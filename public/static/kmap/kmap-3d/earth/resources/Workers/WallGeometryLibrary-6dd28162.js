define(["exports","./when-cbf8cd21","./Math-e66fad2a","./Cartesian2-44433f55","./arrayRemoveDuplicates-b817241d","./PolylinePipeline-9b888896"],function(e,v,A,C,w,P){"use strict";var i={};var b=new C.Cartographic,M=new C.Cartographic;function E(e,i,t,r){var a=(i=w.arrayRemoveDuplicates(i,C.Cartesian3.equalsEpsilon,!0)).length;if(!(a<2)){for(var n,o,h=v.defined(r),l=v.defined(t),s=!0,g=new Array(a),p=new Array(a),u=new Array(a),c=i[0],d=(g[0]=c,e.cartesianToCartographic(c,b)),y=(l&&(d.height=t[0]),s=s&&d.height<=0,p[0]=d.height,u[0]=h?r[0]:0,1),f=1;f<a;++f){var m=i[f],P=e.cartesianToCartographic(m,M);l&&(P.height=t[f]),s=s&&P.height<=0,n=d,o=P,A.CesiumMath.equalsEpsilon(n.latitude,o.latitude,A.CesiumMath.EPSILON10)&&A.CesiumMath.equalsEpsilon(n.longitude,o.longitude,A.CesiumMath.EPSILON10)?d.height<P.height&&(p[y-1]=P.height):(g[y]=m,p[y]=P.height,u[y]=h?r[f]:0,C.Cartographic.clone(P,d),++y)}if(!(y<2))return g.length=y,p.length=y,u.length=y,{positions:g,topHeights:p,bottomHeights:u}}}var F=new Array(2),H=new Array(2),L={positions:void 0,height:void 0,granularity:void 0,ellipsoid:void 0};i.computePositions=function(e,i,t,r,a,n){var o=E(e,i,t,r);if(v.defined(o)){i=o.positions,t=o.topHeights,r=o.bottomHeights;var h=i.length,o=h-2,l=A.CesiumMath.chordLength(a,e.maximumRadius),s=L;if(s.minDistance=l,s.ellipsoid=e,n){for(var g=0,p=0;p<h-1;p++)g+=P.PolylinePipeline.numberOfPoints(i[p],i[p+1],l)+1;var u=new Float64Array(3*g),c=new Float64Array(3*g),d=F,y=H,f=(s.positions=d,s.height=y,0);for(p=0;p<h-1;p++){d[0]=i[p],d[1]=i[p+1],y[0]=t[p],y[1]=t[p+1];var m=P.PolylinePipeline.generateArc(s);u.set(m,f),y[0]=r[p],y[1]=r[p+1],c.set(P.PolylinePipeline.generateArc(s),f),f+=m.length}}else s.positions=i,s.height=t,u=new Float64Array(P.PolylinePipeline.generateArc(s)),s.height=r,c=new Float64Array(P.PolylinePipeline.generateArc(s));return{bottomPositions:c,topPositions:u,numCorners:o}}},e.WallGeometryLibrary=i});
