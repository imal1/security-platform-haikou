!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("KMapEarthBase")):"function"==typeof define&&define.amd?define(["KMapEarthBase"],e):"object"==typeof exports?exports.KMapEarth=e(require("KMapEarthBase")):t.KMapEarth=e(t.KMapEarthBase)}(window,(function(t){return function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="../dist",i(i.s=60)}([function(e,i){e.exports=t},function(t,e,i){(function(t,n){var r;
/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */(function(){var o="Expected a function",s="__lodash_placeholder__",a=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],A="[object Arguments]",l="[object Array]",c="[object Boolean]",u="[object Date]",h="[object Error]",p="[object Function]",d="[object GeneratorFunction]",f="[object Map]",g="[object Number]",m="[object Object]",y="[object RegExp]",v="[object Set]",_="[object String]",w="[object Symbol]",C="[object WeakMap]",B="[object ArrayBuffer]",b="[object DataView]",E="[object Float32Array]",S="[object Float64Array]",x="[object Int8Array]",I="[object Int16Array]",F="[object Int32Array]",O="[object Uint8Array]",P="[object Uint16Array]",T="[object Uint32Array]",L=/\b__p \+= '';/g,M=/\b(__p \+=) '' \+/g,U=/(__e\(.*?\)|\b__t\)) \+\n'';/g,D=/&(?:amp|lt|gt|quot|#39);/g,Q=/[&<>"']/g,R=RegExp(D.source),N=RegExp(Q.source),H=/<%-([\s\S]+?)%>/g,k=/<%([\s\S]+?)%>/g,V=/<%=([\s\S]+?)%>/g,j=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,G=/^\w*$/,K=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,z=/[\\^$.*+?()[\]{}|]/g,W=RegExp(z.source),q=/^\s+/,X=/\s/,Y=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,J=/\{\n\/\* \[wrapped with (.+)\] \*/,Z=/,? & /,$=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,tt=/[()=,{}\[\]\/\s]/,et=/\\(\\)?/g,it=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,nt=/\w*$/,rt=/^[-+]0x[0-9a-f]+$/i,ot=/^0b[01]+$/i,st=/^\[object .+?Constructor\]$/,at=/^0o[0-7]+$/i,At=/^(?:0|[1-9]\d*)$/,lt=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ct=/($^)/,ut=/['\n\r\u2028\u2029\\]/g,ht="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",pt="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",dt="[\\ud800-\\udfff]",ft="["+pt+"]",gt="["+ht+"]",mt="\\d+",yt="[\\u2700-\\u27bf]",vt="[a-z\\xdf-\\xf6\\xf8-\\xff]",_t="[^\\ud800-\\udfff"+pt+mt+"\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",wt="\\ud83c[\\udffb-\\udfff]",Ct="[^\\ud800-\\udfff]",Bt="(?:\\ud83c[\\udde6-\\uddff]){2}",bt="[\\ud800-\\udbff][\\udc00-\\udfff]",Et="[A-Z\\xc0-\\xd6\\xd8-\\xde]",St="(?:"+vt+"|"+_t+")",xt="(?:"+Et+"|"+_t+")",It="(?:"+gt+"|"+wt+")"+"?",Ft="[\\ufe0e\\ufe0f]?"+It+("(?:\\u200d(?:"+[Ct,Bt,bt].join("|")+")[\\ufe0e\\ufe0f]?"+It+")*"),Ot="(?:"+[yt,Bt,bt].join("|")+")"+Ft,Pt="(?:"+[Ct+gt+"?",gt,Bt,bt,dt].join("|")+")",Tt=RegExp("['’]","g"),Lt=RegExp(gt,"g"),Mt=RegExp(wt+"(?="+wt+")|"+Pt+Ft,"g"),Ut=RegExp([Et+"?"+vt+"+(?:['’](?:d|ll|m|re|s|t|ve))?(?="+[ft,Et,"$"].join("|")+")",xt+"+(?:['’](?:D|LL|M|RE|S|T|VE))?(?="+[ft,Et+St,"$"].join("|")+")",Et+"?"+St+"+(?:['’](?:d|ll|m|re|s|t|ve))?",Et+"+(?:['’](?:D|LL|M|RE|S|T|VE))?","\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",mt,Ot].join("|"),"g"),Dt=RegExp("[\\u200d\\ud800-\\udfff"+ht+"\\ufe0e\\ufe0f]"),Qt=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Rt=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Nt=-1,Ht={};Ht[E]=Ht[S]=Ht[x]=Ht[I]=Ht[F]=Ht[O]=Ht["[object Uint8ClampedArray]"]=Ht[P]=Ht[T]=!0,Ht[A]=Ht[l]=Ht[B]=Ht[c]=Ht[b]=Ht[u]=Ht[h]=Ht[p]=Ht[f]=Ht[g]=Ht[m]=Ht[y]=Ht[v]=Ht[_]=Ht[C]=!1;var kt={};kt[A]=kt[l]=kt[B]=kt[b]=kt[c]=kt[u]=kt[E]=kt[S]=kt[x]=kt[I]=kt[F]=kt[f]=kt[g]=kt[m]=kt[y]=kt[v]=kt[_]=kt[w]=kt[O]=kt["[object Uint8ClampedArray]"]=kt[P]=kt[T]=!0,kt[h]=kt[p]=kt[C]=!1;var Vt={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},jt=parseFloat,Gt=parseInt,Kt="object"==typeof t&&t&&t.Object===Object&&t,zt="object"==typeof self&&self&&self.Object===Object&&self,Wt=Kt||zt||Function("return this")(),qt=e&&!e.nodeType&&e,Xt=qt&&"object"==typeof n&&n&&!n.nodeType&&n,Yt=Xt&&Xt.exports===qt,Jt=Yt&&Kt.process,Zt=function(){try{var t=Xt&&Xt.require&&Xt.require("util").types;return t||Jt&&Jt.binding&&Jt.binding("util")}catch(t){}}(),$t=Zt&&Zt.isArrayBuffer,te=Zt&&Zt.isDate,ee=Zt&&Zt.isMap,ie=Zt&&Zt.isRegExp,ne=Zt&&Zt.isSet,re=Zt&&Zt.isTypedArray;function oe(t,e,i){switch(i.length){case 0:return t.call(e);case 1:return t.call(e,i[0]);case 2:return t.call(e,i[0],i[1]);case 3:return t.call(e,i[0],i[1],i[2])}return t.apply(e,i)}function se(t,e,i,n){for(var r=-1,o=null==t?0:t.length;++r<o;){var s=t[r];e(n,s,i(s),t)}return n}function ae(t,e){for(var i=-1,n=null==t?0:t.length;++i<n&&!1!==e(t[i],i,t););return t}function Ae(t,e){for(var i=null==t?0:t.length;i--&&!1!==e(t[i],i,t););return t}function le(t,e){for(var i=-1,n=null==t?0:t.length;++i<n;)if(!e(t[i],i,t))return!1;return!0}function ce(t,e){for(var i=-1,n=null==t?0:t.length,r=0,o=[];++i<n;){var s=t[i];e(s,i,t)&&(o[r++]=s)}return o}function ue(t,e){return!!(null==t?0:t.length)&&we(t,e,0)>-1}function he(t,e,i){for(var n=-1,r=null==t?0:t.length;++n<r;)if(i(e,t[n]))return!0;return!1}function pe(t,e){for(var i=-1,n=null==t?0:t.length,r=Array(n);++i<n;)r[i]=e(t[i],i,t);return r}function de(t,e){for(var i=-1,n=e.length,r=t.length;++i<n;)t[r+i]=e[i];return t}function fe(t,e,i,n){var r=-1,o=null==t?0:t.length;for(n&&o&&(i=t[++r]);++r<o;)i=e(i,t[r],r,t);return i}function ge(t,e,i,n){var r=null==t?0:t.length;for(n&&r&&(i=t[--r]);r--;)i=e(i,t[r],r,t);return i}function me(t,e){for(var i=-1,n=null==t?0:t.length;++i<n;)if(e(t[i],i,t))return!0;return!1}var ye=Ee("length");function ve(t,e,i){var n;return i(t,(function(t,i,r){if(e(t,i,r))return n=i,!1})),n}function _e(t,e,i,n){for(var r=t.length,o=i+(n?1:-1);n?o--:++o<r;)if(e(t[o],o,t))return o;return-1}function we(t,e,i){return e==e?function(t,e,i){var n=i-1,r=t.length;for(;++n<r;)if(t[n]===e)return n;return-1}(t,e,i):_e(t,Be,i)}function Ce(t,e,i,n){for(var r=i-1,o=t.length;++r<o;)if(n(t[r],e))return r;return-1}function Be(t){return t!=t}function be(t,e){var i=null==t?0:t.length;return i?Ie(t,e)/i:NaN}function Ee(t){return function(e){return null==e?void 0:e[t]}}function Se(t){return function(e){return null==t?void 0:t[e]}}function xe(t,e,i,n,r){return r(t,(function(t,r,o){i=n?(n=!1,t):e(i,t,r,o)})),i}function Ie(t,e){for(var i,n=-1,r=t.length;++n<r;){var o=e(t[n]);void 0!==o&&(i=void 0===i?o:i+o)}return i}function Fe(t,e){for(var i=-1,n=Array(t);++i<t;)n[i]=e(i);return n}function Oe(t){return t?t.slice(0,qe(t)+1).replace(q,""):t}function Pe(t){return function(e){return t(e)}}function Te(t,e){return pe(e,(function(e){return t[e]}))}function Le(t,e){return t.has(e)}function Me(t,e){for(var i=-1,n=t.length;++i<n&&we(e,t[i],0)>-1;);return i}function Ue(t,e){for(var i=t.length;i--&&we(e,t[i],0)>-1;);return i}function De(t,e){for(var i=t.length,n=0;i--;)t[i]===e&&++n;return n}var Qe=Se({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),Re=Se({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function Ne(t){return"\\"+Vt[t]}function He(t){return Dt.test(t)}function ke(t){var e=-1,i=Array(t.size);return t.forEach((function(t,n){i[++e]=[n,t]})),i}function Ve(t,e){return function(i){return t(e(i))}}function je(t,e){for(var i=-1,n=t.length,r=0,o=[];++i<n;){var a=t[i];a!==e&&a!==s||(t[i]=s,o[r++]=i)}return o}function Ge(t){var e=-1,i=Array(t.size);return t.forEach((function(t){i[++e]=t})),i}function Ke(t){var e=-1,i=Array(t.size);return t.forEach((function(t){i[++e]=[t,t]})),i}function ze(t){return He(t)?function(t){var e=Mt.lastIndex=0;for(;Mt.test(t);)++e;return e}(t):ye(t)}function We(t){return He(t)?function(t){return t.match(Mt)||[]}(t):function(t){return t.split("")}(t)}function qe(t){for(var e=t.length;e--&&X.test(t.charAt(e)););return e}var Xe=Se({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});var Ye=function t(e){var i,n=(e=null==e?Wt:Ye.defaults(Wt.Object(),e,Ye.pick(Wt,Rt))).Array,r=e.Date,X=e.Error,ht=e.Function,pt=e.Math,dt=e.Object,ft=e.RegExp,gt=e.String,mt=e.TypeError,yt=n.prototype,vt=ht.prototype,_t=dt.prototype,wt=e["__core-js_shared__"],Ct=vt.toString,Bt=_t.hasOwnProperty,bt=0,Et=(i=/[^.]+$/.exec(wt&&wt.keys&&wt.keys.IE_PROTO||""))?"Symbol(src)_1."+i:"",St=_t.toString,xt=Ct.call(dt),It=Wt._,Ft=ft("^"+Ct.call(Bt).replace(z,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ot=Yt?e.Buffer:void 0,Pt=e.Symbol,Mt=e.Uint8Array,Dt=Ot?Ot.allocUnsafe:void 0,Vt=Ve(dt.getPrototypeOf,dt),Kt=dt.create,zt=_t.propertyIsEnumerable,qt=yt.splice,Xt=Pt?Pt.isConcatSpreadable:void 0,Jt=Pt?Pt.iterator:void 0,Zt=Pt?Pt.toStringTag:void 0,ye=function(){try{var t=to(dt,"defineProperty");return t({},"",{}),t}catch(t){}}(),Se=e.clearTimeout!==Wt.clearTimeout&&e.clearTimeout,Je=r&&r.now!==Wt.Date.now&&r.now,Ze=e.setTimeout!==Wt.setTimeout&&e.setTimeout,$e=pt.ceil,ti=pt.floor,ei=dt.getOwnPropertySymbols,ii=Ot?Ot.isBuffer:void 0,ni=e.isFinite,ri=yt.join,oi=Ve(dt.keys,dt),si=pt.max,ai=pt.min,Ai=r.now,li=e.parseInt,ci=pt.random,ui=yt.reverse,hi=to(e,"DataView"),pi=to(e,"Map"),di=to(e,"Promise"),fi=to(e,"Set"),gi=to(e,"WeakMap"),mi=to(dt,"create"),yi=gi&&new gi,vi={},_i=Io(hi),wi=Io(pi),Ci=Io(di),Bi=Io(fi),bi=Io(gi),Ei=Pt?Pt.prototype:void 0,Si=Ei?Ei.valueOf:void 0,xi=Ei?Ei.toString:void 0;function Ii(t){if(Ks(t)&&!Ms(t)&&!(t instanceof Ti)){if(t instanceof Pi)return t;if(Bt.call(t,"__wrapped__"))return Fo(t)}return new Pi(t)}var Fi=function(){function t(){}return function(e){if(!Gs(e))return{};if(Kt)return Kt(e);t.prototype=e;var i=new t;return t.prototype=void 0,i}}();function Oi(){}function Pi(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=void 0}function Ti(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}function Li(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}function Mi(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}function Ui(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}function Di(t){var e=-1,i=null==t?0:t.length;for(this.__data__=new Ui;++e<i;)this.add(t[e])}function Qi(t){var e=this.__data__=new Mi(t);this.size=e.size}function Ri(t,e){var i=Ms(t),n=!i&&Ls(t),r=!i&&!n&&Rs(t),o=!i&&!n&&!r&&$s(t),s=i||n||r||o,a=s?Fe(t.length,gt):[],A=a.length;for(var l in t)!e&&!Bt.call(t,l)||s&&("length"==l||r&&("offset"==l||"parent"==l)||o&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||ao(l,A))||a.push(l);return a}function Ni(t){var e=t.length;return e?t[Qn(0,e-1)]:void 0}function Hi(t,e){return Eo(yr(t),Xi(e,0,t.length))}function ki(t){return Eo(yr(t))}function Vi(t,e,i){(void 0!==i&&!Os(t[e],i)||void 0===i&&!(e in t))&&Wi(t,e,i)}function ji(t,e,i){var n=t[e];Bt.call(t,e)&&Os(n,i)&&(void 0!==i||e in t)||Wi(t,e,i)}function Gi(t,e){for(var i=t.length;i--;)if(Os(t[i][0],e))return i;return-1}function Ki(t,e,i,n){return tn(t,(function(t,r,o){e(n,t,i(t),o)})),n}function zi(t,e){return t&&vr(e,wa(e),t)}function Wi(t,e,i){"__proto__"==e&&ye?ye(t,e,{configurable:!0,enumerable:!0,value:i,writable:!0}):t[e]=i}function qi(t,e){for(var i=-1,r=e.length,o=n(r),s=null==t;++i<r;)o[i]=s?void 0:ga(t,e[i]);return o}function Xi(t,e,i){return t==t&&(void 0!==i&&(t=t<=i?t:i),void 0!==e&&(t=t>=e?t:e)),t}function Yi(t,e,i,n,r,o){var s,a=1&e,l=2&e,h=4&e;if(i&&(s=r?i(t,n,r,o):i(t)),void 0!==s)return s;if(!Gs(t))return t;var C=Ms(t);if(C){if(s=function(t){var e=t.length,i=new t.constructor(e);e&&"string"==typeof t[0]&&Bt.call(t,"index")&&(i.index=t.index,i.input=t.input);return i}(t),!a)return yr(t,s)}else{var L=no(t),M=L==p||L==d;if(Rs(t))return hr(t,a);if(L==m||L==A||M&&!r){if(s=l||M?{}:oo(t),!a)return l?function(t,e){return vr(t,io(t),e)}(t,function(t,e){return t&&vr(e,Ca(e),t)}(s,t)):function(t,e){return vr(t,eo(t),e)}(t,zi(s,t))}else{if(!kt[L])return r?t:{};s=function(t,e,i){var n=t.constructor;switch(e){case B:return pr(t);case c:case u:return new n(+t);case b:return function(t,e){var i=e?pr(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.byteLength)}(t,i);case E:case S:case x:case I:case F:case O:case"[object Uint8ClampedArray]":case P:case T:return dr(t,i);case f:return new n;case g:case _:return new n(t);case y:return function(t){var e=new t.constructor(t.source,nt.exec(t));return e.lastIndex=t.lastIndex,e}(t);case v:return new n;case w:return r=t,Si?dt(Si.call(r)):{}}var r}(t,L,a)}}o||(o=new Qi);var U=o.get(t);if(U)return U;o.set(t,s),Ys(t)?t.forEach((function(n){s.add(Yi(n,e,i,n,t,o))})):zs(t)&&t.forEach((function(n,r){s.set(r,Yi(n,e,i,r,t,o))}));var D=C?void 0:(h?l?Wr:zr:l?Ca:wa)(t);return ae(D||t,(function(n,r){D&&(n=t[r=n]),ji(s,r,Yi(n,e,i,r,t,o))})),s}function Ji(t,e,i){var n=i.length;if(null==t)return!n;for(t=dt(t);n--;){var r=i[n],o=e[r],s=t[r];if(void 0===s&&!(r in t)||!o(s))return!1}return!0}function Zi(t,e,i){if("function"!=typeof t)throw new mt(o);return wo((function(){t.apply(void 0,i)}),e)}function $i(t,e,i,n){var r=-1,o=ue,s=!0,a=t.length,A=[],l=e.length;if(!a)return A;i&&(e=pe(e,Pe(i))),n?(o=he,s=!1):e.length>=200&&(o=Le,s=!1,e=new Di(e));t:for(;++r<a;){var c=t[r],u=null==i?c:i(c);if(c=n||0!==c?c:0,s&&u==u){for(var h=l;h--;)if(e[h]===u)continue t;A.push(c)}else o(e,u,n)||A.push(c)}return A}Ii.templateSettings={escape:H,evaluate:k,interpolate:V,variable:"",imports:{_:Ii}},Ii.prototype=Oi.prototype,Ii.prototype.constructor=Ii,Pi.prototype=Fi(Oi.prototype),Pi.prototype.constructor=Pi,Ti.prototype=Fi(Oi.prototype),Ti.prototype.constructor=Ti,Li.prototype.clear=function(){this.__data__=mi?mi(null):{},this.size=0},Li.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},Li.prototype.get=function(t){var e=this.__data__;if(mi){var i=e[t];return"__lodash_hash_undefined__"===i?void 0:i}return Bt.call(e,t)?e[t]:void 0},Li.prototype.has=function(t){var e=this.__data__;return mi?void 0!==e[t]:Bt.call(e,t)},Li.prototype.set=function(t,e){var i=this.__data__;return this.size+=this.has(t)?0:1,i[t]=mi&&void 0===e?"__lodash_hash_undefined__":e,this},Mi.prototype.clear=function(){this.__data__=[],this.size=0},Mi.prototype.delete=function(t){var e=this.__data__,i=Gi(e,t);return!(i<0)&&(i==e.length-1?e.pop():qt.call(e,i,1),--this.size,!0)},Mi.prototype.get=function(t){var e=this.__data__,i=Gi(e,t);return i<0?void 0:e[i][1]},Mi.prototype.has=function(t){return Gi(this.__data__,t)>-1},Mi.prototype.set=function(t,e){var i=this.__data__,n=Gi(i,t);return n<0?(++this.size,i.push([t,e])):i[n][1]=e,this},Ui.prototype.clear=function(){this.size=0,this.__data__={hash:new Li,map:new(pi||Mi),string:new Li}},Ui.prototype.delete=function(t){var e=Zr(this,t).delete(t);return this.size-=e?1:0,e},Ui.prototype.get=function(t){return Zr(this,t).get(t)},Ui.prototype.has=function(t){return Zr(this,t).has(t)},Ui.prototype.set=function(t,e){var i=Zr(this,t),n=i.size;return i.set(t,e),this.size+=i.size==n?0:1,this},Di.prototype.add=Di.prototype.push=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},Di.prototype.has=function(t){return this.__data__.has(t)},Qi.prototype.clear=function(){this.__data__=new Mi,this.size=0},Qi.prototype.delete=function(t){var e=this.__data__,i=e.delete(t);return this.size=e.size,i},Qi.prototype.get=function(t){return this.__data__.get(t)},Qi.prototype.has=function(t){return this.__data__.has(t)},Qi.prototype.set=function(t,e){var i=this.__data__;if(i instanceof Mi){var n=i.__data__;if(!pi||n.length<199)return n.push([t,e]),this.size=++i.size,this;i=this.__data__=new Ui(n)}return i.set(t,e),this.size=i.size,this};var tn=Cr(ln),en=Cr(cn,!0);function nn(t,e){var i=!0;return tn(t,(function(t,n,r){return i=!!e(t,n,r)})),i}function rn(t,e,i){for(var n=-1,r=t.length;++n<r;){var o=t[n],s=e(o);if(null!=s&&(void 0===a?s==s&&!Zs(s):i(s,a)))var a=s,A=o}return A}function on(t,e){var i=[];return tn(t,(function(t,n,r){e(t,n,r)&&i.push(t)})),i}function sn(t,e,i,n,r){var o=-1,s=t.length;for(i||(i=so),r||(r=[]);++o<s;){var a=t[o];e>0&&i(a)?e>1?sn(a,e-1,i,n,r):de(r,a):n||(r[r.length]=a)}return r}var an=Br(),An=Br(!0);function ln(t,e){return t&&an(t,e,wa)}function cn(t,e){return t&&An(t,e,wa)}function un(t,e){return ce(e,(function(e){return ks(t[e])}))}function hn(t,e){for(var i=0,n=(e=Ar(e,t)).length;null!=t&&i<n;)t=t[xo(e[i++])];return i&&i==n?t:void 0}function pn(t,e,i){var n=e(t);return Ms(t)?n:de(n,i(t))}function dn(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":Zt&&Zt in dt(t)?function(t){var e=Bt.call(t,Zt),i=t[Zt];try{t[Zt]=void 0;var n=!0}catch(t){}var r=St.call(t);n&&(e?t[Zt]=i:delete t[Zt]);return r}(t):function(t){return St.call(t)}(t)}function fn(t,e){return t>e}function gn(t,e){return null!=t&&Bt.call(t,e)}function mn(t,e){return null!=t&&e in dt(t)}function yn(t,e,i){for(var r=i?he:ue,o=t[0].length,s=t.length,a=s,A=n(s),l=1/0,c=[];a--;){var u=t[a];a&&e&&(u=pe(u,Pe(e))),l=ai(u.length,l),A[a]=!i&&(e||o>=120&&u.length>=120)?new Di(a&&u):void 0}u=t[0];var h=-1,p=A[0];t:for(;++h<o&&c.length<l;){var d=u[h],f=e?e(d):d;if(d=i||0!==d?d:0,!(p?Le(p,f):r(c,f,i))){for(a=s;--a;){var g=A[a];if(!(g?Le(g,f):r(t[a],f,i)))continue t}p&&p.push(f),c.push(d)}}return c}function vn(t,e,i){var n=null==(t=mo(t,e=Ar(e,t)))?t:t[xo(Ho(e))];return null==n?void 0:oe(n,t,i)}function _n(t){return Ks(t)&&dn(t)==A}function wn(t,e,i,n,r){return t===e||(null==t||null==e||!Ks(t)&&!Ks(e)?t!=t&&e!=e:function(t,e,i,n,r,o){var s=Ms(t),a=Ms(e),p=s?l:no(t),d=a?l:no(e),C=(p=p==A?m:p)==m,E=(d=d==A?m:d)==m,S=p==d;if(S&&Rs(t)){if(!Rs(e))return!1;s=!0,C=!1}if(S&&!C)return o||(o=new Qi),s||$s(t)?Gr(t,e,i,n,r,o):function(t,e,i,n,r,o,s){switch(i){case b:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case B:return!(t.byteLength!=e.byteLength||!o(new Mt(t),new Mt(e)));case c:case u:case g:return Os(+t,+e);case h:return t.name==e.name&&t.message==e.message;case y:case _:return t==e+"";case f:var a=ke;case v:var A=1&n;if(a||(a=Ge),t.size!=e.size&&!A)return!1;var l=s.get(t);if(l)return l==e;n|=2,s.set(t,e);var p=Gr(a(t),a(e),n,r,o,s);return s.delete(t),p;case w:if(Si)return Si.call(t)==Si.call(e)}return!1}(t,e,p,i,n,r,o);if(!(1&i)){var x=C&&Bt.call(t,"__wrapped__"),I=E&&Bt.call(e,"__wrapped__");if(x||I){var F=x?t.value():t,O=I?e.value():e;return o||(o=new Qi),r(F,O,i,n,o)}}if(!S)return!1;return o||(o=new Qi),function(t,e,i,n,r,o){var s=1&i,a=zr(t),A=a.length,l=zr(e).length;if(A!=l&&!s)return!1;var c=A;for(;c--;){var u=a[c];if(!(s?u in e:Bt.call(e,u)))return!1}var h=o.get(t),p=o.get(e);if(h&&p)return h==e&&p==t;var d=!0;o.set(t,e),o.set(e,t);var f=s;for(;++c<A;){u=a[c];var g=t[u],m=e[u];if(n)var y=s?n(m,g,u,e,t,o):n(g,m,u,t,e,o);if(!(void 0===y?g===m||r(g,m,i,n,o):y)){d=!1;break}f||(f="constructor"==u)}if(d&&!f){var v=t.constructor,_=e.constructor;v==_||!("constructor"in t)||!("constructor"in e)||"function"==typeof v&&v instanceof v&&"function"==typeof _&&_ instanceof _||(d=!1)}return o.delete(t),o.delete(e),d}(t,e,i,n,r,o)}(t,e,i,n,wn,r))}function Cn(t,e,i,n){var r=i.length,o=r,s=!n;if(null==t)return!o;for(t=dt(t);r--;){var a=i[r];if(s&&a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1}for(;++r<o;){var A=(a=i[r])[0],l=t[A],c=a[1];if(s&&a[2]){if(void 0===l&&!(A in t))return!1}else{var u=new Qi;if(n)var h=n(l,c,A,t,e,u);if(!(void 0===h?wn(c,l,3,n,u):h))return!1}}return!0}function Bn(t){return!(!Gs(t)||(e=t,Et&&Et in e))&&(ks(t)?Ft:st).test(Io(t));var e}function bn(t){return"function"==typeof t?t:null==t?Wa:"object"==typeof t?Ms(t)?On(t[0],t[1]):Fn(t):iA(t)}function En(t){if(!ho(t))return oi(t);var e=[];for(var i in dt(t))Bt.call(t,i)&&"constructor"!=i&&e.push(i);return e}function Sn(t){if(!Gs(t))return function(t){var e=[];if(null!=t)for(var i in dt(t))e.push(i);return e}(t);var e=ho(t),i=[];for(var n in t)("constructor"!=n||!e&&Bt.call(t,n))&&i.push(n);return i}function xn(t,e){return t<e}function In(t,e){var i=-1,r=Ds(t)?n(t.length):[];return tn(t,(function(t,n,o){r[++i]=e(t,n,o)})),r}function Fn(t){var e=$r(t);return 1==e.length&&e[0][2]?fo(e[0][0],e[0][1]):function(i){return i===t||Cn(i,t,e)}}function On(t,e){return lo(t)&&po(e)?fo(xo(t),e):function(i){var n=ga(i,t);return void 0===n&&n===e?ma(i,t):wn(e,n,3)}}function Pn(t,e,i,n,r){t!==e&&an(e,(function(o,s){if(r||(r=new Qi),Gs(o))!function(t,e,i,n,r,o,s){var a=vo(t,i),A=vo(e,i),l=s.get(A);if(l)return void Vi(t,i,l);var c=o?o(a,A,i+"",t,e,s):void 0,u=void 0===c;if(u){var h=Ms(A),p=!h&&Rs(A),d=!h&&!p&&$s(A);c=A,h||p||d?Ms(a)?c=a:Qs(a)?c=yr(a):p?(u=!1,c=hr(A,!0)):d?(u=!1,c=dr(A,!0)):c=[]:qs(A)||Ls(A)?(c=a,Ls(a)?c=aa(a):Gs(a)&&!ks(a)||(c=oo(A))):u=!1}u&&(s.set(A,c),r(c,A,n,o,s),s.delete(A));Vi(t,i,c)}(t,e,s,i,Pn,n,r);else{var a=n?n(vo(t,s),o,s+"",t,e,r):void 0;void 0===a&&(a=o),Vi(t,s,a)}}),Ca)}function Tn(t,e){var i=t.length;if(i)return ao(e+=e<0?i:0,i)?t[e]:void 0}function Ln(t,e,i){e=e.length?pe(e,(function(t){return Ms(t)?function(e){return hn(e,1===t.length?t[0]:t)}:t})):[Wa];var n=-1;return e=pe(e,Pe(Jr())),function(t,e){var i=t.length;for(t.sort(e);i--;)t[i]=t[i].value;return t}(In(t,(function(t,i,r){return{criteria:pe(e,(function(e){return e(t)})),index:++n,value:t}})),(function(t,e){return function(t,e,i){var n=-1,r=t.criteria,o=e.criteria,s=r.length,a=i.length;for(;++n<s;){var A=fr(r[n],o[n]);if(A){if(n>=a)return A;var l=i[n];return A*("desc"==l?-1:1)}}return t.index-e.index}(t,e,i)}))}function Mn(t,e,i){for(var n=-1,r=e.length,o={};++n<r;){var s=e[n],a=hn(t,s);i(a,s)&&Vn(o,Ar(s,t),a)}return o}function Un(t,e,i,n){var r=n?Ce:we,o=-1,s=e.length,a=t;for(t===e&&(e=yr(e)),i&&(a=pe(t,Pe(i)));++o<s;)for(var A=0,l=e[o],c=i?i(l):l;(A=r(a,c,A,n))>-1;)a!==t&&qt.call(a,A,1),qt.call(t,A,1);return t}function Dn(t,e){for(var i=t?e.length:0,n=i-1;i--;){var r=e[i];if(i==n||r!==o){var o=r;ao(r)?qt.call(t,r,1):tr(t,r)}}return t}function Qn(t,e){return t+ti(ci()*(e-t+1))}function Rn(t,e){var i="";if(!t||e<1||e>9007199254740991)return i;do{e%2&&(i+=t),(e=ti(e/2))&&(t+=t)}while(e);return i}function Nn(t,e){return Co(go(t,e,Wa),t+"")}function Hn(t){return Ni(Oa(t))}function kn(t,e){var i=Oa(t);return Eo(i,Xi(e,0,i.length))}function Vn(t,e,i,n){if(!Gs(t))return t;for(var r=-1,o=(e=Ar(e,t)).length,s=o-1,a=t;null!=a&&++r<o;){var A=xo(e[r]),l=i;if("__proto__"===A||"constructor"===A||"prototype"===A)return t;if(r!=s){var c=a[A];void 0===(l=n?n(c,A,a):void 0)&&(l=Gs(c)?c:ao(e[r+1])?[]:{})}ji(a,A,l),a=a[A]}return t}var jn=yi?function(t,e){return yi.set(t,e),t}:Wa,Gn=ye?function(t,e){return ye(t,"toString",{configurable:!0,enumerable:!1,value:Ga(e),writable:!0})}:Wa;function Kn(t){return Eo(Oa(t))}function zn(t,e,i){var r=-1,o=t.length;e<0&&(e=-e>o?0:o+e),(i=i>o?o:i)<0&&(i+=o),o=e>i?0:i-e>>>0,e>>>=0;for(var s=n(o);++r<o;)s[r]=t[r+e];return s}function Wn(t,e){var i;return tn(t,(function(t,n,r){return!(i=e(t,n,r))})),!!i}function qn(t,e,i){var n=0,r=null==t?n:t.length;if("number"==typeof e&&e==e&&r<=2147483647){for(;n<r;){var o=n+r>>>1,s=t[o];null!==s&&!Zs(s)&&(i?s<=e:s<e)?n=o+1:r=o}return r}return Xn(t,e,Wa,i)}function Xn(t,e,i,n){var r=0,o=null==t?0:t.length;if(0===o)return 0;for(var s=(e=i(e))!=e,a=null===e,A=Zs(e),l=void 0===e;r<o;){var c=ti((r+o)/2),u=i(t[c]),h=void 0!==u,p=null===u,d=u==u,f=Zs(u);if(s)var g=n||d;else g=l?d&&(n||h):a?d&&h&&(n||!p):A?d&&h&&!p&&(n||!f):!p&&!f&&(n?u<=e:u<e);g?r=c+1:o=c}return ai(o,4294967294)}function Yn(t,e){for(var i=-1,n=t.length,r=0,o=[];++i<n;){var s=t[i],a=e?e(s):s;if(!i||!Os(a,A)){var A=a;o[r++]=0===s?0:s}}return o}function Jn(t){return"number"==typeof t?t:Zs(t)?NaN:+t}function Zn(t){if("string"==typeof t)return t;if(Ms(t))return pe(t,Zn)+"";if(Zs(t))return xi?xi.call(t):"";var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function $n(t,e,i){var n=-1,r=ue,o=t.length,s=!0,a=[],A=a;if(i)s=!1,r=he;else if(o>=200){var l=e?null:Rr(t);if(l)return Ge(l);s=!1,r=Le,A=new Di}else A=e?[]:a;t:for(;++n<o;){var c=t[n],u=e?e(c):c;if(c=i||0!==c?c:0,s&&u==u){for(var h=A.length;h--;)if(A[h]===u)continue t;e&&A.push(u),a.push(c)}else r(A,u,i)||(A!==a&&A.push(u),a.push(c))}return a}function tr(t,e){return null==(t=mo(t,e=Ar(e,t)))||delete t[xo(Ho(e))]}function er(t,e,i,n){return Vn(t,e,i(hn(t,e)),n)}function ir(t,e,i,n){for(var r=t.length,o=n?r:-1;(n?o--:++o<r)&&e(t[o],o,t););return i?zn(t,n?0:o,n?o+1:r):zn(t,n?o+1:0,n?r:o)}function nr(t,e){var i=t;return i instanceof Ti&&(i=i.value()),fe(e,(function(t,e){return e.func.apply(e.thisArg,de([t],e.args))}),i)}function rr(t,e,i){var r=t.length;if(r<2)return r?$n(t[0]):[];for(var o=-1,s=n(r);++o<r;)for(var a=t[o],A=-1;++A<r;)A!=o&&(s[o]=$i(s[o]||a,t[A],e,i));return $n(sn(s,1),e,i)}function or(t,e,i){for(var n=-1,r=t.length,o=e.length,s={};++n<r;){var a=n<o?e[n]:void 0;i(s,t[n],a)}return s}function sr(t){return Qs(t)?t:[]}function ar(t){return"function"==typeof t?t:Wa}function Ar(t,e){return Ms(t)?t:lo(t,e)?[t]:So(Aa(t))}var lr=Nn;function cr(t,e,i){var n=t.length;return i=void 0===i?n:i,!e&&i>=n?t:zn(t,e,i)}var ur=Se||function(t){return Wt.clearTimeout(t)};function hr(t,e){if(e)return t.slice();var i=t.length,n=Dt?Dt(i):new t.constructor(i);return t.copy(n),n}function pr(t){var e=new t.constructor(t.byteLength);return new Mt(e).set(new Mt(t)),e}function dr(t,e){var i=e?pr(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.length)}function fr(t,e){if(t!==e){var i=void 0!==t,n=null===t,r=t==t,o=Zs(t),s=void 0!==e,a=null===e,A=e==e,l=Zs(e);if(!a&&!l&&!o&&t>e||o&&s&&A&&!a&&!l||n&&s&&A||!i&&A||!r)return 1;if(!n&&!o&&!l&&t<e||l&&i&&r&&!n&&!o||a&&i&&r||!s&&r||!A)return-1}return 0}function gr(t,e,i,r){for(var o=-1,s=t.length,a=i.length,A=-1,l=e.length,c=si(s-a,0),u=n(l+c),h=!r;++A<l;)u[A]=e[A];for(;++o<a;)(h||o<s)&&(u[i[o]]=t[o]);for(;c--;)u[A++]=t[o++];return u}function mr(t,e,i,r){for(var o=-1,s=t.length,a=-1,A=i.length,l=-1,c=e.length,u=si(s-A,0),h=n(u+c),p=!r;++o<u;)h[o]=t[o];for(var d=o;++l<c;)h[d+l]=e[l];for(;++a<A;)(p||o<s)&&(h[d+i[a]]=t[o++]);return h}function yr(t,e){var i=-1,r=t.length;for(e||(e=n(r));++i<r;)e[i]=t[i];return e}function vr(t,e,i,n){var r=!i;i||(i={});for(var o=-1,s=e.length;++o<s;){var a=e[o],A=n?n(i[a],t[a],a,i,t):void 0;void 0===A&&(A=t[a]),r?Wi(i,a,A):ji(i,a,A)}return i}function _r(t,e){return function(i,n){var r=Ms(i)?se:Ki,o=e?e():{};return r(i,t,Jr(n,2),o)}}function wr(t){return Nn((function(e,i){var n=-1,r=i.length,o=r>1?i[r-1]:void 0,s=r>2?i[2]:void 0;for(o=t.length>3&&"function"==typeof o?(r--,o):void 0,s&&Ao(i[0],i[1],s)&&(o=r<3?void 0:o,r=1),e=dt(e);++n<r;){var a=i[n];a&&t(e,a,n,o)}return e}))}function Cr(t,e){return function(i,n){if(null==i)return i;if(!Ds(i))return t(i,n);for(var r=i.length,o=e?r:-1,s=dt(i);(e?o--:++o<r)&&!1!==n(s[o],o,s););return i}}function Br(t){return function(e,i,n){for(var r=-1,o=dt(e),s=n(e),a=s.length;a--;){var A=s[t?a:++r];if(!1===i(o[A],A,o))break}return e}}function br(t){return function(e){var i=He(e=Aa(e))?We(e):void 0,n=i?i[0]:e.charAt(0),r=i?cr(i,1).join(""):e.slice(1);return n[t]()+r}}function Er(t){return function(e){return fe(ka(La(e).replace(Tt,"")),t,"")}}function Sr(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var i=Fi(t.prototype),n=t.apply(i,e);return Gs(n)?n:i}}function xr(t){return function(e,i,n){var r=dt(e);if(!Ds(e)){var o=Jr(i,3);e=wa(e),i=function(t){return o(r[t],t,r)}}var s=t(e,i,n);return s>-1?r[o?e[s]:s]:void 0}}function Ir(t){return Kr((function(e){var i=e.length,n=i,r=Pi.prototype.thru;for(t&&e.reverse();n--;){var s=e[n];if("function"!=typeof s)throw new mt(o);if(r&&!a&&"wrapper"==Xr(s))var a=new Pi([],!0)}for(n=a?n:i;++n<i;){var A=Xr(s=e[n]),l="wrapper"==A?qr(s):void 0;a=l&&co(l[0])&&424==l[1]&&!l[4].length&&1==l[9]?a[Xr(l[0])].apply(a,l[3]):1==s.length&&co(s)?a[A]():a.thru(s)}return function(){var t=arguments,n=t[0];if(a&&1==t.length&&Ms(n))return a.plant(n).value();for(var r=0,o=i?e[r].apply(this,t):n;++r<i;)o=e[r].call(this,o);return o}}))}function Fr(t,e,i,r,o,s,a,A,l,c){var u=128&e,h=1&e,p=2&e,d=24&e,f=512&e,g=p?void 0:Sr(t);return function m(){for(var y=arguments.length,v=n(y),_=y;_--;)v[_]=arguments[_];if(d)var w=Yr(m),C=De(v,w);if(r&&(v=gr(v,r,o,d)),s&&(v=mr(v,s,a,d)),y-=C,d&&y<c){var B=je(v,w);return Dr(t,e,Fr,m.placeholder,i,v,B,A,l,c-y)}var b=h?i:this,E=p?b[t]:t;return y=v.length,A?v=yo(v,A):f&&y>1&&v.reverse(),u&&l<y&&(v.length=l),this&&this!==Wt&&this instanceof m&&(E=g||Sr(E)),E.apply(b,v)}}function Or(t,e){return function(i,n){return function(t,e,i,n){return ln(t,(function(t,r,o){e(n,i(t),r,o)})),n}(i,t,e(n),{})}}function Pr(t,e){return function(i,n){var r;if(void 0===i&&void 0===n)return e;if(void 0!==i&&(r=i),void 0!==n){if(void 0===r)return n;"string"==typeof i||"string"==typeof n?(i=Zn(i),n=Zn(n)):(i=Jn(i),n=Jn(n)),r=t(i,n)}return r}}function Tr(t){return Kr((function(e){return e=pe(e,Pe(Jr())),Nn((function(i){var n=this;return t(e,(function(t){return oe(t,n,i)}))}))}))}function Lr(t,e){var i=(e=void 0===e?" ":Zn(e)).length;if(i<2)return i?Rn(e,t):e;var n=Rn(e,$e(t/ze(e)));return He(e)?cr(We(n),0,t).join(""):n.slice(0,t)}function Mr(t){return function(e,i,r){return r&&"number"!=typeof r&&Ao(e,i,r)&&(i=r=void 0),e=na(e),void 0===i?(i=e,e=0):i=na(i),function(t,e,i,r){for(var o=-1,s=si($e((e-t)/(i||1)),0),a=n(s);s--;)a[r?s:++o]=t,t+=i;return a}(e,i,r=void 0===r?e<i?1:-1:na(r),t)}}function Ur(t){return function(e,i){return"string"==typeof e&&"string"==typeof i||(e=sa(e),i=sa(i)),t(e,i)}}function Dr(t,e,i,n,r,o,s,a,A,l){var c=8&e;e|=c?32:64,4&(e&=~(c?64:32))||(e&=-4);var u=[t,e,r,c?o:void 0,c?s:void 0,c?void 0:o,c?void 0:s,a,A,l],h=i.apply(void 0,u);return co(t)&&_o(h,u),h.placeholder=n,Bo(h,t,e)}function Qr(t){var e=pt[t];return function(t,i){if(t=sa(t),(i=null==i?0:ai(ra(i),292))&&ni(t)){var n=(Aa(t)+"e").split("e");return+((n=(Aa(e(n[0]+"e"+(+n[1]+i)))+"e").split("e"))[0]+"e"+(+n[1]-i))}return e(t)}}var Rr=fi&&1/Ge(new fi([,-0]))[1]==1/0?function(t){return new fi(t)}:Za;function Nr(t){return function(e){var i=no(e);return i==f?ke(e):i==v?Ke(e):function(t,e){return pe(e,(function(e){return[e,t[e]]}))}(e,t(e))}}function Hr(t,e,i,r,a,A,l,c){var u=2&e;if(!u&&"function"!=typeof t)throw new mt(o);var h=r?r.length:0;if(h||(e&=-97,r=a=void 0),l=void 0===l?l:si(ra(l),0),c=void 0===c?c:ra(c),h-=a?a.length:0,64&e){var p=r,d=a;r=a=void 0}var f=u?void 0:qr(t),g=[t,e,i,r,a,p,d,A,l,c];if(f&&function(t,e){var i=t[1],n=e[1],r=i|n,o=r<131,a=128==n&&8==i||128==n&&256==i&&t[7].length<=e[8]||384==n&&e[7].length<=e[8]&&8==i;if(!o&&!a)return t;1&n&&(t[2]=e[2],r|=1&i?0:4);var A=e[3];if(A){var l=t[3];t[3]=l?gr(l,A,e[4]):A,t[4]=l?je(t[3],s):e[4]}(A=e[5])&&(l=t[5],t[5]=l?mr(l,A,e[6]):A,t[6]=l?je(t[5],s):e[6]);(A=e[7])&&(t[7]=A);128&n&&(t[8]=null==t[8]?e[8]:ai(t[8],e[8]));null==t[9]&&(t[9]=e[9]);t[0]=e[0],t[1]=r}(g,f),t=g[0],e=g[1],i=g[2],r=g[3],a=g[4],!(c=g[9]=void 0===g[9]?u?0:t.length:si(g[9]-h,0))&&24&e&&(e&=-25),e&&1!=e)m=8==e||16==e?function(t,e,i){var r=Sr(t);return function o(){for(var s=arguments.length,a=n(s),A=s,l=Yr(o);A--;)a[A]=arguments[A];var c=s<3&&a[0]!==l&&a[s-1]!==l?[]:je(a,l);if((s-=c.length)<i)return Dr(t,e,Fr,o.placeholder,void 0,a,c,void 0,void 0,i-s);var u=this&&this!==Wt&&this instanceof o?r:t;return oe(u,this,a)}}(t,e,c):32!=e&&33!=e||a.length?Fr.apply(void 0,g):function(t,e,i,r){var o=1&e,s=Sr(t);return function e(){for(var a=-1,A=arguments.length,l=-1,c=r.length,u=n(c+A),h=this&&this!==Wt&&this instanceof e?s:t;++l<c;)u[l]=r[l];for(;A--;)u[l++]=arguments[++a];return oe(h,o?i:this,u)}}(t,e,i,r);else var m=function(t,e,i){var n=1&e,r=Sr(t);return function e(){var o=this&&this!==Wt&&this instanceof e?r:t;return o.apply(n?i:this,arguments)}}(t,e,i);return Bo((f?jn:_o)(m,g),t,e)}function kr(t,e,i,n){return void 0===t||Os(t,_t[i])&&!Bt.call(n,i)?e:t}function Vr(t,e,i,n,r,o){return Gs(t)&&Gs(e)&&(o.set(e,t),Pn(t,e,void 0,Vr,o),o.delete(e)),t}function jr(t){return qs(t)?void 0:t}function Gr(t,e,i,n,r,o){var s=1&i,a=t.length,A=e.length;if(a!=A&&!(s&&A>a))return!1;var l=o.get(t),c=o.get(e);if(l&&c)return l==e&&c==t;var u=-1,h=!0,p=2&i?new Di:void 0;for(o.set(t,e),o.set(e,t);++u<a;){var d=t[u],f=e[u];if(n)var g=s?n(f,d,u,e,t,o):n(d,f,u,t,e,o);if(void 0!==g){if(g)continue;h=!1;break}if(p){if(!me(e,(function(t,e){if(!Le(p,e)&&(d===t||r(d,t,i,n,o)))return p.push(e)}))){h=!1;break}}else if(d!==f&&!r(d,f,i,n,o)){h=!1;break}}return o.delete(t),o.delete(e),h}function Kr(t){return Co(go(t,void 0,Uo),t+"")}function zr(t){return pn(t,wa,eo)}function Wr(t){return pn(t,Ca,io)}var qr=yi?function(t){return yi.get(t)}:Za;function Xr(t){for(var e=t.name+"",i=vi[e],n=Bt.call(vi,e)?i.length:0;n--;){var r=i[n],o=r.func;if(null==o||o==t)return r.name}return e}function Yr(t){return(Bt.call(Ii,"placeholder")?Ii:t).placeholder}function Jr(){var t=Ii.iteratee||qa;return t=t===qa?bn:t,arguments.length?t(arguments[0],arguments[1]):t}function Zr(t,e){var i,n,r=t.__data__;return("string"==(n=typeof(i=e))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==i:null===i)?r["string"==typeof e?"string":"hash"]:r.map}function $r(t){for(var e=wa(t),i=e.length;i--;){var n=e[i],r=t[n];e[i]=[n,r,po(r)]}return e}function to(t,e){var i=function(t,e){return null==t?void 0:t[e]}(t,e);return Bn(i)?i:void 0}var eo=ei?function(t){return null==t?[]:(t=dt(t),ce(ei(t),(function(e){return zt.call(t,e)})))}:oA,io=ei?function(t){for(var e=[];t;)de(e,eo(t)),t=Vt(t);return e}:oA,no=dn;function ro(t,e,i){for(var n=-1,r=(e=Ar(e,t)).length,o=!1;++n<r;){var s=xo(e[n]);if(!(o=null!=t&&i(t,s)))break;t=t[s]}return o||++n!=r?o:!!(r=null==t?0:t.length)&&js(r)&&ao(s,r)&&(Ms(t)||Ls(t))}function oo(t){return"function"!=typeof t.constructor||ho(t)?{}:Fi(Vt(t))}function so(t){return Ms(t)||Ls(t)||!!(Xt&&t&&t[Xt])}function ao(t,e){var i=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==i||"symbol"!=i&&At.test(t))&&t>-1&&t%1==0&&t<e}function Ao(t,e,i){if(!Gs(i))return!1;var n=typeof e;return!!("number"==n?Ds(i)&&ao(e,i.length):"string"==n&&e in i)&&Os(i[e],t)}function lo(t,e){if(Ms(t))return!1;var i=typeof t;return!("number"!=i&&"symbol"!=i&&"boolean"!=i&&null!=t&&!Zs(t))||(G.test(t)||!j.test(t)||null!=e&&t in dt(e))}function co(t){var e=Xr(t),i=Ii[e];if("function"!=typeof i||!(e in Ti.prototype))return!1;if(t===i)return!0;var n=qr(i);return!!n&&t===n[0]}(hi&&no(new hi(new ArrayBuffer(1)))!=b||pi&&no(new pi)!=f||di&&"[object Promise]"!=no(di.resolve())||fi&&no(new fi)!=v||gi&&no(new gi)!=C)&&(no=function(t){var e=dn(t),i=e==m?t.constructor:void 0,n=i?Io(i):"";if(n)switch(n){case _i:return b;case wi:return f;case Ci:return"[object Promise]";case Bi:return v;case bi:return C}return e});var uo=wt?ks:sA;function ho(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||_t)}function po(t){return t==t&&!Gs(t)}function fo(t,e){return function(i){return null!=i&&(i[t]===e&&(void 0!==e||t in dt(i)))}}function go(t,e,i){return e=si(void 0===e?t.length-1:e,0),function(){for(var r=arguments,o=-1,s=si(r.length-e,0),a=n(s);++o<s;)a[o]=r[e+o];o=-1;for(var A=n(e+1);++o<e;)A[o]=r[o];return A[e]=i(a),oe(t,this,A)}}function mo(t,e){return e.length<2?t:hn(t,zn(e,0,-1))}function yo(t,e){for(var i=t.length,n=ai(e.length,i),r=yr(t);n--;){var o=e[n];t[n]=ao(o,i)?r[o]:void 0}return t}function vo(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}var _o=bo(jn),wo=Ze||function(t,e){return Wt.setTimeout(t,e)},Co=bo(Gn);function Bo(t,e,i){var n=e+"";return Co(t,function(t,e){var i=e.length;if(!i)return t;var n=i-1;return e[n]=(i>1?"& ":"")+e[n],e=e.join(i>2?", ":" "),t.replace(Y,"{\n/* [wrapped with "+e+"] */\n")}(n,function(t,e){return ae(a,(function(i){var n="_."+i[0];e&i[1]&&!ue(t,n)&&t.push(n)})),t.sort()}(function(t){var e=t.match(J);return e?e[1].split(Z):[]}(n),i)))}function bo(t){var e=0,i=0;return function(){var n=Ai(),r=16-(n-i);if(i=n,r>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}function Eo(t,e){var i=-1,n=t.length,r=n-1;for(e=void 0===e?n:e;++i<e;){var o=Qn(i,r),s=t[o];t[o]=t[i],t[i]=s}return t.length=e,t}var So=function(t){var e=bs(t,(function(t){return 500===i.size&&i.clear(),t})),i=e.cache;return e}((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(K,(function(t,i,n,r){e.push(n?r.replace(et,"$1"):i||t)})),e}));function xo(t){if("string"==typeof t||Zs(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function Io(t){if(null!=t){try{return Ct.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function Fo(t){if(t instanceof Ti)return t.clone();var e=new Pi(t.__wrapped__,t.__chain__);return e.__actions__=yr(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}var Oo=Nn((function(t,e){return Qs(t)?$i(t,sn(e,1,Qs,!0)):[]})),Po=Nn((function(t,e){var i=Ho(e);return Qs(i)&&(i=void 0),Qs(t)?$i(t,sn(e,1,Qs,!0),Jr(i,2)):[]})),To=Nn((function(t,e){var i=Ho(e);return Qs(i)&&(i=void 0),Qs(t)?$i(t,sn(e,1,Qs,!0),void 0,i):[]}));function Lo(t,e,i){var n=null==t?0:t.length;if(!n)return-1;var r=null==i?0:ra(i);return r<0&&(r=si(n+r,0)),_e(t,Jr(e,3),r)}function Mo(t,e,i){var n=null==t?0:t.length;if(!n)return-1;var r=n-1;return void 0!==i&&(r=ra(i),r=i<0?si(n+r,0):ai(r,n-1)),_e(t,Jr(e,3),r,!0)}function Uo(t){return(null==t?0:t.length)?sn(t,1):[]}function Do(t){return t&&t.length?t[0]:void 0}var Qo=Nn((function(t){var e=pe(t,sr);return e.length&&e[0]===t[0]?yn(e):[]})),Ro=Nn((function(t){var e=Ho(t),i=pe(t,sr);return e===Ho(i)?e=void 0:i.pop(),i.length&&i[0]===t[0]?yn(i,Jr(e,2)):[]})),No=Nn((function(t){var e=Ho(t),i=pe(t,sr);return(e="function"==typeof e?e:void 0)&&i.pop(),i.length&&i[0]===t[0]?yn(i,void 0,e):[]}));function Ho(t){var e=null==t?0:t.length;return e?t[e-1]:void 0}var ko=Nn(Vo);function Vo(t,e){return t&&t.length&&e&&e.length?Un(t,e):t}var jo=Kr((function(t,e){var i=null==t?0:t.length,n=qi(t,e);return Dn(t,pe(e,(function(t){return ao(t,i)?+t:t})).sort(fr)),n}));function Go(t){return null==t?t:ui.call(t)}var Ko=Nn((function(t){return $n(sn(t,1,Qs,!0))})),zo=Nn((function(t){var e=Ho(t);return Qs(e)&&(e=void 0),$n(sn(t,1,Qs,!0),Jr(e,2))})),Wo=Nn((function(t){var e=Ho(t);return e="function"==typeof e?e:void 0,$n(sn(t,1,Qs,!0),void 0,e)}));function qo(t){if(!t||!t.length)return[];var e=0;return t=ce(t,(function(t){if(Qs(t))return e=si(t.length,e),!0})),Fe(e,(function(e){return pe(t,Ee(e))}))}function Xo(t,e){if(!t||!t.length)return[];var i=qo(t);return null==e?i:pe(i,(function(t){return oe(e,void 0,t)}))}var Yo=Nn((function(t,e){return Qs(t)?$i(t,e):[]})),Jo=Nn((function(t){return rr(ce(t,Qs))})),Zo=Nn((function(t){var e=Ho(t);return Qs(e)&&(e=void 0),rr(ce(t,Qs),Jr(e,2))})),$o=Nn((function(t){var e=Ho(t);return e="function"==typeof e?e:void 0,rr(ce(t,Qs),void 0,e)})),ts=Nn(qo);var es=Nn((function(t){var e=t.length,i=e>1?t[e-1]:void 0;return i="function"==typeof i?(t.pop(),i):void 0,Xo(t,i)}));function is(t){var e=Ii(t);return e.__chain__=!0,e}function ns(t,e){return e(t)}var rs=Kr((function(t){var e=t.length,i=e?t[0]:0,n=this.__wrapped__,r=function(e){return qi(e,t)};return!(e>1||this.__actions__.length)&&n instanceof Ti&&ao(i)?((n=n.slice(i,+i+(e?1:0))).__actions__.push({func:ns,args:[r],thisArg:void 0}),new Pi(n,this.__chain__).thru((function(t){return e&&!t.length&&t.push(void 0),t}))):this.thru(r)}));var os=_r((function(t,e,i){Bt.call(t,i)?++t[i]:Wi(t,i,1)}));var ss=xr(Lo),as=xr(Mo);function As(t,e){return(Ms(t)?ae:tn)(t,Jr(e,3))}function ls(t,e){return(Ms(t)?Ae:en)(t,Jr(e,3))}var cs=_r((function(t,e,i){Bt.call(t,i)?t[i].push(e):Wi(t,i,[e])}));var us=Nn((function(t,e,i){var r=-1,o="function"==typeof e,s=Ds(t)?n(t.length):[];return tn(t,(function(t){s[++r]=o?oe(e,t,i):vn(t,e,i)})),s})),hs=_r((function(t,e,i){Wi(t,i,e)}));function ps(t,e){return(Ms(t)?pe:In)(t,Jr(e,3))}var ds=_r((function(t,e,i){t[i?0:1].push(e)}),(function(){return[[],[]]}));var fs=Nn((function(t,e){if(null==t)return[];var i=e.length;return i>1&&Ao(t,e[0],e[1])?e=[]:i>2&&Ao(e[0],e[1],e[2])&&(e=[e[0]]),Ln(t,sn(e,1),[])})),gs=Je||function(){return Wt.Date.now()};function ms(t,e,i){return e=i?void 0:e,Hr(t,128,void 0,void 0,void 0,void 0,e=t&&null==e?t.length:e)}function ys(t,e){var i;if("function"!=typeof e)throw new mt(o);return t=ra(t),function(){return--t>0&&(i=e.apply(this,arguments)),t<=1&&(e=void 0),i}}var vs=Nn((function(t,e,i){var n=1;if(i.length){var r=je(i,Yr(vs));n|=32}return Hr(t,n,e,i,r)})),_s=Nn((function(t,e,i){var n=3;if(i.length){var r=je(i,Yr(_s));n|=32}return Hr(e,n,t,i,r)}));function ws(t,e,i){var n,r,s,a,A,l,c=0,u=!1,h=!1,p=!0;if("function"!=typeof t)throw new mt(o);function d(e){var i=n,o=r;return n=r=void 0,c=e,a=t.apply(o,i)}function f(t){return c=t,A=wo(m,e),u?d(t):a}function g(t){var i=t-l;return void 0===l||i>=e||i<0||h&&t-c>=s}function m(){var t=gs();if(g(t))return y(t);A=wo(m,function(t){var i=e-(t-l);return h?ai(i,s-(t-c)):i}(t))}function y(t){return A=void 0,p&&n?d(t):(n=r=void 0,a)}function v(){var t=gs(),i=g(t);if(n=arguments,r=this,l=t,i){if(void 0===A)return f(l);if(h)return ur(A),A=wo(m,e),d(l)}return void 0===A&&(A=wo(m,e)),a}return e=sa(e)||0,Gs(i)&&(u=!!i.leading,s=(h="maxWait"in i)?si(sa(i.maxWait)||0,e):s,p="trailing"in i?!!i.trailing:p),v.cancel=function(){void 0!==A&&ur(A),c=0,n=l=r=A=void 0},v.flush=function(){return void 0===A?a:y(gs())},v}var Cs=Nn((function(t,e){return Zi(t,1,e)})),Bs=Nn((function(t,e,i){return Zi(t,sa(e)||0,i)}));function bs(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new mt(o);var i=function(){var n=arguments,r=e?e.apply(this,n):n[0],o=i.cache;if(o.has(r))return o.get(r);var s=t.apply(this,n);return i.cache=o.set(r,s)||o,s};return i.cache=new(bs.Cache||Ui),i}function Es(t){if("function"!=typeof t)throw new mt(o);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}bs.Cache=Ui;var Ss=lr((function(t,e){var i=(e=1==e.length&&Ms(e[0])?pe(e[0],Pe(Jr())):pe(sn(e,1),Pe(Jr()))).length;return Nn((function(n){for(var r=-1,o=ai(n.length,i);++r<o;)n[r]=e[r].call(this,n[r]);return oe(t,this,n)}))})),xs=Nn((function(t,e){return Hr(t,32,void 0,e,je(e,Yr(xs)))})),Is=Nn((function(t,e){return Hr(t,64,void 0,e,je(e,Yr(Is)))})),Fs=Kr((function(t,e){return Hr(t,256,void 0,void 0,void 0,e)}));function Os(t,e){return t===e||t!=t&&e!=e}var Ps=Ur(fn),Ts=Ur((function(t,e){return t>=e})),Ls=_n(function(){return arguments}())?_n:function(t){return Ks(t)&&Bt.call(t,"callee")&&!zt.call(t,"callee")},Ms=n.isArray,Us=$t?Pe($t):function(t){return Ks(t)&&dn(t)==B};function Ds(t){return null!=t&&js(t.length)&&!ks(t)}function Qs(t){return Ks(t)&&Ds(t)}var Rs=ii||sA,Ns=te?Pe(te):function(t){return Ks(t)&&dn(t)==u};function Hs(t){if(!Ks(t))return!1;var e=dn(t);return e==h||"[object DOMException]"==e||"string"==typeof t.message&&"string"==typeof t.name&&!qs(t)}function ks(t){if(!Gs(t))return!1;var e=dn(t);return e==p||e==d||"[object AsyncFunction]"==e||"[object Proxy]"==e}function Vs(t){return"number"==typeof t&&t==ra(t)}function js(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}function Gs(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function Ks(t){return null!=t&&"object"==typeof t}var zs=ee?Pe(ee):function(t){return Ks(t)&&no(t)==f};function Ws(t){return"number"==typeof t||Ks(t)&&dn(t)==g}function qs(t){if(!Ks(t)||dn(t)!=m)return!1;var e=Vt(t);if(null===e)return!0;var i=Bt.call(e,"constructor")&&e.constructor;return"function"==typeof i&&i instanceof i&&Ct.call(i)==xt}var Xs=ie?Pe(ie):function(t){return Ks(t)&&dn(t)==y};var Ys=ne?Pe(ne):function(t){return Ks(t)&&no(t)==v};function Js(t){return"string"==typeof t||!Ms(t)&&Ks(t)&&dn(t)==_}function Zs(t){return"symbol"==typeof t||Ks(t)&&dn(t)==w}var $s=re?Pe(re):function(t){return Ks(t)&&js(t.length)&&!!Ht[dn(t)]};var ta=Ur(xn),ea=Ur((function(t,e){return t<=e}));function ia(t){if(!t)return[];if(Ds(t))return Js(t)?We(t):yr(t);if(Jt&&t[Jt])return function(t){for(var e,i=[];!(e=t.next()).done;)i.push(e.value);return i}(t[Jt]());var e=no(t);return(e==f?ke:e==v?Ge:Oa)(t)}function na(t){return t?(t=sa(t))===1/0||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0}function ra(t){var e=na(t),i=e%1;return e==e?i?e-i:e:0}function oa(t){return t?Xi(ra(t),0,4294967295):0}function sa(t){if("number"==typeof t)return t;if(Zs(t))return NaN;if(Gs(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=Gs(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=Oe(t);var i=ot.test(t);return i||at.test(t)?Gt(t.slice(2),i?2:8):rt.test(t)?NaN:+t}function aa(t){return vr(t,Ca(t))}function Aa(t){return null==t?"":Zn(t)}var la=wr((function(t,e){if(ho(e)||Ds(e))vr(e,wa(e),t);else for(var i in e)Bt.call(e,i)&&ji(t,i,e[i])})),ca=wr((function(t,e){vr(e,Ca(e),t)})),ua=wr((function(t,e,i,n){vr(e,Ca(e),t,n)})),ha=wr((function(t,e,i,n){vr(e,wa(e),t,n)})),pa=Kr(qi);var da=Nn((function(t,e){t=dt(t);var i=-1,n=e.length,r=n>2?e[2]:void 0;for(r&&Ao(e[0],e[1],r)&&(n=1);++i<n;)for(var o=e[i],s=Ca(o),a=-1,A=s.length;++a<A;){var l=s[a],c=t[l];(void 0===c||Os(c,_t[l])&&!Bt.call(t,l))&&(t[l]=o[l])}return t})),fa=Nn((function(t){return t.push(void 0,Vr),oe(ba,void 0,t)}));function ga(t,e,i){var n=null==t?void 0:hn(t,e);return void 0===n?i:n}function ma(t,e){return null!=t&&ro(t,e,mn)}var ya=Or((function(t,e,i){null!=e&&"function"!=typeof e.toString&&(e=St.call(e)),t[e]=i}),Ga(Wa)),va=Or((function(t,e,i){null!=e&&"function"!=typeof e.toString&&(e=St.call(e)),Bt.call(t,e)?t[e].push(i):t[e]=[i]}),Jr),_a=Nn(vn);function wa(t){return Ds(t)?Ri(t):En(t)}function Ca(t){return Ds(t)?Ri(t,!0):Sn(t)}var Ba=wr((function(t,e,i){Pn(t,e,i)})),ba=wr((function(t,e,i,n){Pn(t,e,i,n)})),Ea=Kr((function(t,e){var i={};if(null==t)return i;var n=!1;e=pe(e,(function(e){return e=Ar(e,t),n||(n=e.length>1),e})),vr(t,Wr(t),i),n&&(i=Yi(i,7,jr));for(var r=e.length;r--;)tr(i,e[r]);return i}));var Sa=Kr((function(t,e){return null==t?{}:function(t,e){return Mn(t,e,(function(e,i){return ma(t,i)}))}(t,e)}));function xa(t,e){if(null==t)return{};var i=pe(Wr(t),(function(t){return[t]}));return e=Jr(e),Mn(t,i,(function(t,i){return e(t,i[0])}))}var Ia=Nr(wa),Fa=Nr(Ca);function Oa(t){return null==t?[]:Te(t,wa(t))}var Pa=Er((function(t,e,i){return e=e.toLowerCase(),t+(i?Ta(e):e)}));function Ta(t){return Ha(Aa(t).toLowerCase())}function La(t){return(t=Aa(t))&&t.replace(lt,Qe).replace(Lt,"")}var Ma=Er((function(t,e,i){return t+(i?"-":"")+e.toLowerCase()})),Ua=Er((function(t,e,i){return t+(i?" ":"")+e.toLowerCase()})),Da=br("toLowerCase");var Qa=Er((function(t,e,i){return t+(i?"_":"")+e.toLowerCase()}));var Ra=Er((function(t,e,i){return t+(i?" ":"")+Ha(e)}));var Na=Er((function(t,e,i){return t+(i?" ":"")+e.toUpperCase()})),Ha=br("toUpperCase");function ka(t,e,i){return t=Aa(t),void 0===(e=i?void 0:e)?function(t){return Qt.test(t)}(t)?function(t){return t.match(Ut)||[]}(t):function(t){return t.match($)||[]}(t):t.match(e)||[]}var Va=Nn((function(t,e){try{return oe(t,void 0,e)}catch(t){return Hs(t)?t:new X(t)}})),ja=Kr((function(t,e){return ae(e,(function(e){e=xo(e),Wi(t,e,vs(t[e],t))})),t}));function Ga(t){return function(){return t}}var Ka=Ir(),za=Ir(!0);function Wa(t){return t}function qa(t){return bn("function"==typeof t?t:Yi(t,1))}var Xa=Nn((function(t,e){return function(i){return vn(i,t,e)}})),Ya=Nn((function(t,e){return function(i){return vn(t,i,e)}}));function Ja(t,e,i){var n=wa(e),r=un(e,n);null!=i||Gs(e)&&(r.length||!n.length)||(i=e,e=t,t=this,r=un(e,wa(e)));var o=!(Gs(i)&&"chain"in i&&!i.chain),s=ks(t);return ae(r,(function(i){var n=e[i];t[i]=n,s&&(t.prototype[i]=function(){var e=this.__chain__;if(o||e){var i=t(this.__wrapped__),r=i.__actions__=yr(this.__actions__);return r.push({func:n,args:arguments,thisArg:t}),i.__chain__=e,i}return n.apply(t,de([this.value()],arguments))})})),t}function Za(){}var $a=Tr(pe),tA=Tr(le),eA=Tr(me);function iA(t){return lo(t)?Ee(xo(t)):function(t){return function(e){return hn(e,t)}}(t)}var nA=Mr(),rA=Mr(!0);function oA(){return[]}function sA(){return!1}var aA=Pr((function(t,e){return t+e}),0),AA=Qr("ceil"),lA=Pr((function(t,e){return t/e}),1),cA=Qr("floor");var uA,hA=Pr((function(t,e){return t*e}),1),pA=Qr("round"),dA=Pr((function(t,e){return t-e}),0);return Ii.after=function(t,e){if("function"!=typeof e)throw new mt(o);return t=ra(t),function(){if(--t<1)return e.apply(this,arguments)}},Ii.ary=ms,Ii.assign=la,Ii.assignIn=ca,Ii.assignInWith=ua,Ii.assignWith=ha,Ii.at=pa,Ii.before=ys,Ii.bind=vs,Ii.bindAll=ja,Ii.bindKey=_s,Ii.castArray=function(){if(!arguments.length)return[];var t=arguments[0];return Ms(t)?t:[t]},Ii.chain=is,Ii.chunk=function(t,e,i){e=(i?Ao(t,e,i):void 0===e)?1:si(ra(e),0);var r=null==t?0:t.length;if(!r||e<1)return[];for(var o=0,s=0,a=n($e(r/e));o<r;)a[s++]=zn(t,o,o+=e);return a},Ii.compact=function(t){for(var e=-1,i=null==t?0:t.length,n=0,r=[];++e<i;){var o=t[e];o&&(r[n++]=o)}return r},Ii.concat=function(){var t=arguments.length;if(!t)return[];for(var e=n(t-1),i=arguments[0],r=t;r--;)e[r-1]=arguments[r];return de(Ms(i)?yr(i):[i],sn(e,1))},Ii.cond=function(t){var e=null==t?0:t.length,i=Jr();return t=e?pe(t,(function(t){if("function"!=typeof t[1])throw new mt(o);return[i(t[0]),t[1]]})):[],Nn((function(i){for(var n=-1;++n<e;){var r=t[n];if(oe(r[0],this,i))return oe(r[1],this,i)}}))},Ii.conforms=function(t){return function(t){var e=wa(t);return function(i){return Ji(i,t,e)}}(Yi(t,1))},Ii.constant=Ga,Ii.countBy=os,Ii.create=function(t,e){var i=Fi(t);return null==e?i:zi(i,e)},Ii.curry=function t(e,i,n){var r=Hr(e,8,void 0,void 0,void 0,void 0,void 0,i=n?void 0:i);return r.placeholder=t.placeholder,r},Ii.curryRight=function t(e,i,n){var r=Hr(e,16,void 0,void 0,void 0,void 0,void 0,i=n?void 0:i);return r.placeholder=t.placeholder,r},Ii.debounce=ws,Ii.defaults=da,Ii.defaultsDeep=fa,Ii.defer=Cs,Ii.delay=Bs,Ii.difference=Oo,Ii.differenceBy=Po,Ii.differenceWith=To,Ii.drop=function(t,e,i){var n=null==t?0:t.length;return n?zn(t,(e=i||void 0===e?1:ra(e))<0?0:e,n):[]},Ii.dropRight=function(t,e,i){var n=null==t?0:t.length;return n?zn(t,0,(e=n-(e=i||void 0===e?1:ra(e)))<0?0:e):[]},Ii.dropRightWhile=function(t,e){return t&&t.length?ir(t,Jr(e,3),!0,!0):[]},Ii.dropWhile=function(t,e){return t&&t.length?ir(t,Jr(e,3),!0):[]},Ii.fill=function(t,e,i,n){var r=null==t?0:t.length;return r?(i&&"number"!=typeof i&&Ao(t,e,i)&&(i=0,n=r),function(t,e,i,n){var r=t.length;for((i=ra(i))<0&&(i=-i>r?0:r+i),(n=void 0===n||n>r?r:ra(n))<0&&(n+=r),n=i>n?0:oa(n);i<n;)t[i++]=e;return t}(t,e,i,n)):[]},Ii.filter=function(t,e){return(Ms(t)?ce:on)(t,Jr(e,3))},Ii.flatMap=function(t,e){return sn(ps(t,e),1)},Ii.flatMapDeep=function(t,e){return sn(ps(t,e),1/0)},Ii.flatMapDepth=function(t,e,i){return i=void 0===i?1:ra(i),sn(ps(t,e),i)},Ii.flatten=Uo,Ii.flattenDeep=function(t){return(null==t?0:t.length)?sn(t,1/0):[]},Ii.flattenDepth=function(t,e){return(null==t?0:t.length)?sn(t,e=void 0===e?1:ra(e)):[]},Ii.flip=function(t){return Hr(t,512)},Ii.flow=Ka,Ii.flowRight=za,Ii.fromPairs=function(t){for(var e=-1,i=null==t?0:t.length,n={};++e<i;){var r=t[e];n[r[0]]=r[1]}return n},Ii.functions=function(t){return null==t?[]:un(t,wa(t))},Ii.functionsIn=function(t){return null==t?[]:un(t,Ca(t))},Ii.groupBy=cs,Ii.initial=function(t){return(null==t?0:t.length)?zn(t,0,-1):[]},Ii.intersection=Qo,Ii.intersectionBy=Ro,Ii.intersectionWith=No,Ii.invert=ya,Ii.invertBy=va,Ii.invokeMap=us,Ii.iteratee=qa,Ii.keyBy=hs,Ii.keys=wa,Ii.keysIn=Ca,Ii.map=ps,Ii.mapKeys=function(t,e){var i={};return e=Jr(e,3),ln(t,(function(t,n,r){Wi(i,e(t,n,r),t)})),i},Ii.mapValues=function(t,e){var i={};return e=Jr(e,3),ln(t,(function(t,n,r){Wi(i,n,e(t,n,r))})),i},Ii.matches=function(t){return Fn(Yi(t,1))},Ii.matchesProperty=function(t,e){return On(t,Yi(e,1))},Ii.memoize=bs,Ii.merge=Ba,Ii.mergeWith=ba,Ii.method=Xa,Ii.methodOf=Ya,Ii.mixin=Ja,Ii.negate=Es,Ii.nthArg=function(t){return t=ra(t),Nn((function(e){return Tn(e,t)}))},Ii.omit=Ea,Ii.omitBy=function(t,e){return xa(t,Es(Jr(e)))},Ii.once=function(t){return ys(2,t)},Ii.orderBy=function(t,e,i,n){return null==t?[]:(Ms(e)||(e=null==e?[]:[e]),Ms(i=n?void 0:i)||(i=null==i?[]:[i]),Ln(t,e,i))},Ii.over=$a,Ii.overArgs=Ss,Ii.overEvery=tA,Ii.overSome=eA,Ii.partial=xs,Ii.partialRight=Is,Ii.partition=ds,Ii.pick=Sa,Ii.pickBy=xa,Ii.property=iA,Ii.propertyOf=function(t){return function(e){return null==t?void 0:hn(t,e)}},Ii.pull=ko,Ii.pullAll=Vo,Ii.pullAllBy=function(t,e,i){return t&&t.length&&e&&e.length?Un(t,e,Jr(i,2)):t},Ii.pullAllWith=function(t,e,i){return t&&t.length&&e&&e.length?Un(t,e,void 0,i):t},Ii.pullAt=jo,Ii.range=nA,Ii.rangeRight=rA,Ii.rearg=Fs,Ii.reject=function(t,e){return(Ms(t)?ce:on)(t,Es(Jr(e,3)))},Ii.remove=function(t,e){var i=[];if(!t||!t.length)return i;var n=-1,r=[],o=t.length;for(e=Jr(e,3);++n<o;){var s=t[n];e(s,n,t)&&(i.push(s),r.push(n))}return Dn(t,r),i},Ii.rest=function(t,e){if("function"!=typeof t)throw new mt(o);return Nn(t,e=void 0===e?e:ra(e))},Ii.reverse=Go,Ii.sampleSize=function(t,e,i){return e=(i?Ao(t,e,i):void 0===e)?1:ra(e),(Ms(t)?Hi:kn)(t,e)},Ii.set=function(t,e,i){return null==t?t:Vn(t,e,i)},Ii.setWith=function(t,e,i,n){return n="function"==typeof n?n:void 0,null==t?t:Vn(t,e,i,n)},Ii.shuffle=function(t){return(Ms(t)?ki:Kn)(t)},Ii.slice=function(t,e,i){var n=null==t?0:t.length;return n?(i&&"number"!=typeof i&&Ao(t,e,i)?(e=0,i=n):(e=null==e?0:ra(e),i=void 0===i?n:ra(i)),zn(t,e,i)):[]},Ii.sortBy=fs,Ii.sortedUniq=function(t){return t&&t.length?Yn(t):[]},Ii.sortedUniqBy=function(t,e){return t&&t.length?Yn(t,Jr(e,2)):[]},Ii.split=function(t,e,i){return i&&"number"!=typeof i&&Ao(t,e,i)&&(e=i=void 0),(i=void 0===i?4294967295:i>>>0)?(t=Aa(t))&&("string"==typeof e||null!=e&&!Xs(e))&&!(e=Zn(e))&&He(t)?cr(We(t),0,i):t.split(e,i):[]},Ii.spread=function(t,e){if("function"!=typeof t)throw new mt(o);return e=null==e?0:si(ra(e),0),Nn((function(i){var n=i[e],r=cr(i,0,e);return n&&de(r,n),oe(t,this,r)}))},Ii.tail=function(t){var e=null==t?0:t.length;return e?zn(t,1,e):[]},Ii.take=function(t,e,i){return t&&t.length?zn(t,0,(e=i||void 0===e?1:ra(e))<0?0:e):[]},Ii.takeRight=function(t,e,i){var n=null==t?0:t.length;return n?zn(t,(e=n-(e=i||void 0===e?1:ra(e)))<0?0:e,n):[]},Ii.takeRightWhile=function(t,e){return t&&t.length?ir(t,Jr(e,3),!1,!0):[]},Ii.takeWhile=function(t,e){return t&&t.length?ir(t,Jr(e,3)):[]},Ii.tap=function(t,e){return e(t),t},Ii.throttle=function(t,e,i){var n=!0,r=!0;if("function"!=typeof t)throw new mt(o);return Gs(i)&&(n="leading"in i?!!i.leading:n,r="trailing"in i?!!i.trailing:r),ws(t,e,{leading:n,maxWait:e,trailing:r})},Ii.thru=ns,Ii.toArray=ia,Ii.toPairs=Ia,Ii.toPairsIn=Fa,Ii.toPath=function(t){return Ms(t)?pe(t,xo):Zs(t)?[t]:yr(So(Aa(t)))},Ii.toPlainObject=aa,Ii.transform=function(t,e,i){var n=Ms(t),r=n||Rs(t)||$s(t);if(e=Jr(e,4),null==i){var o=t&&t.constructor;i=r?n?new o:[]:Gs(t)&&ks(o)?Fi(Vt(t)):{}}return(r?ae:ln)(t,(function(t,n,r){return e(i,t,n,r)})),i},Ii.unary=function(t){return ms(t,1)},Ii.union=Ko,Ii.unionBy=zo,Ii.unionWith=Wo,Ii.uniq=function(t){return t&&t.length?$n(t):[]},Ii.uniqBy=function(t,e){return t&&t.length?$n(t,Jr(e,2)):[]},Ii.uniqWith=function(t,e){return e="function"==typeof e?e:void 0,t&&t.length?$n(t,void 0,e):[]},Ii.unset=function(t,e){return null==t||tr(t,e)},Ii.unzip=qo,Ii.unzipWith=Xo,Ii.update=function(t,e,i){return null==t?t:er(t,e,ar(i))},Ii.updateWith=function(t,e,i,n){return n="function"==typeof n?n:void 0,null==t?t:er(t,e,ar(i),n)},Ii.values=Oa,Ii.valuesIn=function(t){return null==t?[]:Te(t,Ca(t))},Ii.without=Yo,Ii.words=ka,Ii.wrap=function(t,e){return xs(ar(e),t)},Ii.xor=Jo,Ii.xorBy=Zo,Ii.xorWith=$o,Ii.zip=ts,Ii.zipObject=function(t,e){return or(t||[],e||[],ji)},Ii.zipObjectDeep=function(t,e){return or(t||[],e||[],Vn)},Ii.zipWith=es,Ii.entries=Ia,Ii.entriesIn=Fa,Ii.extend=ca,Ii.extendWith=ua,Ja(Ii,Ii),Ii.add=aA,Ii.attempt=Va,Ii.camelCase=Pa,Ii.capitalize=Ta,Ii.ceil=AA,Ii.clamp=function(t,e,i){return void 0===i&&(i=e,e=void 0),void 0!==i&&(i=(i=sa(i))==i?i:0),void 0!==e&&(e=(e=sa(e))==e?e:0),Xi(sa(t),e,i)},Ii.clone=function(t){return Yi(t,4)},Ii.cloneDeep=function(t){return Yi(t,5)},Ii.cloneDeepWith=function(t,e){return Yi(t,5,e="function"==typeof e?e:void 0)},Ii.cloneWith=function(t,e){return Yi(t,4,e="function"==typeof e?e:void 0)},Ii.conformsTo=function(t,e){return null==e||Ji(t,e,wa(e))},Ii.deburr=La,Ii.defaultTo=function(t,e){return null==t||t!=t?e:t},Ii.divide=lA,Ii.endsWith=function(t,e,i){t=Aa(t),e=Zn(e);var n=t.length,r=i=void 0===i?n:Xi(ra(i),0,n);return(i-=e.length)>=0&&t.slice(i,r)==e},Ii.eq=Os,Ii.escape=function(t){return(t=Aa(t))&&N.test(t)?t.replace(Q,Re):t},Ii.escapeRegExp=function(t){return(t=Aa(t))&&W.test(t)?t.replace(z,"\\$&"):t},Ii.every=function(t,e,i){var n=Ms(t)?le:nn;return i&&Ao(t,e,i)&&(e=void 0),n(t,Jr(e,3))},Ii.find=ss,Ii.findIndex=Lo,Ii.findKey=function(t,e){return ve(t,Jr(e,3),ln)},Ii.findLast=as,Ii.findLastIndex=Mo,Ii.findLastKey=function(t,e){return ve(t,Jr(e,3),cn)},Ii.floor=cA,Ii.forEach=As,Ii.forEachRight=ls,Ii.forIn=function(t,e){return null==t?t:an(t,Jr(e,3),Ca)},Ii.forInRight=function(t,e){return null==t?t:An(t,Jr(e,3),Ca)},Ii.forOwn=function(t,e){return t&&ln(t,Jr(e,3))},Ii.forOwnRight=function(t,e){return t&&cn(t,Jr(e,3))},Ii.get=ga,Ii.gt=Ps,Ii.gte=Ts,Ii.has=function(t,e){return null!=t&&ro(t,e,gn)},Ii.hasIn=ma,Ii.head=Do,Ii.identity=Wa,Ii.includes=function(t,e,i,n){t=Ds(t)?t:Oa(t),i=i&&!n?ra(i):0;var r=t.length;return i<0&&(i=si(r+i,0)),Js(t)?i<=r&&t.indexOf(e,i)>-1:!!r&&we(t,e,i)>-1},Ii.indexOf=function(t,e,i){var n=null==t?0:t.length;if(!n)return-1;var r=null==i?0:ra(i);return r<0&&(r=si(n+r,0)),we(t,e,r)},Ii.inRange=function(t,e,i){return e=na(e),void 0===i?(i=e,e=0):i=na(i),function(t,e,i){return t>=ai(e,i)&&t<si(e,i)}(t=sa(t),e,i)},Ii.invoke=_a,Ii.isArguments=Ls,Ii.isArray=Ms,Ii.isArrayBuffer=Us,Ii.isArrayLike=Ds,Ii.isArrayLikeObject=Qs,Ii.isBoolean=function(t){return!0===t||!1===t||Ks(t)&&dn(t)==c},Ii.isBuffer=Rs,Ii.isDate=Ns,Ii.isElement=function(t){return Ks(t)&&1===t.nodeType&&!qs(t)},Ii.isEmpty=function(t){if(null==t)return!0;if(Ds(t)&&(Ms(t)||"string"==typeof t||"function"==typeof t.splice||Rs(t)||$s(t)||Ls(t)))return!t.length;var e=no(t);if(e==f||e==v)return!t.size;if(ho(t))return!En(t).length;for(var i in t)if(Bt.call(t,i))return!1;return!0},Ii.isEqual=function(t,e){return wn(t,e)},Ii.isEqualWith=function(t,e,i){var n=(i="function"==typeof i?i:void 0)?i(t,e):void 0;return void 0===n?wn(t,e,void 0,i):!!n},Ii.isError=Hs,Ii.isFinite=function(t){return"number"==typeof t&&ni(t)},Ii.isFunction=ks,Ii.isInteger=Vs,Ii.isLength=js,Ii.isMap=zs,Ii.isMatch=function(t,e){return t===e||Cn(t,e,$r(e))},Ii.isMatchWith=function(t,e,i){return i="function"==typeof i?i:void 0,Cn(t,e,$r(e),i)},Ii.isNaN=function(t){return Ws(t)&&t!=+t},Ii.isNative=function(t){if(uo(t))throw new X("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Bn(t)},Ii.isNil=function(t){return null==t},Ii.isNull=function(t){return null===t},Ii.isNumber=Ws,Ii.isObject=Gs,Ii.isObjectLike=Ks,Ii.isPlainObject=qs,Ii.isRegExp=Xs,Ii.isSafeInteger=function(t){return Vs(t)&&t>=-9007199254740991&&t<=9007199254740991},Ii.isSet=Ys,Ii.isString=Js,Ii.isSymbol=Zs,Ii.isTypedArray=$s,Ii.isUndefined=function(t){return void 0===t},Ii.isWeakMap=function(t){return Ks(t)&&no(t)==C},Ii.isWeakSet=function(t){return Ks(t)&&"[object WeakSet]"==dn(t)},Ii.join=function(t,e){return null==t?"":ri.call(t,e)},Ii.kebabCase=Ma,Ii.last=Ho,Ii.lastIndexOf=function(t,e,i){var n=null==t?0:t.length;if(!n)return-1;var r=n;return void 0!==i&&(r=(r=ra(i))<0?si(n+r,0):ai(r,n-1)),e==e?function(t,e,i){for(var n=i+1;n--;)if(t[n]===e)return n;return n}(t,e,r):_e(t,Be,r,!0)},Ii.lowerCase=Ua,Ii.lowerFirst=Da,Ii.lt=ta,Ii.lte=ea,Ii.max=function(t){return t&&t.length?rn(t,Wa,fn):void 0},Ii.maxBy=function(t,e){return t&&t.length?rn(t,Jr(e,2),fn):void 0},Ii.mean=function(t){return be(t,Wa)},Ii.meanBy=function(t,e){return be(t,Jr(e,2))},Ii.min=function(t){return t&&t.length?rn(t,Wa,xn):void 0},Ii.minBy=function(t,e){return t&&t.length?rn(t,Jr(e,2),xn):void 0},Ii.stubArray=oA,Ii.stubFalse=sA,Ii.stubObject=function(){return{}},Ii.stubString=function(){return""},Ii.stubTrue=function(){return!0},Ii.multiply=hA,Ii.nth=function(t,e){return t&&t.length?Tn(t,ra(e)):void 0},Ii.noConflict=function(){return Wt._===this&&(Wt._=It),this},Ii.noop=Za,Ii.now=gs,Ii.pad=function(t,e,i){t=Aa(t);var n=(e=ra(e))?ze(t):0;if(!e||n>=e)return t;var r=(e-n)/2;return Lr(ti(r),i)+t+Lr($e(r),i)},Ii.padEnd=function(t,e,i){t=Aa(t);var n=(e=ra(e))?ze(t):0;return e&&n<e?t+Lr(e-n,i):t},Ii.padStart=function(t,e,i){t=Aa(t);var n=(e=ra(e))?ze(t):0;return e&&n<e?Lr(e-n,i)+t:t},Ii.parseInt=function(t,e,i){return i||null==e?e=0:e&&(e=+e),li(Aa(t).replace(q,""),e||0)},Ii.random=function(t,e,i){if(i&&"boolean"!=typeof i&&Ao(t,e,i)&&(e=i=void 0),void 0===i&&("boolean"==typeof e?(i=e,e=void 0):"boolean"==typeof t&&(i=t,t=void 0)),void 0===t&&void 0===e?(t=0,e=1):(t=na(t),void 0===e?(e=t,t=0):e=na(e)),t>e){var n=t;t=e,e=n}if(i||t%1||e%1){var r=ci();return ai(t+r*(e-t+jt("1e-"+((r+"").length-1))),e)}return Qn(t,e)},Ii.reduce=function(t,e,i){var n=Ms(t)?fe:xe,r=arguments.length<3;return n(t,Jr(e,4),i,r,tn)},Ii.reduceRight=function(t,e,i){var n=Ms(t)?ge:xe,r=arguments.length<3;return n(t,Jr(e,4),i,r,en)},Ii.repeat=function(t,e,i){return e=(i?Ao(t,e,i):void 0===e)?1:ra(e),Rn(Aa(t),e)},Ii.replace=function(){var t=arguments,e=Aa(t[0]);return t.length<3?e:e.replace(t[1],t[2])},Ii.result=function(t,e,i){var n=-1,r=(e=Ar(e,t)).length;for(r||(r=1,t=void 0);++n<r;){var o=null==t?void 0:t[xo(e[n])];void 0===o&&(n=r,o=i),t=ks(o)?o.call(t):o}return t},Ii.round=pA,Ii.runInContext=t,Ii.sample=function(t){return(Ms(t)?Ni:Hn)(t)},Ii.size=function(t){if(null==t)return 0;if(Ds(t))return Js(t)?ze(t):t.length;var e=no(t);return e==f||e==v?t.size:En(t).length},Ii.snakeCase=Qa,Ii.some=function(t,e,i){var n=Ms(t)?me:Wn;return i&&Ao(t,e,i)&&(e=void 0),n(t,Jr(e,3))},Ii.sortedIndex=function(t,e){return qn(t,e)},Ii.sortedIndexBy=function(t,e,i){return Xn(t,e,Jr(i,2))},Ii.sortedIndexOf=function(t,e){var i=null==t?0:t.length;if(i){var n=qn(t,e);if(n<i&&Os(t[n],e))return n}return-1},Ii.sortedLastIndex=function(t,e){return qn(t,e,!0)},Ii.sortedLastIndexBy=function(t,e,i){return Xn(t,e,Jr(i,2),!0)},Ii.sortedLastIndexOf=function(t,e){if(null==t?0:t.length){var i=qn(t,e,!0)-1;if(Os(t[i],e))return i}return-1},Ii.startCase=Ra,Ii.startsWith=function(t,e,i){return t=Aa(t),i=null==i?0:Xi(ra(i),0,t.length),e=Zn(e),t.slice(i,i+e.length)==e},Ii.subtract=dA,Ii.sum=function(t){return t&&t.length?Ie(t,Wa):0},Ii.sumBy=function(t,e){return t&&t.length?Ie(t,Jr(e,2)):0},Ii.template=function(t,e,i){var n=Ii.templateSettings;i&&Ao(t,e,i)&&(e=void 0),t=Aa(t),e=ua({},e,n,kr);var r,o,s=ua({},e.imports,n.imports,kr),a=wa(s),A=Te(s,a),l=0,c=e.interpolate||ct,u="__p += '",h=ft((e.escape||ct).source+"|"+c.source+"|"+(c===V?it:ct).source+"|"+(e.evaluate||ct).source+"|$","g"),p="//# sourceURL="+(Bt.call(e,"sourceURL")?(e.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Nt+"]")+"\n";t.replace(h,(function(e,i,n,s,a,A){return n||(n=s),u+=t.slice(l,A).replace(ut,Ne),i&&(r=!0,u+="' +\n__e("+i+") +\n'"),a&&(o=!0,u+="';\n"+a+";\n__p += '"),n&&(u+="' +\n((__t = ("+n+")) == null ? '' : __t) +\n'"),l=A+e.length,e})),u+="';\n";var d=Bt.call(e,"variable")&&e.variable;if(d){if(tt.test(d))throw new X("Invalid `variable` option passed into `_.template`")}else u="with (obj) {\n"+u+"\n}\n";u=(o?u.replace(L,""):u).replace(M,"$1").replace(U,"$1;"),u="function("+(d||"obj")+") {\n"+(d?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(r?", __e = _.escape":"")+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+u+"return __p\n}";var f=Va((function(){return ht(a,p+"return "+u).apply(void 0,A)}));if(f.source=u,Hs(f))throw f;return f},Ii.times=function(t,e){if((t=ra(t))<1||t>9007199254740991)return[];var i=4294967295,n=ai(t,4294967295);t-=4294967295;for(var r=Fe(n,e=Jr(e));++i<t;)e(i);return r},Ii.toFinite=na,Ii.toInteger=ra,Ii.toLength=oa,Ii.toLower=function(t){return Aa(t).toLowerCase()},Ii.toNumber=sa,Ii.toSafeInteger=function(t){return t?Xi(ra(t),-9007199254740991,9007199254740991):0===t?t:0},Ii.toString=Aa,Ii.toUpper=function(t){return Aa(t).toUpperCase()},Ii.trim=function(t,e,i){if((t=Aa(t))&&(i||void 0===e))return Oe(t);if(!t||!(e=Zn(e)))return t;var n=We(t),r=We(e);return cr(n,Me(n,r),Ue(n,r)+1).join("")},Ii.trimEnd=function(t,e,i){if((t=Aa(t))&&(i||void 0===e))return t.slice(0,qe(t)+1);if(!t||!(e=Zn(e)))return t;var n=We(t);return cr(n,0,Ue(n,We(e))+1).join("")},Ii.trimStart=function(t,e,i){if((t=Aa(t))&&(i||void 0===e))return t.replace(q,"");if(!t||!(e=Zn(e)))return t;var n=We(t);return cr(n,Me(n,We(e))).join("")},Ii.truncate=function(t,e){var i=30,n="...";if(Gs(e)){var r="separator"in e?e.separator:r;i="length"in e?ra(e.length):i,n="omission"in e?Zn(e.omission):n}var o=(t=Aa(t)).length;if(He(t)){var s=We(t);o=s.length}if(i>=o)return t;var a=i-ze(n);if(a<1)return n;var A=s?cr(s,0,a).join(""):t.slice(0,a);if(void 0===r)return A+n;if(s&&(a+=A.length-a),Xs(r)){if(t.slice(a).search(r)){var l,c=A;for(r.global||(r=ft(r.source,Aa(nt.exec(r))+"g")),r.lastIndex=0;l=r.exec(c);)var u=l.index;A=A.slice(0,void 0===u?a:u)}}else if(t.indexOf(Zn(r),a)!=a){var h=A.lastIndexOf(r);h>-1&&(A=A.slice(0,h))}return A+n},Ii.unescape=function(t){return(t=Aa(t))&&R.test(t)?t.replace(D,Xe):t},Ii.uniqueId=function(t){var e=++bt;return Aa(t)+e},Ii.upperCase=Na,Ii.upperFirst=Ha,Ii.each=As,Ii.eachRight=ls,Ii.first=Do,Ja(Ii,(uA={},ln(Ii,(function(t,e){Bt.call(Ii.prototype,e)||(uA[e]=t)})),uA),{chain:!1}),Ii.VERSION="4.17.21",ae(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(t){Ii[t].placeholder=Ii})),ae(["drop","take"],(function(t,e){Ti.prototype[t]=function(i){i=void 0===i?1:si(ra(i),0);var n=this.__filtered__&&!e?new Ti(this):this.clone();return n.__filtered__?n.__takeCount__=ai(i,n.__takeCount__):n.__views__.push({size:ai(i,4294967295),type:t+(n.__dir__<0?"Right":"")}),n},Ti.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}})),ae(["filter","map","takeWhile"],(function(t,e){var i=e+1,n=1==i||3==i;Ti.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:Jr(t,3),type:i}),e.__filtered__=e.__filtered__||n,e}})),ae(["head","last"],(function(t,e){var i="take"+(e?"Right":"");Ti.prototype[t]=function(){return this[i](1).value()[0]}})),ae(["initial","tail"],(function(t,e){var i="drop"+(e?"":"Right");Ti.prototype[t]=function(){return this.__filtered__?new Ti(this):this[i](1)}})),Ti.prototype.compact=function(){return this.filter(Wa)},Ti.prototype.find=function(t){return this.filter(t).head()},Ti.prototype.findLast=function(t){return this.reverse().find(t)},Ti.prototype.invokeMap=Nn((function(t,e){return"function"==typeof t?new Ti(this):this.map((function(i){return vn(i,t,e)}))})),Ti.prototype.reject=function(t){return this.filter(Es(Jr(t)))},Ti.prototype.slice=function(t,e){t=ra(t);var i=this;return i.__filtered__&&(t>0||e<0)?new Ti(i):(t<0?i=i.takeRight(-t):t&&(i=i.drop(t)),void 0!==e&&(i=(e=ra(e))<0?i.dropRight(-e):i.take(e-t)),i)},Ti.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},Ti.prototype.toArray=function(){return this.take(4294967295)},ln(Ti.prototype,(function(t,e){var i=/^(?:filter|find|map|reject)|While$/.test(e),n=/^(?:head|last)$/.test(e),r=Ii[n?"take"+("last"==e?"Right":""):e],o=n||/^find/.test(e);r&&(Ii.prototype[e]=function(){var e=this.__wrapped__,s=n?[1]:arguments,a=e instanceof Ti,A=s[0],l=a||Ms(e),c=function(t){var e=r.apply(Ii,de([t],s));return n&&u?e[0]:e};l&&i&&"function"==typeof A&&1!=A.length&&(a=l=!1);var u=this.__chain__,h=!!this.__actions__.length,p=o&&!u,d=a&&!h;if(!o&&l){e=d?e:new Ti(this);var f=t.apply(e,s);return f.__actions__.push({func:ns,args:[c],thisArg:void 0}),new Pi(f,u)}return p&&d?t.apply(this,s):(f=this.thru(c),p?n?f.value()[0]:f.value():f)})})),ae(["pop","push","shift","sort","splice","unshift"],(function(t){var e=yt[t],i=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",n=/^(?:pop|shift)$/.test(t);Ii.prototype[t]=function(){var t=arguments;if(n&&!this.__chain__){var r=this.value();return e.apply(Ms(r)?r:[],t)}return this[i]((function(i){return e.apply(Ms(i)?i:[],t)}))}})),ln(Ti.prototype,(function(t,e){var i=Ii[e];if(i){var n=i.name+"";Bt.call(vi,n)||(vi[n]=[]),vi[n].push({name:e,func:i})}})),vi[Fr(void 0,2).name]=[{name:"wrapper",func:void 0}],Ti.prototype.clone=function(){var t=new Ti(this.__wrapped__);return t.__actions__=yr(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=yr(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=yr(this.__views__),t},Ti.prototype.reverse=function(){if(this.__filtered__){var t=new Ti(this);t.__dir__=-1,t.__filtered__=!0}else(t=this.clone()).__dir__*=-1;return t},Ti.prototype.value=function(){var t=this.__wrapped__.value(),e=this.__dir__,i=Ms(t),n=e<0,r=i?t.length:0,o=function(t,e,i){var n=-1,r=i.length;for(;++n<r;){var o=i[n],s=o.size;switch(o.type){case"drop":t+=s;break;case"dropRight":e-=s;break;case"take":e=ai(e,t+s);break;case"takeRight":t=si(t,e-s)}}return{start:t,end:e}}(0,r,this.__views__),s=o.start,a=o.end,A=a-s,l=n?a:s-1,c=this.__iteratees__,u=c.length,h=0,p=ai(A,this.__takeCount__);if(!i||!n&&r==A&&p==A)return nr(t,this.__actions__);var d=[];t:for(;A--&&h<p;){for(var f=-1,g=t[l+=e];++f<u;){var m=c[f],y=m.iteratee,v=m.type,_=y(g);if(2==v)g=_;else if(!_){if(1==v)continue t;break t}}d[h++]=g}return d},Ii.prototype.at=rs,Ii.prototype.chain=function(){return is(this)},Ii.prototype.commit=function(){return new Pi(this.value(),this.__chain__)},Ii.prototype.next=function(){void 0===this.__values__&&(this.__values__=ia(this.value()));var t=this.__index__>=this.__values__.length;return{done:t,value:t?void 0:this.__values__[this.__index__++]}},Ii.prototype.plant=function(t){for(var e,i=this;i instanceof Oi;){var n=Fo(i);n.__index__=0,n.__values__=void 0,e?r.__wrapped__=n:e=n;var r=n;i=i.__wrapped__}return r.__wrapped__=t,e},Ii.prototype.reverse=function(){var t=this.__wrapped__;if(t instanceof Ti){var e=t;return this.__actions__.length&&(e=new Ti(this)),(e=e.reverse()).__actions__.push({func:ns,args:[Go],thisArg:void 0}),new Pi(e,this.__chain__)}return this.thru(Go)},Ii.prototype.toJSON=Ii.prototype.valueOf=Ii.prototype.value=function(){return nr(this.__wrapped__,this.__actions__)},Ii.prototype.first=Ii.prototype.head,Jt&&(Ii.prototype[Jt]=function(){return this}),Ii}();Wt._=Ye,void 0===(r=function(){return Ye}.call(e,i,e,n))||(n.exports=r)}).call(this)}).call(this,i(7),i(23)(t))},function(t,e,i){"use strict";var n=i(8),r=Object.prototype.toString;function o(t){return"[object Array]"===r.call(t)}function s(t){return void 0===t}function a(t){return null!==t&&"object"==typeof t}function A(t){if("[object Object]"!==r.call(t))return!1;var e=Object.getPrototypeOf(t);return null===e||e===Object.prototype}function l(t){return"[object Function]"===r.call(t)}function c(t,e){if(null!=t)if("object"!=typeof t&&(t=[t]),o(t))for(var i=0,n=t.length;i<n;i++)e.call(null,t[i],i,t);else for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.call(null,t[r],r,t)}t.exports={isArray:o,isArrayBuffer:function(t){return"[object ArrayBuffer]"===r.call(t)},isBuffer:function(t){return null!==t&&!s(t)&&null!==t.constructor&&!s(t.constructor)&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)},isFormData:function(t){return"undefined"!=typeof FormData&&t instanceof FormData},isArrayBufferView:function(t){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&t.buffer instanceof ArrayBuffer},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isObject:a,isPlainObject:A,isUndefined:s,isDate:function(t){return"[object Date]"===r.call(t)},isFile:function(t){return"[object File]"===r.call(t)},isBlob:function(t){return"[object Blob]"===r.call(t)},isFunction:l,isStream:function(t){return a(t)&&l(t.pipe)},isURLSearchParams:function(t){return"undefined"!=typeof URLSearchParams&&t instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach:c,merge:function t(){var e={};function i(i,n){A(e[n])&&A(i)?e[n]=t(e[n],i):A(i)?e[n]=t({},i):o(i)?e[n]=i.slice():e[n]=i}for(var n=0,r=arguments.length;n<r;n++)c(arguments[n],i);return e},extend:function(t,e,i){return c(e,(function(e,r){t[r]=i&&"function"==typeof e?n(e,i):e})),t},trim:function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},stripBOM:function(t){return 65279===t.charCodeAt(0)&&(t=t.slice(1)),t}}},function(t,e,i){(function(e){t.exports=function t(e,n,r){function o(a,A){if(!n[a]){if(!e[a]){if(!A&&i(58))return(void 0)(a,!0);if(s)return s(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[a]={exports:{}};e[a][0].call(c.exports,(function(t){return o(e[a][1][t]||t)}),c,c.exports,t,e,n,r)}return n[a].exports}for(var s=!1,a=0;a<r.length;a++)o(r[a]);return o}({1:[function(t,i,n){(function(e){(function(){"use strict";var n=t("./transport-list");i.exports=t("./main")(n),"_sockjs_onload"in e&&setTimeout(e._sockjs_onload,1)}).call(this)}).call(this,void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./main":14,"./transport-list":16}],2:[function(t,e,i){"use strict";var n=t("inherits"),r=t("./event");function o(){r.call(this),this.initEvent("close",!1,!1),this.wasClean=!1,this.code=0,this.reason=""}n(o,r),e.exports=o},{"./event":4,inherits:57}],3:[function(t,e,i){"use strict";var n=t("inherits"),r=t("./eventtarget");function o(){r.call(this)}n(o,r),o.prototype.removeAllListeners=function(t){t?delete this._listeners[t]:this._listeners={}},o.prototype.once=function(t,e){var i=this,n=!1;this.on(t,(function r(){i.removeListener(t,r),n||(n=!0,e.apply(this,arguments))}))},o.prototype.emit=function(){var t=arguments[0],e=this._listeners[t];if(e){for(var i=arguments.length,n=new Array(i-1),r=1;r<i;r++)n[r-1]=arguments[r];for(var o=0;o<e.length;o++)e[o].apply(this,n)}},o.prototype.on=o.prototype.addListener=r.prototype.addEventListener,o.prototype.removeListener=r.prototype.removeEventListener,e.exports.EventEmitter=o},{"./eventtarget":5,inherits:57}],4:[function(t,e,i){"use strict";function n(t){this.type=t}n.prototype.initEvent=function(t,e,i){return this.type=t,this.bubbles=e,this.cancelable=i,this.timeStamp=+new Date,this},n.prototype.stopPropagation=function(){},n.prototype.preventDefault=function(){},n.CAPTURING_PHASE=1,n.AT_TARGET=2,n.BUBBLING_PHASE=3,e.exports=n},{}],5:[function(t,e,i){"use strict";function n(){this._listeners={}}n.prototype.addEventListener=function(t,e){t in this._listeners||(this._listeners[t]=[]);var i=this._listeners[t];-1===i.indexOf(e)&&(i=i.concat([e])),this._listeners[t]=i},n.prototype.removeEventListener=function(t,e){var i=this._listeners[t];if(i){var n=i.indexOf(e);-1===n||(i.length>1?this._listeners[t]=i.slice(0,n).concat(i.slice(n+1)):delete this._listeners[t])}},n.prototype.dispatchEvent=function(){var t=arguments[0],e=t.type,i=1===arguments.length?[t]:Array.apply(null,arguments);if(this["on"+e]&&this["on"+e].apply(this,i),e in this._listeners)for(var n=this._listeners[e],r=0;r<n.length;r++)n[r].apply(this,i)},e.exports=n},{}],6:[function(t,e,i){"use strict";var n=t("inherits"),r=t("./event");function o(t){r.call(this),this.initEvent("message",!1,!1),this.data=t}n(o,r),e.exports=o},{"./event":4,inherits:57}],7:[function(t,e,i){"use strict";var n=t("./utils/iframe");function r(t){this._transport=t,t.on("message",this._transportMessage.bind(this)),t.on("close",this._transportClose.bind(this))}r.prototype._transportClose=function(t,e){n.postMessage("c",JSON.stringify([t,e]))},r.prototype._transportMessage=function(t){n.postMessage("t",t)},r.prototype._send=function(t){this._transport.send(t)},r.prototype._close=function(){this._transport.close(),this._transport.removeAllListeners()},e.exports=r},{"./utils/iframe":47}],8:[function(t,e,i){(function(i){(function(){"use strict";var n=t("./utils/url"),r=t("./utils/event"),o=t("./facade"),s=t("./info-iframe-receiver"),a=t("./utils/iframe"),A=t("./location"),l=function(){};"production"!==i.env.NODE_ENV&&(l=t("debug")("sockjs-client:iframe-bootstrap")),e.exports=function(t,e){var i,c={};e.forEach((function(t){t.facadeTransport&&(c[t.facadeTransport.transportName]=t.facadeTransport)})),c[s.transportName]=s,t.bootstrap_iframe=function(){var e;a.currentWindowId=A.hash.slice(1),r.attachEvent("message",(function(r){if(r.source===parent&&(void 0===i&&(i=r.origin),r.origin===i)){var s;try{s=JSON.parse(r.data)}catch(t){return void l("bad json",r.data)}if(s.windowId===a.currentWindowId)switch(s.type){case"s":var u;try{u=JSON.parse(s.data)}catch(t){l("bad json",s.data);break}var h=u[0],p=u[1],d=u[2],f=u[3];if(l(h,p,d,f),h!==t.version)throw new Error('Incompatible SockJS! Main site uses: "'+h+'", the iframe: "'+t.version+'".');if(!n.isOriginEqual(d,A.href)||!n.isOriginEqual(f,A.href))throw new Error("Can't connect to different domain from within an iframe. ("+A.href+", "+d+", "+f+")");e=new o(new c[p](d,f));break;case"m":e._send(s.data);break;case"c":e&&e._close(),e=null}}})),a.postMessage("s")}}}).call(this)}).call(this,{env:{}})},{"./facade":7,"./info-iframe-receiver":10,"./location":13,"./utils/event":46,"./utils/iframe":47,"./utils/url":52,debug:55}],9:[function(t,e,i){(function(i){(function(){"use strict";var n=t("events").EventEmitter,r=t("inherits"),o=t("./utils/object"),s=function(){};function a(t,e){n.call(this);var i=this,r=+new Date;this.xo=new e("GET",t),this.xo.once("finish",(function(t,e){var n,a;if(200===t){if(a=+new Date-r,e)try{n=JSON.parse(e)}catch(t){s("bad json",e)}o.isObject(n)||(n={})}i.emit("finish",n,a),i.removeAllListeners()}))}"production"!==i.env.NODE_ENV&&(s=t("debug")("sockjs-client:info-ajax")),r(a,n),a.prototype.close=function(){this.removeAllListeners(),this.xo.close()},e.exports=a}).call(this)}).call(this,{env:{}})},{"./utils/object":49,debug:55,events:3,inherits:57}],10:[function(t,e,i){"use strict";var n=t("inherits"),r=t("events").EventEmitter,o=t("./transport/sender/xhr-local"),s=t("./info-ajax");function a(t){var e=this;r.call(this),this.ir=new s(t,o),this.ir.once("finish",(function(t,i){e.ir=null,e.emit("message",JSON.stringify([t,i]))}))}n(a,r),a.transportName="iframe-info-receiver",a.prototype.close=function(){this.ir&&(this.ir.close(),this.ir=null),this.removeAllListeners()},e.exports=a},{"./info-ajax":9,"./transport/sender/xhr-local":37,events:3,inherits:57}],11:[function(t,i,n){(function(e,n){(function(){"use strict";var r=t("events").EventEmitter,o=t("inherits"),s=t("./utils/event"),a=t("./transport/iframe"),A=t("./info-iframe-receiver"),l=function(){};function c(t,e){var i=this;r.call(this);var o=function(){var n=i.ifr=new a(A.transportName,e,t);n.once("message",(function(t){if(t){var e;try{e=JSON.parse(t)}catch(e){return l("bad json",t),i.emit("finish"),void i.close()}var n=e[0],r=e[1];i.emit("finish",n,r)}i.close()})),n.once("close",(function(){i.emit("finish"),i.close()}))};n.document.body?o():s.attachEvent("load",o)}"production"!==e.env.NODE_ENV&&(l=t("debug")("sockjs-client:info-iframe")),o(c,r),c.enabled=function(){return a.enabled()},c.prototype.close=function(){this.ifr&&this.ifr.close(),this.removeAllListeners(),this.ifr=null},i.exports=c}).call(this)}).call(this,{env:{}},void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./info-iframe-receiver":10,"./transport/iframe":22,"./utils/event":46,debug:55,events:3,inherits:57}],12:[function(t,e,i){(function(i){(function(){"use strict";var n=t("events").EventEmitter,r=t("inherits"),o=t("./utils/url"),s=t("./transport/sender/xdr"),a=t("./transport/sender/xhr-cors"),A=t("./transport/sender/xhr-local"),l=t("./transport/sender/xhr-fake"),c=t("./info-iframe"),u=t("./info-ajax"),h=function(){};function p(t,e){h(t);var i=this;n.call(this),setTimeout((function(){i.doXhr(t,e)}),0)}"production"!==i.env.NODE_ENV&&(h=t("debug")("sockjs-client:info-receiver")),r(p,n),p._getReceiver=function(t,e,i){return i.sameOrigin?new u(e,A):a.enabled?new u(e,a):s.enabled&&i.sameScheme?new u(e,s):c.enabled()?new c(t,e):new u(e,l)},p.prototype.doXhr=function(t,e){var i=this,n=o.addPath(t,"/info");h("doXhr",n),this.xo=p._getReceiver(t,n,e),this.timeoutRef=setTimeout((function(){h("timeout"),i._cleanup(!1),i.emit("finish")}),p.timeout),this.xo.once("finish",(function(t,e){h("finish",t,e),i._cleanup(!0),i.emit("finish",t,e)}))},p.prototype._cleanup=function(t){h("_cleanup"),clearTimeout(this.timeoutRef),this.timeoutRef=null,!t&&this.xo&&this.xo.close(),this.xo=null},p.prototype.close=function(){h("close"),this.removeAllListeners(),this._cleanup(!1)},p.timeout=8e3,e.exports=p}).call(this)}).call(this,{env:{}})},{"./info-ajax":9,"./info-iframe":11,"./transport/sender/xdr":34,"./transport/sender/xhr-cors":35,"./transport/sender/xhr-fake":36,"./transport/sender/xhr-local":37,"./utils/url":52,debug:55,events:3,inherits:57}],13:[function(t,i,n){(function(t){(function(){"use strict";i.exports=t.location||{origin:"http://localhost:80",protocol:"http:",host:"localhost",port:80,href:"http://localhost/",hash:""}}).call(this)}).call(this,void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],14:[function(t,i,n){(function(e,n){(function(){"use strict";t("./shims");var r,o=t("url-parse"),s=t("inherits"),a=t("./utils/random"),A=t("./utils/escape"),l=t("./utils/url"),c=t("./utils/event"),u=t("./utils/transport"),h=t("./utils/object"),p=t("./utils/browser"),d=t("./utils/log"),f=t("./event/event"),g=t("./event/eventtarget"),m=t("./location"),y=t("./event/close"),v=t("./event/trans-message"),_=t("./info-receiver"),w=function(){};function C(t,e,i){if(!(this instanceof C))return new C(t,e,i);if(arguments.length<1)throw new TypeError("Failed to construct 'SockJS: 1 argument required, but only 0 present");g.call(this),this.readyState=C.CONNECTING,this.extensions="",this.protocol="",(i=i||{}).protocols_whitelist&&d.warn("'protocols_whitelist' is DEPRECATED. Use 'transports' instead."),this._transportsWhitelist=i.transports,this._transportOptions=i.transportOptions||{},this._timeout=i.timeout||0;var n=i.sessionId||8;if("function"==typeof n)this._generateSessionId=n;else{if("number"!=typeof n)throw new TypeError("If sessionId is used in the options, it needs to be a number or a function.");this._generateSessionId=function(){return a.string(n)}}this._server=i.server||a.numberString(1e3);var r=new o(t);if(!r.host||!r.protocol)throw new SyntaxError("The URL '"+t+"' is invalid");if(r.hash)throw new SyntaxError("The URL must not contain a fragment");if("http:"!==r.protocol&&"https:"!==r.protocol)throw new SyntaxError("The URL's scheme must be either 'http:' or 'https:'. '"+r.protocol+"' is not allowed.");var s="https:"===r.protocol;if("https:"===m.protocol&&!s&&!l.isLoopbackAddr(r.hostname))throw new Error("SecurityError: An insecure SockJS connection may not be initiated from a page loaded over HTTPS");e?Array.isArray(e)||(e=[e]):e=[];var A=e.sort();A.forEach((function(t,e){if(!t)throw new SyntaxError("The protocols entry '"+t+"' is invalid.");if(e<A.length-1&&t===A[e+1])throw new SyntaxError("The protocols entry '"+t+"' is duplicated.")}));var c=l.getOrigin(m.href);this._origin=c?c.toLowerCase():null,r.set("pathname",r.pathname.replace(/\/+$/,"")),this.url=r.href,w("using url",this.url),this._urlInfo={nullOrigin:!p.hasDomain(),sameOrigin:l.isOriginEqual(this.url,m.href),sameScheme:l.isSchemeEqual(this.url,m.href)},this._ir=new _(this.url,this._urlInfo),this._ir.once("finish",this._receiveInfo.bind(this))}function B(t){return 1e3===t||t>=3e3&&t<=4999}"production"!==e.env.NODE_ENV&&(w=t("debug")("sockjs-client:main")),s(C,g),C.prototype.close=function(t,e){if(t&&!B(t))throw new Error("InvalidAccessError: Invalid code");if(e&&e.length>123)throw new SyntaxError("reason argument has an invalid length");this.readyState!==C.CLOSING&&this.readyState!==C.CLOSED&&this._close(t||1e3,e||"Normal closure",!0)},C.prototype.send=function(t){if("string"!=typeof t&&(t=""+t),this.readyState===C.CONNECTING)throw new Error("InvalidStateError: The connection has not been established yet");this.readyState===C.OPEN&&this._transport.send(A.quote(t))},C.version=t("./version"),C.CONNECTING=0,C.OPEN=1,C.CLOSING=2,C.CLOSED=3,C.prototype._receiveInfo=function(t,e){if(w("_receiveInfo",e),this._ir=null,t){this._rto=this.countRTO(e),this._transUrl=t.base_url?t.base_url:this.url,t=h.extend(t,this._urlInfo),w("info",t);var i=r.filterToEnabled(this._transportsWhitelist,t);this._transports=i.main,w(this._transports.length+" enabled transports"),this._connect()}else this._close(1002,"Cannot connect to server")},C.prototype._connect=function(){for(var t=this._transports.shift();t;t=this._transports.shift()){if(w("attempt",t.transportName),t.needBody&&(!n.document.body||void 0!==n.document.readyState&&"complete"!==n.document.readyState&&"interactive"!==n.document.readyState))return w("waiting for body"),this._transports.unshift(t),void c.attachEvent("load",this._connect.bind(this));var e=Math.max(this._timeout,this._rto*t.roundTrips||5e3);this._transportTimeoutId=setTimeout(this._transportTimeout.bind(this),e),w("using timeout",e);var i=l.addPath(this._transUrl,"/"+this._server+"/"+this._generateSessionId()),r=this._transportOptions[t.transportName];w("transport url",i);var o=new t(i,this._transUrl,r);return o.on("message",this._transportMessage.bind(this)),o.once("close",this._transportClose.bind(this)),o.transportName=t.transportName,void(this._transport=o)}this._close(2e3,"All transports failed",!1)},C.prototype._transportTimeout=function(){w("_transportTimeout"),this.readyState===C.CONNECTING&&(this._transport&&this._transport.close(),this._transportClose(2007,"Transport timed out"))},C.prototype._transportMessage=function(t){w("_transportMessage",t);var e,i=this,n=t.slice(0,1),r=t.slice(1);switch(n){case"o":return void this._open();case"h":return this.dispatchEvent(new f("heartbeat")),void w("heartbeat",this.transport)}if(r)try{e=JSON.parse(r)}catch(t){w("bad json",r)}if(void 0!==e)switch(n){case"a":Array.isArray(e)&&e.forEach((function(t){w("message",i.transport,t),i.dispatchEvent(new v(t))}));break;case"m":w("message",this.transport,e),this.dispatchEvent(new v(e));break;case"c":Array.isArray(e)&&2===e.length&&this._close(e[0],e[1],!0)}else w("empty payload",r)},C.prototype._transportClose=function(t,e){w("_transportClose",this.transport,t,e),this._transport&&(this._transport.removeAllListeners(),this._transport=null,this.transport=null),B(t)||2e3===t||this.readyState!==C.CONNECTING?this._close(t,e):this._connect()},C.prototype._open=function(){w("_open",this._transport&&this._transport.transportName,this.readyState),this.readyState===C.CONNECTING?(this._transportTimeoutId&&(clearTimeout(this._transportTimeoutId),this._transportTimeoutId=null),this.readyState=C.OPEN,this.transport=this._transport.transportName,this.dispatchEvent(new f("open")),w("connected",this.transport)):this._close(1006,"Server lost session")},C.prototype._close=function(t,e,i){w("_close",this.transport,t,e,i,this.readyState);var n=!1;if(this._ir&&(n=!0,this._ir.close(),this._ir=null),this._transport&&(this._transport.close(),this._transport=null,this.transport=null),this.readyState===C.CLOSED)throw new Error("InvalidStateError: SockJS has already been closed");this.readyState=C.CLOSING,setTimeout(function(){this.readyState=C.CLOSED,n&&this.dispatchEvent(new f("error"));var r=new y("close");r.wasClean=i||!1,r.code=t||1e3,r.reason=e,this.dispatchEvent(r),this.onmessage=this.onclose=this.onerror=null,w("disconnected")}.bind(this),0)},C.prototype.countRTO=function(t){return t>100?4*t:300+t},i.exports=function(e){return r=u(e),t("./iframe-bootstrap")(C,e),C}}).call(this)}).call(this,{env:{}},void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./event/close":2,"./event/event":4,"./event/eventtarget":5,"./event/trans-message":6,"./iframe-bootstrap":8,"./info-receiver":12,"./location":13,"./shims":15,"./utils/browser":44,"./utils/escape":45,"./utils/event":46,"./utils/log":48,"./utils/object":49,"./utils/random":50,"./utils/transport":51,"./utils/url":52,"./version":53,debug:55,inherits:57,"url-parse":60}],15:[function(t,e,i){"use strict";var n,r=Array.prototype,o=Object.prototype,s=Function.prototype,a=String.prototype,A=r.slice,l=o.toString,c=function(t){return"[object Function]"===o.toString.call(t)},u=function(t){return"[object String]"===l.call(t)},h=Object.defineProperty&&function(){try{return Object.defineProperty({},"x",{}),!0}catch(t){return!1}}();n=h?function(t,e,i,n){!n&&e in t||Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:!0,value:i})}:function(t,e,i,n){!n&&e in t||(t[e]=i)};var p=function(t,e,i){for(var r in e)o.hasOwnProperty.call(e,r)&&n(t,r,e[r],i)},d=function(t){if(null==t)throw new TypeError("can't convert "+t+" to object");return Object(t)};function f(t){var e=+t;return e!=e?e=0:0!==e&&e!==1/0&&e!==-1/0&&(e=(e>0||-1)*Math.floor(Math.abs(e))),e}function g(){}p(s,{bind:function(t){var e=this;if(!c(e))throw new TypeError("Function.prototype.bind called on incompatible "+e);for(var i=A.call(arguments,1),n=function(){if(this instanceof a){var n=e.apply(this,i.concat(A.call(arguments)));return Object(n)===n?n:this}return e.apply(t,i.concat(A.call(arguments)))},r=Math.max(0,e.length-i.length),o=[],s=0;s<r;s++)o.push("$"+s);var a=Function("binder","return function ("+o.join(",")+"){ return binder.apply(this, arguments); }")(n);return e.prototype&&(g.prototype=e.prototype,a.prototype=new g,g.prototype=null),a}}),p(Array,{isArray:function(t){return"[object Array]"===l.call(t)}});var m,y,v,_=Object("a"),w="a"!==_[0]||!(0 in _);p(r,{forEach:function(t){var e=d(this),i=w&&u(this)?this.split(""):e,n=arguments[1],r=-1,o=i.length>>>0;if(!c(t))throw new TypeError;for(;++r<o;)r in i&&t.call(n,i[r],r,e)}},(m=r.forEach,y=!0,v=!0,m&&(m.call("foo",(function(t,e,i){"object"!=typeof i&&(y=!1)})),m.call([1],(function(){v="string"==typeof this}),"x")),!(m&&y&&v)));var C=Array.prototype.indexOf&&-1!==[0,1].indexOf(1,2);p(r,{indexOf:function(t){var e=w&&u(this)?this.split(""):d(this),i=e.length>>>0;if(!i)return-1;var n=0;for(arguments.length>1&&(n=f(arguments[1])),n=n>=0?n:Math.max(0,i+n);n<i;n++)if(n in e&&e[n]===t)return n;return-1}},C);var B,b=a.split;2!=="ab".split(/(?:ab)*/).length||4!==".".split(/(.?)(.?)/).length||"t"==="tesst".split(/(s)*/)[1]||4!=="test".split(/(?:)/,-1).length||"".split(/.?/).length||".".split(/()()/).length>1?(B=void 0===/()??/.exec("")[1],a.split=function(t,e){var i=this;if(void 0===t&&0===e)return[];if("[object RegExp]"!==l.call(t))return b.call(this,t,e);var n,o,s,a,A=[],c=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.extended?"x":"")+(t.sticky?"y":""),u=0;for(t=new RegExp(t.source,c+"g"),i+="",B||(n=new RegExp("^"+t.source+"$(?!\\s)",c)),e=void 0===e?-1>>>0:e>>>0;(o=t.exec(i))&&!((s=o.index+o[0].length)>u&&(A.push(i.slice(u,o.index)),!B&&o.length>1&&o[0].replace(n,(function(){for(var t=1;t<arguments.length-2;t++)void 0===arguments[t]&&(o[t]=void 0)})),o.length>1&&o.index<i.length&&r.push.apply(A,o.slice(1)),a=o[0].length,u=s,A.length>=e));)t.lastIndex===o.index&&t.lastIndex++;return u===i.length?!a&&t.test("")||A.push(""):A.push(i.slice(u)),A.length>e?A.slice(0,e):A}):"0".split(void 0,0).length&&(a.split=function(t,e){return void 0===t&&0===e?[]:b.call(this,t,e)});var E=a.substr,S="".substr&&"b"!=="0b".substr(-1);p(a,{substr:function(t,e){return E.call(this,t<0&&(t=this.length+t)<0?0:t,e)}},S)},{}],16:[function(t,e,i){"use strict";e.exports=[t("./transport/websocket"),t("./transport/xhr-streaming"),t("./transport/xdr-streaming"),t("./transport/eventsource"),t("./transport/lib/iframe-wrap")(t("./transport/eventsource")),t("./transport/htmlfile"),t("./transport/lib/iframe-wrap")(t("./transport/htmlfile")),t("./transport/xhr-polling"),t("./transport/xdr-polling"),t("./transport/lib/iframe-wrap")(t("./transport/xhr-polling")),t("./transport/jsonp-polling")]},{"./transport/eventsource":20,"./transport/htmlfile":21,"./transport/jsonp-polling":23,"./transport/lib/iframe-wrap":26,"./transport/websocket":38,"./transport/xdr-polling":39,"./transport/xdr-streaming":40,"./transport/xhr-polling":41,"./transport/xhr-streaming":42}],17:[function(t,i,n){(function(e,n){(function(){"use strict";var r=t("events").EventEmitter,o=t("inherits"),s=t("../../utils/event"),a=t("../../utils/url"),A=n.XMLHttpRequest,l=function(){};function c(t,e,i,n){l(t,e);var o=this;r.call(this),setTimeout((function(){o._start(t,e,i,n)}),0)}"production"!==e.env.NODE_ENV&&(l=t("debug")("sockjs-client:browser:xhr")),o(c,r),c.prototype._start=function(t,e,i,n){var r=this;try{this.xhr=new A}catch(t){}if(!this.xhr)return l("no xhr"),this.emit("finish",0,"no xhr support"),void this._cleanup();e=a.addQuery(e,"t="+ +new Date),this.unloadRef=s.unloadAdd((function(){l("unload cleanup"),r._cleanup(!0)}));try{this.xhr.open(t,e,!0),this.timeout&&"timeout"in this.xhr&&(this.xhr.timeout=this.timeout,this.xhr.ontimeout=function(){l("xhr timeout"),r.emit("finish",0,""),r._cleanup(!1)})}catch(t){return l("exception",t),this.emit("finish",0,""),void this._cleanup(!1)}if(n&&n.noCredentials||!c.supportsCORS||(l("withCredentials"),this.xhr.withCredentials=!0),n&&n.headers)for(var o in n.headers)this.xhr.setRequestHeader(o,n.headers[o]);this.xhr.onreadystatechange=function(){if(r.xhr){var t,e,i=r.xhr;switch(l("readyState",i.readyState),i.readyState){case 3:try{e=i.status,t=i.responseText}catch(t){}l("status",e),1223===e&&(e=204),200===e&&t&&t.length>0&&(l("chunk"),r.emit("chunk",e,t));break;case 4:e=i.status,l("status",e),1223===e&&(e=204),12005!==e&&12029!==e||(e=0),l("finish",e,i.responseText),r.emit("finish",e,i.responseText),r._cleanup(!1)}}};try{r.xhr.send(i)}catch(t){r.emit("finish",0,""),r._cleanup(!1)}},c.prototype._cleanup=function(t){if(l("cleanup"),this.xhr){if(this.removeAllListeners(),s.unloadDel(this.unloadRef),this.xhr.onreadystatechange=function(){},this.xhr.ontimeout&&(this.xhr.ontimeout=null),t)try{this.xhr.abort()}catch(t){}this.unloadRef=this.xhr=null}},c.prototype.close=function(){l("close"),this._cleanup(!0)},c.enabled=!!A;var u=["Active"].concat("Object").join("X");!c.enabled&&u in n&&(l("overriding xmlhttprequest"),A=function(){try{return new n[u]("Microsoft.XMLHTTP")}catch(t){return null}},c.enabled=!!new A);var h=!1;try{h="withCredentials"in new A}catch(t){}c.supportsCORS=h,i.exports=c}).call(this)}).call(this,{env:{}},void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../utils/event":46,"../../utils/url":52,debug:55,events:3,inherits:57}],18:[function(t,i,n){(function(t){(function(){i.exports=t.EventSource}).call(this)}).call(this,void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],19:[function(t,i,n){(function(t){(function(){"use strict";var e=t.WebSocket||t.MozWebSocket;i.exports=e?function(t){return new e(t)}:void 0}).call(this)}).call(this,void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],20:[function(t,e,i){"use strict";var n=t("inherits"),r=t("./lib/ajax-based"),o=t("./receiver/eventsource"),s=t("./sender/xhr-cors"),a=t("eventsource");function A(t){if(!A.enabled())throw new Error("Transport created when disabled");r.call(this,t,"/eventsource",o,s)}n(A,r),A.enabled=function(){return!!a},A.transportName="eventsource",A.roundTrips=2,e.exports=A},{"./lib/ajax-based":24,"./receiver/eventsource":29,"./sender/xhr-cors":35,eventsource:18,inherits:57}],21:[function(t,e,i){"use strict";var n=t("inherits"),r=t("./receiver/htmlfile"),o=t("./sender/xhr-local"),s=t("./lib/ajax-based");function a(t){if(!r.enabled)throw new Error("Transport created when disabled");s.call(this,t,"/htmlfile",r,o)}n(a,s),a.enabled=function(t){return r.enabled&&t.sameOrigin},a.transportName="htmlfile",a.roundTrips=2,e.exports=a},{"./lib/ajax-based":24,"./receiver/htmlfile":30,"./sender/xhr-local":37,inherits:57}],22:[function(t,e,i){(function(i){(function(){"use strict";var n=t("inherits"),r=t("events").EventEmitter,o=t("../version"),s=t("../utils/url"),a=t("../utils/iframe"),A=t("../utils/event"),l=t("../utils/random"),c=function(){};function u(t,e,i){if(!u.enabled())throw new Error("Transport created when disabled");r.call(this);var n=this;this.origin=s.getOrigin(i),this.baseUrl=i,this.transUrl=e,this.transport=t,this.windowId=l.string(8);var o=s.addPath(i,"/iframe.html")+"#"+this.windowId;c(t,e,o),this.iframeObj=a.createIframe(o,(function(t){c("err callback"),n.emit("close",1006,"Unable to load an iframe ("+t+")"),n.close()})),this.onmessageCallback=this._message.bind(this),A.attachEvent("message",this.onmessageCallback)}"production"!==i.env.NODE_ENV&&(c=t("debug")("sockjs-client:transport:iframe")),n(u,r),u.prototype.close=function(){if(c("close"),this.removeAllListeners(),this.iframeObj){A.detachEvent("message",this.onmessageCallback);try{this.postMessage("c")}catch(t){}this.iframeObj.cleanup(),this.iframeObj=null,this.onmessageCallback=this.iframeObj=null}},u.prototype._message=function(t){if(c("message",t.data),s.isOriginEqual(t.origin,this.origin)){var e;try{e=JSON.parse(t.data)}catch(e){return void c("bad json",t.data)}if(e.windowId===this.windowId)switch(e.type){case"s":this.iframeObj.loaded(),this.postMessage("s",JSON.stringify([o,this.transport,this.transUrl,this.baseUrl]));break;case"t":this.emit("message",e.data);break;case"c":var i;try{i=JSON.parse(e.data)}catch(t){return void c("bad json",e.data)}this.emit("close",i[0],i[1]),this.close()}else c("mismatched window id",e.windowId,this.windowId)}else c("not same origin",t.origin,this.origin)},u.prototype.postMessage=function(t,e){c("postMessage",t,e),this.iframeObj.post(JSON.stringify({windowId:this.windowId,type:t,data:e||""}),this.origin)},u.prototype.send=function(t){c("send",t),this.postMessage("m",t)},u.enabled=function(){return a.iframeEnabled},u.transportName="iframe",u.roundTrips=2,e.exports=u}).call(this)}).call(this,{env:{}})},{"../utils/event":46,"../utils/iframe":47,"../utils/random":50,"../utils/url":52,"../version":53,debug:55,events:3,inherits:57}],23:[function(t,i,n){(function(e){(function(){"use strict";var n=t("inherits"),r=t("./lib/sender-receiver"),o=t("./receiver/jsonp"),s=t("./sender/jsonp");function a(t){if(!a.enabled())throw new Error("Transport created when disabled");r.call(this,t,"/jsonp",s,o)}n(a,r),a.enabled=function(){return!!e.document},a.transportName="jsonp-polling",a.roundTrips=1,a.needBody=!0,i.exports=a}).call(this)}).call(this,void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./lib/sender-receiver":28,"./receiver/jsonp":31,"./sender/jsonp":33,inherits:57}],24:[function(t,e,i){(function(i){(function(){"use strict";var n=t("inherits"),r=t("../../utils/url"),o=t("./sender-receiver"),s=function(){};function a(t,e,i,n){o.call(this,t,e,function(t){return function(e,i,n){s("create ajax sender",e,i);var o={};"string"==typeof i&&(o.headers={"Content-type":"text/plain"});var a=r.addPath(e,"/xhr_send"),A=new t("POST",a,i,o);return A.once("finish",(function(t){if(s("finish",t),A=null,200!==t&&204!==t)return n(new Error("http status "+t));n()})),function(){s("abort"),A.close(),A=null;var t=new Error("Aborted");t.code=1e3,n(t)}}}(n),i,n)}"production"!==i.env.NODE_ENV&&(s=t("debug")("sockjs-client:ajax-based")),n(a,o),e.exports=a}).call(this)}).call(this,{env:{}})},{"../../utils/url":52,"./sender-receiver":28,debug:55,inherits:57}],25:[function(t,e,i){(function(i){(function(){"use strict";var n=t("inherits"),r=t("events").EventEmitter,o=function(){};function s(t,e){o(t),r.call(this),this.sendBuffer=[],this.sender=e,this.url=t}"production"!==i.env.NODE_ENV&&(o=t("debug")("sockjs-client:buffered-sender")),n(s,r),s.prototype.send=function(t){o("send",t),this.sendBuffer.push(t),this.sendStop||this.sendSchedule()},s.prototype.sendScheduleWait=function(){o("sendScheduleWait");var t,e=this;this.sendStop=function(){o("sendStop"),e.sendStop=null,clearTimeout(t)},t=setTimeout((function(){o("timeout"),e.sendStop=null,e.sendSchedule()}),25)},s.prototype.sendSchedule=function(){o("sendSchedule",this.sendBuffer.length);var t=this;if(this.sendBuffer.length>0){var e="["+this.sendBuffer.join(",")+"]";this.sendStop=this.sender(this.url,e,(function(e){t.sendStop=null,e?(o("error",e),t.emit("close",e.code||1006,"Sending error: "+e),t.close()):t.sendScheduleWait()})),this.sendBuffer=[]}},s.prototype._cleanup=function(){o("_cleanup"),this.removeAllListeners()},s.prototype.close=function(){o("close"),this._cleanup(),this.sendStop&&(this.sendStop(),this.sendStop=null)},e.exports=s}).call(this)}).call(this,{env:{}})},{debug:55,events:3,inherits:57}],26:[function(t,i,n){(function(e){(function(){"use strict";var n=t("inherits"),r=t("../iframe"),o=t("../../utils/object");i.exports=function(t){function i(e,i){r.call(this,t.transportName,e,i)}return n(i,r),i.enabled=function(i,n){if(!e.document)return!1;var s=o.extend({},n);return s.sameOrigin=!0,t.enabled(s)&&r.enabled()},i.transportName="iframe-"+t.transportName,i.needBody=!0,i.roundTrips=r.roundTrips+t.roundTrips-1,i.facadeTransport=t,i}}).call(this)}).call(this,void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../utils/object":49,"../iframe":22,inherits:57}],27:[function(t,e,i){(function(i){(function(){"use strict";var n=t("inherits"),r=t("events").EventEmitter,o=function(){};function s(t,e,i){o(e),r.call(this),this.Receiver=t,this.receiveUrl=e,this.AjaxObject=i,this._scheduleReceiver()}"production"!==i.env.NODE_ENV&&(o=t("debug")("sockjs-client:polling")),n(s,r),s.prototype._scheduleReceiver=function(){o("_scheduleReceiver");var t=this,e=this.poll=new this.Receiver(this.receiveUrl,this.AjaxObject);e.on("message",(function(e){o("message",e),t.emit("message",e)})),e.once("close",(function(i,n){o("close",i,n,t.pollIsClosing),t.poll=e=null,t.pollIsClosing||("network"===n?t._scheduleReceiver():(t.emit("close",i||1006,n),t.removeAllListeners()))}))},s.prototype.abort=function(){o("abort"),this.removeAllListeners(),this.pollIsClosing=!0,this.poll&&this.poll.abort()},e.exports=s}).call(this)}).call(this,{env:{}})},{debug:55,events:3,inherits:57}],28:[function(t,e,i){(function(i){(function(){"use strict";var n=t("inherits"),r=t("../../utils/url"),o=t("./buffered-sender"),s=t("./polling"),a=function(){};function A(t,e,i,n,A){var l=r.addPath(t,e);a(l);var c=this;o.call(this,t,i),this.poll=new s(n,l,A),this.poll.on("message",(function(t){a("poll message",t),c.emit("message",t)})),this.poll.once("close",(function(t,e){a("poll close",t,e),c.poll=null,c.emit("close",t,e),c.close()}))}"production"!==i.env.NODE_ENV&&(a=t("debug")("sockjs-client:sender-receiver")),n(A,o),A.prototype.close=function(){o.prototype.close.call(this),a("close"),this.removeAllListeners(),this.poll&&(this.poll.abort(),this.poll=null)},e.exports=A}).call(this)}).call(this,{env:{}})},{"../../utils/url":52,"./buffered-sender":25,"./polling":27,debug:55,inherits:57}],29:[function(t,e,i){(function(i){(function(){"use strict";var n=t("inherits"),r=t("events").EventEmitter,o=t("eventsource"),s=function(){};function a(t){s(t),r.call(this);var e=this,i=this.es=new o(t);i.onmessage=function(t){s("message",t.data),e.emit("message",decodeURI(t.data))},i.onerror=function(t){s("error",i.readyState,t);var n=2!==i.readyState?"network":"permanent";e._cleanup(),e._close(n)}}"production"!==i.env.NODE_ENV&&(s=t("debug")("sockjs-client:receiver:eventsource")),n(a,r),a.prototype.abort=function(){s("abort"),this._cleanup(),this._close("user")},a.prototype._cleanup=function(){s("cleanup");var t=this.es;t&&(t.onmessage=t.onerror=null,t.close(),this.es=null)},a.prototype._close=function(t){s("close",t);var e=this;setTimeout((function(){e.emit("close",null,t),e.removeAllListeners()}),200)},e.exports=a}).call(this)}).call(this,{env:{}})},{debug:55,events:3,eventsource:18,inherits:57}],30:[function(t,i,n){(function(e,n){(function(){"use strict";var r=t("inherits"),o=t("../../utils/iframe"),s=t("../../utils/url"),a=t("events").EventEmitter,A=t("../../utils/random"),l=function(){};function c(t){l(t),a.call(this);var e=this;o.polluteGlobalNamespace(),this.id="a"+A.string(6),t=s.addQuery(t,"c="+decodeURIComponent(o.WPrefix+"."+this.id)),l("using htmlfile",c.htmlfileEnabled);var i=c.htmlfileEnabled?o.createHtmlfile:o.createIframe;n[o.WPrefix][this.id]={start:function(){l("start"),e.iframeObj.loaded()},message:function(t){l("message",t),e.emit("message",t)},stop:function(){l("stop"),e._cleanup(),e._close("network")}},this.iframeObj=i(t,(function(){l("callback"),e._cleanup(),e._close("permanent")}))}"production"!==e.env.NODE_ENV&&(l=t("debug")("sockjs-client:receiver:htmlfile")),r(c,a),c.prototype.abort=function(){l("abort"),this._cleanup(),this._close("user")},c.prototype._cleanup=function(){l("_cleanup"),this.iframeObj&&(this.iframeObj.cleanup(),this.iframeObj=null),delete n[o.WPrefix][this.id]},c.prototype._close=function(t){l("_close",t),this.emit("close",null,t),this.removeAllListeners()},c.htmlfileEnabled=!1;var u=["Active"].concat("Object").join("X");if(u in n)try{c.htmlfileEnabled=!!new n[u]("htmlfile")}catch(t){}c.enabled=c.htmlfileEnabled||o.iframeEnabled,i.exports=c}).call(this)}).call(this,{env:{}},void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../utils/iframe":47,"../../utils/random":50,"../../utils/url":52,debug:55,events:3,inherits:57}],31:[function(t,i,n){(function(e,n){(function(){"use strict";var r=t("../../utils/iframe"),o=t("../../utils/random"),s=t("../../utils/browser"),a=t("../../utils/url"),A=t("inherits"),l=t("events").EventEmitter,c=function(){};function u(t){c(t);var e=this;l.call(this),r.polluteGlobalNamespace(),this.id="a"+o.string(6);var i=a.addQuery(t,"c="+encodeURIComponent(r.WPrefix+"."+this.id));n[r.WPrefix][this.id]=this._callback.bind(this),this._createScript(i),this.timeoutId=setTimeout((function(){c("timeout"),e._abort(new Error("JSONP script loaded abnormally (timeout)"))}),u.timeout)}"production"!==e.env.NODE_ENV&&(c=t("debug")("sockjs-client:receiver:jsonp")),A(u,l),u.prototype.abort=function(){if(c("abort"),n[r.WPrefix][this.id]){var t=new Error("JSONP user aborted read");t.code=1e3,this._abort(t)}},u.timeout=35e3,u.scriptErrorTimeout=1e3,u.prototype._callback=function(t){c("_callback",t),this._cleanup(),this.aborting||(t&&(c("message",t),this.emit("message",t)),this.emit("close",null,"network"),this.removeAllListeners())},u.prototype._abort=function(t){c("_abort",t),this._cleanup(),this.aborting=!0,this.emit("close",t.code,t.message),this.removeAllListeners()},u.prototype._cleanup=function(){if(c("_cleanup"),clearTimeout(this.timeoutId),this.script2&&(this.script2.parentNode.removeChild(this.script2),this.script2=null),this.script){var t=this.script;t.parentNode.removeChild(t),t.onreadystatechange=t.onerror=t.onload=t.onclick=null,this.script=null}delete n[r.WPrefix][this.id]},u.prototype._scriptError=function(){c("_scriptError");var t=this;this.errorTimer||(this.errorTimer=setTimeout((function(){t.loadedOkay||t._abort(new Error("JSONP script loaded abnormally (onerror)"))}),u.scriptErrorTimeout))},u.prototype._createScript=function(t){c("_createScript",t);var e,i=this,r=this.script=n.document.createElement("script");if(r.id="a"+o.string(8),r.src=t,r.type="text/javascript",r.charset="UTF-8",r.onerror=this._scriptError.bind(this),r.onload=function(){c("onload"),i._abort(new Error("JSONP script loaded abnormally (onload)"))},r.onreadystatechange=function(){if(c("onreadystatechange",r.readyState),/loaded|closed/.test(r.readyState)){if(r&&r.htmlFor&&r.onclick){i.loadedOkay=!0;try{r.onclick()}catch(t){}}r&&i._abort(new Error("JSONP script loaded abnormally (onreadystatechange)"))}},void 0===r.async&&n.document.attachEvent)if(s.isOpera())(e=this.script2=n.document.createElement("script")).text="try{var a = document.getElementById('"+r.id+"'); if(a)a.onerror();}catch(x){};",r.async=e.async=!1;else{try{r.htmlFor=r.id,r.event="onclick"}catch(t){}r.async=!0}void 0!==r.async&&(r.async=!0);var a=n.document.getElementsByTagName("head")[0];a.insertBefore(r,a.firstChild),e&&a.insertBefore(e,a.firstChild)},i.exports=u}).call(this)}).call(this,{env:{}},void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../utils/browser":44,"../../utils/iframe":47,"../../utils/random":50,"../../utils/url":52,debug:55,events:3,inherits:57}],32:[function(t,e,i){(function(i){(function(){"use strict";var n=t("inherits"),r=t("events").EventEmitter,o=function(){};function s(t,e){o(t),r.call(this);var i=this;this.bufferPosition=0,this.xo=new e("POST",t,null),this.xo.on("chunk",this._chunkHandler.bind(this)),this.xo.once("finish",(function(t,e){o("finish",t,e),i._chunkHandler(t,e),i.xo=null;var n=200===t?"network":"permanent";o("close",n),i.emit("close",null,n),i._cleanup()}))}"production"!==i.env.NODE_ENV&&(o=t("debug")("sockjs-client:receiver:xhr")),n(s,r),s.prototype._chunkHandler=function(t,e){if(o("_chunkHandler",t),200===t&&e)for(var i=-1;;this.bufferPosition+=i+1){var n=e.slice(this.bufferPosition);if(-1===(i=n.indexOf("\n")))break;var r=n.slice(0,i);r&&(o("message",r),this.emit("message",r))}},s.prototype._cleanup=function(){o("_cleanup"),this.removeAllListeners()},s.prototype.abort=function(){o("abort"),this.xo&&(this.xo.close(),o("close"),this.emit("close",null,"user"),this.xo=null),this._cleanup()},e.exports=s}).call(this)}).call(this,{env:{}})},{debug:55,events:3,inherits:57}],33:[function(t,i,n){(function(e,n){(function(){"use strict";var r,o,s=t("../../utils/random"),a=t("../../utils/url"),A=function(){};"production"!==e.env.NODE_ENV&&(A=t("debug")("sockjs-client:sender:jsonp")),i.exports=function(t,e,i){A(t,e),r||(A("createForm"),(r=n.document.createElement("form")).style.display="none",r.style.position="absolute",r.method="POST",r.enctype="application/x-www-form-urlencoded",r.acceptCharset="UTF-8",(o=n.document.createElement("textarea")).name="d",r.appendChild(o),n.document.body.appendChild(r));var l="a"+s.string(8);r.target=l,r.action=a.addQuery(a.addPath(t,"/jsonp_send"),"i="+l);var c=function(t){A("createIframe",t);try{return n.document.createElement('<iframe name="'+t+'">')}catch(i){var e=n.document.createElement("iframe");return e.name=t,e}}(l);c.id=l,c.style.display="none",r.appendChild(c);try{o.value=e}catch(t){}r.submit();var u=function(t){A("completed",l,t),c.onerror&&(c.onreadystatechange=c.onerror=c.onload=null,setTimeout((function(){A("cleaning up",l),c.parentNode.removeChild(c),c=null}),500),o.value="",i(t))};return c.onerror=function(){A("onerror",l),u()},c.onload=function(){A("onload",l),u()},c.onreadystatechange=function(t){A("onreadystatechange",l,c.readyState,t),"complete"===c.readyState&&u()},function(){A("aborted",l),u(new Error("Aborted"))}}}).call(this)}).call(this,{env:{}},void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../utils/random":50,"../../utils/url":52,debug:55}],34:[function(t,i,n){(function(e,n){(function(){"use strict";var r=t("events").EventEmitter,o=t("inherits"),s=t("../../utils/event"),a=t("../../utils/browser"),A=t("../../utils/url"),l=function(){};function c(t,e,i){l(t,e);var n=this;r.call(this),setTimeout((function(){n._start(t,e,i)}),0)}"production"!==e.env.NODE_ENV&&(l=t("debug")("sockjs-client:sender:xdr")),o(c,r),c.prototype._start=function(t,e,i){l("_start");var r=this,o=new n.XDomainRequest;e=A.addQuery(e,"t="+ +new Date),o.onerror=function(){l("onerror"),r._error()},o.ontimeout=function(){l("ontimeout"),r._error()},o.onprogress=function(){l("progress",o.responseText),r.emit("chunk",200,o.responseText)},o.onload=function(){l("load"),r.emit("finish",200,o.responseText),r._cleanup(!1)},this.xdr=o,this.unloadRef=s.unloadAdd((function(){r._cleanup(!0)}));try{this.xdr.open(t,e),this.timeout&&(this.xdr.timeout=this.timeout),this.xdr.send(i)}catch(t){this._error()}},c.prototype._error=function(){this.emit("finish",0,""),this._cleanup(!1)},c.prototype._cleanup=function(t){if(l("cleanup",t),this.xdr){if(this.removeAllListeners(),s.unloadDel(this.unloadRef),this.xdr.ontimeout=this.xdr.onerror=this.xdr.onprogress=this.xdr.onload=null,t)try{this.xdr.abort()}catch(t){}this.unloadRef=this.xdr=null}},c.prototype.close=function(){l("close"),this._cleanup(!0)},c.enabled=!(!n.XDomainRequest||!a.hasDomain()),i.exports=c}).call(this)}).call(this,{env:{}},void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../utils/browser":44,"../../utils/event":46,"../../utils/url":52,debug:55,events:3,inherits:57}],35:[function(t,e,i){"use strict";var n=t("inherits"),r=t("../driver/xhr");function o(t,e,i,n){r.call(this,t,e,i,n)}n(o,r),o.enabled=r.enabled&&r.supportsCORS,e.exports=o},{"../driver/xhr":17,inherits:57}],36:[function(t,e,i){"use strict";var n=t("events").EventEmitter;function r(){var t=this;n.call(this),this.to=setTimeout((function(){t.emit("finish",200,"{}")}),r.timeout)}t("inherits")(r,n),r.prototype.close=function(){clearTimeout(this.to)},r.timeout=2e3,e.exports=r},{events:3,inherits:57}],37:[function(t,e,i){"use strict";var n=t("inherits"),r=t("../driver/xhr");function o(t,e,i){r.call(this,t,e,i,{noCredentials:!0})}n(o,r),o.enabled=r.enabled,e.exports=o},{"../driver/xhr":17,inherits:57}],38:[function(t,e,i){(function(i){(function(){"use strict";var n=t("../utils/event"),r=t("../utils/url"),o=t("inherits"),s=t("events").EventEmitter,a=t("./driver/websocket"),A=function(){};function l(t,e,i){if(!l.enabled())throw new Error("Transport created when disabled");s.call(this),A("constructor",t);var o=this,c=r.addPath(t,"/websocket");c="https"===c.slice(0,5)?"wss"+c.slice(5):"ws"+c.slice(4),this.url=c,this.ws=new a(this.url,[],i),this.ws.onmessage=function(t){A("message event",t.data),o.emit("message",t.data)},this.unloadRef=n.unloadAdd((function(){A("unload"),o.ws.close()})),this.ws.onclose=function(t){A("close event",t.code,t.reason),o.emit("close",t.code,t.reason),o._cleanup()},this.ws.onerror=function(t){A("error event",t),o.emit("close",1006,"WebSocket connection broken"),o._cleanup()}}"production"!==i.env.NODE_ENV&&(A=t("debug")("sockjs-client:websocket")),o(l,s),l.prototype.send=function(t){var e="["+t+"]";A("send",e),this.ws.send(e)},l.prototype.close=function(){A("close");var t=this.ws;this._cleanup(),t&&t.close()},l.prototype._cleanup=function(){A("_cleanup");var t=this.ws;t&&(t.onmessage=t.onclose=t.onerror=null),n.unloadDel(this.unloadRef),this.unloadRef=this.ws=null,this.removeAllListeners()},l.enabled=function(){return A("enabled"),!!a},l.transportName="websocket",l.roundTrips=2,e.exports=l}).call(this)}).call(this,{env:{}})},{"../utils/event":46,"../utils/url":52,"./driver/websocket":19,debug:55,events:3,inherits:57}],39:[function(t,e,i){"use strict";var n=t("inherits"),r=t("./lib/ajax-based"),o=t("./xdr-streaming"),s=t("./receiver/xhr"),a=t("./sender/xdr");function A(t){if(!a.enabled)throw new Error("Transport created when disabled");r.call(this,t,"/xhr",s,a)}n(A,r),A.enabled=o.enabled,A.transportName="xdr-polling",A.roundTrips=2,e.exports=A},{"./lib/ajax-based":24,"./receiver/xhr":32,"./sender/xdr":34,"./xdr-streaming":40,inherits:57}],40:[function(t,e,i){"use strict";var n=t("inherits"),r=t("./lib/ajax-based"),o=t("./receiver/xhr"),s=t("./sender/xdr");function a(t){if(!s.enabled)throw new Error("Transport created when disabled");r.call(this,t,"/xhr_streaming",o,s)}n(a,r),a.enabled=function(t){return!t.cookie_needed&&!t.nullOrigin&&s.enabled&&t.sameScheme},a.transportName="xdr-streaming",a.roundTrips=2,e.exports=a},{"./lib/ajax-based":24,"./receiver/xhr":32,"./sender/xdr":34,inherits:57}],41:[function(t,e,i){"use strict";var n=t("inherits"),r=t("./lib/ajax-based"),o=t("./receiver/xhr"),s=t("./sender/xhr-cors"),a=t("./sender/xhr-local");function A(t){if(!a.enabled&&!s.enabled)throw new Error("Transport created when disabled");r.call(this,t,"/xhr",o,s)}n(A,r),A.enabled=function(t){return!t.nullOrigin&&(!(!a.enabled||!t.sameOrigin)||s.enabled)},A.transportName="xhr-polling",A.roundTrips=2,e.exports=A},{"./lib/ajax-based":24,"./receiver/xhr":32,"./sender/xhr-cors":35,"./sender/xhr-local":37,inherits:57}],42:[function(t,i,n){(function(e){(function(){"use strict";var n=t("inherits"),r=t("./lib/ajax-based"),o=t("./receiver/xhr"),s=t("./sender/xhr-cors"),a=t("./sender/xhr-local"),A=t("../utils/browser");function l(t){if(!a.enabled&&!s.enabled)throw new Error("Transport created when disabled");r.call(this,t,"/xhr_streaming",o,s)}n(l,r),l.enabled=function(t){return!t.nullOrigin&&!A.isOpera()&&s.enabled},l.transportName="xhr-streaming",l.roundTrips=2,l.needBody=!!e.document,i.exports=l}).call(this)}).call(this,void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../utils/browser":44,"./lib/ajax-based":24,"./receiver/xhr":32,"./sender/xhr-cors":35,"./sender/xhr-local":37,inherits:57}],43:[function(t,i,n){(function(t){(function(){"use strict";t.crypto&&t.crypto.getRandomValues?i.exports.randomBytes=function(e){var i=new Uint8Array(e);return t.crypto.getRandomValues(i),i}:i.exports.randomBytes=function(t){for(var e=new Array(t),i=0;i<t;i++)e[i]=Math.floor(256*Math.random());return e}}).call(this)}).call(this,void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],44:[function(t,i,n){(function(t){(function(){"use strict";i.exports={isOpera:function(){return t.navigator&&/opera/i.test(t.navigator.userAgent)},isKonqueror:function(){return t.navigator&&/konqueror/i.test(t.navigator.userAgent)},hasDomain:function(){if(!t.document)return!0;try{return!!t.document.domain}catch(t){return!1}}}}).call(this)}).call(this,void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],45:[function(t,e,i){"use strict";var n,r=/[\x00-\x1f\ud800-\udfff\ufffe\uffff\u0300-\u0333\u033d-\u0346\u034a-\u034c\u0350-\u0352\u0357-\u0358\u035c-\u0362\u0374\u037e\u0387\u0591-\u05af\u05c4\u0610-\u0617\u0653-\u0654\u0657-\u065b\u065d-\u065e\u06df-\u06e2\u06eb-\u06ec\u0730\u0732-\u0733\u0735-\u0736\u073a\u073d\u073f-\u0741\u0743\u0745\u0747\u07eb-\u07f1\u0951\u0958-\u095f\u09dc-\u09dd\u09df\u0a33\u0a36\u0a59-\u0a5b\u0a5e\u0b5c-\u0b5d\u0e38-\u0e39\u0f43\u0f4d\u0f52\u0f57\u0f5c\u0f69\u0f72-\u0f76\u0f78\u0f80-\u0f83\u0f93\u0f9d\u0fa2\u0fa7\u0fac\u0fb9\u1939-\u193a\u1a17\u1b6b\u1cda-\u1cdb\u1dc0-\u1dcf\u1dfc\u1dfe\u1f71\u1f73\u1f75\u1f77\u1f79\u1f7b\u1f7d\u1fbb\u1fbe\u1fc9\u1fcb\u1fd3\u1fdb\u1fe3\u1feb\u1fee-\u1fef\u1ff9\u1ffb\u1ffd\u2000-\u2001\u20d0-\u20d1\u20d4-\u20d7\u20e7-\u20e9\u2126\u212a-\u212b\u2329-\u232a\u2adc\u302b-\u302c\uaab2-\uaab3\uf900-\ufa0d\ufa10\ufa12\ufa15-\ufa1e\ufa20\ufa22\ufa25-\ufa26\ufa2a-\ufa2d\ufa30-\ufa6d\ufa70-\ufad9\ufb1d\ufb1f\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufb4e\ufff0-\uffff]/g;e.exports={quote:function(t){var e=JSON.stringify(t);return r.lastIndex=0,r.test(e)?(n||(n=function(t){var e,i={},n=[];for(e=0;e<65536;e++)n.push(String.fromCharCode(e));return t.lastIndex=0,n.join("").replace(t,(function(t){return i[t]="\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4),""})),t.lastIndex=0,i}(r)),e.replace(r,(function(t){return n[t]}))):e}}},{}],46:[function(t,i,n){(function(e){(function(){"use strict";var n=t("./random"),r={},o=!1,s=e.chrome&&e.chrome.app&&e.chrome.app.runtime;i.exports={attachEvent:function(t,i){void 0!==e.addEventListener?e.addEventListener(t,i,!1):e.document&&e.attachEvent&&(e.document.attachEvent("on"+t,i),e.attachEvent("on"+t,i))},detachEvent:function(t,i){void 0!==e.addEventListener?e.removeEventListener(t,i,!1):e.document&&e.detachEvent&&(e.document.detachEvent("on"+t,i),e.detachEvent("on"+t,i))},unloadAdd:function(t){if(s)return null;var e=n.string(8);return r[e]=t,o&&setTimeout(this.triggerUnloadCallbacks,0),e},unloadDel:function(t){t in r&&delete r[t]},triggerUnloadCallbacks:function(){for(var t in r)r[t](),delete r[t]}},s||i.exports.attachEvent("unload",(function(){o||(o=!0,i.exports.triggerUnloadCallbacks())}))}).call(this)}).call(this,void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./random":50}],47:[function(t,i,n){(function(e,n){(function(){"use strict";var r=t("./event"),o=t("./browser"),s=function(){};"production"!==e.env.NODE_ENV&&(s=t("debug")("sockjs-client:utils:iframe")),i.exports={WPrefix:"_jp",currentWindowId:null,polluteGlobalNamespace:function(){i.exports.WPrefix in n||(n[i.exports.WPrefix]={})},postMessage:function(t,e){n.parent!==n?n.parent.postMessage(JSON.stringify({windowId:i.exports.currentWindowId,type:t,data:e||""}),"*"):s("Cannot postMessage, no parent window.",t,e)},createIframe:function(t,e){var i,o,a=n.document.createElement("iframe"),A=function(){s("unattach"),clearTimeout(i);try{a.onload=null}catch(t){}a.onerror=null},l=function(){s("cleanup"),a&&(A(),setTimeout((function(){a&&a.parentNode.removeChild(a),a=null}),0),r.unloadDel(o))},c=function(t){s("onerror",t),a&&(l(),e(t))};return a.src=t,a.style.display="none",a.style.position="absolute",a.onerror=function(){c("onerror")},a.onload=function(){s("onload"),clearTimeout(i),i=setTimeout((function(){c("onload timeout")}),2e3)},n.document.body.appendChild(a),i=setTimeout((function(){c("timeout")}),15e3),o=r.unloadAdd(l),{post:function(t,e){s("post",t,e),setTimeout((function(){try{a&&a.contentWindow&&a.contentWindow.postMessage(t,e)}catch(t){}}),0)},cleanup:l,loaded:A}},createHtmlfile:function(t,e){var o,a,A,l=["Active"].concat("Object").join("X"),c=new n[l]("htmlfile"),u=function(){clearTimeout(o),A.onerror=null},h=function(){c&&(u(),r.unloadDel(a),A.parentNode.removeChild(A),A=c=null,CollectGarbage())},p=function(t){s("onerror",t),c&&(h(),e(t))};c.open(),c.write('<html><script>document.domain="'+n.document.domain+'";<\/script></html>'),c.close(),c.parentWindow[i.exports.WPrefix]=n[i.exports.WPrefix];var d=c.createElement("div");return c.body.appendChild(d),A=c.createElement("iframe"),d.appendChild(A),A.src=t,A.onerror=function(){p("onerror")},o=setTimeout((function(){p("timeout")}),15e3),a=r.unloadAdd(h),{post:function(t,e){try{setTimeout((function(){A&&A.contentWindow&&A.contentWindow.postMessage(t,e)}),0)}catch(t){}},cleanup:h,loaded:u}}},i.exports.iframeEnabled=!1,n.document&&(i.exports.iframeEnabled=("function"==typeof n.postMessage||"object"==typeof n.postMessage)&&!o.isKonqueror())}).call(this)}).call(this,{env:{}},void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./browser":44,"./event":46,debug:55}],48:[function(t,i,n){(function(t){(function(){"use strict";var e={};["log","debug","warn"].forEach((function(i){var n;try{n=t.console&&t.console[i]&&t.console[i].apply}catch(t){}e[i]=n?function(){return t.console[i].apply(t.console,arguments)}:"log"===i?function(){}:e.log})),i.exports=e}).call(this)}).call(this,void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],49:[function(t,e,i){"use strict";e.exports={isObject:function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},extend:function(t){if(!this.isObject(t))return t;for(var e,i,n=1,r=arguments.length;n<r;n++)for(i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}}},{}],50:[function(t,e,i){"use strict";var n=t("crypto");e.exports={string:function(t){for(var e="abcdefghijklmnopqrstuvwxyz012345".length,i=n.randomBytes(t),r=[],o=0;o<t;o++)r.push("abcdefghijklmnopqrstuvwxyz012345".substr(i[o]%e,1));return r.join("")},number:function(t){return Math.floor(Math.random()*t)},numberString:function(t){var e=(""+(t-1)).length;return(new Array(e+1).join("0")+this.number(t)).slice(-e)}}},{crypto:43}],51:[function(t,e,i){(function(i){(function(){"use strict";var n=function(){};"production"!==i.env.NODE_ENV&&(n=t("debug")("sockjs-client:utils:transport")),e.exports=function(t){return{filterToEnabled:function(e,i){var r={main:[],facade:[]};return e?"string"==typeof e&&(e=[e]):e=[],t.forEach((function(t){t&&("websocket"!==t.transportName||!1!==i.websocket?e.length&&-1===e.indexOf(t.transportName)?n("not in whitelist",t.transportName):t.enabled(i)?(n("enabled",t.transportName),r.main.push(t),t.facadeTransport&&r.facade.push(t.facadeTransport)):n("disabled",t.transportName):n("disabled from server","websocket"))})),r}}}}).call(this)}).call(this,{env:{}})},{debug:55}],52:[function(t,e,i){(function(i){(function(){"use strict";var n=t("url-parse"),r=function(){};"production"!==i.env.NODE_ENV&&(r=t("debug")("sockjs-client:utils:url")),e.exports={getOrigin:function(t){if(!t)return null;var e=new n(t);if("file:"===e.protocol)return null;var i=e.port;return i||(i="https:"===e.protocol?"443":"80"),e.protocol+"//"+e.hostname+":"+i},isOriginEqual:function(t,e){var i=this.getOrigin(t)===this.getOrigin(e);return r("same",t,e,i),i},isSchemeEqual:function(t,e){return t.split(":")[0]===e.split(":")[0]},addPath:function(t,e){var i=t.split("?");return i[0]+e+(i[1]?"?"+i[1]:"")},addQuery:function(t,e){return t+(-1===t.indexOf("?")?"?"+e:"&"+e)},isLoopbackAddr:function(t){return/^127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(t)||/^\[::1\]$/.test(t)}}}).call(this)}).call(this,{env:{}})},{debug:55,"url-parse":60}],53:[function(t,e,i){e.exports="1.6.1"},{}],54:[function(t,e,i){var n=1e3,r=6e4,o=60*r,s=24*o;function a(t,e,i,n){var r=e>=1.5*i;return Math.round(t/i)+" "+n+(r?"s":"")}e.exports=function(t,e){e=e||{};var i,A,l=typeof t;if("string"===l&&t.length>0)return function(t){if(!((t=String(t)).length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(e){var i=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*i;case"weeks":case"week":case"w":return 6048e5*i;case"days":case"day":case"d":return i*s;case"hours":case"hour":case"hrs":case"hr":case"h":return i*o;case"minutes":case"minute":case"mins":case"min":case"m":return i*r;case"seconds":case"second":case"secs":case"sec":case"s":return i*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return i;default:return}}}}(t);if("number"===l&&isFinite(t))return e.long?(i=t,(A=Math.abs(i))>=s?a(i,A,s,"day"):A>=o?a(i,A,o,"hour"):A>=r?a(i,A,r,"minute"):A>=n?a(i,A,n,"second"):i+" ms"):function(t){var e=Math.abs(t);return e>=s?Math.round(t/s)+"d":e>=o?Math.round(t/o)+"h":e>=r?Math.round(t/r)+"m":e>=n?Math.round(t/n)+"s":t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},{}],55:[function(t,e,i){(function(n){(function(){i.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const i="color: "+this.color;t.splice(1,0,i,"color: inherit");let n=0,r=0;t[0].replace(/%[a-zA-Z%]/g,t=>{"%%"!==t&&(n++,"%c"===t&&(r=n))}),t.splice(r,0,i)},i.save=function(t){try{t?i.storage.setItem("debug",t):i.storage.removeItem("debug")}catch(t){}},i.load=function(){let t;try{t=i.storage.getItem("debug")}catch(t){}return!t&&void 0!==n&&"env"in n&&(t=n.env.DEBUG),t},i.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},i.storage=function(){try{return localStorage}catch(t){}}(),i.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),i.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],i.log=console.debug||console.log||(()=>{}),e.exports=t("./common")(i);const{formatters:r}=e.exports;r.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}}).call(this)}).call(this,{env:{}})},{"./common":56}],56:[function(t,e,i){e.exports=function(e){function i(t){let e,r,o,s=null;function a(...t){if(!a.enabled)return;const n=a,r=Number(new Date),o=r-(e||r);n.diff=o,n.prev=e,n.curr=r,e=r,t[0]=i.coerce(t[0]),"string"!=typeof t[0]&&t.unshift("%O");let s=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,(e,r)=>{if("%%"===e)return"%";s++;const o=i.formatters[r];if("function"==typeof o){const i=t[s];e=o.call(n,i),t.splice(s,1),s--}return e}),i.formatArgs.call(n,t),(n.log||i.log).apply(n,t)}return a.namespace=t,a.useColors=i.useColors(),a.color=i.selectColor(t),a.extend=n,a.destroy=i.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==s?s:(r!==i.namespaces&&(r=i.namespaces,o=i.enabled(t)),o),set:t=>{s=t}}),"function"==typeof i.init&&i.init(a),a}function n(t,e){const n=i(this.namespace+(void 0===e?":":e)+t);return n.log=this.log,n}function r(t){return t.toString().substring(2,t.toString().length-2).replace(/\.\*\?$/,"*")}return i.debug=i,i.default=i,i.coerce=function(t){return t instanceof Error?t.stack||t.message:t},i.disable=function(){const t=[...i.names.map(r),...i.skips.map(r).map(t=>"-"+t)].join(",");return i.enable(""),t},i.enable=function(t){let e;i.save(t),i.namespaces=t,i.names=[],i.skips=[];const n=("string"==typeof t?t:"").split(/[\s,]+/),r=n.length;for(e=0;e<r;e++)n[e]&&("-"===(t=n[e].replace(/\*/g,".*?"))[0]?i.skips.push(new RegExp("^"+t.substr(1)+"$")):i.names.push(new RegExp("^"+t+"$")))},i.enabled=function(t){if("*"===t[t.length-1])return!0;let e,n;for(e=0,n=i.skips.length;e<n;e++)if(i.skips[e].test(t))return!1;for(e=0,n=i.names.length;e<n;e++)if(i.names[e].test(t))return!0;return!1},i.humanize=t("ms"),i.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach(t=>{i[t]=e[t]}),i.names=[],i.skips=[],i.formatters={},i.selectColor=function(t){let e=0;for(let i=0;i<t.length;i++)e=(e<<5)-e+t.charCodeAt(i),e|=0;return i.colors[Math.abs(e)%i.colors.length]},i.enable(i.load()),i}},{ms:54}],57:[function(t,e,i){"function"==typeof Object.create?e.exports=function(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(t,e){if(e){t.super_=e;var i=function(){};i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t}}},{}],58:[function(t,e,i){"use strict";var n=Object.prototype.hasOwnProperty;function r(t){try{return decodeURIComponent(t.replace(/\+/g," "))}catch(t){return null}}i.stringify=function(t,e){e=e||"";var i,r,o=[];for(r in"string"!=typeof e&&(e="?"),t)if(n.call(t,r)){if((i=t[r])||null!=i&&!isNaN(i)||(i=""),r=encodeURIComponent(r),i=encodeURIComponent(i),null===r||null===i)continue;o.push(r+"="+i)}return o.length?e+o.join("&"):""},i.parse=function(t){for(var e,i=/([^=?&]+)=?([^&]*)/g,n={};e=i.exec(t);){var o=r(e[1]),s=r(e[2]);null===o||null===s||o in n||(n[o]=s)}return n}},{}],59:[function(t,e,i){"use strict";e.exports=function(t,e){if(e=e.split(":")[0],!(t=+t))return!1;switch(e){case"http":case"ws":return 80!==t;case"https":case"wss":return 443!==t;case"ftp":return 21!==t;case"gopher":return 70!==t;case"file":return!1}return 0!==t}},{}],60:[function(t,i,n){(function(e){(function(){"use strict";var n=t("requires-port"),r=t("querystringify"),o=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,s=/[\n\r\t]/g,a=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,A=/:\d+$/,l=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,c=/^[a-zA-Z]:/;function u(t){return(t||"").toString().replace(o,"")}var h=[["#","hash"],["?","query"],function(t,e){return f(e.protocol)?t.replace(/\\/g,"/"):t},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],p={hash:1,query:1};function d(t){var i,n=("undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{}).location||{},r={},o=typeof(t=t||n);if("blob:"===t.protocol)r=new m(unescape(t.pathname),{});else if("string"===o)for(i in r=new m(t,{}),p)delete r[i];else if("object"===o){for(i in t)i in p||(r[i]=t[i]);void 0===r.slashes&&(r.slashes=a.test(t.href))}return r}function f(t){return"file:"===t||"ftp:"===t||"http:"===t||"https:"===t||"ws:"===t||"wss:"===t}function g(t,e){t=(t=u(t)).replace(s,""),e=e||{};var i,n=l.exec(t),r=n[1]?n[1].toLowerCase():"",o=!!n[2],a=!!n[3],A=0;return o?a?(i=n[2]+n[3]+n[4],A=n[2].length+n[3].length):(i=n[2]+n[4],A=n[2].length):a?(i=n[3]+n[4],A=n[3].length):i=n[4],"file:"===r?A>=2&&(i=i.slice(2)):f(r)?i=n[4]:r?o&&(i=i.slice(2)):A>=2&&f(e.protocol)&&(i=n[4]),{protocol:r,slashes:o||f(r),slashesCount:A,rest:i}}function m(t,e,i){if(t=(t=u(t)).replace(s,""),!(this instanceof m))return new m(t,e,i);var o,a,A,l,p,y,v=h.slice(),_=typeof e,w=this,C=0;for("object"!==_&&"string"!==_&&(i=e,e=null),i&&"function"!=typeof i&&(i=r.parse),o=!(a=g(t||"",e=d(e))).protocol&&!a.slashes,w.slashes=a.slashes||o&&e.slashes,w.protocol=a.protocol||e.protocol||"",t=a.rest,("file:"===a.protocol&&(2!==a.slashesCount||c.test(t))||!a.slashes&&(a.protocol||a.slashesCount<2||!f(w.protocol)))&&(v[3]=[/(.*)/,"pathname"]);C<v.length;C++)"function"!=typeof(l=v[C])?(A=l[0],y=l[1],A!=A?w[y]=t:"string"==typeof A?~(p="@"===A?t.lastIndexOf(A):t.indexOf(A))&&("number"==typeof l[2]?(w[y]=t.slice(0,p),t=t.slice(p+l[2])):(w[y]=t.slice(p),t=t.slice(0,p))):(p=A.exec(t))&&(w[y]=p[1],t=t.slice(0,p.index)),w[y]=w[y]||o&&l[3]&&e[y]||"",l[4]&&(w[y]=w[y].toLowerCase())):t=l(t,w);i&&(w.query=i(w.query)),o&&e.slashes&&"/"!==w.pathname.charAt(0)&&(""!==w.pathname||""!==e.pathname)&&(w.pathname=function(t,e){if(""===t)return e;for(var i=(e||"/").split("/").slice(0,-1).concat(t.split("/")),n=i.length,r=i[n-1],o=!1,s=0;n--;)"."===i[n]?i.splice(n,1):".."===i[n]?(i.splice(n,1),s++):s&&(0===n&&(o=!0),i.splice(n,1),s--);return o&&i.unshift(""),"."!==r&&".."!==r||i.push(""),i.join("/")}(w.pathname,e.pathname)),"/"!==w.pathname.charAt(0)&&f(w.protocol)&&(w.pathname="/"+w.pathname),n(w.port,w.protocol)||(w.host=w.hostname,w.port=""),w.username=w.password="",w.auth&&(~(p=w.auth.indexOf(":"))?(w.username=w.auth.slice(0,p),w.username=encodeURIComponent(decodeURIComponent(w.username)),w.password=w.auth.slice(p+1),w.password=encodeURIComponent(decodeURIComponent(w.password))):w.username=encodeURIComponent(decodeURIComponent(w.auth)),w.auth=w.password?w.username+":"+w.password:w.username),w.origin="file:"!==w.protocol&&f(w.protocol)&&w.host?w.protocol+"//"+w.host:"null",w.href=w.toString()}m.prototype={set:function(t,e,i){var o=this;switch(t){case"query":"string"==typeof e&&e.length&&(e=(i||r.parse)(e)),o[t]=e;break;case"port":o[t]=e,n(e,o.protocol)?e&&(o.host=o.hostname+":"+e):(o.host=o.hostname,o[t]="");break;case"hostname":o[t]=e,o.port&&(e+=":"+o.port),o.host=e;break;case"host":o[t]=e,A.test(e)?(e=e.split(":"),o.port=e.pop(),o.hostname=e.join(":")):(o.hostname=e,o.port="");break;case"protocol":o.protocol=e.toLowerCase(),o.slashes=!i;break;case"pathname":case"hash":if(e){var s="pathname"===t?"/":"#";o[t]=e.charAt(0)!==s?s+e:e}else o[t]=e;break;case"username":case"password":o[t]=encodeURIComponent(e);break;case"auth":var a=e.indexOf(":");~a?(o.username=e.slice(0,a),o.username=encodeURIComponent(decodeURIComponent(o.username)),o.password=e.slice(a+1),o.password=encodeURIComponent(decodeURIComponent(o.password))):o.username=encodeURIComponent(decodeURIComponent(e))}for(var l=0;l<h.length;l++){var c=h[l];c[4]&&(o[c[1]]=o[c[1]].toLowerCase())}return o.auth=o.password?o.username+":"+o.password:o.username,o.origin="file:"!==o.protocol&&f(o.protocol)&&o.host?o.protocol+"//"+o.host:"null",o.href=o.toString(),o},toString:function(t){t&&"function"==typeof t||(t=r.stringify);var e,i=this,n=i.host,o=i.protocol;o&&":"!==o.charAt(o.length-1)&&(o+=":");var s=o+(i.protocol&&i.slashes||f(i.protocol)?"//":"");return i.username?(s+=i.username,i.password&&(s+=":"+i.password),s+="@"):i.password?(s+=":"+i.password,s+="@"):"file:"!==i.protocol&&f(i.protocol)&&!n&&"/"!==i.pathname&&(s+="@"),(":"===n[n.length-1]||A.test(i.hostname)&&!i.port)&&(n+=":"),s+=n+i.pathname,(e="object"==typeof i.query?t(i.query):i.query)&&(s+="?"!==e.charAt(0)?"?"+e:e),i.hash&&(s+=i.hash),s}},m.extractProtocol=g,m.location=d,m.trimLeft=u,m.qs=r,i.exports=m}).call(this)}).call(this,void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{querystringify:58,"requires-port":59}]},{},[1])(1)}).call(this,i(7))},function(t,e,i){var n;"undefined"!=typeof self&&self,n=function(){return function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}({"./src/byte.ts":
/*!*********************!*\
  !*** ./src/byte.ts ***!
  \*********************/
/*! no static exports found */function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BYTE={LF:"\n",NULL:"\0"}},"./src/client.ts":
/*!***********************!*\
  !*** ./src/client.ts ***!
  \***********************/
/*! no static exports found */function(t,e,i){"use strict";var n=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(r,o){function s(t){try{A(n.next(t))}catch(t){o(t)}}function a(t){try{A(n.throw(t))}catch(t){o(t)}}function A(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(s,a)}A((n=n.apply(t,e||[])).next())}))},r=this&&this.__generator||function(t,e){var i,n,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,n&&(r=2&o[0]?n.return:o[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,o[1])).done)return r;switch(n=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((r=(r=s.trys).length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],n=0}finally{i=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(e,"__esModule",{value:!0});var o=i(/*! ./stomp-handler */"./src/stomp-handler.ts"),s=i(/*! ./versions */"./src/versions.ts"),a=i(/*! ./web-socket-state */"./src/web-socket-state.ts"),A=function(){function t(t){void 0===t&&(t={}),this.stompVersions=s.Versions.default,this.reconnectDelay=5e3,this.heartbeatIncoming=1e4,this.heartbeatOutgoing=1e4,this.splitLargeFrames=!1,this.maxWebSocketChunkSize=8192,this.forceBinaryWSFrames=!1,this.appendMissingNULLonIncoming=!1,this._active=!1;var e=function(){};this.debug=e,this.beforeConnect=e,this.onConnect=e,this.onDisconnect=e,this.onUnhandledMessage=e,this.onUnhandledReceipt=e,this.onUnhandledFrame=e,this.onStompError=e,this.onWebSocketClose=e,this.onWebSocketError=e,this.logRawCommunication=!1,this.connectHeaders={},this._disconnectHeaders={},this.configure(t)}return Object.defineProperty(t.prototype,"webSocket",{get:function(){return this._webSocket},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"disconnectHeaders",{get:function(){return this._disconnectHeaders},set:function(t){this._disconnectHeaders=t,this._stompHandler&&(this._stompHandler.disconnectHeaders=this._disconnectHeaders)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"connected",{get:function(){return!!this._stompHandler&&this._stompHandler.connected},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"connectedVersion",{get:function(){return this._stompHandler?this._stompHandler.connectedVersion:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"active",{get:function(){return this._active},enumerable:!0,configurable:!0}),t.prototype.configure=function(t){Object.assign(this,t)},t.prototype.activate=function(){this._active=!0,this._connect()},t.prototype._connect=function(){return n(this,void 0,void 0,(function(){var t=this;return r(this,(function(e){switch(e.label){case 0:return this.connected?(this.debug("STOMP: already connected, nothing to do"),[2]):[4,this.beforeConnect()];case 1:return e.sent(),this._active?(this.debug("Opening Web Socket..."),this._webSocket=this._createWebSocket(),this._stompHandler=new o.StompHandler(this,this._webSocket,{debug:this.debug,stompVersions:this.stompVersions,connectHeaders:this.connectHeaders,disconnectHeaders:this._disconnectHeaders,heartbeatIncoming:this.heartbeatIncoming,heartbeatOutgoing:this.heartbeatOutgoing,splitLargeFrames:this.splitLargeFrames,maxWebSocketChunkSize:this.maxWebSocketChunkSize,forceBinaryWSFrames:this.forceBinaryWSFrames,logRawCommunication:this.logRawCommunication,appendMissingNULLonIncoming:this.appendMissingNULLonIncoming,onConnect:function(e){if(!t._active)return t.debug("STOMP got connected while deactivate was issued, will disconnect now"),void t._disposeStompHandler();t.onConnect(e)},onDisconnect:function(e){t.onDisconnect(e)},onStompError:function(e){t.onStompError(e)},onWebSocketClose:function(e){t.onWebSocketClose(e),t._active&&t._schedule_reconnect()},onWebSocketError:function(e){t.onWebSocketError(e)},onUnhandledMessage:function(e){t.onUnhandledMessage(e)},onUnhandledReceipt:function(e){t.onUnhandledReceipt(e)},onUnhandledFrame:function(e){t.onUnhandledFrame(e)}}),this._stompHandler.start(),[2]):(this.debug("Client has been marked inactive, will not attempt to connect"),[2])}}))}))},t.prototype._createWebSocket=function(){var t;return(t=this.webSocketFactory?this.webSocketFactory():new WebSocket(this.brokerURL,this.stompVersions.protocolVersions())).binaryType="arraybuffer",t},t.prototype._schedule_reconnect=function(){var t=this;this.reconnectDelay>0&&(this.debug("STOMP: scheduling reconnection in "+this.reconnectDelay+"ms"),this._reconnector=setTimeout((function(){t._connect()}),this.reconnectDelay))},t.prototype.deactivate=function(){this._active=!1,this._reconnector&&clearTimeout(this._reconnector),this._disposeStompHandler()},t.prototype.forceDisconnect=function(){this._webSocket&&(this._webSocket.readyState!==a.WebSocketState.CONNECTING&&this._webSocket.readyState!==a.WebSocketState.OPEN||this._stompHandler._closeWebsocket())},t.prototype._disposeStompHandler=function(){this._stompHandler&&(this._stompHandler.dispose(),this._stompHandler=null)},t.prototype.publish=function(t){this._stompHandler.publish(t)},t.prototype.watchForReceipt=function(t,e){this._stompHandler.watchForReceipt(t,e)},t.prototype.subscribe=function(t,e,i){return void 0===i&&(i={}),this._stompHandler.subscribe(t,e,i)},t.prototype.unsubscribe=function(t,e){void 0===e&&(e={}),this._stompHandler.unsubscribe(t,e)},t.prototype.begin=function(t){return this._stompHandler.begin(t)},t.prototype.commit=function(t){this._stompHandler.commit(t)},t.prototype.abort=function(t){this._stompHandler.abort(t)},t.prototype.ack=function(t,e,i){void 0===i&&(i={}),this._stompHandler.ack(t,e,i)},t.prototype.nack=function(t,e,i){void 0===i&&(i={}),this._stompHandler.nack(t,e,i)},t}();e.Client=A},"./src/compatibility/compat-client.ts":
/*!********************************************!*\
  !*** ./src/compatibility/compat-client.ts ***!
  \********************************************/
/*! no static exports found */function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=i(/*! ../client */"./src/client.ts"),s=i(/*! ./heartbeat-info */"./src/compatibility/heartbeat-info.ts"),a=function(t){function e(e){var i=t.call(this)||this;return i.maxWebSocketFrameSize=16384,i._heartbeatInfo=new s.HeartbeatInfo(i),i.reconnect_delay=0,i.webSocketFactory=e,i.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];console.log.apply(console,t)},i}return r(e,t),e.prototype._parseConnect=function(){for(var t,e,i,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o={};if(n.length<2)throw new Error("Connect requires at least 2 arguments");if("function"==typeof n[1])o=n[0],e=n[1],i=n[2],t=n[3];else switch(n.length){case 6:o.login=n[0],o.passcode=n[1],e=n[2],i=n[3],t=n[4],o.host=n[5];break;default:o.login=n[0],o.passcode=n[1],e=n[2],i=n[3],t=n[4]}return[o,e,i,t]},e.prototype.connect=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];var n=this._parseConnect.apply(this,e);n[0]&&(this.connectHeaders=n[0]),n[1]&&(this.onConnect=n[1]),n[2]&&(this.onStompError=n[2]),n[3]&&(this.onWebSocketClose=n[3]),t.prototype.activate.call(this)},e.prototype.disconnect=function(e,i){void 0===i&&(i={}),e&&(this.onDisconnect=e),this.disconnectHeaders=i,t.prototype.deactivate.call(this)},e.prototype.send=function(t,e,i){void 0===e&&(e={}),void 0===i&&(i="");var n=!1===(e=Object.assign({},e))["content-length"];n&&delete e["content-length"],this.publish({destination:t,headers:e,body:i,skipContentLengthHeader:n})},Object.defineProperty(e.prototype,"reconnect_delay",{set:function(t){this.reconnectDelay=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ws",{get:function(){return this._webSocket},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return this.connectedVersion},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onreceive",{get:function(){return this.onUnhandledMessage},set:function(t){this.onUnhandledMessage=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onreceipt",{get:function(){return this.onUnhandledReceipt},set:function(t){this.onUnhandledReceipt=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"heartbeat",{get:function(){return this._heartbeatInfo},set:function(t){this.heartbeatIncoming=t.incoming,this.heartbeatOutgoing=t.outgoing},enumerable:!0,configurable:!0}),e}(o.Client);e.CompatClient=a},"./src/compatibility/heartbeat-info.ts":
/*!*********************************************!*\
  !*** ./src/compatibility/heartbeat-info.ts ***!
  \*********************************************/
/*! no static exports found */function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t){this.client=t}return Object.defineProperty(t.prototype,"outgoing",{get:function(){return this.client.heartbeatOutgoing},set:function(t){this.client.heartbeatOutgoing=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"incoming",{get:function(){return this.client.heartbeatIncoming},set:function(t){this.client.heartbeatIncoming=t},enumerable:!0,configurable:!0}),t}();e.HeartbeatInfo=n},"./src/compatibility/stomp.ts":
/*!************************************!*\
  !*** ./src/compatibility/stomp.ts ***!
  \************************************/
/*! no static exports found */function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(/*! ../versions */"./src/versions.ts"),r=i(/*! ./compat-client */"./src/compatibility/compat-client.ts"),o=function(){function t(){}return t.client=function(e,i){return null==i&&(i=n.Versions.default.protocolVersions()),new r.CompatClient((function(){return new(t.WebSocketClass||WebSocket)(e,i)}))},t.over=function(t){var e;return"function"==typeof t?e=t:(console.warn("Stomp.over did not receive a factory, auto reconnect will not work. Please see https://stomp-js.github.io/api-docs/latest/classes/Stomp.html#over"),e=function(){return t}),new r.CompatClient(e)},t.WebSocketClass=null,t}();e.Stomp=o},"./src/frame-impl.ts":
/*!***************************!*\
  !*** ./src/frame-impl.ts ***!
  \***************************/
/*! no static exports found */function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(/*! ./byte */"./src/byte.ts"),r=function(){function t(t){var e=t.command,i=t.headers,n=t.body,r=t.binaryBody,o=t.escapeHeaderValues,s=t.skipContentLengthHeader;this.command=e,this.headers=Object.assign({},i||{}),r?(this._binaryBody=r,this.isBinaryBody=!0):(this._body=n||"",this.isBinaryBody=!1),this.escapeHeaderValues=o||!1,this.skipContentLengthHeader=s||!1}return Object.defineProperty(t.prototype,"body",{get:function(){return!this._body&&this.isBinaryBody&&(this._body=(new TextDecoder).decode(this._binaryBody)),this._body},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"binaryBody",{get:function(){return this._binaryBody||this.isBinaryBody||(this._binaryBody=(new TextEncoder).encode(this._body)),this._binaryBody},enumerable:!0,configurable:!0}),t.fromRawFrame=function(e,i){for(var n={},r=function(t){return t.replace(/^\s+|\s+$/g,"")},o=0,s=e.headers.reverse();o<s.length;o++){var a=s[o],A=(a.indexOf(":"),r(a[0])),l=r(a[1]);i&&"CONNECT"!==e.command&&"CONNECTED"!==e.command&&(l=t.hdrValueUnEscape(l)),n[A]=l}return new t({command:e.command,headers:n,binaryBody:e.binaryBody,escapeHeaderValues:i})},t.prototype.toString=function(){return this.serializeCmdAndHeaders()},t.prototype.serialize=function(){var e=this.serializeCmdAndHeaders();return this.isBinaryBody?t.toUnit8Array(e,this._binaryBody).buffer:e+this._body+n.BYTE.NULL},t.prototype.serializeCmdAndHeaders=function(){var e=[this.command];this.skipContentLengthHeader&&delete this.headers["content-length"];for(var i=0,r=Object.keys(this.headers||{});i<r.length;i++){var o=r[i],s=this.headers[o];this.escapeHeaderValues&&"CONNECT"!==this.command&&"CONNECTED"!==this.command?e.push(o+":"+t.hdrValueEscape(""+s)):e.push(o+":"+s)}return(this.isBinaryBody||!this.isBodyEmpty()&&!this.skipContentLengthHeader)&&e.push("content-length:"+this.bodyLength()),e.join(n.BYTE.LF)+n.BYTE.LF+n.BYTE.LF},t.prototype.isBodyEmpty=function(){return 0===this.bodyLength()},t.prototype.bodyLength=function(){var t=this.binaryBody;return t?t.length:0},t.sizeOfUTF8=function(t){return t?(new TextEncoder).encode(t).length:0},t.toUnit8Array=function(t,e){var i=(new TextEncoder).encode(t),n=new Uint8Array([0]),r=new Uint8Array(i.length+e.length+n.length);return r.set(i),r.set(e,i.length),r.set(n,i.length+e.length),r},t.marshall=function(e){return new t(e).serialize()},t.hdrValueEscape=function(t){return t.replace(/\\/g,"\\\\").replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/:/g,"\\c")},t.hdrValueUnEscape=function(t){return t.replace(/\\r/g,"\r").replace(/\\n/g,"\n").replace(/\\c/g,":").replace(/\\\\/g,"\\")},t}();e.FrameImpl=r},"./src/index.ts":
/*!**********************!*\
  !*** ./src/index.ts ***!
  \**********************/
/*! no static exports found */function(t,e,i){"use strict";function n(t){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])}Object.defineProperty(e,"__esModule",{value:!0}),n(i(/*! ./client */"./src/client.ts")),n(i(/*! ./frame-impl */"./src/frame-impl.ts")),n(i(/*! ./parser */"./src/parser.ts")),n(i(/*! ./stomp-config */"./src/stomp-config.ts")),n(i(/*! ./stomp-headers */"./src/stomp-headers.ts")),n(i(/*! ./stomp-subscription */"./src/stomp-subscription.ts")),n(i(/*! ./versions */"./src/versions.ts")),n(i(/*! ./web-socket-state */"./src/web-socket-state.ts")),n(i(/*! ./compatibility/compat-client */"./src/compatibility/compat-client.ts")),n(i(/*! ./compatibility/stomp */"./src/compatibility/stomp.ts"))},"./src/parser.ts":
/*!***********************!*\
  !*** ./src/parser.ts ***!
  \***********************/
/*! no static exports found */function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){this.onFrame=t,this.onIncomingPing=e,this._encoder=new TextEncoder,this._decoder=new TextDecoder,this._token=[],this._initState()}return t.prototype.parseChunk=function(t,e){var i;if(void 0===e&&(e=!1),i=t instanceof ArrayBuffer?new Uint8Array(t):this._encoder.encode(t),e&&0!==i[i.length-1]){var n=new Uint8Array(i.length+1);n.set(i,0),n[i.length]=0,i=n}for(var r=0;r<i.length;r++){var o=i[r];this._onByte(o)}},t.prototype._collectFrame=function(t){0!==t&&13!==t&&(10!==t?(this._onByte=this._collectCommand,this._reinjectByte(t)):this.onIncomingPing())},t.prototype._collectCommand=function(t){if(13!==t)return 10===t?(this._results.command=this._consumeTokenAsUTF8(),void(this._onByte=this._collectHeaders)):void this._consumeByte(t)},t.prototype._collectHeaders=function(t){13!==t&&(10!==t?(this._onByte=this._collectHeaderKey,this._reinjectByte(t)):this._setupCollectBody())},t.prototype._reinjectByte=function(t){this._onByte(t)},t.prototype._collectHeaderKey=function(t){if(58===t)return this._headerKey=this._consumeTokenAsUTF8(),void(this._onByte=this._collectHeaderValue);this._consumeByte(t)},t.prototype._collectHeaderValue=function(t){if(13!==t)return 10===t?(this._results.headers.push([this._headerKey,this._consumeTokenAsUTF8()]),this._headerKey=void 0,void(this._onByte=this._collectHeaders)):void this._consumeByte(t)},t.prototype._setupCollectBody=function(){var t=this._results.headers.filter((function(t){return"content-length"===t[0]}))[0];t?(this._bodyBytesRemaining=parseInt(t[1],10),this._onByte=this._collectBodyFixedSize):this._onByte=this._collectBodyNullTerminated},t.prototype._collectBodyNullTerminated=function(t){0!==t?this._consumeByte(t):this._retrievedBody()},t.prototype._collectBodyFixedSize=function(t){0!=this._bodyBytesRemaining--?this._consumeByte(t):this._retrievedBody()},t.prototype._retrievedBody=function(){this._results.binaryBody=this._consumeTokenAsRaw(),this.onFrame(this._results),this._initState()},t.prototype._consumeByte=function(t){this._token.push(t)},t.prototype._consumeTokenAsUTF8=function(){return this._decoder.decode(this._consumeTokenAsRaw())},t.prototype._consumeTokenAsRaw=function(){var t=new Uint8Array(this._token);return this._token=[],t},t.prototype._initState=function(){this._results={command:void 0,headers:[],binaryBody:void 0},this._token=[],this._headerKey=void 0,this._onByte=this._collectFrame},t}();e.Parser=n},"./src/stomp-config.ts":
/*!*****************************!*\
  !*** ./src/stomp-config.ts ***!
  \*****************************/
/*! no static exports found */function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){};e.StompConfig=n},"./src/stomp-handler.ts":
/*!******************************!*\
  !*** ./src/stomp-handler.ts ***!
  \******************************/
/*! no static exports found */function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(/*! ./byte */"./src/byte.ts"),r=i(/*! ./frame-impl */"./src/frame-impl.ts"),o=i(/*! ./parser */"./src/parser.ts"),s=i(/*! ./versions */"./src/versions.ts"),a=i(/*! ./web-socket-state */"./src/web-socket-state.ts"),A=function(){function t(t,e,i){var n=this;void 0===i&&(i={}),this._client=t,this._webSocket=e,this._serverFrameHandlers={CONNECTED:function(t){n.debug("connected to server "+t.headers.server),n._connected=!0,n._connectedVersion=t.headers.version,n._connectedVersion===s.Versions.V1_2&&(n._escapeHeaderValues=!0),n._setupHeartbeat(t.headers),n.onConnect(t)},MESSAGE:function(t){var e=t.headers.subscription,i=n._subscriptions[e]||n.onUnhandledMessage,r=t,o=n,a=n._connectedVersion===s.Versions.V1_2?r.headers.ack:r.headers["message-id"];r.ack=function(t){return void 0===t&&(t={}),o.ack(a,e,t)},r.nack=function(t){return void 0===t&&(t={}),o.nack(a,e,t)},i(r)},RECEIPT:function(t){var e=n._receiptWatchers[t.headers["receipt-id"]];e?(e(t),delete n._receiptWatchers[t.headers["receipt-id"]]):n.onUnhandledReceipt(t)},ERROR:function(t){n.onStompError(t)}},this._counter=0,this._subscriptions={},this._receiptWatchers={},this._partialData="",this._escapeHeaderValues=!1,this._lastServerActivityTS=Date.now(),this.configure(i)}return Object.defineProperty(t.prototype,"connectedVersion",{get:function(){return this._connectedVersion},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"connected",{get:function(){return this._connected},enumerable:!0,configurable:!0}),t.prototype.configure=function(t){Object.assign(this,t)},t.prototype.start=function(){var t=this,e=new o.Parser((function(e){var i=r.FrameImpl.fromRawFrame(e,t._escapeHeaderValues);t.logRawCommunication||t.debug("<<< "+i),(t._serverFrameHandlers[i.command]||t.onUnhandledFrame)(i)}),(function(){t.debug("<<< PONG")}));this._webSocket.onmessage=function(i){if(t.debug("Received data"),t._lastServerActivityTS=Date.now(),t.logRawCommunication){var n=i.data instanceof ArrayBuffer?(new TextDecoder).decode(i.data):i.data;t.debug("<<< "+n)}e.parseChunk(i.data,t.appendMissingNULLonIncoming)},this._webSocket.onclose=function(e){t.debug("Connection closed to "+t._webSocket.url),t.onWebSocketClose(e),t._cleanUp()},this._webSocket.onerror=function(e){t.onWebSocketError(e)},this._webSocket.onopen=function(){var e=Object.assign({},t.connectHeaders);t.debug("Web Socket Opened..."),e["accept-version"]=t.stompVersions.supportedVersions(),e["heart-beat"]=[t.heartbeatOutgoing,t.heartbeatIncoming].join(","),t._transmit({command:"CONNECT",headers:e})}},t.prototype._setupHeartbeat=function(t){var e=this;if((t.version===s.Versions.V1_1||t.version===s.Versions.V1_2)&&t["heart-beat"]){var i=t["heart-beat"].split(",").map((function(t){return parseInt(t,10)})),r=i[0],o=i[1];if(0!==this.heartbeatOutgoing&&0!==o){var A=Math.max(this.heartbeatOutgoing,o);this.debug("send PING every "+A+"ms"),this._pinger=setInterval((function(){e._webSocket.readyState===a.WebSocketState.OPEN&&(e._webSocket.send(n.BYTE.LF),e.debug(">>> PING"))}),A)}if(0!==this.heartbeatIncoming&&0!==r){var l=Math.max(this.heartbeatIncoming,r);this.debug("check PONG every "+l+"ms"),this._ponger=setInterval((function(){var t=Date.now()-e._lastServerActivityTS;t>2*l&&(e.debug("did not receive server activity for the last "+t+"ms"),e._closeWebsocket())}),l)}}},t.prototype._closeWebsocket=function(){this._webSocket.onmessage=function(){},this._webSocket.close()},t.prototype._transmit=function(t){var e=t.command,i=t.headers,n=t.body,o=t.binaryBody,s=t.skipContentLengthHeader,a=new r.FrameImpl({command:e,headers:i,body:n,binaryBody:o,escapeHeaderValues:this._escapeHeaderValues,skipContentLengthHeader:s}),A=a.serialize();if(this.logRawCommunication?this.debug(">>> "+A):this.debug(">>> "+a),this.forceBinaryWSFrames&&"string"==typeof A&&(A=(new TextEncoder).encode(A)),"string"==typeof A&&this.splitLargeFrames)for(var l=A;l.length>0;){var c=l.substring(0,this.maxWebSocketChunkSize);l=l.substring(this.maxWebSocketChunkSize),this._webSocket.send(c),this.debug("chunk sent = "+c.length+", remaining = "+l.length)}else this._webSocket.send(A)},t.prototype.dispose=function(){var t=this;if(this.connected)try{var e=Object.assign({},this.disconnectHeaders);e.receipt||(e.receipt="close-"+this._counter++),this.watchForReceipt(e.receipt,(function(e){t._closeWebsocket(),t._cleanUp(),t.onDisconnect(e)})),this._transmit({command:"DISCONNECT",headers:e})}catch(t){this.debug("Ignoring error during disconnect "+t)}else this._webSocket.readyState!==a.WebSocketState.CONNECTING&&this._webSocket.readyState!==a.WebSocketState.OPEN||this._closeWebsocket()},t.prototype._cleanUp=function(){this._connected=!1,this._pinger&&clearInterval(this._pinger),this._ponger&&clearInterval(this._ponger)},t.prototype.publish=function(t){var e=t.destination,i=t.headers,n=t.body,r=t.binaryBody,o=t.skipContentLengthHeader,s=Object.assign({destination:e},i);this._transmit({command:"SEND",headers:s,body:n,binaryBody:r,skipContentLengthHeader:o})},t.prototype.watchForReceipt=function(t,e){this._receiptWatchers[t]=e},t.prototype.subscribe=function(t,e,i){void 0===i&&(i={}),(i=Object.assign({},i)).id||(i.id="sub-"+this._counter++),i.destination=t,this._subscriptions[i.id]=e,this._transmit({command:"SUBSCRIBE",headers:i});var n=this;return{id:i.id,unsubscribe:function(t){return n.unsubscribe(i.id,t)}}},t.prototype.unsubscribe=function(t,e){void 0===e&&(e={}),e=Object.assign({},e),delete this._subscriptions[t],e.id=t,this._transmit({command:"UNSUBSCRIBE",headers:e})},t.prototype.begin=function(t){var e=t||"tx-"+this._counter++;this._transmit({command:"BEGIN",headers:{transaction:e}});var i=this;return{id:e,commit:function(){i.commit(e)},abort:function(){i.abort(e)}}},t.prototype.commit=function(t){this._transmit({command:"COMMIT",headers:{transaction:t}})},t.prototype.abort=function(t){this._transmit({command:"ABORT",headers:{transaction:t}})},t.prototype.ack=function(t,e,i){void 0===i&&(i={}),i=Object.assign({},i),this._connectedVersion===s.Versions.V1_2?i.id=t:i["message-id"]=t,i.subscription=e,this._transmit({command:"ACK",headers:i})},t.prototype.nack=function(t,e,i){return void 0===i&&(i={}),i=Object.assign({},i),this._connectedVersion===s.Versions.V1_2?i.id=t:i["message-id"]=t,i.subscription=e,this._transmit({command:"NACK",headers:i})},t}();e.StompHandler=A},"./src/stomp-headers.ts":
/*!******************************!*\
  !*** ./src/stomp-headers.ts ***!
  \******************************/
/*! no static exports found */function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){};e.StompHeaders=n},"./src/stomp-subscription.ts":
/*!***********************************!*\
  !*** ./src/stomp-subscription.ts ***!
  \***********************************/
/*! no static exports found */function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){};e.StompSubscription=n},"./src/versions.ts":
/*!*************************!*\
  !*** ./src/versions.ts ***!
  \*************************/
/*! no static exports found */function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t){this.versions=t}return t.prototype.supportedVersions=function(){return this.versions.join(",")},t.prototype.protocolVersions=function(){return this.versions.map((function(t){return"v"+t.replace(".","")+".stomp"}))},t.V1_0="1.0",t.V1_1="1.1",t.V1_2="1.2",t.default=new t([t.V1_0,t.V1_1,t.V1_2]),t}();e.Versions=n},"./src/web-socket-state.ts":
/*!*********************************!*\
  !*** ./src/web-socket-state.ts ***!
  \*********************************/
/*! no static exports found */function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.CONNECTING=0]="CONNECTING",t[t.OPEN=1]="OPEN",t[t.CLOSING=2]="CLOSING",t[t.CLOSED=3]="CLOSED"}(e.WebSocketState||(e.WebSocketState={}))},0:
/*!****************************!*\
  !*** multi ./src/index.ts ***!
  \****************************/
/*! no static exports found */function(t,e,i){t.exports=i(/*! /home/kdeepak/MyWork/Tech/stomp/stompjs/src/index.ts */"./src/index.ts")}})},t.exports=n()},function(t,e,i){!function(t){"use strict";function e(){}function i(t){this.message=t||""}function n(t){this.message=t||""}function r(t){this.message=t||""}function o(){}function s(t){return null===t?Mt:t.color}function a(t){return null===t?null:t.parent}function A(t,e){null!==t&&(t.color=e)}function l(t){return null===t?null:t.left}function c(t){return null===t?null:t.right}function u(){this.root_=null,this.size_=0}function h(){}function p(){this.array_=[],arguments[0]instanceof _t&&this.addAll(arguments[0])}function d(){}function f(t){this.message=t||""}function g(){this.array_=[]}"fill"in Array.prototype||Object.defineProperty(Array.prototype,"fill",{configurable:!0,value:function(t){if(null==this)throw new TypeError(this+" is not an object");var e=Object(this),i=Math.max(Math.min(e.length,9007199254740991),0)||0,n=1 in arguments&&parseInt(Number(arguments[1]),10)||0;n=n<0?Math.max(i+n,0):Math.min(n,i);var r=2 in arguments&&void 0!==arguments[2]?parseInt(Number(arguments[2]),10)||0:i;for(r=r<0?Math.max(i+arguments[2],0):Math.min(r,i);n<r;)e[n]=t,++n;return e},writable:!0}),Number.isFinite=Number.isFinite||function(t){return"number"==typeof t&&isFinite(t)},Number.isInteger=Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},Number.parseFloat=Number.parseFloat||parseFloat,Number.isNaN=Number.isNaN||function(t){return t!=t},Math.trunc=Math.trunc||function(t){return t<0?Math.ceil(t):Math.floor(t)};var m=function(){};m.prototype.interfaces_=function(){return[]},m.prototype.getClass=function(){return m},m.prototype.equalsWithTolerance=function(t,e,i){return Math.abs(t-e)<=i};var y=function(t){function e(e){t.call(this,e),this.name="IllegalArgumentException",this.message=e,this.stack=(new t).stack}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error),v=function(){},_={MAX_VALUE:{configurable:!0}};v.isNaN=function(t){return Number.isNaN(t)},v.doubleToLongBits=function(t){return t},v.longBitsToDouble=function(t){return t},v.isInfinite=function(t){return!Number.isFinite(t)},_.MAX_VALUE.get=function(){return Number.MAX_VALUE},Object.defineProperties(v,_);var w=function(){},C=function(){},B=function(){},b=function t(){if(this.x=null,this.y=null,this.z=null,0===arguments.length)this.x=0,this.y=0,this.z=t.NULL_ORDINATE;else if(1===arguments.length){var e=arguments[0];this.x=e.x,this.y=e.y,this.z=e.z}else 2===arguments.length?(this.x=arguments[0],this.y=arguments[1],this.z=t.NULL_ORDINATE):3===arguments.length&&(this.x=arguments[0],this.y=arguments[1],this.z=arguments[2])},E={DimensionalComparator:{configurable:!0},serialVersionUID:{configurable:!0},NULL_ORDINATE:{configurable:!0},X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0}};b.prototype.setOrdinate=function(t,e){switch(t){case b.X:this.x=e;break;case b.Y:this.y=e;break;case b.Z:this.z=e;break;default:throw new y("Invalid ordinate index: "+t)}},b.prototype.equals2D=function(){if(1===arguments.length){var t=arguments[0];return this.x===t.x&&this.y===t.y}if(2===arguments.length){var e=arguments[0],i=arguments[1];return!!m.equalsWithTolerance(this.x,e.x,i)&&!!m.equalsWithTolerance(this.y,e.y,i)}},b.prototype.getOrdinate=function(t){switch(t){case b.X:return this.x;case b.Y:return this.y;case b.Z:return this.z}throw new y("Invalid ordinate index: "+t)},b.prototype.equals3D=function(t){return this.x===t.x&&this.y===t.y&&(this.z===t.z||v.isNaN(this.z))&&v.isNaN(t.z)},b.prototype.equals=function(t){return t instanceof b&&this.equals2D(t)},b.prototype.equalInZ=function(t,e){return m.equalsWithTolerance(this.z,t.z,e)},b.prototype.compareTo=function(t){var e=t;return this.x<e.x?-1:this.x>e.x?1:this.y<e.y?-1:this.y>e.y?1:0},b.prototype.clone=function(){},b.prototype.copy=function(){return new b(this)},b.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"},b.prototype.distance3D=function(t){var e=this.x-t.x,i=this.y-t.y,n=this.z-t.z;return Math.sqrt(e*e+i*i+n*n)},b.prototype.distance=function(t){var e=this.x-t.x,i=this.y-t.y;return Math.sqrt(e*e+i*i)},b.prototype.hashCode=function(){var t=17;return 37*(t=37*t+b.hashCode(this.x))+b.hashCode(this.y)},b.prototype.setCoordinate=function(t){this.x=t.x,this.y=t.y,this.z=t.z},b.prototype.interfaces_=function(){return[w,C,e]},b.prototype.getClass=function(){return b},b.hashCode=function(){if(1===arguments.length){var t=arguments[0],e=v.doubleToLongBits(t);return Math.trunc((e^e)>>>32)}},E.DimensionalComparator.get=function(){return S},E.serialVersionUID.get=function(){return 0x5cbf2c235c7e5800},E.NULL_ORDINATE.get=function(){return v.NaN},E.X.get=function(){return 0},E.Y.get=function(){return 1},E.Z.get=function(){return 2},Object.defineProperties(b,E);var S=function(t){if(this._dimensionsToTest=2,0===arguments.length);else if(1===arguments.length){var e=arguments[0];if(2!==e&&3!==e)throw new y("only 2 or 3 dimensions may be specified");this._dimensionsToTest=e}};S.prototype.compare=function(t,e){var i=t,n=e,r=S.compare(i.x,n.x);if(0!==r)return r;var o=S.compare(i.y,n.y);return 0!==o?o:this._dimensionsToTest<=2?0:S.compare(i.z,n.z)},S.prototype.interfaces_=function(){return[B]},S.prototype.getClass=function(){return S},S.compare=function(t,e){return t<e?-1:t>e?1:v.isNaN(t)?v.isNaN(e)?0:-1:v.isNaN(e)?1:0};var x=function(){};x.prototype.create=function(){},x.prototype.interfaces_=function(){return[]},x.prototype.getClass=function(){return x};var I=function(){},F={INTERIOR:{configurable:!0},BOUNDARY:{configurable:!0},EXTERIOR:{configurable:!0},NONE:{configurable:!0}};I.prototype.interfaces_=function(){return[]},I.prototype.getClass=function(){return I},I.toLocationSymbol=function(t){switch(t){case I.EXTERIOR:return"e";case I.BOUNDARY:return"b";case I.INTERIOR:return"i";case I.NONE:return"-"}throw new y("Unknown location value: "+t)},F.INTERIOR.get=function(){return 0},F.BOUNDARY.get=function(){return 1},F.EXTERIOR.get=function(){return 2},F.NONE.get=function(){return-1},Object.defineProperties(I,F);var O=function(t,e){return t.interfaces_&&t.interfaces_().indexOf(e)>-1},P=function(){},T={LOG_10:{configurable:!0}};P.prototype.interfaces_=function(){return[]},P.prototype.getClass=function(){return P},P.log10=function(t){var e=Math.log(t);return v.isInfinite(e)||v.isNaN(e)?e:e/P.LOG_10},P.min=function(t,e,i,n){var r=t;return e<r&&(r=e),i<r&&(r=i),n<r&&(r=n),r},P.clamp=function(){if("number"==typeof arguments[2]&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1],i=arguments[2];return t<e?e:t>i?i:t}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var n=arguments[0],r=arguments[1],o=arguments[2];return n<r?r:n>o?o:n}},P.wrap=function(t,e){return t<0?e- -t%e:t%e},P.max=function(){if(3===arguments.length){var t=arguments[0],e=arguments[1],i=arguments[2],n=t;return e>n&&(n=e),i>n&&(n=i),n}if(4===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3],A=r;return o>A&&(A=o),s>A&&(A=s),a>A&&(A=a),A}},P.average=function(t,e){return(t+e)/2},T.LOG_10.get=function(){return Math.log(10)},Object.defineProperties(P,T);var L=function(t){this.str=t};L.prototype.append=function(t){this.str+=t},L.prototype.setCharAt=function(t,e){this.str=this.str.substr(0,t)+e+this.str.substr(t+1)},L.prototype.toString=function(t){return this.str};var M=function(t){this.value=t};M.prototype.intValue=function(){return this.value},M.prototype.compareTo=function(t){return this.value<t?-1:this.value>t?1:0},M.isNaN=function(t){return Number.isNaN(t)};var U=function(){};U.isWhitespace=function(t){return t<=32&&t>=0||127===t},U.toUpperCase=function(t){return t.toUpperCase()};var D=function t(){if(this._hi=0,this._lo=0,0===arguments.length)this.init(0);else if(1===arguments.length){if("number"==typeof arguments[0]){var e=arguments[0];this.init(e)}else if(arguments[0]instanceof t){var i=arguments[0];this.init(i)}else if("string"==typeof arguments[0]){var n=arguments[0];t.call(this,t.parse(n))}}else if(2===arguments.length){var r=arguments[0],o=arguments[1];this.init(r,o)}},Q={PI:{configurable:!0},TWO_PI:{configurable:!0},PI_2:{configurable:!0},E:{configurable:!0},NaN:{configurable:!0},EPS:{configurable:!0},SPLIT:{configurable:!0},MAX_PRINT_DIGITS:{configurable:!0},TEN:{configurable:!0},ONE:{configurable:!0},SCI_NOT_EXPONENT_CHAR:{configurable:!0},SCI_NOT_ZERO:{configurable:!0}};D.prototype.le=function(t){return(this._hi<t._hi||this._hi===t._hi)&&this._lo<=t._lo},D.prototype.extractSignificantDigits=function(t,e){var i=this.abs(),n=D.magnitude(i._hi),r=D.TEN.pow(n);(i=i.divide(r)).gt(D.TEN)?(i=i.divide(D.TEN),n+=1):i.lt(D.ONE)&&(i=i.multiply(D.TEN),n-=1);for(var o=n+1,s=new L,a=D.MAX_PRINT_DIGITS-1,A=0;A<=a;A++){t&&A===o&&s.append(".");var l=Math.trunc(i._hi);if(l<0)break;var c=!1,u=0;l>9?(c=!0,u="9"):u="0"+l,s.append(u),i=i.subtract(D.valueOf(l)).multiply(D.TEN),c&&i.selfAdd(D.TEN);var h=!0,p=D.magnitude(i._hi);if(p<0&&Math.abs(p)>=a-A&&(h=!1),!h)break}return e[0]=n,s.toString()},D.prototype.sqr=function(){return this.multiply(this)},D.prototype.doubleValue=function(){return this._hi+this._lo},D.prototype.subtract=function(){if(arguments[0]instanceof D){var t=arguments[0];return this.add(t.negate())}if("number"==typeof arguments[0]){var e=arguments[0];return this.add(-e)}},D.prototype.equals=function(){if(1===arguments.length){var t=arguments[0];return this._hi===t._hi&&this._lo===t._lo}},D.prototype.isZero=function(){return 0===this._hi&&0===this._lo},D.prototype.selfSubtract=function(){if(arguments[0]instanceof D){var t=arguments[0];return this.isNaN()?this:this.selfAdd(-t._hi,-t._lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.isNaN()?this:this.selfAdd(-e,0)}},D.prototype.getSpecialNumberString=function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null},D.prototype.min=function(t){return this.le(t)?this:t},D.prototype.selfDivide=function(){if(1===arguments.length){if(arguments[0]instanceof D){var t=arguments[0];return this.selfDivide(t._hi,t._lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.selfDivide(e,0)}}else if(2===arguments.length){var i=arguments[0],n=arguments[1],r=null,o=null,s=null,a=null,A=null,l=null,c=null,u=null;return A=this._hi/i,u=(r=(l=D.SPLIT*A)-(r=l-A))*(s=(u=D.SPLIT*i)-(s=u-i))-(c=A*i)+r*(a=i-s)+(o=A-r)*s+o*a,u=A+(l=(this._hi-c-u+this._lo-A*n)/i),this._hi=u,this._lo=A-u+l,this}},D.prototype.dump=function(){return"DD<"+this._hi+", "+this._lo+">"},D.prototype.divide=function(){if(arguments[0]instanceof D){var t=arguments[0],e=null,i=null,n=null,r=null,o=null,s=null,a=null,A=null;return i=(o=this._hi/t._hi)-(e=(s=D.SPLIT*o)-(e=s-o)),A=e*(n=(A=D.SPLIT*t._hi)-(n=A-t._hi))-(a=o*t._hi)+e*(r=t._hi-n)+i*n+i*r,s=(this._hi-a-A+this._lo-o*t._lo)/t._hi,new D(A=o+s,o-A+s)}if("number"==typeof arguments[0]){var l=arguments[0];return v.isNaN(l)?D.createNaN():D.copy(this).selfDivide(l,0)}},D.prototype.ge=function(t){return(this._hi>t._hi||this._hi===t._hi)&&this._lo>=t._lo},D.prototype.pow=function(t){if(0===t)return D.valueOf(1);var e=new D(this),i=D.valueOf(1),n=Math.abs(t);if(n>1)for(;n>0;)n%2==1&&i.selfMultiply(e),(n/=2)>0&&(e=e.sqr());else i=e;return t<0?i.reciprocal():i},D.prototype.ceil=function(){if(this.isNaN())return D.NaN;var t=Math.ceil(this._hi),e=0;return t===this._hi&&(e=Math.ceil(this._lo)),new D(t,e)},D.prototype.compareTo=function(t){var e=t;return this._hi<e._hi?-1:this._hi>e._hi?1:this._lo<e._lo?-1:this._lo>e._lo?1:0},D.prototype.rint=function(){return this.isNaN()?this:this.add(.5).floor()},D.prototype.setValue=function(){if(arguments[0]instanceof D){var t=arguments[0];return this.init(t),this}if("number"==typeof arguments[0]){var e=arguments[0];return this.init(e),this}},D.prototype.max=function(t){return this.ge(t)?this:t},D.prototype.sqrt=function(){if(this.isZero())return D.valueOf(0);if(this.isNegative())return D.NaN;var t=1/Math.sqrt(this._hi),e=this._hi*t,i=D.valueOf(e),n=this.subtract(i.sqr())._hi*(.5*t);return i.add(n)},D.prototype.selfAdd=function(){if(1===arguments.length){if(arguments[0]instanceof D){var t=arguments[0];return this.selfAdd(t._hi,t._lo)}if("number"==typeof arguments[0]){var e=arguments[0],i=null,n=null,r=null,o=null,s=null,a=null;return o=(r=this._hi+e)-(s=r-this._hi),n=(a=(o=e-s+(this._hi-o))+this._lo)+(r-(i=r+a)),this._hi=i+n,this._lo=n+(i-this._hi),this}}else if(2===arguments.length){var A=arguments[0],l=arguments[1],c=null,u=null,h=null,p=null,d=null,f=null,g=null;p=this._hi+A,u=this._lo+l,d=p-(f=p-this._hi),h=u-(g=u-this._lo);var m=(c=p+(f=(d=A-f+(this._hi-d))+u))+(f=(h=l-g+(this._lo-h))+(f+(p-c))),y=f+(c-m);return this._hi=m,this._lo=y,this}},D.prototype.selfMultiply=function(){if(1===arguments.length){if(arguments[0]instanceof D){var t=arguments[0];return this.selfMultiply(t._hi,t._lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.selfMultiply(e,0)}}else if(2===arguments.length){var i=arguments[0],n=arguments[1],r=null,o=null,s=null,a=null,A=null,l=null;r=(A=D.SPLIT*this._hi)-this._hi,l=D.SPLIT*i,r=A-r,o=this._hi-r,s=l-i;var c=(A=this._hi*i)+(l=r*(s=l-s)-A+r*(a=i-s)+o*s+o*a+(this._hi*n+this._lo*i)),u=l+(r=A-c);return this._hi=c,this._lo=u,this}},D.prototype.selfSqr=function(){return this.selfMultiply(this)},D.prototype.floor=function(){if(this.isNaN())return D.NaN;var t=Math.floor(this._hi),e=0;return t===this._hi&&(e=Math.floor(this._lo)),new D(t,e)},D.prototype.negate=function(){return this.isNaN()?this:new D(-this._hi,-this._lo)},D.prototype.clone=function(){},D.prototype.multiply=function(){if(arguments[0]instanceof D){var t=arguments[0];return t.isNaN()?D.createNaN():D.copy(this).selfMultiply(t)}if("number"==typeof arguments[0]){var e=arguments[0];return v.isNaN(e)?D.createNaN():D.copy(this).selfMultiply(e,0)}},D.prototype.isNaN=function(){return v.isNaN(this._hi)},D.prototype.intValue=function(){return Math.trunc(this._hi)},D.prototype.toString=function(){var t=D.magnitude(this._hi);return t>=-3&&t<=20?this.toStandardNotation():this.toSciNotation()},D.prototype.toStandardNotation=function(){var t=this.getSpecialNumberString();if(null!==t)return t;var e=new Array(1).fill(null),i=this.extractSignificantDigits(!0,e),n=e[0]+1,r=i;if("."===i.charAt(0))r="0"+i;else if(n<0)r="0."+D.stringOfChar("0",-n)+i;else if(-1===i.indexOf(".")){var o=n-i.length;r=i+D.stringOfChar("0",o)+".0"}return this.isNegative()?"-"+r:r},D.prototype.reciprocal=function(){var t,e,i,n,r=null,o=null,s=null,a=null;t=(i=1/this._hi)-(r=(s=D.SPLIT*i)-(r=s-i)),o=(a=D.SPLIT*this._hi)-this._hi;var A=i+(s=(1-(n=i*this._hi)-(a=r*(o=a-o)-n+r*(e=this._hi-o)+t*o+t*e)-i*this._lo)/this._hi);return new D(A,i-A+s)},D.prototype.toSciNotation=function(){if(this.isZero())return D.SCI_NOT_ZERO;var t=this.getSpecialNumberString();if(null!==t)return t;var e=new Array(1).fill(null),i=this.extractSignificantDigits(!1,e),n=D.SCI_NOT_EXPONENT_CHAR+e[0];if("0"===i.charAt(0))throw new Error("Found leading zero: "+i);var r="";i.length>1&&(r=i.substring(1));var o=i.charAt(0)+"."+r;return this.isNegative()?"-"+o+n:o+n},D.prototype.abs=function(){return this.isNaN()?D.NaN:this.isNegative()?this.negate():new D(this)},D.prototype.isPositive=function(){return(this._hi>0||0===this._hi)&&this._lo>0},D.prototype.lt=function(t){return(this._hi<t._hi||this._hi===t._hi)&&this._lo<t._lo},D.prototype.add=function(){if(arguments[0]instanceof D){var t=arguments[0];return D.copy(this).selfAdd(t)}if("number"==typeof arguments[0]){var e=arguments[0];return D.copy(this).selfAdd(e)}},D.prototype.init=function(){if(1===arguments.length){if("number"==typeof arguments[0]){var t=arguments[0];this._hi=t,this._lo=0}else if(arguments[0]instanceof D){var e=arguments[0];this._hi=e._hi,this._lo=e._lo}}else if(2===arguments.length){var i=arguments[0],n=arguments[1];this._hi=i,this._lo=n}},D.prototype.gt=function(t){return(this._hi>t._hi||this._hi===t._hi)&&this._lo>t._lo},D.prototype.isNegative=function(){return(this._hi<0||0===this._hi)&&this._lo<0},D.prototype.trunc=function(){return this.isNaN()?D.NaN:this.isPositive()?this.floor():this.ceil()},D.prototype.signum=function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0},D.prototype.interfaces_=function(){return[e,w,C]},D.prototype.getClass=function(){return D},D.sqr=function(t){return D.valueOf(t).selfMultiply(t)},D.valueOf=function(){if("string"==typeof arguments[0]){var t=arguments[0];return D.parse(t)}if("number"==typeof arguments[0]){var e=arguments[0];return new D(e)}},D.sqrt=function(t){return D.valueOf(t).sqrt()},D.parse=function(t){for(var e=0,i=t.length;U.isWhitespace(t.charAt(e));)e++;var n=!1;if(e<i){var r=t.charAt(e);"-"!==r&&"+"!==r||(e++,"-"===r&&(n=!0))}for(var o=new D,s=0,a=0,A=0;!(e>=i);){var l=t.charAt(e);if(e++,U.isDigit(l)){var c=l-"0";o.selfMultiply(D.TEN),o.selfAdd(c),s++}else{if("."!==l){if("e"===l||"E"===l){var u=t.substring(e);try{A=M.parseInt(u)}catch(e){throw e instanceof Error?new Error("Invalid exponent "+u+" in string "+t):e}break}throw new Error("Unexpected character '"+l+"' at position "+e+" in string "+t)}a=s}}var h=o,p=s-a-A;if(0===p)h=o;else if(p>0){var d=D.TEN.pow(p);h=o.divide(d)}else if(p<0){var f=D.TEN.pow(-p);h=o.multiply(f)}return n?h.negate():h},D.createNaN=function(){return new D(v.NaN,v.NaN)},D.copy=function(t){return new D(t)},D.magnitude=function(t){var e=Math.abs(t),i=Math.log(e)/Math.log(10),n=Math.trunc(Math.floor(i));return 10*Math.pow(10,n)<=e&&(n+=1),n},D.stringOfChar=function(t,e){for(var i=new L,n=0;n<e;n++)i.append(t);return i.toString()},Q.PI.get=function(){return new D(3.141592653589793,12246467991473532e-32)},Q.TWO_PI.get=function(){return new D(6.283185307179586,24492935982947064e-32)},Q.PI_2.get=function(){return new D(1.5707963267948966,6123233995736766e-32)},Q.E.get=function(){return new D(2.718281828459045,14456468917292502e-32)},Q.NaN.get=function(){return new D(v.NaN,v.NaN)},Q.EPS.get=function(){return 123259516440783e-46},Q.SPLIT.get=function(){return 134217729},Q.MAX_PRINT_DIGITS.get=function(){return 32},Q.TEN.get=function(){return D.valueOf(10)},Q.ONE.get=function(){return D.valueOf(1)},Q.SCI_NOT_EXPONENT_CHAR.get=function(){return"E"},Q.SCI_NOT_ZERO.get=function(){return"0.0E0"},Object.defineProperties(D,Q);var R=function(){},N={DP_SAFE_EPSILON:{configurable:!0}};R.prototype.interfaces_=function(){return[]},R.prototype.getClass=function(){return R},R.orientationIndex=function(t,e,i){var n=R.orientationIndexFilter(t,e,i);if(n<=1)return n;var r=D.valueOf(e.x).selfAdd(-t.x),o=D.valueOf(e.y).selfAdd(-t.y),s=D.valueOf(i.x).selfAdd(-e.x),a=D.valueOf(i.y).selfAdd(-e.y);return r.selfMultiply(a).selfSubtract(o.selfMultiply(s)).signum()},R.signOfDet2x2=function(t,e,i,n){return t.multiply(n).selfSubtract(e.multiply(i)).signum()},R.intersection=function(t,e,i,n){var r=D.valueOf(n.y).selfSubtract(i.y).selfMultiply(D.valueOf(e.x).selfSubtract(t.x)),o=D.valueOf(n.x).selfSubtract(i.x).selfMultiply(D.valueOf(e.y).selfSubtract(t.y)),s=r.subtract(o),a=D.valueOf(n.x).selfSubtract(i.x).selfMultiply(D.valueOf(t.y).selfSubtract(i.y)),A=D.valueOf(n.y).selfSubtract(i.y).selfMultiply(D.valueOf(t.x).selfSubtract(i.x)),l=a.subtract(A).selfDivide(s).doubleValue(),c=D.valueOf(t.x).selfAdd(D.valueOf(e.x).selfSubtract(t.x).selfMultiply(l)).doubleValue(),u=D.valueOf(e.x).selfSubtract(t.x).selfMultiply(D.valueOf(t.y).selfSubtract(i.y)),h=D.valueOf(e.y).selfSubtract(t.y).selfMultiply(D.valueOf(t.x).selfSubtract(i.x)),p=u.subtract(h).selfDivide(s).doubleValue(),d=D.valueOf(i.y).selfAdd(D.valueOf(n.y).selfSubtract(i.y).selfMultiply(p)).doubleValue();return new b(c,d)},R.orientationIndexFilter=function(t,e,i){var n=null,r=(t.x-i.x)*(e.y-i.y),o=(t.y-i.y)*(e.x-i.x),s=r-o;if(r>0){if(o<=0)return R.signum(s);n=r+o}else{if(!(r<0))return R.signum(s);if(o>=0)return R.signum(s);n=-r-o}var a=R.DP_SAFE_EPSILON*n;return s>=a||-s>=a?R.signum(s):2},R.signum=function(t){return t>0?1:t<0?-1:0},N.DP_SAFE_EPSILON.get=function(){return 1e-15},Object.defineProperties(R,N);var H=function(){},k={X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0},M:{configurable:!0}};k.X.get=function(){return 0},k.Y.get=function(){return 1},k.Z.get=function(){return 2},k.M.get=function(){return 3},H.prototype.setOrdinate=function(t,e,i){},H.prototype.size=function(){},H.prototype.getOrdinate=function(t,e){},H.prototype.getCoordinate=function(){},H.prototype.getCoordinateCopy=function(t){},H.prototype.getDimension=function(){},H.prototype.getX=function(t){},H.prototype.clone=function(){},H.prototype.expandEnvelope=function(t){},H.prototype.copy=function(){},H.prototype.getY=function(t){},H.prototype.toCoordinateArray=function(){},H.prototype.interfaces_=function(){return[C]},H.prototype.getClass=function(){return H},Object.defineProperties(H,k);var V=function(){},j=function(t){function e(){t.call(this,"Projective point not representable on the Cartesian plane.")}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(V),G=function(){};G.arraycopy=function(t,e,i,n,r){for(var o=0,s=e;s<e+r;s++)i[n+o]=t[s],o++},G.getProperty=function(t){return{"line.separator":"\n"}[t]};var K=function t(){if(this.x=null,this.y=null,this.w=null,0===arguments.length)this.x=0,this.y=0,this.w=1;else if(1===arguments.length){var e=arguments[0];this.x=e.x,this.y=e.y,this.w=1}else if(2===arguments.length){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var i=arguments[0],n=arguments[1];this.x=i,this.y=n,this.w=1}else if(arguments[0]instanceof t&&arguments[1]instanceof t){var r=arguments[0],o=arguments[1];this.x=r.y*o.w-o.y*r.w,this.y=o.x*r.w-r.x*o.w,this.w=r.x*o.y-o.x*r.y}else if(arguments[0]instanceof b&&arguments[1]instanceof b){var s=arguments[0],a=arguments[1];this.x=s.y-a.y,this.y=a.x-s.x,this.w=s.x*a.y-a.x*s.y}}else if(3===arguments.length){var A=arguments[0],l=arguments[1],c=arguments[2];this.x=A,this.y=l,this.w=c}else if(4===arguments.length){var u=arguments[0],h=arguments[1],p=arguments[2],d=arguments[3],f=u.y-h.y,g=h.x-u.x,m=u.x*h.y-h.x*u.y,y=p.y-d.y,v=d.x-p.x,_=p.x*d.y-d.x*p.y;this.x=g*_-v*m,this.y=y*m-f*_,this.w=f*v-y*g}};K.prototype.getY=function(){var t=this.y/this.w;if(v.isNaN(t)||v.isInfinite(t))throw new j;return t},K.prototype.getX=function(){var t=this.x/this.w;if(v.isNaN(t)||v.isInfinite(t))throw new j;return t},K.prototype.getCoordinate=function(){var t=new b;return t.x=this.getX(),t.y=this.getY(),t},K.prototype.interfaces_=function(){return[]},K.prototype.getClass=function(){return K},K.intersection=function(t,e,i,n){var r=t.y-e.y,o=e.x-t.x,s=t.x*e.y-e.x*t.y,a=i.y-n.y,A=n.x-i.x,l=i.x*n.y-n.x*i.y,c=r*A-a*o,u=(o*l-A*s)/c,h=(a*s-r*l)/c;if(v.isNaN(u)||v.isInfinite(u)||v.isNaN(h)||v.isInfinite(h))throw new j;return new b(u,h)};var z=function t(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,0===arguments.length)this.init();else if(1===arguments.length){if(arguments[0]instanceof b){var e=arguments[0];this.init(e.x,e.x,e.y,e.y)}else if(arguments[0]instanceof t){var i=arguments[0];this.init(i)}}else if(2===arguments.length){var n=arguments[0],r=arguments[1];this.init(n.x,r.x,n.y,r.y)}else if(4===arguments.length){var o=arguments[0],s=arguments[1],a=arguments[2],A=arguments[3];this.init(o,s,a,A)}},W={serialVersionUID:{configurable:!0}};z.prototype.getArea=function(){return this.getWidth()*this.getHeight()},z.prototype.equals=function(t){if(!(t instanceof z))return!1;var e=t;return this.isNull()?e.isNull():this._maxx===e.getMaxX()&&this._maxy===e.getMaxY()&&this._minx===e.getMinX()&&this._miny===e.getMinY()},z.prototype.intersection=function(t){if(this.isNull()||t.isNull()||!this.intersects(t))return new z;var e=this._minx>t._minx?this._minx:t._minx,i=this._miny>t._miny?this._miny:t._miny,n=this._maxx<t._maxx?this._maxx:t._maxx,r=this._maxy<t._maxy?this._maxy:t._maxy;return new z(e,n,i,r)},z.prototype.isNull=function(){return this._maxx<this._minx},z.prototype.getMaxX=function(){return this._maxx},z.prototype.covers=function(){if(1===arguments.length){if(arguments[0]instanceof b){var t=arguments[0];return this.covers(t.x,t.y)}if(arguments[0]instanceof z){var e=arguments[0];return!this.isNull()&&!e.isNull()&&e.getMinX()>=this._minx&&e.getMaxX()<=this._maxx&&e.getMinY()>=this._miny&&e.getMaxY()<=this._maxy}}else if(2===arguments.length){var i=arguments[0],n=arguments[1];return!this.isNull()&&i>=this._minx&&i<=this._maxx&&n>=this._miny&&n<=this._maxy}},z.prototype.intersects=function(){if(1===arguments.length){if(arguments[0]instanceof z){var t=arguments[0];return!this.isNull()&&!t.isNull()&&!(t._minx>this._maxx||t._maxx<this._minx||t._miny>this._maxy||t._maxy<this._miny)}if(arguments[0]instanceof b){var e=arguments[0];return this.intersects(e.x,e.y)}}else if(2===arguments.length){var i=arguments[0],n=arguments[1];return!this.isNull()&&!(i>this._maxx||i<this._minx||n>this._maxy||n<this._miny)}},z.prototype.getMinY=function(){return this._miny},z.prototype.getMinX=function(){return this._minx},z.prototype.expandToInclude=function(){if(1===arguments.length){if(arguments[0]instanceof b){var t=arguments[0];this.expandToInclude(t.x,t.y)}else if(arguments[0]instanceof z){var e=arguments[0];if(e.isNull())return null;this.isNull()?(this._minx=e.getMinX(),this._maxx=e.getMaxX(),this._miny=e.getMinY(),this._maxy=e.getMaxY()):(e._minx<this._minx&&(this._minx=e._minx),e._maxx>this._maxx&&(this._maxx=e._maxx),e._miny<this._miny&&(this._miny=e._miny),e._maxy>this._maxy&&(this._maxy=e._maxy))}}else if(2===arguments.length){var i=arguments[0],n=arguments[1];this.isNull()?(this._minx=i,this._maxx=i,this._miny=n,this._maxy=n):(i<this._minx&&(this._minx=i),i>this._maxx&&(this._maxx=i),n<this._miny&&(this._miny=n),n>this._maxy&&(this._maxy=n))}},z.prototype.minExtent=function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t<e?t:e},z.prototype.getWidth=function(){return this.isNull()?0:this._maxx-this._minx},z.prototype.compareTo=function(t){var e=t;return this.isNull()?e.isNull()?0:-1:e.isNull()?1:this._minx<e._minx?-1:this._minx>e._minx?1:this._miny<e._miny?-1:this._miny>e._miny?1:this._maxx<e._maxx?-1:this._maxx>e._maxx?1:this._maxy<e._maxy?-1:this._maxy>e._maxy?1:0},z.prototype.translate=function(t,e){if(this.isNull())return null;this.init(this.getMinX()+t,this.getMaxX()+t,this.getMinY()+e,this.getMaxY()+e)},z.prototype.toString=function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"},z.prototype.setToNull=function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1},z.prototype.getHeight=function(){return this.isNull()?0:this._maxy-this._miny},z.prototype.maxExtent=function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t>e?t:e},z.prototype.expandBy=function(){if(1===arguments.length){var t=arguments[0];this.expandBy(t,t)}else if(2===arguments.length){var e=arguments[0],i=arguments[1];if(this.isNull())return null;this._minx-=e,this._maxx+=e,this._miny-=i,this._maxy+=i,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}},z.prototype.contains=function(){if(1===arguments.length){if(arguments[0]instanceof z){var t=arguments[0];return this.covers(t)}if(arguments[0]instanceof b){var e=arguments[0];return this.covers(e)}}else if(2===arguments.length){var i=arguments[0],n=arguments[1];return this.covers(i,n)}},z.prototype.centre=function(){return this.isNull()?null:new b((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)},z.prototype.init=function(){if(0===arguments.length)this.setToNull();else if(1===arguments.length){if(arguments[0]instanceof b){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof z){var e=arguments[0];this._minx=e._minx,this._maxx=e._maxx,this._miny=e._miny,this._maxy=e._maxy}}else if(2===arguments.length){var i=arguments[0],n=arguments[1];this.init(i.x,n.x,i.y,n.y)}else if(4===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3];r<o?(this._minx=r,this._maxx=o):(this._minx=o,this._maxx=r),s<a?(this._miny=s,this._maxy=a):(this._miny=a,this._maxy=s)}},z.prototype.getMaxY=function(){return this._maxy},z.prototype.distance=function(t){if(this.intersects(t))return 0;var e=0;this._maxx<t._minx?e=t._minx-this._maxx:this._minx>t._maxx&&(e=this._minx-t._maxx);var i=0;return this._maxy<t._miny?i=t._miny-this._maxy:this._miny>t._maxy&&(i=this._miny-t._maxy),0===e?i:0===i?e:Math.sqrt(e*e+i*i)},z.prototype.hashCode=function(){var t=17;return 37*(t=37*(t=37*(t=37*t+b.hashCode(this._minx))+b.hashCode(this._maxx))+b.hashCode(this._miny))+b.hashCode(this._maxy)},z.prototype.interfaces_=function(){return[w,e]},z.prototype.getClass=function(){return z},z.intersects=function(){if(3===arguments.length){var t=arguments[0],e=arguments[1],i=arguments[2];return i.x>=(t.x<e.x?t.x:e.x)&&i.x<=(t.x>e.x?t.x:e.x)&&i.y>=(t.y<e.y?t.y:e.y)&&i.y<=(t.y>e.y?t.y:e.y)}if(4===arguments.length){var n=arguments[0],r=arguments[1],o=arguments[2],s=arguments[3],a=Math.min(o.x,s.x),A=Math.max(o.x,s.x),l=Math.min(n.x,r.x),c=Math.max(n.x,r.x);return!(l>A||c<a||(a=Math.min(o.y,s.y),A=Math.max(o.y,s.y),l=Math.min(n.y,r.y),c=Math.max(n.y,r.y),l>A||c<a))}},W.serialVersionUID.get=function(){return 0x51845cd552189800},Object.defineProperties(z,W);var q={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/},X=function(t){this.geometryFactory=t||new me};X.prototype.read=function(t){var e,i,n;t=t.replace(/[\n\r]/g," ");var r=q.typeStr.exec(t);if(-1!==t.search("EMPTY")&&((r=q.emptyTypeStr.exec(t))[2]=void 0),r&&(i=r[1].toLowerCase(),n=r[2],J[i]&&(e=J[i].apply(this,[n]))),void 0===e)throw new Error("Could not parse WKT "+t);return e},X.prototype.write=function(t){return this.extractGeometry(t)},X.prototype.extractGeometry=function(t){var e=t.getGeometryType().toLowerCase();if(!Y[e])return null;var i=e.toUpperCase();return t.isEmpty()?i+" EMPTY":i+"("+Y[e].apply(this,[t])+")"};var Y={coordinate:function(t){return t.x+" "+t.y},point:function(t){return Y.coordinate.call(this,t._coordinates._coordinates[0])},multipoint:function(t){for(var e=[],i=0,n=t._geometries.length;i<n;++i)e.push("("+Y.point.apply(this,[t._geometries[i]])+")");return e.join(",")},linestring:function(t){for(var e=[],i=0,n=t._points._coordinates.length;i<n;++i)e.push(Y.coordinate.apply(this,[t._points._coordinates[i]]));return e.join(",")},linearring:function(t){for(var e=[],i=0,n=t._points._coordinates.length;i<n;++i)e.push(Y.coordinate.apply(this,[t._points._coordinates[i]]));return e.join(",")},multilinestring:function(t){for(var e=[],i=0,n=t._geometries.length;i<n;++i)e.push("("+Y.linestring.apply(this,[t._geometries[i]])+")");return e.join(",")},polygon:function(t){var e=[];e.push("("+Y.linestring.apply(this,[t._shell])+")");for(var i=0,n=t._holes.length;i<n;++i)e.push("("+Y.linestring.apply(this,[t._holes[i]])+")");return e.join(",")},multipolygon:function(t){for(var e=[],i=0,n=t._geometries.length;i<n;++i)e.push("("+Y.polygon.apply(this,[t._geometries[i]])+")");return e.join(",")},geometrycollection:function(t){for(var e=[],i=0,n=t._geometries.length;i<n;++i)e.push(this.extractGeometry(t._geometries[i]));return e.join(",")}},J={point:function(t){if(void 0===t)return this.geometryFactory.createPoint();var e=t.trim().split(q.spaces);return this.geometryFactory.createPoint(new b(Number.parseFloat(e[0]),Number.parseFloat(e[1])))},multipoint:function(t){if(void 0===t)return this.geometryFactory.createMultiPoint();for(var e,i=t.trim().split(","),n=[],r=0,o=i.length;r<o;++r)e=i[r].replace(q.trimParens,"$1"),n.push(J.point.apply(this,[e]));return this.geometryFactory.createMultiPoint(n)},linestring:function(t){if(void 0===t)return this.geometryFactory.createLineString();for(var e,i=t.trim().split(","),n=[],r=0,o=i.length;r<o;++r)e=i[r].trim().split(q.spaces),n.push(new b(Number.parseFloat(e[0]),Number.parseFloat(e[1])));return this.geometryFactory.createLineString(n)},linearring:function(t){if(void 0===t)return this.geometryFactory.createLinearRing();for(var e,i=t.trim().split(","),n=[],r=0,o=i.length;r<o;++r)e=i[r].trim().split(q.spaces),n.push(new b(Number.parseFloat(e[0]),Number.parseFloat(e[1])));return this.geometryFactory.createLinearRing(n)},multilinestring:function(t){if(void 0===t)return this.geometryFactory.createMultiLineString();for(var e,i=t.trim().split(q.parenComma),n=[],r=0,o=i.length;r<o;++r)e=i[r].replace(q.trimParens,"$1"),n.push(J.linestring.apply(this,[e]));return this.geometryFactory.createMultiLineString(n)},polygon:function(t){if(void 0===t)return this.geometryFactory.createPolygon();for(var e,i,n,r,o=t.trim().split(q.parenComma),s=[],a=0,A=o.length;a<A;++a)e=o[a].replace(q.trimParens,"$1"),i=J.linestring.apply(this,[e]),n=this.geometryFactory.createLinearRing(i._points),0===a?r=n:s.push(n);return this.geometryFactory.createPolygon(r,s)},multipolygon:function(t){if(void 0===t)return this.geometryFactory.createMultiPolygon();for(var e,i=t.trim().split(q.doubleParenComma),n=[],r=0,o=i.length;r<o;++r)e=i[r].replace(q.trimParens,"$1"),n.push(J.polygon.apply(this,[e]));return this.geometryFactory.createMultiPolygon(n)},geometrycollection:function(t){if(void 0===t)return this.geometryFactory.createGeometryCollection();for(var e=(t=t.replace(/,\s*([A-Za-z])/g,"|$1")).trim().split("|"),i=[],n=0,r=e.length;n<r;++n)i.push(this.read(e[n]));return this.geometryFactory.createGeometryCollection(i)}},Z=function(t){this.parser=new X(t)};Z.prototype.write=function(t){return this.parser.write(t)},Z.toLineString=function(t,e){if(2!==arguments.length)throw new Error("Not implemented");return"LINESTRING ( "+t.x+" "+t.y+", "+e.x+" "+e.y+" )"};var $=function(t){function e(e){t.call(this,e),this.name="RuntimeException",this.message=e,this.stack=(new t).stack}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error),tt=function(t){function e(){if(t.call(this),0===arguments.length)t.call(this);else if(1===arguments.length){var e=arguments[0];t.call(this,e)}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}($),et=function(){};et.prototype.interfaces_=function(){return[]},et.prototype.getClass=function(){return et},et.shouldNeverReachHere=function(){if(0===arguments.length)et.shouldNeverReachHere(null);else if(1===arguments.length){var t=arguments[0];throw new tt("Should never reach here"+(null!==t?": "+t:""))}},et.isTrue=function(){var t;if(1===arguments.length)et.isTrue(arguments[0],null);else if(2===arguments.length&&(t=arguments[1],!arguments[0]))throw null===t?new tt:new tt(t)},et.equals=function(){var t,e,i;if(2===arguments.length)et.equals(t=arguments[0],e=arguments[1],null);else if(3===arguments.length&&(t=arguments[0],i=arguments[2],!(e=arguments[1]).equals(t)))throw new tt("Expected "+t+" but encountered "+e+(null!==i?": "+i:""))};var it=function(){this._result=null,this._inputLines=Array(2).fill().map((function(){return Array(2)})),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new b,this._intPt[1]=new b,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0},nt={DONT_INTERSECT:{configurable:!0},DO_INTERSECT:{configurable:!0},COLLINEAR:{configurable:!0},NO_INTERSECTION:{configurable:!0},POINT_INTERSECTION:{configurable:!0},COLLINEAR_INTERSECTION:{configurable:!0}};it.prototype.getIndexAlongSegment=function(t,e){return this.computeIntLineIndex(),this._intLineIndex[t][e]},it.prototype.getTopologySummary=function(){var t=new L;return this.isEndPoint()&&t.append(" endpoint"),this._isProper&&t.append(" proper"),this.isCollinear()&&t.append(" collinear"),t.toString()},it.prototype.computeIntersection=function(t,e,i,n){this._inputLines[0][0]=t,this._inputLines[0][1]=e,this._inputLines[1][0]=i,this._inputLines[1][1]=n,this._result=this.computeIntersect(t,e,i,n)},it.prototype.getIntersectionNum=function(){return this._result},it.prototype.computeIntLineIndex=function(){if(0===arguments.length)null===this._intLineIndex&&(this._intLineIndex=Array(2).fill().map((function(){return Array(2)})),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(1===arguments.length){var t=arguments[0];this.getEdgeDistance(t,0)>this.getEdgeDistance(t,1)?(this._intLineIndex[t][0]=0,this._intLineIndex[t][1]=1):(this._intLineIndex[t][0]=1,this._intLineIndex[t][1]=0)}},it.prototype.isProper=function(){return this.hasIntersection()&&this._isProper},it.prototype.setPrecisionModel=function(t){this._precisionModel=t},it.prototype.isInteriorIntersection=function(){if(0===arguments.length)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(1===arguments.length){for(var t=arguments[0],e=0;e<this._result;e++)if(!this._intPt[e].equals2D(this._inputLines[t][0])&&!this._intPt[e].equals2D(this._inputLines[t][1]))return!0;return!1}},it.prototype.getIntersection=function(t){return this._intPt[t]},it.prototype.isEndPoint=function(){return this.hasIntersection()&&!this._isProper},it.prototype.hasIntersection=function(){return this._result!==it.NO_INTERSECTION},it.prototype.getEdgeDistance=function(t,e){return it.computeEdgeDistance(this._intPt[e],this._inputLines[t][0],this._inputLines[t][1])},it.prototype.isCollinear=function(){return this._result===it.COLLINEAR_INTERSECTION},it.prototype.toString=function(){return Z.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+Z.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()},it.prototype.getEndpoint=function(t,e){return this._inputLines[t][e]},it.prototype.isIntersection=function(t){for(var e=0;e<this._result;e++)if(this._intPt[e].equals2D(t))return!0;return!1},it.prototype.getIntersectionAlongSegment=function(t,e){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[t][e]]},it.prototype.interfaces_=function(){return[]},it.prototype.getClass=function(){return it},it.computeEdgeDistance=function(t,e,i){var n=Math.abs(i.x-e.x),r=Math.abs(i.y-e.y),o=-1;if(t.equals(e))o=0;else if(t.equals(i))o=n>r?n:r;else{var s=Math.abs(t.x-e.x),a=Math.abs(t.y-e.y);0!==(o=n>r?s:a)||t.equals(e)||(o=Math.max(s,a))}return et.isTrue(!(0===o&&!t.equals(e)),"Bad distance calculation"),o},it.nonRobustComputeEdgeDistance=function(t,e,i){var n=t.x-e.x,r=t.y-e.y,o=Math.sqrt(n*n+r*r);return et.isTrue(!(0===o&&!t.equals(e)),"Invalid distance calculation"),o},nt.DONT_INTERSECT.get=function(){return 0},nt.DO_INTERSECT.get=function(){return 1},nt.COLLINEAR.get=function(){return 2},nt.NO_INTERSECTION.get=function(){return 0},nt.POINT_INTERSECTION.get=function(){return 1},nt.COLLINEAR_INTERSECTION.get=function(){return 2},Object.defineProperties(it,nt);var rt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isInSegmentEnvelopes=function(t){var e=new z(this._inputLines[0][0],this._inputLines[0][1]),i=new z(this._inputLines[1][0],this._inputLines[1][1]);return e.contains(t)&&i.contains(t)},e.prototype.computeIntersection=function(){if(3!==arguments.length)return t.prototype.computeIntersection.apply(this,arguments);var e=arguments[0],i=arguments[1],n=arguments[2];if(this._isProper=!1,z.intersects(i,n,e)&&0===at.orientationIndex(i,n,e)&&0===at.orientationIndex(n,i,e))return this._isProper=!0,(e.equals(i)||e.equals(n))&&(this._isProper=!1),this._result=t.POINT_INTERSECTION,null;this._result=t.NO_INTERSECTION},e.prototype.normalizeToMinimum=function(t,e,i,n,r){r.x=this.smallestInAbsValue(t.x,e.x,i.x,n.x),r.y=this.smallestInAbsValue(t.y,e.y,i.y,n.y),t.x-=r.x,t.y-=r.y,e.x-=r.x,e.y-=r.y,i.x-=r.x,i.y-=r.y,n.x-=r.x,n.y-=r.y},e.prototype.safeHCoordinateIntersection=function(t,i,n,r){var o=null;try{o=K.intersection(t,i,n,r)}catch(s){if(!(s instanceof j))throw s;o=e.nearestEndpoint(t,i,n,r)}return o},e.prototype.intersection=function(t,i,n,r){var o=this.intersectionWithNormalization(t,i,n,r);return this.isInSegmentEnvelopes(o)||(o=new b(e.nearestEndpoint(t,i,n,r))),null!==this._precisionModel&&this._precisionModel.makePrecise(o),o},e.prototype.smallestInAbsValue=function(t,e,i,n){var r=t,o=Math.abs(r);return Math.abs(e)<o&&(r=e,o=Math.abs(e)),Math.abs(i)<o&&(r=i,o=Math.abs(i)),Math.abs(n)<o&&(r=n),r},e.prototype.checkDD=function(t,e,i,n,r){var o=R.intersection(t,e,i,n),s=this.isInSegmentEnvelopes(o);G.out.println("DD in env = "+s+"  --------------------- "+o),r.distance(o)>1e-4&&G.out.println("Distance = "+r.distance(o))},e.prototype.intersectionWithNormalization=function(t,e,i,n){var r=new b(t),o=new b(e),s=new b(i),a=new b(n),A=new b;this.normalizeToEnvCentre(r,o,s,a,A);var l=this.safeHCoordinateIntersection(r,o,s,a);return l.x+=A.x,l.y+=A.y,l},e.prototype.computeCollinearIntersection=function(e,i,n,r){var o=z.intersects(e,i,n),s=z.intersects(e,i,r),a=z.intersects(n,r,e),A=z.intersects(n,r,i);return o&&s?(this._intPt[0]=n,this._intPt[1]=r,t.COLLINEAR_INTERSECTION):a&&A?(this._intPt[0]=e,this._intPt[1]=i,t.COLLINEAR_INTERSECTION):o&&a?(this._intPt[0]=n,this._intPt[1]=e,!n.equals(e)||s||A?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):o&&A?(this._intPt[0]=n,this._intPt[1]=i,!n.equals(i)||s||a?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):s&&a?(this._intPt[0]=r,this._intPt[1]=e,!r.equals(e)||o||A?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):s&&A?(this._intPt[0]=r,this._intPt[1]=i,!r.equals(i)||o||a?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):t.NO_INTERSECTION},e.prototype.normalizeToEnvCentre=function(t,e,i,n,r){var o=t.x<e.x?t.x:e.x,s=t.y<e.y?t.y:e.y,a=t.x>e.x?t.x:e.x,A=t.y>e.y?t.y:e.y,l=i.x<n.x?i.x:n.x,c=i.y<n.y?i.y:n.y,u=i.x>n.x?i.x:n.x,h=i.y>n.y?i.y:n.y,p=((o>l?o:l)+(a<u?a:u))/2,d=((s>c?s:c)+(A<h?A:h))/2;r.x=p,r.y=d,t.x-=r.x,t.y-=r.y,e.x-=r.x,e.y-=r.y,i.x-=r.x,i.y-=r.y,n.x-=r.x,n.y-=r.y},e.prototype.computeIntersect=function(e,i,n,r){if(this._isProper=!1,!z.intersects(e,i,n,r))return t.NO_INTERSECTION;var o=at.orientationIndex(e,i,n),s=at.orientationIndex(e,i,r);if(o>0&&s>0||o<0&&s<0)return t.NO_INTERSECTION;var a=at.orientationIndex(n,r,e),A=at.orientationIndex(n,r,i);return a>0&&A>0||a<0&&A<0?t.NO_INTERSECTION:0===o&&0===s&&0===a&&0===A?this.computeCollinearIntersection(e,i,n,r):(0===o||0===s||0===a||0===A?(this._isProper=!1,e.equals2D(n)||e.equals2D(r)?this._intPt[0]=e:i.equals2D(n)||i.equals2D(r)?this._intPt[0]=i:0===o?this._intPt[0]=new b(n):0===s?this._intPt[0]=new b(r):0===a?this._intPt[0]=new b(e):0===A&&(this._intPt[0]=new b(i))):(this._isProper=!0,this._intPt[0]=this.intersection(e,i,n,r)),t.POINT_INTERSECTION)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.nearestEndpoint=function(t,e,i,n){var r=t,o=at.distancePointLine(t,i,n),s=at.distancePointLine(e,i,n);return s<o&&(o=s,r=e),(s=at.distancePointLine(i,t,e))<o&&(o=s,r=i),(s=at.distancePointLine(n,t,e))<o&&(o=s,r=n),r},e}(it),ot=function(){};ot.prototype.interfaces_=function(){return[]},ot.prototype.getClass=function(){return ot},ot.orientationIndex=function(t,e,i){var n=e.x-t.x,r=e.y-t.y,o=i.x-e.x,s=i.y-e.y;return ot.signOfDet2x2(n,r,o,s)},ot.signOfDet2x2=function(t,e,i,n){var r=null,o=null,s=null;if(r=1,0===t||0===n)return 0===e||0===i?0:e>0?i>0?-r:r:i>0?r:-r;if(0===e||0===i)return n>0?t>0?r:-r:t>0?-r:r;if(e>0?n>0?e<=n||(r=-r,o=t,t=i,i=o,o=e,e=n,n=o):e<=-n?(r=-r,i=-i,n=-n):(o=t,t=-i,i=o,o=e,e=-n,n=o):n>0?-e<=n?(r=-r,t=-t,e=-e):(o=-t,t=i,i=o,o=-e,e=n,n=o):e>=n?(t=-t,e=-e,i=-i,n=-n):(r=-r,o=-t,t=-i,i=o,o=-e,e=-n,n=o),t>0){if(!(i>0))return r;if(!(t<=i))return r}else{if(i>0)return-r;if(!(t>=i))return-r;r=-r,t=-t,i=-i}for(;;){if((n-=(s=Math.floor(i/t))*e)<0)return-r;if(n>e)return r;if(t>(i-=s*t)+i){if(e<n+n)return r}else{if(e>n+n)return-r;i=t-i,n=e-n,r=-r}if(0===n)return 0===i?0:-r;if(0===i)return r;if((e-=(s=Math.floor(t/i))*n)<0)return r;if(e>n)return-r;if(i>(t-=s*i)+t){if(n<e+e)return-r}else{if(n>e+e)return r;t=i-t,e=n-e,r=-r}if(0===e)return 0===t?0:r;if(0===t)return-r}};var st=function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;var t=arguments[0];this._p=t};st.prototype.countSegment=function(t,e){if(t.x<this._p.x&&e.x<this._p.x)return null;if(this._p.x===e.x&&this._p.y===e.y)return this._isPointOnSegment=!0,null;if(t.y===this._p.y&&e.y===this._p.y){var i=t.x,n=e.x;return i>n&&(i=e.x,n=t.x),this._p.x>=i&&this._p.x<=n&&(this._isPointOnSegment=!0),null}if(t.y>this._p.y&&e.y<=this._p.y||e.y>this._p.y&&t.y<=this._p.y){var r=t.x-this._p.x,o=t.y-this._p.y,s=e.x-this._p.x,a=e.y-this._p.y,A=ot.signOfDet2x2(r,o,s,a);if(0===A)return this._isPointOnSegment=!0,null;a<o&&(A=-A),A>0&&this._crossingCount++}},st.prototype.isPointInPolygon=function(){return this.getLocation()!==I.EXTERIOR},st.prototype.getLocation=function(){return this._isPointOnSegment?I.BOUNDARY:this._crossingCount%2==1?I.INTERIOR:I.EXTERIOR},st.prototype.isOnSegment=function(){return this._isPointOnSegment},st.prototype.interfaces_=function(){return[]},st.prototype.getClass=function(){return st},st.locatePointInRing=function(){if(arguments[0]instanceof b&&O(arguments[1],H)){for(var t=arguments[0],e=arguments[1],i=new st(t),n=new b,r=new b,o=1;o<e.size();o++)if(e.getCoordinate(o,n),e.getCoordinate(o-1,r),i.countSegment(n,r),i.isOnSegment())return i.getLocation();return i.getLocation()}if(arguments[0]instanceof b&&arguments[1]instanceof Array){for(var s=arguments[0],a=arguments[1],A=new st(s),l=1;l<a.length;l++){var c=a[l],u=a[l-1];if(A.countSegment(c,u),A.isOnSegment())return A.getLocation()}return A.getLocation()}};var at=function(){},At={CLOCKWISE:{configurable:!0},RIGHT:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},LEFT:{configurable:!0},COLLINEAR:{configurable:!0},STRAIGHT:{configurable:!0}};at.prototype.interfaces_=function(){return[]},at.prototype.getClass=function(){return at},at.orientationIndex=function(t,e,i){return R.orientationIndex(t,e,i)},at.signedArea=function(){if(arguments[0]instanceof Array){var t=arguments[0];if(t.length<3)return 0;for(var e=0,i=t[0].x,n=1;n<t.length-1;n++){var r=t[n].x-i,o=t[n+1].y;e+=r*(t[n-1].y-o)}return e/2}if(O(arguments[0],H)){var s=arguments[0],a=s.size();if(a<3)return 0;var A=new b,l=new b,c=new b;s.getCoordinate(0,l),s.getCoordinate(1,c);var u=l.x;c.x-=u;for(var h=0,p=1;p<a-1;p++)A.y=l.y,l.x=c.x,l.y=c.y,s.getCoordinate(p+1,c),c.x-=u,h+=l.x*(A.y-c.y);return h/2}},at.distanceLineLine=function(t,e,i,n){if(t.equals(e))return at.distancePointLine(t,i,n);if(i.equals(n))return at.distancePointLine(n,t,e);var r=!1;if(z.intersects(t,e,i,n)){var o=(e.x-t.x)*(n.y-i.y)-(e.y-t.y)*(n.x-i.x);if(0===o)r=!0;else{var s=(t.y-i.y)*(n.x-i.x)-(t.x-i.x)*(n.y-i.y),a=((t.y-i.y)*(e.x-t.x)-(t.x-i.x)*(e.y-t.y))/o,A=s/o;(A<0||A>1||a<0||a>1)&&(r=!0)}}else r=!0;return r?P.min(at.distancePointLine(t,i,n),at.distancePointLine(e,i,n),at.distancePointLine(i,t,e),at.distancePointLine(n,t,e)):0},at.isPointInRing=function(t,e){return at.locatePointInRing(t,e)!==I.EXTERIOR},at.computeLength=function(t){var e=t.size();if(e<=1)return 0;var i=0,n=new b;t.getCoordinate(0,n);for(var r=n.x,o=n.y,s=1;s<e;s++){t.getCoordinate(s,n);var a=n.x,A=n.y,l=a-r,c=A-o;i+=Math.sqrt(l*l+c*c),r=a,o=A}return i},at.isCCW=function(t){var e=t.length-1;if(e<3)throw new y("Ring has fewer than 4 points, so orientation cannot be determined");for(var i=t[0],n=0,r=1;r<=e;r++){var o=t[r];o.y>i.y&&(i=o,n=r)}var s=n;do{(s-=1)<0&&(s=e)}while(t[s].equals2D(i)&&s!==n);var a=n;do{a=(a+1)%e}while(t[a].equals2D(i)&&a!==n);var A=t[s],l=t[a];if(A.equals2D(i)||l.equals2D(i)||A.equals2D(l))return!1;var c=at.computeOrientation(A,i,l);return 0===c?A.x>l.x:c>0},at.locatePointInRing=function(t,e){return st.locatePointInRing(t,e)},at.distancePointLinePerpendicular=function(t,e,i){var n=(i.x-e.x)*(i.x-e.x)+(i.y-e.y)*(i.y-e.y),r=((e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y))/n;return Math.abs(r)*Math.sqrt(n)},at.computeOrientation=function(t,e,i){return at.orientationIndex(t,e,i)},at.distancePointLine=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(0===e.length)throw new y("Line array must contain at least one vertex");for(var i=t.distance(e[0]),n=0;n<e.length-1;n++){var r=at.distancePointLine(t,e[n],e[n+1]);r<i&&(i=r)}return i}if(3===arguments.length){var o=arguments[0],s=arguments[1],a=arguments[2];if(s.x===a.x&&s.y===a.y)return o.distance(s);var A=(a.x-s.x)*(a.x-s.x)+(a.y-s.y)*(a.y-s.y),l=((o.x-s.x)*(a.x-s.x)+(o.y-s.y)*(a.y-s.y))/A;if(l<=0)return o.distance(s);if(l>=1)return o.distance(a);var c=((s.y-o.y)*(a.x-s.x)-(s.x-o.x)*(a.y-s.y))/A;return Math.abs(c)*Math.sqrt(A)}},at.isOnLine=function(t,e){for(var i=new rt,n=1;n<e.length;n++){var r=e[n-1],o=e[n];if(i.computeIntersection(t,r,o),i.hasIntersection())return!0}return!1},At.CLOCKWISE.get=function(){return-1},At.RIGHT.get=function(){return at.CLOCKWISE},At.COUNTERCLOCKWISE.get=function(){return 1},At.LEFT.get=function(){return at.COUNTERCLOCKWISE},At.COLLINEAR.get=function(){return 0},At.STRAIGHT.get=function(){return at.COLLINEAR},Object.defineProperties(at,At);var lt=function(){};lt.prototype.filter=function(t){},lt.prototype.interfaces_=function(){return[]},lt.prototype.getClass=function(){return lt};var ct=function(){var t=arguments[0];this._envelope=null,this._factory=null,this._SRID=null,this._userData=null,this._factory=t,this._SRID=t.getSRID()},ut={serialVersionUID:{configurable:!0},SORTINDEX_POINT:{configurable:!0},SORTINDEX_MULTIPOINT:{configurable:!0},SORTINDEX_LINESTRING:{configurable:!0},SORTINDEX_LINEARRING:{configurable:!0},SORTINDEX_MULTILINESTRING:{configurable:!0},SORTINDEX_POLYGON:{configurable:!0},SORTINDEX_MULTIPOLYGON:{configurable:!0},SORTINDEX_GEOMETRYCOLLECTION:{configurable:!0},geometryChangedFilter:{configurable:!0}};ct.prototype.isGeometryCollection=function(){return this.getSortIndex()===ct.SORTINDEX_GEOMETRYCOLLECTION},ct.prototype.getFactory=function(){return this._factory},ct.prototype.getGeometryN=function(t){return this},ct.prototype.getArea=function(){return 0},ct.prototype.isRectangle=function(){return!1},ct.prototype.equals=function(){if(arguments[0]instanceof ct){var t=arguments[0];return null!==t&&this.equalsTopo(t)}if(arguments[0]instanceof Object){var e=arguments[0];if(!(e instanceof ct))return!1;var i=e;return this.equalsExact(i)}},ct.prototype.equalsExact=function(t){return this===t||this.equalsExact(t,0)},ct.prototype.geometryChanged=function(){this.apply(ct.geometryChangedFilter)},ct.prototype.geometryChangedAction=function(){this._envelope=null},ct.prototype.equalsNorm=function(t){return null!==t&&this.norm().equalsExact(t.norm())},ct.prototype.getLength=function(){return 0},ct.prototype.getNumGeometries=function(){return 1},ct.prototype.compareTo=function(){if(1===arguments.length){var t=arguments[0],e=t;return this.getSortIndex()!==e.getSortIndex()?this.getSortIndex()-e.getSortIndex():this.isEmpty()&&e.isEmpty()?0:this.isEmpty()?-1:e.isEmpty()?1:this.compareToSameClass(t)}if(2===arguments.length){var i=arguments[0],n=arguments[1];return this.getSortIndex()!==i.getSortIndex()?this.getSortIndex()-i.getSortIndex():this.isEmpty()&&i.isEmpty()?0:this.isEmpty()?-1:i.isEmpty()?1:this.compareToSameClass(i,n)}},ct.prototype.getUserData=function(){return this._userData},ct.prototype.getSRID=function(){return this._SRID},ct.prototype.getEnvelope=function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())},ct.prototype.checkNotGeometryCollection=function(t){if(t.getSortIndex()===ct.SORTINDEX_GEOMETRYCOLLECTION)throw new y("This method does not support GeometryCollection arguments")},ct.prototype.equal=function(t,e,i){return 0===i?t.equals(e):t.distance(e)<=i},ct.prototype.norm=function(){var t=this.copy();return t.normalize(),t},ct.prototype.getPrecisionModel=function(){return this._factory.getPrecisionModel()},ct.prototype.getEnvelopeInternal=function(){return null===this._envelope&&(this._envelope=this.computeEnvelopeInternal()),new z(this._envelope)},ct.prototype.setSRID=function(t){this._SRID=t},ct.prototype.setUserData=function(t){this._userData=t},ct.prototype.compare=function(t,e){for(var i=t.iterator(),n=e.iterator();i.hasNext()&&n.hasNext();){var r=i.next(),o=n.next(),s=r.compareTo(o);if(0!==s)return s}return i.hasNext()?1:n.hasNext()?-1:0},ct.prototype.hashCode=function(){return this.getEnvelopeInternal().hashCode()},ct.prototype.isGeometryCollectionOrDerived=function(){return this.getSortIndex()===ct.SORTINDEX_GEOMETRYCOLLECTION||this.getSortIndex()===ct.SORTINDEX_MULTIPOINT||this.getSortIndex()===ct.SORTINDEX_MULTILINESTRING||this.getSortIndex()===ct.SORTINDEX_MULTIPOLYGON},ct.prototype.interfaces_=function(){return[C,w,e]},ct.prototype.getClass=function(){return ct},ct.hasNonEmptyElements=function(t){for(var e=0;e<t.length;e++)if(!t[e].isEmpty())return!0;return!1},ct.hasNullElements=function(t){for(var e=0;e<t.length;e++)if(null===t[e])return!0;return!1},ut.serialVersionUID.get=function(){return 0x799ea46522854c00},ut.SORTINDEX_POINT.get=function(){return 0},ut.SORTINDEX_MULTIPOINT.get=function(){return 1},ut.SORTINDEX_LINESTRING.get=function(){return 2},ut.SORTINDEX_LINEARRING.get=function(){return 3},ut.SORTINDEX_MULTILINESTRING.get=function(){return 4},ut.SORTINDEX_POLYGON.get=function(){return 5},ut.SORTINDEX_MULTIPOLYGON.get=function(){return 6},ut.SORTINDEX_GEOMETRYCOLLECTION.get=function(){return 7},ut.geometryChangedFilter.get=function(){return ht},Object.defineProperties(ct,ut);var ht=function(){};ht.interfaces_=function(){return[lt]},ht.filter=function(t){t.geometryChangedAction()};var pt=function(){};pt.prototype.filter=function(t){},pt.prototype.interfaces_=function(){return[]},pt.prototype.getClass=function(){return pt};var dt=function(){},ft={Mod2BoundaryNodeRule:{configurable:!0},EndPointBoundaryNodeRule:{configurable:!0},MultiValentEndPointBoundaryNodeRule:{configurable:!0},MonoValentEndPointBoundaryNodeRule:{configurable:!0},MOD2_BOUNDARY_RULE:{configurable:!0},ENDPOINT_BOUNDARY_RULE:{configurable:!0},MULTIVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},MONOVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},OGC_SFS_BOUNDARY_RULE:{configurable:!0}};dt.prototype.isInBoundary=function(t){},dt.prototype.interfaces_=function(){return[]},dt.prototype.getClass=function(){return dt},ft.Mod2BoundaryNodeRule.get=function(){return gt},ft.EndPointBoundaryNodeRule.get=function(){return mt},ft.MultiValentEndPointBoundaryNodeRule.get=function(){return yt},ft.MonoValentEndPointBoundaryNodeRule.get=function(){return vt},ft.MOD2_BOUNDARY_RULE.get=function(){return new gt},ft.ENDPOINT_BOUNDARY_RULE.get=function(){return new mt},ft.MULTIVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new yt},ft.MONOVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new vt},ft.OGC_SFS_BOUNDARY_RULE.get=function(){return dt.MOD2_BOUNDARY_RULE},Object.defineProperties(dt,ft);var gt=function(){};gt.prototype.isInBoundary=function(t){return t%2==1},gt.prototype.interfaces_=function(){return[dt]},gt.prototype.getClass=function(){return gt};var mt=function(){};mt.prototype.isInBoundary=function(t){return t>0},mt.prototype.interfaces_=function(){return[dt]},mt.prototype.getClass=function(){return mt};var yt=function(){};yt.prototype.isInBoundary=function(t){return t>1},yt.prototype.interfaces_=function(){return[dt]},yt.prototype.getClass=function(){return yt};var vt=function(){};vt.prototype.isInBoundary=function(t){return 1===t},vt.prototype.interfaces_=function(){return[dt]},vt.prototype.getClass=function(){return vt};var _t=function(){};_t.prototype.add=function(){},_t.prototype.addAll=function(){},_t.prototype.isEmpty=function(){},_t.prototype.iterator=function(){},_t.prototype.size=function(){},_t.prototype.toArray=function(){},_t.prototype.remove=function(){},(i.prototype=new Error).name="IndexOutOfBoundsException";var wt=function(){};wt.prototype.hasNext=function(){},wt.prototype.next=function(){},wt.prototype.remove=function(){};var Ct=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(){},e.prototype.set=function(){},e.prototype.isEmpty=function(){},e}(_t);(n.prototype=new Error).name="NoSuchElementException";var Bt=function(t){function e(){t.call(this),this.array_=[],arguments[0]instanceof _t&&this.addAll(arguments[0])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.ensureCapacity=function(){},e.prototype.interfaces_=function(){return[t,_t]},e.prototype.add=function(t){return 1===arguments.length?this.array_.push(t):this.array_.splice(arguments[0],arguments[1]),!0},e.prototype.clear=function(){this.array_=[]},e.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},e.prototype.set=function(t,e){var i=this.array_[t];return this.array_[t]=e,i},e.prototype.iterator=function(){return new bt(this)},e.prototype.get=function(t){if(t<0||t>=this.size())throw new i;return this.array_[t]},e.prototype.isEmpty=function(){return 0===this.array_.length},e.prototype.size=function(){return this.array_.length},e.prototype.toArray=function(){for(var t=[],e=0,i=this.array_.length;e<i;e++)t.push(this.array_[e]);return t},e.prototype.remove=function(t){for(var e=!1,i=0,n=this.array_.length;i<n;i++)if(this.array_[i]===t){this.array_.splice(i,1),e=!0;break}return e},e}(Ct),bt=function(t){function e(e){t.call(this),this.arrayList_=e,this.position_=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.next=function(){if(this.position_===this.arrayList_.size())throw new n;return this.arrayList_.get(this.position_++)},e.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},e.prototype.set=function(t){return this.arrayList_.set(this.position_-1,t)},e.prototype.remove=function(){this.arrayList_.remove(this.arrayList_.get(this.position_))},e}(wt),Et=function(t){function e(){if(t.call(this),0===arguments.length);else if(1===arguments.length){var e=arguments[0];this.ensureCapacity(e.length),this.add(e,!0)}else if(2===arguments.length){var i=arguments[0],n=arguments[1];this.ensureCapacity(i.length),this.add(i,n)}}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var i={coordArrayType:{configurable:!0}};return i.coordArrayType.get=function(){return new Array(0).fill(null)},e.prototype.getCoordinate=function(t){return this.get(t)},e.prototype.addAll=function(){if(2===arguments.length){for(var e=arguments[0],i=arguments[1],n=!1,r=e.iterator();r.hasNext();)this.add(r.next(),i),n=!0;return n}return t.prototype.addAll.apply(this,arguments)},e.prototype.clone=function(){for(var e=t.prototype.clone.call(this),i=0;i<this.size();i++)e.add(i,this.get(i).copy());return e},e.prototype.toCoordinateArray=function(){return this.toArray(e.coordArrayType)},e.prototype.add=function(){if(1===arguments.length){var e=arguments[0];t.prototype.add.call(this,e)}else if(2===arguments.length){if(arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var i=arguments[0],n=arguments[1];return this.add(i,n,!0),!0}if(arguments[0]instanceof b&&"boolean"==typeof arguments[1]){var r=arguments[0];if(!arguments[1]&&this.size()>=1&&this.get(this.size()-1).equals2D(r))return null;t.prototype.add.call(this,r)}else if(arguments[0]instanceof Object&&"boolean"==typeof arguments[1]){var o=arguments[0],s=arguments[1];return this.add(o,s),!0}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var a=arguments[0],A=arguments[1];if(arguments[2])for(var l=0;l<a.length;l++)this.add(a[l],A);else for(var c=a.length-1;c>=0;c--)this.add(a[c],A);return!0}if("boolean"==typeof arguments[2]&&Number.isInteger(arguments[0])&&arguments[1]instanceof b){var u=arguments[0],h=arguments[1];if(!arguments[2]){var p=this.size();if(p>0){if(u>0&&this.get(u-1).equals2D(h))return null;if(u<p&&this.get(u).equals2D(h))return null}}t.prototype.add.call(this,u,h)}}else if(4===arguments.length){var d=arguments[0],f=arguments[1],g=arguments[2],m=arguments[3],y=1;g>m&&(y=-1);for(var v=g;v!==m;v+=y)this.add(d[v],f);return!0}},e.prototype.closeRing=function(){this.size()>0&&this.add(new b(this.get(0)),!1)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},Object.defineProperties(e,i),e}(Bt),St=function(){},xt={ForwardComparator:{configurable:!0},BidirectionalComparator:{configurable:!0},coordArrayType:{configurable:!0}};xt.ForwardComparator.get=function(){return It},xt.BidirectionalComparator.get=function(){return Ft},xt.coordArrayType.get=function(){return new Array(0).fill(null)},St.prototype.interfaces_=function(){return[]},St.prototype.getClass=function(){return St},St.isRing=function(t){return!(t.length<4||!t[0].equals2D(t[t.length-1]))},St.ptNotInList=function(t,e){for(var i=0;i<t.length;i++){var n=t[i];if(St.indexOf(n,e)<0)return n}return null},St.scroll=function(t,e){var i=St.indexOf(e,t);if(i<0)return null;var n=new Array(t.length).fill(null);G.arraycopy(t,i,n,0,t.length-i),G.arraycopy(t,0,n,t.length-i,i),G.arraycopy(n,0,t,0,t.length)},St.equals=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(t===e)return!0;if(null===t||null===e)return!1;if(t.length!==e.length)return!1;for(var i=0;i<t.length;i++)if(!t[i].equals(e[i]))return!1;return!0}if(3===arguments.length){var n=arguments[0],r=arguments[1],o=arguments[2];if(n===r)return!0;if(null===n||null===r)return!1;if(n.length!==r.length)return!1;for(var s=0;s<n.length;s++)if(0!==o.compare(n[s],r[s]))return!1;return!0}},St.intersection=function(t,e){for(var i=new Et,n=0;n<t.length;n++)e.intersects(t[n])&&i.add(t[n],!0);return i.toCoordinateArray()},St.hasRepeatedPoints=function(t){for(var e=1;e<t.length;e++)if(t[e-1].equals(t[e]))return!0;return!1},St.removeRepeatedPoints=function(t){return St.hasRepeatedPoints(t)?new Et(t,!1).toCoordinateArray():t},St.reverse=function(t){for(var e=t.length-1,i=Math.trunc(e/2),n=0;n<=i;n++){var r=t[n];t[n]=t[e-n],t[e-n]=r}},St.removeNull=function(t){for(var e=0,i=0;i<t.length;i++)null!==t[i]&&e++;var n=new Array(e).fill(null);if(0===e)return n;for(var r=0,o=0;o<t.length;o++)null!==t[o]&&(n[r++]=t[o]);return n},St.copyDeep=function(){if(1===arguments.length){for(var t=arguments[0],e=new Array(t.length).fill(null),i=0;i<t.length;i++)e[i]=new b(t[i]);return e}if(5===arguments.length)for(var n=arguments[0],r=arguments[1],o=arguments[2],s=arguments[3],a=arguments[4],A=0;A<a;A++)o[s+A]=new b(n[r+A])},St.isEqualReversed=function(t,e){for(var i=0;i<t.length;i++){var n=t[i],r=e[t.length-i-1];if(0!==n.compareTo(r))return!1}return!0},St.envelope=function(t){for(var e=new z,i=0;i<t.length;i++)e.expandToInclude(t[i]);return e},St.toCoordinateArray=function(t){return t.toArray(St.coordArrayType)},St.atLeastNCoordinatesOrNothing=function(t,e){return e.length>=t?e:[]},St.indexOf=function(t,e){for(var i=0;i<e.length;i++)if(t.equals(e[i]))return i;return-1},St.increasingDirection=function(t){for(var e=0;e<Math.trunc(t.length/2);e++){var i=t.length-1-e,n=t[e].compareTo(t[i]);if(0!==n)return n}return 1},St.compare=function(t,e){for(var i=0;i<t.length&&i<e.length;){var n=t[i].compareTo(e[i]);if(0!==n)return n;i++}return i<e.length?-1:i<t.length?1:0},St.minCoordinate=function(t){for(var e=null,i=0;i<t.length;i++)(null===e||e.compareTo(t[i])>0)&&(e=t[i]);return e},St.extract=function(t,e,i){e=P.clamp(e,0,t.length);var n=(i=P.clamp(i,-1,t.length))-e+1;i<0&&(n=0),e>=t.length&&(n=0),i<e&&(n=0);var r=new Array(n).fill(null);if(0===n)return r;for(var o=0,s=e;s<=i;s++)r[o++]=t[s];return r},Object.defineProperties(St,xt);var It=function(){};It.prototype.compare=function(t,e){return St.compare(t,e)},It.prototype.interfaces_=function(){return[B]},It.prototype.getClass=function(){return It};var Ft=function(){};Ft.prototype.compare=function(t,e){var i=t,n=e;if(i.length<n.length)return-1;if(i.length>n.length)return 1;if(0===i.length)return 0;var r=St.compare(i,n);return St.isEqualReversed(i,n)?0:r},Ft.prototype.OLDcompare=function(t,e){var i=t,n=e;if(i.length<n.length)return-1;if(i.length>n.length)return 1;if(0===i.length)return 0;for(var r=St.increasingDirection(i),o=St.increasingDirection(n),s=r>0?0:i.length-1,a=o>0?0:i.length-1,A=0;A<i.length;A++){var l=i[s].compareTo(n[a]);if(0!==l)return l;s+=r,a+=o}return 0},Ft.prototype.interfaces_=function(){return[B]},Ft.prototype.getClass=function(){return Ft};var Ot=function(){};Ot.prototype.get=function(){},Ot.prototype.put=function(){},Ot.prototype.size=function(){},Ot.prototype.values=function(){},Ot.prototype.entrySet=function(){};var Pt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Ot);(r.prototype=new Error).name="OperationNotSupported",(o.prototype=new _t).contains=function(){};var Tt=function(t){function e(){t.call(this),this.array_=[],arguments[0]instanceof _t&&this.addAll(arguments[0])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contains=function(t){for(var e=0,i=this.array_.length;e<i;e++)if(this.array_[e]===t)return!0;return!1},e.prototype.add=function(t){return!this.contains(t)&&(this.array_.push(t),!0)},e.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},e.prototype.remove=function(t){throw new Error},e.prototype.size=function(){return this.array_.length},e.prototype.isEmpty=function(){return 0===this.array_.length},e.prototype.toArray=function(){for(var t=[],e=0,i=this.array_.length;e<i;e++)t.push(this.array_[e]);return t},e.prototype.iterator=function(){return new Lt(this)},e}(o),Lt=function(t){function e(e){t.call(this),this.hashSet_=e,this.position_=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.next=function(){if(this.position_===this.hashSet_.size())throw new n;return this.hashSet_.array_[this.position_++]},e.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},e.prototype.remove=function(){throw new r},e}(wt),Mt=0;(u.prototype=new Pt).get=function(t){for(var e=this.root_;null!==e;){var i=t.compareTo(e.key);if(i<0)e=e.left;else{if(!(i>0))return e.value;e=e.right}}return null},u.prototype.put=function(t,e){if(null===this.root_)return this.root_={key:t,value:e,left:null,right:null,parent:null,color:Mt,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var i,n,r=this.root_;do{if(i=r,(n=t.compareTo(r.key))<0)r=r.left;else{if(!(n>0)){var o=r.value;return r.value=e,o}r=r.right}}while(null!==r);var s={key:t,left:null,right:null,value:e,parent:i,color:Mt,getValue:function(){return this.value},getKey:function(){return this.key}};return n<0?i.left=s:i.right=s,this.fixAfterInsertion(s),this.size_++,null},u.prototype.fixAfterInsertion=function(t){for(t.color=1;null!=t&&t!==this.root_&&1===t.parent.color;)if(a(t)===l(a(a(t)))){var e=c(a(a(t)));1===s(e)?(A(a(t),Mt),A(e,Mt),A(a(a(t)),1),t=a(a(t))):(t===c(a(t))&&(t=a(t),this.rotateLeft(t)),A(a(t),Mt),A(a(a(t)),1),this.rotateRight(a(a(t))))}else{var i=l(a(a(t)));1===s(i)?(A(a(t),Mt),A(i,Mt),A(a(a(t)),1),t=a(a(t))):(t===l(a(t))&&(t=a(t),this.rotateRight(t)),A(a(t),Mt),A(a(a(t)),1),this.rotateLeft(a(a(t))))}this.root_.color=Mt},u.prototype.values=function(){var t=new Bt,e=this.getFirstEntry();if(null!==e)for(t.add(e.value);null!==(e=u.successor(e));)t.add(e.value);return t},u.prototype.entrySet=function(){var t=new Tt,e=this.getFirstEntry();if(null!==e)for(t.add(e);null!==(e=u.successor(e));)t.add(e);return t},u.prototype.rotateLeft=function(t){if(null!=t){var e=t.right;t.right=e.left,null!=e.left&&(e.left.parent=t),e.parent=t.parent,null===t.parent?this.root_=e:t.parent.left===t?t.parent.left=e:t.parent.right=e,e.left=t,t.parent=e}},u.prototype.rotateRight=function(t){if(null!=t){var e=t.left;t.left=e.right,null!=e.right&&(e.right.parent=t),e.parent=t.parent,null===t.parent?this.root_=e:t.parent.right===t?t.parent.right=e:t.parent.left=e,e.right=t,t.parent=e}},u.prototype.getFirstEntry=function(){var t=this.root_;if(null!=t)for(;null!=t.left;)t=t.left;return t},u.successor=function(t){if(null===t)return null;if(null!==t.right){for(var e=t.right;null!==e.left;)e=e.left;return e}for(var i=t.parent,n=t;null!==i&&n===i.right;)n=i,i=i.parent;return i},u.prototype.size=function(){return this.size_};var Ut=function(){};Ut.prototype.interfaces_=function(){return[]},Ut.prototype.getClass=function(){return Ut},h.prototype=new o,(p.prototype=new h).contains=function(t){for(var e=0,i=this.array_.length;e<i;e++)if(0===this.array_[e].compareTo(t))return!0;return!1},p.prototype.add=function(t){if(this.contains(t))return!1;for(var e=0,i=this.array_.length;e<i;e++)if(1===this.array_[e].compareTo(t))return this.array_.splice(e,0,t),!0;return this.array_.push(t),!0},p.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},p.prototype.remove=function(t){throw new r},p.prototype.size=function(){return this.array_.length},p.prototype.isEmpty=function(){return 0===this.array_.length},p.prototype.toArray=function(){for(var t=[],e=0,i=this.array_.length;e<i;e++)t.push(this.array_[e]);return t},p.prototype.iterator=function(){return new Dt(this)};var Dt=function(t){this.treeSet_=t,this.position_=0};Dt.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new n;return this.treeSet_.array_[this.position_++]},Dt.prototype.hasNext=function(){return this.position_<this.treeSet_.size()},Dt.prototype.remove=function(){throw new r};var Qt=function(){};Qt.sort=function(){var t,e,i,n,r=arguments[0];if(1===arguments.length)n=function(t,e){return t.compareTo(e)},r.sort(n);else if(2===arguments.length)i=arguments[1],n=function(t,e){return i.compare(t,e)},r.sort(n);else if(3===arguments.length){(e=r.slice(arguments[1],arguments[2])).sort();var o=r.slice(0,arguments[1]).concat(e,r.slice(arguments[2],r.length));for(r.splice(0,r.length),t=0;t<o.length;t++)r.push(o[t])}else if(4===arguments.length)for(e=r.slice(arguments[1],arguments[2]),i=arguments[3],n=function(t,e){return i.compare(t,e)},e.sort(n),o=r.slice(0,arguments[1]).concat(e,r.slice(arguments[2],r.length)),r.splice(0,r.length),t=0;t<o.length;t++)r.push(o[t])},Qt.asList=function(t){for(var e=new Bt,i=0,n=t.length;i<n;i++)e.add(t[i]);return e};var Rt=function(){},Nt={P:{configurable:!0},L:{configurable:!0},A:{configurable:!0},FALSE:{configurable:!0},TRUE:{configurable:!0},DONTCARE:{configurable:!0},SYM_FALSE:{configurable:!0},SYM_TRUE:{configurable:!0},SYM_DONTCARE:{configurable:!0},SYM_P:{configurable:!0},SYM_L:{configurable:!0},SYM_A:{configurable:!0}};Nt.P.get=function(){return 0},Nt.L.get=function(){return 1},Nt.A.get=function(){return 2},Nt.FALSE.get=function(){return-1},Nt.TRUE.get=function(){return-2},Nt.DONTCARE.get=function(){return-3},Nt.SYM_FALSE.get=function(){return"F"},Nt.SYM_TRUE.get=function(){return"T"},Nt.SYM_DONTCARE.get=function(){return"*"},Nt.SYM_P.get=function(){return"0"},Nt.SYM_L.get=function(){return"1"},Nt.SYM_A.get=function(){return"2"},Rt.prototype.interfaces_=function(){return[]},Rt.prototype.getClass=function(){return Rt},Rt.toDimensionSymbol=function(t){switch(t){case Rt.FALSE:return Rt.SYM_FALSE;case Rt.TRUE:return Rt.SYM_TRUE;case Rt.DONTCARE:return Rt.SYM_DONTCARE;case Rt.P:return Rt.SYM_P;case Rt.L:return Rt.SYM_L;case Rt.A:return Rt.SYM_A}throw new y("Unknown dimension value: "+t)},Rt.toDimensionValue=function(t){switch(U.toUpperCase(t)){case Rt.SYM_FALSE:return Rt.FALSE;case Rt.SYM_TRUE:return Rt.TRUE;case Rt.SYM_DONTCARE:return Rt.DONTCARE;case Rt.SYM_P:return Rt.P;case Rt.SYM_L:return Rt.L;case Rt.SYM_A:return Rt.A}throw new y("Unknown dimension symbol: "+t)},Object.defineProperties(Rt,Nt);var Ht=function(){};Ht.prototype.filter=function(t){},Ht.prototype.interfaces_=function(){return[]},Ht.prototype.getClass=function(){return Ht};var kt=function(){};kt.prototype.filter=function(t,e){},kt.prototype.isDone=function(){},kt.prototype.isGeometryChanged=function(){},kt.prototype.interfaces_=function(){return[]},kt.prototype.getClass=function(){return kt};var Vt=function(t){function e(e,i){if(t.call(this,i),this._geometries=e||[],t.hasNullElements(this._geometries))throw new y("geometries must not contain null elements")}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var i={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){for(var t=new z,e=0;e<this._geometries.length;e++)t.expandToInclude(this._geometries[e].getEnvelopeInternal());return t},e.prototype.getGeometryN=function(t){return this._geometries[t]},e.prototype.getSortIndex=function(){return t.SORTINDEX_GEOMETRYCOLLECTION},e.prototype.getCoordinates=function(){for(var t=new Array(this.getNumPoints()).fill(null),e=-1,i=0;i<this._geometries.length;i++)for(var n=this._geometries[i].getCoordinates(),r=0;r<n.length;r++)t[++e]=n[r];return t},e.prototype.getArea=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getArea();return t},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],i=arguments[1];if(!this.isEquivalentClass(e))return!1;var n=e;if(this._geometries.length!==n._geometries.length)return!1;for(var r=0;r<this._geometries.length;r++)if(!this._geometries[r].equalsExact(n._geometries[r],i))return!1;return!0}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){for(var t=0;t<this._geometries.length;t++)this._geometries[t].normalize();Qt.sort(this._geometries)},e.prototype.getCoordinate=function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()},e.prototype.getBoundaryDimension=function(){for(var t=Rt.FALSE,e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getBoundaryDimension());return t},e.prototype.getDimension=function(){for(var t=Rt.FALSE,e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getDimension());return t},e.prototype.getLength=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getLength();return t},e.prototype.getNumPoints=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getNumPoints();return t},e.prototype.getNumGeometries=function(){return this._geometries.length},e.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),i=0;i<this._geometries.length;i++)e[i]=this._geometries[i].reverse();return this.getFactory().createGeometryCollection(e)},e.prototype.compareToSameClass=function(){if(1===arguments.length){var t=arguments[0],e=new p(Qt.asList(this._geometries)),i=new p(Qt.asList(t._geometries));return this.compare(e,i)}if(2===arguments.length){for(var n=arguments[0],r=arguments[1],o=n,s=this.getNumGeometries(),a=o.getNumGeometries(),A=0;A<s&&A<a;){var l=this.getGeometryN(A),c=o.getGeometryN(A),u=l.compareToSameClass(c,r);if(0!==u)return u;A++}return A<s?1:A<a?-1:0}},e.prototype.apply=function(){if(O(arguments[0],pt))for(var t=arguments[0],e=0;e<this._geometries.length;e++)this._geometries[e].apply(t);else if(O(arguments[0],kt)){var i=arguments[0];if(0===this._geometries.length)return null;for(var n=0;n<this._geometries.length&&(this._geometries[n].apply(i),!i.isDone());n++);i.isGeometryChanged()&&this.geometryChanged()}else if(O(arguments[0],Ht)){var r=arguments[0];r.filter(this);for(var o=0;o<this._geometries.length;o++)this._geometries[o].apply(r)}else if(O(arguments[0],lt)){var s=arguments[0];s.filter(this);for(var a=0;a<this._geometries.length;a++)this._geometries[a].apply(s)}},e.prototype.getBoundary=function(){return this.checkNotGeometryCollection(this),et.shouldNeverReachHere(),null},e.prototype.clone=function(){var e=t.prototype.clone.call(this);e._geometries=new Array(this._geometries.length).fill(null);for(var i=0;i<this._geometries.length;i++)e._geometries[i]=this._geometries[i].clone();return e},e.prototype.getGeometryType=function(){return"GeometryCollection"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),i=0;i<t.length;i++)t[i]=this._geometries[i].copy();return new e(t,this._factory)},e.prototype.isEmpty=function(){for(var t=0;t<this._geometries.length;t++)if(!this._geometries[t].isEmpty())return!1;return!0},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},i.serialVersionUID.get=function(){return-0x4f07bcb1f857d800},Object.defineProperties(e,i),e}(ct),jt=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var i={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return ct.SORTINDEX_MULTILINESTRING},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],i=arguments[1];return!!this.isEquivalentClass(e)&&t.prototype.equalsExact.call(this,e,i)}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return this.isClosed()?Rt.FALSE:0},e.prototype.isClosed=function(){if(this.isEmpty())return!1;for(var t=0;t<this._geometries.length;t++)if(!this._geometries[t].isClosed())return!1;return!0},e.prototype.getDimension=function(){return 1},e.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),i=0;i<this._geometries.length;i++)e[t-1-i]=this._geometries[i].reverse();return this.getFactory().createMultiLineString(e)},e.prototype.getBoundary=function(){return new Gt(this).getBoundary()},e.prototype.getGeometryType=function(){return"MultiLineString"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),i=0;i<t.length;i++)t[i]=this._geometries[i].copy();return new e(t,this._factory)},e.prototype.interfaces_=function(){return[Ut]},e.prototype.getClass=function(){return e},i.serialVersionUID.get=function(){return 0x7155d2ab4afa8000},Object.defineProperties(e,i),e}(Vt),Gt=function(){if(this._geom=null,this._geomFact=null,this._bnRule=null,this._endpointMap=null,1===arguments.length){var t=arguments[0],e=dt.MOD2_BOUNDARY_RULE;this._geom=t,this._geomFact=t.getFactory(),this._bnRule=e}else if(2===arguments.length){var i=arguments[0],n=arguments[1];this._geom=i,this._geomFact=i.getFactory(),this._bnRule=n}};Gt.prototype.boundaryMultiLineString=function(t){if(this._geom.isEmpty())return this.getEmptyMultiPoint();var e=this.computeBoundaryCoordinates(t);return 1===e.length?this._geomFact.createPoint(e[0]):this._geomFact.createMultiPointFromCoords(e)},Gt.prototype.getBoundary=function(){return this._geom instanceof Xt?this.boundaryLineString(this._geom):this._geom instanceof jt?this.boundaryMultiLineString(this._geom):this._geom.getBoundary()},Gt.prototype.boundaryLineString=function(t){return this._geom.isEmpty()?this.getEmptyMultiPoint():t.isClosed()?this._bnRule.isInBoundary(2)?t.getStartPoint():this._geomFact.createMultiPoint():this._geomFact.createMultiPoint([t.getStartPoint(),t.getEndPoint()])},Gt.prototype.getEmptyMultiPoint=function(){return this._geomFact.createMultiPoint()},Gt.prototype.computeBoundaryCoordinates=function(t){var e=new Bt;this._endpointMap=new u;for(var i=0;i<t.getNumGeometries();i++){var n=t.getGeometryN(i);0!==n.getNumPoints()&&(this.addEndpoint(n.getCoordinateN(0)),this.addEndpoint(n.getCoordinateN(n.getNumPoints()-1)))}for(var r=this._endpointMap.entrySet().iterator();r.hasNext();){var o=r.next(),s=o.getValue().count;this._bnRule.isInBoundary(s)&&e.add(o.getKey())}return St.toCoordinateArray(e)},Gt.prototype.addEndpoint=function(t){var e=this._endpointMap.get(t);null===e&&(e=new Kt,this._endpointMap.put(t,e)),e.count++},Gt.prototype.interfaces_=function(){return[]},Gt.prototype.getClass=function(){return Gt},Gt.getBoundary=function(){if(1===arguments.length){var t=arguments[0];return new Gt(t).getBoundary()}if(2===arguments.length){var e=arguments[0],i=arguments[1];return new Gt(e,i).getBoundary()}};var Kt=function(){this.count=null};Kt.prototype.interfaces_=function(){return[]},Kt.prototype.getClass=function(){return Kt};var zt=function(){},Wt={NEWLINE:{configurable:!0},SIMPLE_ORDINATE_FORMAT:{configurable:!0}};zt.prototype.interfaces_=function(){return[]},zt.prototype.getClass=function(){return zt},zt.chars=function(t,e){for(var i=new Array(e).fill(null),n=0;n<e;n++)i[n]=t;return String(i)},zt.getStackTrace=function(){if(1===arguments.length){var t=arguments[0],e=new function(){},i=new function(){}(e);return t.printStackTrace(i),e.toString()}if(2===arguments.length){for(var n=arguments[0],r=arguments[1],o="",s=new function(){}(new function(){}(zt.getStackTrace(n))),a=0;a<r;a++)try{o+=s.readLine()+zt.NEWLINE}catch(t){if(!(t instanceof d))throw t;et.shouldNeverReachHere()}return o}},zt.split=function(t,e){for(var i=e.length,n=new Bt,r=""+t,o=r.indexOf(e);o>=0;){var s=r.substring(0,o);n.add(s),o=(r=r.substring(o+i)).indexOf(e)}r.length>0&&n.add(r);for(var a=new Array(n.size()).fill(null),A=0;A<a.length;A++)a[A]=n.get(A);return a},zt.toString=function(){if(1===arguments.length){var t=arguments[0];return zt.SIMPLE_ORDINATE_FORMAT.format(t)}},zt.spaces=function(t){return zt.chars(" ",t)},Wt.NEWLINE.get=function(){return G.getProperty("line.separator")},Wt.SIMPLE_ORDINATE_FORMAT.get=function(){return new function(){}("0.#")},Object.defineProperties(zt,Wt);var qt=function(){};qt.prototype.interfaces_=function(){return[]},qt.prototype.getClass=function(){return qt},qt.copyCoord=function(t,e,i,n){for(var r=Math.min(t.getDimension(),i.getDimension()),o=0;o<r;o++)i.setOrdinate(n,o,t.getOrdinate(e,o))},qt.isRing=function(t){var e=t.size();return 0===e||!(e<=3)&&t.getOrdinate(0,H.X)===t.getOrdinate(e-1,H.X)&&t.getOrdinate(0,H.Y)===t.getOrdinate(e-1,H.Y)},qt.isEqual=function(t,e){var i=t.size();if(i!==e.size())return!1;for(var n=Math.min(t.getDimension(),e.getDimension()),r=0;r<i;r++)for(var o=0;o<n;o++){var s=t.getOrdinate(r,o),a=e.getOrdinate(r,o);if(!(t.getOrdinate(r,o)===e.getOrdinate(r,o)||v.isNaN(s)&&v.isNaN(a)))return!1}return!0},qt.extend=function(t,e,i){var n=t.create(i,e.getDimension()),r=e.size();if(qt.copy(e,0,n,0,r),r>0)for(var o=r;o<i;o++)qt.copy(e,r-1,n,o,1);return n},qt.reverse=function(t){for(var e=t.size()-1,i=Math.trunc(e/2),n=0;n<=i;n++)qt.swap(t,n,e-n)},qt.swap=function(t,e,i){if(e===i)return null;for(var n=0;n<t.getDimension();n++){var r=t.getOrdinate(e,n);t.setOrdinate(e,n,t.getOrdinate(i,n)),t.setOrdinate(i,n,r)}},qt.copy=function(t,e,i,n,r){for(var o=0;o<r;o++)qt.copyCoord(t,e+o,i,n+o)},qt.toString=function(){if(1===arguments.length){var t=arguments[0],e=t.size();if(0===e)return"()";var i=t.getDimension(),n=new L;n.append("(");for(var r=0;r<e;r++){r>0&&n.append(" ");for(var o=0;o<i;o++)o>0&&n.append(","),n.append(zt.toString(t.getOrdinate(r,o)))}return n.append(")"),n.toString()}},qt.ensureValidRing=function(t,e){var i=e.size();return 0===i?e:i<=3?qt.createClosedRing(t,e,4):e.getOrdinate(0,H.X)===e.getOrdinate(i-1,H.X)&&e.getOrdinate(0,H.Y)===e.getOrdinate(i-1,H.Y)?e:qt.createClosedRing(t,e,i+1)},qt.createClosedRing=function(t,e,i){var n=t.create(i,e.getDimension()),r=e.size();qt.copy(e,0,n,0,r);for(var o=r;o<i;o++)qt.copy(e,0,n,o,1);return n};var Xt=function(t){function e(e,i){t.call(this,i),this._points=null,this.init(e)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var i={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){return this.isEmpty()?new z:this._points.expandEnvelope(new z)},e.prototype.isRing=function(){return this.isClosed()&&this.isSimple()},e.prototype.getSortIndex=function(){return t.SORTINDEX_LINESTRING},e.prototype.getCoordinates=function(){return this._points.toCoordinateArray()},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],i=arguments[1];if(!this.isEquivalentClass(e))return!1;var n=e;if(this._points.size()!==n._points.size())return!1;for(var r=0;r<this._points.size();r++)if(!this.equal(this._points.getCoordinate(r),n._points.getCoordinate(r),i))return!1;return!0}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){for(var t=0;t<Math.trunc(this._points.size()/2);t++){var e=this._points.size()-1-t;if(!this._points.getCoordinate(t).equals(this._points.getCoordinate(e)))return this._points.getCoordinate(t).compareTo(this._points.getCoordinate(e))>0&&qt.reverse(this._points),null}},e.prototype.getCoordinate=function(){return this.isEmpty()?null:this._points.getCoordinate(0)},e.prototype.getBoundaryDimension=function(){return this.isClosed()?Rt.FALSE:0},e.prototype.isClosed=function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))},e.prototype.getEndPoint=function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)},e.prototype.getDimension=function(){return 1},e.prototype.getLength=function(){return at.computeLength(this._points)},e.prototype.getNumPoints=function(){return this._points.size()},e.prototype.reverse=function(){var t=this._points.copy();return qt.reverse(t),this.getFactory().createLineString(t)},e.prototype.compareToSameClass=function(){if(1===arguments.length){for(var t=arguments[0],e=0,i=0;e<this._points.size()&&i<t._points.size();){var n=this._points.getCoordinate(e).compareTo(t._points.getCoordinate(i));if(0!==n)return n;e++,i++}return e<this._points.size()?1:i<t._points.size()?-1:0}if(2===arguments.length){var r=arguments[0];return arguments[1].compare(this._points,r._points)}},e.prototype.apply=function(){if(O(arguments[0],pt))for(var t=arguments[0],e=0;e<this._points.size();e++)t.filter(this._points.getCoordinate(e));else if(O(arguments[0],kt)){var i=arguments[0];if(0===this._points.size())return null;for(var n=0;n<this._points.size()&&(i.filter(this._points,n),!i.isDone());n++);i.isGeometryChanged()&&this.geometryChanged()}else(O(arguments[0],Ht)||O(arguments[0],lt))&&arguments[0].filter(this)},e.prototype.getBoundary=function(){return new Gt(this).getBoundary()},e.prototype.isEquivalentClass=function(t){return t instanceof e},e.prototype.clone=function(){var e=t.prototype.clone.call(this);return e._points=this._points.clone(),e},e.prototype.getCoordinateN=function(t){return this._points.getCoordinate(t)},e.prototype.getGeometryType=function(){return"LineString"},e.prototype.copy=function(){return new e(this._points.copy(),this._factory)},e.prototype.getCoordinateSequence=function(){return this._points},e.prototype.isEmpty=function(){return 0===this._points.size()},e.prototype.init=function(t){if(null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),1===t.size())throw new y("Invalid number of points in LineString (found "+t.size()+" - must be 0 or >= 2)");this._points=t},e.prototype.isCoordinate=function(t){for(var e=0;e<this._points.size();e++)if(this._points.getCoordinate(e).equals(t))return!0;return!1},e.prototype.getStartPoint=function(){return this.isEmpty()?null:this.getPointN(0)},e.prototype.getPointN=function(t){return this.getFactory().createPoint(this._points.getCoordinate(t))},e.prototype.interfaces_=function(){return[Ut]},e.prototype.getClass=function(){return e},i.serialVersionUID.get=function(){return 0x2b2b51ba435c8e00},Object.defineProperties(e,i),e}(ct),Yt=function(){};Yt.prototype.interfaces_=function(){return[]},Yt.prototype.getClass=function(){return Yt};var Jt=function(t){function e(e,i){t.call(this,i),this._coordinates=e||null,this.init(this._coordinates)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var i={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){if(this.isEmpty())return new z;var t=new z;return t.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),t},e.prototype.getSortIndex=function(){return t.SORTINDEX_POINT},e.prototype.getCoordinates=function(){return this.isEmpty()?[]:[this.getCoordinate()]},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],i=arguments[1];return!!this.isEquivalentClass(e)&&(!(!this.isEmpty()||!e.isEmpty())||this.isEmpty()===e.isEmpty()&&this.equal(e.getCoordinate(),this.getCoordinate(),i))}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){},e.prototype.getCoordinate=function(){return 0!==this._coordinates.size()?this._coordinates.getCoordinate(0):null},e.prototype.getBoundaryDimension=function(){return Rt.FALSE},e.prototype.getDimension=function(){return 0},e.prototype.getNumPoints=function(){return this.isEmpty()?0:1},e.prototype.reverse=function(){return this.copy()},e.prototype.getX=function(){if(null===this.getCoordinate())throw new Error("getX called on empty Point");return this.getCoordinate().x},e.prototype.compareToSameClass=function(){if(1===arguments.length){var t=arguments[0];return this.getCoordinate().compareTo(t.getCoordinate())}if(2===arguments.length){var e=arguments[0];return arguments[1].compare(this._coordinates,e._coordinates)}},e.prototype.apply=function(){if(O(arguments[0],pt)){var t=arguments[0];if(this.isEmpty())return null;t.filter(this.getCoordinate())}else if(O(arguments[0],kt)){var e=arguments[0];if(this.isEmpty())return null;e.filter(this._coordinates,0),e.isGeometryChanged()&&this.geometryChanged()}else(O(arguments[0],Ht)||O(arguments[0],lt))&&arguments[0].filter(this)},e.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},e.prototype.clone=function(){var e=t.prototype.clone.call(this);return e._coordinates=this._coordinates.clone(),e},e.prototype.getGeometryType=function(){return"Point"},e.prototype.copy=function(){return new e(this._coordinates.copy(),this._factory)},e.prototype.getCoordinateSequence=function(){return this._coordinates},e.prototype.getY=function(){if(null===this.getCoordinate())throw new Error("getY called on empty Point");return this.getCoordinate().y},e.prototype.isEmpty=function(){return 0===this._coordinates.size()},e.prototype.init=function(t){null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),et.isTrue(t.size()<=1),this._coordinates=t},e.prototype.isSimple=function(){return!0},e.prototype.interfaces_=function(){return[Yt]},e.prototype.getClass=function(){return e},i.serialVersionUID.get=function(){return 0x44077bad161cbc00},Object.defineProperties(e,i),e}(ct),Zt=function(){};Zt.prototype.interfaces_=function(){return[]},Zt.prototype.getClass=function(){return Zt};var $t=function(t){function e(e,i,n){if(t.call(this,n),this._shell=null,this._holes=null,null===e&&(e=this.getFactory().createLinearRing()),null===i&&(i=[]),t.hasNullElements(i))throw new y("holes must not contain null elements");if(e.isEmpty()&&t.hasNonEmptyElements(i))throw new y("shell is empty but holes are not");this._shell=e,this._holes=i}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var i={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){return this._shell.getEnvelopeInternal()},e.prototype.getSortIndex=function(){return t.SORTINDEX_POLYGON},e.prototype.getCoordinates=function(){if(this.isEmpty())return[];for(var t=new Array(this.getNumPoints()).fill(null),e=-1,i=this._shell.getCoordinates(),n=0;n<i.length;n++)t[++e]=i[n];for(var r=0;r<this._holes.length;r++)for(var o=this._holes[r].getCoordinates(),s=0;s<o.length;s++)t[++e]=o[s];return t},e.prototype.getArea=function(){var t=0;t+=Math.abs(at.signedArea(this._shell.getCoordinateSequence()));for(var e=0;e<this._holes.length;e++)t-=Math.abs(at.signedArea(this._holes[e].getCoordinateSequence()));return t},e.prototype.isRectangle=function(){if(0!==this.getNumInteriorRing())return!1;if(null===this._shell)return!1;if(5!==this._shell.getNumPoints())return!1;for(var t=this._shell.getCoordinateSequence(),e=this.getEnvelopeInternal(),i=0;i<5;i++){var n=t.getX(i);if(n!==e.getMinX()&&n!==e.getMaxX())return!1;var r=t.getY(i);if(r!==e.getMinY()&&r!==e.getMaxY())return!1}for(var o=t.getX(0),s=t.getY(0),a=1;a<=4;a++){var A=t.getX(a),l=t.getY(a);if(A!==o==(l!==s))return!1;o=A,s=l}return!0},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],i=arguments[1];if(!this.isEquivalentClass(e))return!1;var n=e,r=this._shell,o=n._shell;if(!r.equalsExact(o,i))return!1;if(this._holes.length!==n._holes.length)return!1;for(var s=0;s<this._holes.length;s++)if(!this._holes[s].equalsExact(n._holes[s],i))return!1;return!0}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){if(0===arguments.length){this.normalize(this._shell,!0);for(var t=0;t<this._holes.length;t++)this.normalize(this._holes[t],!1);Qt.sort(this._holes)}else if(2===arguments.length){var e=arguments[0],i=arguments[1];if(e.isEmpty())return null;var n=new Array(e.getCoordinates().length-1).fill(null);G.arraycopy(e.getCoordinates(),0,n,0,n.length);var r=St.minCoordinate(e.getCoordinates());St.scroll(n,r),G.arraycopy(n,0,e.getCoordinates(),0,n.length),e.getCoordinates()[n.length]=n[0],at.isCCW(e.getCoordinates())===i&&St.reverse(e.getCoordinates())}},e.prototype.getCoordinate=function(){return this._shell.getCoordinate()},e.prototype.getNumInteriorRing=function(){return this._holes.length},e.prototype.getBoundaryDimension=function(){return 1},e.prototype.getDimension=function(){return 2},e.prototype.getLength=function(){var t=0;t+=this._shell.getLength();for(var e=0;e<this._holes.length;e++)t+=this._holes[e].getLength();return t},e.prototype.getNumPoints=function(){for(var t=this._shell.getNumPoints(),e=0;e<this._holes.length;e++)t+=this._holes[e].getNumPoints();return t},e.prototype.reverse=function(){var t=this.copy();t._shell=this._shell.copy().reverse(),t._holes=new Array(this._holes.length).fill(null);for(var e=0;e<this._holes.length;e++)t._holes[e]=this._holes[e].copy().reverse();return t},e.prototype.convexHull=function(){return this.getExteriorRing().convexHull()},e.prototype.compareToSameClass=function(){if(1===arguments.length){var t=arguments[0],e=this._shell,i=t._shell;return e.compareToSameClass(i)}if(2===arguments.length){var n=arguments[0],r=arguments[1],o=n,s=this._shell,a=o._shell,A=s.compareToSameClass(a,r);if(0!==A)return A;for(var l=this.getNumInteriorRing(),c=o.getNumInteriorRing(),u=0;u<l&&u<c;){var h=this.getInteriorRingN(u),p=o.getInteriorRingN(u),d=h.compareToSameClass(p,r);if(0!==d)return d;u++}return u<l?1:u<c?-1:0}},e.prototype.apply=function(t){if(O(t,pt)){this._shell.apply(t);for(var e=0;e<this._holes.length;e++)this._holes[e].apply(t)}else if(O(t,kt)){if(this._shell.apply(t),!t.isDone())for(var i=0;i<this._holes.length&&(this._holes[i].apply(t),!t.isDone());i++);t.isGeometryChanged()&&this.geometryChanged()}else if(O(t,Ht))t.filter(this);else if(O(t,lt)){t.filter(this),this._shell.apply(t);for(var n=0;n<this._holes.length;n++)this._holes[n].apply(t)}},e.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var t=new Array(this._holes.length+1).fill(null);t[0]=this._shell;for(var e=0;e<this._holes.length;e++)t[e+1]=this._holes[e];return t.length<=1?this.getFactory().createLinearRing(t[0].getCoordinateSequence()):this.getFactory().createMultiLineString(t)},e.prototype.clone=function(){var e=t.prototype.clone.call(this);e._shell=this._shell.clone(),e._holes=new Array(this._holes.length).fill(null);for(var i=0;i<this._holes.length;i++)e._holes[i]=this._holes[i].clone();return e},e.prototype.getGeometryType=function(){return"Polygon"},e.prototype.copy=function(){for(var t=this._shell.copy(),i=new Array(this._holes.length).fill(null),n=0;n<i.length;n++)i[n]=this._holes[n].copy();return new e(t,i,this._factory)},e.prototype.getExteriorRing=function(){return this._shell},e.prototype.isEmpty=function(){return this._shell.isEmpty()},e.prototype.getInteriorRingN=function(t){return this._holes[t]},e.prototype.interfaces_=function(){return[Zt]},e.prototype.getClass=function(){return e},i.serialVersionUID.get=function(){return-0x307ffefd8dc97200},Object.defineProperties(e,i),e}(ct),te=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var i={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return ct.SORTINDEX_MULTIPOINT},e.prototype.isValid=function(){return!0},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],i=arguments[1];return!!this.isEquivalentClass(e)&&t.prototype.equalsExact.call(this,e,i)}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.getCoordinate=function(){if(1===arguments.length){var e=arguments[0];return this._geometries[e].getCoordinate()}return t.prototype.getCoordinate.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return Rt.FALSE},e.prototype.getDimension=function(){return 0},e.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},e.prototype.getGeometryType=function(){return"MultiPoint"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),i=0;i<t.length;i++)t[i]=this._geometries[i].copy();return new e(t,this._factory)},e.prototype.interfaces_=function(){return[Yt]},e.prototype.getClass=function(){return e},i.serialVersionUID.get=function(){return-0x6fb1ed4162e0fc00},Object.defineProperties(e,i),e}(Vt),ee=function(t){function e(e,i){e instanceof b&&i instanceof me&&(e=i.getCoordinateSequenceFactory().create(e)),t.call(this,e,i),this.validateConstruction()}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var i={MINIMUM_VALID_SIZE:{configurable:!0},serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return ct.SORTINDEX_LINEARRING},e.prototype.getBoundaryDimension=function(){return Rt.FALSE},e.prototype.isClosed=function(){return!!this.isEmpty()||t.prototype.isClosed.call(this)},e.prototype.reverse=function(){var t=this._points.copy();return qt.reverse(t),this.getFactory().createLinearRing(t)},e.prototype.validateConstruction=function(){if(!this.isEmpty()&&!t.prototype.isClosed.call(this))throw new y("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<e.MINIMUM_VALID_SIZE)throw new y("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")},e.prototype.getGeometryType=function(){return"LinearRing"},e.prototype.copy=function(){return new e(this._points.copy(),this._factory)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},i.MINIMUM_VALID_SIZE.get=function(){return 4},i.serialVersionUID.get=function(){return-0x3b229e262367a600},Object.defineProperties(e,i),e}(Xt),ie=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var i={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return ct.SORTINDEX_MULTIPOLYGON},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],i=arguments[1];return!!this.isEquivalentClass(e)&&t.prototype.equalsExact.call(this,e,i)}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return 1},e.prototype.getDimension=function(){return 2},e.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),i=0;i<this._geometries.length;i++)e[i]=this._geometries[i].reverse();return this.getFactory().createMultiPolygon(e)},e.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var t=new Bt,e=0;e<this._geometries.length;e++)for(var i=this._geometries[e].getBoundary(),n=0;n<i.getNumGeometries();n++)t.add(i.getGeometryN(n));var r=new Array(t.size()).fill(null);return this.getFactory().createMultiLineString(t.toArray(r))},e.prototype.getGeometryType=function(){return"MultiPolygon"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),i=0;i<t.length;i++)t[i]=this._geometries[i].copy();return new e(t,this._factory)},e.prototype.interfaces_=function(){return[Zt]},e.prototype.getClass=function(){return e},i.serialVersionUID.get=function(){return-0x7a5aa1369171980},Object.defineProperties(e,i),e}(Vt),ne=function(t){this._factory=t||null,this._isUserDataCopied=!1},re={NoOpGeometryOperation:{configurable:!0},CoordinateOperation:{configurable:!0},CoordinateSequenceOperation:{configurable:!0}};ne.prototype.setCopyUserData=function(t){this._isUserDataCopied=t},ne.prototype.edit=function(t,e){if(null===t)return null;var i=this.editInternal(t,e);return this._isUserDataCopied&&i.setUserData(t.getUserData()),i},ne.prototype.editInternal=function(t,e){return null===this._factory&&(this._factory=t.getFactory()),t instanceof Vt?this.editGeometryCollection(t,e):t instanceof $t?this.editPolygon(t,e):t instanceof Jt||t instanceof Xt?e.edit(t,this._factory):(et.shouldNeverReachHere("Unsupported Geometry class: "+t.getClass().getName()),null)},ne.prototype.editGeometryCollection=function(t,e){for(var i=e.edit(t,this._factory),n=new Bt,r=0;r<i.getNumGeometries();r++){var o=this.edit(i.getGeometryN(r),e);null===o||o.isEmpty()||n.add(o)}return i.getClass()===te?this._factory.createMultiPoint(n.toArray([])):i.getClass()===jt?this._factory.createMultiLineString(n.toArray([])):i.getClass()===ie?this._factory.createMultiPolygon(n.toArray([])):this._factory.createGeometryCollection(n.toArray([]))},ne.prototype.editPolygon=function(t,e){var i=e.edit(t,this._factory);if(null===i&&(i=this._factory.createPolygon(null)),i.isEmpty())return i;var n=this.edit(i.getExteriorRing(),e);if(null===n||n.isEmpty())return this._factory.createPolygon();for(var r=new Bt,o=0;o<i.getNumInteriorRing();o++){var s=this.edit(i.getInteriorRingN(o),e);null===s||s.isEmpty()||r.add(s)}return this._factory.createPolygon(n,r.toArray([]))},ne.prototype.interfaces_=function(){return[]},ne.prototype.getClass=function(){return ne},ne.GeometryEditorOperation=function(){},re.NoOpGeometryOperation.get=function(){return oe},re.CoordinateOperation.get=function(){return se},re.CoordinateSequenceOperation.get=function(){return ae},Object.defineProperties(ne,re);var oe=function(){};oe.prototype.edit=function(t,e){return t},oe.prototype.interfaces_=function(){return[ne.GeometryEditorOperation]},oe.prototype.getClass=function(){return oe};var se=function(){};se.prototype.edit=function(t,e){var i=this.editCoordinates(t.getCoordinates(),t);return null===i?t:t instanceof ee?e.createLinearRing(i):t instanceof Xt?e.createLineString(i):t instanceof Jt?i.length>0?e.createPoint(i[0]):e.createPoint():t},se.prototype.interfaces_=function(){return[ne.GeometryEditorOperation]},se.prototype.getClass=function(){return se};var ae=function(){};ae.prototype.edit=function(t,e){return t instanceof ee?e.createLinearRing(this.edit(t.getCoordinateSequence(),t)):t instanceof Xt?e.createLineString(this.edit(t.getCoordinateSequence(),t)):t instanceof Jt?e.createPoint(this.edit(t.getCoordinateSequence(),t)):t},ae.prototype.interfaces_=function(){return[ne.GeometryEditorOperation]},ae.prototype.getClass=function(){return ae};var Ae=function(){if(this._dimension=3,this._coordinates=null,1===arguments.length){if(arguments[0]instanceof Array)this._coordinates=arguments[0],this._dimension=3;else if(Number.isInteger(arguments[0])){var t=arguments[0];this._coordinates=new Array(t).fill(null);for(var e=0;e<t;e++)this._coordinates[e]=new b}else if(O(arguments[0],H)){var i=arguments[0];if(null===i)return this._coordinates=new Array(0).fill(null),null;this._dimension=i.getDimension(),this._coordinates=new Array(i.size()).fill(null);for(var n=0;n<this._coordinates.length;n++)this._coordinates[n]=i.getCoordinateCopy(n)}}else if(2===arguments.length)if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var r=arguments[0],o=arguments[1];this._coordinates=r,this._dimension=o,null===r&&(this._coordinates=new Array(0).fill(null))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var s=arguments[0],a=arguments[1];this._coordinates=new Array(s).fill(null),this._dimension=a;for(var A=0;A<s;A++)this._coordinates[A]=new b}},le={serialVersionUID:{configurable:!0}};Ae.prototype.setOrdinate=function(t,e,i){switch(e){case H.X:this._coordinates[t].x=i;break;case H.Y:this._coordinates[t].y=i;break;case H.Z:this._coordinates[t].z=i;break;default:throw new y("invalid ordinateIndex")}},Ae.prototype.size=function(){return this._coordinates.length},Ae.prototype.getOrdinate=function(t,e){switch(e){case H.X:return this._coordinates[t].x;case H.Y:return this._coordinates[t].y;case H.Z:return this._coordinates[t].z}return v.NaN},Ae.prototype.getCoordinate=function(){if(1===arguments.length){var t=arguments[0];return this._coordinates[t]}if(2===arguments.length){var e=arguments[0],i=arguments[1];i.x=this._coordinates[e].x,i.y=this._coordinates[e].y,i.z=this._coordinates[e].z}},Ae.prototype.getCoordinateCopy=function(t){return new b(this._coordinates[t])},Ae.prototype.getDimension=function(){return this._dimension},Ae.prototype.getX=function(t){return this._coordinates[t].x},Ae.prototype.clone=function(){for(var t=new Array(this.size()).fill(null),e=0;e<this._coordinates.length;e++)t[e]=this._coordinates[e].clone();return new Ae(t,this._dimension)},Ae.prototype.expandEnvelope=function(t){for(var e=0;e<this._coordinates.length;e++)t.expandToInclude(this._coordinates[e]);return t},Ae.prototype.copy=function(){for(var t=new Array(this.size()).fill(null),e=0;e<this._coordinates.length;e++)t[e]=this._coordinates[e].copy();return new Ae(t,this._dimension)},Ae.prototype.toString=function(){if(this._coordinates.length>0){var t=new L(17*this._coordinates.length);t.append("("),t.append(this._coordinates[0]);for(var e=1;e<this._coordinates.length;e++)t.append(", "),t.append(this._coordinates[e]);return t.append(")"),t.toString()}return"()"},Ae.prototype.getY=function(t){return this._coordinates[t].y},Ae.prototype.toCoordinateArray=function(){return this._coordinates},Ae.prototype.interfaces_=function(){return[H,e]},Ae.prototype.getClass=function(){return Ae},le.serialVersionUID.get=function(){return-0xcb44a778db18e00},Object.defineProperties(Ae,le);var ce=function(){},ue={serialVersionUID:{configurable:!0},instanceObject:{configurable:!0}};ce.prototype.readResolve=function(){return ce.instance()},ce.prototype.create=function(){if(1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];return new Ae(t)}if(O(arguments[0],H)){var e=arguments[0];return new Ae(e)}}else if(2===arguments.length){var i=arguments[0],n=arguments[1];return n>3&&(n=3),n<2?new Ae(i):new Ae(i,n)}},ce.prototype.interfaces_=function(){return[x,e]},ce.prototype.getClass=function(){return ce},ce.instance=function(){return ce.instanceObject},ue.serialVersionUID.get=function(){return-0x38e49fa6cf6f2e00},ue.instanceObject.get=function(){return new ce},Object.defineProperties(ce,ue);var he=function(t){function e(){t.call(this),this.map_=new Map}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t){return this.map_.get(t)||null},e.prototype.put=function(t,e){return this.map_.set(t,e),e},e.prototype.values=function(){for(var t=new Bt,e=this.map_.values(),i=e.next();!i.done;)t.add(i.value),i=e.next();return t},e.prototype.entrySet=function(){var t=new Tt;return this.map_.entries().forEach((function(e){return t.add(e)})),t},e.prototype.size=function(){return this.map_.size()},e}(Ot),pe=function t(){if(this._modelType=null,this._scale=null,0===arguments.length)this._modelType=t.FLOATING;else if(1===arguments.length)if(arguments[0]instanceof fe){var e=arguments[0];this._modelType=e,e===t.FIXED&&this.setScale(1)}else if("number"==typeof arguments[0]){var i=arguments[0];this._modelType=t.FIXED,this.setScale(i)}else if(arguments[0]instanceof t){var n=arguments[0];this._modelType=n._modelType,this._scale=n._scale}},de={serialVersionUID:{configurable:!0},maximumPreciseValue:{configurable:!0}};pe.prototype.equals=function(t){if(!(t instanceof pe))return!1;var e=t;return this._modelType===e._modelType&&this._scale===e._scale},pe.prototype.compareTo=function(t){var e=t,i=this.getMaximumSignificantDigits(),n=e.getMaximumSignificantDigits();return new M(i).compareTo(new M(n))},pe.prototype.getScale=function(){return this._scale},pe.prototype.isFloating=function(){return this._modelType===pe.FLOATING||this._modelType===pe.FLOATING_SINGLE},pe.prototype.getType=function(){return this._modelType},pe.prototype.toString=function(){var t="UNKNOWN";return this._modelType===pe.FLOATING?t="Floating":this._modelType===pe.FLOATING_SINGLE?t="Floating-Single":this._modelType===pe.FIXED&&(t="Fixed (Scale="+this.getScale()+")"),t},pe.prototype.makePrecise=function(){if("number"==typeof arguments[0]){var t=arguments[0];return v.isNaN(t)||this._modelType===pe.FLOATING_SINGLE?t:this._modelType===pe.FIXED?Math.round(t*this._scale)/this._scale:t}if(arguments[0]instanceof b){var e=arguments[0];if(this._modelType===pe.FLOATING)return null;e.x=this.makePrecise(e.x),e.y=this.makePrecise(e.y)}},pe.prototype.getMaximumSignificantDigits=function(){var t=16;return this._modelType===pe.FLOATING?t=16:this._modelType===pe.FLOATING_SINGLE?t=6:this._modelType===pe.FIXED&&(t=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),t},pe.prototype.setScale=function(t){this._scale=Math.abs(t)},pe.prototype.interfaces_=function(){return[e,w]},pe.prototype.getClass=function(){return pe},pe.mostPrecise=function(t,e){return t.compareTo(e)>=0?t:e},de.serialVersionUID.get=function(){return 0x6bee6404e9a25c00},de.maximumPreciseValue.get=function(){return 9007199254740992},Object.defineProperties(pe,de);var fe=function t(e){this._name=e||null,t.nameToTypeMap.put(e,this)},ge={serialVersionUID:{configurable:!0},nameToTypeMap:{configurable:!0}};fe.prototype.readResolve=function(){return fe.nameToTypeMap.get(this._name)},fe.prototype.toString=function(){return this._name},fe.prototype.interfaces_=function(){return[e]},fe.prototype.getClass=function(){return fe},ge.serialVersionUID.get=function(){return-552860263173159e4},ge.nameToTypeMap.get=function(){return new he},Object.defineProperties(fe,ge),pe.Type=fe,pe.FIXED=new fe("FIXED"),pe.FLOATING=new fe("FLOATING"),pe.FLOATING_SINGLE=new fe("FLOATING SINGLE");var me=function t(){this._precisionModel=new pe,this._SRID=0,this._coordinateSequenceFactory=t.getDefaultCoordinateSequenceFactory(),0===arguments.length||(1===arguments.length?O(arguments[0],x)?this._coordinateSequenceFactory=arguments[0]:arguments[0]instanceof pe&&(this._precisionModel=arguments[0]):2===arguments.length?(this._precisionModel=arguments[0],this._SRID=arguments[1]):3===arguments.length&&(this._precisionModel=arguments[0],this._SRID=arguments[1],this._coordinateSequenceFactory=arguments[2]))},ye={serialVersionUID:{configurable:!0}};me.prototype.toGeometry=function(t){return t.isNull()?this.createPoint(null):t.getMinX()===t.getMaxX()&&t.getMinY()===t.getMaxY()?this.createPoint(new b(t.getMinX(),t.getMinY())):t.getMinX()===t.getMaxX()||t.getMinY()===t.getMaxY()?this.createLineString([new b(t.getMinX(),t.getMinY()),new b(t.getMaxX(),t.getMaxY())]):this.createPolygon(this.createLinearRing([new b(t.getMinX(),t.getMinY()),new b(t.getMinX(),t.getMaxY()),new b(t.getMaxX(),t.getMaxY()),new b(t.getMaxX(),t.getMinY()),new b(t.getMinX(),t.getMinY())]),null)},me.prototype.createLineString=function(t){return t?t instanceof Array?new Xt(this.getCoordinateSequenceFactory().create(t),this):O(t,H)?new Xt(t,this):void 0:new Xt(this.getCoordinateSequenceFactory().create([]),this)},me.prototype.createMultiLineString=function(){if(0===arguments.length)return new jt(null,this);if(1===arguments.length){var t=arguments[0];return new jt(t,this)}},me.prototype.buildGeometry=function(t){for(var e=null,i=!1,n=!1,r=t.iterator();r.hasNext();){var o=r.next(),s=o.getClass();null===e&&(e=s),s!==e&&(i=!0),o.isGeometryCollectionOrDerived()&&(n=!0)}if(null===e)return this.createGeometryCollection();if(i||n)return this.createGeometryCollection(me.toGeometryArray(t));var a=t.iterator().next();if(t.size()>1){if(a instanceof $t)return this.createMultiPolygon(me.toPolygonArray(t));if(a instanceof Xt)return this.createMultiLineString(me.toLineStringArray(t));if(a instanceof Jt)return this.createMultiPoint(me.toPointArray(t));et.shouldNeverReachHere("Unhandled class: "+a.getClass().getName())}return a},me.prototype.createMultiPointFromCoords=function(t){return this.createMultiPoint(null!==t?this.getCoordinateSequenceFactory().create(t):null)},me.prototype.createPoint=function(){if(0===arguments.length)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof b){var t=arguments[0];return this.createPoint(null!==t?this.getCoordinateSequenceFactory().create([t]):null)}if(O(arguments[0],H)){var e=arguments[0];return new Jt(e,this)}}},me.prototype.getCoordinateSequenceFactory=function(){return this._coordinateSequenceFactory},me.prototype.createPolygon=function(){if(0===arguments.length)return new $t(null,null,this);if(1===arguments.length){if(O(arguments[0],H)){var t=arguments[0];return this.createPolygon(this.createLinearRing(t))}if(arguments[0]instanceof Array){var e=arguments[0];return this.createPolygon(this.createLinearRing(e))}if(arguments[0]instanceof ee){var i=arguments[0];return this.createPolygon(i,null)}}else if(2===arguments.length){var n=arguments[0],r=arguments[1];return new $t(n,r,this)}},me.prototype.getSRID=function(){return this._SRID},me.prototype.createGeometryCollection=function(){if(0===arguments.length)return new Vt(null,this);if(1===arguments.length){var t=arguments[0];return new Vt(t,this)}},me.prototype.createGeometry=function(t){return new ne(this).edit(t,{edit:function(){if(2===arguments.length){var t=arguments[0];return this._coordinateSequenceFactory.create(t)}}})},me.prototype.getPrecisionModel=function(){return this._precisionModel},me.prototype.createLinearRing=function(){if(0===arguments.length)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];return this.createLinearRing(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if(O(arguments[0],H)){var e=arguments[0];return new ee(e,this)}}},me.prototype.createMultiPolygon=function(){if(0===arguments.length)return new ie(null,this);if(1===arguments.length){var t=arguments[0];return new ie(t,this)}},me.prototype.createMultiPoint=function(){if(0===arguments.length)return new te(null,this);if(1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];return new te(t,this)}if(arguments[0]instanceof Array){var e=arguments[0];return this.createMultiPoint(null!==e?this.getCoordinateSequenceFactory().create(e):null)}if(O(arguments[0],H)){var i=arguments[0];if(null===i)return this.createMultiPoint(new Array(0).fill(null));for(var n=new Array(i.size()).fill(null),r=0;r<i.size();r++){var o=this.getCoordinateSequenceFactory().create(1,i.getDimension());qt.copy(i,r,o,0,1),n[r]=this.createPoint(o)}return this.createMultiPoint(n)}}},me.prototype.interfaces_=function(){return[e]},me.prototype.getClass=function(){return me},me.toMultiPolygonArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},me.toGeometryArray=function(t){if(null===t)return null;var e=new Array(t.size()).fill(null);return t.toArray(e)},me.getDefaultCoordinateSequenceFactory=function(){return ce.instance()},me.toMultiLineStringArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},me.toLineStringArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},me.toMultiPointArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},me.toLinearRingArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},me.toPointArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},me.toPolygonArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},me.createPointFromInternalCoord=function(t,e){return e.getPrecisionModel().makePrecise(t),e.getFactory().createPoint(t)},ye.serialVersionUID.get=function(){return-0x5ea75f2051eeb400},Object.defineProperties(me,ye);var ve=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],_e=function(t){this.geometryFactory=t||new me};_e.prototype.read=function(t){var e,i=(e="string"==typeof t?JSON.parse(t):t).type;if(!we[i])throw new Error("Unknown GeoJSON type: "+e.type);return-1!==ve.indexOf(i)?we[i].apply(this,[e.coordinates]):"GeometryCollection"===i?we[i].apply(this,[e.geometries]):we[i].apply(this,[e])},_e.prototype.write=function(t){var e=t.getGeometryType();if(!Ce[e])throw new Error("Geometry is not supported");return Ce[e].apply(this,[t])};var we={Feature:function(t){var e={};for(var i in t)e[i]=t[i];if(t.geometry){var n=t.geometry.type;if(!we[n])throw new Error("Unknown GeoJSON type: "+t.type);e.geometry=this.read(t.geometry)}return t.bbox&&(e.bbox=we.bbox.apply(this,[t.bbox])),e},FeatureCollection:function(t){var e={};if(t.features){e.features=[];for(var i=0;i<t.features.length;++i)e.features.push(this.read(t.features[i]))}return t.bbox&&(e.bbox=this.parse.bbox.apply(this,[t.bbox])),e},coordinates:function(t){for(var e=[],i=0;i<t.length;++i){var n=t[i];e.push(new b(n[0],n[1]))}return e},bbox:function(t){return this.geometryFactory.createLinearRing([new b(t[0],t[1]),new b(t[2],t[1]),new b(t[2],t[3]),new b(t[0],t[3]),new b(t[0],t[1])])},Point:function(t){var e=new b(t[0],t[1]);return this.geometryFactory.createPoint(e)},MultiPoint:function(t){for(var e=[],i=0;i<t.length;++i)e.push(we.Point.apply(this,[t[i]]));return this.geometryFactory.createMultiPoint(e)},LineString:function(t){var e=we.coordinates.apply(this,[t]);return this.geometryFactory.createLineString(e)},MultiLineString:function(t){for(var e=[],i=0;i<t.length;++i)e.push(we.LineString.apply(this,[t[i]]));return this.geometryFactory.createMultiLineString(e)},Polygon:function(t){for(var e=we.coordinates.apply(this,[t[0]]),i=this.geometryFactory.createLinearRing(e),n=[],r=1;r<t.length;++r){var o=t[r],s=we.coordinates.apply(this,[o]),a=this.geometryFactory.createLinearRing(s);n.push(a)}return this.geometryFactory.createPolygon(i,n)},MultiPolygon:function(t){for(var e=[],i=0;i<t.length;++i){var n=t[i];e.push(we.Polygon.apply(this,[n]))}return this.geometryFactory.createMultiPolygon(e)},GeometryCollection:function(t){for(var e=[],i=0;i<t.length;++i){var n=t[i];e.push(this.read(n))}return this.geometryFactory.createGeometryCollection(e)}},Ce={coordinate:function(t){return[t.x,t.y]},Point:function(t){return{type:"Point",coordinates:Ce.coordinate.apply(this,[t.getCoordinate()])}},MultiPoint:function(t){for(var e=[],i=0;i<t._geometries.length;++i){var n=t._geometries[i],r=Ce.Point.apply(this,[n]);e.push(r.coordinates)}return{type:"MultiPoint",coordinates:e}},LineString:function(t){for(var e=[],i=t.getCoordinates(),n=0;n<i.length;++n){var r=i[n];e.push(Ce.coordinate.apply(this,[r]))}return{type:"LineString",coordinates:e}},MultiLineString:function(t){for(var e=[],i=0;i<t._geometries.length;++i){var n=t._geometries[i],r=Ce.LineString.apply(this,[n]);e.push(r.coordinates)}return{type:"MultiLineString",coordinates:e}},Polygon:function(t){var e=[],i=Ce.LineString.apply(this,[t._shell]);e.push(i.coordinates);for(var n=0;n<t._holes.length;++n){var r=t._holes[n],o=Ce.LineString.apply(this,[r]);e.push(o.coordinates)}return{type:"Polygon",coordinates:e}},MultiPolygon:function(t){for(var e=[],i=0;i<t._geometries.length;++i){var n=t._geometries[i],r=Ce.Polygon.apply(this,[n]);e.push(r.coordinates)}return{type:"MultiPolygon",coordinates:e}},GeometryCollection:function(t){for(var e=[],i=0;i<t._geometries.length;++i){var n=t._geometries[i],r=n.getGeometryType();e.push(Ce[r].apply(this,[n]))}return{type:"GeometryCollection",geometries:e}}},Be=function(t){this.geometryFactory=t||new me,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new _e(this.geometryFactory)};Be.prototype.read=function(t){var e=this.parser.read(t);return this.precisionModel.getType()===pe.FIXED&&this.reducePrecision(e),e},Be.prototype.reducePrecision=function(t){var e,i;if(t.coordinate)this.precisionModel.makePrecise(t.coordinate);else if(t.points)for(e=0,i=t.points.length;e<i;e++)this.precisionModel.makePrecise(t.points[e]);else if(t.geometries)for(e=0,i=t.geometries.length;e<i;e++)this.reducePrecision(t.geometries[e])};var be=function(){this.parser=new _e(this.geometryFactory)};be.prototype.write=function(t){return this.parser.write(t)};var Ee=function(){},Se={ON:{configurable:!0},LEFT:{configurable:!0},RIGHT:{configurable:!0}};Ee.prototype.interfaces_=function(){return[]},Ee.prototype.getClass=function(){return Ee},Ee.opposite=function(t){return t===Ee.LEFT?Ee.RIGHT:t===Ee.RIGHT?Ee.LEFT:t},Se.ON.get=function(){return 0},Se.LEFT.get=function(){return 1},Se.RIGHT.get=function(){return 2},Object.defineProperties(Ee,Se),(f.prototype=new Error).name="EmptyStackException",(g.prototype=new Ct).add=function(t){return this.array_.push(t),!0},g.prototype.get=function(t){if(t<0||t>=this.size())throw new Error;return this.array_[t]},g.prototype.push=function(t){return this.array_.push(t),t},g.prototype.pop=function(t){if(0===this.array_.length)throw new f;return this.array_.pop()},g.prototype.peek=function(){if(0===this.array_.length)throw new f;return this.array_[this.array_.length-1]},g.prototype.empty=function(){return 0===this.array_.length},g.prototype.isEmpty=function(){return this.empty()},g.prototype.search=function(t){return this.array_.indexOf(t)},g.prototype.size=function(){return this.array_.length},g.prototype.toArray=function(){for(var t=[],e=0,i=this.array_.length;e<i;e++)t.push(this.array_[e]);return t};var xe=function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null};xe.prototype.getCoordinate=function(){return this._minCoord},xe.prototype.getRightmostSide=function(t,e){var i=this.getRightmostSideOfSegment(t,e);return i<0&&(i=this.getRightmostSideOfSegment(t,e-1)),i<0&&(this._minCoord=null,this.checkForRightmostCoordinate(t)),i},xe.prototype.findRightmostEdgeAtVertex=function(){var t=this._minDe.getEdge().getCoordinates();et.isTrue(this._minIndex>0&&this._minIndex<t.length,"rightmost point expected to be interior vertex of edge");var e=t[this._minIndex-1],i=t[this._minIndex+1],n=at.computeOrientation(this._minCoord,i,e),r=!1;(e.y<this._minCoord.y&&i.y<this._minCoord.y&&n===at.COUNTERCLOCKWISE||e.y>this._minCoord.y&&i.y>this._minCoord.y&&n===at.CLOCKWISE)&&(r=!0),r&&(this._minIndex=this._minIndex-1)},xe.prototype.getRightmostSideOfSegment=function(t,e){var i=t.getEdge().getCoordinates();if(e<0||e+1>=i.length)return-1;if(i[e].y===i[e+1].y)return-1;var n=Ee.LEFT;return i[e].y<i[e+1].y&&(n=Ee.RIGHT),n},xe.prototype.getEdge=function(){return this._orientedDe},xe.prototype.checkForRightmostCoordinate=function(t){for(var e=t.getEdge().getCoordinates(),i=0;i<e.length-1;i++)(null===this._minCoord||e[i].x>this._minCoord.x)&&(this._minDe=t,this._minIndex=i,this._minCoord=e[i])},xe.prototype.findRightmostEdgeAtNode=function(){var t=this._minDe.getNode().getEdges();this._minDe=t.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)},xe.prototype.findEdge=function(t){for(var e=t.iterator();e.hasNext();){var i=e.next();i.isForward()&&this.checkForRightmostCoordinate(i)}et.isTrue(0!==this._minIndex||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),0===this._minIndex?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe,this.getRightmostSide(this._minDe,this._minIndex)===Ee.LEFT&&(this._orientedDe=this._minDe.getSym())},xe.prototype.interfaces_=function(){return[]},xe.prototype.getClass=function(){return xe};var Ie=function(t){function e(i,n){t.call(this,e.msgWithCoord(i,n)),this.pt=n?new b(n):null,this.name="TopologyException"}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getCoordinate=function(){return this.pt},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.msgWithCoord=function(t,e){return e?t:t+" [ "+e+" ]"},e}($),Fe=function(){this.array_=[]};Fe.prototype.addLast=function(t){this.array_.push(t)},Fe.prototype.removeFirst=function(){return this.array_.shift()},Fe.prototype.isEmpty=function(){return 0===this.array_.length};var Oe=function(){this._finder=null,this._dirEdgeList=new Bt,this._nodes=new Bt,this._rightMostCoord=null,this._env=null,this._finder=new xe};Oe.prototype.clearVisitedEdges=function(){for(var t=this._dirEdgeList.iterator();t.hasNext();)t.next().setVisited(!1)},Oe.prototype.getRightmostCoordinate=function(){return this._rightMostCoord},Oe.prototype.computeNodeDepth=function(t){for(var e=null,i=t.getEdges().iterator();i.hasNext();){var n=i.next();if(n.isVisited()||n.getSym().isVisited()){e=n;break}}if(null===e)throw new Ie("unable to find edge to compute depths at "+t.getCoordinate());t.getEdges().computeDepths(e);for(var r=t.getEdges().iterator();r.hasNext();){var o=r.next();o.setVisited(!0),this.copySymDepths(o)}},Oe.prototype.computeDepth=function(t){this.clearVisitedEdges();var e=this._finder.getEdge();e.setEdgeDepths(Ee.RIGHT,t),this.copySymDepths(e),this.computeDepths(e)},Oe.prototype.create=function(t){this.addReachable(t),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()},Oe.prototype.findResultEdges=function(){for(var t=this._dirEdgeList.iterator();t.hasNext();){var e=t.next();e.getDepth(Ee.RIGHT)>=1&&e.getDepth(Ee.LEFT)<=0&&!e.isInteriorAreaEdge()&&e.setInResult(!0)}},Oe.prototype.computeDepths=function(t){var e=new Tt,i=new Fe,n=t.getNode();for(i.addLast(n),e.add(n),t.setVisited(!0);!i.isEmpty();){var r=i.removeFirst();e.add(r),this.computeNodeDepth(r);for(var o=r.getEdges().iterator();o.hasNext();){var s=o.next().getSym();if(!s.isVisited()){var a=s.getNode();e.contains(a)||(i.addLast(a),e.add(a))}}}},Oe.prototype.compareTo=function(t){var e=t;return this._rightMostCoord.x<e._rightMostCoord.x?-1:this._rightMostCoord.x>e._rightMostCoord.x?1:0},Oe.prototype.getEnvelope=function(){if(null===this._env){for(var t=new z,e=this._dirEdgeList.iterator();e.hasNext();)for(var i=e.next().getEdge().getCoordinates(),n=0;n<i.length-1;n++)t.expandToInclude(i[n]);this._env=t}return this._env},Oe.prototype.addReachable=function(t){var e=new g;for(e.add(t);!e.empty();){var i=e.pop();this.add(i,e)}},Oe.prototype.copySymDepths=function(t){var e=t.getSym();e.setDepth(Ee.LEFT,t.getDepth(Ee.RIGHT)),e.setDepth(Ee.RIGHT,t.getDepth(Ee.LEFT))},Oe.prototype.add=function(t,e){t.setVisited(!0),this._nodes.add(t);for(var i=t.getEdges().iterator();i.hasNext();){var n=i.next();this._dirEdgeList.add(n);var r=n.getSym().getNode();r.isVisited()||e.push(r)}},Oe.prototype.getNodes=function(){return this._nodes},Oe.prototype.getDirectedEdges=function(){return this._dirEdgeList},Oe.prototype.interfaces_=function(){return[w]},Oe.prototype.getClass=function(){return Oe};var Pe=function t(){if(this.location=null,1===arguments.length){if(arguments[0]instanceof Array){var e=arguments[0];this.init(e.length)}else if(Number.isInteger(arguments[0])){var i=arguments[0];this.init(1),this.location[Ee.ON]=i}else if(arguments[0]instanceof t){var n=arguments[0];if(this.init(n.location.length),null!==n)for(var r=0;r<this.location.length;r++)this.location[r]=n.location[r]}}else if(3===arguments.length){var o=arguments[0],s=arguments[1],a=arguments[2];this.init(3),this.location[Ee.ON]=o,this.location[Ee.LEFT]=s,this.location[Ee.RIGHT]=a}};Pe.prototype.setAllLocations=function(t){for(var e=0;e<this.location.length;e++)this.location[e]=t},Pe.prototype.isNull=function(){for(var t=0;t<this.location.length;t++)if(this.location[t]!==I.NONE)return!1;return!0},Pe.prototype.setAllLocationsIfNull=function(t){for(var e=0;e<this.location.length;e++)this.location[e]===I.NONE&&(this.location[e]=t)},Pe.prototype.isLine=function(){return 1===this.location.length},Pe.prototype.merge=function(t){if(t.location.length>this.location.length){var e=new Array(3).fill(null);e[Ee.ON]=this.location[Ee.ON],e[Ee.LEFT]=I.NONE,e[Ee.RIGHT]=I.NONE,this.location=e}for(var i=0;i<this.location.length;i++)this.location[i]===I.NONE&&i<t.location.length&&(this.location[i]=t.location[i])},Pe.prototype.getLocations=function(){return this.location},Pe.prototype.flip=function(){if(this.location.length<=1)return null;var t=this.location[Ee.LEFT];this.location[Ee.LEFT]=this.location[Ee.RIGHT],this.location[Ee.RIGHT]=t},Pe.prototype.toString=function(){var t=new L;return this.location.length>1&&t.append(I.toLocationSymbol(this.location[Ee.LEFT])),t.append(I.toLocationSymbol(this.location[Ee.ON])),this.location.length>1&&t.append(I.toLocationSymbol(this.location[Ee.RIGHT])),t.toString()},Pe.prototype.setLocations=function(t,e,i){this.location[Ee.ON]=t,this.location[Ee.LEFT]=e,this.location[Ee.RIGHT]=i},Pe.prototype.get=function(t){return t<this.location.length?this.location[t]:I.NONE},Pe.prototype.isArea=function(){return this.location.length>1},Pe.prototype.isAnyNull=function(){for(var t=0;t<this.location.length;t++)if(this.location[t]===I.NONE)return!0;return!1},Pe.prototype.setLocation=function(){if(1===arguments.length){var t=arguments[0];this.setLocation(Ee.ON,t)}else if(2===arguments.length){var e=arguments[0],i=arguments[1];this.location[e]=i}},Pe.prototype.init=function(t){this.location=new Array(t).fill(null),this.setAllLocations(I.NONE)},Pe.prototype.isEqualOnSide=function(t,e){return this.location[e]===t.location[e]},Pe.prototype.allPositionsEqual=function(t){for(var e=0;e<this.location.length;e++)if(this.location[e]!==t)return!1;return!0},Pe.prototype.interfaces_=function(){return[]},Pe.prototype.getClass=function(){return Pe};var Te=function t(){if(this.elt=new Array(2).fill(null),1===arguments.length){if(Number.isInteger(arguments[0])){var e=arguments[0];this.elt[0]=new Pe(e),this.elt[1]=new Pe(e)}else if(arguments[0]instanceof t){var i=arguments[0];this.elt[0]=new Pe(i.elt[0]),this.elt[1]=new Pe(i.elt[1])}}else if(2===arguments.length){var n=arguments[0],r=arguments[1];this.elt[0]=new Pe(I.NONE),this.elt[1]=new Pe(I.NONE),this.elt[n].setLocation(r)}else if(3===arguments.length){var o=arguments[0],s=arguments[1],a=arguments[2];this.elt[0]=new Pe(o,s,a),this.elt[1]=new Pe(o,s,a)}else if(4===arguments.length){var A=arguments[0],l=arguments[1],c=arguments[2],u=arguments[3];this.elt[0]=new Pe(I.NONE,I.NONE,I.NONE),this.elt[1]=new Pe(I.NONE,I.NONE,I.NONE),this.elt[A].setLocations(l,c,u)}};Te.prototype.getGeometryCount=function(){var t=0;return this.elt[0].isNull()||t++,this.elt[1].isNull()||t++,t},Te.prototype.setAllLocations=function(t,e){this.elt[t].setAllLocations(e)},Te.prototype.isNull=function(t){return this.elt[t].isNull()},Te.prototype.setAllLocationsIfNull=function(){if(1===arguments.length){var t=arguments[0];this.setAllLocationsIfNull(0,t),this.setAllLocationsIfNull(1,t)}else if(2===arguments.length){var e=arguments[0],i=arguments[1];this.elt[e].setAllLocationsIfNull(i)}},Te.prototype.isLine=function(t){return this.elt[t].isLine()},Te.prototype.merge=function(t){for(var e=0;e<2;e++)null===this.elt[e]&&null!==t.elt[e]?this.elt[e]=new Pe(t.elt[e]):this.elt[e].merge(t.elt[e])},Te.prototype.flip=function(){this.elt[0].flip(),this.elt[1].flip()},Te.prototype.getLocation=function(){if(1===arguments.length){var t=arguments[0];return this.elt[t].get(Ee.ON)}if(2===arguments.length){var e=arguments[0],i=arguments[1];return this.elt[e].get(i)}},Te.prototype.toString=function(){var t=new L;return null!==this.elt[0]&&(t.append("A:"),t.append(this.elt[0].toString())),null!==this.elt[1]&&(t.append(" B:"),t.append(this.elt[1].toString())),t.toString()},Te.prototype.isArea=function(){if(0===arguments.length)return this.elt[0].isArea()||this.elt[1].isArea();if(1===arguments.length){var t=arguments[0];return this.elt[t].isArea()}},Te.prototype.isAnyNull=function(t){return this.elt[t].isAnyNull()},Te.prototype.setLocation=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];this.elt[t].setLocation(Ee.ON,e)}else if(3===arguments.length){var i=arguments[0],n=arguments[1],r=arguments[2];this.elt[i].setLocation(n,r)}},Te.prototype.isEqualOnSide=function(t,e){return this.elt[0].isEqualOnSide(t.elt[0],e)&&this.elt[1].isEqualOnSide(t.elt[1],e)},Te.prototype.allPositionsEqual=function(t,e){return this.elt[t].allPositionsEqual(e)},Te.prototype.toLine=function(t){this.elt[t].isArea()&&(this.elt[t]=new Pe(this.elt[t].location[0]))},Te.prototype.interfaces_=function(){return[]},Te.prototype.getClass=function(){return Te},Te.toLineLabel=function(t){for(var e=new Te(I.NONE),i=0;i<2;i++)e.setLocation(i,t.getLocation(i));return e};var Le=function(){this._startDe=null,this._maxNodeDegree=-1,this._edges=new Bt,this._pts=new Bt,this._label=new Te(I.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new Bt,this._geometryFactory=null;var t=arguments[0],e=arguments[1];this._geometryFactory=e,this.computePoints(t),this.computeRing()};Le.prototype.computeRing=function(){if(null!==this._ring)return null;for(var t=new Array(this._pts.size()).fill(null),e=0;e<this._pts.size();e++)t[e]=this._pts.get(e);this._ring=this._geometryFactory.createLinearRing(t),this._isHole=at.isCCW(this._ring.getCoordinates())},Le.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()},Le.prototype.computePoints=function(t){this._startDe=t;var e=t,i=!0;do{if(null===e)throw new Ie("Found null DirectedEdge");if(e.getEdgeRing()===this)throw new Ie("Directed Edge visited twice during ring-building at "+e.getCoordinate());this._edges.add(e);var n=e.getLabel();et.isTrue(n.isArea()),this.mergeLabel(n),this.addPoints(e.getEdge(),e.isForward(),i),i=!1,this.setEdgeRing(e,this),e=this.getNext(e)}while(e!==this._startDe)},Le.prototype.getLinearRing=function(){return this._ring},Le.prototype.getCoordinate=function(t){return this._pts.get(t)},Le.prototype.computeMaxNodeDegree=function(){this._maxNodeDegree=0;var t=this._startDe;do{var e=t.getNode().getEdges().getOutgoingDegree(this);e>this._maxNodeDegree&&(this._maxNodeDegree=e),t=this.getNext(t)}while(t!==this._startDe);this._maxNodeDegree*=2},Le.prototype.addPoints=function(t,e,i){var n=t.getCoordinates();if(e){var r=1;i&&(r=0);for(var o=r;o<n.length;o++)this._pts.add(n[o])}else{var s=n.length-2;i&&(s=n.length-1);for(var a=s;a>=0;a--)this._pts.add(n[a])}},Le.prototype.isHole=function(){return this._isHole},Le.prototype.setInResult=function(){var t=this._startDe;do{t.getEdge().setInResult(!0),t=t.getNext()}while(t!==this._startDe)},Le.prototype.containsPoint=function(t){var e=this.getLinearRing();if(!e.getEnvelopeInternal().contains(t))return!1;if(!at.isPointInRing(t,e.getCoordinates()))return!1;for(var i=this._holes.iterator();i.hasNext();)if(i.next().containsPoint(t))return!1;return!0},Le.prototype.addHole=function(t){this._holes.add(t)},Le.prototype.isShell=function(){return null===this._shell},Le.prototype.getLabel=function(){return this._label},Le.prototype.getEdges=function(){return this._edges},Le.prototype.getMaxNodeDegree=function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree},Le.prototype.getShell=function(){return this._shell},Le.prototype.mergeLabel=function(){if(1===arguments.length){var t=arguments[0];this.mergeLabel(t,0),this.mergeLabel(t,1)}else if(2===arguments.length){var e=arguments[0],i=arguments[1],n=e.getLocation(i,Ee.RIGHT);if(n===I.NONE)return null;if(this._label.getLocation(i)===I.NONE)return this._label.setLocation(i,n),null}},Le.prototype.setShell=function(t){this._shell=t,null!==t&&t.addHole(this)},Le.prototype.toPolygon=function(t){for(var e=new Array(this._holes.size()).fill(null),i=0;i<this._holes.size();i++)e[i]=this._holes.get(i).getLinearRing();return t.createPolygon(this.getLinearRing(),e)},Le.prototype.interfaces_=function(){return[]},Le.prototype.getClass=function(){return Le};var Me=function(t){function e(){var e=arguments[0],i=arguments[1];t.call(this,e,i)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setEdgeRing=function(t,e){t.setMinEdgeRing(e)},e.prototype.getNext=function(t){return t.getNextMin()},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Le),Ue=function(t){function e(){var e=arguments[0],i=arguments[1];t.call(this,e,i)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.buildMinimalRings=function(){var t=new Bt,e=this._startDe;do{if(null===e.getMinEdgeRing()){var i=new Me(e,this._geometryFactory);t.add(i)}e=e.getNext()}while(e!==this._startDe);return t},e.prototype.setEdgeRing=function(t,e){t.setEdgeRing(e)},e.prototype.linkDirectedEdgesForMinimalEdgeRings=function(){var t=this._startDe;do{t.getNode().getEdges().linkMinimalDirectedEdges(this),t=t.getNext()}while(t!==this._startDe)},e.prototype.getNext=function(t){return t.getNext()},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Le),De=function(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this._label=t}};De.prototype.setVisited=function(t){this._isVisited=t},De.prototype.setInResult=function(t){this._isInResult=t},De.prototype.isCovered=function(){return this._isCovered},De.prototype.isCoveredSet=function(){return this._isCoveredSet},De.prototype.setLabel=function(t){this._label=t},De.prototype.getLabel=function(){return this._label},De.prototype.setCovered=function(t){this._isCovered=t,this._isCoveredSet=!0},De.prototype.updateIM=function(t){et.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(t)},De.prototype.isInResult=function(){return this._isInResult},De.prototype.isVisited=function(){return this._isVisited},De.prototype.interfaces_=function(){return[]},De.prototype.getClass=function(){return De};var Qe=function(t){function e(){t.call(this),this._coord=null,this._edges=null;var e=arguments[0],i=arguments[1];this._coord=e,this._edges=i,this._label=new Te(0,I.NONE)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isIncidentEdgeInResult=function(){for(var t=this.getEdges().getEdges().iterator();t.hasNext();)if(t.next().getEdge().isInResult())return!0;return!1},e.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()},e.prototype.getCoordinate=function(){return this._coord},e.prototype.print=function(t){t.println("node "+this._coord+" lbl: "+this._label)},e.prototype.computeIM=function(t){},e.prototype.computeMergedLocation=function(t,e){var i=I.NONE;if(i=this._label.getLocation(e),!t.isNull(e)){var n=t.getLocation(e);i!==I.BOUNDARY&&(i=n)}return i},e.prototype.setLabel=function(){if(2!==arguments.length)return t.prototype.setLabel.apply(this,arguments);var e=arguments[0],i=arguments[1];null===this._label?this._label=new Te(e,i):this._label.setLocation(e,i)},e.prototype.getEdges=function(){return this._edges},e.prototype.mergeLabel=function(){if(arguments[0]instanceof e){var t=arguments[0];this.mergeLabel(t._label)}else if(arguments[0]instanceof Te)for(var i=arguments[0],n=0;n<2;n++){var r=this.computeMergedLocation(i,n);this._label.getLocation(n)===I.NONE&&this._label.setLocation(n,r)}},e.prototype.add=function(t){this._edges.insert(t),t.setNode(this)},e.prototype.setLabelBoundary=function(t){if(null===this._label)return null;var e=I.NONE;null!==this._label&&(e=this._label.getLocation(t));var i=null;switch(e){case I.BOUNDARY:i=I.INTERIOR;break;case I.INTERIOR:default:i=I.BOUNDARY}this._label.setLocation(t,i)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(De),Re=function(){this.nodeMap=new u,this.nodeFact=null;var t=arguments[0];this.nodeFact=t};Re.prototype.find=function(t){return this.nodeMap.get(t)},Re.prototype.addNode=function(){if(arguments[0]instanceof b){var t=arguments[0],e=this.nodeMap.get(t);return null===e&&(e=this.nodeFact.createNode(t),this.nodeMap.put(t,e)),e}if(arguments[0]instanceof Qe){var i=arguments[0],n=this.nodeMap.get(i.getCoordinate());return null===n?(this.nodeMap.put(i.getCoordinate(),i),i):(n.mergeLabel(i),n)}},Re.prototype.print=function(t){for(var e=this.iterator();e.hasNext();)e.next().print(t)},Re.prototype.iterator=function(){return this.nodeMap.values().iterator()},Re.prototype.values=function(){return this.nodeMap.values()},Re.prototype.getBoundaryNodes=function(t){for(var e=new Bt,i=this.iterator();i.hasNext();){var n=i.next();n.getLabel().getLocation(t)===I.BOUNDARY&&e.add(n)}return e},Re.prototype.add=function(t){var e=t.getCoordinate();this.addNode(e).add(t)},Re.prototype.interfaces_=function(){return[]},Re.prototype.getClass=function(){return Re};var Ne=function(){},He={NE:{configurable:!0},NW:{configurable:!0},SW:{configurable:!0},SE:{configurable:!0}};Ne.prototype.interfaces_=function(){return[]},Ne.prototype.getClass=function(){return Ne},Ne.isNorthern=function(t){return t===Ne.NE||t===Ne.NW},Ne.isOpposite=function(t,e){return t!==e&&2==(t-e+4)%4},Ne.commonHalfPlane=function(t,e){if(t===e)return t;if(2==(t-e+4)%4)return-1;var i=t<e?t:e;return 0===i&&3===(t>e?t:e)?3:i},Ne.isInHalfPlane=function(t,e){return e===Ne.SE?t===Ne.SE||t===Ne.SW:t===e||t===e+1},Ne.quadrant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new y("Cannot compute the quadrant for point ( "+t+", "+e+" )");return t>=0?e>=0?Ne.NE:Ne.SE:e>=0?Ne.NW:Ne.SW}if(arguments[0]instanceof b&&arguments[1]instanceof b){var i=arguments[0],n=arguments[1];if(n.x===i.x&&n.y===i.y)throw new y("Cannot compute the quadrant for two identical points "+i);return n.x>=i.x?n.y>=i.y?Ne.NE:Ne.SE:n.y>=i.y?Ne.NW:Ne.SW}},He.NE.get=function(){return 0},He.NW.get=function(){return 1},He.SW.get=function(){return 2},He.SE.get=function(){return 3},Object.defineProperties(Ne,He);var ke=function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,1===arguments.length){var t=arguments[0];this._edge=t}else if(3===arguments.length){var e=arguments[0],i=arguments[1],n=arguments[2];this._edge=e,this.init(i,n),this._label=null}else if(4===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3];this._edge=r,this.init(o,s),this._label=a}};ke.prototype.compareDirection=function(t){return this._dx===t._dx&&this._dy===t._dy?0:this._quadrant>t._quadrant?1:this._quadrant<t._quadrant?-1:at.computeOrientation(t._p0,t._p1,this._p1)},ke.prototype.getDy=function(){return this._dy},ke.prototype.getCoordinate=function(){return this._p0},ke.prototype.setNode=function(t){this._node=t},ke.prototype.print=function(t){var e=Math.atan2(this._dy,this._dx),i=this.getClass().getName(),n=i.lastIndexOf("."),r=i.substring(n+1);t.print("  "+r+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+e+"   "+this._label)},ke.prototype.compareTo=function(t){var e=t;return this.compareDirection(e)},ke.prototype.getDirectedCoordinate=function(){return this._p1},ke.prototype.getDx=function(){return this._dx},ke.prototype.getLabel=function(){return this._label},ke.prototype.getEdge=function(){return this._edge},ke.prototype.getQuadrant=function(){return this._quadrant},ke.prototype.getNode=function(){return this._node},ke.prototype.toString=function(){var t=Math.atan2(this._dy,this._dx),e=this.getClass().getName(),i=e.lastIndexOf(".");return"  "+e.substring(i+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+t+"   "+this._label},ke.prototype.computeLabel=function(t){},ke.prototype.init=function(t,e){this._p0=t,this._p1=e,this._dx=e.x-t.x,this._dy=e.y-t.y,this._quadrant=Ne.quadrant(this._dx,this._dy),et.isTrue(!(0===this._dx&&0===this._dy),"EdgeEnd with identical endpoints found")},ke.prototype.interfaces_=function(){return[w]},ke.prototype.getClass=function(){return ke};var Ve=function(t){function e(){var e=arguments[0],i=arguments[1];if(t.call(this,e),this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999],this._isForward=i,i)this.init(e.getCoordinate(0),e.getCoordinate(1));else{var n=e.getNumPoints()-1;this.init(e.getCoordinate(n),e.getCoordinate(n-1))}this.computeDirectedLabel()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getNextMin=function(){return this._nextMin},e.prototype.getDepth=function(t){return this._depth[t]},e.prototype.setVisited=function(t){this._isVisited=t},e.prototype.computeDirectedLabel=function(){this._label=new Te(this._edge.getLabel()),this._isForward||this._label.flip()},e.prototype.getNext=function(){return this._next},e.prototype.setDepth=function(t,e){if(-999!==this._depth[t]&&this._depth[t]!==e)throw new Ie("assigned depths do not match",this.getCoordinate());this._depth[t]=e},e.prototype.isInteriorAreaEdge=function(){for(var t=!0,e=0;e<2;e++)this._label.isArea(e)&&this._label.getLocation(e,Ee.LEFT)===I.INTERIOR&&this._label.getLocation(e,Ee.RIGHT)===I.INTERIOR||(t=!1);return t},e.prototype.setNextMin=function(t){this._nextMin=t},e.prototype.print=function(e){t.prototype.print.call(this,e),e.print(" "+this._depth[Ee.LEFT]+"/"+this._depth[Ee.RIGHT]),e.print(" ("+this.getDepthDelta()+")"),this._isInResult&&e.print(" inResult")},e.prototype.setMinEdgeRing=function(t){this._minEdgeRing=t},e.prototype.isLineEdge=function(){var t=this._label.isLine(0)||this._label.isLine(1),e=!this._label.isArea(0)||this._label.allPositionsEqual(0,I.EXTERIOR),i=!this._label.isArea(1)||this._label.allPositionsEqual(1,I.EXTERIOR);return t&&e&&i},e.prototype.setEdgeRing=function(t){this._edgeRing=t},e.prototype.getMinEdgeRing=function(){return this._minEdgeRing},e.prototype.getDepthDelta=function(){var t=this._edge.getDepthDelta();return this._isForward||(t=-t),t},e.prototype.setInResult=function(t){this._isInResult=t},e.prototype.getSym=function(){return this._sym},e.prototype.isForward=function(){return this._isForward},e.prototype.getEdge=function(){return this._edge},e.prototype.printEdge=function(t){this.print(t),t.print(" "),this._isForward?this._edge.print(t):this._edge.printReverse(t)},e.prototype.setSym=function(t){this._sym=t},e.prototype.setVisitedEdge=function(t){this.setVisited(t),this._sym.setVisited(t)},e.prototype.setEdgeDepths=function(t,e){var i=this.getEdge().getDepthDelta();this._isForward||(i=-i);var n=1;t===Ee.LEFT&&(n=-1);var r=Ee.opposite(t),o=e+i*n;this.setDepth(t,e),this.setDepth(r,o)},e.prototype.getEdgeRing=function(){return this._edgeRing},e.prototype.isInResult=function(){return this._isInResult},e.prototype.setNext=function(t){this._next=t},e.prototype.isVisited=function(){return this._isVisited},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.depthFactor=function(t,e){return t===I.EXTERIOR&&e===I.INTERIOR?1:t===I.INTERIOR&&e===I.EXTERIOR?-1:0},e}(ke),je=function(){};je.prototype.createNode=function(t){return new Qe(t,null)},je.prototype.interfaces_=function(){return[]},je.prototype.getClass=function(){return je};var Ge=function(){if(this._edges=new Bt,this._nodes=null,this._edgeEndList=new Bt,0===arguments.length)this._nodes=new Re(new je);else if(1===arguments.length){var t=arguments[0];this._nodes=new Re(t)}};Ge.prototype.printEdges=function(t){t.println("Edges:");for(var e=0;e<this._edges.size();e++){t.println("edge "+e+":");var i=this._edges.get(e);i.print(t),i.eiList.print(t)}},Ge.prototype.find=function(t){return this._nodes.find(t)},Ge.prototype.addNode=function(){if(arguments[0]instanceof Qe){var t=arguments[0];return this._nodes.addNode(t)}if(arguments[0]instanceof b){var e=arguments[0];return this._nodes.addNode(e)}},Ge.prototype.getNodeIterator=function(){return this._nodes.iterator()},Ge.prototype.linkResultDirectedEdges=function(){for(var t=this._nodes.iterator();t.hasNext();)t.next().getEdges().linkResultDirectedEdges()},Ge.prototype.debugPrintln=function(t){G.out.println(t)},Ge.prototype.isBoundaryNode=function(t,e){var i=this._nodes.find(e);if(null===i)return!1;var n=i.getLabel();return null!==n&&n.getLocation(t)===I.BOUNDARY},Ge.prototype.linkAllDirectedEdges=function(){for(var t=this._nodes.iterator();t.hasNext();)t.next().getEdges().linkAllDirectedEdges()},Ge.prototype.matchInSameDirection=function(t,e,i,n){return!!t.equals(i)&&at.computeOrientation(t,e,n)===at.COLLINEAR&&Ne.quadrant(t,e)===Ne.quadrant(i,n)},Ge.prototype.getEdgeEnds=function(){return this._edgeEndList},Ge.prototype.debugPrint=function(t){G.out.print(t)},Ge.prototype.getEdgeIterator=function(){return this._edges.iterator()},Ge.prototype.findEdgeInSameDirection=function(t,e){for(var i=0;i<this._edges.size();i++){var n=this._edges.get(i),r=n.getCoordinates();if(this.matchInSameDirection(t,e,r[0],r[1]))return n;if(this.matchInSameDirection(t,e,r[r.length-1],r[r.length-2]))return n}return null},Ge.prototype.insertEdge=function(t){this._edges.add(t)},Ge.prototype.findEdgeEnd=function(t){for(var e=this.getEdgeEnds().iterator();e.hasNext();){var i=e.next();if(i.getEdge()===t)return i}return null},Ge.prototype.addEdges=function(t){for(var e=t.iterator();e.hasNext();){var i=e.next();this._edges.add(i);var n=new Ve(i,!0),r=new Ve(i,!1);n.setSym(r),r.setSym(n),this.add(n),this.add(r)}},Ge.prototype.add=function(t){this._nodes.add(t),this._edgeEndList.add(t)},Ge.prototype.getNodes=function(){return this._nodes.values()},Ge.prototype.findEdge=function(t,e){for(var i=0;i<this._edges.size();i++){var n=this._edges.get(i),r=n.getCoordinates();if(t.equals(r[0])&&e.equals(r[1]))return n}return null},Ge.prototype.interfaces_=function(){return[]},Ge.prototype.getClass=function(){return Ge},Ge.linkResultDirectedEdges=function(t){for(var e=t.iterator();e.hasNext();)e.next().getEdges().linkResultDirectedEdges()};var Ke=function(){this._geometryFactory=null,this._shellList=new Bt;var t=arguments[0];this._geometryFactory=t};Ke.prototype.sortShellsAndHoles=function(t,e,i){for(var n=t.iterator();n.hasNext();){var r=n.next();r.isHole()?i.add(r):e.add(r)}},Ke.prototype.computePolygons=function(t){for(var e=new Bt,i=t.iterator();i.hasNext();){var n=i.next().toPolygon(this._geometryFactory);e.add(n)}return e},Ke.prototype.placeFreeHoles=function(t,e){for(var i=e.iterator();i.hasNext();){var n=i.next();if(null===n.getShell()){var r=this.findEdgeRingContaining(n,t);if(null===r)throw new Ie("unable to assign hole to a shell",n.getCoordinate(0));n.setShell(r)}}},Ke.prototype.buildMinimalEdgeRings=function(t,e,i){for(var n=new Bt,r=t.iterator();r.hasNext();){var o=r.next();if(o.getMaxNodeDegree()>2){o.linkDirectedEdgesForMinimalEdgeRings();var s=o.buildMinimalRings(),a=this.findShell(s);null!==a?(this.placePolygonHoles(a,s),e.add(a)):i.addAll(s)}else n.add(o)}return n},Ke.prototype.containsPoint=function(t){for(var e=this._shellList.iterator();e.hasNext();)if(e.next().containsPoint(t))return!0;return!1},Ke.prototype.buildMaximalEdgeRings=function(t){for(var e=new Bt,i=t.iterator();i.hasNext();){var n=i.next();if(n.isInResult()&&n.getLabel().isArea()&&null===n.getEdgeRing()){var r=new Ue(n,this._geometryFactory);e.add(r),r.setInResult()}}return e},Ke.prototype.placePolygonHoles=function(t,e){for(var i=e.iterator();i.hasNext();){var n=i.next();n.isHole()&&n.setShell(t)}},Ke.prototype.getPolygons=function(){return this.computePolygons(this._shellList)},Ke.prototype.findEdgeRingContaining=function(t,e){for(var i=t.getLinearRing(),n=i.getEnvelopeInternal(),r=i.getCoordinateN(0),o=null,s=null,a=e.iterator();a.hasNext();){var A=a.next(),l=A.getLinearRing(),c=l.getEnvelopeInternal();null!==o&&(s=o.getLinearRing().getEnvelopeInternal());var u=!1;c.contains(n)&&at.isPointInRing(r,l.getCoordinates())&&(u=!0),u&&(null===o||s.contains(c))&&(o=A)}return o},Ke.prototype.findShell=function(t){for(var e=0,i=null,n=t.iterator();n.hasNext();){var r=n.next();r.isHole()||(i=r,e++)}return et.isTrue(e<=1,"found two shells in MinimalEdgeRing list"),i},Ke.prototype.add=function(){if(1===arguments.length){var t=arguments[0];this.add(t.getEdgeEnds(),t.getNodes())}else if(2===arguments.length){var e=arguments[0],i=arguments[1];Ge.linkResultDirectedEdges(i);var n=this.buildMaximalEdgeRings(e),r=new Bt,o=this.buildMinimalEdgeRings(n,this._shellList,r);this.sortShellsAndHoles(o,this._shellList,r),this.placeFreeHoles(this._shellList,r)}},Ke.prototype.interfaces_=function(){return[]},Ke.prototype.getClass=function(){return Ke};var ze=function(){};ze.prototype.getBounds=function(){},ze.prototype.interfaces_=function(){return[]},ze.prototype.getClass=function(){return ze};var We=function(){this._bounds=null,this._item=null;var t=arguments[0],e=arguments[1];this._bounds=t,this._item=e};We.prototype.getItem=function(){return this._item},We.prototype.getBounds=function(){return this._bounds},We.prototype.interfaces_=function(){return[ze,e]},We.prototype.getClass=function(){return We};var qe=function(){this._size=null,this._items=null,this._size=0,this._items=new Bt,this._items.add(null)};qe.prototype.poll=function(){if(this.isEmpty())return null;var t=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),t},qe.prototype.size=function(){return this._size},qe.prototype.reorder=function(t){for(var e=null,i=this._items.get(t);2*t<=this._size&&((e=2*t)!==this._size&&this._items.get(e+1).compareTo(this._items.get(e))<0&&e++,this._items.get(e).compareTo(i)<0);t=e)this._items.set(t,this._items.get(e));this._items.set(t,i)},qe.prototype.clear=function(){this._size=0,this._items.clear()},qe.prototype.isEmpty=function(){return 0===this._size},qe.prototype.add=function(t){this._items.add(null),this._size+=1;var e=this._size;for(this._items.set(0,t);t.compareTo(this._items.get(Math.trunc(e/2)))<0;e/=2)this._items.set(e,this._items.get(Math.trunc(e/2)));this._items.set(e,t)},qe.prototype.interfaces_=function(){return[]},qe.prototype.getClass=function(){return qe};var Xe=function(){};Xe.prototype.visitItem=function(t){},Xe.prototype.interfaces_=function(){return[]},Xe.prototype.getClass=function(){return Xe};var Ye=function(){};Ye.prototype.insert=function(t,e){},Ye.prototype.remove=function(t,e){},Ye.prototype.query=function(){},Ye.prototype.interfaces_=function(){return[]},Ye.prototype.getClass=function(){return Ye};var Je=function(){if(this._childBoundables=new Bt,this._bounds=null,this._level=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this._level=t}},Ze={serialVersionUID:{configurable:!0}};Je.prototype.getLevel=function(){return this._level},Je.prototype.size=function(){return this._childBoundables.size()},Je.prototype.getChildBoundables=function(){return this._childBoundables},Je.prototype.addChildBoundable=function(t){et.isTrue(null===this._bounds),this._childBoundables.add(t)},Je.prototype.isEmpty=function(){return this._childBoundables.isEmpty()},Je.prototype.getBounds=function(){return null===this._bounds&&(this._bounds=this.computeBounds()),this._bounds},Je.prototype.interfaces_=function(){return[ze,e]},Je.prototype.getClass=function(){return Je},Ze.serialVersionUID.get=function(){return 0x5a1e55ec41369800},Object.defineProperties(Je,Ze);var $e=function(){};$e.reverseOrder=function(){return{compare:function(t,e){return e.compareTo(t)}}},$e.min=function(t){return $e.sort(t),t.get(0)},$e.sort=function(t,e){var i=t.toArray();e?Qt.sort(i,e):Qt.sort(i);for(var n=t.iterator(),r=0,o=i.length;r<o;r++)n.next(),n.set(i[r])},$e.singletonList=function(t){var e=new Bt;return e.add(t),e};var ti=function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var t=arguments[0],e=arguments[1],i=arguments[2];this._boundable1=t,this._boundable2=e,this._itemDistance=i,this._distance=this.distance()};ti.prototype.expandToQueue=function(t,e){var i=ti.isComposite(this._boundable1),n=ti.isComposite(this._boundable2);if(i&&n)return ti.area(this._boundable1)>ti.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,t,e),null):(this.expand(this._boundable2,this._boundable1,t,e),null);if(i)return this.expand(this._boundable1,this._boundable2,t,e),null;if(n)return this.expand(this._boundable2,this._boundable1,t,e),null;throw new y("neither boundable is composite")},ti.prototype.isLeaves=function(){return!(ti.isComposite(this._boundable1)||ti.isComposite(this._boundable2))},ti.prototype.compareTo=function(t){var e=t;return this._distance<e._distance?-1:this._distance>e._distance?1:0},ti.prototype.expand=function(t,e,i,n){for(var r=t.getChildBoundables().iterator();r.hasNext();){var o=r.next(),s=new ti(o,e,this._itemDistance);s.getDistance()<n&&i.add(s)}},ti.prototype.getBoundable=function(t){return 0===t?this._boundable1:this._boundable2},ti.prototype.getDistance=function(){return this._distance},ti.prototype.distance=function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())},ti.prototype.interfaces_=function(){return[w]},ti.prototype.getClass=function(){return ti},ti.area=function(t){return t.getBounds().getArea()},ti.isComposite=function(t){return t instanceof Je};var ei=function t(){if(this._root=null,this._built=!1,this._itemBoundables=new Bt,this._nodeCapacity=null,0===arguments.length){var e=t.DEFAULT_NODE_CAPACITY;this._nodeCapacity=e}else if(1===arguments.length){var i=arguments[0];et.isTrue(i>1,"Node capacity must be greater than 1"),this._nodeCapacity=i}},ii={IntersectsOp:{configurable:!0},serialVersionUID:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};ei.prototype.getNodeCapacity=function(){return this._nodeCapacity},ei.prototype.lastNode=function(t){return t.get(t.size()-1)},ei.prototype.size=function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.size(this._root));if(1===arguments.length){for(var t=0,e=arguments[0].getChildBoundables().iterator();e.hasNext();){var i=e.next();i instanceof Je?t+=this.size(i):i instanceof We&&(t+=1)}return t}},ei.prototype.removeItem=function(t,e){for(var i=null,n=t.getChildBoundables().iterator();n.hasNext();){var r=n.next();r instanceof We&&r.getItem()===e&&(i=r)}return null!==i&&(t.getChildBoundables().remove(i),!0)},ei.prototype.itemsTree=function(){if(0===arguments.length){this.build();var t=this.itemsTree(this._root);return null===t?new Bt:t}if(1===arguments.length){for(var e=arguments[0],i=new Bt,n=e.getChildBoundables().iterator();n.hasNext();){var r=n.next();if(r instanceof Je){var o=this.itemsTree(r);null!==o&&i.add(o)}else r instanceof We?i.add(r.getItem()):et.shouldNeverReachHere()}return i.size()<=0?null:i}},ei.prototype.insert=function(t,e){et.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new We(t,e))},ei.prototype.boundablesAtLevel=function(){if(1===arguments.length){var t=arguments[0],e=new Bt;return this.boundablesAtLevel(t,this._root,e),e}if(3===arguments.length){var i=arguments[0],n=arguments[1],r=arguments[2];if(et.isTrue(i>-2),n.getLevel()===i)return r.add(n),null;for(var o=n.getChildBoundables().iterator();o.hasNext();){var s=o.next();s instanceof Je?this.boundablesAtLevel(i,s,r):(et.isTrue(s instanceof We),-1===i&&r.add(s))}return null}},ei.prototype.query=function(){if(1===arguments.length){var t=arguments[0];this.build();var e=new Bt;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.query(t,this._root,e),e}if(2===arguments.length){var i=arguments[0],n=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),i)&&this.query(i,this._root,n)}else if(3===arguments.length)if(O(arguments[2],Xe)&&arguments[0]instanceof Object&&arguments[1]instanceof Je)for(var r=arguments[0],o=arguments[1],s=arguments[2],a=o.getChildBoundables(),A=0;A<a.size();A++){var l=a.get(A);this.getIntersectsOp().intersects(l.getBounds(),r)&&(l instanceof Je?this.query(r,l,s):l instanceof We?s.visitItem(l.getItem()):et.shouldNeverReachHere())}else if(O(arguments[2],Ct)&&arguments[0]instanceof Object&&arguments[1]instanceof Je)for(var c=arguments[0],u=arguments[1],h=arguments[2],p=u.getChildBoundables(),d=0;d<p.size();d++){var f=p.get(d);this.getIntersectsOp().intersects(f.getBounds(),c)&&(f instanceof Je?this.query(c,f,h):f instanceof We?h.add(f.getItem()):et.shouldNeverReachHere())}},ei.prototype.build=function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0},ei.prototype.getRoot=function(){return this.build(),this._root},ei.prototype.remove=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.remove(t,this._root,e)}if(3===arguments.length){var i=arguments[0],n=arguments[1],r=arguments[2],o=this.removeItem(n,r);if(o)return!0;for(var s=null,a=n.getChildBoundables().iterator();a.hasNext();){var A=a.next();if(this.getIntersectsOp().intersects(A.getBounds(),i)&&A instanceof Je&&(o=this.remove(i,A,r))){s=A;break}}return null!==s&&s.getChildBoundables().isEmpty()&&n.getChildBoundables().remove(s),o}},ei.prototype.createHigherLevels=function(t,e){et.isTrue(!t.isEmpty());var i=this.createParentBoundables(t,e+1);return 1===i.size()?i.get(0):this.createHigherLevels(i,e+1)},ei.prototype.depth=function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(1===arguments.length){for(var t=0,e=arguments[0].getChildBoundables().iterator();e.hasNext();){var i=e.next();if(i instanceof Je){var n=this.depth(i);n>t&&(t=n)}}return t+1}},ei.prototype.createParentBoundables=function(t,e){et.isTrue(!t.isEmpty());var i=new Bt;i.add(this.createNode(e));var n=new Bt(t);$e.sort(n,this.getComparator());for(var r=n.iterator();r.hasNext();){var o=r.next();this.lastNode(i).getChildBoundables().size()===this.getNodeCapacity()&&i.add(this.createNode(e)),this.lastNode(i).addChildBoundable(o)}return i},ei.prototype.isEmpty=function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()},ei.prototype.interfaces_=function(){return[e]},ei.prototype.getClass=function(){return ei},ei.compareDoubles=function(t,e){return t>e?1:t<e?-1:0},ii.IntersectsOp.get=function(){return ni},ii.serialVersionUID.get=function(){return-0x35ef64c82d4c5400},ii.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(ei,ii);var ni=function(){},ri=function(){};ri.prototype.distance=function(t,e){},ri.prototype.interfaces_=function(){return[]},ri.prototype.getClass=function(){return ri};var oi=function(t){function i(e){e=e||i.DEFAULT_NODE_CAPACITY,t.call(this,e)}t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i;var n={STRtreeNode:{configurable:!0},serialVersionUID:{configurable:!0},xComparator:{configurable:!0},yComparator:{configurable:!0},intersectsOp:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};return i.prototype.createParentBoundablesFromVerticalSlices=function(t,e){et.isTrue(t.length>0);for(var i=new Bt,n=0;n<t.length;n++)i.addAll(this.createParentBoundablesFromVerticalSlice(t[n],e));return i},i.prototype.createNode=function(t){return new si(t)},i.prototype.size=function(){return 0===arguments.length?t.prototype.size.call(this):t.prototype.size.apply(this,arguments)},i.prototype.insert=function(){if(2!==arguments.length)return t.prototype.insert.apply(this,arguments);var e=arguments[0],i=arguments[1];if(e.isNull())return null;t.prototype.insert.call(this,e,i)},i.prototype.getIntersectsOp=function(){return i.intersectsOp},i.prototype.verticalSlices=function(t,e){for(var i=Math.trunc(Math.ceil(t.size()/e)),n=new Array(e).fill(null),r=t.iterator(),o=0;o<e;o++){n[o]=new Bt;for(var s=0;r.hasNext()&&s<i;){var a=r.next();n[o].add(a),s++}}return n},i.prototype.query=function(){if(1===arguments.length){var e=arguments[0];return t.prototype.query.call(this,e)}if(2===arguments.length){var i=arguments[0],n=arguments[1];t.prototype.query.call(this,i,n)}else if(3===arguments.length)if(O(arguments[2],Xe)&&arguments[0]instanceof Object&&arguments[1]instanceof Je){var r=arguments[0],o=arguments[1],s=arguments[2];t.prototype.query.call(this,r,o,s)}else if(O(arguments[2],Ct)&&arguments[0]instanceof Object&&arguments[1]instanceof Je){var a=arguments[0],A=arguments[1],l=arguments[2];t.prototype.query.call(this,a,A,l)}},i.prototype.getComparator=function(){return i.yComparator},i.prototype.createParentBoundablesFromVerticalSlice=function(e,i){return t.prototype.createParentBoundables.call(this,e,i)},i.prototype.remove=function(){if(2===arguments.length){var e=arguments[0],i=arguments[1];return t.prototype.remove.call(this,e,i)}return t.prototype.remove.apply(this,arguments)},i.prototype.depth=function(){return 0===arguments.length?t.prototype.depth.call(this):t.prototype.depth.apply(this,arguments)},i.prototype.createParentBoundables=function(t,e){et.isTrue(!t.isEmpty());var n=Math.trunc(Math.ceil(t.size()/this.getNodeCapacity())),r=new Bt(t);$e.sort(r,i.xComparator);var o=this.verticalSlices(r,Math.trunc(Math.ceil(Math.sqrt(n))));return this.createParentBoundablesFromVerticalSlices(o,e)},i.prototype.nearestNeighbour=function(){if(1===arguments.length){if(O(arguments[0],ri)){var t=arguments[0],e=new ti(this.getRoot(),this.getRoot(),t);return this.nearestNeighbour(e)}if(arguments[0]instanceof ti){var n=arguments[0];return this.nearestNeighbour(n,v.POSITIVE_INFINITY)}}else if(2===arguments.length){if(arguments[0]instanceof i&&O(arguments[1],ri)){var r=arguments[0],o=arguments[1],s=new ti(this.getRoot(),r.getRoot(),o);return this.nearestNeighbour(s)}if(arguments[0]instanceof ti&&"number"==typeof arguments[1]){var a=arguments[0],A=arguments[1],l=null,c=new qe;for(c.add(a);!c.isEmpty()&&A>0;){var u=c.poll(),h=u.getDistance();if(h>=A)break;u.isLeaves()?(A=h,l=u):u.expandToQueue(c,A)}return[l.getBoundable(0).getItem(),l.getBoundable(1).getItem()]}}else if(3===arguments.length){var p=arguments[0],d=arguments[1],f=arguments[2],g=new We(p,d),m=new ti(this.getRoot(),g,f);return this.nearestNeighbour(m)[0]}},i.prototype.interfaces_=function(){return[Ye,e]},i.prototype.getClass=function(){return i},i.centreX=function(t){return i.avg(t.getMinX(),t.getMaxX())},i.avg=function(t,e){return(t+e)/2},i.centreY=function(t){return i.avg(t.getMinY(),t.getMaxY())},n.STRtreeNode.get=function(){return si},n.serialVersionUID.get=function(){return 0x39920f7d5f261e0},n.xComparator.get=function(){return{interfaces_:function(){return[B]},compare:function(e,n){return t.compareDoubles(i.centreX(e.getBounds()),i.centreX(n.getBounds()))}}},n.yComparator.get=function(){return{interfaces_:function(){return[B]},compare:function(e,n){return t.compareDoubles(i.centreY(e.getBounds()),i.centreY(n.getBounds()))}}},n.intersectsOp.get=function(){return{interfaces_:function(){return[t.IntersectsOp]},intersects:function(t,e){return t.intersects(e)}}},n.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(i,n),i}(ei),si=function(t){function e(){var e=arguments[0];t.call(this,e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.computeBounds=function(){for(var t=null,e=this.getChildBoundables().iterator();e.hasNext();){var i=e.next();null===t?t=new z(i.getBounds()):t.expandToInclude(i.getBounds())}return t},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Je),ai=function(){};ai.prototype.interfaces_=function(){return[]},ai.prototype.getClass=function(){return ai},ai.relativeSign=function(t,e){return t<e?-1:t>e?1:0},ai.compare=function(t,e,i){if(e.equals2D(i))return 0;var n=ai.relativeSign(e.x,i.x),r=ai.relativeSign(e.y,i.y);switch(t){case 0:return ai.compareValue(n,r);case 1:return ai.compareValue(r,n);case 2:return ai.compareValue(r,-n);case 3:return ai.compareValue(-n,r);case 4:return ai.compareValue(-n,-r);case 5:return ai.compareValue(-r,-n);case 6:return ai.compareValue(-r,n);case 7:return ai.compareValue(n,-r)}return et.shouldNeverReachHere("invalid octant value"),0},ai.compareValue=function(t,e){return t<0?-1:t>0?1:e<0?-1:e>0?1:0};var Ai=function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var t=arguments[0],e=arguments[1],i=arguments[2],n=arguments[3];this._segString=t,this.coord=new b(e),this.segmentIndex=i,this._segmentOctant=n,this._isInterior=!e.equals2D(t.getCoordinate(i))};Ai.prototype.getCoordinate=function(){return this.coord},Ai.prototype.print=function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex)},Ai.prototype.compareTo=function(t){var e=t;return this.segmentIndex<e.segmentIndex?-1:this.segmentIndex>e.segmentIndex?1:this.coord.equals2D(e.coord)?0:ai.compare(this._segmentOctant,this.coord,e.coord)},Ai.prototype.isEndPoint=function(t){return 0===this.segmentIndex&&!this._isInterior||this.segmentIndex===t},Ai.prototype.isInterior=function(){return this._isInterior},Ai.prototype.interfaces_=function(){return[w]},Ai.prototype.getClass=function(){return Ai};var li=function(){this._nodeMap=new u,this._edge=null;var t=arguments[0];this._edge=t};li.prototype.getSplitCoordinates=function(){var t=new Et;this.addEndpoints();for(var e=this.iterator(),i=e.next();e.hasNext();){var n=e.next();this.addEdgeCoordinates(i,n,t),i=n}return t.toCoordinateArray()},li.prototype.addCollapsedNodes=function(){var t=new Bt;this.findCollapsesFromInsertedNodes(t),this.findCollapsesFromExistingVertices(t);for(var e=t.iterator();e.hasNext();){var i=e.next().intValue();this.add(this._edge.getCoordinate(i),i)}},li.prototype.print=function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();)e.next().print(t)},li.prototype.findCollapsesFromExistingVertices=function(t){for(var e=0;e<this._edge.size()-2;e++){var i=this._edge.getCoordinate(e),n=this._edge.getCoordinate(e+2);i.equals2D(n)&&t.add(new M(e+1))}},li.prototype.addEdgeCoordinates=function(t,e,i){var n=this._edge.getCoordinate(e.segmentIndex),r=e.isInterior()||!e.coord.equals2D(n);i.add(new b(t.coord),!1);for(var o=t.segmentIndex+1;o<=e.segmentIndex;o++)i.add(this._edge.getCoordinate(o));r&&i.add(new b(e.coord))},li.prototype.iterator=function(){return this._nodeMap.values().iterator()},li.prototype.addSplitEdges=function(t){this.addEndpoints(),this.addCollapsedNodes();for(var e=this.iterator(),i=e.next();e.hasNext();){var n=e.next(),r=this.createSplitEdge(i,n);t.add(r),i=n}},li.prototype.findCollapseIndex=function(t,e,i){if(!t.coord.equals2D(e.coord))return!1;var n=e.segmentIndex-t.segmentIndex;return e.isInterior()||n--,1===n&&(i[0]=t.segmentIndex+1,!0)},li.prototype.findCollapsesFromInsertedNodes=function(t){for(var e=new Array(1).fill(null),i=this.iterator(),n=i.next();i.hasNext();){var r=i.next();this.findCollapseIndex(n,r,e)&&t.add(new M(e[0])),n=r}},li.prototype.getEdge=function(){return this._edge},li.prototype.addEndpoints=function(){var t=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(t),t)},li.prototype.createSplitEdge=function(t,e){var i=e.segmentIndex-t.segmentIndex+2,n=this._edge.getCoordinate(e.segmentIndex),r=e.isInterior()||!e.coord.equals2D(n);r||i--;var o=new Array(i).fill(null),s=0;o[s++]=new b(t.coord);for(var a=t.segmentIndex+1;a<=e.segmentIndex;a++)o[s++]=this._edge.getCoordinate(a);return r&&(o[s]=new b(e.coord)),new pi(o,this._edge.getData())},li.prototype.add=function(t,e){var i=new Ai(this._edge,t,e,this._edge.getSegmentOctant(e)),n=this._nodeMap.get(i);return null!==n?(et.isTrue(n.coord.equals2D(t),"Found equal nodes with different coordinates"),n):(this._nodeMap.put(i,i),i)},li.prototype.checkSplitEdgesCorrectness=function(t){var e=this._edge.getCoordinates(),i=t.get(0).getCoordinate(0);if(!i.equals2D(e[0]))throw new $("bad split edge start point at "+i);var n=t.get(t.size()-1).getCoordinates(),r=n[n.length-1];if(!r.equals2D(e[e.length-1]))throw new $("bad split edge end point at "+r)},li.prototype.interfaces_=function(){return[]},li.prototype.getClass=function(){return li};var ci=function(){};ci.prototype.interfaces_=function(){return[]},ci.prototype.getClass=function(){return ci},ci.octant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new y("Cannot compute the octant for point ( "+t+", "+e+" )");var i=Math.abs(t),n=Math.abs(e);return t>=0?e>=0?i>=n?0:1:i>=n?7:6:e>=0?i>=n?3:2:i>=n?4:5}if(arguments[0]instanceof b&&arguments[1]instanceof b){var r=arguments[0],o=arguments[1],s=o.x-r.x,a=o.y-r.y;if(0===s&&0===a)throw new y("Cannot compute the octant for two identical points "+r);return ci.octant(s,a)}};var ui=function(){};ui.prototype.getCoordinates=function(){},ui.prototype.size=function(){},ui.prototype.getCoordinate=function(t){},ui.prototype.isClosed=function(){},ui.prototype.setData=function(t){},ui.prototype.getData=function(){},ui.prototype.interfaces_=function(){return[]},ui.prototype.getClass=function(){return ui};var hi=function(){};hi.prototype.addIntersection=function(t,e){},hi.prototype.interfaces_=function(){return[ui]},hi.prototype.getClass=function(){return hi};var pi=function(){this._nodeList=new li(this),this._pts=null,this._data=null;var t=arguments[0],e=arguments[1];this._pts=t,this._data=e};pi.prototype.getCoordinates=function(){return this._pts},pi.prototype.size=function(){return this._pts.length},pi.prototype.getCoordinate=function(t){return this._pts[t]},pi.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},pi.prototype.getSegmentOctant=function(t){return t===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(t),this.getCoordinate(t+1))},pi.prototype.setData=function(t){this._data=t},pi.prototype.safeOctant=function(t,e){return t.equals2D(e)?0:ci.octant(t,e)},pi.prototype.getData=function(){return this._data},pi.prototype.addIntersection=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];this.addIntersectionNode(t,e)}else if(4===arguments.length){var i=arguments[0],n=arguments[1],r=arguments[3],o=new b(i.getIntersection(r));this.addIntersection(o,n)}},pi.prototype.toString=function(){return Z.toLineString(new Ae(this._pts))},pi.prototype.getNodeList=function(){return this._nodeList},pi.prototype.addIntersectionNode=function(t,e){var i=e,n=i+1;if(n<this._pts.length){var r=this._pts[n];t.equals2D(r)&&(i=n)}return this._nodeList.add(t,i)},pi.prototype.addIntersections=function(t,e,i){for(var n=0;n<t.getIntersectionNum();n++)this.addIntersection(t,e,i,n)},pi.prototype.interfaces_=function(){return[hi]},pi.prototype.getClass=function(){return pi},pi.getNodedSubstrings=function(){if(1===arguments.length){var t=arguments[0],e=new Bt;return pi.getNodedSubstrings(t,e),e}if(2===arguments.length)for(var i=arguments[0],n=arguments[1],r=i.iterator();r.hasNext();)r.next().getNodeList().addSplitEdges(n)};var di=function(){if(this.p0=null,this.p1=null,0===arguments.length)this.p0=new b,this.p1=new b;else if(1===arguments.length){var t=arguments[0];this.p0=new b(t.p0),this.p1=new b(t.p1)}else if(2===arguments.length)this.p0=arguments[0],this.p1=arguments[1];else if(4===arguments.length){var e=arguments[0],i=arguments[1],n=arguments[2],r=arguments[3];this.p0=new b(e,i),this.p1=new b(n,r)}},fi={serialVersionUID:{configurable:!0}};di.prototype.minX=function(){return Math.min(this.p0.x,this.p1.x)},di.prototype.orientationIndex=function(){if(arguments[0]instanceof di){var t=arguments[0],e=at.orientationIndex(this.p0,this.p1,t.p0),i=at.orientationIndex(this.p0,this.p1,t.p1);return e>=0&&i>=0||e<=0&&i<=0?Math.max(e,i):0}if(arguments[0]instanceof b){var n=arguments[0];return at.orientationIndex(this.p0,this.p1,n)}},di.prototype.toGeometry=function(t){return t.createLineString([this.p0,this.p1])},di.prototype.isVertical=function(){return this.p0.x===this.p1.x},di.prototype.equals=function(t){if(!(t instanceof di))return!1;var e=t;return this.p0.equals(e.p0)&&this.p1.equals(e.p1)},di.prototype.intersection=function(t){var e=new rt;return e.computeIntersection(this.p0,this.p1,t.p0,t.p1),e.hasIntersection()?e.getIntersection(0):null},di.prototype.project=function(){if(arguments[0]instanceof b){var t=arguments[0];if(t.equals(this.p0)||t.equals(this.p1))return new b(t);var e=this.projectionFactor(t),i=new b;return i.x=this.p0.x+e*(this.p1.x-this.p0.x),i.y=this.p0.y+e*(this.p1.y-this.p0.y),i}if(arguments[0]instanceof di){var n=arguments[0],r=this.projectionFactor(n.p0),o=this.projectionFactor(n.p1);if(r>=1&&o>=1)return null;if(r<=0&&o<=0)return null;var s=this.project(n.p0);r<0&&(s=this.p0),r>1&&(s=this.p1);var a=this.project(n.p1);return o<0&&(a=this.p0),o>1&&(a=this.p1),new di(s,a)}},di.prototype.normalize=function(){this.p1.compareTo(this.p0)<0&&this.reverse()},di.prototype.angle=function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)},di.prototype.getCoordinate=function(t){return 0===t?this.p0:this.p1},di.prototype.distancePerpendicular=function(t){return at.distancePointLinePerpendicular(t,this.p0,this.p1)},di.prototype.minY=function(){return Math.min(this.p0.y,this.p1.y)},di.prototype.midPoint=function(){return di.midPoint(this.p0,this.p1)},di.prototype.projectionFactor=function(t){if(t.equals(this.p0))return 0;if(t.equals(this.p1))return 1;var e=this.p1.x-this.p0.x,i=this.p1.y-this.p0.y,n=e*e+i*i;return n<=0?v.NaN:((t.x-this.p0.x)*e+(t.y-this.p0.y)*i)/n},di.prototype.closestPoints=function(t){var e=this.intersection(t);if(null!==e)return[e,e];var i=new Array(2).fill(null),n=v.MAX_VALUE,r=null,o=this.closestPoint(t.p0);n=o.distance(t.p0),i[0]=o,i[1]=t.p0;var s=this.closestPoint(t.p1);(r=s.distance(t.p1))<n&&(n=r,i[0]=s,i[1]=t.p1);var a=t.closestPoint(this.p0);(r=a.distance(this.p0))<n&&(n=r,i[0]=this.p0,i[1]=a);var A=t.closestPoint(this.p1);return(r=A.distance(this.p1))<n&&(n=r,i[0]=this.p1,i[1]=A),i},di.prototype.closestPoint=function(t){var e=this.projectionFactor(t);return e>0&&e<1?this.project(t):this.p0.distance(t)<this.p1.distance(t)?this.p0:this.p1},di.prototype.maxX=function(){return Math.max(this.p0.x,this.p1.x)},di.prototype.getLength=function(){return this.p0.distance(this.p1)},di.prototype.compareTo=function(t){var e=t,i=this.p0.compareTo(e.p0);return 0!==i?i:this.p1.compareTo(e.p1)},di.prototype.reverse=function(){var t=this.p0;this.p0=this.p1,this.p1=t},di.prototype.equalsTopo=function(t){return this.p0.equals(t.p0)&&(this.p1.equals(t.p1)||this.p0.equals(t.p1))&&this.p1.equals(t.p0)},di.prototype.lineIntersection=function(t){try{return K.intersection(this.p0,this.p1,t.p0,t.p1)}catch(t){if(!(t instanceof j))throw t}return null},di.prototype.maxY=function(){return Math.max(this.p0.y,this.p1.y)},di.prototype.pointAlongOffset=function(t,e){var i=this.p0.x+t*(this.p1.x-this.p0.x),n=this.p0.y+t*(this.p1.y-this.p0.y),r=this.p1.x-this.p0.x,o=this.p1.y-this.p0.y,s=Math.sqrt(r*r+o*o),a=0,A=0;if(0!==e){if(s<=0)throw new Error("Cannot compute offset from zero-length line segment");a=e*r/s,A=e*o/s}return new b(i-A,n+a)},di.prototype.setCoordinates=function(){if(1===arguments.length){var t=arguments[0];this.setCoordinates(t.p0,t.p1)}else if(2===arguments.length){var e=arguments[0],i=arguments[1];this.p0.x=e.x,this.p0.y=e.y,this.p1.x=i.x,this.p1.y=i.y}},di.prototype.segmentFraction=function(t){var e=this.projectionFactor(t);return e<0?e=0:(e>1||v.isNaN(e))&&(e=1),e},di.prototype.toString=function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"},di.prototype.isHorizontal=function(){return this.p0.y===this.p1.y},di.prototype.distance=function(){if(arguments[0]instanceof di){var t=arguments[0];return at.distanceLineLine(this.p0,this.p1,t.p0,t.p1)}if(arguments[0]instanceof b){var e=arguments[0];return at.distancePointLine(e,this.p0,this.p1)}},di.prototype.pointAlong=function(t){var e=new b;return e.x=this.p0.x+t*(this.p1.x-this.p0.x),e.y=this.p0.y+t*(this.p1.y-this.p0.y),e},di.prototype.hashCode=function(){var t=v.doubleToLongBits(this.p0.x);t^=31*v.doubleToLongBits(this.p0.y);var e=Math.trunc(t)^Math.trunc(t>>32),i=v.doubleToLongBits(this.p1.x);return i^=31*v.doubleToLongBits(this.p1.y),e^Math.trunc(i)^Math.trunc(i>>32)},di.prototype.interfaces_=function(){return[w,e]},di.prototype.getClass=function(){return di},di.midPoint=function(t,e){return new b((t.x+e.x)/2,(t.y+e.y)/2)},fi.serialVersionUID.get=function(){return 0x2d2172135f411c00},Object.defineProperties(di,fi);var gi=function(){this.tempEnv1=new z,this.tempEnv2=new z,this._overlapSeg1=new di,this._overlapSeg2=new di};gi.prototype.overlap=function(){if(2===arguments.length);else if(4===arguments.length){var t=arguments[0],e=arguments[1],i=arguments[2],n=arguments[3];t.getLineSegment(e,this._overlapSeg1),i.getLineSegment(n,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}},gi.prototype.interfaces_=function(){return[]},gi.prototype.getClass=function(){return gi};var mi=function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var t=arguments[0],e=arguments[1],i=arguments[2],n=arguments[3];this._pts=t,this._start=e,this._end=i,this._context=n};mi.prototype.getLineSegment=function(t,e){e.p0=this._pts[t],e.p1=this._pts[t+1]},mi.prototype.computeSelect=function(t,e,i,n){var r=this._pts[e],o=this._pts[i];if(n.tempEnv1.init(r,o),i-e==1)return n.select(this,e),null;if(!t.intersects(n.tempEnv1))return null;var s=Math.trunc((e+i)/2);e<s&&this.computeSelect(t,e,s,n),s<i&&this.computeSelect(t,s,i,n)},mi.prototype.getCoordinates=function(){for(var t=new Array(this._end-this._start+1).fill(null),e=0,i=this._start;i<=this._end;i++)t[e++]=this._pts[i];return t},mi.prototype.computeOverlaps=function(t,e){this.computeOverlapsInternal(this._start,this._end,t,t._start,t._end,e)},mi.prototype.setId=function(t){this._id=t},mi.prototype.select=function(t,e){this.computeSelect(t,this._start,this._end,e)},mi.prototype.getEnvelope=function(){if(null===this._env){var t=this._pts[this._start],e=this._pts[this._end];this._env=new z(t,e)}return this._env},mi.prototype.getEndIndex=function(){return this._end},mi.prototype.getStartIndex=function(){return this._start},mi.prototype.getContext=function(){return this._context},mi.prototype.getId=function(){return this._id},mi.prototype.computeOverlapsInternal=function(t,e,i,n,r,o){var s=this._pts[t],a=this._pts[e],A=i._pts[n],l=i._pts[r];if(e-t==1&&r-n==1)return o.overlap(this,t,i,n),null;if(o.tempEnv1.init(s,a),o.tempEnv2.init(A,l),!o.tempEnv1.intersects(o.tempEnv2))return null;var c=Math.trunc((t+e)/2),u=Math.trunc((n+r)/2);t<c&&(n<u&&this.computeOverlapsInternal(t,c,i,n,u,o),u<r&&this.computeOverlapsInternal(t,c,i,u,r,o)),c<e&&(n<u&&this.computeOverlapsInternal(c,e,i,n,u,o),u<r&&this.computeOverlapsInternal(c,e,i,u,r,o))},mi.prototype.interfaces_=function(){return[]},mi.prototype.getClass=function(){return mi};var yi=function(){};yi.prototype.interfaces_=function(){return[]},yi.prototype.getClass=function(){return yi},yi.getChainStartIndices=function(t){var e=0,i=new Bt;i.add(new M(e));do{var n=yi.findChainEnd(t,e);i.add(new M(n)),e=n}while(e<t.length-1);return yi.toIntArray(i)},yi.findChainEnd=function(t,e){for(var i=e;i<t.length-1&&t[i].equals2D(t[i+1]);)i++;if(i>=t.length-1)return t.length-1;for(var n=Ne.quadrant(t[i],t[i+1]),r=e+1;r<t.length&&(t[r-1].equals2D(t[r])||Ne.quadrant(t[r-1],t[r])===n);)r++;return r-1},yi.getChains=function(){if(1===arguments.length){var t=arguments[0];return yi.getChains(t,null)}if(2===arguments.length){for(var e=arguments[0],i=arguments[1],n=new Bt,r=yi.getChainStartIndices(e),o=0;o<r.length-1;o++){var s=new mi(e,r[o],r[o+1],i);n.add(s)}return n}},yi.toIntArray=function(t){for(var e=new Array(t.size()).fill(null),i=0;i<e.length;i++)e[i]=t.get(i).intValue();return e};var vi=function(){};vi.prototype.computeNodes=function(t){},vi.prototype.getNodedSubstrings=function(){},vi.prototype.interfaces_=function(){return[]},vi.prototype.getClass=function(){return vi};var _i=function(){if(this._segInt=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.setSegmentIntersector(t)}};_i.prototype.setSegmentIntersector=function(t){this._segInt=t},_i.prototype.interfaces_=function(){return[vi]},_i.prototype.getClass=function(){return _i};var wi=function(t){function e(e){e?t.call(this,e):t.call(this),this._monoChains=new Bt,this._index=new oi,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var i={SegmentOverlapAction:{configurable:!0}};return e.prototype.getMonotoneChains=function(){return this._monoChains},e.prototype.getNodedSubstrings=function(){return pi.getNodedSubstrings(this._nodedSegStrings)},e.prototype.getIndex=function(){return this._index},e.prototype.add=function(t){for(var e=yi.getChains(t.getCoordinates(),t).iterator();e.hasNext();){var i=e.next();i.setId(this._idCounter++),this._index.insert(i.getEnvelope(),i),this._monoChains.add(i)}},e.prototype.computeNodes=function(t){this._nodedSegStrings=t;for(var e=t.iterator();e.hasNext();)this.add(e.next());this.intersectChains()},e.prototype.intersectChains=function(){for(var t=new Ci(this._segInt),e=this._monoChains.iterator();e.hasNext();)for(var i=e.next(),n=this._index.query(i.getEnvelope()).iterator();n.hasNext();){var r=n.next();if(r.getId()>i.getId()&&(i.computeOverlaps(r,t),this._nOverlaps++),this._segInt.isDone())return null}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},i.SegmentOverlapAction.get=function(){return Ci},Object.defineProperties(e,i),e}(_i),Ci=function(t){function e(){t.call(this),this._si=null;var e=arguments[0];this._si=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.overlap=function(){if(4!==arguments.length)return t.prototype.overlap.apply(this,arguments);var e=arguments[0],i=arguments[1],n=arguments[2],r=arguments[3],o=e.getContext(),s=n.getContext();this._si.processIntersections(o,i,s,r)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(gi),Bi=function t(){if(this._quadrantSegments=t.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=t.CAP_ROUND,this._joinStyle=t.JOIN_ROUND,this._mitreLimit=t.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=t.DEFAULT_SIMPLIFY_FACTOR,0===arguments.length);else if(1===arguments.length){var e=arguments[0];this.setQuadrantSegments(e)}else if(2===arguments.length){var i=arguments[0],n=arguments[1];this.setQuadrantSegments(i),this.setEndCapStyle(n)}else if(4===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3];this.setQuadrantSegments(r),this.setEndCapStyle(o),this.setJoinStyle(s),this.setMitreLimit(a)}},bi={CAP_ROUND:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},JOIN_ROUND:{configurable:!0},JOIN_MITRE:{configurable:!0},JOIN_BEVEL:{configurable:!0},DEFAULT_QUADRANT_SEGMENTS:{configurable:!0},DEFAULT_MITRE_LIMIT:{configurable:!0},DEFAULT_SIMPLIFY_FACTOR:{configurable:!0}};Bi.prototype.getEndCapStyle=function(){return this._endCapStyle},Bi.prototype.isSingleSided=function(){return this._isSingleSided},Bi.prototype.setQuadrantSegments=function(t){this._quadrantSegments=t,0===this._quadrantSegments&&(this._joinStyle=Bi.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=Bi.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),t<=0&&(this._quadrantSegments=1),this._joinStyle!==Bi.JOIN_ROUND&&(this._quadrantSegments=Bi.DEFAULT_QUADRANT_SEGMENTS)},Bi.prototype.getJoinStyle=function(){return this._joinStyle},Bi.prototype.setJoinStyle=function(t){this._joinStyle=t},Bi.prototype.setSimplifyFactor=function(t){this._simplifyFactor=t<0?0:t},Bi.prototype.getSimplifyFactor=function(){return this._simplifyFactor},Bi.prototype.getQuadrantSegments=function(){return this._quadrantSegments},Bi.prototype.setEndCapStyle=function(t){this._endCapStyle=t},Bi.prototype.getMitreLimit=function(){return this._mitreLimit},Bi.prototype.setMitreLimit=function(t){this._mitreLimit=t},Bi.prototype.setSingleSided=function(t){this._isSingleSided=t},Bi.prototype.interfaces_=function(){return[]},Bi.prototype.getClass=function(){return Bi},Bi.bufferDistanceError=function(t){var e=Math.PI/2/t;return 1-Math.cos(e/2)},bi.CAP_ROUND.get=function(){return 1},bi.CAP_FLAT.get=function(){return 2},bi.CAP_SQUARE.get=function(){return 3},bi.JOIN_ROUND.get=function(){return 1},bi.JOIN_MITRE.get=function(){return 2},bi.JOIN_BEVEL.get=function(){return 3},bi.DEFAULT_QUADRANT_SEGMENTS.get=function(){return 8},bi.DEFAULT_MITRE_LIMIT.get=function(){return 5},bi.DEFAULT_SIMPLIFY_FACTOR.get=function(){return.01},Object.defineProperties(Bi,bi);var Ei=function(t){this._distanceTol=null,this._isDeleted=null,this._angleOrientation=at.COUNTERCLOCKWISE,this._inputLine=t||null},Si={INIT:{configurable:!0},DELETE:{configurable:!0},KEEP:{configurable:!0},NUM_PTS_TO_CHECK:{configurable:!0}};Ei.prototype.isDeletable=function(t,e,i,n){var r=this._inputLine[t],o=this._inputLine[e],s=this._inputLine[i];return!!this.isConcave(r,o,s)&&!!this.isShallow(r,o,s,n)&&this.isShallowSampled(r,o,t,i,n)},Ei.prototype.deleteShallowConcavities=function(){for(var t=1,e=this.findNextNonDeletedIndex(t),i=this.findNextNonDeletedIndex(e),n=!1;i<this._inputLine.length;){var r=!1;this.isDeletable(t,e,i,this._distanceTol)&&(this._isDeleted[e]=Ei.DELETE,r=!0,n=!0),t=r?i:e,e=this.findNextNonDeletedIndex(t),i=this.findNextNonDeletedIndex(e)}return n},Ei.prototype.isShallowConcavity=function(t,e,i,n){return at.computeOrientation(t,e,i)===this._angleOrientation&&at.distancePointLine(e,t,i)<n},Ei.prototype.isShallowSampled=function(t,e,i,n,r){var o=Math.trunc((n-i)/Ei.NUM_PTS_TO_CHECK);o<=0&&(o=1);for(var s=i;s<n;s+=o)if(!this.isShallow(t,e,this._inputLine[s],r))return!1;return!0},Ei.prototype.isConcave=function(t,e,i){return at.computeOrientation(t,e,i)===this._angleOrientation},Ei.prototype.simplify=function(t){this._distanceTol=Math.abs(t),t<0&&(this._angleOrientation=at.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var e=!1;do{e=this.deleteShallowConcavities()}while(e);return this.collapseLine()},Ei.prototype.findNextNonDeletedIndex=function(t){for(var e=t+1;e<this._inputLine.length&&this._isDeleted[e]===Ei.DELETE;)e++;return e},Ei.prototype.isShallow=function(t,e,i,n){return at.distancePointLine(e,t,i)<n},Ei.prototype.collapseLine=function(){for(var t=new Et,e=0;e<this._inputLine.length;e++)this._isDeleted[e]!==Ei.DELETE&&t.add(this._inputLine[e]);return t.toCoordinateArray()},Ei.prototype.interfaces_=function(){return[]},Ei.prototype.getClass=function(){return Ei},Ei.simplify=function(t,e){return new Ei(t).simplify(e)},Si.INIT.get=function(){return 0},Si.DELETE.get=function(){return 1},Si.KEEP.get=function(){return 1},Si.NUM_PTS_TO_CHECK.get=function(){return 10},Object.defineProperties(Ei,Si);var xi=function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new Bt},Ii={COORDINATE_ARRAY_TYPE:{configurable:!0}};xi.prototype.getCoordinates=function(){return this._ptList.toArray(xi.COORDINATE_ARRAY_TYPE)},xi.prototype.setPrecisionModel=function(t){this._precisionModel=t},xi.prototype.addPt=function(t){var e=new b(t);if(this._precisionModel.makePrecise(e),this.isRedundant(e))return null;this._ptList.add(e)},xi.prototype.revere=function(){},xi.prototype.addPts=function(t,e){if(e)for(var i=0;i<t.length;i++)this.addPt(t[i]);else for(var n=t.length-1;n>=0;n--)this.addPt(t[n])},xi.prototype.isRedundant=function(t){if(this._ptList.size()<1)return!1;var e=this._ptList.get(this._ptList.size()-1);return t.distance(e)<this._minimimVertexDistance},xi.prototype.toString=function(){return(new me).createLineString(this.getCoordinates()).toString()},xi.prototype.closeRing=function(){if(this._ptList.size()<1)return null;var t=new b(this._ptList.get(0)),e=this._ptList.get(this._ptList.size()-1);if(t.equals(e))return null;this._ptList.add(t)},xi.prototype.setMinimumVertexDistance=function(t){this._minimimVertexDistance=t},xi.prototype.interfaces_=function(){return[]},xi.prototype.getClass=function(){return xi},Ii.COORDINATE_ARRAY_TYPE.get=function(){return new Array(0).fill(null)},Object.defineProperties(xi,Ii);var Fi=function(){},Oi={PI_TIMES_2:{configurable:!0},PI_OVER_2:{configurable:!0},PI_OVER_4:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},CLOCKWISE:{configurable:!0},NONE:{configurable:!0}};Fi.prototype.interfaces_=function(){return[]},Fi.prototype.getClass=function(){return Fi},Fi.toDegrees=function(t){return 180*t/Math.PI},Fi.normalize=function(t){for(;t>Math.PI;)t-=Fi.PI_TIMES_2;for(;t<=-Math.PI;)t+=Fi.PI_TIMES_2;return t},Fi.angle=function(){if(1===arguments.length){var t=arguments[0];return Math.atan2(t.y,t.x)}if(2===arguments.length){var e=arguments[0],i=arguments[1],n=i.x-e.x,r=i.y-e.y;return Math.atan2(r,n)}},Fi.isAcute=function(t,e,i){var n=t.x-e.x,r=t.y-e.y;return n*(i.x-e.x)+r*(i.y-e.y)>0},Fi.isObtuse=function(t,e,i){var n=t.x-e.x,r=t.y-e.y;return n*(i.x-e.x)+r*(i.y-e.y)<0},Fi.interiorAngle=function(t,e,i){var n=Fi.angle(e,t),r=Fi.angle(e,i);return Math.abs(r-n)},Fi.normalizePositive=function(t){if(t<0){for(;t<0;)t+=Fi.PI_TIMES_2;t>=Fi.PI_TIMES_2&&(t=0)}else{for(;t>=Fi.PI_TIMES_2;)t-=Fi.PI_TIMES_2;t<0&&(t=0)}return t},Fi.angleBetween=function(t,e,i){var n=Fi.angle(e,t),r=Fi.angle(e,i);return Fi.diff(n,r)},Fi.diff=function(t,e){var i=null;return(i=t<e?e-t:t-e)>Math.PI&&(i=2*Math.PI-i),i},Fi.toRadians=function(t){return t*Math.PI/180},Fi.getTurn=function(t,e){var i=Math.sin(e-t);return i>0?Fi.COUNTERCLOCKWISE:i<0?Fi.CLOCKWISE:Fi.NONE},Fi.angleBetweenOriented=function(t,e,i){var n=Fi.angle(e,t),r=Fi.angle(e,i)-n;return r<=-Math.PI?r+Fi.PI_TIMES_2:r>Math.PI?r-Fi.PI_TIMES_2:r},Oi.PI_TIMES_2.get=function(){return 2*Math.PI},Oi.PI_OVER_2.get=function(){return Math.PI/2},Oi.PI_OVER_4.get=function(){return Math.PI/4},Oi.COUNTERCLOCKWISE.get=function(){return at.COUNTERCLOCKWISE},Oi.CLOCKWISE.get=function(){return at.CLOCKWISE},Oi.NONE.get=function(){return at.COLLINEAR},Object.defineProperties(Fi,Oi);var Pi=function t(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new di,this._seg1=new di,this._offset0=new di,this._offset1=new di,this._side=0,this._hasNarrowConcaveAngle=!1;var e=arguments[0],i=arguments[1],n=arguments[2];this._precisionModel=e,this._bufParams=i,this._li=new rt,this._filletAngleQuantum=Math.PI/2/i.getQuadrantSegments(),i.getQuadrantSegments()>=8&&i.getJoinStyle()===Bi.JOIN_ROUND&&(this._closingSegLengthFactor=t.MAX_CLOSING_SEG_LEN_FACTOR),this.init(n)},Ti={OFFSET_SEGMENT_SEPARATION_FACTOR:{configurable:!0},INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},CURVE_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},MAX_CLOSING_SEG_LEN_FACTOR:{configurable:!0}};Pi.prototype.addNextSegment=function(t,e){if(this._s0=this._s1,this._s1=this._s2,this._s2=t,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var i=at.computeOrientation(this._s0,this._s1,this._s2),n=i===at.CLOCKWISE&&this._side===Ee.LEFT||i===at.COUNTERCLOCKWISE&&this._side===Ee.RIGHT;0===i?this.addCollinear(e):n?this.addOutsideTurn(i,e):this.addInsideTurn(i,e)},Pi.prototype.addLineEndCap=function(t,e){var i=new di(t,e),n=new di;this.computeOffsetSegment(i,Ee.LEFT,this._distance,n);var r=new di;this.computeOffsetSegment(i,Ee.RIGHT,this._distance,r);var o=e.x-t.x,s=e.y-t.y,a=Math.atan2(s,o);switch(this._bufParams.getEndCapStyle()){case Bi.CAP_ROUND:this._segList.addPt(n.p1),this.addFilletArc(e,a+Math.PI/2,a-Math.PI/2,at.CLOCKWISE,this._distance),this._segList.addPt(r.p1);break;case Bi.CAP_FLAT:this._segList.addPt(n.p1),this._segList.addPt(r.p1);break;case Bi.CAP_SQUARE:var A=new b;A.x=Math.abs(this._distance)*Math.cos(a),A.y=Math.abs(this._distance)*Math.sin(a);var l=new b(n.p1.x+A.x,n.p1.y+A.y),c=new b(r.p1.x+A.x,r.p1.y+A.y);this._segList.addPt(l),this._segList.addPt(c)}},Pi.prototype.getCoordinates=function(){return this._segList.getCoordinates()},Pi.prototype.addMitreJoin=function(t,e,i,n){var r=!0,o=null;try{o=K.intersection(e.p0,e.p1,i.p0,i.p1),(n<=0?1:o.distance(t)/Math.abs(n))>this._bufParams.getMitreLimit()&&(r=!1)}catch(t){if(!(t instanceof j))throw t;o=new b(0,0),r=!1}r?this._segList.addPt(o):this.addLimitedMitreJoin(e,i,n,this._bufParams.getMitreLimit())},Pi.prototype.addFilletCorner=function(t,e,i,n,r){var o=e.x-t.x,s=e.y-t.y,a=Math.atan2(s,o),A=i.x-t.x,l=i.y-t.y,c=Math.atan2(l,A);n===at.CLOCKWISE?a<=c&&(a+=2*Math.PI):a>=c&&(a-=2*Math.PI),this._segList.addPt(e),this.addFilletArc(t,a,c,n,r),this._segList.addPt(i)},Pi.prototype.addOutsideTurn=function(t,e){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*Pi.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===Bi.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===Bi.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(e&&this._segList.addPt(this._offset0.p1),this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,t,this._distance),this._segList.addPt(this._offset1.p0))},Pi.prototype.createSquare=function(t){this._segList.addPt(new b(t.x+this._distance,t.y+this._distance)),this._segList.addPt(new b(t.x+this._distance,t.y-this._distance)),this._segList.addPt(new b(t.x-this._distance,t.y-this._distance)),this._segList.addPt(new b(t.x-this._distance,t.y+this._distance)),this._segList.closeRing()},Pi.prototype.addSegments=function(t,e){this._segList.addPts(t,e)},Pi.prototype.addFirstSegment=function(){this._segList.addPt(this._offset1.p0)},Pi.prototype.addLastSegment=function(){this._segList.addPt(this._offset1.p1)},Pi.prototype.initSideSegments=function(t,e,i){this._s1=t,this._s2=e,this._side=i,this._seg1.setCoordinates(t,e),this.computeOffsetSegment(this._seg1,i,this._distance,this._offset1)},Pi.prototype.addLimitedMitreJoin=function(t,e,i,n){var r=this._seg0.p1,o=Fi.angle(r,this._seg0.p0),s=Fi.angleBetweenOriented(this._seg0.p0,r,this._seg1.p1)/2,a=Fi.normalize(o+s),A=Fi.normalize(a+Math.PI),l=n*i,c=i-l*Math.abs(Math.sin(s)),u=r.x+l*Math.cos(A),h=r.y+l*Math.sin(A),p=new b(u,h),d=new di(r,p),f=d.pointAlongOffset(1,c),g=d.pointAlongOffset(1,-c);this._side===Ee.LEFT?(this._segList.addPt(f),this._segList.addPt(g)):(this._segList.addPt(g),this._segList.addPt(f))},Pi.prototype.computeOffsetSegment=function(t,e,i,n){var r=e===Ee.LEFT?1:-1,o=t.p1.x-t.p0.x,s=t.p1.y-t.p0.y,a=Math.sqrt(o*o+s*s),A=r*i*o/a,l=r*i*s/a;n.p0.x=t.p0.x-l,n.p0.y=t.p0.y+A,n.p1.x=t.p1.x-l,n.p1.y=t.p1.y+A},Pi.prototype.addFilletArc=function(t,e,i,n,r){var o=n===at.CLOCKWISE?-1:1,s=Math.abs(e-i),a=Math.trunc(s/this._filletAngleQuantum+.5);if(a<1)return null;for(var A=s/a,l=0,c=new b;l<s;){var u=e+o*l;c.x=t.x+r*Math.cos(u),c.y=t.y+r*Math.sin(u),this._segList.addPt(c),l+=A}},Pi.prototype.addInsideTurn=function(t,e){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*Pi.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var i=new b((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(i);var n=new b((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(n)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}},Pi.prototype.createCircle=function(t){var e=new b(t.x+this._distance,t.y);this._segList.addPt(e),this.addFilletArc(t,0,2*Math.PI,-1,this._distance),this._segList.closeRing()},Pi.prototype.addBevelJoin=function(t,e){this._segList.addPt(t.p1),this._segList.addPt(e.p0)},Pi.prototype.init=function(t){this._distance=t,this._maxCurveSegmentError=t*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new xi,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(t*Pi.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)},Pi.prototype.addCollinear=function(t){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2),this._li.getIntersectionNum()>=2&&(this._bufParams.getJoinStyle()===Bi.JOIN_BEVEL||this._bufParams.getJoinStyle()===Bi.JOIN_MITRE?(t&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,at.CLOCKWISE,this._distance))},Pi.prototype.closeRing=function(){this._segList.closeRing()},Pi.prototype.hasNarrowConcaveAngle=function(){return this._hasNarrowConcaveAngle},Pi.prototype.interfaces_=function(){return[]},Pi.prototype.getClass=function(){return Pi},Ti.OFFSET_SEGMENT_SEPARATION_FACTOR.get=function(){return.001},Ti.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return.001},Ti.CURVE_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return 1e-6},Ti.MAX_CLOSING_SEG_LEN_FACTOR.get=function(){return 80},Object.defineProperties(Pi,Ti);var Li=function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var t=arguments[0],e=arguments[1];this._precisionModel=t,this._bufParams=e};Li.prototype.getOffsetCurve=function(t,e){if(this._distance=e,0===e)return null;var i=e<0,n=Math.abs(e),r=this.getSegGen(n);t.length<=1?this.computePointCurve(t[0],r):this.computeOffsetCurve(t,i,r);var o=r.getCoordinates();return i&&St.reverse(o),o},Li.prototype.computeSingleSidedBufferCurve=function(t,e,i){var n=this.simplifyTolerance(this._distance);if(e){i.addSegments(t,!0);var r=Ei.simplify(t,-n),o=r.length-1;i.initSideSegments(r[o],r[o-1],Ee.LEFT),i.addFirstSegment();for(var s=o-2;s>=0;s--)i.addNextSegment(r[s],!0)}else{i.addSegments(t,!1);var a=Ei.simplify(t,n),A=a.length-1;i.initSideSegments(a[0],a[1],Ee.LEFT),i.addFirstSegment();for(var l=2;l<=A;l++)i.addNextSegment(a[l],!0)}i.addLastSegment(),i.closeRing()},Li.prototype.computeRingBufferCurve=function(t,e,i){var n=this.simplifyTolerance(this._distance);e===Ee.RIGHT&&(n=-n);var r=Ei.simplify(t,n),o=r.length-1;i.initSideSegments(r[o-1],r[0],e);for(var s=1;s<=o;s++){var a=1!==s;i.addNextSegment(r[s],a)}i.closeRing()},Li.prototype.computeLineBufferCurve=function(t,e){var i=this.simplifyTolerance(this._distance),n=Ei.simplify(t,i),r=n.length-1;e.initSideSegments(n[0],n[1],Ee.LEFT);for(var o=2;o<=r;o++)e.addNextSegment(n[o],!0);e.addLastSegment(),e.addLineEndCap(n[r-1],n[r]);var s=Ei.simplify(t,-i),a=s.length-1;e.initSideSegments(s[a],s[a-1],Ee.LEFT);for(var A=a-2;A>=0;A--)e.addNextSegment(s[A],!0);e.addLastSegment(),e.addLineEndCap(s[1],s[0]),e.closeRing()},Li.prototype.computePointCurve=function(t,e){switch(this._bufParams.getEndCapStyle()){case Bi.CAP_ROUND:e.createCircle(t);break;case Bi.CAP_SQUARE:e.createSquare(t)}},Li.prototype.getLineCurve=function(t,e){if(this._distance=e,e<0&&!this._bufParams.isSingleSided())return null;if(0===e)return null;var i=Math.abs(e),n=this.getSegGen(i);if(t.length<=1)this.computePointCurve(t[0],n);else if(this._bufParams.isSingleSided()){var r=e<0;this.computeSingleSidedBufferCurve(t,r,n)}else this.computeLineBufferCurve(t,n);return n.getCoordinates()},Li.prototype.getBufferParameters=function(){return this._bufParams},Li.prototype.simplifyTolerance=function(t){return t*this._bufParams.getSimplifyFactor()},Li.prototype.getRingCurve=function(t,e,i){if(this._distance=i,t.length<=2)return this.getLineCurve(t,i);if(0===i)return Li.copyCoordinates(t);var n=this.getSegGen(i);return this.computeRingBufferCurve(t,e,n),n.getCoordinates()},Li.prototype.computeOffsetCurve=function(t,e,i){var n=this.simplifyTolerance(this._distance);if(e){var r=Ei.simplify(t,-n),o=r.length-1;i.initSideSegments(r[o],r[o-1],Ee.LEFT),i.addFirstSegment();for(var s=o-2;s>=0;s--)i.addNextSegment(r[s],!0)}else{var a=Ei.simplify(t,n),A=a.length-1;i.initSideSegments(a[0],a[1],Ee.LEFT),i.addFirstSegment();for(var l=2;l<=A;l++)i.addNextSegment(a[l],!0)}i.addLastSegment()},Li.prototype.getSegGen=function(t){return new Pi(this._precisionModel,this._bufParams,t)},Li.prototype.interfaces_=function(){return[]},Li.prototype.getClass=function(){return Li},Li.copyCoordinates=function(t){for(var e=new Array(t.length).fill(null),i=0;i<e.length;i++)e[i]=new b(t[i]);return e};var Mi=function(){this._subgraphs=null,this._seg=new di,this._cga=new at;var t=arguments[0];this._subgraphs=t},Ui={DepthSegment:{configurable:!0}};Mi.prototype.findStabbedSegments=function(){if(1===arguments.length){for(var t=arguments[0],e=new Bt,i=this._subgraphs.iterator();i.hasNext();){var n=i.next(),r=n.getEnvelope();t.y<r.getMinY()||t.y>r.getMaxY()||this.findStabbedSegments(t,n.getDirectedEdges(),e)}return e}if(3===arguments.length)if(O(arguments[2],Ct)&&arguments[0]instanceof b&&arguments[1]instanceof Ve){for(var o=arguments[0],s=arguments[1],a=arguments[2],A=s.getEdge().getCoordinates(),l=0;l<A.length-1;l++)if(this._seg.p0=A[l],this._seg.p1=A[l+1],this._seg.p0.y>this._seg.p1.y&&this._seg.reverse(),!(Math.max(this._seg.p0.x,this._seg.p1.x)<o.x||this._seg.isHorizontal()||o.y<this._seg.p0.y||o.y>this._seg.p1.y||at.computeOrientation(this._seg.p0,this._seg.p1,o)===at.RIGHT)){var c=s.getDepth(Ee.LEFT);this._seg.p0.equals(A[l])||(c=s.getDepth(Ee.RIGHT));var u=new Di(this._seg,c);a.add(u)}}else if(O(arguments[2],Ct)&&arguments[0]instanceof b&&O(arguments[1],Ct))for(var h=arguments[0],p=arguments[1],d=arguments[2],f=p.iterator();f.hasNext();){var g=f.next();g.isForward()&&this.findStabbedSegments(h,g,d)}},Mi.prototype.getDepth=function(t){var e=this.findStabbedSegments(t);return 0===e.size()?0:$e.min(e)._leftDepth},Mi.prototype.interfaces_=function(){return[]},Mi.prototype.getClass=function(){return Mi},Ui.DepthSegment.get=function(){return Di},Object.defineProperties(Mi,Ui);var Di=function(){this._upwardSeg=null,this._leftDepth=null;var t=arguments[0],e=arguments[1];this._upwardSeg=new di(t),this._leftDepth=e};Di.prototype.compareTo=function(t){var e=t;if(this._upwardSeg.minX()>=e._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=e._upwardSeg.minX())return-1;var i=this._upwardSeg.orientationIndex(e._upwardSeg);return 0!==i||0!=(i=-1*e._upwardSeg.orientationIndex(this._upwardSeg))?i:this._upwardSeg.compareTo(e._upwardSeg)},Di.prototype.compareX=function(t,e){var i=t.p0.compareTo(e.p0);return 0!==i?i:t.p1.compareTo(e.p1)},Di.prototype.toString=function(){return this._upwardSeg.toString()},Di.prototype.interfaces_=function(){return[w]},Di.prototype.getClass=function(){return Di};var Qi=function(t,e,i){this.p0=t||null,this.p1=e||null,this.p2=i||null};Qi.prototype.area=function(){return Qi.area(this.p0,this.p1,this.p2)},Qi.prototype.signedArea=function(){return Qi.signedArea(this.p0,this.p1,this.p2)},Qi.prototype.interpolateZ=function(t){if(null===t)throw new y("Supplied point is null.");return Qi.interpolateZ(t,this.p0,this.p1,this.p2)},Qi.prototype.longestSideLength=function(){return Qi.longestSideLength(this.p0,this.p1,this.p2)},Qi.prototype.isAcute=function(){return Qi.isAcute(this.p0,this.p1,this.p2)},Qi.prototype.circumcentre=function(){return Qi.circumcentre(this.p0,this.p1,this.p2)},Qi.prototype.area3D=function(){return Qi.area3D(this.p0,this.p1,this.p2)},Qi.prototype.centroid=function(){return Qi.centroid(this.p0,this.p1,this.p2)},Qi.prototype.inCentre=function(){return Qi.inCentre(this.p0,this.p1,this.p2)},Qi.prototype.interfaces_=function(){return[]},Qi.prototype.getClass=function(){return Qi},Qi.area=function(t,e,i){return Math.abs(((i.x-t.x)*(e.y-t.y)-(e.x-t.x)*(i.y-t.y))/2)},Qi.signedArea=function(t,e,i){return((i.x-t.x)*(e.y-t.y)-(e.x-t.x)*(i.y-t.y))/2},Qi.det=function(t,e,i,n){return t*n-e*i},Qi.interpolateZ=function(t,e,i,n){var r=e.x,o=e.y,s=i.x-r,a=n.x-r,A=i.y-o,l=n.y-o,c=s*l-a*A,u=t.x-r,h=t.y-o,p=(l*u-a*h)/c,d=(-A*u+s*h)/c;return e.z+p*(i.z-e.z)+d*(n.z-e.z)},Qi.longestSideLength=function(t,e,i){var n=t.distance(e),r=e.distance(i),o=i.distance(t),s=n;return r>s&&(s=r),o>s&&(s=o),s},Qi.isAcute=function(t,e,i){return!!Fi.isAcute(t,e,i)&&!!Fi.isAcute(e,i,t)&&!!Fi.isAcute(i,t,e)},Qi.circumcentre=function(t,e,i){var n=i.x,r=i.y,o=t.x-n,s=t.y-r,a=e.x-n,A=e.y-r,l=2*Qi.det(o,s,a,A),c=Qi.det(s,o*o+s*s,A,a*a+A*A),u=Qi.det(o,o*o+s*s,a,a*a+A*A);return new b(n-c/l,r+u/l)},Qi.perpendicularBisector=function(t,e){var i=e.x-t.x,n=e.y-t.y,r=new K(t.x+i/2,t.y+n/2,1),o=new K(t.x-n+i/2,t.y+i+n/2,1);return new K(r,o)},Qi.angleBisector=function(t,e,i){var n=e.distance(t),r=n/(n+e.distance(i)),o=i.x-t.x,s=i.y-t.y;return new b(t.x+r*o,t.y+r*s)},Qi.area3D=function(t,e,i){var n=e.x-t.x,r=e.y-t.y,o=e.z-t.z,s=i.x-t.x,a=i.y-t.y,A=i.z-t.z,l=r*A-o*a,c=o*s-n*A,u=n*a-r*s,h=l*l+c*c+u*u;return Math.sqrt(h)/2},Qi.centroid=function(t,e,i){var n=(t.x+e.x+i.x)/3,r=(t.y+e.y+i.y)/3;return new b(n,r)},Qi.inCentre=function(t,e,i){var n=e.distance(i),r=t.distance(i),o=t.distance(e),s=n+r+o,a=(n*t.x+r*e.x+o*i.x)/s,A=(n*t.y+r*e.y+o*i.y)/s;return new b(a,A)};var Ri=function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new Bt;var t=arguments[0],e=arguments[1],i=arguments[2];this._inputGeom=t,this._distance=e,this._curveBuilder=i};Ri.prototype.addPoint=function(t){if(this._distance<=0)return null;var e=t.getCoordinates(),i=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(i,I.EXTERIOR,I.INTERIOR)},Ri.prototype.addPolygon=function(t){var e=this._distance,i=Ee.LEFT;this._distance<0&&(e=-this._distance,i=Ee.RIGHT);var n=t.getExteriorRing(),r=St.removeRepeatedPoints(n.getCoordinates());if(this._distance<0&&this.isErodedCompletely(n,this._distance))return null;if(this._distance<=0&&r.length<3)return null;this.addPolygonRing(r,e,i,I.EXTERIOR,I.INTERIOR);for(var o=0;o<t.getNumInteriorRing();o++){var s=t.getInteriorRingN(o),a=St.removeRepeatedPoints(s.getCoordinates());this._distance>0&&this.isErodedCompletely(s,-this._distance)||this.addPolygonRing(a,e,Ee.opposite(i),I.INTERIOR,I.EXTERIOR)}},Ri.prototype.isTriangleErodedCompletely=function(t,e){var i=new Qi(t[0],t[1],t[2]),n=i.inCentre();return at.distancePointLine(n,i.p0,i.p1)<Math.abs(e)},Ri.prototype.addLineString=function(t){if(this._distance<=0&&!this._curveBuilder.getBufferParameters().isSingleSided())return null;var e=St.removeRepeatedPoints(t.getCoordinates()),i=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(i,I.EXTERIOR,I.INTERIOR)},Ri.prototype.addCurve=function(t,e,i){if(null===t||t.length<2)return null;var n=new pi(t,new Te(0,I.BOUNDARY,e,i));this._curveList.add(n)},Ri.prototype.getCurves=function(){return this.add(this._inputGeom),this._curveList},Ri.prototype.addPolygonRing=function(t,e,i,n,r){if(0===e&&t.length<ee.MINIMUM_VALID_SIZE)return null;var o=n,s=r;t.length>=ee.MINIMUM_VALID_SIZE&&at.isCCW(t)&&(o=r,s=n,i=Ee.opposite(i));var a=this._curveBuilder.getRingCurve(t,i,e);this.addCurve(a,o,s)},Ri.prototype.add=function(t){if(t.isEmpty())return null;t instanceof $t?this.addPolygon(t):t instanceof Xt?this.addLineString(t):t instanceof Jt?this.addPoint(t):(t instanceof te||t instanceof jt||t instanceof ie||t instanceof Vt)&&this.addCollection(t)},Ri.prototype.isErodedCompletely=function(t,e){var i=t.getCoordinates();if(i.length<4)return e<0;if(4===i.length)return this.isTriangleErodedCompletely(i,e);var n=t.getEnvelopeInternal(),r=Math.min(n.getHeight(),n.getWidth());return e<0&&2*Math.abs(e)>r},Ri.prototype.addCollection=function(t){for(var e=0;e<t.getNumGeometries();e++){var i=t.getGeometryN(e);this.add(i)}},Ri.prototype.interfaces_=function(){return[]},Ri.prototype.getClass=function(){return Ri};var Ni=function(){};Ni.prototype.locate=function(t){},Ni.prototype.interfaces_=function(){return[]},Ni.prototype.getClass=function(){return Ni};var Hi=function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var t=arguments[0];this._parent=t,this._atStart=!0,this._index=0,this._max=t.getNumGeometries()};Hi.prototype.next=function(){if(this._atStart)return this._atStart=!1,Hi.isAtomic(this._parent)&&this._index++,this._parent;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new n;var t=this._parent.getGeometryN(this._index++);return t instanceof Vt?(this._subcollectionIterator=new Hi(t),this._subcollectionIterator.next()):t},Hi.prototype.remove=function(){throw new Error(this.getClass().getName())},Hi.prototype.hasNext=function(){if(this._atStart)return!0;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)},Hi.prototype.interfaces_=function(){return[wt]},Hi.prototype.getClass=function(){return Hi},Hi.isAtomic=function(t){return!(t instanceof Vt)};var ki=function(){this._geom=null;var t=arguments[0];this._geom=t};ki.prototype.locate=function(t){return ki.locate(t,this._geom)},ki.prototype.interfaces_=function(){return[Ni]},ki.prototype.getClass=function(){return ki},ki.isPointInRing=function(t,e){return!!e.getEnvelopeInternal().intersects(t)&&at.isPointInRing(t,e.getCoordinates())},ki.containsPointInPolygon=function(t,e){if(e.isEmpty())return!1;var i=e.getExteriorRing();if(!ki.isPointInRing(t,i))return!1;for(var n=0;n<e.getNumInteriorRing();n++){var r=e.getInteriorRingN(n);if(ki.isPointInRing(t,r))return!1}return!0},ki.containsPoint=function(t,e){if(e instanceof $t)return ki.containsPointInPolygon(t,e);if(e instanceof Vt)for(var i=new Hi(e);i.hasNext();){var n=i.next();if(n!==e&&ki.containsPoint(t,n))return!0}return!1},ki.locate=function(t,e){return e.isEmpty()?I.EXTERIOR:ki.containsPoint(t,e)?I.INTERIOR:I.EXTERIOR};var Vi=function(){this._edgeMap=new u,this._edgeList=null,this._ptInAreaLocation=[I.NONE,I.NONE]};Vi.prototype.getNextCW=function(t){this.getEdges();var e=this._edgeList.indexOf(t),i=e-1;return 0===e&&(i=this._edgeList.size()-1),this._edgeList.get(i)},Vi.prototype.propagateSideLabels=function(t){for(var e=I.NONE,i=this.iterator();i.hasNext();){var n=i.next().getLabel();n.isArea(t)&&n.getLocation(t,Ee.LEFT)!==I.NONE&&(e=n.getLocation(t,Ee.LEFT))}if(e===I.NONE)return null;for(var r=e,o=this.iterator();o.hasNext();){var s=o.next(),a=s.getLabel();if(a.getLocation(t,Ee.ON)===I.NONE&&a.setLocation(t,Ee.ON,r),a.isArea(t)){var A=a.getLocation(t,Ee.LEFT),l=a.getLocation(t,Ee.RIGHT);if(l!==I.NONE){if(l!==r)throw new Ie("side location conflict",s.getCoordinate());A===I.NONE&&et.shouldNeverReachHere("found single null side (at "+s.getCoordinate()+")"),r=A}else et.isTrue(a.getLocation(t,Ee.LEFT)===I.NONE,"found single null side"),a.setLocation(t,Ee.RIGHT,r),a.setLocation(t,Ee.LEFT,r)}}},Vi.prototype.getCoordinate=function(){var t=this.iterator();return t.hasNext()?t.next().getCoordinate():null},Vi.prototype.print=function(t){G.out.println("EdgeEndStar:   "+this.getCoordinate());for(var e=this.iterator();e.hasNext();)e.next().print(t)},Vi.prototype.isAreaLabelsConsistent=function(t){return this.computeEdgeEndLabels(t.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)},Vi.prototype.checkAreaLabelsConsistent=function(t){var e=this.getEdges();if(e.size()<=0)return!0;var i=e.size()-1,n=e.get(i).getLabel().getLocation(t,Ee.LEFT);et.isTrue(n!==I.NONE,"Found unlabelled area edge");for(var r=n,o=this.iterator();o.hasNext();){var s=o.next().getLabel();et.isTrue(s.isArea(t),"Found non-area edge");var a=s.getLocation(t,Ee.LEFT),A=s.getLocation(t,Ee.RIGHT);if(a===A)return!1;if(A!==r)return!1;r=a}return!0},Vi.prototype.findIndex=function(t){this.iterator();for(var e=0;e<this._edgeList.size();e++)if(this._edgeList.get(e)===t)return e;return-1},Vi.prototype.iterator=function(){return this.getEdges().iterator()},Vi.prototype.getEdges=function(){return null===this._edgeList&&(this._edgeList=new Bt(this._edgeMap.values())),this._edgeList},Vi.prototype.getLocation=function(t,e,i){return this._ptInAreaLocation[t]===I.NONE&&(this._ptInAreaLocation[t]=ki.locate(e,i[t].getGeometry())),this._ptInAreaLocation[t]},Vi.prototype.toString=function(){var t=new L;t.append("EdgeEndStar:   "+this.getCoordinate()),t.append("\n");for(var e=this.iterator();e.hasNext();){var i=e.next();t.append(i),t.append("\n")}return t.toString()},Vi.prototype.computeEdgeEndLabels=function(t){for(var e=this.iterator();e.hasNext();)e.next().computeLabel(t)},Vi.prototype.computeLabelling=function(t){this.computeEdgeEndLabels(t[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var e=[!1,!1],i=this.iterator();i.hasNext();)for(var n=i.next().getLabel(),r=0;r<2;r++)n.isLine(r)&&n.getLocation(r)===I.BOUNDARY&&(e[r]=!0);for(var o=this.iterator();o.hasNext();)for(var s=o.next(),a=s.getLabel(),A=0;A<2;A++)if(a.isAnyNull(A)){var l=I.NONE;if(e[A])l=I.EXTERIOR;else{var c=s.getCoordinate();l=this.getLocation(A,c,t)}a.setAllLocationsIfNull(A,l)}},Vi.prototype.getDegree=function(){return this._edgeMap.size()},Vi.prototype.insertEdgeEnd=function(t,e){this._edgeMap.put(t,e),this._edgeList=null},Vi.prototype.interfaces_=function(){return[]},Vi.prototype.getClass=function(){return Vi};var ji=function(t){function e(){t.call(this),this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.linkResultDirectedEdges=function(){this.getResultAreaEdges();for(var t=null,e=null,i=this._SCANNING_FOR_INCOMING,n=0;n<this._resultAreaEdgeList.size();n++){var r=this._resultAreaEdgeList.get(n),o=r.getSym();if(r.getLabel().isArea())switch(null===t&&r.isInResult()&&(t=r),i){case this._SCANNING_FOR_INCOMING:if(!o.isInResult())continue;e=o,i=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(!r.isInResult())continue;e.setNext(r),i=this._SCANNING_FOR_INCOMING}}if(i===this._LINKING_TO_OUTGOING){if(null===t)throw new Ie("no outgoing dirEdge found",this.getCoordinate());et.isTrue(t.isInResult(),"unable to link last incoming dirEdge"),e.setNext(t)}},e.prototype.insert=function(t){var e=t;this.insertEdgeEnd(e,e)},e.prototype.getRightmostEdge=function(){var t=this.getEdges(),e=t.size();if(e<1)return null;var i=t.get(0);if(1===e)return i;var n=t.get(e-1),r=i.getQuadrant(),o=n.getQuadrant();return Ne.isNorthern(r)&&Ne.isNorthern(o)?i:Ne.isNorthern(r)||Ne.isNorthern(o)?0!==i.getDy()?i:0!==n.getDy()?n:(et.shouldNeverReachHere("found two horizontal edges incident on node"),null):n},e.prototype.print=function(t){G.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var e=this.iterator();e.hasNext();){var i=e.next();t.print("out "),i.print(t),t.println(),t.print("in "),i.getSym().print(t),t.println()}},e.prototype.getResultAreaEdges=function(){if(null!==this._resultAreaEdgeList)return this._resultAreaEdgeList;this._resultAreaEdgeList=new Bt;for(var t=this.iterator();t.hasNext();){var e=t.next();(e.isInResult()||e.getSym().isInResult())&&this._resultAreaEdgeList.add(e)}return this._resultAreaEdgeList},e.prototype.updateLabelling=function(t){for(var e=this.iterator();e.hasNext();){var i=e.next().getLabel();i.setAllLocationsIfNull(0,t.getLocation(0)),i.setAllLocationsIfNull(1,t.getLocation(1))}},e.prototype.linkAllDirectedEdges=function(){this.getEdges();for(var t=null,e=null,i=this._edgeList.size()-1;i>=0;i--){var n=this._edgeList.get(i),r=n.getSym();null===e&&(e=r),null!==t&&r.setNext(t),t=n}e.setNext(t)},e.prototype.computeDepths=function(){if(1===arguments.length){var t=arguments[0],e=this.findIndex(t),i=t.getDepth(Ee.LEFT),n=t.getDepth(Ee.RIGHT),r=this.computeDepths(e+1,this._edgeList.size(),i);if(this.computeDepths(0,e,r)!==n)throw new Ie("depth mismatch at "+t.getCoordinate())}else if(3===arguments.length){for(var o=arguments[0],s=arguments[1],a=arguments[2],A=o;A<s;A++){var l=this._edgeList.get(A);l.setEdgeDepths(Ee.RIGHT,a),a=l.getDepth(Ee.LEFT)}return a}},e.prototype.mergeSymLabels=function(){for(var t=this.iterator();t.hasNext();){var e=t.next();e.getLabel().merge(e.getSym().getLabel())}},e.prototype.linkMinimalDirectedEdges=function(t){for(var e=null,i=null,n=this._SCANNING_FOR_INCOMING,r=this._resultAreaEdgeList.size()-1;r>=0;r--){var o=this._resultAreaEdgeList.get(r),s=o.getSym();switch(null===e&&o.getEdgeRing()===t&&(e=o),n){case this._SCANNING_FOR_INCOMING:if(s.getEdgeRing()!==t)continue;i=s,n=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(o.getEdgeRing()!==t)continue;i.setNextMin(o),n=this._SCANNING_FOR_INCOMING}}n===this._LINKING_TO_OUTGOING&&(et.isTrue(null!==e,"found null for first outgoing dirEdge"),et.isTrue(e.getEdgeRing()===t,"unable to link last incoming dirEdge"),i.setNextMin(e))},e.prototype.getOutgoingDegree=function(){if(0===arguments.length){for(var t=0,e=this.iterator();e.hasNext();)e.next().isInResult()&&t++;return t}if(1===arguments.length){for(var i=arguments[0],n=0,r=this.iterator();r.hasNext();)r.next().getEdgeRing()===i&&n++;return n}},e.prototype.getLabel=function(){return this._label},e.prototype.findCoveredLineEdges=function(){for(var t=I.NONE,e=this.iterator();e.hasNext();){var i=e.next(),n=i.getSym();if(!i.isLineEdge()){if(i.isInResult()){t=I.INTERIOR;break}if(n.isInResult()){t=I.EXTERIOR;break}}}if(t===I.NONE)return null;for(var r=t,o=this.iterator();o.hasNext();){var s=o.next(),a=s.getSym();s.isLineEdge()?s.getEdge().setCovered(r===I.INTERIOR):(s.isInResult()&&(r=I.EXTERIOR),a.isInResult()&&(r=I.INTERIOR))}},e.prototype.computeLabelling=function(e){t.prototype.computeLabelling.call(this,e),this._label=new Te(I.NONE);for(var i=this.iterator();i.hasNext();)for(var n=i.next().getEdge().getLabel(),r=0;r<2;r++){var o=n.getLocation(r);o!==I.INTERIOR&&o!==I.BOUNDARY||this._label.setLocation(r,I.INTERIOR)}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Vi),Gi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createNode=function(t){return new Qe(t,new ji)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(je),Ki=function t(){this._pts=null,this._orientation=null;var e=arguments[0];this._pts=e,this._orientation=t.orientation(e)};Ki.prototype.compareTo=function(t){var e=t;return Ki.compareOriented(this._pts,this._orientation,e._pts,e._orientation)},Ki.prototype.interfaces_=function(){return[w]},Ki.prototype.getClass=function(){return Ki},Ki.orientation=function(t){return 1===St.increasingDirection(t)},Ki.compareOriented=function(t,e,i,n){for(var r=e?1:-1,o=n?1:-1,s=e?t.length:-1,a=n?i.length:-1,A=e?0:t.length-1,l=n?0:i.length-1;;){var c=t[A].compareTo(i[l]);if(0!==c)return c;var u=(A+=r)===s,h=(l+=o)===a;if(u&&!h)return-1;if(!u&&h)return 1;if(u&&h)return 0}};var zi=function(){this._edges=new Bt,this._ocaMap=new u};zi.prototype.print=function(t){t.print("MULTILINESTRING ( ");for(var e=0;e<this._edges.size();e++){var i=this._edges.get(e);e>0&&t.print(","),t.print("(");for(var n=i.getCoordinates(),r=0;r<n.length;r++)r>0&&t.print(","),t.print(n[r].x+" "+n[r].y);t.println(")")}t.print(")  ")},zi.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next())},zi.prototype.findEdgeIndex=function(t){for(var e=0;e<this._edges.size();e++)if(this._edges.get(e).equals(t))return e;return-1},zi.prototype.iterator=function(){return this._edges.iterator()},zi.prototype.getEdges=function(){return this._edges},zi.prototype.get=function(t){return this._edges.get(t)},zi.prototype.findEqualEdge=function(t){var e=new Ki(t.getCoordinates());return this._ocaMap.get(e)},zi.prototype.add=function(t){this._edges.add(t);var e=new Ki(t.getCoordinates());this._ocaMap.put(e,t)},zi.prototype.interfaces_=function(){return[]},zi.prototype.getClass=function(){return zi};var Wi=function(){};Wi.prototype.processIntersections=function(t,e,i,n){},Wi.prototype.isDone=function(){},Wi.prototype.interfaces_=function(){return[]},Wi.prototype.getClass=function(){return Wi};var qi=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var t=arguments[0];this._li=t};qi.prototype.isTrivialIntersection=function(t,e,i,n){if(t===i&&1===this._li.getIntersectionNum()){if(qi.isAdjacentSegments(e,n))return!0;if(t.isClosed()){var r=t.size()-1;if(0===e&&n===r||0===n&&e===r)return!0}}return!1},qi.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},qi.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},qi.prototype.getLineIntersector=function(){return this._li},qi.prototype.hasProperIntersection=function(){return this._hasProper},qi.prototype.processIntersections=function(t,e,i,n){if(t===i&&e===n)return null;this.numTests++;var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=i.getCoordinates()[n],a=i.getCoordinates()[n+1];this._li.computeIntersection(r,o,s,a),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(t,e,i,n)||(this._hasIntersection=!0,t.addIntersections(this._li,e,0),i.addIntersections(this._li,n,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))},qi.prototype.hasIntersection=function(){return this._hasIntersection},qi.prototype.isDone=function(){return!1},qi.prototype.hasInteriorIntersection=function(){return this._hasInterior},qi.prototype.interfaces_=function(){return[Wi]},qi.prototype.getClass=function(){return qi},qi.isAdjacentSegments=function(t,e){return 1===Math.abs(t-e)};var Xi=function(){this.coord=null,this.segmentIndex=null,this.dist=null;var t=arguments[0],e=arguments[1],i=arguments[2];this.coord=new b(t),this.segmentIndex=e,this.dist=i};Xi.prototype.getSegmentIndex=function(){return this.segmentIndex},Xi.prototype.getCoordinate=function(){return this.coord},Xi.prototype.print=function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex),t.println(" dist = "+this.dist)},Xi.prototype.compareTo=function(t){var e=t;return this.compare(e.segmentIndex,e.dist)},Xi.prototype.isEndPoint=function(t){return 0===this.segmentIndex&&0===this.dist||this.segmentIndex===t},Xi.prototype.toString=function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist},Xi.prototype.getDistance=function(){return this.dist},Xi.prototype.compare=function(t,e){return this.segmentIndex<t?-1:this.segmentIndex>t?1:this.dist<e?-1:this.dist>e?1:0},Xi.prototype.interfaces_=function(){return[w]},Xi.prototype.getClass=function(){return Xi};var Yi=function(){this._nodeMap=new u,this.edge=null;var t=arguments[0];this.edge=t};Yi.prototype.print=function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();)e.next().print(t)},Yi.prototype.iterator=function(){return this._nodeMap.values().iterator()},Yi.prototype.addSplitEdges=function(t){this.addEndpoints();for(var e=this.iterator(),i=e.next();e.hasNext();){var n=e.next(),r=this.createSplitEdge(i,n);t.add(r),i=n}},Yi.prototype.addEndpoints=function(){var t=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[t],t,0)},Yi.prototype.createSplitEdge=function(t,e){var i=e.segmentIndex-t.segmentIndex+2,n=this.edge.pts[e.segmentIndex],r=e.dist>0||!e.coord.equals2D(n);r||i--;var o=new Array(i).fill(null),s=0;o[s++]=new b(t.coord);for(var a=t.segmentIndex+1;a<=e.segmentIndex;a++)o[s++]=this.edge.pts[a];return r&&(o[s]=e.coord),new en(o,new Te(this.edge._label))},Yi.prototype.add=function(t,e,i){var n=new Xi(t,e,i),r=this._nodeMap.get(n);return null!==r?r:(this._nodeMap.put(n,n),n)},Yi.prototype.isIntersection=function(t){for(var e=this.iterator();e.hasNext();)if(e.next().coord.equals(t))return!0;return!1},Yi.prototype.interfaces_=function(){return[]},Yi.prototype.getClass=function(){return Yi};var Ji=function(){};Ji.prototype.getChainStartIndices=function(t){var e=0,i=new Bt;i.add(new M(e));do{var n=this.findChainEnd(t,e);i.add(new M(n)),e=n}while(e<t.length-1);return Ji.toIntArray(i)},Ji.prototype.findChainEnd=function(t,e){for(var i=Ne.quadrant(t[e],t[e+1]),n=e+1;n<t.length&&Ne.quadrant(t[n-1],t[n])===i;)n++;return n-1},Ji.prototype.interfaces_=function(){return[]},Ji.prototype.getClass=function(){return Ji},Ji.toIntArray=function(t){for(var e=new Array(t.size()).fill(null),i=0;i<e.length;i++)e[i]=t.get(i).intValue();return e};var Zi=function(){this.e=null,this.pts=null,this.startIndex=null,this.env1=new z,this.env2=new z;var t=arguments[0];this.e=t,this.pts=t.getCoordinates();var e=new Ji;this.startIndex=e.getChainStartIndices(this.pts)};Zi.prototype.getCoordinates=function(){return this.pts},Zi.prototype.getMaxX=function(t){var e=this.pts[this.startIndex[t]].x,i=this.pts[this.startIndex[t+1]].x;return e>i?e:i},Zi.prototype.getMinX=function(t){var e=this.pts[this.startIndex[t]].x,i=this.pts[this.startIndex[t+1]].x;return e<i?e:i},Zi.prototype.computeIntersectsForChain=function(){if(4===arguments.length){var t=arguments[0],e=arguments[1],i=arguments[2],n=arguments[3];this.computeIntersectsForChain(this.startIndex[t],this.startIndex[t+1],e,e.startIndex[i],e.startIndex[i+1],n)}else if(6===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3],A=arguments[4],l=arguments[5],c=this.pts[r],u=this.pts[o],h=s.pts[a],p=s.pts[A];if(o-r==1&&A-a==1)return l.addIntersections(this.e,r,s.e,a),null;if(this.env1.init(c,u),this.env2.init(h,p),!this.env1.intersects(this.env2))return null;var d=Math.trunc((r+o)/2),f=Math.trunc((a+A)/2);r<d&&(a<f&&this.computeIntersectsForChain(r,d,s,a,f,l),f<A&&this.computeIntersectsForChain(r,d,s,f,A,l)),d<o&&(a<f&&this.computeIntersectsForChain(d,o,s,a,f,l),f<A&&this.computeIntersectsForChain(d,o,s,f,A,l))}},Zi.prototype.getStartIndexes=function(){return this.startIndex},Zi.prototype.computeIntersects=function(t,e){for(var i=0;i<this.startIndex.length-1;i++)for(var n=0;n<t.startIndex.length-1;n++)this.computeIntersectsForChain(i,t,n,e)},Zi.prototype.interfaces_=function(){return[]},Zi.prototype.getClass=function(){return Zi};var $i=function t(){this._depth=Array(2).fill().map((function(){return Array(3)}));for(var e=0;e<2;e++)for(var i=0;i<3;i++)this._depth[e][i]=t.NULL_VALUE},tn={NULL_VALUE:{configurable:!0}};$i.prototype.getDepth=function(t,e){return this._depth[t][e]},$i.prototype.setDepth=function(t,e,i){this._depth[t][e]=i},$i.prototype.isNull=function(){if(0===arguments.length){for(var t=0;t<2;t++)for(var e=0;e<3;e++)if(this._depth[t][e]!==$i.NULL_VALUE)return!1;return!0}if(1===arguments.length){var i=arguments[0];return this._depth[i][1]===$i.NULL_VALUE}if(2===arguments.length){var n=arguments[0],r=arguments[1];return this._depth[n][r]===$i.NULL_VALUE}},$i.prototype.normalize=function(){for(var t=0;t<2;t++)if(!this.isNull(t)){var e=this._depth[t][1];this._depth[t][2]<e&&(e=this._depth[t][2]),e<0&&(e=0);for(var i=1;i<3;i++){var n=0;this._depth[t][i]>e&&(n=1),this._depth[t][i]=n}}},$i.prototype.getDelta=function(t){return this._depth[t][Ee.RIGHT]-this._depth[t][Ee.LEFT]},$i.prototype.getLocation=function(t,e){return this._depth[t][e]<=0?I.EXTERIOR:I.INTERIOR},$i.prototype.toString=function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]},$i.prototype.add=function(){if(1===arguments.length)for(var t=arguments[0],e=0;e<2;e++)for(var i=1;i<3;i++){var n=t.getLocation(e,i);n!==I.EXTERIOR&&n!==I.INTERIOR||(this.isNull(e,i)?this._depth[e][i]=$i.depthAtLocation(n):this._depth[e][i]+=$i.depthAtLocation(n))}else if(3===arguments.length){var r=arguments[0],o=arguments[1];arguments[2]===I.INTERIOR&&this._depth[r][o]++}},$i.prototype.interfaces_=function(){return[]},$i.prototype.getClass=function(){return $i},$i.depthAtLocation=function(t){return t===I.EXTERIOR?0:t===I.INTERIOR?1:$i.NULL_VALUE},tn.NULL_VALUE.get=function(){return-1},Object.defineProperties($i,tn);var en=function(t){function e(){if(t.call(this),this.pts=null,this._env=null,this.eiList=new Yi(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new $i,this._depthDelta=0,1===arguments.length){var i=arguments[0];e.call(this,i,null)}else if(2===arguments.length){var n=arguments[0],r=arguments[1];this.pts=n,this._label=r}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDepth=function(){return this._depth},e.prototype.getCollapsedEdge=function(){var t=new Array(2).fill(null);return t[0]=this.pts[0],t[1]=this.pts[1],new e(t,Te.toLineLabel(this._label))},e.prototype.isIsolated=function(){return this._isIsolated},e.prototype.getCoordinates=function(){return this.pts},e.prototype.setIsolated=function(t){this._isIsolated=t},e.prototype.setName=function(t){this._name=t},e.prototype.equals=function(t){if(!(t instanceof e))return!1;var i=t;if(this.pts.length!==i.pts.length)return!1;for(var n=!0,r=!0,o=this.pts.length,s=0;s<this.pts.length;s++)if(this.pts[s].equals2D(i.pts[s])||(n=!1),this.pts[s].equals2D(i.pts[--o])||(r=!1),!n&&!r)return!1;return!0},e.prototype.getCoordinate=function(){if(0===arguments.length)return this.pts.length>0?this.pts[0]:null;if(1===arguments.length){var t=arguments[0];return this.pts[t]}},e.prototype.print=function(t){t.print("edge "+this._name+": "),t.print("LINESTRING (");for(var e=0;e<this.pts.length;e++)e>0&&t.print(","),t.print(this.pts[e].x+" "+this.pts[e].y);t.print(")  "+this._label+" "+this._depthDelta)},e.prototype.computeIM=function(t){e.updateIM(this._label,t)},e.prototype.isCollapsed=function(){return!!this._label.isArea()&&3===this.pts.length&&!!this.pts[0].equals(this.pts[2])},e.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1])},e.prototype.getMaximumSegmentIndex=function(){return this.pts.length-1},e.prototype.getDepthDelta=function(){return this._depthDelta},e.prototype.getNumPoints=function(){return this.pts.length},e.prototype.printReverse=function(t){t.print("edge "+this._name+": ");for(var e=this.pts.length-1;e>=0;e--)t.print(this.pts[e]+" ");t.println("")},e.prototype.getMonotoneChainEdge=function(){return null===this._mce&&(this._mce=new Zi(this)),this._mce},e.prototype.getEnvelope=function(){if(null===this._env){this._env=new z;for(var t=0;t<this.pts.length;t++)this._env.expandToInclude(this.pts[t])}return this._env},e.prototype.addIntersection=function(t,e,i,n){var r=new b(t.getIntersection(n)),o=e,s=t.getEdgeDistance(i,n),a=o+1;if(a<this.pts.length){var A=this.pts[a];r.equals2D(A)&&(o=a,s=0)}this.eiList.add(r,o,s)},e.prototype.toString=function(){var t=new L;t.append("edge "+this._name+": "),t.append("LINESTRING (");for(var e=0;e<this.pts.length;e++)e>0&&t.append(","),t.append(this.pts[e].x+" "+this.pts[e].y);return t.append(")  "+this._label+" "+this._depthDelta),t.toString()},e.prototype.isPointwiseEqual=function(t){if(this.pts.length!==t.pts.length)return!1;for(var e=0;e<this.pts.length;e++)if(!this.pts[e].equals2D(t.pts[e]))return!1;return!0},e.prototype.setDepthDelta=function(t){this._depthDelta=t},e.prototype.getEdgeIntersectionList=function(){return this.eiList},e.prototype.addIntersections=function(t,e,i){for(var n=0;n<t.getIntersectionNum();n++)this.addIntersection(t,e,i,n)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.updateIM=function(){if(2!==arguments.length)return t.prototype.updateIM.apply(this,arguments);var e=arguments[0],i=arguments[1];i.setAtLeastIfValid(e.getLocation(0,Ee.ON),e.getLocation(1,Ee.ON),1),e.isArea()&&(i.setAtLeastIfValid(e.getLocation(0,Ee.LEFT),e.getLocation(1,Ee.LEFT),2),i.setAtLeastIfValid(e.getLocation(0,Ee.RIGHT),e.getLocation(1,Ee.RIGHT),2))},e}(De),nn=function(t){this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new zi,this._bufParams=t||null};nn.prototype.setWorkingPrecisionModel=function(t){this._workingPrecisionModel=t},nn.prototype.insertUniqueEdge=function(t){var e=this._edgeList.findEqualEdge(t);if(null!==e){var i=e.getLabel(),n=t.getLabel();e.isPointwiseEqual(t)||(n=new Te(t.getLabel())).flip(),i.merge(n);var r=nn.depthDelta(n),o=e.getDepthDelta()+r;e.setDepthDelta(o)}else this._edgeList.add(t),t.setDepthDelta(nn.depthDelta(t.getLabel()))},nn.prototype.buildSubgraphs=function(t,e){for(var i=new Bt,n=t.iterator();n.hasNext();){var r=n.next(),o=r.getRightmostCoordinate(),s=new Mi(i).getDepth(o);r.computeDepth(s),r.findResultEdges(),i.add(r),e.add(r.getDirectedEdges(),r.getNodes())}},nn.prototype.createSubgraphs=function(t){for(var e=new Bt,i=t.getNodes().iterator();i.hasNext();){var n=i.next();if(!n.isVisited()){var r=new Oe;r.create(n),e.add(r)}}return $e.sort(e,$e.reverseOrder()),e},nn.prototype.createEmptyResultGeometry=function(){return this._geomFact.createPolygon()},nn.prototype.getNoder=function(t){if(null!==this._workingNoder)return this._workingNoder;var e=new wi,i=new rt;return i.setPrecisionModel(t),e.setSegmentIntersector(new qi(i)),e},nn.prototype.buffer=function(t,e){var i=this._workingPrecisionModel;null===i&&(i=t.getPrecisionModel()),this._geomFact=t.getFactory();var n=new Li(i,this._bufParams),r=new Ri(t,e,n).getCurves();if(r.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(r,i),this._graph=new Ge(new Gi),this._graph.addEdges(this._edgeList.getEdges());var o=this.createSubgraphs(this._graph),s=new Ke(this._geomFact);this.buildSubgraphs(o,s);var a=s.getPolygons();return a.size()<=0?this.createEmptyResultGeometry():this._geomFact.buildGeometry(a)},nn.prototype.computeNodedEdges=function(t,e){var i=this.getNoder(e);i.computeNodes(t);for(var n=i.getNodedSubstrings().iterator();n.hasNext();){var r=n.next(),o=r.getCoordinates();if(2!==o.length||!o[0].equals2D(o[1])){var s=r.getData(),a=new en(r.getCoordinates(),new Te(s));this.insertUniqueEdge(a)}}},nn.prototype.setNoder=function(t){this._workingNoder=t},nn.prototype.interfaces_=function(){return[]},nn.prototype.getClass=function(){return nn},nn.depthDelta=function(t){var e=t.getLocation(0,Ee.LEFT),i=t.getLocation(0,Ee.RIGHT);return e===I.INTERIOR&&i===I.EXTERIOR?1:e===I.EXTERIOR&&i===I.INTERIOR?-1:0},nn.convertSegStrings=function(t){for(var e=new me,i=new Bt;t.hasNext();){var n=t.next(),r=e.createLineString(n.getCoordinates());i.add(r)}return e.buildGeometry(i)};var rn=function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,2===arguments.length){var t=arguments[0],e=arguments[1];this._noder=t,this._scaleFactor=e,this._offsetX=0,this._offsetY=0,this._isScaled=!this.isIntegerPrecision()}else if(4===arguments.length){var i=arguments[0],n=arguments[1],r=arguments[2],o=arguments[3];this._noder=i,this._scaleFactor=n,this._offsetX=r,this._offsetY=o,this._isScaled=!this.isIntegerPrecision()}};rn.prototype.rescale=function(){if(O(arguments[0],_t))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.rescale(e.getCoordinates())}else if(arguments[0]instanceof Array){for(var i=arguments[0],n=0;n<i.length;n++)i[n].x=i[n].x/this._scaleFactor+this._offsetX,i[n].y=i[n].y/this._scaleFactor+this._offsetY;2===i.length&&i[0].equals2D(i[1])&&G.out.println(i)}},rn.prototype.scale=function(){if(O(arguments[0],_t)){for(var t=arguments[0],e=new Bt,i=t.iterator();i.hasNext();){var n=i.next();e.add(new pi(this.scale(n.getCoordinates()),n.getData()))}return e}if(arguments[0]instanceof Array){for(var r=arguments[0],o=new Array(r.length).fill(null),s=0;s<r.length;s++)o[s]=new b(Math.round((r[s].x-this._offsetX)*this._scaleFactor),Math.round((r[s].y-this._offsetY)*this._scaleFactor),r[s].z);return St.removeRepeatedPoints(o)}},rn.prototype.isIntegerPrecision=function(){return 1===this._scaleFactor},rn.prototype.getNodedSubstrings=function(){var t=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(t),t},rn.prototype.computeNodes=function(t){var e=t;this._isScaled&&(e=this.scale(t)),this._noder.computeNodes(e)},rn.prototype.interfaces_=function(){return[vi]},rn.prototype.getClass=function(){return rn};var on=function(){this._li=new rt,this._segStrings=null;var t=arguments[0];this._segStrings=t},sn={fact:{configurable:!0}};on.prototype.checkEndPtVertexIntersections=function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();){var e=t.next().getCoordinates();this.checkEndPtVertexIntersections(e[0],this._segStrings),this.checkEndPtVertexIntersections(e[e.length-1],this._segStrings)}else if(2===arguments.length)for(var i=arguments[0],n=arguments[1].iterator();n.hasNext();)for(var r=n.next().getCoordinates(),o=1;o<r.length-1;o++)if(r[o].equals(i))throw new $("found endpt/interior pt intersection at index "+o+" :pt "+i)},on.prototype.checkInteriorIntersections=function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();)for(var e=t.next(),i=this._segStrings.iterator();i.hasNext();){var n=i.next();this.checkInteriorIntersections(e,n)}else if(2===arguments.length)for(var r=arguments[0],o=arguments[1],s=r.getCoordinates(),a=o.getCoordinates(),A=0;A<s.length-1;A++)for(var l=0;l<a.length-1;l++)this.checkInteriorIntersections(r,A,o,l);else if(4===arguments.length){var c=arguments[0],u=arguments[1],h=arguments[2],p=arguments[3];if(c===h&&u===p)return null;var d=c.getCoordinates()[u],f=c.getCoordinates()[u+1],g=h.getCoordinates()[p],m=h.getCoordinates()[p+1];if(this._li.computeIntersection(d,f,g,m),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,d,f)||this.hasInteriorIntersection(this._li,g,m)))throw new $("found non-noded intersection at "+d+"-"+f+" and "+g+"-"+m)}},on.prototype.checkValid=function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()},on.prototype.checkCollapses=function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();){var e=t.next();this.checkCollapses(e)}else if(1===arguments.length)for(var i=arguments[0].getCoordinates(),n=0;n<i.length-2;n++)this.checkCollapse(i[n],i[n+1],i[n+2])},on.prototype.hasInteriorIntersection=function(t,e,i){for(var n=0;n<t.getIntersectionNum();n++){var r=t.getIntersection(n);if(!r.equals(e)&&!r.equals(i))return!0}return!1},on.prototype.checkCollapse=function(t,e,i){if(t.equals(i))throw new $("found non-noded collapse at "+on.fact.createLineString([t,e,i]))},on.prototype.interfaces_=function(){return[]},on.prototype.getClass=function(){return on},sn.fact.get=function(){return new me},Object.defineProperties(on,sn);var an=function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var t=arguments[0],e=arguments[1],i=arguments[2];if(this._originalPt=t,this._pt=t,this._scaleFactor=e,this._li=i,e<=0)throw new y("Scale factor must be non-zero");1!==e&&(this._pt=new b(this.scale(t.x),this.scale(t.y)),this._p0Scaled=new b,this._p1Scaled=new b),this.initCorners(this._pt)},An={SAFE_ENV_EXPANSION_FACTOR:{configurable:!0}};an.prototype.intersectsScaled=function(t,e){var i=Math.min(t.x,e.x),n=Math.max(t.x,e.x),r=Math.min(t.y,e.y),o=Math.max(t.y,e.y),s=this._maxx<i||this._minx>n||this._maxy<r||this._miny>o;if(s)return!1;var a=this.intersectsToleranceSquare(t,e);return et.isTrue(!(s&&a),"Found bad envelope test"),a},an.prototype.initCorners=function(t){this._minx=t.x-.5,this._maxx=t.x+.5,this._miny=t.y-.5,this._maxy=t.y+.5,this._corner[0]=new b(this._maxx,this._maxy),this._corner[1]=new b(this._minx,this._maxy),this._corner[2]=new b(this._minx,this._miny),this._corner[3]=new b(this._maxx,this._miny)},an.prototype.intersects=function(t,e){return 1===this._scaleFactor?this.intersectsScaled(t,e):(this.copyScaled(t,this._p0Scaled),this.copyScaled(e,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))},an.prototype.scale=function(t){return Math.round(t*this._scaleFactor)},an.prototype.getCoordinate=function(){return this._originalPt},an.prototype.copyScaled=function(t,e){e.x=this.scale(t.x),e.y=this.scale(t.y)},an.prototype.getSafeEnvelope=function(){if(null===this._safeEnv){var t=an.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new z(this._originalPt.x-t,this._originalPt.x+t,this._originalPt.y-t,this._originalPt.y+t)}return this._safeEnv},an.prototype.intersectsPixelClosure=function(t,e){return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!(this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),this._li.hasIntersection()))))},an.prototype.intersectsToleranceSquare=function(t,e){var i=!1,n=!1;return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!(this._li.isProper()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),this._li.isProper()||(this._li.hasIntersection()&&(i=!0),this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),this._li.isProper()||(this._li.hasIntersection()&&(n=!0),this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),this._li.isProper()||i&&n||t.equals(this._pt)||e.equals(this._pt)))))},an.prototype.addSnappedNode=function(t,e){var i=t.getCoordinate(e),n=t.getCoordinate(e+1);return!!this.intersects(i,n)&&(t.addIntersection(this.getCoordinate(),e),!0)},an.prototype.interfaces_=function(){return[]},an.prototype.getClass=function(){return an},An.SAFE_ENV_EXPANSION_FACTOR.get=function(){return.75},Object.defineProperties(an,An);var ln=function(){this.tempEnv1=new z,this.selectedSegment=new di};ln.prototype.select=function(){if(1===arguments.length);else if(2===arguments.length){var t=arguments[0],e=arguments[1];t.getLineSegment(e,this.selectedSegment),this.select(this.selectedSegment)}},ln.prototype.interfaces_=function(){return[]},ln.prototype.getClass=function(){return ln};var cn=function(){this._index=null;var t=arguments[0];this._index=t},un={HotPixelSnapAction:{configurable:!0}};cn.prototype.snap=function(){if(1===arguments.length){var t=arguments[0];return this.snap(t,null,-1)}if(3===arguments.length){var e=arguments[0],i=arguments[1],n=arguments[2],r=e.getSafeEnvelope(),o=new hn(e,i,n);return this._index.query(r,{interfaces_:function(){return[Xe]},visitItem:function(t){t.select(r,o)}}),o.isNodeAdded()}},cn.prototype.interfaces_=function(){return[]},cn.prototype.getClass=function(){return cn},un.HotPixelSnapAction.get=function(){return hn},Object.defineProperties(cn,un);var hn=function(t){function e(){t.call(this),this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var e=arguments[0],i=arguments[1],n=arguments[2];this._hotPixel=e,this._parentEdge=i,this._hotPixelVertexIndex=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isNodeAdded=function(){return this._isNodeAdded},e.prototype.select=function(){if(2!==arguments.length)return t.prototype.select.apply(this,arguments);var e=arguments[0],i=arguments[1],n=e.getContext();if(null!==this._parentEdge&&n===this._parentEdge&&i===this._hotPixelVertexIndex)return null;this._isNodeAdded=this._hotPixel.addSnappedNode(n,i)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(ln),pn=function(){this._li=null,this._interiorIntersections=null;var t=arguments[0];this._li=t,this._interiorIntersections=new Bt};pn.prototype.processIntersections=function(t,e,i,n){if(t===i&&e===n)return null;var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=i.getCoordinates()[n],a=i.getCoordinates()[n+1];if(this._li.computeIntersection(r,o,s,a),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var A=0;A<this._li.getIntersectionNum();A++)this._interiorIntersections.add(this._li.getIntersection(A));t.addIntersections(this._li,e,0),i.addIntersections(this._li,n,1)}},pn.prototype.isDone=function(){return!1},pn.prototype.getInteriorIntersections=function(){return this._interiorIntersections},pn.prototype.interfaces_=function(){return[Wi]},pn.prototype.getClass=function(){return pn};var dn=function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var t=arguments[0];this._pm=t,this._li=new rt,this._li.setPrecisionModel(t),this._scaleFactor=t.getScale()};dn.prototype.checkCorrectness=function(t){var e=pi.getNodedSubstrings(t),i=new on(e);try{i.checkValid()}catch(t){if(!(t instanceof V))throw t;t.printStackTrace()}},dn.prototype.getNodedSubstrings=function(){return pi.getNodedSubstrings(this._nodedSegStrings)},dn.prototype.snapRound=function(t,e){var i=this.findInteriorIntersections(t,e);this.computeIntersectionSnaps(i),this.computeVertexSnaps(t)},dn.prototype.findInteriorIntersections=function(t,e){var i=new pn(e);return this._noder.setSegmentIntersector(i),this._noder.computeNodes(t),i.getInteriorIntersections()},dn.prototype.computeVertexSnaps=function(){if(O(arguments[0],_t))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.computeVertexSnaps(e)}else if(arguments[0]instanceof pi)for(var i=arguments[0],n=i.getCoordinates(),r=0;r<n.length;r++){var o=new an(n[r],this._scaleFactor,this._li);this._pointSnapper.snap(o,i,r)&&i.addIntersection(n[r],r)}},dn.prototype.computeNodes=function(t){this._nodedSegStrings=t,this._noder=new wi,this._pointSnapper=new cn(this._noder.getIndex()),this.snapRound(t,this._li)},dn.prototype.computeIntersectionSnaps=function(t){for(var e=t.iterator();e.hasNext();){var i=e.next(),n=new an(i,this._scaleFactor,this._li);this._pointSnapper.snap(n)}},dn.prototype.interfaces_=function(){return[vi]},dn.prototype.getClass=function(){return dn};var fn=function(){if(this._argGeom=null,this._distance=null,this._bufParams=new Bi,this._resultGeometry=null,this._saveException=null,1===arguments.length){var t=arguments[0];this._argGeom=t}else if(2===arguments.length){var e=arguments[0],i=arguments[1];this._argGeom=e,this._bufParams=i}},gn={CAP_ROUND:{configurable:!0},CAP_BUTT:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},MAX_PRECISION_DIGITS:{configurable:!0}};fn.prototype.bufferFixedPrecision=function(t){var e=new rn(new dn(new pe(1)),t.getScale()),i=new nn(this._bufParams);i.setWorkingPrecisionModel(t),i.setNoder(e),this._resultGeometry=i.buffer(this._argGeom,this._distance)},fn.prototype.bufferReducedPrecision=function(){var t=this;if(0===arguments.length){for(var e=fn.MAX_PRECISION_DIGITS;e>=0;e--){try{t.bufferReducedPrecision(e)}catch(e){if(!(e instanceof Ie))throw e;t._saveException=e}if(null!==t._resultGeometry)return null}throw this._saveException}if(1===arguments.length){var i=arguments[0],n=fn.precisionScaleFactor(this._argGeom,this._distance,i),r=new pe(n);this.bufferFixedPrecision(r)}},fn.prototype.computeGeometry=function(){if(this.bufferOriginalPrecision(),null!==this._resultGeometry)return null;var t=this._argGeom.getFactory().getPrecisionModel();t.getType()===pe.FIXED?this.bufferFixedPrecision(t):this.bufferReducedPrecision()},fn.prototype.setQuadrantSegments=function(t){this._bufParams.setQuadrantSegments(t)},fn.prototype.bufferOriginalPrecision=function(){try{var t=new nn(this._bufParams);this._resultGeometry=t.buffer(this._argGeom,this._distance)}catch(t){if(!(t instanceof $))throw t;this._saveException=t}},fn.prototype.getResultGeometry=function(t){return this._distance=t,this.computeGeometry(),this._resultGeometry},fn.prototype.setEndCapStyle=function(t){this._bufParams.setEndCapStyle(t)},fn.prototype.interfaces_=function(){return[]},fn.prototype.getClass=function(){return fn},fn.bufferOp=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return new fn(t).getResultGeometry(e)}if(3===arguments.length){if(Number.isInteger(arguments[2])&&arguments[0]instanceof ct&&"number"==typeof arguments[1]){var i=arguments[0],n=arguments[1],r=arguments[2],o=new fn(i);return o.setQuadrantSegments(r),o.getResultGeometry(n)}if(arguments[2]instanceof Bi&&arguments[0]instanceof ct&&"number"==typeof arguments[1]){var s=arguments[0],a=arguments[1],A=arguments[2];return new fn(s,A).getResultGeometry(a)}}else if(4===arguments.length){var l=arguments[0],c=arguments[1],u=arguments[2],h=arguments[3],p=new fn(l);return p.setQuadrantSegments(u),p.setEndCapStyle(h),p.getResultGeometry(c)}},fn.precisionScaleFactor=function(t,e,i){var n=t.getEnvelopeInternal(),r=P.max(Math.abs(n.getMaxX()),Math.abs(n.getMaxY()),Math.abs(n.getMinX()),Math.abs(n.getMinY()))+2*(e>0?e:0),o=i-Math.trunc(Math.log(r)/Math.log(10)+1);return Math.pow(10,o)},gn.CAP_ROUND.get=function(){return Bi.CAP_ROUND},gn.CAP_BUTT.get=function(){return Bi.CAP_FLAT},gn.CAP_FLAT.get=function(){return Bi.CAP_FLAT},gn.CAP_SQUARE.get=function(){return Bi.CAP_SQUARE},gn.MAX_PRECISION_DIGITS.get=function(){return 12},Object.defineProperties(fn,gn);var mn=function(){this._pt=[new b,new b],this._distance=v.NaN,this._isNull=!0};mn.prototype.getCoordinates=function(){return this._pt},mn.prototype.getCoordinate=function(t){return this._pt[t]},mn.prototype.setMinimum=function(){if(1===arguments.length){var t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],i=arguments[1];if(this._isNull)return this.initialize(e,i),null;var n=e.distance(i);n<this._distance&&this.initialize(e,i,n)}},mn.prototype.initialize=function(){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){var t=arguments[0],e=arguments[1];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(e),this._distance=t.distance(e),this._isNull=!1}else if(3===arguments.length){var i=arguments[0],n=arguments[1],r=arguments[2];this._pt[0].setCoordinate(i),this._pt[1].setCoordinate(n),this._distance=r,this._isNull=!1}},mn.prototype.getDistance=function(){return this._distance},mn.prototype.setMaximum=function(){if(1===arguments.length){var t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],i=arguments[1];if(this._isNull)return this.initialize(e,i),null;var n=e.distance(i);n>this._distance&&this.initialize(e,i,n)}},mn.prototype.interfaces_=function(){return[]},mn.prototype.getClass=function(){return mn};var yn=function(){};yn.prototype.interfaces_=function(){return[]},yn.prototype.getClass=function(){return yn},yn.computeDistance=function(){if(arguments[2]instanceof mn&&arguments[0]instanceof Xt&&arguments[1]instanceof b)for(var t=arguments[0],e=arguments[1],i=arguments[2],n=t.getCoordinates(),r=new di,o=0;o<n.length-1;o++){r.setCoordinates(n[o],n[o+1]);var s=r.closestPoint(e);i.setMinimum(s,e)}else if(arguments[2]instanceof mn&&arguments[0]instanceof $t&&arguments[1]instanceof b){var a=arguments[0],A=arguments[1],l=arguments[2];yn.computeDistance(a.getExteriorRing(),A,l);for(var c=0;c<a.getNumInteriorRing();c++)yn.computeDistance(a.getInteriorRingN(c),A,l)}else if(arguments[2]instanceof mn&&arguments[0]instanceof ct&&arguments[1]instanceof b){var u=arguments[0],h=arguments[1],p=arguments[2];if(u instanceof Xt)yn.computeDistance(u,h,p);else if(u instanceof $t)yn.computeDistance(u,h,p);else if(u instanceof Vt)for(var d=u,f=0;f<d.getNumGeometries();f++){var g=d.getGeometryN(f);yn.computeDistance(g,h,p)}else p.setMinimum(u.getCoordinate(),h)}else if(arguments[2]instanceof mn&&arguments[0]instanceof di&&arguments[1]instanceof b){var m=arguments[0],y=arguments[1],v=arguments[2],_=m.closestPoint(y);v.setMinimum(_,y)}};var vn=function(t){this._maxPtDist=new mn,this._inputGeom=t||null},_n={MaxPointDistanceFilter:{configurable:!0},MaxMidpointDistanceFilter:{configurable:!0}};vn.prototype.computeMaxMidpointDistance=function(t){var e=new Cn(this._inputGeom);t.apply(e),this._maxPtDist.setMaximum(e.getMaxPointDistance())},vn.prototype.computeMaxVertexDistance=function(t){var e=new wn(this._inputGeom);t.apply(e),this._maxPtDist.setMaximum(e.getMaxPointDistance())},vn.prototype.findDistance=function(t){return this.computeMaxVertexDistance(t),this.computeMaxMidpointDistance(t),this._maxPtDist.getDistance()},vn.prototype.getDistancePoints=function(){return this._maxPtDist},vn.prototype.interfaces_=function(){return[]},vn.prototype.getClass=function(){return vn},_n.MaxPointDistanceFilter.get=function(){return wn},_n.MaxMidpointDistanceFilter.get=function(){return Cn},Object.defineProperties(vn,_n);var wn=function(t){this._maxPtDist=new mn,this._minPtDist=new mn,this._geom=t||null};wn.prototype.filter=function(t){this._minPtDist.initialize(),yn.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},wn.prototype.getMaxPointDistance=function(){return this._maxPtDist},wn.prototype.interfaces_=function(){return[pt]},wn.prototype.getClass=function(){return wn};var Cn=function(t){this._maxPtDist=new mn,this._minPtDist=new mn,this._geom=t||null};Cn.prototype.filter=function(t,e){if(0===e)return null;var i=t.getCoordinate(e-1),n=t.getCoordinate(e),r=new b((i.x+n.x)/2,(i.y+n.y)/2);this._minPtDist.initialize(),yn.computeDistance(this._geom,r,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},Cn.prototype.isDone=function(){return!1},Cn.prototype.isGeometryChanged=function(){return!1},Cn.prototype.getMaxPointDistance=function(){return this._maxPtDist},Cn.prototype.interfaces_=function(){return[kt]},Cn.prototype.getClass=function(){return Cn};var Bn=function(t){this._comps=t||null};Bn.prototype.filter=function(t){t instanceof $t&&this._comps.add(t)},Bn.prototype.interfaces_=function(){return[Ht]},Bn.prototype.getClass=function(){return Bn},Bn.getPolygons=function(){if(1===arguments.length){var t=arguments[0];return Bn.getPolygons(t,new Bt)}if(2===arguments.length){var e=arguments[0],i=arguments[1];return e instanceof $t?i.add(e):e instanceof Vt&&e.apply(new Bn(i)),i}};var bn=function(){if(this._lines=null,this._isForcedToLineString=!1,1===arguments.length){var t=arguments[0];this._lines=t}else if(2===arguments.length){var e=arguments[0],i=arguments[1];this._lines=e,this._isForcedToLineString=i}};bn.prototype.filter=function(t){if(this._isForcedToLineString&&t instanceof ee){var e=t.getFactory().createLineString(t.getCoordinateSequence());return this._lines.add(e),null}t instanceof Xt&&this._lines.add(t)},bn.prototype.setForceToLineString=function(t){this._isForcedToLineString=t},bn.prototype.interfaces_=function(){return[lt]},bn.prototype.getClass=function(){return bn},bn.getGeometry=function(){if(1===arguments.length){var t=arguments[0];return t.getFactory().buildGeometry(bn.getLines(t))}if(2===arguments.length){var e=arguments[0],i=arguments[1];return e.getFactory().buildGeometry(bn.getLines(e,i))}},bn.getLines=function(){if(1===arguments.length){var t=arguments[0];return bn.getLines(t,!1)}if(2===arguments.length){if(O(arguments[0],_t)&&O(arguments[1],_t)){for(var e=arguments[0],i=arguments[1],n=e.iterator();n.hasNext();){var r=n.next();bn.getLines(r,i)}return i}if(arguments[0]instanceof ct&&"boolean"==typeof arguments[1]){var o=arguments[0],s=arguments[1],a=new Bt;return o.apply(new bn(a,s)),a}if(arguments[0]instanceof ct&&O(arguments[1],_t)){var A=arguments[0],l=arguments[1];return A instanceof Xt?l.add(A):A.apply(new bn(l)),l}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&O(arguments[0],_t)&&O(arguments[1],_t)){for(var c=arguments[0],u=arguments[1],h=arguments[2],p=c.iterator();p.hasNext();){var d=p.next();bn.getLines(d,u,h)}return u}if("boolean"==typeof arguments[2]&&arguments[0]instanceof ct&&O(arguments[1],_t)){var f=arguments[0],g=arguments[1],m=arguments[2];return f.apply(new bn(g,m)),g}}};var En=function(){if(this._boundaryRule=dt.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];if(null===t)throw new y("Rule must be non-null");this._boundaryRule=t}};En.prototype.locateInternal=function(){if(arguments[0]instanceof b&&arguments[1]instanceof $t){var t=arguments[0],e=arguments[1];if(e.isEmpty())return I.EXTERIOR;var i=e.getExteriorRing(),n=this.locateInPolygonRing(t,i);if(n===I.EXTERIOR)return I.EXTERIOR;if(n===I.BOUNDARY)return I.BOUNDARY;for(var r=0;r<e.getNumInteriorRing();r++){var o=e.getInteriorRingN(r),s=this.locateInPolygonRing(t,o);if(s===I.INTERIOR)return I.EXTERIOR;if(s===I.BOUNDARY)return I.BOUNDARY}return I.INTERIOR}if(arguments[0]instanceof b&&arguments[1]instanceof Xt){var a=arguments[0],A=arguments[1];if(!A.getEnvelopeInternal().intersects(a))return I.EXTERIOR;var l=A.getCoordinates();return A.isClosed()||!a.equals(l[0])&&!a.equals(l[l.length-1])?at.isOnLine(a,l)?I.INTERIOR:I.EXTERIOR:I.BOUNDARY}if(arguments[0]instanceof b&&arguments[1]instanceof Jt){var c=arguments[0];return arguments[1].getCoordinate().equals2D(c)?I.INTERIOR:I.EXTERIOR}},En.prototype.locateInPolygonRing=function(t,e){return e.getEnvelopeInternal().intersects(t)?at.locatePointInRing(t,e.getCoordinates()):I.EXTERIOR},En.prototype.intersects=function(t,e){return this.locate(t,e)!==I.EXTERIOR},En.prototype.updateLocationInfo=function(t){t===I.INTERIOR&&(this._isIn=!0),t===I.BOUNDARY&&this._numBoundaries++},En.prototype.computeLocation=function(t,e){if(e instanceof Jt&&this.updateLocationInfo(this.locateInternal(t,e)),e instanceof Xt)this.updateLocationInfo(this.locateInternal(t,e));else if(e instanceof $t)this.updateLocationInfo(this.locateInternal(t,e));else if(e instanceof jt)for(var i=e,n=0;n<i.getNumGeometries();n++){var r=i.getGeometryN(n);this.updateLocationInfo(this.locateInternal(t,r))}else if(e instanceof ie)for(var o=e,s=0;s<o.getNumGeometries();s++){var a=o.getGeometryN(s);this.updateLocationInfo(this.locateInternal(t,a))}else if(e instanceof Vt)for(var A=new Hi(e);A.hasNext();){var l=A.next();l!==e&&this.computeLocation(t,l)}},En.prototype.locate=function(t,e){return e.isEmpty()?I.EXTERIOR:e instanceof Xt||e instanceof $t?this.locateInternal(t,e):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(t,e),this._boundaryRule.isInBoundary(this._numBoundaries)?I.BOUNDARY:this._numBoundaries>0||this._isIn?I.INTERIOR:I.EXTERIOR)},En.prototype.interfaces_=function(){return[]},En.prototype.getClass=function(){return En};var Sn=function t(){if(this._component=null,this._segIndex=null,this._pt=null,2===arguments.length){var e=arguments[0],i=arguments[1];t.call(this,e,t.INSIDE_AREA,i)}else if(3===arguments.length){var n=arguments[0],r=arguments[1],o=arguments[2];this._component=n,this._segIndex=r,this._pt=o}},xn={INSIDE_AREA:{configurable:!0}};Sn.prototype.isInsideArea=function(){return this._segIndex===Sn.INSIDE_AREA},Sn.prototype.getCoordinate=function(){return this._pt},Sn.prototype.getGeometryComponent=function(){return this._component},Sn.prototype.getSegmentIndex=function(){return this._segIndex},Sn.prototype.interfaces_=function(){return[]},Sn.prototype.getClass=function(){return Sn},xn.INSIDE_AREA.get=function(){return-1},Object.defineProperties(Sn,xn);var In=function(t){this._pts=t||null};In.prototype.filter=function(t){t instanceof Jt&&this._pts.add(t)},In.prototype.interfaces_=function(){return[Ht]},In.prototype.getClass=function(){return In},In.getPoints=function(){if(1===arguments.length){var t=arguments[0];return t instanceof Jt?$e.singletonList(t):In.getPoints(t,new Bt)}if(2===arguments.length){var e=arguments[0],i=arguments[1];return e instanceof Jt?i.add(e):e instanceof Vt&&e.apply(new In(i)),i}};var Fn=function(){this._locations=null;var t=arguments[0];this._locations=t};Fn.prototype.filter=function(t){(t instanceof Jt||t instanceof Xt||t instanceof $t)&&this._locations.add(new Sn(t,0,t.getCoordinate()))},Fn.prototype.interfaces_=function(){return[Ht]},Fn.prototype.getClass=function(){return Fn},Fn.getLocations=function(t){var e=new Bt;return t.apply(new Fn(e)),e};var On=function(){if(this._geom=null,this._terminateDistance=0,this._ptLocator=new En,this._minDistanceLocation=null,this._minDistance=v.MAX_VALUE,2===arguments.length){var t=arguments[0],e=arguments[1];this._geom=[t,e],this._terminateDistance=0}else if(3===arguments.length){var i=arguments[0],n=arguments[1],r=arguments[2];this._geom=new Array(2).fill(null),this._geom[0]=i,this._geom[1]=n,this._terminateDistance=r}};On.prototype.computeContainmentDistance=function(){if(0===arguments.length){var t=new Array(2).fill(null);if(this.computeContainmentDistance(0,t),this._minDistance<=this._terminateDistance)return null;this.computeContainmentDistance(1,t)}else if(2===arguments.length){var e=arguments[0],i=arguments[1],n=1-e,r=Bn.getPolygons(this._geom[e]);if(r.size()>0){var o=Fn.getLocations(this._geom[n]);if(this.computeContainmentDistance(o,r,i),this._minDistance<=this._terminateDistance)return this._minDistanceLocation[n]=i[0],this._minDistanceLocation[e]=i[1],null}}else if(3===arguments.length)if(arguments[2]instanceof Array&&O(arguments[0],Ct)&&O(arguments[1],Ct)){for(var s=arguments[0],a=arguments[1],A=arguments[2],l=0;l<s.size();l++)for(var c=s.get(l),u=0;u<a.size();u++)if(this.computeContainmentDistance(c,a.get(u),A),this._minDistance<=this._terminateDistance)return null}else if(arguments[2]instanceof Array&&arguments[0]instanceof Sn&&arguments[1]instanceof $t){var h=arguments[0],p=arguments[1],d=arguments[2],f=h.getCoordinate();if(I.EXTERIOR!==this._ptLocator.locate(f,p))return this._minDistance=0,d[0]=h,d[1]=new Sn(p,f),null}},On.prototype.computeMinDistanceLinesPoints=function(t,e,i){for(var n=0;n<t.size();n++)for(var r=t.get(n),o=0;o<e.size();o++){var s=e.get(o);if(this.computeMinDistance(r,s,i),this._minDistance<=this._terminateDistance)return null}},On.prototype.computeFacetDistance=function(){var t=new Array(2).fill(null),e=bn.getLines(this._geom[0]),i=bn.getLines(this._geom[1]),n=In.getPoints(this._geom[0]),r=In.getPoints(this._geom[1]);return this.computeMinDistanceLines(e,i,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(e,r,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(i,n,t),this.updateMinDistance(t,!0),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistancePoints(n,r,t),void this.updateMinDistance(t,!1))))},On.prototype.nearestLocations=function(){return this.computeMinDistance(),this._minDistanceLocation},On.prototype.updateMinDistance=function(t,e){if(null===t[0])return null;e?(this._minDistanceLocation[0]=t[1],this._minDistanceLocation[1]=t[0]):(this._minDistanceLocation[0]=t[0],this._minDistanceLocation[1]=t[1])},On.prototype.nearestPoints=function(){return this.computeMinDistance(),[this._minDistanceLocation[0].getCoordinate(),this._minDistanceLocation[1].getCoordinate()]},On.prototype.computeMinDistance=function(){if(0===arguments.length){if(null!==this._minDistanceLocation)return null;if(this._minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this._minDistance<=this._terminateDistance)return null;this.computeFacetDistance()}else if(3===arguments.length)if(arguments[2]instanceof Array&&arguments[0]instanceof Xt&&arguments[1]instanceof Jt){var t=arguments[0],e=arguments[1],i=arguments[2];if(t.getEnvelopeInternal().distance(e.getEnvelopeInternal())>this._minDistance)return null;for(var n=t.getCoordinates(),r=e.getCoordinate(),o=0;o<n.length-1;o++){var s=at.distancePointLine(r,n[o],n[o+1]);if(s<this._minDistance){this._minDistance=s;var a=new di(n[o],n[o+1]).closestPoint(r);i[0]=new Sn(t,o,a),i[1]=new Sn(e,0,r)}if(this._minDistance<=this._terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof Xt&&arguments[1]instanceof Xt){var A=arguments[0],l=arguments[1],c=arguments[2];if(A.getEnvelopeInternal().distance(l.getEnvelopeInternal())>this._minDistance)return null;for(var u=A.getCoordinates(),h=l.getCoordinates(),p=0;p<u.length-1;p++)for(var d=0;d<h.length-1;d++){var f=at.distanceLineLine(u[p],u[p+1],h[d],h[d+1]);if(f<this._minDistance){this._minDistance=f;var g=new di(u[p],u[p+1]),m=new di(h[d],h[d+1]),y=g.closestPoints(m);c[0]=new Sn(A,p,y[0]),c[1]=new Sn(l,d,y[1])}if(this._minDistance<=this._terminateDistance)return null}}},On.prototype.computeMinDistancePoints=function(t,e,i){for(var n=0;n<t.size();n++)for(var r=t.get(n),o=0;o<e.size();o++){var s=e.get(o),a=r.getCoordinate().distance(s.getCoordinate());if(a<this._minDistance&&(this._minDistance=a,i[0]=new Sn(r,0,r.getCoordinate()),i[1]=new Sn(s,0,s.getCoordinate())),this._minDistance<=this._terminateDistance)return null}},On.prototype.distance=function(){if(null===this._geom[0]||null===this._geom[1])throw new y("null geometries are not supported");return this._geom[0].isEmpty()||this._geom[1].isEmpty()?0:(this.computeMinDistance(),this._minDistance)},On.prototype.computeMinDistanceLines=function(t,e,i){for(var n=0;n<t.size();n++)for(var r=t.get(n),o=0;o<e.size();o++){var s=e.get(o);if(this.computeMinDistance(r,s,i),this._minDistance<=this._terminateDistance)return null}},On.prototype.interfaces_=function(){return[]},On.prototype.getClass=function(){return On},On.distance=function(t,e){return new On(t,e).distance()},On.isWithinDistance=function(t,e,i){return new On(t,e,i).distance()<=i},On.nearestPoints=function(t,e){return new On(t,e).nearestPoints()};var Pn=function(){this._pt=[new b,new b],this._distance=v.NaN,this._isNull=!0};Pn.prototype.getCoordinates=function(){return this._pt},Pn.prototype.getCoordinate=function(t){return this._pt[t]},Pn.prototype.setMinimum=function(){if(1===arguments.length){var t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],i=arguments[1];if(this._isNull)return this.initialize(e,i),null;var n=e.distance(i);n<this._distance&&this.initialize(e,i,n)}},Pn.prototype.initialize=function(){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){var t=arguments[0],e=arguments[1];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(e),this._distance=t.distance(e),this._isNull=!1}else if(3===arguments.length){var i=arguments[0],n=arguments[1],r=arguments[2];this._pt[0].setCoordinate(i),this._pt[1].setCoordinate(n),this._distance=r,this._isNull=!1}},Pn.prototype.toString=function(){return Z.toLineString(this._pt[0],this._pt[1])},Pn.prototype.getDistance=function(){return this._distance},Pn.prototype.setMaximum=function(){if(1===arguments.length){var t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],i=arguments[1];if(this._isNull)return this.initialize(e,i),null;var n=e.distance(i);n>this._distance&&this.initialize(e,i,n)}},Pn.prototype.interfaces_=function(){return[]},Pn.prototype.getClass=function(){return Pn};var Tn=function(){};Tn.prototype.interfaces_=function(){return[]},Tn.prototype.getClass=function(){return Tn},Tn.computeDistance=function(){if(arguments[2]instanceof Pn&&arguments[0]instanceof Xt&&arguments[1]instanceof b)for(var t=arguments[0],e=arguments[1],i=arguments[2],n=new di,r=t.getCoordinates(),o=0;o<r.length-1;o++){n.setCoordinates(r[o],r[o+1]);var s=n.closestPoint(e);i.setMinimum(s,e)}else if(arguments[2]instanceof Pn&&arguments[0]instanceof $t&&arguments[1]instanceof b){var a=arguments[0],A=arguments[1],l=arguments[2];Tn.computeDistance(a.getExteriorRing(),A,l);for(var c=0;c<a.getNumInteriorRing();c++)Tn.computeDistance(a.getInteriorRingN(c),A,l)}else if(arguments[2]instanceof Pn&&arguments[0]instanceof ct&&arguments[1]instanceof b){var u=arguments[0],h=arguments[1],p=arguments[2];if(u instanceof Xt)Tn.computeDistance(u,h,p);else if(u instanceof $t)Tn.computeDistance(u,h,p);else if(u instanceof Vt)for(var d=u,f=0;f<d.getNumGeometries();f++){var g=d.getGeometryN(f);Tn.computeDistance(g,h,p)}else p.setMinimum(u.getCoordinate(),h)}else if(arguments[2]instanceof Pn&&arguments[0]instanceof di&&arguments[1]instanceof b){var m=arguments[0],y=arguments[1],v=arguments[2],_=m.closestPoint(y);v.setMinimum(_,y)}};var Ln=function(){this._g0=null,this._g1=null,this._ptDist=new Pn,this._densifyFrac=0;var t=arguments[0],e=arguments[1];this._g0=t,this._g1=e},Mn={MaxPointDistanceFilter:{configurable:!0},MaxDensifiedByFractionDistanceFilter:{configurable:!0}};Ln.prototype.getCoordinates=function(){return this._ptDist.getCoordinates()},Ln.prototype.setDensifyFraction=function(t){if(t>1||t<=0)throw new y("Fraction is not in range (0.0 - 1.0]");this._densifyFrac=t},Ln.prototype.compute=function(t,e){this.computeOrientedDistance(t,e,this._ptDist),this.computeOrientedDistance(e,t,this._ptDist)},Ln.prototype.distance=function(){return this.compute(this._g0,this._g1),this._ptDist.getDistance()},Ln.prototype.computeOrientedDistance=function(t,e,i){var n=new Un(e);if(t.apply(n),i.setMaximum(n.getMaxPointDistance()),this._densifyFrac>0){var r=new Dn(e,this._densifyFrac);t.apply(r),i.setMaximum(r.getMaxPointDistance())}},Ln.prototype.orientedDistance=function(){return this.computeOrientedDistance(this._g0,this._g1,this._ptDist),this._ptDist.getDistance()},Ln.prototype.interfaces_=function(){return[]},Ln.prototype.getClass=function(){return Ln},Ln.distance=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return new Ln(t,e).distance()}if(3===arguments.length){var i=arguments[0],n=arguments[1],r=arguments[2],o=new Ln(i,n);return o.setDensifyFraction(r),o.distance()}},Mn.MaxPointDistanceFilter.get=function(){return Un},Mn.MaxDensifiedByFractionDistanceFilter.get=function(){return Dn},Object.defineProperties(Ln,Mn);var Un=function(){this._maxPtDist=new Pn,this._minPtDist=new Pn,this._euclideanDist=new Tn,this._geom=null;var t=arguments[0];this._geom=t};Un.prototype.filter=function(t){this._minPtDist.initialize(),Tn.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},Un.prototype.getMaxPointDistance=function(){return this._maxPtDist},Un.prototype.interfaces_=function(){return[pt]},Un.prototype.getClass=function(){return Un};var Dn=function(){this._maxPtDist=new Pn,this._minPtDist=new Pn,this._geom=null,this._numSubSegs=0;var t=arguments[0],e=arguments[1];this._geom=t,this._numSubSegs=Math.trunc(Math.round(1/e))};Dn.prototype.filter=function(t,e){if(0===e)return null;for(var i=t.getCoordinate(e-1),n=t.getCoordinate(e),r=(n.x-i.x)/this._numSubSegs,o=(n.y-i.y)/this._numSubSegs,s=0;s<this._numSubSegs;s++){var a=i.x+s*r,A=i.y+s*o,l=new b(a,A);this._minPtDist.initialize(),Tn.computeDistance(this._geom,l,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)}},Dn.prototype.isDone=function(){return!1},Dn.prototype.isGeometryChanged=function(){return!1},Dn.prototype.getMaxPointDistance=function(){return this._maxPtDist},Dn.prototype.interfaces_=function(){return[kt]},Dn.prototype.getClass=function(){return Dn};var Qn=function(t,e,i){this._minValidDistance=null,this._maxValidDistance=null,this._minDistanceFound=null,this._maxDistanceFound=null,this._isValid=!0,this._errMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._bufDistance=e||null,this._result=i||null},Rn={VERBOSE:{configurable:!0},MAX_DISTANCE_DIFF_FRAC:{configurable:!0}};Qn.prototype.checkMaximumDistance=function(t,e,i){var n=new Ln(e,t);if(n.setDensifyFraction(.25),this._maxDistanceFound=n.orientedDistance(),this._maxDistanceFound>i){this._isValid=!1;var r=n.getCoordinates();this._errorLocation=r[1],this._errorIndicator=t.getFactory().createLineString(r),this._errMsg="Distance between buffer curve and input is too large ("+this._maxDistanceFound+" at "+Z.toLineString(r[0],r[1])+")"}},Qn.prototype.isValid=function(){var t=Math.abs(this._bufDistance),e=Qn.MAX_DISTANCE_DIFF_FRAC*t;return this._minValidDistance=t-e,this._maxValidDistance=t+e,!(!this._input.isEmpty()&&!this._result.isEmpty())||(this._bufDistance>0?this.checkPositiveValid():this.checkNegativeValid(),Qn.VERBOSE&&G.out.println("Min Dist= "+this._minDistanceFound+"  err= "+(1-this._minDistanceFound/this._bufDistance)+"  Max Dist= "+this._maxDistanceFound+"  err= "+(this._maxDistanceFound/this._bufDistance-1)),this._isValid)},Qn.prototype.checkNegativeValid=function(){if(!(this._input instanceof $t||this._input instanceof ie||this._input instanceof Vt))return null;var t=this.getPolygonLines(this._input);if(this.checkMinimumDistance(t,this._result,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(t,this._result,this._maxValidDistance)},Qn.prototype.getErrorIndicator=function(){return this._errorIndicator},Qn.prototype.checkMinimumDistance=function(t,e,i){var n=new On(t,e,i);if(this._minDistanceFound=n.distance(),this._minDistanceFound<i){this._isValid=!1;var r=n.nearestPoints();this._errorLocation=n.nearestPoints()[1],this._errorIndicator=t.getFactory().createLineString(r),this._errMsg="Distance between buffer curve and input is too small ("+this._minDistanceFound+" at "+Z.toLineString(r[0],r[1])+" )"}},Qn.prototype.checkPositiveValid=function(){var t=this._result.getBoundary();if(this.checkMinimumDistance(this._input,t,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(this._input,t,this._maxValidDistance)},Qn.prototype.getErrorLocation=function(){return this._errorLocation},Qn.prototype.getPolygonLines=function(t){for(var e=new Bt,i=new bn(e),n=Bn.getPolygons(t).iterator();n.hasNext();)n.next().apply(i);return t.getFactory().buildGeometry(e)},Qn.prototype.getErrorMessage=function(){return this._errMsg},Qn.prototype.interfaces_=function(){return[]},Qn.prototype.getClass=function(){return Qn},Rn.VERBOSE.get=function(){return!1},Rn.MAX_DISTANCE_DIFF_FRAC.get=function(){return.012},Object.defineProperties(Qn,Rn);var Nn=function(t,e,i){this._isValid=!0,this._errorMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._distance=e||null,this._result=i||null},Hn={VERBOSE:{configurable:!0},MAX_ENV_DIFF_FRAC:{configurable:!0}};Nn.prototype.isValid=function(){return this.checkPolygonal(),this._isValid?(this.checkExpectedEmpty(),this._isValid?(this.checkEnvelope(),this._isValid?(this.checkArea(),this._isValid?(this.checkDistance(),this._isValid):this._isValid):this._isValid):this._isValid):this._isValid},Nn.prototype.checkEnvelope=function(){if(this._distance<0)return null;var t=this._distance*Nn.MAX_ENV_DIFF_FRAC;0===t&&(t=.001);var e=new z(this._input.getEnvelopeInternal());e.expandBy(this._distance);var i=new z(this._result.getEnvelopeInternal());i.expandBy(t),i.contains(e)||(this._isValid=!1,this._errorMsg="Buffer envelope is incorrect",this._errorIndicator=this._input.getFactory().toGeometry(i)),this.report("Envelope")},Nn.prototype.checkDistance=function(){var t=new Qn(this._input,this._distance,this._result);t.isValid()||(this._isValid=!1,this._errorMsg=t.getErrorMessage(),this._errorLocation=t.getErrorLocation(),this._errorIndicator=t.getErrorIndicator()),this.report("Distance")},Nn.prototype.checkArea=function(){var t=this._input.getArea(),e=this._result.getArea();this._distance>0&&t>e&&(this._isValid=!1,this._errorMsg="Area of positive buffer is smaller than input",this._errorIndicator=this._result),this._distance<0&&t<e&&(this._isValid=!1,this._errorMsg="Area of negative buffer is larger than input",this._errorIndicator=this._result),this.report("Area")},Nn.prototype.checkPolygonal=function(){this._result instanceof $t||this._result instanceof ie||(this._isValid=!1),this._errorMsg="Result is not polygonal",this._errorIndicator=this._result,this.report("Polygonal")},Nn.prototype.getErrorIndicator=function(){return this._errorIndicator},Nn.prototype.getErrorLocation=function(){return this._errorLocation},Nn.prototype.checkExpectedEmpty=function(){return this._input.getDimension()>=2||this._distance>0?null:(this._result.isEmpty()||(this._isValid=!1,this._errorMsg="Result is non-empty",this._errorIndicator=this._result),void this.report("ExpectedEmpty"))},Nn.prototype.report=function(t){if(!Nn.VERBOSE)return null;G.out.println("Check "+t+": "+(this._isValid?"passed":"FAILED"))},Nn.prototype.getErrorMessage=function(){return this._errorMsg},Nn.prototype.interfaces_=function(){return[]},Nn.prototype.getClass=function(){return Nn},Nn.isValidMsg=function(t,e,i){var n=new Nn(t,e,i);return n.isValid()?null:n.getErrorMessage()},Nn.isValid=function(t,e,i){return!!new Nn(t,e,i).isValid()},Hn.VERBOSE.get=function(){return!1},Hn.MAX_ENV_DIFF_FRAC.get=function(){return.012},Object.defineProperties(Nn,Hn);var kn=function(){this._pts=null,this._data=null;var t=arguments[0],e=arguments[1];this._pts=t,this._data=e};kn.prototype.getCoordinates=function(){return this._pts},kn.prototype.size=function(){return this._pts.length},kn.prototype.getCoordinate=function(t){return this._pts[t]},kn.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},kn.prototype.getSegmentOctant=function(t){return t===this._pts.length-1?-1:ci.octant(this.getCoordinate(t),this.getCoordinate(t+1))},kn.prototype.setData=function(t){this._data=t},kn.prototype.getData=function(){return this._data},kn.prototype.toString=function(){return Z.toLineString(new Ae(this._pts))},kn.prototype.interfaces_=function(){return[ui]},kn.prototype.getClass=function(){return kn};var Vn=function(){this._findAllIntersections=!1,this._isCheckEndSegmentsOnly=!1,this._li=null,this._interiorIntersection=null,this._intSegments=null,this._intersections=new Bt,this._intersectionCount=0,this._keepIntersections=!0;var t=arguments[0];this._li=t,this._interiorIntersection=null};Vn.prototype.getInteriorIntersection=function(){return this._interiorIntersection},Vn.prototype.setCheckEndSegmentsOnly=function(t){this._isCheckEndSegmentsOnly=t},Vn.prototype.getIntersectionSegments=function(){return this._intSegments},Vn.prototype.count=function(){return this._intersectionCount},Vn.prototype.getIntersections=function(){return this._intersections},Vn.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t},Vn.prototype.setKeepIntersections=function(t){this._keepIntersections=t},Vn.prototype.processIntersections=function(t,e,i,n){if(!this._findAllIntersections&&this.hasIntersection())return null;if(t===i&&e===n)return null;if(this._isCheckEndSegmentsOnly&&!this.isEndSegment(t,e)&&!this.isEndSegment(i,n))return null;var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=i.getCoordinates()[n],a=i.getCoordinates()[n+1];this._li.computeIntersection(r,o,s,a),this._li.hasIntersection()&&this._li.isInteriorIntersection()&&(this._intSegments=new Array(4).fill(null),this._intSegments[0]=r,this._intSegments[1]=o,this._intSegments[2]=s,this._intSegments[3]=a,this._interiorIntersection=this._li.getIntersection(0),this._keepIntersections&&this._intersections.add(this._interiorIntersection),this._intersectionCount++)},Vn.prototype.isEndSegment=function(t,e){return 0===e||e>=t.size()-2},Vn.prototype.hasIntersection=function(){return null!==this._interiorIntersection},Vn.prototype.isDone=function(){return!this._findAllIntersections&&null!==this._interiorIntersection},Vn.prototype.interfaces_=function(){return[Wi]},Vn.prototype.getClass=function(){return Vn},Vn.createAllIntersectionsFinder=function(t){var e=new Vn(t);return e.setFindAllIntersections(!0),e},Vn.createAnyIntersectionFinder=function(t){return new Vn(t)},Vn.createIntersectionCounter=function(t){var e=new Vn(t);return e.setFindAllIntersections(!0),e.setKeepIntersections(!1),e};var jn=function(){this._li=new rt,this._segStrings=null,this._findAllIntersections=!1,this._segInt=null,this._isValid=!0;var t=arguments[0];this._segStrings=t};jn.prototype.execute=function(){if(null!==this._segInt)return null;this.checkInteriorIntersections()},jn.prototype.getIntersections=function(){return this._segInt.getIntersections()},jn.prototype.isValid=function(){return this.execute(),this._isValid},jn.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t},jn.prototype.checkInteriorIntersections=function(){this._isValid=!0,this._segInt=new Vn(this._li),this._segInt.setFindAllIntersections(this._findAllIntersections);var t=new wi;if(t.setSegmentIntersector(this._segInt),t.computeNodes(this._segStrings),this._segInt.hasIntersection())return this._isValid=!1,null},jn.prototype.checkValid=function(){if(this.execute(),!this._isValid)throw new Ie(this.getErrorMessage(),this._segInt.getInteriorIntersection())},jn.prototype.getErrorMessage=function(){if(this._isValid)return"no intersections found";var t=this._segInt.getIntersectionSegments();return"found non-noded intersection between "+Z.toLineString(t[0],t[1])+" and "+Z.toLineString(t[2],t[3])},jn.prototype.interfaces_=function(){return[]},jn.prototype.getClass=function(){return jn},jn.computeIntersections=function(t){var e=new jn(t);return e.setFindAllIntersections(!0),e.isValid(),e.getIntersections()};var Gn=function t(){this._nv=null;var e=arguments[0];this._nv=new jn(t.toSegmentStrings(e))};Gn.prototype.checkValid=function(){this._nv.checkValid()},Gn.prototype.interfaces_=function(){return[]},Gn.prototype.getClass=function(){return Gn},Gn.toSegmentStrings=function(t){for(var e=new Bt,i=t.iterator();i.hasNext();){var n=i.next();e.add(new kn(n.getCoordinates(),n))}return e},Gn.checkValid=function(t){new Gn(t).checkValid()};var Kn=function(t){this._mapOp=t};Kn.prototype.map=function(t){for(var e=new Bt,i=0;i<t.getNumGeometries();i++){var n=this._mapOp.map(t.getGeometryN(i));n.isEmpty()||e.add(n)}return t.getFactory().createGeometryCollection(me.toGeometryArray(e))},Kn.prototype.interfaces_=function(){return[]},Kn.prototype.getClass=function(){return Kn},Kn.map=function(t,e){return new Kn(e).map(t)};var zn=function(){this._op=null,this._geometryFactory=null,this._ptLocator=null,this._lineEdgesList=new Bt,this._resultLineList=new Bt;var t=arguments[0],e=arguments[1],i=arguments[2];this._op=t,this._geometryFactory=e,this._ptLocator=i};zn.prototype.collectLines=function(t){for(var e=this._op.getGraph().getEdgeEnds().iterator();e.hasNext();){var i=e.next();this.collectLineEdge(i,t,this._lineEdgesList),this.collectBoundaryTouchEdge(i,t,this._lineEdgesList)}},zn.prototype.labelIsolatedLine=function(t,e){var i=this._ptLocator.locate(t.getCoordinate(),this._op.getArgGeometry(e));t.getLabel().setLocation(e,i)},zn.prototype.build=function(t){return this.findCoveredLineEdges(),this.collectLines(t),this.buildLines(t),this._resultLineList},zn.prototype.collectLineEdge=function(t,e,i){var n=t.getLabel(),r=t.getEdge();t.isLineEdge()&&(t.isVisited()||!Sr.isResultOfOp(n,e)||r.isCovered()||(i.add(r),t.setVisitedEdge(!0)))},zn.prototype.findCoveredLineEdges=function(){for(var t=this._op.getGraph().getNodes().iterator();t.hasNext();)t.next().getEdges().findCoveredLineEdges();for(var e=this._op.getGraph().getEdgeEnds().iterator();e.hasNext();){var i=e.next(),n=i.getEdge();if(i.isLineEdge()&&!n.isCoveredSet()){var r=this._op.isCoveredByA(i.getCoordinate());n.setCovered(r)}}},zn.prototype.labelIsolatedLines=function(t){for(var e=t.iterator();e.hasNext();){var i=e.next(),n=i.getLabel();i.isIsolated()&&(n.isNull(0)?this.labelIsolatedLine(i,0):this.labelIsolatedLine(i,1))}},zn.prototype.buildLines=function(t){for(var e=this._lineEdgesList.iterator();e.hasNext();){var i=e.next(),n=this._geometryFactory.createLineString(i.getCoordinates());this._resultLineList.add(n),i.setInResult(!0)}},zn.prototype.collectBoundaryTouchEdge=function(t,e,i){var n=t.getLabel();return t.isLineEdge()||t.isVisited()||t.isInteriorAreaEdge()||t.getEdge().isInResult()?null:(et.isTrue(!(t.isInResult()||t.getSym().isInResult())||!t.getEdge().isInResult()),void(Sr.isResultOfOp(n,e)&&e===Sr.INTERSECTION&&(i.add(t.getEdge()),t.setVisitedEdge(!0))))},zn.prototype.interfaces_=function(){return[]},zn.prototype.getClass=function(){return zn};var Wn=function(){this._op=null,this._geometryFactory=null,this._resultPointList=new Bt;var t=arguments[0],e=arguments[1];this._op=t,this._geometryFactory=e};Wn.prototype.filterCoveredNodeToPoint=function(t){var e=t.getCoordinate();if(!this._op.isCoveredByLA(e)){var i=this._geometryFactory.createPoint(e);this._resultPointList.add(i)}},Wn.prototype.extractNonCoveredResultNodes=function(t){for(var e=this._op.getGraph().getNodes().iterator();e.hasNext();){var i=e.next();if(!(i.isInResult()||i.isIncidentEdgeInResult()||0!==i.getEdges().getDegree()&&t!==Sr.INTERSECTION)){var n=i.getLabel();Sr.isResultOfOp(n,t)&&this.filterCoveredNodeToPoint(i)}}},Wn.prototype.build=function(t){return this.extractNonCoveredResultNodes(t),this._resultPointList},Wn.prototype.interfaces_=function(){return[]},Wn.prototype.getClass=function(){return Wn};var qn=function(){this._inputGeom=null,this._factory=null,this._pruneEmptyGeometry=!0,this._preserveGeometryCollectionType=!0,this._preserveCollections=!1,this._preserveType=!1};qn.prototype.transformPoint=function(t,e){return this._factory.createPoint(this.transformCoordinates(t.getCoordinateSequence(),t))},qn.prototype.transformPolygon=function(t,e){var i=!0,n=this.transformLinearRing(t.getExteriorRing(),t);null!==n&&n instanceof ee&&!n.isEmpty()||(i=!1);for(var r=new Bt,o=0;o<t.getNumInteriorRing();o++){var s=this.transformLinearRing(t.getInteriorRingN(o),t);null===s||s.isEmpty()||(s instanceof ee||(i=!1),r.add(s))}if(i)return this._factory.createPolygon(n,r.toArray([]));var a=new Bt;return null!==n&&a.add(n),a.addAll(r),this._factory.buildGeometry(a)},qn.prototype.createCoordinateSequence=function(t){return this._factory.getCoordinateSequenceFactory().create(t)},qn.prototype.getInputGeometry=function(){return this._inputGeom},qn.prototype.transformMultiLineString=function(t,e){for(var i=new Bt,n=0;n<t.getNumGeometries();n++){var r=this.transformLineString(t.getGeometryN(n),t);null!==r&&(r.isEmpty()||i.add(r))}return this._factory.buildGeometry(i)},qn.prototype.transformCoordinates=function(t,e){return this.copy(t)},qn.prototype.transformLineString=function(t,e){return this._factory.createLineString(this.transformCoordinates(t.getCoordinateSequence(),t))},qn.prototype.transformMultiPoint=function(t,e){for(var i=new Bt,n=0;n<t.getNumGeometries();n++){var r=this.transformPoint(t.getGeometryN(n),t);null!==r&&(r.isEmpty()||i.add(r))}return this._factory.buildGeometry(i)},qn.prototype.transformMultiPolygon=function(t,e){for(var i=new Bt,n=0;n<t.getNumGeometries();n++){var r=this.transformPolygon(t.getGeometryN(n),t);null!==r&&(r.isEmpty()||i.add(r))}return this._factory.buildGeometry(i)},qn.prototype.copy=function(t){return t.copy()},qn.prototype.transformGeometryCollection=function(t,e){for(var i=new Bt,n=0;n<t.getNumGeometries();n++){var r=this.transform(t.getGeometryN(n));null!==r&&(this._pruneEmptyGeometry&&r.isEmpty()||i.add(r))}return this._preserveGeometryCollectionType?this._factory.createGeometryCollection(me.toGeometryArray(i)):this._factory.buildGeometry(i)},qn.prototype.transform=function(t){if(this._inputGeom=t,this._factory=t.getFactory(),t instanceof Jt)return this.transformPoint(t,null);if(t instanceof te)return this.transformMultiPoint(t,null);if(t instanceof ee)return this.transformLinearRing(t,null);if(t instanceof Xt)return this.transformLineString(t,null);if(t instanceof jt)return this.transformMultiLineString(t,null);if(t instanceof $t)return this.transformPolygon(t,null);if(t instanceof ie)return this.transformMultiPolygon(t,null);if(t instanceof Vt)return this.transformGeometryCollection(t,null);throw new y("Unknown Geometry subtype: "+t.getClass().getName())},qn.prototype.transformLinearRing=function(t,e){var i=this.transformCoordinates(t.getCoordinateSequence(),t);if(null===i)return this._factory.createLinearRing(null);var n=i.size();return n>0&&n<4&&!this._preserveType?this._factory.createLineString(i):this._factory.createLinearRing(i)},qn.prototype.interfaces_=function(){return[]},qn.prototype.getClass=function(){return qn};var Xn=function t(){if(this._snapTolerance=0,this._srcPts=null,this._seg=new di,this._allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof Xt&&"number"==typeof arguments[1]){var e=arguments[0],i=arguments[1];t.call(this,e.getCoordinates(),i)}else if(arguments[0]instanceof Array&&"number"==typeof arguments[1]){var n=arguments[0],r=arguments[1];this._srcPts=n,this._isClosed=t.isClosed(n),this._snapTolerance=r}};Xn.prototype.snapVertices=function(t,e){for(var i=this._isClosed?t.size()-1:t.size(),n=0;n<i;n++){var r=t.get(n),o=this.findSnapForVertex(r,e);null!==o&&(t.set(n,new b(o)),0===n&&this._isClosed&&t.set(t.size()-1,new b(o)))}},Xn.prototype.findSnapForVertex=function(t,e){for(var i=0;i<e.length;i++){if(t.equals2D(e[i]))return null;if(t.distance(e[i])<this._snapTolerance)return e[i]}return null},Xn.prototype.snapTo=function(t){var e=new Et(this._srcPts);return this.snapVertices(e,t),this.snapSegments(e,t),e.toCoordinateArray()},Xn.prototype.snapSegments=function(t,e){if(0===e.length)return null;var i=e.length;e[0].equals2D(e[e.length-1])&&(i=e.length-1);for(var n=0;n<i;n++){var r=e[n],o=this.findSegmentIndexToSnap(r,t);o>=0&&t.add(o+1,new b(r),!1)}},Xn.prototype.findSegmentIndexToSnap=function(t,e){for(var i=v.MAX_VALUE,n=-1,r=0;r<e.size()-1;r++){if(this._seg.p0=e.get(r),this._seg.p1=e.get(r+1),this._seg.p0.equals2D(t)||this._seg.p1.equals2D(t)){if(this._allowSnappingToSourceVertices)continue;return-1}var o=this._seg.distance(t);o<this._snapTolerance&&o<i&&(i=o,n=r)}return n},Xn.prototype.setAllowSnappingToSourceVertices=function(t){this._allowSnappingToSourceVertices=t},Xn.prototype.interfaces_=function(){return[]},Xn.prototype.getClass=function(){return Xn},Xn.isClosed=function(t){return!(t.length<=1)&&t[0].equals2D(t[t.length-1])};var Yn=function(t){this._srcGeom=t||null},Jn={SNAP_PRECISION_FACTOR:{configurable:!0}};Yn.prototype.snapTo=function(t,e){var i=this.extractTargetCoordinates(t);return new Zn(e,i).transform(this._srcGeom)},Yn.prototype.snapToSelf=function(t,e){var i=this.extractTargetCoordinates(this._srcGeom),n=new Zn(t,i,!0).transform(this._srcGeom),r=n;return e&&O(r,Zt)&&(r=n.buffer(0)),r},Yn.prototype.computeSnapTolerance=function(t){return this.computeMinimumSegmentLength(t)/10},Yn.prototype.extractTargetCoordinates=function(t){for(var e=new p,i=t.getCoordinates(),n=0;n<i.length;n++)e.add(i[n]);return e.toArray(new Array(0).fill(null))},Yn.prototype.computeMinimumSegmentLength=function(t){for(var e=v.MAX_VALUE,i=0;i<t.length-1;i++){var n=t[i].distance(t[i+1]);n<e&&(e=n)}return e},Yn.prototype.interfaces_=function(){return[]},Yn.prototype.getClass=function(){return Yn},Yn.snap=function(t,e,i){var n=new Array(2).fill(null),r=new Yn(t);n[0]=r.snapTo(e,i);var o=new Yn(e);return n[1]=o.snapTo(n[0],i),n},Yn.computeOverlaySnapTolerance=function(){if(1===arguments.length){var t=arguments[0],e=Yn.computeSizeBasedSnapTolerance(t),i=t.getPrecisionModel();if(i.getType()===pe.FIXED){var n=1/i.getScale()*2/1.415;n>e&&(e=n)}return e}if(2===arguments.length){var r=arguments[0],o=arguments[1];return Math.min(Yn.computeOverlaySnapTolerance(r),Yn.computeOverlaySnapTolerance(o))}},Yn.computeSizeBasedSnapTolerance=function(t){var e=t.getEnvelopeInternal();return Math.min(e.getHeight(),e.getWidth())*Yn.SNAP_PRECISION_FACTOR},Yn.snapToSelf=function(t,e,i){return new Yn(t).snapToSelf(e,i)},Jn.SNAP_PRECISION_FACTOR.get=function(){return 1e-9},Object.defineProperties(Yn,Jn);var Zn=function(t){function e(e,i,n){t.call(this),this._snapTolerance=e||null,this._snapPts=i||null,this._isSelfSnap=void 0!==n&&n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.snapLine=function(t,e){var i=new Xn(t,this._snapTolerance);return i.setAllowSnappingToSourceVertices(this._isSelfSnap),i.snapTo(e)},e.prototype.transformCoordinates=function(t,e){var i=t.toCoordinateArray(),n=this.snapLine(i,this._snapPts);return this._factory.getCoordinateSequenceFactory().create(n)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(qn),$n=function(){this._isFirst=!0,this._commonMantissaBitsCount=53,this._commonBits=0,this._commonSignExp=null};$n.prototype.getCommon=function(){return v.longBitsToDouble(this._commonBits)},$n.prototype.add=function(t){var e=v.doubleToLongBits(t);return this._isFirst?(this._commonBits=e,this._commonSignExp=$n.signExpBits(this._commonBits),this._isFirst=!1,null):$n.signExpBits(e)!==this._commonSignExp?(this._commonBits=0,null):(this._commonMantissaBitsCount=$n.numCommonMostSigMantissaBits(this._commonBits,e),void(this._commonBits=$n.zeroLowerBits(this._commonBits,64-(12+this._commonMantissaBitsCount))))},$n.prototype.toString=function(){if(1===arguments.length){var t=arguments[0],e=v.longBitsToDouble(t),i="0000000000000000000000000000000000000000000000000000000000000000"+v.toBinaryString(t),n=i.substring(i.length-64);return n.substring(0,1)+"  "+n.substring(1,12)+"(exp) "+n.substring(12)+" [ "+e+" ]"}},$n.prototype.interfaces_=function(){return[]},$n.prototype.getClass=function(){return $n},$n.getBit=function(t,e){return 0!=(t&1<<e)?1:0},$n.signExpBits=function(t){return t>>52},$n.zeroLowerBits=function(t,e){return t&~((1<<e)-1)},$n.numCommonMostSigMantissaBits=function(t,e){for(var i=0,n=52;n>=0;n--){if($n.getBit(t,n)!==$n.getBit(e,n))return i;i++}return 52};var tr=function(){this._commonCoord=null,this._ccFilter=new ir},er={CommonCoordinateFilter:{configurable:!0},Translater:{configurable:!0}};tr.prototype.addCommonBits=function(t){var e=new nr(this._commonCoord);t.apply(e),t.geometryChanged()},tr.prototype.removeCommonBits=function(t){if(0===this._commonCoord.x&&0===this._commonCoord.y)return t;var e=new b(this._commonCoord);e.x=-e.x,e.y=-e.y;var i=new nr(e);return t.apply(i),t.geometryChanged(),t},tr.prototype.getCommonCoordinate=function(){return this._commonCoord},tr.prototype.add=function(t){t.apply(this._ccFilter),this._commonCoord=this._ccFilter.getCommonCoordinate()},tr.prototype.interfaces_=function(){return[]},tr.prototype.getClass=function(){return tr},er.CommonCoordinateFilter.get=function(){return ir},er.Translater.get=function(){return nr},Object.defineProperties(tr,er);var ir=function(){this._commonBitsX=new $n,this._commonBitsY=new $n};ir.prototype.filter=function(t){this._commonBitsX.add(t.x),this._commonBitsY.add(t.y)},ir.prototype.getCommonCoordinate=function(){return new b(this._commonBitsX.getCommon(),this._commonBitsY.getCommon())},ir.prototype.interfaces_=function(){return[pt]},ir.prototype.getClass=function(){return ir};var nr=function(){this.trans=null;var t=arguments[0];this.trans=t};nr.prototype.filter=function(t,e){var i=t.getOrdinate(e,0)+this.trans.x,n=t.getOrdinate(e,1)+this.trans.y;t.setOrdinate(e,0,i),t.setOrdinate(e,1,n)},nr.prototype.isDone=function(){return!1},nr.prototype.isGeometryChanged=function(){return!0},nr.prototype.interfaces_=function(){return[kt]},nr.prototype.getClass=function(){return nr};var rr=function(t,e){this._geom=new Array(2).fill(null),this._snapTolerance=null,this._cbr=null,this._geom[0]=t,this._geom[1]=e,this.computeSnapTolerance()};rr.prototype.selfSnap=function(t){return new Yn(t).snapTo(t,this._snapTolerance)},rr.prototype.removeCommonBits=function(t){this._cbr=new tr,this._cbr.add(t[0]),this._cbr.add(t[1]);var e=new Array(2).fill(null);return e[0]=this._cbr.removeCommonBits(t[0].copy()),e[1]=this._cbr.removeCommonBits(t[1].copy()),e},rr.prototype.prepareResult=function(t){return this._cbr.addCommonBits(t),t},rr.prototype.getResultGeometry=function(t){var e=this.snap(this._geom),i=Sr.overlayOp(e[0],e[1],t);return this.prepareResult(i)},rr.prototype.checkValid=function(t){t.isValid()||G.out.println("Snapped geometry is invalid")},rr.prototype.computeSnapTolerance=function(){this._snapTolerance=Yn.computeOverlaySnapTolerance(this._geom[0],this._geom[1])},rr.prototype.snap=function(t){var e=this.removeCommonBits(t);return Yn.snap(e[0],e[1],this._snapTolerance)},rr.prototype.interfaces_=function(){return[]},rr.prototype.getClass=function(){return rr},rr.overlayOp=function(t,e,i){return new rr(t,e).getResultGeometry(i)},rr.union=function(t,e){return rr.overlayOp(t,e,Sr.UNION)},rr.intersection=function(t,e){return rr.overlayOp(t,e,Sr.INTERSECTION)},rr.symDifference=function(t,e){return rr.overlayOp(t,e,Sr.SYMDIFFERENCE)},rr.difference=function(t,e){return rr.overlayOp(t,e,Sr.DIFFERENCE)};var or=function(t,e){this._geom=new Array(2).fill(null),this._geom[0]=t,this._geom[1]=e};or.prototype.getResultGeometry=function(t){var e=null,i=!1,n=null;try{e=Sr.overlayOp(this._geom[0],this._geom[1],t),i=!0}catch(t){if(!(t instanceof $))throw t;n=t}if(!i)try{e=rr.overlayOp(this._geom[0],this._geom[1],t)}catch(t){throw t instanceof $?n:t}return e},or.prototype.interfaces_=function(){return[]},or.prototype.getClass=function(){return or},or.overlayOp=function(t,e,i){return new or(t,e).getResultGeometry(i)},or.union=function(t,e){return or.overlayOp(t,e,Sr.UNION)},or.intersection=function(t,e){return or.overlayOp(t,e,Sr.INTERSECTION)},or.symDifference=function(t,e){return or.overlayOp(t,e,Sr.SYMDIFFERENCE)},or.difference=function(t,e){return or.overlayOp(t,e,Sr.DIFFERENCE)};var sr=function(){this.mce=null,this.chainIndex=null;var t=arguments[0],e=arguments[1];this.mce=t,this.chainIndex=e};sr.prototype.computeIntersections=function(t,e){this.mce.computeIntersectsForChain(this.chainIndex,t.mce,t.chainIndex,e)},sr.prototype.interfaces_=function(){return[]},sr.prototype.getClass=function(){return sr};var ar=function t(){if(this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,2===arguments.length){var e=arguments[0],i=arguments[1];this._eventType=t.DELETE,this._xValue=e,this._insertEvent=i}else if(3===arguments.length){var n=arguments[0],r=arguments[1],o=arguments[2];this._eventType=t.INSERT,this._label=n,this._xValue=r,this._obj=o}},Ar={INSERT:{configurable:!0},DELETE:{configurable:!0}};ar.prototype.isDelete=function(){return this._eventType===ar.DELETE},ar.prototype.setDeleteEventIndex=function(t){this._deleteEventIndex=t},ar.prototype.getObject=function(){return this._obj},ar.prototype.compareTo=function(t){var e=t;return this._xValue<e._xValue?-1:this._xValue>e._xValue?1:this._eventType<e._eventType?-1:this._eventType>e._eventType?1:0},ar.prototype.getInsertEvent=function(){return this._insertEvent},ar.prototype.isInsert=function(){return this._eventType===ar.INSERT},ar.prototype.isSameLabel=function(t){return null!==this._label&&this._label===t._label},ar.prototype.getDeleteEventIndex=function(){return this._deleteEventIndex},ar.prototype.interfaces_=function(){return[w]},ar.prototype.getClass=function(){return ar},Ar.INSERT.get=function(){return 1},Ar.DELETE.get=function(){return 2},Object.defineProperties(ar,Ar);var lr=function(){};lr.prototype.interfaces_=function(){return[]},lr.prototype.getClass=function(){return lr};var cr=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._properIntersectionPoint=null,this._li=null,this._includeProper=null,this._recordIsolated=null,this._isSelfIntersection=null,this._numIntersections=0,this.numTests=0,this._bdyNodes=null,this._isDone=!1,this._isDoneWhenProperInt=!1;var t=arguments[0],e=arguments[1],i=arguments[2];this._li=t,this._includeProper=e,this._recordIsolated=i};cr.prototype.isTrivialIntersection=function(t,e,i,n){if(t===i&&1===this._li.getIntersectionNum()){if(cr.isAdjacentSegments(e,n))return!0;if(t.isClosed()){var r=t.getNumPoints()-1;if(0===e&&n===r||0===n&&e===r)return!0}}return!1},cr.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},cr.prototype.setIsDoneIfProperInt=function(t){this._isDoneWhenProperInt=t},cr.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},cr.prototype.isBoundaryPointInternal=function(t,e){for(var i=e.iterator();i.hasNext();){var n=i.next().getCoordinate();if(t.isIntersection(n))return!0}return!1},cr.prototype.hasProperIntersection=function(){return this._hasProper},cr.prototype.hasIntersection=function(){return this._hasIntersection},cr.prototype.isDone=function(){return this._isDone},cr.prototype.isBoundaryPoint=function(t,e){return!(null===e||!this.isBoundaryPointInternal(t,e[0])&&!this.isBoundaryPointInternal(t,e[1]))},cr.prototype.setBoundaryNodes=function(t,e){this._bdyNodes=new Array(2).fill(null),this._bdyNodes[0]=t,this._bdyNodes[1]=e},cr.prototype.addIntersections=function(t,e,i,n){if(t===i&&e===n)return null;this.numTests++;var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=i.getCoordinates()[n],a=i.getCoordinates()[n+1];this._li.computeIntersection(r,o,s,a),this._li.hasIntersection()&&(this._recordIsolated&&(t.setIsolated(!1),i.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(t,e,i,n)||(this._hasIntersection=!0,!this._includeProper&&this._li.isProper()||(t.addIntersections(this._li,e,0),i.addIntersections(this._li,n,1)),this._li.isProper()&&(this._properIntersectionPoint=this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))},cr.prototype.interfaces_=function(){return[]},cr.prototype.getClass=function(){return cr},cr.isAdjacentSegments=function(t,e){return 1===Math.abs(t-e)};var ur=function(t){function e(){t.call(this),this.events=new Bt,this.nOverlaps=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.prepareEvents=function(){$e.sort(this.events);for(var t=0;t<this.events.size();t++){var e=this.events.get(t);e.isDelete()&&e.getInsertEvent().setDeleteEventIndex(t)}},e.prototype.computeIntersections=function(){if(1===arguments.length){var t=arguments[0];this.nOverlaps=0,this.prepareEvents();for(var e=0;e<this.events.size();e++){var i=this.events.get(e);if(i.isInsert()&&this.processOverlaps(e,i.getDeleteEventIndex(),i,t),t.isDone())break}}else if(3===arguments.length)if(arguments[2]instanceof cr&&O(arguments[0],Ct)&&O(arguments[1],Ct)){var n=arguments[0],r=arguments[1],o=arguments[2];this.addEdges(n,n),this.addEdges(r,r),this.computeIntersections(o)}else if("boolean"==typeof arguments[2]&&O(arguments[0],Ct)&&arguments[1]instanceof cr){var s=arguments[0],a=arguments[1];arguments[2]?this.addEdges(s,null):this.addEdges(s),this.computeIntersections(a)}},e.prototype.addEdge=function(t,e){for(var i=t.getMonotoneChainEdge(),n=i.getStartIndexes(),r=0;r<n.length-1;r++){var o=new sr(i,r),s=new ar(e,i.getMinX(r),o);this.events.add(s),this.events.add(new ar(i.getMaxX(r),s))}},e.prototype.processOverlaps=function(t,e,i,n){for(var r=i.getObject(),o=t;o<e;o++){var s=this.events.get(o);if(s.isInsert()){var a=s.getObject();i.isSameLabel(s)||(r.computeIntersections(a,n),this.nOverlaps++)}}},e.prototype.addEdges=function(){if(1===arguments.length)for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.addEdge(e,e)}else if(2===arguments.length)for(var i=arguments[0],n=arguments[1],r=i.iterator();r.hasNext();){var o=r.next();this.addEdge(o,n)}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(lr),hr=function(){this._min=v.POSITIVE_INFINITY,this._max=v.NEGATIVE_INFINITY},pr={NodeComparator:{configurable:!0}};hr.prototype.getMin=function(){return this._min},hr.prototype.intersects=function(t,e){return!(this._min>e||this._max<t)},hr.prototype.getMax=function(){return this._max},hr.prototype.toString=function(){return Z.toLineString(new b(this._min,0),new b(this._max,0))},hr.prototype.interfaces_=function(){return[]},hr.prototype.getClass=function(){return hr},pr.NodeComparator.get=function(){return dr},Object.defineProperties(hr,pr);var dr=function(){};dr.prototype.compare=function(t,e){var i=t,n=e,r=(i._min+i._max)/2,o=(n._min+n._max)/2;return r<o?-1:r>o?1:0},dr.prototype.interfaces_=function(){return[B]},dr.prototype.getClass=function(){return dr};var fr=function(t){function e(){t.call(this),this._item=null;var e=arguments[0],i=arguments[1],n=arguments[2];this._min=e,this._max=i,this._item=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.query=function(t,e,i){if(!this.intersects(t,e))return null;i.visitItem(this._item)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(hr),gr=function(t){function e(){t.call(this),this._node1=null,this._node2=null;var e=arguments[0],i=arguments[1];this._node1=e,this._node2=i,this.buildExtent(this._node1,this._node2)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.buildExtent=function(t,e){this._min=Math.min(t._min,e._min),this._max=Math.max(t._max,e._max)},e.prototype.query=function(t,e,i){if(!this.intersects(t,e))return null;null!==this._node1&&this._node1.query(t,e,i),null!==this._node2&&this._node2.query(t,e,i)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(hr),mr=function(){this._leaves=new Bt,this._root=null,this._level=0};mr.prototype.buildTree=function(){$e.sort(this._leaves,new hr.NodeComparator);for(var t=this._leaves,e=null,i=new Bt;;){if(this.buildLevel(t,i),1===i.size())return i.get(0);e=t,t=i,i=e}},mr.prototype.insert=function(t,e,i){if(null!==this._root)throw new Error("Index cannot be added to once it has been queried");this._leaves.add(new fr(t,e,i))},mr.prototype.query=function(t,e,i){this.init(),this._root.query(t,e,i)},mr.prototype.buildRoot=function(){if(null!==this._root)return null;this._root=this.buildTree()},mr.prototype.printNode=function(t){G.out.println(Z.toLineString(new b(t._min,this._level),new b(t._max,this._level)))},mr.prototype.init=function(){if(null!==this._root)return null;this.buildRoot()},mr.prototype.buildLevel=function(t,e){this._level++,e.clear();for(var i=0;i<t.size();i+=2){var n=t.get(i);if(null===(i+1<t.size()?t.get(i):null))e.add(n);else{var r=new gr(t.get(i),t.get(i+1));e.add(r)}}},mr.prototype.interfaces_=function(){return[]},mr.prototype.getClass=function(){return mr};var yr=function(){this._items=new Bt};yr.prototype.visitItem=function(t){this._items.add(t)},yr.prototype.getItems=function(){return this._items},yr.prototype.interfaces_=function(){return[Xe]},yr.prototype.getClass=function(){return yr};var vr=function(){this._index=null;var t=arguments[0];if(!O(t,Zt))throw new y("Argument must be Polygonal");this._index=new Cr(t)},_r={SegmentVisitor:{configurable:!0},IntervalIndexedGeometry:{configurable:!0}};vr.prototype.locate=function(t){var e=new st(t),i=new wr(e);return this._index.query(t.y,t.y,i),e.getLocation()},vr.prototype.interfaces_=function(){return[Ni]},vr.prototype.getClass=function(){return vr},_r.SegmentVisitor.get=function(){return wr},_r.IntervalIndexedGeometry.get=function(){return Cr},Object.defineProperties(vr,_r);var wr=function(){this._counter=null;var t=arguments[0];this._counter=t};wr.prototype.visitItem=function(t){var e=t;this._counter.countSegment(e.getCoordinate(0),e.getCoordinate(1))},wr.prototype.interfaces_=function(){return[Xe]},wr.prototype.getClass=function(){return wr};var Cr=function(){this._index=new mr;var t=arguments[0];this.init(t)};Cr.prototype.init=function(t){for(var e=bn.getLines(t).iterator();e.hasNext();){var i=e.next().getCoordinates();this.addLine(i)}},Cr.prototype.addLine=function(t){for(var e=1;e<t.length;e++){var i=new di(t[e-1],t[e]),n=Math.min(i.p0.y,i.p1.y),r=Math.max(i.p0.y,i.p1.y);this._index.insert(n,r,i)}},Cr.prototype.query=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],i=new yr;return this._index.query(t,e,i),i.getItems()}if(3===arguments.length){var n=arguments[0],r=arguments[1],o=arguments[2];this._index.query(n,r,o)}},Cr.prototype.interfaces_=function(){return[]},Cr.prototype.getClass=function(){return Cr};var Br=function(t){function e(){if(t.call(this),this._parentGeom=null,this._lineEdgeMap=new he,this._boundaryNodeRule=null,this._useBoundaryDeterminationRule=!0,this._argIndex=null,this._boundaryNodes=null,this._hasTooFewPoints=!1,this._invalidPoint=null,this._areaPtLocator=null,this._ptLocator=new En,2===arguments.length){var e=arguments[0],i=arguments[1],n=dt.OGC_SFS_BOUNDARY_RULE;this._argIndex=e,this._parentGeom=i,this._boundaryNodeRule=n,null!==i&&this.add(i)}else if(3===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2];this._argIndex=r,this._parentGeom=o,this._boundaryNodeRule=s,null!==o&&this.add(o)}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.insertBoundaryPoint=function(t,i){var n=this._nodes.addNode(i).getLabel(),r=1;n.getLocation(t,Ee.ON)===I.BOUNDARY&&r++;var o=e.determineBoundary(this._boundaryNodeRule,r);n.setLocation(t,o)},e.prototype.computeSelfNodes=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return this.computeSelfNodes(t,e,!1)}if(3===arguments.length){var i=arguments[0],n=arguments[1],r=arguments[2],o=new cr(i,!0,!1);o.setIsDoneIfProperInt(r);var s=this.createEdgeSetIntersector(),a=this._parentGeom instanceof ee||this._parentGeom instanceof $t||this._parentGeom instanceof ie,A=n||!a;return s.computeIntersections(this._edges,o,A),this.addSelfIntersectionNodes(this._argIndex),o}},e.prototype.computeSplitEdges=function(t){for(var e=this._edges.iterator();e.hasNext();)e.next().eiList.addSplitEdges(t)},e.prototype.computeEdgeIntersections=function(t,e,i){var n=new cr(e,i,!0);return n.setBoundaryNodes(this.getBoundaryNodes(),t.getBoundaryNodes()),this.createEdgeSetIntersector().computeIntersections(this._edges,t._edges,n),n},e.prototype.getGeometry=function(){return this._parentGeom},e.prototype.getBoundaryNodeRule=function(){return this._boundaryNodeRule},e.prototype.hasTooFewPoints=function(){return this._hasTooFewPoints},e.prototype.addPoint=function(){if(arguments[0]instanceof Jt){var t=arguments[0].getCoordinate();this.insertPoint(this._argIndex,t,I.INTERIOR)}else if(arguments[0]instanceof b){var e=arguments[0];this.insertPoint(this._argIndex,e,I.INTERIOR)}},e.prototype.addPolygon=function(t){this.addPolygonRing(t.getExteriorRing(),I.EXTERIOR,I.INTERIOR);for(var e=0;e<t.getNumInteriorRing();e++){var i=t.getInteriorRingN(e);this.addPolygonRing(i,I.INTERIOR,I.EXTERIOR)}},e.prototype.addEdge=function(t){this.insertEdge(t);var e=t.getCoordinates();this.insertPoint(this._argIndex,e[0],I.BOUNDARY),this.insertPoint(this._argIndex,e[e.length-1],I.BOUNDARY)},e.prototype.addLineString=function(t){var e=St.removeRepeatedPoints(t.getCoordinates());if(e.length<2)return this._hasTooFewPoints=!0,this._invalidPoint=e[0],null;var i=new en(e,new Te(this._argIndex,I.INTERIOR));this._lineEdgeMap.put(t,i),this.insertEdge(i),et.isTrue(e.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this._argIndex,e[0]),this.insertBoundaryPoint(this._argIndex,e[e.length-1])},e.prototype.getInvalidPoint=function(){return this._invalidPoint},e.prototype.getBoundaryPoints=function(){for(var t=this.getBoundaryNodes(),e=new Array(t.size()).fill(null),i=0,n=t.iterator();n.hasNext();){var r=n.next();e[i++]=r.getCoordinate().copy()}return e},e.prototype.getBoundaryNodes=function(){return null===this._boundaryNodes&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes},e.prototype.addSelfIntersectionNode=function(t,e,i){if(this.isBoundaryNode(t,e))return null;i===I.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(t,e):this.insertPoint(t,e,i)},e.prototype.addPolygonRing=function(t,e,i){if(t.isEmpty())return null;var n=St.removeRepeatedPoints(t.getCoordinates());if(n.length<4)return this._hasTooFewPoints=!0,this._invalidPoint=n[0],null;var r=e,o=i;at.isCCW(n)&&(r=i,o=e);var s=new en(n,new Te(this._argIndex,I.BOUNDARY,r,o));this._lineEdgeMap.put(t,s),this.insertEdge(s),this.insertPoint(this._argIndex,n[0],I.BOUNDARY)},e.prototype.insertPoint=function(t,e,i){var n=this._nodes.addNode(e),r=n.getLabel();null===r?n._label=new Te(t,i):r.setLocation(t,i)},e.prototype.createEdgeSetIntersector=function(){return new ur},e.prototype.addSelfIntersectionNodes=function(t){for(var e=this._edges.iterator();e.hasNext();)for(var i=e.next(),n=i.getLabel().getLocation(t),r=i.eiList.iterator();r.hasNext();){var o=r.next();this.addSelfIntersectionNode(t,o.coord,n)}},e.prototype.add=function(){if(1!==arguments.length)return t.prototype.add.apply(this,arguments);var e=arguments[0];if(e.isEmpty())return null;if(e instanceof ie&&(this._useBoundaryDeterminationRule=!1),e instanceof $t)this.addPolygon(e);else if(e instanceof Xt)this.addLineString(e);else if(e instanceof Jt)this.addPoint(e);else if(e instanceof te)this.addCollection(e);else if(e instanceof jt)this.addCollection(e);else if(e instanceof ie)this.addCollection(e);else{if(!(e instanceof Vt))throw new Error(e.getClass().getName());this.addCollection(e)}},e.prototype.addCollection=function(t){for(var e=0;e<t.getNumGeometries();e++){var i=t.getGeometryN(e);this.add(i)}},e.prototype.locate=function(t){return O(this._parentGeom,Zt)&&this._parentGeom.getNumGeometries()>50?(null===this._areaPtLocator&&(this._areaPtLocator=new vr(this._parentGeom)),this._areaPtLocator.locate(t)):this._ptLocator.locate(t,this._parentGeom)},e.prototype.findEdge=function(){if(1===arguments.length){var e=arguments[0];return this._lineEdgeMap.get(e)}return t.prototype.findEdge.apply(this,arguments)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.determineBoundary=function(t,e){return t.isInBoundary(e)?I.BOUNDARY:I.INTERIOR},e}(Ge),br=function(){if(this._li=new rt,this._resultPrecisionModel=null,this._arg=null,1===arguments.length){var t=arguments[0];this.setComputationPrecision(t.getPrecisionModel()),this._arg=new Array(1).fill(null),this._arg[0]=new Br(0,t)}else if(2===arguments.length){var e=arguments[0],i=arguments[1],n=dt.OGC_SFS_BOUNDARY_RULE;e.getPrecisionModel().compareTo(i.getPrecisionModel())>=0?this.setComputationPrecision(e.getPrecisionModel()):this.setComputationPrecision(i.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new Br(0,e,n),this._arg[1]=new Br(1,i,n)}else if(3===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2];r.getPrecisionModel().compareTo(o.getPrecisionModel())>=0?this.setComputationPrecision(r.getPrecisionModel()):this.setComputationPrecision(o.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new Br(0,r,s),this._arg[1]=new Br(1,o,s)}};br.prototype.getArgGeometry=function(t){return this._arg[t].getGeometry()},br.prototype.setComputationPrecision=function(t){this._resultPrecisionModel=t,this._li.setPrecisionModel(this._resultPrecisionModel)},br.prototype.interfaces_=function(){return[]},br.prototype.getClass=function(){return br};var Er=function(){};Er.prototype.interfaces_=function(){return[]},Er.prototype.getClass=function(){return Er},Er.map=function(){if(arguments[0]instanceof ct&&O(arguments[1],Er.MapOp)){for(var t=arguments[0],e=arguments[1],i=new Bt,n=0;n<t.getNumGeometries();n++){var r=e.map(t.getGeometryN(n));null!==r&&i.add(r)}return t.getFactory().buildGeometry(i)}if(O(arguments[0],_t)&&O(arguments[1],Er.MapOp)){for(var o=arguments[0],s=arguments[1],a=new Bt,A=o.iterator();A.hasNext();){var l=A.next(),c=s.map(l);null!==c&&a.add(c)}return a}},Er.MapOp=function(){};var Sr=function(t){function e(){var e=arguments[0],i=arguments[1];t.call(this,e,i),this._ptLocator=new En,this._geomFact=null,this._resultGeom=null,this._graph=null,this._edgeList=new zi,this._resultPolyList=new Bt,this._resultLineList=new Bt,this._resultPointList=new Bt,this._graph=new Ge(new Gi),this._geomFact=e.getFactory()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.insertUniqueEdge=function(t){var e=this._edgeList.findEqualEdge(t);if(null!==e){var i=e.getLabel(),n=t.getLabel();e.isPointwiseEqual(t)||(n=new Te(t.getLabel())).flip();var r=e.getDepth();r.isNull()&&r.add(i),r.add(n),i.merge(n)}else this._edgeList.add(t)},e.prototype.getGraph=function(){return this._graph},e.prototype.cancelDuplicateResultEdges=function(){for(var t=this._graph.getEdgeEnds().iterator();t.hasNext();){var e=t.next(),i=e.getSym();e.isInResult()&&i.isInResult()&&(e.setInResult(!1),i.setInResult(!1))}},e.prototype.isCoveredByLA=function(t){return!!this.isCovered(t,this._resultLineList)||!!this.isCovered(t,this._resultPolyList)},e.prototype.computeGeometry=function(t,i,n,r){var o=new Bt;return o.addAll(t),o.addAll(i),o.addAll(n),o.isEmpty()?e.createEmptyResult(r,this._arg[0].getGeometry(),this._arg[1].getGeometry(),this._geomFact):this._geomFact.buildGeometry(o)},e.prototype.mergeSymLabels=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();)t.next().getEdges().mergeSymLabels()},e.prototype.isCovered=function(t,e){for(var i=e.iterator();i.hasNext();){var n=i.next();if(this._ptLocator.locate(t,n)!==I.EXTERIOR)return!0}return!1},e.prototype.replaceCollapsedEdges=function(){for(var t=new Bt,e=this._edgeList.iterator();e.hasNext();){var i=e.next();i.isCollapsed()&&(e.remove(),t.add(i.getCollapsedEdge()))}this._edgeList.addAll(t)},e.prototype.updateNodeLabelling=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();){var e=t.next(),i=e.getEdges().getLabel();e.getLabel().merge(i)}},e.prototype.getResultGeometry=function(t){return this.computeOverlay(t),this._resultGeom},e.prototype.insertUniqueEdges=function(t){for(var e=t.iterator();e.hasNext();){var i=e.next();this.insertUniqueEdge(i)}},e.prototype.computeOverlay=function(t){this.copyPoints(0),this.copyPoints(1),this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1),this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!0);var e=new Bt;this._arg[0].computeSplitEdges(e),this._arg[1].computeSplitEdges(e),this.insertUniqueEdges(e),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),Gn.checkValid(this._edgeList.getEdges()),this._graph.addEdges(this._edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(t),this.cancelDuplicateResultEdges();var i=new Ke(this._geomFact);i.add(this._graph),this._resultPolyList=i.getPolygons();var n=new zn(this,this._geomFact,this._ptLocator);this._resultLineList=n.build(t);var r=new Wn(this,this._geomFact,this._ptLocator);this._resultPointList=r.build(t),this._resultGeom=this.computeGeometry(this._resultPointList,this._resultLineList,this._resultPolyList,t)},e.prototype.labelIncompleteNode=function(t,e){var i=this._ptLocator.locate(t.getCoordinate(),this._arg[e].getGeometry());t.getLabel().setLocation(e,i)},e.prototype.copyPoints=function(t){for(var e=this._arg[t].getNodeIterator();e.hasNext();){var i=e.next();this._graph.addNode(i.getCoordinate()).setLabel(t,i.getLabel().getLocation(t))}},e.prototype.findResultAreaEdges=function(t){for(var i=this._graph.getEdgeEnds().iterator();i.hasNext();){var n=i.next(),r=n.getLabel();r.isArea()&&!n.isInteriorAreaEdge()&&e.isResultOfOp(r.getLocation(0,Ee.RIGHT),r.getLocation(1,Ee.RIGHT),t)&&n.setInResult(!0)}},e.prototype.computeLabelsFromDepths=function(){for(var t=this._edgeList.iterator();t.hasNext();){var e=t.next(),i=e.getLabel(),n=e.getDepth();if(!n.isNull()){n.normalize();for(var r=0;r<2;r++)i.isNull(r)||!i.isArea()||n.isNull(r)||(0===n.getDelta(r)?i.toLine(r):(et.isTrue(!n.isNull(r,Ee.LEFT),"depth of LEFT side has not been initialized"),i.setLocation(r,Ee.LEFT,n.getLocation(r,Ee.LEFT)),et.isTrue(!n.isNull(r,Ee.RIGHT),"depth of RIGHT side has not been initialized"),i.setLocation(r,Ee.RIGHT,n.getLocation(r,Ee.RIGHT))))}}},e.prototype.computeLabelling=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();)t.next().getEdges().computeLabelling(this._arg);this.mergeSymLabels(),this.updateNodeLabelling()},e.prototype.labelIncompleteNodes=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();){var e=t.next(),i=e.getLabel();e.isIsolated()&&(i.isNull(0)?this.labelIncompleteNode(e,0):this.labelIncompleteNode(e,1)),e.getEdges().updateLabelling(i)}},e.prototype.isCoveredByA=function(t){return!!this.isCovered(t,this._resultPolyList)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(br);Sr.overlayOp=function(t,e,i){return new Sr(t,e).getResultGeometry(i)},Sr.intersection=function(t,e){if(t.isEmpty()||e.isEmpty())return Sr.createEmptyResult(Sr.INTERSECTION,t,e,t.getFactory());if(t.isGeometryCollection()){var i=e;return Kn.map(t,{interfaces_:function(){return[Er.MapOp]},map:function(t){return t.intersection(i)}})}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),or.overlayOp(t,e,Sr.INTERSECTION)},Sr.symDifference=function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return Sr.createEmptyResult(Sr.SYMDIFFERENCE,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),or.overlayOp(t,e,Sr.SYMDIFFERENCE)},Sr.resultDimension=function(t,e,i){var n=e.getDimension(),r=i.getDimension(),o=-1;switch(t){case Sr.INTERSECTION:o=Math.min(n,r);break;case Sr.UNION:o=Math.max(n,r);break;case Sr.DIFFERENCE:o=n;break;case Sr.SYMDIFFERENCE:o=Math.max(n,r)}return o},Sr.createEmptyResult=function(t,e,i,n){var r=null;switch(Sr.resultDimension(t,e,i)){case-1:r=n.createGeometryCollection(new Array(0).fill(null));break;case 0:r=n.createPoint();break;case 1:r=n.createLineString();break;case 2:r=n.createPolygon()}return r},Sr.difference=function(t,e){return t.isEmpty()?Sr.createEmptyResult(Sr.DIFFERENCE,t,e,t.getFactory()):e.isEmpty()?t.copy():(t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),or.overlayOp(t,e,Sr.DIFFERENCE))},Sr.isResultOfOp=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],i=t.getLocation(0),n=t.getLocation(1);return Sr.isResultOfOp(i,n,e)}if(3===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2];switch(r===I.BOUNDARY&&(r=I.INTERIOR),o===I.BOUNDARY&&(o=I.INTERIOR),s){case Sr.INTERSECTION:return r===I.INTERIOR&&o===I.INTERIOR;case Sr.UNION:return r===I.INTERIOR||o===I.INTERIOR;case Sr.DIFFERENCE:return r===I.INTERIOR&&o!==I.INTERIOR;case Sr.SYMDIFFERENCE:return r===I.INTERIOR&&o!==I.INTERIOR||r!==I.INTERIOR&&o===I.INTERIOR}return!1}},Sr.INTERSECTION=1,Sr.UNION=2,Sr.DIFFERENCE=3,Sr.SYMDIFFERENCE=4;var xr=function(){this._g=null,this._boundaryDistanceTolerance=null,this._linework=null,this._ptLocator=new En,this._seg=new di;var t=arguments[0],e=arguments[1];this._g=t,this._boundaryDistanceTolerance=e,this._linework=this.extractLinework(t)};xr.prototype.isWithinToleranceOfBoundary=function(t){for(var e=0;e<this._linework.getNumGeometries();e++)for(var i=this._linework.getGeometryN(e).getCoordinateSequence(),n=0;n<i.size()-1;n++)if(i.getCoordinate(n,this._seg.p0),i.getCoordinate(n+1,this._seg.p1),this._seg.distance(t)<=this._boundaryDistanceTolerance)return!0;return!1},xr.prototype.getLocation=function(t){return this.isWithinToleranceOfBoundary(t)?I.BOUNDARY:this._ptLocator.locate(t,this._g)},xr.prototype.extractLinework=function(t){var e=new Ir;t.apply(e);var i=e.getLinework(),n=me.toLineStringArray(i);return t.getFactory().createMultiLineString(n)},xr.prototype.interfaces_=function(){return[]},xr.prototype.getClass=function(){return xr};var Ir=function(){this._linework=null,this._linework=new Bt};Ir.prototype.getLinework=function(){return this._linework},Ir.prototype.filter=function(t){if(t instanceof $t){var e=t;this._linework.add(e.getExteriorRing());for(var i=0;i<e.getNumInteriorRing();i++)this._linework.add(e.getInteriorRingN(i))}},Ir.prototype.interfaces_=function(){return[Ht]},Ir.prototype.getClass=function(){return Ir};var Fr=function(){this._g=null,this._doLeft=!0,this._doRight=!0;var t=arguments[0];this._g=t};Fr.prototype.extractPoints=function(t,e,i){for(var n=t.getCoordinates(),r=0;r<n.length-1;r++)this.computeOffsetPoints(n[r],n[r+1],e,i)},Fr.prototype.setSidesToGenerate=function(t,e){this._doLeft=t,this._doRight=e},Fr.prototype.getPoints=function(t){for(var e=new Bt,i=bn.getLines(this._g).iterator();i.hasNext();){var n=i.next();this.extractPoints(n,t,e)}return e},Fr.prototype.computeOffsetPoints=function(t,e,i,n){var r=e.x-t.x,o=e.y-t.y,s=Math.sqrt(r*r+o*o),a=i*r/s,A=i*o/s,l=(e.x+t.x)/2,c=(e.y+t.y)/2;if(this._doLeft){var u=new b(l-A,c+a);n.add(u)}if(this._doRight){var h=new b(l+A,c-a);n.add(h)}},Fr.prototype.interfaces_=function(){return[]},Fr.prototype.getClass=function(){return Fr};var Or=function t(){this._geom=null,this._locFinder=null,this._location=new Array(3).fill(null),this._invalidLocation=null,this._boundaryDistanceTolerance=t.TOLERANCE,this._testCoords=new Bt;var e=arguments[0],i=arguments[1],n=arguments[2];this._boundaryDistanceTolerance=t.computeBoundaryDistanceTolerance(e,i),this._geom=[e,i,n],this._locFinder=[new xr(this._geom[0],this._boundaryDistanceTolerance),new xr(this._geom[1],this._boundaryDistanceTolerance),new xr(this._geom[2],this._boundaryDistanceTolerance)]},Pr={TOLERANCE:{configurable:!0}};Or.prototype.reportResult=function(t,e,i){G.out.println("Overlay result invalid - A:"+I.toLocationSymbol(e[0])+" B:"+I.toLocationSymbol(e[1])+" expected:"+(i?"i":"e")+" actual:"+I.toLocationSymbol(e[2]))},Or.prototype.isValid=function(t){return this.addTestPts(this._geom[0]),this.addTestPts(this._geom[1]),this.checkValid(t)},Or.prototype.checkValid=function(){if(1===arguments.length){for(var t=arguments[0],e=0;e<this._testCoords.size();e++){var i=this._testCoords.get(e);if(!this.checkValid(t,i))return this._invalidLocation=i,!1}return!0}if(2===arguments.length){var n=arguments[0],r=arguments[1];return this._location[0]=this._locFinder[0].getLocation(r),this._location[1]=this._locFinder[1].getLocation(r),this._location[2]=this._locFinder[2].getLocation(r),!!Or.hasLocation(this._location,I.BOUNDARY)||this.isValidResult(n,this._location)}},Or.prototype.addTestPts=function(t){var e=new Fr(t);this._testCoords.addAll(e.getPoints(5*this._boundaryDistanceTolerance))},Or.prototype.isValidResult=function(t,e){var i=Sr.isResultOfOp(e[0],e[1],t),n=!(i^e[2]===I.INTERIOR);return n||this.reportResult(t,e,i),n},Or.prototype.getInvalidLocation=function(){return this._invalidLocation},Or.prototype.interfaces_=function(){return[]},Or.prototype.getClass=function(){return Or},Or.hasLocation=function(t,e){for(var i=0;i<3;i++)if(t[i]===e)return!0;return!1},Or.computeBoundaryDistanceTolerance=function(t,e){return Math.min(Yn.computeSizeBasedSnapTolerance(t),Yn.computeSizeBasedSnapTolerance(e))},Or.isValid=function(t,e,i,n){return new Or(t,e,n).isValid(i)},Pr.TOLERANCE.get=function(){return 1e-6},Object.defineProperties(Or,Pr);var Tr=function t(e){this._geomFactory=null,this._skipEmpty=!1,this._inputGeoms=null,this._geomFactory=t.extractFactory(e),this._inputGeoms=e};Tr.prototype.extractElements=function(t,e){if(null===t)return null;for(var i=0;i<t.getNumGeometries();i++){var n=t.getGeometryN(i);this._skipEmpty&&n.isEmpty()||e.add(n)}},Tr.prototype.combine=function(){for(var t=new Bt,e=this._inputGeoms.iterator();e.hasNext();){var i=e.next();this.extractElements(i,t)}return 0===t.size()?null!==this._geomFactory?this._geomFactory.createGeometryCollection(null):null:this._geomFactory.buildGeometry(t)},Tr.prototype.interfaces_=function(){return[]},Tr.prototype.getClass=function(){return Tr},Tr.combine=function(){if(1===arguments.length){var t=arguments[0];return new Tr(t).combine()}if(2===arguments.length){var e=arguments[0],i=arguments[1];return new Tr(Tr.createList(e,i)).combine()}if(3===arguments.length){var n=arguments[0],r=arguments[1],o=arguments[2];return new Tr(Tr.createList(n,r,o)).combine()}},Tr.extractFactory=function(t){return t.isEmpty()?null:t.iterator().next().getFactory()},Tr.createList=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],i=new Bt;return i.add(t),i.add(e),i}if(3===arguments.length){var n=arguments[0],r=arguments[1],o=arguments[2],s=new Bt;return s.add(n),s.add(r),s.add(o),s}};var Lr=function(){this._inputPolys=null,this._geomFactory=null;var t=arguments[0];this._inputPolys=t,null===this._inputPolys&&(this._inputPolys=new Bt)},Mr={STRTREE_NODE_CAPACITY:{configurable:!0}};Lr.prototype.reduceToGeometries=function(t){for(var e=new Bt,i=t.iterator();i.hasNext();){var n=i.next(),r=null;O(n,Ct)?r=this.unionTree(n):n instanceof ct&&(r=n),e.add(r)}return e},Lr.prototype.extractByEnvelope=function(t,e,i){for(var n=new Bt,r=0;r<e.getNumGeometries();r++){var o=e.getGeometryN(r);o.getEnvelopeInternal().intersects(t)?n.add(o):i.add(o)}return this._geomFactory.buildGeometry(n)},Lr.prototype.unionOptimized=function(t,e){var i=t.getEnvelopeInternal(),n=e.getEnvelopeInternal();if(!i.intersects(n))return Tr.combine(t,e);if(t.getNumGeometries()<=1&&e.getNumGeometries()<=1)return this.unionActual(t,e);var r=i.intersection(n);return this.unionUsingEnvelopeIntersection(t,e,r)},Lr.prototype.union=function(){if(null===this._inputPolys)throw new Error("union() method cannot be called twice");if(this._inputPolys.isEmpty())return null;this._geomFactory=this._inputPolys.iterator().next().getFactory();for(var t=new oi(Lr.STRTREE_NODE_CAPACITY),e=this._inputPolys.iterator();e.hasNext();){var i=e.next();t.insert(i.getEnvelopeInternal(),i)}this._inputPolys=null;var n=t.itemsTree();return this.unionTree(n)},Lr.prototype.binaryUnion=function(){if(1===arguments.length){var t=arguments[0];return this.binaryUnion(t,0,t.size())}if(3===arguments.length){var e=arguments[0],i=arguments[1],n=arguments[2];if(n-i<=1){var r=Lr.getGeometry(e,i);return this.unionSafe(r,null)}if(n-i==2)return this.unionSafe(Lr.getGeometry(e,i),Lr.getGeometry(e,i+1));var o=Math.trunc((n+i)/2),s=this.binaryUnion(e,i,o),a=this.binaryUnion(e,o,n);return this.unionSafe(s,a)}},Lr.prototype.repeatedUnion=function(t){for(var e=null,i=t.iterator();i.hasNext();){var n=i.next();e=null===e?n.copy():e.union(n)}return e},Lr.prototype.unionSafe=function(t,e){return null===t&&null===e?null:null===t?e.copy():null===e?t.copy():this.unionOptimized(t,e)},Lr.prototype.unionActual=function(t,e){return Lr.restrictToPolygons(t.union(e))},Lr.prototype.unionTree=function(t){var e=this.reduceToGeometries(t);return this.binaryUnion(e)},Lr.prototype.unionUsingEnvelopeIntersection=function(t,e,i){var n=new Bt,r=this.extractByEnvelope(i,t,n),o=this.extractByEnvelope(i,e,n),s=this.unionActual(r,o);return n.add(s),Tr.combine(n)},Lr.prototype.bufferUnion=function(){if(1===arguments.length){var t=arguments[0];return t.get(0).getFactory().buildGeometry(t).buffer(0)}if(2===arguments.length){var e=arguments[0],i=arguments[1];return e.getFactory().createGeometryCollection([e,i]).buffer(0)}},Lr.prototype.interfaces_=function(){return[]},Lr.prototype.getClass=function(){return Lr},Lr.restrictToPolygons=function(t){if(O(t,Zt))return t;var e=Bn.getPolygons(t);return 1===e.size()?e.get(0):t.getFactory().createMultiPolygon(me.toPolygonArray(e))},Lr.getGeometry=function(t,e){return e>=t.size()?null:t.get(e)},Lr.union=function(t){return new Lr(t).union()},Mr.STRTREE_NODE_CAPACITY.get=function(){return 4},Object.defineProperties(Lr,Mr);var Ur=function(){};Ur.prototype.interfaces_=function(){return[]},Ur.prototype.getClass=function(){return Ur},Ur.union=function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return Sr.createEmptyResult(Sr.UNION,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),or.overlayOp(t,e,Sr.UNION)},t.GeoJSONReader=Be,t.GeoJSONWriter=be,t.OverlayOp=Sr,t.UnionOp=Ur,t.BufferOp=fn,Object.defineProperty(t,"__esModule",{value:!0})}(e)},function(t,e,i){"use strict";(function(e){var n=i(2),r=i(30),o=i(10),s={"Content-Type":"application/x-www-form-urlencoded"};function a(t,e){!n.isUndefined(t)&&n.isUndefined(t["Content-Type"])&&(t["Content-Type"]=e)}var A,l={transitional:{silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},adapter:(("undefined"!=typeof XMLHttpRequest||void 0!==e&&"[object process]"===Object.prototype.toString.call(e))&&(A=i(11)),A),transformRequest:[function(t,e){return r(e,"Accept"),r(e,"Content-Type"),n.isFormData(t)||n.isArrayBuffer(t)||n.isBuffer(t)||n.isStream(t)||n.isFile(t)||n.isBlob(t)?t:n.isArrayBufferView(t)?t.buffer:n.isURLSearchParams(t)?(a(e,"application/x-www-form-urlencoded;charset=utf-8"),t.toString()):n.isObject(t)||e&&"application/json"===e["Content-Type"]?(a(e,"application/json"),function(t,e,i){if(n.isString(t))try{return(e||JSON.parse)(t),n.trim(t)}catch(t){if("SyntaxError"!==t.name)throw t}return(i||JSON.stringify)(t)}(t)):t}],transformResponse:[function(t){var e=this.transitional,i=e&&e.silentJSONParsing,r=e&&e.forcedJSONParsing,s=!i&&"json"===this.responseType;if(s||r&&n.isString(t)&&t.length)try{return JSON.parse(t)}catch(t){if(s){if("SyntaxError"===t.name)throw o(t,this,"E_JSON_PARSE");throw t}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(t){return t>=200&&t<300}};l.headers={common:{Accept:"application/json, text/plain, */*"}},n.forEach(["delete","get","head"],(function(t){l.headers[t]={}})),n.forEach(["post","put","patch"],(function(t){l.headers[t]=n.merge(s)})),t.exports=l}).call(this,i(29))},function(t,e){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(t){"object"==typeof window&&(i=window)}t.exports=i},function(t,e,i){"use strict";t.exports=function(t,e){return function(){for(var i=new Array(arguments.length),n=0;n<i.length;n++)i[n]=arguments[n];return t.apply(e,i)}}},function(t,e,i){"use strict";var n=i(2);function r(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}t.exports=function(t,e,i){if(!e)return t;var o;if(i)o=i(e);else if(n.isURLSearchParams(e))o=e.toString();else{var s=[];n.forEach(e,(function(t,e){null!=t&&(n.isArray(t)?e+="[]":t=[t],n.forEach(t,(function(t){n.isDate(t)?t=t.toISOString():n.isObject(t)&&(t=JSON.stringify(t)),s.push(r(e)+"="+r(t))})))})),o=s.join("&")}if(o){var a=t.indexOf("#");-1!==a&&(t=t.slice(0,a)),t+=(-1===t.indexOf("?")?"?":"&")+o}return t}},function(t,e,i){"use strict";t.exports=function(t,e,i,n,r){return t.config=e,i&&(t.code=i),t.request=n,t.response=r,t.isAxiosError=!0,t.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},t}},function(t,e,i){"use strict";var n=i(2),r=i(31),o=i(32),s=i(9),a=i(33),A=i(36),l=i(37),c=i(12);t.exports=function(t){return new Promise((function(e,i){var u=t.data,h=t.headers,p=t.responseType;n.isFormData(u)&&delete h["Content-Type"];var d=new XMLHttpRequest;if(t.auth){var f=t.auth.username||"",g=t.auth.password?unescape(encodeURIComponent(t.auth.password)):"";h.Authorization="Basic "+btoa(f+":"+g)}var m=a(t.baseURL,t.url);function y(){if(d){var n="getAllResponseHeaders"in d?A(d.getAllResponseHeaders()):null,o={data:p&&"text"!==p&&"json"!==p?d.response:d.responseText,status:d.status,statusText:d.statusText,headers:n,config:t,request:d};r(e,i,o),d=null}}if(d.open(t.method.toUpperCase(),s(m,t.params,t.paramsSerializer),!0),d.timeout=t.timeout,"onloadend"in d?d.onloadend=y:d.onreadystatechange=function(){d&&4===d.readyState&&(0!==d.status||d.responseURL&&0===d.responseURL.indexOf("file:"))&&setTimeout(y)},d.onabort=function(){d&&(i(c("Request aborted",t,"ECONNABORTED",d)),d=null)},d.onerror=function(){i(c("Network Error",t,null,d)),d=null},d.ontimeout=function(){var e="timeout of "+t.timeout+"ms exceeded";t.timeoutErrorMessage&&(e=t.timeoutErrorMessage),i(c(e,t,t.transitional&&t.transitional.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",d)),d=null},n.isStandardBrowserEnv()){var v=(t.withCredentials||l(m))&&t.xsrfCookieName?o.read(t.xsrfCookieName):void 0;v&&(h[t.xsrfHeaderName]=v)}"setRequestHeader"in d&&n.forEach(h,(function(t,e){void 0===u&&"content-type"===e.toLowerCase()?delete h[e]:d.setRequestHeader(e,t)})),n.isUndefined(t.withCredentials)||(d.withCredentials=!!t.withCredentials),p&&"json"!==p&&(d.responseType=t.responseType),"function"==typeof t.onDownloadProgress&&d.addEventListener("progress",t.onDownloadProgress),"function"==typeof t.onUploadProgress&&d.upload&&d.upload.addEventListener("progress",t.onUploadProgress),t.cancelToken&&t.cancelToken.promise.then((function(t){d&&(d.abort(),i(t),d=null)})),u||(u=null),d.send(u)}))}},function(t,e,i){"use strict";var n=i(10);t.exports=function(t,e,i,r,o){var s=new Error(t);return n(s,e,i,r,o)}},function(t,e,i){"use strict";t.exports=function(t){return!(!t||!t.__CANCEL__)}},function(t,e,i){"use strict";var n=i(2);t.exports=function(t,e){e=e||{};var i={},r=["url","method","data"],o=["headers","auth","proxy","params"],s=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],a=["validateStatus"];function A(t,e){return n.isPlainObject(t)&&n.isPlainObject(e)?n.merge(t,e):n.isPlainObject(e)?n.merge({},e):n.isArray(e)?e.slice():e}function l(r){n.isUndefined(e[r])?n.isUndefined(t[r])||(i[r]=A(void 0,t[r])):i[r]=A(t[r],e[r])}n.forEach(r,(function(t){n.isUndefined(e[t])||(i[t]=A(void 0,e[t]))})),n.forEach(o,l),n.forEach(s,(function(r){n.isUndefined(e[r])?n.isUndefined(t[r])||(i[r]=A(void 0,t[r])):i[r]=A(void 0,e[r])})),n.forEach(a,(function(n){n in e?i[n]=A(t[n],e[n]):n in t&&(i[n]=A(void 0,t[n]))}));var c=r.concat(o).concat(s).concat(a),u=Object.keys(t).concat(Object.keys(e)).filter((function(t){return-1===c.indexOf(t)}));return n.forEach(u,l),i}},function(t,e,i){"use strict";function n(t){this.message=t}n.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},n.prototype.__CANCEL__=!0,t.exports=n},function(t){t.exports=JSON.parse('{"c010101":"The initial configuration file is incorrectly filled in","c010102":"KMap3D static resource acquisition failed","c010103":"Failed to obtain cloud platform configuration items","c010104":"Failed to get Sprite","c010105":"Failed to obtain cloud platform base map configuration","c010106":"Failed to obtain cloud platform terrain configuration","c010107":"Error getting the visual boundary of the map","c010108":"Terrain service is not configured","c010109":"Sprite is not configured correctly","c010110":"The scene information corresponding to the ID cannot be found","c010111":"Earth instance not initialized","c010112":"Already in this scene","c010113":"Layer instance does not exist","c020201":"Error in layer loading","c020202":"The service address is incorrect","c020203":"Service access-token exception","c030101":"Model ID is incorrect","c030102":"Model loading error","c030201":"Binding Control, deletion not allowed","c040101":"Can\'t find historical track data","c040102":"Error getting czml file","c040201":"Can\'t find path planning data","c040301":"Error occurred in websocket subscription","c070201":"The tilt angle is too low, please increase the map tilt angle","c070101":"Cannot edit in the current state","c080501":"Unsupported solution type","CHOOSE_START":"Choose a starting point","CHOOSE_END":"Choose the end","ADD_NEXT_POINT":"Click to add next point","CLICK_STOP_DRAW":"Click to end drawing","DOUBLE_CLICK_STOP_DRAW":"Double click to end drawing","RIGHT_CLICK_CANCEL_DRAW":"Right click to cancel drawing","MOVE_CONTROL_POINT":"Move control point","MOVE_ADD_NEW_CONTROL_POINT":"Move to create new control points","LEFT_STOP_MOVE_AND_RIGHT_STOP_EDIT":"Left click to stop moving, then right click to end editing","RADIUS":"radius"}')},function(t){t.exports=JSON.parse('{"c010101":"初始化配置文件填写错误","c010102":"KMap3D静态资源获取失败","c010103":"获取云平台配置项失败","c010104":"获取雪碧图失败","c010105":"获取云平台底图配置失败","c010106":"获取云平台地形配置失败","c010107":"获取地图可视边界范围出错","c010108":"地形服务没有配置","c010109":"雪碧图未正确配置","c010110":"找不到该ID对应的场景信息","c010111":"地球实例未初始化完成","c010112":"已处于该场景","c010113":"图层实例初始化失败","c020201":"图层加载发生错误","c020202":"服务地址不正确","c020203":"服务鉴权异常","c030101":"模型ID不正确","c030102":"模型加载发生错误","c030201":"绑定控件时，无法删除","c040101":"查询不到历史轨迹数据","c040102":"czml文件获取发生错误","c040201":"查询不到路径规划数据","c040301":"websocket订阅发生错误","c070201":"倾斜角过低，请增大地图倾斜角度","c070101":"当前状态无法编辑","c080501":"不支持的solution类型","CHOOSE_START":"选择起点","CHOOSE_END":"选择终点","ADD_NEXT_POINT":"点击添加下一个点","CLICK_STOP_DRAW":"单击结束绘制","DOUBLE_CLICK_STOP_DRAW":"双击结束绘制","RIGHT_CLICK_CANCEL_DRAW":"右击取消绘制","MOVE_CONTROL_POINT":"移动控制点","MOVE_ADD_NEW_CONTROL_POINT":"移动创建新的控制点","LEFT_STOP_MOVE_AND_RIGHT_STOP_EDIT":"左键停止移动，之后右键结束编辑","RADIUS":"半径"}')},function(t){t.exports=JSON.parse('{"c010101":"Le fichier de configuration initiale est incorrectement rempli","c010102":"Échec de l\'acquisition des ressources statiques KMap3D","c010103":"Échec d\'obtention des éléments de configuration de la plate-forme cloud","c010104":"Échec d\'obtention du Sprite","c010105":"Échec d\'obtention de la configuration de la carte de base de la plate-forme cloud","c010106":"Échec d\'obtention de la configuration du terrain de la plate-forme cloud","c010107":"Erreur lors de l\'obtention de la limite visuelle de la carte","c010108":"Le service de terrain n\'est pas configuré","c010109":"Le sprite n\'est pas configuré correctement","c010110":"Les infos de la scène correspondant à l\'ID sont introuvables.","c010111":"Instance terrestre non initialisée terminée","c010112":"Déjà dans ce scénario","c010113":"L\'initialisation de l\'Instance de calque a échoué","c020201":"Erreur dans le chargement des couches","c020202":"Adresse de service incorrecte","c020203":"Anomalies de l\'identification du Service","c030101":"L\'ID du modèle est incorrect","c030102":"Erreur de chargement du modèle","c030201":"Contrôles avec bIND, ne permettent pas la suppression","c040101":"Impossible de trouver les données historiques des pistes","c040102":"Erreur d\'obtention du fichier czml","c040201":"Les données de planification des pistes sont introuvables","c040301":"Une erreur s\'est produite dans l\'abonnement au websocket","c070201":"Angle d\'inclinaison trop bas, veuillez augmenter l\'angle d\'inclinaison de la carte","c070101":"Impossible d\'éditer dans l\'état actuel","c080501":"Type de solution non pris en charge","CHOOSE_START":"Choisir un point de départ","CHOOSE_END":"Choisir l\'arrivée","ADD_NEXT_POINT":"Cliquez pour ajouter le point suivant","CLICK_STOP_DRAW":"Cliquez sur terminer le dessin","DOUBLE_CLICK_STOP_DRAW":"Double-cliquez pour finir le dessin","RIGHT_CLICK_CANCEL_DRAW":"Cliquez à droite pour annuler le dessin","MOVE_CONTROL_POINT":"Point de contrôle mobile","MOVE_ADD_NEW_CONTROL_POINT":"Déplacer pour créer de nouveaux points de contrôle","LEFT_STOP_MOVE_AND_RIGHT_STOP_EDIT":"Clic gauche pour arrêter tout mouvement, clic droit pour finaliser la modification","RADIUS":"Rayon"}')},function(t,e,i){t.exports=i(24)},function(t,e,i){"use strict";var n=i(43),r=i(44),o=i(45),s=i(48).orient2d;function a(t,e,i){e=Math.max(0,void 0===e?2:e),i=i||0;var r=function(t){for(var e=t[0],i=t[0],n=t[0],r=t[0],s=0;s<t.length;s++){var a=t[s];a[0]<e[0]&&(e=a),a[0]>n[0]&&(n=a),a[1]<i[1]&&(i=a),a[1]>r[1]&&(r=a)}var A=[e,i,n,r],l=A.slice();for(s=0;s<t.length;s++)o(t[s],A)||l.push(t[s]);return function(t){t.sort(v);for(var e=[],i=0;i<t.length;i++){for(;e.length>=2&&p(e[e.length-2],e[e.length-1],t[i])<=0;)e.pop();e.push(t[i])}for(var n=[],r=t.length-1;r>=0;r--){for(;n.length>=2&&p(n[n.length-2],n[n.length-1],t[r])<=0;)n.pop();n.push(t[r])}return n.pop(),e.pop(),e.concat(n)}(l)}(t),s=new n(16);s.toBBox=function(t){return{minX:t[0],minY:t[1],maxX:t[0],maxY:t[1]}},s.compareMinX=function(t,e){return t[0]-e[0]},s.compareMinY=function(t,e){return t[1]-e[1]},s.load(t);for(var a,l=[],c=0;c<r.length;c++){var u=r[c];s.remove(u),a=f(u,a),l.push(a)}var h=new n(16);for(c=0;c<l.length;c++)h.insert(d(l[c]));for(var m=e*e,y=i*i;l.length;){var _=l.shift(),w=_.p,C=_.next.p,B=g(w,C);if(!(B<y)){var b=B/m;(u=A(s,_.prev.p,w,C,_.next.next.p,b,h))&&Math.min(g(u,w),g(u,C))<=b&&(l.push(_),l.push(f(u,_)),s.remove(u),h.remove(_),h.insert(d(_)),h.insert(d(_.next)))}}_=a;var E=[];do{E.push(_.p),_=_.next}while(_!==a);return E.push(_.p),E}function A(t,e,i,n,o,s,a){for(var A=new r([],l),u=t.data;u;){for(var p=0;p<u.children.length;p++){var d=u.children[p],f=u.leaf?m(d,i,n):c(i,n,d);f>s||A.push({node:d,dist:f})}for(;A.length&&!A.peek().node.children;){var g=A.pop(),y=g.node,v=m(y,e,i),_=m(y,n,o);if(g.dist<v&&g.dist<_&&h(i,y,a)&&h(n,y,a))return y}(u=A.pop())&&(u=u.node)}return null}function l(t,e){return t.dist-e.dist}function c(t,e,i){if(u(t,i)||u(e,i))return 0;var n=y(t[0],t[1],e[0],e[1],i.minX,i.minY,i.maxX,i.minY);if(0===n)return 0;var r=y(t[0],t[1],e[0],e[1],i.minX,i.minY,i.minX,i.maxY);if(0===r)return 0;var o=y(t[0],t[1],e[0],e[1],i.maxX,i.minY,i.maxX,i.maxY);if(0===o)return 0;var s=y(t[0],t[1],e[0],e[1],i.minX,i.maxY,i.maxX,i.maxY);return 0===s?0:Math.min(n,r,o,s)}function u(t,e){return t[0]>=e.minX&&t[0]<=e.maxX&&t[1]>=e.minY&&t[1]<=e.maxY}function h(t,e,i){for(var n,r,o,s,a=Math.min(t[0],e[0]),A=Math.min(t[1],e[1]),l=Math.max(t[0],e[0]),c=Math.max(t[1],e[1]),u=i.search({minX:a,minY:A,maxX:l,maxY:c}),h=0;h<u.length;h++)if(n=u[h].p,r=u[h].next.p,o=t,n!==(s=e)&&r!==o&&p(n,r,o)>0!=p(n,r,s)>0&&p(o,s,n)>0!=p(o,s,r)>0)return!1;return!0}function p(t,e,i){return s(t[0],t[1],e[0],e[1],i[0],i[1])}function d(t){var e=t.p,i=t.next.p;return t.minX=Math.min(e[0],i[0]),t.minY=Math.min(e[1],i[1]),t.maxX=Math.max(e[0],i[0]),t.maxY=Math.max(e[1],i[1]),t}function f(t,e){var i={p:t,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return e?(i.next=e.next,i.prev=e,e.next.prev=i,e.next=i):(i.prev=i,i.next=i),i}function g(t,e){var i=t[0]-e[0],n=t[1]-e[1];return i*i+n*n}function m(t,e,i){var n=e[0],r=e[1],o=i[0]-n,s=i[1]-r;if(0!==o||0!==s){var a=((t[0]-n)*o+(t[1]-r)*s)/(o*o+s*s);a>1?(n=i[0],r=i[1]):a>0&&(n+=o*a,r+=s*a)}return(o=t[0]-n)*o+(s=t[1]-r)*s}function y(t,e,i,n,r,o,s,a){var A,l,c,u,h=i-t,p=n-e,d=s-r,f=a-o,g=t-r,m=e-o,y=h*h+p*p,v=h*d+p*f,_=d*d+f*f,w=h*g+p*m,C=d*g+f*m,B=y*_-v*v,b=B,E=B;0===B?(l=0,b=1,u=C,E=_):(u=y*C-v*w,(l=v*C-_*w)<0?(l=0,u=C,E=_):l>b&&(l=b,u=C+v,E=_)),u<0?(u=0,-w<0?l=0:-w>y?l=b:(l=-w,b=y)):u>E&&(u=E,-w+v<0?l=0:-w+v>y?l=b:(l=-w+v,b=y));var S=(1-(c=0===u?0:u/E))*r+c*s-((1-(A=0===l?0:l/b))*t+A*i),x=(1-c)*o+c*a-((1-A)*e+A*n);return S*S+x*x}function v(t,e){return t[0]===e[0]?t[1]-e[1]:t[0]-e[0]}r.default&&(r=r.default),t.exports=a,t.exports.default=a},function(t,e,i){
/*!
 * html2canvas 1.4.1 <https://html2canvas.hertzen.com>
 * Copyright (c) 2022 Niklas von Hertzen <https://hertzen.com>
 * Released under MIT License
 */
t.exports=function(){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(e,i)};function e(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}var i=function(){return(i=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};function n(t,e,i,n){return new(i||(i=Promise))((function(r,o){function s(t){try{A(n.next(t))}catch(t){o(t)}}function a(t){try{A(n.throw(t))}catch(t){o(t)}}function A(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(s,a)}A((n=n.apply(t,e||[])).next())}))}function r(t,e){var i,n,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,n&&(r=2&o[0]?n.return:o[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,o[1])).done)return r;switch(n=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((r=(r=s.trys).length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],n=0}finally{i=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function o(t,e,i){if(i||2===arguments.length)for(var n,r=0,o=e.length;r<o;r++)!n&&r in e||(n||(n=Array.prototype.slice.call(e,0,r)),n[r]=e[r]);return t.concat(n||e)}for(var s=function(){function t(t,e,i,n){this.left=t,this.top=e,this.width=i,this.height=n}return t.prototype.add=function(e,i,n,r){return new t(this.left+e,this.top+i,this.width+n,this.height+r)},t.fromClientRect=function(e,i){return new t(i.left+e.windowBounds.left,i.top+e.windowBounds.top,i.width,i.height)},t.fromDOMRectList=function(e,i){var n=Array.from(i).find((function(t){return 0!==t.width}));return n?new t(n.left+e.windowBounds.left,n.top+e.windowBounds.top,n.width,n.height):t.EMPTY},t.EMPTY=new t(0,0,0,0),t}(),a=function(t,e){return s.fromClientRect(t,e.getBoundingClientRect())},A=function(t){for(var e=[],i=0,n=t.length;i<n;){var r=t.charCodeAt(i++);if(r>=55296&&r<=56319&&i<n){var o=t.charCodeAt(i++);56320==(64512&o)?e.push(((1023&r)<<10)+(1023&o)+65536):(e.push(r),i--)}else e.push(r)}return e},l=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(String.fromCodePoint)return String.fromCodePoint.apply(String,t);var i=t.length;if(!i)return"";for(var n=[],r=-1,o="";++r<i;){var s=t[r];s<=65535?n.push(s):(s-=65536,n.push(55296+(s>>10),s%1024+56320)),(r+1===i||n.length>16384)&&(o+=String.fromCharCode.apply(String,n),n.length=0)}return o},c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",u="undefined"==typeof Uint8Array?[]:new Uint8Array(256),h=0;h<c.length;h++)u[c.charCodeAt(h)]=h;for(var p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",d="undefined"==typeof Uint8Array?[]:new Uint8Array(256),f=0;f<p.length;f++)d[p.charCodeAt(f)]=f;for(var g=function(t,e,i){return t.slice?t.slice(e,i):new Uint16Array(Array.prototype.slice.call(t,e,i))},m=function(){function t(t,e,i,n,r,o){this.initialValue=t,this.errorValue=e,this.highStart=i,this.highValueIndex=n,this.index=r,this.data=o}return t.prototype.get=function(t){var e;if(t>=0){if(t<55296||t>56319&&t<=65535)return e=((e=this.index[t>>5])<<2)+(31&t),this.data[e];if(t<=65535)return e=((e=this.index[2048+(t-55296>>5)])<<2)+(31&t),this.data[e];if(t<this.highStart)return e=2080+(t>>11),e=this.index[e],e+=t>>5&63,e=((e=this.index[e])<<2)+(31&t),this.data[e];if(t<=1114111)return this.data[this.highValueIndex]}return this.errorValue},t}(),y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",v="undefined"==typeof Uint8Array?[]:new Uint8Array(256),_=0;_<y.length;_++)v[y.charCodeAt(_)]=_;var w=10,C=13,B=15,b=17,E=18,S=19,x=20,I=21,F=22,O=24,P=25,T=26,L=27,M=28,U=30,D=32,Q=33,R=34,N=35,H=37,k=38,V=39,j=40,G=42,K=[9001,65288],z=function(t,e){var i,n,r,o=function(t){var e,i,n,r,o,s=.75*t.length,a=t.length,A=0;"="===t[t.length-1]&&(s--,"="===t[t.length-2]&&s--);var l="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array&&void 0!==Uint8Array.prototype.slice?new ArrayBuffer(s):new Array(s),c=Array.isArray(l)?l:new Uint8Array(l);for(e=0;e<a;e+=4)i=d[t.charCodeAt(e)],n=d[t.charCodeAt(e+1)],r=d[t.charCodeAt(e+2)],o=d[t.charCodeAt(e+3)],c[A++]=i<<2|n>>4,c[A++]=(15&n)<<4|r>>2,c[A++]=(3&r)<<6|63&o;return l}(t),s=Array.isArray(o)?function(t){for(var e=t.length,i=[],n=0;n<e;n+=4)i.push(t[n+3]<<24|t[n+2]<<16|t[n+1]<<8|t[n]);return i}(o):new Uint32Array(o),a=Array.isArray(o)?function(t){for(var e=t.length,i=[],n=0;n<e;n+=2)i.push(t[n+1]<<8|t[n]);return i}(o):new Uint16Array(o),A=g(a,12,s[4]/2),l=2===s[5]?g(a,(24+s[4])/2):(i=s,n=Math.ceil((24+s[4])/4),i.slice?i.slice(n,r):new Uint32Array(Array.prototype.slice.call(i,n,r)));return new m(s[0],s[1],s[2],s[3],A,l)}("KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA=="),W=[U,36],q=[1,2,3,5],X=[w,8],Y=[L,T],J=q.concat(X),Z=[k,V,j,R,N],$=[B,C],tt=function(t,e,i,n){var r=n[i];if(Array.isArray(t)?-1!==t.indexOf(r):t===r)for(var o=i;o<=n.length;){if((A=n[++o])===e)return!0;if(A!==w)break}if(r===w)for(o=i;o>0;){var s=n[--o];if(Array.isArray(t)?-1!==t.indexOf(s):t===s)for(var a=i;a<=n.length;){var A;if((A=n[++a])===e)return!0;if(A!==w)break}if(s!==w)break}return!1},et=function(t,e){for(var i=t;i>=0;){var n=e[i];if(n!==w)return n;i--}return 0},it=function(t,e,i,n,r){if(0===i[n])return"×";var o=n-1;if(Array.isArray(r)&&!0===r[o])return"×";var s=o-1,a=o+1,A=e[o],l=s>=0?e[s]:0,c=e[a];if(2===A&&3===c)return"×";if(-1!==q.indexOf(A))return"!";if(-1!==q.indexOf(c))return"×";if(-1!==X.indexOf(c))return"×";if(8===et(o,e))return"÷";if(11===z.get(t[o]))return"×";if((A===D||A===Q)&&11===z.get(t[a]))return"×";if(7===A||7===c)return"×";if(9===A)return"×";if(-1===[w,C,B].indexOf(A)&&9===c)return"×";if(-1!==[b,E,S,O,M].indexOf(c))return"×";if(et(o,e)===F)return"×";if(tt(23,F,o,e))return"×";if(tt([b,E],I,o,e))return"×";if(tt(12,12,o,e))return"×";if(A===w)return"÷";if(23===A||23===c)return"×";if(16===c||16===A)return"÷";if(-1!==[C,B,I].indexOf(c)||14===A)return"×";if(36===l&&-1!==$.indexOf(A))return"×";if(A===M&&36===c)return"×";if(c===x)return"×";if(-1!==W.indexOf(c)&&A===P||-1!==W.indexOf(A)&&c===P)return"×";if(A===L&&-1!==[H,D,Q].indexOf(c)||-1!==[H,D,Q].indexOf(A)&&c===T)return"×";if(-1!==W.indexOf(A)&&-1!==Y.indexOf(c)||-1!==Y.indexOf(A)&&-1!==W.indexOf(c))return"×";if(-1!==[L,T].indexOf(A)&&(c===P||-1!==[F,B].indexOf(c)&&e[a+1]===P)||-1!==[F,B].indexOf(A)&&c===P||A===P&&-1!==[P,M,O].indexOf(c))return"×";if(-1!==[P,M,O,b,E].indexOf(c))for(var u=o;u>=0;){if((h=e[u])===P)return"×";if(-1===[M,O].indexOf(h))break;u--}if(-1!==[L,T].indexOf(c))for(u=-1!==[b,E].indexOf(A)?s:o;u>=0;){var h;if((h=e[u])===P)return"×";if(-1===[M,O].indexOf(h))break;u--}if(k===A&&-1!==[k,V,R,N].indexOf(c)||-1!==[V,R].indexOf(A)&&-1!==[V,j].indexOf(c)||-1!==[j,N].indexOf(A)&&c===j)return"×";if(-1!==Z.indexOf(A)&&-1!==[x,T].indexOf(c)||-1!==Z.indexOf(c)&&A===L)return"×";if(-1!==W.indexOf(A)&&-1!==W.indexOf(c))return"×";if(A===O&&-1!==W.indexOf(c))return"×";if(-1!==W.concat(P).indexOf(A)&&c===F&&-1===K.indexOf(t[a])||-1!==W.concat(P).indexOf(c)&&A===E)return"×";if(41===A&&41===c){for(var p=i[o],d=1;p>0&&41===e[--p];)d++;if(d%2!=0)return"×"}return A===D&&c===Q?"×":"÷"},nt=function(t,e){e||(e={lineBreak:"normal",wordBreak:"normal"});var i=function(t,e){void 0===e&&(e="strict");var i=[],n=[],r=[];return t.forEach((function(t,o){var s=z.get(t);if(s>50?(r.push(!0),s-=50):r.push(!1),-1!==["normal","auto","loose"].indexOf(e)&&-1!==[8208,8211,12316,12448].indexOf(t))return n.push(o),i.push(16);if(4===s||11===s){if(0===o)return n.push(o),i.push(U);var a=i[o-1];return-1===J.indexOf(a)?(n.push(n[o-1]),i.push(a)):(n.push(o),i.push(U))}return n.push(o),31===s?i.push("strict"===e?I:H):s===G||29===s?i.push(U):43===s?t>=131072&&t<=196605||t>=196608&&t<=262141?i.push(H):i.push(U):void i.push(s)})),[n,i,r]}(t,e.lineBreak),n=i[0],r=i[1],o=i[2];return"break-all"!==e.wordBreak&&"break-word"!==e.wordBreak||(r=r.map((function(t){return-1!==[P,U,G].indexOf(t)?H:t}))),[n,r,"keep-all"===e.wordBreak?o.map((function(e,i){return e&&t[i]>=19968&&t[i]<=40959})):void 0]},rt=function(){function t(t,e,i,n){this.codePoints=t,this.required="!"===e,this.start=i,this.end=n}return t.prototype.slice=function(){return l.apply(void 0,this.codePoints.slice(this.start,this.end))},t}(),ot=function(t){return t>=48&&t<=57},st=function(t){return ot(t)||t>=65&&t<=70||t>=97&&t<=102},at=function(t){return 10===t||9===t||32===t},At=function(t){return function(t){return function(t){return t>=97&&t<=122}(t)||function(t){return t>=65&&t<=90}(t)}(t)||function(t){return t>=128}(t)||95===t},lt=function(t){return At(t)||ot(t)||45===t},ct=function(t){return t>=0&&t<=8||11===t||t>=14&&t<=31||127===t},ut=function(t,e){return 92===t&&10!==e},ht=function(t,e,i){return 45===t?At(e)||ut(e,i):!!At(t)||!(92!==t||!ut(t,e))},pt=function(t,e,i){return 43===t||45===t?!!ot(e)||46===e&&ot(i):ot(46===t?e:t)},dt=function(t){var e=0,i=1;43!==t[e]&&45!==t[e]||(45===t[e]&&(i=-1),e++);for(var n=[];ot(t[e]);)n.push(t[e++]);var r=n.length?parseInt(l.apply(void 0,n),10):0;46===t[e]&&e++;for(var o=[];ot(t[e]);)o.push(t[e++]);var s=o.length,a=s?parseInt(l.apply(void 0,o),10):0;69!==t[e]&&101!==t[e]||e++;var A=1;43!==t[e]&&45!==t[e]||(45===t[e]&&(A=-1),e++);for(var c=[];ot(t[e]);)c.push(t[e++]);var u=c.length?parseInt(l.apply(void 0,c),10):0;return i*(r+a*Math.pow(10,-s))*Math.pow(10,A*u)},ft={type:2},gt={type:3},mt={type:4},yt={type:13},vt={type:8},_t={type:21},wt={type:9},Ct={type:10},Bt={type:11},bt={type:12},Et={type:14},St={type:23},xt={type:1},It={type:25},Ft={type:24},Ot={type:26},Pt={type:27},Tt={type:28},Lt={type:29},Mt={type:31},Ut={type:32},Dt=function(){function t(){this._value=[]}return t.prototype.write=function(t){this._value=this._value.concat(A(t))},t.prototype.read=function(){for(var t=[],e=this.consumeToken();e!==Ut;)t.push(e),e=this.consumeToken();return t},t.prototype.consumeToken=function(){var t=this.consumeCodePoint();switch(t){case 34:return this.consumeStringToken(34);case 35:var e=this.peekCodePoint(0),i=this.peekCodePoint(1),n=this.peekCodePoint(2);if(lt(e)||ut(i,n)){var r=ht(e,i,n)?2:1;return{type:5,value:this.consumeName(),flags:r}}break;case 36:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),yt;break;case 39:return this.consumeStringToken(39);case 40:return ft;case 41:return gt;case 42:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),Et;break;case 43:if(pt(t,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(t),this.consumeNumericToken();break;case 44:return mt;case 45:var o=t,s=this.peekCodePoint(0),a=this.peekCodePoint(1);if(pt(o,s,a))return this.reconsumeCodePoint(t),this.consumeNumericToken();if(ht(o,s,a))return this.reconsumeCodePoint(t),this.consumeIdentLikeToken();if(45===s&&62===a)return this.consumeCodePoint(),this.consumeCodePoint(),Ft;break;case 46:if(pt(t,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(t),this.consumeNumericToken();break;case 47:if(42===this.peekCodePoint(0))for(this.consumeCodePoint();;){var A=this.consumeCodePoint();if(42===A&&47===(A=this.consumeCodePoint()))return this.consumeToken();if(-1===A)return this.consumeToken()}break;case 58:return Ot;case 59:return Pt;case 60:if(33===this.peekCodePoint(0)&&45===this.peekCodePoint(1)&&45===this.peekCodePoint(2))return this.consumeCodePoint(),this.consumeCodePoint(),It;break;case 64:var c=this.peekCodePoint(0),u=this.peekCodePoint(1),h=this.peekCodePoint(2);if(ht(c,u,h))return{type:7,value:this.consumeName()};break;case 91:return Tt;case 92:if(ut(t,this.peekCodePoint(0)))return this.reconsumeCodePoint(t),this.consumeIdentLikeToken();break;case 93:return Lt;case 61:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),vt;break;case 123:return Bt;case 125:return bt;case 117:case 85:var p=this.peekCodePoint(0),d=this.peekCodePoint(1);return 43!==p||!st(d)&&63!==d||(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(t),this.consumeIdentLikeToken();case 124:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),wt;if(124===this.peekCodePoint(0))return this.consumeCodePoint(),_t;break;case 126:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),Ct;break;case-1:return Ut}return at(t)?(this.consumeWhiteSpace(),Mt):ot(t)?(this.reconsumeCodePoint(t),this.consumeNumericToken()):At(t)?(this.reconsumeCodePoint(t),this.consumeIdentLikeToken()):{type:6,value:l(t)}},t.prototype.consumeCodePoint=function(){var t=this._value.shift();return void 0===t?-1:t},t.prototype.reconsumeCodePoint=function(t){this._value.unshift(t)},t.prototype.peekCodePoint=function(t){return t>=this._value.length?-1:this._value[t]},t.prototype.consumeUnicodeRangeToken=function(){for(var t=[],e=this.consumeCodePoint();st(e)&&t.length<6;)t.push(e),e=this.consumeCodePoint();for(var i=!1;63===e&&t.length<6;)t.push(e),e=this.consumeCodePoint(),i=!0;if(i)return{type:30,start:parseInt(l.apply(void 0,t.map((function(t){return 63===t?48:t}))),16),end:parseInt(l.apply(void 0,t.map((function(t){return 63===t?70:t}))),16)};var n=parseInt(l.apply(void 0,t),16);if(45===this.peekCodePoint(0)&&st(this.peekCodePoint(1))){this.consumeCodePoint(),e=this.consumeCodePoint();for(var r=[];st(e)&&r.length<6;)r.push(e),e=this.consumeCodePoint();return{type:30,start:n,end:parseInt(l.apply(void 0,r),16)}}return{type:30,start:n,end:n}},t.prototype.consumeIdentLikeToken=function(){var t=this.consumeName();return"url"===t.toLowerCase()&&40===this.peekCodePoint(0)?(this.consumeCodePoint(),this.consumeUrlToken()):40===this.peekCodePoint(0)?(this.consumeCodePoint(),{type:19,value:t}):{type:20,value:t}},t.prototype.consumeUrlToken=function(){var t=[];if(this.consumeWhiteSpace(),-1===this.peekCodePoint(0))return{type:22,value:""};var e=this.peekCodePoint(0);if(39===e||34===e){var i=this.consumeStringToken(this.consumeCodePoint());return 0===i.type&&(this.consumeWhiteSpace(),-1===this.peekCodePoint(0)||41===this.peekCodePoint(0))?(this.consumeCodePoint(),{type:22,value:i.value}):(this.consumeBadUrlRemnants(),St)}for(;;){var n=this.consumeCodePoint();if(-1===n||41===n)return{type:22,value:l.apply(void 0,t)};if(at(n))return this.consumeWhiteSpace(),-1===this.peekCodePoint(0)||41===this.peekCodePoint(0)?(this.consumeCodePoint(),{type:22,value:l.apply(void 0,t)}):(this.consumeBadUrlRemnants(),St);if(34===n||39===n||40===n||ct(n))return this.consumeBadUrlRemnants(),St;if(92===n){if(!ut(n,this.peekCodePoint(0)))return this.consumeBadUrlRemnants(),St;t.push(this.consumeEscapedCodePoint())}else t.push(n)}},t.prototype.consumeWhiteSpace=function(){for(;at(this.peekCodePoint(0));)this.consumeCodePoint()},t.prototype.consumeBadUrlRemnants=function(){for(;;){var t=this.consumeCodePoint();if(41===t||-1===t)return;ut(t,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},t.prototype.consumeStringSlice=function(t){for(var e="";t>0;){var i=Math.min(5e4,t);e+=l.apply(void 0,this._value.splice(0,i)),t-=i}return this._value.shift(),e},t.prototype.consumeStringToken=function(t){for(var e="",i=0;;){var n=this._value[i];if(-1===n||void 0===n||n===t)return{type:0,value:e+=this.consumeStringSlice(i)};if(10===n)return this._value.splice(0,i),xt;if(92===n){var r=this._value[i+1];-1!==r&&void 0!==r&&(10===r?(e+=this.consumeStringSlice(i),i=-1,this._value.shift()):ut(n,r)&&(e+=this.consumeStringSlice(i),e+=l(this.consumeEscapedCodePoint()),i=-1))}i++}},t.prototype.consumeNumber=function(){var t=[],e=4,i=this.peekCodePoint(0);for(43!==i&&45!==i||t.push(this.consumeCodePoint());ot(this.peekCodePoint(0));)t.push(this.consumeCodePoint());i=this.peekCodePoint(0);var n=this.peekCodePoint(1);if(46===i&&ot(n))for(t.push(this.consumeCodePoint(),this.consumeCodePoint()),e=8;ot(this.peekCodePoint(0));)t.push(this.consumeCodePoint());i=this.peekCodePoint(0),n=this.peekCodePoint(1);var r=this.peekCodePoint(2);if((69===i||101===i)&&((43===n||45===n)&&ot(r)||ot(n)))for(t.push(this.consumeCodePoint(),this.consumeCodePoint()),e=8;ot(this.peekCodePoint(0));)t.push(this.consumeCodePoint());return[dt(t),e]},t.prototype.consumeNumericToken=function(){var t=this.consumeNumber(),e=t[0],i=t[1],n=this.peekCodePoint(0),r=this.peekCodePoint(1),o=this.peekCodePoint(2);return ht(n,r,o)?{type:15,number:e,flags:i,unit:this.consumeName()}:37===n?(this.consumeCodePoint(),{type:16,number:e,flags:i}):{type:17,number:e,flags:i}},t.prototype.consumeEscapedCodePoint=function(){var t=this.consumeCodePoint();if(st(t)){for(var e=l(t);st(this.peekCodePoint(0))&&e.length<6;)e+=l(this.consumeCodePoint());at(this.peekCodePoint(0))&&this.consumeCodePoint();var i=parseInt(e,16);return 0===i||function(t){return t>=55296&&t<=57343}(i)||i>1114111?65533:i}return-1===t?65533:t},t.prototype.consumeName=function(){for(var t="";;){var e=this.consumeCodePoint();if(lt(e))t+=l(e);else{if(!ut(e,this.peekCodePoint(0)))return this.reconsumeCodePoint(e),t;t+=l(this.consumeEscapedCodePoint())}}},t}(),Qt=function(){function t(t){this._tokens=t}return t.create=function(e){var i=new Dt;return i.write(e),new t(i.read())},t.parseValue=function(e){return t.create(e).parseComponentValue()},t.parseValues=function(e){return t.create(e).parseComponentValues()},t.prototype.parseComponentValue=function(){for(var t=this.consumeToken();31===t.type;)t=this.consumeToken();if(32===t.type)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(t);var e=this.consumeComponentValue();do{t=this.consumeToken()}while(31===t.type);if(32===t.type)return e;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},t.prototype.parseComponentValues=function(){for(var t=[];;){var e=this.consumeComponentValue();if(32===e.type)return t;t.push(e),t.push()}},t.prototype.consumeComponentValue=function(){var t=this.consumeToken();switch(t.type){case 11:case 28:case 2:return this.consumeSimpleBlock(t.type);case 19:return this.consumeFunction(t)}return t},t.prototype.consumeSimpleBlock=function(t){for(var e={type:t,values:[]},i=this.consumeToken();;){if(32===i.type||zt(i,t))return e;this.reconsumeToken(i),e.values.push(this.consumeComponentValue()),i=this.consumeToken()}},t.prototype.consumeFunction=function(t){for(var e={name:t.value,values:[],type:18};;){var i=this.consumeToken();if(32===i.type||3===i.type)return e;this.reconsumeToken(i),e.values.push(this.consumeComponentValue())}},t.prototype.consumeToken=function(){var t=this._tokens.shift();return void 0===t?Ut:t},t.prototype.reconsumeToken=function(t){this._tokens.unshift(t)},t}(),Rt=function(t){return 15===t.type},Nt=function(t){return 17===t.type},Ht=function(t){return 20===t.type},kt=function(t){return 0===t.type},Vt=function(t,e){return Ht(t)&&t.value===e},jt=function(t){return 31!==t.type},Gt=function(t){return 31!==t.type&&4!==t.type},Kt=function(t){var e=[],i=[];return t.forEach((function(t){if(4===t.type){if(0===i.length)throw new Error("Error parsing function args, zero tokens for arg");return e.push(i),void(i=[])}31!==t.type&&i.push(t)})),i.length&&e.push(i),e},zt=function(t,e){return 11===e&&12===t.type||28===e&&29===t.type||2===e&&3===t.type},Wt=function(t){return 17===t.type||15===t.type},qt=function(t){return 16===t.type||Wt(t)},Xt=function(t){return t.length>1?[t[0],t[1]]:[t[0]]},Yt={type:17,number:0,flags:4},Jt={type:16,number:50,flags:4},Zt={type:16,number:100,flags:4},$t=function(t,e,i){var n=t[0],r=t[1];return[te(n,e),te(void 0!==r?r:n,i)]},te=function(t,e){if(16===t.type)return t.number/100*e;if(Rt(t))switch(t.unit){case"rem":case"em":return 16*t.number;case"px":default:return t.number}return t.number},ee=function(t,e){if(15===e.type)switch(e.unit){case"deg":return Math.PI*e.number/180;case"grad":return Math.PI/200*e.number;case"rad":return e.number;case"turn":return 2*Math.PI*e.number}throw new Error("Unsupported angle type")},ie=function(t){return 15===t.type&&("deg"===t.unit||"grad"===t.unit||"rad"===t.unit||"turn"===t.unit)},ne=function(t){switch(t.filter(Ht).map((function(t){return t.value})).join(" ")){case"to bottom right":case"to right bottom":case"left top":case"top left":return[Yt,Yt];case"to top":case"bottom":return re(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[Yt,Zt];case"to right":case"left":return re(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[Zt,Zt];case"to bottom":case"top":return re(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[Zt,Yt];case"to left":case"right":return re(270)}return 0},re=function(t){return Math.PI*t/180},oe=function(t,e){if(18===e.type){var i=de[e.name];if(void 0===i)throw new Error('Attempting to parse an unsupported color function "'+e.name+'"');return i(t,e.values)}if(5===e.type){if(3===e.value.length){var n=e.value.substring(0,1),r=e.value.substring(1,2),o=e.value.substring(2,3);return Ae(parseInt(n+n,16),parseInt(r+r,16),parseInt(o+o,16),1)}if(4===e.value.length){n=e.value.substring(0,1),r=e.value.substring(1,2),o=e.value.substring(2,3);var s=e.value.substring(3,4);return Ae(parseInt(n+n,16),parseInt(r+r,16),parseInt(o+o,16),parseInt(s+s,16)/255)}if(6===e.value.length)return n=e.value.substring(0,2),r=e.value.substring(2,4),o=e.value.substring(4,6),Ae(parseInt(n,16),parseInt(r,16),parseInt(o,16),1);if(8===e.value.length)return n=e.value.substring(0,2),r=e.value.substring(2,4),o=e.value.substring(4,6),s=e.value.substring(6,8),Ae(parseInt(n,16),parseInt(r,16),parseInt(o,16),parseInt(s,16)/255)}if(20===e.type){var a=ge[e.value.toUpperCase()];if(void 0!==a)return a}return ge.TRANSPARENT},se=function(t){return 0==(255&t)},ae=function(t){var e=255&t,i=255&t>>8,n=255&t>>16,r=255&t>>24;return e<255?"rgba("+r+","+n+","+i+","+e/255+")":"rgb("+r+","+n+","+i+")"},Ae=function(t,e,i,n){return(t<<24|e<<16|i<<8|Math.round(255*n)<<0)>>>0},le=function(t,e){if(17===t.type)return t.number;if(16===t.type){var i=3===e?1:255;return 3===e?t.number/100*i:Math.round(t.number/100*i)}return 0},ce=function(t,e){var i=e.filter(Gt);if(3===i.length){var n=i.map(le),r=n[0],o=n[1],s=n[2];return Ae(r,o,s,1)}if(4===i.length){var a=i.map(le),A=(r=a[0],o=a[1],s=a[2],a[3]);return Ae(r,o,s,A)}return 0};function ue(t,e,i){return i<0&&(i+=1),i>=1&&(i-=1),i<1/6?(e-t)*i*6+t:i<.5?e:i<2/3?6*(e-t)*(2/3-i)+t:t}var he,pe=function(t,e){var i=e.filter(Gt),n=i[0],r=i[1],o=i[2],s=i[3],a=(17===n.type?re(n.number):ee(t,n))/(2*Math.PI),A=qt(r)?r.number/100:0,l=qt(o)?o.number/100:0,c=void 0!==s&&qt(s)?te(s,1):1;if(0===A)return Ae(255*l,255*l,255*l,1);var u=l<=.5?l*(A+1):l+A-l*A,h=2*l-u,p=ue(h,u,a+1/3),d=ue(h,u,a),f=ue(h,u,a-1/3);return Ae(255*p,255*d,255*f,c)},de={hsl:pe,hsla:pe,rgb:ce,rgba:ce},fe=function(t,e){return oe(t,Qt.create(e).parseComponentValue())},ge={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},me={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(t,e){return e.map((function(t){if(Ht(t))switch(t.value){case"padding-box":return 1;case"content-box":return 2}return 0}))}},ye={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},ve=function(t,e){var i=oe(t,e[0]),n=e[1];return n&&qt(n)?{color:i,stop:n}:{color:i,stop:null}},_e=function(t,e){var i=t[0],n=t[t.length-1];null===i.stop&&(i.stop=Yt),null===n.stop&&(n.stop=Zt);for(var r=[],o=0,s=0;s<t.length;s++){var a=t[s].stop;if(null!==a){var A=te(a,e);A>o?r.push(A):r.push(o),o=A}else r.push(null)}var l=null;for(s=0;s<r.length;s++){var c=r[s];if(null===c)null===l&&(l=s);else if(null!==l){for(var u=s-l,h=(c-r[l-1])/(u+1),p=1;p<=u;p++)r[l+p-1]=h*p;l=null}}return t.map((function(t,i){return{color:t.color,stop:Math.max(Math.min(1,r[i]/e),0)}}))},we=function(t,e,i){var n="number"==typeof t?t:function(t,e,i){var n=e/2,r=i/2,o=te(t[0],e)-n,s=r-te(t[1],i);return(Math.atan2(s,o)+2*Math.PI)%(2*Math.PI)}(t,e,i),r=Math.abs(e*Math.sin(n))+Math.abs(i*Math.cos(n)),o=e/2,s=i/2,a=r/2,A=Math.sin(n-Math.PI/2)*a,l=Math.cos(n-Math.PI/2)*a;return[r,o-l,o+l,s-A,s+A]},Ce=function(t,e){return Math.sqrt(t*t+e*e)},Be=function(t,e,i,n,r){return[[0,0],[0,e],[t,0],[t,e]].reduce((function(t,e){var o=e[0],s=e[1],a=Ce(i-o,n-s);return(r?a<t.optimumDistance:a>t.optimumDistance)?{optimumCorner:e,optimumDistance:a}:t}),{optimumDistance:r?1/0:-1/0,optimumCorner:null}).optimumCorner},be=function(t,e){var i=re(180),n=[];return Kt(e).forEach((function(e,r){if(0===r){var o=e[0];if(20===o.type&&-1!==["top","left","right","bottom"].indexOf(o.value))return void(i=ne(e));if(ie(o))return void(i=(ee(t,o)+re(270))%re(360))}var s=ve(t,e);n.push(s)})),{angle:i,stops:n,type:1}},Ee=function(t,e){var i=0,n=3,r=[],o=[];return Kt(e).forEach((function(e,s){var a=!0;if(0===s?a=e.reduce((function(t,e){if(Ht(e))switch(e.value){case"center":return o.push(Jt),!1;case"top":case"left":return o.push(Yt),!1;case"right":case"bottom":return o.push(Zt),!1}else if(qt(e)||Wt(e))return o.push(e),!1;return t}),a):1===s&&(a=e.reduce((function(t,e){if(Ht(e))switch(e.value){case"circle":return i=0,!1;case"ellipse":return i=1,!1;case"contain":case"closest-side":return n=0,!1;case"farthest-side":return n=1,!1;case"closest-corner":return n=2,!1;case"cover":case"farthest-corner":return n=3,!1}else if(Wt(e)||qt(e))return Array.isArray(n)||(n=[]),n.push(e),!1;return t}),a)),a){var A=ve(t,e);r.push(A)}})),{size:n,shape:i,stops:r,position:o,type:2}},Se=function(t,e){if(22===e.type){var i={url:e.value,type:0};return t.cache.addImage(e.value),i}if(18===e.type){var n=xe[e.name];if(void 0===n)throw new Error('Attempting to parse an unsupported image function "'+e.name+'"');return n(t,e.values)}throw new Error("Unsupported image type "+e.type)},xe={"linear-gradient":function(t,e){var i=re(180),n=[];return Kt(e).forEach((function(e,r){if(0===r){var o=e[0];if(20===o.type&&"to"===o.value)return void(i=ne(e));if(ie(o))return void(i=ee(t,o))}var s=ve(t,e);n.push(s)})),{angle:i,stops:n,type:1}},"-moz-linear-gradient":be,"-ms-linear-gradient":be,"-o-linear-gradient":be,"-webkit-linear-gradient":be,"radial-gradient":function(t,e){var i=0,n=3,r=[],o=[];return Kt(e).forEach((function(e,s){var a=!0;if(0===s){var A=!1;a=e.reduce((function(t,e){if(A)if(Ht(e))switch(e.value){case"center":return o.push(Jt),t;case"top":case"left":return o.push(Yt),t;case"right":case"bottom":return o.push(Zt),t}else(qt(e)||Wt(e))&&o.push(e);else if(Ht(e))switch(e.value){case"circle":return i=0,!1;case"ellipse":return i=1,!1;case"at":return A=!0,!1;case"closest-side":return n=0,!1;case"cover":case"farthest-side":return n=1,!1;case"contain":case"closest-corner":return n=2,!1;case"farthest-corner":return n=3,!1}else if(Wt(e)||qt(e))return Array.isArray(n)||(n=[]),n.push(e),!1;return t}),a)}if(a){var l=ve(t,e);r.push(l)}})),{size:n,shape:i,stops:r,position:o,type:2}},"-moz-radial-gradient":Ee,"-ms-radial-gradient":Ee,"-o-radial-gradient":Ee,"-webkit-radial-gradient":Ee,"-webkit-gradient":function(t,e){var i=re(180),n=[],r=1;return Kt(e).forEach((function(e,i){var o=e[0];if(0===i){if(Ht(o)&&"linear"===o.value)return void(r=1);if(Ht(o)&&"radial"===o.value)return void(r=2)}if(18===o.type)if("from"===o.name){var s=oe(t,o.values[0]);n.push({stop:Yt,color:s})}else if("to"===o.name)s=oe(t,o.values[0]),n.push({stop:Zt,color:s});else if("color-stop"===o.name){var a=o.values.filter(Gt);if(2===a.length){s=oe(t,a[1]);var A=a[0];Nt(A)&&n.push({stop:{type:16,number:100*A.number,flags:A.flags},color:s})}}})),1===r?{angle:(i+re(180))%re(360),stops:n,type:r}:{size:3,shape:0,stops:n,position:[],type:r}}},Ie={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(t,e){if(0===e.length)return[];var i=e[0];return 20===i.type&&"none"===i.value?[]:e.filter((function(t){return Gt(t)&&function(t){return!(20===t.type&&"none"===t.value||18===t.type&&!xe[t.name])}(t)})).map((function(e){return Se(t,e)}))}},Fe={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(t,e){return e.map((function(t){if(Ht(t))switch(t.value){case"padding-box":return 1;case"content-box":return 2}return 0}))}},Oe={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(t,e){return Kt(e).map((function(t){return t.filter(qt)})).map(Xt)}},Pe={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(t,e){return Kt(e).map((function(t){return t.filter(Ht).map((function(t){return t.value})).join(" ")})).map(Te)}},Te=function(t){switch(t){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;case"repeat":default:return 0}};!function(t){t.AUTO="auto",t.CONTAIN="contain",t.COVER="cover"}(he||(he={}));var Le,Me={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(t,e){return Kt(e).map((function(t){return t.filter(Ue)}))}},Ue=function(t){return Ht(t)||qt(t)},De=function(t){return{name:"border-"+t+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},Qe=De("top"),Re=De("right"),Ne=De("bottom"),He=De("left"),ke=function(t){return{name:"border-radius-"+t,initialValue:"0 0",prefix:!1,type:1,parse:function(t,e){return Xt(e.filter(qt))}}},Ve=ke("top-left"),je=ke("top-right"),Ge=ke("bottom-right"),Ke=ke("bottom-left"),ze=function(t){return{name:"border-"+t+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(t,e){switch(e){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},We=ze("top"),qe=ze("right"),Xe=ze("bottom"),Ye=ze("left"),Je=function(t){return{name:"border-"+t+"-width",initialValue:"0",type:0,prefix:!1,parse:function(t,e){return Rt(e)?e.number:0}}},Ze=Je("top"),$e=Je("right"),ti=Je("bottom"),ei=Je("left"),ii={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},ni={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(t,e){switch(e){case"rtl":return 1;case"ltr":default:return 0}}},ri={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(t,e){return e.filter(Ht).reduce((function(t,e){return t|oi(e.value)}),0)}},oi=function(t){switch(t){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},si={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},ai={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(t,e){return 20===e.type&&"normal"===e.value?0:17===e.type||15===e.type?e.number:0}};!function(t){t.NORMAL="normal",t.STRICT="strict"}(Le||(Le={}));var Ai,li={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){switch(e){case"strict":return Le.STRICT;case"normal":default:return Le.NORMAL}}},ci={name:"line-height",initialValue:"normal",prefix:!1,type:4},ui=function(t,e){return Ht(t)&&"normal"===t.value?1.2*e:17===t.type?e*t.number:qt(t)?te(t,e):e},hi={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(t,e){return 20===e.type&&"none"===e.value?null:Se(t,e)}},pi={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(t,e){switch(e){case"inside":return 0;case"outside":default:return 1}}},di={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;case"none":default:return-1}}},fi=function(t){return{name:"margin-"+t,initialValue:"0",prefix:!1,type:4}},gi=fi("top"),mi=fi("right"),yi=fi("bottom"),vi=fi("left"),_i={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(t,e){return e.filter(Ht).map((function(t){switch(t.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;case"visible":default:return 0}}))}},wi={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){switch(e){case"break-word":return"break-word";case"normal":default:return"normal"}}},Ci=function(t){return{name:"padding-"+t,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},Bi=Ci("top"),bi=Ci("right"),Ei=Ci("bottom"),Si=Ci("left"),xi={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(t,e){switch(e){case"right":return 2;case"center":case"justify":return 1;case"left":default:return 0}}},Ii={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(t,e){switch(e){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},Fi={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(t,e){return 1===e.length&&Vt(e[0],"none")?[]:Kt(e).map((function(e){for(var i={color:ge.TRANSPARENT,offsetX:Yt,offsetY:Yt,blur:Yt},n=0,r=0;r<e.length;r++){var o=e[r];Wt(o)?(0===n?i.offsetX=o:1===n?i.offsetY=o:i.blur=o,n++):i.color=oe(t,o)}return i}))}},Oi={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},Pi={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(t,e){if(20===e.type&&"none"===e.value)return null;if(18===e.type){var i=Ti[e.name];if(void 0===i)throw new Error('Attempting to parse an unsupported transform function "'+e.name+'"');return i(e.values)}return null}},Ti={matrix:function(t){var e=t.filter((function(t){return 17===t.type})).map((function(t){return t.number}));return 6===e.length?e:null},matrix3d:function(t){var e=t.filter((function(t){return 17===t.type})).map((function(t){return t.number})),i=e[0],n=e[1];e[2],e[3];var r=e[4],o=e[5];e[6],e[7],e[8],e[9],e[10],e[11];var s=e[12],a=e[13];return e[14],e[15],16===e.length?[i,n,r,o,s,a]:null}},Li={type:16,number:50,flags:4},Mi=[Li,Li],Ui={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(t,e){var i=e.filter(qt);return 2!==i.length?Mi:[i[0],i[1]]}},Di={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"hidden":return 1;case"collapse":return 2;case"visible":default:return 0}}};!function(t){t.NORMAL="normal",t.BREAK_ALL="break-all",t.KEEP_ALL="keep-all"}(Ai||(Ai={}));for(var Qi={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){switch(e){case"break-all":return Ai.BREAK_ALL;case"keep-all":return Ai.KEEP_ALL;case"normal":default:return Ai.NORMAL}}},Ri={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(t,e){if(20===e.type)return{auto:!0,order:0};if(Nt(e))return{auto:!1,order:e.number};throw new Error("Invalid z-index number parsed")}},Ni=function(t,e){if(15===e.type)switch(e.unit.toLowerCase()){case"s":return 1e3*e.number;case"ms":return e.number}throw new Error("Unsupported time type")},Hi={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(t,e){return Nt(e)?e.number:1}},ki={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Vi={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(t,e){return e.filter(Ht).map((function(t){switch(t.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0})).filter((function(t){return 0!==t}))}},ji={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(t,e){var i=[],n=[];return e.forEach((function(t){switch(t.type){case 20:case 0:i.push(t.value);break;case 17:i.push(t.number.toString());break;case 4:n.push(i.join(" ")),i.length=0}})),i.length&&n.push(i.join(" ")),n.map((function(t){return-1===t.indexOf(" ")?t:"'"+t+"'"}))}},Gi={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},Ki={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(t,e){if(Nt(e))return e.number;if(Ht(e))switch(e.value){case"bold":return 700;case"normal":default:return 400}return 400}},zi={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(t,e){return e.filter(Ht).map((function(t){return t.value}))}},Wi={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){switch(e){case"oblique":return"oblique";case"italic":return"italic";case"normal":default:return"normal"}}},qi=function(t,e){return 0!=(t&e)},Xi={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(t,e){if(0===e.length)return[];var i=e[0];return 20===i.type&&"none"===i.value?[]:e}},Yi={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(t,e){if(0===e.length)return null;var i=e[0];if(20===i.type&&"none"===i.value)return null;for(var n=[],r=e.filter(jt),o=0;o<r.length;o++){var s=r[o],a=r[o+1];if(20===s.type){var A=a&&Nt(a)?a.number:1;n.push({counter:s.value,increment:A})}}return n}},Ji={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(t,e){if(0===e.length)return[];for(var i=[],n=e.filter(jt),r=0;r<n.length;r++){var o=n[r],s=n[r+1];if(Ht(o)&&"none"!==o.value){var a=s&&Nt(s)?s.number:0;i.push({counter:o.value,reset:a})}}return i}},Zi={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(t,e){return e.filter(Rt).map((function(e){return Ni(t,e)}))}},$i={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(t,e){if(0===e.length)return null;var i=e[0];if(20===i.type&&"none"===i.value)return null;var n=[],r=e.filter(kt);if(r.length%2!=0)return null;for(var o=0;o<r.length;o+=2){var s=r[o].value,a=r[o+1].value;n.push({open:s,close:a})}return n}},tn=function(t,e,i){if(!t)return"";var n=t[Math.min(e,t.length-1)];return n?i?n.open:n.close:""},en={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(t,e){return 1===e.length&&Vt(e[0],"none")?[]:Kt(e).map((function(e){for(var i={color:255,offsetX:Yt,offsetY:Yt,blur:Yt,spread:Yt,inset:!1},n=0,r=0;r<e.length;r++){var o=e[r];Vt(o,"inset")?i.inset=!0:Wt(o)?(0===n?i.offsetX=o:1===n?i.offsetY=o:2===n?i.blur=o:i.spread=o,n++):i.color=oe(t,o)}return i}))}},nn={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(t,e){var i=[];return e.filter(Ht).forEach((function(t){switch(t.value){case"stroke":i.push(1);break;case"fill":i.push(0);break;case"markers":i.push(2)}})),[0,1,2].forEach((function(t){-1===i.indexOf(t)&&i.push(t)})),i}},rn={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},on={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(t,e){return Rt(e)?e.number:0}},sn=function(){function t(t,e){var i,n;this.animationDuration=ln(t,Zi,e.animationDuration),this.backgroundClip=ln(t,me,e.backgroundClip),this.backgroundColor=ln(t,ye,e.backgroundColor),this.backgroundImage=ln(t,Ie,e.backgroundImage),this.backgroundOrigin=ln(t,Fe,e.backgroundOrigin),this.backgroundPosition=ln(t,Oe,e.backgroundPosition),this.backgroundRepeat=ln(t,Pe,e.backgroundRepeat),this.backgroundSize=ln(t,Me,e.backgroundSize),this.borderTopColor=ln(t,Qe,e.borderTopColor),this.borderRightColor=ln(t,Re,e.borderRightColor),this.borderBottomColor=ln(t,Ne,e.borderBottomColor),this.borderLeftColor=ln(t,He,e.borderLeftColor),this.borderTopLeftRadius=ln(t,Ve,e.borderTopLeftRadius),this.borderTopRightRadius=ln(t,je,e.borderTopRightRadius),this.borderBottomRightRadius=ln(t,Ge,e.borderBottomRightRadius),this.borderBottomLeftRadius=ln(t,Ke,e.borderBottomLeftRadius),this.borderTopStyle=ln(t,We,e.borderTopStyle),this.borderRightStyle=ln(t,qe,e.borderRightStyle),this.borderBottomStyle=ln(t,Xe,e.borderBottomStyle),this.borderLeftStyle=ln(t,Ye,e.borderLeftStyle),this.borderTopWidth=ln(t,Ze,e.borderTopWidth),this.borderRightWidth=ln(t,$e,e.borderRightWidth),this.borderBottomWidth=ln(t,ti,e.borderBottomWidth),this.borderLeftWidth=ln(t,ei,e.borderLeftWidth),this.boxShadow=ln(t,en,e.boxShadow),this.color=ln(t,ii,e.color),this.direction=ln(t,ni,e.direction),this.display=ln(t,ri,e.display),this.float=ln(t,si,e.cssFloat),this.fontFamily=ln(t,ji,e.fontFamily),this.fontSize=ln(t,Gi,e.fontSize),this.fontStyle=ln(t,Wi,e.fontStyle),this.fontVariant=ln(t,zi,e.fontVariant),this.fontWeight=ln(t,Ki,e.fontWeight),this.letterSpacing=ln(t,ai,e.letterSpacing),this.lineBreak=ln(t,li,e.lineBreak),this.lineHeight=ln(t,ci,e.lineHeight),this.listStyleImage=ln(t,hi,e.listStyleImage),this.listStylePosition=ln(t,pi,e.listStylePosition),this.listStyleType=ln(t,di,e.listStyleType),this.marginTop=ln(t,gi,e.marginTop),this.marginRight=ln(t,mi,e.marginRight),this.marginBottom=ln(t,yi,e.marginBottom),this.marginLeft=ln(t,vi,e.marginLeft),this.opacity=ln(t,Hi,e.opacity);var r=ln(t,_i,e.overflow);this.overflowX=r[0],this.overflowY=r[r.length>1?1:0],this.overflowWrap=ln(t,wi,e.overflowWrap),this.paddingTop=ln(t,Bi,e.paddingTop),this.paddingRight=ln(t,bi,e.paddingRight),this.paddingBottom=ln(t,Ei,e.paddingBottom),this.paddingLeft=ln(t,Si,e.paddingLeft),this.paintOrder=ln(t,nn,e.paintOrder),this.position=ln(t,Ii,e.position),this.textAlign=ln(t,xi,e.textAlign),this.textDecorationColor=ln(t,ki,null!==(i=e.textDecorationColor)&&void 0!==i?i:e.color),this.textDecorationLine=ln(t,Vi,null!==(n=e.textDecorationLine)&&void 0!==n?n:e.textDecoration),this.textShadow=ln(t,Fi,e.textShadow),this.textTransform=ln(t,Oi,e.textTransform),this.transform=ln(t,Pi,e.transform),this.transformOrigin=ln(t,Ui,e.transformOrigin),this.visibility=ln(t,Di,e.visibility),this.webkitTextStrokeColor=ln(t,rn,e.webkitTextStrokeColor),this.webkitTextStrokeWidth=ln(t,on,e.webkitTextStrokeWidth),this.wordBreak=ln(t,Qi,e.wordBreak),this.zIndex=ln(t,Ri,e.zIndex)}return t.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&0===this.visibility},t.prototype.isTransparent=function(){return se(this.backgroundColor)},t.prototype.isTransformed=function(){return null!==this.transform},t.prototype.isPositioned=function(){return 0!==this.position},t.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},t.prototype.isFloating=function(){return 0!==this.float},t.prototype.isInlineLevel=function(){return qi(this.display,4)||qi(this.display,33554432)||qi(this.display,268435456)||qi(this.display,536870912)||qi(this.display,67108864)||qi(this.display,134217728)},t}(),an=function(t,e){this.content=ln(t,Xi,e.content),this.quotes=ln(t,$i,e.quotes)},An=function(t,e){this.counterIncrement=ln(t,Yi,e.counterIncrement),this.counterReset=ln(t,Ji,e.counterReset)},ln=function(t,e,i){var n=new Dt,r=null!=i?i.toString():e.initialValue;n.write(r);var o=new Qt(n.read());switch(e.type){case 2:var s=o.parseComponentValue();return e.parse(t,Ht(s)?s.value:e.initialValue);case 0:return e.parse(t,o.parseComponentValue());case 1:return e.parse(t,o.parseComponentValues());case 4:return o.parseComponentValue();case 3:switch(e.format){case"angle":return ee(t,o.parseComponentValue());case"color":return oe(t,o.parseComponentValue());case"image":return Se(t,o.parseComponentValue());case"length":var a=o.parseComponentValue();return Wt(a)?a:Yt;case"length-percentage":var A=o.parseComponentValue();return qt(A)?A:Yt;case"time":return Ni(t,o.parseComponentValue())}}},cn=function(t,e){var i=function(t){switch(t.getAttribute("data-html2canvas-debug")){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}}(t);return 1===i||e===i},un=function(t,e){this.context=t,this.textNodes=[],this.elements=[],this.flags=0,cn(e,3),this.styles=new sn(t,window.getComputedStyle(e,null)),ur(e)&&(this.styles.animationDuration.some((function(t){return t>0}))&&(e.style.animationDuration="0s"),null!==this.styles.transform&&(e.style.transform="none")),this.bounds=a(this.context,e),cn(e,4)&&(this.flags|=16)},hn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",pn="undefined"==typeof Uint8Array?[]:new Uint8Array(256),dn=0;dn<hn.length;dn++)pn[hn.charCodeAt(dn)]=dn;for(var fn=function(t,e,i){return t.slice?t.slice(e,i):new Uint16Array(Array.prototype.slice.call(t,e,i))},gn=function(){function t(t,e,i,n,r,o){this.initialValue=t,this.errorValue=e,this.highStart=i,this.highValueIndex=n,this.index=r,this.data=o}return t.prototype.get=function(t){var e;if(t>=0){if(t<55296||t>56319&&t<=65535)return e=((e=this.index[t>>5])<<2)+(31&t),this.data[e];if(t<=65535)return e=((e=this.index[2048+(t-55296>>5)])<<2)+(31&t),this.data[e];if(t<this.highStart)return e=2080+(t>>11),e=this.index[e],e+=t>>5&63,e=((e=this.index[e])<<2)+(31&t),this.data[e];if(t<=1114111)return this.data[this.highValueIndex]}return this.errorValue},t}(),mn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",yn="undefined"==typeof Uint8Array?[]:new Uint8Array(256),vn=0;vn<mn.length;vn++)yn[mn.charCodeAt(vn)]=vn;var _n,wn=8,Cn=9,Bn=11,bn=12,En=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(String.fromCodePoint)return String.fromCodePoint.apply(String,t);var i=t.length;if(!i)return"";for(var n=[],r=-1,o="";++r<i;){var s=t[r];s<=65535?n.push(s):(s-=65536,n.push(55296+(s>>10),s%1024+56320)),(r+1===i||n.length>16384)&&(o+=String.fromCharCode.apply(String,n),n.length=0)}return o},Sn=function(t,e){var i,n,r,o=function(t){var e,i,n,r,o,s=.75*t.length,a=t.length,A=0;"="===t[t.length-1]&&(s--,"="===t[t.length-2]&&s--);var l="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array&&void 0!==Uint8Array.prototype.slice?new ArrayBuffer(s):new Array(s),c=Array.isArray(l)?l:new Uint8Array(l);for(e=0;e<a;e+=4)i=pn[t.charCodeAt(e)],n=pn[t.charCodeAt(e+1)],r=pn[t.charCodeAt(e+2)],o=pn[t.charCodeAt(e+3)],c[A++]=i<<2|n>>4,c[A++]=(15&n)<<4|r>>2,c[A++]=(3&r)<<6|63&o;return l}(t),s=Array.isArray(o)?function(t){for(var e=t.length,i=[],n=0;n<e;n+=4)i.push(t[n+3]<<24|t[n+2]<<16|t[n+1]<<8|t[n]);return i}(o):new Uint32Array(o),a=Array.isArray(o)?function(t){for(var e=t.length,i=[],n=0;n<e;n+=2)i.push(t[n+1]<<8|t[n]);return i}(o):new Uint16Array(o),A=fn(a,12,s[4]/2),l=2===s[5]?fn(a,(24+s[4])/2):(i=s,n=Math.ceil((24+s[4])/4),i.slice?i.slice(n,r):new Uint32Array(Array.prototype.slice.call(i,n,r)));return new gn(s[0],s[1],s[2],s[3],A,l)}("AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA="),xn=function(t){return Sn.get(t)},In=function(t,e,i){var n=i-2,r=e[n],o=e[i-1],s=e[i];if(2===o&&3===s)return"×";if(2===o||3===o||4===o)return"÷";if(2===s||3===s||4===s)return"÷";if(o===wn&&-1!==[wn,Cn,Bn,bn].indexOf(s))return"×";if(!(o!==Bn&&o!==Cn||s!==Cn&&10!==s))return"×";if((o===bn||10===o)&&10===s)return"×";if(13===s||5===s)return"×";if(7===s)return"×";if(1===o)return"×";if(13===o&&14===s){for(;5===r;)r=e[--n];if(14===r)return"×"}if(15===o&&15===s){for(var a=0;15===r;)a++,r=e[--n];if(a%2==0)return"×"}return"÷"},Fn=function(t){var e=function(t){for(var e=[],i=0,n=t.length;i<n;){var r=t.charCodeAt(i++);if(r>=55296&&r<=56319&&i<n){var o=t.charCodeAt(i++);56320==(64512&o)?e.push(((1023&r)<<10)+(1023&o)+65536):(e.push(r),i--)}else e.push(r)}return e}(t),i=e.length,n=0,r=0,o=e.map(xn);return{next:function(){if(n>=i)return{done:!0,value:null};for(var t="×";n<i&&"×"===(t=In(0,o,++n)););if("×"!==t||n===i){var s=En.apply(null,e.slice(r,n));return r=n,{value:s,done:!1}}return{done:!0,value:null}}}},On=function(t){return 0===t[0]&&255===t[1]&&0===t[2]&&255===t[3]},Pn=function(t,e,i,n,r){var o="http://www.w3.org/2000/svg",s=document.createElementNS(o,"svg"),a=document.createElementNS(o,"foreignObject");return s.setAttributeNS(null,"width",t.toString()),s.setAttributeNS(null,"height",e.toString()),a.setAttributeNS(null,"width","100%"),a.setAttributeNS(null,"height","100%"),a.setAttributeNS(null,"x",i.toString()),a.setAttributeNS(null,"y",n.toString()),a.setAttributeNS(null,"externalResourcesRequired","true"),s.appendChild(a),a.appendChild(r),s},Tn=function(t){return new Promise((function(e,i){var n=new Image;n.onload=function(){return e(n)},n.onerror=i,n.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent((new XMLSerializer).serializeToString(t))}))},Ln={get SUPPORT_RANGE_BOUNDS(){var t=function(t){if(t.createRange){var e=t.createRange();if(e.getBoundingClientRect){var i=t.createElement("boundtest");i.style.height="123px",i.style.display="block",t.body.appendChild(i),e.selectNode(i);var n=e.getBoundingClientRect(),r=Math.round(n.height);if(t.body.removeChild(i),123===r)return!0}}return!1}(document);return Object.defineProperty(Ln,"SUPPORT_RANGE_BOUNDS",{value:t}),t},get SUPPORT_WORD_BREAKING(){var t=Ln.SUPPORT_RANGE_BOUNDS&&function(t){var e=t.createElement("boundtest");e.style.width="50px",e.style.display="block",e.style.fontSize="12px",e.style.letterSpacing="0px",e.style.wordSpacing="0px",t.body.appendChild(e);var i=t.createRange();e.innerHTML="function"==typeof"".repeat?"&#128104;".repeat(10):"";var n=e.firstChild,r=A(n.data).map((function(t){return l(t)})),o=0,s={},a=r.every((function(t,e){i.setStart(n,o),i.setEnd(n,o+t.length);var r=i.getBoundingClientRect();o+=t.length;var a=r.x>s.x||r.y>s.y;return s=r,0===e||a}));return t.body.removeChild(e),a}(document);return Object.defineProperty(Ln,"SUPPORT_WORD_BREAKING",{value:t}),t},get SUPPORT_SVG_DRAWING(){var t=function(t){var e=new Image,i=t.createElement("canvas"),n=i.getContext("2d");if(!n)return!1;e.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{n.drawImage(e,0,0),i.toDataURL()}catch(t){return!1}return!0}(document);return Object.defineProperty(Ln,"SUPPORT_SVG_DRAWING",{value:t}),t},get SUPPORT_FOREIGNOBJECT_DRAWING(){var t="function"==typeof Array.from&&"function"==typeof window.fetch?function(t){var e=t.createElement("canvas");e.width=100,e.height=100;var i=e.getContext("2d");if(!i)return Promise.reject(!1);i.fillStyle="rgb(0, 255, 0)",i.fillRect(0,0,100,100);var n=new Image,r=e.toDataURL();n.src=r;var o=Pn(100,100,0,0,n);return i.fillStyle="red",i.fillRect(0,0,100,100),Tn(o).then((function(e){i.drawImage(e,0,0);var n=i.getImageData(0,0,100,100).data;i.fillStyle="red",i.fillRect(0,0,100,100);var o=t.createElement("div");return o.style.backgroundImage="url("+r+")",o.style.height="100px",On(n)?Tn(Pn(100,100,0,0,o)):Promise.reject(!1)})).then((function(t){return i.drawImage(t,0,0),On(i.getImageData(0,0,100,100).data)})).catch((function(){return!1}))}(document):Promise.resolve(!1);return Object.defineProperty(Ln,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:t}),t},get SUPPORT_CORS_IMAGES(){var t=void 0!==(new Image).crossOrigin;return Object.defineProperty(Ln,"SUPPORT_CORS_IMAGES",{value:t}),t},get SUPPORT_RESPONSE_TYPE(){var t="string"==typeof(new XMLHttpRequest).responseType;return Object.defineProperty(Ln,"SUPPORT_RESPONSE_TYPE",{value:t}),t},get SUPPORT_CORS_XHR(){var t="withCredentials"in new XMLHttpRequest;return Object.defineProperty(Ln,"SUPPORT_CORS_XHR",{value:t}),t},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var t=!("undefined"==typeof Intl||!Intl.Segmenter);return Object.defineProperty(Ln,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:t}),t}},Mn=function(t,e){this.text=t,this.bounds=e},Un=function(t,e){var i=e.ownerDocument;if(i){var n=i.createElement("html2canvaswrapper");n.appendChild(e.cloneNode(!0));var r=e.parentNode;if(r){r.replaceChild(n,e);var o=a(t,n);return n.firstChild&&r.replaceChild(n.firstChild,n),o}}return s.EMPTY},Dn=function(t,e,i){var n=t.ownerDocument;if(!n)throw new Error("Node has no owner document");var r=n.createRange();return r.setStart(t,e),r.setEnd(t,e+i),r},Qn=function(t){if(Ln.SUPPORT_NATIVE_TEXT_SEGMENTATION){var e=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(e.segment(t)).map((function(t){return t.segment}))}return function(t){for(var e,i=Fn(t),n=[];!(e=i.next()).done;)e.value&&n.push(e.value.slice());return n}(t)},Rn=function(t,e){return 0!==e.letterSpacing?Qn(t):function(t,e){if(Ln.SUPPORT_NATIVE_TEXT_SEGMENTATION){var i=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(i.segment(t)).map((function(t){return t.segment}))}return Hn(t,e)}(t,e)},Nn=[32,160,4961,65792,65793,4153,4241],Hn=function(t,e){for(var i,n=function(t,e){var i=A(t),n=nt(i,e),r=n[0],o=n[1],s=n[2],a=i.length,l=0,c=0;return{next:function(){if(c>=a)return{done:!0,value:null};for(var t="×";c<a&&"×"===(t=it(i,o,r,++c,s)););if("×"!==t||c===a){var e=new rt(i,t,l,c);return l=c,{value:e,done:!1}}return{done:!0,value:null}}}}(t,{lineBreak:e.lineBreak,wordBreak:"break-word"===e.overflowWrap?"break-word":e.wordBreak}),r=[],o=function(){if(i.value){var t=i.value.slice(),e=A(t),n="";e.forEach((function(t){-1===Nn.indexOf(t)?n+=l(t):(n.length&&r.push(n),r.push(l(t)),n="")})),n.length&&r.push(n)}};!(i=n.next()).done;)o();return r},kn=function(t,e,i){this.text=Vn(e.data,i.textTransform),this.textBounds=function(t,e,i,n){var r=Rn(e,i),o=[],a=0;return r.forEach((function(e){if(i.textDecorationLine.length||e.trim().length>0)if(Ln.SUPPORT_RANGE_BOUNDS){var r=Dn(n,a,e.length).getClientRects();if(r.length>1){var A=Qn(e),l=0;A.forEach((function(e){o.push(new Mn(e,s.fromDOMRectList(t,Dn(n,l+a,e.length).getClientRects()))),l+=e.length}))}else o.push(new Mn(e,s.fromDOMRectList(t,r)))}else{var c=n.splitText(e.length);o.push(new Mn(e,Un(t,n))),n=c}else Ln.SUPPORT_RANGE_BOUNDS||(n=n.splitText(e.length));a+=e.length})),o}(t,this.text,i,e)},Vn=function(t,e){switch(e){case 1:return t.toLowerCase();case 3:return t.replace(jn,Gn);case 2:return t.toUpperCase();default:return t}},jn=/(^|\s|:|-|\(|\))([a-z])/g,Gn=function(t,e,i){return t.length>0?e+i.toUpperCase():t},Kn=function(t){function i(e,i){var n=t.call(this,e,i)||this;return n.src=i.currentSrc||i.src,n.intrinsicWidth=i.naturalWidth,n.intrinsicHeight=i.naturalHeight,n.context.cache.addImage(n.src),n}return e(i,t),i}(un),zn=function(t){function i(e,i){var n=t.call(this,e,i)||this;return n.canvas=i,n.intrinsicWidth=i.width,n.intrinsicHeight=i.height,n}return e(i,t),i}(un),Wn=function(t){function i(e,i){var n=t.call(this,e,i)||this,r=new XMLSerializer,o=a(e,i);return i.setAttribute("width",o.width+"px"),i.setAttribute("height",o.height+"px"),n.svg="data:image/svg+xml,"+encodeURIComponent(r.serializeToString(i)),n.intrinsicWidth=i.width.baseVal.value,n.intrinsicHeight=i.height.baseVal.value,n.context.cache.addImage(n.svg),n}return e(i,t),i}(un),qn=function(t){function i(e,i){var n=t.call(this,e,i)||this;return n.value=i.value,n}return e(i,t),i}(un),Xn=function(t){function i(e,i){var n=t.call(this,e,i)||this;return n.start=i.start,n.reversed="boolean"==typeof i.reversed&&!0===i.reversed,n}return e(i,t),i}(un),Yn=[{type:15,flags:0,unit:"px",number:3}],Jn=[{type:16,flags:0,number:50}],Zn="password",$n=function(t){function i(e,i){var n,r,o,a=t.call(this,e,i)||this;switch(a.type=i.type.toLowerCase(),a.checked=i.checked,a.value=0===(r=(n=i).type===Zn?new Array(n.value.length+1).join("•"):n.value).length?n.placeholder||"":r,"checkbox"!==a.type&&"radio"!==a.type||(a.styles.backgroundColor=3739148031,a.styles.borderTopColor=a.styles.borderRightColor=a.styles.borderBottomColor=a.styles.borderLeftColor=2779096575,a.styles.borderTopWidth=a.styles.borderRightWidth=a.styles.borderBottomWidth=a.styles.borderLeftWidth=1,a.styles.borderTopStyle=a.styles.borderRightStyle=a.styles.borderBottomStyle=a.styles.borderLeftStyle=1,a.styles.backgroundClip=[0],a.styles.backgroundOrigin=[0],a.bounds=(o=a.bounds).width>o.height?new s(o.left+(o.width-o.height)/2,o.top,o.height,o.height):o.width<o.height?new s(o.left,o.top+(o.height-o.width)/2,o.width,o.width):o),a.type){case"checkbox":a.styles.borderTopRightRadius=a.styles.borderTopLeftRadius=a.styles.borderBottomRightRadius=a.styles.borderBottomLeftRadius=Yn;break;case"radio":a.styles.borderTopRightRadius=a.styles.borderTopLeftRadius=a.styles.borderBottomRightRadius=a.styles.borderBottomLeftRadius=Jn}return a}return e(i,t),i}(un),tr=function(t){function i(e,i){var n=t.call(this,e,i)||this,r=i.options[i.selectedIndex||0];return n.value=r&&r.text||"",n}return e(i,t),i}(un),er=function(t){function i(e,i){var n=t.call(this,e,i)||this;return n.value=i.value,n}return e(i,t),i}(un),ir=function(t){function i(e,i){var n=t.call(this,e,i)||this;n.src=i.src,n.width=parseInt(i.width,10)||0,n.height=parseInt(i.height,10)||0,n.backgroundColor=n.styles.backgroundColor;try{if(i.contentWindow&&i.contentWindow.document&&i.contentWindow.document.documentElement){n.tree=sr(e,i.contentWindow.document.documentElement);var r=i.contentWindow.document.documentElement?fe(e,getComputedStyle(i.contentWindow.document.documentElement).backgroundColor):ge.TRANSPARENT,o=i.contentWindow.document.body?fe(e,getComputedStyle(i.contentWindow.document.body).backgroundColor):ge.TRANSPARENT;n.backgroundColor=se(r)?se(o)?n.styles.backgroundColor:o:r}}catch(t){}return n}return e(i,t),i}(un),nr=["OL","UL","MENU"],rr=function(t,e,i,n){for(var r=e.firstChild,o=void 0;r;r=o)if(o=r.nextSibling,lr(r)&&r.data.trim().length>0)i.textNodes.push(new kn(t,r,i.styles));else if(cr(r))if(Er(r)&&r.assignedNodes)r.assignedNodes().forEach((function(e){return rr(t,e,i,n)}));else{var s=or(t,r);s.styles.isVisible()&&(ar(r,s,n)?s.flags|=4:Ar(s.styles)&&(s.flags|=2),-1!==nr.indexOf(r.tagName)&&(s.flags|=8),i.elements.push(s),r.slot,r.shadowRoot?rr(t,r.shadowRoot,s,n):Br(r)||gr(r)||br(r)||rr(t,r,s,n))}},or=function(t,e){return _r(e)?new Kn(t,e):yr(e)?new zn(t,e):gr(e)?new Wn(t,e):pr(e)?new qn(t,e):dr(e)?new Xn(t,e):fr(e)?new $n(t,e):br(e)?new tr(t,e):Br(e)?new er(t,e):wr(e)?new ir(t,e):new un(t,e)},sr=function(t,e){var i=or(t,e);return i.flags|=4,rr(t,e,i,i),i},ar=function(t,e,i){return e.styles.isPositionedWithZIndex()||e.styles.opacity<1||e.styles.isTransformed()||mr(t)&&i.styles.isTransparent()},Ar=function(t){return t.isPositioned()||t.isFloating()},lr=function(t){return t.nodeType===Node.TEXT_NODE},cr=function(t){return t.nodeType===Node.ELEMENT_NODE},ur=function(t){return cr(t)&&void 0!==t.style&&!hr(t)},hr=function(t){return"object"==typeof t.className},pr=function(t){return"LI"===t.tagName},dr=function(t){return"OL"===t.tagName},fr=function(t){return"INPUT"===t.tagName},gr=function(t){return"svg"===t.tagName},mr=function(t){return"BODY"===t.tagName},yr=function(t){return"CANVAS"===t.tagName},vr=function(t){return"VIDEO"===t.tagName},_r=function(t){return"IMG"===t.tagName},wr=function(t){return"IFRAME"===t.tagName},Cr=function(t){return"STYLE"===t.tagName},Br=function(t){return"TEXTAREA"===t.tagName},br=function(t){return"SELECT"===t.tagName},Er=function(t){return"SLOT"===t.tagName},Sr=function(t){return t.tagName.indexOf("-")>0},xr=function(){function t(){this.counters={}}return t.prototype.getCounterValue=function(t){var e=this.counters[t];return e&&e.length?e[e.length-1]:1},t.prototype.getCounterValues=function(t){var e=this.counters[t];return e||[]},t.prototype.pop=function(t){var e=this;t.forEach((function(t){return e.counters[t].pop()}))},t.prototype.parse=function(t){var e=this,i=t.counterIncrement,n=t.counterReset,r=!0;null!==i&&i.forEach((function(t){var i=e.counters[t.counter];i&&0!==t.increment&&(r=!1,i.length||i.push(1),i[Math.max(0,i.length-1)]+=t.increment)}));var o=[];return r&&n.forEach((function(t){var i=e.counters[t.counter];o.push(t.counter),i||(i=e.counters[t.counter]=[]),i.push(t.reset)})),o},t}(),Ir={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},Fr={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["Ք","Փ","Ւ","Ց","Ր","Տ","Վ","Ս","Ռ","Ջ","Պ","Չ","Ո","Շ","Ն","Յ","Մ","Ճ","Ղ","Ձ","Հ","Կ","Ծ","Խ","Լ","Ի","Ժ","Թ","Ը","Է","Զ","Ե","Դ","Գ","Բ","Ա"]},Or={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["י׳","ט׳","ח׳","ז׳","ו׳","ה׳","ד׳","ג׳","ב׳","א׳","ת","ש","ר","ק","צ","פ","ע","ס","נ","מ","ל","כ","יט","יח","יז","טז","טו","י","ט","ח","ז","ו","ה","ד","ג","ב","א"]},Pr={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["ჵ","ჰ","ჯ","ჴ","ხ","ჭ","წ","ძ","ც","ჩ","შ","ყ","ღ","ქ","ფ","ჳ","ტ","ს","რ","ჟ","პ","ო","ჲ","ნ","მ","ლ","კ","ი","თ","ჱ","ზ","ვ","ე","დ","გ","ბ","ა"]},Tr=function(t,e,i,n,r,o){return t<e||t>i?Qr(t,r,o.length>0):n.integers.reduce((function(e,i,r){for(;t>=i;)t-=i,e+=n.values[r];return e}),"")+o},Lr=function(t,e,i,n){var r="";do{i||t--,r=n(t)+r,t/=e}while(t*e>=e);return r},Mr=function(t,e,i,n,r){var o=i-e+1;return(t<0?"-":"")+(Lr(Math.abs(t),o,n,(function(t){return l(Math.floor(t%o)+e)}))+r)},Ur=function(t,e,i){void 0===i&&(i=". ");var n=e.length;return Lr(Math.abs(t),n,!1,(function(t){return e[Math.floor(t%n)]}))+i},Dr=function(t,e,i,n,r,o){if(t<-9999||t>9999)return Qr(t,4,r.length>0);var s=Math.abs(t),a=r;if(0===s)return e[0]+a;for(var A=0;s>0&&A<=4;A++){var l=s%10;0===l&&qi(o,1)&&""!==a?a=e[l]+a:l>1||1===l&&0===A||1===l&&1===A&&qi(o,2)||1===l&&1===A&&qi(o,4)&&t>100||1===l&&A>1&&qi(o,8)?a=e[l]+(A>0?i[A-1]:"")+a:1===l&&A>0&&(a=i[A-1]+a),s=Math.floor(s/10)}return(t<0?n:"")+a},Qr=function(t,e,i){var n=i?". ":"",r=i?"、":"",o=i?", ":"",s=i?" ":"";switch(e){case 0:return"•"+s;case 1:return"◦"+s;case 2:return"◾"+s;case 5:var a=Mr(t,48,57,!0,n);return a.length<4?"0"+a:a;case 4:return Ur(t,"〇一二三四五六七八九",r);case 6:return Tr(t,1,3999,Ir,3,n).toLowerCase();case 7:return Tr(t,1,3999,Ir,3,n);case 8:return Mr(t,945,969,!1,n);case 9:return Mr(t,97,122,!1,n);case 10:return Mr(t,65,90,!1,n);case 11:return Mr(t,1632,1641,!0,n);case 12:case 49:return Tr(t,1,9999,Fr,3,n);case 35:return Tr(t,1,9999,Fr,3,n).toLowerCase();case 13:return Mr(t,2534,2543,!0,n);case 14:case 30:return Mr(t,6112,6121,!0,n);case 15:return Ur(t,"子丑寅卯辰巳午未申酉戌亥",r);case 16:return Ur(t,"甲乙丙丁戊己庚辛壬癸",r);case 17:case 48:return Dr(t,"零一二三四五六七八九","十百千萬","負",r,14);case 47:return Dr(t,"零壹貳參肆伍陸柒捌玖","拾佰仟萬","負",r,15);case 42:return Dr(t,"零一二三四五六七八九","十百千萬","负",r,14);case 41:return Dr(t,"零壹贰叁肆伍陆柒捌玖","拾佰仟萬","负",r,15);case 26:return Dr(t,"〇一二三四五六七八九","十百千万","マイナス",r,0);case 25:return Dr(t,"零壱弐参四伍六七八九","拾百千万","マイナス",r,7);case 31:return Dr(t,"영일이삼사오육칠팔구","십백천만","마이너스",o,7);case 33:return Dr(t,"零一二三四五六七八九","十百千萬","마이너스",o,0);case 32:return Dr(t,"零壹貳參四五六七八九","拾百千","마이너스",o,7);case 18:return Mr(t,2406,2415,!0,n);case 20:return Tr(t,1,19999,Pr,3,n);case 21:return Mr(t,2790,2799,!0,n);case 22:return Mr(t,2662,2671,!0,n);case 22:return Tr(t,1,10999,Or,3,n);case 23:return Ur(t,"あいうえおかきくけこさしすせそたちつてとなにぬねのはひふへほまみむめもやゆよらりるれろわゐゑをん");case 24:return Ur(t,"いろはにほへとちりぬるをわかよたれそつねならむうゐのおくやまけふこえてあさきゆめみしゑひもせす");case 27:return Mr(t,3302,3311,!0,n);case 28:return Ur(t,"アイウエオカキクケコサシスセソタチツテトナニヌネノハヒフヘホマミムメモヤユヨラリルレロワヰヱヲン",r);case 29:return Ur(t,"イロハニホヘトチリヌルヲワカヨタレソツネナラムウヰノオクヤマケフコエテアサキユメミシヱヒモセス",r);case 34:return Mr(t,3792,3801,!0,n);case 37:return Mr(t,6160,6169,!0,n);case 38:return Mr(t,4160,4169,!0,n);case 39:return Mr(t,2918,2927,!0,n);case 40:return Mr(t,1776,1785,!0,n);case 43:return Mr(t,3046,3055,!0,n);case 44:return Mr(t,3174,3183,!0,n);case 45:return Mr(t,3664,3673,!0,n);case 46:return Mr(t,3872,3881,!0,n);case 3:default:return Mr(t,48,57,!0,n)}},Rr=function(){function t(t,e,i){if(this.context=t,this.options=i,this.scrolledElements=[],this.referenceElement=e,this.counters=new xr,this.quoteDepth=0,!e.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(e.ownerDocument.documentElement,!1)}return t.prototype.toIFrame=function(t,e){var i=this,o=Hr(t,e);if(!o.contentWindow)return Promise.reject("Unable to find iframe window");var s=t.defaultView.pageXOffset,a=t.defaultView.pageYOffset,A=o.contentWindow,l=A.document,c=jr(o).then((function(){return n(i,void 0,void 0,(function(){var t,i;return r(this,(function(n){switch(n.label){case 0:return this.scrolledElements.forEach(qr),A&&(A.scrollTo(e.left,e.top),!/(iPad|iPhone|iPod)/g.test(navigator.userAgent)||A.scrollY===e.top&&A.scrollX===e.left||(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(A.scrollX-e.left,A.scrollY-e.top,0,0))),t=this.options.onclone,void 0===(i=this.clonedReferenceElement)?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:l.fonts&&l.fonts.ready?[4,l.fonts.ready]:[3,2];case 1:n.sent(),n.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,Vr(l)]:[3,4];case 3:n.sent(),n.label=4;case 4:return"function"==typeof t?[2,Promise.resolve().then((function(){return t(l,i)})).then((function(){return o}))]:[2,o]}}))}))}));return l.open(),l.write(zr(document.doctype)+"<html></html>"),Wr(this.referenceElement.ownerDocument,s,a),l.replaceChild(l.adoptNode(this.documentElement),l.documentElement),l.close(),c},t.prototype.createElementClone=function(t){if(cn(t,2),yr(t))return this.createCanvasClone(t);if(vr(t))return this.createVideoClone(t);if(Cr(t))return this.createStyleClone(t);var e=t.cloneNode(!1);return _r(e)&&(_r(t)&&t.currentSrc&&t.currentSrc!==t.src&&(e.src=t.currentSrc,e.srcset=""),"lazy"===e.loading&&(e.loading="eager")),Sr(e)?this.createCustomElementClone(e):e},t.prototype.createCustomElementClone=function(t){var e=document.createElement("html2canvascustomelement");return Kr(t.style,e),e},t.prototype.createStyleClone=function(t){try{var e=t.sheet;if(e&&e.cssRules){var i=[].slice.call(e.cssRules,0).reduce((function(t,e){return e&&"string"==typeof e.cssText?t+e.cssText:t}),""),n=t.cloneNode(!1);return n.textContent=i,n}}catch(t){if(this.context.logger.error("Unable to access cssRules property",t),"SecurityError"!==t.name)throw t}return t.cloneNode(!1)},t.prototype.createCanvasClone=function(t){var e;if(this.options.inlineImages&&t.ownerDocument){var i=t.ownerDocument.createElement("img");try{return i.src=t.toDataURL(),i}catch(e){this.context.logger.info("Unable to inline canvas contents, canvas is tainted",t)}}var n=t.cloneNode(!1);try{n.width=t.width,n.height=t.height;var r=t.getContext("2d"),o=n.getContext("2d");if(o)if(!this.options.allowTaint&&r)o.putImageData(r.getImageData(0,0,t.width,t.height),0,0);else{var s=null!==(e=t.getContext("webgl2"))&&void 0!==e?e:t.getContext("webgl");if(s){var a=s.getContextAttributes();!1===(null==a?void 0:a.preserveDrawingBuffer)&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",t)}o.drawImage(t,0,0)}return n}catch(e){this.context.logger.info("Unable to clone canvas as it is tainted",t)}return n},t.prototype.createVideoClone=function(t){var e=t.ownerDocument.createElement("canvas");e.width=t.offsetWidth,e.height=t.offsetHeight;var i=e.getContext("2d");try{return i&&(i.drawImage(t,0,0,e.width,e.height),this.options.allowTaint||i.getImageData(0,0,e.width,e.height)),e}catch(e){this.context.logger.info("Unable to clone video as it is tainted",t)}var n=t.ownerDocument.createElement("canvas");return n.width=t.offsetWidth,n.height=t.offsetHeight,n},t.prototype.appendChildNode=function(t,e,i){cr(e)&&("SCRIPT"===e.tagName||e.hasAttribute("data-html2canvas-ignore")||"function"==typeof this.options.ignoreElements&&this.options.ignoreElements(e))||this.options.copyStyles&&cr(e)&&Cr(e)||t.appendChild(this.cloneNode(e,i))},t.prototype.cloneChildNodes=function(t,e,i){for(var n=this,r=t.shadowRoot?t.shadowRoot.firstChild:t.firstChild;r;r=r.nextSibling)if(cr(r)&&Er(r)&&"function"==typeof r.assignedNodes){var o=r.assignedNodes();o.length&&o.forEach((function(t){return n.appendChildNode(e,t,i)}))}else this.appendChildNode(e,r,i)},t.prototype.cloneNode=function(t,e){if(lr(t))return document.createTextNode(t.data);if(!t.ownerDocument)return t.cloneNode(!1);var i=t.ownerDocument.defaultView;if(i&&cr(t)&&(ur(t)||hr(t))){var n=this.createElementClone(t);n.style.transitionProperty="none";var r=i.getComputedStyle(t),o=i.getComputedStyle(t,":before"),s=i.getComputedStyle(t,":after");this.referenceElement===t&&ur(n)&&(this.clonedReferenceElement=n),mr(n)&&Jr(n);var a=this.counters.parse(new An(this.context,r)),A=this.resolvePseudoContent(t,n,o,_n.BEFORE);Sr(t)&&(e=!0),vr(t)||this.cloneChildNodes(t,n,e),A&&n.insertBefore(A,n.firstChild);var l=this.resolvePseudoContent(t,n,s,_n.AFTER);return l&&n.appendChild(l),this.counters.pop(a),(r&&(this.options.copyStyles||hr(t))&&!wr(t)||e)&&Kr(r,n),0===t.scrollTop&&0===t.scrollLeft||this.scrolledElements.push([n,t.scrollLeft,t.scrollTop]),(Br(t)||br(t))&&(Br(n)||br(n))&&(n.value=t.value),n}return t.cloneNode(!1)},t.prototype.resolvePseudoContent=function(t,e,i,n){var r=this;if(i){var o=i.content,s=e.ownerDocument;if(s&&o&&"none"!==o&&"-moz-alt-content"!==o&&"none"!==i.display){this.counters.parse(new An(this.context,i));var a=new an(this.context,i),A=s.createElement("html2canvaspseudoelement");Kr(i,A),a.content.forEach((function(e){if(0===e.type)A.appendChild(s.createTextNode(e.value));else if(22===e.type){var i=s.createElement("img");i.src=e.value,i.style.opacity="1",A.appendChild(i)}else if(18===e.type){if("attr"===e.name){var n=e.values.filter(Ht);n.length&&A.appendChild(s.createTextNode(t.getAttribute(n[0].value)||""))}else if("counter"===e.name){var o=e.values.filter(Gt),l=o[0],c=o[1];if(l&&Ht(l)){var u=r.counters.getCounterValue(l.value),h=c&&Ht(c)?di.parse(r.context,c.value):3;A.appendChild(s.createTextNode(Qr(u,h,!1)))}}else if("counters"===e.name){var p=e.values.filter(Gt),d=(l=p[0],p[1]);if(c=p[2],l&&Ht(l)){var f=r.counters.getCounterValues(l.value),g=c&&Ht(c)?di.parse(r.context,c.value):3,m=d&&0===d.type?d.value:"",y=f.map((function(t){return Qr(t,g,!1)})).join(m);A.appendChild(s.createTextNode(y))}}}else if(20===e.type)switch(e.value){case"open-quote":A.appendChild(s.createTextNode(tn(a.quotes,r.quoteDepth++,!0)));break;case"close-quote":A.appendChild(s.createTextNode(tn(a.quotes,--r.quoteDepth,!1)));break;default:A.appendChild(s.createTextNode(e.value))}})),A.className=Xr+" "+Yr;var l=n===_n.BEFORE?" "+Xr:" "+Yr;return hr(e)?e.className.baseValue+=l:e.className+=l,A}}},t.destroy=function(t){return!!t.parentNode&&(t.parentNode.removeChild(t),!0)},t}();!function(t){t[t.BEFORE=0]="BEFORE",t[t.AFTER=1]="AFTER"}(_n||(_n={}));var Nr,Hr=function(t,e){var i=t.createElement("iframe");return i.className="html2canvas-container",i.style.visibility="hidden",i.style.position="fixed",i.style.left="-10000px",i.style.top="0px",i.style.border="0",i.width=e.width.toString(),i.height=e.height.toString(),i.scrolling="no",i.setAttribute("data-html2canvas-ignore","true"),t.body.appendChild(i),i},kr=function(t){return new Promise((function(e){t.complete?e():t.src?(t.onload=e,t.onerror=e):e()}))},Vr=function(t){return Promise.all([].slice.call(t.images,0).map(kr))},jr=function(t){return new Promise((function(e,i){var n=t.contentWindow;if(!n)return i("No window assigned for iframe");var r=n.document;n.onload=t.onload=function(){n.onload=t.onload=null;var i=setInterval((function(){r.body.childNodes.length>0&&"complete"===r.readyState&&(clearInterval(i),e(t))}),50)}}))},Gr=["all","d","content"],Kr=function(t,e){for(var i=t.length-1;i>=0;i--){var n=t.item(i);-1===Gr.indexOf(n)&&e.style.setProperty(n,t.getPropertyValue(n))}return e},zr=function(t){var e="";return t&&(e+="<!DOCTYPE ",t.name&&(e+=t.name),t.internalSubset&&(e+=t.internalSubset),t.publicId&&(e+='"'+t.publicId+'"'),t.systemId&&(e+='"'+t.systemId+'"'),e+=">"),e},Wr=function(t,e,i){t&&t.defaultView&&(e!==t.defaultView.pageXOffset||i!==t.defaultView.pageYOffset)&&t.defaultView.scrollTo(e,i)},qr=function(t){var e=t[0],i=t[1],n=t[2];e.scrollLeft=i,e.scrollTop=n},Xr="___html2canvas___pseudoelement_before",Yr="___html2canvas___pseudoelement_after",Jr=function(t){Zr(t,"."+Xr+':before{\n    content: "" !important;\n    display: none !important;\n}\n         .'+Yr+':after{\n    content: "" !important;\n    display: none !important;\n}')},Zr=function(t,e){var i=t.ownerDocument;if(i){var n=i.createElement("style");n.textContent=e,t.appendChild(n)}},$r=function(){function t(){}return t.getOrigin=function(e){var i=t._link;return i?(i.href=e,i.href=i.href,i.protocol+i.hostname+i.port):"about:blank"},t.isSameOrigin=function(e){return t.getOrigin(e)===t._origin},t.setContext=function(e){t._link=e.document.createElement("a"),t._origin=t.getOrigin(e.location.href)},t._origin="about:blank",t}(),to=function(){function t(t,e){this.context=t,this._options=e,this._cache={}}return t.prototype.addImage=function(t){var e=Promise.resolve();return this.has(t)?e:ao(t)||ro(t)?((this._cache[t]=this.loadImage(t)).catch((function(){})),e):e},t.prototype.match=function(t){return this._cache[t]},t.prototype.loadImage=function(t){return n(this,void 0,void 0,(function(){var e,i,n,o,s=this;return r(this,(function(r){switch(r.label){case 0:return e=$r.isSameOrigin(t),i=!oo(t)&&!0===this._options.useCORS&&Ln.SUPPORT_CORS_IMAGES&&!e,n=!oo(t)&&!e&&!ao(t)&&"string"==typeof this._options.proxy&&Ln.SUPPORT_CORS_XHR&&!i,e||!1!==this._options.allowTaint||oo(t)||ao(t)||n||i?(o=t,n?[4,this.proxy(o)]:[3,2]):[2];case 1:o=r.sent(),r.label=2;case 2:return this.context.logger.debug("Added image "+t.substring(0,256)),[4,new Promise((function(t,e){var n=new Image;n.onload=function(){return t(n)},n.onerror=e,(so(o)||i)&&(n.crossOrigin="anonymous"),n.src=o,!0===n.complete&&setTimeout((function(){return t(n)}),500),s._options.imageTimeout>0&&setTimeout((function(){return e("Timed out ("+s._options.imageTimeout+"ms) loading image")}),s._options.imageTimeout)}))];case 3:return[2,r.sent()]}}))}))},t.prototype.has=function(t){return void 0!==this._cache[t]},t.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},t.prototype.proxy=function(t){var e=this,i=this._options.proxy;if(!i)throw new Error("No proxy defined");var n=t.substring(0,256);return new Promise((function(r,o){var s=Ln.SUPPORT_RESPONSE_TYPE?"blob":"text",a=new XMLHttpRequest;a.onload=function(){if(200===a.status)if("text"===s)r(a.response);else{var t=new FileReader;t.addEventListener("load",(function(){return r(t.result)}),!1),t.addEventListener("error",(function(t){return o(t)}),!1),t.readAsDataURL(a.response)}else o("Failed to proxy resource "+n+" with status code "+a.status)},a.onerror=o;var A=i.indexOf("?")>-1?"&":"?";if(a.open("GET",""+i+A+"url="+encodeURIComponent(t)+"&responseType="+s),"text"!==s&&a instanceof XMLHttpRequest&&(a.responseType=s),e._options.imageTimeout){var l=e._options.imageTimeout;a.timeout=l,a.ontimeout=function(){return o("Timed out ("+l+"ms) proxying "+n)}}a.send()}))},t}(),eo=/^data:image\/svg\+xml/i,io=/^data:image\/.*;base64,/i,no=/^data:image\/.*/i,ro=function(t){return Ln.SUPPORT_SVG_DRAWING||!Ao(t)},oo=function(t){return no.test(t)},so=function(t){return io.test(t)},ao=function(t){return"blob"===t.substr(0,4)},Ao=function(t){return"svg"===t.substr(-3).toLowerCase()||eo.test(t)},lo=function(){function t(t,e){this.type=0,this.x=t,this.y=e}return t.prototype.add=function(e,i){return new t(this.x+e,this.y+i)},t}(),co=function(t,e,i){return new lo(t.x+(e.x-t.x)*i,t.y+(e.y-t.y)*i)},uo=function(){function t(t,e,i,n){this.type=1,this.start=t,this.startControl=e,this.endControl=i,this.end=n}return t.prototype.subdivide=function(e,i){var n=co(this.start,this.startControl,e),r=co(this.startControl,this.endControl,e),o=co(this.endControl,this.end,e),s=co(n,r,e),a=co(r,o,e),A=co(s,a,e);return i?new t(this.start,n,s,A):new t(A,a,o,this.end)},t.prototype.add=function(e,i){return new t(this.start.add(e,i),this.startControl.add(e,i),this.endControl.add(e,i),this.end.add(e,i))},t.prototype.reverse=function(){return new t(this.end,this.endControl,this.startControl,this.start)},t}(),ho=function(t){return 1===t.type},po=function(t){var e=t.styles,i=t.bounds,n=$t(e.borderTopLeftRadius,i.width,i.height),r=n[0],o=n[1],s=$t(e.borderTopRightRadius,i.width,i.height),a=s[0],A=s[1],l=$t(e.borderBottomRightRadius,i.width,i.height),c=l[0],u=l[1],h=$t(e.borderBottomLeftRadius,i.width,i.height),p=h[0],d=h[1],f=[];f.push((r+a)/i.width),f.push((p+c)/i.width),f.push((o+d)/i.height),f.push((A+u)/i.height);var g=Math.max.apply(Math,f);g>1&&(r/=g,o/=g,a/=g,A/=g,c/=g,u/=g,p/=g,d/=g);var m=i.width-a,y=i.height-u,v=i.width-c,_=i.height-d,w=e.borderTopWidth,C=e.borderRightWidth,B=e.borderBottomWidth,b=e.borderLeftWidth,E=te(e.paddingTop,t.bounds.width),S=te(e.paddingRight,t.bounds.width),x=te(e.paddingBottom,t.bounds.width),I=te(e.paddingLeft,t.bounds.width);this.topLeftBorderDoubleOuterBox=r>0||o>0?fo(i.left+b/3,i.top+w/3,r-b/3,o-w/3,Nr.TOP_LEFT):new lo(i.left+b/3,i.top+w/3),this.topRightBorderDoubleOuterBox=r>0||o>0?fo(i.left+m,i.top+w/3,a-C/3,A-w/3,Nr.TOP_RIGHT):new lo(i.left+i.width-C/3,i.top+w/3),this.bottomRightBorderDoubleOuterBox=c>0||u>0?fo(i.left+v,i.top+y,c-C/3,u-B/3,Nr.BOTTOM_RIGHT):new lo(i.left+i.width-C/3,i.top+i.height-B/3),this.bottomLeftBorderDoubleOuterBox=p>0||d>0?fo(i.left+b/3,i.top+_,p-b/3,d-B/3,Nr.BOTTOM_LEFT):new lo(i.left+b/3,i.top+i.height-B/3),this.topLeftBorderDoubleInnerBox=r>0||o>0?fo(i.left+2*b/3,i.top+2*w/3,r-2*b/3,o-2*w/3,Nr.TOP_LEFT):new lo(i.left+2*b/3,i.top+2*w/3),this.topRightBorderDoubleInnerBox=r>0||o>0?fo(i.left+m,i.top+2*w/3,a-2*C/3,A-2*w/3,Nr.TOP_RIGHT):new lo(i.left+i.width-2*C/3,i.top+2*w/3),this.bottomRightBorderDoubleInnerBox=c>0||u>0?fo(i.left+v,i.top+y,c-2*C/3,u-2*B/3,Nr.BOTTOM_RIGHT):new lo(i.left+i.width-2*C/3,i.top+i.height-2*B/3),this.bottomLeftBorderDoubleInnerBox=p>0||d>0?fo(i.left+2*b/3,i.top+_,p-2*b/3,d-2*B/3,Nr.BOTTOM_LEFT):new lo(i.left+2*b/3,i.top+i.height-2*B/3),this.topLeftBorderStroke=r>0||o>0?fo(i.left+b/2,i.top+w/2,r-b/2,o-w/2,Nr.TOP_LEFT):new lo(i.left+b/2,i.top+w/2),this.topRightBorderStroke=r>0||o>0?fo(i.left+m,i.top+w/2,a-C/2,A-w/2,Nr.TOP_RIGHT):new lo(i.left+i.width-C/2,i.top+w/2),this.bottomRightBorderStroke=c>0||u>0?fo(i.left+v,i.top+y,c-C/2,u-B/2,Nr.BOTTOM_RIGHT):new lo(i.left+i.width-C/2,i.top+i.height-B/2),this.bottomLeftBorderStroke=p>0||d>0?fo(i.left+b/2,i.top+_,p-b/2,d-B/2,Nr.BOTTOM_LEFT):new lo(i.left+b/2,i.top+i.height-B/2),this.topLeftBorderBox=r>0||o>0?fo(i.left,i.top,r,o,Nr.TOP_LEFT):new lo(i.left,i.top),this.topRightBorderBox=a>0||A>0?fo(i.left+m,i.top,a,A,Nr.TOP_RIGHT):new lo(i.left+i.width,i.top),this.bottomRightBorderBox=c>0||u>0?fo(i.left+v,i.top+y,c,u,Nr.BOTTOM_RIGHT):new lo(i.left+i.width,i.top+i.height),this.bottomLeftBorderBox=p>0||d>0?fo(i.left,i.top+_,p,d,Nr.BOTTOM_LEFT):new lo(i.left,i.top+i.height),this.topLeftPaddingBox=r>0||o>0?fo(i.left+b,i.top+w,Math.max(0,r-b),Math.max(0,o-w),Nr.TOP_LEFT):new lo(i.left+b,i.top+w),this.topRightPaddingBox=a>0||A>0?fo(i.left+Math.min(m,i.width-C),i.top+w,m>i.width+C?0:Math.max(0,a-C),Math.max(0,A-w),Nr.TOP_RIGHT):new lo(i.left+i.width-C,i.top+w),this.bottomRightPaddingBox=c>0||u>0?fo(i.left+Math.min(v,i.width-b),i.top+Math.min(y,i.height-B),Math.max(0,c-C),Math.max(0,u-B),Nr.BOTTOM_RIGHT):new lo(i.left+i.width-C,i.top+i.height-B),this.bottomLeftPaddingBox=p>0||d>0?fo(i.left+b,i.top+Math.min(_,i.height-B),Math.max(0,p-b),Math.max(0,d-B),Nr.BOTTOM_LEFT):new lo(i.left+b,i.top+i.height-B),this.topLeftContentBox=r>0||o>0?fo(i.left+b+I,i.top+w+E,Math.max(0,r-(b+I)),Math.max(0,o-(w+E)),Nr.TOP_LEFT):new lo(i.left+b+I,i.top+w+E),this.topRightContentBox=a>0||A>0?fo(i.left+Math.min(m,i.width+b+I),i.top+w+E,m>i.width+b+I?0:a-b+I,A-(w+E),Nr.TOP_RIGHT):new lo(i.left+i.width-(C+S),i.top+w+E),this.bottomRightContentBox=c>0||u>0?fo(i.left+Math.min(v,i.width-(b+I)),i.top+Math.min(y,i.height+w+E),Math.max(0,c-(C+S)),u-(B+x),Nr.BOTTOM_RIGHT):new lo(i.left+i.width-(C+S),i.top+i.height-(B+x)),this.bottomLeftContentBox=p>0||d>0?fo(i.left+b+I,i.top+_,Math.max(0,p-(b+I)),d-(B+x),Nr.BOTTOM_LEFT):new lo(i.left+b+I,i.top+i.height-(B+x))};!function(t){t[t.TOP_LEFT=0]="TOP_LEFT",t[t.TOP_RIGHT=1]="TOP_RIGHT",t[t.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",t[t.BOTTOM_LEFT=3]="BOTTOM_LEFT"}(Nr||(Nr={}));var fo=function(t,e,i,n,r){var o=(Math.sqrt(2)-1)/3*4,s=i*o,a=n*o,A=t+i,l=e+n;switch(r){case Nr.TOP_LEFT:return new uo(new lo(t,l),new lo(t,l-a),new lo(A-s,e),new lo(A,e));case Nr.TOP_RIGHT:return new uo(new lo(t,e),new lo(t+s,e),new lo(A,l-a),new lo(A,l));case Nr.BOTTOM_RIGHT:return new uo(new lo(A,e),new lo(A,e+a),new lo(t+s,l),new lo(t,l));case Nr.BOTTOM_LEFT:default:return new uo(new lo(A,l),new lo(A-s,l),new lo(t,e+a),new lo(t,e))}},go=function(t){return[t.topLeftBorderBox,t.topRightBorderBox,t.bottomRightBorderBox,t.bottomLeftBorderBox]},mo=function(t){return[t.topLeftPaddingBox,t.topRightPaddingBox,t.bottomRightPaddingBox,t.bottomLeftPaddingBox]},yo=function(t,e,i){this.offsetX=t,this.offsetY=e,this.matrix=i,this.type=0,this.target=6},vo=function(t,e){this.path=t,this.target=e,this.type=1},_o=function(t){this.opacity=t,this.type=2,this.target=6},wo=function(t){return 1===t.type},Co=function(t,e){return t.length===e.length&&t.some((function(t,i){return t===e[i]}))},Bo=function(t){this.element=t,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]},bo=function(){function t(t,e){if(this.container=t,this.parent=e,this.effects=[],this.curves=new po(this.container),this.container.styles.opacity<1&&this.effects.push(new _o(this.container.styles.opacity)),null!==this.container.styles.transform){var i=this.container.bounds.left+this.container.styles.transformOrigin[0].number,n=this.container.bounds.top+this.container.styles.transformOrigin[1].number,r=this.container.styles.transform;this.effects.push(new yo(i,n,r))}if(0!==this.container.styles.overflowX){var o=go(this.curves),s=mo(this.curves);Co(o,s)?this.effects.push(new vo(o,6)):(this.effects.push(new vo(o,2)),this.effects.push(new vo(s,4)))}}return t.prototype.getEffects=function(t){for(var e=-1===[2,3].indexOf(this.container.styles.position),i=this.parent,n=this.effects.slice(0);i;){var r=i.effects.filter((function(t){return!wo(t)}));if(e||0!==i.container.styles.position||!i.parent){if(n.unshift.apply(n,r),e=-1===[2,3].indexOf(i.container.styles.position),0!==i.container.styles.overflowX){var o=go(i.curves),s=mo(i.curves);Co(o,s)||n.unshift(new vo(s,6))}}else n.unshift.apply(n,r);i=i.parent}return n.filter((function(e){return qi(e.target,t)}))},t}(),Eo=function(t,e,i,n){t.container.elements.forEach((function(r){var o=qi(r.flags,4),s=qi(r.flags,2),a=new bo(r,t);qi(r.styles.display,2048)&&n.push(a);var A=qi(r.flags,8)?[]:n;if(o||s){var l=o||r.styles.isPositioned()?i:e,c=new Bo(a);if(r.styles.isPositioned()||r.styles.opacity<1||r.styles.isTransformed()){var u=r.styles.zIndex.order;if(u<0){var h=0;l.negativeZIndex.some((function(t,e){return u>t.element.container.styles.zIndex.order?(h=e,!1):h>0})),l.negativeZIndex.splice(h,0,c)}else if(u>0){var p=0;l.positiveZIndex.some((function(t,e){return u>=t.element.container.styles.zIndex.order?(p=e+1,!1):p>0})),l.positiveZIndex.splice(p,0,c)}else l.zeroOrAutoZIndexOrTransformedOrOpacity.push(c)}else r.styles.isFloating()?l.nonPositionedFloats.push(c):l.nonPositionedInlineLevel.push(c);Eo(a,c,o?c:i,A)}else r.styles.isInlineLevel()?e.inlineLevel.push(a):e.nonInlineLevel.push(a),Eo(a,e,i,A);qi(r.flags,8)&&So(r,A)}))},So=function(t,e){for(var i=t instanceof Xn?t.start:1,n=t instanceof Xn&&t.reversed,r=0;r<e.length;r++){var o=e[r];o.container instanceof qn&&"number"==typeof o.container.value&&0!==o.container.value&&(i=o.container.value),o.listValue=Qr(i,o.container.styles.listStyleType,!0),i+=n?-1:1}},xo=function(t,e){switch(e){case 0:return Fo(t.topLeftBorderBox,t.topLeftPaddingBox,t.topRightBorderBox,t.topRightPaddingBox);case 1:return Fo(t.topRightBorderBox,t.topRightPaddingBox,t.bottomRightBorderBox,t.bottomRightPaddingBox);case 2:return Fo(t.bottomRightBorderBox,t.bottomRightPaddingBox,t.bottomLeftBorderBox,t.bottomLeftPaddingBox);case 3:default:return Fo(t.bottomLeftBorderBox,t.bottomLeftPaddingBox,t.topLeftBorderBox,t.topLeftPaddingBox)}},Io=function(t,e){var i=[];return ho(t)?i.push(t.subdivide(.5,!1)):i.push(t),ho(e)?i.push(e.subdivide(.5,!0)):i.push(e),i},Fo=function(t,e,i,n){var r=[];return ho(t)?r.push(t.subdivide(.5,!1)):r.push(t),ho(i)?r.push(i.subdivide(.5,!0)):r.push(i),ho(n)?r.push(n.subdivide(.5,!0).reverse()):r.push(n),ho(e)?r.push(e.subdivide(.5,!1).reverse()):r.push(e),r},Oo=function(t){var e=t.bounds,i=t.styles;return e.add(i.borderLeftWidth,i.borderTopWidth,-(i.borderRightWidth+i.borderLeftWidth),-(i.borderTopWidth+i.borderBottomWidth))},Po=function(t){var e=t.styles,i=t.bounds,n=te(e.paddingLeft,i.width),r=te(e.paddingRight,i.width),o=te(e.paddingTop,i.width),s=te(e.paddingBottom,i.width);return i.add(n+e.borderLeftWidth,o+e.borderTopWidth,-(e.borderRightWidth+e.borderLeftWidth+n+r),-(e.borderTopWidth+e.borderBottomWidth+o+s))},To=function(t,e,i){var n=function(t,e){return 0===t?e.bounds:2===t?Po(e):Oo(e)}(Do(t.styles.backgroundOrigin,e),t),r=function(t,e){return 0===t?e.bounds:2===t?Po(e):Oo(e)}(Do(t.styles.backgroundClip,e),t),o=Uo(Do(t.styles.backgroundSize,e),i,n),s=o[0],a=o[1],A=$t(Do(t.styles.backgroundPosition,e),n.width-s,n.height-a);return[Qo(Do(t.styles.backgroundRepeat,e),A,o,n,r),Math.round(n.left+A[0]),Math.round(n.top+A[1]),s,a]},Lo=function(t){return Ht(t)&&t.value===he.AUTO},Mo=function(t){return"number"==typeof t},Uo=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=t[0],a=t[1];if(!s)return[0,0];if(qt(s)&&a&&qt(a))return[te(s,i.width),te(a,i.height)];var A=Mo(o);if(Ht(s)&&(s.value===he.CONTAIN||s.value===he.COVER))return Mo(o)?i.width/i.height<o!=(s.value===he.COVER)?[i.width,i.width/o]:[i.height*o,i.height]:[i.width,i.height];var l=Mo(n),c=Mo(r),u=l||c;if(Lo(s)&&(!a||Lo(a)))return l&&c?[n,r]:A||u?u&&A?[l?n:r*o,c?r:n/o]:[l?n:i.width,c?r:i.height]:[i.width,i.height];if(A){var h=0,p=0;return qt(s)?h=te(s,i.width):qt(a)&&(p=te(a,i.height)),Lo(s)?h=p*o:a&&!Lo(a)||(p=h/o),[h,p]}var d=null,f=null;if(qt(s)?d=te(s,i.width):a&&qt(a)&&(f=te(a,i.height)),null===d||a&&!Lo(a)||(f=l&&c?d/n*r:i.height),null!==f&&Lo(s)&&(d=l&&c?f/r*n:i.width),null!==d&&null!==f)return[d,f];throw new Error("Unable to calculate background-size for element")},Do=function(t,e){var i=t[e];return void 0===i?t[0]:i},Qo=function(t,e,i,n,r){var o=e[0],s=e[1],a=i[0],A=i[1];switch(t){case 2:return[new lo(Math.round(n.left),Math.round(n.top+s)),new lo(Math.round(n.left+n.width),Math.round(n.top+s)),new lo(Math.round(n.left+n.width),Math.round(A+n.top+s)),new lo(Math.round(n.left),Math.round(A+n.top+s))];case 3:return[new lo(Math.round(n.left+o),Math.round(n.top)),new lo(Math.round(n.left+o+a),Math.round(n.top)),new lo(Math.round(n.left+o+a),Math.round(n.height+n.top)),new lo(Math.round(n.left+o),Math.round(n.height+n.top))];case 1:return[new lo(Math.round(n.left+o),Math.round(n.top+s)),new lo(Math.round(n.left+o+a),Math.round(n.top+s)),new lo(Math.round(n.left+o+a),Math.round(n.top+s+A)),new lo(Math.round(n.left+o),Math.round(n.top+s+A))];default:return[new lo(Math.round(r.left),Math.round(r.top)),new lo(Math.round(r.left+r.width),Math.round(r.top)),new lo(Math.round(r.left+r.width),Math.round(r.height+r.top)),new lo(Math.round(r.left),Math.round(r.height+r.top))]}},Ro=function(){function t(t){this._data={},this._document=t}return t.prototype.parseMetrics=function(t,e){var i=this._document.createElement("div"),n=this._document.createElement("img"),r=this._document.createElement("span"),o=this._document.body;i.style.visibility="hidden",i.style.fontFamily=t,i.style.fontSize=e,i.style.margin="0",i.style.padding="0",i.style.whiteSpace="nowrap",o.appendChild(i),n.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",n.width=1,n.height=1,n.style.margin="0",n.style.padding="0",n.style.verticalAlign="baseline",r.style.fontFamily=t,r.style.fontSize=e,r.style.margin="0",r.style.padding="0",r.appendChild(this._document.createTextNode("Hidden Text")),i.appendChild(r),i.appendChild(n);var s=n.offsetTop-r.offsetTop+2;i.removeChild(r),i.appendChild(this._document.createTextNode("Hidden Text")),i.style.lineHeight="normal",n.style.verticalAlign="super";var a=n.offsetTop-i.offsetTop+2;return o.removeChild(i),{baseline:s,middle:a}},t.prototype.getMetrics=function(t,e){var i=t+" "+e;return void 0===this._data[i]&&(this._data[i]=this.parseMetrics(t,e)),this._data[i]},t}(),No=function(t,e){this.context=t,this.options=e},Ho=function(t){function i(e,i){var n=t.call(this,e,i)||this;return n._activeEffects=[],n.canvas=i.canvas?i.canvas:document.createElement("canvas"),n.ctx=n.canvas.getContext("2d"),i.canvas||(n.canvas.width=Math.floor(i.width*i.scale),n.canvas.height=Math.floor(i.height*i.scale),n.canvas.style.width=i.width+"px",n.canvas.style.height=i.height+"px"),n.fontMetrics=new Ro(document),n.ctx.scale(n.options.scale,n.options.scale),n.ctx.translate(-i.x,-i.y),n.ctx.textBaseline="bottom",n._activeEffects=[],n.context.logger.debug("Canvas renderer initialized ("+i.width+"x"+i.height+") with scale "+i.scale),n}return e(i,t),i.prototype.applyEffects=function(t){for(var e=this;this._activeEffects.length;)this.popEffect();t.forEach((function(t){return e.applyEffect(t)}))},i.prototype.applyEffect=function(t){this.ctx.save(),function(t){return 2===t.type}(t)&&(this.ctx.globalAlpha=t.opacity),function(t){return 0===t.type}(t)&&(this.ctx.translate(t.offsetX,t.offsetY),this.ctx.transform(t.matrix[0],t.matrix[1],t.matrix[2],t.matrix[3],t.matrix[4],t.matrix[5]),this.ctx.translate(-t.offsetX,-t.offsetY)),wo(t)&&(this.path(t.path),this.ctx.clip()),this._activeEffects.push(t)},i.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},i.prototype.renderStack=function(t){return n(this,void 0,void 0,(function(){return r(this,(function(e){switch(e.label){case 0:return t.element.container.styles.isVisible()?[4,this.renderStackContent(t)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},i.prototype.renderNode=function(t){return n(this,void 0,void 0,(function(){return r(this,(function(e){switch(e.label){case 0:return qi(t.container.flags,16),t.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(t)]:[3,3];case 1:return e.sent(),[4,this.renderNodeContent(t)];case 2:e.sent(),e.label=3;case 3:return[2]}}))}))},i.prototype.renderTextWithLetterSpacing=function(t,e,i){var n=this;0===e?this.ctx.fillText(t.text,t.bounds.left,t.bounds.top+i):Qn(t.text).reduce((function(e,r){return n.ctx.fillText(r,e,t.bounds.top+i),e+n.ctx.measureText(r).width}),t.bounds.left)},i.prototype.createFontStyle=function(t){var e=t.fontVariant.filter((function(t){return"normal"===t||"small-caps"===t})).join(""),i=Ko(t.fontFamily).join(", "),n=Rt(t.fontSize)?""+t.fontSize.number+t.fontSize.unit:t.fontSize.number+"px";return[[t.fontStyle,e,t.fontWeight,n,i].join(" "),i,n]},i.prototype.renderTextNode=function(t,e){return n(this,void 0,void 0,(function(){var i,n,o,s,a,A,l,c,u=this;return r(this,(function(r){return i=this.createFontStyle(e),n=i[0],o=i[1],s=i[2],this.ctx.font=n,this.ctx.direction=1===e.direction?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",a=this.fontMetrics.getMetrics(o,s),A=a.baseline,l=a.middle,c=e.paintOrder,t.textBounds.forEach((function(t){c.forEach((function(i){switch(i){case 0:u.ctx.fillStyle=ae(e.color),u.renderTextWithLetterSpacing(t,e.letterSpacing,A);var n=e.textShadow;n.length&&t.text.trim().length&&(n.slice(0).reverse().forEach((function(i){u.ctx.shadowColor=ae(i.color),u.ctx.shadowOffsetX=i.offsetX.number*u.options.scale,u.ctx.shadowOffsetY=i.offsetY.number*u.options.scale,u.ctx.shadowBlur=i.blur.number,u.renderTextWithLetterSpacing(t,e.letterSpacing,A)})),u.ctx.shadowColor="",u.ctx.shadowOffsetX=0,u.ctx.shadowOffsetY=0,u.ctx.shadowBlur=0),e.textDecorationLine.length&&(u.ctx.fillStyle=ae(e.textDecorationColor||e.color),e.textDecorationLine.forEach((function(e){switch(e){case 1:u.ctx.fillRect(t.bounds.left,Math.round(t.bounds.top+A),t.bounds.width,1);break;case 2:u.ctx.fillRect(t.bounds.left,Math.round(t.bounds.top),t.bounds.width,1);break;case 3:u.ctx.fillRect(t.bounds.left,Math.ceil(t.bounds.top+l),t.bounds.width,1)}})));break;case 1:e.webkitTextStrokeWidth&&t.text.trim().length&&(u.ctx.strokeStyle=ae(e.webkitTextStrokeColor),u.ctx.lineWidth=e.webkitTextStrokeWidth,u.ctx.lineJoin=window.chrome?"miter":"round",u.ctx.strokeText(t.text,t.bounds.left,t.bounds.top+A)),u.ctx.strokeStyle="",u.ctx.lineWidth=0,u.ctx.lineJoin="miter"}}))})),[2]}))}))},i.prototype.renderReplacedElement=function(t,e,i){if(i&&t.intrinsicWidth>0&&t.intrinsicHeight>0){var n=Po(t),r=mo(e);this.path(r),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(i,0,0,t.intrinsicWidth,t.intrinsicHeight,n.left,n.top,n.width,n.height),this.ctx.restore()}},i.prototype.renderNodeContent=function(t){return n(this,void 0,void 0,(function(){var e,n,o,a,A,l,c,u,h,p,d,f,g,m,y,v,_,w;return r(this,(function(r){switch(r.label){case 0:this.applyEffects(t.getEffects(4)),e=t.container,n=t.curves,o=e.styles,a=0,A=e.textNodes,r.label=1;case 1:return a<A.length?(l=A[a],[4,this.renderTextNode(l,o)]):[3,4];case 2:r.sent(),r.label=3;case 3:return a++,[3,1];case 4:if(!(e instanceof Kn))return[3,8];r.label=5;case 5:return r.trys.push([5,7,,8]),[4,this.context.cache.match(e.src)];case 6:return y=r.sent(),this.renderReplacedElement(e,n,y),[3,8];case 7:return r.sent(),this.context.logger.error("Error loading image "+e.src),[3,8];case 8:if(e instanceof zn&&this.renderReplacedElement(e,n,e.canvas),!(e instanceof Wn))return[3,12];r.label=9;case 9:return r.trys.push([9,11,,12]),[4,this.context.cache.match(e.svg)];case 10:return y=r.sent(),this.renderReplacedElement(e,n,y),[3,12];case 11:return r.sent(),this.context.logger.error("Error loading svg "+e.svg.substring(0,255)),[3,12];case 12:return e instanceof ir&&e.tree?[4,new i(this.context,{scale:this.options.scale,backgroundColor:e.backgroundColor,x:0,y:0,width:e.width,height:e.height}).render(e.tree)]:[3,14];case 13:c=r.sent(),e.width&&e.height&&this.ctx.drawImage(c,0,0,e.width,e.height,e.bounds.left,e.bounds.top,e.bounds.width,e.bounds.height),r.label=14;case 14:if(e instanceof $n&&(u=Math.min(e.bounds.width,e.bounds.height),"checkbox"===e.type?e.checked&&(this.ctx.save(),this.path([new lo(e.bounds.left+.39363*u,e.bounds.top+.79*u),new lo(e.bounds.left+.16*u,e.bounds.top+.5549*u),new lo(e.bounds.left+.27347*u,e.bounds.top+.44071*u),new lo(e.bounds.left+.39694*u,e.bounds.top+.5649*u),new lo(e.bounds.left+.72983*u,e.bounds.top+.23*u),new lo(e.bounds.left+.84*u,e.bounds.top+.34085*u),new lo(e.bounds.left+.39363*u,e.bounds.top+.79*u)]),this.ctx.fillStyle=ae(707406591),this.ctx.fill(),this.ctx.restore()):"radio"===e.type&&e.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(e.bounds.left+u/2,e.bounds.top+u/2,u/4,0,2*Math.PI,!0),this.ctx.fillStyle=ae(707406591),this.ctx.fill(),this.ctx.restore())),ko(e)&&e.value.length){switch(h=this.createFontStyle(o),_=h[0],p=h[1],d=this.fontMetrics.getMetrics(_,p).baseline,this.ctx.font=_,this.ctx.fillStyle=ae(o.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=jo(e.styles.textAlign),w=Po(e),f=0,e.styles.textAlign){case 1:f+=w.width/2;break;case 2:f+=w.width}g=w.add(f,0,0,-w.height/2+1),this.ctx.save(),this.path([new lo(w.left,w.top),new lo(w.left+w.width,w.top),new lo(w.left+w.width,w.top+w.height),new lo(w.left,w.top+w.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new Mn(e.value,g),o.letterSpacing,d),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!qi(e.styles.display,2048))return[3,20];if(null===e.styles.listStyleImage)return[3,19];if(0!==(m=e.styles.listStyleImage).type)return[3,18];y=void 0,v=m.url,r.label=15;case 15:return r.trys.push([15,17,,18]),[4,this.context.cache.match(v)];case 16:return y=r.sent(),this.ctx.drawImage(y,e.bounds.left-(y.width+10),e.bounds.top),[3,18];case 17:return r.sent(),this.context.logger.error("Error loading list-style-image "+v),[3,18];case 18:return[3,20];case 19:t.listValue&&-1!==e.styles.listStyleType&&(_=this.createFontStyle(o)[0],this.ctx.font=_,this.ctx.fillStyle=ae(o.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",w=new s(e.bounds.left,e.bounds.top+te(e.styles.paddingTop,e.bounds.width),e.bounds.width,ui(o.lineHeight,o.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new Mn(t.listValue,w),o.letterSpacing,ui(o.lineHeight,o.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),r.label=20;case 20:return[2]}}))}))},i.prototype.renderStackContent=function(t){return n(this,void 0,void 0,(function(){var e,i,n,o,s,a,A,l,c,u,h,p,d,f,g;return r(this,(function(r){switch(r.label){case 0:return qi(t.element.container.flags,16),[4,this.renderNodeBackgroundAndBorders(t.element)];case 1:r.sent(),e=0,i=t.negativeZIndex,r.label=2;case 2:return e<i.length?(g=i[e],[4,this.renderStack(g)]):[3,5];case 3:r.sent(),r.label=4;case 4:return e++,[3,2];case 5:return[4,this.renderNodeContent(t.element)];case 6:r.sent(),n=0,o=t.nonInlineLevel,r.label=7;case 7:return n<o.length?(g=o[n],[4,this.renderNode(g)]):[3,10];case 8:r.sent(),r.label=9;case 9:return n++,[3,7];case 10:s=0,a=t.nonPositionedFloats,r.label=11;case 11:return s<a.length?(g=a[s],[4,this.renderStack(g)]):[3,14];case 12:r.sent(),r.label=13;case 13:return s++,[3,11];case 14:A=0,l=t.nonPositionedInlineLevel,r.label=15;case 15:return A<l.length?(g=l[A],[4,this.renderStack(g)]):[3,18];case 16:r.sent(),r.label=17;case 17:return A++,[3,15];case 18:c=0,u=t.inlineLevel,r.label=19;case 19:return c<u.length?(g=u[c],[4,this.renderNode(g)]):[3,22];case 20:r.sent(),r.label=21;case 21:return c++,[3,19];case 22:h=0,p=t.zeroOrAutoZIndexOrTransformedOrOpacity,r.label=23;case 23:return h<p.length?(g=p[h],[4,this.renderStack(g)]):[3,26];case 24:r.sent(),r.label=25;case 25:return h++,[3,23];case 26:d=0,f=t.positiveZIndex,r.label=27;case 27:return d<f.length?(g=f[d],[4,this.renderStack(g)]):[3,30];case 28:r.sent(),r.label=29;case 29:return d++,[3,27];case 30:return[2]}}))}))},i.prototype.mask=function(t){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(t.slice(0).reverse()),this.ctx.closePath()},i.prototype.path=function(t){this.ctx.beginPath(),this.formatPath(t),this.ctx.closePath()},i.prototype.formatPath=function(t){var e=this;t.forEach((function(t,i){var n=ho(t)?t.start:t;0===i?e.ctx.moveTo(n.x,n.y):e.ctx.lineTo(n.x,n.y),ho(t)&&e.ctx.bezierCurveTo(t.startControl.x,t.startControl.y,t.endControl.x,t.endControl.y,t.end.x,t.end.y)}))},i.prototype.renderRepeat=function(t,e,i,n){this.path(t),this.ctx.fillStyle=e,this.ctx.translate(i,n),this.ctx.fill(),this.ctx.translate(-i,-n)},i.prototype.resizeImage=function(t,e,i){var n;if(t.width===e&&t.height===i)return t;var r=(null!==(n=this.canvas.ownerDocument)&&void 0!==n?n:document).createElement("canvas");return r.width=Math.max(1,e),r.height=Math.max(1,i),r.getContext("2d").drawImage(t,0,0,t.width,t.height,0,0,e,i),r},i.prototype.renderBackgroundImage=function(t){return n(this,void 0,void 0,(function(){var e,i,n,o,s,a;return r(this,(function(A){switch(A.label){case 0:e=t.styles.backgroundImage.length-1,i=function(i){var o,s,a,A,l,c,u,h,p,d,f,g,m,y,v,_,w,C,B,b,E,S,x,I,F,O,P,T,L,M,U;return r(this,(function(r){switch(r.label){case 0:if(0!==i.type)return[3,5];o=void 0,s=i.url,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,n.context.cache.match(s)];case 2:return o=r.sent(),[3,4];case 3:return r.sent(),n.context.logger.error("Error loading background-image "+s),[3,4];case 4:return o&&(a=To(t,e,[o.width,o.height,o.width/o.height]),_=a[0],S=a[1],x=a[2],B=a[3],b=a[4],y=n.ctx.createPattern(n.resizeImage(o,B,b),"repeat"),n.renderRepeat(_,y,S,x)),[3,6];case 5:1===i.type?(A=To(t,e,[null,null,null]),_=A[0],S=A[1],x=A[2],B=A[3],b=A[4],l=we(i.angle,B,b),c=l[0],u=l[1],h=l[2],p=l[3],d=l[4],(f=document.createElement("canvas")).width=B,f.height=b,g=f.getContext("2d"),m=g.createLinearGradient(u,p,h,d),_e(i.stops,c).forEach((function(t){return m.addColorStop(t.stop,ae(t.color))})),g.fillStyle=m,g.fillRect(0,0,B,b),B>0&&b>0&&(y=n.ctx.createPattern(f,"repeat"),n.renderRepeat(_,y,S,x))):function(t){return 2===t.type}(i)&&(v=To(t,e,[null,null,null]),_=v[0],w=v[1],C=v[2],B=v[3],b=v[4],E=0===i.position.length?[Jt]:i.position,S=te(E[0],B),x=te(E[E.length-1],b),I=function(t,e,i,n,r){var o=0,s=0;switch(t.size){case 0:0===t.shape?o=s=Math.min(Math.abs(e),Math.abs(e-n),Math.abs(i),Math.abs(i-r)):1===t.shape&&(o=Math.min(Math.abs(e),Math.abs(e-n)),s=Math.min(Math.abs(i),Math.abs(i-r)));break;case 2:if(0===t.shape)o=s=Math.min(Ce(e,i),Ce(e,i-r),Ce(e-n,i),Ce(e-n,i-r));else if(1===t.shape){var a=Math.min(Math.abs(i),Math.abs(i-r))/Math.min(Math.abs(e),Math.abs(e-n)),A=Be(n,r,e,i,!0),l=A[0],c=A[1];s=a*(o=Ce(l-e,(c-i)/a))}break;case 1:0===t.shape?o=s=Math.max(Math.abs(e),Math.abs(e-n),Math.abs(i),Math.abs(i-r)):1===t.shape&&(o=Math.max(Math.abs(e),Math.abs(e-n)),s=Math.max(Math.abs(i),Math.abs(i-r)));break;case 3:if(0===t.shape)o=s=Math.max(Ce(e,i),Ce(e,i-r),Ce(e-n,i),Ce(e-n,i-r));else if(1===t.shape){a=Math.max(Math.abs(i),Math.abs(i-r))/Math.max(Math.abs(e),Math.abs(e-n));var u=Be(n,r,e,i,!1);l=u[0],c=u[1],s=a*(o=Ce(l-e,(c-i)/a))}}return Array.isArray(t.size)&&(o=te(t.size[0],n),s=2===t.size.length?te(t.size[1],r):o),[o,s]}(i,S,x,B,b),F=I[0],O=I[1],F>0&&O>0&&(P=n.ctx.createRadialGradient(w+S,C+x,0,w+S,C+x,F),_e(i.stops,2*F).forEach((function(t){return P.addColorStop(t.stop,ae(t.color))})),n.path(_),n.ctx.fillStyle=P,F!==O?(T=t.bounds.left+.5*t.bounds.width,L=t.bounds.top+.5*t.bounds.height,U=1/(M=O/F),n.ctx.save(),n.ctx.translate(T,L),n.ctx.transform(1,0,0,M,0,0),n.ctx.translate(-T,-L),n.ctx.fillRect(w,U*(C-L)+L,B,b*U),n.ctx.restore()):n.ctx.fill())),r.label=6;case 6:return e--,[2]}}))},n=this,o=0,s=t.styles.backgroundImage.slice(0).reverse(),A.label=1;case 1:return o<s.length?(a=s[o],[5,i(a)]):[3,4];case 2:A.sent(),A.label=3;case 3:return o++,[3,1];case 4:return[2]}}))}))},i.prototype.renderSolidBorder=function(t,e,i){return n(this,void 0,void 0,(function(){return r(this,(function(n){return this.path(xo(i,e)),this.ctx.fillStyle=ae(t),this.ctx.fill(),[2]}))}))},i.prototype.renderDoubleBorder=function(t,e,i,o){return n(this,void 0,void 0,(function(){var n,s;return r(this,(function(r){switch(r.label){case 0:return e<3?[4,this.renderSolidBorder(t,i,o)]:[3,2];case 1:return r.sent(),[2];case 2:return n=function(t,e){switch(e){case 0:return Fo(t.topLeftBorderBox,t.topLeftBorderDoubleOuterBox,t.topRightBorderBox,t.topRightBorderDoubleOuterBox);case 1:return Fo(t.topRightBorderBox,t.topRightBorderDoubleOuterBox,t.bottomRightBorderBox,t.bottomRightBorderDoubleOuterBox);case 2:return Fo(t.bottomRightBorderBox,t.bottomRightBorderDoubleOuterBox,t.bottomLeftBorderBox,t.bottomLeftBorderDoubleOuterBox);case 3:default:return Fo(t.bottomLeftBorderBox,t.bottomLeftBorderDoubleOuterBox,t.topLeftBorderBox,t.topLeftBorderDoubleOuterBox)}}(o,i),this.path(n),this.ctx.fillStyle=ae(t),this.ctx.fill(),s=function(t,e){switch(e){case 0:return Fo(t.topLeftBorderDoubleInnerBox,t.topLeftPaddingBox,t.topRightBorderDoubleInnerBox,t.topRightPaddingBox);case 1:return Fo(t.topRightBorderDoubleInnerBox,t.topRightPaddingBox,t.bottomRightBorderDoubleInnerBox,t.bottomRightPaddingBox);case 2:return Fo(t.bottomRightBorderDoubleInnerBox,t.bottomRightPaddingBox,t.bottomLeftBorderDoubleInnerBox,t.bottomLeftPaddingBox);case 3:default:return Fo(t.bottomLeftBorderDoubleInnerBox,t.bottomLeftPaddingBox,t.topLeftBorderDoubleInnerBox,t.topLeftPaddingBox)}}(o,i),this.path(s),this.ctx.fill(),[2]}}))}))},i.prototype.renderNodeBackgroundAndBorders=function(t){return n(this,void 0,void 0,(function(){var e,i,n,o,s,a,A,l,c=this;return r(this,(function(r){switch(r.label){case 0:return this.applyEffects(t.getEffects(2)),e=t.container.styles,i=!se(e.backgroundColor)||e.backgroundImage.length,n=[{style:e.borderTopStyle,color:e.borderTopColor,width:e.borderTopWidth},{style:e.borderRightStyle,color:e.borderRightColor,width:e.borderRightWidth},{style:e.borderBottomStyle,color:e.borderBottomColor,width:e.borderBottomWidth},{style:e.borderLeftStyle,color:e.borderLeftColor,width:e.borderLeftWidth}],o=Vo(Do(e.backgroundClip,0),t.curves),i||e.boxShadow.length?(this.ctx.save(),this.path(o),this.ctx.clip(),se(e.backgroundColor)||(this.ctx.fillStyle=ae(e.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(t.container)]):[3,2];case 1:r.sent(),this.ctx.restore(),e.boxShadow.slice(0).reverse().forEach((function(e){c.ctx.save();var i,n,r,o,s,a=go(t.curves),A=e.inset?0:1e4,l=(i=a,n=-A+(e.inset?1:-1)*e.spread.number,r=(e.inset?1:-1)*e.spread.number,o=e.spread.number*(e.inset?-2:2),s=e.spread.number*(e.inset?-2:2),i.map((function(t,e){switch(e){case 0:return t.add(n,r);case 1:return t.add(n+o,r);case 2:return t.add(n+o,r+s);case 3:return t.add(n,r+s)}return t})));e.inset?(c.path(a),c.ctx.clip(),c.mask(l)):(c.mask(a),c.ctx.clip(),c.path(l)),c.ctx.shadowOffsetX=e.offsetX.number+A,c.ctx.shadowOffsetY=e.offsetY.number,c.ctx.shadowColor=ae(e.color),c.ctx.shadowBlur=e.blur.number,c.ctx.fillStyle=e.inset?ae(e.color):"rgba(0,0,0,1)",c.ctx.fill(),c.ctx.restore()})),r.label=2;case 2:s=0,a=0,A=n,r.label=3;case 3:return a<A.length?0!==(l=A[a]).style&&!se(l.color)&&l.width>0?2!==l.style?[3,5]:[4,this.renderDashedDottedBorder(l.color,l.width,s,t.curves,2)]:[3,11]:[3,13];case 4:return r.sent(),[3,11];case 5:return 3!==l.style?[3,7]:[4,this.renderDashedDottedBorder(l.color,l.width,s,t.curves,3)];case 6:return r.sent(),[3,11];case 7:return 4!==l.style?[3,9]:[4,this.renderDoubleBorder(l.color,l.width,s,t.curves)];case 8:return r.sent(),[3,11];case 9:return[4,this.renderSolidBorder(l.color,s,t.curves)];case 10:r.sent(),r.label=11;case 11:s++,r.label=12;case 12:return a++,[3,3];case 13:return[2]}}))}))},i.prototype.renderDashedDottedBorder=function(t,e,i,o,s){return n(this,void 0,void 0,(function(){var n,a,A,l,c,u,h,p,d,f,g,m,y,v,_,w;return r(this,(function(r){return this.ctx.save(),n=function(t,e){switch(e){case 0:return Io(t.topLeftBorderStroke,t.topRightBorderStroke);case 1:return Io(t.topRightBorderStroke,t.bottomRightBorderStroke);case 2:return Io(t.bottomRightBorderStroke,t.bottomLeftBorderStroke);case 3:default:return Io(t.bottomLeftBorderStroke,t.topLeftBorderStroke)}}(o,i),a=xo(o,i),2===s&&(this.path(a),this.ctx.clip()),ho(a[0])?(A=a[0].start.x,l=a[0].start.y):(A=a[0].x,l=a[0].y),ho(a[1])?(c=a[1].end.x,u=a[1].end.y):(c=a[1].x,u=a[1].y),h=0===i||2===i?Math.abs(A-c):Math.abs(l-u),this.ctx.beginPath(),3===s?this.formatPath(n):this.formatPath(a.slice(0,2)),p=e<3?3*e:2*e,d=e<3?2*e:e,3===s&&(p=e,d=e),f=!0,h<=2*p?f=!1:h<=2*p+d?(p*=g=h/(2*p+d),d*=g):(m=Math.floor((h+d)/(p+d)),y=(h-m*p)/(m-1),d=(v=(h-(m+1)*p)/m)<=0||Math.abs(d-y)<Math.abs(d-v)?y:v),f&&(3===s?this.ctx.setLineDash([0,p+d]):this.ctx.setLineDash([p,d])),3===s?(this.ctx.lineCap="round",this.ctx.lineWidth=e):this.ctx.lineWidth=2*e+1.1,this.ctx.strokeStyle=ae(t),this.ctx.stroke(),this.ctx.setLineDash([]),2===s&&(ho(a[0])&&(_=a[3],w=a[0],this.ctx.beginPath(),this.formatPath([new lo(_.end.x,_.end.y),new lo(w.start.x,w.start.y)]),this.ctx.stroke()),ho(a[1])&&(_=a[1],w=a[2],this.ctx.beginPath(),this.formatPath([new lo(_.end.x,_.end.y),new lo(w.start.x,w.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]}))}))},i.prototype.render=function(t){return n(this,void 0,void 0,(function(){var e;return r(this,(function(i){switch(i.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=ae(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),n=new bo(t,null),r=new Bo(n),Eo(n,r,r,o=[]),So(n.container,o),e=r,[4,this.renderStack(e)];case 1:return i.sent(),this.applyEffects([]),[2,this.canvas]}var n,r,o}))}))},i}(No),ko=function(t){return t instanceof er||t instanceof tr||t instanceof $n&&"radio"!==t.type&&"checkbox"!==t.type},Vo=function(t,e){switch(t){case 0:return go(e);case 2:return function(t){return[t.topLeftContentBox,t.topRightContentBox,t.bottomRightContentBox,t.bottomLeftContentBox]}(e);case 1:default:return mo(e)}},jo=function(t){switch(t){case 1:return"center";case 2:return"right";case 0:default:return"left"}},Go=["-apple-system","system-ui"],Ko=function(t){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?t.filter((function(t){return-1===Go.indexOf(t)})):t},zo=function(t){function i(e,i){var n=t.call(this,e,i)||this;return n.canvas=i.canvas?i.canvas:document.createElement("canvas"),n.ctx=n.canvas.getContext("2d"),n.options=i,n.canvas.width=Math.floor(i.width*i.scale),n.canvas.height=Math.floor(i.height*i.scale),n.canvas.style.width=i.width+"px",n.canvas.style.height=i.height+"px",n.ctx.scale(n.options.scale,n.options.scale),n.ctx.translate(-i.x,-i.y),n.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+i.width+"x"+i.height+" at "+i.x+","+i.y+") with scale "+i.scale),n}return e(i,t),i.prototype.render=function(t){return n(this,void 0,void 0,(function(){var e,i;return r(this,(function(n){switch(n.label){case 0:return e=Pn(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,t),[4,Wo(e)];case 1:return i=n.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=ae(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(i,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}}))}))},i}(No),Wo=function(t){return new Promise((function(e,i){var n=new Image;n.onload=function(){e(n)},n.onerror=i,n.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent((new XMLSerializer).serializeToString(t))}))},qo=function(){function t(t){var e=t.id,i=t.enabled;this.id=e,this.enabled=i,this.start=Date.now()}return t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.enabled&&("undefined"!=typeof window&&window.console&&"function"==typeof console.debug?console.debug.apply(console,o([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},t.prototype.getTime=function(){return Date.now()-this.start},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.enabled&&"undefined"!=typeof window&&window.console&&"function"==typeof console.info&&console.info.apply(console,o([this.id,this.getTime()+"ms"],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.enabled&&("undefined"!=typeof window&&window.console&&"function"==typeof console.warn?console.warn.apply(console,o([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.enabled&&("undefined"!=typeof window&&window.console&&"function"==typeof console.error?console.error.apply(console,o([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},t.instances={},t}(),Xo=function(){function t(e,i){var n;this.windowBounds=i,this.instanceName="#"+t.instanceCount++,this.logger=new qo({id:this.instanceName,enabled:e.logging}),this.cache=null!==(n=e.cache)&&void 0!==n?n:new to(this,e)}return t.instanceCount=1,t}();"undefined"!=typeof window&&$r.setContext(window);var Yo=function(t,e){return n(void 0,void 0,void 0,(function(){var n,o,A,l,c,u,h,p,d,f,g,m,y,v,_,w,C,B,b,E,S,x,I,F,O,P,T,L,M,U,D,Q,R,N,H,k,V,j;return r(this,(function(r){switch(r.label){case 0:if(!t||"object"!=typeof t)return[2,Promise.reject("Invalid element provided as first argument")];if(!(n=t.ownerDocument))throw new Error("Element is not attached to a Document");if(!(o=n.defaultView))throw new Error("Document is not attached to a Window");return A={allowTaint:null!==(x=e.allowTaint)&&void 0!==x&&x,imageTimeout:null!==(I=e.imageTimeout)&&void 0!==I?I:15e3,proxy:e.proxy,useCORS:null!==(F=e.useCORS)&&void 0!==F&&F},l=i({logging:null===(O=e.logging)||void 0===O||O,cache:e.cache},A),c={windowWidth:null!==(P=e.windowWidth)&&void 0!==P?P:o.innerWidth,windowHeight:null!==(T=e.windowHeight)&&void 0!==T?T:o.innerHeight,scrollX:null!==(L=e.scrollX)&&void 0!==L?L:o.pageXOffset,scrollY:null!==(M=e.scrollY)&&void 0!==M?M:o.pageYOffset},u=new s(c.scrollX,c.scrollY,c.windowWidth,c.windowHeight),h=new Xo(l,u),p=null!==(U=e.foreignObjectRendering)&&void 0!==U&&U,d={allowTaint:null!==(D=e.allowTaint)&&void 0!==D&&D,onclone:e.onclone,ignoreElements:e.ignoreElements,inlineImages:p,copyStyles:p},h.logger.debug("Starting document clone with size "+u.width+"x"+u.height+" scrolled to "+-u.left+","+-u.top),f=new Rr(h,t,d),(g=f.clonedReferenceElement)?[4,f.toIFrame(n,u)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return m=r.sent(),y=mr(g)||"HTML"===g.tagName?function(t){var e=t.body,i=t.documentElement;if(!e||!i)throw new Error("Unable to get document size");var n=Math.max(Math.max(e.scrollWidth,i.scrollWidth),Math.max(e.offsetWidth,i.offsetWidth),Math.max(e.clientWidth,i.clientWidth)),r=Math.max(Math.max(e.scrollHeight,i.scrollHeight),Math.max(e.offsetHeight,i.offsetHeight),Math.max(e.clientHeight,i.clientHeight));return new s(0,0,n,r)}(g.ownerDocument):a(h,g),v=y.width,_=y.height,w=y.left,C=y.top,B=Jo(h,g,e.backgroundColor),b={canvas:e.canvas,backgroundColor:B,scale:null!==(R=null!==(Q=e.scale)&&void 0!==Q?Q:o.devicePixelRatio)&&void 0!==R?R:1,x:(null!==(N=e.x)&&void 0!==N?N:0)+w,y:(null!==(H=e.y)&&void 0!==H?H:0)+C,width:null!==(k=e.width)&&void 0!==k?k:Math.ceil(v),height:null!==(V=e.height)&&void 0!==V?V:Math.ceil(_)},p?(h.logger.debug("Document cloned, using foreign object rendering"),[4,new zo(h,b).render(g)]):[3,3];case 2:return E=r.sent(),[3,5];case 3:return h.logger.debug("Document cloned, element located at "+w+","+C+" with size "+v+"x"+_+" using computed rendering"),h.logger.debug("Starting DOM parsing"),S=sr(h,g),B===S.styles.backgroundColor&&(S.styles.backgroundColor=ge.TRANSPARENT),h.logger.debug("Starting renderer for element at "+b.x+","+b.y+" with size "+b.width+"x"+b.height),[4,new Ho(h,b).render(S)];case 4:E=r.sent(),r.label=5;case 5:return(null===(j=e.removeContainer)||void 0===j||j)&&(Rr.destroy(m)||h.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),h.logger.debug("Finished rendering"),[2,E]}}))}))},Jo=function(t,e,i){var n=e.ownerDocument,r=n.documentElement?fe(t,getComputedStyle(n.documentElement).backgroundColor):ge.TRANSPARENT,o=n.body?fe(t,getComputedStyle(n.body).backgroundColor):ge.TRANSPARENT,s="string"==typeof i?fe(t,i):null===i?ge.TRANSPARENT:4294967295;return e===n.documentElement?se(r)?se(o)?s:o:r:s};return function(t,e){return void 0===e&&(e={}),Yo(t,e)}}()},function(t,e,i){},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,i){"use strict";var n=i(2),r=i(8),o=i(25),s=i(14);function a(t){var e=new o(t),i=r(o.prototype.request,e);return n.extend(i,o.prototype,e),n.extend(i,e),i}var A=a(i(6));A.Axios=o,A.create=function(t){return a(s(A.defaults,t))},A.Cancel=i(15),A.CancelToken=i(40),A.isCancel=i(13),A.all=function(t){return Promise.all(t)},A.spread=i(41),A.isAxiosError=i(42),t.exports=A,t.exports.default=A},function(t,e,i){"use strict";var n=i(2),r=i(9),o=i(26),s=i(27),a=i(14),A=i(38),l=A.validators;function c(t){this.defaults=t,this.interceptors={request:new o,response:new o}}c.prototype.request=function(t){"string"==typeof t?(t=arguments[1]||{}).url=arguments[0]:t=t||{},(t=a(this.defaults,t)).method?t.method=t.method.toLowerCase():this.defaults.method?t.method=this.defaults.method.toLowerCase():t.method="get";var e=t.transitional;void 0!==e&&A.assertOptions(e,{silentJSONParsing:l.transitional(l.boolean,"1.0.0"),forcedJSONParsing:l.transitional(l.boolean,"1.0.0"),clarifyTimeoutError:l.transitional(l.boolean,"1.0.0")},!1);var i=[],n=!0;this.interceptors.request.forEach((function(e){"function"==typeof e.runWhen&&!1===e.runWhen(t)||(n=n&&e.synchronous,i.unshift(e.fulfilled,e.rejected))}));var r,o=[];if(this.interceptors.response.forEach((function(t){o.push(t.fulfilled,t.rejected)})),!n){var c=[s,void 0];for(Array.prototype.unshift.apply(c,i),c=c.concat(o),r=Promise.resolve(t);c.length;)r=r.then(c.shift(),c.shift());return r}for(var u=t;i.length;){var h=i.shift(),p=i.shift();try{u=h(u)}catch(t){p(t);break}}try{r=s(u)}catch(t){return Promise.reject(t)}for(;o.length;)r=r.then(o.shift(),o.shift());return r},c.prototype.getUri=function(t){return t=a(this.defaults,t),r(t.url,t.params,t.paramsSerializer).replace(/^\?/,"")},n.forEach(["delete","get","head","options"],(function(t){c.prototype[t]=function(e,i){return this.request(a(i||{},{method:t,url:e,data:(i||{}).data}))}})),n.forEach(["post","put","patch"],(function(t){c.prototype[t]=function(e,i,n){return this.request(a(n||{},{method:t,url:e,data:i}))}})),t.exports=c},function(t,e,i){"use strict";var n=i(2);function r(){this.handlers=[]}r.prototype.use=function(t,e,i){return this.handlers.push({fulfilled:t,rejected:e,synchronous:!!i&&i.synchronous,runWhen:i?i.runWhen:null}),this.handlers.length-1},r.prototype.eject=function(t){this.handlers[t]&&(this.handlers[t]=null)},r.prototype.forEach=function(t){n.forEach(this.handlers,(function(e){null!==e&&t(e)}))},t.exports=r},function(t,e,i){"use strict";var n=i(2),r=i(28),o=i(13),s=i(6);function a(t){t.cancelToken&&t.cancelToken.throwIfRequested()}t.exports=function(t){return a(t),t.headers=t.headers||{},t.data=r.call(t,t.data,t.headers,t.transformRequest),t.headers=n.merge(t.headers.common||{},t.headers[t.method]||{},t.headers),n.forEach(["delete","get","head","post","put","patch","common"],(function(e){delete t.headers[e]})),(t.adapter||s.adapter)(t).then((function(e){return a(t),e.data=r.call(t,e.data,e.headers,t.transformResponse),e}),(function(e){return o(e)||(a(t),e&&e.response&&(e.response.data=r.call(t,e.response.data,e.response.headers,t.transformResponse))),Promise.reject(e)}))}},function(t,e,i){"use strict";var n=i(2),r=i(6);t.exports=function(t,e,i){var o=this||r;return n.forEach(i,(function(i){t=i.call(o,t,e)})),t}},function(t,e){var i,n,r=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(t){if(i===setTimeout)return setTimeout(t,0);if((i===o||!i)&&setTimeout)return i=setTimeout,setTimeout(t,0);try{return i(t,0)}catch(e){try{return i.call(null,t,0)}catch(e){return i.call(this,t,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:o}catch(t){i=o}try{n="function"==typeof clearTimeout?clearTimeout:s}catch(t){n=s}}();var A,l=[],c=!1,u=-1;function h(){c&&A&&(c=!1,A.length?l=A.concat(l):u=-1,l.length&&p())}function p(){if(!c){var t=a(h);c=!0;for(var e=l.length;e;){for(A=l,l=[];++u<e;)A&&A[u].run();u=-1,e=l.length}A=null,c=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===s||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function d(t,e){this.fun=t,this.array=e}function f(){}r.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];l.push(new d(t,e)),1!==l.length||c||a(p)},d.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=f,r.addListener=f,r.once=f,r.off=f,r.removeListener=f,r.removeAllListeners=f,r.emit=f,r.prependListener=f,r.prependOnceListener=f,r.listeners=function(t){return[]},r.binding=function(t){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(t,e,i){"use strict";var n=i(2);t.exports=function(t,e){n.forEach(t,(function(i,n){n!==e&&n.toUpperCase()===e.toUpperCase()&&(t[e]=i,delete t[n])}))}},function(t,e,i){"use strict";var n=i(12);t.exports=function(t,e,i){var r=i.config.validateStatus;i.status&&r&&!r(i.status)?e(n("Request failed with status code "+i.status,i.config,null,i.request,i)):t(i)}},function(t,e,i){"use strict";var n=i(2);t.exports=n.isStandardBrowserEnv()?{write:function(t,e,i,r,o,s){var a=[];a.push(t+"="+encodeURIComponent(e)),n.isNumber(i)&&a.push("expires="+new Date(i).toGMTString()),n.isString(r)&&a.push("path="+r),n.isString(o)&&a.push("domain="+o),!0===s&&a.push("secure"),document.cookie=a.join("; ")},read:function(t){var e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(t,e,i){"use strict";var n=i(34),r=i(35);t.exports=function(t,e){return t&&!n(e)?r(t,e):e}},function(t,e,i){"use strict";t.exports=function(t){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(t)}},function(t,e,i){"use strict";t.exports=function(t,e){return e?t.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):t}},function(t,e,i){"use strict";var n=i(2),r=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];t.exports=function(t){var e,i,o,s={};return t?(n.forEach(t.split("\n"),(function(t){if(o=t.indexOf(":"),e=n.trim(t.substr(0,o)).toLowerCase(),i=n.trim(t.substr(o+1)),e){if(s[e]&&r.indexOf(e)>=0)return;s[e]="set-cookie"===e?(s[e]?s[e]:[]).concat([i]):s[e]?s[e]+", "+i:i}})),s):s}},function(t,e,i){"use strict";var n=i(2);t.exports=n.isStandardBrowserEnv()?function(){var t,e=/(msie|trident)/i.test(navigator.userAgent),i=document.createElement("a");function r(t){var n=t;return e&&(i.setAttribute("href",n),n=i.href),i.setAttribute("href",n),{href:i.href,protocol:i.protocol?i.protocol.replace(/:$/,""):"",host:i.host,search:i.search?i.search.replace(/^\?/,""):"",hash:i.hash?i.hash.replace(/^#/,""):"",hostname:i.hostname,port:i.port,pathname:"/"===i.pathname.charAt(0)?i.pathname:"/"+i.pathname}}return t=r(window.location.href),function(e){var i=n.isString(e)?r(e):e;return i.protocol===t.protocol&&i.host===t.host}}():function(){return!0}},function(t,e,i){"use strict";var n=i(39),r={};["object","boolean","number","function","string","symbol"].forEach((function(t,e){r[t]=function(i){return typeof i===t||"a"+(e<1?"n ":" ")+t}}));var o={},s=n.version.split(".");function a(t,e){for(var i=e?e.split("."):s,n=t.split("."),r=0;r<3;r++){if(i[r]>n[r])return!0;if(i[r]<n[r])return!1}return!1}r.transitional=function(t,e,i){var r=e&&a(e);function s(t,e){return"[Axios v"+n.version+"] Transitional option '"+t+"'"+e+(i?". "+i:"")}return function(i,n,a){if(!1===t)throw new Error(s(n," has been removed in "+e));return r&&!o[n]&&(o[n]=!0,console.warn(s(n," has been deprecated since v"+e+" and will be removed in the near future"))),!t||t(i,n,a)}},t.exports={isOlderVersion:a,assertOptions:function(t,e,i){if("object"!=typeof t)throw new TypeError("options must be an object");for(var n=Object.keys(t),r=n.length;r-- >0;){var o=n[r],s=e[o];if(s){var a=t[o],A=void 0===a||s(a,o,t);if(!0!==A)throw new TypeError("option "+o+" must be "+A)}else if(!0!==i)throw Error("Unknown option "+o)}},validators:r}},function(t){t.exports=JSON.parse('{"_from":"axios@^0.21.1","_id":"axios@0.21.4","_inBundle":false,"_integrity":"sha1-xnuQ3AVo5cHPKwuFjEO6KOLtpXU=","_location":"/axios","_phantomChildren":{},"_requested":{"type":"range","registry":true,"raw":"axios@^0.21.1","name":"axios","escapedName":"axios","rawSpec":"^0.21.1","saveSpec":null,"fetchSpec":"^0.21.1"},"_requiredBy":["/"],"_resolved":"https://kfront-dev-dev.devdolphin.com/ty-knpm/axios/-/axios-0.21.4.tgz","_shasum":"c67b90dc0568e5c1cf2b0b858c43ba28e2eda575","_spec":"axios@^0.21.1","_where":"D:\\\\work\\\\kmap-3d\\\\packages\\\\kmap-earth","author":{"name":"Matt Zabriskie"},"browser":{"./lib/adapters/http.js":"./lib/adapters/xhr.js"},"bugs":{"url":"https://github.com/axios/axios/issues"},"bundleDependencies":false,"bundlesize":[{"path":"./dist/axios.min.js","threshold":"5kB"}],"dependencies":{"follow-redirects":"^1.14.0"},"deprecated":false,"description":"Promise based HTTP client for the browser and node.js","devDependencies":{"coveralls":"^3.0.0","es6-promise":"^4.2.4","grunt":"^1.3.0","grunt-banner":"^0.6.0","grunt-cli":"^1.2.0","grunt-contrib-clean":"^1.1.0","grunt-contrib-watch":"^1.0.0","grunt-eslint":"^23.0.0","grunt-karma":"^4.0.0","grunt-mocha-test":"^0.13.3","grunt-ts":"^6.0.0-beta.19","grunt-webpack":"^4.0.2","istanbul-instrumenter-loader":"^1.0.0","jasmine-core":"^2.4.1","karma":"^6.3.2","karma-chrome-launcher":"^3.1.0","karma-firefox-launcher":"^2.1.0","karma-jasmine":"^1.1.1","karma-jasmine-ajax":"^0.1.13","karma-safari-launcher":"^1.0.0","karma-sauce-launcher":"^4.3.6","karma-sinon":"^1.0.5","karma-sourcemap-loader":"^0.3.8","karma-webpack":"^4.0.2","load-grunt-tasks":"^3.5.2","minimist":"^1.2.0","mocha":"^8.2.1","sinon":"^4.5.0","terser-webpack-plugin":"^4.2.3","typescript":"^4.0.5","url-search-params":"^0.10.0","webpack":"^4.44.2","webpack-dev-server":"^3.11.0"},"homepage":"https://axios-http.com","jsdelivr":"dist/axios.min.js","keywords":["xhr","http","ajax","promise","node"],"license":"MIT","main":"index.js","name":"axios","repository":{"type":"git","url":"git+https://github.com/axios/axios.git"},"scripts":{"build":"NODE_ENV=production grunt build","coveralls":"cat coverage/lcov.info | ./node_modules/coveralls/bin/coveralls.js","examples":"node ./examples/server.js","fix":"eslint --fix lib/**/*.js","postversion":"git push && git push --tags","preversion":"npm test","start":"node ./sandbox/server.js","test":"grunt test","version":"npm run build && grunt version && git add -A dist && git add CHANGELOG.md bower.json package.json"},"typings":"./index.d.ts","unpkg":"dist/axios.min.js","version":"0.21.4"}')},function(t,e,i){"use strict";var n=i(15);function r(t){if("function"!=typeof t)throw new TypeError("executor must be a function.");var e;this.promise=new Promise((function(t){e=t}));var i=this;t((function(t){i.reason||(i.reason=new n(t),e(i.reason))}))}r.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},r.source=function(){var t;return{token:new r((function(e){t=e})),cancel:t}},t.exports=r},function(t,e,i){"use strict";t.exports=function(t){return function(e){return t.apply(null,e)}}},function(t,e,i){"use strict";t.exports=function(t){return"object"==typeof t&&!0===t.isAxiosError}},function(t,e,i){t.exports=function(){"use strict";function t(t,n,r,o,s){!function t(i,n,r,o,s){for(;o>r;){if(o-r>600){var a=o-r+1,A=n-r+1,l=Math.log(a),c=.5*Math.exp(2*l/3),u=.5*Math.sqrt(l*c*(a-c)/a)*(A-a/2<0?-1:1);t(i,n,Math.max(r,Math.floor(n-A*c/a+u)),Math.min(o,Math.floor(n+(a-A)*c/a+u)),s)}var h=i[n],p=r,d=o;for(e(i,r,n),s(i[o],h)>0&&e(i,r,o);p<d;){for(e(i,p,d),p++,d--;s(i[p],h)<0;)p++;for(;s(i[d],h)>0;)d--}0===s(i[r],h)?e(i,r,d):e(i,++d,o),d<=n&&(r=d+1),n<=d&&(o=d-1)}}(t,n,r||0,o||t.length-1,s||i)}function e(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}function i(t,e){return t<e?-1:t>e?1:0}var n=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function r(t,e,i){if(!i)return e.indexOf(t);for(var n=0;n<e.length;n++)if(i(t,e[n]))return n;return-1}function o(t,e){s(t,0,t.children.length,e,t)}function s(t,e,i,n,r){r||(r=d(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var o=e;o<i;o++){var s=t.children[o];a(r,t.leaf?n(s):s)}return r}function a(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function A(t,e){return t.minX-e.minX}function l(t,e){return t.minY-e.minY}function c(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function u(t){return t.maxX-t.minX+(t.maxY-t.minY)}function h(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function p(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function d(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function f(e,i,n,r,o){for(var s=[i,n];s.length;)if(!((n=s.pop())-(i=s.pop())<=r)){var a=i+Math.ceil((n-i)/r/2)*r;t(e,a,i,n,o),s.push(i,a,a,n)}}return n.prototype.all=function(){return this._all(this.data,[])},n.prototype.search=function(t){var e=this.data,i=[];if(!p(t,e))return i;for(var n=this.toBBox,r=[];e;){for(var o=0;o<e.children.length;o++){var s=e.children[o],a=e.leaf?n(s):s;p(t,a)&&(e.leaf?i.push(s):h(t,a)?this._all(s,i):r.push(s))}e=r.pop()}return i},n.prototype.collides=function(t){var e=this.data;if(!p(t,e))return!1;for(var i=[];e;){for(var n=0;n<e.children.length;n++){var r=e.children[n],o=e.leaf?this.toBBox(r):r;if(p(t,o)){if(e.leaf||h(t,o))return!0;i.push(r)}}e=i.pop()}return!1},n.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this}var i=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var n=this.data;this.data=i,i=n}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this},n.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},n.prototype.clear=function(){return this.data=d([]),this},n.prototype.remove=function(t,e){if(!t)return this;for(var i,n,o,s=this.data,a=this.toBBox(t),A=[],l=[];s||A.length;){if(s||(s=A.pop(),n=A[A.length-1],i=l.pop(),o=!0),s.leaf){var c=r(t,s.children,e);if(-1!==c)return s.children.splice(c,1),A.push(s),this._condense(A),this}o||s.leaf||!h(s,a)?n?(i++,s=n.children[i],o=!1):s=null:(A.push(s),l.push(i),i=0,n=s,s=s.children[0])}return this},n.prototype.toBBox=function(t){return t},n.prototype.compareMinX=function(t,e){return t.minX-e.minX},n.prototype.compareMinY=function(t,e){return t.minY-e.minY},n.prototype.toJSON=function(){return this.data},n.prototype.fromJSON=function(t){return this.data=t,this},n.prototype._all=function(t,e){for(var i=[];t;)t.leaf?e.push.apply(e,t.children):i.push.apply(i,t.children),t=i.pop();return e},n.prototype._build=function(t,e,i,n){var r,s=i-e+1,a=this._maxEntries;if(s<=a)return o(r=d(t.slice(e,i+1)),this.toBBox),r;n||(n=Math.ceil(Math.log(s)/Math.log(a)),a=Math.ceil(s/Math.pow(a,n-1))),(r=d([])).leaf=!1,r.height=n;var A=Math.ceil(s/a),l=A*Math.ceil(Math.sqrt(a));f(t,e,i,l,this.compareMinX);for(var c=e;c<=i;c+=l){var u=Math.min(c+l-1,i);f(t,c,u,A,this.compareMinY);for(var h=c;h<=u;h+=A){var p=Math.min(h+A-1,u);r.children.push(this._build(t,h,p,n-1))}}return o(r,this.toBBox),r},n.prototype._chooseSubtree=function(t,e,i,n){for(;n.push(e),!e.leaf&&n.length-1!==i;){for(var r=1/0,o=1/0,s=void 0,a=0;a<e.children.length;a++){var A=e.children[a],l=c(A),u=(h=t,p=A,(Math.max(p.maxX,h.maxX)-Math.min(p.minX,h.minX))*(Math.max(p.maxY,h.maxY)-Math.min(p.minY,h.minY))-l);u<o?(o=u,r=l<r?l:r,s=A):u===o&&l<r&&(r=l,s=A)}e=s||e.children[0]}var h,p;return e},n.prototype._insert=function(t,e,i){var n=i?t:this.toBBox(t),r=[],o=this._chooseSubtree(n,this.data,e,r);for(o.children.push(t),a(o,n);e>=0&&r[e].children.length>this._maxEntries;)this._split(r,e),e--;this._adjustParentBBoxes(n,r,e)},n.prototype._split=function(t,e){var i=t[e],n=i.children.length,r=this._minEntries;this._chooseSplitAxis(i,r,n);var s=this._chooseSplitIndex(i,r,n),a=d(i.children.splice(s,i.children.length-s));a.height=i.height,a.leaf=i.leaf,o(i,this.toBBox),o(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(i,a)},n.prototype._splitRoot=function(t,e){this.data=d([t,e]),this.data.height=t.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},n.prototype._chooseSplitIndex=function(t,e,i){for(var n,r,o,a,A,l,u,h=1/0,p=1/0,d=e;d<=i-e;d++){var f=s(t,0,d,this.toBBox),g=s(t,d,i,this.toBBox),m=(r=f,o=g,a=Math.max(r.minX,o.minX),A=Math.max(r.minY,o.minY),l=Math.min(r.maxX,o.maxX),u=Math.min(r.maxY,o.maxY),Math.max(0,l-a)*Math.max(0,u-A)),y=c(f)+c(g);m<h?(h=m,n=d,p=y<p?y:p):m===h&&y<p&&(p=y,n=d)}return n||i-e},n.prototype._chooseSplitAxis=function(t,e,i){var n=t.leaf?this.compareMinX:A,r=t.leaf?this.compareMinY:l;this._allDistMargin(t,e,i,n)<this._allDistMargin(t,e,i,r)&&t.children.sort(n)},n.prototype._allDistMargin=function(t,e,i,n){t.children.sort(n);for(var r=this.toBBox,o=s(t,0,e,r),A=s(t,i-e,i,r),l=u(o)+u(A),c=e;c<i-e;c++){var h=t.children[c];a(o,t.leaf?r(h):h),l+=u(o)}for(var p=i-e-1;p>=e;p--){var d=t.children[p];a(A,t.leaf?r(d):d),l+=u(A)}return l},n.prototype._adjustParentBBoxes=function(t,e,i){for(var n=i;n>=0;n--)a(e[n],t)},n.prototype._condense=function(t){for(var e=t.length-1,i=void 0;e>=0;e--)0===t[e].children.length?e>0?(i=t[e-1].children).splice(i.indexOf(t[e]),1):this.clear():o(t[e],this.toBBox)},n}()},function(t,e,i){"use strict";i.r(e),i.d(e,"default",(function(){return n}));class n{constructor(t=[],e=r){if(this.data=t,this.length=this.data.length,this.compare=e,this.length>0)for(let t=(this.length>>1)-1;t>=0;t--)this._down(t)}push(t){this.data.push(t),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const t=this.data[0],e=this.data.pop();return this.length--,this.length>0&&(this.data[0]=e,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:e,compare:i}=this,n=e[t];for(;t>0;){const r=t-1>>1,o=e[r];if(i(n,o)>=0)break;e[t]=o,t=r}e[t]=n}_down(t){const{data:e,compare:i}=this,n=this.length>>1,r=e[t];for(;t<n;){let n=1+(t<<1),o=e[n];const s=n+1;if(s<this.length&&i(e[s],o)<0&&(n=s,o=e[s]),i(o,r)>=0)break;e[t]=o,t=n}e[t]=r}}function r(t,e){return t<e?-1:t>e?1:0}},function(t,e,i){var n=i(46),r=i(47);t.exports=function(t,e,i,o){return e.length>0&&Array.isArray(e[0])?r(t,e,i,o):n(t,e,i,o)},t.exports.nested=r,t.exports.flat=n},function(t,e){t.exports=function(t,e,i,n){var r=t[0],o=t[1],s=!1;void 0===i&&(i=0),void 0===n&&(n=e.length);for(var a=(n-i)/2,A=0,l=a-1;A<a;l=A++){var c=e[i+2*A+0],u=e[i+2*A+1],h=e[i+2*l+0],p=e[i+2*l+1];u>o!=p>o&&r<(h-c)*(o-u)/(p-u)+c&&(s=!s)}return s}},function(t,e){t.exports=function(t,e,i,n){var r=t[0],o=t[1],s=!1;void 0===i&&(i=0),void 0===n&&(n=e.length);for(var a=n-i,A=0,l=a-1;A<a;l=A++){var c=e[A+i][0],u=e[A+i][1],h=e[l+i][0],p=e[l+i][1];u>o!=p>o&&r<(h-c)*(o-u)/(p-u)+c&&(s=!s)}return s}},function(t,e,i){!function(t){"use strict";const e=134217729;function i(t,e,i,n,r){let o,s,a,A,l=e[0],c=n[0],u=0,h=0;c>l==c>-l?(o=l,l=e[++u]):(o=c,c=n[++h]);let p=0;if(u<t&&h<i)for(c>l==c>-l?(a=o-((s=l+o)-l),l=e[++u]):(a=o-((s=c+o)-c),c=n[++h]),o=s,0!==a&&(r[p++]=a);u<t&&h<i;)c>l==c>-l?(a=o-((s=o+l)-(A=s-o))+(l-A),l=e[++u]):(a=o-((s=o+c)-(A=s-o))+(c-A),c=n[++h]),o=s,0!==a&&(r[p++]=a);for(;u<t;)a=o-((s=o+l)-(A=s-o))+(l-A),l=e[++u],o=s,0!==a&&(r[p++]=a);for(;h<i;)a=o-((s=o+c)-(A=s-o))+(c-A),c=n[++h],o=s,0!==a&&(r[p++]=a);return 0===o&&0!==p||(r[p++]=o),p}function n(t){return new Float64Array(t)}const r=n(4),o=n(8),s=n(12),a=n(16),A=n(4);t.orient2d=function(t,n,l,c,u,h){const p=(n-h)*(l-u),d=(t-u)*(c-h),f=p-d;if(0===p||0===d||p>0!=d>0)return f;const g=Math.abs(p+d);return Math.abs(f)>=33306690738754716e-32*g?f:-function(t,n,l,c,u,h,p){let d,f,g,m,y,v,_,w,C,B,b,E,S,x,I,F,O,P;const T=t-u,L=l-u,M=n-h,U=c-h;y=(I=(w=T-(_=(v=e*T)-(v-T)))*(B=U-(C=(v=e*U)-(v-U)))-((x=T*U)-_*C-w*C-_*B))-(b=I-(O=(w=M-(_=(v=e*M)-(v-M)))*(B=L-(C=(v=e*L)-(v-L)))-((F=M*L)-_*C-w*C-_*B))),r[0]=I-(b+y)+(y-O),y=(S=x-((E=x+b)-(y=E-x))+(b-y))-(b=S-F),r[1]=S-(b+y)+(y-F),y=(P=E+b)-E,r[2]=E-(P-y)+(b-y),r[3]=P;let D=function(t,e){let i=e[0];for(let t=1;t<4;t++)i+=e[t];return i}(0,r),Q=22204460492503146e-32*p;if(D>=Q||-D>=Q)return D;if(d=t-(T+(y=t-T))+(y-u),g=l-(L+(y=l-L))+(y-u),f=n-(M+(y=n-M))+(y-h),m=c-(U+(y=c-U))+(y-h),0===d&&0===f&&0===g&&0===m)return D;if(Q=11093356479670487e-47*p+33306690738754706e-32*Math.abs(D),(D+=T*m+U*d-(M*g+L*f))>=Q||-D>=Q)return D;y=(I=(w=d-(_=(v=e*d)-(v-d)))*(B=U-(C=(v=e*U)-(v-U)))-((x=d*U)-_*C-w*C-_*B))-(b=I-(O=(w=f-(_=(v=e*f)-(v-f)))*(B=L-(C=(v=e*L)-(v-L)))-((F=f*L)-_*C-w*C-_*B))),A[0]=I-(b+y)+(y-O),y=(S=x-((E=x+b)-(y=E-x))+(b-y))-(b=S-F),A[1]=S-(b+y)+(y-F),y=(P=E+b)-E,A[2]=E-(P-y)+(b-y),A[3]=P;const R=i(4,r,4,A,o);y=(I=(w=T-(_=(v=e*T)-(v-T)))*(B=m-(C=(v=e*m)-(v-m)))-((x=T*m)-_*C-w*C-_*B))-(b=I-(O=(w=M-(_=(v=e*M)-(v-M)))*(B=g-(C=(v=e*g)-(v-g)))-((F=M*g)-_*C-w*C-_*B))),A[0]=I-(b+y)+(y-O),y=(S=x-((E=x+b)-(y=E-x))+(b-y))-(b=S-F),A[1]=S-(b+y)+(y-F),y=(P=E+b)-E,A[2]=E-(P-y)+(b-y),A[3]=P;const N=i(R,o,4,A,s);y=(I=(w=d-(_=(v=e*d)-(v-d)))*(B=m-(C=(v=e*m)-(v-m)))-((x=d*m)-_*C-w*C-_*B))-(b=I-(O=(w=f-(_=(v=e*f)-(v-f)))*(B=g-(C=(v=e*g)-(v-g)))-((F=f*g)-_*C-w*C-_*B))),A[0]=I-(b+y)+(y-O),y=(S=x-((E=x+b)-(y=E-x))+(b-y))-(b=S-F),A[1]=S-(b+y)+(y-F),y=(P=E+b)-E,A[2]=E-(P-y)+(b-y),A[3]=P;const H=i(N,s,4,A,a);return a[H-1]}(t,n,l,c,u,h,g)},t.orient2dfast=function(t,e,i,n,r,o){return(e-o)*(i-r)-(t-r)*(n-o)},Object.defineProperty(t,"__esModule",{value:!0})}(e)},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e){function i(t){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}i.keys=function(){return[]},i.resolve=i,t.exports=i,i.id=58},function(t,e,i){},function(t,e,i){"use strict";i.r(e);var n={};i.r(n),i.d(n,"earthRadius",(function(){return bt})),i.d(n,"factors",(function(){return Et})),i.d(n,"unitsFactors",(function(){return St})),i.d(n,"areaFactors",(function(){return xt})),i.d(n,"feature",(function(){return It})),i.d(n,"geometry",(function(){return Ft})),i.d(n,"point",(function(){return Ot})),i.d(n,"points",(function(){return Pt})),i.d(n,"polygon",(function(){return Tt})),i.d(n,"polygons",(function(){return Lt})),i.d(n,"lineString",(function(){return Mt})),i.d(n,"lineStrings",(function(){return Ut})),i.d(n,"featureCollection",(function(){return Dt})),i.d(n,"multiLineString",(function(){return Qt})),i.d(n,"multiPoint",(function(){return Rt})),i.d(n,"multiPolygon",(function(){return Nt})),i.d(n,"geometryCollection",(function(){return Ht})),i.d(n,"round",(function(){return kt})),i.d(n,"radiansToLength",(function(){return Vt})),i.d(n,"lengthToRadians",(function(){return jt})),i.d(n,"lengthToDegrees",(function(){return Gt})),i.d(n,"bearingToAzimuth",(function(){return Kt})),i.d(n,"radiansToDegrees",(function(){return zt})),i.d(n,"degreesToRadians",(function(){return Wt})),i.d(n,"convertLength",(function(){return qt})),i.d(n,"convertArea",(function(){return Xt})),i.d(n,"isNumber",(function(){return Yt})),i.d(n,"isObject",(function(){return Jt})),i.d(n,"validateBBox",(function(){return Zt})),i.d(n,"validateId",(function(){return $t}));var r={};i.r(r),i.d(r,"BasicDataCategoryType",(function(){return o})),i.d(r,"HorizontalOrigin",(function(){return s})),i.d(r,"LabelStyle",(function(){return a})),i.d(r,"VerticalOrigin",(function(){return A})),i.d(r,"HeightReference",(function(){return l})),i.d(r,"ShadowMode",(function(){return c})),i.d(r,"ClassificationType",(function(){return u})),i.d(r,"FENCE_MATERIAL_TYPE",(function(){return h})),i.d(r,"CLUSTER_STYLE_SHAPE",(function(){return p})),i.d(r,"ARROW_TYPE",(function(){return d})),i.d(r,"Viewer",(function(){return ta})),i.d(r,"getCesium",(function(){return ea})),i.d(r,"Service",(function(){return oa})),i.d(r,"Graphic",(function(){return Ra})),i.d(r,"Measure",(function(){return ka})),i.d(r,"FlameEffect",(function(){return KA})),i.d(r,"DynamicLine",(function(){return qA})),i.d(r,"DynamicPolygon",(function(){return JA})),i.d(r,"FenceEffect",(function(){return tl})),i.d(r,"SphereShiledEffect",(function(){return nl})),i.d(r,"RadarScanEffect",(function(){return sl})),i.d(r,"ColorWallEffect",(function(){return ll})),i.d(r,"AngelRingEffect",(function(){return hl})),i.d(r,"ReflectionSurfaceEffect",(function(){return fl})),i.d(r,"AtmospherePointEffect",(function(){return yl})),i.d(r,"TerrainClipEffect",(function(){return wl})),i.d(r,"ModelFocusEffect",(function(){return bl})),i.d(r,"InnerGlowPolygonEffect",(function(){return xl})),i.d(r,"RichArrowEffect",(function(){return Ul})),i.d(r,"WaterEffect",(function(){return Nl})),i.d(r,"WeatherEffect",(function(){return Kl})),i.d(r,"SnowCoverEffect",(function(){return Yl})),i.d(r,"BaseMapMaskEffect",(function(){return tc})),i.d(r,"CorridorEffect",(function(){return oc})),i.d(r,"HeatMapEffect",(function(){return Ac})),i.d(r,"CircleSpreadEffect",(function(){return uc})),i.d(r,"SnowEffect",(function(){return dc})),i.d(r,"SmokeEffect",(function(){return mc})),i.d(r,"FireworkEffect",(function(){return _c})),i.d(r,"RainEffect",(function(){return Bc})),i.d(r,"FountainEffect",(function(){return Sc})),i.d(r,"BlastEffect",(function(){return Fc})),i.d(r,"ProjectionVideoAnalysis",(function(){return Uc})),i.d(r,"ViewShedAnalysis",(function(){return Nc})),i.d(r,"FloodAnalysis",(function(){return zc})),i.d(r,"ShadowsAnalysis",(function(){return Zc})),i.d(r,"SwipeAnalysis",(function(){return ou})),i.d(r,"DivIcon",(function(){return os})),i.d(r,"Model",(function(){return As})),i.d(r,"Billboard",(function(){return us})),i.d(r,"Label",(function(){return ds})),i.d(r,"HistoryTrack",(function(){return Pu})),i.d(r,"EventTrack",(function(){return Mu})),i.d(r,"RealtimeTrack",(function(){return Qu})),i.d(r,"IntelliSenseDeviceTrack",(function(){return Hu})),i.d(r,"HolographicRoadNetworkTrack",(function(){return ju})),i.d(r,"RoutePlan",(function(){return zu})),i.d(r,"GeometryLayer",(function(){return ms})),i.d(r,"ServiceLayer",(function(){return _s})),i.d(r,"PoiLayer",(function(){return bs})),i.d(r,"CityModelLayer",(function(){return xs})),i.d(r,"RoadConditionLayer",(function(){return Os})),i.d(r,"ComplexLayer",(function(){return Ls})),i.d(r,"PointLayer",(function(){return Ds})),i.d(r,"PolylineLayer",(function(){return Ns})),i.d(r,"PolygonLayer",(function(){return Vs})),i.d(r,"VideoLayer",(function(){return Ks})),i.d(r,"ClassifyLayer",(function(){return qs})),i.d(r,"ClipTilesetLayer",(function(){return Js})),i.d(r,"TransformControl",(function(){return Zu})),i.d(r,"BillboardControl",(function(){return eh})),i.d(r,"TranslateControl",(function(){return rh})),i.d(r,"Airway",(function(){return ch})),i.d(r,"Position",(function(){return I})),i.d(r,"Transform",(function(){return Y})),i.d(r,"Calculation",(function(){return Wn})),i.d(r,"LightSourceType",(function(){return dh})),i.d(r,"BasicDataType",(function(){return _h})),i.d(r,"CONSTANTS",(function(){return wh}));var o,s,a,A,l,c,u,h,p,d;i(22);!function(t){t.POI="POI",t.ROAD="road",t.CROSS="cross",t.ROAD_SECTION="roadSection",t.WATER_FACE="waterFace"}(o||(o={})),function(t){t[t.CENTER=0]="CENTER",t[t.LEFT=1]="LEFT",t[t.RIGHT=-1]="RIGHT"}(s||(s={})),function(t){t[t.FILL=0]="FILL",t[t.FILL_AND_OUTLINE=2]="FILL_AND_OUTLINE"}(a||(a={})),function(t){t[t.CENTER=0]="CENTER",t[t.BOTTOM=1]="BOTTOM",t[t.BASELINE=2]="BASELINE",t[t.TOP=-1]="TOP"}(A||(A={})),function(t){t[t.NONE=0]="NONE",t[t.CLAMP_TO_GROUND=1]="CLAMP_TO_GROUND",t[t.RELATIVE_TO_GROUND=2]="RELATIVE_TO_GROUND"}(l||(l={})),function(t){t[t.DISABLED=0]="DISABLED",t[t.ENABLED=1]="ENABLED",t[t.CAST_ONLY=2]="CAST_ONLY",t[t.RECEIVE_ONLY=3]="RECEIVE_ONLY"}(c||(c={})),function(t){t[t.TERRAIN=0]="TERRAIN",t[t.CESIUM_3D_TILE=1]="CESIUM_3D_TILE",t[t.BOTH=2]="BOTH"}(u||(u={})),function(t){t.DEFAULT="DEFAULT",t.FADE="FADE",t.COLOR_FLOW="COLOR_FLOW",t.IMAGE_FLOW="IMAGE_FLOW"}(h||(h={})),function(t){t[t.CIRCLE=1]="CIRCLE",t[t.RECT=2]="RECT"}(p||(p={})),function(t){t.SINGLEARROW="SINGLEARROW",t.DOUBLEARROW="DOUBLEARROW",t.STEPARROW="STEPARROW",t.DOUBLESTEPARROW="DOUBLESTEPARROW"}(d||(d={}));var f=i(0),g=i(1);class m{constructor(){this.instance={}}add(t,e){if(t){const e=t._layerType;this.instance[e]=this.instance[e]||{};const i=t._id;return this.instance[e][i]=t,!0}return!1}remove(t,e){if(t){const e=t._layerType,i=t._id;return this.instance[e]&&this.instance[e][i]&&delete this.instance[e][i],this.instance[e]&&!Object.keys(this.instance[e]).length&&delete this.instance[e],!0}return!1}has(t,e){return this.instance[t]=this.instance[t]||{},!Object(g.isEmpty)(this.instance[t])&&Object(g.isUndefined)(this.instance[t][e])}hasType(t){return!!this.instance[t]}getByType(t){const e=this.instance[t];return e[Object.keys(e)[0]]}get(t,e){return this.instance[t]=this.instance[t]||{},this.instance[t][e]}getAll(){let t=[];return Object.keys(this.instance).forEach(e=>{Object.values(this.instance[e]).forEach(e=>{t.push(e)})}),t}getById(t){let e=null;return Object(g.each)(this.instance,(i,n)=>{i[t]&&(e=i[t])}),e}}class y{constructor(){this.oldListener={},this.eventCache={},this.autoRegisterEvent()}autoRegisterEvent(){}on(t,e,i){const n=this.getEvent(t);if(Object(g.isUndefined)(n)||Object(g.isUndefined)(e))return;1===n.numberOfListeners&&(n.removeEventListener(this.oldListener[t],i),this.oldListener[t]=null);const r=n.addEventListener(e,i);return this.oldListener[t]=e,r}off(t,e){const i=this.getEvent(t);if(Object(g.isUndefined)(i)||Object(g.isUndefined)(this.oldListener[t]))return!1;const n=i.removeEventListener(this.oldListener[t],e);return this.oldListener[t]=null,n}fire(t,e={}){const i=this.getEvent(t);i&&i.raiseEvent(e)}getEvent(t){return this.eventCache[t]}}class v extends y{constructor(t){super(),this.viewer=t}on(t,e,i){this.oldListener=e,this.viewer.instance.canvas.addEventListener(t,e,i)}off(t,e){return this.viewer.instance.canvas.removeEventListener(t,this.oldListener),!0}}const _={animation:!0,baseLayerPicker:!1,fullscreenButton:!1,geocoder:!1,homeButton:!1,infoBox:!1,sceneModePicker:!1,selectionIndicator:!1,timeline:!1,navigationHelpButton:!1,navigationInstructionsInitiallyVisible:!1,creditContainer:void 0,shouldAnimate:!0,imageryProvider:new f.UrlTemplateImageryProvider({url:"http://mt1.google.cn/vt/lyrs=s&hl=zh-CN&x={x}&y={y}&z={z}&s=Gali"}),contextOptions:{webgl:{alpha:!0},requestWebgl2:!0}},w={style:"default",format:"image/jpeg",tileMatrixSetID:"default"},C={},B={},b={},E={CIRCLE:1,RECT:2},S={DEFAULT:"DEFAULT",FADE:"FADE",COLOR_FLOW:"COLOR_FLOW",IMAGE_FLOW:"IMAGE_FLOW"},x={SINGLEARROW:"SINGLEARROW",DOUBLEARROW:"DOUBLEARROW",STEPARROW:"STEPARROW",DOUBLESTEPARROW:"DOUBLESTEPARROW"};class I{constructor(t=0,e=0,i=0,n=0,r=0,o=0){this.lng=t,this.lat=e,this.alt=i,this.heading=n,this.pitch=r,this.roll=o}serialize(){const t=new I(this.lng,this.lat,this.alt,this.heading,this.pitch,this.roll);return JSON.stringify(t)}distance(t){if(!(t&&t instanceof I))return 0}toCartesian3(){return f.Cartesian3.fromDegrees(this.lng,this.lat,this.alt)}}const F=3.141592653589793,O=.006693421622965943;function P(t,e){let i=300+t+2*e+.1*t*t+.1*t*e+.1*Math.sqrt(Math.abs(t));return i+=2*(20*Math.sin(6*t*F)+20*Math.sin(2*t*F))/3,i+=2*(20*Math.sin(t*F)+40*Math.sin(t/3*F))/3,i+=2*(150*Math.sin(t/12*F)+300*Math.sin(t/30*F))/3,i}function T(t,e){let i=2*t-100+3*e+.2*e*e+.1*t*e+.2*Math.sqrt(Math.abs(t));return i+=2*(20*Math.sin(6*t*F)+20*Math.sin(2*t*F))/3,i+=2*(20*Math.sin(e*F)+40*Math.sin(e/3*F))/3,i+=2*(160*Math.sin(e/12*F)+320*Math.sin(e*F/30))/3,i}class L extends Array{static toString(){return"function Point() { [custom class Point] }"}static validate(t){let e=!1;if(Array.isArray(t)&&(2===t.length||3===t.length)){const i=t[0],n=t[1];if("number"!=typeof i||"number"!=typeof n)return e;e=i>=-180&&i<=180&&n>=-90&&n<=90}return e}}function M(t){return t>=0&&t<=255}var U={Color:class extends String{static toString(){return"function Color() { [ custom class Color ] }"}isInNumberScope(t){return t>=0&&t<=255}isInFloatNumberScope(t){return t>=0&&t<=1}static customValidate(t){return!1}static validate(t){if(t=t.toString(),this.customValidate(t))return!0;const e=/^[rR][gG][Bb]\((2[0-4][0-9]|25[0-5]|[01]?[0-9][0-9]?),[ ]*(2[0-4][0-9]|25[0-5]|[01]?[0-9][0-9]?),[ ]*(2[0-4][0-9]|25[0-5]|[01]?[0-9][0-9]?)\)$/,i=/^[rR][gG][Bb][Aa]\((2[0-4][0-9]|25[0-5]|[01]?[0-9][0-9]?),[ ]*(2[0-4][0-9]|25[0-5]|[01]?[0-9][0-9]?),[ ]*(2[0-4][0-9]|25[0-5]|[01]?[0-9][0-9]?),[ ]*(0|0\.[1-9]{1,2}|1)\)$/;if(t.toLowerCase().indexOf("rgb")>=0&&e.test(t)){let i=+t.match(e)[1],n=+t.match(e)[2],r=+t.match(e)[3];if(M(i)&&M(n)&&M(r))return!0}if(t.toLowerCase().indexOf("rgba")>=0&&i.test(t)){let e=+t.match(i)[1],n=+t.match(i)[2],r=+t.match(i)[3],o=+t.match(i)[4];if(M(e)&&M(n)&&M(r)&&function(t){return t>=0&&t<=1}(o))return!0}return!!(t.indexOf("#")>=0&&/^#(([a-f|A-F|0-9]{3})|([a-f|A-F|0-9]{6}))$/.test(t))}},Point:L,Unit:class extends String{static toString(){return"function Unit() { [ custom class Unit ] }"}static validate(t){let e=!1;return e=new RegExp(/^(kilometers|meters|miles)$/).test(t),e}},Bound:class extends Array{static toString(){return"function Bound() { [ custom class Bound ] }"}static validate(t){const e="FAILURE";let i=e;if(Array.isArray(t))for(let n=0;n<t.length;n++)i=L.validate(t[n])||e;return i!==e}},ArrayPoint:class extends Array{static toString(){return"function ArrayPoint() { [custom class ArrayPoint] }"}static validate(t){let e=!1;if(Array.isArray(t))for(let i=0;i<t.length;i++)if(e=L.validate(t[i]),!e)return!1;return!0}},DOM:class extends Object{static toString(){return"function DOM() { [ custom class DOM ] }"}static validate(t){let e=!1;var i;return i=t,e="object"==typeof HTMLElement?i instanceof HTMLElement:!(!i||"object"!=typeof i||1!==i.nodeType&&9!==i.nodeType||"string"!=typeof i.nodeName),e}},String:String,Number:Number,Boolean:Boolean,Object:Object,Array:Array,Symbol:Symbol,Function:Function,GeoJSON:class extends Object{static toString(){return"function GeoJSON() { [custom class GeoJSON ] }"}static validate(t){if(t&&t.geometry&&t.geometry.type&&"Circle"===t.geometry.type)return!0;return!1}},CustomDate:class extends String{static toString(){return"function CustomDate() { [ custom class CustomDate ] }"}static validate(t){let e=!1;if("string"!=typeof t)return e;const i=new RegExp(/^((?:19|20)\d\d)-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])$/),n=new RegExp(/([0-1][0-9]|(2[0-3])):([0-5][0-9]):([0-5][0-9])$/),r=t.split(" "),o=r[0],s=r[1];return e=i.test(o)&&n.test(s),e}},PolygonArr:class extends String{static toString(){return"function PolygonArr() { [ custom class PolygonArr ] }"}static validate(t){let e=!0;return t.forEach(t=>{"Feature"===t.type&&"Polygon"===t.geometry.type||(e=!1)}),e}},Polygon:class extends Object{static toString(){return"function Polygon() { [ custom class Polygon ] }"}static validate(t){let e=!0;return"Feature"===t.type&&"Polygon"===t.geometry.type||(e=!1),e}}};const D=/^(String|Number|Boolean|Function|Symbol)$/,Q=/^(Point|Unit|Bound|ArrayPoint|DOM|GeoJSON|CustomDate|Color|Polygon)$/;function R(t,e=0){return function(i,n,r){const o=r.value;return"function"==typeof o&&(r.value=new Proxy(o,{apply:function(i,n,r){if(V(t,r[e]))return i.apply(n,r)}})),r}}function N(t){return function(e,i,n){const r=n.value;return"function"==typeof r&&(n.value=new Proxy(r,{apply:function(e,n,r){if(j(t,r,i))return e.apply(n,r)}})),n}}function H(t,e=0){return function(i){function n(...n){if(!V(t,n[e]))return{};return new i(...n)}return n.prototype=i.prototype,n}}const k=U;function V(t={},e){let i=!0;const n=Reflect.ownKeys(t);for(let r=0;r<n.length&&i;r++){const o=n[r];i=G(o,t,e),(t[o]||{}).children&&(z(e[o])?i=V((t[o]||{}).children,e[o]):Array.isArray(e[o])&&(i=j((t[o]||{}).children,e[o],o)))}return i}function j(t=[],e,i){let n=!0;for(let r=0;r<t.length&&n;r++)n=G(r,t,e,i),(t[r]||{}).children&&(z(e[r])?n=V((t[r]||{}).children,e[r]):Array.isArray(e[r])&&(n=j((t[r]||{}).children,e[r],i)));return n}function G(t,e,i,n){const r=!function(t,e){if(t instanceof Object)return void 0!==t[e]||t.hasOwnProperty(e)||Object.prototype.hasOwnProperty.call(t,e);return!1}(i,t),o=(i||{})[t],s=e[t];if(s.required&&r)return W(`\n            Missing required prop:${n?n+"=>"+t:t}\n        `),!1;if(null==o&&!s.required)return!0;let a=s.type,A=!a||!0===a;const l=[];if(a){Array.isArray(a)||(a=[a]);for(let t=0;t<a.length&&!A;t++){const e=K(o,a[t]);l.push(e.expectedType||""),A=e.valid}}if(!A)return W(`Invalid prop: type check failed for prop "${n?n+"=>"+t:t}".  expected prop type " ${l.join(" or ")} "`),!1;const{validator:c}=s;return!(c&&!c(o,i||{}))||(W("Invalid prop: "+(s.message||`custom validator check failed for prop "${t}".  `)),!1)}function K(t,e){let i;const n=function(t){const e=t&&t.toString().match(/^\s*function (\w+)/);return e?e[1]:""}(e);if(D.test(n)){const r=typeof t;i=r===n.toLowerCase(),i||"object"!==r||(i=t instanceof e)}else i=Q.test(n)?k[n].validate(t):"Object"===n?z(t):"Array"===n?Array.isArray(t):i instanceof e;return{valid:i,expectedType:n}}function z(t){return"[object Object]"===Object.prototype.toString.call(t)}function W(t){console.error(t)}var q=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},X=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};class Y{static CartesianToWGS84(t){if(t){const e=f.Ellipsoid.WGS84.cartesianToCartographic(t);return e?new I(f.Math.toDegrees(e.longitude),f.Math.toDegrees(e.latitude),e.height):new I(0,0)}return new I(0,0)}static WGS84ToCartesian(t){return t?f.Cartesian3.fromDegrees(t.lng||0,t.lat||0,t.alt||0,f.Ellipsoid.WGS84):f.Cartesian3.ZERO}static WindowPositionToWGS84(t,e){const i=e.viewer.instance.scene;let n=void 0;if(i.mode===f.SceneMode.SCENE3D){const e=i.camera.getPickRay(t);n=i.globe.pick(e,i)}else n=i.camera.pickEllipsoid(t,f.Ellipsoid.WGS84);return Y.CartesianToWGS84(n)}static WindowPositionToScenePosition(t,e){const i=e.viewer.instance.scene;let n;if(i.pickPositionSupported&&(n=i.pickPosition(t)),n){const t=Y.CartesianToWGS84(n);if(t.alt>=0)return t}let r=void 0;if(i.mode===f.SceneMode.SCENE3D){const e=i.camera.getPickRay(t);r=i.globe.pick(e,i)}else r=i.camera.pickEllipsoid(t,f.Ellipsoid.WGS84);if(r){const t=Y.CartesianToWGS84(r);return t.alt=0,t}return n}static WGS84ToWindowPosition(t,e){const i=e.viewer.instance.scene;return f.SceneTransforms.wgs84ToWindowCoordinates(i,Y.WGS84ToCartesian(t))}static WGS84ToGCJ02(t){let e=function(t){let e=t[0],i=t[1],n=T(e-105,i-35),r=P(e-105,i-35),o=i/180*F,s=Math.sin(o);s=1-O*s*s;let a=Math.sqrt(s);return n=180*n/(6378245*(1-O)/(s*a)*F),r=180*r/(6378245/a*Math.cos(o)*F),[e+r,i+n]}([t.lng,t.lat]);return new I(e[0],e[1],t.alt)}static GCJ02ToWGS84(t){let e=function(t){let e=t[0],i=t[1],n=T(e-105,i-35),r=P(e-105,i-35),o=i/180*F,s=Math.sin(o);s=1-O*s*s;let a=Math.sqrt(s);return n=180*n/(6378245*(1-O)/(s*a)*F),r=180*r/(6378245/a*Math.cos(o)*F),[2*e-(e+r),2*i-(i+n)]}([t.lng,t.lat]);return new I(e[0],e[1],t.alt)}static WindowPositionToCartesian(t,e){const i=e.viewer.instance.scene;let n=void 0;if(i.mode===f.SceneMode.SCENE3D){const e=i.camera.getPickRay(t);n=i.globe.pick(e,i)}else n=i.camera.pickEllipsoid(t,f.Ellipsoid.WGS84);return n}static CartesianToWindowPosition(t,e){return f.SceneTransforms.wgs84ToWindowCoordinates(e.viewer.instance.scene,t)}static WGS84ToCartographic(t){if(t)return f.Cartesian3.fromDegrees(t.lng,t.lat,t.alt)}static CartesianArrToWGS84Arr(t){return t?t.map(t=>Y.CartesianToWGS84(t)):[]}static WGS84ArrToCartesianArr(t){return t?t.map(t=>Y.WGS84ToCartesian(t)):[]}}q([R({x:{type:k.Number,required:!0},y:{type:k.Number,required:!0},z:{type:k.Number,required:!0}}),X("design:type",Function),X("design:paramtypes",[f.Cartesian3]),X("design:returntype",void 0)],Y,"CartesianToWGS84",null),q([R({lng:{type:k.Number,required:!0,validator:function(t){return t>=-180&&t<=180}},lat:{type:k.Number,required:!0,validator:function(t){return t>=-90&&t<=90}},alt:{type:k.Number,required:!0}}),X("design:type",Function),X("design:paramtypes",[I]),X("design:returntype",void 0)],Y,"WGS84ToCartesian",null),q([R({lng:{type:k.Number,required:!0}}),X("design:type",Function),X("design:paramtypes",[I]),X("design:returntype",void 0)],Y,"WGS84ToGCJ02",null),q([R({lng:{type:k.Number,required:!0}}),X("design:type",Function),X("design:paramtypes",[I]),X("design:returntype",void 0)],Y,"GCJ02ToWGS84",null);const J={billboard:"BillboardCollection",point:"PointPrimitiveCollection",label:"LabelCollection",primitive:"PrimitiveCollection",customDataSource:"CustomDataSource"};class Z{constructor(t){t&&J[t]&&(this.type=t,this._collection=new f[J[t]])}getCollection(){return this._collection}get size(){return"customDataSource"===this.type?this._collection.entities.values.length:"primitive"===this.type?this._collection.length:void 0}getType(){return this.type}add(t){"customDataSource"===this.type&&this._collection.entities.add(t),"primitive"===this.type&&this._collection.add(t)}removeAll(){"customDataSource"===this.type&&this._collection.entities.removeAll(),"primitive"===this.type&&this._collection.removeAll()}show(){this._collection&&(this._collection.show=!0)}hide(){this._collection&&(this._collection.show=!1)}}function $(t){var e=(new Date).getTime(),i="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var i=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?i:3&i|8).toString(16)}));return t?`${t}-${i}`:i}function tt(t,e){const i=t.length;let n=0;const r=[];let o=0,s=0,a=0;for(;n<i;){let i,A=0,l=0;do{i=t.charCodeAt(n++)-63,l|=(31&i)<<A,A+=5}while(i>=32);o+=0!=(1&l)?~(l>>1):l>>1,A=0,l=0;do{i=t.charCodeAt(n++)-63,l|=(31&i)<<A,A+=5}while(i>=32);if(s+=0!=(1&l)?~(l>>1):l>>1,e){A=0,l=0;do{i=t.charCodeAt(n++)-63,l|=(31&i)<<A,A+=5}while(i>=32);a+=0!=(1&l)?~(l>>1):l>>1,r.push([s/1e6,o/1e6,a/100])}else r.push([s/1e6,o/1e6])}return{type:"LineString",coordinates:r}}function et(t){switch(t){case 0:return"CENTER";case 1:return"LEFT";case-1:return"RIGHT";default:return"CENTER"}}function it(t){switch(t){case 0:return"CENTER";case 1:return"BOTTOM";case 2:return"BASELINE";case-1:return"TOP";default:return"CENTER"}}var nt=i(16),rt=i(17),ot=i(18);var st=new class{constructor(t={}){this._lang="zh-CN",this._langMap=Object.keys(t).reduce((e,i)=>{const n=t[i]||{};return e[i]=Object.keys(n).reduce((t,e)=>(t[e]=n[e],t),{}),e},{}),this._langMap["zh-CN"]||(this._langMap["zh-CN"]={})}get lang(){return this._lang}set lang(t){if(!this._langMap[t])throw new Error(`Language ${t} is not support. Expected value to be one of ${Object.keys(this._langMap).map(t=>JSON.stringify(t)).join(", ")}.`);this._lang=t}property(t){return this._langMap[this.lang][t]}}({en:nt,"zh-CN":rt,fr:ot});function at(t,e){if(!e)return{status:10,data:t};e({status:10,data:t})}function At(t,e){let i,n;"object"==typeof t?(i=t.message||"",n=t.code):(i=st.property(t)?st.property(t):t,n=t),console.error(i),e&&e({status:20,code:n,message:i})}const lt=t=>{const e=t.searchServer;return{SERVICE_POI_SEARCH_URL:e+"/gisdata/getPoiData",SERVICE_POI_V2_SEARCH_URL:e+"/v2/poi/query",SERVICE_POI_TYPE:e+"/poiSubClass/getAllClassWithBigClass",SERVICE_WATERFACE_SEARCH_URL:e+"/gisdata/getRiverData",SERVICE_SECTION_SEARCH_URL:e+"/poi/query/getSectionData",SERVICE_CROSS_SEARCH_URL:e+"/poi/query/getAccessData",SERVICE_ROAD_SEARCH_URL:e+"/poi/query/getEntireRoadData",BUSINESS_RENDER_SERVICE:e+"/gisdata/service/query/geometry",BUSINESS_HISTORY_SERVICE:e+"/gisdata/log/query",SERVICE_3D_AGGS:e+"/3dModel/aggs",SERVICE_3D_BASE_CLUSTER:e+"/3dModel/baseDataAggs",SERVICE_3D_DEVICE_CLUSTER:e+"/3dModel/aggs",SERVICE_3D_DEVICE:e+"/layer/threeDimModel/query",GET_GEOMETRY_BY_ADMIN_CODE_URL:e+"/area/base/queryByAdcode",GET_ADMIN_BY_POINT:e+"/region/queryAdminFaceAllByLonLat",GET_GEO_POINT_KD:e+"/geocode/geocoding",GET_LOCATION_KD:e+"/geocode/reverse-geocoding"}},ct=t=>{const e=t.portalUrl,i=t.configServer;return{GET_CONFIG_URL:e+"/auth/kMapInit",GET_TOKEN:e+"/auth/accessToken",GET_MODEL_URL:i+"/api/3d/model",GET_SINGLE_CONFIG_URL:i+"/api/init"}},ut=t=>{const e=t.wsServer;return{WS_SERVER:e+"/ctserver",SUBSCRIBE_GPS_DEVICE:e+"/trace/subscribeGpsDevice",SUBSCRIBE_INTERSECTION:e+"/scTrace/subscribeSection",UNSUBSCRIBE_INTERSECTION:e+"/scTrace/unsubscribeSection",SUBSCRIBE_ELECTRONIC:e+"/elc/subscribeVehicle",UNSUBSCRIBE_ELECTRONIC:e+"/elc/unsubscribeVehicle",UPDATE_MONITOR_DEVICE:e+"/elc/updateMonitorDevices"}},ht=t=>{const e=t.routeServer;return{ROUTE_EQUAL_TIME_URL:e+"/isochrone",DRIVING_ROUTE:e+"/route"}};var pt=i(19),dt=i.n(pt),ft=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i};class gt{constructor(){this.axiosInstance=dt.a.create({timeout:8e3}),this.axiosInstance.interceptors.request.use((function(t){return t}),(function(t){return Promise.reject(t)})),this.axiosInstance.interceptors.response.use((function(t){return t}),(function(t){return Promise.reject(t)}))}changeConfig(t){t&&t(this.axiosInstance)}createRequestByRequestMethod(t,e,i){return new Promise((n,r)=>{let o=null;const{body:s,url:a,noAuth:A,headers:l,withCredentials:c}=t,u=ft(t,["body","url","noAuth","headers","withCredentials"]);if(s){o={["get"===i?"params":"data"]:s}}const h=Object.assign(Object.assign(Object.assign({},u),{url:a,method:i,withCredentials:"boolean"!=typeof c||c}),o);if(!A){const t=e||{};t.accessToken?a.includes(t.wsServer)?h.headers=l:h.headers=Object.assign({"access-token":t.accessToken},l):h.headers=l}return this.axiosInstance(h).then(t=>{const{status:e,data:i}=t;if(200===e){const{code:t,message:e,status:o}=i;t&&200!=t&&200!=o?r({code:t,message:e}):n(i)}else r(t)}).catch(t=>{r(t)})})}get(t,e={}){return this.createRequestByRequestMethod(t,e,"get")}post(t,e){return this.createRequestByRequestMethod(t,e,"post")}custom(t,e,i){return this.createRequestByRequestMethod(e,i,t)}}var mt=new gt;var yt=function(t,e,i,n){return new(i||(i=Promise))((function(r,o){function s(t){try{A(n.next(t))}catch(t){o(t)}}function a(t){try{A(n.throw(t))}catch(t){o(t)}}function A(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(s,a)}A((n=n.apply(t,e||[])).next())}))};const vt=(t,e)=>new Promise((i,n)=>{let r={url:`${ct(t).GET_MODEL_URL}/${e}`,body:{},headers:{"base-url":t.portalUrl}};mt.get(r,t).then(t=>{t&&t.result?i(t.result):n(st.property("c030102"))}).catch(t=>{n(t)})}),_t=(t,e)=>yt(void 0,void 0,void 0,(function*(){const i=yield vt(t,e).catch(t=>Promise.resolve(null));return i?Promise.resolve(i):Promise.resolve(null)}));function wt(t,e=!0){let i=document.createElement("canvas");i.width=e?1:100,i.height=e?100:1;let n=i.getContext("2d"),r=t,o=e?n.createLinearGradient(0,0,0,100):n.createLinearGradient(0,0,100,0);r.forEach(t=>{o.addColorStop(t.stop,t.color)}),n.fillStyle=o,e?n.fillRect(0,0,1,100):n.fillRect(0,0,100,1);var s=new Image;return s.src=i.toDataURL("image/png"),s}function Ct(t){const e=t.getBoundingClientRect(),i=e.width,n=e.height;return i>=7680&&n>=4320?8:i>=3840&&n>=2160?4:2}var Bt=new class{constructor(){this.list={}}add(t){const e=t.id;this.list[e]=t}getModule(t){const e=t.id;return this.list[e].viewer}getEngine(t){const e=t.id;return this.list[e].viewer.instance}getPrimitives(t){const e=t.id;return this.list[e].viewer.instance.scene.primitives}getEntities(t){const e=t.id;return this.list[e].viewer.instance.entities}getMapConfig(t){const e=t.id;return this.list[e].viewer.mapConfig}getLayerCache(t){const e=t.id;return this.list[e].viewer.layerCache}},bt=6371008.8,Et={centimeters:100*bt,centimetres:100*bt,degrees:bt/111325,feet:3.28084*bt,inches:39.37*bt,kilometers:bt/1e3,kilometres:bt/1e3,meters:bt,metres:bt,miles:bt/1609.344,millimeters:1e3*bt,millimetres:1e3*bt,nauticalmiles:bt/1852,radians:1,yards:1.0936*bt},St={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/bt,yards:1.0936133},xt={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function It(t,e,i){void 0===i&&(i={});var n={type:"Feature"};return(0===i.id||i.id)&&(n.id=i.id),i.bbox&&(n.bbox=i.bbox),n.properties=e||{},n.geometry=t,n}function Ft(t,e,i){switch(void 0===i&&(i={}),t){case"Point":return Ot(e).geometry;case"LineString":return Mt(e).geometry;case"Polygon":return Tt(e).geometry;case"MultiPoint":return Rt(e).geometry;case"MultiLineString":return Qt(e).geometry;case"MultiPolygon":return Nt(e).geometry;default:throw new Error(t+" is invalid")}}function Ot(t,e,i){if(void 0===i&&(i={}),!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Yt(t[0])||!Yt(t[1]))throw new Error("coordinates must contain numbers");return It({type:"Point",coordinates:t},e,i)}function Pt(t,e,i){return void 0===i&&(i={}),Dt(t.map((function(t){return Ot(t,e)})),i)}function Tt(t,e,i){void 0===i&&(i={});for(var n=0,r=t;n<r.length;n++){var o=r[n];if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var s=0;s<o[o.length-1].length;s++)if(o[o.length-1][s]!==o[0][s])throw new Error("First and last Position are not equivalent.")}return It({type:"Polygon",coordinates:t},e,i)}function Lt(t,e,i){return void 0===i&&(i={}),Dt(t.map((function(t){return Tt(t,e)})),i)}function Mt(t,e,i){if(void 0===i&&(i={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");return It({type:"LineString",coordinates:t},e,i)}function Ut(t,e,i){return void 0===i&&(i={}),Dt(t.map((function(t){return Mt(t,e)})),i)}function Dt(t,e){void 0===e&&(e={});var i={type:"FeatureCollection"};return e.id&&(i.id=e.id),e.bbox&&(i.bbox=e.bbox),i.features=t,i}function Qt(t,e,i){return void 0===i&&(i={}),It({type:"MultiLineString",coordinates:t},e,i)}function Rt(t,e,i){return void 0===i&&(i={}),It({type:"MultiPoint",coordinates:t},e,i)}function Nt(t,e,i){return void 0===i&&(i={}),It({type:"MultiPolygon",coordinates:t},e,i)}function Ht(t,e,i){return void 0===i&&(i={}),It({type:"GeometryCollection",geometries:t},e,i)}function kt(t,e){if(void 0===e&&(e=0),e&&!(e>=0))throw new Error("precision must be a positive number");var i=Math.pow(10,e||0);return Math.round(t*i)/i}function Vt(t,e){void 0===e&&(e="kilometers");var i=Et[e];if(!i)throw new Error(e+" units is invalid");return t*i}function jt(t,e){void 0===e&&(e="kilometers");var i=Et[e];if(!i)throw new Error(e+" units is invalid");return t/i}function Gt(t,e){return zt(jt(t,e))}function Kt(t){var e=t%360;return e<0&&(e+=360),e}function zt(t){return 180*(t%(2*Math.PI))/Math.PI}function Wt(t){return t%360*Math.PI/180}function qt(t,e,i){if(void 0===e&&(e="kilometers"),void 0===i&&(i="kilometers"),!(t>=0))throw new Error("length must be a positive number");return Vt(jt(t,e),i)}function Xt(t,e,i){if(void 0===e&&(e="meters"),void 0===i&&(i="kilometers"),!(t>=0))throw new Error("area must be a positive number");var n=xt[e];if(!n)throw new Error("invalid original units");var r=xt[i];if(!r)throw new Error("invalid final units");return t/n*r}function Yt(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function Jt(t){return!!t&&t.constructor===Object}function Zt(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach((function(t){if(!Yt(t))throw new Error("bbox must only contain numbers")}))}function $t(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}function te(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function ee(t,e,i){if(void 0===i&&(i={}),!0===i.final)return function(t,e){var i=ee(e,t);return i=(i+180)%360}(t,e);var n=te(t),r=te(e),o=Wt(n[0]),s=Wt(r[0]),a=Wt(n[1]),A=Wt(r[1]),l=Math.sin(s-o)*Math.cos(A),c=Math.cos(a)*Math.sin(A)-Math.sin(a)*Math.cos(A)*Math.cos(s-o);return zt(Math.atan2(l,c))}function ie(t,e,i,n){void 0===n&&(n={});var r=te(t),o=Wt(r[0]),s=Wt(r[1]),a=Wt(i),A=jt(e,n.units),l=Math.asin(Math.sin(s)*Math.cos(A)+Math.cos(s)*Math.sin(A)*Math.cos(a));return Ot([zt(o+Math.atan2(Math.sin(a)*Math.sin(A)*Math.cos(s),Math.cos(A)-Math.sin(s)*Math.sin(l))),zt(l)],n.properties)}var ne=function(t,e,i){void 0===i&&(i={});var n=te(t),r=te(e),o=Wt(r[1]-n[1]),s=Wt(r[0]-n[0]),a=Wt(n[1]),A=Wt(r[1]),l=Math.pow(Math.sin(o/2),2)+Math.pow(Math.sin(s/2),2)*Math.cos(a)*Math.cos(A);return Vt(2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l)),i.units)};function re(t,e,i){void 0===i&&(i={});for(var n,r=("Feature"===(n=t).type?n.geometry:n).coordinates,o=0,s=0;s<r.length&&!(e>=o&&s===r.length-1);s++){if(o>=e){var a=e-o;if(a){var A=ee(r[s],r[s-1])-180;return ie(r[s],a,A,i)}return Ot(r[s])}o+=ne(r[s],r[s+1],i)}return Ot(r[r.length-1])}function oe(t,e,i){if(null!==t)for(var n,r,o,s,a,A,l,c,u=0,h=0,p=t.type,d="FeatureCollection"===p,f="Feature"===p,g=d?t.features.length:1,m=0;m<g;m++){a=(c=!!(l=d?t.features[m].geometry:f?t.geometry:t)&&"GeometryCollection"===l.type)?l.geometries.length:1;for(var y=0;y<a;y++){var v=0,_=0;if(null!==(s=c?l.geometries[y]:l)){A=s.coordinates;var w=s.type;switch(u=!i||"Polygon"!==w&&"MultiPolygon"!==w?0:1,w){case null:break;case"Point":if(!1===e(A,h,m,v,_))return!1;h++,v++;break;case"LineString":case"MultiPoint":for(n=0;n<A.length;n++){if(!1===e(A[n],h,m,v,_))return!1;h++,"MultiPoint"===w&&v++}"LineString"===w&&v++;break;case"Polygon":case"MultiLineString":for(n=0;n<A.length;n++){for(r=0;r<A[n].length-u;r++){if(!1===e(A[n][r],h,m,v,_))return!1;h++}"MultiLineString"===w&&v++,"Polygon"===w&&_++}"Polygon"===w&&v++;break;case"MultiPolygon":for(n=0;n<A.length;n++){for(_=0,r=0;r<A[n].length;r++){for(o=0;o<A[n][r].length-u;o++){if(!1===e(A[n][r][o],h,m,v,_))return!1;h++}_++}v++}break;case"GeometryCollection":for(n=0;n<s.geometries.length;n++)if(!1===oe(s.geometries[n],e,i))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function se(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var i=0;i<t.features.length&&!1!==e(t.features[i],i);i++);}function ae(t,e){var i,n,r,o,s,a,A,l,c,u,h=0,p="FeatureCollection"===t.type,d="Feature"===t.type,f=p?t.features.length:1;for(i=0;i<f;i++){for(a=p?t.features[i].geometry:d?t.geometry:t,l=p?t.features[i].properties:d?t.properties:{},c=p?t.features[i].bbox:d?t.bbox:void 0,u=p?t.features[i].id:d?t.id:void 0,s=(A=!!a&&"GeometryCollection"===a.type)?a.geometries.length:1,r=0;r<s;r++)if(null!==(o=A?a.geometries[r]:a))switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(o,h,l,c,u))return!1;break;case"GeometryCollection":for(n=0;n<o.geometries.length;n++)if(!1===e(o.geometries[n],h,l,c,u))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,h,l,c,u))return!1;h++}}function Ae(t){return function(t,e,i){var n=i;return ae(t,(function(t,r,o,s,a){n=0===r&&void 0===i?t:e(n,t,r,o,s,a)})),n}(t,(function(t,e){return t+function(t){var e,i=0;switch(t.type){case"Polygon":return le(t.coordinates);case"MultiPolygon":for(e=0;e<t.coordinates.length;e++)i+=le(t.coordinates[e]);return i;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}(e)}),0)}function le(t){var e=0;if(t&&t.length>0){e+=Math.abs(ce(t[0]));for(var i=1;i<t.length;i++)e-=Math.abs(ce(t[i]))}return e}function ce(t){var e,i,n,r,o,s,a=0,A=t.length;if(A>2){for(s=0;s<A;s++)s===A-2?(n=A-2,r=A-1,o=0):s===A-1?(n=A-1,r=0,o=1):(n=s,r=s+1,o=s+2),e=t[n],i=t[r],a+=(ue(t[o][0])-ue(e[0]))*Math.sin(ue(i[1]));a=6378137*a*6378137/2}return a}function ue(t){return t*Math.PI/180}function he(t){var e=[1/0,1/0,-1/0,-1/0];return oe(t,(function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])})),e}he.default=he;var pe=he;var de=function(t,e){void 0===e&&(e={});var i=pe(t);return Ot([(i[0]+i[2])/2,(i[1]+i[3])/2],e.properties,e)},fe=i(5),ge=function(){return new me};function me(){this.reset()}me.prototype={constructor:me,reset:function(){this.s=this.t=0},add:function(t){ve(ye,t,this.t),ve(this,ye.s,this.s),this.s?this.t+=ye.t:this.s=ye.t},valueOf:function(){return this.s}};var ye=new me;function ve(t,e,i){var n=t.s=e+i,r=n-e,o=n-r;t.t=e-o+(i-r)}var _e=1e-6,we=Math.PI,Ce=we/2,Be=we/4,be=2*we,Ee=180/we,Se=we/180,xe=Math.abs,Ie=Math.atan,Fe=Math.atan2,Oe=Math.cos,Pe=(Math.ceil,Math.exp),Te=(Math.floor,Math.log),Le=(Math.pow,Math.sin),Me=(Math.sign,Math.sqrt),Ue=Math.tan;function De(t){return t>1?0:t<-1?we:Math.acos(t)}function Qe(t){return t>1?Ce:t<-1?-Ce:Math.asin(t)}function Re(){}function Ne(t,e){t&&ke.hasOwnProperty(t.type)&&ke[t.type](t,e)}var He={Feature:function(t,e){Ne(t.geometry,e)},FeatureCollection:function(t,e){for(var i=t.features,n=-1,r=i.length;++n<r;)Ne(i[n].geometry,e)}},ke={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var i=t.coordinates,n=-1,r=i.length;++n<r;)t=i[n],e.point(t[0],t[1],t[2])},LineString:function(t,e){Ve(t.coordinates,e,0)},MultiLineString:function(t,e){for(var i=t.coordinates,n=-1,r=i.length;++n<r;)Ve(i[n],e,0)},Polygon:function(t,e){je(t.coordinates,e)},MultiPolygon:function(t,e){for(var i=t.coordinates,n=-1,r=i.length;++n<r;)je(i[n],e)},GeometryCollection:function(t,e){for(var i=t.geometries,n=-1,r=i.length;++n<r;)Ne(i[n],e)}};function Ve(t,e,i){var n,r=-1,o=t.length-i;for(e.lineStart();++r<o;)n=t[r],e.point(n[0],n[1],n[2]);e.lineEnd()}function je(t,e){var i=-1,n=t.length;for(e.polygonStart();++i<n;)Ve(t[i],e,1);e.polygonEnd()}var Ge=function(t,e){t&&He.hasOwnProperty(t.type)?He[t.type](t,e):Ne(t,e)};ge(),ge();function Ke(t){return[Fe(t[1],t[0]),Qe(t[2])]}function ze(t){var e=t[0],i=t[1],n=Oe(i);return[n*Oe(e),n*Le(e),Le(i)]}function We(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function qe(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function Xe(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function Ye(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function Je(t){var e=Me(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}ge();var Ze=function(t,e){function i(i,n){return i=t(i,n),e(i[0],i[1])}return t.invert&&e.invert&&(i.invert=function(i,n){return(i=e.invert(i,n))&&t.invert(i[0],i[1])}),i};function $e(t,e){return[t>we?t-be:t<-we?t+be:t,e]}function ti(t,e,i){return(t%=be)?e||i?Ze(ii(t),ni(e,i)):ii(t):e||i?ni(e,i):$e}function ei(t){return function(e,i){return[(e+=t)>we?e-be:e<-we?e+be:e,i]}}function ii(t){var e=ei(t);return e.invert=ei(-t),e}function ni(t,e){var i=Oe(t),n=Le(t),r=Oe(e),o=Le(e);function s(t,e){var s=Oe(e),a=Oe(t)*s,A=Le(t)*s,l=Le(e),c=l*i+a*n;return[Fe(A*r-c*o,a*i-l*n),Qe(c*r+A*o)]}return s.invert=function(t,e){var s=Oe(e),a=Oe(t)*s,A=Le(t)*s,l=Le(e),c=l*r-A*o;return[Fe(A*r+l*o,a*i+c*n),Qe(c*i-a*n)]},s}$e.invert=$e;function ri(t,e,i,n,r,o){if(i){var s=Oe(e),a=Le(e),A=n*i;null==r?(r=e+n*be,o=e-A/2):(r=oi(s,r),o=oi(s,o),(n>0?r<o:r>o)&&(r+=n*be));for(var l,c=r;n>0?c>o:c<o;c-=A)l=Ke([s,-a*Oe(c),-a*Le(c)]),t.point(l[0],l[1])}}function oi(t,e){(e=ze(e))[0]-=t,Je(e);var i=De(-e[1]);return((-e[2]<0?-i:i)+be-_e)%be}var si=function(){var t,e=[];return{point:function(e,i){t.push([e,i])},lineStart:function(){e.push(t=[])},lineEnd:Re,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var i=e;return e=[],t=null,i}}},ai=function(t,e){return xe(t[0]-e[0])<_e&&xe(t[1]-e[1])<_e};function Ai(t,e,i,n){this.x=t,this.z=e,this.o=i,this.e=n,this.v=!1,this.n=this.p=null}var li=function(t,e,i,n,r){var o,s,a=[],A=[];if(t.forEach((function(t){if(!((e=t.length-1)<=0)){var e,i,n=t[0],s=t[e];if(ai(n,s)){for(r.lineStart(),o=0;o<e;++o)r.point((n=t[o])[0],n[1]);r.lineEnd()}else a.push(i=new Ai(n,t,null,!0)),A.push(i.o=new Ai(n,null,i,!1)),a.push(i=new Ai(s,t,null,!1)),A.push(i.o=new Ai(s,null,i,!0))}})),a.length){for(A.sort(e),ci(a),ci(A),o=0,s=A.length;o<s;++o)A[o].e=i=!i;for(var l,c,u=a[0];;){for(var h=u,p=!0;h.v;)if((h=h.n)===u)return;l=h.z,r.lineStart();do{if(h.v=h.o.v=!0,h.e){if(p)for(o=0,s=l.length;o<s;++o)r.point((c=l[o])[0],c[1]);else n(h.x,h.n.x,1,r);h=h.n}else{if(p)for(l=h.p.z,o=l.length-1;o>=0;--o)r.point((c=l[o])[0],c[1]);else n(h.x,h.p.x,-1,r);h=h.p}l=(h=h.o).z,p=!p}while(!h.v);r.lineEnd()}}};function ci(t){if(e=t.length){for(var e,i,n=0,r=t[0];++n<e;)r.n=i=t[n],i.p=r,r=i;r.n=i=t[0],i.p=r}}var ui=function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN};var hi,pi;1===(hi=ui).length&&(pi=hi,hi=function(t,e){return ui(pi(t),e)});var di=Array.prototype;di.slice,di.map,Math.sqrt(50),Math.sqrt(10),Math.sqrt(2);var fi=function(t){for(var e,i,n,r=t.length,o=-1,s=0;++o<r;)s+=t[o].length;for(i=new Array(s);--r>=0;)for(e=(n=t[r]).length;--e>=0;)i[--s]=n[e];return i};function gi(t,e,i,n){function r(r,o){return t<=r&&r<=i&&e<=o&&o<=n}function o(r,o,a,l){var c=0,u=0;if(null==r||(c=s(r,a))!==(u=s(o,a))||A(r,o)<0^a>0)do{l.point(0===c||3===c?t:i,c>1?n:e)}while((c=(c+a+4)%4)!==u);else l.point(o[0],o[1])}function s(n,r){return xe(n[0]-t)<_e?r>0?0:3:xe(n[0]-i)<_e?r>0?2:1:xe(n[1]-e)<_e?r>0?1:0:r>0?3:2}function a(t,e){return A(t.x,e.x)}function A(t,e){var i=s(t,1),n=s(e,1);return i!==n?i-n:0===i?e[1]-t[1]:1===i?t[0]-e[0]:2===i?t[1]-e[1]:e[0]-t[0]}return function(s){var A,l,c,u,h,p,d,f,g,m,y,v=s,_=si(),w={point:C,lineStart:function(){w.point=B,l&&l.push(c=[]);m=!0,g=!1,d=f=NaN},lineEnd:function(){A&&(B(u,h),p&&g&&_.rejoin(),A.push(_.result()));w.point=C,g&&v.lineEnd()},polygonStart:function(){v=_,A=[],l=[],y=!0},polygonEnd:function(){var e=function(){for(var e=0,i=0,r=l.length;i<r;++i)for(var o,s,a=l[i],A=1,c=a.length,u=a[0],h=u[0],p=u[1];A<c;++A)o=h,s=p,u=a[A],h=u[0],p=u[1],s<=n?p>n&&(h-o)*(n-s)>(p-s)*(t-o)&&++e:p<=n&&(h-o)*(n-s)<(p-s)*(t-o)&&--e;return e}(),i=y&&e,r=(A=fi(A)).length;(i||r)&&(s.polygonStart(),i&&(s.lineStart(),o(null,null,1,s),s.lineEnd()),r&&li(A,a,e,o,s),s.polygonEnd());v=s,A=l=c=null}};function C(t,e){r(t,e)&&v.point(t,e)}function B(o,s){var a=r(o,s);if(l&&c.push([o,s]),m)u=o,h=s,p=a,m=!1,a&&(v.lineStart(),v.point(o,s));else if(a&&g)v.point(o,s);else{var A=[d=Math.max(-1e9,Math.min(1e9,d)),f=Math.max(-1e9,Math.min(1e9,f))],_=[o=Math.max(-1e9,Math.min(1e9,o)),s=Math.max(-1e9,Math.min(1e9,s))];!function(t,e,i,n,r,o){var s,a=t[0],A=t[1],l=0,c=1,u=e[0]-a,h=e[1]-A;if(s=i-a,u||!(s>0)){if(s/=u,u<0){if(s<l)return;s<c&&(c=s)}else if(u>0){if(s>c)return;s>l&&(l=s)}if(s=r-a,u||!(s<0)){if(s/=u,u<0){if(s>c)return;s>l&&(l=s)}else if(u>0){if(s<l)return;s<c&&(c=s)}if(s=n-A,h||!(s>0)){if(s/=h,h<0){if(s<l)return;s<c&&(c=s)}else if(h>0){if(s>c)return;s>l&&(l=s)}if(s=o-A,h||!(s<0)){if(s/=h,h<0){if(s>c)return;s>l&&(l=s)}else if(h>0){if(s<l)return;s<c&&(c=s)}return l>0&&(t[0]=a+l*u,t[1]=A+l*h),c<1&&(e[0]=a+c*u,e[1]=A+c*h),!0}}}}}(A,_,t,e,i,n)?a&&(v.lineStart(),v.point(o,s),y=!1):(g||(v.lineStart(),v.point(A[0],A[1])),v.point(_[0],_[1]),a||v.lineEnd(),y=!1)}d=o,f=s,g=a}return w}}var mi=ge(),yi=function(t,e){var i=e[0],n=e[1],r=[Le(i),-Oe(i),0],o=0,s=0;mi.reset();for(var a=0,A=t.length;a<A;++a)if(c=(l=t[a]).length)for(var l,c,u=l[c-1],h=u[0],p=u[1]/2+Be,d=Le(p),f=Oe(p),g=0;g<c;++g,h=y,d=_,f=w,u=m){var m=l[g],y=m[0],v=m[1]/2+Be,_=Le(v),w=Oe(v),C=y-h,B=C>=0?1:-1,b=B*C,E=b>we,S=d*_;if(mi.add(Fe(S*B*Le(b),f*w+S*Oe(b))),o+=E?C+B*be:C,E^h>=i^y>=i){var x=qe(ze(u),ze(m));Je(x);var I=qe(r,x);Je(I);var F=(E^C>=0?-1:1)*Qe(I[2]);(n>F||n===F&&(x[0]||x[1]))&&(s+=E^C>=0?1:-1)}}return(o<-_e||o<_e&&mi<-_e)^1&s};ge();var vi=function(t){return t};ge(),ge();var _i=1/0,wi=_i,Ci=-_i,Bi=Ci;var bi={point:function(t,e){t<_i&&(_i=t);t>Ci&&(Ci=t);e<wi&&(wi=e);e>Bi&&(Bi=e)},lineStart:Re,lineEnd:Re,polygonStart:Re,polygonEnd:Re,result:function(){var t=[[_i,wi],[Ci,Bi]];return Ci=Bi=-(wi=_i=1/0),t}};function Ei(t){this._context=t}Ei.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._context.moveTo(t,e),this._point=1;break;case 1:this._context.lineTo(t,e);break;default:this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,be)}},result:Re};ge();function Si(){this._string=[]}function xi(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}Si.prototype={_radius:4.5,_circle:xi(4.5),pointRadius:function(t){return(t=+t)!==this._radius&&(this._radius=t,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._string.push("M",t,",",e),this._point=1;break;case 1:this._string.push("L",t,",",e);break;default:null==this._circle&&(this._circle=xi(this._radius)),this._string.push("M",t,",",e,this._circle)}},result:function(){if(this._string.length){var t=this._string.join("");return this._string=[],t}return null}};var Ii=function(t,e,i,n){return function(r,o){var s,a,A,l=e(o),c=r.invert(n[0],n[1]),u=si(),h=e(u),p=!1,d={point:f,lineStart:m,lineEnd:y,polygonStart:function(){d.point=v,d.lineStart=_,d.lineEnd=w,a=[],s=[]},polygonEnd:function(){d.point=f,d.lineStart=m,d.lineEnd=y,a=fi(a);var t=yi(s,c);a.length?(p||(o.polygonStart(),p=!0),li(a,Oi,t,i,o)):t&&(p||(o.polygonStart(),p=!0),o.lineStart(),i(null,null,1,o),o.lineEnd()),p&&(o.polygonEnd(),p=!1),a=s=null},sphere:function(){o.polygonStart(),o.lineStart(),i(null,null,1,o),o.lineEnd(),o.polygonEnd()}};function f(e,i){var n=r(e,i);t(e=n[0],i=n[1])&&o.point(e,i)}function g(t,e){var i=r(t,e);l.point(i[0],i[1])}function m(){d.point=g,l.lineStart()}function y(){d.point=f,l.lineEnd()}function v(t,e){A.push([t,e]);var i=r(t,e);h.point(i[0],i[1])}function _(){h.lineStart(),A=[]}function w(){v(A[0][0],A[0][1]),h.lineEnd();var t,e,i,n,r=h.clean(),l=u.result(),c=l.length;if(A.pop(),s.push(A),A=null,c)if(1&r){if((e=(i=l[0]).length-1)>0){for(p||(o.polygonStart(),p=!0),o.lineStart(),t=0;t<e;++t)o.point((n=i[t])[0],n[1]);o.lineEnd()}}else c>1&&2&r&&l.push(l.pop().concat(l.shift())),a.push(l.filter(Fi))}return d}};function Fi(t){return t.length>1}function Oi(t,e){return((t=t.x)[0]<0?t[1]-Ce-_e:Ce-t[1])-((e=e.x)[0]<0?e[1]-Ce-_e:Ce-e[1])}var Pi=Ii((function(){return!0}),(function(t){var e,i=NaN,n=NaN,r=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(o,s){var a=o>0?we:-we,A=xe(o-i);xe(A-we)<_e?(t.point(i,n=(n+s)/2>0?Ce:-Ce),t.point(r,n),t.lineEnd(),t.lineStart(),t.point(a,n),t.point(o,n),e=0):r!==a&&A>=we&&(xe(i-r)<_e&&(i-=r*_e),xe(o-a)<_e&&(o-=a*_e),n=function(t,e,i,n){var r,o,s=Le(t-i);return xe(s)>_e?Ie((Le(e)*(o=Oe(n))*Le(i)-Le(n)*(r=Oe(e))*Le(t))/(r*o*s)):(e+n)/2}(i,n,o,s),t.point(r,n),t.lineEnd(),t.lineStart(),t.point(a,n),e=0),t.point(i=o,n=s),r=a},lineEnd:function(){t.lineEnd(),i=n=NaN},clean:function(){return 2-e}}}),(function(t,e,i,n){var r;if(null==t)r=i*Ce,n.point(-we,r),n.point(0,r),n.point(we,r),n.point(we,0),n.point(we,-r),n.point(0,-r),n.point(-we,-r),n.point(-we,0),n.point(-we,r);else if(xe(t[0]-e[0])>_e){var o=t[0]<e[0]?we:-we;r=i*o/2,n.point(-o,r),n.point(0,r),n.point(o,r)}else n.point(e[0],e[1])}),[-we,-Ce]);var Ti=function(t,e){var i=Oe(t),n=i>0,r=xe(i)>_e;function o(t,e){return Oe(t)*Oe(e)>i}function s(t,e,n){var r=[1,0,0],o=qe(ze(t),ze(e)),s=We(o,o),a=o[0],A=s-a*a;if(!A)return!n&&t;var l=i*s/A,c=-i*a/A,u=qe(r,o),h=Ye(r,l);Xe(h,Ye(o,c));var p=u,d=We(h,p),f=We(p,p),g=d*d-f*(We(h,h)-1);if(!(g<0)){var m=Me(g),y=Ye(p,(-d-m)/f);if(Xe(y,h),y=Ke(y),!n)return y;var v,_=t[0],w=e[0],C=t[1],B=e[1];w<_&&(v=_,_=w,w=v);var b=w-_,E=xe(b-we)<_e;if(!E&&B<C&&(v=C,C=B,B=v),E||b<_e?E?C+B>0^y[1]<(xe(y[0]-_)<_e?C:B):C<=y[1]&&y[1]<=B:b>we^(_<=y[0]&&y[0]<=w)){var S=Ye(p,(-d+m)/f);return Xe(S,h),[y,Ke(S)]}}}function a(e,i){var r=n?t:we-t,o=0;return e<-r?o|=1:e>r&&(o|=2),i<-r?o|=4:i>r&&(o|=8),o}return Ii(o,(function(t){var e,i,A,l,c;return{lineStart:function(){l=A=!1,c=1},point:function(u,h){var p,d=[u,h],f=o(u,h),g=n?f?0:a(u,h):f?a(u+(u<0?we:-we),h):0;if(!e&&(l=A=f)&&t.lineStart(),f!==A&&(!(p=s(e,d))||ai(e,p)||ai(d,p))&&(d[0]+=_e,d[1]+=_e,f=o(d[0],d[1])),f!==A)c=0,f?(t.lineStart(),p=s(d,e),t.point(p[0],p[1])):(p=s(e,d),t.point(p[0],p[1]),t.lineEnd()),e=p;else if(r&&e&&n^f){var m;g&i||!(m=s(d,e,!0))||(c=0,n?(t.lineStart(),t.point(m[0][0],m[0][1]),t.point(m[1][0],m[1][1]),t.lineEnd()):(t.point(m[1][0],m[1][1]),t.lineEnd(),t.lineStart(),t.point(m[0][0],m[0][1])))}!f||e&&ai(e,d)||t.point(d[0],d[1]),e=d,A=f,i=g},lineEnd:function(){A&&t.lineEnd(),e=null},clean:function(){return c|(l&&A)<<1}}}),(function(i,n,r,o){ri(o,t,e,r,i,n)}),n?[0,-t]:[-we,t-we])};function Li(t){return function(e){var i=new Mi;for(var n in t)i[n]=t[n];return i.stream=e,i}}function Mi(){}function Ui(t,e,i){var n=e[1][0]-e[0][0],r=e[1][1]-e[0][1],o=t.clipExtent&&t.clipExtent();t.scale(150).translate([0,0]),null!=o&&t.clipExtent(null),Ge(i,t.stream(bi));var s=bi.result(),a=Math.min(n/(s[1][0]-s[0][0]),r/(s[1][1]-s[0][1])),A=+e[0][0]+(n-a*(s[1][0]+s[0][0]))/2,l=+e[0][1]+(r-a*(s[1][1]+s[0][1]))/2;return null!=o&&t.clipExtent(o),t.scale(150*a).translate([A,l])}function Di(t,e,i){return Ui(t,[[0,0],e],i)}Mi.prototype={constructor:Mi,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var Qi=Oe(30*Se),Ri=function(t,e){return+e?function(t,e){function i(n,r,o,s,a,A,l,c,u,h,p,d,f,g){var m=l-n,y=c-r,v=m*m+y*y;if(v>4*e&&f--){var _=s+h,w=a+p,C=A+d,B=Me(_*_+w*w+C*C),b=Qe(C/=B),E=xe(xe(C)-1)<_e||xe(o-u)<_e?(o+u)/2:Fe(w,_),S=t(E,b),x=S[0],I=S[1],F=x-n,O=I-r,P=y*F-m*O;(P*P/v>e||xe((m*F+y*O)/v-.5)>.3||s*h+a*p+A*d<Qi)&&(i(n,r,o,s,a,A,x,I,E,_/=B,w/=B,C,f,g),g.point(x,I),i(x,I,E,_,w,C,l,c,u,h,p,d,f,g))}}return function(e){var n,r,o,s,a,A,l,c,u,h,p,d,f={point:g,lineStart:m,lineEnd:v,polygonStart:function(){e.polygonStart(),f.lineStart=_},polygonEnd:function(){e.polygonEnd(),f.lineStart=m}};function g(i,n){i=t(i,n),e.point(i[0],i[1])}function m(){c=NaN,f.point=y,e.lineStart()}function y(n,r){var o=ze([n,r]),s=t(n,r);i(c,u,l,h,p,d,c=s[0],u=s[1],l=n,h=o[0],p=o[1],d=o[2],16,e),e.point(c,u)}function v(){f.point=g,e.lineEnd()}function _(){m(),f.point=w,f.lineEnd=C}function w(t,e){y(n=t,e),r=c,o=u,s=h,a=p,A=d,f.point=y}function C(){i(c,u,l,h,p,d,r,o,n,s,a,A,16,e),f.lineEnd=v,v()}return f}}(t,e):function(t){return Li({point:function(e,i){e=t(e,i),this.stream.point(e[0],e[1])}})}(t)};var Ni=Li({point:function(t,e){this.stream.point(t*Se,e*Se)}});function Hi(t){return ki((function(){return t}))()}function ki(t){var e,i,n,r,o,s,a,A,l,c,u=150,h=480,p=250,d=0,f=0,g=0,m=0,y=0,v=null,_=Pi,w=null,C=vi,B=.5,b=Ri(x,B);function E(t){return[(t=o(t[0]*Se,t[1]*Se))[0]*u+i,n-t[1]*u]}function S(t){return(t=o.invert((t[0]-i)/u,(n-t[1])/u))&&[t[0]*Ee,t[1]*Ee]}function x(t,r){return[(t=e(t,r))[0]*u+i,n-t[1]*u]}function I(){o=Ze(r=ti(g,m,y),e);var t=e(d,f);return i=h-t[0]*u,n=p+t[1]*u,F()}function F(){return l=c=null,E}return E.stream=function(t){return l&&c===t?l:l=Ni(_(r,b(C(c=t))))},E.clipAngle=function(t){return arguments.length?(_=+t?Ti(v=t*Se,6*Se):(v=null,Pi),F()):v*Ee},E.clipExtent=function(t){return arguments.length?(C=null==t?(w=s=a=A=null,vi):gi(w=+t[0][0],s=+t[0][1],a=+t[1][0],A=+t[1][1]),F()):null==w?null:[[w,s],[a,A]]},E.scale=function(t){return arguments.length?(u=+t,I()):u},E.translate=function(t){return arguments.length?(h=+t[0],p=+t[1],I()):[h,p]},E.center=function(t){return arguments.length?(d=t[0]%360*Se,f=t[1]%360*Se,I()):[d*Ee,f*Ee]},E.rotate=function(t){return arguments.length?(g=t[0]%360*Se,m=t[1]%360*Se,y=t.length>2?t[2]%360*Se:0,I()):[g*Ee,m*Ee,y*Ee]},E.precision=function(t){return arguments.length?(b=Ri(x,B=t*t),F()):Me(B)},E.fitExtent=function(t,e){return Ui(E,t,e)},E.fitSize=function(t,e){return Di(E,t,e)},function(){return e=t.apply(this,arguments),E.invert=e.invert&&S,I()}}function Vi(t){return function(e,i){var n=Oe(e),r=Oe(i),o=t(n*r);return[o*r*Le(e),o*Le(i)]}}function ji(t){return function(e,i){var n=Me(e*e+i*i),r=t(n),o=Le(r),s=Oe(r);return[Fe(e*o,n*s),Qe(n&&i*o/n)]}}var Gi=Vi((function(t){return Me(2/(1+t))}));Gi.invert=ji((function(t){return 2*Qe(t/2)}));var Ki=Vi((function(t){return(t=De(t))&&t/Le(t)}));Ki.invert=ji((function(t){return t}));function zi(t,e){return[t,Te(Ue((Ce+e)/2))]}zi.invert=function(t,e){return[t,2*Ie(Pe(e))-Ce]};function Wi(t,e){return[t,e]}Wi.invert=Wi;function qi(t,e){var i=Oe(e),n=Oe(t)*i;return[i*Le(t)/n,Le(e)/n]}qi.invert=ji(Ie);function Xi(t,e){var i=e*e,n=i*i;return[t*(.8707-.131979*i+n*(n*(.003971*i-.001529*n)-.013791)),e*(1.007226+i*(.015085+n*(.028874*i-.044475-.005916*n)))]}Xi.invert=function(t,e){var i,n=e,r=25;do{var o=n*n,s=o*o;n-=i=(n*(1.007226+o*(.015085+s*(.028874*o-.044475-.005916*s)))-e)/(1.007226+o*(.045255+s*(.259866*o-.311325-.005916*11*s)))}while(xe(i)>_e&&--r>0);return[t/(.8707+(o=n*n)*(o*(o*o*o*(.003971-.001529*o)-.013791)-.131979)),n]};function Yi(t,e){return[Oe(e)*Le(t),Le(e)]}Yi.invert=ji(Qe);function Ji(t,e){var i=Oe(e),n=1+Oe(t)*i;return[i*Le(t)/n,Le(e)/n]}Ji.invert=ji((function(t){return 2*Ie(t)}));function Zi(t,e){return[Te(Ue((Ce+e)/2)),-t]}Zi.invert=function(t,e){return[-e,2*Ie(Pe(t))-Ce]};function $i(t,e,i,n){var r=t.properties||{},o="Feature"===t.type?t.geometry:t;if("GeometryCollection"===o.type){var s=[];return ae(t,(function(t){var r=$i(t,e,i,n);r&&s.push(r)})),Dt(s)}var a=function(t){var e=de(t).geometry.coordinates,i=[-e[0],-e[1]];return Hi(Ki).scale(79.4188).clipAngle(179.999).rotate(i).scale(bt)}(o),A={type:o.type,coordinates:tn(o.coordinates,a)},l=(new fe.GeoJSONReader).read(A),c=Vt(jt(e,i),"meters"),u=fe.BufferOp.bufferOp(l,c,n);if(!function t(e){return Array.isArray(e[0])?t(e[0]):isNaN(e[0])}((u=(new fe.GeoJSONWriter).write(u)).coordinates))return It({type:u.type,coordinates:en(u.coordinates,a)},r)}function tn(t,e){return"object"!=typeof t[0]?e(t):t.map((function(t){return tn(t,e)}))}function en(t,e){return"object"!=typeof t[0]?e.invert(t):t.map((function(t){return en(t,e)}))}var nn=function(t,e,i){var n=(i=i||{}).units||"kilometers",r=i.steps||8;if(!t)throw new Error("geojson is required");if("object"!=typeof i)throw new Error("options must be an object");if("number"!=typeof r)throw new Error("steps must be an number");if(void 0===e)throw new Error("radius is required");if(r<=0)throw new Error("steps must be greater than 0");var o=[];switch(t.type){case"GeometryCollection":return ae(t,(function(t){var i=$i(t,e,n,r);i&&o.push(i)})),Dt(o);case"FeatureCollection":return se(t,(function(t){var i=$i(t,e,n,r);i&&se(i,(function(t){t&&o.push(t)}))})),Dt(o)}return $i(t,e,n,r)},rn=i(20),on=i.n(rn);var sn=function(t,e){void 0===e&&(e={});var i=0,n=0,r=0;return oe(t,(function(t){i+=t[0],n+=t[1],r++}),!0),Ot([i/r,n/r],e.properties)};var an=function t(e,i){switch(void 0===i&&(i={}),function(t,e){return"FeatureCollection"===t.type?"FeatureCollection":"GeometryCollection"===t.type?"GeometryCollection":"Feature"===t.type&&null!==t.geometry?t.geometry.type:t.type}(e)){case"Point":return Ot(te(e),i.properties);case"Polygon":var n=[];oe(e,(function(t){n.push(t)}));var r,o,s,a,A,l,c,u,h=sn(e,{properties:i.properties}),p=h.geometry.coordinates,d=0,f=0,g=0,m=n.map((function(t){return[t[0]-p[0],t[1]-p[1]]}));for(r=0;r<n.length-1;r++)a=(o=m[r])[0],l=o[1],A=(s=m[r+1])[0],g+=u=a*(c=s[1])-A*l,d+=(a+A)*u,f+=(l+c)*u;if(0===g)return h;var y=1/(6*(.5*g));return Ot([p[0]+y*d,p[1]+y*f],i.properties);default:var v=function(t,e){void 0===e&&(e={}),e.concavity=e.concavity||1/0;var i=[];if(oe(t,(function(t){i.push([t[0],t[1]])})),!i.length)return null;var n=on()(i,e.concavity);return n.length>3?Tt([n]):null}(e);return v?t(v,{properties:i.properties}):sn(e,{properties:i.properties})}};var An=function(t,e,i){void 0===i&&(i={});for(var n=i.steps||64,r=i.properties?i.properties:!Array.isArray(t)&&"Feature"===t.type&&t.properties?t.properties:{},o=[],s=0;s<n;s++)o.push(ie(t,e,-360*s/n,i).geometry.coordinates);return o.push(o[0]),Tt([o],r)};var ln=function(t,e,i,n){void 0===n&&(n={});var r=e<0,o=qt(Math.abs(e),n.units,"meters");r&&(o=-Math.abs(o));var s=te(t),a=function(t,e,i,n){n=void 0===n?bt:Number(n);var r=e/n,o=t[0]*Math.PI/180,s=Wt(t[1]),a=Wt(i),A=r*Math.cos(a),l=s+A;Math.abs(l)>Math.PI/2&&(l=l>0?Math.PI-l:-Math.PI-l);var c=Math.log(Math.tan(l/2+Math.PI/4)/Math.tan(s/2+Math.PI/4)),u=Math.abs(c)>1e-11?A/c:Math.cos(s),h=r*Math.sin(a)/u;return[(180*(o+h)/Math.PI+540)%360-180,180*l/Math.PI]}(s,o,i);return a[0]+=a[0]-s[0]>180?-360:s[0]-a[0]>180?360:0,Ot(a,n.properties)},cn={meters:6371008.8,metres:6371008.8,millimeters:6371008800,millimetres:6371008800,centimeters:637100880,centimetres:637100880,kilometers:6371.0088,kilometres:6371.0088,miles:3958.761333810546,nauticalmiles:6371008.8/1852,inches:6371008.8*39.37,yards:6371008.8/1.0936,feet:20902260.511392,radians:1,degrees:6371008.8/111325};function un(t,e,i){if(!yn(i=i||{}))throw new Error("options is invalid");var n=i.bbox,r=i.id;if(void 0===t)throw new Error("geometry is required");if(e&&e.constructor!==Object)throw new Error("properties must be an Object");n&&vn(n),r&&_n(r);var o={type:"Feature"};return r&&(o.id=r),n&&(o.bbox=n),o.properties=e||{},o.geometry=t,o}function hn(t,e,i){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!mn(t[0])||!mn(t[1]))throw new Error("coordinates must contain numbers");return un({type:"Point",coordinates:t},e,i)}function pn(t,e,i){if(!t)throw new Error("coordinates is required");for(var n=0;n<t.length;n++){var r=t[n];if(r.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var o=0;o<r[r.length-1].length;o++){if(0===n&&0===o&&!mn(r[0][0])||!mn(r[0][1]))throw new Error("coordinates must contain numbers");if(r[r.length-1][o]!==r[0][o])throw new Error("First and last Position are not equivalent.")}}return un({type:"Polygon",coordinates:t},e,i)}function dn(t,e){if(null==t)throw new Error("distance is required");if(e&&"string"!=typeof e)throw new Error("units must be a string");var i=cn[e||"kilometers"];if(!i)throw new Error(e+" units is invalid");return t/i}function fn(t){if(null==t)throw new Error("radians is required");return 180*(t%(2*Math.PI))/Math.PI}function gn(t){if(null==t)throw new Error("degrees is required");return t%360*Math.PI/180}function mn(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function yn(t){return!!t&&t.constructor===Object}function vn(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach((function(t){if(!mn(t))throw new Error("bbox must only contain numbers")}))}function _n(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}var wn=function(t,e,i,n){if(!yn(n=n||{}))throw new Error("options is invalid");var r=n.units,o=n.properties,s=function(t){if(!t)throw new Error("coord is required");if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates;if(Array.isArray(t)&&t.length>=2&&void 0===t[0].length&&void 0===t[1].length)return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")}(t),a=gn(s[0]),A=gn(s[1]),l=gn(i),c=dn(e,r),u=Math.asin(Math.sin(A)*Math.cos(c)+Math.cos(A)*Math.sin(c)*Math.cos(l));return hn([fn(a+Math.atan2(Math.sin(l)*Math.sin(c)*Math.cos(A),Math.cos(c)-Math.sin(A)*Math.sin(u))),fn(u)],o)};var Cn=function(t,e,i){var n=(i=i||{}).steps||64,r=i.properties;if(!t)throw new Error("center is required");if(!e)throw new Error("radius is required");if("object"!=typeof i)throw new Error("options must be an object");if("number"!=typeof n)throw new Error("steps must be a number");n=n||64,r=r||t.properties||{};for(var o=[],s=0;s<n;s++)o.push(wn(t,e,-360*s/n,i).geometry.coordinates);return o.push(o[0]),pn([o],r)},Bn={meters:6371008.8,metres:6371008.8,millimeters:6371008800,millimetres:6371008800,centimeters:637100880,centimetres:637100880,kilometers:6371.0088,kilometres:6371.0088,miles:3958.761333810546,nauticalmiles:6371008.8/1852,inches:6371008.8*39.37,yards:6371008.8/1.0936,feet:20902260.511392,radians:1,degrees:6371008.8/111325};function bn(t,e,i){if(!Tn(i=i||{}))throw new Error("options is invalid");var n=i.bbox,r=i.id;if(void 0===t)throw new Error("geometry is required");if(e&&e.constructor!==Object)throw new Error("properties must be an Object");n&&Ln(n),r&&Mn(r);var o={type:"Feature"};return r&&(o.id=r),n&&(o.bbox=n),o.properties=e||{},o.geometry=t,o}function En(t,e,i){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Pn(t[0])||!Pn(t[1]))throw new Error("coordinates must contain numbers");return bn({type:"Point",coordinates:t},e,i)}function Sn(t,e,i){if(!t)throw new Error("coordinates is required");for(var n=0;n<t.length;n++){var r=t[n];if(r.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var o=0;o<r[r.length-1].length;o++){if(0===n&&0===o&&!Pn(r[0][0])||!Pn(r[0][1]))throw new Error("coordinates must contain numbers");if(r[r.length-1][o]!==r[0][o])throw new Error("First and last Position are not equivalent.")}}return bn({type:"Polygon",coordinates:t},e,i)}function xn(t,e,i){if(!t)throw new Error("coordinates is required");if(t.length<2)throw new Error("coordinates must be an array of two or more positions");if(!Pn(t[0][1])||!Pn(t[0][1]))throw new Error("coordinates must contain numbers");return bn({type:"LineString",coordinates:t},e,i)}function In(t,e){if(null==t)throw new Error("distance is required");if(e&&"string"!=typeof e)throw new Error("units must be a string");var i=Bn[e||"kilometers"];if(!i)throw new Error(e+" units is invalid");return t/i}function Fn(t){if(null==t)throw new Error("radians is required");return 180*(t%(2*Math.PI))/Math.PI}function On(t){if(null==t)throw new Error("degrees is required");return t%360*Math.PI/180}function Pn(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function Tn(t){return!!t&&t.constructor===Object}function Ln(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach((function(t){if(!Pn(t))throw new Error("bbox must only contain numbers")}))}function Mn(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}var Un=function(t,e,i,n){if(!Tn(n=n||{}))throw new Error("options is invalid");var r=n.units,o=n.properties,s=function(t){if(!t)throw new Error("coord is required");if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates;if(Array.isArray(t)&&t.length>=2&&void 0===t[0].length&&void 0===t[1].length)return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")}(t),a=On(s[0]),A=On(s[1]),l=On(i),c=In(e,r),u=Math.asin(Math.sin(A)*Math.cos(c)+Math.cos(A)*Math.sin(c)*Math.cos(l));return En([Fn(a+Math.atan2(Math.sin(l)*Math.sin(c)*Math.cos(A),Math.cos(c)-Math.sin(A)*Math.sin(u))),Fn(u)],o)};var Dn=function(t,e,i){var n=(i=i||{}).steps||64,r=i.properties;if(!t)throw new Error("center is required");if(!e)throw new Error("radius is required");if("object"!=typeof i)throw new Error("options must be an object");if("number"!=typeof n)throw new Error("steps must be a number");n=n||64,r=r||t.properties||{};for(var o=[],s=0;s<n;s++)o.push(Un(t,e,-360*s/n,i).geometry.coordinates);return o.push(o[0]),Sn([o],r)};function Qn(t){var e=t%360;return e<0&&(e+=360),e}var Rn=function(t,e,i,n,r){if(!Tn(r=r||{}))throw new Error("options is invalid");var o=r.steps,s=r.units;if(!t)throw new Error("center is required");if(!e)throw new Error("radius is required");if(null==i)throw new Error("bearing1 is required");if(null==n)throw new Error("bearing2 is required");if("object"!=typeof r)throw new Error("options must be an object");o=o||64;var a=Qn(i),A=Qn(n),l=t.properties;if(a===A)return xn(Dn(t,e,r).geometry.coordinates[0],l);for(var c=a,u=a<A?A:A+360,h=c,p=[],d=0;h<u;)p.push(Un(t,e,h,s).geometry.coordinates),h=c+360*++d/o;return h>u&&p.push(Un(t,e,u,s).geometry.coordinates),xn(p,l)};function Nn(t,e,i){if(null!==t)for(var n,r,o,s,a,A,l,c,u=0,h=0,p=t.type,d="FeatureCollection"===p,f="Feature"===p,g=d?t.features.length:1,m=0;m<g;m++){a=(c=!!(l=d?t.features[m].geometry:f?t.geometry:t)&&"GeometryCollection"===l.type)?l.geometries.length:1;for(var y=0;y<a;y++){var v=0,_=0;if(null!==(s=c?l.geometries[y]:l)){A=s.coordinates;var w=s.type;switch(u=!i||"Polygon"!==w&&"MultiPolygon"!==w?0:1,w){case null:break;case"Point":if(!1===e(A,h,m,v,_))return!1;h++,v++;break;case"LineString":case"MultiPoint":for(n=0;n<A.length;n++){if(!1===e(A[n],h,m,v,_))return!1;h++,"MultiPoint"===w&&v++}"LineString"===w&&v++;break;case"Polygon":case"MultiLineString":for(n=0;n<A.length;n++){for(r=0;r<A[n].length-u;r++){if(!1===e(A[n][r],h,m,v,_))return!1;h++}"MultiLineString"===w&&v++,"Polygon"===w&&_++}"Polygon"===w&&v++;break;case"MultiPolygon":for(n=0;n<A.length;n++){for("MultiPolygon"===w&&(_=0),r=0;r<A[n].length;r++){for(o=0;o<A[n][r].length-u;o++){if(!1===e(A[n][r][o],h,m,v,_))return!1;h++}_++}v++}break;case"GeometryCollection":for(n=0;n<s.geometries.length;n++)if(!1===Nn(s.geometries[n],e,i))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Hn(t){var e=t%360;return e<0&&(e+=360),e}var kn=function(t,e,i,n,r){if(!yn(r=r||{}))throw new Error("options is invalid");if(!t)throw new Error("center is required");if(null==i)throw new Error("bearing1 is required");if(null==n)throw new Error("bearing2 is required");if(!e)throw new Error("radius is required");if("object"!=typeof r)throw new Error("options must be an object");if(Hn(i)===Hn(n))return Cn(t,e,r);var o=function(t){if(!t)throw new Error("coords is required");if("Feature"===t.type&&null!==t.geometry)return t.geometry.coordinates;if(t.coordinates)return t.coordinates;if(Array.isArray(t))return t;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}(t),s=Rn(t,e,i,n,r),a=[[o]];return Nn(s,(function(t){a[0].push(t)})),a[0].push(o),pn(a)},Vn=Object.assign({bearing:ee,buffer:nn,distance:ne,sector:kn,centerOfMass:an,area:Ae,circle:An,bbox:pe,along:re,rhumbDestination:ln},n);function jn(t,e="yyyy-MM-dd HH:mm:ss"){if(!t)return"";const i=new Date(t);let n=e.replace("yyyy",i.getFullYear().toString()).replace("MM",(i.getMonth()+1<10?"0"+(i.getMonth()+1):i.getMonth()+1).toString()).replace("dd",(i.getDate()<10?"0"+i.getDate():i.getDate()).toString()).replace("HH",(i.getHours()<10?"0"+i.getHours():i.getHours()).toString()).replace("mm",(i.getMinutes()<10?"0"+i.getMinutes():i.getMinutes()).toString()).replace("ss",(i.getSeconds()<10?"0"+i.getSeconds():i.getSeconds()).toString()).replace("SSS",String(i.getMilliseconds()).padStart(3,"0"));return n=n.replace("M",(i.getMonth()+1).toString()).replace("d",i.getDate().toString()).replace("H",i.getHours().toString()).replace("m",i.getMinutes().toString()).replace("s",i.getSeconds().toString()),n}function Gn(t,e="HH:mm:ss"){let i=jn(Date.now(),"yyyy-MM-dd 00:00");return i=jn(new Date(i).getTime()+t,e),i}var Kn=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},zn=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};class Wn{static getSector(t){const{center:e,radius:i,bearing1:n,bearing2:r,options:o={},callback:s}=t;o.units&&(o.units={units:o.units});let a=Vn.sector(Vn.point(e),i,n,r,o);return at(a,s),a}static pointToBuffer(t){const{point:e,radius:i,units:n="kilometers",callback:r}=t,o=Vn.circle(e,i,{units:n,steps:128});return at(o,r),o}static lineToBuffer(t){const{polyline:e,radius:i,units:n="kilometers",callback:r}=t,o=Vn.lineString(e),s=Vn.buffer(o,i,{units:n});return at(s,r),s}static distancePoints(t){const{startPoint:e,endPoint:i,units:n="kilometers",callback:r}=t;let o=Vn.point(e),s=Vn.point(i),a=Vn.distance(o,s,{units:n});return at(a,r),a}static bearingPoints(t){const{startPoint:e,endPoint:i,callback:n}=t;let r=Vn.point(e),o=Vn.point(i),s=Vn.bearing(r,o);return s=s>=0?s:s+360,at(s,n),s}static getCenterOfPolygon(t){const{polygon:e,callback:i}=t;let n=e;e[0][0]&&!e[0][0][0]&&(n=[e]);try{let t=Vn.polygon(n),e=Vn.centerOfMass(t);return at(e.geometry.coordinates,i),e.geometry.coordinates}catch(t){}}static pointToRectangle(t){const{point:e,radius:i,units:n="kilometers",callback:r}=t;let o={units:n},s=Vn.point(e),a=Vn.rhumbDestination(s,i,0,o),A=Vn.rhumbDestination(s,i,90,o),l=Vn.rhumbDestination(s,i,180,o),c=Vn.rhumbDestination(s,i,270,o).geometry.coordinates[0],u=A.geometry.coordinates[0],h=l.geometry.coordinates[1],p=a.geometry.coordinates[1],d=[[[c,h],[u,h],[u,p],[c,p],[c,h]]];return at(Vn.polygon(d),r),Vn.polygon(d)}static getPointByRhumbLine(t){const{point:e,bearing:i,distance:n,units:r="kilometers",callback:o}=t;let s={units:r},a=Vn.point(e);const A=Vn.rhumbDestination(a,n,i,s).geometry.coordinates;return at(A,o),A}static getBboxOfPoints(t){const{points:e,callback:i}=t;let n,r=Vn.multiPoint(e),o=Vn.bbox(r);return o&&(n=Vn.polygon([[[o[0],o[3]],[o[2],o[3]],[o[2],o[1]],[o[0],o[1]],[o[0],o[3]]]])),at(n,i),n}static nearestPointOnLine(t){let e=f.Cartesian3.fromDegrees(t.point[0],t.point[1],0),i=f.Cartesian3.fromDegrees(t.line[0][0],t.line[0][1],0),n=f.Cartesian3.fromDegrees(t.line[1][0],t.line[1][1],0),r=f.Cartesian3.subtract(n,i,new f.Cartesian3),o=f.Cartesian3.subtract(e,i,new f.Cartesian3),s=f.Cartesian3.projectVector(o,r,new f.Cartesian3),a=f.Cartesian3.add(i,s,new f.Cartesian3),A=f.Cartographic.fromCartesian(a),l=new I(180*A.longitude/Math.PI,180*A.latitude/Math.PI,A.height);return at(l,t.callback),l}}Kn([R({center:{type:k.Point,required:!0},radius:{type:k.Number,required:!0},bearing1:{type:k.Number,required:!0},bearing2:{type:k.Number,required:!0},callback:{type:k.Function}}),zn("design:type",Function),zn("design:paramtypes",[Object]),zn("design:returntype",void 0)],Wn,"getSector",null),Kn([R({point:{type:k.Point,required:!0},radius:{type:k.Number,required:!0},callback:{type:k.Function}}),zn("design:type",Function),zn("design:paramtypes",[Object]),zn("design:returntype",void 0)],Wn,"pointToBuffer",null),Kn([R({polyline:{type:k.Array,required:!0},radius:{type:k.Number,required:!0},callback:{type:k.Function}}),zn("design:type",Function),zn("design:paramtypes",[Object]),zn("design:returntype",void 0)],Wn,"lineToBuffer",null),Kn([R({startPoint:{type:k.Point,required:!0},endPoint:{type:k.Point,required:!0},callback:{type:k.Function}}),zn("design:type",Function),zn("design:paramtypes",[Object]),zn("design:returntype",void 0)],Wn,"distancePoints",null),Kn([R({startPoint:{type:k.Point,required:!0},endPoint:{type:k.Point,required:!0},callback:{type:k.Function}}),zn("design:type",Function),zn("design:paramtypes",[Object]),zn("design:returntype",void 0)],Wn,"bearingPoints",null),Kn([R({polygon:{type:k.Array,required:!0,validator:t=>{let e=!0;return t[0]&&!t[0][0]&&(e=!1),t[0]&&t[0][0]&&t[0][0][0]&&t[0][0][0][0]&&(e=!1),e},message:"Incorrect Array Format!"},callback:{type:k.Function}}),zn("design:type",Function),zn("design:paramtypes",[Object]),zn("design:returntype",void 0)],Wn,"getCenterOfPolygon",null),Kn([R({point:{type:k.Point,required:!0},radius:{type:k.Number,required:!0},callback:{type:k.Function}}),zn("design:type",Function),zn("design:paramtypes",[Object]),zn("design:returntype",void 0)],Wn,"pointToRectangle",null),Kn([R({point:{type:k.Point,required:!0},bearing:{type:k.Number,required:!0},distance:{type:k.Number,required:!0,validator:t=>t>=0,message:"distance must be greater than 0"},units:{type:k.String},callback:{type:k.Function}}),zn("design:type",Function),zn("design:paramtypes",[Object]),zn("design:returntype",void 0)],Wn,"getPointByRhumbLine",null),Kn([R({points:{type:k.Array,required:!0},callback:{type:k.Function}}),zn("design:type",Function),zn("design:paramtypes",[Object]),zn("design:returntype",void 0)],Wn,"getBboxOfPoints",null),Kn([R({point:{type:k.Point,required:!0},line:{type:k.ArrayPoint,required:!0},callback:{type:k.Function}}),zn("design:type",Function),zn("design:paramtypes",[Object]),zn("design:returntype",void 0)],Wn,"nearestPointOnLine",null);const qn=(t,e,i,n)=>{const r=f.Matrix4.clone(t),o=f.Matrix4.fromTranslation(f.Cartesian3.fromArray(e));f.Matrix4.multiply(r,o,r);const s=f.Matrix4.fromScale(new f.Cartesian3(...n));f.Matrix4.multiply(r,s,r);const a=f.Matrix3.fromRotationX(f.Math.toRadians(i[0])),A=f.Matrix3.fromRotationY(f.Math.toRadians(i[1])),l=f.Matrix3.fromRotationZ(f.Math.toRadians(i[2])),c=f.Matrix4.fromRotationTranslation(a),u=f.Matrix4.fromRotationTranslation(A),h=f.Matrix4.fromRotationTranslation(l);return f.Matrix4.multiply(r,c,r),f.Matrix4.multiply(r,u,r),f.Matrix4.multiply(r,h,r),r};i(49);class Xn{constructor(t,e){this._div=null,this._title=null,this._styleName=e,this.init(t)}init(t){var e=document.createElement("div");e.className="twipsy right";var i=document.createElement("div");i.className=this._styleName||"twipsy-inner",e.appendChild(i),t.appendChild(e),this._div=e,this._title=i}setVisible(t){this._div&&(this._div.style.display=t?"block":"none")}showAt(t,e){t&&e&&(this.setVisible(!0),this._title&&(this._title.innerHTML=e),this._div&&(this._div.style.left=t.x+10+"px",this._div.style.top=t.y-this._div.clientHeight/2+"px"))}destroy(){this._div&&(this._div.parentNode&&this._div.parentNode.removeChild(this._div),this._div=null)}}class Yn{constructor(t){this._id="",this._entity=null,this._positions=[],this._tempPositions=[],this._markers=[],this._dragIconLight="",this._dragIcon="",this._defaultColor={point:"rgba(59,178,208,0.8)",line:"rgba(59,178,208,0.8)",polygon:"rgba(59,178,208,0.8)"},this._layerType="layer",this._drawing=!0,this._status="draw",this._visibleStatus="show",this._isDrawing=!0,this.drawEndInfo={};const{viewer:e,styleName:i=""}=t;this.viewer=e,this._viewer=e.viewer.instance,this._layerEvent=new Cr,this._dragIconLight=e.viewer.mapConfig.distUrl+"Imgs/circle_red.png",this._dragIcon=e.viewer.mapConfig.distUrl+"Imgs/circle_gray.png",this._tooltip=new Xn(this._viewer.container,i),this._drawHandler=new f.ScreenSpaceEventHandler(this.viewer.viewer.containerBox),this._modifyHandler=new f.ScreenSpaceEventHandler(this.viewer.viewer.containerBox),this._dragHandler=new f.ScreenSpaceEventHandler(this.viewer.viewer.containerBox)}startCreate(t){}isSimpleXYZ(t,e){return t.x==e.x&&t.y==e.y&&t.z==e.z}createPoint(t,e,i,n){let r=this._viewer.entities.add({position:t,billboard:{color:f.Color.fromCssColorString("rgba(255,255,255,1.0)"),image:new f.ConstantProperty(this._dragIconLight),heightReference:n?f.HeightReference.CLAMP_TO_GROUND:f.HeightReference.NONE},show:void 0===i||i});return r.oid=e,r.relatedId=this._id,r.flag="anchor",this._markers[e]=r,r}clearAnchors(){let t=this;for(let e in t._markers){let i=t._markers[e];t._viewer.entities.remove(i)}t._markers={}}updateAnchors(t){this._markers.forEach(e=>{e.billboard.heightReference=t?f.HeightReference.CLAMP_TO_GROUND:f.HeightReference.NONE})}togglePointStatus(t){if(t)for(let t in this._markers)Number(t)>-1&&(this._markers[t].show=!0);else for(let t in this._markers)this._markers[t].show=!1}computeCenterPotition(t,e){return f.Cartesian3.midpoint(t,e,new f.Cartesian3)}clearEventHandler(t){"draw"===t?this._drawHandler&&(this._drawHandler.destroy(),this._drawHandler=null):"modify"===t?this._modifyHandler&&(this._modifyHandler.destroy(),this._modifyHandler=null):"drag"===t&&this._dragHandler&&(this._dragHandler.destroy(),this._dragHandler=null)}destroy(){if(this._drawHandler&&(this._drawHandler.destroy(),this._drawHandler=null),this._modifyHandler&&(this._modifyHandler.destroy(),this._modifyHandler=null),this._dragHandler&&(this._dragHandler.destroy(),this._dragHandler=null),this._layerEvent=null,this.viewer.viewer.layerCache.remove(this),this._entity){this._viewer.entities.remove(this._entity)&&(this._entity=null)}this._positions=[],this._tooltip.destroy(),this.clearAnchors(),this._drawing=!1}on(t){const{event:e,handler:i}=t;this._layerEvent&&this._layerEvent.on(e,i,this)}off(t){const{event:e}=t;this._layerEvent&&this._layerEvent.off(e,this)}show(){this._entity&&(this._entity.show=!0),"edit"===this._status&&this.togglePointStatus(!0)}hide(){this._entity&&(this._entity.show=!1),"edit"===this._status&&this.togglePointStatus(!1)}showAnimation(t=1e3,e=0,i){if(this._style.type&&this._style.type===S.COLOR_FLOW)return this._visibleStatus="show",void this.show();if(this._entity){this._entity.show=!0;const n=this.getElements(this._entity);this.animateOpacity(n,-1,t,e,()=>{this._visibleStatus="show",i&&i()})}if("edit"===this._status){const i=this._markers.map(t=>t.billboard);this.animateOpacity(i,-1,t,e)}}hideAnimation(t=1e3,e=0,i){if(this._style.type&&this._style.type===S.COLOR_FLOW)return this._visibleStatus="hide",void this.hide();if(this._entity){const n=this.getElements(this._entity);this.animateOpacity(n,0,t,e,()=>{this._visibleStatus="hide",i&&i()})}if("edit"===this._status){const i=this._markers.map(t=>t.billboard);this.animateOpacity(i,0,t,e)}}animateOpacity(t,e,i,n,r){setTimeout(()=>{let n=[];t.forEach(t=>{let i,r=t.material;i=r?r.image&&void 0!==r.color.alpha?r.color.alpha:r.color.getValue().alpha:t.color.getValue().alpha;let o=0;o=-1===e?"polygon"===t.drawType?f.Color.fromCssColorString(this._style.fillColor).alpha:"polyline"===t.drawType?f.Color.fromCssColorString(this._style.lineColor||this._style.color).alpha:"point"===t.drawType?f.Color.fromCssColorString(this._style.color).alpha:1:e,n.push({startAlpha:i,targetAlpha:o,graphic:t,material:r})});let o=Date.now();const s=()=>{const t=Date.now()-o;if(t>=i)return n.forEach(t=>{const{targetAlpha:e,graphic:i,material:n}=t;if(n){if(n.image&&void 0!==n.color.alpha)n.color.alpha!==e&&(n.color.alpha=e);else if(n.color.getValue().alpha!==e){const t=n.color.getValue().withAlpha(e);n.color.setValue(t)}}else if(i.color.getValue().alpha!==e){const t=i.color.getValue().withAlpha(e);i.color.setValue(t)}}),r&&r(),o=0,void this._viewer.clock.onTick.removeEventListener(s);n.forEach(e=>{const{startAlpha:n,targetAlpha:r,graphic:o,material:s}=e,a=n+t/i*(r-n);if(s)if(s.image&&void 0!==s.color.alpha)s.color.alpha=a;else{const t=s.color.getValue().withAlpha(a);s.color.setValue(t)}else{const t=o.color.getValue().withAlpha(a);o.color.setValue(t)}})};this._viewer.clock.onTick.addEventListener(s)},n)}getElements(t){let e=[];return t.polygon&&(t.polygon.drawType="polygon",e.push(t.polygon)),t.ellipse&&(t.ellipse.drawType="polygon",e.push(t.ellipse)),t.rectangle&&(t.rectangle.drawType="polygon",e.push(t.rectangle)),t.polyline&&(t.polyline.drawType="polyline",e.push(t.polyline)),t.wall&&(t.wall.drawType="polyline",e.push(t.wall)),t.point&&(t.point.drawType="point",e.push(t.point)),e}draggable(){let t,e=!1;this._dragHandler&&this._dragHandler.setInputAction(i=>{const n=this._viewer.scene.camera.getPickRay(i.position);if(n){const r=this._viewer.scene.globe.pick(n,this._viewer.scene),o=this._viewer.scene.pick(i.position);if(Object(f.defined)(o)&&o.id instanceof f.Entity){o.id.id==this._id&&(e=!0,t=r,this._viewer.scene.screenSpaceCameraController.enableRotate=!1)}}},f.ScreenSpaceEventType.LEFT_DOWN),this._dragHandler&&this._dragHandler.setInputAction(i=>{if(e&&t){const e=Y.WindowPositionToCartesian(i.endPosition,this.viewer);if(e){const i=f.Cartesian3.subtract(e,t,new f.Cartesian3);this._tempPositions=this._tempPositions.map(t=>f.Cartesian3.add(t,i,new f.Cartesian3)),this._positions=this._positions.map(t=>f.Cartesian3.add(t,i,new f.Cartesian3)),this._markers.forEach(t=>{var e,n;const r=null===(e=t.position)||void 0===e?void 0:e.getValue(f.JulianDate.now()),o=f.Cartesian3.add(r,i,new f.Cartesian3);null===(n=t.position)||void 0===n||n.setValue(o)}),t=e}}},f.ScreenSpaceEventType.MOUSE_MOVE),this._dragHandler&&this._dragHandler.setInputAction(()=>{e=!1,t=void 0,this._viewer.scene.screenSpaceCameraController.enableRotate=!0},f.ScreenSpaceEventType.LEFT_UP)}disableDrag(){this._dragHandler&&this._dragHandler.removeInputAction(f.ScreenSpaceEventType.LEFT_DOWN),this._dragHandler&&this._dragHandler.removeInputAction(f.ScreenSpaceEventType.MOUSE_MOVE),this._dragHandler&&this._dragHandler.removeInputAction(f.ScreenSpaceEventType.LEFT_UP)}disableModify(){this._modifyHandler&&this._modifyHandler.removeInputAction(f.ScreenSpaceEventType.LEFT_CLICK),this._modifyHandler&&this._modifyHandler.removeInputAction(f.ScreenSpaceEventType.MOUSE_MOVE),this._modifyHandler&&this._modifyHandler.removeInputAction(f.ScreenSpaceEventType.RIGHT_CLICK)}cartesianArrToLngArr(t){return t.map(t=>{const e=Y.CartesianToWGS84(t);return[e.lng,e.lat,e.alt]})}finishEdit(){this._finishEditFn&&this._finishEditFn()}getCartesianByType(t,e){const i=this._viewer.scene.pickPosition(t);if(!i)return Y.WindowPositionToCartesian(t,this.viewer);const n=Y.CartesianToWGS84(i);return n.alt<0?Y.WindowPositionToCartesian(t,this.viewer):e?Y.WGS84ToCartesian(new I(n.lng,n.lat,n.alt+e)):i}}class Jn{constructor(t){this._definitionChanged=new f.Event,this._color=t.color,this._colorSubscription=void 0,this.color=t.color,this.speed=t.speed||3e3,this.image=t.image,this.repeat=t.repeat,this.repeatY=t.repeatY,this.isTranslucent=function(){return!0}}getType(t){return nr.PolylineTrailLinkType}getValue(t,e){return e||(e={}),e.color=this._color||f.Color.WHITE,e.image=this.image,e.repeat=this.repeat||1,e.repeatY=this.repeatY||1,e.speed=this.speed||1,e}equals(t){return this===t||t instanceof Jn&&this._color==t._color}get isConstant(){return!1}get definitionChanged(){return this._definitionChanged}}new f.Color(0,0,0,0);class Zn{constructor(t){this._definitionChanged=new f.Event,this._color=t.color,this._colorSubscription=void 0,this.color=t.color,this.speed=t.speed||1,this.repeat=t.repeat||1,this.brightness=t.brightness||1,this.alpha=t.alpha||1,this.axisY=t.axisY||!0,this.isTranslucent=function(){return!0}}getType(){return nr.ColorFlowType}getValue(t,e){return e||(e={}),e.color=this._color||f.Color.WHITE,e.repeat=this.repeat,e.speed=this.speed,e.brightness=this.brightness,e.alpha=this.alpha,e.axisY=this.axisY,e}equals(t){return this===t||t instanceof Zn&&this._color==t._color}get isConstant(){return!1}get definitionChanged(){return this._definitionChanged}}class $n{constructor(t){this._definitionChanged=new f.Event,this._color=t.color,this._colorSubscription=void 0,this.image=t.image,this.color=t.color,this.speed=t.speed,this.repeat=t.repeat,this.brightness=t.brightness,this.alpha=t.alpha,this.axisY=t.axisY,this.reverse=t.reverse,this.isTranslucent=function(){return!0}}getType(){return nr.ImageFlowType}getValue(t,e){return e||(e={}),e.image=this.image,e.color=this._color,e.repeat=this.repeat,e.speed=this.speed,e.brightness=this.brightness,e.alpha=this.alpha,e.axisY=this.axisY,e.reverse=this.reverse,e}equals(t){return this===t||t instanceof $n&&this._color==t._color}get isConstant(){return!1}get definitionChanged(){return this._definitionChanged}}var tr="czm_material czm_getMaterial(czm_materialInput materialInput) {\r\n    czm_material material = czm_getDefaultMaterial(materialInput);\r\n    material.diffuse = 1.5 * color.rgb;\r\n    vec2 st = materialInput.st;\r\n    vec3 str = materialInput.str;\r\n    float dis = distance(st, vec2(0.5, 0.5));\r\n    float per = fract(czm_frameNumber * time * speed / 1000.0 * 3.14 * 2.0);\r\n    float grad = 1.0 + 10.0 * (1.0 - gradient);\r\n    if(abs(str.z) > 0.001) {\r\n        discard;\r\n    }\r\n    if(dis > 0.5) {\r\n        discard;\r\n    } else {\r\n        float perDis = 0.5 / count;\r\n        float disNum;\r\n        float bl = .0;\r\n        for(int i = 0; i <= 9; i++) {\r\n            if(float(i) <= count) {\r\n                disNum = perDis * float(i) - dis + per / count;\r\n                if(disNum > 0.0) {\r\n                    if(disNum < perDis) {\r\n                        bl = 1.0 - disNum / perDis;\r\n                    } else if(disNum - perDis < perDis) {\r\n                        bl = 1.0 - abs(1.0 - disNum / perDis);\r\n                    }\r\n                    material.alpha = pow(bl, grad);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return material;\r\n}",er="czm_material czm_getMaterial(czm_materialInput materialInput) {\r\n    czm_material material = czm_getDefaultMaterial(materialInput);\r\n    vec2 st = materialInput.st;\r\n    material.diffuse = color.rgb * brightness;\r\n    material.alpha = (1.0 - st.t) * 0.5 * alpha;\r\n    float time = 0.0; \r\n    if(dynamic){\r\n        time = fract(czm_frameNumber * speed / 500.0);\r\n    }\r\n    float powNum = fract((axisY ? st.t : st.s) * repeat - time);\r\n    float midNum = abs(powNum - 0.5) * 3.0;\r\n    material.alpha = pow(material.alpha, midNum) * (1.0 - st.t) * alpha;\r\n    return material;\r\n}",ir="czm_material czm_getMaterial(czm_materialInput materialInput) {\r\n    czm_material material = czm_getDefaultMaterial(materialInput);\r\n    vec2 st = materialInput.st;\r\n    float time = 0.0; \r\n    if(dynamic){\r\n        time = fract(czm_frameNumber * speed / 500.0);\r\n    }\r\n    if (reverse) {\r\n        time *= -1.0;\r\n    }\r\n    vec4 colorImage = texture2D(image, vec2(fract((axisY ? st.t : st.s) * repeat - time), st.t));\r\n    material.alpha = colorImage.a * color.a;\r\n    material.diffuse = colorImage.rgb * color.rgb * brightness;\r\n    \r\n    return material;\r\n}";const nr={PolylineTrailLinkType:"PolylineTrailLink",EllipsoidWaveMaterialType:"EllipsoidWaveMaterialType",ColorFlowType:"ColorFlowType",ImageFlowType:"ImageFlowType"};f.Material._materialCache.addMaterial(nr.PolylineTrailLinkType,{fabric:{type:nr.PolylineTrailLinkType,uniforms:{color:new f.Color(0,0,0,.5),image:"./style3.png",speed:1,repeat:1,repeatY:1},source:"czm_material czm_getMaterial(czm_materialInput materialInput) {\r\n    czm_material material = czm_getDefaultMaterial(materialInput);\r\n    vec2 st = materialInput.st;\r\n    float tempTime = fract(czm_frameNumber * speed / 500.0);\r\n    vec4 colorImage = texture2D(image, vec2(fract(st.s * repeat - tempTime), fract(st.t * repeatY)));\r\n    material.alpha = colorImage.a * color.a;\r\n    material.diffuse = (colorImage.rgb + color.rgb) / 2.0;\r\n    return material;\r\n}"},translucent:function(t){return!0}}),f.Material._materialCache.addMaterial(nr.EllipsoidWaveMaterialType,{fabric:{type:nr.EllipsoidWaveMaterialType,uniforms:{color:new f.Color(1,0,0,1),time:1,count:2,gradient:.1},source:tr},translucent:function(){return!0}}),f.Material._materialCache.addMaterial(nr.ColorFlowType,{fabric:{type:nr.ColorFlowType,uniforms:{dynamic:!0,color:new f.Color(1,0,0,1),repeat:1,speed:1,brightness:1,alpha:1,axisY:!0},source:er},translucent:function(){return!0}}),f.Material._materialCache.addMaterial(nr.ImageFlowType,{fabric:{type:nr.ImageFlowType,uniforms:{dynamic:!0,image:"./style3.png",color:new f.Color(1,0,0,1),repeat:1,speed:1,brightness:1,alpha:1,axisY:!0,reverse:!1},source:ir},translucent:function(){return!0}});const rr={CLICK:f.ScreenSpaceEventType.LEFT_CLICK,RIGHT_CLICK:f.ScreenSpaceEventType.RIGHT_CLICK,DB_CLICK:f.ScreenSpaceEventType.LEFT_DOUBLE_CLICK,MOUSE_MOVE:f.ScreenSpaceEventType.MOUSE_MOVE,WHEEL:f.ScreenSpaceEventType.WHEEL,MOUSE_OVER:"mouseover",MOUSE_OUT:"mouseout"},or={ADD_LAYER:"addLayer",REMOVE_LAYER:"removeLayer",ADD_SIMULATION:"addSimulation",REMOVE_SIMULATION:"removeSimulation",CLICK:f.ScreenSpaceEventType.LEFT_CLICK,RIGHT_CLICK:f.ScreenSpaceEventType.RIGHT_CLICK,DB_CLICK:f.ScreenSpaceEventType.LEFT_DOUBLE_CLICK,MOUSE_MOVE:f.ScreenSpaceEventType.MOUSE_MOVE,WHEEL:f.ScreenSpaceEventType.WHEEL},sr="cameraMoveEnd",ar="cameraChanged",Ar="preRender",lr="postRender",cr="preUpdate",ur="postUpdate",hr="morphComplete",pr="clockTick",dr=(f.ScreenSpaceEventType.LEFT_CLICK,f.ScreenSpaceEventType.RIGHT_CLICK,f.ScreenSpaceEventType.LEFT_DOUBLE_CLICK,f.ScreenSpaceEventType.MOUSE_MOVE,f.ScreenSpaceEventType.WHEEL,f.ScreenSpaceEventType.LEFT_CLICK,f.ScreenSpaceEventType.RIGHT_CLICK,f.ScreenSpaceEventType.LEFT_DOUBLE_CLICK,f.ScreenSpaceEventType.MOUSE_MOVE,f.ScreenSpaceEventType.WHEEL,{CLICK:f.ScreenSpaceEventType.LEFT_CLICK,RIGHT_CLICK:f.ScreenSpaceEventType.RIGHT_CLICK,DB_CLICK:f.ScreenSpaceEventType.LEFT_DOUBLE_CLICK,MOUSE_MOVE:f.ScreenSpaceEventType.MOUSE_MOVE,WHEEL:f.ScreenSpaceEventType.WHEEL,MOUSE_OVER:"mouseover",MOUSE_OUT:"mouseout"}),fr={CLICK:f.ScreenSpaceEventType.LEFT_CLICK,RIGHT_CLICK:f.ScreenSpaceEventType.RIGHT_CLICK,DB_CLICK:f.ScreenSpaceEventType.LEFT_DOUBLE_CLICK,MOUSE_MOVE:f.ScreenSpaceEventType.MOUSE_MOVE,WHEEL:f.ScreenSpaceEventType.WHEEL,MOUSE_OVER:"mouseover",MOUSE_OUT:"mouseout"},gr=(Object.assign(Object.assign({},{ADD:"add",REMOVE:"remove"}),{TICK:"tick",ACTIVE:"active"}),{click:f.ScreenSpaceEventType.LEFT_CLICK,dblclick:f.ScreenSpaceEventType.LEFT_DOUBLE_CLICK,contextmenu:f.ScreenSpaceEventType.RIGHT_CLICK,mousemove:f.ScreenSpaceEventType.MOUSE_MOVE,wheel:f.ScreenSpaceEventType.WHEEL,mouseover:"mouseover",mouseout:"mouseout",cameraChanged:"cameraChanged",cameraMoveEnd:"cameraMoveEnd",keydown:"keydown",keyup:"keyup",preRender:"preRender",postRender:"postRender",preUpdate:"preUpdate",postUpdate:"postUpdate"}),mr={1:class extends Yn{constructor(t){super(t)}startCreate(t){this._style=Object.assign({radius:0,color:this._defaultColor.point,clampToGround:!0,extraHeight:0},t),this._options=t;const{extraHeight:e,callback:i}=this._style;this._drawHandler&&this._drawHandler.setInputAction(t=>{let n=t.position;if(!Object(f.defined)(n))return;n=new f.Cartesian2(n.x/this.viewer.viewer.canvasScale.x,n.y/this.viewer.viewer.canvasScale.y);let r=this.getCartesianByType(n,e);if(!r)return;this._positions[0]=r,this.showPoint2Map(),this._dragHandler&&this._dragHandler.removeInputAction(f.ScreenSpaceEventType.MOUSE_MOVE),this.clearEventHandler("draw"),this._tooltip.setVisible(!1),this.viewer.viewer.layerCache.add(this);let o=Y.CartesianToWGS84(this._positions[0]);at({id:this._id,coordinates:[o.lng,o.lat,o.alt]},i),this._drawing=!1},f.ScreenSpaceEventType.LEFT_CLICK),this._dragHandler&&this._dragHandler.setInputAction(t=>{let e=t.endPosition;e=new f.Cartesian2(e.x/this.viewer.viewer.canvasScale.x,e.y/this.viewer.viewer.canvasScale.y),this._positions.length<1&&this._tooltip.showAt(e,`<p>${st.property("CHOOSE_START")}</p>`)},f.ScreenSpaceEventType.MOUSE_MOVE)}showEdit(t,e){this._id&&(this._updateCallback=t,this._updateEndCallback=e,this.showModifyRegion2Map())}setProperty(t){const e=this._entity,{radius:i,color:n}=this.getStyle(t);e.point.pixelSize=i,e.point.color=n}showPoint2Map(t=!0){const{radius:e,color:i}=this.getStyle();this._entity=this._viewer.entities.add({show:t,position:this._positions[0],point:{pixelSize:e,color:i}}),this._id=this._entity.id}showModifyRegion2Map(){this.bindModifyEvent();let t=this._viewer.entities.getById(this._id);t&&t.point&&(t.point.outlineWidth=new f.ConstantProperty(1),t.point.outlineColor=new f.ConstantProperty(f.Color.WHITE))}bindModifyEvent(){const{extraHeight:t}=this.getStyle();let e=!1;this._modifyHandler&&this._modifyHandler.setInputAction(i=>{if(e)e=!1,this._tooltip.setVisible(!1);else{let n=i.position;if(!Object(f.defined)(n))return;if(n=new f.Cartesian2(n.x/this.viewer.viewer.canvasScale.x,n.y/this.viewer.viewer.canvasScale.y),!this.getCartesianByType(n,t))return;let r=this._viewer.scene.pick(n);if(!Object(f.defined)(r))return;if(!Object(f.defined)(r.id))return;if(r.id.id!=this._id)return;e=!0}let n=Y.CartesianToWGS84(this._positions[0]);at({id:this._id,coordinates:[n.lng,n.lat,n.alt]},this._updateCallback)},f.ScreenSpaceEventType.LEFT_CLICK),this._modifyHandler&&this._modifyHandler.setInputAction(i=>{if(!e)return;let n=i.endPosition;if(!Object(f.defined)(n))return;n=new f.Cartesian2(n.x/this.viewer.viewer.canvasScale.x,n.y/this.viewer.viewer.canvasScale.y);let r=this.getCartesianByType(n,t);r&&(this._positions[0]=r,this._entity&&(this._entity.position=r,this._tooltip.showAt(n,`<p>${st.property("LEFT_STOP_MOVE_AND_RIGHT_STOP_EDIT")}</p>`)))},f.ScreenSpaceEventType.MOUSE_MOVE),this._finishEditFn=()=>{if(e)return;this._entity&&(this._viewer.entities.getById(this._id).point.outlineColor=void 0,this._viewer.entities.getById(this._id).point.outlineWidth=void 0);let t=Y.CartesianToWGS84(this._positions[0]);this._updateEndCallback&&this._updateEndCallback(at({id:this._id,coordinates:[t.lng,t.lat,t.alt]})),this._tooltip.setVisible(!1),this.disableModify()},this._modifyHandler&&this._modifyHandler.setInputAction(t=>{this._finishEditFn()},f.ScreenSpaceEventType.RIGHT_CLICK)}getStyle(t={}){const e=Object.assign(this._style,t),{radius:i,color:n,clampToGround:r,extraHeight:o}=e;return{radius:i,color:f.Color.fromCssColorString(n),clampToGround:r,extraHeight:o}}createByData(t,e,i){const n=new I(e[0],e[1],e[2]),r=Y.WGS84ToCartesian(n);this._positions[0]=r,this.showPoint2Map(t),t||this.hideAnimation(0,0),this.clearEventHandler("draw"),this.viewer.viewer.layerCache.add(this),at({id:this._id,coordinates:e},i),this._drawing=!1}},2:class extends Yn{constructor(t){super(t),this._isModified=!1}startCreate(t){this._style=Object.assign({width:2,texture:"",textureRepeat:20,color:this._defaultColor.line,type:"solid",dynamic:!1,speed:1,reverse:!1,clampToGround:!0,extraHeight:0,classificationType:2},t),this._options=t;const{callback:e,clickFn:i,cancelFn:n}=t,{clampToGround:r,extraHeight:o}=this.getStyle();let s=null;this._drawHandler&&this._drawHandler.setInputAction(t=>{t.position=new f.Cartesian2(t.position.x/this.viewer.viewer.canvasScale.x,t.position.y/this.viewer.viewer.canvasScale.y);let e=this.getCartesianByType(t.position,o);if(!e)return;let n=this._positions.length;0===n&&(this._positions.push(e),s=this.createPoint(e,-1,!1),this.showPolyline2Map()),this._positions.push(e);let r=n-2;this.createPoint(e,r,!1),i&&i()},f.ScreenSpaceEventType.LEFT_CLICK),this._drawHandler&&this._drawHandler.setInputAction(t=>{let e=t.endPosition;if(e=new f.Cartesian2(e.x/this.viewer.viewer.canvasScale.x,e.y/this.viewer.viewer.canvasScale.y),this._positions.length<1)return void this._tooltip.showAt(e,`<p>${st.property("CHOOSE_START")}</p>`);let i=this._positions.length,n=`<p>${st.property("ADD_NEXT_POINT")}</p>`;i>2&&(n+=`<p>${st.property("DOUBLE_CLICK_STOP_DRAW")},${st.property("RIGHT_CLICK_CANCEL_DRAW")}</p>`),this._tooltip.showAt(e,n);let r=this.getCartesianByType(e,o);r&&(s.position.setValue(r),this._positions.pop(),this._positions.push(r))},f.ScreenSpaceEventType.MOUSE_MOVE),this._drawHandler&&this._drawHandler.setInputAction(t=>{if(this._positions.length<2)return;this._positions.pop(),this._positions.pop(),this._viewer.entities.remove(s),this._tooltip.setVisible(!1),this.clearEventHandler("draw"),this.viewer.viewer.layerCache.add(this),this.setFinish();let i=this._positions.map(t=>{let e=Y.CartesianToWGS84(t);return[e.lng,e.lat,e.alt]});at({id:this._id,coordinates:i},e),this._drawing=!1},f.ScreenSpaceEventType.LEFT_DOUBLE_CLICK),this._drawHandler&&this._drawHandler.setInputAction(t=>{n&&n(),this.destroy()},f.ScreenSpaceEventType.RIGHT_CLICK)}showEdit(t,e){"edit"!==this._status&&(this._status="edit",this._updateCallback=t,this._updateEndCallback=e,this._isDrawing=!0,this.showModifyRegion2Map())}createMidPoint(t,e){let i=this._viewer.entities.add({position:t,billboard:{show:!1,color:f.Color.fromCssColorString("rgba(255,255,255,1.0)"),image:new f.ConstantProperty(this._dragIcon)}});return i.oid=e,i.relatedId=this._id,i.flag="mid_anchor",this._markers[e]=i,i}setProperty(t){const e=this._entity,{width:i,material:n,clampToGround:r,classificationType:o}=this.getStyle(t);e.polyline.width=i,e.polyline.material=n,e.polyline.clampToGround=r,e.polyline.classificationType=o,this.updateAnchors(r&&0===o)}showPolyline2Map(t=!0){const{width:e,material:i,clampToGround:n,classificationType:r}=this.getStyle();let o={show:t,polyline:{positions:new f.CallbackProperty(()=>this._isDrawing?this._positions:this.drawEndInfo.positions,!1),clampToGround:n,width:e,material:i,classificationType:r,zIndex:this.viewer.viewer.graphicIndex}};this._entity=this._viewer.entities.add(o),this._id=this._entity.id,this.viewer.viewer.graphicIndex++}showModifyRegion2Map(){const{clampToGround:t,classificationType:e}=this.getStyle();if(this.computeTempPositions(),this.bindModifyEvent(),this.draggable(),this._isModified)this.togglePointStatus(!0);else{let i=this._tempPositions;for(let n=0;n<i.length;n++){0==n%2?this.createPoint(i[n],n,!0,t&&0===e):this.createMidPoint(i[n],n)}}}bindModifyEvent(){const{clampToGround:t,extraHeight:e}=this.getStyle();let i=!1,n=null;this._modifyHandler&&this._modifyHandler.setInputAction(t=>{let r=t.position;if(!Object(f.defined)(r))return;r=new f.Cartesian2(r.x/this.viewer.viewer.canvasScale.x,r.y/this.viewer.viewer.canvasScale.y);let o=this.getCartesianByType(r,e);if(!o)return;if(i){i=!1,n.position.setValue(o);let t=n.oid;this._tempPositions[t]=o,this._tooltip.setVisible(!1),"mid_anchor"==n.flag&&this.updateModifyAnchors(t)}else{let t=this._viewer.scene.pick(r);if(!Object(f.defined)(t))return;if(!Object(f.defined)(t.id))return;let e=t.id;if(e.relatedId!=this._id)return;if("anchor"!=e.flag&&"mid_anchor"!=e.flag)return;n=e,i=!0,"anchor"==e.flag&&this._tooltip.showAt(r,`<p>${st.property("MOVE_CONTROL_POINT")}</p>`),"mid_anchor"==e.flag&&this._tooltip.showAt(r,`<p>${st.property("MOVE_ADD_NEW_CONTROL_POINT")}</p>`)}this.updatePostions();const s=this.cartesianArrToLngArr(this._positions);at({id:this._id,coordinates:s},this._updateCallback)},f.ScreenSpaceEventType.LEFT_CLICK),this._modifyHandler&&this._modifyHandler.setInputAction(t=>{if(!i)return;let r=t.endPosition;if(!Object(f.defined)(r))return;r=new f.Cartesian2(r.x/this.viewer.viewer.canvasScale.x,r.y/this.viewer.viewer.canvasScale.y),this._tooltip.showAt(r,`<p>${st.property("MOVE_CONTROL_POINT")}</p><p>${st.property("LEFT_STOP_MOVE_AND_RIGHT_STOP_EDIT")}</p>`);let o=this.getCartesianByType(r,e);if(!Object(f.defined)(o))return;let s=n.oid;"anchor"==n.flag?(n.position.setValue(o),this._tempPositions[s]=o,this.updateNewMidAnchors(s)):"mid_anchor"==n.flag&&(n.position.setValue(o),this._tempPositions[s]=o),this.updatePostions()},f.ScreenSpaceEventType.MOUSE_MOVE),this._finishEditFn=()=>{if(i)return;this.togglePointStatus(!1),this._isModified=!0;const t=this.cartesianArrToLngArr(this._positions);at({id:this._id,coordinates:t},this._updateEndCallback),this._tempPositions=[],this.disableDrag(),this.disableModify(),this.setFinish(),this._status="draw"},this._modifyHandler&&this._modifyHandler.setInputAction(t=>{this._finishEditFn()},f.ScreenSpaceEventType.RIGHT_CLICK)}updateNewMidAnchors(t){let e=this;if(null==t||null==t)return;let i=null,n=null,r=null,o=null,s=e._tempPositions.length;0==t?(i=s-2,n=s-1,r=t+1,o=t+2):t==s-2?(i=t-2,n=t-1,r=s-1,o=0):(i=t-2,n=t-1,r=t+1,o=t+2);let a=e._tempPositions[i],A=e._tempPositions[t],l=e._tempPositions[o];if(0==t){let t=e.computeCenterPotition(l,A);e._tempPositions[r]=t,e._markers[r].position.setValue(t)}else if(t==s-1){let t=e.computeCenterPotition(a,A);e._tempPositions[n]=t,e._markers[n].position.setValue(t)}else{let t=e.computeCenterPotition(a,A),i=e.computeCenterPotition(l,A);e._tempPositions[n]=t,e._tempPositions[r]=i,e._markers[n].position.setValue(t),e._markers[r].position.setValue(i)}}updateModifyAnchors(t){let e=this,i=e._tempPositions.length;if(0==t||t==i-1)return;let n=e._tempPositions[t],r=e._tempPositions[t-1],o=e._tempPositions[t+1],s=e.computeCenterPotition(r,n),a=e.computeCenterPotition(n,o);e._tempPositions.splice(t,1,s,n,a),e.clearAnchors();let A=e._tempPositions;for(let t=0;t<A.length;t++){0==t%2?e.createPoint(A[t],t,!0):e.createMidPoint(A[t],t)}}updatePostions(){let t=this._tempPositions;this._positions=t.filter((t,e)=>e%2==0)}getPositionArr(){return this._positions.map(t=>{let e=Y.CartesianToWGS84(t);return[e.lng,e.lat]})}computeTempPositions(){let t=this._positions,e=t.length;for(let i=1;i<e;i++){let e=t[i-1],n=t[i],r=this.computeCenterPotition(e,n);this._tempPositions.push(e),this._tempPositions.push(r)}let i=t[e-1];this._tempPositions.push(i)}getStyle(t={}){const e=Object.assign(this._style,t),{width:i,type:n,color:r,texture:o,textureRepeat:s,dynamic:a,speed:A,reverse:l,clampToGround:c,extraHeight:u,classificationType:h}=e;let p;return o?p=new $n({image:o,color:f.Color.fromCssColorString("#fff"),repeat:s,speed:0,brightness:1,alpha:1,axisY:!1}):n&&(p="dashed"===n?new f.PolylineDashMaterialProperty({color:f.Color.fromCssColorString(r)}):f.Color.fromCssColorString(r)),a&&o&&(p=new $n({image:o,color:f.Color.fromCssColorString(r),repeat:s,speed:A,brightness:1,alpha:1,axisY:!1,reverse:l})),{width:i,material:p,clampToGround:c,extraHeight:u,classificationType:h}}createByData(t,e,i){const n=e.map(t=>new I(t[0],t[1],t[2])),r=Y.WGS84ArrToCartesianArr(n);this._positions=r,this.showPolyline2Map(t),t||this.hideAnimation(0,0),this.clearEventHandler("draw"),this._drawing=!1,this.setFinish(),this.viewer.viewer.layerCache.add(this),at({id:this._id,coordinates:e},i)}setFinish(){const t=this._positions;this._isDrawing=!1,this.drawEndInfo={positions:t}}},3:class extends Yn{constructor(t){super(t),this._isModified=!1}startCreate(t){this._style=Object.assign({lineWidth:0,lineColor:this._defaultColor.line,lineType:"solid",fillColor:this._defaultColor.polygon,texture:"",textureRepeat:[20,20],clampToGround:!0,extraHeight:0,classificationType:2},t),this._options=t;const{callback:e,clickFn:i,cancelFn:n,compat:r=!1}=t,{extraHeight:o}=this.getStyle();let s=null;this._drawHandler&&this._drawHandler.setInputAction(t=>{t.position=new f.Cartesian2(t.position.x/this.viewer.viewer.canvasScale.x,t.position.y/this.viewer.viewer.canvasScale.y);let e=this.getCartesianByType(t.position,o);if(!e)return;0===this._positions.length&&(this._positions.push(e),s=this.createPoint(e,-1,!1),this.showRegion2Map()),this._positions.push(e);let n=this._positions.length-2;this.createPoint(e,n,!1),i&&i()},f.ScreenSpaceEventType.LEFT_CLICK),this._drawHandler&&this._drawHandler.setInputAction(t=>{let e=t.endPosition;if(!s)return void this._tooltip.showAt(e,`<p>${st.property("CHOOSE_START")}</p>`);if(!e)return;e=new f.Cartesian2(e.x/this.viewer.viewer.canvasScale.x,e.y/this.viewer.viewer.canvasScale.y);let i=this._positions.length,n=`<p>${st.property("ADD_NEXT_POINT")}</p>`;i>2&&(n+=`<p>${st.property("DOUBLE_CLICK_STOP_DRAW")},${st.property("RIGHT_CLICK_CANCEL_DRAW")}</p>`),this._tooltip.showAt(e,n);let r=this.getCartesianByType(e,o);r&&(s.position.setValue(r),this._positions.pop(),this._positions.push(r))},f.ScreenSpaceEventType.MOUSE_MOVE),this._drawHandler&&this._drawHandler.setInputAction(t=>{if(this._positions.length<5)return;this._positions.pop(),this._positions.pop(),this._viewer.entities.remove(s),this._tooltip.setVisible(!1),this.clearEventHandler("draw"),this.viewer.viewer.layerCache.add(this),this.setFinish();let i=[...this._positions];i.push(this._positions[0]);const n=i.map(t=>{const e=Y.CartesianToWGS84(t);return[e.lng,e.lat,e.alt]});at({id:this._id,coordinates:r?[n]:n},e),this._drawing=!1},f.ScreenSpaceEventType.LEFT_DOUBLE_CLICK),this._drawHandler&&this._drawHandler.setInputAction(t=>{n&&n(),this.destroy()},f.ScreenSpaceEventType.RIGHT_CLICK)}showEdit(t,e){"edit"!==this._status&&(this._status="edit",this._updateCallback=t,this._updateEndCallback=e,this._isDrawing=!0,this.showModifyRegion2Map())}createMidPoint(t,e){let i=this._viewer.entities.add({position:t,billboard:{show:!1,color:f.Color.fromCssColorString("rgba(255,255,255,1.0)"),image:new f.ConstantProperty(this._dragIcon)}});return i.oid=e,i.relatedId=this._id,i.flag="mid_anchor",this._markers[e]=i,i}setProperty(t){const e=this._entity,{fillMaterial:i,lineWidth:n,lineMaterial:r,clampToGround:o,classificationType:s}=this.getStyle(t);e.polygon.material=i,e.polygon.perPositionHeight=!o,e.polygon.classificationType=s,e.polyline.width=n,e.polyline.material=r,e.polyline.clampToGround=o,e.polyline.classificationType=s,this.updateAnchors(o&&0===s)}showRegion2Map(t=!0){const{fillMaterial:e,lineWidth:i,lineMaterial:n,clampToGround:r,classificationType:o}=this.getStyle();let s=new f.CallbackProperty(()=>{if(!this._isDrawing)return this.drawEndInfo.pHierarchy;if(this._tempPositions.length){if(this._tempPositions.length>2){const t=Object(g.cloneDeep)(this._tempPositions);return new f.PolygonHierarchy(t)}return null}if(this._positions.length>2){const t=Object(g.cloneDeep)(this._positions);return new f.PolygonHierarchy(t)}return null},!1),a=new f.CallbackProperty(()=>{if(!this._isDrawing)return this.drawEndInfo.positions;if(this._tempPositions.length){if(this._tempPositions.length>=2){let t=[...this._tempPositions];return t.push(this._tempPositions[0]),t}return null}if(this._positions.length>=2){let t=[...this._positions];return t.push(this._positions[0]),t}return null},!1),A={show:t,polygon:new f.PolygonGraphics({hierarchy:s,material:e,zIndex:this.viewer.viewer.graphicIndex,perPositionHeight:!r,classificationType:o}),polyline:{positions:a,width:i,material:n,clampToGround:r,classificationType:o,zIndex:this.viewer.viewer.graphicIndex}};this._entity=this._viewer.entities.add(A),this._id=this._entity.id,this.viewer.viewer.graphicIndex++}showModifyRegion2Map(){const{clampToGround:t,classificationType:e}=this.getStyle();let i=this;if(i.computeTempPositions(),i.bindModifyEvent(),this.draggable(),i._isModified)i.togglePointStatus(!0);else{let n=i._tempPositions;for(let r=0;r<n.length;r++){0==r%2?i.createPoint(n[r],r,!0,t&&0===e):i.createMidPoint(n[r],r)}}}bindModifyEvent(){const{extraHeight:t}=this.getStyle();let e=this,i=!1,n=null;const{compat:r=!1}=this._options;e._modifyHandler&&e._modifyHandler.setInputAction(o=>{let s=o.position;if(!Object(f.defined)(s))return;s=new f.Cartesian2(s.x/this.viewer.viewer.canvasScale.x,s.y/this.viewer.viewer.canvasScale.y);let a=this.getCartesianByType(s,t);if(!a)return;if(i){i=!1,n.position.setValue(a);let t=n.oid;e._tempPositions[t]=a,e._tooltip.setVisible(!1),"mid_anchor"==n.flag&&e.updateModifyAnchors(t)}else{let t=e._viewer.scene.pick(s);if(!Object(f.defined)(t))return;if(!Object(f.defined)(t.id))return;let r=t.id;if(r.relatedId!=e._id)return;if("anchor"!=r.flag&&"mid_anchor"!=r.flag)return;n=r,i=!0,"anchor"==r.flag&&e._tooltip.showAt(s,`<p>${st.property("MOVE_CONTROL_POINT")}</p>`),"mid_anchor"==r.flag&&e._tooltip.showAt(s,`<p>${st.property("MOVE_ADD_NEW_CONTROL_POINT")}</p>`)}e.updatePostions();let A=[...this._positions];A.push(this._positions[0]);const l=this.cartesianArrToLngArr(A);at({id:this._id,coordinates:r?[l]:l},this._updateCallback)},f.ScreenSpaceEventType.LEFT_CLICK),e._modifyHandler&&e._modifyHandler.setInputAction(r=>{if(!i)return;let o=r.endPosition;if(!Object(f.defined)(o))return;o=new f.Cartesian2(o.x/this.viewer.viewer.canvasScale.x,o.y/this.viewer.viewer.canvasScale.y),e._tooltip.showAt(o,`<p>${st.property("MOVE_CONTROL_POINT")}</p><p>${st.property("LEFT_STOP_MOVE_AND_RIGHT_STOP_EDIT")}</p>`);let s=this.getCartesianByType(o,t);if(!s)return;let a=n.oid;"anchor"==n.flag?(n.position.setValue(s),e._tempPositions[a]=s,e.updateNewMidAnchors(a)):"mid_anchor"==n.flag&&(n.position.setValue(s),e._tempPositions[a]=s),e.updatePostions()},f.ScreenSpaceEventType.MOUSE_MOVE),this._finishEditFn=()=>{if(i)return;e.togglePointStatus(!1),e._isModified=!0;let t=[...this._positions];t.push(this._positions[0]);const n=this.cartesianArrToLngArr(t);at({id:this._id,coordinates:r?[n]:n},this._updateEndCallback),e._tempPositions=[],this.disableDrag(),this.disableModify(),this.setFinish(),this._status="draw"},e._modifyHandler&&e._modifyHandler.setInputAction(t=>{this._finishEditFn()},f.ScreenSpaceEventType.RIGHT_CLICK)}updateNewMidAnchors(t){if(null==t||null==t)return;let e=null,i=null,n=null,r=null,o=this._tempPositions.length;0==t?(e=o-2,i=o-1,n=t+1,r=t+2):t==o-2?(e=t-2,i=t-1,n=o-1,r=0):(e=t-2,i=t-1,n=t+1,r=t+2);let s=this._tempPositions[e],a=this._tempPositions[t],A=this._tempPositions[r],l=this.computeCenterPotition(s,a),c=this.computeCenterPotition(A,a);this._tempPositions[i]=l,this._tempPositions[n]=c,this._markers[i].position.setValue(l),this._markers[n].position.setValue(c)}updatePostions(){let t=this._tempPositions;this._positions=t.filter((t,e)=>e%2==0)}computeTempPositions(){let t=this._positions,e=t.length,i=t[0],n=t[e-1];0==this.isSimpleXYZ(i,n)&&(t.push(i),e+=1);for(let i=1;i<e;i++){let e=t[i-1],n=t[i],r=this.computeCenterPotition(e,n);this._tempPositions.push(e),this._tempPositions.push(r)}}updateModifyAnchors(t){let e=this,i=e._tempPositions[t],n=null,r=null,o=e._tempPositions.length;0==t?(n=e._tempPositions[o-1],r=e._tempPositions[t+1]):t==o-1?(n=e._tempPositions[t-1],r=e._tempPositions[0]):(n=e._tempPositions[t-1],r=e._tempPositions[t+1]);let s=e.computeCenterPotition(n,i),a=e.computeCenterPotition(i,r);e._tempPositions.splice(t,1,s,i,a),e.clearAnchors();let A=e._tempPositions;for(let t=0;t<A.length;t++){0==t%2?e.createPoint(A[t],t,!0):e.createMidPoint(A[t],t)}}getPositionArr(){return this._positions.map(t=>{let e=Y.CartesianToWGS84(t);return[e.lng,e.lat]})}getStyle(t={}){const e=Object.assign(this._style,t),{lineWidth:i,lineType:n,lineColor:r,fillColor:o,texture:s,textureRepeat:a,clampToGround:A,extraHeight:l,classificationType:c}=e;let u;u=s?new f.ImageMaterialProperty({image:s,color:f.Color.fromCssColorString("#fff"),repeat:new f.Cartesian2(...a),transparent:!0}):f.Color.fromCssColorString(o);return{fillMaterial:u,lineMaterial:"dashed"===n?new f.PolylineDashMaterialProperty({color:f.Color.fromCssColorString(r)}):f.Color.fromCssColorString(r),lineWidth:i,clampToGround:A,extraHeight:l,classificationType:c}}createByData(t,e,i){const n=e.map(t=>new I(t[0],t[1],t[2]));n.pop();const r=Y.WGS84ArrToCartesianArr(n);this._positions=r,this.showRegion2Map(t),t||this.hideAnimation(0,0),this.clearEventHandler("draw"),this._drawing=!1,this.setFinish(),this.viewer.viewer.layerCache.add(this),at({id:this._id,coordinates:e},i)}setFinish(){const t=new f.PolygonHierarchy(this._positions);let e=[...this._positions];e.push(this._positions[0]),this._isDrawing=!1,this.drawEndInfo={pHierarchy:t,positions:e}}},4:class extends Yn{constructor(t){super(t),this._isModified=!1}startCreate(t){this._style=Object.assign({lineWidth:0,lineColor:this._defaultColor.line,lineType:"solid",fillColor:this._defaultColor.polygon,texture:"",textureRepeat:[20,20],clampToGround:!0,extraHeight:0,classificationType:2},t),this._options=t;const{callback:e,compat:i=!1}=t,{extraHeight:n}=this.getStyle();this._drawHandler&&this._drawHandler.setInputAction(t=>{t.position=new f.Cartesian2(t.position.x/this.viewer.viewer.canvasScale.x,t.position.y/this.viewer.viewer.canvasScale.y);let e=this.getCartesianByType(t.position,n);e&&0===this._positions.length&&(this._positions.push(e),this._positions.push(e),this.showRegion2Map())},f.ScreenSpaceEventType.LEFT_CLICK),this._drawHandler&&this._drawHandler.setInputAction(t=>{let e=t.endPosition;if(e=new f.Cartesian2(e.x/this.viewer.viewer.canvasScale.x,e.y/this.viewer.viewer.canvasScale.y),this._positions.length<1)return void this._tooltip.showAt(e,`<p>${st.property("CHOOSE_START")}</p>`);this._tooltip.showAt(e,`<p>${st.property("CHOOSE_END")}</p><p>${st.property("DOUBLE_CLICK_STOP_DRAW")},${st.property("RIGHT_CLICK_CANCEL_DRAW")}</p>`);let i=this.getCartesianByType(e,n);i&&(this._positions.pop(),this._positions.push(i))},f.ScreenSpaceEventType.MOUSE_MOVE),this._drawHandler&&this._drawHandler.setInputAction(t=>{t.position=new f.Cartesian2(t.position.x/this.viewer.viewer.canvasScale.x,t.position.y/this.viewer.viewer.canvasScale.y);let r=this.getCartesianByType(t.position,n);if(!r)return;this._tooltip.setVisible(!1),this.clearEventHandler("draw"),this._positions.pop(),this._positions.push(r),this.viewer.viewer.layerCache.add(this);let o=this._positions.map(t=>{let e=Y.CartesianToWGS84(t);return[e.lng,e.lat,e.alt]});const s=[o[0],[o[1][0],o[0][1],o[0][2]],[o[1][0],o[1][1],o[0][2]],[o[0][0],o[1][1],o[0][2]],o[0]];this.setFinish(),at({id:this._id,coordinates:i?[s]:s},e),this._drawing=!1},f.ScreenSpaceEventType.LEFT_DOUBLE_CLICK),this._drawHandler&&this._drawHandler.setInputAction(t=>{this.destroy()},f.ScreenSpaceEventType.RIGHT_CLICK)}showEdit(t,e){"edit"!==this._status&&(this._status="edit",this._updateCallback=t,this._updateEndCallback=e,this._isDrawing=!0,this.showModifyRegion2Map())}setProperty(t){const e=this._entity,{fillMaterial:i,lineWidth:n,lineMaterial:r,clampToGround:o,classificationType:s}=this.getStyle(t);e.rectangle.material=i,e.rectangle.classificationType=s,e.polyline.width=n,e.polyline.material=r,e.polyline.classificationType=s,this.updateAnchors(o&&0===s)}showRegion2Map(t=!0){const{fillMaterial:e,lineWidth:i,lineMaterial:n,clampToGround:r,classificationType:o}=this.getStyle();let s=new f.CallbackProperty(()=>this._isDrawing?2===this._positions.length?f.Rectangle.fromCartesianArray(this._positions):null:this.drawEndInfo.coordinates,!1);const a=new f.CallbackProperty(()=>{if(!this._isDrawing)return this.drawEndInfo.height;if(this._positions.length){return Y.CartesianToWGS84(this._positions[0]).alt}},!1);let A=new f.CallbackProperty(()=>{if(!this._isDrawing)return this.drawEndInfo.linePositions;if(this._positions.length>=2){const t=Y.CartesianToWGS84(this._positions[0]),e=Y.CartesianToWGS84(this._positions[1]),i=Wn.getBboxOfPoints({points:[[t.lng,t.lat],[e.lng,e.lat]]}).geometry.coordinates[0].map(e=>new I(...e,t.alt));return Y.WGS84ArrToCartesianArr(i)}return null},!1),l={show:t,rectangle:new f.RectangleGraphics({coordinates:s,material:e,zIndex:this.viewer.viewer.graphicIndex,height:r?void 0:a,classificationType:o}),polyline:{positions:A,width:i,material:n,clampToGround:r,classificationType:o,zIndex:this.viewer.viewer.graphicIndex}};this._entity=this._viewer.entities.add(l),this._id=this._entity.id,this.viewer.viewer.graphicIndex++}showModifyRegion2Map(){const{clampToGround:t,classificationType:e}=this.getStyle();this.bindModifyEvent(),this.draggable(),this._isModified?this.togglePointStatus(!0):this._positions.forEach((i,n)=>{this.createPoint(i,n,!0,t&&0===e)})}bindModifyEvent(){const{extraHeight:t}=this.getStyle();let e=this,i=!1,n=null;const{compat:r=!1}=this._options;e._modifyHandler&&e._modifyHandler.setInputAction(o=>{let s=o.position;if(!Object(f.defined)(s))return;s=new f.Cartesian2(s.x/this.viewer.viewer.canvasScale.x,s.y/this.viewer.viewer.canvasScale.y);let a=this.getCartesianByType(s,t);if(!a)return;if(i){i=!1,n.position.setValue(a);let t=n.oid;e._positions[t]=a,e._tooltip.setVisible(!1)}else{let t=e._viewer.scene.pick(s);if(!Object(f.defined)(t))return;if(!Object(f.defined)(t.id))return;let r=t.id;if(r.relatedId!=e._id)return;if("anchor"!=r.flag)return;n=r,i=!0,"anchor"==r.flag&&e._tooltip.showAt(s,`<p>${st.property("MOVE_CONTROL_POINT")}</p>`)}let A=this.cartesianArrToLngArr(this._positions);const l=[A[0],[A[1][0],A[0][1],A[0][2]],[A[1][0],A[1][1],A[0][2]],[A[0][0],A[1][1],A[0][2]],A[0]];at({id:this._id,coordinates:r?[l]:l},this._updateCallback)},f.ScreenSpaceEventType.LEFT_CLICK),e._modifyHandler&&e._modifyHandler.setInputAction(r=>{if(!i)return;let o=r.endPosition;if(!Object(f.defined)(o))return;o=new f.Cartesian2(o.x/this.viewer.viewer.canvasScale.x,o.y/this.viewer.viewer.canvasScale.y),e._tooltip.showAt(o,`<p>${st.property("MOVE_CONTROL_POINT")}</p><p>${st.property("LEFT_STOP_MOVE_AND_RIGHT_STOP_EDIT")}</p>`);let s=this.getCartesianByType(o,t);if(!s)return;let a=n.oid;"anchor"==n.flag&&(n.position.setValue(s),e._positions[a]=s)},f.ScreenSpaceEventType.MOUSE_MOVE),this._finishEditFn=()=>{if(i)return;e.togglePointStatus(!1),e._isModified=!0;let t=this._positions.map(t=>{let e=Y.CartesianToWGS84(t);return[e.lng,e.lat,e.alt]});const n=[t[0],[t[1][0],t[0][1],t[0][2]],[t[1][0],t[1][1],t[0][2]],[t[0][0],t[1][1],t[0][2]],t[0]];at({id:this._id,coordinates:r?[n]:n},this._updateEndCallback),this.disableDrag(),this.disableModify(),this.setFinish(),this._status="draw"},e._modifyHandler&&e._modifyHandler.setInputAction(t=>{this._finishEditFn()},f.ScreenSpaceEventType.RIGHT_CLICK)}getStyle(t={}){const e=Object.assign(this._style,t),{lineWidth:i,lineType:n,lineColor:r,fillColor:o,texture:s,textureRepeat:a,clampToGround:A,extraHeight:l,classificationType:c}=e;let u;u=s?new f.ImageMaterialProperty({image:s,color:f.Color.fromCssColorString("#fff"),repeat:new f.Cartesian2(...a),transparent:!0}):f.Color.fromCssColorString(o);return{fillMaterial:u,lineMaterial:"dashed"===n?new f.PolylineDashMaterialProperty({color:f.Color.fromCssColorString(r)}):f.Color.fromCssColorString(r),lineWidth:i,clampToGround:A,extraHeight:l,classificationType:c}}createByData(t,e,i){const n=e.filter((t,e)=>0===e||2===e).map(t=>new I(t[0],t[1],t[2])),r=Y.WGS84ArrToCartesianArr(n);this._positions=r,this.showRegion2Map(t),t||this.hideAnimation(0,0),this.clearEventHandler("draw"),this._drawing=!1,this.setFinish(),this.viewer.viewer.layerCache.add(this),at({id:this._id,coordinates:e},i)}setFinish(){const t=f.Rectangle.fromCartesianArray(this._positions),e=Y.CartesianToWGS84(this._positions[0]).alt,i=Y.CartesianToWGS84(this._positions[0]),n=Y.CartesianToWGS84(this._positions[1]),r=Wn.getBboxOfPoints({points:[[i.lng,i.lat],[n.lng,n.lat]]}).geometry.coordinates[0].map(t=>new I(...t,i.alt)),o=Y.WGS84ArrToCartesianArr(r);this._isDrawing=!1,this.drawEndInfo={coordinates:t,height:e,linePositions:o}}},5:class extends Yn{constructor(t){super(t),this._isModified=!1,this.type=""}startCreate(t){this._style=Object.assign({lineWidth:0,lineColor:this._defaultColor.line,lineType:"solid",fillColor:this._defaultColor.polygon,showRadius:!0},t),this._options=t,this.type=t.type||x.SINGLEARROW;const{callback:e,compat:i=!1}=t;this._drawHandler&&this._drawHandler.setInputAction(t=>{t.position=new f.Cartesian2(t.position.x/this.viewer.viewer.canvasScale.x,t.position.y/this.viewer.viewer.canvasScale.y);let e=Y.WindowPositionToCartesian(t.position,this.viewer);if(!e)return;let i=this._positions.length;0===i&&(this._positions.push(e),this.showRegion2Map()),this._positions.push(e),i>1&&(this._positions.pop(),this._tooltip.setVisible(!1))},f.ScreenSpaceEventType.LEFT_CLICK),this._drawHandler&&this._drawHandler.setInputAction(t=>{let e=t.endPosition;if(!e)return;if(e=new f.Cartesian2(e.x/this.viewer.viewer.canvasScale.x,e.y/this.viewer.viewer.canvasScale.y),this._positions.length<1)return void this._tooltip.showAt(e,`<p>${st.property("CHOOSE_START")}</p>`);this._tooltip.showAt(e,`<p>${st.property("CHOOSE_END")},${st.property("DOUBLE_CLICK_STOP_DRAW")}</p>`);let i=Y.WindowPositionToCartesian(e,this.viewer);i&&(this._positions.pop(),this._positions.push(i))},f.ScreenSpaceEventType.MOUSE_MOVE),this._drawHandler&&this._drawHandler.setInputAction(t=>{if(this._positions.length<2)return;this._tooltip.setVisible(!1),this.clearEventHandler("draw");let n,r=Y.CartesianToWindowPosition(this._positions[0],this.viewer),o=Y.CartesianToWindowPosition(this._positions[1],this.viewer);n=this.type==x.DOUBLEARROW?this.getDoubleArrowVertex(r,o):this.getArrowVertex(r,o);let s=n.map(t=>{let e=Y.CartesianToWGS84(t);return[e.lng,e.lat,0]});this.viewer.viewer.layerCache.add(this),at({id:this._id,coordinates:i?[s]:s},e),this._drawing=!1},f.ScreenSpaceEventType.LEFT_DOUBLE_CLICK),this._drawHandler&&this._drawHandler.setInputAction(t=>{this.destroy()},f.ScreenSpaceEventType.RIGHT_CLICK)}showEdit(t,e){"edit"!==this._status&&(this._status="edit",this._updateCallback=t,this._updateEndCallback=e,this.showModifyRegion2Map())}setProperty(t){const e=this._entity,{fillMaterial:i,lineWidth:n,lineMaterial:r}=this.getStyle(t);e.polygon.material=i,e.polyline.width=n,e.polyline.material=r}showRegion2Map(){const{fillMaterial:t,lineWidth:e,lineMaterial:i}=this.getStyle();let n=this,r=new f.CallbackProperty(()=>{if(n._positions.length>1){let t,e=Y.CartesianToWindowPosition(n._positions[0],this.viewer),i=Y.CartesianToWindowPosition(n._positions[1],this.viewer);if(n.isSimpleXYZ(n._positions[0],n._positions[1]))return null;if(t=this.type==x.DOUBLEARROW?this.getDoubleArrowVertex(e,i):this.getArrowVertex(e,i),t){return new f.PolygonHierarchy(t)}return null}return null},!1),o=new f.CallbackProperty(()=>{if(n._positions.length>1){let t,e=Y.CartesianToWindowPosition(n._positions[0],this.viewer),i=Y.CartesianToWindowPosition(n._positions[1],this.viewer);return n.isSimpleXYZ(n._positions[0],n._positions[1])?null:(t=this.type==x.DOUBLEARROW?this.getDoubleArrowVertex(e,i):this.getArrowVertex(e,i),t||null)}return null},!1),s={polygon:new f.PolygonGraphics({hierarchy:r,material:t,zIndex:this.viewer.viewer.graphicIndex}),polyline:{positions:o,width:e,material:i,clampToGround:!0,zIndex:this.viewer.viewer.graphicIndex}};n._entity=n._viewer.entities.add(s),n._id=n._entity.id,this.viewer.viewer.graphicIndex++}showModifyRegion2Map(){let t=this;t.bindModifyEvent(),t.draggable(),t._isModified?t.togglePointStatus(!0):this._positions.forEach((t,e)=>{this.createPoint(t,e,!0)})}bindModifyEvent(){let t=this,e=!1,i=null;const{compat:n=!1}=this._options;t._modifyHandler&&t._modifyHandler.setInputAction(r=>{let o=r.position;if(!Object(f.defined)(o))return;o=new f.Cartesian2(o.x/this.viewer.viewer.canvasScale.x,o.y/this.viewer.viewer.canvasScale.y);let s=Y.WindowPositionToCartesian(r.position,this.viewer);if(!s)return;if(e){e=!1,i.position.setValue(s);let n=i.oid;t._positions[n]=s,t._tooltip.setVisible(!1)}else{let n=t._viewer.scene.pick(o);if(!Object(f.defined)(n))return;if(!Object(f.defined)(n.id))return;let r=n.id;if(r.relatedId!=t._id)return;if("anchor"!=r.flag)return;i=r,e=!0,"anchor"==r.flag&&t._tooltip.showAt(o,`<p>${st.property("MOVE_CONTROL_POINT")}</p>`)}let a,A=Y.CartesianToWindowPosition(t._positions[0],this.viewer),l=Y.CartesianToWindowPosition(t._positions[1],this.viewer);a=this.type==x.DOUBLEARROW?this.getDoubleArrowVertex(A,l):this.getArrowVertex(A,l);let c=a.map(t=>{let e=Y.CartesianToWGS84(t);return[e.lng,e.lat,0]});at({id:this._id,coordinates:n?[c]:c},this._updateCallback)},f.ScreenSpaceEventType.LEFT_CLICK),t._modifyHandler&&t._modifyHandler.setInputAction(n=>{if(!e)return;let r=n.endPosition;if(!Object(f.defined)(r))return;r=new f.Cartesian2(r.x/this.viewer.viewer.canvasScale.x,r.y/this.viewer.viewer.canvasScale.y),t._tooltip.showAt(r,`<p>${st.property("MOVE_CONTROL_POINT")}</p><p>${st.property("LEFT_STOP_MOVE_AND_RIGHT_STOP_EDIT")}</p>`);let o=Y.WindowPositionToCartesian(r,this.viewer);if(!o)return;let s=i.oid;"anchor"==i.flag&&(i.position.setValue(o),t._positions[s]=o)},f.ScreenSpaceEventType.MOUSE_MOVE),this._finishEditFn=()=>{if(e)return;t.togglePointStatus(!1),t._isModified=!0;let i,r=Y.CartesianToWindowPosition(t._positions[0],this.viewer),o=Y.CartesianToWindowPosition(t._positions[1],this.viewer);i=this.type==x.DOUBLEARROW?this.getDoubleArrowVertex(r,o):this.getArrowVertex(r,o);let s=i.map(t=>{let e=Y.CartesianToWGS84(t);return[e.lng,e.lat,0]});at({id:this._id,coordinates:n?[s]:s},this._updateEndCallback),this.disableDrag(),this.disableModify(),this._status="draw"},t._modifyHandler&&t._modifyHandler.setInputAction(t=>{this._finishEditFn()},f.ScreenSpaceEventType.RIGHT_CLICK)}getArrowVertex(t,e){let i=Y.WindowPositionToCartesian(t,this.viewer),n=Y.WindowPositionToCartesian(e,this.viewer);if(!i||!n)return[];let r=f.Cartesian3.distance(i,n);const o=new f.Cartesian3;f.Cartesian3.subtract(n,i,o);let s=this._getpoint(r-36*(r/36/3>1?1:r/36/3),10*(r/36/3>1?1:r/36/2),i,o),a=this._getpoint(r-36*(r/36/3>1?1:r/36/3),22*(r/36/3>1?1:r/36/2),i,o);return[i,s[0],a[0],n,a[1],s[1],i]}getDoubleArrowVertex(t,e){let i=Y.WindowPositionToCartesian(t,this.viewer),n=Y.WindowPositionToCartesian(e,this.viewer);if(!i||!n)return[];let r=f.Cartesian3.distance(i,n);const o=new f.Cartesian3;f.Cartesian3.subtract(n,i,o);let s=this._getpoint(34*(r/36/3>1?1:r/36/3),10*(r/36/3>1?1:r/36/3),i,o),a=this._getpoint(36*(r/36/3>1?1:r/36/3),22*(r/36/3>1?1:r/36/3),i,o),A=this._getpoint(r-34*(r/36/3>1?1:r/36/3),10*(r/36/3>1?1:r/36/3),i,o),l=this._getpoint(r-36*(r/36/3>1?1:r/36/3),22*(r/36/3>1?1:r/36/3),i,o);return[i,a[0],s[0],A[0],l[0],n,l[1],A[1],s[1],a[1],i]}_getpoint(t,e,i,n){const r=new f.Cartesian3,o=new f.Ray(i,n);f.Ray.getPoint(o,t,r);const s=new f.Cartesian3;f.Cartesian3.cross(n,i,s);const a=new f.Cartesian3,A=new f.Ray(r,s);f.Ray.getPoint(A,e,a),f.Cartesian3.negate(s,s);const l=new f.Cartesian3,c=new f.Ray(r,s);return f.Ray.getPoint(c,e,l),[a,l]}getStyle(t={}){const e=Object.assign(this._style,t),{lineWidth:i,lineType:n,lineColor:r,fillColor:o}=e;return{fillMaterial:f.Color.fromCssColorString(o),lineMaterial:"dashed"===n?new f.PolylineDashMaterialProperty({color:f.Color.fromCssColorString(r)}):f.Color.fromCssColorString(r),lineWidth:i}}},6:class extends Yn{constructor(t){super(t),this._isModified=!1}startCreate(t){this._style=Object.assign({lineWidth:0,lineColor:this._defaultColor.line,lineType:"solid",fillColor:this._defaultColor.polygon,showRadius:!0,texture:"",textureRepeat:[20,20],clampToGround:!0,extraHeight:0,classificationType:2},t),this._options=t;const{callback:e}=t,{extraHeight:i}=this.getStyle();this._drawHandler&&this._drawHandler.setInputAction(t=>{t.position=new f.Cartesian2(t.position.x/this.viewer.viewer.canvasScale.x,t.position.y/this.viewer.viewer.canvasScale.y);let e=this.getCartesianByType(t.position,i);e&&0===this._positions.length&&(this._positions.push(e.clone()),this._positions.push(e.clone()),this.showRegion2Map())},f.ScreenSpaceEventType.LEFT_CLICK),this._drawHandler&&this._drawHandler.setInputAction(t=>{let e=t.endPosition;if(e=new f.Cartesian2(e.x/this.viewer.viewer.canvasScale.x,e.y/this.viewer.viewer.canvasScale.y),this._positions.length<1)return void this._tooltip.showAt(e,`<p>${st.property("CHOOSE_START")}</p>`);this._tooltip.showAt(e,`<p>${st.property("CHOOSE_END")}</p><p>${st.property("DOUBLE_CLICK_STOP_DRAW")},${st.property("RIGHT_CLICK_CANCEL_DRAW")}</p>`);let n=this.getCartesianByType(e,i);n&&(this._positions.pop(),this._positions.push(n))},f.ScreenSpaceEventType.MOUSE_MOVE),this._drawHandler&&this._drawHandler.setInputAction(t=>{t.position=new f.Cartesian2(t.position.x/this.viewer.viewer.canvasScale.x,t.position.y/this.viewer.viewer.canvasScale.y);let n=this.getCartesianByType(t.position,i);if(!n)return;this._tooltip.setVisible(!1),this.clearEventHandler("draw"),this._positions.pop(),this._positions.push(n),this.viewer.viewer.layerCache.add(this),this.setFinish();const r=Y.CartesianToWGS84(this._positions[0]),o=Y.CartesianToWGS84(this._positions[1]),s=Wn.distancePoints({startPoint:[r.lng,r.lat],endPoint:[o.lng,o.lat]}),a=Wn.pointToBuffer({point:[r.lng,r.lat],radius:s}).geometry.coordinates[0].map(t=>[...t,r.alt]);at({id:this._id,coordinates:[a]},e),this._drawing=!1},f.ScreenSpaceEventType.LEFT_DOUBLE_CLICK),this._drawHandler&&this._drawHandler.setInputAction(t=>{this.destroy()},f.ScreenSpaceEventType.RIGHT_CLICK)}showEdit(t,e){"edit"!==this._status&&(this._status="edit",this._updateCallback=t,this._updateEndCallback=e,this._isDrawing=!0,this.showModifyRegion2Map())}setProperty(t){const e=this._entity,{fillMaterial:i,showRadius:n,lineWidth:r,lineMaterial:o,clampToGround:s,classificationType:a}=this.getStyle(t);e.ellipse.material=i,e.ellipse.classificationType=a,e.label.show=n,e.polyline.width=r,e.polyline.material=o,e.polyline.classificationType=a,this.updateAnchors(s&&0===a)}showRegion2Map(t=!0){const{fillMaterial:e,showRadius:i,lineWidth:n,lineMaterial:r,clampToGround:o,classificationType:s}=this.getStyle(),a=new f.CallbackProperty(()=>{if(!this._isDrawing)return this.drawEndInfo.radius;if(2===this._positions.length){const t=this._positions[0],e=this._positions[1];return f.Cartesian3.distance(t,e)}return null},!1),A=new f.CallbackProperty(()=>{if(!this._isDrawing)return this.drawEndInfo.radiusText;if(2===this._positions.length){const t=Y.CartesianToWGS84(this._positions[0]),e=Y.CartesianToWGS84(this._positions[1]),i=Wn.distancePoints({startPoint:[t.lng,t.lat],endPoint:[e.lng,e.lat]});return`${st.property("RADIUS")}: ${i.toFixed(2)}km`}return"0km"},!1),l=new f.CallbackProperty(()=>this._isDrawing?2===this._positions.length?this._positions[0]:void 0:this.drawEndInfo.originPosition,!1),c=new f.CallbackProperty(()=>{if(!this._isDrawing)return this.drawEndInfo.height;if(this._positions.length){return Y.CartesianToWGS84(this._positions[0]).alt}},!1);let u=new f.CallbackProperty(()=>{if(!this._isDrawing)return this.drawEndInfo.positions;if(this._positions.length>=2){const t=Y.CartesianToWGS84(this._positions[0]),e=Y.CartesianToWGS84(this._positions[1]),i=Wn.distancePoints({startPoint:[t.lng,t.lat],endPoint:[e.lng,e.lat]}),n=Wn.pointToBuffer({point:[t.lng,t.lat],radius:i}).geometry.coordinates[0].map(e=>new I(...e,t.alt));return Y.WGS84ArrToCartesianArr(n)}return null},!1),h={show:t,position:l,ellipse:new f.EllipseGraphics({semiMajorAxis:a,semiMinorAxis:a,material:e,zIndex:this.viewer.viewer.graphicIndex,height:o?void 0:c,classificationType:s}),label:new f.LabelGraphics({show:i,text:A,font:"12px",verticalOrigin:f.VerticalOrigin.BOTTOM,pixelOffset:new f.Cartesian2(0,-10)}),polyline:{positions:u,width:n,material:r,clampToGround:o,classificationType:s,zIndex:this.viewer.viewer.graphicIndex}};this._entity=this._viewer.entities.add(h),this._id=this._entity.id,this.viewer.viewer.graphicIndex++}showModifyRegion2Map(){const{clampToGround:t,classificationType:e}=this.getStyle();this.bindModifyEvent(),this.draggable(),this._isModified?this.togglePointStatus(!0):this._positions.forEach((i,n)=>{this.createPoint(i,n,!0,t&&0===e)})}bindModifyEvent(){const{extraHeight:t}=this.getStyle();let e=this,i=!1,n=null;e._modifyHandler&&e._modifyHandler.setInputAction(r=>{let o=r.position;if(!Object(f.defined)(o))return;o=new f.Cartesian2(o.x/this.viewer.viewer.canvasScale.x,o.y/this.viewer.viewer.canvasScale.y);let s=this.getCartesianByType(o,t);if(!s)return;if(i){i=!1,n.position.setValue(s);let t=n.oid;e._positions[t]=s,e._tooltip.setVisible(!1)}else{let t=e._viewer.scene.pick(o);if(!Object(f.defined)(t))return;if(!Object(f.defined)(t.id))return;let r=t.id;if(r.relatedId!=e._id)return;if("anchor"!=r.flag)return;n=r,i=!0,"anchor"==r.flag&&e._tooltip.showAt(o,`<p>${st.property("MOVE_CONTROL_POINT")}</p>`)}const a=Y.CartesianToWGS84(this._positions[0]),A=this.calRadius(this._positions[0],this._positions[1]),l=Wn.pointToBuffer({point:[a.lng,a.lat],radius:A}).geometry.coordinates[0].map(t=>[...t,a.alt]);at({id:this._id,coordinates:[l]},this._updateCallback)},f.ScreenSpaceEventType.LEFT_CLICK),e._modifyHandler&&e._modifyHandler.setInputAction(t=>{if(!i)return;let r=t.endPosition;if(!Object(f.defined)(r))return;r=new f.Cartesian2(r.x/this.viewer.viewer.canvasScale.x,r.y/this.viewer.viewer.canvasScale.y),e._tooltip.showAt(r,`<p>${st.property("MOVE_CONTROL_POINT")}</p><p>${st.property("LEFT_STOP_MOVE_AND_RIGHT_STOP_EDIT")}</p>`);let o=Y.WindowPositionToCartesian(r,this.viewer);if(!o)return;let s=n.oid;"anchor"==n.flag&&(n.position.setValue(o),e._positions[s]=o)},f.ScreenSpaceEventType.MOUSE_MOVE),this._finishEditFn=()=>{if(i)return;e.togglePointStatus(!1),e._isModified=!0;const t=Y.CartesianToWGS84(this._positions[0]),n=this.calRadius(this._positions[0],this._positions[1]),r=Wn.pointToBuffer({point:[t.lng,t.lat],radius:n}).geometry.coordinates[0].map(e=>[...e,t.alt]);at({id:this._id,coordinates:[r]},this._updateEndCallback),this.disableDrag(),this.disableModify(),this.setFinish(),this._status="draw"},e._modifyHandler&&e._modifyHandler.setInputAction(t=>{this._finishEditFn()},f.ScreenSpaceEventType.RIGHT_CLICK)}calRadius(t,e){const i=Y.CartesianToWGS84(t),n=Y.CartesianToWGS84(e);return Wn.distancePoints({startPoint:[i.lng,i.lat],endPoint:[n.lng,n.lat]})}calBearing(t,e){const i=Y.CartesianToWGS84(t),n=Y.CartesianToWGS84(e);return Wn.bearingPoints({startPoint:[i.lng,i.lat],endPoint:[n.lng,n.lat]})}getStyle(t={}){const e=Object.assign(this._style,t),{lineWidth:i,lineType:n,lineColor:r,fillColor:o,showRadius:s,texture:a,textureRepeat:A,clampToGround:l,extraHeight:c,classificationType:u}=e;let h;h=a?new f.ImageMaterialProperty({image:a,color:f.Color.fromCssColorString("#fff"),repeat:new f.Cartesian2(...A),transparent:!0}):f.Color.fromCssColorString(o);return{fillMaterial:h,lineMaterial:"dashed"===n?new f.PolylineDashMaterialProperty({color:f.Color.fromCssColorString(r)}):f.Color.fromCssColorString(r),lineWidth:i,showRadius:s,clampToGround:l,extraHeight:c,classificationType:u}}createByData(t,e,i){const n=[],r=Wn.getCenterOfPolygon({polygon:e});n.push([...r,e[0][0][2]]),n.push(e[0][0]);const o=n.map(t=>new I(t[0],t[1],t[2])),s=Y.WGS84ArrToCartesianArr(o);this._positions=s,this.showRegion2Map(t),t||this.hideAnimation(0,0),this.clearEventHandler("draw"),this._drawing=!1,this.setFinish(),this.viewer.viewer.layerCache.add(this),at({id:this._id,coordinates:e},i)}setFinish(){const t=this._positions[0],e=this._positions[1],i=f.Cartesian3.distance(t,e),n=Y.CartesianToWGS84(this._positions[0]),r=Y.CartesianToWGS84(this._positions[1]),o=Wn.distancePoints({startPoint:[n.lng,n.lat],endPoint:[r.lng,r.lat]}),s=`${st.property("RADIUS")}: ${o.toFixed(2)}km`,a=this._positions[0],A=n.alt,l=Wn.pointToBuffer({point:[n.lng,n.lat],radius:o}).geometry.coordinates[0].map(t=>new I(...t,n.alt)),c=Y.WGS84ArrToCartesianArr(l);this._isDrawing=!1,this.drawEndInfo={radius:i,radiusText:s,originPosition:a,height:A,positions:c}}},7:class extends Yn{constructor(t){super(t)}startCreate(t){this._options=t;const{callback:e,moveFn:i,cancelFn:n}=t;this._drawHandler&&this._drawHandler.setInputAction(t=>{t.position=new f.Cartesian2(t.position.x/this.viewer.viewer.canvasScale.x,t.position.y/this.viewer.viewer.canvasScale.y);let e=this._viewer.scene.pickPosition(t.position);if(e&&0===this._positions.length){f.Cartographic.fromCartesian(e).height<0&&(e=Y.WindowPositionToCartesian(t.position,this.viewer)),this._positions.push(e),this._positions.push(e),this.showRegion2Map()}},f.ScreenSpaceEventType.LEFT_CLICK),this._drawHandler&&this._drawHandler.setInputAction(t=>{let e=t.endPosition;if(e=new f.Cartesian2(e.x/this.viewer.viewer.canvasScale.x,e.y/this.viewer.viewer.canvasScale.y),this._positions.length<1)return void this._tooltip.showAt(e,`<p>${st.property("CHOOSE_START")}</p>`);this._tooltip.showAt(e,`<p>${st.property("CHOOSE_END")},${st.property("DOUBLE_CLICK_STOP_DRAW")}</p>`);let n=this._viewer.scene.pickPosition(e);if(!n)return;f.Cartographic.fromCartesian(n).height<0&&(n=Y.WindowPositionToCartesian(e,this.viewer)),this._positions.pop(),this._positions.push(n),i&&i()},f.ScreenSpaceEventType.MOUSE_MOVE),this._drawHandler&&this._drawHandler.setInputAction(t=>{t.position=new f.Cartesian2(t.position.x/this.viewer.viewer.canvasScale.x,t.position.y/this.viewer.viewer.canvasScale.y);let i=this._viewer.scene.pickPosition(t.position);if(!i)return;f.Cartographic.fromCartesian(i).height<0&&(i=Y.WindowPositionToCartesian(t.position,this.viewer)),this._tooltip.setVisible(!1),this.clearEventHandler("draw"),this._positions.pop(),this._positions.push(i),this.viewer.viewer.layerCache.add(this);const n=Y.CartesianToWGS84(this._positions[0]),r=Y.CartesianToWGS84(this._positions[1]),o=f.Cartographic.fromCartesian(this._positions[0]),s=f.Cartographic.fromCartesian(this._positions[1]),a=Y.CartesianToWGS84(f.Cartesian3.fromRadians(o.longitude,o.latitude,s.height));at({id:this._id,coordinates:[n,r,a,n]},e),this._drawing=!1},f.ScreenSpaceEventType.LEFT_DOUBLE_CLICK),this._drawHandler&&this._drawHandler.setInputAction(t=>{n&&n(),this.destroy()},f.ScreenSpaceEventType.RIGHT_CLICK)}showRegion2Map(){const{color:t,width:e}=this._options,i=f.Color.fromCssColorString(t||this._defaultColor.line),n=e||2;let r={polyline:{positions:new f.CallbackProperty(()=>{if(2===this._positions.length){const t=this._positions[0],e=this._positions[1],i=f.Cartographic.fromCartesian(t),n=f.Cartographic.fromCartesian(e);return[t,e,f.Cartesian3.fromRadians(i.longitude,i.latitude,n.height),t]}},!1),width:new f.ConstantProperty(n),material:i}};this._entity=this._viewer.entities.add(r),this._id=this._entity.id}getPositionArr(){const t=Y.CartesianToWGS84(this._positions[0]),e=Y.CartesianToWGS84(this._positions[1]),i=f.Cartographic.fromCartesian(this._positions[0]),n=f.Cartographic.fromCartesian(this._positions[1]);return[t,e,Y.CartesianToWGS84(f.Cartesian3.fromRadians(i.longitude,i.latitude,n.height))]}},8:class extends Yn{constructor(t){super(t),this.complete=!1,this.info={},this.getModelPosition=t=>f.Matrix4.multiplyByPoint(this.inverseMatrix,t,new f.Cartesian3),this.getDirectionByTwoPoint=(t,e)=>{const i=new f.Cartesian3;return f.Cartesian3.normalize(f.Cartesian3.subtract(e,t,i),i)}}startCreate(t){this._options=t;const{callback:e,moveFn:i,cancelFn:n}=t;this._drawHandler&&this._drawHandler.setInputAction(t=>{t.position=new f.Cartesian2(t.position.x/this.viewer.viewer.canvasScale.x,t.position.y/this.viewer.viewer.canvasScale.y);let e=this._viewer.scene.pickPosition(t.position);if(e){if(0===this._positions.length){f.Cartographic.fromCartesian(e).height<0&&(e=Y.WindowPositionToCartesian(t.position,this.viewer));const i=f.Transforms.eastNorthUpToFixedFrame(e,f.Ellipsoid.WGS84);this.inverseMatrix=f.Matrix4.inverse(i,new f.Matrix4),this._positions.push(e),this._positions.push(e),this.showRegion2Map()}}else console.warn(st.property("c070201"))},f.ScreenSpaceEventType.LEFT_CLICK),this._drawHandler&&this._drawHandler.setInputAction(t=>{let e=t.endPosition;if(e=new f.Cartesian2(e.x/this.viewer.viewer.canvasScale.x,e.y/this.viewer.viewer.canvasScale.y),this._positions.length<1)return void this._tooltip.showAt(e,`<p>${st.property("CHOOSE_START")}</p>`);this._tooltip.showAt(e,`<p>${st.property("CHOOSE_END")},${st.property("DOUBLE_CLICK_STOP_DRAW")}</p>`);let n=this._viewer.scene.pickPosition(e);n&&(this.mousePosition=e,this._positions.pop(),this._positions.push(n),i&&i())},f.ScreenSpaceEventType.MOUSE_MOVE),this._drawHandler&&this._drawHandler.setInputAction(t=>{t.position=new f.Cartesian2(t.position.x/this.viewer.viewer.canvasScale.x,t.position.y/this.viewer.viewer.canvasScale.y);let i=this._viewer.scene.pickPosition(t.position);if(!i)return;f.Cartographic.fromCartesian(i).height<0&&(i=Y.WindowPositionToCartesian(t.position,this.viewer)),this._tooltip.setVisible(!1),this.clearEventHandler("draw"),this._positions.pop(),this._positions.push(i),this.viewer.viewer.layerCache.add(this);const n=Y.CartesianToWGS84(this.info.center);at({id:this._id,coordinates:n},e),this.complete=!0,this._drawing=!1},f.ScreenSpaceEventType.LEFT_DOUBLE_CLICK),this._drawHandler&&this._drawHandler.setInputAction(t=>{n&&n(),this.destroy()},f.ScreenSpaceEventType.RIGHT_CLICK)}showRegion2Map(){const{color:t,width:e,fillColor:i}=this._options,n=f.Color.fromCssColorString(t||this._defaultColor.line),r=f.Color.fromCssColorString(i||this._defaultColor.polygon),o=e||2,s=t=>new f.CallbackProperty(()=>{if(2===this._positions.length){if(!this.mousePosition)return;if(this.complete){if("center"===t)return this.info.center;if("line"===t)return this.info.line;if("radius"===t)return this.info.radius;if("height"===t)return this.info.height}const e=this._positions[0],i=f.Cartographic.fromCartesian(e),n=this.getModelPosition(this._viewer.scene.camera.positionWC),r=this.getDirectionByTwoPoint(n,new f.Cartesian3),o=this._viewer.scene.camera.getPickRay(this.mousePosition),s=f.Plane.fromPointNormal(e,r),a=f.IntersectionTests.rayPlane(o,s);if(!a)return;const A=f.Cartographic.fromCartesian(a),l=f.Cartesian3.fromRadians(i.longitude,i.latitude,A.height),c=f.Cartesian3.distance(a,l);if(this.info={center:l,radius:c,height:A.height,line:[e,l]},"center"===t)return l;if("line"===t)return[e,l];if("radius"===t)return c;if("height"===t)return A.height}},!1);let a={position:s("center"),ellipse:new f.EllipseGraphics({semiMajorAxis:s("radius"),semiMinorAxis:s("radius"),material:r,height:s("height")}),polyline:{positions:s("line"),width:new f.ConstantProperty(o),material:n}};this._entity=this._viewer.entities.add(a),this._id=this._entity.id}},9:class extends Yn{constructor(t){super(t),this._isModified=!1}startCreate(t){this._style=Object.assign({lineWidth:0,lineColor:this._defaultColor.line,lineType:"solid",fillColor:this._defaultColor.polygon,texture:"",textureRepeat:[20,20],clampToGround:!0,extraHeight:0,classificationType:2},t),this._options=t;const{callback:e,clickFn:i,cancelFn:n,compat:r=!1}=t,{extraHeight:o}=this.getStyle();this._drawHandler&&this._drawHandler.setInputAction(t=>{t.position=new f.Cartesian2(t.position.x/this.viewer.viewer.canvasScale.x,t.position.y/this.viewer.viewer.canvasScale.y);let e=this.getCartesianByType(t.position,o);e&&(0===this._positions.length&&(this._positions.push(e),this.showRegion2Map()),this._positions.length<3&&this._positions.push(e),i&&i())},f.ScreenSpaceEventType.LEFT_CLICK),this._drawHandler&&this._drawHandler.setInputAction(t=>{let e=t.endPosition;if(!e)return;e=new f.Cartesian2(e.x/this.viewer.viewer.canvasScale.x,e.y/this.viewer.viewer.canvasScale.y);let i=this._positions.length;if(i<1)return void this._tooltip.showAt(e,`<p>${st.property("CHOOSE_START")}</p>`);let n=`<p>${st.property("ADD_NEXT_POINT")}</p>`;3===i&&(n=`<p>${st.property("DOUBLE_CLICK_STOP_DRAW")},${st.property("RIGHT_CLICK_CANCEL_DRAW")}</p>`),this._tooltip.showAt(e,n);let r=this.getCartesianByType(e,o);r&&(this._positions.pop(),this._positions.push(r))},f.ScreenSpaceEventType.MOUSE_MOVE),this._drawHandler&&this._drawHandler.setInputAction(t=>{if(this._positions.length<3)return;this._tooltip.setVisible(!1),this.clearEventHandler("draw"),this.viewer.viewer.layerCache.add(this),this.setFinish();let i=[...this._positions];i.push(this._positions[0]);let n=i.map(t=>{let e=Y.CartesianToWGS84(t);return[e.lng,e.lat,e.alt]});at({id:this._id,coordinates:r?[n]:n},e),this._drawing=!1},f.ScreenSpaceEventType.LEFT_DOUBLE_CLICK),this._drawHandler&&this._drawHandler.setInputAction(t=>{n&&n(),this.destroy()},f.ScreenSpaceEventType.RIGHT_CLICK)}showEdit(t,e){"edit"!==this._status&&(this._status="edit",this._updateCallback=t,this._updateEndCallback=e,this._isDrawing=!0,this.showModifyRegion2Map())}setProperty(t){const e=this._entity,{fillMaterial:i,lineWidth:n,lineMaterial:r,clampToGround:o,classificationType:s}=this.getStyle(t);e.polygon.material=i,e.polygon.perPositionHeight=!o,e.polygon.classificationType=s,e.polyline.width=n,e.polyline.material=r,e.polyline.clampToGround=o,e.polyline.classificationType=s,this.updateAnchors(o&&0===s)}showRegion2Map(t=!0){const{fillMaterial:e,lineWidth:i,lineMaterial:n,clampToGround:r,classificationType:o}=this.getStyle();let s=new f.CallbackProperty(()=>{if(!this._isDrawing)return this.drawEndInfo.pHierarchy;if(this._positions.length>2){const t=Object(g.cloneDeep)(this._positions);return new f.PolygonHierarchy(t)}return null},!1),a=new f.CallbackProperty(()=>{if(!this._isDrawing)return this.drawEndInfo.positions;if(this._positions.length>=2){let t=[...this._positions];return t.push(this._positions[0]),t}return null},!1),A={show:t,polygon:new f.PolygonGraphics({hierarchy:s,material:e,zIndex:this.viewer.viewer.graphicIndex,perPositionHeight:!r,classificationType:o}),polyline:{positions:a,width:i,material:n,clampToGround:r,classificationType:o,zIndex:this.viewer.viewer.graphicIndex}};this._entity=this._viewer.entities.add(A),this._id=this._entity.id,this.viewer.viewer.graphicIndex++}showModifyRegion2Map(){const{clampToGround:t,classificationType:e}=this.getStyle();let i=this;i.bindModifyEvent(),this.draggable(),i._isModified?i.togglePointStatus(!0):this._positions.forEach((i,n)=>{this.createPoint(i,n,!0,t&&0===e)})}bindModifyEvent(){const{extraHeight:t}=this.getStyle();let e=this,i=!1,n=null;const{compat:r}=this._options;e._modifyHandler&&e._modifyHandler.setInputAction(o=>{let s=o.position;if(!Object(f.defined)(s))return;s=new f.Cartesian2(s.x/this.viewer.viewer.canvasScale.x,s.y/this.viewer.viewer.canvasScale.y);let a=this.getCartesianByType(s,t);if(!a)return;if(i){i=!1,n.position.setValue(a);let t=n.oid;e._positions[t]=a,e._tooltip.setVisible(!1)}else{let t=e._viewer.scene.pick(s);if(!Object(f.defined)(t))return;if(!Object(f.defined)(t.id))return;let r=t.id;if(r.relatedId!=e._id)return;if("anchor"!=r.flag)return;n=r,i=!0,"anchor"==r.flag&&e._tooltip.showAt(s,`<p>${st.property("MOVE_CONTROL_POINT")}</p>`)}let A=[...this._positions];A.push(this._positions[0]);let l=this.cartesianArrToLngArr(A);at({id:this._id,coordinates:r?[l]:l},this._updateCallback)},f.ScreenSpaceEventType.LEFT_CLICK),e._modifyHandler&&e._modifyHandler.setInputAction(r=>{if(!i)return;let o=r.endPosition;if(!Object(f.defined)(o))return;o=new f.Cartesian2(o.x/this.viewer.viewer.canvasScale.x,o.y/this.viewer.viewer.canvasScale.y),e._tooltip.showAt(o,`<p>${st.property("MOVE_CONTROL_POINT")}</p><p>${st.property("LEFT_STOP_MOVE_AND_RIGHT_STOP_EDIT")}</p>`);let s=this.getCartesianByType(o,t);if(!s)return;let a=n.oid;"anchor"==n.flag&&(n.position.setValue(s),e._positions[a]=s)},f.ScreenSpaceEventType.MOUSE_MOVE),this._finishEditFn=()=>{if(i)return;e.togglePointStatus(!1),e._isModified=!0;let t=[...this._positions];t.push(this._positions[0]);let n=this.cartesianArrToLngArr(t);at({id:this._id,coordinates:r?[n]:n},this._updateEndCallback),this.disableDrag(),this.disableModify(),this.setFinish(),this._status="draw"},e._modifyHandler&&e._modifyHandler.setInputAction(t=>{this._finishEditFn()},f.ScreenSpaceEventType.RIGHT_CLICK)}getStyle(t={}){const e=Object.assign(this._style,t),{lineWidth:i,lineType:n,lineColor:r,fillColor:o,texture:s,textureRepeat:a,clampToGround:A,extraHeight:l,classificationType:c}=e;let u;u=s?new f.ImageMaterialProperty({image:s,color:f.Color.fromCssColorString("#fff"),repeat:new f.Cartesian2(...a),transparent:!0}):f.Color.fromCssColorString(o);return{fillMaterial:u,lineMaterial:"dashed"===n?new f.PolylineDashMaterialProperty({color:f.Color.fromCssColorString(r)}):f.Color.fromCssColorString(r),lineWidth:i,clampToGround:A,extraHeight:l,classificationType:c}}createByData(t,e,i){const n=e.map(t=>new I(t[0],t[1],t[2]));n.pop();const r=Y.WGS84ArrToCartesianArr(n);this._positions=r,this.showRegion2Map(t),t||this.hideAnimation(0,0),this.clearEventHandler("draw"),this._drawing=!1,this.setFinish(),this.viewer.viewer.layerCache.add(this),at({id:this._id,coordinates:e},i)}setFinish(){const t=new f.PolygonHierarchy(this._positions);let e=[...this._positions];e.push(this._positions[0]),this._isDrawing=!1,this.drawEndInfo={pHierarchy:t,positions:e}}},10:class extends Yn{constructor(t){super(t),this._isModified=!1}startCreate(t){this._style=Object.assign({type:S.DEFAULT,color:this._defaultColor.line,url:"",height:100,repeat:1,speed:1,brightness:1,alpha:1,axisY:!0,reverse:!1,closure:!1},t),this._options=t;const{callback:e}=t;let i=null;this._drawHandler&&this._drawHandler.setInputAction(t=>{t.position=new f.Cartesian2(t.position.x/this.viewer.viewer.canvasScale.x,t.position.y/this.viewer.viewer.canvasScale.y);let e=Y.WindowPositionToCartesian(t.position,this.viewer);if(!e)return;let n=this._positions.length;0===n&&(this._positions.push(e),i=this.createPoint(e,-1,!1),this.showPolyline2Map()),this._positions.push(e);let r=n-2;this.createPoint(e,r,!1)},f.ScreenSpaceEventType.LEFT_CLICK),this._drawHandler&&this._drawHandler.setInputAction(t=>{let e=t.endPosition;if(e=new f.Cartesian2(e.x/this.viewer.viewer.canvasScale.x,e.y/this.viewer.viewer.canvasScale.y),this._positions.length<1)return void this._tooltip.showAt(e,`<p>${st.property("CHOOSE_START")}</p>`);let n=this._positions.length,r=`<p>${st.property("ADD_NEXT_POINT")}</p>`;n>2&&(r+=`<p>${st.property("DOUBLE_CLICK_STOP_DRAW")},${st.property("RIGHT_CLICK_CANCEL_DRAW")}</p>`),this._tooltip.showAt(e,r);let o=Y.WindowPositionToCartesian(e,this.viewer);o&&(i.position.setValue(o),this._positions.pop(),this._positions.push(o))},f.ScreenSpaceEventType.MOUSE_MOVE),this._drawHandler&&this._drawHandler.setInputAction(t=>{if(this._positions.length<2)return;const{closure:n}=this._options;this._positions.pop(),this._positions.pop(),this._viewer.entities.remove(i),this._tooltip.setVisible(!1),n&&this._positions.push(this._positions[0]),this.clearEventHandler("draw"),this.viewer.viewer.layerCache.add(this),this.setFinish();let r=this._positions.map(t=>{let e=Y.CartesianToWGS84(t);return[e.lng,e.lat,0]});at({id:this._id,coordinates:r},e),this._drawing=!1},f.ScreenSpaceEventType.LEFT_DOUBLE_CLICK),this._drawHandler&&this._drawHandler.setInputAction(t=>{this.destroy()},f.ScreenSpaceEventType.RIGHT_CLICK)}showEdit(t,e){"edit"!==this._status&&(this._status="edit",this._updateCallback=t,this._updateEndCallback=e,this._isDrawing=!0,this.showModifyRegion2Map())}createMidPoint(t,e){let i=this._viewer.entities.add({position:t,billboard:{show:!1,color:f.Color.fromCssColorString("rgba(255,255,255,1.0)"),image:new f.ConstantProperty(this._dragIcon),heightReference:f.HeightReference.CLAMP_TO_GROUND}});return i.oid=e,i.relatedId=this._id,i.flag="mid_anchor",this._markers[e]=i,i}setProperty(t){const e=this._entity,{material:i}=this.getStyle(t);e.wall.material=i}showPolyline2Map(t=!0){const{material:e}=this.getStyle(),i=t=>new f.CallbackProperty(()=>{if(!this._isDrawing){if("position"===t)return this.drawEndInfo.positions;if("height"===t)return this.drawEndInfo.heights}const{height:e}=this.getStyle();let i=[],n=[];return i=this._tempPositions.length?this._tempPositions:this._positions,i.forEach(()=>{n.push(e)}),"position"===t?i:"height"===t?n:void 0},!1),n={show:t,wall:{positions:i("position"),maximumHeights:i("height"),material:e}};this._entity=this._viewer.entities.add(n),this._id=this._entity.id}showModifyRegion2Map(){if(this.computeTempPositions(),this.bindModifyEvent(),this.draggable(),this._isModified)this.togglePointStatus(!0);else{let t=this._tempPositions;for(let e=0;e<t.length;e++){0==e%2?this.createPoint(t[e],e,!0):this.createMidPoint(t[e],e)}}}bindModifyEvent(){let t=!1,e=null;this._modifyHandler&&this._modifyHandler.setInputAction(i=>{let n=i.position;if(!Object(f.defined)(n))return;n=new f.Cartesian2(n.x/this.viewer.viewer.canvasScale.x,n.y/this.viewer.viewer.canvasScale.y);let r=Y.WindowPositionToCartesian(n,this.viewer);if(!r)return;if(t){t=!1,e.position.setValue(r);let i=e.oid;this._tempPositions[i]=r,this._tooltip.setVisible(!1),"mid_anchor"==e.flag&&this.updateModifyAnchors(i)}else{let i=this._viewer.scene.pick(n);if(!Object(f.defined)(i))return;if(!Object(f.defined)(i.id))return;let r=i.id;if(r.relatedId!=this._id)return;if("anchor"!=r.flag&&"mid_anchor"!=r.flag)return;e=r,t=!0,"anchor"==r.flag&&this._tooltip.showAt(n,`<p>${st.property("MOVE_CONTROL_POINT")}</p>`),"mid_anchor"==r.flag&&this._tooltip.showAt(n,`<p>${st.property("MOVE_ADD_NEW_CONTROL_POINT")}</p>`)}this.updatePostions();const o=this.cartesianArrToLngArr(this._positions);at({id:this._id,coordinates:o},this._updateCallback)},f.ScreenSpaceEventType.LEFT_CLICK),this._modifyHandler&&this._modifyHandler.setInputAction(i=>{if(!t)return;let n=i.endPosition;if(!Object(f.defined)(n))return;n=new f.Cartesian2(n.x/this.viewer.viewer.canvasScale.x,n.y/this.viewer.viewer.canvasScale.y),this._tooltip.showAt(n,`<p>${st.property("MOVE_CONTROL_POINT")}</p><p>${st.property("LEFT_STOP_MOVE_AND_RIGHT_STOP_EDIT")}</p>`);let r=Y.WindowPositionToCartesian(n,this.viewer);if(!Object(f.defined)(r))return;let o=e.oid;"anchor"==e.flag?(e.position.setValue(r),this._tempPositions[o]=r,this.updateNewMidAnchors(o)):"mid_anchor"==e.flag&&(e.position.setValue(r),this._tempPositions[o]=r),this.updatePostions()},f.ScreenSpaceEventType.MOUSE_MOVE),this._finishEditFn=()=>{if(t)return;this.togglePointStatus(!1),this._isModified=!0;const e=this.cartesianArrToLngArr(this._positions);at({id:this._id,coordinates:e},this._updateEndCallback),this._tempPositions=[],this.disableDrag(),this.disableModify(),this.setFinish(),this._status="draw"},this._modifyHandler&&this._modifyHandler.setInputAction(t=>{this._finishEditFn()},f.ScreenSpaceEventType.RIGHT_CLICK)}updateNewMidAnchors(t){let e=this;if(null==t||null==t)return;let i=null,n=null,r=null,o=null,s=e._tempPositions.length;0==t?(i=s-2,n=s-1,r=t+1,o=t+2):t==s-2?(i=t-2,n=t-1,r=s-1,o=0):(i=t-2,n=t-1,r=t+1,o=t+2);let a=e._tempPositions[i],A=e._tempPositions[t],l=e._tempPositions[o];if(0==t){let t=e.computeCenterPotition(l,A);e._tempPositions[r]=t,e._markers[r].position.setValue(t)}else if(t==s-1){let t=e.computeCenterPotition(a,A);e._tempPositions[n]=t,e._markers[n].position.setValue(t)}else{let t=e.computeCenterPotition(a,A),i=e.computeCenterPotition(l,A);e._tempPositions[n]=t,e._tempPositions[r]=i,e._markers[n].position.setValue(t),e._markers[r].position.setValue(i)}}updateModifyAnchors(t){let e=this,i=e._tempPositions.length;if(0==t||t==i-1)return;let n=e._tempPositions[t],r=e._tempPositions[t-1],o=e._tempPositions[t+1],s=e.computeCenterPotition(r,n),a=e.computeCenterPotition(n,o);e._tempPositions.splice(t,1,s,n,a),e.clearAnchors();let A=e._tempPositions;for(let t=0;t<A.length;t++){0==t%2?e.createPoint(A[t],t,!0):e.createMidPoint(A[t],t)}}updatePostions(){let t=this._tempPositions;this._positions=t.filter((t,e)=>e%2==0)}getPositionArr(){return this._positions.map(t=>{let e=Y.CartesianToWGS84(t);return[e.lng,e.lat]})}computeTempPositions(){let t=this._positions,e=t.length;for(let i=1;i<e;i++){let e=t[i-1],n=t[i],r=this.computeCenterPotition(e,n);this._tempPositions.push(e),this._tempPositions.push(r)}let i=t[e-1];this._tempPositions.push(i)}getStyle(t={}){const e=Object.assign(this._style,t),{type:i,color:n,url:r,height:o,repeat:s,speed:a,brightness:A,alpha:l,axisY:c,reverse:u,closure:h}=e;let p;return i===S.DEFAULT||i===S.FADE?p=f.Color.fromCssColorString(n):i===S.COLOR_FLOW?p=new Zn({color:f.Color.fromCssColorString(n),repeat:s,speed:a,brightness:A,alpha:l,axisY:c}):i===S.IMAGE_FLOW&&(p=new $n({image:r,color:f.Color.fromCssColorString(n),repeat:s,speed:a,brightness:A,alpha:l,axisY:c,reverse:u})),{height:o,material:p,closure:h}}createByData(t,e,i){const{closure:n}=this.getStyle();if(n){const t=e[0],i=e[e.length-1];t[0]===i[0]&&t[1]===i[1]||e.push(t)}const r=e.map(t=>new I(t[0],t[1],t[2])),o=Y.WGS84ArrToCartesianArr(r);this._positions=o,this.showPolyline2Map(t),t||this.hideAnimation(0,0),this.clearEventHandler("draw"),this._drawing=!1,this.setFinish(),this.viewer.viewer.layerCache.add(this),at({id:this._id,coordinates:e},i)}setFinish(){const{height:t}=this.getStyle(),e=this._tempPositions.length?this._tempPositions:this._positions,i=[];e.forEach(()=>{i.push(t)}),this._isDrawing=!1,this.drawEndInfo={positions:e,heights:i}}}},yr={Point:1,Polyline:2,Polygon:3,Rectangle:4,Arrow:5,Circular:6,SpaceTriangle:7,Elevation:8,Triangle:9,Wall:10},vr={INITED:"inited",ADDED:"added",REMOVED:"removed"};Object.assign(Object.assign({},vr),{CLEARED:"cleared"}),Object.assign({},vr),Object.assign({},vr);class _r extends y{constructor(t){super(),this._selected=void 0,this.viewer=t,this.setInputAction(),this.on(rr.CLICK,this.onClick,this),this.on(rr.DB_CLICK,this.onDblClick,this),this.on(rr.RIGHT_CLICK,this.onRightClick,this),this.on(rr.MOUSE_MOVE,this.debounce(this.onMouseMove,100),this),this.on(rr.WHEEL,this.onMouseWheel,this)}autoRegisterEvent(){}setInputAction(){this._handler=new f.ScreenSpaceEventHandler(this.viewer.instance.canvas),Object(g.forEach)(f.ScreenSpaceEventType,(t,e)=>{const i=f.ScreenSpaceEventType[e];this.eventCache[i]=new f.Event,this._handler.setInputAction(t=>{this.eventCache[i].raiseEvent(t)},i)})}removeInputAction(){this._handler.destroy(),this._handler=null,this.eventCache=[]}onClick(t){if(this.viewer.instance.canvas.focus(),!t||!t.position)return!1;const e=this.getMouseInfo(t.position);this.raiseEvent(rr.CLICK,e)}onDblClick(t){if(!t||!t.position)return!1;const e=this.getMouseInfo(t.position);this.raiseEvent(rr.DB_CLICK,e)}onRightClick(t){if(!t||!t.position)return!1;const e=this.getMouseInfo(t.position);this.raiseEvent(rr.RIGHT_CLICK,e)}onMouseMove(t){if(!t||!t.endPosition)return!1;if(this.viewer.particleLayer.length>0)return;const e=this.getMouseInfo(t.endPosition);this.viewer.instance.canvas.style.cursor=e.target?"pointer":"default",this.raiseEvent(rr.MOUSE_MOVE,e),this._selected&&this.getOverlayId(this._selected.target)===this.getOverlayId(e.target)||(this.raiseEvent(rr.MOUSE_OUT,this._selected),this.raiseEvent(rr.MOUSE_OVER,e),this._selected=e)}onMouseWheel(t){if(!t)return!1;this.raiseEvent(rr.WHEEL,{movement:t})}debounce(t,e){let i=null;return n=>{clearTimeout(i),i=setTimeout(t.bind(this),e,n)}}getMouseInfo(t){const e=this.viewer.instance.scene;let i={x:t.x/this.viewer.canvasScale.x,y:t.y/this.viewer.canvasScale.y};const n=e.pick(i);let r;e.pickPositionSupported&&(r=e.pickPosition(t));let o=void 0;if(e.mode===f.SceneMode.SCENE3D){const i=e.camera.getPickRay(t);o=e.globe.pick(i,e)}else o=e.camera.pickEllipsoid(t,f.Ellipsoid.WGS84);return{target:n,windowPosition:t,position:r?Y.CartesianToWGS84(r):o?Y.CartesianToWGS84(o):null,surfacePosition:o?Y.CartesianToWGS84(o):null}}getTargetInfo(t){if(!t)return;const e={obj:null,info:null},i=this.viewer.layerCache;if(t instanceof f.Cesium3DTileFeature){e.obj=i.getById(t.tileset.layerId);let n={};try{t.getPropertyIds().forEach(e=>{n[e]=t.getProperty(e)})}catch(t){console.warn("get tile property error")}return e.info=n,e}if(t.id){const n=t.id;n instanceof f.Entity&&(n.name?(n.name.includes("effect-")||n.name.includes("complex-")||n.name.includes("overlay-")||n.name.includes("custom-")||n.name.includes("geometry-"))&&(e.obj=i.getById(n.name)):e.obj=i.getById(n.id)),"string"==typeof n&&(n.includes("effect-")||n.includes("video-")||n.includes("geometry-")||n.includes("model-"))&&(e.obj=i.getById(n))}if(t.id&&e.obj&&"layer"===e.obj._layerType){const i={};if(t.id&&t.id.name&&t.id.name.includes("complex-")&&(i.data=t.id.info),t.id&&t.id.name&&t.id.name.includes("overlay-")){let e=t.id;if(e){i.data=e.info,i.entityId=e.id;let t=e.position.getValue(),n=this.viewer.instance.scene.globe.ellipsoid.cartesianToCartographic(t);i.entityPosition=new I(f.Math.toDegrees(n.longitude),f.Math.toDegrees(n.latitude),n.height),i.entityWindowPosition=f.SceneTransforms.wgs84ToWindowCoordinates(this.viewer.instance.scene,t)}}if(t.id&&t.id.name&&t.id.name.includes("custom-")&&t.id.info&&(t.id.info.screenPos&&t.id.info.size&&t.id.info.size>1?(i.data=t.id.info,i.clustered=!0,t.id.length&&(i.size=t.id.length)):(i.data=t.id.info,i.clustered=!1)),t.id&&t.id.name&&t.id.name.includes("geometry-")&&(i.entityId=t.id.id,t.id.info))for(let e in t.id.info)i[e]=t.id.info[e];e.info=i}if(t.id&&e.obj&&"model"===e.obj._layerType){const i={};t.detail&&t.detail.node&&t.detail.node._name&&(i.name=t.detail.node._name),e.info=i}return e}getOverlayId(t){if(t){if(t instanceof f.Cesium3DTileFeature)return t.tileset.layerId;if(t.id){const e=t.id;if(e instanceof f.Entity){if(!e.name)return e.id;if(e.name.includes("effect-")||e.name.includes("complex-")||e.name.includes("overlay-")||e.name.includes("custom-")||e.name.includes("geometry-"))return e.name}if("string"==typeof e&&(e.includes("effect-")||e.includes("video-")||e.includes("geometry-")||e.includes("model-")))return e}}}raiseEvent(t,e={}){let i=void 0,n=void 0,r=this.getTargetInfo(e.target),o={};if(r&&r.obj){const e=r.obj,n=r.info;let s;switch(e._layerType){case"layer":o=n,s=e._layerEvent,i=s.getEvent(t);break;case"model":o=Object.assign(e._props||{},n),s=e._modelEvent,i=s.getEvent(t);break;case"tileset":o=n,s=e._tilesetEvent,i=s.getEvent(t)}}n=this.viewer.viewerEvent.getEvent(t),i&&i.numberOfListeners>0&&(e.position?i.raiseEvent({position:e.position,surfacePosition:e.surfacePosition,props:o,windowPosition:e.windowPosition}):e.movement?i.raiseEvent({movement:e.movement,height:this.viewer.instance.camera.positionCartographic.height}):void 0===e.target&&null===e.position&&i.raiseEvent({windowPosition:e.windowPosition})),n&&n.numberOfListeners>0&&(e.position?n.raiseEvent({position:e.position,surfacePosition:e.surfacePosition,props:o,windowPosition:e.windowPosition}):e.movement?n.raiseEvent({movement:e.movement,height:this.viewer.instance.camera.positionCartographic.height}):void 0===e.target&&null===e.position&&n.raiseEvent({windowPosition:e.windowPosition}))}}class wr extends y{constructor(){super()}on(t,e,i){const n=this.getEvent(t);Object(g.isUndefined)(n)||Object(g.isUndefined)(e)||n.addEventListener(e,i)}off(t,e,i){const n=this.getEvent(t);if(Object(g.isUndefined)(n))return!1;if(e)n.removeEventListener(e,i);else{const t=n._listeners[n.numberOfListeners-1],e=n._scopes[n.numberOfListeners-1];n.removeEventListener(t,e)}}autoRegisterEvent(){Object(g.forEach)(or,(t,e)=>{const i=or[e];this.eventCache[i]=new f.Event})}}class Cr extends y{constructor(){super()}autoRegisterEvent(){Object.keys(fr).forEach(t=>{let e=fr[t];this.eventCache[e]=new f.Event})}}class Br extends y{constructor(){super()}autoRegisterEvent(){Object(g.forEach)(dr,(t,e)=>{const i=dr[e];this.eventCache[i]=new f.Event})}}class br extends y{constructor(){super()}autoRegisterEvent(){Object.keys(fr).forEach(t=>{let e=fr[t];this.eventCache[e]=new f.Event})}}class Er extends y{constructor(t){super(),this.viewer=t}on(t,e,i){const n=this.viewer.instance.camera,r=this.viewer.instance.scene,o=this.viewer.instance.clock;switch(t){case sr:return n.moveEnd.addEventListener(e,i);case ar:return n.changed.addEventListener(e,i);case Ar:return r.preRender.addEventListener(e,i||this);case lr:return r.postRender.addEventListener(e,i||this);case cr:return r.preUpdate.addEventListener(e,i||this);case ur:return r.postUpdate.addEventListener(e,i||this);case hr:return r.morphComplete.addEventListener(e,i||this);case pr:return o.onTick.addEventListener(e,i||this);default:return}}off(t,e,i){const n=this.viewer.instance.camera,r=this.viewer.instance.scene;let o;switch(t){case sr:o=n.moveEnd;break;case ar:o=n.changed;break;case Ar:o=r.preRender;break;case lr:o=r.postRender;break;case cr:o=r.preUpdate;break;case ur:o=r.postUpdate;break;default:o=null}if(e)o.removeEventListener(e,i);else{const t=o._listeners[o.numberOfListeners-1],e=o._scopes[o.numberOfListeners-1];o.removeEventListener(t,e)}}}class Sr{constructor(t){this._isTouched=!1,this._viewer=t,this._eventHandler=new f.ScreenSpaceEventHandler(this._viewer.scene.canvas),this._mouseoutEventHandler=new f.ScreenSpaceEventHandler(this._viewer.scene.canvas)}on(t,e){this._tracks=e;const{event:i,handler:n}=t;let r=gr[i];"mouseout"===i?this._mouseoutEventHandler.setInputAction(t=>{let e=t.endPosition,i=this._viewer.scene.pick(e);if(this._isTouched){if(i||(this._isTouched=!1,n(at(this._touchedEntity.info))),i&&i.id){let t=i.id;t.id&&t.id===this._tracks.id?this._isTouched=!0:(this._isTouched=!1,n(at(this._touchedEntity.info)))}}else if(i&&i.id){let t=i.id;t.id&&Object(g.forEach)(this._tracks,e=>{t.id===e.id&&(this._isTouched=!0,this._touchedEntity=e)})}},r):this._eventHandler.setInputAction(t=>{let e="mouseover"===i?t.endPosition:t.position,r=this._viewer.scene.pick(e);if(!Object(f.defined)(r))return;if(!Object(f.defined)(r.id))return;let o=r.id;o.id&&Object(g.forEach)(this._tracks,t=>{o.id===t.object.id&&n(at(t.object.props))})},r)}off(t){const{event:e}=t;let i=gr[e];"mouseout"===e?this._mouseoutEventHandler.removeInputAction(i):this._eventHandler.removeInputAction(i)}destroy(){this._eventHandler.destroy(),this._mouseoutEventHandler.destroy()}}f.CesiumTerrainProvider.prototype.requestTileGeometry=new Proxy(f.CesiumTerrainProvider.prototype.requestTileGeometry,{apply:function(t,e,i){return e.beforeRequest&&"function"==typeof e.beforeRequest&&e.beforeRequest(e,...i),t.apply(e,i)}});var xr=f.CesiumTerrainProvider,Ir=function(t,e,i,n){return new(i||(i=Promise))((function(r,o){function s(t){try{A(n.next(t))}catch(t){o(t)}}function a(t){try{A(n.throw(t))}catch(t){o(t)}}function A(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(s,a)}A((n=n.apply(t,e||[])).next())}))},Fr=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i};class Or{constructor(t){this._url="";let e=t.viewer;this._mapConfig=e instanceof ts?e.mapConfig:e.viewer.mapConfig}query3DBaseCluster(t={}){return Ir(this,void 0,void 0,(function*(){this._url=""+lt(this._mapConfig).SERVICE_3D_BASE_CLUSTER;const{callback:e}=t,i=Fr(t,["callback"]);let n={url:this._url,body:i};mt.post(n,this._mapConfig).then(t=>{e&&e(at(t.result))}).catch(t=>{At(t,e)})}))}query3DDeviceCluster(t={}){return Ir(this,void 0,void 0,(function*(){this._url=""+lt(this._mapConfig).SERVICE_3D_DEVICE_CLUSTER;const{callback:e}=t,i=Fr(t,["callback"]);let n={url:this._url,body:i};mt.post(n,this._mapConfig).then(t=>{at(t.result,e)}).catch(t=>{At(t,e)})}))}query3dAggs(t){return Ir(this,void 0,void 0,(function*(){this._url=""+lt(this._mapConfig).SERVICE_3D_AGGS;const{callback:e}=t,i=Fr(t,["callback"]);let n={url:this._url,body:i};mt.post(n,this._mapConfig).then(t=>{e&&e(at(t.result))}).catch(t=>{At(t,e)})}))}queryPoiInfo(t){return Ir(this,void 0,void 0,(function*(){const{version:e}=t;this._url=e&&2===e?""+lt(this._mapConfig).SERVICE_POI_V2_SEARCH_URL:""+lt(this._mapConfig).SERVICE_POI_SEARCH_URL,this.commonQuery(t)}))}queryPoiType(t){return Ir(this,void 0,void 0,(function*(){const{keyword:e,callback:i}=t;let n={url:""+lt(this._mapConfig).SERVICE_POI_TYPE,body:{keyword:e}};mt.get(n,this._mapConfig).then(t=>{200===t.status&&t.result&&at(t.result,i)}).catch(t=>{At(t,i)})}))}queryWaterfaceInfo(t){return Ir(this,void 0,void 0,(function*(){this._url=""+lt(this._mapConfig).SERVICE_WATERFACE_SEARCH_URL,this.commonQuery(t)}))}queryRoadSectionInfo(t){return Ir(this,void 0,void 0,(function*(){this._url=""+lt(this._mapConfig).SERVICE_SECTION_SEARCH_URL,this.commonQuery(t)}))}queryRoadCrossInfo(t){return Ir(this,void 0,void 0,(function*(){this._url=""+lt(this._mapConfig).SERVICE_CROSS_SEARCH_URL,this.commonQuery(t)}))}queryRoadInfo(t){return Ir(this,void 0,void 0,(function*(){this._url=""+lt(this._mapConfig).SERVICE_ROAD_SEARCH_URL,this.commonQuery(t)}))}queryCustomInfo(t){return Ir(this,void 0,void 0,(function*(){this._url=""+lt(this._mapConfig).BUSINESS_RENDER_SERVICE,this.commonQuery(t,"custom")}))}getGeometryByAdminCode(t){return Ir(this,void 0,void 0,(function*(){const{code:e,containsSon:i,callback:n,isNativeData:r}=t;let o={url:""+lt(this._mapConfig).GET_GEOMETRY_BY_ADMIN_CODE_URL,body:{adcode:e,containsSon:Boolean(i)}};mt.get(o,this._mapConfig).then(t=>{let e=t.result;if(r)return void n(at(e));let i={type:"FeatureCollection",features:[]};if(!e||!e.polyline)return void n(at([]));let o={};for(let t in e)"polyline"!==t&&(o[t]=e[t]);"Polygon"===e.polyline.type?i.features.push({type:"Feature",geometry:{type:"MultiPolygon",coordinates:[e.polyline.coordinates]},properties:o}):"MultiPolygon"===e.polyline.type&&i.features.push({type:"Feature",geometry:e.polyline,properties:o}),n(at(i))}).catch(t=>{At(t,n)})}))}getAdminInfoByPoint(t){return Ir(this,void 0,void 0,(function*(){const{point:e,level:i="district",callback:n}=t;let r={url:""+lt(this._mapConfig).GET_ADMIN_BY_POINT,body:{lon:e[0],lat:e[1],level:i}};mt.get(r,this._mapConfig).then(t=>{200===t.status&&t.result&&at(t.result,n)}).catch(t=>{At(t,n)})}))}getGeoPoint(t){return Ir(this,void 0,void 0,(function*(){const{keyword:e,adcode:i,type:n,kinCode:r,callback:o}=t;let s=""+lt(this._mapConfig).GET_GEO_POINT_KD,a={address:e};i&&(a.adCode=i),n&&(a.type=n),r&&(a.kinCode=r);let A={body:a,url:s};mt.get(A,this._mapConfig).then(t=>{if(t.result&&t.result[0]&&t.result[0].location){const e=t.result[0].location.split(",");at([parseFloat(e[0]),parseFloat(e[1])],o)}else at([],o)}).catch(t=>{At(t,o)})}))}getLocation(t){return Ir(this,void 0,void 0,(function*(){const e={poi:1,road:2,cross:3,roadSection:4,waterFace:5},{point:i,radius:n=1,type:r,kindCode:o,callback:s}=t;let a=""+lt(this._mapConfig).GET_LOCATION_KD,A={location:i.join(","),radius:n};if(r){const t={};r.forEach(i=>{const n=e[i];n&&(t[n]=!0)});const i=Object.keys(t);i.length&&(A.type=i.join(","))}o&&(A.kindCode=o);let l={body:A,url:a};mt.get(l,this._mapConfig).then(t=>{let e=t.result[0];at(void 0!==e?{address:(e.address||"")+(e.name||""),country:e.country||"",province:e.provinceName||"",city:e.cityName||"",dist:e.districtName||"",town:e.town||"",village:e.village||""}:{address:""},s)}).catch(t=>{At(t,s)})}))}getIsochrone(t){return Ir(this,void 0,void 0,(function*(){const{point:e,time:i,callback:n}=t,r=""+ht(this._mapConfig).ROUTE_EQUAL_TIME_URL;let o={body:{point:e.join(","),timeLimit:i},url:r};mt.get(o,this._mapConfig).then(t=>{"200"===t.code&&t.result&&at(t.result,n)}).catch(t=>{At(t,n)})}))}getSceneModel(t){return Ir(this,void 0,void 0,(function*(){const{sceneId:e,pageNo:i=1,maxCount:n=1e3,mixTerms:r,callback:o}=t,s=""+lt(this._mapConfig).SERVICE_3D_DEVICE,a={appName:this._mapConfig.userName,sceneId:e,pageNo:i<1?0:i-1,pageSize:n};r&&(a.filterTerms=r);let A={body:a,url:s};mt.post(A,this._mapConfig).then(t=>{if("0"===t.code&&t.result){at(t.result.data,o)}}).catch(t=>{At(t,o)})}))}getClusterDetail(t){return Ir(this,void 0,void 0,(function*(){this._url=""+lt(this._mapConfig).BUSINESS_RENDER_SERVICE;const e=Object.assign({},t),{data:i}=t.queryOptions;let{aggsName:n,aggsValue:r,isPublic:o}=i;r.indexOf("[")>-1&&(r=JSON.parse(r));let s="eq";r instanceof Array&&(s="in");const a=[{column:n,value:r,termType:s,type:"or"}];e.terms=[{type:"and",terms:a}],e.isPublic=o,this.commonQuery(e,"custom")}))}commonQuery(t,e){return Ir(this,void 0,void 0,(function*(){const{callback:i}=t;let n=e&&"custom"===e?this.handleCustomParams(t):this.handleParams(t),r={url:this._url,body:n};mt.post(r,this._mapConfig).then(t=>{let e=this.setDefaultFieldsAtSuccessResponse(t);i(at(e))}).catch(t=>{At(t,i)})}))}handleParams(t){const{code:e,polygon:i,keyword:n,searchType:r,sortType:o,pageNo:s,maxCount:a,version:A}=t;if(!e&&!i)throw new Error("行政区划编码和面信息必须至少有一个!");let l={keyword:n||"",pageNumber:s||0,pageSize:a||1e3};return e&&(l.adminId=e),r&&(l.classCodes=r.join(",")),o&&(l.sortType=o),i&&(Array.isArray(i[0][0][0])&&!Array.isArray(i[0][0][0][0])&&(A&&2===A?l.location={type:"MultiPolygon",coordinates:i}:l.geometry={type:"MultiPolygon",coordinates:i}),Array.isArray(i[0][0])&&!Array.isArray(i[0][0][0])&&(A&&2===A?l.location={type:"Polygon",coordinates:i}:l.geometry={type:"Polygon",coordinates:i})),l}handleCustomParams(t){const{adcode:e,polygon:i,points:n,point:r,serviceName:o,maxCount:s,pageNo:a,mixTerms:A,terms:l,throughNetFlag:c,throughNetUrls:u,sorts:h,through:p,isPublic:d}=t;let f={pageSize:s&&s<=2e4?s:10,pageNo:a-1||0};f.serviceNames=[d?"device_base":o],A&&(f.filterTerms=A),l&&(f.terms=l),c&&(f.throughNetFlag=0,f.throughNetUrls=u),h&&(f.sorts=h.map(t=>{let e=t;return t.origin&&(e.origin={lon:t.origin[0],lat:t.origin[1]}),e})),p&&(f.throughNetFlag=p.netFlag,f.throughNetUrls=p.netUrls),f.appName=d?"public_space":this._mapConfig.userName,e&&(f.adcode=e);let g=i||n;if((g||[]).length>0&&(Array.isArray(g[0][0][0])&&!Array.isArray(g[0][0][0][0])&&(f.location={type:"MultiPolygon",coordinates:g}),Array.isArray(g[0][0])&&!Array.isArray(g[0][0][0])&&(f.location={type:"Polygon",coordinates:g})),r){const t=r[0],e=r[1],i=r[2];f.location={type:"Point",coordinates:[t,e]};const n={column:"minHeight",value:i,termType:"lte",type:"and"},o={column:"maxHeight",value:i,termType:"gte",type:"and"};f.filterTerms?(f.filterTerms.push(n),f.filterTerms.push(o)):f.filterTerms=[n,o]}return f}setDefaultFieldsAtSuccessResponse(t){let e={};return t&&t.result&&(t.result.records&&(e={data:t.result.records,total:t.result.total}),t.result.data&&(e={data:t.result.data,total:t.result.total})),e}}class Pr{constructor(t){this._id=$("overlay"),this._layerType="layer",this._boundingRectangle=[],this._fieldMap=t.fieldMap||[],this._layerEvent=new Cr,t.viewer&&(this.query=new Or({viewer:t.viewer})),this._container=new Z("primitive")}field(t,e,i){const n={field:t,props:e,value:i};this._fieldMap.push(n)}get fieldMap(){return this._fieldMap}show(){this._container&&this._container.show()}hide(){this._container&&this._container.hide()}addToViewer(t){const{viewer:e,ended:i}=t;this._container&&(this._userViewer||(this._userViewer=e),this._userViewer.viewer.layerCache.add(this),"primitive"==this._container.getType()?this._userViewer.viewer.instance.scene.primitives.add(this._container.getCollection()):"customDataSource"==this._container.getType()&&this._userViewer.viewer.instance.dataSources.add(this._container.getCollection())),i&&i(at(!0))}remove(t={}){const{ended:e}=t;if(this._container){if(this._attachControl)return void console.error(st.property("c030201"));"primitive"==this._container.getType()?this._userViewer.viewer.instance.scene.primitives.remove(this._container.getCollection()):"customDataSource"==this._container.getType()&&this._userViewer.viewer.instance.dataSources.remove(this._container.getCollection()),this._container=void 0,this._layerEvent=null,this._userViewer.viewer.layerCache.remove(this),at(!0,e)}}on(t){const{event:e,handler:i}=t;this._layerEvent.on(e,i,this)}off(t){const{event:e}=t;this._layerEvent.off(e,this)}makeBounding(t){let e=[];t.forEach(t=>{t.position&&e.push([t.position.lng,t.position.lat])}),1===e.length&&Wn.pointToRectangle({point:e[0],radius:3,callback:t=>{let e=t.data.geometry.coordinates[0];this._boundingRectangle=[[e[0][0],e[2][1]],[e[1][0],e[0][1]]]}}),e.length>1&&Wn.getBboxOfPoints({points:e,callback:t=>{let e=t.data.geometry.coordinates[0];this._boundingRectangle=[[e[0][0],e[2][1]],[e[1][0],e[0][1]]]}})}}const Tr={text:"text",fillColor:"#fff",backgroundColor:"rgba(42, 42, 42, 0.8)",outlineColor:"#000"};class Lr extends Pr{constructor(t){super(t),this.options=Object.assign(Object.assign({},Tr),t),this._container=new Z("customDataSource"),this.init()}init(){const{position:t}=this.options||{};t&&this._handerData(this.options)}setSource(t){if(!this.query)return;const{ended:e}=t;this.query.queryCustomInfo(Object.assign(Object.assign({},t),{callback:t=>{if(t.data&&t.data.total>0){let i=t.data.data.filter(t=>"Point"==t.geometry.type).map(t=>Object.assign({position:{lng:t.geometry.coordinates[0],lat:t.geometry.coordinates[1],alt:t.geometry.coordinates[2]||0}},t.properties));this.makeBounding(i),this.setData(i,e)}}}))}setData(t,e){this._container.size>0&&this._container.removeAll();for(const e of t){let t=Object.assign({},this.options);const i=this.fieldMap.map(t=>t.props);for(let n of i){const i=this.fieldMap.find(t=>t.props===n);let r=(i||{}).value(e[i.field]);t[n]=r}t=Object.assign(Object.assign({},t),e),this._handerData(t)}at(!0,e)}_handerData(t){const{position:e}=t,{lng:i,lat:n,alt:r}=e;let o={};for(let e in t){let i=t[e];["backgroundColor","fillColor","outlineColor"].includes(e)?o[e]=f.Color.fromCssColorString(i):["backgroundPadding","pixelOffset"].includes(e)?o[e]=new f.Cartesian2(...i):"eyeOffset"===e?o[e]=new f.Cartesian3(...i):["scaleByDistance","pixelOffsetScaleByDistance","translucencyByDistance"].includes(e)?o[e]=Array.isArray(i)?new f.NearFarScalar(...i):void 0:o[e]="distanceDisplayCondition"===e?new f.DistanceDisplayCondition(...i):"font"===e&&i.endsWith("px")?i+" sans-serif":i}const s=new f.Entity({name:this._id,position:f.Cartesian3.fromDegrees(i,n,r),label:o});this._container.add(s)}setProperty(t){Object.assign(this.options,t);const{position:e}=t,i=this._container.getCollection();i.entities.values[0]&&i.entities.values.forEach(i=>{let n=i.label;if(e){const{lng:t,lat:n,alt:r}=e;i.position=f.Cartesian3.fromDegrees(t,n,r)}for(let e in t){let i=t[e];["backgroundColor","fillColor","outlineColor"].includes(e)?n[e]=f.Color.fromCssColorString(i):["backgroundPadding","pixelOffset"].includes(e)?n[e]=new f.Cartesian2(...i):"eyeOffset"===e?n[e]=new f.Cartesian3(...i):["scaleByDistance","pixelOffsetScaleByDistance","translucencyByDistance"].includes(e)?n[e]=Array.isArray(i)?new f.NearFarScalar(...i):void 0:n[e]="distanceDisplayCondition"===e?new f.DistanceDisplayCondition(...i):"font"===e&&i.endsWith("px")?i+" sans-serif":i}})}getEntity(){const t=this._container.getCollection().entities.values[0];if(t)return t}animateOpacity(t,e,i,n,r){setTimeout(()=>{const n=t.label;let o=[];const s=n.backgroundColor,a=n.fillColor,A=n.outlineColor;let l=e;if(s){const t=s.getValue().alpha;-1===e&&(l=f.Color.fromCssColorString(this.options.backgroundColor).alpha),o.push({startAlpha:t,targetAlpha:l,type:"backgroundColor"})}if(a){const t=a.getValue().alpha;-1===e&&(l=f.Color.fromCssColorString(this.options.fillColor).alpha),o.push({startAlpha:t,targetAlpha:l,type:"fillColor"})}if(A){const t=A.getValue().alpha;-1===e&&(l=f.Color.fromCssColorString(this.options.outlineColor).alpha),o.push({startAlpha:t,targetAlpha:l,type:"outlineColor"})}let c=Date.now();const u=()=>{const t=Date.now()-c;if(t>=i)return o.forEach(t=>{const{targetAlpha:e,type:i}=t;if(n[i].getValue().alpha!==e){const t=n[i].getValue().withAlpha(e);n[i].setValue(t)}}),r&&r(),c=0,void this._userViewer.viewer.instance.clock.onTick.removeEventListener(u);o.forEach(e=>{const{startAlpha:r,targetAlpha:o,type:s}=e,a=r+t/i*(o-r),A=n[s].getValue().withAlpha(a);n[s].setValue(A)})};this._userViewer.viewer.instance.clock.onTick.addEventListener(u)},n)}showAnimation(t=1e3,e=0,i){const n=this.getEntity();this.animateOpacity(n,-1,t,e,i)}hideAnimation(t=1e3,e=0,i){const n=this.getEntity();this.animateOpacity(n,0,t,e,i)}}var Mr=function(t,e,i,n){return new(i||(i=Promise))((function(r,o){function s(t){try{A(n.next(t))}catch(t){o(t)}}function a(t){try{A(n.throw(t))}catch(t){o(t)}}function A(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(s,a)}A((n=n.apply(t,e||[])).next())}))},Ur=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i};class Dr{constructor(t){this.modelInstance=null,this._id=$("model"),this._layerType="model",this._attachControl=null,this._options=Object.assign({color:"rgba(255, 255, 255, 1)"},t),this._modelEvent=new Br,t.viewer&&(this._userViewer=t.viewer),this.init()}init(){let t=this._options,{position:e,translation:i=[0,0,0],rotation:n=[0,0,0],scale:r=[1,1,1],id:o,props:s={},color:a="white",imageBasedLightingFactor:A=[1,1],lightColor:l=[1,1,1]}=t,c=Ur(t,["position","translation","rotation","scale","id","props","color","imageBasedLightingFactor","lightColor"]);this._props=s,this._modelParams=c,this._transformParams={position:new f.Cartesian3,rotation:n,scale:r};const u=Y.WGS84ToCartesian(e),h=this.createModelMatrix(u,i,n,r);this._modelParams.modelMatrix=h,this._modelParams.imageBasedLightingFactor=new f.Cartesian2(...A||[1,1]),this._modelParams.lightColor=new f.Cartesian3(...l),this._modelParams.color=f.Color.fromCssColorString(a),this._modelParams.id=this._id,c.distanceDisplayCondition&&(this._modelParams.distanceDisplayCondition=new f.DistanceDisplayCondition(...c.distanceDisplayCondition))}addToViewer(t){return Mr(this,void 0,void 0,(function*(){const e=Ur(this._modelParams,[]),{scale:i}=this._transformParams,{id:n,show:r=!0}=this._options,{viewer:o,ended:s}=t;o&&(o.viewer?this._userViewer=o:this._userViewer={viewer:o}),this._mapConfig=this._userViewer.viewer.mapConfig,this._userViewer.viewer.layerCache.add(this);let a="";a=n.toString().length>5?n:yield vt(this._mapConfig,n).catch(t=>{throw At("c030101",s),t}),this.modelInstance=f.Model.fromGltf(Object.assign({show:r,url:a,scale:i[0]},e)),e.label&&(this._label=new Lr(Object.assign({viewer:e.viewer,position:this._options.position},e.label)),this._label.addToViewer({viewer:e.viewer}));let A=this._userViewer.viewer.instance.scene.primitives.add(this.modelInstance);A.readyPromise.then(t=>{r||this.hideAnimation(0,0),this._animations=t.sceneGraph.components.animations,this._animations.length&&t.activeAnimations.add({index:0,loop:f.ModelAnimationLoop.REPEAT}),A.isLoad=!0,at(!0,s)}).catch(t=>{console.log("err",t),A.isLoad=!0,At("c030102",s)})}))}getProps(){if(this.modelInstance){const t=this.getPosition();if(t){const e=Y.CartesianToWGS84(t);e.heading=this._transformParams.rotation[2],e.pitch=this._transformParams.rotation[0],e.roll=this._transformParams.rotation[1],this._props.position=e}this._props.scale=this._transformParams.scale}return this._props}setPosition(t){if(!this.modelInstance)return;this._transformParams.rotation=[t.pitch,t.roll,t.heading];const e=Y.WGS84ToCartesian(t),i=[t.pitch,t.roll,t.heading],n=this._transformParams.scale,r=this.createModelMatrix(e,[0,0,0],i,n);this.modelInstance.modelMatrix=r,this.modelInstance.scale=n[0],this._attachControl&&this._attachControl.update(),this.setProperty({label:{position:t}})}setProperty(t){t.label&&this._label&&this._label.setProperty(t.label)}getAnimations(){return this._animations.map(t=>t.name)}setAnimation(t){if(this.modelInstance){this.modelInstance.activeAnimations.removeAll();this._animations.filter(e=>t.includes(e.name)).forEach(t=>{this.modelInstance.activeAnimations.add({index:t.index,loop:f.ModelAnimationLoop.REPEAT})})}}removeAnimation(){this.modelInstance&&this.modelInstance.activeAnimations.removeAll()}translateX(t){this.moveModel({translation:[t,0,0]})}translateY(t){this.moveModel({translation:[0,t,0]})}translateZ(t){this.moveModel({translation:[0,0,t]})}rotateX(t){this._transformParams.rotation[0]+=t,this.moveModel({rotation:this._transformParams.rotation})}rotateY(t){this._transformParams.rotation[1]+=t,this.moveModel({rotation:this._transformParams.rotation})}rotateZ(t){this._transformParams.rotation[2]+=t,this.moveModel({rotation:this._transformParams.rotation})}scale(t){this._transformParams.scale=t,this.moveModel({scale:this._transformParams.scale})}moveModel(t){if(!this.modelInstance)return;const{position:e,rotation:i,scale:n}=this._transformParams,{translation:r=[0,0,0]}=t,o=this.createModelMatrix(e,r,i,n);this.modelInstance.modelMatrix=o,this.modelInstance.scale=n[0],this._attachControl&&this._attachControl.update(),this.setProperty({label:{position:this.getProps().position}})}createModelMatrix(t,e=[0,0,0],i=[0,0,0],n=[1,1,1]){const r=f.Transforms.eastNorthUpToFixedFrame(t,f.Ellipsoid.WGS84),o=qn(r,e,i,[1,1,1]);return this._transformParams.position=f.Matrix4.getTranslation(o,new f.Cartesian3),o}remove(t={}){if(this._attachControl)return void console.error(st.property("c030201"));const{ended:e}=t;this.modelInstance&&(this.modelInstance.destroy(),this.modelInstance=null,this._props={},this._modelEvent=null,this._label&&this._label.remove(),this._userViewer.viewer.layerCache.remove(this),at(!0,e))}animateOpacity(t,e,i,n,r){setTimeout(()=>{let n=t.color.alpha,o=e;-1===e&&(o=f.Color.fromCssColorString(this._options.color).alpha);let s=Date.now();const a=()=>{const e=Date.now()-s;if(e>=i){if(t.color.alpha!==o){const e=f.Color.fromAlpha(t.color,o);t.color=e}return r&&r(),s=0,void this._userViewer.viewer.instance.clock.onTick.removeEventListener(a)}const A=n+e/i*(o-n),l=f.Color.fromAlpha(t.color,A);t.color=l};this._userViewer.viewer.instance.clock.onTick.addEventListener(a)},n)}showAnimation(t=1e3,e=0,i){this._attachControl?console.error("has bounded control!"):(this._label&&this._label.showAnimation(t,e),this.modelInstance&&!this.modelInstance.color||(this.modelInstance.show=!0,this.animateOpacity(this.modelInstance,-1,t,e,i)))}hideAnimation(t=1e3,e=0,i){this._attachControl?console.error("has bounded control!"):(this._label&&this._label.hideAnimation(t,e),this.animateOpacity(this.modelInstance,0,t,e,i))}on(t){const{event:e,handler:i}=t;return this._modelEvent.on(e,i,this),this}off(t){const{event:e}=t;this._modelEvent.off(e,this)}getPosition(){if(!this.modelInstance)return;const t=this.modelInstance.modelMatrix;return f.Matrix4.getTranslation(t,new f.Cartesian3)}getPositionMatrix(){if(!this.modelInstance)return;const t=this.modelInstance.modelMatrix,e=f.Matrix4.getTranslation(t,new f.Cartesian3);return f.Transforms.eastNorthUpToFixedFrame(e,f.Ellipsoid.WGS84)}}i(50);class Qr{constructor(t){this.options={anchor:"top-left",offset:[0,0]},this.anchorTranslate={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"},this._dragEvent={},this.position=t.position,this.options=Object.assign({},this.options,t),this.visible=!0,this.id=$(),this._userViewer=t.viewer,this.init()}init(){this.instance=document.createElement("div"),this.instance.className="div-icon",this.instance.oncontextmenu=t=>{t.preventDefault()},this.instance.setAttribute("id",this.id),this.instance.classList.add("popup"),this.instance.style.position="absolute",this.instance.style.top="0",this.instance.style.left="0"}getPosition(){return this.position}setProperty(t={}){t.position&&(this.position=t.position)}setStyle(t={}){t.position&&(this.position=t.position)}addToViewer(t){const{ended:e}=t,{element:i}=this.options,n=Bt.getEngine(this._userViewer);i&&("object"==typeof i?this.instance.appendChild(i):"string"==typeof i&&(this.instance.innerHTML=i)),this.postRenderFun=()=>{const t=this.options.anchor?this.anchorTranslate[this.options.anchor]:this.anchorTranslate["top-left"],e=this.options.offset||[0,0],{scaleByDistance:i}=this.options;let r=Y.WGS84ToWindowPosition(this.position,this._userViewer),o=Y.WGS84ToCartesian(this.position),s=n.camera.positionWC,a=f.Cartesian3.distance(f.Cartesian3.fromDegrees(this.position.lng,this.position.lat,this.position.alt),s);if(this._occluder=new f.EllipsoidalOccluder(f.Ellipsoid.WGS84,n.camera.position),Object(f.defined)(r)){let n=`translate3d(${r.x+e[0]}px, ${r.y+e[1]}px,0) ${t}`,s="scale3d(1, 1, 1)";if(i){const[t,e,n,r]=i;if(a<t)s=`scale3d(${e},${e},1)`;else if(a>n)s=`scale3d(${r},${r},1)`;else{let i=Math.abs(t-n),o=Math.abs(e-r)/i,A=e<r?a*o+e:e-a*o;s=`scale3d(${A},${A},1)`}}this.instance.style.transform=`${n} ${s}`;this._occluder.isPointVisible(o)?this.visible&&(this.instance.style.display="block"):this.instance.style.display="none"}else this.instance.style.display="none"},n._element.offsetParent.appendChild(this.instance),n.clock.onTick.addEventListener(this.postRenderFun),at(!0,e)}remove(t={}){const{ended:e}=t,i=Bt.getEngine(this._userViewer);this.instance&&(i._element.offsetParent.removeChild(this.instance),i.clock.onTick.removeEventListener(this.postRenderFun),at(!0,e))}show(){this.instance&&(this.visible=!0,this.instance.style.display="block")}hide(){this.instance&&(this.visible=!1,this.instance.style.display="none")}on(t){const{event:e,handler:i}=t;this.instance&&("dragstart"===e||"dragging"===e||"dragend"===e?this._dragEvent[e]=i:this.instance["on"+e]=t=>{i(t)})}off(t){const{event:e}=t;this.instance&&("dragstart"===e||"dragging"===e||"dragend"===e?this._dragEvent[e]=null:this.instance["on"+e]=null)}setDraggable(t){const e=t;if(this.instance)if(e){const t=this.instance;let e={left:0,top:0},i=!1;this._moveFn=t=>{if(!i)return;const n=t.x-e.left,r=t.y-e.top,o=Y.WindowPositionToWGS84(new f.Cartesian2(n,r),this._userViewer);o&&(this.position=o,this._dragEvent.dragging&&this._dragEvent.dragging(t))},t.onmousedown=t=>{const n=Y.WGS84ToWindowPosition(this.position,this._userViewer);i=!0,e.left=t.x-n.x,e.top=t.y-n.y,this._dragEvent.dragstart&&this._dragEvent.dragstart(t)},document.body.addEventListener("mousemove",this._moveFn),t.onmouseup=t=>{i=!1,this._dragEvent.dragend&&this._dragEvent.dragend(t)}}else{const t=this.instance;t.onmousedown=t.onmouseup=null,document.body.removeEventListener("mousemove",this._moveFn)}}}var Rr=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i};class Nr extends Pr{constructor(t){super(t),this._attachControl=null,this._hideControl=!1,this.options=Object.assign(Object.assign({},t),{label:Object.assign({fillColor:"#fff",backgroundColor:"rgba(42, 42, 42, 0.8)",outlineColor:"#000"},t.label)}),this._container=new Z("customDataSource"),this.init()}init(){const{position:t}=this.options||{};t&&this._handerData(this.options)}setSource(t){if(!this.query)return;const{ended:e}=t;this.query.queryCustomInfo(Object.assign(Object.assign({},t),{callback:t=>{if(t.data&&t.data.total>0){let i=t.data.data.filter(t=>"Point"==t.geometry.type).map(t=>Object.assign({position:{lng:t.geometry.coordinates[0],lat:t.geometry.coordinates[1],alt:t.geometry.coordinates[2]||0}},t.properties));this.makeBounding(i),this.setData(i,e)}}}))}setData(t,e){this.data=t,this._container.size>0&&this._container.removeAll();for(const e of t){let t=Object.assign({},this.options);const i=this.fieldMap.map(t=>t.props);for(let n of i){const i=this.fieldMap.find(t=>t.props===n);let r=(i||{}).value(e[i.field]);if(n.indexOf(".")>-1){const e=n.split(".")[0],i=n.split(".")[1];t[e][i]=r}else t[n]=r}t=Object.assign(Object.assign({},t),e),this._handerData(t)}at(!0,e)}getSource(){return this.data}_handerData(t){const{position:e,show:i=!0}=t,n=Rr(t,["position","show"]),{lng:r,lat:o,alt:s}=e;let a={color:f.Color.fromCssColorString("rgba(255,255,255,1.0)")},A={};if(t.label){const e=t.label;for(let t in e){let i=e[t];["backgroundColor","fillColor","outlineColor"].includes(t)?A[t]=f.Color.fromCssColorString(i):["backgroundPadding","pixelOffset"].includes(t)?A[t]=new f.Cartesian2(...i):"eyeOffset"===t?A[t]=new f.Cartesian3(...i):["scaleByDistance","pixelOffsetScaleByDistance","translucencyByDistance"].includes(t)?A[t]=Array.isArray(i)?new f.NearFarScalar(...i):void 0:A[t]="distanceDisplayCondition"===t?new f.DistanceDisplayCondition(...i):"font"===t&&i.endsWith("px")?i+" sans-serif":i}}for(let e in t){let i=t[e];if("image"===e){let t=typeof i;a[e]="function"===t?new f.CallbackProperty(i,!1):i}else"eyeOffset"===e?(i=i||[0,0,0],a[e]=new f.Cartesian3(...i)):"pixelOffset"===e?(i=i||[0,0],a[e]=new f.Cartesian2(...i)):a[e]="scaleByDistance"===e||"pixelOffsetScaleByDistance"===e||"translucencyByDistance"===e?Array.isArray(i)?new f.NearFarScalar(...i):void 0:"distanceDisplayCondition"===e?new f.DistanceDisplayCondition(...i):"rotation"===e?f.Math.toRadians(i):i}const l=new f.Entity({show:i,id:a.id,name:this._id,position:f.Cartesian3.fromDegrees(r,o,s),billboard:a,label:Object.assign({show:!!A.text},A),info:n});this._container.add(l),i||this.hideAnimation(0,0)}setProperty(t){t.label?this.options=Object.assign(Object.assign({},this.options),{label:Object.assign(Object.assign({},this.options.label),t.label)}):Object.assign(this.options,t);const{position:e}=t,i=this._container.getCollection();i.entities.values[0]&&i.entities.values.forEach(i=>{let n=i.billboard,r=i.label;if(e){const{lng:t,lat:n,alt:r}=e;i.position=f.Cartesian3.fromDegrees(t,n,r)}if(t.label){const e=t.label;for(let t in e){let i=e[t];["backgroundColor","fillColor","outlineColor"].includes(t)?r[t]=f.Color.fromCssColorString(i):["backgroundPadding","pixelOffset"].includes(t)?r[t]=new f.Cartesian2(...i):"eyeOffset"===t?r[t]=new f.Cartesian3(...i):["scaleByDistance","pixelOffsetScaleByDistance","translucencyByDistance"].includes(t)?r[t]=Array.isArray(i)?new f.NearFarScalar(...i):void 0:r[t]="distanceDisplayCondition"===t?new f.DistanceDisplayCondition(...i):"font"===t&&i.endsWith("px")?i+" sans-serif":i}}for(let e in t){let i=t[e];if("image"===e){let t=typeof i;n[e]="function"===t?new f.CallbackProperty(i,!1):i}else"eyeOffset"===e?(i=i||[0,0,0],n[e]=new f.Cartesian3(...i)):"pixelOffset"===e?(i=i||[0,0],n[e]=new f.Cartesian2(...i)):n[e]="scaleByDistance"===e||"pixelOffsetScaleByDistance"===e||"translucencyByDistance"===e?Array.isArray(i)?new f.NearFarScalar(...i):void 0:"distanceDisplayCondition"===e?new f.DistanceDisplayCondition(...i):"rotation"===e?f.Math.toRadians(i):i}})}setPosition(t={}){let e=t.entityId;if(e){let i=this._userViewer.viewer.instance,n=t.windowPosition,r=this._container.getCollection().entities.getById(e);if(r){let t=r.position.getValue(i.clock.currentTime),e=i.scene.globe.ellipsoid.cartesianToCartographic(t),o=f.Ellipsoid.WGS84.geodeticSurfaceNormal(t,new f.Cartesian3),s=f.Plane.fromPointNormal(t,o),a=i.camera.getPickRay(new f.Cartesian2(n.x,n.y)),A=f.IntersectionTests.rayPlane(a,s);if(A){let t=i.scene.globe.ellipsoid.cartesianToCartographic(A);r.position=f.Cartesian3.fromRadians(t.longitude,t.latitude,e.height)}}}else{const e=this._container.getCollection().entities.values[0],{lng:i,lat:n,alt:r}=t;e.position=f.Cartesian3.fromDegrees(i,n,r),this._attachControl&&this._attachControl.update()}}getPosition(t={}){let e=t.entityId;if(e){let t=this._container.getCollection().entities.getById(e);if(t){let e=t.position._value,i=Bt.getEngine(this._userViewer).scene.globe.ellipsoid.cartesianToCartographic(e);return new I(f.Math.toDegrees(i.longitude),f.Math.toDegrees(i.latitude),i.height)}return null}{const t=this._container.getCollection().entities.values[0];if(!t)return;return t.position._value}}getPositionMatrix(){const t=this._container.getCollection().entities.values[0];if(!t)return;const e=t.position._value;return f.Transforms.eastNorthUpToFixedFrame(e,f.Ellipsoid.WGS84)}getProps(){const t={},e=this._container.getCollection().entities.values[0];if(e){const i=this.getPosition();if(i){const e=Y.CartesianToWGS84(i);t.position=e}const n=e.billboard;t.width=n.width.getValue(),t.height=n.height.getValue(),t.rotation=f.Math.toDegrees(n.rotation&&n.rotation.getValue())}return t}getEntity(){const t=this._container.getCollection().entities.values[0];if(t)return t}animateOpacity(t,e,i,n,r){setTimeout(()=>{const n=t.billboard;let o=n.color.getValue().alpha,s=e;-1===e&&(s=1);const a=t.label;let A=[];const l=a.backgroundColor,c=a.fillColor,u=a.outlineColor;if(l){const t=l.getValue().alpha;-1===e&&(s=f.Color.fromCssColorString(this.options.label.backgroundColor).alpha),A.push({startAlpha:t,targetAlpha:s,type:"backgroundColor"})}if(c){const t=c.getValue().alpha;-1===e&&(s=f.Color.fromCssColorString(this.options.label.fillColor).alpha),A.push({startAlpha:t,targetAlpha:s,type:"fillColor"})}if(u){const t=u.getValue().alpha;-1===e&&(s=f.Color.fromCssColorString(this.options.label.outlineColor).alpha),A.push({startAlpha:t,targetAlpha:s,type:"outlineColor"})}let h=Date.now();const p=()=>{const t=Date.now()-h;if(t>=i){if(n.color.getValue().alpha!==s){const t=n.color.getValue().withAlpha(s);n.color.setValue(t),n.show&&n.show.setValue(!0)}return A.forEach(t=>{const{targetAlpha:e,type:i}=t;if(a[i].getValue().alpha!==e){const t=a[i].getValue().withAlpha(e);a[i].setValue(t)}}),r&&r(),h=0,void this._userViewer.viewer.instance.clock.onTick.removeEventListener(p)}const e=o+t/i*(s-o),l=n.color.getValue().withAlpha(e);n.color.setValue(l),A.forEach(e=>{const{startAlpha:n,targetAlpha:r,type:o}=e,s=n+t/i*(r-n),A=a[o].getValue().withAlpha(s);a[o].setValue(A)})};this._userViewer.viewer.instance.clock.onTick.addEventListener(p)},n)}showAnimation(t=1e3,e=0,i){this._hideControl&&(this._attachControl&&this._attachControl.setVisible(),this._hideControl=!1);const n=this.getEntity();n.show=!0,this.animateOpacity(n,-1,t,e,i)}hideAnimation(t=1e3,e=0,i){this._attachControl&&(this._attachControl.hideAll(),this._hideControl=!0);const n=this.getEntity();this.animateOpacity(n,0,t,e,i)}}var Hr=function(t,e,i,n){return new(i||(i=Promise))((function(r,o){function s(t){try{A(n.next(t))}catch(t){o(t)}}function a(t){try{A(n.throw(t))}catch(t){o(t)}}function A(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(s,a)}A((n=n.apply(t,e||[])).next())}))};const kr=[{min:1,max:10,size:40,isFill:!0,fillColor:"rgba(81,187,214,0.9)",shape:E.CIRCLE,fontSize:16,fontColor:"#FFFFFF",textOffset:[0,0],scale:1},{min:10,max:100,size:40,isFill:!0,fillColor:"rgba(241,240,117,0.9)",shape:E.CIRCLE,fontSize:16,fontColor:"#FFFFFF",textOffset:[0,0],scale:1},{min:100,max:1e3,size:40,isFill:!0,fillColor:"rgba(242,140,177,0.9)",shape:E.CIRCLE,fontSize:16,fontColor:"#FFFFFF",textOffset:[0,0],scale:1}];class Vr{constructor(t){this._dataCache=[],this._modelCache={},this._iconMode="",this._isFirstRequest=!0;const{viewer:e}=t;this._id=$("custom"),this._layerType="layer",this._constructOptions=t,this._clusterStyleJson=t.clusterstyle||kr,this._layerEvent=new Cr,this._moveendHandler=this._moveendHandler.bind(this),this._iconMode=this._constructOptions.iconMode||"image",this._dataSource=new f.CustomDataSource,e&&(this._usrViewer=e,this._config=e.viewer.mapConfig,this._queryModule=new Or({viewer:this._usrViewer}))}addToViewer(t,e){return Hr(this,void 0,void 0,(function*(){const{viewer:e,ended:i}=t;if(this._modelCache=yield this._preHandleModel(),!1===this._modelCache)return void At("c030102",i);if(e&&(this._usrViewer=e,this._config=e.viewer.mapConfig,this._queryModule=new Or({viewer:this._usrViewer})),this._defaultImg=new Image,this._defaultImg.src=this._config.distUrl+"Imgs/circle_red.png",!this._usrViewer.viewer.spriteJson)return void At("c010109",i);this._spriteJSON=this._usrViewer.viewer.spriteJson,this._originalViewer=this._usrViewer.viewer.instance,this._originalViewer.dataSources.add(this._dataSource),this._usrViewer.viewer.layerCache.add(this),this._usrViewer.viewer.spriteImage?this._spriteImage=this._usrViewer.viewer.spriteImage:yield this._loadSpriteImage(),void 0!==this._constructOptions.clusterIcon&&this._constructOptions.clusterIcon.startsWith("http")&&(yield this._loadClusterImage(this._constructOptions.clusterIcon)),this._registerMoveendEvent();if(!(yield this._query()))return At("c010113",i),void this.remove();if(this._isFirstRequest=!1,at(!0,i),this._constructOptions.timer){const t=this._constructOptions.timer;this._timer=setInterval(()=>{this._query()},t)}}))}setIconMode(t){this._dataSource&&(this._iconMode=t,this._query())}remove(t={}){this._unregisterMoveendEvent(),clearInterval(this._timer),this._timer=null;const{ended:e}=t;if(this._dataSource){let t=this._originalViewer.dataSources.remove(this._dataSource);t&&(this._dataSource=null,this._layerEvent=null,this._usrViewer.viewer.layerCache.remove(this)),at(t,e)}}show(){if(this._dataSource){const t=this._dataSource.entities.values;this.animateOpacity(t,1)}}hide(){if(this._dataSource){const t=this._dataSource.entities.values;this.animateOpacity(t,0)}}animateOpacity(t,e){t.forEach(t=>{if("image"===this._iconMode){const i=t.billboard;i&&(i.show=Boolean(e))}if("model"===this._iconMode){const i=t.model;i&&(i.show=Boolean(e))}const i=t.label;if(i){const t=i.backgroundColor,n=i.fillColor,r=i.outlineColor;if(t){const n=t.getValue().withAlpha(e);i.backgroundColor.setValue(n)}if(n){const t=n.getValue().withAlpha(e);i.fillColor.setValue(t)}if(r){const t=r.getValue().withAlpha(e);i.outlineColor.setValue(t)}}})}on(t){if(this._dataSource){const{event:e,handler:i}=t;this._layerEvent.on(e,i,this)}}off(t){if(this._dataSource){const{event:e}=t;this._layerEvent.off(e,this)}}computeViewRectangle(){var t=this._originalViewer.camera.computeViewRectangle();if(t){const e=f.Math.toDegrees(t.east),i=f.Math.toDegrees(t.north),n=f.Math.toDegrees(t.west),r=f.Math.toDegrees(t.south);return{type:"Polygon",coordinates:[[[n,i],[e,i],[e,r],[n,r],[n,i]]]}}{const t=this._originalViewer;let e=t.scene.canvas,i=new f.Cartesian2(0,0),n=new f.Cartesian2(e.clientWidth,e.clientHeight),r=t.scene.globe.ellipsoid,o=t.camera.pickEllipsoid(i,r),s=t.camera.pickEllipsoid(n,r),a=t.scene.globe.ellipsoid.cartesianToCartographic(o),A=t.scene.globe.ellipsoid.cartesianToCartographic(s),l=f.Math.toDegrees(a.longitude),c=f.Math.toDegrees(A.longitude),u=f.Math.toDegrees(A.latitude),h=f.Math.toDegrees(a.latitude);return{type:"Polygon",coordinates:[[[l,h],[c,h],[c,u],[l,u],[l,h]]]}}}_getSpriteName(t){const{icons:e}=this._constructOptions;let i={iconName:"bus-15",scale:1,mId:0};return e&&e.length>0&&e.forEach(e=>{if(e.filter&&e.filter.length>0){e.filter.every(e=>e.key&&t[e.key]===e.value)&&(i.iconName=e.iconName,i.mId=e.mId||0,i.scale=e.scale||1)}else i.iconName=e.iconName,i.mId=e.mId||0,i.scale=e.scale||1}),i}_getFields(t){if(!t)return!1;const e=t.match(/\{(.+?)\}/g);if(!e)return!1;return e.map(t=>t.substring(1,t.length-1))}_getLabelText(t,e){return e[t]||""}_handerLabel(t,e){let i={fillColor:f.Color.fromCssColorString("#fff"),backgroundColor:f.Color.fromCssColorString("rgba(42, 42, 42, 0.8)"),outlineColor:f.Color.fromCssColorString("#000"),text:t,disableDepthTestDistance:Number.POSITIVE_INFINITY};for(let t in e){let n=e[t];["backgroundColor","fillColor","outlineColor"].includes(t)?i[t]=f.Color.fromCssColorString(n):["backgroundPadding","pixelOffset"].includes(t)?i[t]=new f.Cartesian2(...n):"eyeOffset"===t?i[t]=new f.Cartesian3(...n):["scaleByDistance","pixelOffsetScaleByDistance","translucencyByDistance"].includes(t)?i[t]=Array.isArray(n)?new f.NearFarScalar(...n):void 0:i[t]="distanceDisplayCondition"===t?new f.DistanceDisplayCondition(...n):"font"===t&&n.endsWith("px")?n+" sans-serif":n}return i}_loadSpriteImage(){return Hr(this,void 0,void 0,(function*(){return new Promise((t,e)=>{const i=new Image;i.onload=()=>{this._spriteImage=this._usrViewer.viewer.spriteImage=i,t(!0)},i.src=1===window.devicePixelRatio?this._config.spriteUrl+"/sprite.png":this._config.spriteUrl+"/sprite@2x.png",i.crossOrigin="Anonymous"})}))}_loadClusterImage(t){return Hr(this,void 0,void 0,(function*(){return new Promise((e,i)=>{const n=new Image;n.onload=()=>{this._clusterImage=n,e(!0)},n.src=t,n.crossOrigin="Anonymous"})}))}_registerMoveendEvent(){this._originalViewer.camera.moveEnd.addEventListener(this._moveendHandler,this._originalViewer)}_unregisterMoveendEvent(){this._originalViewer.camera.moveEnd.removeEventListener(this._moveendHandler,this._originalViewer)}_moveendHandler(){this._constructOptions.clustered&&this._query()}query(t){this._dataSource&&(this._constructOptions=Object.assign(Object.assign({},this._constructOptions),t),t.iconMode&&(this._iconMode=t.iconMode),t.clusterstyle&&(this._clusterStyleJson=t.clusterstyle),this._query())}_resolveData(t={}){this._runtimeData=t.data||[],this._spriteImage&&(this._constructOptions.clustered?this._manualRender():this._unclusterRender())}_unclusterRender(){const{scaleByDistance:t,label:e={},distanceDisplayCondition:i,disableDepthTestDistance:n}=this._constructOptions,r=e.text,o=this._getFields(e.text);delete e.text;const s=this._getRuntimeDataKeys(),a=this._dataCache;let A=[];a.forEach((t,e)=>{s.indexOf(t)>-1&&A.push(t)}),this._dataCache=A;this._dataSource.entities.values.slice(0).forEach(t=>{const e=t.info&&(t.info.dataId||t.info.id);s.indexOf(e)>-1||this._dataSource.entities.remove(t)}),this._runtimeData.data&&this._runtimeData.data.forEach((s,a)=>{if(s.location&&"Point"!==s.location.type||s.geometry&&"Point"!==s.geometry.type)return void console.error("invalid data!",JSON.stringify(s));const A=s.properties?s.properties:s,l=A.dataId||A.id;if(this._dataCache.indexOf(l)>-1){const t=this._getEntityByDataId(l);"image"===this._iconMode?(t.billboard.show=!0,t.model.show=!1):"model"===this._iconMode&&(t.billboard.show=!1,t.model.show=!0)}else{const a=this._getSpriteName(A),{scale:l}=a,c=(s.location||s.geometry).coordinates,u=f.Cartesian3.fromDegrees(c[0],c[1],c[2]||0);if(u){let s={position:u,name:this._id,info:A};if(o&&o.length){let t=r;o.forEach(e=>{const i=this._getLabelText(e,A);t=t.replace(`{${e}}`,i)});const i=t.split("\n");if(i.length>1){const e=i.map(t=>t.length>12?`${t.substring(0,12)}\n${t.substring(12,t.length)}`:t);t=e.join("\n")}else t.length>12&&(t=`${t.substring(0,12)}\n${t.substring(12,t.length)}`);const n=this._handerLabel(t,e);s.label=n}let c,h=this._spriteJSON[a.iconName];if(h){c=document.createElement("canvas");const t=c.getContext("2d");c.width=h.width,c.height=h.height,t&&t.drawImage(this._spriteImage,h.x,h.y,h.width,h.height,0,0,h.width,h.height)}else c=this._getDefaultIconCanvas();s.billboard={show:"image"===this._iconMode,image:c,verticalOrigin:f.VerticalOrigin.BOTTOM,width:l*((h||{}).width||16),height:l*((h||{}).height||16),disableDepthTestDistance:n||Number.POSITIVE_INFINITY,scaleByDistance:t?new f.NearFarScalar(...t):null,distanceDisplayCondition:i?new f.DistanceDisplayCondition(...i):null};let p=this._modelCache[a.mId]||this._usrViewer.viewer.mapConfig.distUrl+"Imgs/device.glb";s.model={show:"model"===this._iconMode,uri:p,scale:l},this._dataCache.push(s.info.dataId||s.info.id),this._dataSource.entities.add(s)}else console.error("invalid data!",JSON.stringify(s))}})}_manualRender(){const{scaleByDistance:t,distanceDisplayCondition:e,disableDepthTestDistance:i}=this._constructOptions,n=this._getClusterRuntimeDataKeys(),r=this._dataCache;let o=[];r.forEach((t,e)=>{n.indexOf(t)>-1&&o.push(t)}),this._dataCache=o;this._dataSource.entities.values.slice(0).forEach(t=>{const e=t.info&&(t.info.dataId||t.info.id);n.indexOf(e)>-1||this._dataSource.entities.remove(t)});for(const n of this._runtimeData)if(n.size&&!n.gps);else if(1===n.size){const r=n.points[0],o=r.gps,s=r.mapFields,a=s.dataId||s.id;if(this._dataCache.indexOf(a)>-1){const t=this._getEntityByDataId(a);"image"===this._iconMode?(t.billboard.show=!0,t.model.show=!1):"model"===this._iconMode&&(t.billboard.show=!1,t.model.show=!0)}else{const n=this._getSpriteName(s),{scale:r}=n;let a={position:f.Cartesian3.fromDegrees(o.x,o.y,o.z),name:this._id,info:s};const A=this._spriteJSON[n.iconName];let l;if(A){l=document.createElement("canvas");const t=l.getContext("2d");l.width=A.width,l.height=A.height,t&&t.drawImage(this._spriteImage,A.x,A.y,A.width,A.height,0,0,A.width,A.height)}else l=this._getDefaultIconCanvas();a.billboard={show:"image"===this._iconMode,image:l,verticalOrigin:f.VerticalOrigin.BOTTOM,width:r*((A||{}).width||16),height:r*((A||{}).height||16),disableDepthTestDistance:i||Number.POSITIVE_INFINITY,scaleByDistance:t?new f.NearFarScalar(...t):null,distanceDisplayCondition:e?new f.DistanceDisplayCondition(...e):null};let c=this._modelCache[n.mId]||this._usrViewer.viewer.mapConfig.distUrl+"Imgs/device.glb";a.model={show:"model"===this._iconMode,uri:c,scale:r},this._dataCache.push(a.info.dataId||a.info.id),this._dataSource.entities.add(a)}}else if(n.gps){const t=n.gps,r=this.drawImage(this._clusterStyleJson,n.size);this._dataSource.entities.add({position:f.Cartesian3.fromDegrees(t.x,t.y,t.z),billboard:{image:r,verticalOrigin:f.VerticalOrigin.BOTTOM,show:!0,width:r.width,height:r.height,disableDepthTestDistance:i||Number.POSITIVE_INFINITY,distanceDisplayCondition:e?new f.DistanceDisplayCondition(...e):null},name:this._id,info:Object.assign(Object.assign({},n),{isPublic:!!this._constructOptions.isPublic})})}}_getDefaultIconCanvas(){const t=document.createElement("canvas"),e=t.getContext("2d");return t.width=16,t.height=16,e&&e.drawImage(this._defaultImg,0,0,16,16),t}_preHandleModel(){return Hr(this,void 0,void 0,(function*(){return new Promise((t,e)=>{const{icons:i}=this._constructOptions,n=[];if(i&&i.length>0&&i.forEach(t=>{t.mId&&n.push(t.mId)}),!n.length)return void t({});const r=[];n.forEach(t=>{r.push(vt(this._usrViewer.viewer.mapConfig,t))});const o={};Promise.all(r).then(e=>{e.forEach((t,e)=>{o[n[e]]=t}),t(o)}).catch(e=>{t(!1)})})}))}_getRuntimeDataKeys(){if(Array.isArray(this._runtimeData)&&0===this._runtimeData.length)return[];return this._runtimeData.data.map(t=>{const e=t.properties?t.properties:t;return e.dataId||e.id})}_getClusterRuntimeDataKeys(){return this._runtimeData.filter(t=>1===t.size&&t.points).map(t=>{const e=t.points[0].mapFields;return e.dataId||e.id})}_getEntityByDataId(t){let e;return this._dataSource.entities.values.forEach(i=>{(i.info&&(i.info.dataId||i.info.id))===t&&(e=i)}),e}drawImage(t,e){const i=t.findIndex(t=>e<=(t.max||Number.MAX_VALUE)&&e>=(t.min||1)),n=Object.assign({},kr[0],t[i]);let r=document.createElement("canvas");const o=this._constructOptions.clusterIcon;if(void 0!==o){const{scale:t,fontSize:i,fillColor:s,fontColor:a,textOffset:A}=n,l=A[0],c=i+2*A[1]+2;let u,h=0,p=0;if(o.startsWith("http"))h=this._clusterImage.width*t,p=this._clusterImage.height*t+c,r.width=h,r.height=p,u=r.getContext("2d"),u.drawImage(this._clusterImage,0,0,this._clusterImage.width,this._clusterImage.height,0,c,this._clusterImage.width*t,this._clusterImage.height*t);else if(""===o){const{icons:e}=this._constructOptions;if(e&&e.length>0){const i=e[0].iconName,n=this._spriteJSON[i];h=n.width*t,p=n.height*t+c,r.width=h,r.height=p,u=r.getContext("2d"),u.drawImage(this._spriteImage,n.x,n.y,n.width,n.height,0,c,n.width*t,n.height*t)}}else{const e=this._spriteJSON[o];h=e.width*t,p=e.height*t+c,r.width=h,r.height=p,u=r.getContext("2d"),e&&u.drawImage(this._spriteImage,e.x,e.y,e.width,e.height,0,c,e.width*t,e.height*t)}u.font=i+"px bold PingFangSC-Medium-GBpc-EUC-H";const d=Math.ceil(u.measureText(e).width)+2*l+2,f=(h-d)/2;switch(u.fillStyle=s,u.beginPath(),n.shape){case E.CIRCLE:u.roundRect?u.roundRect(f,0,d,c,c/2):this.fillRoundRect(u,f,0,d,c,c/2);break;case E.RECT:u.rect(f,0,d,c);break;default:u.roundRect?u.roundRect(f,0,d,c,c/2):this.fillRoundRect(u,f,0,d,c,c/2)}u.fill(),u.closePath(),u.fillStyle=a,u.textAlign="center",u.textBaseline="middle",u.fillText(e,h/2,c/2+1)}else{r.width=r.height=n.size+4;let t=r.getContext("2d");switch(t.fillStyle=n.fillColor,t.strokeStyle="rgba(191,239,255,0.9)",t.beginPath(),n.shape){case E.CIRCLE:t.arc(r.width/2,r.height/2,n.size/2,0,2*Math.PI);break;case E.RECT:t.rect(2,2,n.size,n.size);break;default:t.arc(r.width/2,r.height/2,n.size/2,0,2*Math.PI)}n.isFill&&t.fill(),t.stroke(),t.closePath(),t.font=n.fontSize+"px bold PingFangSC-Medium-GBpc-EUC-H",t.fillStyle=n.fontColor,t.textAlign="center",t.textBaseline="middle",t.fillText(e,n.size/2+2,n.size/2+2+1)}return r}fillRoundRect(t,e,i,n,r,o){if(2*o>n||2*o>r)return!1;t.save(),t.translate(e,i),this.drawRoundRectPath(t,n,r,o),t.fill(),t.restore()}drawRoundRectPath(t,e,i,n){t.beginPath(0),t.arc(e-n,i-n,n,0,Math.PI/2),t.lineTo(n,i),t.arc(n,i-n,n,Math.PI/2,Math.PI),t.lineTo(0,n),t.arc(n,n,n,Math.PI,3*Math.PI/2),t.lineTo(e-n,0),t.arc(e-n,n,n,3*Math.PI/2,2*Math.PI),t.lineTo(e,i-n),t.closePath()}}var jr=function(t,e,i,n){return new(i||(i=Promise))((function(r,o){function s(t){try{A(n.next(t))}catch(t){o(t)}}function a(t){try{A(n.throw(t))}catch(t){o(t)}}function A(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(s,a)}A((n=n.apply(t,e||[])).next())}))};class Gr extends Vr{constructor(t){super(t)}_query(){return jr(this,void 0,void 0,(function*(){return new Promise((t,e)=>{const i=this._usrViewer.getCurrentCameraInfo().data,n=i.lat,r=i.lng,o=i.alt,s={pageNumber:1,adcode:"",pageSize:this._constructOptions.maxCount||1e3,fov:this._originalViewer.camera.frustum.fov||f.Math.PI_OVER_THREE,heading:this._originalViewer.camera.heading,pitch:this._originalViewer.camera.pitch,roll:this._originalViewer.camera.roll,range:this._constructOptions.clusteredRadius||100,point3D:{x:r,y:n,z:o},location:this._constructOptions.polygon?{type:"Polygon",coordinates:this._constructOptions.polygon}:this.computeViewRectangle(),pgPoint:{x:this._originalViewer.canvas.clientWidth,y:this._originalViewer.canvas.clientHeight},dataType:1,callback:e=>{this._isFirstRequest&&e&&20===e.status?t(!1):(this._resolveData(e&&e.result?e.result:e),t(!0))}};this._constructOptions.searchType&&this._constructOptions.searchType.length>0&&(s.filterTerms=[{column:"kindcode",value:this._constructOptions.searchType,termType:"in",type:"and",filterType:1}]),this._constructOptions.clustered?this._queryModule.query3DBaseCluster(s):this._queryModule.queryPoiInfo(Object.assign(Object.assign({},this._constructOptions),{callback:e=>{this._isFirstRequest&&e&&20===e.status?t(!1):(this._resolveData(e&&e.result?e.result:e),t(!0))}}))})}))}}var Kr=function(t,e,i,n){return new(i||(i=Promise))((function(r,o){function s(t){try{A(n.next(t))}catch(t){o(t)}}function a(t){try{A(n.throw(t))}catch(t){o(t)}}function A(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(s,a)}A((n=n.apply(t,e||[])).next())}))};class zr extends Vr{constructor(t){super(t)}_query(){return Kr(this,void 0,void 0,(function*(){return new Promise((t,e)=>{const i=this._usrViewer.getCurrentCameraInfo().data,n=i.lat,r=i.lng,o=i.alt,s={appName:this._constructOptions.isPublic?"public_space":this._config.userName,serviceNames:[this._constructOptions.serviceName],pageNumber:this._constructOptions.pageNo||1,adcode:this._constructOptions.adcode||"",pageSize:this._constructOptions.maxCount||1e3,fov:this._originalViewer.camera.frustum.fov||f.Math.PI_OVER_THREE,heading:this._originalViewer.camera.heading,pitch:this._originalViewer.camera.pitch,roll:this._originalViewer.camera.roll,range:this._constructOptions.clusteredRadius||100,isPublic:this._constructOptions.isPublic,point3D:{x:r,y:n,z:o},location:this._constructOptions.polygon?{type:"Polygon",coordinates:this._constructOptions.polygon}:this.computeViewRectangle(),pgPoint:{x:this._originalViewer.canvas.clientWidth,y:this._originalViewer.canvas.clientHeight},callback:e=>{this._isFirstRequest&&e&&20===e.status?t(!1):(this._resolveData(e&&e.result?e.result:e),t(!0))}};this._constructOptions.mixTerms&&(s.filterTerms=this._constructOptions.mixTerms),this._constructOptions.clustered?this._queryModule.query3DDeviceCluster(s):this._queryModule.queryCustomInfo(Object.assign(Object.assign({},this._constructOptions),{callback:e=>{this._isFirstRequest&&e&&20===e.status?t(!1):(this._resolveData(e&&e.result?e.result:e),t(!0))}}))})}))}}class Wr{constructor(t){this._id=$("geometry"),this._layerType="layer",this._style={"circle-color":"#f00","circle-radius":1,"circle-stroke-width":1,"circle-stroke-color":"#f00","circle-height":0,"line-type":"solid","line-color":"#f00","line-width":1,"line-height":0,"fill-color":"#f00","fill-height":0,"fill-outline-color":"#f00","fill-outline-width":0,"fill-outline-type":"solid","clamp-to-ground":!1,"is-dynamic":!1,"extruded-height":0},this._style=Object.assign(this._style,t.defaultStyles),this.points=new f.PointPrimitiveCollection,this.polylines=new f.PolylineCollection,this.primitiveCollection=new f.PrimitiveCollection,this.polygons=new f.CustomDataSource,this._layerEvent=new Cr,t.viewer?(this._userViewer=t.viewer,this.init(t.data)):this.init(t)}init(t){const e=t.features;Object(g.forEach)(e,t=>{switch(t.geometry.type){case"Point":this.addPoint(t);break;case"MultiPoint":this.addMultiPoint(t);break;case"LineString":this.addPolyline(t);break;case"MultiLineString":this.addMultiPolyline(t);break;case"Polygon":this.addPolygon(t);break;case"MultiPolygon":this.addMultiPolygon(t)}})}addToViewer(t){const{viewer:e,ended:i}=t;e&&(this._userViewer=e),this.viewer=this._userViewer.viewer.instance,this._userViewer.viewer.layerCache.add(this),this.points.length&&this.primitiveCollection.add(this.points),this.polylines.length&&this.primitiveCollection.add(this.polylines),this.polygons.entities.values.length&&this.viewer.dataSources.add(this.polygons),this.viewer.scene.primitives.add(this.primitiveCollection),at(!0,i)}remove(t={}){const{ended:e}=t;this.viewer.scene.primitives.remove(this.primitiveCollection),this.viewer.dataSources.remove(this.polygons),this._layerEvent=null,this._userViewer.viewer.layerCache.remove(this),at(!0,e)}show(){this.primitiveCollection.show=!0,this.polygons.show=!0}hide(){this.primitiveCollection.show=!1,this.polygons.show=!1}setStyle(t,e,i){if(t.startsWith("circle-")){const{color:i,pixelSize:n,outlineColor:r,outlineWidth:o}=this.getStyle({[t]:e},"point"),s=this.points;for(let t=0;t<s.length;t++){const e=s.get(t);e.color=i,e.pixelSize=n,e.outlineColor=r,e.outlineWidth=o}}else if(t.startsWith("line-")){const{color:i,width:n}=this.getStyle({[t]:e},"polyline"),r=this.polylines;for(let t=0;t<r.length;t++){const e=r.get(t);e.width=n,e.material=f.Material.fromType("Color",{color:i})}}else if(t.startsWith("fill-")||t.startsWith("clamp-")){const{color:n,outlineColor:r,outlineWidth:o,outlineType:s,clampToGround:a}=this.getStyle({[t]:e},"polygon");this.polygons.entities.values.forEach(t=>{if(!i||t.id===i){if(t.polygon){const e=t.polygon;e.material=n,i||(e.classificationType=a?f.ClassificationType.BOTH:void 0,e.perPositionHeight=!a||void 0)}if(t.polyline){const e=t.polyline;let i;i="dashed"===s?new f.PolylineDashMaterialProperty({color:r}):r,e.width=o,e.material=i,e.classificationType=a?f.ClassificationType.BOTH:void 0,e.clampToGround=!!a||void 0}}})}}setData(t){this.points.removeAll(),this.polylines.removeAll(),this.polygons.entities.removeAll(),this.init(t)}on(t){const{event:e,handler:i}=t;this._layerEvent.on(e,i,this)}off(t){const{event:e}=t;this._layerEvent.off(e,this)}addPoint(t){const e=t.geometry.coordinates,i=t.properties,n=this.getStyle(i,"point");this._addPoint(e,n)}addMultiPoint(t){const e=t.geometry.coordinates,i=t.properties,n=this.getStyle(i,"point");Object(g.forEach)(e,t=>{this._addPoint(t,n)})}addPolyline(t){const e=t.geometry.coordinates,i=t.properties,n=this.getStyle(i,"polyline");this._addPolyline(e,n)}addMultiPolyline(t){const e=t.geometry.coordinates,i=t.properties,n=this.getStyle(i,"polyline");Object(g.forEach)(e,t=>{this._addPolyline(t,n)})}addPolygon(t){const e=t.geometry.coordinates,i=t.properties,n=this.getStyle(i,"polygon");this._addPolygon(e,n)}addMultiPolygon(t){const e=t.geometry.coordinates,i=t.properties,n=this.getStyle(i,"polygon");Object(g.forEach)(e,t=>{this._addPolygon(t,n)})}getStyle(t,e){const i=Object.assign(this._style,t);if("point"===e){return{color:f.Color.fromCssColorString(i["circle-color"]),height:i["circle-height"],pixelSize:i["circle-radius"],outlineWidth:i["circle-stroke-width"],outlineColor:f.Color.fromCssColorString(i["circle-stroke-color"])}}if("polyline"===e){return{color:f.Color.fromCssColorString(i["line-color"]),height:i["line-height"],width:i["line-width"],type:i["line-type"]}}if("polygon"===e){return{color:f.Color.fromCssColorString(i["fill-color"]),height:i["fill-height"],outlineColor:f.Color.fromCssColorString(i["fill-outline-color"]),outlineWidth:i["fill-outline-width"],outlineType:i["fill-outline-type"],clampToGround:i["clamp-to-ground"],isDynamic:i["is-dynamic"],extrudedHeight:i["extruded-height"],info:t}}}_addPoint(t,e){const{color:i,height:n,pixelSize:r,outlineColor:o,outlineWidth:s}=e,a={color:i,position:f.Cartesian3.fromDegrees(t[0],t[1],n),pixelSize:r,outlineColor:o,outlineWidth:s,id:this._id};this.points.add(a)}_addPolyline(t,e){const{color:i,height:n,width:r,type:o}=e,s=t.map(t=>{let e=t.concat();return 2===e.length?e.push(n):e[2]=n,e}),a=f.Cartesian3.fromDegreesArrayHeights(Object(g.flattenDeep)(s));let A;A="dashed"===o?f.Material.fromType("PolylineDash",{color:i}):f.Material.fromType("Color",{color:i}),this.polylines.add({positions:a,width:r,material:A,id:this._id})}_addPolygon(t,e){const{color:i,height:n,outlineColor:r,outlineWidth:o,outlineType:s,clampToGround:a,isDynamic:A,extrudedHeight:l}=e,c=t[0].map(t=>{let e=t.concat();return 2===e.length?e.push(n):e[2]=e[2]||n,e}),u=f.Cartesian3.fromDegreesArrayHeights(Object(g.flattenDeep)(c));let h;if(h="dashed"===s?new f.PolylineDashMaterialProperty({color:r}):r,l){const{info:t}=e,r={polygon:new f.PolygonGraphics({hierarchy:u,material:i,height:n,extrudedHeight:l}),name:this._id,info:t};this.polygons.entities.add(r)}else{const t={polygon:new f.PolygonGraphics({hierarchy:A?new f.CallbackProperty(()=>new f.PolygonHierarchy(u),!1):u,material:i,classificationType:a?f.ClassificationType.BOTH:void 0,perPositionHeight:!a||void 0}),polyline:{positions:u,width:o,material:h,classificationType:a?f.ClassificationType.BOTH:void 0,clampToGround:!!a||void 0},name:this._id};this.polygons.entities.add(t)}}}f.Cesium3DTileset.prototype.loadTileset=new Proxy(f.Cesium3DTileset.prototype.loadTileset,{apply:function(t,e,i){e.beforeLoadTileset&&"function"==typeof e.beforeLoadTileset&&e.beforeLoadTileset(e,...i);const n=t.apply(e,i);return e.afterLoadTileset&&"function"==typeof e.afterLoadTileset&&e.afterLoadTileset(e,...i),n}});var qr=f.Cesium3DTileset;f.Cesium3DTile.prototype.requestContent=new Proxy(f.Cesium3DTile.prototype.requestContent,{apply:function(t,e,i){return e._tileset.beforeLoadTile&&"function"==typeof e._tileset.beforeLoadTile&&e._tileset.beforeLoadTile(e),t.apply(e,i)}});var Xr=f.Cesium3DTile,Yr=function(t,e,i,n){return new(i||(i=Promise))((function(r,o){function s(t){try{A(n.next(t))}catch(t){o(t)}}function a(t){try{A(n.throw(t))}catch(t){o(t)}}function A(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(s,a)}A((n=n.apply(t,e||[])).next())}))};Xr.enableProxy=!0;class Jr{constructor(t){this._conditions={},this._id=$(),this._layerType="tileset",this._attachControl=null,this._useGradient=!1,this._applyEffect={light:!0},this._options=t,this._tilesetEvent=new br,this._conditions={color:{conditions:[["true","color('#ffffff')"]]},show:"true"},t.viewer&&(this._userViewer=t.viewer),this._transformParams={position:new f.Cartesian3,rotation:[0,0,0],scale:[1,1,1]},this._useGradient=Boolean(this._options.useGradient),this._shader={lightingModel:this._useGradient?f.LightingModel.UNLIT:f.LightingModel.PBR,uniforms:{uPointSize:{type:f.UniformType.INT,value:0},uPointLightPositionEC:{type:f.UniformType.VEC3_ARRAY_10,value:[]},uPointLightColor:{type:f.UniformType.VEC3_ARRAY_10,value:[]},uPointLightDistanceAndDecayAndVisible:{type:f.UniformType.VEC3_ARRAY_10,value:[]},uSpotSize:{type:f.UniformType.INT,value:0},uSpotLightPositionEC:{type:f.UniformType.VEC3_ARRAY_10,value:[]},uSpotLightColor:{type:f.UniformType.VEC3_ARRAY_10,value:[]},uSpotLightDirectionEC:{type:f.UniformType.VEC3_ARRAY_10,value:[]},uSpotLightDistanceDecayCosVisible:{type:f.UniformType.VEC4_ARRAY_10,value:[]},uSpotLightExponent:{type:f.UniformType.FLOAT_ARRAY_10,value:[]}},fragmentShaderText:{part1:"\n\t\t\t\t\tfloat calcLightAttenuation(float lightDistance, float cutoffDistance, float decayExponent) {\n\t\t\t\t\t\treturn pow(clamp(1.0 - lightDistance / cutoffDistance, 0.0, 1.0), decayExponent);\n\t\t\t\t\t}\n\t\t\t\t\tfloat D_Phong(float g, float ndh) {\n\t\t\t\t\t\tfloat a = pow(8192.0, g);\n\t\t\t\t\t\treturn (a + 2.0) / 8.0 * pow(ndh, a);\n\t\t\t\t\t}\n\t\t\t\t\tvoid fragmentMain(FragmentInput fsInput, inout czm_modelMaterial material) {\n\t\t\t\t\t\tvec3 baseColor = material.diffuse;\n\t\t\t\t\t\tvec3 diffuseTerm = vec3(0.0);\n\t\t\t\t\t\tvec3 specularTerm = vec3(0.0);\n\t\t\t\t\t\tfloat roughness = 1.0;\n\t\t\t\t\t\tvec3 positionEC = fsInput.attributes.positionEC;\n\t\t\t\t\t\tvec3 v = -normalize(positionEC);\n\t\t\t\t\t\tvec3 color = baseColor;\n\t\t\t\t\t\tvec3 n = normalize(fsInput.attributes.normalEC);\n\t\t\t\t\t\t// float r = 0.0;\n\t\t\t\t\t",part2:"",part3:"\n\t\t\t\t\tif (uPointSize > 0 || uSpotSize > 0) {\t// 光源\n\t\t\t\t\t\tif (uPointSize > 0) {\n\t\t\t\t\t\t\tfor (int i = 0; i < uPointSize; i++) {\n\t\t\t\t\t\t\t\tif(uPointLightDistanceAndDecayAndVisible[i].z < 0.1) {\n\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tvec3 lVector = uPointLightPositionEC[i] - positionEC;\n\t\t\t\t\t\t\t\tfloat lightDistance = length(lVector);\n\t\t\t\t\t\t\t\tfloat lightAttenuation = calcLightAttenuation(lightDistance, uPointLightDistanceAndDecayAndVisible[i].x, uPointLightDistanceAndDecayAndVisible[i].y);\n\t\t\t\t\t\t\t\tif(lightAttenuation < 0.001) {\n\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\tvec3 pointLightColor = uPointLightColor[i] * lightAttenuation;\n\t\t\t\t\t\t\t\tvec3 pl = normalize(lVector);\n\t\t\t\t\t\t\t\tvec3 ph = normalize(v + pl);\n\t\t\t\t\t\t\t\tfloat pNdotL = clamp(dot(n, pl), 0.001, 1.0);\n\t\t\t\t\t\t\t\tfloat pNdotH = clamp(dot(n, ph), 0.0, 1.0);\n\t\t\t\t\t\t\t\tvec3 li = pNdotL * pointLightColor;\n\t\t\t\t\t\t\t\tdiffuseTerm += li;\n\t\t\t\t\t\t\t\tspecularTerm += li * D_Phong(1.0 - roughness, pNdotH);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (uSpotSize > 0) {\n\t\t\t\t\t\t\tfor (int i = 0; i < uSpotSize; i++) {\n\t\t\t\t\t\t\t\tif(uSpotLightDistanceDecayCosVisible[i].w < 0.1) {\n\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tvec3 lVector = uSpotLightPositionEC[i] - positionEC;\n\t\t\t\t\t\t\t\tfloat lightDistance = length(lVector);\n\t\t\t\t\t\t\t\tfloat lightAttenuation = calcLightAttenuation(lightDistance, uSpotLightDistanceDecayCosVisible[i].x, uSpotLightDistanceDecayCosVisible[i].y);\n\t\t\t\t\t\t\t\tif(lightAttenuation < 0.001) {\n\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tfloat spotEffect = dot(uSpotLightDirectionEC[i], normalize(lVector));\n\t\t\t\t\t\t\t\tif(spotEffect > uSpotLightDistanceDecayCosVisible[i].z) {\n\t\t\t\t\t\t\t\t\tvec3 spotLightColor = uSpotLightColor[i] * lightAttenuation * spotEffect;\n\t\t\t\t\t\t\t\t\tvec3 pl = normalize(lVector);\n\t\t\t\t\t\t\t\t\tvec3 ph = normalize(v + pl);\n\t\t\t\t\t\t\t\t\tfloat pNdotL = clamp(dot(n, pl), 0.001, 1.0);\n\t\t\t\t\t\t\t\t\tfloat pNdotH = clamp(dot(n, ph), 0.0, 1.0);\n\t\t\t\t\t\t\t\t\tvec3 li = pNdotL * spotLightColor;\n\t\t\t\t\t\t\t\t\tdiffuseTerm += li;\n\t\t\t\t\t\t\t\t\tspecularTerm += li * D_Phong(1.0 - roughness, pNdotH);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcolor += baseColor * diffuseTerm + specularTerm;\n\t\t\t\t\t}\n\t\t\t\t\tmaterial.diffuse = color;\n\t\t\t\t\t// material.diffuse = vec3(r,0.0, 0.0);\n\t\t\t\t}\n\t\t\t\t"}}}addToViewer(t){return Yr(this,void 0,void 0,(function*(){const{url:e,mixNum:i=[20,.3],noAuth:n=!1}=this._options;let r,o=e.split(","),s=[];if(o.length>1){const t=o[0],e=new URL(t).pathname.split("/").pop();r="{DOMAIN}/"+e,o.forEach(t=>{const i=t.split(e)[0];s.push(i)})}else r=e;const{viewer:a,ended:A}=t;a&&(this._userViewer=a);let l="",c=!1;this._userViewer instanceof ts?(this._viewer=this._userViewer.instance,this._userViewer.layerCache.add(this),l=this._userViewer.mapConfig.accessToken,c=this._userViewer.mapConfig.paramAccessTokenSupport):(this._viewer=this._userViewer.viewer.instance,this._userViewer.viewer.layerCache.add(this),l=this._userViewer.viewer.mapConfig.accessToken,c=this._userViewer.viewer.mapConfig.paramAccessTokenSupport);let u=new f.Resource({url:r,headers:{}});u.url.indexOf("?")>-1?u.url+="&at="+l:u.url+="?at="+l;const h=Ct(this._viewer.container);let p={maximumScreenSpaceError:this.getSpaceError(h)};o.length>1&&(p.urlDomains=s);for(let t in this._options)if("url"===t)p[t]=n?r:u;else if("light"===t||"imageBasedLightingFactor"===t){let e=this._options[t];p.imageBasedLightingFactor=new f.Cartesian2(e,e)}else if("modelMatrix"===t){let e=this._options[t];Array.isArray(e)&&0!==e.length&&16!==e.length&&console.error("check tileset modelMatrix length!");let i=Array.isArray(e)&&0===e.length?[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]:e;p[t]=f.Matrix4.fromArray(i)}else p[t]=this._options[t];const d=new qr(p);d.isLoad=!1,d.initialTilesLoaded.addEventListener((function(){d.isLoad=!0}));const g=t=>(-1==t.indexOf("at=")&&(t.indexOf("?")>-1?t+="&at="+l:t+="?at="+l),t);n||(d.beforeLoadTileset=(t,e)=>{c?e.url=g(e.url):e.headers["access-token"]=l},d.beforeLoadTile=t=>{c?t._contentResource.url=g(t._contentResource.url):t._contentResource&&(t._contentResource.headers["access-token"]=l)}),this._useGradient&&this.setShader("gradient",{mixNum:i}),d.customShader=this.generateShader(),this._instance=this._viewer.scene.primitives.add(d),this._instance&&this._instance.readyPromise.then(t=>{t.layerId=this._id;const{axesHelper:e={}}=this._options;e.show&&(this._axesHelper||(this._axesHelper=this._userViewer.viewer.instance.scene.primitives.add(new f.DebugModelMatrixPrimitive({modelMatrix:t.root.transform,length:e.length||100})))),this._transformParams.position=this.getPosition();try{at(!0,A)}catch(t){console.error(t)}}).catch(t=>{t.hasOwnProperty("statusCode")&&void 0===t.statusCode?At("c020202",A):t.hasOwnProperty("name")&&t.message&&t.message.startsWith("Tileset")?At("c020203",A):At("c020201",A)})}))}setUniform(t){for(let e in t)this._instance.customShader.setUniform(e,t[e])}setGradient(t){const{mixNum:e=[20,.3]}=this._options;t?this.setUniform({gradient:new f.Cartesian3(1,...e)}):this.setUniform({gradient:new f.Cartesian3}),this._useGradient=t}setShader(t,e){if("focus"===t){this._applyEffect.focus=!0;const{size:t}=e;this._shader.uniforms.focus={type:f.UniformType.VEC3,value:new f.Cartesian3},this._shader.uniforms.focusPoints={type:f.UniformType["VEC3_ARRAY_"+t],value:[]},this._shader.uniforms.focusMatrix={type:f.UniformType.MAT4,value:new f.Matrix4},this._shader.fragmentShaderText.part2="\n\t\t\t\tfloat isFocus = focus.x;\t// focus\n\t\t\t\tif (isFocus == 1.0) {\t// 区域聚焦\n\t\t\t\t\tfloat focusNum = focus.y;\n\t\t\t\t\tint numVertices = int(focus.z);\n\t\t\t\t\tvec3 wc = fsInput.attributes.positionWC;\n\t\t\t\t\tvec4 point = focusMatrix * vec4(wc, 1.0);\n\t\t\t\t\tbool isInside = false;\n\t\t\t\t\tfor (int i = 1, j = numVertices - 1; i < numVertices; j = i++) {\n\t\t\t\t\t\tif (((focusPoints[i].y > point.y) != (focusPoints[j].y > point.y)) &&\n\t\t\t\t\t\t\t(point.x < (focusPoints[j].x - focusPoints[i].x) * (point.y - focusPoints[i].y) / (focusPoints[j].y - focusPoints[i].y) + focusPoints[i].x)) {\n\t\t\t\t\t\t\tisInside = !isInside;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (!isInside) {\n\t\t\t\t\t\tcolor *= focusNum;\n\t\t\t\t\t}\n\t\t\t\t}\t\n\t\t\t",this._instance.customShader=this.generateShader()}else if("gradient"===t){this._applyEffect.gradient=!0;const{mixNum:t}=e;this._shader.uniforms.gradient={type:f.UniformType.VEC3,value:new f.Cartesian3(Number(this._useGradient),...t)},this._shader.fragmentShaderText.part2="\n\t\t\t\tfloat isGradient = gradient.x;\t// gradient\n\t\t\t\tif (isGradient == 1.0) {\t// 白模渐变\n\t\t\t\t\tfloat curz = fsInput.attributes.positionMC.z;\n\t\t\t\t\tfloat intensity = gradient.y;\n\t\t\t\t\tfloat fade = gradient.z;\n\t\t\t\t\tfloat helsing_p = curz / intensity;\n\t\t\t\t\thelsing_p += fade;\n\t\t\t\t\tcolor = vec3(helsing_p, helsing_p, helsing_p);\n\t\t\t\t}\n\t\t\t"}}removeShader(t){"focus"===t&&(delete this._applyEffect.focus,delete this._shader.uniforms.focus,delete this._shader.uniforms.focusPoints,delete this._shader.uniforms.focusMatrix,this._shader.fragmentShaderText.part2=""),this._instance.customShader=this.generateShader()}generateShader(){return new f.CustomShader({lightingModel:this._shader.lightingModel,uniforms:this._shader.uniforms,fragmentShaderText:`${this._shader.fragmentShaderText.part1}${this._shader.fragmentShaderText.part2}${this._shader.fragmentShaderText.part3}`})}remove(t={}){const{ended:e}=t;this._instance&&this._viewer.scene.primitives.remove(this._instance)&&(this._instance=null,this._conditions=[],this._tilesetEvent=null,this._userViewer instanceof ts?this._userViewer.layerCache.remove(this):this._userViewer.viewer.layerCache.remove(this),this._axesHelper&&(this._viewer.scene.primitives.remove(this._axesHelper),this._axesHelper=null),at(!0,e))}show(){this._instance&&(this._instance.show=!0)}hide(){this._instance&&(this._instance.show=!1)}on(t){const{event:e,handler:i}=t;this._tilesetEvent.on(e,i,this)}off(t){const{event:e}=t;this._tilesetEvent.off(e,this)}setStyle(t={}){const{type:e,content:i,ended:n}=t;if("color"===e){let t=i.map(t=>{let e="string"==typeof t.value?`'${t.value}'`:t.value,i=""+t.color;return["${"+t.column+"} "+t.operator+" "+e,i]});t.push(["true","color('#ffffff')"]),this._conditions.color.conditions=t}if("show"===e){let t="";i.forEach(e=>{let i="string"==typeof e.value?`'${e.value}'`:e.value,n="${"+e.column+"} "+e.operator+" "+i;e.type&&(n+=` ${e.type} `),t+=n}),this._conditions.show=t}this._instance&&(this._instance.style=new f.Cesium3DTileStyle({color:this._conditions.color,show:this._conditions.show}),at(!0,n))}translateX(t){this.moveModel({translation:[t,0,0]})}translateY(t){this.moveModel({translation:[0,t,0]})}translateZ(t){this.moveModel({translation:[0,0,t]})}rotateX(t){this._transformParams.rotation[0]+=t,this.moveModel({rotation:this._transformParams.rotation})}rotateY(t){this._transformParams.rotation[1]+=t,this.moveModel({rotation:this._transformParams.rotation})}rotateZ(t){this._transformParams.rotation[2]+=t,this.moveModel({rotation:this._transformParams.rotation})}scale(t){this._transformParams.scale=t,this.moveModel({scale:this._transformParams.scale})}moveModel(t){if(!this._instance)return;const{position:e,rotation:i,scale:n}=this._transformParams,{translation:r=[0,0,0]}=t,o=this.createModelMatrix(e,r,i,n);this._instance._root.transform=o,this._attachControl&&this._attachControl.update()}createModelMatrix(t,e=[0,0,0],i=[0,0,0],n=[1,1,1]){const r=f.Transforms.eastNorthUpToFixedFrame(t,f.Ellipsoid.WGS84),o=qn(r,e,i,n);return this._transformParams.position=f.Matrix4.getTranslation(o,new f.Cartesian3),o}setPosition(t){if(!this._instance)return;this._transformParams.rotation=[t.pitch,t.roll,t.heading];const e=Y.WGS84ToCartesian(t),i=[t.pitch,t.roll,t.heading],n=this._transformParams.scale,r=this.createModelMatrix(e,[0,0,0],i,n);this._instance._root.transform=r,this._attachControl&&this._attachControl.update()}getProps(){const t={};if(this._instance){const e=this.getPosition();if(e){const i=Y.CartesianToWGS84(e);i.heading=this._transformParams.rotation[2],i.pitch=this._transformParams.rotation[0],i.roll=this._transformParams.rotation[1],t.position=i}}return t}getPosition(){if(!this._instance)return;const t=this._instance._root.transform;return f.Matrix4.getTranslation(t,new f.Cartesian3)}getPositionMatrix(){if(!this._instance)return;const t=this._instance._root.transform,e=f.Matrix4.getTranslation(t,new f.Cartesian3);return f.Transforms.eastNorthUpToFixedFrame(e,f.Ellipsoid.WGS84)}getSpaceError(t){switch(t){case 2:return 16;case 4:return 24;case 8:return 48;default:return 16}}}var Zr=function(t,e,i,n){return new(i||(i=Promise))((function(r,o){function s(t){try{A(n.next(t))}catch(t){o(t)}}function a(t){try{A(n.throw(t))}catch(t){o(t)}}function A(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(s,a)}A((n=n.apply(t,e||[])).next())}))};class $r{constructor(t){this._instance=null,this._timer=null,this._options=t,this._userViewer=t.viewer}addToViewer(t){return Zr(this,void 0,void 0,(function*(){const{isFetch:e=!1}=this._options,{ended:i}=t;let n=this.addLayer(i);e&&(this._timer=setInterval(this.addLayer.bind(this),3e5)),n&&at(!0,i)}))}remove(t={}){const{ended:e}=t;if(this._instance){let t=Bt.getEngine(this._userViewer).imageryLayers.remove(this._instance);t?(at(t,e),this._instance=null,clearInterval(this._timer),this._timer=null):At("remove failed",e)}}show(){this._instance&&(this._instance.show=!0)}hide(){this._instance&&(this._instance.show=!1)}addLayer(t){this._instance&&Bt.getEngine(this._userViewer).imageryLayers.remove(this._instance);const{url:e}=this._options;let i,n=Object.assign({},C,{url:e+"/{z}/{y}/{x}"}),r=new f.Resource({url:n.url+"{Time}",headers:{}});if(n.customTags={Time:((t,e,i,n)=>(t._resource.headers["access-token"]=this._userViewer.viewer.mapConfig.accessToken,"")).bind(this)},n.url=r,i=new f.UrlTemplateImageryProvider(n),!Bt.getEngine(this._userViewer))return void At("c010111",t);const o=Bt.getEngine(this._userViewer).imageryLayers._layers.filter(t=>!(t.imageryProvider instanceof f.SingleTileImageryProvider)).length;return this._instance=Bt.getEngine(this._userViewer).imageryLayers.addImageryProvider(i),this._instance.layerType="roadCondition",2===o&&Bt.getEngine(this._userViewer).imageryLayers.lower(this._instance),!0}}class to{constructor(t){this._layerType="layer",this._id=$("complex"),this._fieldMap=[],this._options=t,this._instance=new f.CustomDataSource,this._layerEvent=new Cr,t.viewer&&(this.userViewer=t.viewer),this.init()}init(){const{data:t}=this._options;t&&Array.isArray(t)&&t.length>0&&t.forEach(t=>{this._handerData(t)})}field(t,e,i){const n={field:t,props:e,value:i};return this._fieldMap.push(n),this}setData(t){this._instance.entities.values.length>0&&this._instance.entities.removeAll();const{label:e,billboard:i,polygon:n}=this._options,r=t=>this._fieldMap.find(e=>e.props===t),o=r("billboard.scale"),s=r("billboard.color"),a=r("billboard.image"),A=r("label.backgroundColor"),l=r("label.fillColor"),c=r("label.outlineColor"),u=r("label.scale"),h=r("polygon.fillColor"),p=r("polygon.outlineColor");for(const r of t){const{lng:t,lat:d,alt:m}=r;let y={name:this._id,position:f.Cartesian3.fromDegrees(t,d,m),info:r};if(Object(f.defined)(i)&&"{}"!==JSON.stringify(i)){let t={};for(let e in i)if("scale"===e)t[e]=o?o.value(r[o.field]):i.scale;else if("color"===e)t[e]=s?f.Color.fromCssColorString(s.value(r[s.field])):f.Color.fromCssColorString(i.color);else if("image"===e)t[e]=a?a.value(r[a.field]):i.image;else if("eyeOffset"===e){let n=i[e]||[0,0,0];t[e]=new f.Cartesian3(...n)}else if("pixelOffset"===e){let n=i[e]||[0,0];t[e]=new f.Cartesian2(...n)}else if("scaleByDistance"===e||"pixelOffsetScaleByDistance"===e||"translucencyByDistance"===e){let n=i[e];t[e]=Array.isArray(n)?new f.NearFarScalar(...n):void 0}else if("distanceDisplayCondition"===e){let n=i[e];t[e]=new f.DistanceDisplayCondition(...n)}else t[e]=i[e];y.billboard=t}if(Object(f.defined)(e)&&"{}"!==JSON.stringify(e)&&r.text){let t={text:r.text};for(let i in e)if("backgroundColor"===i)t[i]=A?f.Color.fromCssColorString(A.value(r[A.field])):f.Color.fromCssColorString(e.backgroundColor);else if("fillColor"===i)t[i]=l?f.Color.fromCssColorString(l.value(r[l.field])):f.Color.fromCssColorString(e.fillColor);else if("outlineColor"===i)t[i]=c?f.Color.fromCssColorString(c.value(r[c.field])):f.Color.fromCssColorString(e.outlineColor);else if("scale"===i)t[i]=u?u.value(r[u.field]):e.scale;else if("backgroundPadding"===i||"pixelOffset"===i){let n=e[i];t[i]=new f.Cartesian2(...n)}else if("eyeOffset"===i){let n=e[i]||[0,0,0];t[i]=new f.Cartesian3(...n)}else if("scaleByDistance"===i||"pixelOffsetScaleByDistance"===i||"translucencyByDistance"===i){let n=e[i];t[i]=Array.isArray(n)?new f.NearFarScalar(...n):void 0}else if("distanceDisplayCondition"===i){let n=e[i];t[i]=new f.DistanceDisplayCondition(...n)}else t[i]=e[i];y.label=t}if(Object(f.defined)(n)&&"{}"!==JSON.stringify(n)&&r.polygon){let[t,...e]=r.polygon;e&&e.length>0&&(e=e.map(t=>new f.PolygonHierarchy(f.Cartesian3.fromDegreesArray(Object(g.flattenDepth)(t)))));let i={outline:!1,hierarchy:new f.PolygonHierarchy(f.Cartesian3.fromDegreesArray(Object(g.flattenDepth)(t)),e)};for(let t in n)if("fillColor"===t)i.material=h?f.Color.fromCssColorString(h.value(r[h.field])):f.Color.fromCssColorString(n.fillColor);else if("distanceDisplayCondition"===t){let e=n[t];i[t]=new f.DistanceDisplayCondition(...e)}else i[t]=n[t];if(i.outline=!1,y.polygon=i,n.outline&&n.outlineColor){let t=r.polygon[0]||[],e=n.height||0;t.map(t=>t.push(e));let i=Object(g.flattenDepth)(t),o={positions:f.Cartesian3.fromDegreesArrayHeights(i)};n.outlineWidth&&(o.width=n.outlineWidth),n.outlineColor&&(o.material=p?f.Color.fromCssColorString(p.value(r[p.field])):f.Color.fromCssColorString(n.outlineColor)),n.distanceDisplayCondition&&(o.distanceDisplayCondition=new f.DistanceDisplayCondition(...n.distanceDisplayCondition)),y.polyline=o}}this._instance.entities.add(new f.Entity(y))}}_handerData(t){const{position:e,billboard:i,label:n,polygon:r}=t,{lng:o,lat:s,alt:a}=e;let A={name:this._id,position:f.Cartesian3.fromDegrees(o,s,a)};if(Object(f.defined)(i)&&"{}"!==JSON.stringify(i)){let t={};for(let e in i)if("eyeOffset"===e){let n=i[e]||[0,0,0];t[e]=new f.Cartesian3(...n)}else if("pixelOffset"===e){let n=i[e]||[0,0];t[e]=new f.Cartesian2(...n)}else if("scaleByDistance"===e||"pixelOffsetScaleByDistance"===e||"translucencyByDistance"===e){let n=i[e];t[e]=Array.isArray(n)?new f.NearFarScalar(...n):void 0}else if("distanceDisplayCondition"===e){let n=i[e];t[e]=new f.DistanceDisplayCondition(...n)}else t[e]=i[e];A.billboard=t}if(Object(f.defined)(n)&&"{}"!==JSON.stringify(n)){let t={};for(let e in n)if("backgroundColor"===e||"fillColor"===e||"outlineColor"===e){let i=n[e];t[e]=f.Color.fromCssColorString(i)}else if("backgroundPadding"===e||"pixelOffset"===e){let i=n[e];t[e]=new f.Cartesian2(...i)}else if("eyeOffset"===e){let i=n[e]||[0,0,0];t[e]=new f.Cartesian3(...i)}else if("scaleByDistance"===e||"pixelOffsetScaleByDistance"===e||"translucencyByDistance"===e){let i=n[e];t[e]=Array.isArray(i)?new f.NearFarScalar(...i):void 0}else if("distanceDisplayCondition"===e){let i=n[e];t[e]=new f.DistanceDisplayCondition(...i)}else t[e]=n[e];A.label=t}if(Object(f.defined)(r)&&"{}"!==JSON.stringify(r)){let t={};for(let e in r)if("hierarchy"===e||"data"===e)if(r[e]&&r[e][0]&&Object(g.isArray)(r[e][0][0])){let[i,...n]=r[e];n&&n.length>0&&(n=n.map(t=>new f.PolygonHierarchy(f.Cartesian3.fromDegreesArray(Object(g.flattenDepth)(t))))),t.hierarchy=new f.PolygonHierarchy(f.Cartesian3.fromDegreesArray(Object(g.flattenDepth)(i)),n)}else{let i=Object(g.flattenDepth)(r[e]);t.hierarchy=f.Cartesian3.fromDegreesArray(Object(g.flattenDepth)(i))}else if("fillColor"===e){let i=r[e];t.material=f.Color.fromCssColorString(i)}else if("distanceDisplayCondition"===e){let i=r[e];t[e]=new f.DistanceDisplayCondition(...i)}else t[e]="outline"!==e&&r[e];if(A.polygon=t,r.outline){let t={};if(r.hierarchy||r.data){let e=r.hierarchy||r.data;e&&e[0]&&Object(g.isArray)(e[0][0])&&(e=e[0]);let i=r.height||0;e.map(t=>t.push(i));let n=Object(g.flattenDepth)(e);t.positions=f.Cartesian3.fromDegreesArrayHeights(n)}r.outlineWidth&&(t.width=r.outlineWidth),r.outlineColor&&(t.material=f.Color.fromCssColorString(r.outlineColor)),r.distanceDisplayCondition&&(t.distanceDisplayCondition=new f.DistanceDisplayCondition(...r.distanceDisplayCondition)),A.polyline=t}}this._instance.entities.add(new f.Entity(A))}addToViewer(t){const{viewer:e,ended:i}=t;e&&(this.userViewer=e),this.userViewer.viewer.layerCache.add(this),this.userViewer.viewer.instance.dataSources.add(this._instance),i&&i(at(!0))}remove(t){const{ended:e}=t;this._instance&&(this._instance.entities.removeAll(),this.userViewer.viewer.instance.dataSources.remove(this._instance),this._instance=null,this._layerEvent=null,this._fieldMap=[],this.userViewer.viewer.layerCache.remove(this),e&&e(at(!0)))}show(){this._instance&&(this._instance.show=!0)}hide(){this._instance&&(this._instance.show=!1)}on(t){const{event:e,handler:i}=t;this._layerEvent.on(e,i,this)}off(t){const{event:e}=t;this._layerEvent.off(e,this)}}class eo{constructor(t){this._id=$("geometry"),this._layerType="layer",this._layerEvent=new Cr,t.viewer?(this._userViewer=t.viewer,this.init(t.data)):this.init(t)}init(t){const e=t.features;Object(g.forEach)(e,t=>{switch(t.geometry.type){case"Point":this.addPoint(t);break;case"MultiPoint":this.addMultiPoint(t)}})}addToViewer(t){const{viewer:e,ended:i}=t;e&&(this._userViewer=e),this.viewer=this._userViewer.viewer.instance,this._userViewer.viewer.layerCache.add(this),this.points&&(this.pointsCollection||(this.pointsCollection=new f.PrimitiveCollection),this.pointsCollection.add(this.points),this.viewer.scene.primitives.add(this.pointsCollection)),i&&i(at(!0))}remove(t={}){const{ended:e}=t;this.pointsCollection&&this.viewer.scene.primitives.remove(this.pointsCollection),this._layerEvent=null,this._userViewer.viewer.layerCache.remove(this),e&&e(at(!0))}show(){this.pointsCollection&&(this.pointsCollection.show=!0)}hide(){this.pointsCollection&&(this.pointsCollection.show=!1)}on(t){const{event:e,handler:i}=t;this._layerEvent.on(e,i,this)}off(t){const{event:e}=t;this._layerEvent.off(e,this)}addPoint(t){this.points||(this.points=new f.PointPrimitiveCollection);let e=t.geometry.coordinates,i=t.properties,n=Object(f.defined)(i.color)?f.Color.fromCssColorString(i.color):void 0,r=i.height||0,o=i.radius||1,s=i["stroke-width"]||1,a=Object(f.defined)(i["stroke-color"])?f.Color.fromCssColorString(i["stroke-color"]):void 0,A={color:n,position:f.Cartesian3.fromDegrees(e[0],e[1],r),pixelSize:o,outlineColor:a,outlineWidth:s,id:this._id};this.points.add(A)}addMultiPoint(t){this.points||(this.points=new f.PointPrimitiveCollection);const e=t.geometry.coordinates;let i=t.properties;const n=Object(f.defined)(i.color)?f.Color.fromCssColorString(i.color):f.Color.fromCssColorString("#f00"),r=i.height||0,o=i.radius||1;let s=i["stroke-width"]||1,a=Object(f.defined)(i["stroke-color"])?f.Color.fromCssColorString(i["stroke-color"]):f.Color.fromCssColorString("#f00");Object(g.forEach)(e,t=>{const e={color:n,position:f.Cartesian3.fromDegrees(t[0],t[1],r),pixelSize:o,outlineWidth:s,outlineColor:a,id:this._id};this.points.add(e)})}}var io=function(t,e,i,n){return new(i||(i=Promise))((function(r,o){function s(t){try{A(n.next(t))}catch(t){o(t)}}function a(t){try{A(n.throw(t))}catch(t){o(t)}}function A(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(s,a)}A((n=n.apply(t,e||[])).next())}))};class no{constructor(t){this._instance=null,this._id=$("video"),this._layerType="layer",this._options=t,this._layerEvent=new Cr,this._viewer=t.viewer}addToViewer(t){return io(this,void 0,void 0,(function*(){const{positions:e,video:i}=this._options,{ended:n}=t;let r=e.map(t=>(t[2]||(t[2]=0),t)),o=f.Cartesian3.fromDegreesArrayHeights(Object(g.flatten)(r)),s=new f.GeometryInstance({geometry:f.PolygonGeometry.fromPositions({positions:o,perPositionHeight:!0,vertexFormat:f.EllipsoidSurfaceAppearance.VERTEX_FORMAT}),attributes:{},id:this._id}),a=this._createAppearence(i),A=new f.Primitive({geometryInstances:[s],appearance:a,asynchronous:!1});Bt.getLayerCache(this._viewer).add(this),this._instance=Bt.getPrimitives(this._viewer).add(A),at(!0,n)}))}remove(t={}){const{ended:e}=t;this._instance&&Bt.getPrimitives(this._viewer).remove(this._instance)&&(this._instance=this._layerEvent=null,Bt.getLayerCache(this._viewer).remove(this),at(!0,e))}show(){this._instance&&(this._instance.show=!0)}hide(){this._instance&&(this._instance.show=!1)}on(t){const{event:e,handler:i}=t;this._layerEvent.on(e,i,this)}off(t){const{event:e}=t;this._layerEvent.off(e,this)}_createAppearence(t){const{shadow:e=!0}=this._options;let i=Bt.getMapConfig(this._viewer).distUrl+"Imgs/tMask.jpg",n=new f.Material({fabric:{type:"custome_1",uniforms:{color:new f.Color(1,1,1,1),image:"",tmask:""},source:"czm_material czm_getMaterial(czm_materialInput materialInput)\n        {\n             czm_material material = czm_getDefaultMaterial(materialInput);\n             vec2 st = materialInput.st;\n             vec4 colorImage = texture2D(image, st);\n             vec4 maskImage = texture2D(tmask, st);\n             material.alpha = colorImage.a * color.a*maskImage.r;\n             material.diffuse = colorImage.rgb*color.rgb;\n             return material;\n         }"}});return n.uniforms.image=t,e&&(n.uniforms.tmask=i),new f.EllipsoidSurfaceAppearance({material:n,flat:!0,renderState:{cull:{enabled:!1},depthTest:{enabled:!1}}})}}class ro{constructor(t){this._id=$("geometry"),this._layerType="layer",this._layerEvent=new Cr,this.polylines=new f.PolylineCollection,this.polylinesCollection=new f.PrimitiveCollection,t.viewer?(this._userViewer=t.viewer,this.init(t.data)):this.init(t)}init(t){const e=t.features;Object(g.forEach)(e,t=>{switch(t.geometry.type){case"LineString":this.addPolyline(t);break;case"MultiLineString":this.addMultiPolyline(t)}})}addToViewer(t){const{viewer:e,ended:i}=t;e&&(this._userViewer=e),this.viewer=this._userViewer.viewer.instance,this._userViewer.viewer.layerCache.add(this),this.polylines&&(this.polylinesCollection.add(this.polylines),this.viewer.scene.primitives.add(this.polylinesCollection)),at(!0,i)}remove(t={}){const{ended:e}=t;this.polylinesCollection&&this.viewer.scene.primitives.remove(this.polylinesCollection),this._layerEvent=null,this._userViewer.viewer.layerCache.remove(this),at(!0,e)}show(){this.polylinesCollection&&(this.polylinesCollection.show=!0)}hide(){this.polylinesCollection&&(this.polylinesCollection.show=!1)}on(t){const{event:e,handler:i}=t;this._layerEvent.on(e,i,this)}off(t){const{event:e}=t;this._layerEvent.off(e,this)}addPolyline(t){let e=t.geometry.coordinates,i=t.properties;const n=this.handlePolyline(e,i);this.polylines.add(n)}addMultiPolyline(t){const e=t.geometry.coordinates;let i=t.properties;Object(g.forEach)(e,t=>{const e=this.handlePolyline(t,i);this.polylines.add(e)})}handlePolyline(t,e){const i=t.map(t=>{let i=t.concat();return 2===i.length?e.height?i.push(e.height):i.push(0):e.height?i[2]=e.height:i[2]=0,i}),n=f.Cartesian3.fromDegreesArrayHeights(Object(g.flattenDeep)(i));let r,o=Object(f.defined)(e.color)?f.Color.fromCssColorString(e.color):f.Color.fromCssColorString("#f00"),s=e.width||1,a=e.type||"solid";return"solid"===a?r=f.Material.fromType("Color",{color:o}):"dashed"===a&&(r=f.Material.fromType("PolylineDash",{color:o})),{positions:n,width:s,material:r,id:this._id}}}class oo{constructor(t){this._id=$("geometry"),this._layerType="layer",this._layerEvent=new Cr,t.viewer?(this._userViewer=t.viewer,this.init(t.data)):this.init(t)}init(t){const e=t.features;Object(g.forEach)(e,t=>{switch(t.geometry.type){case"Polygon":this.addPolygon(t);break;case"MultiPolygon":this.addMultiPolygon(t)}})}addToViewer(t){const{viewer:e,ended:i}=t;e&&(this._userViewer=e),this.viewer=this._userViewer.viewer.instance,this._userViewer.viewer.layerCache.add(this),this.polygons&&(this.polygons.add(this.polylines),this.viewer.scene.primitives.add(this.polygons)),i&&i(at(!0))}remove(t={}){const{ended:e}=t;this.polygons&&this.viewer.scene.primitives.remove(this.polygons),this._layerEvent=null,this._userViewer.viewer.layerCache.remove(this),e&&e(at(!0))}show(){this.polygons&&(this.polygons.show=!0)}hide(){this.polygons&&(this.polygons.show=!1)}on(t){const{event:e,handler:i}=t;this._layerEvent.on(e,i,this)}off(t){const{event:e}=t;this._layerEvent.off(e,this)}addPolygon(t){this.polygons||(this.polygons=new f.PrimitiveCollection),this.polylines||(this.polylines=new f.PolylineCollection);let e,i=t.geometry.coordinates,n=t.properties;e=2===i[0][0].length?f.Cartesian3.fromDegreesArray(Object(g.flattenDeep)(i[0])):f.Cartesian3.fromDegreesArrayHeights(Object(g.flattenDeep)(i[0]));let r=Object(f.defined)(n.color)?f.Color.fromCssColorString(n.color):f.Color.fromCssColorString("#f00"),o=n.height||0,s=new f.GeometryInstance({geometry:f.PolygonGeometry.fromPositions({positions:e,height:o,vertexFormat:f.EllipsoidSurfaceAppearance.VERTEX_FORMAT}),attributes:{color:f.ColorGeometryInstanceAttribute.fromColor(r)},id:this._id}),a=new f.Primitive({geometryInstances:s,appearance:new f.PerInstanceColorAppearance({flat:!0,translucent:1!==r.alpha})});const A=i[0].map(t=>{let e=t.concat();return 2===e.length?n.height?e.push(n.height):e.push(0):n.height&&(e[2]=n.height),e}),l=f.Cartesian3.fromDegreesArrayHeights(Object(g.flattenDeep)(A));let c,u=Object(f.defined)(n["line-color"])?f.Color.fromCssColorString(n["line-color"]):f.Color.fromCssColorString("#f00"),h=n["line-width"]||0,p=n["line-type"]||"solid";"solid"===p?c=f.Material.fromType("Color",{color:u}):"dashed"===p&&(c=f.Material.fromType("PolylineDash",{color:u})),l&&this.polylines.add({positions:l,width:h,material:c,id:this._id}),this.polygons.add(a)}addMultiPolygon(t){this.polygons||(this.polygons=new f.PrimitiveCollection),this.polylines||(this.polylines=new f.PolylineCollection);let e=t.geometry.coordinates;Object(g.forEach)(e,e=>{let i;i=2===e[0][0].length?f.Cartesian3.fromDegreesArray(Object(g.flattenDeep)(e[0])):f.Cartesian3.fromDegreesArrayHeights(Object(g.flattenDeep)(e[0]));let n=t.properties,r=Object(f.defined)(n.color)?f.Color.fromCssColorString(n.color):f.Color.fromCssColorString("#f00"),o=n.height||0,s=new f.GeometryInstance({geometry:f.PolygonGeometry.fromPositions({positions:i,height:o,vertexFormat:f.EllipsoidSurfaceAppearance.VERTEX_FORMAT}),attributes:{color:f.ColorGeometryInstanceAttribute.fromColor(r)},id:this._id}),a=new f.Primitive({geometryInstances:s,appearance:new f.PerInstanceColorAppearance({flat:!0,translucent:1!==r.alpha})});const A=e[0].map(t=>{let e=t.concat();return 2===e.length?n.height?e.push(n.height):e.push(0):n.height&&(e[2]=n.height),e}),l=f.Cartesian3.fromDegreesArrayHeights(Object(g.flattenDeep)(A));let c,u=Object(f.defined)(n["line-color"])?f.Color.fromCssColorString(n["line-color"]):f.Color.fromCssColorString("#f00"),h=n["line-width"]||0,p=n["line-type"]||"solid";"solid"===p?c=f.Material.fromType("Color",{color:u}):"dashed"===p&&(c=f.Material.fromType("PolylineDash",{color:u})),l&&this.polylines.add({positions:l,width:h,material:c,id:this._id}),this.polygons.add(a)})}}class so{constructor(t){this._id=$("geometry"),this._layerType="layer",this._style={"fill-color":"rgba(255,0,0,0.8)","min-height":0,"max-height":10},this._style=Object.assign(this._style,t.defaultStyles),this._layerEvent=new Cr,this._userViewer=t.viewer,this.init(t.data)}get viewer(){return this._userViewer.viewer.instance}init(t){const e=t.features;Object(g.forEach)(e,t=>{switch(t.geometry.type){case"Polygon":this.addPolygon(t)}})}addToViewer(t){const{ended:e}=t;this._userViewer.viewer.layerCache.add(this),this.viewer.scene.primitives.add(this._instance),at(!0,e)}remove(t={}){const{ended:e}=t;this.viewer.scene.primitives.remove(this._instance),this._layerEvent=null,this._userViewer.viewer.layerCache.remove(this),at(!0,e)}show(){this._instance&&(this._instance.show=!0)}hide(){this._instance&&(this._instance.show=!1)}on(t){const{event:e,handler:i}=t;this._layerEvent.on(e,i,this)}off(t){const{event:e}=t;this._layerEvent.off(e,this)}addPolygon(t){let e=t.geometry.coordinates,i=t.properties,n=f.Cartesian3.fromDegreesArray(Object(g.flattenDeep)(e[0]));const r=this.getStyle(i),{color:o,minHeight:s,maxHeight:a}=r,A=new f.GeometryInstance({geometry:new f.PolygonGeometry({vertexFormat:f.PerInstanceColorAppearance.VERTEX_FORMAT,polygonHierarchy:{positions:n},height:s,extrudedHeight:a}),attributes:{color:f.ColorGeometryInstanceAttribute.fromColor(o),show:new f.ShowGeometryInstanceAttribute(!0)},id:this._id});this._instance=new f.ClassificationPrimitive({geometryInstances:A,classificationType:f.ClassificationType.CESIUM_3D_TILE})}getStyle(t){t.minHeight&&(t["min-height"]=t.minHeight,delete t.minHeight),t.maxHeight&&(t["max-height"]=t.maxHeight,delete t.maxHeight);const e=Object.assign(this._style,t);return{color:f.Color.fromCssColorString(e["fill-color"]),minHeight:e["min-height"],maxHeight:e["max-height"]}}setStyle(t,e){const{color:i}=this.getStyle({[t]:e});if(this._instance){const t=this._instance.getGeometryInstanceAttributes(this._id),e=i.toBytes();t.color=[e[0],e[1],e[2],e[3]]}}setData(t){this.viewer.scene.primitives.remove(this._instance),this.init(t),this.viewer.scene.primitives.add(this._instance)}}var ao=function(t,e,i,n){return new(i||(i=Promise))((function(r,o){function s(t){try{A(n.next(t))}catch(t){o(t)}}function a(t){try{A(n.throw(t))}catch(t){o(t)}}function A(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(s,a)}A((n=n.apply(t,e||[])).next())}))};Xr.enableProxy=!0;class Ao{constructor(t){this._id=$(),this._layerType="tileset",this._options=t,this._tilesetEvent=new br,this._userViewer=t.viewer,this._transformParams={position:new f.Cartesian3,rotation:[0,0,0],scale:[1,1,1]}}addToViewer(t){return ao(this,void 0,void 0,(function*(){const{url:e,noAuth:i=!1}=this._options,{ended:n}=t;let r,o=e.split(","),s=[];if(o.length>1){const t=o[0],e=new URL(t).pathname.split("/").pop();r="{DOMAIN}/"+e,o.forEach(t=>{const i=t.split(e)[0];s.push(i)})}else r=e;let a="",A=!1;this._userViewer instanceof ts?(this._viewer=this._userViewer.instance,this._userViewer.layerCache.add(this),a=this._userViewer.mapConfig.accessToken,A=this._userViewer.mapConfig.paramAccessTokenSupport):(this._viewer=this._userViewer.viewer.instance,this._userViewer.viewer.layerCache.add(this),a=this._userViewer.viewer.mapConfig.accessToken,A=this._userViewer.viewer.mapConfig.paramAccessTokenSupport);let l=new f.Resource({url:r,headers:{}});const c=Ct(this._viewer.container);let u={maximumScreenSpaceError:this.getSpaceError(c)};o.length>1&&(u.urlDomains=s);for(let t in this._options)if("url"===t)u[t]=i?r:l;else if("light"===t||"imageBasedLightingFactor"===t){let e=this._options[t];u.imageBasedLightingFactor=new f.Cartesian2(e,e)}else if("modelMatrix"===t){let e=this._options[t];Array.isArray(e)&&0!==e.length&&16!==e.length&&console.error("check tileset modelMatrix length!");let i=Array.isArray(e)&&0===e.length?[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]:e;u[t]=f.Matrix4.fromArray(i)}else u[t]=this._options[t];const h=new qr(u);h.isLoad=!1,h.initialTilesLoaded.addEventListener((function(){h.isLoad=!0}));const p=t=>(-1==t.indexOf("at=")&&(t.indexOf("?")>-1?t+="&at="+a:t+="?at="+a),t);i||(h.beforeLoadTileset=(t,e)=>{A?e.url=p(e.url):e.headers["access-token"]=a},h.beforeLoadTile=t=>{A?t._contentResource.url=p(t._contentResource.url):t._contentResource&&(t._contentResource.headers["access-token"]=a)}),this.generateShader()&&(h.customShader=this.generateShader()),this._instance=this._viewer.scene.primitives.add(h),this._instance&&this._instance.readyPromise.then(t=>{t.layerId=this._id,this._transformParams.position=this.getPosition();try{at(!0,n)}catch(t){console.error(t)}}).catch(t=>{t.hasOwnProperty("statusCode")&&void 0===t.statusCode?At("c020202",n):t.hasOwnProperty("name")&&t.message&&t.message.startsWith("Tileset")?At("c020203",n):At("c020201",n)})}))}generateShader(){const{data:t,light:e=1}=this._options;if(!t)return!1;const i=t.features.map(t=>t.geometry.coordinates[0]);if(!Boolean(i.length))return!1;const n=i.length;let r={light:{type:f.UniformType.FLOAT,value:e}};i.forEach((t,e)=>{const i=t.length,n=f.Cartesian3.fromDegrees(t[0][0],t[0][1],0),o=f.Transforms.eastNorthUpToFixedFrame(n,f.Ellipsoid.WGS84),s=f.Matrix4.inverse(o,new f.Matrix4),a=this.getPoints(t,s);r["clipNum"+(e+1)]={type:f.UniformType.INT,value:i},r["clipPoints"+(e+1)]={type:f.UniformType["VEC3_ARRAY_"+i],value:a},r["clipMatrix"+(e+1)]={type:f.UniformType.MAT4,value:s}});let o="";for(let t=0;t<n;t++)o+=`\n\t\t\t\tvec4 point${t+1} = clipMatrix${t+1} * vec4(wc, 1.0);\n\t\t\t\tbool isInside${t+1} = false;\n\t\t\t\tfor (int i = 1, j = clipNum${t+1} - 1; i < clipNum${t+1}; j = i++) {\n\t\t\t\t\tif (((clipPoints${t+1}[i].y > point${t+1}.y) != (clipPoints${t+1}[j].y > point${t+1}.y)) &&\n\t\t\t\t\t\t(point${t+1}.x < (clipPoints${t+1}[j].x - clipPoints${t+1}[i].x) * (point${t+1}.y - clipPoints${t+1}[i].y) / (clipPoints${t+1}[j].y - clipPoints${t+1}[i].y) + clipPoints${t+1}[i].x)) {\n\t\t\t\t\t\tisInside${t+1} = !isInside${t+1};\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (isInside${t+1}) {\n\t\t\t\t\tdiscard;\n\t\t\t\t}\n\t\t\t`;const s="\n\t\t\tvoid fragmentMain(FragmentInput fsInput, inout czm_modelMaterial material) {\n\t\t\t\tvec3 baseColor = material.diffuse;\n\t\t\t\tvec3 color = baseColor;\n\t\t\t\tvec3 wc = fsInput.attributes.positionWC;\n\t\t"+o+"\n\t\t\t\tmaterial.diffuse = color * light;\n\t\t\t}\n\t\t";return new f.CustomShader({lightingModel:f.LightingModel.PBR,uniforms:r,fragmentShaderText:s})}remove(t={}){const{ended:e}=t;this._instance&&this._viewer.scene.primitives.remove(this._instance)&&(this._instance=null,this._tilesetEvent=null,this._userViewer.viewer.layerCache.remove(this),at(!0,e))}show(){this._instance&&(this._instance.show=!0)}hide(){this._instance&&(this._instance.show=!1)}on(t){const{event:e,handler:i}=t;this._tilesetEvent.on(e,i,this)}off(t){const{event:e}=t;this._tilesetEvent.off(e,this)}getSpaceError(t){switch(t){case 2:return 16;case 4:return 24;case 8:return 48;default:return 16}}getPoints(t,e){return t.map(t=>{const i=f.Cartesian3.fromDegrees(...t);return f.Matrix4.multiplyByPoint(e,i,new f.Cartesian3)})}translateX(t){this.moveModel({translation:[t,0,0]})}translateY(t){this.moveModel({translation:[0,t,0]})}translateZ(t){this.moveModel({translation:[0,0,t]})}moveModel(t){if(!this._instance)return;const{position:e,rotation:i,scale:n}=this._transformParams,{translation:r=[0,0,0]}=t,o=this.createModelMatrix(e,r,i,n);this._instance._root.transform=o}createModelMatrix(t,e=[0,0,0],i=[0,0,0],n=[1,1,1]){const r=f.Transforms.eastNorthUpToFixedFrame(t,f.Ellipsoid.WGS84),o=qn(r,e,i,n);return this._transformParams.position=f.Matrix4.getTranslation(o,new f.Cartesian3),o}getPosition(){if(!this._instance)return;const t=this._instance._root.transform;return f.Matrix4.getTranslation(t,new f.Cartesian3)}}i(51);var lo=function(t){var e=document.createElement("div");e.innerHTML=t;for(var i=document.createDocumentFragment();e.firstChild;)i.appendChild(e.firstChild);return i},co=f.knockout,uo=function(t,e,i){e=Object(f.getElement)(e);var n,r=lo(t),o=[];for(n=0;n<r.childNodes.length;++n)o.push(r.childNodes[n]);for(e.appendChild(r),n=0;n<o.length;++n){var s=o[n];1!==s.nodeType&&8!==s.nodeType||co.applyBindings(i,s)}return o},ho=f.knockout,po=function(t){if(!Object(f.defined)(t)||!Object(f.defined)(t.terria))throw new f.DeveloperError("options.terria is required.");this.terria=t.terria,this._removeSubscription=void 0,this._lastLegendUpdate=void 0,this.eventHelper=new f.EventHelper,this.distanceLabel=void 0,this.barWidth=void 0,this.enableDistanceLegend=!Object(f.defined)(t.enableDistanceLegend)||t.enableDistanceLegend,ho.track(this,["distanceLabel","barWidth"]),this.eventHelper.add(this.terria.afterWidgetChanged,(function(){Object(f.defined)(this._removeSubscription)&&(this._removeSubscription(),this._removeSubscription=void 0)}),this);var e=this;function i(){if(Object(f.defined)(e.terria)){var t=e.terria.scene;e._removeSubscription=t.postRender.addEventListener((function(){!function(t,e){if(!t.enableDistanceLegend)return t.barWidth=void 0,void(t.distanceLabel=void 0);var i=Object(f.getTimestamp)();if(i<t._lastLegendUpdate+250)return;t._lastLegendUpdate=i;var n=e.canvas.clientWidth,r=e.canvas.clientHeight,o=e.camera.getPickRay(new f.Cartesian2(n/2|0,r-1)),s=e.camera.getPickRay(new f.Cartesian2(1+n/2|0,r-1)),a=e.globe,A=a.pick(o,e),l=a.pick(s,e);if(!Object(f.defined)(A)||!Object(f.defined)(l))return t.barWidth=void 0,void(t.distanceLabel=void 0);var c=a.ellipsoid.cartesianToCartographic(A),u=a.ellipsoid.cartesianToCartographic(l);fo.setEndPoints(c,u);for(var h,p=fo.surfaceDistance,d=go.length-1;!Object(f.defined)(h)&&d>=0;--d)go[d]/p<100&&(h=go[d]);if(Object(f.defined)(h)){var g;g=h>=1e3?(h/1e3).toString()+" km":h.toString()+" m",t.barWidth=h/p|0,t.distanceLabel=g}else t.barWidth=void 0,t.distanceLabel=void 0}(this,t)}),e)}}i(),this.eventHelper.add(this.terria.afterWidgetChanged,(function(){i()}),this)};po.prototype.destroy=function(){this.eventHelper.removeAll()},po.prototype.show=function(t){var e;e=this.enableDistanceLegend?'<div class="distance-legend" data-bind="visible: distanceLabel && barWidth"><div class="distance-legend-label" data-bind="text: distanceLabel"></div><div class="distance-legend-scale-bar" data-bind="style: { width: barWidth + \'px\', left: (5 + (125 - barWidth) / 2) + \'px\' }"></div></div>':'<div class="distance-legend"  style="display: none;" data-bind="visible: distanceLabel && barWidth"><div class="distance-legend-label"  data-bind="text: distanceLabel"></div><div class="distance-legend-scale-bar"  data-bind="style: { width: barWidth + \'px\', left: (5 + (125 - barWidth) / 2) + \'px\' }"></div></div>',uo(e,t,this)},po.create=function(t){var e=new po(t);return e.show(t.container),e};var fo=new f.EllipsoidGeodesic,go=[1,2,3,5,10,20,30,50,100,200,300,500,1e3,2e3,3e3,5e3,1e4,2e4,3e4,5e4,1e5,2e5,3e5,5e5,1e6,2e6,3e6,5e6,1e7,2e7,3e7,5e7];var mo=po,yo="M 7.5,0 C 3.375,0 0,3.375 0,7.5 0,11.625 3.375,15 7.5,15 c 3.46875,0 6.375,-2.4375 7.21875,-5.625 l -1.96875,0 C 12,11.53125 9.9375,13.125 7.5,13.125 4.40625,13.125 1.875,10.59375 1.875,7.5 1.875,4.40625 4.40625,1.875 7.5,1.875 c 1.59375,0 2.90625,0.65625 3.9375,1.6875 l -3,3 6.5625,0 L 15,0 12.75,2.25 C 11.4375,0.84375 9.5625,0 7.5,0 z",vo=f.knockout,_o=function(t){if(!Object(f.defined)(t))throw new f.DeveloperError("terria is required");this._terria=t,this.name="Unnamed Control",this.text=void 0,this.svgIcon=void 0,this.svgHeight=void 0,this.svgWidth=void 0,this.cssClass=void 0,this.isActive=!1,vo.track(this,["name","svgIcon","svgHeight","svgWidth","cssClass","isActive"])};Object.defineProperties(_o.prototype,{terria:{get:function(){return this._terria}},hasText:{get:function(){return Object(f.defined)(this.text)&&"string"==typeof this.text}}}),_o.prototype.activate=function(){throw new f.DeveloperError("activate must be implemented in the derived class.")};var wo=_o,Co=function(t){wo.apply(this,arguments)};Co.prototype=Object.create(wo.prototype);var Bo=Co,bo=function(t){Bo.apply(this,arguments),this.name=t.options.resetTooltip?t.options.resetTooltip:"重置视图",this.navigationLocked=!1,this.svgIcon=t.options.resetSvg?"":yo,this.resetSvg=t.options.resetSvg,this.svgHeight=15,this.svgWidth=15,this.cssClass="navigation-control-icon-reset"};(bo.prototype=Object.create(Bo.prototype)).setNavigationLocked=function(t){this.navigationLocked=t},bo.prototype.resetView=function(){if(!this.navigationLocked){var t=this.terria.scene;if(t.screenSpaceCameraController.enableInputs){this.isActive=!0;var e=t.camera;if(Object(f.defined)(this.terria.trackedEntity)){var i=this.terria.trackedEntity;this.terria.trackedEntity=void 0,this.terria.trackedEntity=i}else{const i=this.terria.options.duration?this.terria.options.duration:3;if(this.terria.options.defaultResetView){const n=this.terria.options.orientation?this.terria.options.orientation:{heading:f.Math.toRadians(5.729578)};if(this.terria.options.defaultResetView&&this.terria.options.defaultResetView instanceof f.Cartographic)e.flyTo({destination:t.globe.ellipsoid.cartographicToCartesian(this.terria.options.defaultResetView),orientation:n,duration:i});else if(this.terria.options.defaultResetView&&this.terria.options.defaultResetView instanceof f.Rectangle)try{f.Rectangle.validate(this.terria.options.defaultResetView),e.flyTo({destination:this.terria.options.defaultResetView,orientation:n,duration:i})}catch(t){console.log("Cesium-navigation/ResetViewNavigationControl:   options.defaultResetView Cesium rectangle is  invalid!")}}else"function"==typeof e.flyHome?e.flyHome(1):e.flyTo({destination:f.Camera.DEFAULT_VIEW_RECTANGLE,duration:i})}this.isActive=!1}}},bo.prototype.activate=function(){this.resetView()};var Eo=bo,So={},xo=new f.Cartographic,Io=new f.Ray;So.getCameraFocus=function(t,e,i){var n=t.scene,r=n.camera;if(n.mode!==f.SceneMode.MORPHING&&(Object(f.defined)(i)||(i=new f.Cartesian3),Object(f.defined)(t.trackedEntity)?i=t.trackedEntity.position.getValue(t.clock.currentTime,i):(Io.origin=r.positionWC,Io.direction=r.directionWC,i=n.globe.pick(Io,n,i)),Object(f.defined)(i)))return n.mode===f.SceneMode.SCENE2D||n.mode===f.SceneMode.COLUMBUS_VIEW?(i=r.worldToCameraCoordinatesPoint(i,i),e&&(i=n.globe.ellipsoid.cartographicToCartesian(n.mapProjection.unproject(i,xo),i))):e||(i=r.worldToCameraCoordinatesPoint(i,i)),i};var Fo=So,Oo=function(t,e){Bo.apply(this,arguments),this.name=e?t.options.zoomInTooltip?t.options.zoomInTooltip:"放大":t.options.zoomOutTooltip?t.options.zoomOutTooltip:"缩小",e?t.options.zoomInSvg?this.zoomInSvg=t.options.zoomInSvg:this.text="+":t.options.zoomOutSvg?this.zoomOutSvg=t.options.zoomOutSvg:this.text="-",this.cssClass="navigation-control-icon-zoom-"+(e?"in":"out"),this.relativeAmount=2,e&&(this.relativeAmount=1/this.relativeAmount)};Oo.prototype.relativeAmount=1,(Oo.prototype=Object.create(Bo.prototype)).activate=function(){this.zoom(this.relativeAmount)};var Po=new f.Cartesian3;Oo.prototype.zoom=function(t){if(this.isActive=!0,Object(f.defined)(this.terria)){var e=this.terria.scene,i=e.screenSpaceCameraController;if(!i.enableInputs||!i.enableZoom)return;var n,r=e.camera;switch(e.mode){case f.SceneMode.MORPHING:break;case f.SceneMode.SCENE2D:r.zoomIn(r.positionCartographic.height*(1-this.relativeAmount));break;default:var o;if(o=Object(f.defined)(this.terria.trackedEntity)?new f.Cartesian3:Fo.getCameraFocus(this.terria,!1),Object(f.defined)(o))n={direction:r.direction,up:r.up};else{var s=new f.Ray(r.worldToCameraCoordinatesPoint(e.globe.ellipsoid.cartographicToCartesian(r.positionCartographic)),r.directionWC);o=f.IntersectionTests.grazingAltitudeLocation(s,e.globe.ellipsoid),n={heading:r.heading,pitch:r.pitch,roll:r.roll}}if(r.position.z>=406944828719368.56)return;var a=f.Cartesian3.subtract(r.position,o,Po),A=f.Cartesian3.multiplyByScalar(a,t,a),l=f.Cartesian3.add(o,A,o);Object(f.defined)(this.terria.trackedEntity)||e.mode===f.SceneMode.COLUMBUS_VIEW?r.position=l:r.flyTo({destination:l,orientation:n,duration:.5,convert:!1})}}this.isActive=!1};var To=Oo,Lo=f.knockout,Mo=function(t){this.terria=t.terria,this.eventHelper=new f.EventHelper,this.enableZoomControls=!Object(f.defined)(t.enableZoomControls)||t.enableZoomControls,this.enableCompass=!Object(f.defined)(t.enableCompass)||t.enableCompass,this.navigationLocked=!1,this.controls=t.controls,Object(f.defined)(this.controls)||(this.controls=[new To(this.terria,!0),new Eo(this.terria),new To(this.terria,!1)]),this.svgCompassOuterRing="m 66.5625,0 0,15.15625 3.71875,0 0,-10.40625 5.5,10.40625 4.375,0 0,-15.15625 -3.71875,0 0,10.40625 L 70.9375,0 66.5625,0 z M 72.5,20.21875 c -28.867432,0 -52.28125,23.407738 -52.28125,52.28125 0,28.87351 23.413818,52.3125 52.28125,52.3125 28.86743,0 52.28125,-23.43899 52.28125,-52.3125 0,-28.873512 -23.41382,-52.28125 -52.28125,-52.28125 z m 0,1.75 c 13.842515,0 26.368948,5.558092 35.5,14.5625 l -11.03125,11 0.625,0.625 11.03125,-11 c 8.9199,9.108762 14.4375,21.579143 14.4375,35.34375 0,13.764606 -5.5176,26.22729 -14.4375,35.34375 l -11.03125,-11 -0.625,0.625 11.03125,11 c -9.130866,9.01087 -21.658601,14.59375 -35.5,14.59375 -13.801622,0 -26.321058,-5.53481 -35.4375,-14.5 l 11.125,-11.09375 c 6.277989,6.12179 14.857796,9.90625 24.3125,9.90625 19.241896,0 34.875,-15.629154 34.875,-34.875 0,-19.245847 -15.633104,-34.84375 -34.875,-34.84375 -9.454704,0 -18.034511,3.760884 -24.3125,9.875 L 37.0625,36.4375 C 46.179178,27.478444 58.696991,21.96875 72.5,21.96875 z m -0.875,0.84375 0,13.9375 1.75,0 0,-13.9375 -1.75,0 z M 36.46875,37.0625 47.5625,48.15625 C 41.429794,54.436565 37.65625,63.027539 37.65625,72.5 c 0,9.472461 3.773544,18.055746 9.90625,24.34375 L 36.46875,107.9375 c -8.96721,-9.1247 -14.5,-21.624886 -14.5,-35.4375 0,-13.812615 5.53279,-26.320526 14.5,-35.4375 z M 72.5,39.40625 c 18.297686,0 33.125,14.791695 33.125,33.09375 0,18.302054 -14.827314,33.125 -33.125,33.125 -18.297687,0 -33.09375,-14.822946 -33.09375,-33.125 0,-18.302056 14.796063,-33.09375 33.09375,-33.09375 z M 22.84375,71.625 l 0,1.75 13.96875,0 0,-1.75 -13.96875,0 z m 85.5625,0 0,1.75 14,0 0,-1.75 -14,0 z M 71.75,108.25 l 0,13.9375 1.71875,0 0,-13.9375 -1.71875,0 z",this.svgCompassGyro="m 72.71875,54.375 c -0.476702,0 -0.908208,0.245402 -1.21875,0.5625 -0.310542,0.317098 -0.551189,0.701933 -0.78125,1.1875 -0.172018,0.363062 -0.319101,0.791709 -0.46875,1.25 -6.91615,1.075544 -12.313231,6.656514 -13,13.625 -0.327516,0.117495 -0.661877,0.244642 -0.9375,0.375 -0.485434,0.22959 -0.901634,0.471239 -1.21875,0.78125 -0.317116,0.310011 -0.5625,0.742111 -0.5625,1.21875 l 0.03125,0 c 0,0.476639 0.245384,0.877489 0.5625,1.1875 0.317116,0.310011 0.702066,0.58291 1.1875,0.8125 0.35554,0.168155 0.771616,0.32165 1.21875,0.46875 1.370803,6.10004 6.420817,10.834127 12.71875,11.8125 0.146999,0.447079 0.30025,0.863113 0.46875,1.21875 0.230061,0.485567 0.470708,0.870402 0.78125,1.1875 0.310542,0.317098 0.742048,0.5625 1.21875,0.5625 0.476702,0 0.876958,-0.245402 1.1875,-0.5625 0.310542,-0.317098 0.582439,-0.701933 0.8125,-1.1875 0.172018,-0.363062 0.319101,-0.791709 0.46875,-1.25 6.249045,-1.017063 11.256351,-5.7184 12.625,-11.78125 0.447134,-0.1471 0.86321,-0.300595 1.21875,-0.46875 0.485434,-0.22959 0.901633,-0.502489 1.21875,-0.8125 0.317117,-0.310011 0.5625,-0.710861 0.5625,-1.1875 l -0.03125,0 c 0,-0.476639 -0.245383,-0.908739 -0.5625,-1.21875 C 89.901633,71.846239 89.516684,71.60459 89.03125,71.375 88.755626,71.244642 88.456123,71.117495 88.125,71 87.439949,64.078341 82.072807,58.503735 75.21875,57.375 c -0.15044,-0.461669 -0.326927,-0.884711 -0.5,-1.25 -0.230061,-0.485567 -0.501958,-0.870402 -0.8125,-1.1875 -0.310542,-0.317098 -0.710798,-0.5625 -1.1875,-0.5625 z m -0.0625,1.40625 c 0.03595,-0.01283 0.05968,0 0.0625,0 0.0056,0 0.04321,-0.02233 0.1875,0.125 0.144288,0.147334 0.34336,0.447188 0.53125,0.84375 0.06385,0.134761 0.123901,0.309578 0.1875,0.46875 -0.320353,-0.01957 -0.643524,-0.0625 -0.96875,-0.0625 -0.289073,0 -0.558569,0.04702 -0.84375,0.0625 C 71.8761,57.059578 71.936151,56.884761 72,56.75 c 0.18789,-0.396562 0.355712,-0.696416 0.5,-0.84375 0.07214,-0.07367 0.120304,-0.112167 0.15625,-0.125 z m 0,2.40625 c 0.448007,0 0.906196,0.05436 1.34375,0.09375 0.177011,0.592256 0.347655,1.271044 0.5,2.03125 0.475097,2.370753 0.807525,5.463852 0.9375,8.9375 -0.906869,-0.02852 -1.834463,-0.0625 -2.78125,-0.0625 -0.92298,0 -1.802327,0.03537 -2.6875,0.0625 0.138529,-3.473648 0.493653,-6.566747 0.96875,-8.9375 0.154684,-0.771878 0.320019,-1.463985 0.5,-2.0625 0.405568,-0.03377 0.804291,-0.0625 1.21875,-0.0625 z m -2.71875,0.28125 c -0.129732,0.498888 -0.259782,0.987558 -0.375,1.5625 -0.498513,2.487595 -0.838088,5.693299 -0.96875,9.25 -3.21363,0.15162 -6.119596,0.480068 -8.40625,0.9375 -0.682394,0.136509 -1.275579,0.279657 -1.84375,0.4375 0.799068,-6.135482 5.504716,-11.036454 11.59375,-12.1875 z M 75.5,58.5 c 6.043169,1.18408 10.705093,6.052712 11.5,12.15625 -0.569435,-0.155806 -1.200273,-0.302525 -1.875,-0.4375 -2.262525,-0.452605 -5.108535,-0.783809 -8.28125,-0.9375 -0.130662,-3.556701 -0.470237,-6.762405 -0.96875,-9.25 C 75.761959,59.467174 75.626981,58.990925 75.5,58.5 z m -2.84375,12.09375 c 0.959338,0 1.895843,0.03282 2.8125,0.0625 C 75.48165,71.267751 75.5,71.871028 75.5,72.5 c 0,1.228616 -0.01449,2.438313 -0.0625,3.59375 -0.897358,0.0284 -1.811972,0.0625 -2.75,0.0625 -0.927373,0 -1.831062,-0.03473 -2.71875,-0.0625 -0.05109,-1.155437 -0.0625,-2.365134 -0.0625,-3.59375 0,-0.628972 0.01741,-1.232249 0.03125,-1.84375 0.895269,-0.02827 1.783025,-0.0625 2.71875,-0.0625 z M 68.5625,70.6875 c -0.01243,0.60601 -0.03125,1.189946 -0.03125,1.8125 0,1.22431 0.01541,2.407837 0.0625,3.5625 -3.125243,-0.150329 -5.92077,-0.471558 -8.09375,-0.90625 -0.784983,-0.157031 -1.511491,-0.316471 -2.125,-0.5 -0.107878,-0.704096 -0.1875,-1.422089 -0.1875,-2.15625 0,-0.115714 0.02849,-0.228688 0.03125,-0.34375 0.643106,-0.20284 1.389577,-0.390377 2.25,-0.5625 2.166953,-0.433487 4.97905,-0.75541 8.09375,-0.90625 z m 8.3125,0.03125 c 3.075121,0.15271 5.824455,0.446046 7.96875,0.875 0.857478,0.171534 1.630962,0.360416 2.28125,0.5625 0.0027,0.114659 0,0.228443 0,0.34375 0,0.735827 -0.07914,1.450633 -0.1875,2.15625 -0.598568,0.180148 -1.29077,0.34562 -2.0625,0.5 -2.158064,0.431708 -4.932088,0.754666 -8.03125,0.90625 0.04709,-1.154663 0.0625,-2.33819 0.0625,-3.5625 0,-0.611824 -0.01924,-1.185379 -0.03125,-1.78125 z M 57.15625,72.5625 c 0.0023,0.572772 0.06082,1.131112 0.125,1.6875 -0.125327,-0.05123 -0.266577,-0.10497 -0.375,-0.15625 -0.396499,-0.187528 -0.665288,-0.387337 -0.8125,-0.53125 -0.147212,-0.143913 -0.15625,-0.182756 -0.15625,-0.1875 0,-0.0047 -0.02221,-0.07484 0.125,-0.21875 0.147212,-0.143913 0.447251,-0.312472 0.84375,-0.5 0.07123,-0.03369 0.171867,-0.06006 0.25,-0.09375 z m 31.03125,0 c 0.08201,0.03503 0.175941,0.05872 0.25,0.09375 0.396499,0.187528 0.665288,0.356087 0.8125,0.5 0.14725,0.14391 0.15625,0.21405 0.15625,0.21875 0,0.0047 -0.009,0.04359 -0.15625,0.1875 -0.147212,0.143913 -0.416001,0.343722 -0.8125,0.53125 -0.09755,0.04613 -0.233314,0.07889 -0.34375,0.125 0.06214,-0.546289 0.09144,-1.094215 0.09375,-1.65625 z m -29.5,3.625 c 0.479308,0.123125 0.983064,0.234089 1.53125,0.34375 2.301781,0.460458 5.229421,0.787224 8.46875,0.9375 0.167006,2.84339 0.46081,5.433176 0.875,7.5 0.115218,0.574942 0.245268,1.063612 0.375,1.5625 -5.463677,-1.028179 -9.833074,-5.091831 -11.25,-10.34375 z m 27.96875,0 C 85.247546,81.408945 80.919274,85.442932 75.5,86.5 c 0.126981,-0.490925 0.261959,-0.967174 0.375,-1.53125 0.41419,-2.066824 0.707994,-4.65661 0.875,-7.5 3.204493,-0.15162 6.088346,-0.480068 8.375,-0.9375 0.548186,-0.109661 1.051942,-0.220625 1.53125,-0.34375 z M 70.0625,77.53125 c 0.865391,0.02589 1.723666,0.03125 2.625,0.03125 0.912062,0 1.782843,-0.0048 2.65625,-0.03125 -0.165173,2.736408 -0.453252,5.207651 -0.84375,7.15625 -0.152345,0.760206 -0.322989,1.438994 -0.5,2.03125 -0.437447,0.03919 -0.895856,0.0625 -1.34375,0.0625 -0.414943,0 -0.812719,-0.02881 -1.21875,-0.0625 -0.177011,-0.592256 -0.347655,-1.271044 -0.5,-2.03125 -0.390498,-1.948599 -0.700644,-4.419842 -0.875,-7.15625 z m 1.75,10.28125 c 0.284911,0.01545 0.554954,0.03125 0.84375,0.03125 0.325029,0 0.648588,-0.01171 0.96875,-0.03125 -0.05999,0.148763 -0.127309,0.31046 -0.1875,0.4375 -0.18789,0.396562 -0.386962,0.696416 -0.53125,0.84375 -0.144288,0.147334 -0.181857,0.125 -0.1875,0.125 -0.0056,0 -0.07446,0.02233 -0.21875,-0.125 C 72.355712,88.946416 72.18789,88.646562 72,88.25 71.939809,88.12296 71.872486,87.961263 71.8125,87.8125 z",this.svgCompassRotationMarker="M 72.46875,22.03125 C 59.505873,22.050338 46.521615,27.004287 36.6875,36.875 L 47.84375,47.96875 C 61.521556,34.240041 83.442603,34.227389 97.125,47.90625 l 11.125,-11.125 C 98.401629,26.935424 85.431627,22.012162 72.46875,22.03125 z",this.showCompass=Object(f.defined)(this.terria)&&this.enableCompass,this.heading=this.showCompass?this.terria.scene.camera.heading:0,this.isOrbiting=!1,this.orbitCursorAngle=0,this.orbitCursorOpacity=0,this.orbitLastTimestamp=0,this.orbitFrame=void 0,this.orbitIsLook=!1,this.orbitMouseMoveFunction=void 0,this.orbitMouseUpFunction=void 0,this.isRotating=!1,this.rotateInitialCursorAngle=void 0,this.rotateFrame=void 0,this.rotateIsLook=!1,this.rotateMouseMoveFunction=void 0,this.rotateMouseUpFunction=void 0,this._unsubcribeFromPostRender=void 0,Lo.track(this,["controls","showCompass","heading","isOrbiting","orbitCursorAngle","isRotating"]);var e=this;function i(){Object(f.defined)(e.terria)?(e._unsubcribeFromPostRender&&(e._unsubcribeFromPostRender(),e._unsubcribeFromPostRender=void 0),e.showCompass=e.enableCompass,e._unsubcribeFromPostRender=e.terria.scene.postRender.addEventListener((function(){e.heading=e.terria.scene.camera.heading}))):(e._unsubcribeFromPostRender&&(e._unsubcribeFromPostRender(),e._unsubcribeFromPostRender=void 0),e.showCompass=!1)}Mo.prototype.setNavigationLocked=function(t){this.navigationLocked=t,this.controls&&this.controls.length>1&&this.controls[1].setNavigationLocked(this.navigationLocked)},this.eventHelper.add(this.terria.afterWidgetChanged,i,this),i()};Mo.prototype.destroy=function(){this.eventHelper.removeAll()},Mo.prototype.show=function(t){const e=void 0===this.terria.options.enableCompassOuterRing||this.terria.options.enableCompassOuterRing?'title="" data-bind="visible: showCompass, event: { mousedown: handleMouseDown,touchstart:handleMouseDown, dblclick: handleDoubleClick }">':'title="" data-bind="visible: showCompass">',i=" <div class=\"compass-rotation-marker\" data-bind=\"visible: isOrbiting, style: { transform: 'rotate(-' + orbitCursorAngle + 'rad)', '-webkit-transform': 'rotate(-' + orbitCursorAngle + 'rad)', opacity: orbitCursorOpacity }",n=i+'">'+this.terria.options.compassRotationMarkerSvg,r=(this.terria.options.compassRotationMarkerSvg?n:" <div class=\"compass-rotation-marker\" data-bind=\"visible: isOrbiting, style: { transform: 'rotate(-' + orbitCursorAngle + 'rad)', '-webkit-transform': 'rotate(-' + orbitCursorAngle + 'rad)', opacity: orbitCursorOpacity }, cesiumSvgPath: { path: svgCompassRotationMarker, width: 145, height: 145 }\">")+"</div>",o=" <div class=\"compass-outer-ring\" title=\"\" data-bind=\"style: { transform: 'rotate(-' + heading + 'rad)', '-webkit-transform': 'rotate(-' + heading + 'rad)' }",s=o+'">'+this.terria.options.compassOuterRingSvg,a=(this.terria.options.compassOuterRingSvg?s:" <div class=\"compass-outer-ring\" title=\"\" data-bind=\"style: { transform: 'rotate(-' + heading + 'rad)', '-webkit-transform': 'rotate(-' + heading + 'rad)' }, cesiumSvgPath: { path: svgCompassOuterRing, width: 145, height: 145 }\">")+"</div>",A=' <div class="compass-gyro" data-bind="css: { \'compass-gyro-active\': isOrbiting }',l=A+'">'+this.terria.options.compassGyroSvg,c=e+'<div class="compass-outer-ring-background"></div>'+r+a+' <div class="compass-gyro-background"></div>'+((this.terria.options.compassGyroSvg?l:' <div class="compass-gyro" data-bind="css: { \'compass-gyro-active\': isOrbiting },cesiumSvgPath: { path: svgCompassGyro, width: 145, height: 145 } ">')+"</div>")+"</div>",u='<div class="compass"'+c,h='<div class="compass" style="display: none;"'+c,p=">\x3c!-- ko foreach: controls --\x3e<div data-bind=\"click: activate, attr: { title: $data.name }, css: $root.isLastControl($data) ? 'navigation-control-last' : 'navigation-control' \">   \x3c!-- ko if: $data.hasText --\x3e   <div data-bind=\"text: $data.text, css: $data.isActive ?  'navigation-control-icon-active ' + $data.cssClass : $data.cssClass\"></div>   \x3c!-- /ko --\x3e  \x3c!-- ko ifnot: $data.hasText --\x3e  \x3c!-- ko if: $data.svgIcon --\x3e  <div data-bind=\"cesiumSvgPath: { path: $data.svgIcon, width: $data.svgWidth, height: $data.svgHeight }, css: $data.isActive ?  'navigation-control-icon-active ' + $data.cssClass : $data.cssClass\"></div>  \x3c!-- /ko --\x3e  \x3c!-- ko ifnot: $data.svgIcon --\x3e  \x3c!-- ko if: $data.resetSvg --\x3e  <div class=\"navigation-control-icon-svg\">"+this.terria.options.resetSvg+'</div>  \x3c!-- /ko --\x3e  \x3c!-- ko ifnot: $data.resetSvg --\x3e  \x3c!-- ko if: $data.zoomInSvg --\x3e  <div class="navigation-control-icon-svg">'+this.terria.options.zoomInSvg+'</div>  \x3c!-- /ko --\x3e  \x3c!-- ko ifnot: $data.zoomInSvg --\x3e  \x3c!-- ko if: $data.zoomOutSvg --\x3e  <div class="navigation-control-icon-svg">'+this.terria.options.zoomOutSvg+"</div>  \x3c!-- /ko --\x3e  \x3c!-- /ko --\x3e  \x3c!-- /ko --\x3e  \x3c!-- /ko --\x3e  \x3c!-- /ko --\x3e </div> \x3c!-- /ko --\x3e</div>",d='<div class="navigation-controls"'+p,f='<div class="navigation-controls" style="display: none;">'+p,g=(this.enableCompass?u:h)+(this.enableZoomControls?d:f);uo(g,t,this)},Mo.prototype.add=function(t){this.controls.push(t)},Mo.prototype.remove=function(t){this.controls.remove(t)},Mo.prototype.isLastControl=function(t){return t===this.controls[this.controls.length-1]};var Uo=new f.Cartesian2;const Do=t=>{let e;e=t.touches?t.touches[0]:t;const{clientX:i,clientY:n}=e;return{clientX:i,clientY:n}};Mo.prototype.handleMouseDown=function(t,e){const{clientX:i,clientY:n}=Do(e);if(this.terria.scene.mode===f.SceneMode.MORPHING)return!0;if(t.navigationLocked)return!0;var r=e.currentTarget,o=e.currentTarget.getBoundingClientRect(),s=o.width/2,a=new f.Cartesian2((o.right-o.left)/2,(o.bottom-o.top)/2),A=new f.Cartesian2(i-o.left,n-o.top),l=f.Cartesian2.subtract(A,a,Uo),c=f.Cartesian2.magnitude(l)/s;if(c<50/145)!function(t,e,i){var n=t.terria.scene,r=n.screenSpaceCameraController;if(n.mode===f.SceneMode.MORPHING||!r.enableInputs)return;if(t.navigationLocked)return!0;switch(n.mode){case f.SceneMode.COLUMBUS_VIEW:if(r.enableLook)break;if(!r.enableTranslate||!r.enableTilt)return;break;case f.SceneMode.SCENE3D:if(r.enableLook)break;if(!r.enableTilt||!r.enableRotate)return;break;case f.SceneMode.SCENE2D:if(!r.enableTranslate)return}Ho(t),Object(f.defined)(t.orbitTickFunction)&&t.terria.clock.onTick.removeEventListener(t.orbitTickFunction);t.orbitMouseMoveFunction=void 0,t.orbitMouseUpFunction=void 0,t.orbitTickFunction=void 0,t.isOrbiting=!0,t.orbitLastTimestamp=Object(f.getTimestamp)();var o=n.camera;if(Object(f.defined)(t.terria.trackedEntity))t.orbitFrame=void 0,t.orbitIsLook=!1;else{var s=Fo.getCameraFocus(t.terria,!0,No);Object(f.defined)(s)?(t.orbitFrame=f.Transforms.eastNorthUpToFixedFrame(s,n.globe.ellipsoid,Ro),t.orbitIsLook=!1):(t.orbitFrame=f.Transforms.eastNorthUpToFixedFrame(o.positionWC,n.globe.ellipsoid,Ro),t.orbitIsLook=!0)}function a(e,i){var n=Math.atan2(-e.y,e.x);t.orbitCursorAngle=f.Math.zeroToTwoPi(n-f.Math.PI_OVER_TWO);var r=f.Cartesian2.magnitude(e),o=i/2,s=Math.min(r/o,1),a=.5*s*s+.5;t.orbitCursorOpacity=a}t.orbitTickFunction=function(e){var i,r=Object(f.getTimestamp)(),s=(r-t.orbitLastTimestamp)*(2.5*(t.orbitCursorOpacity-.5)/1e3),a=t.orbitCursorAngle+f.Math.PI_OVER_TWO,A=Math.cos(a)*s,l=Math.sin(a)*s;if(t.navigationLocked)return!0;Object(f.defined)(t.orbitFrame)&&(i=f.Matrix4.clone(o.transform,Qo),o.lookAtTransform(t.orbitFrame)),n.mode===f.SceneMode.SCENE2D?o.move(new f.Cartesian3(A,l,0),Math.max(n.canvas.clientWidth,n.canvas.clientHeight)/100*o.positionCartographic.height*s):t.orbitIsLook?(o.look(f.Cartesian3.UNIT_Z,-A),o.look(o.right,-l)):(o.rotateLeft(A),o.rotateUp(l)),Object(f.defined)(t.orbitFrame)&&o.lookAtTransform(i),t.orbitLastTimestamp=r},t.orbitMouseMoveFunction=function(t){const{clientX:i,clientY:n}=Do(t);var r=e.getBoundingClientRect(),o=new f.Cartesian2((r.right-r.left)/2,(r.bottom-r.top)/2),s=new f.Cartesian2(i-r.left,n-r.top);a(f.Cartesian2.subtract(s,o,Uo),r.width)},t.orbitMouseUpFunction=function(e){t.isOrbiting=!1,Ho(t),Object(f.defined)(t.orbitTickFunction)&&t.terria.clock.onTick.removeEventListener(t.orbitTickFunction),t.orbitMouseMoveFunction=void 0,t.orbitMouseUpFunction=void 0,t.orbitTickFunction=void 0},(t=>{document.addEventListener("mousemove",t.orbitMouseMoveFunction,!1),document.addEventListener("touchmove",t.orbitMouseMoveFunction,!1),document.addEventListener("mouseup",t.orbitMouseUpFunction,!1),document.addEventListener("touchend",t.orbitMouseUpFunction,!1)})(t),t.terria.clock.onTick.addEventListener(t.orbitTickFunction),a(i,e.getBoundingClientRect().width)}(this,r,l);else{if(!(c<1))return!0;!function(t,e,i){var n,r=t.terria.scene,o=r.camera,s=r.screenSpaceCameraController;if(r.mode===f.SceneMode.MORPHING||r.mode===f.SceneMode.SCENE2D||!s.enableInputs)return;if(t.navigationLocked)return!0;if(!s.enableLook&&(r.mode===f.SceneMode.COLUMBUS_VIEW||r.mode===f.SceneMode.SCENE3D&&!s.enableRotate))return;if(ko(t),t.rotateMouseMoveFunction=void 0,t.rotateMouseUpFunction=void 0,t.isRotating=!0,t.rotateInitialCursorAngle=Math.atan2(-i.y,i.x),Object(f.defined)(t.terria.trackedEntity))t.rotateFrame=void 0,t.rotateIsLook=!1;else{var a=Fo.getCameraFocus(t.terria,!0,No);Object(f.defined)(a)&&(r.mode!==f.SceneMode.COLUMBUS_VIEW||s.enableLook||s.enableTranslate)?(t.rotateFrame=f.Transforms.eastNorthUpToFixedFrame(a,r.globe.ellipsoid,Ro),t.rotateIsLook=!1):(t.rotateFrame=f.Transforms.eastNorthUpToFixedFrame(o.positionWC,r.globe.ellipsoid,Ro),t.rotateIsLook=!0)}Object(f.defined)(t.rotateFrame)&&(n=f.Matrix4.clone(o.transform,Qo),o.lookAtTransform(t.rotateFrame));t.rotateInitialCameraAngle=-o.heading,Object(f.defined)(t.rotateFrame)&&o.lookAtTransform(n);t.rotateMouseMoveFunction=function(i){const{clientX:n,clientY:r}=Do(i);var o,s=e.getBoundingClientRect(),a=new f.Cartesian2((s.right-s.left)/2,(s.bottom-s.top)/2),A=new f.Cartesian2(n-s.left,r-s.top),l=f.Cartesian2.subtract(A,a,Uo),c=Math.atan2(-l.y,l.x)-t.rotateInitialCursorAngle,u=f.Math.zeroToTwoPi(t.rotateInitialCameraAngle-c),h=t.terria.scene.camera;Object(f.defined)(t.rotateFrame)&&(o=f.Matrix4.clone(h.transform,Qo),h.lookAtTransform(t.rotateFrame));var p=-h.heading;h.rotateRight(u-p),Object(f.defined)(t.rotateFrame)&&h.lookAtTransform(o)},t.rotateMouseUpFunction=function(e){t.isRotating=!1,ko(t),t.rotateMouseMoveFunction=void 0,t.rotateMouseUpFunction=void 0},(t=>{document.addEventListener("mousemove",t.rotateMouseMoveFunction,!1),document.addEventListener("touchmove",t.rotateMouseMoveFunction,!1),document.addEventListener("mouseup",t.rotateMouseUpFunction,!1),document.addEventListener("touchend",t.rotateMouseUpFunction,!1)})(t)}(this,r,l)}};var Qo=new f.Matrix4,Ro=new f.Matrix4,No=new f.Cartesian3;Mo.prototype.handleDoubleClick=function(t,e){var i=t.terria.scene,n=i.camera,r=i.screenSpaceCameraController;if(i.mode===f.SceneMode.MORPHING||!r.enableInputs)return!0;if(t.navigationLocked)return!0;if(i.mode!==f.SceneMode.COLUMBUS_VIEW||r.enableTranslate){if(i.mode===f.SceneMode.SCENE3D||i.mode===f.SceneMode.COLUMBUS_VIEW){if(!r.enableLook)return;if(i.mode===f.SceneMode.SCENE3D&&!r.enableRotate)return}var o=Fo.getCameraFocus(t.terria,!0,No);if(Object(f.defined)(o)){var s=i.globe.ellipsoid.cartographicToCartesian(n.positionCartographic,new f.Cartesian3),a=i.globe.ellipsoid.geodeticSurfaceNormal(o),A=new f.BoundingSphere(o,0);n.flyToBoundingSphere(A,{offset:new f.HeadingPitchRange(0,f.Math.PI_OVER_TWO-f.Cartesian3.angleBetween(a,n.directionWC),f.Cartesian3.distance(s,o)),duration:1.5})}else this.controls[1].resetView()}},Mo.create=function(t){var e=new Mo(t);return e.show(t.container),e};const Ho=t=>{document.removeEventListener("mousemove",t.orbitMouseMoveFunction,!1),document.removeEventListener("touchmove",t.orbitMouseMoveFunction,!1),document.removeEventListener("mouseup",t.orbitMouseUpFunction,!1),document.removeEventListener("touchend",t.orbitMouseUpFunction,!1)},ko=t=>{document.removeEventListener("mousemove",t.rotateMouseMoveFunction,!1),document.removeEventListener("touchmove",t.rotateMouseMoveFunction,!1),document.removeEventListener("mouseup",t.rotateMouseUpFunction,!1),document.removeEventListener("touchend",t.rotateMouseUpFunction,!1)};var Vo=Mo,jo=f.Event,Go=function(t){Ko.apply(this,arguments),this._onDestroyListeners=[]};function Ko(t,e){if(!Object(f.defined)(t))throw new f.DeveloperError("CesiumWidget or Viewer is required.");var i=Object(f.defined)(t.cesiumWidget)?t.cesiumWidget:t,n=document.createElement("div");n.className="cesium-widget-cesiumNavigationContainer",i.container.appendChild(n),this.terria=t,this.terria.options=Object(f.defined)(e)?e:{},this.terria.afterWidgetChanged=new jo,this.terria.beforeWidgetChanged=new jo,this.container=n,Object(f.defined)(this.terria.options.enableDistanceLegend)&&!this.terria.options.enableDistanceLegend||(this.distanceLegendDiv=document.createElement("div"),n.appendChild(this.distanceLegendDiv),this.distanceLegendDiv.setAttribute("id","distanceLegendDiv"),this.distanceLegendViewModel=mo.create({container:this.distanceLegendDiv,terria:this.terria,mapElement:n,enableDistanceLegend:!0})),Object(f.defined)(this.terria.options.enableZoomControls)&&!this.terria.options.enableZoomControls||Object(f.defined)(this.terria.options.enableCompass)&&!this.terria.options.enableCompass?!Object(f.defined)(this.terria.options.enableZoomControls)||this.terria.options.enableZoomControls||Object(f.defined)(this.terria.options.enableCompass)&&!this.terria.options.enableCompass?Object(f.defined)(this.terria.options.enableZoomControls)&&!this.terria.options.enableZoomControls||!Object(f.defined)(this.terria.options.enableCompass)||this.terria.options.enableCompass?Object(f.defined)(this.terria.options.enableZoomControls)&&!this.terria.options.enableZoomControls&&Object(f.defined)(this.terria.options.enableCompass)&&this.terria.options.enableCompass:(this.navigationDiv=document.createElement("div"),this.navigationDiv.setAttribute("id","navigationDiv"),n.appendChild(this.navigationDiv),this.navigationViewModel=Vo.create({container:this.navigationDiv,terria:this.terria,enableZoomControls:!0,enableCompass:!1})):(this.navigationDiv=document.createElement("div"),this.navigationDiv.setAttribute("id","navigationDiv"),n.appendChild(this.navigationDiv),this.navigationViewModel=Vo.create({container:this.navigationDiv,terria:this.terria,enableZoomControls:!1,enableCompass:!0})):(this.navigationDiv=document.createElement("div"),this.navigationDiv.setAttribute("id","navigationDiv"),n.appendChild(this.navigationDiv),this.navigationViewModel=Vo.create({container:this.navigationDiv,terria:this.terria,enableZoomControls:!0,enableCompass:!0}))}Go.prototype.distanceLegendViewModel=void 0,Go.prototype.navigationViewModel=void 0,Go.prototype.navigationDiv=void 0,Go.prototype.distanceLegendDiv=void 0,Go.prototype.terria=void 0,Go.prototype.container=void 0,Go.prototype._onDestroyListeners=void 0,Go.prototype._navigationLocked=!1,Go.prototype.setNavigationLocked=function(t){this._navigationLocked=t,this.navigationViewModel.setNavigationLocked(this._navigationLocked)},Go.prototype.getNavigationLocked=function(){return this._navigationLocked},Go.prototype.destroy=function(){Object(f.defined)(this.navigationViewModel)&&this.navigationViewModel.destroy(),Object(f.defined)(this.distanceLegendViewModel)&&this.distanceLegendViewModel.destroy(),Object(f.defined)(this.navigationDiv)&&this.navigationDiv.parentNode.removeChild(this.navigationDiv),delete this.navigationDiv,Object(f.defined)(this.distanceLegendDiv)&&this.distanceLegendDiv.parentNode.removeChild(this.distanceLegendDiv),delete this.distanceLegendDiv,Object(f.defined)(this.container)&&this.container.parentNode.removeChild(this.container),delete this.container;for(var t=0;t<this._onDestroyListeners.length;t++)this._onDestroyListeners[t]()},Go.prototype.addOnDestroyListener=function(t){"function"==typeof t&&this._onDestroyListeners.push(t)};var zo=Go,Wo=function(t,e,i,n){return new(i||(i=Promise))((function(r,o){function s(t){try{A(n.next(t))}catch(t){o(t)}}function a(t){try{A(n.throw(t))}catch(t){o(t)}}function A(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(s,a)}A((n=n.apply(t,e||[])).next())}))};class qo{constructor(t){this.sceneInfo={},this.viewer=t,this.mapConfig=t.mapConfig,this.options={},this.init()}init(){const{onLoadMap:t}=this.viewer.options;this.viewer.instance.cesiumWidget.creditContainer.style.display="none",this.viewer.instance.cesiumWidget.screenSpaceEventHandler.removeInputAction(f.ScreenSpaceEventType.LEFT_DOUBLE_CLICK),this.viewer.instance.scene.screenSpaceCameraController.maximumZoomDistance=40489014,this.viewer.instance.imageryLayers.removeAll();const e=this.viewer.options.baseLayerImage||this.viewer.mapConfig.distUrl+"Imgs/earthbump.jpg";this.viewer.instance.imageryLayers.addImageryProvider(new f.SingleTileImageryProvider({url:e})).layerType="baseImage";let i=this.viewer.mapConfig.terrainLayers&&this.viewer.mapConfig.terrainLayers.fileContent;i&&(!i||i.content?i.content.forEach(t=>{let e=Object(g.assign)({},b,t);if(e.authentication){let t=new f.Resource({url:e.url,headers:{"access-token":this.viewer.mapConfig.accessToken}});delete e.url,delete e.authentication,this.viewer.instance.terrainProvider=new xr(Object.assign({url:t},e)),this.viewer.instance.terrainProvider.beforeRequest=(t,...e)=>{t._layers.forEach(t=>{t.resource.headers["access-token"]=this.viewer.mapConfig.accessToken})}}else this.viewer.instance.terrainProvider=new xr(e)}):At("c010106",t))}setOption(t){return Object(g.isEmpty)(t)||(this.options=Object.assign(Object.assign({distanceRange:[1,40489014]},this.options),t),this.setViewerOption(t).setSceneOption(t).setGlobeOption(t).setClockOption(t).setCameraOption(t)),this}getElevation(t){const{position:e,callback:i}=t;let n=this.viewer.instance.terrainProvider;if(n instanceof f.EllipsoidTerrainProvider)return void At("c010108",i);const r=e instanceof I?[f.Cartographic.fromDegrees(e.lng,e.lat)]:[f.Cartographic.fromDegrees(e[0],e[1])],o=Object(f.sampleTerrainMostDetailed)(n,r);Promise.resolve(o).then(t=>{t&&t[0]&&at(t[0].height,i)})}getZoom(){const t=f.Cartographic.fromCartesian(this.viewer.instance.camera.positionWC).height,e=-40467.74;return Math.round(e+80955.31/(1+Math.pow(t/91610.74,7096758e-11)))}setViewerOption(t){const{shadows:e,navigation:i}=t;if(Object(f.defined)(e)&&(this.viewer.instance.shadows=Object(f.defaultValue)(e,!1)),Object(f.defined)(i)){const{enableCompass:t=!0,enableZoomControls:e=!0,enableDistanceLegend:n=!0,enableCompassOuterRing:r=!0,resetViewPosition:o,duration:s=3}=i;this.viewer.navigation&&(this.viewer.navigation.destroy(),this.viewer.navigation=null);const a={};if(o){const{lng:t,lat:e,alt:i,heading:n,pitch:r,roll:s}=o;a.defaultResetView=new f.Cartographic(f.Math.toRadians(t),f.Math.toRadians(e),i),a.orientation={heading:f.Math.toRadians(n),pitch:f.Math.toRadians(r),roll:f.Math.toRadians(s)}}else a.defaultResetView=f.Rectangle.fromDegrees(100,10,120,70);a.duration=s,a.enableCompass=t,a.enableZoomControls=e,a.enableDistanceLegend=n,a.enableCompassOuterRing=r,this.viewer.navigation=new zo(this.viewer.instance,a)}return this}setSceneOption(t){const{showAtmosphere:e,atmosphereOptions:i,showSun:n,showMoon:r,showSkyBox:o,skybox:s,skyBox:a,skyBoxOptions:A,enableFog:l,enableFxaa:c,enableRotate:u,enableTilt:h,enableTranslate:p,enableZoom:d,distanceRange:g,requestRenderMode:m,backgroundColor:y,bloom:v}=t,_=this.viewer.instance.scene;if(Object(f.defined)(y)&&void 0!==y&&(_.backgroundColor=Object(f.defaultValue)(f.Color.fromCssColorString(y),f.Color.BLACK)),Object(f.defined)(e)&&(_.skyAtmosphere.show=Object(f.defaultValue)(e,!0)),Object(f.defined)(i)&&(i.brightnessShift&&(_.skyAtmosphere.brightnessShift=i.brightnessShift),i.hueShift&&(_.skyAtmosphere.hueShift=i.hueShift),i.saturationShift&&(_.skyAtmosphere.saturationShift=i.saturationShift)),Object(f.defined)(n)&&(_.sun.show=Object(f.defaultValue)(n,!0)),Object(f.defined)(r)&&(_.moon.show=Object(f.defaultValue)(r,!0)),Object(f.defined)(o)&&(_.skyBox.show=Object(f.defaultValue)(o,!0)),Object(f.defined)(s)&&this.addSkyBox(s),Object(f.defined)(a)&&this.addSkyBox(a),Object(f.defined)(A)&&(_.skyBox.nearGround=Object(f.defaultValue)(A.nearGround,!0),_.skyBox.mirrorEnable=Object(f.defaultValue)(A.mirrorEnable,!0)),Object(f.defined)(l)&&(_.fog.enabled=Object(f.defaultValue)(l,!1)),Object(f.defined)(m)&&(_.requestRenderMode=Object(f.defaultValue)(m,!1)),Object(f.defined)(c)&&(_.postProcessStages.fxaa.enabled=Object(f.defaultValue)(c,!1)),Object(f.defined)(u)&&(_.screenSpaceCameraController.enableRotate=Object(f.defaultValue)(u,!0)),Object(f.defined)(h)&&(_.screenSpaceCameraController.enableTilt=Object(f.defaultValue)(h,!0)),Object(f.defined)(p)&&(_.screenSpaceCameraController.enableTranslate=Object(f.defaultValue)(p,!0)),Object(f.defined)(d)&&(_.screenSpaceCameraController.enableZoom=Object(f.defaultValue)(d,!0)),Object(f.defined)(g)&&(_.screenSpaceCameraController.minimumZoomDistance=Object(f.defaultValue)(g&&g[0],1)),Object(f.defined)(g)&&(_.screenSpaceCameraController.maximumZoomDistance=Object(f.defaultValue)(g&&g[1],40489014)),Object(f.defined)(v)&&"object"==typeof v){const{show:t,glowOnly:e,contrast:i,brightness:n,delta:r,sigma:o,stepSize:s}=v;var w={show:!!Object(f.defined)(t)&&t,glowOnly:!!Object(f.defined)(e)&&e,contrast:Object(f.defined)(i)?i:128,brightness:Object(f.defined)(n)?n:-.3,delta:Object(f.defined)(r)?r:1,sigma:Object(f.defined)(o)?o:3.78,stepSize:Object(f.defined)(s)?s:5};let a=_.postProcessStages.bloom;a.enabled=w.show,a.uniforms.glowOnly=w.glowOnly,a.uniforms.contrast=w.contrast,a.uniforms.brightness=w.brightness,a.uniforms.delta=w.delta,a.uniforms.sigma=w.sigma,a.uniforms.stepSize=w.stepSize}return this}setGlobeOption(t){const{showGlobe:e,enableLighting:i,globeBaseColor:n,undergroundMode:r,tileCacheSize:o}=t,s=this.viewer.instance.scene.globe;return Object(f.defined)(e)&&(s.show=Object(f.defaultValue)(e,!0)),Object(f.defined)(i)&&(s.enableLighting=Object(f.defaultValue)(i,!1)),Object(f.defined)(n)&&void 0!==n&&(s.baseColor=f.Color.fromCssColorString(n)),Object(f.defined)(r)&&(s.depthTestAgainstTerrain=Object(f.defaultValue)(r,!1)),Object(f.defined)(o)&&(s.tileCacheSize=Object(f.defaultValue)(o,100)),this}setClockOption(t){const{shouldAnimate:e}=t;return Object(f.defined)(e)&&(this.viewer.instance.clock.shouldAnimate=Object(f.defaultValue)(e,!0)),this}setCameraOption(t){const{camera:e={}}=t,i=this.viewer.instance.scene.camera;if(Object(f.defined)(e.percentageChanged)&&(i.percentageChanged=e.percentageChanged),e.frustum){const{fov:t,aspectRatio:n}=e.frustum;Object(f.defined)(t)&&(i.frustum.fov=f.Math.toRadians(t)),Object(f.defined)(n)&&(i.frustum.aspectRatio=n)}if(e.lookAt){const{target:t,offset:n,transform:r}=e.lookAt;if(n&&n.type)if(1===n.type)i.lookAt(f.Cartesian3.fromDegrees(t[0],t[1],t[2]),new f.Cartesian3(...n.value));else if(2===n.type){let e=n.value;i.lookAt(f.Cartesian3.fromDegrees(t[0],t[1],t[2]),new f.HeadingPitchRange(f.Math.toRadians(e[0]),f.Math.toRadians(e[1]),e[2]))}r&&"identity"===r&&i.lookAtTransform(f.Matrix4.IDENTITY)}return this}setDayNight(t,e){this.dayNightOptions=Object.assign(Object.assign(Object.assign({viewer:e},{autoSwitch:!0,day:{},night:{}}),t),{modelArray:[],cityModelArray:[]});const{day:i,night:n,autoSwitch:r}=this.dayNightOptions,o=i.startTime||"9:00",s=n.startTime||"18:00";let a=o.split(":"),A=s.split(":"),l=parseInt(a[0]),c=parseInt(a[1]),u=parseInt(A[0]),h=parseInt(A[1]),p=(new Date).getHours(),d=(new Date).getMinutes();r&&(60*p+d>=60*l+c&&60*p+d<60*u+h?this.switchDayStyle():this.switchNightStyle(),this._dayNightInterval=setInterval(()=>{p=(new Date).getHours(),d=(new Date).getMinutes(),p==l&&d==c&&this.switchDayStyle(),p==u&&d==h&&this.switchNightStyle()},6e4))}switchDayStyle(){if(!this.dayNightOptions)return void console.error("dayNightOptions is null");const{day:t,viewer:e}=this.dayNightOptions;this._switchDayNightStyle(t,e)}switchNightStyle(){if(!this.dayNightOptions)return void console.error("dayNightOptions is null");const{night:t,viewer:e}=this.dayNightOptions;this._switchDayNightStyle(t,e)}_switchDayNightStyle(t,e){try{const{modelArray:i,cityModelArray:n}=this.dayNightOptions;i.forEach(t=>{t.remove()}),this.dayNightOptions.modelArray=[],n.forEach(t=>{t.remove()}),this.dayNightOptions.cityModelArray=[],t.viewId&&this.loadNewScene({id:t.viewId},e),t.baseLayer&&this.viewer.changeBaseLayer(Object.assign({},t.baseLayer)),t.model&&(t.model||[]).length>0&&(t.model||[]).forEach(t=>{let i=new Dr(Object.assign({viewer:e},t));i.addToViewer({}),this.dayNightOptions.modelArray.push(i)}),t.cityModel&&(t.cityModel||[]).length>0&&(t.cityModel||[]).forEach(t=>{let i=new Jr(Object.assign({viewer:e},t));i.addToViewer({}),this.dayNightOptions.cityModelArray.push(i)})}catch(t){console.error("setDayNight error")}}closeDayNight(){this._dayNightInterval&&clearInterval(this._dayNightInterval)}addImageryLayers(t){let e,i;switch(t.type){case"url":if(e=Object(g.assign)({},C,t),delete e.type,e.rectangle&&(e.rectangle=f.Rectangle.fromDegrees(...e.rectangle)),e.authentication){const t=e.url;let n,r=t.split(","),o=[];r.length>1?(n="{DOMAIN}/{z}/{y}/{x}",r.forEach(t=>{const e=t.split("/{z}/{y}/{x}")[0];o.push(e)})):n=t;const s=this.viewer.mapConfig.accessToken;let a=new f.Resource({url:this.viewer.mapConfig.paramAccessTokenSupport?n+"?t={Time}&at="+s:n+"?t={Time}",headers:{}});const A=(t,e,i,n)=>(this.viewer.mapConfig.paramAccessTokenSupport||(t._resource.headers["access-token"]=this.viewer.mapConfig.accessToken),this.viewer.mapConfig["2DDataSource"]||"");e.customTags={Time:A.bind(this)},e.url=a,o.length&&(e.urlDomains=o),i=new f.UrlTemplateImageryProvider(e)}else{const t=e.url;let n,r=t.split(","),o=[];r.length>1?(n="{DOMAIN}/{z}/{y}/{x}",r.forEach(t=>{const e=t.split("/{z}/{y}/{x}")[0];o.push(e)})):n=t;let s=new f.Resource({url:n});if(e.url=s,o.length&&(e.urlDomains=o),e.projection&&"EPSG:4326"===e.projection){const t=new f.GeographicTilingScheme;if(e.tilingScheme=t,e.customTags){const t=Object.keys(e.customTags)[0],i=Object.values(e.customTags)[0],n=new Function("return "+i)();e.customTags={[t]:n}}}i=new f.UrlTemplateImageryProvider(e)}break;case"wmts":if(e=Object(g.assign)({},w,t),delete e.type,e.rectangle&&(e.rectangle=f.Rectangle.fromDegrees(...e.rectangle)),e.authentication){let t=new f.Resource({url:e.url+"?t={Time}",headers:{}});const n=(t,e,i,n)=>(t._resource.headers["access-token"]=this.viewer.mapConfig.accessToken,this.viewer.mapConfig["2DDataSource"]||"");e.customTags={Time:n.bind(this)},e.url=t,i=new f.WebMapTileServiceImageryProvider(e)}else i=new f.WebMapTileServiceImageryProvider(e);break;case"arcgis":if(e=Object(g.assign)({},B,t),delete e.type,e.rectangle&&(e.rectangle=f.Rectangle.fromDegrees(...e.rectangle)),e.authentication){let t=new f.Resource({url:e.url+"?t={Time}",headers:{}});const n=(t,e,i,n)=>(t._resource.headers["access-token"]=this.viewer.mapConfig.accessToken,this.viewer.mapConfig["2DDataSource"]||"");e.customTags={Time:n.bind(this)},e.url=t,i=new f.ArcGisMapServerImageryProvider(e)}else i=new f.ArcGisMapServerImageryProvider(e)}return i.errorEvent.addEventListener(()=>{}),this.viewer.instance.imageryLayers.addImageryProvider(i),i}addSkyBox(t){const{positiveX:e,positiveY:i,positiveZ:n,negativeX:r,negativeY:o,negativeZ:s}=t,a=this.viewer.instance.scene;this.setOption({showAtmosphere:!1}),a.skyBox=new f.SkyBox({nearGround:!0,mirrorEnable:!0,sources:{positiveX:e,positiveY:i,positiveZ:n,negativeX:r,negativeY:o,negativeZ:s}})}loadNewScene(t,e){return Wo(this,void 0,void 0,(function*(){const{id:i,flyDuration:n,ended:r}=t;if(this.sceneInfo.id==i)return void at("Already in this scene",r);this.clearSceneInfo();let o=this.mapConfig.tilesetLayers;if(o&&o.list[i]){let t=o.list[i],s=0,a=0,A=[];(yield this.getInitModels(i)).forEach(t=>{const i=new Dr({viewer:e,id:t.modelSourceId,position:new I(t.lng,t.lat,t.alt),rotation:[t.roll,t.pitch,t.heading],scale:[t.scale,t.scale,t.scale],props:Object.assign({},t)});e.addLayer({layer:i,ended:()=>{a++}}),A.push(i)}),t.models&&t.models.forEach(t=>{const i=new Dr({viewer:e,id:t.url,position:new I(t.position[0],t.position[1],t.position[2])});e.addLayer({layer:i,ended:()=>{a++}}),A.push(i)}),this.sceneInfo.models=A,t.skybox&&t.skybox.negativeX?this.viewer.viewerOption.addSkyBox(t.skybox):this.viewer.instance.scene.skyBox=this.viewer.orignSkyBox;let l=t.imageryLayers||(this.viewer.mapConfig.imageryLayers.fileContent||{})["3d"];if(l&&l.content&&l.content.length>0){this.viewer.instance.imageryLayers._layers.filter(t=>"roadCondition"!==t.layerType&&"baseImage"!==t.layerType).forEach(t=>{this.viewer.instance.imageryLayers.remove(t)});let e=t.baseMapZoomRange;l.content.forEach(t=>{t.maximumLevel||t.minimumLevel||!e||(t.minimumLevel=e[0],t.maximumLevel=e[1]),this.addImageryLayers(t)}),this.viewer.baseLayerOptions&&this.viewer.setBaseLayerProps(this.viewer.baseLayerOptions)}let c=[];if(t.tilesetLayers&&t.tilesetLayers.length>0){let e=t.tilesetLayers;e.forEach((o,l)=>{let{light:u,modelMatrix:h,url:p}=o,d=new Jr({url:p,light:u,modelMatrix:h||new f.Matrix4,preloadWhenHidden:!0});d.addToViewer({viewer:this,ended:o=>{if(s++,c.push(d),s===e.length){20!==o.status&&t.camera&&t.camera[0]&&this.viewer.cameraOption.flyToPosition(new I(...t.camera),()=>{},n),this.sceneInfo.id=i,this.sceneInfo.urls=c;let e=setInterval(()=>{a===A.length&&(at(!0,r),clearInterval(e),e=null)},100)}}})})}else t.urls&&t.urls.length>0?At("版本过低，请更新到最新版本"):At("c010103",r)}}))}clearSceneInfo(){let t=this.sceneInfo;if(t.id){(t.models||[]).length>0&&(t.models.forEach(t=>{t.remove()}),t.models=[]);let e=t.urls,i=0;e.forEach(t=>{t.remove({ended:()=>{i++,e.length}})}),this.viewer.instance.imageryLayers._layers.filter(t=>"roadCondition"!==t.layerType&&"baseImage"!==t.layerType).forEach(t=>{this.viewer.instance.imageryLayers.remove(t)})}}getInitModels(t){return Wo(this,void 0,void 0,(function*(){return new Promise((e,i)=>{new Or({viewer:this.viewer}).getSceneModel({sceneId:t,callback:t=>{10===t.status?e(t.data):e([])}})})}))}}var Xo=function(t,e,i,n){return new(i||(i=Promise))((function(r,o){function s(t){try{A(n.next(t))}catch(t){o(t)}}function a(t){try{A(n.throw(t))}catch(t){o(t)}}function A(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(s,a)}A((n=n.apply(t,e||[])).next())}))};class Yo{constructor(t){this.flyStops=0,this.firstPersonControl={rotateSpeed:.05,panSpeed:.1,status:{},handler:null,keydownEvent:null,keyupEvent:null,tickEvent:null},this.viewer=t,this.mouseMode=0}get _viewer(){return this.viewer.instance}setPitchRange(t,e){this.viewer.instance.scene.camera._kmap_limit_pitch=[t,e]}limitCameraToGround(){this.viewer.instance.camera.changed.addEventListener(()=>{this.viewer.instance.camera&&this.viewer.instance.camera._suspendTerrainAdjustment&&this.viewer.instance.scene.mode===f.SceneMode.SCENE3D&&(this.viewer.instance.camera._suspendTerrainAdjustment=!1,this.viewer.instance.camera._adjustOrthographicFrustum(!0))})}changeMouseMode(t=0){this.mouseMode=t;const e=this.viewer.instance;0===t?(e.scene.screenSpaceCameraController.tiltEventTypes=[f.CameraEventType.MIDDLE_DRAG,f.CameraEventType.PINCH,{eventType:f.CameraEventType.LEFT_DRAG,modifier:f.KeyboardEventModifier.CTRL},{eventType:f.CameraEventType.RIGHT_DRAG,modifier:f.KeyboardEventModifier.CTRL}],e.scene.screenSpaceCameraController.zoomEventTypes=[f.CameraEventType.RIGHT_DRAG,f.CameraEventType.WHEEL,f.CameraEventType.PINCH]):1===t&&(e.scene.screenSpaceCameraController.tiltEventTypes=[f.CameraEventType.RIGHT_DRAG,f.CameraEventType.PINCH,{eventType:f.CameraEventType.LEFT_DRAG,modifier:f.KeyboardEventModifier.CTRL},{eventType:f.CameraEventType.RIGHT_DRAG,modifier:f.KeyboardEventModifier.CTRL}],e.scene.screenSpaceCameraController.zoomEventTypes=[f.CameraEventType.WHEEL,f.CameraEventType.PINCH])}getBounds(t){const{callback:e}=t;let i=this.viewer.instance.camera.computeViewRectangle();if(i){let t=f.Math.toDegrees(i.east),n=f.Math.toDegrees(i.north);e(at([[f.Math.toDegrees(i.west),f.Math.toDegrees(i.south)],[t,n]]))}else{const t=this.viewer.instance;let i=t.scene.canvas,n=new f.Cartesian2(0,0),r=new f.Cartesian2(i.clientWidth,i.clientHeight),o=t.scene.globe.ellipsoid,s=t.camera.pickEllipsoid(n,o),a=t.camera.pickEllipsoid(r,o),A=t.scene.globe.ellipsoid.cartesianToCartographic(s),l=t.scene.globe.ellipsoid.cartesianToCartographic(a),c=f.Math.toDegrees(A.longitude),u=f.Math.toDegrees(l.longitude);e(at([[c,f.Math.toDegrees(l.latitude)],[u,f.Math.toDegrees(A.latitude)]]))}}flyToPosition(t,e,i,n){return t instanceof I&&this.viewer.instance.camera.flyTo({destination:Y.WGS84ToCartesian(t),orientation:{heading:f.Math.toRadians(t.heading),pitch:f.Math.toRadians(t.pitch),roll:f.Math.toRadians(t.roll)},complete:e,duration:i,maximumHeight:n}),this}flyToBounds(t){const{lngLatBounds:e,orientation:i={},ended:n,duration:r}=t,o=e[0][0],s=e[0][1],a=e[1][0],A=e[1][1];return this.viewer.instance.camera.flyTo({destination:f.Rectangle.fromDegrees(o,s,a,A),orientation:{heading:f.Math.toRadians(i.heading||0),pitch:f.Math.toRadians(i.pitch||0),roll:f.Math.toRadians(i.roll||0)},complete:n,duration:r}),this}zoomToPosition(t,e){return t instanceof I&&this.viewer.instance.camera.flyTo({destination:Y.WGS84ToCartesian(t),orientation:{heading:f.Math.toRadians(t.heading),pitch:f.Math.toRadians(t.pitch),roll:f.Math.toRadians(t.roll)},complete:e,duration:0}),this}zoomToBounds(t){const{lngLatBounds:e,orientation:i={},ended:n}=t,r=e[0][0],o=e[0][1],s=e[1][0],a=e[1][1];return this.viewer.instance.camera.flyTo({destination:f.Rectangle.fromDegrees(r,o,s,a),orientation:{heading:f.Math.toRadians(i.heading||0),pitch:f.Math.toRadians(i.pitch||0),roll:f.Math.toRadians(i.roll||0)},complete:n,duration:0}),this}addRoaming(t){return Xo(this,void 0,void 0,(function*(){const{type:e="speed",lineData:i,speed:n=1,height:r=500,ended:o}=t;if(i&&!(i.length<2))if(this.flyStops=i.length,this.roamEventFun&&(this.viewer.instance.clock.onTick.removeEventListener(this.roamEventFun),this.roamEventFun=null),"speed"===e){this.pathNodes=this.fillRoamPath(i,r);let t,e,s,a=0,A=n;this.roamEventFun=()=>{if(this.pathNodes[a]){if(this.pathNodes[a+60]){const i=this.adjustCameraNoRoll(this.pathNodes[a+60],this.pathNodes[a]);i&&(t=i.direction,e=i.up,s=i.right)}this.viewer.instance.camera.position=this.pathNodes[a],e&&(this.viewer.instance.camera.direction=t,this.viewer.instance.camera.right=s,this.viewer.instance.camera.up=e)}else this.viewer.instance.clock.onTick.removeEventListener(this.roamEventFun),A=1,at(!0,o);a+=Math.max(Math.floor(A),1)},yield this.boforeRoamFly(),this.viewer.instance.clock.onTick.addEventListener(this.roamEventFun)}else if("time"===e){let t=0,e=!1;this.roamEventFun=()=>{if(t===this.flyStops&&(this._viewer.clock.onTick.removeEventListener(this.roamEventFun),at(!0,o)),!e&&i[t+1]){e=!0;const n=i[t],o=i[t+1],s=o[3],a=f.Cartesian3.fromDegrees(n[0],n[1],n[2]),A=f.Cartesian3.fromDegrees(o[0],o[1],o[2]),l=this.adjustCameraNoRoll(A,a);this._viewer.camera.flyTo({destination:A,orientation:l,duration:s,maximumHeight:r,complete:()=>{t++,e=!1},easingFunction:t=>t})}},yield this.boforeRoamFly(i),this._viewer.clock.onTick.addEventListener(this.roamEventFun)}}))}removeRoaming(t){const{ended:e}=t;this.viewer.instance.clock.onTick.removeEventListener(this.roamEventFun),at(!0,e)}addLookAround(t){return Xo(this,void 0,void 0,(function*(){const{isSelf:e=!1,ended:i}=t;return this.viewer.instance.clock.onTick.removeEventListener(this.rotateElseFun),this.viewer.instance.clock.onTick.removeEventListener(this.rotateSelfFun),this.rotateSelfFun=null,this.rotateElseFun=null,this.addRotateSelfFun(t),yield this.lookAtPoint(t),e?this.viewer.instance.clock.onTick.addEventListener(this.rotateSelfFun):this.viewer.instance.clock.onTick.addEventListener(this.rotateElseFun),i&&i(at(!0)),Promise.resolve()}))}removeLookAround(t){const{ended:e}=t;this.viewer.instance.clock.onTick.removeEventListener(this.rotateElseFun),this.viewer.instance.clock.onTick.removeEventListener(this.rotateSelfFun),e&&e(at(!0))}addRotateSelfFun(t){const{position:e,speed:i=1,distance:n,pitch:r}=t,o=this.viewer.instance.camera,s=f.Cartesian3.fromDegrees(e.lng,e.lat,e.alt),a=i,A=.005*a;this.rotateSelfFun=()=>{o.position=f.Cartesian3.fromDegrees(e.lng,e.lat,e.alt||50),o.flyTo({destination:s,orientation:{heading:o.heading+A,pitch:o.pitch,roll:o.roll},duration:0})},this.rotateElseFun=()=>{const t={center:s,distance:n,pitch:r,camera:this.viewer.instance.camera,speed:a},e=this.getNextPointOnCircle(t);e&&(o.position=e.position,o.direction=e.direction,o.up=e.up,o.right=e.right)}}rotate(t,e){return this.viewer.instance.camera.rotate(t,e),this}getHeadingPitchRoll(){return{heading:this.viewer.instance.camera.heading,pitch:this.viewer.instance.camera.pitch,roll:this.viewer.instance.camera.roll}}getUpRightDirection(){return{direction:this.viewer.instance.camera.direction,up:this.viewer.instance.camera.up,right:this.viewer.instance.camera.right}}lookAtPoint(t){const{position:e,pitch:i=45,distance:n,isSelf:r=!1}=t;return new Promise((t,o)=>{const s=this.viewer.instance.camera;let a=f.Cartesian3.fromDegrees(e.lng,e.lat,e.alt),A=f.Cartesian3.clone(a),l=new f.HeadingPitchRoll;if(r)l=new f.HeadingPitchRoll(0,f.Math.toRadians(-1*i),0),e.alt||(a=this.setCartesian3Height(a,e.alt));else{const t=Object(f.clone)(s.position),r=this.setCartesian3Height(t,e.alt);if(!r)return;const o=f.Cartesian3.subtract(r,a,new f.Cartesian3);f.Cartesian3.normalize(o,o);const c=n*Math.cos(f.Math.toRadians(i)),u=new f.Ray(a,o),h=f.Ray.getPoint(u,c,new f.Cartesian3);A=this.adjustCartesina3Height(h,n*Math.sin(f.Math.toRadians(i)));let p=f.Cartesian3.subtract(a,A,new f.Cartesian3);0===p.x&&0===p.y&&(p=new f.Cartesian3(10,10,-13)),f.Cartesian3.normalize(p,p);const d=f.Cartesian3.normalize(f.Cartesian3.cross(p,A,new f.Cartesian3),new f.Cartesian3);l={direction:p,up:f.Cartesian3.normalize(f.Cartesian3.cross(d,p,new f.Cartesian3),new f.Cartesian3)}}s.flyTo({destination:A,orientation:l,duration:0,complete:()=>{t(!0)}})})}setFirstPersonController(t){if(t.rotateSpeed&&(this.firstPersonControl.rotateSpeed=t.rotateSpeed),t.panSpeed&&(this.firstPersonControl.panSpeed=t.panSpeed),this.firstPersonControl.handler)return;let e,i;this.firstPersonControl.status={enableTranslate:this._viewer.scene.screenSpaceCameraController.enableTranslate,enableTilt:this._viewer.scene.screenSpaceCameraController.enableTilt,enableRotate:this._viewer.scene.screenSpaceCameraController.enableRotate,enableZoom:this._viewer.scene.screenSpaceCameraController.enableZoom,enableLook:this._viewer.scene.screenSpaceCameraController.enableLook},this._viewer.scene.screenSpaceCameraController.enableTranslate=!1,this._viewer.scene.screenSpaceCameraController.enableTilt=!1,this._viewer.scene.screenSpaceCameraController.enableRotate=!1,this._viewer.scene.screenSpaceCameraController.enableZoom=!1,this._viewer.scene.screenSpaceCameraController.enableLook=!1;let n={looking:!1,moveForward:!1,moveBackward:!1,moveUp:!1,moveDown:!1,moveLeft:!1,moveRight:!1};this.firstPersonControl.handler=new f.ScreenSpaceEventHandler(this._viewer.canvas),this.firstPersonControl.handler.setInputAction((function(t){n.looking=!0,i=e=f.Cartesian3.clone(t.position)}),f.ScreenSpaceEventType.LEFT_DOWN),this.firstPersonControl.handler.setInputAction((function(t){i=t.endPosition}),f.ScreenSpaceEventType.MOUSE_MOVE),this.firstPersonControl.handler.setInputAction((function(){n.looking=!1}),f.ScreenSpaceEventType.LEFT_UP);const r=t=>{switch(t){case"W".charCodeAt(0):case 38:return"moveForward";case"S".charCodeAt(0):case 40:return"moveBackward";case"A".charCodeAt(0):case 37:return"moveLeft";case"D".charCodeAt(0):case 39:return"moveRight";case"R".charCodeAt(0):return"moveUp";case"F".charCodeAt(0):return"moveDown";default:return}};this.firstPersonControl.keydownEvent=t=>{const e=r(t.keyCode);void 0!==e&&(n[e]=!0)},this.firstPersonControl.keyupEvent=t=>{const e=r(t.keyCode);void 0!==e&&(n[e]=!1)},document.addEventListener("keydown",this.firstPersonControl.keydownEvent,!1),document.addEventListener("keyup",this.firstPersonControl.keyupEvent,!1);const o=f.Cartesian3.normalize(f.Cartesian3.subtract(f.Cartesian3.fromDegrees(120.57318,31.29658,100),f.Cartesian3.fromDegrees(120.57318,31.29658,0),new f.Cartesian3),new f.Cartesian3),s=this._viewer.scene.globe.ellipsoid,a=this._viewer.camera,A=this._viewer.canvas.clientWidth,l=this._viewer.canvas.clientHeight;this.firstPersonControl.tickEvent=()=>{if(n.looking){var t=(i.x-e.x)/A,r=-(i.y-e.y)/l;a.look(o,t*this.firstPersonControl.rotateSpeed),a.lookUp(r*this.firstPersonControl.rotateSpeed)}var c=s.cartesianToCartographic(a.position).height*this.firstPersonControl.panSpeed;n.moveForward&&a.moveForward(c),n.moveBackward&&a.moveBackward(c),n.moveUp&&a.moveUp(c),n.moveDown&&a.moveDown(c),n.moveLeft&&a.moveLeft(c),n.moveRight&&a.moveRight(c)},this._viewer.clock.onTick.addEventListener(this.firstPersonControl.tickEvent)}cancelFirstPersonController(){const t=this.firstPersonControl,e=t.status;this._viewer.scene.screenSpaceCameraController.enableTranslate=e.enableTranslate,this._viewer.scene.screenSpaceCameraController.enableTilt=e.enableTilt,this._viewer.scene.screenSpaceCameraController.enableRotate=e.enableRotate,this._viewer.scene.screenSpaceCameraController.enableZoom=e.enableZoom,this._viewer.scene.screenSpaceCameraController.enableLook=e.enableLook,t.handler&&(t.handler.destroy(),t.handler=null),t.keydownEvent&&(document.removeEventListener("keydown",t.keydownEvent,!1),t.keydownEvent=null),t.keyupEvent&&(document.removeEventListener("keyup",t.keyupEvent,!1),t.keyupEvent=null),t.tickEvent&&(this._viewer.clock.onTick.removeEventListener(t.tickEvent),t.tickEvent=null)}fillRoamPath(t,e){const i=[];return t.forEach((n,r)=>{const o=n,s=t[r+1];if(s){const t=f.Cartesian3.fromDegrees(o[0],o[1],o[2]||e),n=f.Cartesian3.fromDegrees(s[0],s[1],s[2]||e),r=f.Cartesian3.distance(t,n),a=Math.floor(r)+1;for(let t=0;t<a;t++){const n=f.Math.lerp(o[0],s[0],t/a),r=f.Math.lerp(o[1],s[1],t/a),A=f.Math.lerp(o[2],s[2],t/a);i.push(f.Cartesian3.fromDegrees(n,r,A||e))}}const a=f.Cartesian3.fromDegrees(n[0],n[1],n[2]||e);i.push(a)}),i}boforeRoamFly(t){return Xo(this,void 0,void 0,(function*(){const e=t?f.Cartesian3.fromDegrees(t[0][0],t[0][1],t[0][2]):this.pathNodes[0],i=t?f.Cartesian3.fromDegrees(t[1][0],t[1][1],t[1][2]):this.pathNodes[1];return new Promise(t=>{this.viewer.instance.camera.flyTo({destination:e,orientation:this.adjustCameraNoRoll(i,e),complete:()=>{t(!0)}})})}))}adjustCameraNoRoll(t,e){const i={direction:new f.Cartesian3,right:new f.Cartesian3,up:new f.Cartesian3};if(t&&e)return f.Cartesian3.subtract(t,e,i.direction),f.Cartesian3.normalize(i.direction,i.direction),f.Cartesian3.normalize(e,i.up),f.Cartesian3.cross(i.direction,i.up,i.right),f.Cartesian3.normalize(i.right,i.right),f.Cartesian3.cross(i.right,i.direction,i.up),f.Cartesian3.normalize(i.up,i.up),i}getNextPointOnCircle(t){const{center:e,camera:i,speed:n,distance:r,pitch:o}=t;let s=1;if(!e||!i)return;const a=i.position,A=this.adjustCartesina3Height(e,r*Math.sin(f.Math.toRadians(o))),l=f.Cartesian3.distance(A,a),c=i.right,u=new f.Ray(a,c),h=new f.Cartesian3;s=l/1e3,f.Ray.getPoint(u,n*s,h);new f.Cartesian3;const p=new f.Cartesian3,d=new f.Cartesian3;f.Cartesian3.subtract(h,A,p),f.Cartesian3.normalize(p,p);const g=new f.Ray(A,p);f.Ray.getPoint(g,l,d),f.Cartesian3.subtract(d,e,p),f.Cartesian3.normalize(p,p);const m=new f.Cartesian3,y=new f.Cartesian3;return f.Cartesian3.negate(p,p),f.Cartesian3.cross(p,d,m),f.Cartesian3.cross(m,p,y),{position:d,direction:p,up:y,right:m}}setCartesian3Height(t,e){if(!t||!e&&0!==e)return;const i=f.Cartographic.fromCartesian(t);return i?f.Cartesian3.fromRadians(i.longitude,i.latitude,e):void 0}adjustCartesina3Height(t,e){if(!t||!e&&0!==e)return;const i=f.Cartographic.fromCartesian(t);return f.Cartesian3.fromRadians(i.longitude,i.latitude,e||0)}}var Jo=i(21),Zo=i.n(Jo),$o=function(t,e,i,n){return new(i||(i=Promise))((function(r,o){function s(t){try{A(n.next(t))}catch(t){o(t)}}function a(t){try{A(n.throw(t))}catch(t){o(t)}}function A(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(s,a)}A((n=n.apply(t,e||[])).next())}))};class ts{constructor(t,e={}){if(this.mapConfig={},this.options={},this.baseLayerOptions=null,this.canvasScale={x:1,y:1},this.measureCache=[],this.graphicIndex=0,this.particleLayer=[],this.navigation=null,"string"==typeof t)this.containerId=t,this.containerBox=document.getElementById(t);else{const e=t.id;e&&(this.containerId=e),this.containerBox=t}this.createInstance(t,e)}createInstance(t,e={}){return $o(this,void 0,void 0,(function*(){this.options=e,this.options.language&&(st.lang=this.options.language);const{configUrl:i,onLoadMap:n,onSourceLoaded:r}=e;if(!this.instance){let o;if("object"==typeof i)o=i;else if(o=yield mt.get({url:i}).catch(t=>{At("c010101",n)}),!o)return;let s=o.distUrl;if(s.endsWith("/")||(s+="/",o.distUrl=s),window.CESIUM_BASE_URL=s,f.buildModuleUrl.setBaseUrl(s),!(yield mt.get({url:s+"Assets/Textures/maki/airport.png",withCredentials:!1}).catch(t=>{At("c010102",n)})))return;let a="";if(/http/.test(o.portalUrl)?a=o.portalUrl:(a=location.origin+"/portal",o.portalUrl=a),this.options.isPreview){let e={url:ct(o).GET_TOKEN,body:{userName:o.userName,secretKey:o.secretKey}};const i=yield mt.get(e).catch(t=>{At("token get error!",n)});if(!i)return;const r=i.result.access_token;this.instance=new f.Viewer(t,Object.assign({},_)),this.mapConfig=Object.assign(Object.assign({},o),{accessToken:r})}else{let i={url:ct(o).GET_CONFIG_URL,body:{userName:o.userName,secretKey:o.secretKey,configType:1,type:"3D",configKey:"KMAP_EARTH"},headers:{"base-url":a,"gateway-proxy":o.gatewayProxy||!1}},r=yield mt.get(i).catch(t=>{At("c010103",n)});if(!r)return;r=r.result;const{searchServer:s,routingServer:A,usermngServer:l,configServer:c,wsServer:u,sockjsCTWsServer:h,KGisRoutingPro:p}=r;let d=Object.assign(Object.assign({},r),{searchServer:`${o.portalUrl}${s}`,routingServer:`${o.portalUrl}${A}`,usermngServer:`${o.portalUrl}${l}`,configServer:`${o.portalUrl}${c}`,routeServer:`${o.portalUrl}${p}`,wsServer:o.gatewayProxy?`${o.portalUrl}${h}`:u});if(this.mapConfig=Object.assign(Object.assign({},o),d),r.validPeriodCode&&4612===r.validPeriodCode&&r.validPeriodMessage.forEach(t=>{console.error(t)}),d.spriteUrl){let t=d.spriteUrl;d.acrossNetPortalUrl&&d.spriteUrl.indexOf(d.acrossNetPortalUrl)>-1&&(t=t.replace(d.acrossNetPortalUrl,o.portalUrl)),1===window.devicePixelRatio?this.spriteJson=yield mt.get({url:t+"sprite.json"}).catch(t=>{At("c010104",n)}):this.spriteJson=yield mt.get({url:t+"sprite@2x.json"}).catch(t=>{At("c010104",n)})}let g=f.Rectangle.fromDegrees(100,10,120,70);f.Camera.DEFAULT_VIEW_RECTANGLE=g,f.Camera.DEFAULT_VIEW_FACTOR=0,this.instance=new f.Viewer(t,Object.assign(Object.assign({},_),e)),this.refreshToken(this.mapConfig.expiresIn)}const A=new f.EventHelper;let l=null;const c=A.add(this.instance.scene.postRender,(function(t){let e=!0,i=t.primitives;for(let t=0;t<i.length;t++){const n=i.get(t);n instanceof qr&&n.root&&n.root._visible&&n.root._inRequestVolume&&(e=e&&n.isLoad),n instanceof f.Model&&(e=e&&n.isLoad)}t.globe.tilesLoaded&&e&&(l||(l=t.frameState.frameNumber),t.frameState.frameNumber>l+3&&(c(),r&&r(at(!0))))}));this.layerCache=new m,this.viewerOption=new qo(this),this.cameraOption=new Yo(this),this.viewerEvent=new wr,this.sceneEvent=new Er(this),this.keyboradEvent=new v(this),this._mouseEvent=new _r(this),this.instance.canvas.setAttribute("tabindex","-1"),this.instance.container.style.position="relative",this.instance.container.style.overflow="hidden",this.instance.animation&&this.instance.animation.container&&(this.instance.animation.container.style.visibility="hidden"),this.orignSkyBox=this.instance.scene.skyBox,this.initLoadedFn=()=>{this.instance.scene.globe.tilesLoaded&&(at(!0,n),this.instance.scene.globe.tileLoadProgressEvent.removeEventListener(this.initLoadedFn),this.initLoadedFn=null)},this.instance.scene.globe.tileLoadProgressEvent.addEventListener(this.initLoadedFn)}}))}setOptions(t){return this.viewerOption&&this.viewerOption.setOption(t),this}setPitchRange(t=-90,e=-20){return this.cameraOption.setPitchRange(t,e),this}limitCameraToGround(){return this.cameraOption.limitCameraToGround(),this}limitCameraMaxHeight(t){const e=this.instance;if(0===t)e.scene.screenSpaceCameraController.maximumZoomDistance=40489014;else{e.scene.screenSpaceCameraController.maximumZoomDistance=t;const i=e.scene.camera;if(i.positionCartographic.height>t){let e={destination:[i.positionCartographic.longitude,i.positionCartographic.latitude,i.positionCartographic.height],orientation:[i.heading,i.pitch,i.roll]};i.flyTo({destination:f.Cartesian3.fromRadians(e.destination[0],e.destination[1],t),orientation:{heading:e.orientation[0],pitch:e.orientation[1],roll:e.orientation[2]},duration:0})}}return this}getBounds(t){this.cameraOption.getBounds(t)}getElevation(t){this.viewerOption.getElevation(t)}screenshot(t){const{callback:e,quality:i=.5}=t;let n=!1;const r=this.instance.container;let o=()=>{n||(n=!0,Zo()(r,{ignoreElements(t){const e=t.compareDocumentPosition(document.head);if([0,10].includes(e))return!1;const i=t.compareDocumentPosition(r);return![0,10,20].includes(i)&&!["STYLE","LINK"].includes(t.nodeName)},removeContainer:!1,useCORS:!0}).then(t=>{let n=t.toDataURL("image/jpeg",i);this.instance.scene.postRender.removeEventListener(o),at(n,e)}))};this.instance.scene.postRender.addEventListener(o)}getZoom(){return this.viewerOption.getZoom()}changeSceneMode(t,e=0){switch(t){case 2:this.instance.scene.morphTo2D(e);break;case 3:this.instance.scene.morphTo3D(e);break;case 2.5:this.instance.scene.morphToColumbusView(e)}return this}changeBaseLayer(t){return $o(this,void 0,void 0,(function*(){const{id:e,ended:i}=t;let n={url:ct(this.mapConfig).GET_SINGLE_CONFIG_URL,body:{configType:1,type:"3D",configKey:"KMAP_EARTH",imagerySolutionId:e},headers:{"base-url":this.mapConfig.portalUrl}},r=yield mt.post(n,this.mapConfig).catch(t=>{At("c010105",i)});if(!r)return;let o=r&&r.result&&r.result.imageryLayers&&r.result.imageryLayers.fileContent&&r.result.imageryLayers.fileContent["3d"];if(!o)return void At("c010105",i);this.instance.imageryLayers._layers.filter(t=>"roadCondition"!==t.layerType&&"baseImage"!==t.layerType).forEach(t=>{this.instance.imageryLayers.remove(t)});let s=this.mapConfig.baseMapZoomRange;o.content.forEach(t=>{t.maximumLevel||t.minimumLevel||!s||(t.minimumLevel=s[0],t.maximumLevel=s[1]),this.viewerOption.addImageryLayers(t)}),this.baseLayerOptions&&this.setBaseLayerProps(this.baseLayerOptions);const a=this.instance.imageryLayers._layers.filter(t=>"roadCondition"===t.layerType);if(a.length){const t=a[0];this.instance.imageryLayers._layers.filter(t=>"roadCondition"!==t.layerType&&"baseImage"!==t.layerType).length>1?(this.instance.imageryLayers.raiseToTop(t),this.instance.imageryLayers.lower(t)):this.instance.imageryLayers.raiseToTop(t)}i&&i(at(!0))}))}setDayNight(t,e){this.viewerOption.setDayNight(t,e)}switchDayStyle(){this.viewerOption.switchDayStyle()}switchNightStyle(){this.viewerOption.switchNightStyle()}closeDayNight(){this.viewerOption.closeDayNight()}setBaseLayerProps(t){const{show:e=!0,opacity:i=1,brightness:n=1,contrast:r=1,saturation:o=1,gamma:s=1,hue:a=0,ended:A}=t;this.instance.imageryLayers._layers.forEach(t=>{t.show=e,t.alpha=i,t.brightness=n,t.contrast=r,t.saturation=o,t.gamma=s,t.hue=a}),this.baseLayerOptions=t,A&&A(at(!0))}changeBaseLayerImage(t){const{url:e,ended:i}=t;if(this.instance.imageryLayers._layers.forEach(t=>{"baseImage"==t.layerType&&this.instance.imageryLayers.remove(t)}),e){const t=new f.SingleTileImageryProvider({url:e});this.instance.imageryLayers.addImageryProvider(t,0).layerType="baseImage"}i&&i(at(!0))}changeTerrain(t){return $o(this,void 0,void 0,(function*(){const{id:e,ended:i}=t;if(this.instance.terrainProvider=new f.EllipsoidTerrainProvider({}),e){let t={url:ct(this.mapConfig).GET_SINGLE_CONFIG_URL,body:{configType:1,type:"3D",configKey:"KMAP_EARTH",terrainSolutionId:e}},n=yield mt.post(t,this.mapConfig).catch(t=>{At("c010106",i)});if(!n)return;let r=n.result&&n.result.terrainLayers&&n.result.terrainLayers.fileContent;if(!r||r&&!r.content)return void At("c010106",i);r.content.forEach(t=>{let e=Object(g.assign)({},b,t);if(e.authentication){let t=new f.Resource({url:e.url,headers:{"access-token":this.mapConfig.accessToken}});delete e.url,delete e.authentication,this.instance.terrainProvider=new f.CesiumTerrainProvider(Object.assign({url:t},e)),this.instance.terrainProvider.beforeRequest=t=>{t._layers.forEach(t=>{t.resource.headers["access-token"]=this.mapConfig.accessToken})}}else this.instance.terrainProvider=new f.CesiumTerrainProvider(e)}),i&&i(at(!0))}}))}addLayer(t,e,i){t.addToViewer?t.addToViewer({viewer:e,ended:i}):At("layer is null",i)}removeLayer(t,e){t.remove({ended:e})}getLayers(){return this.layerCache.getAll()}hasLayerType(t){return this.layerCache.hasType(t)}getLayerByType(t){return this.layerCache.getByType(t)}flyToPosition(t){const{position:e,callback:i,ended:n,duration:r=3,maximumHeight:o}=t;return this.cameraOption&&this.cameraOption.flyToPosition(e,i||n,r,o),this}zoomToPosition(t){const{position:e,callback:i,ended:n}=t;return this.cameraOption&&this.cameraOption.zoomToPosition(e,i||n),this}flyToBounds(t){return this.cameraOption.flyToBounds(t),this}zoomToBounds(t){return this.cameraOption.zoomToBounds(t),this}addRoaming(t){return this.cameraOption.addRoaming(t),this}removeRoaming(t){return this.cameraOption.removeRoaming(t),this}addLookAround(t){const{ended:e}=t;if(!(t.pitch>=90)||t.isSelf)return this.cameraOption.addLookAround(t),this;At("pitch must less than 90!",e)}removeLookAround(t){return this.cameraOption.removeLookAround(t),this}setFirstPersonController(t){return this.cameraOption.setFirstPersonController(t),this}cancelFirstPersonController(){return this.cameraOption.cancelFirstPersonController(),this}rotate(t,e){this.cameraOption.rotate(t,e)}getHeadingPitchRoll(){return this.cameraOption.getHeadingPitchRoll()}getUpRightDirection(){return this.cameraOption.getUpRightDirection()}addDirectionalLight(t){const{direction:e,isFollowCamera:i=!1,intensity:n=1,ended:r}=t;let o=new f.DirectionalLight({direction:f.defined(e)?new f.Cartesian3(...e):this.instance.camera.directionWC,intensity:n});this.instance.scene.light=o,i&&this.instance.scene.preRender.addEventListener(this.setDirectionLight.bind(this)),this.instance.scene.light===o&&r&&r(at(!0))}removeDirectionalLight(t={}){const{ended:e}=t;if(this.instance.scene.light instanceof f.DirectionalLight){let t=new f.SunLight;this.instance.scene.light=t,this.instance.scene.preRender.removeEventListener(this.setDirectionLight),e&&e(at(!0))}}resizeScale(t,e){this.canvasScale.x=t||1,this.canvasScale.y=e||1}on(t,e){return"cameraChanged"===t||"cameraMoveEnd"===t||t===Ar||t===lr||t===cr||t===ur?this.sceneEvent.on(t,e,this):"keydown"===t||"keyup"===t?this.keyboradEvent.on(t,e,!1):this.viewerEvent.on(t,e,this),this}off(t,e){return"cameraChanged"===t||"cameraMoveEnd"===t||t===Ar||t===lr||t===cr||t===ur?this.sceneEvent.off(t,e||!1,this):"keydown"===t||"keyup"===t?this.keyboradEvent.off(t,!1):this.viewerEvent.off(t,e||!1,this),this}setDirectionLight(t,e){t.light.direction=f.Cartesian3.clone(t.camera.directionWC,t.light.direction)}setAmbientLight(t){f.ExpandBySTC&&(f.ExpandBySTC.lightObj.extendLightSwitch.x=t.enable,f.ExpandBySTC.lightObj.extendAmbientLightBrightness=t.brightness,f.ExpandBySTC.lightObj.extendAmbientLightColor=f.Color.fromCssColorString(t.color||"#FFF"))}destroy(){this.layerCache.getAll().forEach(t=>{t.remove&&t.remove(),t.destroy&&t.destroy()}),this._mouseEvent&&this._mouseEvent.removeInputAction(),this.instance&&this.instance.destroy(),clearTimeout(this.tokenTimer),this.tokenTimer=null}addLightSource(t){let e;if(t.type==f.LightSourceType.POINT)e=new f.PointLight({position:f.Cartesian3.fromDegrees(...t.position),color:f.Color.fromCssColorString(t.color||"#fff"),intensity:t.intensity,distance:t.distance,decay:t.decay});else{if(t.type!=f.LightSourceType.SPOT)return;if(!t.targetPosition)return void At("targetPosition is required",!0);e=new f.SpotLight({position:f.Cartesian3.fromDegrees(...t.position),targetPosition:f.Cartesian3.fromDegrees(...t.targetPosition),color:f.Color.fromCssColorString(t.color||"#fff"),intensity:t.intensity,distance:t.distance,angle:t.angle,decay:t.decay})}this.instance.scene.lightSource.addLightSource(e);const i=this.getLayers().filter(t=>"tileset"===t._layerType);return this.lightFn=()=>{const t=this.instance.scene.lightSource,e=t.pointLight,n=t.spotLight,r=e.length,o=n.length;i.forEach(e=>{e.setUniform({uPointSize:r,uPointLightPositionEC:t.createUniformMap().uPointLightPositionEC(),uPointLightColor:t.createUniformMap().uPointLightColor(),uPointLightDistanceAndDecayAndVisible:t._pointLightDistanceDecayVisible,uSpotSize:o,uSpotLightPositionEC:t.createUniformMap().uSpotLightPositionEC(),uSpotLightColor:t.createUniformMap().uSpotLightColor(),uSpotLightDirectionEC:t.createUniformMap().uSpotLightDirectionEC(),uSpotLightExponent:t.createUniformMap().uSpotLightExponent(),uSpotLightDistanceDecayCosVisible:t._spotLightDistanceDecayCosVisible})})},this.instance.scene.lightSource.addListenFn(this.lightFn),e}removeLightSource(t){const e=this.instance.scene.lightSource.removeLightSource(t),i=this.instance.scene.lightSource,n=i.pointLight.length,r=i.spotLight.length;if(!n.length&&!r.length){this.instance.scene.lightSource.removeListenFn(),this.lightFn=null;this.getLayers().filter(t=>"tileset"===t._layerType).forEach(t=>{t.setUniform({uPointSize:0,uSpotSize:0})})}return e}setShadowMap(t){let e=this.instance.scene;e.shadowMap.darkness=Object(f.defaultValue)(t.darkness,.3),e.shadowMap.softShadows=Object(f.defaultValue)(t.softShadows,!1),e.shadowMap.size=Object(f.defaultValue)(t.size,2048),e.shadowMap.maximumDistance=Object(f.defaultValue)(t.maximumDistance,2048),e.shadowMap.normalOffset=Object(f.defaultValue)(t.normalOffset,!0)}setScreenAdjust(t){null==this.screenAdjustStage&&(this.screenAdjustStage=this.instance.scene.postProcessStages.add(new f.PostProcessStage({fragmentShader:"uniform sampler2D colorTexture;\r\nvarying vec2 v_textureCoordinates;\r\nuniform float _Brightness;\r\nuniform float _Saturation;\r\nuniform float _Contrast;\r\nvoid main(void) {\r\n    vec4 renderTex = texture2D(colorTexture, v_textureCoordinates);\r\n    vec3 finalColor = renderTex.rgb * _Brightness;\r\n    float luminance = 0.2125 * renderTex.r + 0.7154 * renderTex.g + 0.0721 * renderTex.b;\r\n    vec3 luminanceColor = vec3(luminance, luminance, luminance);\r\n    finalColor = mix(luminanceColor, finalColor, _Saturation);\r\n    vec3 avgColor = vec3(0.5, 0.5, 0.5);\r\n    finalColor = mix(avgColor, finalColor, _Contrast);\r\n    gl_FragColor = vec4(finalColor, renderTex.a);\r\n}",uniforms:{}}))),this.screenAdjustStage.uniforms._Brightness=Object(f.defaultValue)(t.brightness,1.6),this.screenAdjustStage.uniforms._Saturation=Object(f.defaultValue)(t.saturation,1.9),this.screenAdjustStage.uniforms._Contrast=Object(f.defaultValue)(t.contrast,1)}removeAllMeasure(){return this.measureCache.forEach(t=>{t.destroy()}),this.measureCache=[],!0}refreshToken(t){t||(t=86400);const e=1e3*(t-14400);this.tokenTimer=setTimeout(()=>{mt.get({url:this.mapConfig.portalUrl+"/auth/accessToken",body:{userName:this.mapConfig.userName,secretKey:this.mapConfig.secretKey}}).then(t=>{const{access_token:e,expires_in:i}=t.result;this.mapConfig.accessToken=e,this.refreshToken(i)})},e)}}var es={setOptions:{shadow:{type:k.Boolean},showAtmosphere:{type:k.Boolean},atmosphereOptions:{type:k.Object},showSun:{type:k.Boolean},showMoon:{type:k.Boolean},showSkyBox:{type:k.Boolean},enableFog:{type:k.Boolean},enableFxaa:{type:k.Boolean},enableRotate:{type:k.Boolean},enableTilt:{type:k.Boolean},enableTranslate:{type:k.Boolean},enableZoom:{type:k.Boolean},distanceRange:{type:k.Array,children:[{type:k.Number,required:!0},{type:k.Number,required:!0}],validator:t=>{if(2==t.length)return t[1]>t[0]},message:"distanceRange[1] is greater than or equal to distanceRange[0]"},showGlobe:{type:k.Boolean},enableLighting:{type:k.Boolean},undergroundMode:{type:k.Boolean},tileCacheSize:{type:k.Boolean},shouldAnimate:{type:k.Boolean},requestRenderMode:{type:k.Boolean},backgroundColor:{type:k.Color},globeBaseColor:{type:k.Color},camera:{type:k.Object},skybox:{type:k.Object}},setPichRange:{min:{type:k.Number,required:!0},max:{type:k.Number,required:!0}},getBounds:{callback:{type:k.Function,required:!0}},getElevation:{position:{required:!0},callback:{type:k.Function,required:!0}},screenshot:{quality:{type:k.Number},callback:{type:k.Function,required:!0}},changeBaseLayer:{id:{type:k.String,required:!0},ended:{type:k.Function}},setBaseLayerProps:{show:{type:k.Boolean},opacity:{type:k.Number,validator:t=>t>=0&&t<=1,message:"opacity should be set to 0-1"},brightness:{type:k.Number,validator:t=>t>=0&&t<=3,message:"brightness should be set to 0-3"},contrast:{type:k.Number,validator:t=>t>=0&&t<=3,message:"contrast should be set to 0-3"},saturation:{type:k.Number,validator:t=>t>=0&&t<=3,message:"saturation should be set to 0-3"},gamma:{type:k.Number,validator:t=>t>=0&&t<=3,message:"gamma should be set to 0-3"},hue:{type:k.Number,validator:t=>t>=0&&t<=3,message:"hue should be set to 0-3"},ended:{type:k.Function}},changeTerrain:{id:{type:k.String,required:!0},callback:{type:k.Function},ended:{type:k.Function}},changeScene:{id:{type:[k.String,k.Number],required:!0},ended:{type:k.Function}},addLayer:{layer:{type:k.Object,required:!0},ended:{type:k.Function}},flyToPosition:{position:{type:k.Object,required:!0},callback:{type:k.Function},ended:{type:k.Function},duration:{type:k.Number}},zoomToPosition:{position:{type:k.Object,required:!0},callback:{type:k.Function},ended:{type:k.Function}},flyToBounds:{lngLatBounds:{type:k.Array,required:!0},ended:{type:k.Function},orientation:{type:k.Object},duration:{type:k.Number}},zoomToBounds:{lngLatBounds:{type:k.Array,required:!0},ended:{type:k.Function},orientation:{type:k.Object}},addRoaming:{lineData:{type:k.Array,required:!0},speed:{type:k.Number},height:{type:k.Number},ended:{type:k.Function}},removeRoaming:{ended:{type:k.Function}},addLookAround:{position:{type:k.Object,required:!0},distance:{type:k.Number},pitch:{type:k.Number,validator:function(t,e){return!!e.isSelf||t<90&&t>0},message:"pitch < 90"},speed:{type:k.Number},isSelf:{type:k.Boolean},ended:{type:k.Function}},rotateOptions:{axis:{type:k.Object,required:!0,children:{x:{type:k.Number,requie:!0},y:{type:k.Number,requie:!0},z:{type:k.Number,requie:!0}}},angle:{type:k.Number}},addDirectionalLight:{direction:{type:k.Array},isFollowCamera:{type:k.Boolean},intensity:{type:k.Number,validator:t=>t>0,message:"intensity must greater than 0!"},ended:{type:k.Function}},setAmbientLightOptions:{color:{type:k.String},brightness:{type:k.Number},enable:{type:k.Boolean}},setDayNight:{autoSwitch:{type:k.Boolean},day:{type:k.Object,required:!0},night:{type:k.Object,required:!0}},addLightSourceOptions:{type:{type:k.Number,required:!0},position:{type:k.Array,required:!0},color:{type:k.Color},intensity:{type:k.Number,validator:t=>t>0},distance:{type:k.Number,validator:t=>t>0},angle:{type:k.Number,validator:t=>t>0},decay:{type:k.Number,validator:t=>t>0}},removeLightSourceOptions:{lightType:{type:k.Number,required:!0},id:{type:k.String,required:!0}},setShadowMapOptions:{darkness:{type:k.Number,validator:t=>t>=0&&t<=1},softShadows:{type:k.Boolean},size:{type:k.Number},maximumDistance:{type:k.Number},normalOffset:{type:k.Boolean}},setScreenAdjustOptions:{brightness:{type:k.Number},saturation:{type:k.Number},contrast:{type:k.Number}},setFirstPersonOptions:{rotateSpeed:{type:k.Number,validator:t=>t>=0&&t<=1,message:"rotateSpeed should be set to 0-1"},panSpeed:{type:k.Number,validator:t=>t>=0&&t<=10,message:"panSpeed should be set to 0-10"}}};k.Color.customValidate=function(t){return!!f.Color[t.toUpperCase()]};var is={on:{event:{type:k.String,required:!0},handler:{type:k.Function,required:!0}},off:{event:{type:k.String,required:!0}},addToViewer:{viewer:{type:k.Object},ended:{type:k.Function},callback:{type:k.Function}},remove:{ended:{type:k.Function}}},ns=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},rs=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let os=class{constructor(t){this.instance=new Qr(t)}addToViewer(t){this.instance.addToViewer(t)}remove(t={}){this.instance.remove(t)}show(){this.instance.show()}hide(){this.instance.hide()}setProperty(t){this.instance.setProperty(t)}setStyle(t){this.instance.setStyle(t)}setDraggable(t){this.instance.setDraggable(t)}on(t){this.instance.on(t)}off(t){this.instance.off(t)}};ns([R(is.addToViewer),rs("design:type",Function),rs("design:paramtypes",[Object]),rs("design:returntype",void 0)],os.prototype,"addToViewer",null),ns([R(is.remove),rs("design:type",Function),rs("design:paramtypes",[Object]),rs("design:returntype",void 0)],os.prototype,"remove",null),ns([R(is.on),rs("design:type",Function),rs("design:paramtypes",[Object]),rs("design:returntype",void 0)],os.prototype,"on",null),ns([R(is.off),rs("design:type",Function),rs("design:paramtypes",[Object]),rs("design:returntype",void 0)],os.prototype,"off",null),os=ns([H({viewer:{type:k.Object,required:!0},position:{type:k.Object,required:!0},element:{type:[k.DOM,k.String],required:!0},anchor:{type:k.String},offset:{type:k.Array},scaleByDistance:{type:k.Array}}),rs("design:paramtypes",[Object])],os);var ss=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},as=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let As=class{constructor(t){t.instance&&t.instance instanceof Dr?this._modelInstance=t.instance:this._modelInstance=new Dr(t)}getProps(){if(this._modelInstance)return this._modelInstance.getProps()}addToViewer(t){this._modelInstance.addToViewer(t)}remove(t={}){this._modelInstance.remove(t)}show(t){if(t){const{duration:e,delay:i,callback:n}=t;this._modelInstance.showAnimation(e,i,n)}else this._modelInstance.showAnimation(0,0)}hide(t){if(t){const{duration:e,delay:i,callback:n}=t;this._modelInstance.hideAnimation(e,i,n)}else this._modelInstance.hideAnimation(0,0)}on(t){t.event=gr[t.event],this._modelInstance.on(t)}off(t){t.event=gr[t.event],this._modelInstance.off(t)}translateX(t){this._modelInstance.translateX(t)}translateY(t){this._modelInstance.translateY(t)}translateZ(t){this._modelInstance.translateZ(t)}rotateX(t){this._modelInstance.rotateX(t)}rotateY(t){this._modelInstance.rotateY(t)}rotateZ(t){this._modelInstance.rotateZ(t)}scale(t){this._modelInstance.scale(t)}setPosition(t){this._modelInstance.setPosition(t)}setProperty(t){this._modelInstance.setProperty(t)}getAnimations(){return this._modelInstance.getAnimations()}setAnimation(t){this._modelInstance.setAnimation(t)}removeAnimation(){this._modelInstance.removeAnimation()}getInstance(){return this._modelInstance}};ss([R(is.addToViewer),as("design:type",Function),as("design:paramtypes",[Object]),as("design:returntype",void 0)],As.prototype,"addToViewer",null),ss([R(is.remove),as("design:type",Function),as("design:paramtypes",[Object]),as("design:returntype",void 0)],As.prototype,"remove",null),ss([R(is.on),as("design:type",Function),as("design:paramtypes",[Object]),as("design:returntype",void 0)],As.prototype,"on",null),ss([R(is.off),as("design:type",Function),as("design:paramtypes",[Object]),as("design:returntype",void 0)],As.prototype,"off",null),ss([N([{type:k.Number,required:!0}]),as("design:type",Function),as("design:paramtypes",[Number]),as("design:returntype",void 0)],As.prototype,"translateX",null),ss([N([{type:k.Number,required:!0}]),as("design:type",Function),as("design:paramtypes",[Number]),as("design:returntype",void 0)],As.prototype,"translateY",null),ss([N([{type:k.Number,required:!0}]),as("design:type",Function),as("design:paramtypes",[Number]),as("design:returntype",void 0)],As.prototype,"translateZ",null),ss([N([{type:k.Number,required:!0}]),as("design:type",Function),as("design:paramtypes",[Number]),as("design:returntype",void 0)],As.prototype,"rotateX",null),ss([N([{type:k.Number,required:!0}]),as("design:type",Function),as("design:paramtypes",[Number]),as("design:returntype",void 0)],As.prototype,"rotateY",null),ss([N([{type:k.Number,required:!0}]),as("design:type",Function),as("design:paramtypes",[Number]),as("design:returntype",void 0)],As.prototype,"rotateZ",null),ss([N([{type:k.Array,required:!0}]),as("design:type",Function),as("design:paramtypes",[Array]),as("design:returntype",void 0)],As.prototype,"scale",null),ss([N([{type:k.Object,required:!0}]),as("design:type",Function),as("design:paramtypes",[Object]),as("design:returntype",void 0)],As.prototype,"setPosition",null),ss([N([{type:k.Array,required:!0}]),as("design:type",Function),as("design:paramtypes",[Array]),as("design:returntype",void 0)],As.prototype,"setAnimation",null),As=ss([H({viewer:{type:k.Object,required:!0},id:{type:[k.Number,k.String],required:!0},position:{type:k.Object,required:!0},translation:{type:k.Array},rotation:{type:k.Array},scale:{type:k.Array},props:{type:k.Object}}),as("design:paramtypes",[Object])],As);var ls=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},cs=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let us=class{constructor(t){this.instance=new Nr(t)}getProps(){if(this.instance)return this.instance.getProps()}addToViewer(t){this.instance.addToViewer(t)}field(t,e,i){return this.instance.field(t,e,i),this}setData(t){this.instance.setData(t)}setSource(t){this.instance.setSource(t)}getSource(){return this.instance.getSource()}setProperty(t){this.instance.setProperty(t)}setPosition(t){this.instance.setPosition(t)}getPosition(t){return this.instance.getPosition(t)}remove(t={}){this.instance.remove(t)}show(t){if(t){const{duration:e,delay:i,callback:n}=t;this.instance.showAnimation(e,i,n)}else this.instance.showAnimation(0,0)}hide(t){if(t){const{duration:e,delay:i,callback:n}=t;this.instance.hideAnimation(e,i,n)}else this.instance.hideAnimation(0,0)}on(t){t.event=gr[t.event],this.instance.on(t)}off(t){t.event=gr[t.event],this.instance.off(t)}getInstance(){return this.instance}};ls([R(is.addToViewer),cs("design:type",Function),cs("design:paramtypes",[Object]),cs("design:returntype",void 0)],us.prototype,"addToViewer",null),ls([R(is.remove),cs("design:type",Function),cs("design:paramtypes",[Object]),cs("design:returntype",void 0)],us.prototype,"remove",null),ls([R(is.on),cs("design:type",Function),cs("design:paramtypes",[Object]),cs("design:returntype",void 0)],us.prototype,"on",null),ls([R(is.off),cs("design:type",Function),cs("design:paramtypes",[Object]),cs("design:returntype",void 0)],us.prototype,"off",null),us=ls([H({viewer:{type:k.Object,required:!0},image:{type:[k.String,k.DOM,k.Function]},position:{type:k.Object},width:{type:k.Number},height:{type:k.Number},eyeOffset:{type:k.Array},pixelOffset:{type:k.Array},scaleByDistance:{type:k.Array}}),cs("design:paramtypes",[Object])],us);var hs=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},ps=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let ds=class{constructor(t){this.instance=new Lr(t)}addToViewer(t){this.instance.addToViewer(t)}field(t,e,i){return this.instance.field(t,e,i),this}setData(t){this.instance.setData(t)}setSource(t){this.instance.setSource(t)}setProperty(t){this.instance.setProperty(t)}remove(t={}){this.instance.remove(t)}show(t){if(t){const{duration:e,delay:i,callback:n}=t;this.instance.showAnimation(e,i,n)}else this.instance.showAnimation(0,0)}hide(t){if(t){const{duration:e,delay:i,callback:n}=t;this.instance.hideAnimation(e,i,n)}else this.instance.hideAnimation(0,0)}on(t){t.event=gr[t.event],this.instance.on(t)}off(t){t.event=gr[t.event],this.instance.off(t)}};hs([R(is.addToViewer),ps("design:type",Function),ps("design:paramtypes",[Object]),ps("design:returntype",void 0)],ds.prototype,"addToViewer",null),hs([R(is.remove),ps("design:type",Function),ps("design:paramtypes",[Object]),ps("design:returntype",void 0)],ds.prototype,"remove",null),hs([R(is.on),ps("design:type",Function),ps("design:paramtypes",[Object]),ps("design:returntype",void 0)],ds.prototype,"on",null),hs([R(is.off),ps("design:type",Function),ps("design:paramtypes",[Object]),ps("design:returntype",void 0)],ds.prototype,"off",null),ds=hs([H({viewer:{type:k.Object,required:!0},text:{type:k.String},font:{type:k.String},fillColor:{type:k.String},showBackground:{type:k.Boolean},backgroundColor:{type:k.String},eyeOffset:{type:k.Array},pixelOffset:{type:k.Array},horizontalOrigin:{type:k.Number},verticalOrigin:{type:k.Number},scaleByDistance:{type:k.Array}}),ps("design:paramtypes",[Object])],ds);var fs=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},gs=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let ms=class{constructor(t){this.instance=new Wr(t)}addToViewer(t){this.instance.addToViewer(t,this)}remove(t={}){this.instance.remove(t)}show(){this.instance.show()}hide(){this.instance.hide()}setData(t){this.instance.setData(t)}setStyle(t,e,i){this.instance.setStyle(t,e,i)}on(t){t.event=gr[t.event],this.instance.on(t)}off(t){t.event=gr[t.event],this.instance.off(t)}};fs([R(is.addToViewer),gs("design:type",Function),gs("design:paramtypes",[Object]),gs("design:returntype",void 0)],ms.prototype,"addToViewer",null),fs([R(is.remove),gs("design:type",Function),gs("design:paramtypes",[Object]),gs("design:returntype",void 0)],ms.prototype,"remove",null),fs([R(is.on),gs("design:type",Function),gs("design:paramtypes",[Object]),gs("design:returntype",void 0)],ms.prototype,"on",null),fs([R(is.off),gs("design:type",Function),gs("design:paramtypes",[Object]),gs("design:returntype",void 0)],ms.prototype,"off",null),ms=fs([H({viewer:{type:k.Object,required:!0},data:{type:k.Object,required:!0},defaultStyles:{type:k.Object}}),gs("design:paramtypes",[Object])],ms);var ys=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},vs=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let _s=class{constructor(t){this.instance=new zr(t)}addToViewer(t){this.instance.addToViewer(t,this)}remove(t={}){this.instance.remove(t)}show(){this.instance.show()}hide(){this.instance.hide()}setIconMode(t){this.instance.setIconMode(t)}query(t){this.instance.query(t)}on(t){t.event=gr[t.event],this.instance.on(t)}off(t){t.event=gr[t.event],this.instance.off(t)}};ys([R(is.addToViewer),vs("design:type",Function),vs("design:paramtypes",[Object]),vs("design:returntype",void 0)],_s.prototype,"addToViewer",null),ys([R(is.remove),vs("design:type",Function),vs("design:paramtypes",[Object]),vs("design:returntype",void 0)],_s.prototype,"remove",null),ys([R(is.on),vs("design:type",Function),vs("design:paramtypes",[Object]),vs("design:returntype",void 0)],_s.prototype,"on",null),ys([R(is.off),vs("design:type",Function),vs("design:paramtypes",[Object]),vs("design:returntype",void 0)],_s.prototype,"off",null),_s=ys([H({viewer:{type:k.Object,required:!0},serviceName:{type:k.String,required:!0},adcode:{type:k.String},polygon:{type:k.Array},mixTerms:{type:k.Array},icons:{type:k.Array,required:!0,validator:t=>{let e=!0;return t.forEach(t=>{t.iconName&&"string"!=typeof t.iconName&&(e=!1),t.mId&&"string"!=typeof t.mId&&"number"!=typeof t.mId&&(e=!1),t.scale&&"number"!=typeof t.scale&&(e=!1)}),e},message:"please check the format of icons!"},clustered:{type:k.Boolean},clusteredRadius:{type:k.Number},pageNo:{type:k.Number},maxCount:{type:k.Number},clusterstyle:{type:k.Array},timer:{type:k.Number,validator:t=>t>=15e3,message:"timer must be greater than or equal to 15000"},iconMode:{type:k.String,validator:t=>["image","model"].indexOf(t)>-1,message:"iconMode must be image or model"}}),vs("design:paramtypes",[Object])],_s);var ws={poiLayerInit:{viewer:{type:k.Object,required:!0},searchType:{type:k.Array},polygon:{type:k.Array},icons:{type:k.Array},clustered:{type:k.Boolean},clusteredRadius:{type:k.Number},pageNo:{type:k.Number},maxCount:{type:k.Number},clusterstyle:{type:k.Array}},videoLayerInit:{viewer:{type:k.Object,required:!0},positions:{type:k.Array,required:!0},video:{type:k.DOM,required:!0},shadow:{type:k.Boolean}},cityModelLayerInit:{viewer:{type:k.Object,required:!0},url:{type:k.String,required:!0},light:{type:k.Number},modelMatrix:{type:k.Array},useGradient:{type:k.Boolean},mixNum:{type:k.Array,validator:function(t){return"number"==typeof t[0]&&"number"==typeof t[1]}}},clipTilesetLayerInit:{viewer:{type:k.Object,required:!0},url:{type:k.String,required:!0}}},Cs=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},Bs=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let bs=class{constructor(t){this.instance=new Gr(t)}addToViewer(t){this.instance.addToViewer(t,this)}remove(t={}){this.instance.remove(t)}show(){this.instance.show()}hide(){this.instance.hide()}on(t){t.event=gr[t.event],this.instance.on(t)}off(t){t.event=gr[t.event],this.instance.off(t)}};Cs([R(is.addToViewer),Bs("design:type",Function),Bs("design:paramtypes",[Object]),Bs("design:returntype",void 0)],bs.prototype,"addToViewer",null),Cs([R(is.remove),Bs("design:type",Function),Bs("design:paramtypes",[Object]),Bs("design:returntype",void 0)],bs.prototype,"remove",null),Cs([R(is.on),Bs("design:type",Function),Bs("design:paramtypes",[Object]),Bs("design:returntype",void 0)],bs.prototype,"on",null),Cs([R(is.off),Bs("design:type",Function),Bs("design:paramtypes",[Object]),Bs("design:returntype",void 0)],bs.prototype,"off",null),bs=Cs([H(ws.poiLayerInit),Bs("design:paramtypes",[Object])],bs);var Es=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},Ss=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let xs=class{constructor(t){t.instance&&t.instance instanceof Jr?this.instance=t.instance:this.instance=new Jr(t)}get useGradient(){return this.instance._useGradient}set useGradient(t){this.instance.setGradient(t)}addToViewer(t){this.instance.addToViewer(t)}remove(t={}){this.instance.remove(t)}show(){this.instance.show()}hide(){this.instance.hide()}on(t){t.event=gr[t.event],this.instance.on(t)}off(t){t.event=gr[t.event],this.instance.off(t)}setStyle(t){this.instance.setStyle(t)}translateX(t){this.instance.translateX(t)}translateY(t){this.instance.translateY(t)}translateZ(t){this.instance.translateZ(t)}rotateX(t){this.instance.rotateX(t)}rotateY(t){this.instance.rotateY(t)}rotateZ(t){this.instance.rotateZ(t)}scale(t){this.instance.scale(t)}getInstance(){return this.instance}};Es([R(is.addToViewer),Ss("design:type",Function),Ss("design:paramtypes",[Object]),Ss("design:returntype",void 0)],xs.prototype,"addToViewer",null),Es([R(is.remove),Ss("design:type",Function),Ss("design:paramtypes",[Object]),Ss("design:returntype",void 0)],xs.prototype,"remove",null),Es([R(is.on),Ss("design:type",Function),Ss("design:paramtypes",[Object]),Ss("design:returntype",void 0)],xs.prototype,"on",null),Es([R(is.off),Ss("design:type",Function),Ss("design:paramtypes",[Object]),Ss("design:returntype",void 0)],xs.prototype,"off",null),Es([N([{type:k.Number,required:!0}]),Ss("design:type",Function),Ss("design:paramtypes",[Number]),Ss("design:returntype",void 0)],xs.prototype,"translateX",null),Es([N([{type:k.Number,required:!0}]),Ss("design:type",Function),Ss("design:paramtypes",[Number]),Ss("design:returntype",void 0)],xs.prototype,"translateY",null),Es([N([{type:k.Number,required:!0}]),Ss("design:type",Function),Ss("design:paramtypes",[Number]),Ss("design:returntype",void 0)],xs.prototype,"translateZ",null),Es([N([{type:k.Number,required:!0}]),Ss("design:type",Function),Ss("design:paramtypes",[Number]),Ss("design:returntype",void 0)],xs.prototype,"rotateX",null),Es([N([{type:k.Number,required:!0}]),Ss("design:type",Function),Ss("design:paramtypes",[Number]),Ss("design:returntype",void 0)],xs.prototype,"rotateY",null),Es([N([{type:k.Number,required:!0}]),Ss("design:type",Function),Ss("design:paramtypes",[Number]),Ss("design:returntype",void 0)],xs.prototype,"rotateZ",null),Es([N([{type:k.Array,required:!0}]),Ss("design:type",Function),Ss("design:paramtypes",[Array]),Ss("design:returntype",void 0)],xs.prototype,"scale",null),xs=Es([H(ws.cityModelLayerInit),Ss("design:paramtypes",[Object])],xs);var Is=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},Fs=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let Os=class{constructor(t){this.instance=new $r(t)}addToViewer(t){this.instance.addToViewer(t)}remove(t={}){this.instance.remove(t)}show(){this.instance.show()}hide(){this.instance.hide()}};Is([R(is.addToViewer),Fs("design:type",Function),Fs("design:paramtypes",[Object]),Fs("design:returntype",void 0)],Os.prototype,"addToViewer",null),Is([R(is.remove),Fs("design:type",Function),Fs("design:paramtypes",[Object]),Fs("design:returntype",void 0)],Os.prototype,"remove",null),Os=Is([H({viewer:{type:k.Object,required:!0},url:{type:k.String,required:!0},isFetch:{type:k.Boolean}}),Fs("design:paramtypes",[Object])],Os);var Ps=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},Ts=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let Ls=class{constructor(t){this.instance=new to(t)}field(t,e,i){return this.instance.field(t,e,i),this}setData(t){this.instance.setData(t)}addToViewer(t){this.instance.addToViewer(t)}remove(t={}){this.instance.remove(t)}show(){this.instance.show()}hide(){this.instance.hide()}on(t){t.event=gr[t.event],this.instance.on(t)}off(t){t.event=gr[t.event],this.instance.off(t)}};Ps([R(is.addToViewer),Ts("design:type",Function),Ts("design:paramtypes",[Object]),Ts("design:returntype",void 0)],Ls.prototype,"addToViewer",null),Ps([R(is.remove),Ts("design:type",Function),Ts("design:paramtypes",[Object]),Ts("design:returntype",void 0)],Ls.prototype,"remove",null),Ps([R(is.on),Ts("design:type",Function),Ts("design:paramtypes",[Object]),Ts("design:returntype",void 0)],Ls.prototype,"on",null),Ps([R(is.off),Ts("design:type",Function),Ts("design:paramtypes",[Object]),Ts("design:returntype",void 0)],Ls.prototype,"off",null),Ls=Ps([H({viewer:{type:k.Object,required:!0}}),Ts("design:paramtypes",[Object])],Ls);var Ms=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},Us=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let Ds=class{constructor(t){this.instance=new eo(t)}addToViewer(t){this.instance.addToViewer(t)}remove(t={}){this.instance.remove(t)}show(){this.instance.show()}hide(){this.instance.hide()}on(t){t.event=gr[t.event],this.instance.on(t)}off(t){t.event=gr[t.event],this.instance.off(t)}};Ms([R(is.addToViewer),Us("design:type",Function),Us("design:paramtypes",[Object]),Us("design:returntype",void 0)],Ds.prototype,"addToViewer",null),Ms([R(is.remove),Us("design:type",Function),Us("design:paramtypes",[Object]),Us("design:returntype",void 0)],Ds.prototype,"remove",null),Ms([R(is.on),Us("design:type",Function),Us("design:paramtypes",[Object]),Us("design:returntype",void 0)],Ds.prototype,"on",null),Ms([R(is.off),Us("design:type",Function),Us("design:paramtypes",[Object]),Us("design:returntype",void 0)],Ds.prototype,"off",null),Ds=Ms([H({viewer:{type:k.Object,required:!0},data:{type:k.Object,required:!0}}),Us("design:paramtypes",[Object])],Ds);var Qs=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},Rs=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let Ns=class{constructor(t){this.instance=new ro(t)}addToViewer(t){this.instance.addToViewer(t)}remove(t={}){this.instance.remove(t)}show(){this.instance.show()}hide(){this.instance.hide()}on(t){t.event=gr[t.event],this.instance.on(t)}off(t){t.event=gr[t.event],this.instance.off(t)}};Qs([R(is.addToViewer),Rs("design:type",Function),Rs("design:paramtypes",[Object]),Rs("design:returntype",void 0)],Ns.prototype,"addToViewer",null),Qs([R(is.remove),Rs("design:type",Function),Rs("design:paramtypes",[Object]),Rs("design:returntype",void 0)],Ns.prototype,"remove",null),Qs([R(is.on),Rs("design:type",Function),Rs("design:paramtypes",[Object]),Rs("design:returntype",void 0)],Ns.prototype,"on",null),Qs([R(is.off),Rs("design:type",Function),Rs("design:paramtypes",[Object]),Rs("design:returntype",void 0)],Ns.prototype,"off",null),Ns=Qs([H({viewer:{type:k.Object,required:!0},data:{type:k.Object,required:!0}}),Rs("design:paramtypes",[Object])],Ns);var Hs=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},ks=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let Vs=class{constructor(t){this.instance=new oo(t)}addToViewer(t){this.instance.addToViewer(t)}remove(t={}){this.instance.remove(t)}show(){this.instance.show()}hide(){this.instance.hide()}on(t){t.event=gr[t.event],this.instance.on(t)}off(t){t.event=gr[t.event],this.instance.off(t)}};Hs([R(is.addToViewer),ks("design:type",Function),ks("design:paramtypes",[Object]),ks("design:returntype",void 0)],Vs.prototype,"addToViewer",null),Hs([R(is.remove),ks("design:type",Function),ks("design:paramtypes",[Object]),ks("design:returntype",void 0)],Vs.prototype,"remove",null),Hs([R(is.on),ks("design:type",Function),ks("design:paramtypes",[Object]),ks("design:returntype",void 0)],Vs.prototype,"on",null),Hs([R(is.off),ks("design:type",Function),ks("design:paramtypes",[Object]),ks("design:returntype",void 0)],Vs.prototype,"off",null),Vs=Hs([H({viewer:{type:k.Object,required:!0},data:{type:k.Object,required:!0}}),ks("design:paramtypes",[Object])],Vs);var js=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},Gs=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let Ks=class{constructor(t){this.instance=new no(t)}addToViewer(t){this.instance.addToViewer(t)}remove(t={}){this.instance.remove(t)}show(){this.instance.show()}hide(){this.instance.hide()}on(t){t.event=gr[t.event],this.instance.on(t)}off(t){t.event=gr[t.event],this.instance.off(t)}};js([R(is.addToViewer),Gs("design:type",Function),Gs("design:paramtypes",[Object]),Gs("design:returntype",void 0)],Ks.prototype,"addToViewer",null),js([R(is.remove),Gs("design:type",Function),Gs("design:paramtypes",[Object]),Gs("design:returntype",void 0)],Ks.prototype,"remove",null),js([R(is.on),Gs("design:type",Function),Gs("design:paramtypes",[Object]),Gs("design:returntype",void 0)],Ks.prototype,"on",null),js([R(is.off),Gs("design:type",Function),Gs("design:paramtypes",[Object]),Gs("design:returntype",void 0)],Ks.prototype,"off",null),Ks=js([H(ws.videoLayerInit),Gs("design:paramtypes",[Object])],Ks);var zs=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},Ws=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let qs=class{constructor(t){this.instance=new so(t)}addToViewer(t){this.instance.addToViewer(t)}remove(t={}){this.instance.remove(t)}show(){this.instance.show()}hide(){this.instance.hide()}on(t){t.event=gr[t.event],this.instance.on(t)}off(t){t.event=gr[t.event],this.instance.off(t)}setData(t){this.instance.setData(t)}setStyle(t,e){this.instance.setStyle(t,e)}};zs([R(is.addToViewer),Ws("design:type",Function),Ws("design:paramtypes",[Object]),Ws("design:returntype",void 0)],qs.prototype,"addToViewer",null),zs([R(is.remove),Ws("design:type",Function),Ws("design:paramtypes",[Object]),Ws("design:returntype",void 0)],qs.prototype,"remove",null),zs([R(is.on),Ws("design:type",Function),Ws("design:paramtypes",[Object]),Ws("design:returntype",void 0)],qs.prototype,"on",null),zs([R(is.off),Ws("design:type",Function),Ws("design:paramtypes",[Object]),Ws("design:returntype",void 0)],qs.prototype,"off",null),qs=zs([H({viewer:{type:k.Object,required:!0},data:{type:k.Object,required:!0}}),Ws("design:paramtypes",[Object])],qs);var Xs=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},Ys=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let Js=class{constructor(t){this.instance=new Ao(t)}addToViewer(t){this.instance.addToViewer(t)}remove(t={}){this.instance.remove(t)}show(){this.instance.show()}hide(){this.instance.hide()}on(t){t.event=gr[t.event],this.instance.on(t)}off(t){t.event=gr[t.event],this.instance.off(t)}translateX(t){this.instance.translateX(t)}translateY(t){this.instance.translateY(t)}translateZ(t){this.instance.translateZ(t)}getInstance(){return this.instance}};Xs([R(is.addToViewer),Ys("design:type",Function),Ys("design:paramtypes",[Object]),Ys("design:returntype",void 0)],Js.prototype,"addToViewer",null),Xs([R(is.remove),Ys("design:type",Function),Ys("design:paramtypes",[Object]),Ys("design:returntype",void 0)],Js.prototype,"remove",null),Xs([R(is.on),Ys("design:type",Function),Ys("design:paramtypes",[Object]),Ys("design:returntype",void 0)],Js.prototype,"on",null),Xs([R(is.off),Ys("design:type",Function),Ys("design:paramtypes",[Object]),Ys("design:returntype",void 0)],Js.prototype,"off",null),Xs([N([{type:k.Number,required:!0}]),Ys("design:type",Function),Ys("design:paramtypes",[Number]),Ys("design:returntype",void 0)],Js.prototype,"translateX",null),Xs([N([{type:k.Number,required:!0}]),Ys("design:type",Function),Ys("design:paramtypes",[Number]),Ys("design:returntype",void 0)],Js.prototype,"translateY",null),Xs([N([{type:k.Number,required:!0}]),Ys("design:type",Function),Ys("design:paramtypes",[Number]),Ys("design:returntype",void 0)],Js.prototype,"translateZ",null),Js=Xs([H(ws.clipTilesetLayerInit),Ys("design:paramtypes",[Object])],Js);var Zs=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},$s=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let ta=class{constructor(t,e){const{onLoadMap:i,sceneId:n=0,flyDuration:r=3}=e;this.id=t,this.viewer=new ts(t,Object.assign(Object.assign({},e),{onLoadMap:t=>{if(20===t.status)return void(i&&i(t));const e=this.viewer.mapConfig,o=this.viewer.viewerOption,s=e.tilesetLayers,a=s&&s.default.trim();if(Bt.add(this),n)this.changeScene({ended:i,id:n,flyDuration:r});else if(a)this.changeScene({ended:i,id:a,flyDuration:r});else{let t=e.imageryLayers&&e.imageryLayers.fileContent&&e.imageryLayers.fileContent["3d"],n=e.baseMapZoomRange;if(t&&t.content)t.content.forEach(t=>{t.maximumLevel||t.minimumLevel||!n||(t.minimumLevel=n[0],t.maximumLevel=n[1]),o.addImageryLayers(t)});else if(t&&!t.content)return void At("c010105",i);at(!0,i)}}}))}setOptions(t){return this.viewer.setOptions(t),this}setPitchRange(t){const{min:e,max:i}=t;return this.viewer.setPitchRange(e,i),this}limitCameraToGround(){return this.viewer.limitCameraToGround(),this}limitCameraMaxHeight(t){return this.viewer.limitCameraMaxHeight(t),this}changeBaseLayer(t){return this.viewer.changeBaseLayer(t),this}changeSceneMode(t,e=0){return this.viewer.changeSceneMode(t,e),this}changeScene(t){const{ended:e,id:i,flyDuration:n}=t,r=this.viewer.mapConfig.tilesetLayers;try{if(!r.list[i])return void At("c010110",e)}catch(t){return}const o=this.viewer.viewerOption;return o.loadNewScene({flyDuration:n,id:i,ended:()=>{const{modelList:t,tileList:i}=this.handleSceneInfo(o.sceneInfo);at({models:t,tiles:i},e)}},this),this}setBaseLayerProps(t){return this.viewer.setBaseLayerProps(t),this}addRoaming(t){return this.viewer.addRoaming(t),this}removeRoaming(t={}){return this.viewer.removeRoaming(t),this}flyToPosition(t){return this.viewer.flyToPosition(t),this}zoomToPosition(t){return this.viewer.zoomToPosition(t),this}flyToBounds(t){return this.viewer.flyToBounds(t),this}zoomToBounds(t){return this.viewer.zoomToBounds(t),this}getCurrentCameraInfo(){let t=this.viewer.instance.camera,e=t.positionCartographic;return at(new I(f.Math.toDegrees(e.longitude),f.Math.toDegrees(e.latitude),e.height,f.Math.toDegrees(t.heading),f.Math.toDegrees(t.pitch),f.Math.toDegrees(t.roll)))}getBounds(t){this.viewer.getBounds(t)}getElevation(t){this.viewer.getElevation(t)}addDirectionalLight(t){return this.viewer.addDirectionalLight(t),this}removeDirectionalLight(t){return this.viewer.removeDirectionalLight(t),this}addLayer(t){const{layer:e,ended:i}=t;!e||Object.keys(e).length?this.viewer.addLayer(e,this,i):At("c010113",i)}removeLayer(t){const{layer:e,ended:i}=t;this.viewer.removeLayer(e,i)}addLookAround(t){return this.viewer.addLookAround(t),this}removeLookAround(t){return this.viewer.removeLookAround(t),this}resizeScale(t,e){return this.viewer.resizeScale(t,e),this}changeBaseLayerImage(t){return this.viewer.changeBaseLayerImage(t),this}addLightSource(t){return this.viewer.addLightSource(t)}removeLightSource(t){return this.viewer.removeLightSource(t)}setShadowMap(t){return this.viewer.setShadowMap(t)}screenshot(t){this.viewer.screenshot(t)}getLayers(){return this.viewer.getLayers()}flyTo(t,e){e=Object(f.defaultValue)(e,{});const i={duration:Object(f.defaultValue)(e.duration,3)};let n=t.instance||t._instance;n._boundingRectangle?this.flyToBounds({lngLatBounds:n._boundingRectangle,orientation:{heading:0,pitch:-90,roll:0}}):n._instance&&this.viewer.instance.flyTo(n._instance,i)}setAmbientLight(t){this.viewer.setAmbientLight(t)}removeAllMeasure(){return this.viewer.removeAllMeasure()}enableFirstPersonController(t){return this.viewer.setFirstPersonController(t),this}disableFirstPersonController(){return this.viewer.cancelFirstPersonController(),this}on(t){const{event:e,handler:i}=t;return this.viewer.on(gr[e],i),this}off(t){const{event:e,handler:i}=t;return this.viewer.off(gr[e],i),this}destroy(){return this.viewer.destroy(),this}handleSceneInfo(t){const{id:e,models:i,urls:n}=t;return{modelList:i.map(t=>new As({viewer:this,id:0,position:new I,instance:t})),tileList:n.map(t=>new xs({viewer:this,url:"",instance:t}))}}changeTerrain(t){return this.viewer.changeTerrain(t),this}getZoom(){return this.viewer.getZoom()}hasLayerType(t){return this.viewer.hasLayerType(t)}getLayerByType(t){return this.viewer.getLayerByType(t)}zoomTo(t,e){let i=t.instance||t._instance;i._boundingRectangle?this.flyToBounds({lngLatBounds:i._boundingRectangle,orientation:{heading:0,pitch:-90,roll:0},duration:0}):i._instance&&this.viewer.instance.zoomTo(i._instance)}rotate(t){let e=new f.Cartesian3(t.axis.x,t.axis.y,t.axis.z);return this.viewer.rotate(e,t.angle),this}getHeadingPitchRoll(){return at(this.viewer.getHeadingPitchRoll())}getUpRightDirection(){return at(this.viewer.getUpRightDirection())}setDayNight(t){this.viewer.setDayNight(t,this)}switchDayStyle(){this.viewer.switchDayStyle()}switchNightStyle(){this.viewer.switchNightStyle()}closeDayNight(){return this.viewer.closeDayNight(),this}setScreenAdjust(t){return this.viewer.setScreenAdjust(t)}setDebugFrame(t){void 0!==t&&!1===t?(this.viewer.instance.scene.debugShowFramesPerSecond=!1,setTimeout(()=>{document.querySelectorAll(".cesium-performanceDisplay-defaultContainer")[0].style.display="none"},1e3)):(this.viewer.instance.scene.debugShowFramesPerSecond=!0,setTimeout(()=>{document.querySelectorAll(".cesium-performanceDisplay-defaultContainer")[0].style.display="block"},1e3))}getSourceLoaded(t){let e=!1,i=!1,n=[];const r=this.viewer.getLayers().filter(t=>"tileset"===t._layerType);n=r.map(()=>!1),r.forEach((t,e)=>{t._instance.allTilesLoaded.addEventListener(()=>{n[e]=!0})});const o=(new f.EventHelper).add(this.viewer.instance.scene.postRender,r=>{this.viewer.instance.scene.globe.tilesLoaded&&(e=!0),i=n.every(t=>t),e&&i&&(o(),t())})}};function ea(){return f}Zs([R(es.setOptions),$s("design:type",Function),$s("design:paramtypes",[Object]),$s("design:returntype",void 0)],ta.prototype,"setOptions",null),Zs([R(es.setPichRange),$s("design:type",Function),$s("design:paramtypes",[Object]),$s("design:returntype",void 0)],ta.prototype,"setPitchRange",null),Zs([R(es.changeBaseLayer),$s("design:type",Function),$s("design:paramtypes",[Object]),$s("design:returntype",void 0)],ta.prototype,"changeBaseLayer",null),Zs([R(es.changeScene),$s("design:type",Function),$s("design:paramtypes",[Object]),$s("design:returntype",void 0)],ta.prototype,"changeScene",null),Zs([R(es.setBaseLayerProps),$s("design:type",Function),$s("design:paramtypes",[Object]),$s("design:returntype",void 0)],ta.prototype,"setBaseLayerProps",null),Zs([R(es.addRoaming),$s("design:type",Function),$s("design:paramtypes",[Object]),$s("design:returntype",void 0)],ta.prototype,"addRoaming",null),Zs([R(es.removeRoaming),$s("design:type",Function),$s("design:paramtypes",[Object]),$s("design:returntype",void 0)],ta.prototype,"removeRoaming",null),Zs([R(es.flyToPosition),$s("design:type",Function),$s("design:paramtypes",[Object]),$s("design:returntype",void 0)],ta.prototype,"flyToPosition",null),Zs([R(es.zoomToPosition),$s("design:type",Function),$s("design:paramtypes",[Object]),$s("design:returntype",void 0)],ta.prototype,"zoomToPosition",null),Zs([R(es.flyToBounds),$s("design:type",Function),$s("design:paramtypes",[Object]),$s("design:returntype",void 0)],ta.prototype,"flyToBounds",null),Zs([R(es.zoomToBounds),$s("design:type",Function),$s("design:paramtypes",[Object]),$s("design:returntype",void 0)],ta.prototype,"zoomToBounds",null),Zs([R(es.getBounds),$s("design:type",Function),$s("design:paramtypes",[Object]),$s("design:returntype",void 0)],ta.prototype,"getBounds",null),Zs([R(es.getElevation),$s("design:type",Function),$s("design:paramtypes",[Object]),$s("design:returntype",void 0)],ta.prototype,"getElevation",null),Zs([R(es.addDirectionalLight),$s("design:type",Function),$s("design:paramtypes",[Object]),$s("design:returntype",void 0)],ta.prototype,"addDirectionalLight",null),Zs([R(es.addLayer),$s("design:type",Function),$s("design:paramtypes",[Object]),$s("design:returntype",void 0)],ta.prototype,"addLayer",null),Zs([R(es.addLookAround),$s("design:type",Function),$s("design:paramtypes",[Object]),$s("design:returntype",void 0)],ta.prototype,"addLookAround",null),Zs([R(es.addLightSourceOptions),$s("design:type",Function),$s("design:paramtypes",[Object]),$s("design:returntype",void 0)],ta.prototype,"addLightSource",null),Zs([R(es.removeLightSourceOptions),$s("design:type",Function),$s("design:paramtypes",[Object]),$s("design:returntype",void 0)],ta.prototype,"removeLightSource",null),Zs([R(es.setShadowMapOptions),$s("design:type",Function),$s("design:paramtypes",[Object]),$s("design:returntype",void 0)],ta.prototype,"setShadowMap",null),Zs([R(es.screenshot),$s("design:type",Function),$s("design:paramtypes",[Object]),$s("design:returntype",void 0)],ta.prototype,"screenshot",null),Zs([R(es.setAmbientLightOptions),$s("design:type",Function),$s("design:paramtypes",[Object]),$s("design:returntype",void 0)],ta.prototype,"setAmbientLight",null),Zs([R(es.setFirstPersonOptions),$s("design:type",Function),$s("design:paramtypes",[Object]),$s("design:returntype",void 0)],ta.prototype,"enableFirstPersonController",null),Zs([R(is.on),$s("design:type",Function),$s("design:paramtypes",[Object]),$s("design:returntype",void 0)],ta.prototype,"on",null),Zs([R(is.off),$s("design:type",Function),$s("design:paramtypes",[Object]),$s("design:returntype",void 0)],ta.prototype,"off",null),Zs([R(es.changeTerrain),$s("design:type",Function),$s("design:paramtypes",[Object]),$s("design:returntype",void 0)],ta.prototype,"changeTerrain",null),Zs([R(es.rotateOptions),$s("design:type",Function),$s("design:paramtypes",[Object]),$s("design:returntype",void 0)],ta.prototype,"rotate",null),Zs([R(es.setDayNight),$s("design:type",Function),$s("design:paramtypes",[Object]),$s("design:returntype",void 0)],ta.prototype,"setDayNight",null),Zs([R(es.setScreenAdjustOptions),$s("design:type",Function),$s("design:paramtypes",[Object]),$s("design:returntype",void 0)],ta.prototype,"setScreenAdjust",null),ta=Zs([H(),$s("design:paramtypes",[String,Object])],ta);var ia={getGeometryByAdminCode:{code:{type:k.String,required:!0},containsSon:{type:k.Boolean},isNativeData:{type:k.Boolean},callback:{type:k.Function,required:!0}},getAdminInfoByPoint:{point:{type:k.Array,required:!0},level:{type:k.String},callback:{type:k.Function,required:!0}},getGeoPoint:{keyword:{type:k.String,required:!0},adcode:{type:k.String},callback:{type:k.Function,required:!0}},getLocation:{point:{type:k.Array,required:!0},type:{type:k.Array},kindCode:{type:k.String},callback:{type:k.Function,required:!0}},getIsochrone:{point:{type:k.Array,required:!0},time:{type:k.Number,required:!0,validator:t=>t>0,message:"time must be greater than 0"},callback:{type:k.Function,required:!0}},getSceneModel:{sceneId:{type:k.String,required:!0},pageNo:{type:k.Number},maxCount:{type:k.Number},callback:{type:k.Function,required:!0}},getClusterDetail:{serviceName:{type:k.String,required:!0},queryOptions:{type:k.Object,required:!0},pageNo:{type:k.Number},maxCount:{type:k.Number},callback:{type:k.Function,required:!0}}},na=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},ra=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let oa=class{constructor(t){this.instance=new Or(t)}queryPoiInfo(t){this.instance.queryPoiInfo(t)}queryPoiType(t){this.instance.queryPoiType(t)}queryWaterfaceInfo(t){this.instance.queryWaterfaceInfo(t)}queryRoadSectionInfo(t){this.instance.queryRoadSectionInfo(t)}queryRoadCrossInfo(t){this.instance.queryRoadCrossInfo(t)}queryRoadInfo(t){this.instance.queryRoadInfo(t)}queryCustomInfo(t){this.instance.queryCustomInfo(t)}getGeometryByAdminCode(t){t=Object.assign({},{isNativeData:!1},t),this.instance.getGeometryByAdminCode(t)}getAdminInfoByPoint(t){this.instance.getAdminInfoByPoint(t)}getGeoPoint(t){this.instance.getGeoPoint(t)}getLocation(t){this.instance.getLocation(t)}getIsochrone(t){this.instance.getIsochrone(t)}getSceneModel(t){this.instance.getSceneModel(t)}getClusterDetail(t){this.instance.getClusterDetail(t)}};na([R(ia.getGeometryByAdminCode),ra("design:type",Function),ra("design:paramtypes",[Object]),ra("design:returntype",void 0)],oa.prototype,"getGeometryByAdminCode",null),na([R(ia.getAdminInfoByPoint),ra("design:type",Function),ra("design:paramtypes",[Object]),ra("design:returntype",void 0)],oa.prototype,"getAdminInfoByPoint",null),na([R(ia.getGeoPoint),ra("design:type",Function),ra("design:paramtypes",[Object]),ra("design:returntype",void 0)],oa.prototype,"getGeoPoint",null),na([R(ia.getLocation),ra("design:type",Function),ra("design:paramtypes",[Object]),ra("design:returntype",void 0)],oa.prototype,"getLocation",null),na([R(ia.getIsochrone),ra("design:type",Function),ra("design:paramtypes",[Object]),ra("design:returntype",void 0)],oa.prototype,"getIsochrone",null),na([R(ia.getSceneModel),ra("design:type",Function),ra("design:paramtypes",[Object]),ra("design:returntype",void 0)],oa.prototype,"getSceneModel",null),na([R(ia.getClusterDetail),ra("design:type",Function),ra("design:paramtypes",[Object]),ra("design:returntype",void 0)],oa.prototype,"getClusterDetail",null),oa=na([H({viewer:{type:k.Object,required:!0}}),ra("design:paramtypes",[Object])],oa);class sa{constructor(t){this._geometryArr=[];const{viewer:e,styleName:i=""}=t;this._styleName=i,this._viewer=e}create(t,e){const i=this._geometryArr[this._geometryArr.length-1];i&&i._drawing&&i.destroy();const n=new mr[e]({viewer:this._viewer,styleName:this._styleName});n.startCreate(Object.assign({},t)),this._geometryArr.push(n)}createGraphicByData(t){const{style:e,points:i,type:n,callback:r,show:o=!0}=t,s=yr[n],a=Object.assign({},e);this.create(a,s);this._geometryArr[this._geometryArr.length-1].createByData(o,i,r)}removeById(t){const{id:e,ended:i}=t;let n=Object(g.findIndex)(this._geometryArr,{_id:e});-1!==n?(this._geometryArr[n].destroy(),this._geometryArr.splice(n,1),at(!0,i)):console.warn("The provided ID does not exist.")}removeAll(){this._geometryArr.forEach(t=>{t.destroy()}),this._geometryArr=[]}editById(t){const{id:e,updateCallback:i,updateEndCallback:n}=t;let r=Object(g.findIndex)(this._geometryArr,{_id:e});-1!==r?this._geometryArr[r].showEdit(i,n):console.warn("The provided ID does not exist.")}editPropertyById(t){const{id:e,property:i}=t,n=Object(g.findIndex)(this._geometryArr,{_id:e});-1!==n?"hide"!==this._geometryArr[n]._visibleStatus?this._geometryArr[n].setProperty(i):console.error("can not set style!"):console.warn("The provided ID does not exist.")}finishEdit(t){const{id:e,callback:i}=t;let n=Object(g.findIndex)(this._geometryArr,{_id:e});-1!==n?this._geometryArr[n].finishEdit(i):console.warn("The provided ID does not exist.")}show(t){const{id:e,animation:i}=t,n=Object(g.findIndex)(this._geometryArr,{_id:e});if(-1!==n)if(i){const{duration:t,delay:e,callback:r}=i;this._geometryArr[n].showAnimation(t,e,r)}else this._geometryArr[n].showAnimation(0,0);else console.warn("The provided ID does not exist.")}hide(t){const{id:e,animation:i}=t,n=Object(g.findIndex)(this._geometryArr,{_id:e});if(-1!==n)if(i){const{duration:t,delay:e,callback:r}=i;this._geometryArr[n].hideAnimation(t,e,r)}else this._geometryArr[n].hideAnimation(0,0);else console.warn("The provided ID does not exist.")}cancelDraw(){const t=this._geometryArr[this._geometryArr.length-1];t&&t._drawing&&t.destroy()}on(t){const{id:e,event:i,handler:n}=t;if(e){let t=Object(g.findIndex)(this._geometryArr,{_id:e});this._geometryArr[t].on({event:i,handler:t=>{t.id=e,n(t)}})}else this._geometryArr.forEach(t=>{t.on({event:i,handler:e=>{e.id=t._id,n(e)}})})}off(t){const{id:e,event:i}=t;if(e){let t=Object(g.findIndex)(this._geometryArr,{_id:e});this._geometryArr[t].off({event:i})}else this._geometryArr.forEach(t=>{t.off({event:i})})}}class aa{constructor(t){this._textLabelLayer=null,this._drawing=!0;const{viewer:e,text:i={}}=t,n=Bt.getModule(e).measureCache,r=n[n.length-1];r&&r._drawing&&r.destroy(),this._userViewer=e,this._drawInstance=new sa({viewer:e}),!1!==i.show&&(this._textLabelLayer=new Lr({viewer:e,font:i.font||"12px",fillColor:i.color||"#000",verticalOrigin:f.VerticalOrigin.BOTTOM,disableDepthTestDistance:Number.POSITIVE_INFINITY}),this._userViewer.addLayer({layer:this._textLabelLayer})),this.init(t)}init(t){const{mode:e="distance",callback:i,text:n={}}=t;if("distance"===e){let e,r=!0;this._drawInstance.create(Object.assign(Object.assign({},t),{callback:()=>{clearTimeout(e),this.calculateDistance(),!1!==n.show&&this.setTextData("distance"),i&&i(Object.assign(Object.assign({},this._disValue.slice(this._disValue.length-1)[0]),{isEnd:!0,isStart:!1})),this._drawing=!1},clickFn:()=>{clearTimeout(e),e=setTimeout(()=>{this.calculateDistance("click"),!1!==n.show&&this.setTextData("distance"),i&&i(Object.assign(Object.assign({},this._disValue.slice(this._disValue.length-1)[0]),{isStart:r,isEnd:!1})),r=!1},200)},cancelFn:()=>{this.destroy()}}),2)}else if("area"===e){let e,r=!0;this._drawInstance.create(Object.assign(Object.assign({},t),{callback:()=>{clearTimeout(e),this.calculateArea(),!1!==n.show&&this.setTextData("area",!0),i&&i(Object.assign(Object.assign({},this._disValue.slice(this._disValue.length-1)[0]),{isEnd:!0,isStart:!1})),this._drawing=!1},clickFn:()=>{clearTimeout(e),e=setTimeout(()=>{this.calculateArea("click"),!1!==n.show&&this.setTextData("area",!1),i&&i(Object.assign(Object.assign({},this._disValue.slice(this._disValue.length-1)[0]),{isStart:r,isEnd:!1})),r=!1},200)},cancelFn:()=>{this.destroy()}}),3)}else"triangle"===e?this._drawInstance.create(Object.assign(Object.assign({},t),{callback:()=>{this.calculateLength(),!1!==n.show&&this.setTextData("triangle"),i&&i({label:this._disValue,isStart:!1,isEnd:!0}),this._drawing=!1},moveFn:()=>{this.calculateLength(),!1!==n.show&&this.setTextData("triangle"),i&&i({label:this._disValue,isStart:!0,isEnd:!1})},cancelFn:()=>{this.destroy()}}),7):"height"===e&&this._drawInstance.create(Object.assign(Object.assign({},t),{callback:()=>{this.calculateHeight(),!1!==n.show&&this.setTextData("height"),i&&i(Object.assign(Object.assign({},this._disValue[0]),{isStart:!1,isEnd:!0})),this._drawing=!1},moveFn:()=>{this.calculateHeight(),!1!==n.show&&this.setTextData("height"),i&&i(Object.assign(Object.assign({},this._disValue[0]),{isStart:!0,isEnd:!1}))},cancelFn:()=>{this.destroy()}}),8);Bt.getModule(this._userViewer).measureCache.push(this)}setTextData(t,e=!1){const i=this._disValue.map((i,n)=>{if("distance"===t)return Object.assign(Object.assign({},i),{text:0!==i.text?this.formatDistance(i.text):"起点"});if("area"===t){const t=n===this._disValue.length-1;return Object.assign(Object.assign({},i),{text:0!==i.text&&e&&t?this.formatArea(i.text):""})}if("triangle"===t){let t="";return 0===n?t="直线距离: "+this.formatDistance(i.text,"meters"):1===n?t="水平距离: "+this.formatDistance(i.text,"meters"):2===n&&(t="垂直高度: "+this.formatDistance(i.text,"meters")),Object.assign(Object.assign({},i),{text:t})}return"height"===t?Object.assign(Object.assign({},i),{text:"高度："+this.formatDistance(i.text,"meters")}):void 0});this._textLabelLayer&&this._textLabelLayer.setData(i)}getPositions(){return this._drawInstance._geometryArr[0].getPositionArr()}calculateDistance(t){let e=[{text:0}],i=this.getPositions();if(t&&"click"===t&&i.pop(),1===i.length){const t=i[0];e[0].position=new I(t[0],t[1])}if(i.length>1){let t=i[0];e[0].position=new I(t[0],t[1]);for(let t=1;t<i.length;t++){let n=Ot(i[t]),r=Ot(i[t-1]),o=ne(n,r);o+=e[t-1].text,e.push({text:o,position:new I(i[t][0],i[t][1])})}}this._disValue=e}calculateLength(){let t=this.getPositions();const e=Y.WGS84ToCartesian(t[0]),i=Y.WGS84ToCartesian(t[1]),n=Y.WGS84ToCartesian(t[2]),r=f.Cartesian3.distance(e,i),o=Y.CartesianToWGS84(f.Cartesian3.midpoint(e,i,new f.Cartesian3)),s=f.Cartesian3.distance(i,n),a=Y.CartesianToWGS84(f.Cartesian3.midpoint(i,n,new f.Cartesian3)),A=f.Cartesian3.distance(e,n),l=Y.CartesianToWGS84(f.Cartesian3.midpoint(e,n,new f.Cartesian3));this._disValue=[{text:r,position:o},{text:s,position:a},{text:A,position:l}]}calculateHeight(){const t=this._drawInstance._geometryArr[0],{center:e,height:i}=t.info,n=t._positions[0];this._disValue=e&&i?[{text:i,position:Y.CartesianToWGS84(e)}]:[{text:0,position:Y.CartesianToWGS84(n)}]}calculateArea(t){let e=[],i=this.getPositions();if(t&&"click"===t&&i.pop(),i.length<3)for(let t=0;t<i.length;t++){let n=i[t];e.push({text:0,position:new I(n[0],n[1])})}else for(let t=0;t<i.length;t++)if(t<2){let n=i[t];e.push({text:0,position:new I(n[0],n[1])})}else{let r=i.filter((e,i)=>i<=t);r.push(i[0]);let o=Tt([r]);var n=Ae(o);let s=an(o);e.push({text:n,position:new I(s.geometry.coordinates[0],s.geometry.coordinates[1])})}this._disValue=e}destroy(t={}){const{ended:e}=t;this._drawInstance.removeAll(),this._textLabelLayer&&this._textLabelLayer.remove(),this._drawing=!1,at(!0,e)}formatDistance(t,e){return e&&"meters"===e?t<1e3?t.toFixed(1)+"m":(t/1e3).toFixed(1)+"km":t<1?(1e3*t).toFixed(0)+"m":t.toFixed(1)+"km"}formatArea(t){return t>1e6?(t/1e6).toFixed(2)+"㎞²":t.toFixed(2)+"㎡"}}var Aa={drawPoint:{radius:{type:k.Number},color:{type:k.String},callback:{type:k.Function}},drawPolyline:{width:{type:k.Number},color:{type:k.String},url:{type:k.String},callback:{type:k.Function}},drawPolygon:{lineWidth:{type:k.Number},lineColor:{type:k.String},lineType:{type:k.String},fillColor:{type:k.String},callback:{type:k.Function}},drawRectangle:{lineWidth:{type:k.Number},lineColor:{type:k.String},lineType:{type:k.String},fillColor:{type:k.String},callback:{type:k.Function}},drawArrow:{type:{type:k.String},fillColor:{type:k.String},callback:{type:k.Function}},drawCircular:{showRadius:{type:k.Boolean},fillColor:{type:k.String},callback:{type:k.Function}},drawSpaceTriangle:{width:{type:k.Number},color:{type:k.String},callback:{type:k.Function}},drawTriangle:{lineWidth:{type:k.Number},lineColor:{type:k.String},lineType:{type:k.String},callback:{type:k.Function}},drawElevationLine:{width:{type:k.Number},color:{type:k.String},callback:{type:k.Function}},removeById:{id:{type:k.String,required:!0},callback:{type:k.Function}},editById:{id:{type:k.String,required:!0},updateEndCallback:{type:k.Function}},plotPolygon:{fillColor:{type:k.String},outlineColor:{type:k.String},outlineWidth:{type:k.Number},dashedOutline:{type:k.Boolean},dashLength:{type:k.Number}},plotLine:{lineColor:{type:k.String},lineWidth:{type:k.Number},dashedLine:{type:k.Boolean},dashLength:{type:k.Number},texture:{type:k.String}},showOrHide:{id:{type:k.String,required:!0},animation:{duration:{type:k.Number},delay:{type:k.Number},callback:{type:k.Function}}},GrowthAnimationOption:{id:{type:k.String,required:!0},delay:{type:k.Number},duration:{type:k.Number},callback:{type:k.Function}}};class la{constructor(){this.listeners=new Map([["drawStart",new Set],["drawUpdate",new Set],["drawEnd",new Set],["editStart",new Set],["editUpdate",new Set],["editEnd",new Set]])}on(t,e){this.listeners.has(t)?this.listeners.get(t).add(e):console.warn("Event binding must be one of 'drawStart', 'drawUpdate', or 'drawEnd'.")}off(t,e){this.listeners.has(t)&&this.listeners.get(t).delete(e)}dispatchEvent(t,e){this.listeners.has(t)&&this.listeners.get(t).forEach(t=>{t(e)})}}const ca=(t,e)=>Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)),ua=t=>{let e=0;return t&&Array.isArray(t)&&t.length>0&&t.forEach((i,n)=>{n<t.length-1&&(e+=ca(i,t[n+1]))}),e},ha=t=>Math.pow(ua(t),.99),pa=(t,e)=>[(t[0]+e[0])/2,(t[1]+e[1])/2],da=(t,e,i)=>{const n=[(t[0]+e[0])/2,(t[1]+e[1])/2],r=[n[0]-t[1]+e[1],n[1]+t[0]-e[0]],o=[(t[0]+i[0])/2,(t[1]+i[1])/2],s=[o[0]-t[1]+i[1],o[1]+t[0]-i[0]];return fa(n,r,o,s)},fa=(t,e,i,n)=>{if(t[1]===e[1]){return[(n[0]-i[0])/(n[1]-i[1])*(t[1]-i[1])+i[0],t[1]]}if(i[1]===n[1]){return[(e[0]-t[0])/(e[1]-t[1])*(i[1]-t[1])+t[0],i[1]]}const r=(e[0]-t[0])/(e[1]-t[1]),o=(n[0]-i[0])/(n[1]-i[1]),s=(r*t[1]-t[0]-o*i[1]+i[0])/(r-o);return[r*s-r*t[1]+t[0],s]},ga=(t,e)=>{let i;const n=Math.asin(Math.abs(e[1]-t[1])/ca(t,e));return e[1]>=t[1]&&e[0]>=t[0]?i=n+Math.PI:e[1]>=t[1]&&e[0]<t[0]?i=2*Math.PI-n:e[1]<t[1]&&e[0]<t[0]?i=n:e[1]<t[1]&&e[0]>=t[0]&&(i=Math.PI-n),i},ma=(t,e,i)=>{const n=ga(e,t)-ga(e,i);return n<0?n+2*Math.PI:n},ya=(t,e,i)=>(i[1]-t[1])*(e[0]-t[0])>(e[1]-t[1])*(i[0]-t[0]),va=(t,e,i,n,r)=>{t=Math.max(Math.min(t,1),0);const[o,s]=[1-t,t*t],a=s*t,A=o*o,l=A*o;return[l*e[0]+3*A*t*i[0]+3*o*s*n[0]+a*r[0],l*e[1]+3*A*t*i[1]+3*o*s*n[1]+a*r[1]]},_a=(t,e,i,n,r)=>{const o=ga(t,e),s=r?o+i:o-i,a=n*Math.cos(s),A=n*Math.sin(s);return[e[0]+a,e[1]+A]},wa=(t,e,i,n)=>{let[r,o,s,a]=[null,null,[],n-i];a=a<0?a+2*Math.PI:a;for(let n=0;n<=100;n++){const A=i+a*n/100;r=t[0]+e*Math.cos(A),o=t[1]+e*Math.sin(A),s.push([r,o])}return s},Ca=(t,e,i,n)=>{const r=Ba(e,i,n);let[o,s,a,A,l]=[null,null,null,null,null];const c=Math.sqrt(r[0]*r[0]+r[1]*r[1]),u=r[0]/c,h=r[1]/c,p=ca(e,i),d=ca(i,n);return c>1e-4?ya(e,i,n)?(a=t*p,A=i[0]-a*h,l=i[1]+a*u,o=[A,l],a=t*d,A=i[0]+a*h,l=i[1]-a*u,s=[A,l]):(a=t*p,A=i[0]+a*h,l=i[1]-a*u,o=[A,l],a=t*d,A=i[0]-a*h,l=i[1]+a*u,s=[A,l]):(A=i[0]+t*(e[0]-i[0]),l=i[1]+t*(e[1]-i[1]),o=[A,l],A=i[0]+t*(n[0]-i[0]),l=i[1]+t*(n[1]-i[1]),s=[A,l]),[o,s]},Ba=(t,e,i)=>{let n=t[0]-e[0],r=t[1]-e[1];const o=Math.sqrt(n*n+r*r);n/=o,r/=o;let s=i[0]-e[0],a=i[1]-e[1];const A=Math.sqrt(s*s+a*a);s/=A,a/=A;return[n+s,r+a]},ba=(t,e)=>{const i=((t,e)=>{let[i,n,r,o,s]=[t[0],t[1],t[2],null,null];const a=Ca(0,i,n,r)[0],A=Ba(i,n,r);if(Math.sqrt(A[0]*A[0]+A[1]*A[1])>1e-4){const t=pa(i,n),e=i[0]-t[0],r=i[1]-t[1],A=2/ca(i,n),l=-A*r,c=A*e,u=l*l-c*c,h=2*l*c,p=c*c-l*l,d=a[0]-t[0],f=a[1]-t[1];o=t[0]+u*d+h*f,s=t[1]+h*d+p*f}else o=i[0]+e*(n[0]-i[0]),s=i[1]+e*(n[1]-i[1]);return[o,s]})(e,t);let[n,r,o,s,a]=[null,null,null,[i],[]];for(let i=0;i<e.length-2;i++){[n,r,o]=[e[i],e[i+1],e[i+2]];const a=Ca(t,n,r,o);s=s.concat(a)}const A=((t,e)=>{const i=t.length,n=t[i-3],r=t[i-2],o=t[i-1],s=Ca(0,n,r,o)[1],a=Ba(n,r,o),A=Math.sqrt(a[0]*a[0]+a[1]*a[1]);let[l,c]=[null,null];if(A>1e-4){const t=pa(r,o),e=o[0]-t[0],i=o[1]-t[1],n=2/ca(r,o),a=-n*i,A=n*e,u=a*a-A*A,h=2*a*A,p=A*A-a*a,d=s[0]-t[0],f=s[1]-t[1];l=t[0]+u*d+h*f,c=t[1]+h*d+p*f}else l=o[0]+e*(r[0]-o[0]),c=o[1]+e*(r[1]-o[1]);return[l,c]})(e,t);A&&s.push(A);for(let t=0;t<e.length-1;t++){n=e[t],r=e[t+1],a.push(n);for(let e=0;e<100;e++){const i=va(e/100,n,s[2*t],s[2*t+1],r);a.push(i)}a.push(r)}return a},Ea=function(t){if(t.length<=2)return t;const e=[],i=t.length-1;for(let n=0;n<=1;n+=.01){let[r,o]=[0,0];for(let e=0;e<=i;e++){const s=xa(i,e),a=Math.pow(n,e),A=Math.pow(1-n,i-e);r+=s*a*A*t[e][0],o+=s*a*A*t[e][1]}e.push([r,o])}return e.push(t[i]),e},Sa=t=>{let e=1;switch(t){case t<=1:e=1;break;case 2===t:e=2;break;case 3===t:e=6;break;case 24===t:e=24;break;case 5===t:e=120;break;default:for(let i=1;i<=t;i++)e*=i}return e},xa=(t,e)=>Sa(t)/(Sa(e)*Sa(t-e)),Ia=t=>{if(t.length<=2)return t;const[e,i]=[2,[]],n=t.length-e-1;i.push(t[0]);for(let r=0;r<=n;r++)for(let n=0;n<=1;n+=.05){let[o,s]=[0,0];for(let i=0;i<=e;i++){const e=Fa(i,n);o+=e*t[r+i][0],s+=e*t[r+i][1]}i.push([o,s])}return i.push(t[t.length-1]),i},Fa=(t,e)=>{let i=0;return 0===t?i=Math.pow(e-1,2)/2:1===t?i=(-2*Math.pow(e,2)+2*e+1)/2:2===t&&(i=Math.pow(e,2)/2),i};class Oa{constructor(t,e,i){this.geometryPoints=[],this.state="drawing",this.controlPoints=[],this._id="",this.isHidden=!1,this.graphicType="plot",this.cesium=t,this.CesiumViewer=e.viewer.instance,this.viewer=e,this.viewerContainer=this.CesiumViewer.container,this._layerType="layer",this.type=this.getType(),this.zIndex=this.viewer.viewer.graphicIndex++,this.mergeStyle(i),this.cartesianToLnglat=this.cartesianToLnglat.bind(this),this.pixelToCartesian=this.pixelToCartesian.bind(this),this.eventDispatcher=new la,this.onClick(),this._layerEvent=new Cr,this._tooltip=new Xn(this.CesiumViewer.container,""),this._tooltipDrawHandler=new this.cesium.ScreenSpaceEventHandler(this.viewerContainer),this._tooltipEditHandler=new this.cesium.ScreenSpaceEventHandler(this.viewerContainer),this.onTooltipDrawEvent()}mergeStyle(t){"polygon"===this.type?this.style=Object.assign({material:this.cesium.Color.fromCssColorString("rgba(59, 178, 208, 0.3)"),outlineMaterial:this.cesium.Color.fromCssColorString("rgba(59, 178, 208, 1.0)"),outlineWidth:2},t):"line"===this.type&&(this.style=Object.assign({material:this.cesium.Color.fromCssColorString("rgba(59, 178, 208, 1.0)"),lineWidth:2},t)),this.styleCache=Object(g.cloneDeep)(this.style)}setState(t){this.state=t,"static"===t?(this.polygonEntity&&this.polygonEntity.polygon.setStatic(),this.outlineEntity&&this.outlineEntity.polyline.setStatic(),this.lineEntity&&this.lineEntity.polyline.setStatic()):(this.polygonEntity&&this.polygonEntity.polygon.setDynamic(),this.outlineEntity&&this.outlineEntity.polyline.setDynamic(),this.lineEntity&&this.lineEntity.polyline.setDynamic())}getState(){return this.state}onClick(){this.eventHandler=new this.cesium.ScreenSpaceEventHandler(this.viewerContainer),this.eventHandler.setInputAction(t=>{if("drawing"===this.state){const e=this.pixelToCartesian(t.position),i=this.getPoints();if(!e)return;if(!this.freehand&&i.length>0&&!this.checkDistance(e,i[i.length-1]))return;this.addPoint(e),1===this.getPoints().length&&this.eventDispatcher.dispatchEvent("drawStart")}},this.cesium.ScreenSpaceEventType.LEFT_CLICK)}finishEdit(t){if("edit"!=this.state)return;this.setState("static"),this.removeControlPoints();const e=this.getPoints().map(t=>this.cartesianToLnglat(t));this.disableDrag(),this.removeRightClickListener(),this.removeTooltipEditListener(),this.eventDispatcher.dispatchEvent("drawEnd",{lnglatPoints:e}),t&&t({lnglatPoints:e})}onRightClick(){this.eventHandler.setInputAction(t=>{"drawing"===this.state?this.remove():"edit"===this.state&&this.finishEdit()},this.cesium.ScreenSpaceEventType.RIGHT_CLICK)}startEdit(){return"animating"===this.state?"animating":"edit"!==this.state&&(this.onRightClick(),this.setState("edit"),this.addControlPoints(),this.draggable(),this.onTooltipEditEvent(),this.eventDispatcher.dispatchEvent("editStart"),"success")}onMouseMove(){this.eventHandler.setInputAction(t=>{const e=this.getPoints(),i=this.pixelToCartesian(t.endPosition);i&&this.checkDistance(i,e[e.length-1])&&this.updateMovingPoint(i,e.length)},this.cesium.ScreenSpaceEventType.MOUSE_MOVE)}onDoubleClick(){this.eventHandler.setInputAction(t=>{this.finishDrawing()},this.cesium.ScreenSpaceEventType.LEFT_DOUBLE_CLICK)}checkDistance(t,e){return this.cesium.Cartesian3.distance(t,e)>10}finishDrawing(){const t=this.getPoints();if(3===this.minPointsForShape&&2===t.length)return void this.remove();this.removeClickListener(),this.removeMoveListener(),this.removeDoubleClickListener(),this._tooltip.setVisible(!1),this.removeTooltipDrawListener(),this.setState("static");const e=this.polygonEntity||this.lineEntity;if(e){this._id=e.id,this.viewer.viewer.layerCache.add(this);const i=t.map(t=>this.cartesianToLnglat(t));this.eventDispatcher.dispatchEvent("drawEnd",{lnglatPoints:i})}}removeClickListener(){this.eventHandler.removeInputAction(this.cesium.ScreenSpaceEventType.LEFT_CLICK)}removeRightClickListener(){this.eventHandler.removeInputAction(this.cesium.ScreenSpaceEventType.RIGHT_CLICK)}removeMoveListener(){this.eventHandler.removeInputAction(this.cesium.ScreenSpaceEventType.MOUSE_MOVE)}removeDoubleClickListener(){this.eventHandler.removeInputAction(this.cesium.ScreenSpaceEventType.LEFT_DOUBLE_CLICK)}setGeometryPoints(t){this.geometryPoints=t}getGeometryPoints(){return this.geometryPoints}drawPolygon(t){if(!this.polygonEntity){const e=this.style,i=()=>new this.cesium.PolygonHierarchy(this.geometryPoints);if(!1===t){if(e.material&&e.material.image){const t=e.material.color.getValue();t.alpha=0,e.material.color.setValue(t)}else e.material.alpha=0;if(e.outlineMaterial.dashLength){const t=e.outlineMaterial.color.getValue();t.alpha=0,e.outlineMaterial.color.setValue(t)}else e.outlineMaterial.alpha=0;this.isHidden=!0}this.polygonEntity=this.CesiumViewer.entities.add({polygon:new this.cesium.PolygonGraphics({hierarchy:new this.cesium.CallbackProperty(i,!1),show:!0,material:e.material,zIndex:this.zIndex})}),this.outlineEntity=this.CesiumViewer.entities.add({polyline:{positions:new this.cesium.CallbackProperty(()=>[...this.geometryPoints,this.geometryPoints[0]],!1),width:e.outlineWidth,material:e.outlineMaterial,clampToGround:!0,zIndex:this.zIndex}})}}drawLine(t){if(!this.lineEntity){const e=this.style;if(!1===t){if(e.material&&e.material.image)e.material.color.alpha=0;else if(e.material.dashLength){const t=e.material.color.getValue();t.alpha=0,e.material.color.setValue(t)}else e.material.alpha=0;this.isHidden=!0}this.lineEntity=this.addLineEntity(e)}}addFirstLineOfTheArrow(){if(!this.lineEntity){const t=this.style,e={material:t.outlineMaterial,lineWidth:t.outlineWidth};this.lineEntity=this.addLineEntity(e)}}addLineEntity(t){return this.CesiumViewer.entities.add({polyline:{positions:new this.cesium.CallbackProperty(()=>this.geometryPoints,!1),width:t.lineWidth,material:t.material,clampToGround:!0,zIndex:this.zIndex}})}cartesianToLnglat(t){const e=this.CesiumViewer.scene.globe.ellipsoid.cartesianToCartographic(t),i=this.cesium.Math.toDegrees(e.latitude);return[this.cesium.Math.toDegrees(e.longitude),i]}pixelToCartesian(t){const e=this.CesiumViewer.camera.getPickRay(t);return this.CesiumViewer.scene.globe.pick(e,this.CesiumViewer.scene)}addControlPoints(){const t=this.getPoints(),e=this.viewer.viewer.mapConfig.distUrl+"Imgs/circle_red.png";this.controlPoints=t.map(t=>this.CesiumViewer.entities.add({position:t,billboard:{image:e,color:this.cesium.Color.fromCssColorString("rgba(255,255,255,1.0)")}}));let i,n,r=!1;this.controlPointsEventHandler=new this.cesium.ScreenSpaceEventHandler(this.viewerContainer),this.controlPointsEventHandler.setInputAction(t=>{var e;if(r){if(i&&!this.cesium.Cartesian3.equals(n,i.position._value)){const t=this.getPoints().map(t=>this.cartesianToLnglat(t));this.eventDispatcher.dispatchEvent("editUpdate",{lnglatPoints:t})}r=!1,i=null}else{const o=this.CesiumViewer.scene.pick(t.position);if(this.cesium.defined(o))for(let t=0;t<this.controlPoints.length;t++)if(o.id===this.controlPoints[t]){r=!0,i=this.controlPoints[t],n=null===(e=i.position)||void 0===e?void 0:e._value,i.index=t;break}}},this.cesium.ScreenSpaceEventType.LEFT_CLICK),this.controlPointsEventHandler.setInputAction(t=>{var e;if(r&&i){const n=this.CesiumViewer.camera.pickEllipsoid(t.endPosition,this.CesiumViewer.scene.globe.ellipsoid);n&&(null===(e=i.position)||void 0===e||e.setValue(n),this.updateDraggingPoint(n,i.index))}},this.cesium.ScreenSpaceEventType.MOUSE_MOVE)}removeControlPoints(){this.controlPoints.length>0&&(this.controlPoints.forEach(t=>{this.CesiumViewer.entities.remove(t)}),this.controlPointsEventHandler.removeInputAction(this.cesium.ScreenSpaceEventType.LEFT_CLICK),this.controlPointsEventHandler.removeInputAction(this.cesium.ScreenSpaceEventType.MOUSE_MOVE))}remove(){"polygon"===this.type?(this.CesiumViewer.entities.remove(this.polygonEntity),this.CesiumViewer.entities.remove(this.outlineEntity),this.lineEntity&&this.CesiumViewer.entities.remove(this.lineEntity),this.polygonEntity=null,this.outlineEntity=null):"line"===this.type&&(this.CesiumViewer.entities.remove(this.lineEntity),this.lineEntity=null),this.removeClickListener(),this.removeRightClickListener(),this.removeMoveListener(),this.removeDoubleClickListener(),this.removeControlPoints(),this.removeTooltipDrawListener(),this.removeTooltipEditListener(),this._tooltip.destroy()}on(t,e){this.eventDispatcher.on(t,e)}off(t,e){this.eventDispatcher.off(t,e)}onLayerEvent(t,e){this._layerEvent&&this._layerEvent.on(t,e,this)}offLayerEvent(t){const{event:e}=t;this._layerEvent&&this._layerEvent.off(e,this)}animateOpacity(t,e,i,n,r,o){setTimeout(()=>{const n=t.polygon||t.polyline||t.billboard;let s,a=n.material;if(a)s=a.image&&void 0!==a.color.alpha?a.color.alpha:a.color.getValue().alpha;else{const t=n.color.getValue();s=t.alpha}let A=0;const l=t=>{A||(A=t);const c=t-A;if(c<i){const t=s+c/i*(e-s);if(a)if(a.image&&void 0!==a.color.alpha)a.color.alpha=t;else{const e=a.color.getValue().withAlpha(t);a.color.setValue(e)}else{const e=n.color.getValue().withAlpha(t);n.color.setValue(e)}requestAnimationFrame(l)}else{r&&r();const t=o||"static";if(0===e&&(this.isHidden=!0),this.setState("drawing"),a)if(a.image&&void 0!==a.color.alpha)a.color.alpha=e;else{const t=a.color.getValue().withAlpha(e);a.color.setValue(t)}else{const t=n.color.getValue().withAlpha(e);n.color.setValue(t)}requestAnimationFrame(()=>{this.setState(t)})}};requestAnimationFrame(l)},n)}showAnimation(t=1e3,e=0,i){var n,r,o,s;if("static"==this.state&&!1!==this.isHidden){if(this.isHidden=!1,"polygon"===this.type){let o=.3;const s=this.styleCache.material;o=s.image?s.color.getValue().alpha:s.alpha,this.animateOpacity(this.polygonEntity,o,t,e,i,this.state);const a=null===(r=null===(n=this.styleCache)||void 0===n?void 0:n.outlineMaterial)||void 0===r?void 0:r.alpha;this.animateOpacity(this.outlineEntity,a||1,t,e,void 0,this.state)}else if("line"===this.type){const n=this.styleCache.material;let r=1;if(n.image)r=n.color.alpha;else if(n.dashLength){r=n.color.getValue().alpha}else r=null===(s=null===(o=this.styleCache)||void 0===o?void 0:o.material)||void 0===s?void 0:s.alpha;this.animateOpacity(this.lineEntity,r,t,e,i,this.state)}0!=t&&this.setState("animating")}}hideAnimation(t=1e3,e=0,i){"static"==this.state&&!0!==this.isHidden&&("polygon"===this.type?(this.animateOpacity(this.polygonEntity,0,t,e,i,this.state),this.animateOpacity(this.outlineEntity,0,t,e,void 0,this.state)):"line"===this.type&&this.animateOpacity(this.lineEntity,0,t,e,i,this.state),0!=t&&this.setState("animating"))}growthAnimation(t=3e3,e=0,i){"static"===this.state&&(this.minPointsForShape?(this.setState("animating"),4!==this.minPointsForShape?setTimeout(()=>{this.hideAnimation(0,0,void 0);const e=this.getPoints();let n=0;n=2===this.minPointsForShape?t/(e.length-1):t/(e.length-2);let r=Date.now(),o=0;this.CesiumViewer.clock.shouldAnimate=!0;const s=a=>{const A=Date.now()-r;if(A>=t)return i&&i(),r=0,this.CesiumViewer.clock.shouldAnimate=!1,this.CesiumViewer.clock.onTick.removeEventListener(s),void this.setState("static");const l=Math.floor(A/n);let c;o=2===this.minPointsForShape?l+1:l+2,c=e[o-1],0==l&&3===this.minPointsForShape&&(c=this.cesium.Cartesian3.midpoint(e[0],e[1],new this.cesium.Cartesian3));let u=e[o];const h=(A-l*n)/n,p=this.cesium.Cartesian3.lerp(c,u,h,new this.cesium.Cartesian3),d=e.slice(0,o+1);d[d.length-1]=p;const f=this.createGraphic(d);this.setGeometryPoints(f),this.showAnimation(0,0,void 0)};this.CesiumViewer.clock.onTick.addEventListener(s)},e):this.doubleArrowGrowthAnimation(t,e,i)):console.warn("Growth animation is not supported for this type of shape"))}doubleArrowGrowthAnimation(t=3e3,e=0,i){setTimeout(()=>{this.CesiumViewer.entities.remove(this.polygonEntity),this.CesiumViewer.entities.remove(this.outlineEntity),this.polygonEntity=null,this.outlineEntity=null;const e=this.getPoints();let n=Date.now();this.CesiumViewer.clock.shouldAnimate=!0;const r=o=>{const s=Date.now()-n;if(s>=t)return i&&i(),n=0,this.CesiumViewer.clock.shouldAnimate=!1,this.CesiumViewer.clock.onTick.removeEventListener(r),void this.setState("static");const a=this.cesium.Cartesian3.midpoint(e[0],e[1],new this.cesium.Cartesian3),A=this.cesium.Cartesian3.midpoint(e[0],a,new this.cesium.Cartesian3),l=this.cesium.Cartesian3.midpoint(a,e[1],new this.cesium.Cartesian3);let c=e[3],u=e[2];const h=s/t,p=this.getBezierControlPointforGrowthAnimation();let d=[A,p.left,c],f=[l,p.right,u];const g=this.getNewPosition(d,h),m=this.getNewPosition(f,h),y=[...e];y[2]=m,y[3]=g;const v=this.createGraphic(y);this.setGeometryPoints(v),this.drawPolygon()};this.CesiumViewer.clock.onTick.addEventListener(r)},e)}getNewPosition(t,e){t=t.map(t=>this.cartesianToLnglat(t));let i=ba(.3,t);return i=i.map(t=>this.cesium.Cartesian3.fromDegrees(t[0],t[1])),this.interpolateAlongCurve(i,e)}interpolateAlongCurve(t,e){const i=t.length-1,n=Math.floor(e*i),r=e*i-n,o=t[n],s=t[n+1],a=o.x+(s.x-o.x)*r,A=o.y+(s.y-o.y)*r,l=o.z+(s.z-o.z)*r;return new f.Cartesian3(a,A,l)}createGraphicByData(t,e){const i=t.map(t=>this.cesium.Cartesian3.fromDegrees(t[0],t[1]));this.points=i;const n=this.createGraphic(i);this.setGeometryPoints(n),"polygon"==this.type?!1===e?this.drawPolygon(!1):this.drawPolygon():!1===e?this.drawLine(!1):this.drawLine(),requestAnimationFrame(()=>{this.finishDrawing()})}draggable(){let t,e=!1;this.dragEventHandler=new this.cesium.ScreenSpaceEventHandler(this.viewerContainer),this.dragEventHandler.setInputAction(i=>{const n=this.CesiumViewer.scene.camera.getPickRay(i.position);if(n){const r=this.CesiumViewer.scene.globe.pick(n,this.CesiumViewer.scene),o=this.CesiumViewer.scene.pick(i.position);if(f.defined(o)&&o.id instanceof f.Entity){o.id.id==this._id&&(e=!0,t=r,this.CesiumViewer.scene.screenSpaceCameraController.enableRotate=!1)}}},f.ScreenSpaceEventType.LEFT_DOWN),this.dragEventHandler.setInputAction(i=>{if(e&&t){const e=this.pixelToCartesian(i.endPosition);if(e){const i=f.Cartesian3.subtract(e,t,new f.Cartesian3),n=this.geometryPoints.map(t=>f.Cartesian3.add(t,i,new f.Cartesian3));this.points=this.points.map(t=>f.Cartesian3.add(t,i,new f.Cartesian3)),this.controlPoints.map(t=>{var e,n;const r=null===(e=t.position)||void 0===e?void 0:e.getValue(f.JulianDate.now()),o=f.Cartesian3.add(r,i,new f.Cartesian3);null===(n=t.position)||void 0===n||n.setValue(o)}),this.setGeometryPoints(n),t=e}}},f.ScreenSpaceEventType.MOUSE_MOVE),this.dragEventHandler.setInputAction(()=>{if(e){e=!1,t=void 0,this.CesiumViewer.scene.screenSpaceCameraController.enableRotate=!0;const i=this.getPoints().map(t=>this.cartesianToLnglat(t));this.eventDispatcher.dispatchEvent("editUpdate",{lnglatPoints:i})}},f.ScreenSpaceEventType.LEFT_UP)}disableDrag(){this.dragEventHandler.removeInputAction(this.cesium.ScreenSpaceEventType.LEFT_DOWN),this.dragEventHandler.removeInputAction(this.cesium.ScreenSpaceEventType.MOUSE_MOVE),this.dragEventHandler.removeInputAction(this.cesium.ScreenSpaceEventType.LEFT_UP)}editPropertyById(t){const e=this.getState();if("animating"==e||!0===this.isHidden)return;const i=Object(g.cloneDeep)(t);this.styleCache=Object(g.merge)(this.styleCache,i),this.setState("drawing"),"polygon"===this.type?(t.material&&(this.polygonEntity.polygon.material=t.material),t.outlineMaterial&&(this.outlineEntity.polyline.material=t.outlineMaterial),t.outlineWidth&&(this.outlineEntity.polyline.width=t.outlineWidth)):"line"===this.type&&(t.material&&(this.lineEntity.polyline.material=t.material),t.lineWidth&&(this.lineEntity.polyline.width=t.lineWidth)),requestAnimationFrame(()=>{this.setState(e)})}addPoint(t){}getPoints(){return[new this.cesium.Cartesian3]}updateMovingPoint(t,e){}updateDraggingPoint(t,e){}getType(){return"polygon"}createGraphic(t){return[new this.cesium.Cartesian3]}onTooltipDrawEvent(){this._tooltipDrawHandler.setInputAction(t=>{let e=t.endPosition;e&&(e=new f.Cartesian2(e.x/this.viewer.viewer.canvasScale.x,e.y/this.viewer.viewer.canvasScale.y),0===this.points.length?this._tooltip.showAt(e,`<p>${st.property("CHOOSE_START")}</p>`):-1===this._completePointSize?this._tooltip.showAt(e,`<p>${st.property("ADD_NEXT_POINT")}</p><p>${st.property("DOUBLE_CLICK_STOP_DRAW")}</p>`):this.points.length===this._completePointSize-1?this._tooltip.showAt(e,`<p>${st.property("CHOOSE_END")}</p><p>${st.property("CLICK_STOP_DRAW")}</p>`):this.points.length>this._completePointSize?this._tooltip.showAt(e,`<p>${st.property("CLICK_STOP_DRAW")}</p>`):this._tooltip.showAt(e,`<p>${st.property("ADD_NEXT_POINT")}</p>`))},f.ScreenSpaceEventType.MOUSE_MOVE)}removeTooltipDrawListener(){this._tooltipDrawHandler.removeInputAction(this.cesium.ScreenSpaceEventType.MOUSE_MOVE)}onTooltipEditEvent(){let t=!1;this._tooltipEditHandler.setInputAction(e=>{let i=e.position;if(i)if(i=new f.Cartesian2(i.x/this.viewer.viewer.canvasScale.x,i.y/this.viewer.viewer.canvasScale.y),t)t=!1,this._tooltip.setVisible(!1);else{const e=this.CesiumViewer.scene.pick(i);if(this.cesium.defined(e))for(let n=0;n<this.controlPoints.length;n++)e.id===this.controlPoints[n]&&(t=!0,this._tooltip.showAt(i,`<p>${st.property("MOVE_CONTROL_POINT")}</p>`))}},f.ScreenSpaceEventType.LEFT_CLICK),this._tooltipEditHandler.setInputAction(e=>{let i=e.endPosition;i&&(i=new f.Cartesian2(i.x/this.viewer.viewer.canvasScale.x,i.y/this.viewer.viewer.canvasScale.y),t&&this._tooltip.showAt(i,`<p>${st.property("MOVE_CONTROL_POINT")}</p><p>${st.property("LEFT_STOP_MOVE_AND_RIGHT_STOP_EDIT")}</p>`))},f.ScreenSpaceEventType.MOUSE_MOVE)}removeTooltipEditListener(){this._tooltipEditHandler.removeInputAction(this.cesium.ScreenSpaceEventType.LEFT_CLICK),this._tooltipEditHandler.removeInputAction(this.cesium.ScreenSpaceEventType.MOUSE_MOVE)}}class Pa extends Oa{constructor(t,e,i){super(t,e,i),this.points=[],this.arrowLengthScale=5,this.maxArrowLength=2,this.cesium=t,this.tailWidthFactor=.1,this.neckWidthFactor=.2,this.headWidthFactor=.25,this.headAngle=Math.PI/8.5,this.neckAngle=Math.PI/13,this.minPointsForShape=2,this._completePointSize=2,this.setState("drawing")}getType(){return"polygon"}addPoint(t){if(this.points.length<2&&(this.points.push(t),this.onMouseMove()),2===this.points.length){const t=this.createGraphic(this.points);this.setGeometryPoints(t),this.drawPolygon(),this.finishDrawing()}}updateMovingPoint(t){const e=[...this.points,t],i=this.createGraphic(e);this.setGeometryPoints(i),this.drawPolygon()}updateDraggingPoint(t,e){this.points[e]=t;const i=this.createGraphic(this.points);this.setGeometryPoints(i),this.drawPolygon()}createGraphic(t){const[e,i]=t.map(this.cartesianToLnglat),n=ha([e,i]),r=n*this.tailWidthFactor,o=n*this.neckWidthFactor,s=n*this.headWidthFactor,a=_a(i,e,Math.PI/2,r,!0),A=_a(i,e,Math.PI/2,r,!1),l=_a(e,i,this.headAngle,s,!1),c=_a(e,i,this.headAngle,s,!0),u=_a(e,i,this.neckAngle,o,!1),h=_a(e,i,this.neckAngle,o,!0),p=[...a,...u,...l,...i,...c,...h,...A,...e];return this.cesium.Cartesian3.fromDegreesArray(p)}getPoints(){return this.points}}class Ta extends Oa{constructor(t,e,i){super(t,e,i),this.points=[],this.cesium=t,this.headHeightFactor=.18,this.headWidthFactor=.3,this.neckHeightFactor=.85,this.neckWidthFactor=.15,this.headTailFactor=.8,this.minPointsForShape=3,this._completePointSize=-1,this.setState("drawing"),this.onDoubleClick()}getType(){return"polygon"}addPoint(t){this.points.push(t),this.points.length<2?this.onMouseMove():2===this.points.length?(this.setGeometryPoints(this.points),this.drawPolygon()):this.lineEntity&&this.CesiumViewer.entities.remove(this.lineEntity)}updateMovingPoint(t){const e=[...this.points,t];if(this.setGeometryPoints(e),2===e.length)this.addFirstLineOfTheArrow();else{const t=this.createGraphic(e);this.setGeometryPoints(t),this.drawPolygon()}}createGraphic(t){const e=t.map(t=>this.cartesianToLnglat(t));let[i,n]=[e[0],e[1]];ya(e[0],e[1],e[2])&&(i=e[1],n=e[0]);const r=[pa(i,n)].concat(e.slice(2)),o=this.getArrowHeadPoints(r,i,n),[s,a]=[o[0],o[4]],A=ca(i,n)/ha(r),l=this.getArrowBodyPoints(r,s,a,A),c=l.length;let u=[i].concat(l.slice(0,c/2));u.push(s);let h=[n].concat(l.slice(c/2,c));h.push(a),u=Ia(u),h=Ia(h);const p=u.concat(o,h.reverse()),d=[].concat(...p);return this.cesium.Cartesian3.fromDegreesArray(d)}getPoints(){return this.points}getArrowHeadPoints(t,e,i){try{let n=ha(t),r=n*this.headHeightFactor;const o=t[t.length-1];n=ca(o,t[t.length-2]);const s=ca(e,i);r>s*this.headTailFactor&&(r=s*this.headTailFactor);const a=r*this.headWidthFactor,A=r*this.neckWidthFactor;r=r>n?n:r;const l=r*this.neckHeightFactor,c=_a(t[t.length-2],o,0,r,!0),u=_a(t[t.length-2],o,0,l,!0),h=_a(o,c,Math.PI/2,a,!1),p=_a(o,c,Math.PI/2,a,!0),d=_a(o,u,Math.PI/2,A,!1);return[d,h,o,p,_a(o,u,Math.PI/2,A,!0)]}catch(t){console.log(t)}}getArrowBodyPoints(t,e,i,n){const r=ua(t),o=ha(t)*n,s=(o-ca(e,i))/2;let[a,A,l]=[0,[],[]];for(let e=1;e<t.length-1;e++){const i=ma(t[e-1],t[e],t[e+1])/2;a+=ca(t[e-1],t[e]);const n=(o/2-a/r*s)/Math.sin(i),c=_a(t[e-1],t[e],Math.PI-i,n,!0),u=_a(t[e-1],t[e],i,n,!1);A.push(c),l.push(u)}return A.concat(l)}updateDraggingPoint(t,e){this.points[e]=t;const i=this.createGraphic(this.points);this.setGeometryPoints(i),this.drawPolygon()}}class La extends Ta{constructor(t,e,i){super(t,e,i),this.points=[],this.cesium=t,this.headHeightFactor=.18,this.headWidthFactor=.3,this.neckHeightFactor=.85,this.neckWidthFactor=.15,this.tailWidthFactor=.1,this.minPointsForShape=2,this._completePointSize=-1}addPoint(t){this.points.push(t),this.points.length<2?this.onMouseMove():this.points.length>2&&this.lineEntity&&this.CesiumViewer.entities.remove(this.lineEntity)}updateMovingPoint(t){const e=[...this.points,t];if(this.setGeometryPoints(e),!(e.length<2)){const t=this.createGraphic(e);this.setGeometryPoints(t),this.drawPolygon()}}createGraphic(t){const e=t.map(t=>this.cartesianToLnglat(t)),i=this.getTailPoints(e),n=this.getArrowHeadPoints(e,i[0],i[1]),r=n[0],o=n[4],s=this.getArrowBodyPoints(e,r,o,this.tailWidthFactor),a=s.length;let A=[i[0]].concat(s.slice(0,a/2));A.push(r);let l=[i[1]].concat(s.slice(a/2,a));l.push(o),A=Ia(A),l=Ia(l);const c=A.concat(n,l.reverse()),u=[].concat(...c);return this.cesium.Cartesian3.fromDegreesArray(u)}getTailPoints(t){const e=ha(t)*this.tailWidthFactor;return[_a(t[1],t[0],Math.PI/2,e,!1),_a(t[1],t[0],Math.PI/2,e,!0)]}}class Ma extends Oa{constructor(t,e,i){super(t,e,i)}drawLine(t){if(!this.lineBodyEntity){const e=this.style;if(!1===t){if(e.material&&e.material.image)e.material.color.alpha=0;else if(e.material.dashLength){const t=e.material.color.getValue();t.alpha=0,e.material.color.setValue(t)}else e.material.alpha=0;this.isHidden=!0}this.lineBodyEntity=this.CesiumViewer.entities.add({polyline:{positions:new this.cesium.CallbackProperty(()=>this.lineArrowPoints.bodyPoints,!1),width:e.lineWidth,material:e.material,clampToGround:!0,zIndex:this.zIndex}}),this.lineArrowEntity=this.CesiumViewer.entities.add({polyline:{positions:new this.cesium.CallbackProperty(()=>this.lineArrowPoints.arrowPoints,!1),width:e.lineWidth,material:e.material,clampToGround:!0,zIndex:this.zIndex}})}}setGeometryPoints(t){this.lineArrowPoints=t}startEdit(){return"animating"===this.state?"animating":"edit"!==this.state&&(this.onRightClick(),this.setState("edit"),this.addControlPoints(),this.draggable(),this.onTooltipEditEvent(),this.eventDispatcher.dispatchEvent("editStart"),"success")}finishEdit(){if("edit"!=this.state)return;this.setState("static"),this.removeControlPoints();const t=this.getPoints().map(t=>this.cartesianToLnglat(t));this.removeRightClickListener(),this.disableDrag(),this.removeTooltipEditListener(),this.eventDispatcher.dispatchEvent("drawEnd",{lnglatPoints:t})}finishDrawing(){if(this.removeClickListener(),this.removeMoveListener(),this.removeDoubleClickListener(),this.setState("static"),this._tooltip.setVisible(!1),this.removeTooltipDrawListener(),this.lineBodyEntity){this.bodyId=this.lineBodyEntity.id,this.arrowId=this.lineArrowEntity.id,this._id=this.bodyId,this.viewer.viewer.layerCache.add(this);const t=this.getPoints().map(t=>this.cartesianToLnglat(t));this.lineBodyEntity&&this.lineBodyEntity.polyline.setStatic(),this.lineArrowEntity&&this.lineArrowEntity.polyline.setStatic(),this.eventDispatcher.dispatchEvent("drawEnd",{lnglatPoints:t})}}draggable(){let t,e=!1;this.dragEventHandler=new this.cesium.ScreenSpaceEventHandler(this.CesiumViewer.canvas),this.dragEventHandler.setInputAction(i=>{const n=this.CesiumViewer.scene.camera.getPickRay(i.position);if(n){const r=this.CesiumViewer.scene.globe.pick(n,this.CesiumViewer.scene),o=this.CesiumViewer.scene.pick(i.position);if(f.defined(o)&&o.id instanceof f.Entity){const i=o.id;i.id!=this.bodyId&&i.id!=this.arrowId||(e=!0,t=r,this.CesiumViewer.scene.screenSpaceCameraController.enableRotate=!1)}}},f.ScreenSpaceEventType.LEFT_DOWN),this.dragEventHandler.setInputAction(i=>{if(e&&t){const e=this.pixelToCartesian(i.endPosition);if(e){const i=f.Cartesian3.subtract(e,t,new f.Cartesian3),n=this.lineArrowPoints.bodyPoints.map(t=>f.Cartesian3.add(t,i,new f.Cartesian3)),r=this.lineArrowPoints.arrowPoints.map(t=>f.Cartesian3.add(t,i,new f.Cartesian3));this.points=this.points.map(t=>f.Cartesian3.add(t,i,new f.Cartesian3)),this.controlPoints.map(t=>{var e,n;const r=null===(e=t.position)||void 0===e?void 0:e.getValue(f.JulianDate.now()),o=f.Cartesian3.add(r,i,new f.Cartesian3);null===(n=t.position)||void 0===n||n.setValue(o)}),this.setGeometryPoints({bodyPoints:n,arrowPoints:r}),t=e}}},f.ScreenSpaceEventType.MOUSE_MOVE),this.dragEventHandler.setInputAction(()=>{e=!1,t=void 0,this.CesiumViewer.scene.screenSpaceCameraController.enableRotate=!0},f.ScreenSpaceEventType.LEFT_UP)}remove(){this.CesiumViewer.entities.remove(this.lineBodyEntity),this.CesiumViewer.entities.remove(this.lineArrowEntity),this.lineBodyEntity=null,this.lineArrowEntity=null,this.removeClickListener(),this.removeRightClickListener(),this.removeMoveListener(),this.removeDoubleClickListener(),this.removeControlPoints()}showAnimation(t=1e3,e=0,i){var n,r;if("static"!=this.state)return;this.isHidden=!1;const o=this.styleCache.material;let s=1;if(o.image)s=o.color.alpha;else if(o.dashLength){s=o.color.getValue().alpha}else s=null===(r=null===(n=this.styleCache)||void 0===n?void 0:n.material)||void 0===r?void 0:r.alpha;this.animateOpacity(this.lineBodyEntity,s,t,e,i,this.state),this.animateOpacity(this.lineArrowEntity,s,t,e,void 0,this.state),0!=t&&this.setState("animating")}hideAnimation(t=1e3,e=0,i){"static"==this.state&&(this.animateOpacity(this.lineBodyEntity,0,t,e,i,this.state),this.animateOpacity(this.lineArrowEntity,0,t,e,void 0,this.state),0!=t&&this.setState("animating"))}setState(t){this.state=t,"static"===t?(this.lineBodyEntity&&this.lineBodyEntity.polyline.setStatic(),this.lineArrowEntity&&this.lineArrowEntity.polyline.setStatic()):(this.lineBodyEntity&&this.lineBodyEntity.polyline.setDynamic(),this.lineArrowEntity&&this.lineArrowEntity.polyline.setDynamic())}editPropertyById(t){const e=this.getState(),i=Object(g.cloneDeep)(t);this.styleCache=Object(g.merge)(this.styleCache,i),this.setState("drawing"),t.material&&(this.lineBodyEntity.polyline.material=t.material),t.material&&(this.lineArrowEntity.polyline.material=t.material),t.lineWidth&&(this.lineBodyEntity.polyline.width=t.lineWidth),t.lineWidth&&(this.lineArrowEntity.polyline.width=t.lineWidth),requestAnimationFrame(()=>{this.setState(e)})}}var Ua={FineArrow:Pa,AttackArrow:Ta,SwallowtailAttackArrow:class extends Ta{constructor(t,e,i){super(t,e,i),this.points=[],this.cesium=t,this.headHeightFactor=.18,this.headWidthFactor=.3,this.neckHeightFactor=.85,this.neckWidthFactor=.15,this.tailWidthFactor=.1,this.headTailFactor=.8,this.swallowTailFactor=1,this.swallowTailPnt=[0,0],this.minPointsForShape=3,this._completePointSize=-1}createGraphic(t){const e=t.map(t=>this.cartesianToLnglat(t));let[i,n]=[e[0],e[1]];ya(e[0],e[1],e[2])&&(i=e[1],n=e[0]);const r=[pa(i,n)].concat(e.slice(2)),o=this.getArrowHeadPoints(r,i,n),[s,a]=[o[0],o[4]],A=ca(i,n),l=ha(r),c=l*this.tailWidthFactor*this.swallowTailFactor;this.swallowTailPnt=_a(r[1],r[0],0,c,!0);const u=A/l,h=this.getArrowBodyPoints(r,s,a,u),p=h.length;let d=[i].concat(h.slice(0,p/2));d.push(s);let f=[n].concat(h.slice(p/2,p));f.push(a),d=Ia(d),f=Ia(f);const g=d.concat(o,f.reverse(),[this.swallowTailPnt,d[0]]),m=[].concat(...g);return this.cesium.Cartesian3.fromDegreesArray(m)}},SquadCombat:La,SwallowtailSquadCombat:class extends La{constructor(t,e,i){super(t,e,i),this.points=[],this.cesium=t,this.headHeightFactor=.18,this.headWidthFactor=.3,this.neckHeightFactor=.85,this.neckWidthFactor=.15,this.tailWidthFactor=.1,this.swallowTailFactor=1,this.minPointsForShape=2,this._completePointSize=-1}createGraphic(t){const e=t.map(t=>this.cartesianToLnglat(t)),i=this.getTailPoints(e),n=this.getArrowHeadPoints(e,i[0],i[2]),r=n[0],o=n[4],s=this.getArrowBodyPoints(e,r,o,this.tailWidthFactor),a=s.length;let A=[i[0]].concat(s.slice(0,a/2));A.push(r);let l=[i[2]].concat(s.slice(a/2,a));l.push(o),A=Ia(A),l=Ia(l);const c=A.concat(n,l.reverse(),[i[1],A[0]]),u=[].concat(...c);return this.cesium.Cartesian3.fromDegreesArray(u)}getTailPoints(t){const e=ha(t)*this.tailWidthFactor,i=_a(t[1],t[0],Math.PI/2,e,!1),n=_a(t[1],t[0],Math.PI/2,e,!0),r=e*this.swallowTailFactor;return[i,_a(t[1],t[0],0,r,!0),n]}},StraightArrow:class extends Ma{constructor(t,e,i){super(t,e,i),this.points=[],this.arrowLengthScale=5,this.maxArrowLength=3e6,this.cesium=t,this.minPointsForShape=2,this._completePointSize=2,this.setState("drawing")}getType(){return"line"}addPoint(t){if(this.points.length<2&&(this.points.push(t),this.onMouseMove()),2===this.points.length){const t=this.createGraphic(this.points);this.setGeometryPoints(t),this.drawLine(),this.finishDrawing()}}updateMovingPoint(t){const e=[...this.points,t],i=this.createGraphic(e);this.setGeometryPoints(i),this.drawLine()}updateDraggingPoint(t,e){this.points[e]=t;const i=this.createGraphic(this.points);this.setGeometryPoints(i),this.drawLine()}createGraphic(t){const[e,i]=t.map(this.cartesianToLnglat);let n=ca(e,i)/this.arrowLengthScale;n=n>this.maxArrowLength?this.maxArrowLength:n;const r=_a(e,i,Math.PI/6,n/2,!1),o=_a(e,i,Math.PI/6,n/2,!0),s=[...e,...i],a=[...r,...i,...o];return{bodyPoints:this.cesium.Cartesian3.fromDegreesArray(s),arrowPoints:this.cesium.Cartesian3.fromDegreesArray(a)}}getPoints(){return this.points}},CurvedArrow:class extends Ma{constructor(t,e,i){super(t,e,i),this.points=[],this.arrowLengthScale=5,this.maxArrowLength=3e6,this.cesium=t,this.t=.3,this.minPointsForShape=2,this._completePointSize=-1,this.setState("drawing"),this.onDoubleClick()}getType(){return"line"}addPoint(t){this.points.push(t),this.points.length<2&&this.onMouseMove()}updateMovingPoint(t){const e=[...this.points,t];let i=this.createGraphic(e);this.setGeometryPoints(i),this.drawLine()}createStraightArrow(t){const[e,i]=t.map(this.cartesianToLnglat);let n=ca(e,i)/this.arrowLengthScale;n=n>this.maxArrowLength?this.maxArrowLength:n;const r=_a(e,i,Math.PI/6,n/2,!1),o=_a(e,i,Math.PI/6,n/2,!0),s=[...e,...i],a=[...r,...i,...o];return{bodyPoints:this.cesium.Cartesian3.fromDegreesArray(s),arrowPoints:this.cesium.Cartesian3.fromDegreesArray(a)}}updateDraggingPoint(t,e){this.points[e]=t;const i=this.createGraphic(this.points);this.setGeometryPoints(i),this.drawLine()}createGraphic(t){const e=t.map(t=>this.cartesianToLnglat(t));if(2===t.length)return this.createStraightArrow(t);const i=ba(this.t,e),n=e[e.length-2],r=e[e.length-1];let o=ua(e)/this.arrowLengthScale;o=o>this.maxArrowLength?this.maxArrowLength:o;const s=_a(n,r,Math.PI/6,o/2,!1),a=_a(n,r,Math.PI/6,o/2,!0),A=[...[].concat(...i)],l=[...s,...r,...a];return{bodyPoints:this.cesium.Cartesian3.fromDegreesArray(A),arrowPoints:this.cesium.Cartesian3.fromDegreesArray(l)}}getPoints(){return this.points}},AssaultDirection:class extends Pa{constructor(t,e,i){super(t,e,i),this.points=[],this.arrowLengthScale=5,this.maxArrowLength=2,this.cesium=t,this.tailWidthFactor=.08,this.neckWidthFactor=.1,this.headWidthFactor=.13,this.headAngle=Math.PI/4,this.neckAngle=.17741*Math.PI,this.minPointsForShape=2,this._completePointSize=2,this.setState("drawing")}createGraphic(t){const[e,i]=t.map(this.cartesianToLnglat),n=1.5*ha([e,i]),r=n*this.tailWidthFactor,o=n*this.neckWidthFactor,s=n*this.headWidthFactor,a=_a(i,e,Math.PI/2,r,!0),A=_a(i,e,Math.PI/2,r,!1),l=_a(e,i,this.headAngle,s,!1),c=_a(e,i,this.headAngle,s,!0),u=_a(e,i,this.neckAngle,o,!1),h=_a(e,i,this.neckAngle,o,!0),p=[...a,...u,...l,...i,...c,...h,...A,...e];return this.cesium.Cartesian3.fromDegreesArray(p)}},DoubleArrow:class extends Oa{constructor(t,e,i){super(t,e,i),this.points=[],this.arrowLengthScale=5,this.maxArrowLength=2,this.cesium=t,this.headHeightFactor=.25,this.headWidthFactor=.3,this.neckHeightFactor=.85,this.neckWidthFactor=.15,this.connPoint=[0,0],this.tempPoint4=[0,0],this.minPointsForShape=4,this._completePointSize=4,this.setState("drawing")}getType(){return"polygon"}addPoint(t){this.points.push(t),this.points.length<2?this.onMouseMove():2===this.points.length?(this.setGeometryPoints(this.points),this.drawPolygon()):3===this.points.length?this.lineEntity&&this.CesiumViewer.entities.remove(this.lineEntity):(this.finishDrawing(),this.curveControlPointLeft=this.cesium.Cartesian3.fromDegrees(this.llBodyPnts[2][0],this.llBodyPnts[2][1]),this.curveControlPointRight=this.cesium.Cartesian3.fromDegrees(this.rrBodyPnts[1][0],this.rrBodyPnts[1][1]))}updateMovingPoint(t){const e=[...this.points,t];if(this.setGeometryPoints(e),2===e.length)this.addFirstLineOfTheArrow();else if(e.length>2){const t=this.createGraphic(e);this.setGeometryPoints(t),this.drawPolygon()}}updateDraggingPoint(t,e){this.points[e]=t;const i=this.createGraphic(this.points);this.setGeometryPoints(i),this.drawPolygon()}createGraphic(t){const e=t.map(t=>this.cartesianToLnglat(t)),[i,n,r]=[e[0],e[1],e[2]],o=e.length;let s,a;3===o?(this.tempPoint4=this.getTempPoint4(i,n,r),this.connPoint=pa(i,n)):4===o?(this.tempPoint4=e[3],this.connPoint=pa(i,n)):(this.tempPoint4=e[3],this.connPoint=e[4]),this.isClockWise=ya(i,n,r),this.isClockWise?(s=this.getArrowPoints(i,this.connPoint,this.tempPoint4,!1),a=this.getArrowPoints(this.connPoint,n,r,!0)):(s=this.getArrowPoints(n,this.connPoint,r,!1),a=this.getArrowPoints(this.connPoint,i,this.tempPoint4,!0));const A=s.length,l=(A-5)/2,c=s.slice(0,l),u=s.slice(l,l+5);let h=s.slice(l+5,A);this.llBodyPnts=c;let p=a.slice(0,l);const d=a.slice(l,l+5),f=a.slice(l+5,A);this.rrBodyPnts=f,p=Ea(p);const g=Ea(f.concat(c.slice(1)));h=Ea(h);const m=p.concat(d,g,u,h),y=[].concat(...m);return this.cesium.Cartesian3.fromDegreesArray(y)}getTempPoint4(t,e,i){const n=pa(t,e),r=ca(n,i),o=ma(t,n,i);let s,a,A,l=[0,0];return o<Math.PI/2?(s=r*Math.sin(o),a=r*Math.cos(o),A=_a(t,n,Math.PI/2,s,!1),l=_a(n,A,Math.PI/2,a,!0)):o>=Math.PI/2&&o<Math.PI?(s=r*Math.sin(Math.PI-o),a=r*Math.cos(Math.PI-o),A=_a(t,n,Math.PI/2,s,!1),l=_a(n,A,Math.PI/2,a,!1)):o>=Math.PI&&o<1.5*Math.PI?(s=r*Math.sin(o-Math.PI),a=r*Math.cos(o-Math.PI),A=_a(t,n,Math.PI/2,s,!0),l=_a(n,A,Math.PI/2,a,!0)):(s=r*Math.sin(2*Math.PI-o),a=r*Math.cos(2*Math.PI-o),A=_a(t,n,Math.PI/2,s,!0),l=_a(n,A,Math.PI/2,a,!1)),l}getArrowPoints(t,e,i,n){const r=pa(t,e),o=ca(r,i);let s=_a(i,r,0,.3*o,!0),a=_a(i,r,0,.5*o,!0);s=_a(r,s,Math.PI/2,o/5,n),a=_a(r,a,Math.PI/2,o/4,n);const A=[r,s,a,i],l=this.getArrowHeadPoints(A);if(!(l&&Array.isArray(l)&&l.length>0))throw new Error("Interpolation Error");{const i=l[0],n=l[4],r=ca(t,e)/ha(A)/2,o=this.getArrowBodyPoints(A,i,n,r);if(o){const r=o.length;let s=o.slice(0,r/2),a=o.slice(r/2,r);return s.push(i),a.push(n),s=s.reverse(),s.push(e),a=a.reverse(),a.push(t),s.reverse().concat(l,a)}}}getArrowBodyPoints(t,e,i,n){const r=ua(t),o=ha(t)*n,s=(o-ca(e,i))/2;let a=0,A=[],l=[];for(let e=1;e<t.length-1;e++){const i=ma(t[e-1],t[e],t[e+1])/2;a+=ca(t[e-1],t[e]);const n=(o/2-a/r*s)/Math.sin(i),c=_a(t[e-1],t[e],Math.PI-i,n,!0),u=_a(t[e-1],t[e],i,n,!1);A.push(c),l.push(u)}return A.concat(l)}getArrowHeadPoints(t){const e=ha(t)*this.headHeightFactor,i=t[t.length-1],n=e*this.headWidthFactor,r=e*this.neckWidthFactor,o=e*this.neckHeightFactor,s=_a(t[t.length-2],i,0,e,!0),a=_a(t[t.length-2],i,0,o,!0),A=_a(i,s,Math.PI/2,n,!1),l=_a(i,s,Math.PI/2,n,!0);return[_a(i,a,Math.PI/2,r,!1),A,i,l,_a(i,a,Math.PI/2,r,!0)]}getPoints(){return this.points}getBezierControlPointforGrowthAnimation(){return this.isClockWise?{left:this.curveControlPointLeft,right:this.curveControlPointRight}:{right:this.curveControlPointLeft,left:this.curveControlPointRight}}},FreehandLine:class extends Oa{constructor(t,e,i){super(t,e,i),this.points=[],this.cesium=t,this.freehand=!0,this._completePointSize=2,this.setState("drawing")}getType(){return"line"}addPoint(t){this.points.push(t),this.points.length<2?this.onMouseMove():this.finishDrawing()}updateMovingPoint(t){this.points.push(t),this.setGeometryPoints(this.points),this.drawLine()}updateDraggingPoint(t,e){this.points[e]=t,this.setGeometryPoints(this.points),this.drawLine()}createGraphic(){return this.points}getPoints(){return this.points}},FreehandPolygon:class extends Oa{constructor(t,e,i){super(t,e,i),this.points=[],this.cesium=t,this.freehand=!0,this._completePointSize=2,this.setState("drawing")}getType(){return"polygon"}addPoint(t){this.points.push(t),1===this.points.length?this.onMouseMove():this.points.length>2&&this.finishDrawing()}updateMovingPoint(t){this.points.push(t),this.points.length>2&&(this.setGeometryPoints(this.points),this.drawPolygon())}createGraphic(){return this.points}updateDraggingPoint(t,e){this.points[e]=t,this.setGeometryPoints(this.points),this.drawPolygon()}getPoints(){return this.points}},Curve:class extends Oa{constructor(t,e,i){super(t,e,i),this.points=[],this.arrowLengthScale=5,this.maxArrowLength=3e6,this.cesium=t,this.t=.3,this._completePointSize=-1,this.setState("drawing"),this.onDoubleClick()}getType(){return"line"}addPoint(t){this.points.push(t),this.points.length<2?this.onMouseMove():2===this.points.length&&(this.setGeometryPoints(this.points),this.drawLine())}updateMovingPoint(t){const e=[...this.points,t];let i=[];2===e.length?(this.setGeometryPoints(e),this.drawLine()):(i=this.createGraphic(e),this.setGeometryPoints(i))}updateDraggingPoint(t,e){this.points[e]=t;const i=this.createGraphic(this.points);this.setGeometryPoints(i),this.drawLine()}createGraphic(t){const e=t.map(t=>this.cartesianToLnglat(t)),i=ba(this.t,e),n=[].concat(...i);return this.cesium.Cartesian3.fromDegreesArray(n)}getPoints(){return this.points}},Ellipse:class extends Oa{constructor(t,e,i){super(t,e,i),this.points=[],this.cesium=t,this.freehand=!0,this._completePointSize=2,this.setState("drawing")}getType(){return"polygon"}addPoint(t){this.points.push(t),1===this.points.length?this.onMouseMove():this.points.length>1&&this.finishDrawing()}updateMovingPoint(t){const e=[...this.points,t],i=this.createGraphic(e);this.setGeometryPoints(i),this.drawPolygon()}updateDraggingPoint(t,e){this.points[e]=t;const i=this.createGraphic(this.points);this.setGeometryPoints(i),this.drawPolygon()}createGraphic(t){const e=t.map(t=>this.cartesianToLnglat(t)),i=e[0],n=e[1],r=pa(i,n),o=Math.abs((i[0]-n[0])/2),s=Math.abs((i[1]-n[1])/2),a=this.generatePoints(r,o,s),A=[].concat(...a);return this.cesium.Cartesian3.fromDegreesArray(A)}generatePoints(t,e,i){let[n,r,o,s]=[null,null,0,[]];for(let a=0;a<=100;a++)o=2*Math.PI*a/100,n=t[0]+e*Math.cos(o),r=t[1]+i*Math.sin(o),s.push([n,r]);return s}getPoints(){return this.points}},Lune:class extends Oa{constructor(t,e,i){super(t,e,i),this.points=[],this.cesium=t,this.setState("drawing"),this._completePointSize=3}getType(){return"polygon"}addPoint(t){this.points.push(t),1===this.points.length?this.onMouseMove():this.points.length>2&&this.finishDrawing()}updateMovingPoint(t){const e=[...this.points,t],i=this.createGraphic(e);this.setGeometryPoints(i),this.drawPolygon()}updateDraggingPoint(t,e){this.points[e]=t;const i=this.createGraphic(this.points);this.setGeometryPoints(i),this.drawPolygon()}createGraphic(t){3==t.length&&t[1].equals(t[2])&&t.pop();const e=t.map(t=>this.cartesianToLnglat(t));if(2===e.length){const t=pa(e[0],e[1]),i=ca(e[0],t),n=_a(e[0],t,Math.PI/2,i,!1);e.push(n)}let[i,n,r,o,s]=[e[0],e[1],e[2],void 0,void 0];const a=da(i,n,r),A=ca(i,a),l=ga(i,a),c=ga(n,a);ya(i,n,r)?(o=c,s=l):(o=l,s=c);let u=wa(a,A,o,s);const h=[].concat(...u);return this.cesium.Cartesian3.fromDegreesArray(h)}getPoints(){return this.points}},Sector:class extends Oa{constructor(t,e,i){super(t,e,i),this.points=[],this.cesium=t,this.headHeightFactor=.18,this.headWidthFactor=.3,this.neckHeightFactor=.85,this.neckWidthFactor=.15,this.headTailFactor=.8,this._completePointSize=3,this.setState("drawing")}getType(){return"polygon"}addPoint(t){this.points.push(t),this.points.length<2?this.onMouseMove():2===this.points.length?(this.setGeometryPoints(this.points),this.drawPolygon()):(this.lineEntity&&this.CesiumViewer.entities.remove(this.lineEntity),this.finishDrawing())}updateMovingPoint(t){const e=[...this.points,t];if(this.setGeometryPoints(e),2===e.length)this.addFirstLineOfTheArrow();else{const t=this.createGraphic(e);this.setGeometryPoints(t),this.drawPolygon()}}createGraphic(t){const e=t.map(t=>this.cartesianToLnglat(t)),[i,n,r]=[e[0],e[1],e[2]],o=ca(n,i),s=ga(n,i),a=ga(r,i),A=wa(i,o,s,a);A.push(i,A[0]);const l=[].concat(...A);return this.cesium.Cartesian3.fromDegreesArray(l)}getPoints(){return this.points}updateDraggingPoint(t,e){this.points[e]=t;const i=this.createGraphic(this.points);this.setGeometryPoints(i),this.drawPolygon()}},Arc:class extends Oa{constructor(t,e,i){super(t,e,i),this.points=[],this.arrowLengthScale=5,this.maxArrowLength=3e6,this.cesium=t,this.t=.3,this._completePointSize=3,this.setState("drawing")}getType(){return"line"}addPoint(t){this.points.push(t),this.points.length<2?this.onMouseMove():this.points.length>2&&this.finishDrawing()}updateMovingPoint(t){const e=[...this.points,t];let i=[];2===e.length?(this.setGeometryPoints(e),this.drawLine()):(i=this.createGraphic(e),this.setGeometryPoints(i))}updateDraggingPoint(t,e){this.points[e]=t;const i=this.createGraphic(this.points);this.setGeometryPoints(i),this.drawLine()}createGraphic(t){const e=t.map(t=>this.cartesianToLnglat(t));let[i,n,r,o,s]=[e[0],e[1],e[2],null,null];const a=da(i,n,r),A=ca(i,a),l=ga(i,a),c=ga(n,a);ya(i,n,r)?(o=c,s=l):(o=l,s=c);const u=wa(a,A,o,s),h=[].concat(...u);return this.cesium.Cartesian3.fromDegreesArray(h)}getPoints(){return this.points}},ClosedCurve:class extends Oa{constructor(t,e,i){super(t,e,i),this.points=[],this.cesium=t,this.setState("drawing"),this._completePointSize=3}getType(){return"polygon"}addPoint(t){this.points.push(t),1===this.points.length?this.onMouseMove():this.points.length>2&&this.finishDrawing()}updateMovingPoint(t){const e=[...this.points,t],i=this.createGraphic(e);this.setGeometryPoints(i),this.drawPolygon()}updateDraggingPoint(t,e){this.points[e]=t;const i=this.createGraphic(this.points);this.setGeometryPoints(i),this.drawPolygon()}createGraphic(t){let e=t.map(t=>this.cartesianToLnglat(t));if(2===e.length){const t=pa(e[0],e[1]),i=ca(e[0],t)/.9,n=_a(e[0],t,Math.PI/2,i,!0);e=[e[0],n,e[1]]}const i=pa(e[0],e[2]);e.push(i,e[0],e[1]);let[n,r,o,s]=[[],void 0,void 0,void 0];const a=[];for(let t=0;t<e.length-2;t++){r=e[t],o=e[t+1],s=e[t+2];const i=Ca(.4,r,o,s);n=n.concat(i)}const A=n.length;n=[n[A-1]].concat(n.slice(0,A-1));for(let t=0;t<e.length-2;t++){r=e[t],o=e[t+1],a.push(r);for(let e=0;e<=100;e++){const i=va(e/100,r,n[2*t],n[2*t+1],o);a.push(i)}a.push(o)}const l=[].concat(...a);return this.cesium.Cartesian3.fromDegreesArray(l)}getPoints(){return this.points}}},Da=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},Qa=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let Ra=class{constructor(t){this._drawInstance=new sa(t),this.cesium=ea(),this.viewer=t.viewer,this.plotCollection={}}drawPoint(t){this._drawInstance.create(t,1)}drawPolyline(t){this._drawInstance.create(t,2)}drawPolygon(t){this._drawInstance.create(t,3)}drawRectangle(t){this._drawInstance.create(t,4)}drawArrow(t){this._drawInstance.create(t,5)}drawCircular(t){this._drawInstance.create(t,6)}drawSpaceTriangle(t){this._drawInstance.create(t,7)}drawTriangle(t){this._drawInstance.create(t,9)}drawElevationLine(t){this._drawInstance.create(t,8)}drawWall(t){this._drawInstance.create(t,10)}removeById(t){if(t.id.indexOf("plot")>-1){const e=this.plotCollection[t.id];if(!e)return void console.warn("The provided ID does not exist.");e.remove(),delete this.plotCollection[t.id],t.ended&&t.ended()}else this._drawInstance.removeById(t)}removeAll(){this._drawInstance.removeAll();for(const t in this.plotCollection){this.plotCollection[t].remove()}this.plotCollection={}}editById(t){if(t.id.indexOf("plot")>-1){const e=this.plotCollection[t.id];if(!e)return void console.warn("The provided ID does not exist.");const i=e.startEdit();let n;if(t.updateEndCallback)if("success"===i){const i=r=>{e.off("drawEnd",i),n&&e.off("editUpdate",n),t.updateEndCallback({status:10,data:{id:t.id,coordinates:r.lnglatPoints}})};e.on("drawEnd",i)}else{if(!1===i)return;At("c070101",t.updateEndCallback)}if(t.updateCallback)if("success"===i)n=e=>{t.updateCallback({status:10,data:{id:t.id,coordinates:e.lnglatPoints}})},e.on("editUpdate",n);else{if(!1===i)return;At("c070101",t.updateEndCallback)}}else this._drawInstance.editById(t)}editPropertyById(t){if(t.id.indexOf("plot")>-1){const e=this.plotCollection[t.id];if(!e)return void console.warn("The provided ID does not exist.");const i=t.property;let n;n="polygon"==e.type?this.convertPolygonStyleWithoutDefault(i):this.convertLineStyleWithoutDefault(i),e.editPropertyById(n)}else this._drawInstance.editPropertyById(t)}cancelDraw(){this.activePlot?this.activePlot.remove():this._drawInstance.cancelDraw()}on(t){if(t.event=gr[t.event],t.id){const e=this.plotCollection[t.id];e&&"plot"===e.graphicType?e.onLayerEvent(t.event,e=>{e.id=t.id,t.handler(e)}):this._drawInstance.on(t)}else{for(let e in this.plotCollection){const i=this.plotCollection[e];i&&"plot"===i.graphicType&&i.onLayerEvent(t.event,i=>{i.id=e,t.handler(i)})}this._drawInstance.on(t)}}off(t){if(t.event=gr[t.event],t.id){const e=this.plotCollection[t.id];e&&"plot"===e.graphicType?e.offLayerEvent(t):this._drawInstance.off(t)}else{for(let e in this.plotCollection){const i=this.plotCollection[e];i&&"plot"===i.graphicType&&i.offLayerEvent(t)}this._drawInstance.off(t)}}drawFineArrow(t){this.drawPolygonBase(t,"FineArrow")}drawStraightArrow(t){this.drawLineBase(t,"StraightArrow")}drawCurvedArrow(t){this.drawLineBase(t,"CurvedArrow")}drawAttackArrow(t){this.drawPolygonBase(t,"AttackArrow")}drawSwallowtailAttackArrow(t){this.drawPolygonBase(t,"SwallowtailAttackArrow")}drawSquadCombat(t){this.drawPolygonBase(t,"SquadCombat")}drawSwallowtailSquadCombat(t){this.drawPolygonBase(t,"SwallowtailSquadCombat")}drawAssaultDirection(t){this.drawPolygonBase(t,"AssaultDirection")}drawDoubleArrow(t){this.drawPolygonBase(t,"DoubleArrow")}drawFreehandLine(t){this.drawLineBase(t,"FreehandLine")}drawFreehandPolygon(t){this.drawPolygonBase(t,"FreehandPolygon")}drawCurve(t){this.drawLineBase(t,"Curve")}drawEllipse(t){this.drawPolygonBase(t,"Ellipse")}drawLune(t){this.drawPolygonBase(t,"Lune")}drawSector(t){this.drawPolygonBase(t,"Sector")}drawArc(t){this.drawLineBase(t,"Arc")}drawClosedCurve(t){this.drawPolygonBase(t,"ClosedCurve")}convertPolygonStyle(t){let e=this.cesium.Color.fromCssColorString(t.outlineColor||"rgba(59,178,208,1.0)");t.dashedOutline&&(e=new this.cesium.PolylineDashMaterialProperty({color:this.cesium.Color.fromCssColorString(t.outlineColor||"rgba(59,178,208,1.0)"),dashLength:t.dashLength||16}));let i=this.cesium.Color.fromCssColorString(t.fillColor||"rgba(59,178,208,0.3)");if(t.texture){const e=t.textureRepeat||[20,20];i=new this.cesium.ImageMaterialProperty({image:t.texture,repeat:new this.cesium.Cartesian2(e[0],e[1]),color:this.cesium.Color.fromCssColorString("rgba(255,255,255,1.0)")})}return{material:i,outlineMaterial:e,outlineWidth:t.outlineWidth||2}}convertPolygonStyleWithoutDefault(t){const e={};if(t.outlineColor){let i=this.cesium.Color.fromCssColorString(t.outlineColor);e.outlineMaterial=i}return t.dashedOutline&&(e.outlineMaterial=new this.cesium.PolylineDashMaterialProperty({color:this.cesium.Color.fromCssColorString(t.outlineColor||"rgba(59,178,208,1.0)"),dashLength:t.dashLength||16})),t.fillColor&&(e.material=this.cesium.Color.fromCssColorString(t.fillColor)),t.outlineWidth&&(e.outlineWidth=t.outlineWidth),e}convertLineStyle(t){let e=this.cesium.Color.fromCssColorString(t.lineColor||"rgba(59,178,208,0.8)");if(t.texture){const i=t.textureRepeat||20;e=new $n({image:t.texture,color:this.cesium.Color.fromCssColorString("rgba(255,255,255,1.0)"),repeat:i,speed:0,brightness:1,alpha:1,axisY:!1,reverse:!1})}else t.dashedLine&&(e=new this.cesium.PolylineDashMaterialProperty({color:this.cesium.Color.fromCssColorString(t.lineColor||"rgba(59,178,208,0.8)"),dashLength:t.dashLength||16}));return{material:e,lineWidth:t.lineWidth||2}}convertLineStyleWithoutDefault(t){let e;if(t.texture){const i=t.textureRepeat||20;e=new $n({image:t.texture,color:this.cesium.Color.fromCssColorString("rgba(255,255,255,1.0)"),repeat:i,speed:0,brightness:1,alpha:1,axisY:!1,reverse:!1})}else t.dashedLine&&(e=new this.cesium.PolylineDashMaterialProperty({color:this.cesium.Color.fromCssColorString(t.lineColor||"rgba(59,178,208,0.8)"),dashLength:t.dashLength||16}));if(t.lineColor){const i=this.cesium.Color.fromCssColorString(t.lineColor);e&&e.dashLength?e.color.setValue(i):e=i}const i={};return e&&(i.material=e),t.lineWidth&&(i.lineWidth=t.lineWidth),i}drawPolygonBase(t,e){const{fillColor:i,outlineColor:n,outlineWidth:r,dashedOutline:o,dashLength:s,texture:a,textureRepeat:A}=t,l=this.convertPolygonStyle({fillColor:i,outlineColor:n,outlineWidth:r,dashedOutline:o,dashLength:s,texture:a,textureRepeat:A});this.drawPlot(e,l,t.callback)}drawLineBase(t,e){const{lineColor:i,lineWidth:n,dashedLine:r,dashLength:o,texture:s,textureRepeat:a}=t,A=this.convertLineStyle({lineColor:i,lineWidth:n,dashedLine:r,dashLength:o,texture:s,textureRepeat:a});this.drawPlot(e,A,t.callback)}drawPlot(t,e,i){this.activePlot&&this.activePlot.remove(),this.activePlot=new Ua[t](this.cesium,this.viewer,e);const n=$("plot");this.plotCollection[n]=this.activePlot,this._drawEndHandler=t=>{this.activePlot.off("drawEnd",this._drawEndHandler),this.activePlot=null;const e={id:n,coordinates:t.lnglatPoints};i&&i({status:10,data:e})},this.activePlot.on("drawEnd",this._drawEndHandler)}hide(t){if(t.id.indexOf("plot")>-1){const e=this.plotCollection[t.id];if(!e)return void console.warn("The provided ID does not exist.");if(t.animation){const i=t.animation;e.hideAnimation(i.duration,i.delay,i.callback)}else e.hideAnimation(0,0)}else this._drawInstance.hide(t)}show(t){if(t.id.indexOf("plot")>-1){const e=this.plotCollection[t.id];if(!e)return void console.warn("The provided ID does not exist.");if(t.animation){const i=t.animation;e.showAnimation(i.duration,i.delay,i.callback)}else e.showAnimation(0,0)}else this._drawInstance.show(t)}growthAnimation(t){const e=this.plotCollection[t.id];e?e.growthAnimation(t.duration,t.delay,t.callback):console.warn("The provided ID does not exist.")}createGraphicByData(t){const{style:e,points:i,type:n,callback:r}=t;if(["Point","Polyline","Polygon","Rectangle","Circular","Triangle","Wall"].includes(n))this._drawInstance.createGraphicByData(t);else{let o;if("Curve"==n||"StraightArrow"==n||"CurvedArrow"==n||"FreehandLine"==n||"Arc"==n){const{lineColor:t,lineWidth:i,dashedLine:n,dashLength:r,texture:s,textureRepeat:a}=e;o=this.convertLineStyle({lineColor:t,lineWidth:i,dashedLine:n,dashLength:r,texture:s,textureRepeat:a})}else{const{fillColor:t,outlineColor:i,outlineWidth:n,dashedOutline:r,dashLength:s,texture:a}=e;o=this.convertPolygonStyle({fillColor:t,outlineColor:i,outlineWidth:n,dashedOutline:r,dashLength:s,texture:a})}let s=new Ua[n](this.cesium,this.viewer,o);const a=$("plot");this.plotCollection[a]=s;const A=t=>{s.off("drawEnd",A),s=null;const e={id:a,coordinates:t.lnglatPoints};r&&r({status:10,data:e})};s.on("drawEnd",A),s.createGraphicByData(i,t.show)}}finishEdit(t){if(t.id.indexOf("plot")>-1){const e=this.plotCollection[t.id];if(!e)return void console.warn("The provided ID does not exist.");e.finishEdit(e=>{const i={id:t.id,coordinates:e.lnglatPoints};t.callback&&t.callback({status:10,data:i})})}else this._drawInstance.finishEdit(t)}};Da([R(Aa.drawPoint),Qa("design:type",Function),Qa("design:paramtypes",[Object]),Qa("design:returntype",void 0)],Ra.prototype,"drawPoint",null),Da([R(Aa.drawPolyline),Qa("design:type",Function),Qa("design:paramtypes",[Object]),Qa("design:returntype",void 0)],Ra.prototype,"drawPolyline",null),Da([R(Aa.drawPolygon),Qa("design:type",Function),Qa("design:paramtypes",[Object]),Qa("design:returntype",void 0)],Ra.prototype,"drawPolygon",null),Da([R(Aa.drawRectangle),Qa("design:type",Function),Qa("design:paramtypes",[Object]),Qa("design:returntype",void 0)],Ra.prototype,"drawRectangle",null),Da([R(Aa.drawArrow),Qa("design:type",Function),Qa("design:paramtypes",[Object]),Qa("design:returntype",void 0)],Ra.prototype,"drawArrow",null),Da([R(Aa.drawCircular),Qa("design:type",Function),Qa("design:paramtypes",[Object]),Qa("design:returntype",void 0)],Ra.prototype,"drawCircular",null),Da([R(Aa.drawSpaceTriangle),Qa("design:type",Function),Qa("design:paramtypes",[Object]),Qa("design:returntype",void 0)],Ra.prototype,"drawSpaceTriangle",null),Da([R(Aa.drawTriangle),Qa("design:type",Function),Qa("design:paramtypes",[Object]),Qa("design:returntype",void 0)],Ra.prototype,"drawTriangle",null),Da([R(Aa.drawElevationLine),Qa("design:type",Function),Qa("design:paramtypes",[Object]),Qa("design:returntype",void 0)],Ra.prototype,"drawElevationLine",null),Da([R(),Qa("design:type",Function),Qa("design:paramtypes",[Object]),Qa("design:returntype",void 0)],Ra.prototype,"drawWall",null),Da([R(Aa.removeById),Qa("design:type",Function),Qa("design:paramtypes",[Object]),Qa("design:returntype",void 0)],Ra.prototype,"removeById",null),Da([R(Aa.editById),Qa("design:type",Function),Qa("design:paramtypes",[Object]),Qa("design:returntype",void 0)],Ra.prototype,"editById",null),Da([R(),Qa("design:type",Function),Qa("design:paramtypes",[Object]),Qa("design:returntype",void 0)],Ra.prototype,"editPropertyById",null),Da([R(is.on),Qa("design:type",Function),Qa("design:paramtypes",[Object]),Qa("design:returntype",void 0)],Ra.prototype,"on",null),Da([R(is.off),Qa("design:type",Function),Qa("design:paramtypes",[Object]),Qa("design:returntype",void 0)],Ra.prototype,"off",null),Da([R(Aa.plotPolygon),Qa("design:type",Function),Qa("design:paramtypes",[Object]),Qa("design:returntype",void 0)],Ra.prototype,"drawFineArrow",null),Da([R(Aa.plotLine),Qa("design:type",Function),Qa("design:paramtypes",[Object]),Qa("design:returntype",void 0)],Ra.prototype,"drawStraightArrow",null),Da([R(Aa.plotLine),Qa("design:type",Function),Qa("design:paramtypes",[Object]),Qa("design:returntype",void 0)],Ra.prototype,"drawCurvedArrow",null),Da([R(Aa.plotPolygon),Qa("design:type",Function),Qa("design:paramtypes",[Object]),Qa("design:returntype",void 0)],Ra.prototype,"drawAttackArrow",null),Da([R(Aa.plotPolygon),Qa("design:type",Function),Qa("design:paramtypes",[Object]),Qa("design:returntype",void 0)],Ra.prototype,"drawSwallowtailAttackArrow",null),Da([R(Aa.plotPolygon),Qa("design:type",Function),Qa("design:paramtypes",[Object]),Qa("design:returntype",void 0)],Ra.prototype,"drawSquadCombat",null),Da([R(Aa.plotPolygon),Qa("design:type",Function),Qa("design:paramtypes",[Object]),Qa("design:returntype",void 0)],Ra.prototype,"drawSwallowtailSquadCombat",null),Da([R(Aa.plotPolygon),Qa("design:type",Function),Qa("design:paramtypes",[Object]),Qa("design:returntype",void 0)],Ra.prototype,"drawAssaultDirection",null),Da([R(Aa.plotPolygon),Qa("design:type",Function),Qa("design:paramtypes",[Object]),Qa("design:returntype",void 0)],Ra.prototype,"drawDoubleArrow",null),Da([R(Aa.plotLine),Qa("design:type",Function),Qa("design:paramtypes",[Object]),Qa("design:returntype",void 0)],Ra.prototype,"drawFreehandLine",null),Da([R(Aa.plotPolygon),Qa("design:type",Function),Qa("design:paramtypes",[Object]),Qa("design:returntype",void 0)],Ra.prototype,"drawFreehandPolygon",null),Da([R(Aa.plotLine),Qa("design:type",Function),Qa("design:paramtypes",[Object]),Qa("design:returntype",void 0)],Ra.prototype,"drawCurve",null),Da([R(Aa.plotPolygon),Qa("design:type",Function),Qa("design:paramtypes",[Object]),Qa("design:returntype",void 0)],Ra.prototype,"drawEllipse",null),Da([R(Aa.plotPolygon),Qa("design:type",Function),Qa("design:paramtypes",[Object]),Qa("design:returntype",void 0)],Ra.prototype,"drawLune",null),Da([R(Aa.plotPolygon),Qa("design:type",Function),Qa("design:paramtypes",[Object]),Qa("design:returntype",void 0)],Ra.prototype,"drawSector",null),Da([R(Aa.plotLine),Qa("design:type",Function),Qa("design:paramtypes",[Object]),Qa("design:returntype",void 0)],Ra.prototype,"drawArc",null),Da([R(Aa.plotPolygon),Qa("design:type",Function),Qa("design:paramtypes",[Object]),Qa("design:returntype",void 0)],Ra.prototype,"drawClosedCurve",null),Da([R(Aa.showOrHide),Qa("design:type",Function),Qa("design:paramtypes",[Object]),Qa("design:returntype",void 0)],Ra.prototype,"hide",null),Da([R(Aa.showOrHide),Qa("design:type",Function),Qa("design:paramtypes",[Object]),Qa("design:returntype",void 0)],Ra.prototype,"show",null),Da([R(Aa.GrowthAnimationOption),Qa("design:type",Function),Qa("design:paramtypes",[Object]),Qa("design:returntype",void 0)],Ra.prototype,"growthAnimation",null),Ra=Da([H({viewer:{type:k.Object,required:!0},styleName:{type:k.String}}),Qa("design:paramtypes",[Object])],Ra);var Na=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},Ha=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let ka=class{constructor(t){this._measureInstance=new aa(t)}remove(t={}){this._measureInstance.destroy(t)}};Na([R(is.remove),Ha("design:type",Function),Ha("design:paramtypes",[Object]),Ha("design:returntype",void 0)],ka.prototype,"remove",null),ka=Na([H({viewer:{type:k.Object,required:!0},mode:{type:k.String,validator:t=>["distance","area","triangle","height"].indexOf(t)>-1,message:"incorrect mode!"},width:{type:k.Number},color:{type:k.Color},text:{type:k.Object,children:{show:{type:k.Boolean},color:{type:k.Color},font:{type:k.String}}},lineWidth:{type:k.Number},lineColor:{type:k.Color},fillColor:{type:k.Color},callback:{type:k.Function}}),Ha("design:paramtypes",[Object])],ka);class Va{constructor(t){this._layerType="layer",this._id=$("effect"),this._boundingRectangle=[],this._isGlobal=!1,this._data=[],this._options=t,this._layerEvent=new Cr,this._fieldMap=t.fieldMap||[],t.viewer&&(this._userViewer=t.viewer,this.query=new Or({viewer:t.viewer})),this._container=new Z("primitive"),this.init()}init(){}addToViewer(t){const{viewer:e,ended:i}=t;e&&(this._userViewer=e),this._userViewer.viewer.layerCache.add(this),"primitive"==this._container.getType()?this._userViewer.viewer.instance.scene.primitives.add(this._container.getCollection()):"customDataSource"==this._container.getType()&&this._userViewer.viewer.instance.dataSources.add(this._container.getCollection()),this._isGlobal&&this._userViewer.viewer.particleLayer.push(this._id),at(!0,i)}remove(t={}){const{ended:e}=t;if(this._container){if("primitive"==this._container.getType()?this._userViewer.viewer.instance.scene.primitives.remove(this._container.getCollection()):"customDataSource"==this._container.getType()&&this._userViewer.viewer.instance.dataSources.remove(this._container.getCollection()),this._container=null,this._layerEvent=null,this._userViewer.viewer.layerCache.remove(this),this._userViewer.viewer.particleLayer.includes(this._id)){const t=this._userViewer.viewer.particleLayer.indexOf(this._id);this._userViewer.viewer.particleLayer.splice(t,1)}this._data=[],at(!0,e)}}field(t,e,i){const n={field:t,props:e,value:i},r=this._fieldMap.map(t=>`${t.field}-${t.props}`).indexOf(`${t}-${e}`);return r>-1?this._fieldMap.splice(r,1,n):this._fieldMap.push(n),this}mapProps(t){return this._fieldMap.find(e=>e.props===t)}get fieldMap(){return this._fieldMap}show(){this._container&&this._container.show()}hide(){this._container&&this._container.hide()}on(t){const{event:e,handler:i}=t;this._layerEvent.on(e,i,this)}off(t){const{event:e}=t;this._layerEvent.off(e,this)}makeBounding(t){let e=[];t.forEach(t=>{if(t.polyline)t.polyline.forEach(t=>{e.push([t[0],t[1]])});else if(t.positions)t.positions.forEach(t=>{e.push([t[0],t[1]])});else if(t.polygon)if(Array.isArray(t.polygon[0]))t.polygon.forEach(t=>{e.push([t[0],t[1]])});else{Object(g.chunk)(t.polygon,3).forEach(t=>{e.push([t[0],t[1]])})}else e.push([t.lng,t.lat])}),1===e.length&&Wn.pointToRectangle({point:e[0],radius:3,callback:t=>{let e=t.data.geometry.coordinates[0];this._boundingRectangle=[[e[0][0],e[2][1]],[e[1][0],e[0][1]]]}}),e.length>1&&Wn.getBboxOfPoints({points:e,callback:t=>{let e=t.data.geometry.coordinates[0];this._boundingRectangle=[[e[0][0],e[2][1]],[e[1][0],e[0][1]]]}})}}class ja extends Va{constructor(t){super(t),this._i=0,this._speed=1}setData(t,e){this._container.size>0&&this._container.removeAll(),this.timer=this._userViewer.viewer.instance.clock.onTick.addEventListener(this.camera_changedHandler,this);for(const e of t){let t=Object.assign({},this._options);const i=this.fieldMap.map(t=>t.props);for(let n of i){const i=this.fieldMap.find(t=>t.props===n);let r=(i||{}).value(e[i.field]);t[n]=r}t=Object.assign(Object.assign({},t),e),this._handlerData(t),this.camera_changedHandler()}at(!0,e)}setSource(t){if(!this.query)return;const{ended:e}=t;this.query.queryCustomInfo(Object.assign(Object.assign({},t),{callback:t=>{if(t.data&&t.data.total>0){let i=t.data.data.filter(t=>"LineString"==t.geometry.type).map(t=>{let e=t.geometry.coordinates;return Object.assign({polyline:e},t.properties)});this.makeBounding(i),this.setData(i,e)}}}))}init(){this._container=new Z("customDataSource"),this._options.polyline&&this.setData([{polyline:this._options.polyline}])}_handlerData(t){const{lineString:e,polyline:i,width:n,repeat:r=[1,1],url:o,dynamic:s,color:a,speed:A,nearDistance:l=0,farDistance:c=Number.MAX_VALUE}=t;let u=[];(e||i).forEach(t=>{2==t.length?u.push(...t,0):u.push(...t)});let h=f.Cartesian3.fromDegreesArrayHeights(u),p=1e7;h.forEach((t,e)=>{if(e>0){let t=f.Cartesian3.distance(h[e-1],h[e]);p=t>p?p:t}});let d=[];d.push(h[0]),h.forEach((t,e)=>{if(e>0){let t=f.Cartesian3.distance(h[e-1],h[e]),i=f.Cartesian3.subtract(h[e],h[e-1],new f.Cartesian3),n=Math.floor(t/p);if(n>2){let t=f.Cartesian3.divideByScalar(i,n,new f.Cartesian3),r=h[e-1];for(let e=0;e<n;e++)r=f.Cartesian3.add(r,t,new f.Cartesian3),d.push(r)}d.push(h[e])}});let g=new f.Entity({name:this._id,polyline:{positions:d,width:new f.ConstantProperty(n),nearDistance:l,farDistance:c,material:!1===s?new f.ImageMaterialProperty({color:a,image:o,repeat:new f.Cartesian2(...r),transparent:new f.ConstantProperty(!0)}):new Jn({color:a,image:o,repeat:r[0],repeatY:r[1],speed:A||5})}});g.nearDistance=l,g.farDistance=c,this._container.add(g)}remove(t={}){const{ended:e}=t;this._userViewer.viewer.instance.clock.onTick.removeEventListener(this.camera_changedHandler,this),this._container&&("primitive"==this._container.getType()?this._userViewer.viewer.instance.scene.primitives.remove(this._container.getCollection()):"customDataSource"==this._container.getType()&&this._userViewer.viewer.instance.dataSources.remove(this._container.getCollection()),this._container=null,this._layerEvent=null,this._userViewer.viewer.layerCache.remove(this),e&&e(at(!0)))}drawCanvasImage(){let t=document.createElement("canvas");t.width=100,t.height=20;let e=t.getContext("2d"),i=this._img;return this._i<200?(e&&e.clearRect(0,0,100,20),e&&e.drawImage(i,this._i-100,0,100,20)):this._i=0,this._i+=this._speed,t}camera_changedHandler(){let t=this._userViewer.viewer.instance.camera.positionCartographic.height;if(this._container){let e=this._container.getCollection().entities._entities.values;for(const i of e)t>=i.nearDistance&&t<=i.farDistance?i.show=!0:i.show=!1}}}class Ga extends Va{constructor(t){super(t)}init(){this._container=new Z("customDataSource"),this._options.polygon&&this._handlerData(this._options)}setData(t,e){this._container.size>0&&this._container.removeAll();for(const e of t){let t=Object.assign({},this._options);const i=this.fieldMap.map(t=>t.props);for(let n of i){const i=this.fieldMap.find(t=>t.props===n);let r=(i||{}).value(e[i.field]);t[n]=r}t=Object.assign(Object.assign({},t),e),this._handlerData(t)}at(!0,e)}setSource(t){if(!this.query)return;const{ended:e}=t;this.query.queryCustomInfo(Object.assign(Object.assign({},t),{callback:t=>{if(t.data&&t.data.total>0){let i=t.data.data.filter(t=>"Polygon"==t.geometry.type).map(t=>{let e=t.geometry.coordinates[0];return Object.assign({polygon:e},t.properties)});this.makeBounding(i),this.setData(i,e)}}}))}_handlerData(t){const{polygon:e,colors:i,color:n,height:r,opacity:o,outlineColor:s,outlineWidth:a}=t;let A=Object(g.flattenDepth)(e),l={name:this._id,polygon:{hierarchy:f.Cartesian3.fromDegreesArray(A)}};if(n&&(l.polygon.material=f.Color.fromCssColorString(n)),i&&(l.polygon.material=function(t){let e=document.createElement("canvas");e.width=100,e.height=1;let i=e.getContext("2d");i.globalAlpha=o;let n=t,r=i.createLinearGradient(0,0,100,1);return n.forEach(t=>{r.addColorStop(t.stop,t.color)}),i.fillStyle=r,i.fillRect(0,0,100,1),e}(i)),s&&(l.polyline={positions:f.Cartesian3.fromDegreesArray(A),material:f.Color.fromCssColorString(s)}),a&&(l.polyline.width=a),r&&(l.polygon.height=r,s)){let t=e.map(t=>(t.push(r),t)),i=Object(g.flattenDepth)(t);l.polyline.positions=f.Cartesian3.fromDegreesArrayHeights(i)}let c=new f.Entity(l);this._container.add(c)}}class Ka extends Va{constructor(t){super(t)}init(){this._style=Object.assign({imgUrl:Bt.getMapConfig(this._userViewer).distUrl+"Imgs/fire.png",startColor:"rgba(255,0,0,0.7)",endColor:"rgba(255,255,0,0)",startScale:1,endScale:5,minimumParticleLife:1.2,maximumParticleLife:7,minimumSpeed:1,maximumSpeed:4,imageSize:25,emissionRate:5,lifetime:16,radius:2,gravity:20,loop:!0,sizeInMeters:!0},this._options),this._handlerData()}_handlerData(){const{position:t,imgUrl:e,startColor:i,endColor:n,startScale:r,endScale:o,minimumParticleLife:s,maximumParticleLife:a,minimumSpeed:A,maximumSpeed:l,imageSize:c,emissionRate:u,lifetime:h,radius:p,loop:d,sizeInMeters:g}=this.getStyle(),m=new f.Matrix4,y=new f.Cartesian3,v=new f.Quaternion;let _=new f.HeadingPitchRoll;const w=new f.TranslationRotationScale,C=new f.Cartesian3,B=new f.ParticleSystem({loop:d,image:e,startColor:i,endColor:n,startScale:r,endScale:o,minimumParticleLife:s,maximumParticleLife:a,minimumSpeed:A,maximumSpeed:l,imageSize:c,emissionRate:u,lifetime:h,sizeInMeters:g,emitter:new f.CircleEmitter(p),modelMatrix:f.Transforms.eastNorthUpToFixedFrame(f.Cartesian3.fromDegrees(t.lng,t.lat,t.alt)),emitterModelMatrix:(_=f.HeadingPitchRoll.fromDegrees(0,0,0,_),w.translation=f.Cartesian3.fromElements(-4,0,1.4,y),w.rotation=f.Quaternion.fromHeadingPitchRoll(_,v),f.Matrix4.fromTranslationRotationScale(w,m)),updateCallback:(t,e)=>{const i=t.position;f.Cartesian3.normalize(i,C),f.Cartesian3.multiplyByScalar(C,this._style.gravity*e,C),t.velocity=f.Cartesian3.add(t.velocity,C,t.velocity)}});this._container.add(B),this._particle=B}setProperty(t){const{emissionRate:e,startColor:i,endColor:n,startScale:r,endScale:o,minimumSpeed:s,maximumSpeed:a,minimumParticleLife:A,maximumParticleLife:l,lifetime:c,imageSize:u,loop:h,sizeInMeters:p}=this.getStyle(t);this._particle.emissionRate=e,this._particle.startColor=i,this._particle.endColor=n,this._particle.startScale=r,this._particle.endScale=o,this._particle.minimumSpeed=s,this._particle.maximumSpeed=a,this._particle.minimumParticleLife=A,this._particle.maximumParticleLife=l,this._particle.lifetime=c,this._particle.imageSize=u,this._particle.loop=h,this._particle.sizeInMeters=p}getStyle(t={}){const e=Object.assign(this._style,t),{position:i,imgUrl:n,startColor:r,endColor:o,startScale:s,endScale:a,minimumParticleLife:A,maximumParticleLife:l,minimumSpeed:c,maximumSpeed:u,imageSize:h,emissionRate:p,lifetime:d,radius:g,loop:m,sizeInMeters:y}=e;return{position:i,imgUrl:n,startColor:f.Color.fromCssColorString(r),endColor:f.Color.fromCssColorString(o),startScale:s,endScale:a,minimumParticleLife:A,maximumParticleLife:l,minimumSpeed:c,maximumSpeed:u,imageSize:new f.Cartesian2(h,h),emissionRate:p,lifetime:d,radius:g,loop:m,sizeInMeters:y}}setPosition(t){const e=f.Transforms.eastNorthUpToFixedFrame(f.Cartesian3.fromDegrees(t.lng,t.lat,t.alt));this._particle.modelMatrix=e}}var za="czm_material czm_getMaterial(czm_materialInput materialInput) {\r\n    czm_material material = czm_getDefaultMaterial(materialInput);\r\n    vec2 st = materialInput.st;\r\n    vec4 colorImage = texture2D(image, fract(repeat * st));\r\n    float time = 0.0;\r\n    if(dynamic) {\r\n        time = fract(czm_frameNumber * speed / 500.0);\r\n    }\r\n    float step = time * (1.0 - 0.3);\r\n    if(color.a == 0.0) {\r\n        material.alpha = colorImage.a * (abs(step - 0.35) * 2.0 + 0.3);\r\n        material.diffuse = colorImage.rgb;\r\n    } else {\r\n        material.alpha = colorImage.a * color.a * (abs(step - 0.35) * 2.0 + 0.3);\r\n        material.diffuse = colorImage.rgb * color.rgb;\r\n    }\r\n\r\n    return material;\r\n}";class Wa extends Va{constructor(t){super(t)}init(){this._defaultStyle={dynamic:!0,speed:1,colors:[{stop:0,color:"rgba(255, 0, 0, 1)"},{stop:1,color:"rgba(0, 202, 255, 0)"}],color:"rgba(255, 255, 255, 0)",height:100,minimumHeights:0,brightness:1,repeat:1,alpha:1,axisY:!0,type:h.DEFAULT,reverse:!1};const{data:t}=this._options;if(t){let e=[{polygon:t}];this.setData(e)}}setSource(t){const{ended:e}=t;this.query&&this.query.queryCustomInfo(Object.assign(Object.assign({},t),{callback:t=>{if(t.data&&t.data.total>0){let i=t.data.data.filter(t=>"Polygon"==t.geometry.type).map(t=>{let e=[];return t.geometry.coordinates[0].forEach(t=>{e.push(...t),e.push(t[2]||100)}),Object.assign({polygon:e},t.properties)});this.makeBounding(i),this.setData(i,e)}}}))}setData(t,e){this._container.size>0&&this._container.removeAll();for(const e of t){let t=Object.assign(Object.assign({},this._defaultStyle),this._options);const i=this.fieldMap.map(t=>t.props);for(let n of i){const i=this.fieldMap.find(t=>t.props===n);let r=(i||{}).value(e[i.field]);t[n]=r}t=Object.assign(Object.assign({},t),e),this._handlerData(t)}at(!0,e)}_handlerData(t){let e=t.polygon;e[e.length-3]=e[e.length-3]+1e-6;let i=e.length/3,n=[],r=[];for(let e=0;e<i;e++)n.push(t.minimumHeights),r.push(t.minimumHeights+t.height);let o,s=new f.WallGeometry({positions:f.Cartesian3.fromDegreesArrayHeights(e),minimumHeights:n,maximumHeights:r});switch(t.type){case h.DEFAULT:case h.FADE:o=new f.Material({fabric:{uniforms:{image:t.image||wt(t.colors,!0),repeat:t.repeat,speed:t.speed,dynamic:t.dynamic,color:f.Color.fromCssColorString(t.color)},source:za},translucent:!0});break;case h.COLOR_FLOW:o=new f.Material({fabric:{uniforms:{color:f.Color.fromCssColorString(t.color),dynamic:t.dynamic,repeat:t.repeat,speed:t.speed,brightness:t.brightness,alpha:t.alpha,axisY:t.axisY},source:er}});break;case h.IMAGE_FLOW:o=new f.Material({fabric:{uniforms:{color:f.Color.fromCssColorString(t.color),dynamic:t.dynamic,image:t.image||wt(t.colors,!0),repeat:t.repeat,speed:t.speed,brightness:t.brightness,alpha:t.alpha,axisY:t.axisY,reverse:t.reverse},source:ir}})}let a=f.WallGeometry.createGeometry(s),A=new f.Primitive({geometryInstances:new f.GeometryInstance({geometry:a,id:this._id}),appearance:new f.PolylineMaterialAppearance({material:o})});this._container.add(A)}}class qa extends Va{constructor(t){super(t)}init(){this._container=new Z("customDataSource"),this._defaultStyle={radius:100,dynamic:!0,speed:1,colors:[{stop:0,color:"rgba(255, 0, 0, 1)"},{stop:1,color:"rgba(0, 202, 255, 0)"}]};const{point:t}=this._options;if(t){let e=[{lng:t[0],lat:t[1],alt:t[2]||0}];this.setData(e)}}setSource(t){const{ended:e}=t;this.query&&this.query.queryCustomInfo(Object.assign(Object.assign({},t),{callback:t=>{if(t.data&&t.data.total>0){let i=t.data.data.filter(t=>"Point"==t.geometry.type).map(t=>Object.assign({lng:t.geometry.coordinates[0],lat:t.geometry.coordinates[1],alt:t.geometry.coordinates[2]||0},t.properties));this.makeBounding(i),this.setData(i,e)}}}))}setData(t,e){this._container.size>0&&this._container.removeAll();const i=this.mapProps("radius"),n=this.mapProps("colors");t.forEach(t=>{const{radius:e,dynamic:r,speed:o}=this._options;let s=n?n.value(t[n.field]):n||this._defaultStyle.colors,a=i?i.value(t[i.field]):e||this._defaultStyle.radius,A=1,l=0,c=o/100,u=new f.Entity({position:f.Cartesian3.fromDegrees(t.lng,t.lat,t.alt||0),ellipsoid:{radii:new f.Cartesian3(a,a,a),material:new f.ImageMaterialProperty({image:this.getColorRamp(s,!0),transparent:new f.ConstantProperty(!0),color:!1===r?void 0:new f.CallbackProperty(()=>(l%2==0?A-=c:A+=c,(A<=.3||A>=1)&&l++,f.Color.WHITE.withAlpha(A)),!1)}),outline:!1},name:this._id});this._container.add(u)}),at(!0,e)}getColorRamp(t,e=!0){let i=document.createElement("canvas");i.width=e?1:100,i.height=e?100:1;let n=i.getContext("2d"),r=t,o=e?n.createLinearGradient(0,0,0,100):n.createLinearGradient(0,0,100,0);r.forEach(t=>{o.addColorStop(t.stop,t.color)}),n.fillStyle=o,e?n.fillRect(0,0,1,100):n.fillRect(0,0,100,1);var s=new Image;return s.src=i.toDataURL("image/png"),s}}class Xa extends Va{constructor(t){super(t)}init(){const{point:t,viewer:e}=this._options,i={color:"rgb(255, 0, 0)",speed:1,imgUrl:e.viewer.mapConfig.distUrl+"Imgs/radar.png",radius:200,brightness:1,alpha:.2,condition:[],bearing1:0,bearing2:360,revert:!1};if(this.globalStyle=Object.assign({},i,this._options),t){let e=[{lng:t[0],lat:t[1],alt:t[2]||0}];this.setData(e)}}setSource(t){if(!this.query)return;const{serviceName:e,ended:i}=t;if(e.startsWith("3D-model-")){const n=e.replace("3D-model-","");this.query.getSceneModel(Object.assign(Object.assign({},t),{sceneId:n,callback:t=>{if(t.data&&t.data.length>0){let e=t.data;this.makeBounding(e),this.setData(e,i)}}}))}else this.query.queryCustomInfo(Object.assign(Object.assign({},t),{callback:t=>{if(t.data&&t.data.total>0){let e=t.data.data.filter(t=>"Point"==t.geometry.type).map(t=>Object.assign({lng:t.geometry.coordinates[0],lat:t.geometry.coordinates[1],alt:t.geometry.coordinates[2]||0},t.properties));this.makeBounding(e),this.setData(e,i)}}}))}setData(t,e){this._container.size>0&&this._container.removeAll();const i=this.fieldMap.map(t=>({field:t.field,props:t.props}));t.forEach(t=>{let e=Object.assign({},this.globalStyle);for(let n of i){const i=this.fieldMap.find(t=>t.field===n.field&&t.props===n.props);let r=(i||{}).value(t[i.field]);e[n.props]=r}e=Object.assign(Object.assign({},e),t);let n=new f.EllipseGeometry({center:f.Cartesian3.fromDegrees(e.lng,e.lat),height:e.alt,semiMajorAxis:e.radius,semiMinorAxis:e.radius,stRotation:f.Math.toRadians(e.bearing1)}),r=new f.Primitive({geometryInstances:new f.GeometryInstance({geometry:n,id:this._id}),appearance:new f.MaterialAppearance({material:new f.Material({fabric:{uniforms:{imgUrl:e.imgUrl,speed:Number(e.speed),color:f.Color.fromCssColorString(e.color),brightness:e.brightness,alpha:e.alpha,bearing1:e.bearing1,bearing2:e.bearing2,revert:Number(e.revert)},source:"czm_material czm_getMaterial(czm_materialInput materialInput) {\r\n    czm_material material = czm_getDefaultMaterial(materialInput);\r\n    const float PI = 3.141592653589793;\r\n    vec2 originst = materialInput.st;\r\n    vec2 st = materialInput.st; // 左下角st为0,0 右上角st为1,1\r\n    // float startRadian = bearing1 * (PI / 180.0);\r\n    // float endRadian = bearing2 * (PI / 180.0);\r\n\r\n    float radian = (bearing2 - bearing1) * (PI / 180.0);  // 总弧度\r\n    st -= .5;\r\n\r\n    float n = czm_frameNumber * speed / 1000.0 * 3.14 * 2.0;\r\n    float rad = 0.0;\r\n    // 是否需要反转\r\n    if (revert == 1.0) {\r\n      rad = (sin(n) + 1.0) * 0.5 * radian;  // 限定旋转角度\r\n    } else {\r\n      rad = n;\r\n    }\r\n    mat2 m = mat2(cos(rad), sin(rad), -sin(rad), cos(rad));\r\n\r\n    // 判断处于顺时针区间还是逆时针区间\r\n    float sign = 1.0;\r\n    float extra = mod(n, 3.14 * 2.0);\r\n    if (extra >= (3.14 * 0.5) && extra <= (3.14 * 1.5)) {\r\n        sign = 1.0;\r\n    } else {\r\n        sign = -1.0;\r\n    }\r\n    // 处理是否需要反转图片\r\n    mat2 rm = mat2(1.0, 0.0, 0.0, 1.0);\r\n    if (sign == -1.0) {\r\n      rm = mat2(1.0, 0.0, 0.0, 1.0);\r\n    } else {\r\n      rm = mat2(1.0, 0.0, 0.0, -1.0);\r\n    }\r\n    mat2 lm = rm * m;\r\n    // 是否需要反转\r\n    if (revert == 1.0) {\r\n      st = lm * st;\r\n    } else {\r\n      st = m * st;\r\n    }\r\n    st += .5;\r\n\r\n    vec4 imgC = texture2D(imgUrl, st);\r\n    if(imgC.a > .1) {\r\n        material.diffuse = color.rgb * brightness;\r\n    }\r\n\r\n    // 限制显示范围\r\n    if (bearing2 - bearing1 == 90.0) {\r\n      if (originst.s < .5 || originst.t > .5) {\r\n        discard;\r\n      }\r\n    }\r\n    material.alpha = imgC.a * alpha;\r\n    return material;\r\n}"}})})});this._container.add(r)}),at(!0,e)}}class Ya extends Va{constructor(t){super(t)}init(){const{point:t}=this._options;if(this._defaultStyle=Object.assign({color:"rgb(255, 0, 0)",speed:1,radius:200,alpha:.2,bearing1:0,bearing2:360,gradient:!1,count:1},this._options),t){let e=[{lng:t[0],lat:t[1],alt:t[2]||0}];this.setData(e)}}setSource(t){if(!this.query)return;const{serviceName:e,ended:i}=t;if(e.startsWith("3D-model-")){const n=e.replace("3D-model-","");this.query.getSceneModel(Object.assign(Object.assign({},t),{sceneId:n,callback:t=>{if(t.data&&t.data.length>0){let e=t.data;this.makeBounding(e),this.setData(e,i)}}}))}else this.query.queryCustomInfo(Object.assign(Object.assign({},t),{callback:t=>{if(t.data&&t.data.total>0){let e=t.data.data.filter(t=>"Point"==t.geometry.type).map(t=>Object.assign({lng:t.geometry.coordinates[0],lat:t.geometry.coordinates[1],alt:t.geometry.coordinates[2]||0},t.properties));this.makeBounding(e),this.setData(e,i)}}}))}setData(t,e){this._data=t,this._container.size>0&&this._container.removeAll();const i=this.fieldMap.map(t=>({field:t.field,props:t.props}));t.forEach(t=>{let e=Object.assign({},this._defaultStyle);for(let n of i){const i=this.fieldMap.find(t=>t.field===n.field&&t.props===n.props);let r=(i||{}).value(t[i.field]);e[n.props]=r}e=Object.assign(Object.assign({},e),t);const{material:n}=this.getStyle(Object.assign({},e));let r=new f.EllipseGeometry({center:f.Cartesian3.fromDegrees(e.lng,e.lat),height:e.alt,semiMajorAxis:e.radius,semiMinorAxis:e.radius,stRotation:f.Math.toRadians(e.bearing1)}),o=new f.Primitive({geometryInstances:new f.GeometryInstance({geometry:r,id:this._id}),appearance:new f.MaterialAppearance({material:n})});this._container.add(o)}),at(!0,e)}setProperty(t){const{radius:e}=t,{material:i}=this.getStyle(t);let n=this._container.getCollection();if(0!=n.length){if(e)return this._container.removeAll(),void this.setData(this._data);for(let t=0;t<n.length;t++){n.get(t).appearance.material=i}}}getStyle(t={}){const e=Object.assign(this._defaultStyle,t),{color:i,speed:n,gradient:r,alpha:o,bearing1:s,bearing2:a,count:A}=e;let l;return l=1===A?new f.Material({fabric:{uniforms:{speed:n,color:f.Color.fromCssColorString(i),gradient:Number(r),alpha:o,bearing1:s,bearing2:a},source:"czm_material czm_getMaterial(czm_materialInput materialInput) {\r\n  czm_material material = czm_getDefaultMaterial(materialInput);\r\n  material.diffuse = 1.5 * color.rgb;\r\n  vec2 originst = materialInput.st;\r\n  vec2 st = materialInput.st;\r\n\r\n  float dis = distance(st, vec2(0.5, 0.5));\r\n  float n = czm_frameNumber * speed / 1000.0 * 3.14 * 2.0;\r\n  float per = fract(n);\r\n\r\n  // 限制显示范围\r\n  if (bearing2 - bearing1 == 90.0) {\r\n    if (bearing1 >= .0) {\r\n      if (originst.s < .5 || originst.t > .5) {\r\n        discard;\r\n      }\r\n    }\r\n  }\r\n\r\n  if(dis > per * 0.5) {\r\n    material.alpha = 0.0;\r\n    discard;\r\n  } else {\r\n    if (gradient == 1.0) {\r\n      material.alpha = color.a * (dis) / per;\r\n    } else {\r\n      material.alpha = color.a * alpha;\r\n    }\r\n  }\r\n  return material;\r\n}"}}):new f.Material({fabric:{uniforms:{color:f.Color.fromCssColorString(i),time:1,speed:n,count:A,gradient:.1},source:tr}}),{material:l}}}class Ja extends Va{constructor(t){super(t)}addToViewer(t){const{data:e,color:i,alpha:n=1,efinition:r=.5,height:o=1}=this._options,{viewer:s,ended:a}=t;this._userViewer=s;const A=this.transformColor(i),l=this.transformLonLatData(e);if(!l)return void At("transform data error!",a);let c=s.viewer.mapConfig.distUrl+"Imgs/waterNormals.png";this._userViewer.viewer.instance.scene.context.defaultTexture.type="sampler2D";const u=new f.Material({fabric:{uniforms:{baseWaterColor:A,frequency:125e3,normalMap:c,animationSpeed:2,amplitude:1,specularMap:this._userViewer.viewer.instance.scene.context.defaultTexture,efinition:r,alpha:n}}}),h=this;u._updateFunctions=[function(t,e){t._uniforms.normalMap_2=()=>c,t.uniforms.specularMap=f.ExpandBySTC.mirror.stcTex||h._userViewer.viewer.instance.scene.context.defaultTexture,t._uniforms.specularMap_5=()=>f.ExpandBySTC.mirror.MirrorFrameBuffer&&f.ExpandBySTC.mirror.MirrorFrameBuffer.getColorTexture(0)||h._userViewer.viewer.instance.scene.context.defaultTexture}];let p=new f.GeometryInstance({id:this._id,geometry:new f.PolygonGeometry({polygonHierarchy:new f.PolygonHierarchy(l),height:o})});this._effectIns=new f.Primitive({geometryInstances:p,appearance:new f.EllipsoidSurfaceAppearance({material:u,fragmentShaderSource:$a,vertexShaderSource:Za})}),Bt.getLayerCache(this._userViewer).add(this),Bt.getPrimitives(this._userViewer).add(this._effectIns),f.ExpandBySTC.mirror.MirrorEnable=!0,at(!0,a)}remove(t={}){const{ended:e}=t;f.ExpandBySTC.mirror.MirrorEnable=!1,this._effectIns&&(Bt.getPrimitives(this._userViewer).remove(this._effectIns),this._effectIns=null,this._layerEvent=null,Bt.getLayerCache(this._userViewer).remove(this),at(!0,e))}show(){this._effectIns&&(this._effectIns.show=!0)}hide(){this._effectIns&&(this._effectIns.show=!1)}transformLonLatData(t,e){const i=[];return t.forEach(t=>{let n=0;t[2]||(t[2]=0),n=t[2]?t[2]+e||.1:e||-.5;const r=Number(t[0]),o=Number(t[1]);i.push(r,o,n)}),f.Cartesian3.fromDegreesArrayHeights(i)}transformColor(t,e){if(!t)return;const i=f.Color.fromCssColorString(t);return e&&0!==e&&(i.alpha=e),i}}const Za="attribute vec3 position3DHigh;\r\nattribute vec3 position3DLow;\r\nattribute vec3 normal;\r\nattribute vec3 tangent;\r\nattribute vec3 bitangent;\r\nattribute vec2 st;\r\nattribute float batchId;\r\nvarying vec3 v_positionEC;\r\nvarying vec3 v_normalEC;\r\nvarying vec3 v_tangentEC;\r\nvarying vec3 v_bitangentEC;\r\nvarying vec2 v_st;\r\nvoid main() {\r\n    vec4 p = czm_computePosition();\r\n\r\n    v_positionEC = (czm_modelViewRelativeToEye * p).xyz;      // position in eye coordinates\r\n    v_normalEC = czm_normal * normal;                         // normal in eye coordinates\r\n    v_tangentEC = czm_normal * tangent;                       // tangent in eye coordinates\r\n    v_bitangentEC = czm_normal * bitangent;                   // bitangent in eye coordinates\r\n    v_st = st;\r\n\r\n    gl_Position = czm_modelViewProjectionRelativeToEye * p;\r\n}",$a="czm_material czm_getMaterial1(czm_materialInput materialInput) {\r\n    czm_material material = czm_getDefaultMaterial(materialInput);\r\n    float time = czm_frameNumber * animationSpeed_3;\r\n    float fade = max(1.0, (length(materialInput.positionToEyeEC) / 10000000000.0) * frequency_1);\r\n    vec2 st = materialInput.st * frequency_1;\r\n    vec4 noise = czm_getWaterNoise(normalMap_2, st, time, 0.0);\r\n    vec3 normalTangentSpace = noise.xyz * vec3(1.0, 1.0, (1.0 / amplitude_4));\r\n    normalTangentSpace.xy /= fade;\r\n    normalTangentSpace = normalize(normalTangentSpace);\r\n    float tsPerturbationRatio = clamp(dot(normalTangentSpace, vec3(0.0, 0.0, 1.0)), 0.0, 1.0);\r\n    vec2 v = gl_FragCoord.xy / czm_viewport.zw;\r\n    v.x = 1.0 - v.x;\r\n    vec2 nosize1 = noise.xy * 0.005;\r\n\r\n    float r = sqrt((v.x - 0.8) * (v.x - 0.8) + (v.y - 0.8) * (v.y - 0.8));\r\n    float r2 = sqrt((v.x - 0.2) * (v.x - 0.2) + (v.y - 0.2) * (v.y - 0.2));\r\n    float z = cos(400.0 * r + time / 100.0) / 250.0;\r\n    float z2 = cos(400.0 * r2 + time / 50.0) / 150.0;\r\n    v += sqrt(z*z+z2*z2);\r\n    // vec3 skyColor = texture2D(skyimg_7, v).rgb;\r\n    material.diffuse = texture2D(specularMap_5, v + nosize1).rgb;\r\n    // material.diffuse = texture2D(specularMap_5, v).rgb;\r\n    // float mixNum = clamp(material.diffuse.r + material.diffuse.g + material.diffuse.b, 0.0, 1.0);\r\n    material.diffuse += (0.1 * tsPerturbationRatio);\r\n    material.diffuse = mix(baseWaterColor_0.rgb, material.diffuse, efinition_6);\r\n    material.normal = normalize(materialInput.tangentToEyeMatrix * normalTangentSpace);\r\n    // material.diffuse = mix(material.diffuse, skyColor, 1.0 - mixNum);\r\n    material.shininess = 10.0;\r\n    material.alpha = alpha_7;\r\n    return material;\r\n}\r\n\r\nvarying vec3 v_positionEC;\r\nvarying vec3 v_normalEC;\r\nvarying vec3 v_tangentEC;\r\nvarying vec3 v_bitangentEC;\r\nvarying vec2 v_st;\r\nvoid czm_log_depth_main() {\r\n    vec3 positionToEyeEC = -v_positionEC;\r\n    mat3 tangentToEyeMatrix = czm_tangentToEyeSpaceMatrix(v_normalEC, v_tangentEC, v_bitangentEC);\r\n    vec3 normalEC = normalize(v_normalEC);\r\n    #ifdef FACE_FORWARD\r\n    normalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);\r\n    #endif\r\n    czm_materialInput materialInput;\r\n    materialInput.normalEC = normalEC;\r\n    materialInput.tangentToEyeMatrix = tangentToEyeMatrix;\r\n    materialInput.positionToEyeEC = positionToEyeEC;\r\n    materialInput.st = v_st;\r\n    czm_material material = czm_getMaterial1(materialInput);\r\n    #ifdef FLAT\r\n    gl_FragColor = vec4(material.diffuse, material.alpha);\r\n    #else\r\n    gl_FragColor = czm_translucentPhong(normalize(positionToEyeEC), material, vec3(0.7));\r\n    #endif\r\n    czm_geometryInput geometry;\r\n    geometry.normal = normalEC;\r\n    geometry.metalness = 1.0;\r\n    geometry.roughness = 0.2;\r\n    geometry.color = material.diffuse;\r\n\r\n    // czm_pointLightInput light;\r\n    // light.position = czm_extendPointLightPositionEC;\r\n    // light.intensity = czm_extendPointLightBrightness;\r\n    // light.dis = czm_extendPointLightDistance;\r\n    // light.color = czm_extendPointLightColor;\r\n    // material.diffuse += czm_stcPointLight(positionToEyeEC, geometry, light);\r\n    gl_FragColor = vec4(material.diffuse, material.alpha);\r\n}\r\n#line 0\r\n#ifdef GL_EXT_frag_depth\r\n#endif\r\nvoid czm_translucent_main1() {\r\n    czm_log_depth_main();\r\n    czm_writeLogDepth();\r\n}\r\n#line 0\r\nvoid main() {\r\n    czm_translucent_main1();\r\n}";class tA extends Va{constructor(t){super(t)}init(){this._container=new Z("primitive"),this._defaultStyle=Object.assign({type:S.DEFAULT,color:"rgba(255, 0, 0, 1)",speed:1,height:100,repeat:1,brightness:1,minimumHeights:0,alpha:1,url:"",axisY:!0,dynamic:!0,reverse:!1},this._options);const{data:t}=this._options;if(t){let e=[{polygon:t}];this.setData(e)}}setSource(t){const{ended:e}=t;this.query&&this.query.queryCustomInfo(Object.assign(Object.assign({},t),{callback:t=>{if(t.data&&t.data.total>0){let i=t.data.data.filter(t=>"Polygon"==t.geometry.type).map(t=>{let e=t.geometry.coordinates[0];return Object.assign({polygon:e},t.properties)});this.makeBounding(i),this.setData(i,e)}}}))}setData(t,e){this._container.size>0&&this._container.removeAll();const i=this.mapProps("color");t.forEach(t=>{const e=i?i.value(t[i.field]):i||this._defaultStyle.color,{height:n,minimumHeights:r,material:o}=this.getStyle({color:e});let s=t.polygon.map(t=>Y.WGS84ToCartesian(new I(...t))),a=t.polygon[0];a[0]=t.polygon[0][0]+1e-6,s.push(Y.WGS84ToCartesian(new I(...a)));let A=[],l=[];s.forEach(()=>{A.push(r),l.push(r+n)});let c=new f.WallGeometry({positions:s,minimumHeights:A,maximumHeights:l}),u=f.WallGeometry.createGeometry(c),h=new f.GeometryInstance({geometry:u,id:this._id}),p=new f.Primitive({geometryInstances:h,appearance:new f.PolylineMaterialAppearance({material:o})});this._container.add(p)}),at(!0,e)}setProperty(t){const{material:e}=this.getStyle(t);let i=this._container.getCollection();if(0!=i.length)for(let t=0;t<i.length;t++){i.get(t).appearance.material=e}}getStyle(t={}){const e=Object.assign(this._defaultStyle,t),{type:i,color:n,colors:r,url:o,dynamic:s,height:a,repeat:A,speed:l,brightness:c,alpha:u,axisY:h,minimumHeights:p,reverse:d}=e;let g;switch(i){case S.DEFAULT:case S.FADE:const t={repeat:A,speed:l,dynamic:s,color:f.Color.fromCssColorString(n)};r?(t.image=wt(r),t.color=f.Color.WHITE):t.image=wt([{stop:0,color:"rgb(255,255,255)"},{stop:1,color:"rgb(255,255,255)"}]),g=new f.Material({fabric:{uniforms:t,source:za},translucent:!0});break;case S.COLOR_FLOW:g=new f.Material({fabric:{uniforms:{dynamic:!0,color:f.Color.fromCssColorString(n),repeat:A,speed:l,brightness:c,alpha:u,axisY:h},source:er}});break;case S.IMAGE_FLOW:g=new f.Material({fabric:{uniforms:{dynamic:!0,color:f.Color.fromCssColorString(n),image:o,repeat:A,speed:l,brightness:c,alpha:u,axisY:h,reverse:d},source:ir}})}return{height:a,minimumHeights:p,material:g}}}class eA extends Va{constructor(t){super(t)}init(){this._container=new Z("primitive"),this._defaultStyle={radius:50,brightness:1,color:"rgba(255, 0, 0, 1)",bloom:!0,ratio:2,topRatio:1.5,condition:[],speed:1,repeat:3};const{point:t}=this._options;if(t){let e=[{lng:t[0],lat:t[1],alt:t[2]||0}];this.setData(e)}}setSource(t){const{ended:e}=t;this.query&&this.query.queryCustomInfo(Object.assign(Object.assign({},t),{callback:t=>{if(t.data&&t.data.total>0){let i=t.data.data.filter(t=>"Point"==t.geometry.type).map(t=>Object.assign({lng:t.geometry.coordinates[0],lat:t.geometry.coordinates[1],alt:t.geometry.coordinates[2]||0},t.properties));this.makeBounding(i),this.setData(i,e)}}}))}setData(t,e){this._container.size>0&&this._container.removeAll();const i=this.mapProps("radius"),n=this.mapProps("color");t.forEach(t=>{const{radius:e,color:r,brightness:o,speed:s,repeat:a,ratio:A}=this._options;let l=Y.WGS84ToCartesian(new I(t.lng,t.lat,t.alt||0));let c=n?n.value(t[n.field]):r,u=new f.Material({fabric:{uniforms:{color:c?f.Color.fromCssColorString(c):f.Color.fromCssColorString(this._defaultStyle.color),brightness:o||this._defaultStyle.brightness,speed:s||this._defaultStyle.speed,repeat:a||this._defaultStyle.repeat,alpha:1},source:"\n                czm_material czm_getMaterial(czm_materialInput materialInput)\n                {\n                    czm_material material = czm_getDefaultMaterial(materialInput);\n                    vec2 st = materialInput.st;\n                    material.diffuse = color.rgb * brightness;\n                    material.alpha = (1.0 - st.t) * 0.01;\n                    float tempFlood = fract(czm_frameNumber*speed/500.0);\n                    float temp = 1.0/repeat;\n                    temp = (st.t - tempFlood)/temp;\n                    float powNum = fract(temp);\n                    float stcNum = 0.4;\n                    if(powNum<stcNum * 2.0){\n                        float midNum = abs(powNum - stcNum)/stcNum;\n                        material.alpha = pow(material.alpha,midNum);\n                        material.alpha = material.alpha * (1.0 - st.t) * alpha;\n                    }\n                    return material;\n                }\n            "}}),h=this._createCustomGeometry(this._prepareVAO()),p=new f.GeometryInstance({geometry:h,id:this._id}),d=new f.Primitive({geometryInstances:p,appearance:new f.MaterialAppearance({material:u})}),g=f.Transforms.eastNorthUpToFixedFrame(l);const m=Object.assign({},g);let y=i?i.value(t[i.field]):e;const v=f.Matrix4.fromScale(new f.Cartesian3(y,y,y*(A||this._defaultStyle.ratio)));f.Matrix4.multiply(m,v,g),d.modelMatrix=g,d.shapeMat=v,this._container.add(d)}),at(!0,e)}_prepareVAO(){const{topRatio:t=1.5}=this._options,e=this._SplitCircle(30),i=[];e.forEach((e,n)=>{n%3==2?i.push(1):i.push(e*t)});const n=e.concat(i),r=[],o=[];for(let t=0;t<=30;t++)if(o.push(t/30),o.push(0),t<30){const e=t,i=t+31,n=t+1+31,o=t+1;r.push(e,n,i),r.push(e,o,n)}for(let t=0;t<=30;t++)o.push(t/30),o.push(1);return{type:"TRIANGLES",position:{values:new Float32Array(n),componentDatatype:"DOUBLE",componentsPerAttribute:3},indexs:new Uint16Array(r),st:{values:new Float32Array(o),componentDatatype:"FLOAT",componentsPerAttribute:2}}}_SplitCircle(t){const e=[];for(let i=0;i<=t;i++){const n=360/t*i,r=f.Math.toRadians(n),o=Math.cos(r),s=Math.sin(r);e.push(o,s,0)}return e}_createCustomGeometry(t){if(!t)return;const e=new f.GeometryAttributes;t.position&&(e.position=this._CreateAttribute(t.position)),t.st&&(e.st=this._CreateAttribute(t.st)),t.color&&(e.color=this._CreateAttribute(t.color)),t.normal&&(e.normal=this._CreateAttribute(t.normal));let i=new f.Geometry({attributes:e,indices:t.indexs,primitiveType:f.PrimitiveType[t.type],boundingSphere:f.BoundingSphere.fromVertices(t.position.values)});return i.rectangle=new f.Rectangle,i}_CreateAttribute(t){const e=t.componentDatatype;return new f.GeometryAttribute({componentDatatype:f.ComponentDatatype[e],componentsPerAttribute:t.componentsPerAttribute,values:t.values})}}class iA extends Va{constructor(t){super(t),this.polygon=t.data,this.handleData()}handleData(){const t=f.Color.fromCssColorString("#000");let e=Object(g.flattenDeep)(this.polygon);var i={positions:f.Cartesian3.fromDegreesArray([-180,-84.9901,-1e-5,-84.9901,-1e-5,84.9901,-180,84.9901])},n=new f.GeometryInstance({geometry:new f.PolygonGeometry({polygonHierarchy:i,vertexFormat:f.PerInstanceColorAppearance.VERTEX_FORMAT}),attributes:{color:f.ColorGeometryInstanceAttribute.fromColor(t)}}),r={positions:f.Cartesian3.fromDegreesArray([1e-5,-84.9901,180,-84.9901,180,84.9901,1e-5,84.9901]),holes:[{positions:f.Cartesian3.fromDegreesArray(e)}]},o=new f.GeometryInstance({geometry:new f.PolygonGeometry({polygonHierarchy:r,vertexFormat:f.PerInstanceColorAppearance.VERTEX_FORMAT}),attributes:{color:f.ColorGeometryInstanceAttribute.fromColor(t)}});const s=new f.Primitive({geometryInstances:[n,o],appearance:new f.PerInstanceColorAppearance({closed:!0,translucent:!1})});this._container.add(s)}}class nA extends Va{constructor(t){super(t),this.uniform_focus=new f.Matrix3}addToViewer(t){const{data:e,tailorBrightNum:i=.2}=this._options,{ended:n}=t;this._tilesetLayers=this._userViewer.getLayers().filter(t=>"tileset"===t._layerType);const r=f.Cartesian3.fromDegrees(...e[0],0),o=f.Transforms.eastNorthUpToFixedFrame(r,f.Ellipsoid.WGS84),s=f.Matrix4.inverse(o,new f.Matrix4),a=this.getPoints(s);this._tilesetLayers.forEach(t=>{t.setShader("focus",{size:e.length}),this.uniform_focus=new f.Cartesian3(1,i,e.length),t.setUniform({focus:this.uniform_focus,focusPoints:a,focusMatrix:s})}),this._effectIns=!0,at(!0,n)}remove(t={}){const{ended:e}=t;this._tilesetLayers.forEach(t=>{t._applyEffect.focus&&t.removeShader("focus")}),this._effectIns=!1,at(!0,e)}show(){this._effectIns&&(this.uniform_focus.x=1,this._tilesetLayers.forEach(t=>{t.setUniform({focus:this.uniform_focus})}))}hide(){this._effectIns&&(this.uniform_focus.x=0,this._tilesetLayers.forEach(t=>{t.setUniform({focus:this.uniform_focus})}))}getPoints(t){const{data:e}=this._options;return e.map(e=>{const i=f.Cartesian3.fromDegrees(...e);return f.Matrix4.multiplyByPoint(t,i,new f.Cartesian3)})}}const rA=t=>{const e=t.componentDatatype;return new f.GeometryAttribute({componentDatatype:f.ComponentDatatype[e],componentsPerAttribute:t.componentsPerAttribute,values:t.values})};class oA{constructor(t){if(!t)return;const e=new f.GeometryAttributes;t.position&&(e.position=rA(t.position)),t.st&&(e.st=rA(t.st)),t.color&&(e.color=rA(t.color)),t.normal&&(e.normal=rA(t.normal)),this.geometry=new f.Geometry({attributes:e,indices:t.indexs,primitiveType:f.PrimitiveType[t.type],boundingSphere:f.BoundingSphere.fromVertices(t.position.values)}),this.geometry.rectangle=new f.Rectangle}}class sA{constructor(t,e,i,n){const r=new f.GeometryInstance({geometry:t});n&&"string"==typeof t&&(this.primitive=f.Model.fromGltf({url:t})),this.primitive=i?new f.GroundPrimitive({geometryInstances:r,appearance:e.appearance}):new f.Primitive({geometryInstances:r,appearance:e.appearance})}static updatePriAppearance(t,e){t&&e&&(t.appearance=e.appearance||e)}setMatrix(t,e){this.primitive.modelMatrix=t,this.primitive.shapeMat=e}setBloom(t){}}const aA={PolylineMaterial:"PolylineMaterialAppearance",MaterialAppearance:"MaterialAppearance",EllipsoidSurfaceAppearance:"EllipsoidSurfaceAppearance"};class AA{constructor(t){if(!t||!t.type||!aA[t.type])return;this.material=t.material;const e=Object.assign({},t);e.material=t.material.material,this.appearance=new f[aA[t.type]](e)}destroy(){this.appearance&&this.appearance.material&&this.appearance.material.destroy(),this.appearance=null}resetMaterial(t){this.material.reset(t)}}class lA{constructor(t){const e=cA(t.color)||new f.Color(1,0,1,1);this.material=new f.Material({fabric:{uniforms:{color:e,brightness:t.brightness||1,alpha:t.alpha,floatDis:t.floatDis||500,speed:t.speed||1,pointSize:t.pointSize||10,maxDis:t.maxDis||1/0},source:"czm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n    material.alpha = alpha;\n    material.diffuse = color.rgb * brightness;\n    return material;\n}"}})}reset(t){this.material.uniforms.color=cA(t.color)||this.material.uniforms.floodColor,this.material.uniforms.alpha=t.alpha,this.material.uniforms.brightness=t.brightness||1,this.material.uniforms.floatDis=t.floatDis||500,this.material.uniforms.speed=t.speed||1,this.material.uniforms.pointSize=t.pointSize||10,this.material.uniforms.maxDis=t.maxDis||1/0}destroy(){this.material&&this.material.destroy(),this.material=null}}const cA=(t,e)=>{if(!t)return;const i=f.Color.fromCssColorString(t);return e&&0!==e&&(i.alpha=e),i};class uA extends Va{constructor(t){super(t)}addToViewer(t){const{point:e,color:i,alpha:n=1,brightness:r=1,floatDis:o=500,speed:s=1,pointSize:a=10,maxDis:A=1/0,width:l=1e4,height:c=0,limitHeight:u=1e4,potNum:h=1e5}=this._options,{viewer:p,ended:d}=t;this._userViewer=p;const g=f.Cartesian3.fromDegrees(e[0],e[1]),m=this.randomPoints(h),y=new lA({color:i,brightness:r,alpha:n,floatDis:o,speed:s,pointSize:a,maxDis:A}),v=new AA({type:"MaterialAppearance",material:y,vertexShaderSource:hA,fragmentShaderSource:pA}),_={type:"POINTS",position:{values:m.vertex,componentDatatype:"DOUBLE",componentsPerAttribute:3},color:{values:m.color,componentDatatype:"FLOAT",componentsPerAttribute:4},indexs:m.index};let w=f.Transforms.eastNorthUpToFixedFrame(g);const C=Object.assign({},w),B=this.computedMat({radius:l,height:c,limitHeight:u});if(!B)return;w=f.Matrix4.multiply(w,B,new f.Matrix4);const b=new oA(_),E=new sA(b.geometry,v);E.setMatrix(w),E.primitive.oldMat=C,this._effectIns=E.primitive,this._userViewer.viewer.layerCache.add(this),this._userViewer.viewer.instance.scene.primitives.add(this._effectIns),d&&d(at(!0))}show(){this._effectIns&&(this._effectIns.show=!0)}hide(){this._effectIns&&(this._effectIns.show=!1)}remove(t={}){const{ended:e}=t;this._effectIns&&(this._userViewer.viewer.instance.scene.primitives.remove(this._effectIns),this._effectIns=null,this._layerEvent=null,this._userViewer.viewer.layerCache.remove(this),e&&e(at(!0)))}randomPoints(t){const e=[],i=[],n=[];for(let r=0;r<t;r++)e.push(Math.random()-.5),e.push(Math.random()-.5),e.push(Math.random()),i.push(r),n.push(Math.random()-.5),n.push(Math.random()-.5),n.push(Math.random()-.5),n.push(Math.random()-.5);return{vertex:new Float64Array(e),index:new Uint32Array(i),color:new Float32Array(n)}}computedMat(t){const e=f.Matrix4.fromTranslation(new f.Cartesian3(0,0,t.height+1e-7)),i=f.Matrix4.fromScale(new f.Cartesian3(t.radius+1e-7,t.radius+1e-7,t.limitHeight+1e-7));return f.Matrix4.multiply(e,i,new f.Matrix4)}transformColor(t,e){if(!t)return;const i=f.Color.fromCssColorString(t);return e&&0!==e&&(i.alpha=e),i}}const hA="\nattribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec4 color;\nattribute float batchId;\nvarying vec3 v_positionEC;\nvarying vec3 v_positionMC;\nvarying vec4 randomColor;\nuniform float floatDis_3;\nuniform float speed_4;\nuniform float pointSize_5;\nuniform float maxDis_6;\nvoid main()\n{\n    vec4 p = czm_computePosition();\n    float num = czm_frameNumber * 1.4 / 1000.0;\n    float nosizex = sin(color.r * num) * floatDis_3;\n    float nosizey = sin(color.g * num) * floatDis_3;\n    float nosizez = sin(color.b * num) * floatDis_3;\n    float nw = sin(color.a * num * 50.0);\n    randomColor = vec4(nosizex,nosizey,nosizez,nw);\n    v_positionMC = position3DHigh + position3DLow;\n    v_positionEC = (czm_modelViewRelativeToEye * p).xyz;\n    vec4 p2 = czm_modelView * p;\n    float disEye = distance(p2.xyz, vec3(0.0));\n    if (disEye > maxDis_6) {\n        return;\n    }\n    gl_Position = czm_modelViewProjectionRelativeToEye * p;\n    gl_Position.xyz += randomColor.xyz * speed_4;\n    randomColor = abs(randomColor);\n    gl_PointSize = pointSize_5 * color.a;\n}",pA="\nvarying vec3 v_positionMC;\nvarying vec3 v_positionEC;\nvarying vec4 randomColor;\nvoid main(){\n    czm_materialInput materialInput;\n    czm_material material = czm_getMaterial(materialInput);\n    float dist = distance(gl_PointCoord, vec2(0.5));\n    float alpha = 0.0;\n    vec3 constColor = vec3(0.0,0.53,1.0);\n    if (dist < 0.5) {\n        alpha = (0.5 - dist) / 0.5;\n        material.diffuse = mix(constColor, material.diffuse, randomColor.a);\n    }\n    gl_FragColor = vec4(material.diffuse, alpha * randomColor.a);\n}",dA={PolylineMaterial:"PolylineMaterialAppearance",MaterialAppearance:"MaterialAppearance",EllipsoidSurfaceAppearance:"EllipsoidSurfaceAppearance"};class fA{constructor(t){if(!t||!t.type||!dA[t.type])return;this.material=t.material;const e=Object.assign({},t);e.material=t.material.material,this.appearance=new f[dA[t.type]](e)}destroy(){this.appearance&&this.appearance.material&&this.appearance.material.destroy(),this.appearance=null}resetMaterial(t){this.material.reset(t)}}const gA={fgNum:0,blurRadius:2,brightStrength:8.5,bloomSizeScale:2,color:"red",condition:[]};class mA extends Va{constructor(t){super(t)}init(){let t=Object.assign(Object.assign({},gA),this._options);const{color:e,brightStrength:i,blurRadius:n,fgNum:r,data:o,bloomSizeScale:s}=t,a=f.Material.fromType("Color");a.uniforms.color=f.Color.fromCssColorString(e),this.conditionAppearance={},this.conditionAppearance.default=new fA({type:"EllipsoidSurfaceAppearance",material:a}),this.conditionAppearance.line=new fA({type:"PolylineMaterial",material:a}),this.conditionAppearance.default.appearance.material.uniforms.color=a.uniforms.color,this.conditionAppearance.line.appearance.material.uniforms.color=a.uniforms.color,f.ExpandBySTC.bloomInside.brightStrength=i||gA.brightStrength,f.ExpandBySTC.bloomInside.blurRadius=n||gA.blurRadius,f.ExpandBySTC.bloomInside.fgNum=r||gA.fgNum,f.ExpandBySTC.bloomSizeScale=s||gA.bloomSizeScale,o&&this.setData([o])}setData(t,e){this._container.size>0&&this._container.removeAll();for(const e of t){let t=e;Object(g.isArray)(e)&&(t={polygon:e}),this._handlerData(t)}at(!0,e)}setSource(t){if(!this.query)return;const{ended:e}=t;this.query.queryCustomInfo(Object.assign(Object.assign({},t),{callback:t=>{if(t.data&&t.data.total>0){let i=t.data.data.filter(t=>"Polygon"==t.geometry.type).map(t=>{let e=t.geometry.coordinates[0];return Object.assign({polygon:e},t.properties)});this.makeBounding(i),this.setData(i,e)}}}))}_handlerData(t){if(!t)return;let e=t.polygon.map(t=>Y.WGS84ToCartesian(new I(...t)));const i=this._createPolygonGeometry({id:this._id,data:e}),n=this._createPolylineGeometry({data:e,width:3}),r=new f.Primitive({geometryInstances:[i]});r.bloomInside=!0,r.insideArea=!0,r.appearance=this.conditionAppearance.default.appearance;const o=new f.Primitive({geometryInstances:n});o.bloomInside=!0,o.appearance=this.conditionAppearance.line.appearance;let s=new f.PrimitiveCollection;s.add(r),s.add(o),this._container.add(s)}_createPolygonGeometry(t){let e;return t.holesArr&&t.holesArr.length&&(e=[],t.holesArr.forEach(t=>{e.push(new f.PolygonHierarchy(t))})),new f.GeometryInstance({id:t.id,geometry:new f.PolygonGeometry({polygonHierarchy:new f.PolygonHierarchy(t.data,e)})})}_createPolylineGeometry(t){if(t&&t.data)return t.groundLine?new f.GeometryInstance({geometry:new f.GroundPolylineGeometry({positions:t.data,width:t.width})}):new f.GeometryInstance({geometry:new f.PolylineGeometry({positions:t.data,width:t.width})})}}var yA,vA,_A={defaultRadius:40,defaultRenderer:"canvas2d",defaultGradient:{.25:"rgb(0,0,255)",.55:"rgb(0,255,0)",.85:"yellow",1:"rgb(255,0,0)"},defaultMaxOpacity:1,defaultMinOpacity:0,defaultBlur:.85,defaultXField:"x",defaultYField:"y",defaultValueField:"value",plugins:{}},wA=(yA=function(t){this._coordinator={},this._data=[],this._radi=[],this._min=0,this._max=1,this._xField=t.xField||t.defaultXField,this._yField=t.yField||t.defaultYField,this._valueField=t.valueField||t.defaultValueField,t.radius&&(this._cfgRadius=t.radius)},vA=_A.defaultRadius,yA.prototype={_organiseData:function(t,e){var i=t[this._xField],n=t[this._yField],r=this._radi,o=this._data,s=this._max,a=this._min,A=t[this._valueField]||1,l=t.radius||this._cfgRadius||vA;return o[i]||(o[i]=[],r[i]=[]),o[i][n]?o[i][n]+=A:(o[i][n]=A,r[i][n]=l),o[i][n]>s?(e?this.setDataMax(o[i][n]):this._max=o[i][n],!1):{x:i,y:n,value:A,radius:l,min:a,max:s}},_unOrganizeData:function(){var t=[],e=this._data,i=this._radi;for(var n in e)for(var r in e[n])t.push({x:n,y:r,radius:i[n][r],value:e[n][r]});return{min:this._min,max:this._max,data:t}},_onExtremaChange:function(){this._coordinator.emit("extremachange",{min:this._min,max:this._max})},addData:function(){if(arguments[0].length>0)for(var t=arguments[0],e=t.length;e--;)this.addData.call(this,t[e]);else{var i=this._organiseData(arguments[0],!0);i&&this._coordinator.emit("renderpartial",{min:this._min,max:this._max,data:[i]})}return this},setData:function(t){var e=t.data,i=e.length;this._data=[],this._radi=[];for(var n=0;n<i;n++)this._organiseData(e[n],!1);return this._max=t.max,this._min=t.min||0,this._onExtremaChange(),this._coordinator.emit("renderall",this._getInternalData()),this},removeData:function(){},setDataMax:function(t){return this._max=t,this._onExtremaChange(),this._coordinator.emit("renderall",this._getInternalData()),this},setDataMin:function(t){return this._min=t,this._onExtremaChange(),this._coordinator.emit("renderall",this._getInternalData()),this},setCoordinator:function(t){this._coordinator=t},_getInternalData:function(){return{max:this._max,min:this._min,data:this._data,radi:this._radi}},getData:function(){return this._unOrganizeData()}},yA),CA=function(){var t=function(t){var e=t.gradient||t.defaultGradient,i=document.createElement("canvas"),n=i.getContext("2d");i.width=256,i.height=1;var r=n.createLinearGradient(0,0,256,1);for(var o in e)r.addColorStop(o,e[o]);return n.fillStyle=r,n.fillRect(0,0,256,1),n.getImageData(0,0,256,1).data},e=function(t,e){var i=document.createElement("canvas"),n=i.getContext("2d"),r=t,o=t;if(i.width=i.height=2*t,1==e)n.beginPath(),n.arc(r,o,t,0,2*Math.PI,!1),n.fillStyle="rgba(0,0,0,1)",n.fill();else{var s=n.createRadialGradient(r,o,t*e,r,o,t);s.addColorStop(0,"rgba(0,0,0,1)"),s.addColorStop(1,"rgba(0,0,0,0)"),n.fillStyle=s,n.fillRect(0,0,2*t,2*t)}return i};function i(e){var i=e.container,n=this.shadowCanvas=document.createElement("canvas"),r=this.canvas=e.canvas||document.createElement("canvas"),o=(this._renderBoundaries=[1e4,1e4,0,0],getComputedStyle(e.container)||{});r.className="heatmap-canvas",this._width=r.width=n.width=+o.width.replace(/px/,""),this._height=r.height=n.height=+o.height.replace(/px/,""),this.shadowCtx=n.getContext("2d"),this.ctx=r.getContext("2d"),r.style.cssText=n.style.cssText="position:absolute;left:0;top:0;",i.style.position="relative",i.appendChild(r),this._palette=t(e),this._templates={},this._setStyles(e)}return i.prototype={renderPartial:function(t){this._drawAlpha(t),this._colorize()},renderAll:function(t){this._clear(),this._drawAlpha(function(t){for(var e=[],i=t.min,n=t.max,r=t.radi,o=(t=t.data,Object.keys(t)),s=o.length;s--;)for(var a=o[s],A=Object.keys(t[a]),l=A.length;l--;){var c=A[l],u=t[a][c],h=r[a][c];e.push({x:a,y:c,value:u,radius:h})}return{min:i,max:n,data:e}}(t)),this._colorize()},_updateGradient:function(e){this._palette=t(e)},updateConfig:function(t){t.gradient&&this._updateGradient(t),this._setStyles(t)},setDimensions:function(t,e){this._width=t,this._height=e,this.canvas.width=this.shadowCanvas.width=t,this.canvas.height=this.shadowCanvas.height=e},_clear:function(){this.shadowCtx.clearRect(0,0,this._width,this._height),this.ctx.clearRect(0,0,this._width,this._height)},_setStyles:function(t){this._blur=0==t.blur?0:t.blur||t.defaultBlur,t.backgroundColor&&(this.canvas.style.backgroundColor=t.backgroundColor),this._opacity=255*(t.opacity||0),this._maxOpacity=255*(t.maxOpacity||t.defaultMaxOpacity),this._minOpacity=255*(t.minOpacity||t.defaultMinOpacity),this._useGradientOpacity=!!t.useGradientOpacity},_drawAlpha:function(t){for(var i=this._min=t.min,n=this._max=t.max,r=(t=t.data||[]).length,o=1-this._blur;r--;){var s,a=t[r],A=a.x,l=a.y,c=a.radius,u=Math.min(a.value,n),h=A-c,p=l-c,d=this.shadowCtx;this._templates[c]?s=this._templates[c]:this._templates[c]=s=e(c,o),d.globalAlpha=(u-i)/(n-i),d.drawImage(s,h,p),h<this._renderBoundaries[0]&&(this._renderBoundaries[0]=h),p<this._renderBoundaries[1]&&(this._renderBoundaries[1]=p),h+2*c>this._renderBoundaries[2]&&(this._renderBoundaries[2]=h+2*c),p+2*c>this._renderBoundaries[3]&&(this._renderBoundaries[3]=p+2*c)}},_colorize:function(){var t=this._renderBoundaries[0],e=this._renderBoundaries[1],i=this._renderBoundaries[2]-t,n=this._renderBoundaries[3]-e,r=this._width,o=this._height,s=this._opacity,a=this._maxOpacity,A=this._minOpacity,l=this._useGradientOpacity;t<0&&(t=0),e<0&&(e=0),t+i>r&&(i=r-t),e+n>o&&(n=o-e);for(var c=this.shadowCtx.getImageData(t,e,i,n),u=c.data,h=u.length,p=this._palette,d=3;d<h;d+=4){var f,g=u[d],m=4*g;if(m)f=s>0?s:g<a?g<A?A:g:a,u[d-3]=p[m],u[d-2]=p[m+1],u[d-1]=p[m+2],u[d]=l?p[m+3]:f}this.ctx.putImageData(c,t,e),this._renderBoundaries=[1e3,1e3,0,0]},getValueAt:function(t){var e=this.shadowCtx.getImageData(t.x,t.y,1,1).data[3],i=this._max,n=this._min;return Math.abs(i-n)*(e/255)>>0},getDataURL:function(){return this.canvas.toDataURL()}},i}(),BA=function(){var t=!1;return"canvas2d"===_A.defaultRenderer&&(t=CA),t}(),bA=function(){for(var t={},e=arguments.length,i=0;i<e;i++){var n=arguments[i];for(var r in n)t[r]=n[r]}return t},EA=function(){var t=function(){function t(){this.cStore={}}return t.prototype={on:function(t,e,i){var n=this.cStore;n[t]||(n[t]=[]),n[t].push((function(t){return e.call(i,t)}))},emit:function(t,e){var i=this.cStore;if(i[t])for(var n=i[t].length,r=0;r<n;r++){(0,i[t][r])(e)}}},t}(),e=function(t){var e=t._renderer,i=t._coordinator,n=t._store;i.on("renderpartial",e.renderPartial,e),i.on("renderall",e.renderAll,e),i.on("extremachange",(function(e){t._config.onExtremaChange&&t._config.onExtremaChange({min:e.min,max:e.max,gradient:t._config.gradient||t._config.defaultGradient})})),n.setCoordinator(i)};function i(){var i=this._config=bA(_A,arguments[0]||{});if(this._coordinator=new t,i.plugin){var n=i.plugin;if(!_A.plugins[n])throw new Error("Plugin '"+n+"' not found. Maybe it was not registered.");var r=_A.plugins[n];this._renderer=new r.renderer(i),this._store=new r.store(i)}else this._renderer=new BA(i),this._store=new wA(i);e(this)}return i.prototype={addData:function(){return this._store.addData.apply(this._store,arguments),this},removeData:function(){return this._store.removeData&&this._store.removeData.apply(this._store,arguments),this},setData:function(){return this._store.setData.apply(this._store,arguments),this},setDataMax:function(){return this._store.setDataMax.apply(this._store,arguments),this},setDataMin:function(){return this._store.setDataMin.apply(this._store,arguments),this},configure:function(t){return this._config=bA(this._config,t),this._renderer.updateConfig(this._config),this._coordinator.emit("renderall",this._store._getInternalData()),this},repaint:function(){return this._coordinator.emit("renderall",this._store._getInternalData()),this},getData:function(){return this._store.getData()},getDataURL:function(){return this._renderer.getDataURL()},getValueAt:function(t){return this._store.getValueAt?this._store.getValueAt(t):this._renderer.getValueAt?this._renderer.getValueAt(t):null}},i}(),SA={create:function(t){return new EA(t)},register:function(t,e){_A.plugins[t]=e}};function xA(t,e,i,n){if(!e)return null;i||(i={}),this._cesium=t,this._options=i,this.CesiumHeatmap=n,this._id=this.CesiumHeatmap._getID(),this._options.gradient=this._options.gradient?this._options.gradient:this.CesiumHeatmap.defaults.gradient,this._options.maxOpacity=this._options.maxOpacity?this._options.maxOpacity:this.CesiumHeatmap.defaults.maxOpacity,this._options.minOpacity=this._options.minOpacity?this._options.minOpacity:this.CesiumHeatmap.defaults.minOpacity,this._options.blur=this._options.blur?this._options.blur:this.CesiumHeatmap.defaults.blur,this._mbounds=this.CesiumHeatmap.wgs84ToMercatorBB(e),this._setWidthAndHeight(this._mbounds),this._options.radius=Math.round(this._options.radius?this._options.radius:this.width>this.height?this.width/this.CesiumHeatmap.defaults.radiusFactor:this.height/this.CesiumHeatmap.defaults.radiusFactor),this._spacing=this._options.radius*this.CesiumHeatmap.defaults.spacingFactor,this._xoffset=this._mbounds.west,this._yoffset=this._mbounds.south,this.width=Math.round(this.width+2*this._spacing),this.height=Math.round(this.height+2*this._spacing),this._mbounds.west-=this._spacing*this._factor,this._mbounds.east+=this._spacing*this._factor,this._mbounds.south-=this._spacing*this._factor,this._mbounds.north+=this._spacing*this._factor,this.bounds=this.CesiumHeatmap.mercatorToWgs84BB(this._mbounds),this._rectangle=f.Rectangle.fromDegrees(this.bounds.west,this.bounds.south,this.bounds.east,this.bounds.north),this._container=this.CesiumHeatmap._getContainer(this.width,this.height,this._id),this._options.container=this._container,this._heatmap=SA.create(this._options),this._container.children[0].setAttribute("id",this._id+"-hm")}xA.prototype.wgs84PointToHeatmapPoint=function(t){return this.mercatorPointToHeatmapPoint(this.CesiumHeatmap.wgs84ToMercator(t))},xA.prototype.mercatorPointToHeatmapPoint=function(t){var e={};return e.x=Math.round((t.x-this._xoffset)/this._factor+this._spacing),e.y=Math.round((t.y-this._yoffset)/this._factor+this._spacing),e.y=this.height-e.y,e},xA.prototype._setWidthAndHeight=function(t){this.width=t.east>0&&t.west<0?t.east+Math.abs(t.west):Math.abs(t.east-t.west),this.height=t.north>0&&t.south<0?t.north+Math.abs(t.south):Math.abs(t.north-t.south),this._factor=1,this.width>this.height&&this.width>this.CesiumHeatmap.defaults.maxCanvasSize?(this._factor=this.width/this.CesiumHeatmap.defaults.maxCanvasSize,this.height/this._factor<this.CesiumHeatmap.defaults.minCanvasSize&&(this._factor=this.height/this.CesiumHeatmap.defaults.minCanvasSize)):this.height>this.width&&this.height>this.CesiumHeatmap.defaults.maxCanvasSize?(this._factor=this.height/this.CesiumHeatmap.defaults.maxCanvasSize,this.width/this._factor<this.CesiumHeatmap.defaults.minCanvasSize&&(this._factor=this.width/this.CesiumHeatmap.defaults.minCanvasSize)):this.width<this.height&&this.width<this.CesiumHeatmap.defaults.minCanvasSize?(this._factor=this.width/this.CesiumHeatmap.defaults.minCanvasSize,this.height/this._factor>this.CesiumHeatmap.defaults.maxCanvasSize&&(this._factor=this.height/this.CesiumHeatmap.defaults.maxCanvasSize)):this.height<this.width&&this.height<this.CesiumHeatmap.defaults.minCanvasSize&&(this._factor=this.height/this.CesiumHeatmap.defaults.minCanvasSize,this.width/this._factor>this.CesiumHeatmap.defaults.maxCanvasSize&&(this._factor=this.width/this.CesiumHeatmap.defaults.maxCanvasSize)),this.width=this.width/this._factor,this.height=this.height/this._factor},xA.prototype.setData=function(t,e,i){return!!(i&&i.length>0&&null!==t&&!1!==t&&null!==e&&!1!==e)&&(this._heatmap.setData({min:t,max:e,data:i}),this.updateLayer(),!0)},xA.prototype.setWGS84Data=function(t,e,i){if(i&&i.length>0&&null!==t&&!1!==t&&null!==e&&!1!==e){for(var n=[],r=0;r<i.length;r++){var o=i[r],s=this.wgs84PointToHeatmapPoint(o);(o.value||0===o.value)&&(s.value=o.value),n.push(s)}return this.setData(t,e,n)}return!1},xA.prototype.show=function(t){this._layer&&(this._layer.show=t)},xA.prototype.remove=function(){this._layer&&(this.CesiumHeatmap.defaults.useEntitiesIfAvailable&&this._cesium.entities?this._cesium.entities.remove(this._layer):this._cesium.scene.imageryLayers.remove(this._layer))},xA.prototype.updateLayer=function(){if(this.CesiumHeatmap.defaults.useEntitiesIfAvailable&&this._cesium.entities){this._layer&&this._cesium.entities.remove(this._layer);const t=new f.ImageMaterialProperty({image:this._heatmap._renderer.canvas});t.transparent=!0,this._layer=this._cesium.entities.add({show:!0,rectangle:{coordinates:this._rectangle,material:t}})}else this._layer&&this._cesium.scene.imageryLayers.remove(this._layer),this._layer=this._cesium.scene.imageryLayers.addImageryProvider(this.CesiumHeatmap._getImageryProvider(this))};var IA=xA,FA={defaults:{useEntitiesIfAvailable:!0,minCanvasSize:700,maxCanvasSize:2e3,radiusFactor:60,spacingFactor:1.5,maxOpacity:.8,minOpacity:.1,blur:.85,gradient:{".3":"blue",".65":"yellow",".8":"orange",".95":"red"}},create:function(t,e,i){return new IA(t,e,i,this)},_getContainer:function(t,e,i){var n=document.createElement("div");return i&&n.setAttribute("id",i),n.setAttribute("style","width: "+t+"px; height: "+e+"px; margin: 0px; display: none;"),document.body.appendChild(n),n},_getImageryProvider:function(t){var e=t._heatmap.getDataURL(),i=new f.SingleTileImageryProvider({url:e,rectangle:t._rectangle});return i._tilingScheme=new f.WebMercatorTilingScheme({rectangleSouthwestInMeters:new f.Cartesian2(t._mbounds.west,t._mbounds.south),rectangleNortheastInMeters:new f.Cartesian2(t._mbounds.east,t._mbounds.north)}),i},_getID:function(t){for(var e="",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=0;n<(t||8);n++)e+=i.charAt(Math.floor(Math.random()*i.length));return e}},OA=new f.WebMercatorProjection;FA.wgs84ToMercator=function(t){var e=OA.project(f.Cartographic.fromDegrees(t.x,t.y));return{x:e.x,y:e.y}},FA.wgs84ToMercatorBB=function(t){var e=OA.project(f.Cartographic.fromDegrees(t.west,t.south)),i=OA.project(f.Cartographic.fromDegrees(t.east,t.north));return{north:i.y,east:i.x,south:e.y,west:e.x}},FA.mercatorToWgs84=function(t){var e=OA.unproject(new f.Cartesian3(t.x,t.y));return{x:e.longitude,y:e.latitude}},FA.mercatorToWgs84BB=function(t){var e=OA.unproject(new f.Cartesian3(t.west,t.south)),i=OA.unproject(new f.Cartesian3(t.east,t.north));return{north:this.rad2deg(i.latitude),east:this.rad2deg(i.longitude),south:this.rad2deg(e.latitude),west:this.rad2deg(e.longitude)}},FA.deg2rad=function(t){return t*(Math.PI/180)},FA.rad2deg=function(t){return t/(Math.PI/180)};var PA=FA;class TA extends Va{constructor(t){super(t)}init(){this._defaultStyle=Object.assign({gradient:{".3":"blue",".65":"yellow",".8":"orange",".95":"red"}},this._options),this.handerData()}handerData(){const{data:t}=this._options,e=t.map(t=>({x:t.longitude,y:t.latitude,value:t.value||1})),i=e.map(t=>t.x),n=e.map(t=>t.y),r=e.map(t=>t.value);return{data:e,bounds:{west:Math.min(...i),east:Math.max(...i),south:Math.min(...n),north:Math.max(...n)},valueMin:Math.min(...r),valueMax:Math.max(...r)}}addToViewer(t){const{data:e,bounds:i,valueMin:n,valueMax:r}=this.handerData(),{ended:o}=t;this._instance=PA.create(Bt.getEngine(this._userViewer),i,this._options),this._instance.setWGS84Data(n,r,e),this._userViewer.viewer.layerCache.add(this),at(!0,o)}remove(t={}){const{ended:e}=t;this._instance&&(this._instance.remove(),this._instance=null,this._userViewer.viewer.layerCache.remove(this),at(!0,e))}show(){this._instance.show(!0)}hide(){this._instance.show(!1)}}class LA extends Va{constructor(t){super(t)}init(){this._isGlobal=!0,this._style=Object.assign({imgUrl:Bt.getMapConfig(this._userViewer).distUrl+"Imgs/snowflake_particle.png",startColor:"rgba(255,255,255,0)",endColor:"rgba(255,255,255,1)",startScale:.5,endScale:1,emissionRate:500,imageSize:1,minimumImageSize:12,maximumImageSize:24,minimumSpeed:-1,maximumSpeed:0,lifetime:15,radius:1e5,loop:!0},this._options),this._handlerData()}_handlerData(){const{position:t,imgUrl:e,startColor:i,endColor:n,startScale:r,endScale:o,minimumImageSize:s,maximumImageSize:a,minimumSpeed:A,maximumSpeed:l,emissionRate:c,lifetime:u,radius:h,loop:p}=this.getStyle();let d=new f.Cartesian3;const g=new f.ParticleSystem({image:e,startColor:i,endColor:n,startScale:r,endScale:o,minimumImageSize:s,maximumImageSize:a,minimumSpeed:A,maximumSpeed:l,emissionRate:c,lifetime:u,loop:p,emitter:new f.SphereEmitter(h),modelMatrix:f.Transforms.eastNorthUpToFixedFrame(f.Cartesian3.fromDegrees(t.lng,t.lat,t.alt)),updateCallback:(e,i)=>{d=f.Cartesian3.normalize(e.position,d),f.Cartesian3.multiplyByScalar(d,f.Math.randomBetween(-30,-300),d),e.velocity=f.Cartesian3.add(e.velocity,d,e.velocity);const n=f.Cartesian3.distance(f.Cartesian3.fromDegrees(t.lng,t.lat,t.alt),e.position);e.endColor.alpha=n>h?0:1/(n/h+.1)}});this._container.add(g),this._particle=g}setProperty(t){const{emissionRate:e,startColor:i,endColor:n,startScale:r,endScale:o,minimumSpeed:s,maximumSpeed:a,minimumImageSize:A,maximumImageSize:l,lifetime:c,loop:u}=this.getStyle(t);this._particle.emissionRate=e,this._particle.startColor=i,this._particle.endColor=n,this._particle.startScale=r,this._particle.endScale=o,this._particle.minimumImageSize=A,this._particle.maximumImageSize=l,this._particle.minimumSpeed=s,this._particle.maximumSpeed=a,this._particle.lifetime=c,this._particle.loop=u}getStyle(t={}){const e=Object.assign(this._style,t),{position:i,imgUrl:n,startColor:r,endColor:o,startScale:s,endScale:a,minimumSpeed:A,maximumSpeed:l,minimumImageSize:c,maximumImageSize:u,emissionRate:h,lifetime:p,radius:d,loop:g}=e;return{position:i,imgUrl:n,startColor:f.Color.fromCssColorString(r),endColor:f.Color.fromCssColorString(o),startScale:s,endScale:a,minimumImageSize:new f.Cartesian2(c,c),maximumImageSize:new f.Cartesian2(u,u),minimumSpeed:A,maximumSpeed:l,emissionRate:h,lifetime:p,radius:d,loop:g}}setPosition(t){const{radius:e}=this.getStyle(),i=f.Transforms.eastNorthUpToFixedFrame(f.Cartesian3.fromDegrees(t.lng,t.lat,t.alt));let n=new f.Cartesian3;this._particle.modelMatrix=i,this._particle.updateCallback=(i,r)=>{n=f.Cartesian3.normalize(i.position,n),f.Cartesian3.multiplyByScalar(n,f.Math.randomBetween(-30,-300),n),i.velocity=f.Cartesian3.add(i.velocity,n,i.velocity);const o=f.Cartesian3.distance(f.Cartesian3.fromDegrees(t.lng,t.lat,t.alt),i.position);i.endColor.alpha=o>e?0:1/(o/e+.1)}}}class MA extends Va{constructor(t){super(t)}init(){this._isGlobal=!0,this._style=Object.assign({imgUrl:Bt.getMapConfig(this._userViewer).distUrl+"Imgs/circular_particle.png",color:"#457FB2",startScale:1,endScale:0,emissionRate:500,minimumImageSize:12,maximumImageSize:24,speed:-1,lifetime:15,radius:1e5,loop:!0},this._options),this._handlerData()}_handlerData(){const{position:t,imgUrl:e,startColor:i,endColor:n,startScale:r,endScale:o,speed:s,emissionRate:a,lifetime:A,minimumImageSize:l,maximumImageSize:c,radius:u,loop:h}=this.getStyle();let p=new f.Cartesian3;const d=new f.ParticleSystem({image:e,startColor:i,endColor:n,startScale:r,endScale:o,speed:s,emissionRate:a,loop:h,lifetime:A,minimumImageSize:l,maximumImageSize:c,emitter:new f.SphereEmitter(u),modelMatrix:f.Transforms.eastNorthUpToFixedFrame(f.Cartesian3.fromDegrees(t.lng,t.lat,t.alt)),updateCallback:(e,i)=>{p=f.Cartesian3.normalize(e.position,p),p=f.Cartesian3.multiplyByScalar(p,-1050,p),e.position=f.Cartesian3.add(e.position,p,e.position);const n=f.Cartesian3.distance(f.Cartesian3.fromDegrees(t.lng,t.lat,t.alt),e.position);e.endColor.alpha=n>u?0:f.Color.BLUE.alpha/(n/u+.1)}});this._container.add(d),this._particle=d}setProperty(t){const{emissionRate:e,startColor:i,endColor:n,startScale:r,endScale:o,speed:s,lifetime:a,loop:A,minimumImageSize:l,maximumImageSize:c}=this.getStyle(t);this._particle.emissionRate=e,this._particle.startColor=i,this._particle.endColor=n,this._particle.startScale=r,this._particle.endScale=o,this._particle.lifetime=a,this._particle.minimumImageSize=l,this._particle.maximumImageSize=c,this._particle.speed=s,this._particle.loop=A}getStyle(t={}){const e=Object.assign(this._style,t),{position:i,imgUrl:n,color:r,startScale:o,endScale:s,emissionRate:a,minimumImageSize:A,maximumImageSize:l,speed:c,lifetime:u,radius:h,loop:p}=e;return{position:i,imgUrl:n,startColor:f.Color.fromCssColorString(r).withAlpha(0),endColor:f.Color.fromCssColorString(r).withAlpha(.98),startScale:o,endScale:s,emissionRate:a,minimumImageSize:new f.Cartesian2(A,2*A),maximumImageSize:new f.Cartesian2(l,2*l),speed:c,lifetime:u,radius:h,loop:p}}setPosition(t){const{radius:e}=this.getStyle(),i=f.Transforms.eastNorthUpToFixedFrame(f.Cartesian3.fromDegrees(t.lng,t.lat,t.alt));let n=new f.Cartesian3;this._particle.modelMatrix=i,this._particle.updateCallback=(i,r)=>{n=f.Cartesian3.normalize(i.position,n),n=f.Cartesian3.multiplyByScalar(n,-1050,n),i.position=f.Cartesian3.add(i.position,n,i.position);const o=f.Cartesian3.distance(f.Cartesian3.fromDegrees(t.lng,t.lat,t.alt),i.position);i.endColor.alpha=o>e?0:f.Color.BLUE.alpha/(o/e+.1)}}}class UA extends Va{constructor(t){super(t)}init(){this._style=Object.assign({imgUrl:Bt.getMapConfig(this._userViewer).distUrl+"Imgs/smoke.png",startColor:"rgba(0,0,0,0.7)",endColor:"rgba(255,255,255,0)",startScale:1,endScale:5,minimumParticleLife:1.2,maximumParticleLife:7,minimumSpeed:1,maximumSpeed:4,imageSize:25,emissionRate:5,radius:2,lifetime:16,gravity:20,loop:!0,sizeInMeters:!0},this._options),this._handlerData()}_handlerData(){const{position:t,imgUrl:e,startColor:i,endColor:n,startScale:r,endScale:o,imageSize:s,minimumParticleLife:a,maximumParticleLife:A,minimumSpeed:l,maximumSpeed:c,emissionRate:u,lifetime:h,radius:p,sizeInMeters:d,loop:g}=this.getStyle(),m=new f.Matrix4,y=new f.Cartesian3,v=new f.Quaternion;let _=new f.HeadingPitchRoll;const w=new f.TranslationRotationScale,C=new f.Cartesian3,B=new f.ParticleSystem({image:e,startColor:i,endColor:n,startScale:r,endScale:o,minimumParticleLife:a,maximumParticleLife:A,minimumSpeed:l,maximumSpeed:c,imageSize:s,emissionRate:u,lifetime:h,sizeInMeters:d,loop:g,emitter:new f.CircleEmitter(p),modelMatrix:f.Transforms.eastNorthUpToFixedFrame(f.Cartesian3.fromDegrees(t.lng,t.lat,t.alt)),emitterModelMatrix:(_=f.HeadingPitchRoll.fromDegrees(0,0,0,_),w.translation=f.Cartesian3.fromElements(-4,0,1.4,y),w.rotation=f.Quaternion.fromHeadingPitchRoll(_,v),f.Matrix4.fromTranslationRotationScale(w,m)),updateCallback:(t,e)=>{const i=t.position;f.Cartesian3.normalize(i,C),f.Cartesian3.multiplyByScalar(C,this._style.gravity*e,C),t.velocity=f.Cartesian3.add(t.velocity,C,t.velocity)}});this._container.add(B),this._particle=B}setProperty(t){const{emissionRate:e,startColor:i,endColor:n,startScale:r,endScale:o,minimumSpeed:s,maximumSpeed:a,minimumParticleLife:A,maximumParticleLife:l,lifetime:c,imageSize:u,sizeInMeters:h,loop:p}=this.getStyle(t);this._particle.emissionRate=e,this._particle.startColor=i,this._particle.endColor=n,this._particle.startScale=r,this._particle.endScale=o,this._particle.minimumSpeed=s,this._particle.maximumSpeed=a,this._particle.minimumParticleLife=A,this._particle.maximumParticleLife=l,this._particle.lifetime=c,this._particle.imageSize=u,this._particle.sizeInMeters=h,this._particle.loop=p}getStyle(t={}){const e=Object.assign(this._style,t),{position:i,imgUrl:n,startColor:r,endColor:o,startScale:s,endScale:a,minimumParticleLife:A,maximumParticleLife:l,minimumSpeed:c,maximumSpeed:u,emissionRate:h,imageSize:p,lifetime:d,radius:g,gravity:m,sizeInMeters:y,loop:v}=e;return{position:i,imgUrl:n,startColor:f.Color.fromCssColorString(r),endColor:f.Color.fromCssColorString(o),startScale:s,endScale:a,minimumParticleLife:A,maximumParticleLife:l,minimumSpeed:c,maximumSpeed:u,imageSize:new f.Cartesian2(p,p),emissionRate:h,lifetime:d,radius:g,gravity:m,sizeInMeters:y,loop:v}}setPosition(t){const e=f.Transforms.eastNorthUpToFixedFrame(f.Cartesian3.fromDegrees(t.lng,t.lat,t.alt));this._particle.modelMatrix=e}}class DA extends Va{constructor(t){super(t)}init(){this._style=Object.assign({color:"rgb(255,0,0)",speed:100,radius:.1,lifetime:10,imageSize:7,loop:!0,burstNumber:3},this._options),this._handlerData()}_handlerData(){const{position:t,startColor:e,endColor:i,speed:n,imageSize:r,lifetime:o,radius:s,loop:a,burstNumber:A}=this.getStyle(),l=f.Transforms.eastNorthUpToFixedFrame(f.Cartesian3.fromDegrees(t.lng,t.lat,t.alt)),c=f.Matrix4.fromTranslation(new f.Cartesian3,new f.Matrix4),u=f.Matrix4.multiply(l,c,new f.Matrix4),h=f.Matrix4.inverseTransformation(u,u),p=f.Math.randomBetween(30,100),d=.7*((p-30)/70)+.3,g=[];for(let t=0;t<A;++t)g.push(new f.ParticleBurst({time:f.Math.nextRandomNumber()*o,minimum:400,maximum:400}));const m=new f.Cartesian3,y=new f.ParticleSystem({image:(()=>{const t=document.createElement("canvas");t.width=20,t.height=20;const e=t.getContext("2d");return e.beginPath(),e.arc(8,8,8,0,f.Math.TWO_PI,!0),e.closePath(),e.fillStyle="rgb(255, 255, 255)",e.fill(),t})(),startColor:e,endColor:i,speed:n,imageSize:r,emissionRate:0,particleLife:d,lifetime:o,emitter:new f.SphereEmitter(s),modelMatrix:l,emitterModelMatrix:c,bursts:g,loop:a,updateCallback:function(t){const e=f.Matrix4.multiplyByPoint(h,t.position,m);f.Cartesian3.magnitudeSquared(e)>=p*p&&f.Cartesian3.clone(f.Cartesian3.ZERO,t.velocity)}});this._container.add(y),this._particle=y}setProperty(t){const{startColor:e,endColor:i,lifetime:n,imageSize:r,speed:o,loop:s}=this.getStyle(t);this._particle.startColor=e,this._particle.endColor=i,this._particle.lifetime=n,this._particle.imageSize=r,this._particle.speed=o,this._particle.loop=s}getStyle(t={}){const e=Object.assign(this._style,t),{position:i,color:n,speed:r,imageSize:o,lifetime:s,radius:a,loop:A,burstNumber:l}=e;return{position:i,startColor:f.Color.fromCssColorString(n),endColor:f.Color.fromCssColorString(n).withAlpha(0),speed:r,lifetime:s,imageSize:new f.Cartesian2(o,o),radius:a,loop:A,burstNumber:l}}setPosition(t){const e=f.Transforms.eastNorthUpToFixedFrame(f.Cartesian3.fromDegrees(t.lng,t.lat,t.alt)),i=f.Matrix4.fromTranslation(new f.Cartesian3,new f.Matrix4),n=f.Matrix4.multiply(e,i,new f.Matrix4),r=f.Matrix4.inverseTransformation(n,n),o=f.Math.randomBetween(30,100),s=new f.Cartesian3;this._particle.modelMatrix=e,this._particle.emitterModelMatrix=i,this._particle.updateCallback=function(t){const e=f.Matrix4.multiplyByPoint(r,t.position,s);f.Cartesian3.magnitudeSquared(e)>=o*o&&f.Cartesian3.clone(f.Cartesian3.ZERO,t.velocity)}}}class QA extends Va{constructor(t){super(t)}init(){this._style=Object.assign({imgUrl:Bt.getMapConfig(this._userViewer).distUrl+"Imgs/smoke.png",color:"#fff",startScale:1,endScale:2,minimumParticleLife:.5,maximumParticleLife:1.6,minimumSpeed:5,maximumSpeed:10,emissionRate:310,radius:2.5,imageSize:5,gravity:-20},this._options),this._handlerData()}_handlerData(){const{position:t,targetPosition:e,imgUrl:i,startColor:n,endColor:r,startScale:o,endScale:s,minimumParticleLife:a,maximumParticleLife:A,minimumSpeed:l,maximumSpeed:c,emissionRate:u,imageSize:h,radius:p}=this.getStyle(),d=new f.ParticleSystem({image:i,startColor:n,endColor:r,startScale:o,endScale:s,minimumParticleLife:a,maximumParticleLife:A,minimumSpeed:l,maximumSpeed:c,emissionRate:u,imageSize:h,emitter:new f.CircleEmitter(p),modelMatrix:f.Transforms.eastNorthUpToFixedFrame(f.Cartesian3.fromDegrees(t.lng,t.lat,t.alt)),emitterModelMatrix:(()=>{const t=new f.Matrix4,e=f.HeadingPitchRoll.fromDegrees(0,0,0),i=new f.TranslationRotationScale;return i.translation=f.Cartesian3.fromElements(0,0,0),i.rotation=f.Quaternion.fromHeadingPitchRoll(e),f.Matrix4.fromTranslationRotationScale(i,t)})(),updateCallback:(i,n)=>{const r=(()=>{const i=f.Cartesian3.fromDegrees(t.lng,t.lat,t.alt),n=f.Cartesian3.fromDegrees(e.lng,e.lat,e.alt);return f.Cartesian3.normalize(f.Cartesian3.subtract(n,i,new f.Cartesian3),new f.Cartesian3)})();i.velocity=f.Cartesian3.add(i.velocity,r,i.velocity)}});this._container.add(d),this._particle=d}setProperty(t){const{emissionRate:e,startColor:i,endColor:n,startScale:r,endScale:o,minimumParticleLife:s,maximumParticleLife:a,minimumSpeed:A,maximumSpeed:l,imageSize:c,gravity:u}=this.getStyle(t);this._particle.emissionRate=e,this._particle.startColor=i,this._particle.endColor=n,this._particle.startScale=r,this._particle.endScale=o,this._particle.minimumParticleLife=s,this._particle.maximumParticleLife=a,this._particle.minimumSpeed=A,this._particle.maximumSpeed=l,this._particle.imageSize=c,this._particle.gravity=u}getStyle(t={}){const e=Object.assign(this._style,t),{position:i,targetPosition:n,imgUrl:r,color:o,startScale:s,endScale:a,minimumParticleLife:A,maximumParticleLife:l,minimumSpeed:c,maximumSpeed:u,emissionRate:h,imageSize:p,radius:d,gravity:g}=e;return{position:i,targetPosition:n,imgUrl:r,startColor:f.Color.fromCssColorString(o).withAlpha(0),endColor:f.Color.fromCssColorString(o).withAlpha(.65),startScale:s,endScale:a,minimumParticleLife:A,maximumParticleLife:l,minimumSpeed:c,maximumSpeed:u,emissionRate:h,imageSize:new f.Cartesian2(p,p),radius:d,gravity:g}}}class RA extends Va{constructor(t){super(t)}init(){this._style=Object.assign({imgUrl:Bt.getMapConfig(this._userViewer).distUrl+"Imgs/fire.png",startColor:"rgba(255,0,0,0.7)",endColor:"rgba(255,255,0,0)",startScale:1,endScale:5,minimumParticleLife:1.2,maximumParticleLife:4,minimumSpeed:1,maximumSpeed:4,imageSize:25,emissionRate:5,lifetime:12,radius:2,gravity:20,loop:!0,sizeInMeters:!1},this._options),this._handlerData()}_handlerData(){const{position:t,imgUrl:e,startColor:i,endColor:n,startScale:r,endScale:o,minimumParticleLife:s,maximumParticleLife:a,minimumSpeed:A,maximumSpeed:l,imageSize:c,emissionRate:u,lifetime:h,radius:p,loop:d,sizeInMeters:g}=this.getStyle(),m=new f.Matrix4,y=new f.Cartesian3,v=new f.Quaternion;let _=new f.HeadingPitchRoll;const w=new f.TranslationRotationScale,C=new f.Cartesian3,B=new f.ParticleSystem({image:e,startColor:i,endColor:n,startScale:r,endScale:o,minimumParticleLife:s,maximumParticleLife:a,minimumSpeed:A,maximumSpeed:l,imageSize:c,emissionRate:u,lifetime:h,bursts:[new f.ParticleBurst({time:3,minimum:5,maximum:20}),new f.ParticleBurst({time:6,minimum:20,maximum:50}),new f.ParticleBurst({time:9,minimum:50,maximum:100})],loop:d,sizeInMeters:g,emitter:new f.SphereEmitter(p),modelMatrix:f.Transforms.eastNorthUpToFixedFrame(f.Cartesian3.fromDegrees(t.lng,t.lat,t.alt)),emitterModelMatrix:(_=f.HeadingPitchRoll.fromDegrees(0,0,0,_),w.translation=f.Cartesian3.fromElements(-4,0,1.4,y),w.rotation=f.Quaternion.fromHeadingPitchRoll(_,v),f.Matrix4.fromTranslationRotationScale(w,m)),updateCallback:(t,e)=>{const i=t.position;f.Cartesian3.normalize(i,C),f.Cartesian3.multiplyByScalar(C,this._style.gravity*e,C),t.velocity=f.Cartesian3.add(t.velocity,C,t.velocity)}});this._container.add(B),this._particle=B}setProperty(t){const{emissionRate:e,startColor:i,endColor:n,startScale:r,endScale:o,minimumSpeed:s,maximumSpeed:a,minimumParticleLife:A,maximumParticleLife:l,lifetime:c,imageSize:u,loop:h,sizeInMeters:p}=this.getStyle(t);this._particle.emissionRate=e,this._particle.startColor=i,this._particle.endColor=n,this._particle.startScale=r,this._particle.endScale=o,this._particle.minimumSpeed=s,this._particle.maximumSpeed=a,this._particle.minimumParticleLife=A,this._particle.maximumParticleLife=l,this._particle.lifetime=c,this._particle.imageSize=u,this._particle.loop=h,this._particle.sizeInMeters=p}getStyle(t={}){const e=Object.assign(this._style,t),{position:i,imgUrl:n,startColor:r,endColor:o,startScale:s,endScale:a,minimumParticleLife:A,maximumParticleLife:l,minimumSpeed:c,maximumSpeed:u,imageSize:h,emissionRate:p,lifetime:d,radius:g,loop:m,sizeInMeters:y}=e;return{position:i,imgUrl:n,startColor:f.Color.fromCssColorString(r),endColor:f.Color.fromCssColorString(o),startScale:s,endScale:a,minimumParticleLife:A,maximumParticleLife:l,minimumSpeed:c,maximumSpeed:u,imageSize:new f.Cartesian2(h,h),emissionRate:p,lifetime:d,radius:g,loop:m,sizeInMeters:y}}setPosition(t){const e=f.Transforms.eastNorthUpToFixedFrame(f.Cartesian3.fromDegrees(t.lng,t.lat,t.alt));this._particle.modelMatrix=e}}var NA=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},HA=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};class kA{constructor(t){}field(t,e,i){return this._instance.field(t,e,i),this}setSource(t){this._instance.setSource(t)}setData(t){this._instance.setData(t)}addToViewer(t){this._instance.addToViewer(t)}remove(t={}){this._instance.remove(t)}show(){this._instance.show()}hide(){this._instance.hide()}setProperty(t){this._instance.setProperty(t)}}NA([R(is.addToViewer),HA("design:type",Function),HA("design:paramtypes",[Object]),HA("design:returntype",void 0)],kA.prototype,"addToViewer",null),NA([R(is.remove),HA("design:type",Function),HA("design:paramtypes",[Object]),HA("design:returntype",void 0)],kA.prototype,"remove",null);var VA={common:{viewer:{type:k.Object,required:!0}},dynamicLineInit:{lineString:{type:k.Array},polyline:{type:k.Array},width:{type:k.Number,validator:function(t){return t>0}},repeat:{type:k.Array,validator:function(t){return 2==t.length&&(t[0]>=1&&t[1]>=1)}},url:{type:k.String},dynamic:{type:k.Boolean},color:{type:k.Color},speed:{type:k.Number},nearDistance:{type:k.Number,validator:function(t){return t>0}},farDistance:{type:k.Number,validator:function(t){return t>0}}},fenceInit:{viewer:{type:k.Object,required:!0},data:{type:k.Array},colors:{type:k.Array},speed:{validator:function(t){return t>0}},dynamic:{type:k.Boolean},repeat:{type:k.Number,validator:function(t){return t>=1}},brightness:{type:k.Number,validator:function(t){return t>0}},height:{type:k.Number,validator:function(t){return t>0}},color:{type:k.Color},axisY:{type:k.Boolean},image:{type:k.String},type:{type:k.String}},colorWallInit:{viewer:{type:k.Object,required:!0},speed:{validator:function(t){return t>0}}},radarScanInit:{viewer:{type:k.Object,required:!0},point:{type:k.Array},speed:{validator:function(t){return t>0}},radius:{validator:function(t){return t>0}},alpha:{type:k.Number,validator:function(t){return t>=0&&t<=1}}},circleSpreadInit:{viewer:{type:k.Object,required:!0},point:{type:k.Array},color:{type:k.Color},speed:{validator:function(t){return t>0}},radius:{validator:function(t){return t>0}},alpha:{type:k.Number,validator:function(t){return t>=0&&t<=1}},gradient:{type:k.Boolean},bearing1:{type:k.Number},bearing2:{type:k.Number,validator:function(t){return t<=360}}},reflectionSurfaceInit:{viewer:{type:k.Object,required:!0},data:{type:k.Array,required:!0}},sphereShiledInit:{viewer:{type:k.Object,required:!0},point:{type:k.Array},colors:{type:k.Array,required:!0},speed:{validator:function(t){return t>0}},radius:{validator:function(t){return t>0}}},richArrowEffectInit:{viewer:{type:k.Object,required:!0},data:{type:k.Array},positions:{type:k.Array},height:{type:k.Number},slope:{type:k.Number,validator:function(t){return t>0}},wing:{type:k.Number,validator:function(t){return t>0}},space:{type:k.Number,validator:function(t){return t>0}},color:{type:[k.Array,k.String]},scaleDistance:{type:k.Number,validator:function(t){return t>=1}}},InnerGlowPolygonEffectInit:{viewer:{type:k.Object,required:!0},data:{type:k.Array},color:{type:k.Color},brightStrength:{type:k.Number},fgNum:{type:k.Number},blurRadius:{type:k.Number},bloomSizeScale:{type:k.Number,validator:function(t){return t>0}}},waterEffectInit:{viewer:{type:k.Object,required:!0},polygon:{type:k.Array},frequency:{type:k.Number,validator:function(t){return t>0}},animationSpeed:{type:k.Number,validator:function(t){return t>=0}},amplitude:{type:k.Number,validator:function(t){return t>=0}},specularIntensity:{type:k.Number,validator:function(t){return t>=0}},opacity:{type:k.Number,validator:function(t){return t>=0&&t<=1}},baseWaterColor:{type:k.Color},blendColor:{type:k.Color},clampToGround:{type:k.Boolean}},corridorValidate:{viewer:{type:k.Object,required:!0},height:{type:k.Number,validator:function(t){return t>0}},width:{type:k.Number,validator:function(t){return t>0}},color:{type:k.Color},outlineColor:{type:k.Color},outline:{type:k.Boolean},opacity:{type:k.Number,validator:function(t){return t>=0&&t<=1}}},weatherValidate:{viewer:{type:k.Object,required:!0},type:{type:k.String}},snowCoverValidate:{viewer:{type:k.Object,required:!0},maxHeight:{type:k.Number},alpha:{type:k.Number,validator:function(t){return t>=0&&t<=1}}},baseMapMaskValidate:{viewer:{type:k.Object,required:!0},polygon:{type:k.Array,required:!0},color:{type:k.Color},alpha:{type:k.Number,validator:function(t){return t>=0&&t<=1}}},rainEffectInit:{viewer:{type:k.Object,required:!0},position:{type:k.Object,required:!0},color:{type:k.Color},emissionRate:{type:k.Number,validator:function(t){return t>0&&t<=1e4},message:"emissionRate range is (0,10000]"},maximumImageSize:{type:k.Number,validator:function(t){return t>0&&t<=48},message:"maximumImageSize range is (0,48]"},loop:{type:k.Boolean},lifetime:{type:k.Number}},rainEffectProperty:{color:{type:k.Color},emissionRate:{type:k.Number,validator:function(t){return t>0&&t<=1e4},message:"emissionRate range is (0,10000]"},maximumImageSize:{type:k.Number,validator:function(t){return t>0&&t<=48},message:"maximumImageSize range is (0,48]"},lifetime:{type:k.Number}},fireworkEffectInit:{viewer:{type:k.Object,required:!0},position:{type:k.Object,required:!0},color:{type:k.String},speed:{type:k.Number},burstNumber:{type:k.Number,validator:function(t){return t>=0&&t<=10},message:"burstNumber range is [0,10]"},loop:{type:k.Boolean},lifetime:{type:k.Number}},fireworkEffectProperty:{color:{type:k.Color},speed:{type:k.Number},burstNumber:{type:k.Number,validator:function(t){return t>=0&&t<=10},message:"burstNumber range is [0,10]"},lifetime:{type:k.Number}}},jA=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},GA=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let KA=class extends kA{constructor(t){super(t),this._instance=new Ka(t)}field(t,e,i){return this._instance.field(t,e,i),this}setSource(){}setPosition(t){return this._instance.setPosition(t),this}};KA=jA([H(VA.common),GA("design:paramtypes",[Object])],KA);var zA=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},WA=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let qA=class extends kA{constructor(t){super(t),this._instance=new ja(t)}on(t){t.event=gr[t.event],this._instance.on(t)}off(t){t.event=gr[t.event],this._instance.off(t)}setProperty(){}};zA([R(is.on),WA("design:type",Function),WA("design:paramtypes",[Object]),WA("design:returntype",void 0)],qA.prototype,"on",null),zA([R(is.off),WA("design:type",Function),WA("design:paramtypes",[Object]),WA("design:returntype",void 0)],qA.prototype,"off",null),qA=zA([H(VA.dynamicLineInit),WA("design:paramtypes",[Object])],qA);var XA=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},YA=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let JA=class extends kA{constructor(t){super(t),this._instance=new Ga(t)}on(t){t.event=gr[t.event],this._instance.on(t)}off(t){t.event=gr[t.event],this._instance.off(t)}setProperty(){}};XA([R(is.on),YA("design:type",Function),YA("design:paramtypes",[Object]),YA("design:returntype",void 0)],JA.prototype,"on",null),XA([R(is.off),YA("design:type",Function),YA("design:paramtypes",[Object]),YA("design:returntype",void 0)],JA.prototype,"off",null),JA=XA([H(VA.common),YA("design:paramtypes",[Object])],JA);var ZA=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},$A=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let tl=class extends kA{constructor(t){super(t),this._instance=new Wa(t)}on(t){t.event=gr[t.event],this._instance.on(t)}off(t){t.event=gr[t.event],this._instance.off(t)}setProperty(){}};ZA([R(is.on),$A("design:type",Function),$A("design:paramtypes",[Object]),$A("design:returntype",void 0)],tl.prototype,"on",null),ZA([R(is.off),$A("design:type",Function),$A("design:paramtypes",[Object]),$A("design:returntype",void 0)],tl.prototype,"off",null),tl=ZA([H(VA.fenceInit),$A("design:paramtypes",[Object])],tl);var el=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},il=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let nl=class extends kA{constructor(t){super(t),this._instance=new qa(t)}on(t){t.event=gr[t.event],this._instance.on(t)}off(t){t.event=gr[t.event],this._instance.off(t)}setProperty(){}};el([R(is.on),il("design:type",Function),il("design:paramtypes",[Object]),il("design:returntype",void 0)],nl.prototype,"on",null),el([R(is.off),il("design:type",Function),il("design:paramtypes",[Object]),il("design:returntype",void 0)],nl.prototype,"off",null),nl=el([H(VA.sphereShiledInit),il("design:paramtypes",[Object])],nl);var rl=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},ol=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let sl=class extends kA{constructor(t){super(t),this._instance=new Xa(t)}on(t){t.event=gr[t.event],this._instance.on(t)}off(t){t.event=gr[t.event],this._instance.off(t)}setProperty(){}};rl([R(is.on),ol("design:type",Function),ol("design:paramtypes",[Object]),ol("design:returntype",void 0)],sl.prototype,"on",null),rl([R(is.off),ol("design:type",Function),ol("design:paramtypes",[Object]),ol("design:returntype",void 0)],sl.prototype,"off",null),sl=rl([H(VA.radarScanInit),ol("design:paramtypes",[Object])],sl);var al=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},Al=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let ll=class extends kA{constructor(t){super(t),this._instance=new tA(t)}on(t){t.event=gr[t.event],this._instance.on(t)}off(t){t.event=gr[t.event],this._instance.off(t)}};al([R(is.on),Al("design:type",Function),Al("design:paramtypes",[Object]),Al("design:returntype",void 0)],ll.prototype,"on",null),al([R(is.off),Al("design:type",Function),Al("design:paramtypes",[Object]),Al("design:returntype",void 0)],ll.prototype,"off",null),ll=al([H(VA.colorWallInit),Al("design:paramtypes",[Object])],ll);var cl=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},ul=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let hl=class extends kA{constructor(t){super(t),this._instance=new eA(t)}on(t){t.event=gr[t.event],this._instance.on(t)}off(t){t.event=gr[t.event],this._instance.off(t)}setProperty(){}};cl([R(is.on),ul("design:type",Function),ul("design:paramtypes",[Object]),ul("design:returntype",void 0)],hl.prototype,"on",null),cl([R(is.off),ul("design:type",Function),ul("design:paramtypes",[Object]),ul("design:returntype",void 0)],hl.prototype,"off",null),hl=cl([H(VA.common),ul("design:paramtypes",[Object])],hl);var pl=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},dl=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let fl=class extends kA{constructor(t){super(t),this._instance=new Ja(t)}field(){return this}setSource(){}setProperty(){}};fl=pl([H(VA.reflectionSurfaceInit),dl("design:paramtypes",[Object])],fl);var gl=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},ml=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let yl=class extends kA{constructor(t){super(t),this._instance=new uA(t)}field(){return this}setSource(){}setProperty(){}};yl=gl([H({viewer:{type:k.Object,required:!0},point:{type:k.Array,required:!0}}),ml("design:paramtypes",[Object])],yl);var vl=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},_l=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let wl=class extends kA{constructor(t){super(t),this._instance=new iA(t)}field(){return this}setSource(){}setProperty(){}};wl=vl([H({viewer:{type:k.Object,required:!0},data:{type:k.Array,required:!0}}),_l("design:paramtypes",[Object])],wl);var Cl=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},Bl=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let bl=class extends kA{constructor(t){super(t),this._instance=new nA(t)}field(){return this}setSource(){}setProperty(){}};bl=Cl([H({viewer:{type:k.Object,required:!0},data:{type:k.Array,required:!0}}),Bl("design:paramtypes",[Object])],bl);var El=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},Sl=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let xl=class extends kA{constructor(t){super(t),this._instance=new mA(t)}on(t){t.event=gr[t.event],this._instance.on(t)}off(t){t.event=gr[t.event],this._instance.off(t)}setProperty(){}};El([R(is.on),Sl("design:type",Function),Sl("design:paramtypes",[Object]),Sl("design:returntype",void 0)],xl.prototype,"on",null),El([R(is.off),Sl("design:type",Function),Sl("design:paramtypes",[Object]),Sl("design:returntype",void 0)],xl.prototype,"off",null),xl=El([H(VA.InnerGlowPolygonEffectInit),Sl("design:paramtypes",[Object])],xl);const Il={type:x.STEPARROW,height:0,slope:5,wing:10,innerWing:5,space:2,scaleDistance:5,color:[{stop:0,color:"rgba(0,170,255,0)"},{stop:.1,color:"rgba(0,170,255,0)"},{stop:1,color:"rgba(0,170,255,1)"}]},Fl={height:0,slope:20,wing:10,innerWing:5,space:2,scaleDistance:3,color:"rgba(0,170,255,0.8)"},Ol={height:0,slope:20,wing:10,innerWing:5,space:2,scaleDistance:3,color:"rgba(0,170,255,0.8)"},Pl={height:0,slope:5,wing:10,innerWing:5,space:2,scaleDistance:2,color:"rgba(0,170,255,0.8)"};class Tl extends Va{constructor(t){super(t)}init(){this._container=new Z("customDataSource"),this._options.type==x.SINGLEARROW?this.globalStyle=Object.assign({},Fl,this._options):this._options.type==x.DOUBLEARROW?this.globalStyle=Object.assign({},Ol,this._options):this._options.type==x.DOUBLESTEPARROW?this.globalStyle=Object.assign({},Pl,this._options):this.globalStyle=Object.assign({},Il,this._options),this._options.positions&&this.setData([{positions:this._options.positions}])}setSource(t){if(!this.query)return;const{ended:e}=t;this.query.queryCustomInfo(Object.assign(Object.assign({},t),{callback:t=>{if(t.data&&t.data.total>0){let i=t.data.data.filter(t=>"LineString"==t.geometry.type).map(t=>{let e=t.geometry.coordinates;return Object.assign({positions:e},t.properties)});this.makeBounding(i),this.setData(i,e)}}}))}setData(t,e){this._container&&this._container.size>0&&this._container.removeAll(),t.forEach(t=>{let e=Object.assign({},this.globalStyle);const i=this.fieldMap.map(t=>t.props);for(let n of i){const i=this.fieldMap.find(t=>t.props===n);let r=(i||{}).value(t[i.field]);e[n]=r}e=Object.assign(Object.assign({},e),t),this._graphics(e)}),at(!0,e)}_graphics(t){if(!this._container)return;let e=t.positions[0][0],i=t.positions[0][1],n=t.positions[1][0],r=t.positions[1][1],o=t.height,s=f.Cartesian3.fromDegrees(e,i,o),a=f.Cartesian3.fromDegrees(n,r,o),A=f.Cartesian3.fromDegrees(e,r,o),l=f.Cartesian3.fromDegrees(n,i,o),c=f.Cartesian3.distance(s,a),u=f.Cartesian3.distance(s,A),h=f.Cartesian3.distance(a,l);const p=new f.Cartesian3;f.Cartesian3.subtract(a,s,p);let d=function(t){let o=document.createElement("canvas");o.width=u,o.height=h;let s,a=o.getContext("2d"),A=t;return e>=n&&i>=r?s=a.createLinearGradient(u,0,0,h):e<n&&i>=r?s=a.createLinearGradient(0,0,u,h):e>=n&&i<r?s=a.createLinearGradient(u,h,0,0):e<n&&i<r&&(s=a.createLinearGradient(0,h,u,0)),A.forEach(t=>{s.addColorStop(t.stop,t.color)}),a.fillStyle=s,a.fillRect(0,0,u,h),o},m=function(t){return Object(g.isArray)(t)?new f.ImageMaterialProperty({image:d(t),transparent:new f.ConstantProperty(!0)}):f.Color.fromCssColorString(t)},y=t.slope,v=t.wing,_=t.innerWing,w=t.space,C=t.scaleDistance,B=c/y/C>1?1:c/y/C,b=t.type;if(b==x.SINGLEARROW){let e=this._getOnePoint(c-(y-w)*B,_*B,s,p),i=this._getOnePoint(c-y*B,v*B,s,p);this._container.add({name:this._id,polygon:{hierarchy:{positions:[s,e[0],i[0],a,i[1],e[1],s]},height:o,material:m(t.color)}})}else if(b==x.DOUBLEARROW){let e=this._getOnePoint((y-w)*B,_*B,s,p),i=this._getOnePoint(y*B,v*B,s,p),n=this._getOnePoint(c-(y-w)*B,_*B,s,p),r=this._getOnePoint(c-y*B,v*B,s,p);this._container.add({name:this._id,polygon:{hierarchy:{positions:[s,i[0],e[0],n[0],r[0],a,r[1],n[1],e[1],i[1],s]},height:o,material:m(t.color)}})}else if(b==x.DOUBLESTEPARROW){B=c/(y+5+2*w)/C/2>1?1:c/(y+5+2*w)/C/2;let e=this._getpoint(c-(y+5+2*w)*B,y*B,v*B,s,p),i=this._getpoint(c-(y+5+w)*B,y*B,v*B,s,p),n=this._getpoint(c-(y+2+w)*B,y*B,v*B,s,p),r=this._getpoint(c-(y+2)*B,y*B,v*B,s,p),a=this._getpoint(c-y*B,y*B,v*B,s,p),A=this._getpoint((y+5+2*w)*B,-1*y*B,v*B,s,p),l=this._getpoint((y+5+w)*B,-1*y*B,v*B,s,p),u=this._getpoint((y+2+w)*B,-1*y*B,v*B,s,p),h=this._getpoint((y+2)*B,-1*y*B,v*B,s,p),d=this._getpoint(y*B,-1*y*B,v*B,s,p);this._container.add({name:this._id,polygon:{hierarchy:{positions:[A.rightPoint,A.secendPoint,A.leftPoint,e.leftPoint,e.secendPoint,e.rightPoint,A.rightPoint]},height:o,material:m(t.color)}});let f="";f=Object(g.isArray)(t.color)?(t.color[t.color.length-1]||{}).color:t.color,this._container.add({name:this._id,polygon:{hierarchy:{positions:[n.leftPoint,n.secendPoint,n.rightPoint,i.rightPoint,i.secendPoint,i.leftPoint,n.leftPoint]},height:o,material:m(f)}}),this._container.add({name:this._id,polygon:{hierarchy:{positions:[r.leftPoint,r.secendPoint,r.rightPoint,a.rightPoint,a.secendPoint,a.leftPoint,r.leftPoint]},height:o,material:m(f)}}),this._container.add({name:this._id,polygon:{hierarchy:{positions:[u.leftPoint,u.secendPoint,u.rightPoint,l.rightPoint,l.secendPoint,l.leftPoint,u.leftPoint]},height:o,material:m(f)}}),this._container.add({name:this._id,polygon:{hierarchy:{positions:[d.leftPoint,d.secendPoint,d.rightPoint,h.rightPoint,h.secendPoint,h.leftPoint,d.leftPoint]},height:o,material:m(f)}})}else{B=c/(y+5+2*w)/C>1?1:c/(y+5+2*w)/C;let e=this._getpoint(c-(y+5+2*w)*B,y*B,v*B,s,p),i=this._getpoint(c-(y+5+w)*B,y*B,v*B,s,p),n=this._getpoint(c-(y+2+w)*B,y*B,v*B,s,p),r=this._getpoint(c-(y+2)*B,y*B,v*B,s,p),a=this._getpoint(c-y*B,y*B,v*B,s,p);this._container.add({name:this._id,polygon:{hierarchy:{positions:[s,e.leftPoint,e.secendPoint,e.rightPoint,s]},height:o,material:m(t.color)}});let A="";A=Object(g.isArray)(t.color)?(t.color[t.color.length-1]||{}).color:t.color,this._container.add({name:this._id,polygon:{hierarchy:{positions:[n.leftPoint,n.secendPoint,n.rightPoint,i.rightPoint,i.secendPoint,i.leftPoint,n.leftPoint]},height:o,material:m(A)}}),this._container.add({name:this._id,polygon:{hierarchy:{positions:[r.leftPoint,r.secendPoint,r.rightPoint,a.rightPoint,a.secendPoint,a.leftPoint,r.leftPoint]},height:o,material:m(A)}})}}_getpoint(t,e,i,n,r){const o=new f.Cartesian3,s=new f.Ray(n,r);f.Ray.getPoint(s,t,o);const a=new f.Cartesian3;f.Cartesian3.cross(r,n,a);const A=new f.Cartesian3,l=new f.Ray(o,a);f.Ray.getPoint(l,i,A),f.Cartesian3.negate(a,a);const c=new f.Cartesian3,u=new f.Ray(o,a);f.Ray.getPoint(u,i,c);const h=new f.Cartesian3;return f.Ray.getPoint(s,t+e,h),{leftPoint:A,rightPoint:c,secendPoint:h}}_getOnePoint(t,e,i,n){const r=new f.Cartesian3,o=new f.Ray(i,n);f.Ray.getPoint(o,t,r);const s=new f.Cartesian3;f.Cartesian3.cross(n,i,s);const a=new f.Cartesian3,A=new f.Ray(r,s);f.Ray.getPoint(A,e,a),f.Cartesian3.negate(s,s);const l=new f.Cartesian3,c=new f.Ray(r,s);return f.Ray.getPoint(c,e,l),[a,l]}}var Ll=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},Ml=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let Ul=class extends kA{constructor(t){super(t),this._instance=new Tl(t)}on(t){t.event=gr[t.event],this._instance.on(t)}off(t){t.event=gr[t.event],this._instance.off(t)}setProperty(){}};Ll([R(is.on),Ml("design:type",Function),Ml("design:paramtypes",[Object]),Ml("design:returntype",void 0)],Ul.prototype,"on",null),Ll([R(is.off),Ml("design:type",Function),Ml("design:paramtypes",[Object]),Ml("design:returntype",void 0)],Ul.prototype,"off",null),Ul=Ll([H(VA.richArrowEffectInit),Ml("design:paramtypes",[Object])],Ul);class Dl extends Va{constructor(t){super(t)}init(){this._container=new Z("primitive");let t={normalMap:this._options.viewer.viewer.mapConfig.distUrl+"Imgs/waterNormals.jpg",frequency:8e3,animationSpeed:.02,amplitude:5,specularIntensity:.6,baseWaterColor:"#006ab4",blendColor:"#006ab4",opacity:.4,clampToGround:!1,height:1};this.globalStyle=Object.assign({},t,this._options),this._options.polygon&&this._handlerData(this.globalStyle)}setData(t){this._container.size>0&&this._container.removeAll();for(const e of t){let t=Object.assign({},this.globalStyle);const i=this.fieldMap.map(t=>t.props);for(let n of i){const i=this.fieldMap.find(t=>t.props===n);let r=(i||{}).value(e[i.field]);t[n]=r}t=Object.assign(Object.assign({},t),e),this._handlerData(t)}}setSource(t){this.query&&this.query.queryCustomInfo(Object.assign(Object.assign({},t),{callback:t=>{if(t.data&&t.data.total>0){let e=t.data.data.filter(t=>"Polygon"==t.geometry.type).map(t=>{let e=t.geometry.coordinates[0];return Object.assign({polygon:e},t.properties)});this.setData(e)}}}))}_handlerData(t){let e=t,i=t.polygon,n=f.Cartesian3.fromDegreesArray(Object(g.flattenDepth)(i)),r=new f.PolygonGeometry({polygonHierarchy:new f.PolygonHierarchy(n),extrudedHeight:e.height,height:e.height,vertexFormat:f.EllipsoidSurfaceAppearance.VERTEX_FORMAT});var o={geometryInstances:new f.GeometryInstance({geometry:r,id:this._id}),appearance:new f.EllipsoidSurfaceAppearance({aboveGround:!1,material:new f.Material({fabric:{type:"Water",uniforms:{normalMap:e.normalMap,frequency:e.frequency,animationSpeed:e.animationSpeed,amplitude:e.amplitude,specularIntensity:e.specularIntensity,baseWaterColor:f.Color.fromCssColorString(e.baseWaterColor),blendColor:f.Color.fromCssColorString(e.blendColor)}}}),fragmentShaderSource:this.getWaterShader(e.opacity)}),show:!0};let s=null;e.clampToGround?(o.classificationType=e.classificationType||f.ClassificationType.TERRAIN,s=new f.GroundPrimitive(o)):s=new f.Primitive(o),this._container.add(s)}getWaterShader(t=.5){return"varying vec3 v_positionMC;\n                varying vec3 v_positionEC;\n                varying vec2 v_st;\n                \n                void main()\n                {\n                    czm_materialInput materialInput;\n                    vec3 normalEC = normalize(czm_normal3D * czm_geodeticSurfaceNormal(v_positionMC, vec3(0.0), vec3(1.0)));\n                #ifdef FACE_FORWARD\n                    normalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);\n                #endif\n                    materialInput.s = v_st.s;\n                    materialInput.st = v_st;\n                    materialInput.str = vec3(v_st, 0.0);\n                    materialInput.normalEC = normalEC;\n                    materialInput.tangentToEyeMatrix = czm_eastNorthUpToEyeCoordinates(v_positionMC, materialInput.normalEC);\n                    vec3 positionToEyeEC = -v_positionEC;\n                    materialInput.positionToEyeEC = positionToEyeEC;\n                    czm_material material = czm_getMaterial(materialInput);\n                #ifdef FLAT\n                    gl_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n                #else\n                    gl_FragColor = czm_phong(normalize(positionToEyeEC), material, czm_lightDirectionEC);\n                    gl_FragColor.a = "+parseFloat(t).toFixed(2)+";\n                #endif\n                }"}}var Ql=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},Rl=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let Nl=class extends kA{constructor(t){super(t),this._instance=new Dl(t)}on(t){t.event=gr[t.event],this._instance.on(t)}off(t){t.event=gr[t.event],this._instance.off(t)}setProperty(){}};Ql([R(is.on),Rl("design:type",Function),Rl("design:paramtypes",[Object]),Rl("design:returntype",void 0)],Nl.prototype,"on",null),Ql([R(is.off),Rl("design:type",Function),Rl("design:paramtypes",[Object]),Rl("design:returntype",void 0)],Nl.prototype,"off",null),Nl=Ql([H(VA.waterEffectInit),Rl("design:paramtypes",[Object])],Nl);var Hl="uniform sampler2D colorTexture;\r\nvarying vec2 v_textureCoordinates;\r\nfloat hash(float x) {\r\n    return fract(sin(x * 133.3) * 13.13);\r\n}\r\nvoid main(void) {\r\n    float time = czm_frameNumber / 240.0;\r\n    vec2 resolution = czm_viewport.zw;\r\n    vec2 uv = (gl_FragCoord.xy * 2. - resolution.xy) / min(resolution.x, resolution.y);\r\n    vec3 c = vec3(.6, .7, .8);\r\n    float a = -.4;\r\n    float si = sin(a), co = cos(a);\r\n    uv *= mat2(co, -si, si, co);\r\n    uv *= length(uv + vec2(0, 4.9)) * .3 + 1.;\r\n    float v = 1. - sin(hash(floor(uv.x * 100.)) * 2.);\r\n    float b = clamp(abs(sin(20. * time * v + uv.y * (5. / (2. + v)))) - .95, 0., 1.) * 20.;\r\n    c *= v * b;\r\n    gl_FragColor = mix(texture2D(colorTexture, v_textureCoordinates), vec4(c, 1), 0.5);\r\n}";class kl extends Va{constructor(t){super(t),this._show=t.show,this.alpha=t.alpha,this.type=t.type,this._layerType=this.type,this._id=$("weather"),this.cesiumViewer=this._userViewer.viewer.instance,"rain"==t.type?this.shader=Hl:"snow"==t.type?this.shader="uniform sampler2D colorTexture;\r\nuniform float alpha;\r\nvarying vec2 v_textureCoordinates;\r\nfloat snow(vec2 uv, float scale) {\r\n    float time = czm_frameNumber / 60.0;\r\n    float w = smoothstep(1., 0., -uv.y * (scale / 10.));\r\n    if(w < .1)\r\n        return 0.;\r\n    uv += time / scale;\r\n    uv.y += time * 2. / scale;\r\n    uv.x += sin(uv.y + time * .5) / scale;\r\n    uv *= scale;\r\n    vec2 s = floor(uv), f = fract(uv), p;\r\n    float k = 3., d;\r\n    p = .5 + .35 * sin(11. * fract(sin((s + p + scale) * mat2(7, 3, 6, 5)) * 5.)) - f;\r\n    d = length(p);\r\n    k = min(d, k);\r\n    k = smoothstep(0., k, sin(f.x + f.y) * 0.01);\r\n    return k * w;\r\n}\r\nvoid main(void) {\r\n    vec2 resolution = czm_viewport.zw;\r\n    vec2 uv = (gl_FragCoord.xy * 2. - resolution.xy) / min(resolution.x, resolution.y);\r\n    vec3 finalColor = vec3(0);\r\n    float c = 0.0;    \r\n    // c+=snow(uv,30.)*.0;    \r\n    // c+=snow(uv,20.)*.0;  \r\n    // c+=snow(uv,15.)*.0;   \r\n    c += snow(uv, 10.);\r\n    c += snow(uv, 8.);\r\n    c += snow(uv, 6.);\r\n    c += snow(uv, 5.);\r\n    finalColor = (vec3(c));\r\n    gl_FragColor = mix(texture2D(colorTexture, v_textureCoordinates), vec4(finalColor, 1), 0.5);\r\n}":this.shader=Hl,this.addPostProcessStage()}addPostProcessStage(){this.postStage||(this.postStage=new f.PostProcessStage({name:"Weather_"+this.type,fragmentShader:this.shader})),this.postStage.enabled=this._show,this.cesiumViewer.scene.postProcessStages.add(this.postStage)}remove(t){const{ended:e}=t;this.postStage&&(this.cesiumViewer.scene.postProcessStages.remove(this.postStage),delete this.postStage,this._userViewer.viewer.layerCache.remove(this),e&&e(at(!0)))}show(){!this._show&&this.postStage&&(this._show=!0,this.postStage.enabled=this._show)}hide(){this._show&&this.postStage&&(this._show=!1,this.postStage.enabled=this._show)}addToViewer(t){const{ended:e}=t;this._userViewer.viewer.layerCache.hasType(this._layerType)||(this.show(),this._userViewer.viewer.layerCache.add(this)),at(!0,e)}}var Vl=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},jl=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let Gl={show:!1,type:"rain"},Kl=class extends kA{constructor(t){super(t);if((t=Object.assign({},Gl,t)).viewer.hasLayerType(t.type))return console.warn(`weather ${t.type} has exists!`),void(this._instance=t.viewer.getLayerByType(t.type));this._instance=new kl(t)}field(){return this}setSource(){}setProperty(){}};Kl=Vl([H(VA.weatherValidate),jl("design:paramtypes",[Object])],Kl);class zl{constructor(t){this._layerType="snowCover",this._id=$("weather"),this._show=t.show,this._maxHeight=t.maxHeight,this.alpha=t.alpha,this.ready=!1,this.userViewer=t.viewer,this.cesiumViewer=t.viewer.viewer.instance,this.cesiumViewer.scene.globe.depthTestAgainstTerrain=!0;let e=null,i=new f.Matrix4,n=!1,r=[];const o=this.userViewer.getLayers().filter(t=>t instanceof iA);if(o.length&&(e=o[0]),e){n=!0;const t=e.polygon,o=f.Transforms.eastNorthUpToFixedFrame(f.Cartesian3.fromDegrees(...t[0],0),f.Ellipsoid.WGS84);i=f.Matrix4.inverse(o,new f.Matrix4),r=t.map(t=>{const e=f.Cartesian3.fromDegrees(...t);return f.Matrix4.multiplyByPoint(i,e,new f.Cartesian3)})}this.postStage=new f.PostProcessStage({name:"SnowCover",fragmentShader:"uniform sampler2D colorTexture;\r\nuniform sampler2D depthTexture;\r\nuniform float alpha;\r\nuniform bool u_clip;\r\nuniform mat4 u_matrix;\r\nuniform vec3[300] u_points;\r\nvarying vec2 v_textureCoordinates;\r\nvec4 toEye(in vec2 uv, in float depth) {\r\n    vec2 xy = vec2((uv.x * 2. - 1.), (uv.y * 2. - 1.));\r\n    vec4 posInCamera = czm_inverseProjection * vec4(xy, depth, 1.);\r\n    posInCamera = posInCamera / posInCamera.w;\r\n    return posInCamera;\r\n}\r\nfloat getDepth(in vec4 depth) {\r\n    float z_window = czm_unpackDepth(depth);\r\n    z_window = czm_reverseLogDepth(z_window);\r\n    float n_range = czm_depthRange.near;\r\n    float f_range = czm_depthRange.far;\r\n    return (2. * z_window - n_range - f_range) / (f_range - n_range);\r\n}\r\nvoid main() {\r\n    vec4 color = texture2D(colorTexture, v_textureCoordinates);\r\n    vec4 currD = texture2D(depthTexture, v_textureCoordinates);\r\n    if(currD.r >= 1.) {\r\n        gl_FragColor = color;\r\n        return;\r\n    }\r\n    float depth = getDepth(currD);\r\n    vec4 positionEC = toEye(v_textureCoordinates, depth);\r\n    vec3 dx = dFdx(positionEC.xyz);\r\n    vec3 dy = dFdy(positionEC.xyz);\r\n    vec3 nor = normalize(cross(dx, dy));\r\n    vec4 wc = czm_inverseView * positionEC;\r\n    vec4 positionWC = normalize(wc);\r\n\r\n    if(u_clip) {\r\n        vec4 point = u_matrix * wc;\r\n        bool isInside = false;\r\n        int numVertices = u_points.length();\r\n        for(int i = 1, j = numVertices - 1; i < numVertices; j = i++) {\r\n            if(((u_points[i].y > point.y) != (u_points[j].y > point.y)) &&\r\n                (point.x < (u_points[j].x - u_points[i].x) * (point.y - u_points[i].y) / (u_points[j].y - u_points[i].y) + u_points[i].x)) {\r\n                isInside = !isInside;\r\n            }\r\n        }\r\n        if(!isInside) {\r\n            discard;\r\n        }\r\n    }\r\n\r\n    vec3 normalWC = normalize(czm_inverseViewRotation * nor);\r\n    float dotNumWC = dot(positionWC.xyz, normalWC);\r\n    if(dotNumWC <= .3) {\r\n        gl_FragColor = mix(color, vec4(1.), alpha * .3);\r\n        return;\r\n    }\r\n    gl_FragColor = mix(color, vec4(1.), dotNumWC * alpha);\r\n\r\n}",uniforms:{alpha:this.alpha,u_clip:n,u_matrix:i,u_points:r}}),this.cesiumViewer.scene.camera.changed.addEventListener(this.camera_changedHandler,this)}remove(t={}){const{ended:e}=t;this.postStage&&(this.cesiumViewer.scene.camera.changed.removeEventListener(this.camera_changedHandler,this),this.cesiumViewer.scene.globe.depthTestAgainstTerrain=!1,this.cesiumViewer.scene.postProcessStages.remove(this.postStage),this.userViewer.viewer.layerCache.remove(this),at(!0,e))}show(){this._show||(this._show=!0,this.camera_changedHandler(),this.postStage.uniforms.alpha=this.alpha)}hide(){this._show&&(this._show=!1,this.postStage.uniforms.alpha=0)}addToViewer(t){const{ended:e}=t;this.userViewer.viewer.layerCache.hasType(this._layerType)||(this.show(),this.userViewer.viewer.layerCache.add(this)),at(!0,e)}camera_changedHandler(){this.cesiumViewer.camera.positionCartographic.height<this._maxHeight?(this.postStage.enabled=this._show,this.ready||(this.cesiumViewer.scene.postProcessStages.add(this.postStage),this.ready=!0)):this.postStage.enabled=!1}}var Wl=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},ql=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let Xl={show:!1,maxHeight:8e5,alpha:.5},Yl=class extends kA{constructor(t){super(t);if((t=Object.assign({},Xl,t)).viewer.hasLayerType("snowCover"))return console.warn("snowCover has exists!"),void(this._instance=t.viewer.getLayerByType("snowCover"));this._instance=new zl(t)}field(){return this}setSource(){}setProperty(){}};Yl=Wl([H(VA.snowCoverValidate),ql("design:paramtypes",[Object])],Yl);class Jl extends Va{constructor(t){super(t),this.cesiumViewer=this._userViewer.viewer.instance,this.polygon=t.polygon,this.color=t.color||"#000",this.alpha=t.alpha||.5,this.materialColor=f.Color.fromCssColorString(this.color).withAlpha(this.alpha),this.handleData()}handleData(){let t=Object(g.flattenDeep)(this.polygon);var e={positions:f.Cartesian3.fromDegreesArray([-180,-84.9901,-1e-5,-84.9901,-1e-5,84.9901,-180,84.9901])},i=new f.GeometryInstance({geometry:new f.PolygonGeometry({polygonHierarchy:e,vertexFormat:f.PerInstanceColorAppearance.VERTEX_FORMAT}),attributes:{color:f.ColorGeometryInstanceAttribute.fromColor(this.materialColor)}}),n={positions:f.Cartesian3.fromDegreesArray([1e-5,-84.9901,180,-84.9901,180,84.9901,1e-5,84.9901]),holes:[{positions:f.Cartesian3.fromDegreesArray(t)}]},r=new f.GeometryInstance({geometry:new f.PolygonGeometry({polygonHierarchy:n,vertexFormat:f.PerInstanceColorAppearance.VERTEX_FORMAT}),attributes:{color:f.ColorGeometryInstanceAttribute.fromColor(this.materialColor)}});const o=new f.GroundPrimitive({geometryInstances:[i,r],appearance:new f.PerInstanceColorAppearance({closed:!0,translucent:1!=this.alpha})});this._container.add(o)}}var Zl=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},$l=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let tc=class extends kA{constructor(t){super(t),this._instance=new Jl(t)}setProperty(){}};tc=Zl([H(VA.baseMapMaskValidate),$l("design:paramtypes",[Object])],tc);var ec="czm_material czm_getMaterial(czm_materialInput materialInput) {\r\n    czm_material material = czm_getDefaultMaterial(materialInput);\r\n    material.diffuse = brightness * color.rgb;\r\n    material.emission = color.rgb;\r\n    material.alpha = alpha;\r\n    return material;\r\n}";class ic extends Va{constructor(t){super(t)}init(){this._defaultStyle={height:100,width:50,outline:!0,opacity:.2,color:"#00acc1",outlineColor:"#00acc1"};const{data:t}=this._options;if(t){let e=[{polygon:t}];this.setData(e)}}setSource(t){const{ended:e}=t;this.query&&this.query.queryCustomInfo(Object.assign(Object.assign({},t),{callback:t=>{if(t.data&&t.data.total>0){let i=t.data.data.filter(t=>"Polygon"==t.geometry.type).map(t=>{let e=t.geometry.coordinates[0];return Object.assign({polygon:e},t.properties)});this.makeBounding(i),this.setData(i,e)}}}))}setData(t,e){this._container.size>0&&this._container.removeAll();for(const e of t){let t=Object.assign(Object.assign({},this._defaultStyle),this._options);const i=this.fieldMap.map(t=>t.props);for(let n of i){const i=this.fieldMap.find(t=>t.props===n);let r=(i||{}).value(e[i.field]);t[n]=r}t=Object.assign(Object.assign({},t),e),this._handlerData(t)}at(!0,e)}_handlerData(t){let{polygon:e,height:i,outline:n,opacity:r,color:o,outlineColor:s,width:a}=t,A=[];e.forEach(t=>{t.length>=2&&A.push(t[0],t[1])});let l=f.Cartesian3.fromDegreesArray(A),c=this.computePositions(l,a),u=new f.PolygonGeometry({polygonHierarchy:new f.PolygonHierarchy(c,[new f.PolygonHierarchy(l)]),extrudedHeight:i}),h=f.PolygonGeometry.createGeometry(u),p=new f.Primitive({geometryInstances:[new f.GeometryInstance({geometry:h,id:this._id})],appearance:new f.MaterialAppearance({material:new f.Material({fabric:{uniforms:{color:f.Color.fromCssColorString(o),brightness:1,alpha:r},source:ec}})})});if(this._container.add(p),n){let t=new f.PolygonOutlineGeometry({polygonHierarchy:new f.PolygonHierarchy(c,[new f.PolygonHierarchy(l)]),extrudedHeight:i}),e=f.PolygonOutlineGeometry.createGeometry(t),n=new f.Primitive({geometryInstances:[new f.GeometryInstance({geometry:e,id:this._id})],appearance:new f.MaterialAppearance({material:new f.Material({fabric:{uniforms:{color:f.Color.fromCssColorString(s),brightness:4,alpha:r},source:ec}})})});this._container.add(n)}}computePositions(t,e=50,i=!0){let n=[],r=[];for(let e=0;e<t.length-1;e++){let i=t[e],n=t[(e+1)%t.length],o=new f.Cartesian3;o=f.Cartesian3.subtract(n,i,o),r.push(o)}let o=new f.Cartesian3;o=f.Cartesian3.cross(r[0],r[1],o);for(let i=0;i<r.length;i++){let s=f.Cartesian3.clone(r[i]),a=f.Cartesian3.clone(r[(i+1)%r.length]),A=new f.Cartesian3;A=f.Cartesian3.cross(s,a,A),s=f.Cartesian3.normalize(s,s),a=f.Cartesian3.normalize(f.Cartesian3.negate(a,a),a);let l=f.Cartesian3.angleBetween(s,a),c=new f.Cartesian3;c=f.Cartesian3.normalize(f.Cartesian3.add(s,a,c),c),c=f.Cartesian3.multiplyByScalar(c,e/Math.sin(l/2),c),f.Cartesian3.dot(o,A)<0&&(c=f.Cartesian3.negate(c,c));let u=new f.Cartesian3;u=f.Cartesian3.add(t[i+1],c,u),n.push(u)}return n}}var nc=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},rc=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let oc=class extends kA{constructor(t){super(t),this._instance=new ic(t)}on(t){t.event=gr[t.event],this._instance.on(t)}off(t){t.event=gr[t.event],this._instance.off(t)}setProperty(){}};nc([R(is.on),rc("design:type",Function),rc("design:paramtypes",[Object]),rc("design:returntype",void 0)],oc.prototype,"on",null),nc([R(is.off),rc("design:type",Function),rc("design:paramtypes",[Object]),rc("design:returntype",void 0)],oc.prototype,"off",null),oc=nc([H(VA.corridorValidate),rc("design:paramtypes",[Object])],oc);var sc=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},ac=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let Ac=class extends kA{constructor(t){super(t),this._instance=new TA(t)}field(){return this}setSource(){}setProperty(){}};Ac=sc([H({viewer:{type:k.Object,required:!0},pointSize:{type:k.Number},alpha:{type:k.Number},showNum:{type:k.Number}}),ac("design:paramtypes",[Object])],Ac);var lc=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},cc=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let uc=class extends kA{constructor(t){super(t),this._instance=new Ya(t)}on(t){t.event=gr[t.event],this._instance.on(t)}off(t){t.event=gr[t.event],this._instance.off(t)}};lc([R(is.on),cc("design:type",Function),cc("design:paramtypes",[Object]),cc("design:returntype",void 0)],uc.prototype,"on",null),lc([R(is.off),cc("design:type",Function),cc("design:paramtypes",[Object]),cc("design:returntype",void 0)],uc.prototype,"off",null),uc=lc([H(VA.circleSpreadInit),cc("design:paramtypes",[Object])],uc);var hc=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},pc=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let dc=class extends kA{constructor(t){super(t),this._instance=new LA(t)}field(t,e,i){return this._instance.field(t,e,i),this}setSource(){}setPosition(t){return this._instance.setPosition(t),this}};dc=hc([H(VA.common),pc("design:paramtypes",[Object])],dc);var fc=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},gc=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let mc=class extends kA{constructor(t){super(t),this._instance=new UA(t)}field(t,e,i){return this._instance.field(t,e,i),this}setSource(){}setPosition(t){return this._instance.setPosition(t),this}};mc=fc([H(VA.common),gc("design:paramtypes",[Object])],mc);var yc=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},vc=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let _c=class extends kA{constructor(t){super(t),this._instance=new DA(t)}setProperty(t){this._instance.setProperty(t)}field(t,e,i){return this._instance.field(t,e,i),this}setSource(){}setPosition(t){return this._instance.setPosition(t),this}};yc([R(VA.fireworkEffectProperty),vc("design:type",Function),vc("design:paramtypes",[Object]),vc("design:returntype",void 0)],_c.prototype,"setProperty",null),_c=yc([H(VA.fireworkEffectInit),vc("design:paramtypes",[Object])],_c);var wc=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},Cc=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let Bc=class extends kA{constructor(t){super(t),this._instance=new MA(t)}setProperty(t){this._instance.setProperty(t)}field(t,e,i){return this._instance.field(t,e,i),this}setSource(){}setPosition(t){return this._instance.setPosition(t),this}};wc([R(VA.rainEffectProperty),Cc("design:type",Function),Cc("design:paramtypes",[Object]),Cc("design:returntype",void 0)],Bc.prototype,"setProperty",null),Bc=wc([H(VA.rainEffectInit),Cc("design:paramtypes",[Object])],Bc);var bc=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},Ec=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let Sc=class extends kA{constructor(t){super(t),this._instance=new QA(t)}field(t,e,i){return this._instance.field(t,e,i),this}setSource(){}};Sc=bc([H(VA.common),Ec("design:paramtypes",[Object])],Sc);var xc=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},Ic=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let Fc=class extends kA{constructor(t){super(t),this._instance=new RA(t)}field(t,e,i){return this._instance.field(t,e,i),this}setSource(){}setPosition(t){return this._instance.setPosition(t),this}};Fc=xc([H(VA.common),Ic("design:paramtypes",[Object])],Fc);class Oc{constructor(t){this._id=$("analysis"),this._userViewer=t.viewer,this._options=t,this.init()}init(){this.createLightCamera(),this.drawFrustumOutline()}addToViewer(t={}){this.createVideo(),at(!0,t.ended)}remove(t={}){const{ended:e}=t;Bt.getPrimitives(this._userViewer).remove(this._farPolygonInstance),Bt.getEntities(this._userViewer).remove(this._instance),this._farPolygonInstance=null,this._instance=null,this._lightCamera=null,at(!0,e)}show(){const{lineHelper:t=!0}=this._options;this._instance&&(this._instance.show=!0),t&&this._farPolygonInstance&&(this._farPolygonInstance.show=!0)}hide(){const{lineHelper:t=!0}=this._options;this._instance&&(this._instance.show=!1),t&&this._farPolygonInstance&&(this._farPolygonInstance.show=!1)}setStyle(t={}){"{}"!==JSON.stringify(t)&&(this.remove(),this.createLightCamera(t),this.drawFrustumOutline(t),this.createVideo())}createLightCamera(t={}){const e=t.viewPosition||this._options.viewPosition||[],i=t.viewDistance||this._options.viewDistance,n=t.viewHeading||this._options.viewHeading||0,r=t.viewPitch||this._options.viewPitch||0,o=t.horizontalViewAngle||this._options.horizontalViewAngle||90,s=t.verticalViewAngle||this._options.verticalViewAngle||60;let a=f.Cartesian3.fromDegrees(e[0],e[1],e[2]||0);this._lightCamera=new f.Camera(Bt.getEngine(this._userViewer).scene),this._lightCamera.position=a,this._lightCamera.frustum.near=.001*i,this._lightCamera.frustum.far=i;const A=f.Math.toRadians(o),l=f.Math.toRadians(s),c=i*Math.tan(A/2)*2/(i*Math.tan(l/2)*2);this._lightCamera.frustum.aspectRatio=c,this._lightCamera.frustum.fov=A>l?A:l,this._lightCamera.setView({destination:a,orientation:{heading:f.Math.toRadians(n),pitch:f.Math.toRadians(r),roll:0}})}drawFrustumOutline(t={}){const{lineHelper:e=!0}=this._options,i=t.viewPosition||this._options.viewPosition;let n=f.Cartesian3.fromDegrees(i[0],i[1],i[2]||0);const r=new f.Cartesian3,o=new f.Matrix3,s=new f.Quaternion,a=this._lightCamera.directionWC,A=this._lightCamera.upWC;let l=this._lightCamera.rightWC;l=f.Cartesian3.negate(l,r);let c=o;f.Matrix3.setColumn(c,0,l,c),f.Matrix3.setColumn(c,1,A,c),f.Matrix3.setColumn(c,2,a,c);let u=f.Quaternion.fromRotationMatrix(c,s),h=new f.FrustumOutlineGeometry({frustum:this._lightCamera.frustum,origin:n,orientation:u}),p=f.FrustumOutlineGeometry.createGeometry(h);if(p&&p.attributes&&p.attributes.position&&p.attributes.position.values){{let t=p.attributes.position.values.slice(12);this._farPolygon=t}if(e){let t=new f.GeometryInstance({geometry:h,id:this._id,attributes:{color:f.ColorGeometryInstanceAttribute.fromColor(f.Color.YELLOWGREEN),show:new f.ShowGeometryInstanceAttribute(!0)}});this._farPolygonInstance=Bt.getPrimitives(this._userViewer).add(new f.Primitive({geometryInstances:[t],appearance:new f.PerInstanceColorAppearance({flat:!0,translucent:!1})}))}}else console.error("position_info error!")}createVideo(){const{video:t,isProjection:e=!0}=this._options;let i=[];for(let t=0;t<this._farPolygon.length;t+=3){let e=new f.Cartesian3(this._farPolygon[t],this._farPolygon[t+1],this._farPolygon[t+2]);i.push(e)}let n={polygon:{hierarchy:new f.PolygonHierarchy(i),material:t,perPositionHeight:!e,classificationType:e?f.ClassificationType.BOTH:f.ClassificationType.TERRAIN}};this._instance=Bt.getEntities(this._userViewer).add(n)}}class Pc{constructor(t){this._options=t,this._userViewer=t.viewer,this.init()}init(){this.beforeStatus={shadows:Bt.getEngine(this._userViewer).shadows,shouldAnimate:Bt.getEngine(this._userViewer).shouldAnimate}}setTime(t,e){const i=f.JulianDate.fromDate(new Date(t)),n=f.JulianDate.addHours(i,0,new f.JulianDate);let r;if(e){const t=f.JulianDate.fromDate(new Date(e));r=f.JulianDate.addHours(t,0,new f.JulianDate)}else r=f.JulianDate.addHours(i,24,new f.JulianDate);const o=Bt.getEngine(this._userViewer);o.clockViewModel.startTime=n,o.clockViewModel.currentTime=n,o.clockViewModel.stopTime=r,o.clockViewModel.clockRange=f.ClockRange.CLAMPED,o.clock.shouldAnimate=!1,o.clock.onStop.addEventListener(()=>{setTimeout(()=>{this.pause()},20)})}setMultiplier(t){Bt.getEngine(this._userViewer).clock.multiplier=t}start(){Bt.getEngine(this._userViewer).shadows=!0,Bt.getEngine(this._userViewer).clock.shouldAnimate=!0;const{onChange:t}=this._options;t&&(this._timer=setInterval(()=>{const e=Bt.getEngine(this._userViewer).clockViewModel.currentTime,i=f.JulianDate.toDate(e);t(this.dateFormat(i))},20))}pause(){clearInterval(this._timer),Bt.getEngine(this._userViewer).clock.shouldAnimate=!1,this._timer=null}remove(){this.pause(),Bt.getEngine(this._userViewer).shadows=this.beforeStatus.shadows,Bt.getEngine(this._userViewer).shouldAnimate=this.beforeStatus.shouldAnimate}toDouble(t){return t<10?"0"+t:t}dateFormat(t){return`${t.getFullYear()}-${this.toDouble(t.getMonth()+1)}-${this.toDouble(t.getDate())} ${this.toDouble(t.getHours())}:${this.toDouble(t.getMinutes())}:${this.toDouble(t.getSeconds())}`}}var Tc={viewShedValidate:{viewer:{type:k.Object,required:!0},cameraPosition:{type:k.Point,required:!0},viewPosition:{type:k.Point,required:!0},horizontalAngle:{type:k.Number,validator:function(t){return t>0&&t<=120}},verticalAngle:{type:k.Number,validator:function(t){return t>0&&t<=90}},visibleAreaColor:{type:k.Color},hiddenAreaColor:{type:k.Color},alpha:{type:k.Number,validator:function(t){return t>=0&&t<=1}},frustum:{type:k.Boolean},show:{type:k.Boolean},maximumDistance:{type:k.Number,validator:function(t){return t>0}}},viewShedUpdate:{horizontalAngle:{type:k.Number,validator:function(t){return t>=0&&t<=360}},verticalAngle:{type:k.Number,validator:function(t){return t>=0&&t<=360}},visibleAreaColor:{type:k.Color},hiddenAreaColor:{type:k.Color},alpha:{type:k.Number,validator:function(t){return t>=0&&t<=1}}},projectionVideoValidate:{viewer:{type:k.Object,required:!0},video:{type:k.DOM,required:!0},viewPosition:{type:k.Array,required:!0},viewDistance:{type:k.Number,required:!0,validator:t=>t>0,message:"viewDistance must greater than 0!"},viewHeading:{type:k.Number},viewPitch:{type:k.Number},lineHelper:{type:k.Boolean},isProjection:{type:k.Boolean}},projectionVideoUpdate:{viewPosition:{type:k.Array},viewDistance:{type:k.Number,validator:t=>t>0,message:"viewDistance must greater than 0!"},viewHeading:{type:k.Number},viewPitch:{type:k.Number}},floodValidate:{viewer:{type:k.Object,required:!0},polygon:{type:k.ArrayPoint,required:!0},height:{type:k.Number,validator:function(t){return t>=0}},maxHeight:{type:k.Number,validator:function(t){return t>0}},speed:{type:k.Number,validator:function(t){return t>0}},color:{type:k.Color},alpha:{type:k.Number,validator:function(t){return t>=0&&t<=1}},onStop:{type:k.Function},onChange:{type:k.Function}},floodUpdate:{maxHeight:{type:k.Number,validator:function(t){return t>0}},speed:{type:k.Number,validator:function(t){return t>0}},color:{type:k.Color},alpha:{type:k.Number,validator:function(t){return t>=0&&t<=1}}},shadowsValidate:{viewer:{type:k.Object,required:!0}},swipeValidate:{viewer:{type:k.Object,required:!0},comparedSolution:{type:k.string,required:!0}}},Lc=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},Mc=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let Uc=class{constructor(t){this._instance=new Oc(t)}addToViewer(t){this._instance.addToViewer(t)}remove(t={}){this._instance.remove(t)}show(){this._instance.show()}hide(){this._instance.hide()}setStyle(t){this._instance.setStyle(t)}};Lc([R(),Mc("design:type",Function),Mc("design:paramtypes",[Object]),Mc("design:returntype",void 0)],Uc.prototype,"addToViewer",null),Lc([R(is.remove),Mc("design:type",Function),Mc("design:paramtypes",[Object]),Mc("design:returntype",void 0)],Uc.prototype,"remove",null),Lc([R(Tc.projectionVideoUpdate),Mc("design:type",Function),Mc("design:paramtypes",[Object]),Mc("design:returntype",void 0)],Uc.prototype,"setStyle",null),Uc=Lc([H(Tc.projectionVideoValidate),Mc("design:paramtypes",[Object])],Uc);i(61);class Dc{constructor(t){let e={cameraPosition:null,viewPosition:null,horizontalAngle:120,verticalAngle:90,visibleAreaColor:"#00ff00",hiddenAreaColor:"#ff0000",alpha:.5,distance:100,frustum:!0,show:!1,maximumDistance:5e3};this.defaultOptions=e,this.userViewer=t.viewer,this.cesiumViewer=t.viewer.viewer.instance,this.cameraPosition=f.Cartesian3.fromDegreesArrayHeights([t.cameraPosition[0],t.cameraPosition[1],t.cameraPosition[2]||0])[0],this.viewPosition=f.Cartesian3.fromDegreesArrayHeights([t.viewPosition[0],t.viewPosition[1],t.viewPosition[2]||0])[0],this.frustumQuaternion=this.getFrustumQuaternion(this.cameraPosition,this.viewPosition),this.verticalAngle=Object(f.defaultValue)(t.verticalAngle,e.verticalAngle),this.horizontalAngle=Object(f.defaultValue)(t.horizontalAngle,e.horizontalAngle),this.distance=Object(f.defaultValue)(t.distance,e.distance),this.visibleAreaColor=f.Color.fromCssColorString(Object(f.defaultValue)(t.visibleAreaColor,e.visibleAreaColor)),this.hiddenAreaColor=f.Color.fromCssColorString(Object(f.defaultValue)(t.hiddenAreaColor,e.hiddenAreaColor)),this.frustum=Object(f.defaultValue)(t.frustum,e.frustum),this._show=Object(f.defaultValue)(t.show,e.show),this.alpha=Object(f.defaultValue)(t.alpha,e.alpha),this._defaultColorTexture=new f.Texture({context:this.cesiumViewer.scene.context,source:{width:1,height:1,arrayBufferView:new Uint8Array([0,0,0,0])},flipY:!1}),this._maximumDistance=Object(f.defaultValue)(t.maximumDistance,e.maximumDistance),this.createShadowMap(),this._show&&this.addPostProcess(),this.addRadar(this.cameraPosition,this.frustumQuaternion),this.cesiumViewer.scene.primitives.add(this)}getFrustumQuaternion(t,e){var i=f.Cartesian3.normalize(f.Cartesian3.subtract(e,t,new f.Cartesian3),new f.Cartesian3),n=f.Cartesian3.normalize(t,new f.Cartesian3),r=new f.Camera(this.cesiumViewer.scene);r.position=t,r.direction=i,r.up=n,i=r.directionWC,n=r.upWC;var o=r.rightWC,s=new f.Cartesian3,a=new f.Matrix3,A=new f.Quaternion;o=f.Cartesian3.negate(o,s);var l=a;return f.Matrix3.setColumn(l,0,o,l),f.Matrix3.setColumn(l,1,n,l),f.Matrix3.setColumn(l,2,i,l),f.Quaternion.fromRotationMatrix(l,A)}createShadowMap(){var t=this.cameraPosition,e=this.viewPosition,i=this.cesiumViewer.scene;this.lightCamera=new f.Camera(i),this.lightCamera.position=t,this.lightCamera.direction=f.Cartesian3.subtract(e,t,new f.Cartesian3(0,0,0)),this.lightCamera.up=f.Cartesian3.normalize(t,new f.Cartesian3(0,0,0));var n=Number(f.Cartesian3.distance(e,t).toFixed(1));this.distance=n,this.lightCamera.frustum=new f.PerspectiveFrustum({fov:f.Math.toRadians(120),aspectRatio:i.canvas.clientWidth/i.canvas.clientHeight,near:.001*n,far:n});this.viewShadowMap=new f.ShadowMap({lightCamera:this.lightCamera,enable:!1,isPointLight:!1,isSpotLight:!0,cascadesEnabled:!1,context:i.context,pointLightRadius:n,softShadows:!0,maximumDistance:this._maximumDistance})}addPostProcess(){var t=this,e=t.viewShadowMap._isPointLight?t.viewShadowMap._pointBias:t.viewShadowMap._primitiveBias;this.postProcess=new f.PostProcessStage({fragmentShader:"uniform float czzj;\r\nuniform float dis;\r\nuniform float spzj;\r\nuniform vec3 visibleColor;\r\nuniform vec3 disVisibleColor;\r\nuniform float mixNum;\r\nuniform sampler2D colorTexture;\r\nuniform sampler2D marsShadow;\r\nuniform sampler2D depthTexture;\r\nuniform mat4 _shadowMap_matrix;\r\nuniform vec4 shadowMap_lightPositionEC;\r\nuniform vec3 shadowMap_lightPositionWC;\r\nuniform vec4 shadowMap_lightDirectionEC;\r\nuniform vec3 shadowMap_lightUp;\r\nuniform vec3 shadowMap_lightDir;\r\nuniform vec3 shadowMap_lightRight;\r\nuniform vec4 shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness;\r\nuniform vec4 shadowMap_texelSizeDepthBiasAndNormalShadingSmooth;\r\nvarying vec2 v_textureCoordinates;\r\nvec4 toEye(in vec2 uv, in float depth) {\r\n    vec2 xy = vec2((uv.x * 2.0 - 1.0), (uv.y * 2.0 - 1.0));\r\n    vec4 posInCamera = czm_inverseProjection * vec4(xy, depth, 1.0);\r\n    posInCamera = posInCamera / posInCamera.w;\r\n    return posInCamera;\r\n}\r\nfloat getDepth(in vec4 depth) {\r\n    float z_window = czm_unpackDepth(depth);\r\n    z_window = czm_reverseLogDepth(z_window);\r\n    float n_range = czm_depthRange.near;\r\n    float f_range = czm_depthRange.far;\r\n    return (2.0 * z_window - n_range - f_range) / (f_range - n_range);\r\n}\r\nfloat _czm_sampleShadowMap(sampler2D shadowMap, vec2 uv) {\r\n    return texture2D(shadowMap, uv).r;\r\n}\r\nfloat _czm_shadowDepthCompare(sampler2D shadowMap, vec2 uv, float depth) {\r\n    return step(depth, _czm_sampleShadowMap(shadowMap, uv));\r\n}\r\nfloat _czm_shadowVisibility(sampler2D shadowMap, czm_shadowParameters shadowParameters) {\r\n    float depthBias = shadowParameters.depthBias;\r\n    float depth = shadowParameters.depth;\r\n    float nDotL = shadowParameters.nDotL;\r\n    float normalShadingSmooth = shadowParameters.normalShadingSmooth;\r\n    float darkness = shadowParameters.darkness;\r\n    vec2 uv = shadowParameters.texCoords;\r\n    depth -= depthBias;\r\n    vec2 texelStepSize = shadowParameters.texelStepSize;\r\n    float radius = 1.0;\r\n    float dx0 = -texelStepSize.x * radius;\r\n    float dy0 = -texelStepSize.y * radius;\r\n    float dx1 = texelStepSize.x * radius;\r\n    float dy1 = texelStepSize.y * radius;\r\n    float visibility = (_czm_shadowDepthCompare(shadowMap, uv, depth) + _czm_shadowDepthCompare(shadowMap, uv + vec2(dx0, dy0), depth) + _czm_shadowDepthCompare(shadowMap, uv + vec2(0.0, dy0), depth) + _czm_shadowDepthCompare(shadowMap, uv + vec2(dx1, dy0), depth) + _czm_shadowDepthCompare(shadowMap, uv + vec2(dx0, 0.0), depth) + _czm_shadowDepthCompare(shadowMap, uv + vec2(dx1, 0.0), depth) + _czm_shadowDepthCompare(shadowMap, uv + vec2(dx0, dy1), depth) + _czm_shadowDepthCompare(shadowMap, uv + vec2(0.0, dy1), depth) + _czm_shadowDepthCompare(shadowMap, uv + vec2(dx1, dy1), depth)) * (1.0 / 9.0);\r\n    return visibility;\r\n}\r\nvec3 pointProjectOnPlane(in vec3 planeNormal, in vec3 planeOrigin, in vec3 point) {\r\n    vec3 v01 = point - planeOrigin;\r\n    float d = dot(planeNormal, v01);\r\n    return (point - planeNormal * d);\r\n}\r\nfloat ptm(vec3 pt) {\r\n    return sqrt(pt.x * pt.x + pt.y * pt.y + pt.z * pt.z);\r\n}\r\nvoid main() {\r\n    const float PI = 3.141592653589793;\r\n    vec4 color = texture2D(colorTexture, v_textureCoordinates);\r\n    vec4 currD = texture2D(depthTexture, v_textureCoordinates);    \r\n    // vec4 stcc = texture2D(marsShadow, v_textureCoordinates); \r\n   // gl_FragColor = currD;   \r\n    // return;   \r\n    if(currD.r >= 1.0) {\r\n        gl_FragColor = color;\r\n        return;\r\n    }\r\n    float depth = getDepth(currD);   \r\n    // gl_FragColor = vec4(depth,0.0,0.0,1.0);  \r\n    // return;  \r\n     // float depth = czm_unpackDepth(texture2D(depthTexture, v_textureCoordinates));  \r\n    vec4 positionEC = toEye(v_textureCoordinates, depth);\r\n    vec3 normalEC = vec3(1.0);\r\n    czm_shadowParameters shadowParameters;\r\n    shadowParameters.texelStepSize = shadowMap_texelSizeDepthBiasAndNormalShadingSmooth.xy;\r\n    shadowParameters.depthBias = shadowMap_texelSizeDepthBiasAndNormalShadingSmooth.z;\r\n    shadowParameters.normalShadingSmooth = shadowMap_texelSizeDepthBiasAndNormalShadingSmooth.w;\r\n    shadowParameters.darkness = shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness.w;\r\n    shadowParameters.depthBias *= max(depth * 0.01, 1.0);\r\n    vec3 directionEC = normalize(positionEC.xyz - shadowMap_lightPositionEC.xyz);\r\n    float nDotL = clamp(dot(normalEC, -directionEC), 0.0, 1.0);\r\n    vec4 shadowPosition = _shadowMap_matrix * positionEC;\r\n    shadowPosition /= shadowPosition.w;\r\n    if(any(lessThan(shadowPosition.xyz, vec3(0.0))) || any(greaterThan(shadowPosition.xyz, vec3(1.0)))) {\r\n        gl_FragColor = color;\r\n        return;\r\n    }   \r\n //坐标与视点位置距离，大于最大距离则舍弃阴影效果   \r\n    vec4 lw = vec4(shadowMap_lightPositionWC, 1.0);\r\n    vec4 vw = czm_inverseView * vec4(positionEC.xyz, 1.0);\r\n    if(distance(lw.xyz, vw.xyz) > dis) {\r\n        gl_FragColor = color;\r\n        return;\r\n    }   \r\n //水平夹角限制  \r\n    vec3 ptOnSP = pointProjectOnPlane(shadowMap_lightUp, lw.xyz, vw.xyz);\r\n    directionEC = ptOnSP - lw.xyz;\r\n    float directionECMO = ptm(directionEC.xyz);\r\n    float shadowMap_lightDirMO = ptm(shadowMap_lightDir.xyz);\r\n    float cosJJ = dot(directionEC, shadowMap_lightDir) / (directionECMO * shadowMap_lightDirMO);\r\n    float degJJ = acos(cosJJ) * (180.0 / PI);\r\n    degJJ = abs(degJJ);\r\n    if(degJJ > spzj / 2.0) {\r\n        gl_FragColor = color;\r\n        return;\r\n    }    //垂直夹角限制  \r\n    vec3 ptOnCZ = pointProjectOnPlane(shadowMap_lightRight, lw.xyz, vw.xyz);\r\n    vec3 dirOnCZ = ptOnCZ - lw.xyz;\r\n    float dirOnCZMO = ptm(dirOnCZ);\r\n    float cosJJCZ = dot(dirOnCZ, shadowMap_lightDir) / (dirOnCZMO * shadowMap_lightDirMO);\r\n    float degJJCZ = acos(cosJJCZ) * (180.0 / PI);\r\n    degJJCZ = abs(degJJCZ);\r\n    if(degJJCZ > czzj / 2.0) {\r\n        gl_FragColor = color;\r\n        return;\r\n    }\r\n    shadowParameters.texCoords = shadowPosition.xy;\r\n    shadowParameters.depth = shadowPosition.z;\r\n    shadowParameters.nDotL = nDotL;\r\n    float visibility = _czm_shadowVisibility(marsShadow, shadowParameters);\r\n    if(visibility == 1.0) {\r\n        gl_FragColor = mix(color, vec4(visibleColor, 1.0), mixNum);\r\n    } else {       \r\n     // if(abs(shadowPosition.z-0.0)<0.01){  \r\n               //     return;    \r\n                   // } \r\n        gl_FragColor = mix(color, vec4(disVisibleColor, 1.0), mixNum);\r\n    }\r\n}",uniforms:{czzj:function(){return t.verticalAngle},dis:function(){return t.distance},spzj:function(){return t.horizontalAngle},visibleColor:function(){return t.visibleAreaColor},disVisibleColor:function(){return t.hiddenAreaColor},mixNum:function(){return t.alpha},marsShadow:function(){return t.viewShadowMap._shadowMapTexture||t._defaultColorTexture},_shadowMap_matrix:function(){return t.viewShadowMap._shadowMapMatrix},shadowMap_lightPositionEC:function(){return t.viewShadowMap._lightPositionEC},shadowMap_lightPositionWC:function(){return t.viewShadowMap._lightCamera.position},shadowMap_lightDirectionEC:function(){return t.viewShadowMap._lightDirectionEC},shadowMap_lightUp:function(){return t.viewShadowMap._lightCamera.up},shadowMap_lightDir:function(){return t.viewShadowMap._lightCamera.direction},shadowMap_lightRight:function(){return t.viewShadowMap._lightCamera.right},shadowMap_texelSizeDepthBiasAndNormalShadingSmooth:function(){var i=new f.Cartesian2;return i.x=1/t.viewShadowMap._textureSize.x,i.y=1/t.viewShadowMap._textureSize.y,f.Cartesian4.fromElements(i.x,i.y,e.depthBias,e.normalShadingSmooth,this.combinedUniforms1)},shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness:function(){return f.Cartesian4.fromElements(e.normalOffsetScale,t.viewShadowMap._distance,t.viewShadowMap.maximumDistance,t.viewShadowMap._darkness,this.combinedUniforms2)},depthTexture1:function(){return t.getSceneDepthTexture(t.cesiumViewer)}}}),this.cesiumViewer.scene.postProcessStages.add(this.postProcess)}getSceneDepthTexture(t){var e=t.scene,i=e._environmentState,n=e._view,r=i.useGlobeDepthFramebuffer?n.globeDepth.framebuffer:void 0,o=n.sceneFramebuffer.getFramebuffer();return Object(f.defaultValue)(r,o).depthStencilTexture}addRadar(t,e){var i=t;let n=new f.RectangularSensorGraphics({radius:this.distance,xHalfAngle:f.Math.toRadians(this.horizontalAngle/2),yHalfAngle:f.Math.toRadians(this.verticalAngle/2),material:new f.Color(0,1,1,.4),lineColor:new f.Color(1,1,1,1),slice:8,showScanPlane:!1,showThroughEllipsoid:!1,showLateralSurfaces:!1,showDomeSurfaces:!0});this.radar=this.cesiumViewer.entities.add({position:i,orientation:e,show:this.frustum&&this._show,rectangularSensor:n})}setStyle(t){(t.horizontalAngle||t.verticalAngle||t.distance)&&(t.horizontalAngle&&(this.horizontalAngle=t.horizontalAngle),t.verticalAngle&&(this.verticalAngle=t.verticalAngle),t.distance&&(this.distance=t.distance),this.removeRadar(),this.addRadar(this.cameraPosition,this.frustumQuaternion)),t.visibleAreaColor&&(this.visibleAreaColor=f.Color.fromCssColorString(Object(f.defaultValue)(t.visibleAreaColor,this.defaultOptions.visibleAreaColor))),t.hiddenAreaColor&&(this.hiddenAreaColor=f.Color.fromCssColorString(Object(f.defaultValue)(t.hiddenAreaColor,this.defaultOptions.visibleAreaColor))),t.alpha&&(this.alpha=t.alpha)}removeRadar(){this.radar&&(this.cesiumViewer.entities.remove(this.radar),delete this.radar)}update(t){this.viewShadowMap&&t.shadowMaps.push(this.viewShadowMap)}destroy(t){const{ended:e}=t;this.postProcess&&(this.cesiumViewer.scene.postProcessStages.remove(this.postProcess),delete this.postProcess),this.removeRadar(),delete this.viewShadowMap,Object(f.destroyObject)(this),e&&e(at(!0))}show(){this.viewShadowMap&&(this._show=!0,!this.postProcess&&this.addPostProcess(),this.radar&&(this.radar.show=this.frustum&&this._show))}hide(){this.viewShadowMap&&this.postProcess&&(this._show=!1,this.cesiumViewer.scene.postProcessStages.remove(this.postProcess),this.radar&&(this.radar.show=this.frustum&&this._show),delete this.postProcess)}addToViewer(t){const{ended:e}=t;this.show(),e&&e(at(!0))}}var Qc=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},Rc=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let Nc=class{constructor(t){this._instance=new Dc(t)}remove(t={}){this._instance.destroy(t)}show(){this._instance.show()}hide(){this._instance.hide()}setStyle(t){this._instance.setStyle(t)}setProperty(t){this._instance.setStyle(t)}addToViewer(t){this._instance.addToViewer(t)}};Qc([R(is.remove),Rc("design:type",Function),Rc("design:paramtypes",[Object]),Rc("design:returntype",void 0)],Nc.prototype,"remove",null),Qc([H(Tc.viewShedUpdate),Rc("design:type",Function),Rc("design:paramtypes",[Object]),Rc("design:returntype",void 0)],Nc.prototype,"setStyle",null),Qc([H(Tc.viewShedUpdate),Rc("design:type",Function),Rc("design:paramtypes",[Object]),Rc("design:returntype",void 0)],Nc.prototype,"setProperty",null),Nc=Qc([H(Tc.viewShedValidate),Rc("design:paramtypes",[Object])],Nc);class Hc{constructor(t){this.userViewer=t.viewer,this.cesiumViewer=t.viewer.viewer.instance,this.entity={},this.extrudedHeight=t.height||0,this.maxHeight=t.maxHeight||1e3,this.speed=t.speed||1,this.color=t.color||"#00f",this.alpha=t.alpha||.2,this.onStop=t.onStop||function(){},this.onChange=t.onChange||function(){},this.createEntity(t.polygon)}createEntity(t){const e=this.handerData(t);let i=f.Cartesian3.fromDegreesArray(Object(g.flattenDepth)(e));this.entity=this.cesiumViewer.entities.add({polygon:{show:!1,hierarchy:new f.PolygonHierarchy(i),extrudedHeight:this.extrudedHeight,material:f.Color.fromCssColorString(this.color).withAlpha(this.alpha)}})}start(){this.entity&&(this.entity.polygon.show=!0,this.timeIdx&&(clearInterval(this.timeIdx),this.timeIdx=void 0),this._last_depthTestAgainstTerrain=this.cesiumViewer.scene.globe.depthTestAgainstTerrain,this.cesiumViewer.scene.globe.depthTestAgainstTerrain=!0,this.entity.polygon.extrudedHeight=new f.CallbackProperty(()=>this.extrudedHeight,!1),this.timeIdx=setInterval(()=>{if(this.extrudedHeight>=this.maxHeight)this.stop();else{var t=this.extrudedHeight+this.speed;t>this.maxHeight?this.extrudedHeight=this.maxHeight:this.extrudedHeight=t,this.onChange&&this.onChange(this.extrudedHeight)}},100))}stop(){this.timeIdx&&(clearInterval(this.timeIdx),this.timeIdx=void 0,this.onStop())}remove(){this.stop(),null!==this._last_depthTestAgainstTerrain&&(this.cesiumViewer.scene.globe.depthTestAgainstTerrain=this._last_depthTestAgainstTerrain||!1),this.cesiumViewer.entities.remove(this.entity),this.entity=null}updateHeight(t){this.extrudedHeight=t}handerData(t){let e=[];return 2===t[0].length?t:3===t[0].length?(e=t.map(t=>[t[0],t[1]]),e):void 0}setStyle(t){const{maxHeight:e,color:i,alpha:n,speed:r}=t;e&&(this.extrudedHeight=e),i&&(this.color=i),n&&(this.alpha=n),r&&(this.speed=r),this.entity.polygon.material=f.Color.fromCssColorString(this.color).withAlpha(this.alpha)}}var kc,Vc=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},jc=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Gc=function(t,e,i,n,r){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?r.call(t,i):r?r.value=i:e.set(t,i),i},Kc=function(t,e,i,n){if("a"===i&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?n:"a"===i?n.call(t):n?n.value:e.get(t)};let zc=class{constructor(t){kc.set(this,void 0),Gc(this,kc,new Hc(t),"f")}start(){Kc(this,kc,"f").start()}stop(){Kc(this,kc,"f").stop()}remove(){Kc(this,kc,"f").remove()}setProperty(t){Kc(this,kc,"f").setStyle(t)}};kc=new WeakMap,Vc([H(Tc.floodUpdate),jc("design:type",Function),jc("design:paramtypes",[Object]),jc("design:returntype",void 0)],zc.prototype,"setProperty",null),zc=Vc([H(Tc.floodValidate),jc("design:paramtypes",[Object])],zc);var Wc,qc=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},Xc=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},Yc=function(t,e,i,n,r){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?r.call(t,i):r?r.value=i:e.set(t,i),i},Jc=function(t,e,i,n){if("a"===i&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?n:"a"===i?n.call(t):n?n.value:e.get(t)};let Zc=class{constructor(t){Wc.set(this,void 0),Yc(this,Wc,new Pc(t),"f")}setTime(t,e){Jc(this,Wc,"f")&&Jc(this,Wc,"f").setTime(t,e)}setMultiplier(t){Jc(this,Wc,"f")&&Jc(this,Wc,"f").setMultiplier(t)}start(){Jc(this,Wc,"f")&&Jc(this,Wc,"f").start()}pause(){Jc(this,Wc,"f")&&Jc(this,Wc,"f").pause()}remove(){Jc(this,Wc,"f")&&(Jc(this,Wc,"f").remove(),Yc(this,Wc,null,"f"))}};Wc=new WeakMap,qc([N([{type:k.String,required:!0},{type:k.String}]),Xc("design:type",Function),Xc("design:paramtypes",[String,String]),Xc("design:returntype",void 0)],Zc.prototype,"setTime",null),Zc=qc([H(Tc.shadowsValidate),Xc("design:paramtypes",[Object])],Zc);class $c{constructor(t){this.leftImageryLayers=[],this.kmapViewer=t.viewer,this.solution=t.comparedSolution,this.viewer=this.kmapViewer.viewer.instance,this.getSolution()}getSolution(){const t=this.kmapViewer.viewer.mapConfig;let e={url:ct(t).GET_SINGLE_CONFIG_URL,body:{configType:1,type:"3D",configKey:"KMAP_EARTH",imagerySolutionId:this.solution},headers:{"base-url":t.portalUrl}};mt.post(e,t).catch(t=>{At("c010105")}).then(t=>{var e,i,n;const r=null===(n=null===(i=null===(e=null==t?void 0:t.result)||void 0===e?void 0:e.imageryLayers)||void 0===i?void 0:i.fileContent["3d"])||void 0===n?void 0:n.content;if(r){const t=r.map(t=>{if("url"==t.type)return t.url});if(0===t.length)return void At("c080501");this.addImageryLayers(t)}})}addImageryLayers(t){const e=this.kmapViewer.viewer.mapConfig,i=this.kmapViewer.viewer.containerBox,n=document.createElement("div");n.innerHTML='<div id="kmap-slider" style="position: absolute;left: 50%;top: 0px;background-color: #d3d3d3;width: 5px;height: 100%;z-index: 9999;cursor: ew-resize;"></div>';const r=n.firstChild;this.slider=r,i.prepend(r),t.forEach(t=>{let i=new f.Resource({url:t,headers:{"access-token":e.accessToken}}),n=new f.UrlTemplateImageryProvider({url:i});const r=new f.ImageryLayer(n);this.leftImageryLayers.push(r);const o=this.viewer.imageryLayers;r.splitDirection=f.SplitDirection.LEFT,o.add(r)}),this.viewer.scene.splitPosition=r.offsetLeft/r.parentElement.offsetWidth,this.eventHandler=new f.ScreenSpaceEventHandler(r);let o=!1;const s=t=>{if(!o)return;const e=t.endPosition.x,i=(r.offsetLeft+e)/r.parentElement.offsetWidth;r.style.left=100*i+"%",this.viewer.scene.splitPosition=i};this.eventHandler.setInputAction((function(){o=!0}),f.ScreenSpaceEventType.LEFT_DOWN),this.eventHandler.setInputAction((function(){o=!0}),f.ScreenSpaceEventType.PINCH_START),this.eventHandler.setInputAction(s,f.ScreenSpaceEventType.MOUSE_MOVE),this.eventHandler.setInputAction(s,f.ScreenSpaceEventType.PINCH_MOVE),this.eventHandler.setInputAction((function(){o=!1}),f.ScreenSpaceEventType.LEFT_UP),this.eventHandler.setInputAction((function(){o=!1}),f.ScreenSpaceEventType.PINCH_END)}remove(){this.slider.remove(),this.eventHandler.removeInputAction(f.ScreenSpaceEventType.LEFT_DOWN),this.eventHandler.removeInputAction(f.ScreenSpaceEventType.PINCH_START),this.eventHandler.removeInputAction(f.ScreenSpaceEventType.MOUSE_MOVE),this.eventHandler.removeInputAction(f.ScreenSpaceEventType.PINCH_MOVE),this.eventHandler.removeInputAction(f.ScreenSpaceEventType.LEFT_UP),this.eventHandler.removeInputAction(f.ScreenSpaceEventType.PINCH_END);const t=this.viewer.imageryLayers;this.leftImageryLayers.forEach(e=>{t.remove(e)})}}var tu,eu=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},iu=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},nu=function(t,e,i,n,r){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?r.call(t,i):r?r.value=i:e.set(t,i),i},ru=function(t,e,i,n){if("a"===i&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?n:"a"===i?n.call(t):n?n.value:e.get(t)};let ou=class{constructor(t){tu.set(this,void 0),nu(this,tu,new $c(t),"f")}remove(){ru(this,tu,"f").remove()}};tu=new WeakMap,ou=eu([H(Tc.swipeValidate),iu("design:paramtypes",[Object])],ou);i(52),i(53),i(54),i(55),i(56),i(57);const su={isMouseDown:!1,isMouseIn:!1};function au(){su.isMouseDown=!1}function Au(t,e,i){const n=t.currentTarget.getBoundingClientRect(),r=(t.clientX-n.left)/n.width,o=i.getStartTime(),s=i.getEndTime()-o;i.setTo(s*r)}var lu={tag:"div",classList:["kmap-hpc"],children:[{tag:"div",classList:["kmap-empty-placeholder"]},{tag:"div",classList:["kmap-hpc-top-border"],children:[{tag:"div",classList:["kmap-iconfont","kmap-iconclose","kmap-hpc-close"],listeners:[{event:"click",listener:function(t,e,i){i.destroy()}}]}]},{tag:"div",classList:["kmap-hpc-panel"],children:[{tag:"div",classList:["kmap-hpc-controls"],children:[{tag:"div",classList:["kmap-hpc-reltime"],text:function(t){const e=t.getStartTime(),i=t.getEndTime()-e;return`${Gn(t.getPassedTimestamp(),"HH:mm:ss")} / ${Gn(i,"HH:mm:ss")}`}},{tag:"div",classList:["kmap-hpc-plays"],children:[{tag:"span",classList:["kmap-iconfont","kmap-hpc-prev","kmap-iconback"],listeners:[{event:"click",listener:function(t,e,i){i.setBy(-5e3)}}]},{tag:"span",classList:function(t){return"play"===t.getStatus()?["kmap-iconfont","kmap-hpc-pause","kmap-iconstop"]:["kmap-iconfont","kmap-hpc-play","kmap-iconplay"]},listeners:[{event:"click",listener:function(t,e,i){i.toggleStatus()}}]},{tag:"span",classList:["kmap-iconfont","kmap-hpc-next","kmap-iconforward"],listeners:[{event:"click",listener:function(t,e,i){i.setBy(5e3)}}]}]},{tag:"div",classList:["kmap-hpc-right-controls"],children:[{tag:"div",classList:["kmap-hpc-speed"],children:[{tag:"div",classList:["kmap-hpc-speed-label"],text:function(t){return"Speed:&nbsp;"}},{tag:"div",classList:["kmap-hpc-speed-btn"],children:[{tag:"div",classList:["kmap-hpc-speed-btn-text"],text:function(t){let e=t.getSpeedRate();return e<1&&(e=-1/e),e+".0x"}},{tag:"div",classList:["kmap-iconfont","kmap-iconpull"]}]},{tag:"div",classList:["kmap-hpc-speed-list"],children:[{tag:"div",classList:["kmap-hpc-speed-list-container"],children:[{tag:"div",classList:function(t){return-20===t.getSpeedRate()?["kmap-hpc-speed-list-item","kmap-hpc-active-speed"]:["kmap-hpc-speed-list-item"]},text:"-20.0x",listeners:[{event:"click",listener:function(t,e,i){i.setSpeedRate(-20)}}]},{tag:"div",classList:function(t){return-15===t.getSpeedRate()?["kmap-hpc-speed-list-item","kmap-hpc-active-speed"]:["kmap-hpc-speed-list-item"]},text:"-15.0x",listeners:[{event:"click",listener:function(t,e,i){i.setSpeedRate(-15)}}]},{tag:"div",classList:function(t){return-10===t.getSpeedRate()?["kmap-hpc-speed-list-item","kmap-hpc-active-speed"]:["kmap-hpc-speed-list-item"]},text:"-10.0x",listeners:[{event:"click",listener:function(t,e,i){i.setSpeedRate(-10)}}]},{tag:"div",classList:function(t){return-5===t.getSpeedRate()?["kmap-hpc-speed-list-item","kmap-hpc-active-speed"]:["kmap-hpc-speed-list-item"]},text:"-5.0x",listeners:[{event:"click",listener:function(t,e,i){i.setSpeedRate(-5)}}]},{tag:"div",classList:function(t){return 1===t.getSpeedRate()?["kmap-hpc-speed-list-item","kmap-hpc-active-speed"]:["kmap-hpc-speed-list-item"]},text:"1.0x",listeners:[{event:"click",listener:function(t,e,i){i.setSpeedRate(1)}}]},{tag:"div",classList:function(t){return 5===t.getSpeedRate()?["kmap-hpc-speed-list-item","kmap-hpc-active-speed"]:["kmap-hpc-speed-list-item"]},text:"5.0x",listeners:[{event:"click",listener:function(t,e,i){i.setSpeedRate(5)}}]},{tag:"div",classList:function(t){return 10===t.getSpeedRate()?["kmap-hpc-speed-list-item","kmap-hpc-active-speed"]:["kmap-hpc-speed-list-item"]},text:"10.0x",listeners:[{event:"click",listener:function(t,e,i){i.setSpeedRate(10)}}]},{tag:"div",classList:function(t){return 15===t.getSpeedRate()?["kmap-hpc-speed-list-item","kmap-hpc-active-speed"]:["kmap-hpc-speed-list-item"]},text:"15.0x",listeners:[{event:"click",listener:function(t,e,i){i.setSpeedRate(15)}}]},{tag:"div",classList:function(t){return 20===t.getSpeedRate()?["kmap-hpc-speed-list-item","kmap-hpc-active-speed"]:["kmap-hpc-speed-list-item"]},text:"20.0x",listeners:[{event:"click",listener:function(t,e,i){i.setSpeedRate(20)}}]},{tag:"div",classList:function(t){return 50===t.getSpeedRate()?["kmap-hpc-speed-list-item","kmap-hpc-active-speed"]:["kmap-hpc-speed-list-item"]},text:"50.0x",listeners:[{event:"click",listener:function(t,e,i){i.setSpeedRate(50)}}]},{tag:"div",classList:function(t){return 100===t.getSpeedRate()?["kmap-hpc-speed-list-item","kmap-hpc-active-speed"]:["kmap-hpc-speed-list-item"]},text:"100.0x",listeners:[{event:"click",listener:function(t,e,i){i.setSpeedRate(100)}}]},{tag:"div",classList:function(t){return 300===t.getSpeedRate()?["kmap-hpc-speed-list-item","kmap-hpc-active-speed"]:["kmap-hpc-speed-list-item"]},text:"300.0x",listeners:[{event:"click",listener:function(t,e,i){i.setSpeedRate(300)}}]}]}]}]}]}]},{tag:"div",classList:["kmap-hpc-history-player-timeline"],children:[{tag:"div",classList:["kmap-hpc-history-player-slider"],children:[{tag:"div",classList:["kmap-hpc-scaleplate"],children:[{tag:"div",classList:["kmap-hpc-level-1"],style:{left:0}},{tag:"div",classList:["kmap-hpc-level-2"],style:{left:"4%"}},{tag:"div",classList:["kmap-hpc-level-2"],style:{left:"8%"}},{tag:"div",classList:["kmap-hpc-level-2"],style:{left:"12%"}},{tag:"div",classList:["kmap-hpc-level-2"],style:{left:"16%"}},{tag:"div",classList:["kmap-hpc-level-1"],style:{left:"20%"}},{tag:"div",classList:["kmap-hpc-level-2"],style:{left:"24%"}},{tag:"div",classList:["kmap-hpc-level-2"],style:{left:"28%"}},{tag:"div",classList:["kmap-hpc-level-2"],style:{left:"32%"}},{tag:"div",classList:["kmap-hpc-level-2"],style:{left:"36%"}},{tag:"div",classList:["kmap-hpc-level-1"],style:{left:"40%"}},{tag:"div",classList:["kmap-hpc-level-2"],style:{left:"44%"}},{tag:"div",classList:["kmap-hpc-level-2"],style:{left:"48%"}},{tag:"div",classList:["kmap-hpc-level-2"],style:{left:"52%"}},{tag:"div",classList:["kmap-hpc-level-2"],style:{left:"56%"}},{tag:"div",classList:["kmap-hpc-level-1"],style:{left:"60%"}},{tag:"div",classList:["kmap-hpc-level-2"],style:{left:"64%"}},{tag:"div",classList:["kmap-hpc-level-2"],style:{left:"68%"}},{tag:"div",classList:["kmap-hpc-level-2"],style:{left:"72%"}},{tag:"div",classList:["kmap-hpc-level-2"],style:{left:"76%"}},{tag:"div",classList:["kmap-hpc-level-1"],style:{left:"80%"}},{tag:"div",classList:["kmap-hpc-level-2"],style:{left:"84%"}},{tag:"div",classList:["kmap-hpc-level-2"],style:{left:"88%"}},{tag:"div",classList:["kmap-hpc-level-2"],style:{left:"92%"}},{tag:"div",classList:["kmap-hpc-level-2"],style:{left:"96%"}},{tag:"div",classList:["kmap-hpc-start-abs-time"],text:function(t){return jn(t.getStartTime(),"yyyy-MM-dd HH:mm:ss")}},{tag:"div",classList:["kmap-hpc-end-abs-time"],text:function(t){return jn(t.getEndTime(),"yyyy-MM-dd HH:mm:ss")}},{tag:"div",classList:["kmap-hpc-level-1"],style:{left:"100%"}}]},{tag:"div",classList:["kmap-hpc-progress"],listeners:[{event:"click",listener:function(t,e,i){const n=t.currentTarget.getBoundingClientRect(),r=(t.clientX-n.left)/n.width,o=i.getStartTime(),s=i.getEndTime()-o;i.setTo(s*r)}},{event:"mousedown",listener:function(t,e,i){Au(t,0,i),su.isMouseDown=!0}},{event:"mousemove",listener:function(t,e,i){if(su.isMouseDown)return;const n=t.currentTarget.getBoundingClientRect(),r=(t.clientX-n.left)/n.width,o=i.getStartTime(),s=i.getEndTime()-o;i.setHoverTimestamp(s*r),i.setHoverStatus("on")}},{event:"mouseout",listener:function(t,e,i){i.setHoverStatus("off")}}],children:[{tag:"div",classList:["kmap-hpc-progress-passed"],style:function(t){const e=t.getStartTime(),i=t.getEndTime()-e;return{width:t.getPassedTimestamp()/i*100+"%"}}}]}]},{tag:"div",classList:["kmap-hpc-time-popup-container"],children:[{tag:"div",classList:["kmap-hpc-abs-time-popup","kmap-hpc-current-position"],children:[{tag:"div",classList:["kmap-hpc-popup-time"],style:function(t,e){const i=e.getBoundingClientRect(),n=e.parentElement,r=n.getBoundingClientRect(),o=n.parentElement.getBoundingClientRect(),s=o.width,a=r.x-o.x,A=i.width/2;return a<=A?{transform:`translate(-${10+a/A*40}%, 0)`}:s-a<=A?{transform:`translate(-${90-(s-a)/A*40}%, 0)`}:{transform:"translate(-50%, 0)"}},text:function(t){return jn(t.getCurrentTimestamp(),"yyyy-MM-dd HH:mm:ss")}},{tag:"div",classList:["kmap-hpc-popup-arrow"]},{tag:"div",classList:["kmap-hpc-popup-pointer"]}],style:function(t){const e=t.getStartTime(),i=t.getEndTime();return{left:t.getPassedTimestamp()/(i-e)*100+"%"}}},{tag:"div",classList:["kmap-hpc-abs-time-popup","kmap-hpc-hover-position"],children:[{tag:"div",classList:["kmap-hpc-popup-time"],style:function(t,e){const i=e.getBoundingClientRect(),n=e.parentElement,r=n.getBoundingClientRect(),o=n.parentElement.getBoundingClientRect(),s=o.width,a=r.x-o.x,A=i.width/2;return a<=A?{transform:`translate(-${10+a/A*40}%, 0)`}:s-a<=A?{transform:`translate(-${90-(s-a)/A*40}%, 0)`}:{transform:"translate(-50%, 0)"}},text:function(t){return jn(t.getHoverTimestamp())}},{tag:"div",classList:["kmap-hpc-popup-arrow"]},{tag:"div",classList:["kmap-hpc-popup-pointer"]}],style:function(t){const e=t.getStartTime(),i=t.getEndTime();return{left:(t.getHoverTimestamp()-e)/(i-e)*100+"%",display:"on"===t.getHoverStatus()?"block":"none"}}}]}]}],listeners:[{event:"mousemove",listener:function(t,e,i){su.isMouseDown&&su.isMouseIn&&Au(t,0,i)}},{event:"mouseup",listener:function(t,e,i){t.stopPropagation(),su.isMouseDown=!1}},{event:"mouseenter",listener:function(){su.isMouseIn=!0}},{event:"mouseleave",listener:function(){su.isMouseIn=!1}}]}]},cu={tag:"div",classList:["kmap-dark-container"],children:[{tag:"div",classList:["kmap-dark-header"],children:[{tag:"div",classList:["kmap-iconfont","kmap-iconclose","kmap-dark-close"],listeners:[{event:"click",listener:function(t,e,i){i.destroy()}}]}]},{tag:"div",classList:["kmap-dark-body"],children:[{tag:"div",classList:["kmap-dark-main"],children:[{tag:"div",classList:function(t){return t.deviceListVisible?["kmap-dark-list-control"]:["kmap-device-list-hidden"]},children:[{tag:"div",classList:["kmap-iconfont","kmap-iconpull"]}],listeners:[{event:"click",listener:function(t,e,i){i.toggleDeviceListContainer()}}]},{tag:"div",classList:["kmap-dark-map-placeholder"]},{tag:"div",classList:["kmap-dark-bottom-controls"],children:[{tag:"div",classList:["kmap-dark-abstime-box"],children:[{tag:"div",classList:["kmap-dark-start-abstime"],text:function(t){return jn(t.getStartTime(),"yyyy-MM-dd HH:mm:ss")}},{tag:"div",classList:["kmap-dark-end-abstime"],text:function(t){return jn(t.getEndTime(),"yyyy-MM-dd HH:mm:ss")}},{tag:"div",classList:["kmap-dark-active-popup"],text:function(t){return jn(t.getCurrentTimestamp())},style:function(t,e){const i=t.getStartTime(),n=t.getEndTime(),r=t.getPassedTimestamp()/(n-i),o=e.getBoundingClientRect(),s=e.parentElement.getBoundingClientRect().width,a=s*r,A=o.width/2;return a<=A?{left:"70px"}:s-a<=A?{left:"calc(100% - 70px)"}:{left:a/s*100+"%"}}},{tag:"div",classList:["kmap-dark-hover-popup"],text:function(t){return jn(t.getHoverTimestamp())},style:function(t,e){const i=t.getStartTime(),n=t.getEndTime(),r=(t.getHoverTimestamp()-i)/(n-i),o="on"===t.getHoverStatus(),s=e.getBoundingClientRect(),a=e.parentElement.getBoundingClientRect().width,A=a*r,l=s.width/2;return A<=l?{left:"70px",display:o?"block":"none"}:a-A<=l?{left:"calc(100% - 70px)",display:o?"block":"none"}:{left:A/a*100+"%",display:o?"block":"none"}}}]},{tag:"div",classList:["kmap-dark-timeline"],listeners:[{event:"click",listener:function(t,e,i){const n=t.currentTarget.getBoundingClientRect(),r=(t.clientX-n.left)/n.width,o=i.getStartTime(),s=i.getEndTime()-o;i.setTo(s*r)}},{event:"mousedown",listener:function(t,e,i){Au(t,0,i),su.isMouseDown=!0}},{event:"mousemove",listener:function(t,e,i){if(su.isMouseDown)return;const n=t.currentTarget.getBoundingClientRect(),r=(t.clientX-n.left)/n.width,o=i.getStartTime(),s=i.getEndTime()-o;i.setHoverTimestamp(s*r),i.setHoverStatus("on")}},{event:"mouseout",listener:function(t,e,i){i.setHoverStatus("off")}}],children:[{tag:"div",classList:["kmap-dark-progress"],style:function(t){const e=t.getStartTime(),i=t.getEndTime()-e;return{width:t.getPassedTimestamp()/i*100+"%"}}},{tag:"div",classList:["kmap-dark-scaleplate"],children:[{tag:"div",classList:["kmap-dark-devel"],style:{left:0}},{tag:"div",classList:["kmap-dark-devel"],style:{left:"20%"}},{tag:"div",classList:["kmap-dark-devel"],style:{left:"40%"}},{tag:"div",classList:["kmap-dark-devel"],style:{left:"60%"}},{tag:"div",classList:["kmap-dark-devel"],style:{left:"80%"}},{tag:"div",classList:["kmap-dark-devel"],style:{left:"100%"}}]}]},{tag:"div",classList:["kmap-dark-controls"],children:[{tag:"div",classList:["kmap-dark-play-controls"],children:[{tag:"span",classList:["kmap-iconfont","kmap-dark-prev","kmap-iconback"],listeners:[{event:"click",listener:function(t,e,i){i.setBy(-5e3)}}]},{tag:"span",classList:function(t){return"play"===t.getStatus()?["kmap-iconfont","kmap-dark-pause","kmap-iconstop"]:["kmap-iconfont","kmap-dark-play","kmap-iconplay"]},listeners:[{event:"click",listener:function(t,e,i){i.toggleStatus()}}]},{tag:"span",classList:["kmap-iconfont","kmap-dark-next","kmap-iconforward"],listeners:[{event:"click",listener:function(t,e,i){i.setBy(5e3)}}]}]},{tag:"div",classList:["kmap-dark-reltime"],text:function(t){const e=t.getStartTime(),i=t.getEndTime()-e;return`<span style="color: #4DBDFA;">${Gn(t.getPassedTimestamp(),"HH:mm:ss")}</span><span style="color: rgba(77,189,250,0.5);"> / ${Gn(i,"HH:mm:ss")}</span>`}},{tag:"div",classList:["kmap-dark-speedrate"],children:[{tag:"div",classList:["kmap-dark-speed-btn"],children:[{tag:"div",classList:["kmap-iconfont","kmap-iconpull","kmap-drak-speed-btn-arrow-top"]},{tag:"div",classList:["kmap-dark-speed-btn-text"],text:function(t){let e=t.getSpeedRate();return e<1&&(e=-1/e),e+".0x"}},{tag:"div",classList:["kmap-iconfont","kmap-iconpull","kmap-drak-speed-btn-arrow-down"]}]},{tag:"div",classList:["kmap-dark-speed-list"],children:[{tag:"div",classList:["kmap-dark-speed-list-container"],children:[{tag:"div",classList:function(t){return-20===t.getSpeedRate()?["kmap-dark-speed-list-item","kmap-dark-active-speed"]:["kmap-dark-speed-list-item"]},text:"-20.0x",listeners:[{event:"click",listener:function(t,e,i){i.setSpeedRate(-20)}}]},{tag:"div",classList:function(t){return-15===t.getSpeedRate()?["kmap-dark-speed-list-item","kmap-dark-active-speed"]:["kmap-dark-speed-list-item"]},text:"-15.0x",listeners:[{event:"click",listener:function(t,e,i){i.setSpeedRate(-15)}}]},{tag:"div",classList:function(t){return-10===t.getSpeedRate()?["kmap-dark-speed-list-item","kmap-dark-active-speed"]:["kmap-dark-speed-list-item"]},text:"-10.0x",listeners:[{event:"click",listener:function(t,e,i){i.setSpeedRate(-10)}}]},{tag:"div",classList:function(t){return-5===t.getSpeedRate()?["kmap-dark-speed-list-item","kmap-dark-active-speed"]:["kmap-dark-speed-list-item"]},text:"-5.0x",listeners:[{event:"click",listener:function(t,e,i){i.setSpeedRate(-5)}}]},{tag:"div",classList:function(t){return 1===t.getSpeedRate()?["kmap-dark-speed-list-item","kmap-dark-active-speed"]:["kmap-dark-speed-list-item"]},text:"1.0x",listeners:[{event:"click",listener:function(t,e,i){i.setSpeedRate(1)}}]},{tag:"div",classList:function(t){return 5===t.getSpeedRate()?["kmap-dark-speed-list-item","kmap-dark-active-speed"]:["kmap-dark-speed-list-item"]},text:"5.0x",listeners:[{event:"click",listener:function(t,e,i){i.setSpeedRate(5)}}]},{tag:"div",classList:function(t){return 10===t.getSpeedRate()?["kmap-dark-speed-list-item","kmap-dark-active-speed"]:["kmap-dark-speed-list-item"]},text:"10.0x",listeners:[{event:"click",listener:function(t,e,i){i.setSpeedRate(10)}}]},{tag:"div",classList:function(t){return 15===t.getSpeedRate()?["kmap-dark-speed-list-item","kmap-dark-active-speed"]:["kmap-dark-speed-list-item"]},text:"15.0x",listeners:[{event:"click",listener:function(t,e,i){i.setSpeedRate(15)}}]},{tag:"div",classList:function(t){return 20===t.getSpeedRate()?["kmap-dark-speed-list-item","kmap-dark-active-speed"]:["kmap-dark-speed-list-item"]},text:"20.0x",listeners:[{event:"click",listener:function(t,e,i){i.setSpeedRate(20)}}]},{tag:"div",classList:function(t){return 50===t.getSpeedRate()?["kmap-dark-speed-list-item","kmap-dark-active-speed"]:["kmap-dark-speed-list-item"]},text:"50.0x",listeners:[{event:"click",listener:function(t,e,i){i.setSpeedRate(50)}}]},{tag:"div",classList:function(t){return 100===t.getSpeedRate()?["kmap-dark-speed-list-item","kmap-dark-active-speed"]:["kmap-dark-speed-list-item"]},text:"100.0x",listeners:[{event:"click",listener:function(t,e,i){i.setSpeedRate(100)}}]},{tag:"div",classList:function(t){return 300===t.getSpeedRate()?["kmap-dark-speed-list-item","kmap-dark-active-speed"]:["kmap-dark-speed-list-item"]},text:"300.0x",listeners:[{event:"click",listener:function(t,e,i){i.setSpeedRate(300)}}]}]}]}]}]}],listeners:[{event:"mousemove",listener:function(t,e,i){su.isMouseDown&&Au(t,0,i)}},{event:"mouseup",listener:function(t,e,i){t.stopPropagation(),su.isMouseDown=!1}},{event:"mouseenter",listener:function(){su.isMouseIn=!0}},{event:"mouseleave",listener:function(){su.isMouseIn=!1}}]}]}]}]};class uu{constructor(t="light",e){this.domTree="light"===t?lu:cu,this.context=e}getElement(){return this.parse(this.domTree,this.context)}parse(t,e,i){const n=document.createElement(t.tag);if(Array.isArray(t.classList))for(const e of t.classList)n.classList.add(e);if("function"==typeof t.classList&&e.addCalculateListener({el:n,listener:t.classList,handler:function(t,e){Array.isArray(t)&&e.setAttribute("class",t.join(" "))}}),"function"==typeof t.style&&e.addCalculateListener({el:n,listener:t.style,handler:function(t,e){for(const i in t)e.style[i]=t[i]}}),"object"==typeof t.style)for(const e in t.style)n.style[e]=t.style[e];if("string"==typeof t.id&&(n.id=t.id),"string"==typeof t.text&&(n.innerHTML=t.text),"function"==typeof t.text&&e.addCalculateListener({el:n,listener:t.text,handler:function(t,e){"string"==typeof t&&(e.innerHTML=t)}}),Array.isArray(t.children))for(const i of t.children)this.parse(Object.assign({},i),e,n);if(t.listeners)for(const i of t.listeners){const t=t=>i.listener(t,n,e);n.addEventListener(i.event,t,!1)}return i instanceof HTMLElement&&i.appendChild(n),n}}class hu{constructor(t,e){this.visible=!0,this.calculateListeners=[],this.tracker=t.tracker,this.containerId=e,this.theme=t.theme||"light",this.visible=void 0===t.visible||t.visible,this.startTime=new Date(t.startTime).getTime(),this.endTime=new Date(t.endTime).getTime(),this.speedRate=t.speedRate||1,this.currentTimestamp=this.startTime,document.body.addEventListener("mouseup",au)}getTheme(){return this.theme}setContainerId(t){this.containerId=t}init(){const t=new uu(this.theme,this).getElement();if(this.element=t,this.containerId){const e=document.getElementById(this.containerId);e&&e.appendChild(t)}}addCalculateListener(t){this.calculateListeners.push(t)}render(){for(const t of this.calculateListeners){const e=t.listener(this,t.el);t.handler(e,t.el)}}getPlayStatus(){return this.status}getStartTime(){return this.startTime}setStartTime(t){this.startTime=t,this.currentTimestamp=t}getEndTime(){return this.endTime}setEndTime(t){this.endTime=t}getCurrentTimestamp(){return this.currentTimestamp}getPassedTimestamp(){return this.currentTimestamp-this.startTime}play(){this.status="play",this.lastTimestamp=Date.now(),this.currentTimestamp===this.endTime&&(this.currentTimestamp=this.startTime),this.changeFrame(),this.tracker.play()}pause(){this.status="pause",this.changeFrame(),this.tracker.pause()}replay(){this.currentTimestamp=this.startTime,this.status="play",this.lastTimestamp=Date.now(),this.changeFrame(),this.tracker.replay(this.currentTimestamp)}getStatus(){return this.status}toggleStatus(){"play"===this.status?this.pause():this.play()}setHoverTimestamp(t){this.hoverTimestamp=this.startTime+t}getHoverTimestamp(){return this.hoverTimestamp}setHoverStatus(t){this.hoverStatus=t,"play"!==this.status&&this.render()}getHoverStatus(){return this.hoverStatus}normalizeCurrentTimestamp(t){return t>this.endTime&&(t=this.endTime),t<this.startTime&&(t=this.startTime),t}setTo(t){const e=this.startTime+t;this.currentTimestamp=this.normalizeCurrentTimestamp(e),this.changeFrame();const i={duration:this.getPassedTimestamp(),timestamp:this.currentTimestamp};this.tracker.setBy(i.timestamp)}setBy(t){this.currentTimestamp=this.normalizeCurrentTimestamp(this.currentTimestamp+t),this.changeFrame();const e={duration:this.getPassedTimestamp(),timestamp:this.currentTimestamp};this.tracker.setBy(e.timestamp)}getSpeedRate(){return this.speedRate}setSpeedRate(t){t<0&&(t=1/Math.abs(t)),this.speedRate=t,this.visible&&"play"!==this.status&&this.render(),this.tracker.setSpeedRate(this.speedRate)}setTimeRange(t,e){this.startTime=t,this.endTime=e,this.tracker.setTimeRange({startTime:t,endTime:e}),this.currentTimestamp=t}getPerspective(){return this.perspective}getFollowingPerspectiveGbid(){return this.followingPerspectiveGbid}frame(){const t=Date.now();if("play"===this.status){let e=this.lastTimestamp?t-this.lastTimestamp:0;e*=this.speedRate,this.currentTimestamp+=e,this.currentTimestamp>=this.endTime&&(this.currentTimestamp=this.endTime,this.status="end",this.tracker.end()),this.frameId=0}this.visible&&this.render(),this.lastTimestamp=t,"play"===this.status&&this.changeFrame()}changeFrame(){this.frameId&&window.cancelAnimationFrame(this.frameId),this.frameId=window.requestAnimationFrame(()=>this.frame())}destroy(){this.tracker.remove()}remove(){this.visible&&document.getElementById(this.containerId).removeChild(this.element),this.frameId&&window.cancelAnimationFrame(this.frameId),document.body.removeEventListener("mouseup",au)}}var pu=function(t,e,i,n){return new(i||(i=Promise))((function(r,o){function s(t){try{A(n.next(t))}catch(t){o(t)}}function a(t){try{A(n.throw(t))}catch(t){o(t)}}function A(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(s,a)}A((n=n.apply(t,e||[])).next())}))};class du{constructor(t){this._instance=null,this._isRunning=!0,this._id=$("Vehicle"),this._layerType="model",this._isEnd=!1,this._options=t,this._userViewer=t.viewer,t.showPlayer&&this.initPlayer(t)}get viewer(){return this._userViewer.viewer.instance}initPlayer(t){const{startTime:e,endTime:i,theme:n}=t,r={tracker:this,startTime:e,endTime:i,theme:n};this._trackPlayer=new hu(r,this._userViewer.id)}initData(t){return pu(this,void 0,void 0,(function*(){const{serviceName:e,gbid:i,startTime:n,endTime:r}=this._options;let o={appName:"public_space",serviceNames:[e],logTime:`${n.split(" ")[0]},${r.split(" ")[0]}`,pageSize:8e3,sorts:[{column:"timestamp",type:"asc"}],terms:[{column:"devGbId",termType:"eq",type:"and",value:i},{column:"timestamp",termType:"gte",type:"and",value:new Date(n).getTime()},{column:"timestamp",termType:"lte",type:"and",value:new Date(r).getTime()}],traceTargetType:0},s={url:lt(this._mapConfig).BUSINESS_HISTORY_SERVICE,body:o};return(yield mt.post(s,this._mapConfig).catch(e=>{throw At(e,t),new Error(st.property("c040101"))})).result}))}addToViewer(t){return pu(this,void 0,void 0,(function*(){const{ended:e}=t,{czmlCfg:i,showPlayer:n}=this._options;this._mapConfig=this._userViewer.viewer.mapConfig,this._modelEvent=new Br,this._userViewer.viewer.layerCache.add(this);let r=yield this.initData(e),o=r.data&&r.data.length;if(!o)return void At("c040101",e);let s=this.unique(r.data);s=this.fillPoints(s),o=s.length;let a=s[0].timestamp,A=new Date(a).toISOString(),l=s[o-1].timestamp-a>=6e4?s[o-1].timestamp:a+6e4,c=new Date(l).toISOString(),u=s.map(t=>({longitude:t.longitude,latitude:t.latitude,alt:t.altitude?parseFloat(t.altitude):0,time:(t.timestamp-a)/1e3})),h=[];u.forEach(t=>{h.push(t.time,t.longitude,t.latitude,t.alt)}),this._dataSource=new f.CzmlDataSource,this.viewer.dataSources.add(this._dataSource);const{popup:p}=this._options;let d;if("object"==typeof i)if(i.id){let t=i;if(t.id=this._id,t.availability=`${A}/${c}`,t.model&&t.model.gltf){const i=yield _t(this._mapConfig,t.model.gltf);if(!i)return void At("c030101",e);t.model.gltf=i}t.position.epoch=A,t.position.cartographicDegrees=h,d={url:[{id:"document",version:"1.0",clock:{currentTime:""+A}},t]}}else{let t=i.model,n=i.path,r=i.label,o=i.cylinder,s=i.billboard;const a={id:""+this._id,availability:`${A}/${c}`,orientation:{velocityReference:"#position"},path:{material:{solidColor:{color:{rgba:n.color?[n.color[0],n.color[1],n.color[2],255*n.color[3]]:[255,255,0,255]}}},width:n.width||3,show:!Object(f.defined)(n.show)||n.show},position:{interpolationAlgorithm:"LAGRANGE",interpolationDegree:1,epoch:""+A,cartographicDegrees:h}};if(s&&(a.billboard={show:!!Object(f.defined)(s.show)&&s.show,image:{uri:s.url||""},width:s.width||void 0,height:s.height||void 0,scale:s.scale||1,pixelOffset:{cartesian2:s.pixelOffset||[0,0]},eyeOffset:{cartesian:s.eyeOffset||[0,0,0]},rotation:s.rotation||0,horizontalOrigin:et(s.horizontalOrigin),verticalOrigin:it(s.verticalOrigin),sizeInMeters:s.sizeInMeters||!1,scaleByDistance:{nearFarScalar:s.scaleByDistance||void 0},translucencyByDistance:{nearFarScalar:s.translucencyByDistance||void 0},pixelOffsetScaleByDistance:{nearFarScalar:s.pixelOffsetScaleByDistance||void 0}}),t){const i=yield _t(this._mapConfig,t.id);if(!i)return void At("c030101",e);a.model={show:!Object(f.defined)(t.show)||t.show,gltf:i,scale:t.scale||1,silhouetteColor:t.outline&&t.outline.color?[t.outline.color[0],t.outline.color[1],t.outline.color[2],255*t.outline.color[3]]:void 0,silhouetteSize:t.outline&&t.outline.width?t.outline.width:void 0}}o&&(a.cylinder={length:o.length||100,topRadius:0,bottomRadius:o.bottomRadius||500,material:{solidColor:{color:{rgba:o.color?[o.color[0],o.color[1],o.color[2],255*o.color[3]]:[255,255,0,255]}}},heightReference:"CLAMP_TO_GROUND",show:!!Object(f.defined)(o.show)&&o.show}),r&&(a.label={fillColor:[{rgba:r.color?[r.color[0],r.color[1],r.color[2],255*r.color[3]]:[255,255,0,255]}],font:"bold 10pt Segoe UI Semibold",horizontalOrigin:"CENTER",outlineColor:{rgba:r.outlineColor?[r.outlineColor[0],r.outlineColor[1],r.outlineColor[2],255*r.outlineColor[3]]:[255,255,0,255]},pixelOffset:{cartesian2:[0,-50]},scale:1,show:!!Object(f.defined)(r.show)&&r.show,style:"FILL",text:r.text||"",verticalOrigin:"CENTER"}),d={url:[{id:"document",version:"1.0",clock:{currentTime:""+A}},a]}}else if("string"==typeof i){let t={url:i,body:{}},n=yield mt.get(t,this._mapConfig);if(n.id=this._id,n.availability=`${A}/${c}`,n.model&&n.model.gltf){const t=yield _t(this._mapConfig,n.model.gltf);if(!t)return void At("c030101",e);n.model.gltf=t}n.position.epoch=A,n.position.cartographicDegrees=h,d={url:[{id:"document",version:"1.0",clock:{currentTime:""+A}},n]}}this.processPart(d),p&&(this._popupEvent=()=>{let t=this._dataSource.entities.getById(this._id);if(t){const e=t.position.getValue(this.viewer.clock.currentTime);let i=Y.CartesianToWGS84(e);if(this._popup)this._popup.setProperty({position:new I(i.lng,i.lat,i.alt)});else{const t=new I(i.lng,i.lat,i.alt);this._popup=new Qr({viewer:this._userViewer,position:t,element:p.element,anchor:p.anchor,offset:p.offset}),this._userViewer.addLayer({layer:this._popup})}}},this.viewer.clock.onTick.addEventListener(this._popupEvent)),n&&(this._trackPlayer.init(),this._trackPlayer.play()),at(!0,e)}))}processPart(t){const{onRender:e}=this._options;this._dataSource.process(t.url).then(()=>{this._instance=this._dataSource.entities.getById(this._id),e&&e(new I(t.url[1].position.cartographicDegrees[1],t.url[1].position.cartographicDegrees[2],t.url[1].position.cartographicDegrees[3]))})}remove(t={}){const{ended:e}=t;this._instance&&this.viewer.dataSources.remove(this._dataSource,!0)&&(this._instance=null,this._dataSource=null,this._modelEvent=null,this._userViewer.viewer.layerCache.remove(this),this._popup&&(this._popup.remove(),this._popup=null,this.viewer.clock.onTick.removeEventListener(this._popupEvent),this._popupEvent=null),this._trackPlayer&&this._trackPlayer.remove(),at(!0,e))}on(t){const{event:e,handler:i}=t;this._modelEvent.on(e,i,this)}off(t){const{event:e}=t;this._modelEvent.off(e,this)}play(){if(!this._isRunning){this._isEnd&&this._trackPlayer.replay();let t=this.viewer.animation.viewModel.pauseViewModel.command;t.canExecute&&(t(),this._isRunning=!0),this._trackPlayer.play(),this._isEnd=!1}}replay(t){this.setBy(t)}pause(){if(this._isRunning){let t=this.viewer.animation.viewModel.pauseViewModel.command;t.canExecute&&(t(),this._isRunning=!1),this._trackPlayer.pause()}}setSpeedRate(t){this.viewer.animation.viewModel.clockViewModel.multiplier=t}setBy(t){const e=this.viewer.animation.viewModel.clockViewModel,i=f.JulianDate.fromDate(new Date(t));e.currentTime=i}followPerspective(){this._instance&&(this.viewer.trackedEntity=this._instance,this._instance.viewFrom=new f.Cartesian3(100,100,100))}removeFollowPerspective(){this._instance&&(this.viewer.trackedEntity=void 0)}setVisible(t){t?(this._dataSource&&(this._dataSource.entities.show=!0),this._popup&&this._popup.show()):(this._dataSource&&(this._dataSource.entities.show=!1),this._popup&&this._popup.hide())}end(){const{ended:t}=this._options;this.pause(),this._isEnd=!0,t&&t()}fillPoints(t){const e=t.slice(),{startTime:i,endTime:n}=this._options,r=new Date(i).getTime(),o=new Date(n).getTime(),s=e.length,a=e[0],A=f.Cartesian3.fromDegrees(a.longitude,a.latitude,parseFloat(a.altitude||0)),l=e[1],c=f.Cartesian3.fromDegrees(l.longitude,l.latitude,parseFloat(l.altitude||0)),u=e[s-2],h=f.Cartesian3.fromDegrees(u.longitude,u.latitude,parseFloat(u.altitude||0)),p=e[s-1],d=f.Cartesian3.fromDegrees(p.longitude,p.latitude,parseFloat(p.altitude||0));if(r!==a.timestamp){const t=f.Cartesian3.normalize(f.Cartesian3.subtract(A,c,new f.Cartesian3),new f.Cartesian3),i=new f.Ray(A,t),n=new f.Cartesian3;f.Ray.getPoint(i,.1,n);const o=Y.CartesianToWGS84(n),s=Object.assign(Object.assign({},a),{timestamp:r,longitude:o.lng,latitude:o.lat});e.unshift(s)}if(o!==p.timestamp){const t=f.Cartesian3.normalize(f.Cartesian3.subtract(d,h,new f.Cartesian3),new f.Cartesian3),i=new f.Ray(d,t),n=new f.Cartesian3;f.Ray.getPoint(i,.1,n);const r=Y.CartesianToWGS84(n),s=Object.assign(Object.assign({},p),{timestamp:o+86400,longitude:r.lng,latitude:r.lat});e.push(s)}return e}unique(t){let e=[t[0]];for(let i=1;i<t.length;i++)t[i].timestamp!==e[e.length-1].timestamp&&e.push(t[i]);return e}}var fu=function(t,e,i,n){return new(i||(i=Promise))((function(r,o){function s(t){try{A(n.next(t))}catch(t){o(t)}}function a(t){try{A(n.throw(t))}catch(t){o(t)}}function A(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(s,a)}A((n=n.apply(t,e||[])).next())}))};class gu{constructor(t){this._instance=null,this._isRunning=!0,this._id=$("Vehicle"),this._layerType="model",this._options=t,this._userViewer=t.viewer,this._modelEvent=new Br,this._mapConfig=this._userViewer.viewer.mapConfig}addToViewer(t){return fu(this,void 0,void 0,(function*(){const{ended:e}=t,{czmlCfg:i}=this._options;Bt.getLayerCache(this._userViewer).add(this);let n=yield this.initData();if(!n)return void At("c040201",e);let r=n.total;if(!r)return void At("c040201",e);let o=n.data[0].timestamp,s=new Date(o).toISOString(),a=n.data[r-1].timestamp-o>=6e4?n.data[r-1].timestamp:o+6e4,A=new Date(a).toISOString(),l=n.data.map(t=>({longitude:t.longitude,latitude:t.latitude,alt:t.alt||0,time:(t.timestamp-o)/1e3})),c=[],u=[];l.forEach(t=>{c.push(t.time,t.longitude,t.latitude,t.alt),u.push(t.longitude,t.latitude,t.alt)}),this._dataSource=new f.CzmlDataSource,Bt.getEngine(this._userViewer).dataSources.add(this._dataSource);const{popup:h}=this._options;let p,d=void 0;if("object"==typeof i)if(i.id){let t=i;if(t.model&&t.model.gltf){const i=yield _t(this._mapConfig,t.model.gltf);if(!i)return void At("c030101",e);t.model.gltf=i}t.id=this._id,t.availability=`${s}/${A}`,t.polyline.positions.cartographicDegrees=u,t.path.leadTime=0,t.path.trailTime=(a-o)/1e3,t.position.epoch=s,t.position.cartographicDegrees=c,p={url:[{id:"document",version:"1.0"},t]}}else{let t=i.model,n=i.path,r=i.label,l=i.cylinder,h=i.billboard;n&&n.passedColor&&(d=[n.passedColor[0],n.passedColor[1],n.passedColor[2],255*n.passedColor[3]]);const g={id:""+this._id,availability:`${s}/${A}`,orientation:{velocityReference:"#position"},polyline:{show:!n||!Object(f.defined)(n.show)||n.show,clampToGround:!0,material:{solidColor:{color:{rgba:n&&n.color?[n.color[0],n.color[1],n.color[2],255*n.color[3]]:[255,255,0,255]}}},width:n&&n.width?n.width:3,positions:{cartographicDegrees:u}},path:{show:(!n||!Object(f.defined)(n.show)||!1!==n.show)&&!!d,material:{solidColor:{color:{rgba:d?[d[0],d[1],d[2],d[3]]:[0,255,0,255]}}},width:n&&n.width?n.width:3,leadTime:0,trailTime:(a-o)/1e3},position:{interpolationAlgorithm:"LAGRANGE",interpolationDegree:1,epoch:""+s,cartographicDegrees:c}};if(h&&(g.billboard={show:!!Object(f.defined)(h.show)&&h.show,image:{uri:h.url||""},width:h.width||void 0,height:h.height||void 0,scale:h.scale||1,pixelOffset:{cartesian2:h.pixelOffset||[0,0]},eyeOffset:{cartesian:h.eyeOffset||[0,0,0]},rotation:h.rotation||0,horizontalOrigin:et(h.horizontalOrigin),verticalOrigin:it(h.verticalOrigin),sizeInMeters:h.sizeInMeters||!1,scaleByDistance:{nearFarScalar:h.scaleByDistance||void 0},translucencyByDistance:{nearFarScalar:h.translucencyByDistance||void 0},pixelOffsetScaleByDistance:{nearFarScalar:h.pixelOffsetScaleByDistance||void 0}}),t){const i=yield _t(this._mapConfig,t.id);if(!i)return void At("c030101",e);g.model={show:!Object(f.defined)(t.show)||t.show,gltf:i,scale:t.scale||1,silhouetteColor:t.outline&&t.outline.color?[t.outline.color[0],t.outline.color[1],t.outline.color[2],255*t.outline.color[3]]:void 0,silhouetteSize:t.outline&&t.outline.width?t.outline.width:void 0}}l&&(g.cylinder={length:l.length||100,topRadius:0,bottomRadius:l.bottomRadius||500,material:{solidColor:{color:{rgba:l.color?[l.color[0],l.color[1],l.color[2],255*l.color[3]]:[255,255,0,255]}}},heightReference:"CLAMP_TO_GROUND",show:!!Object(f.defined)(l.show)&&l.show}),r&&(g.label={fillColor:[{rgba:r.color?[r.color[0],r.color[1],r.color[2],255*r.color[3]]:[255,255,0,255]}],outlineColor:{rgba:r.outlineColor?[r.outlineColor[0],r.outlineColor[1],r.outlineColor[2],255*r.outlineColor[3]]:[255,255,0,255]},pixelOffset:{cartesian2:[0,-50]},font:"bold 10pt Segoe UI Semibold",show:!!Object(f.defined)(r.show)&&r.show,text:r.text||""}),p={url:[{id:"document",version:"1.0"},g]}}else if("string"==typeof i){let t={url:i,body:{}},n=yield mt.get(t,this._mapConfig);if(n.id=this._id,n.availability=`${s}/${A}`,n.model&&n.model.gltf){const t=yield _t(this._mapConfig,n.model.gltf);if(!t)return void At("c030101",e);n.model.gltf=t}n.polyline.positions.cartographicDegrees=u,n.path.leadTime=0,n.path.trailTime=(a-o)/1e3,n.position.epoch=s,n.position.cartographicDegrees=c,p={url:[{id:"document",version:"1.0"},n]}}this.processPart(p),h&&(this._popupEvent=()=>{let t=this._dataSource.entities.getById(this._id);if(t){let e=new f.Cartesian3(...t.position._property._interpolationResult),i=Y.CartesianToWGS84(e);if(this._popup)this._popup.setProperty({position:new I(i.lng,i.lat,i.alt)});else{const t=new I(i.lng,i.lat,i.alt);this._popup=new Qr({viewer:this._userViewer,position:t,element:h.element,anchor:h.anchor,offset:h.offset}),this._userViewer.addLayer({layer:this._popup})}}},Bt.getEngine(this._userViewer).clock.onTick.addEventListener(this._popupEvent)),at(!0,e)}))}initData(){return fu(this,void 0,void 0,(function*(){const{points:t,duration:e=6e4,isPlan:i=!1}=this._options;let n;if(i){let e=t[0].join(","),i=t[t.length-1].join(","),o="";if(t.length>2){t.slice(1,t.length-1).forEach(t=>{let e=t.join(",");o+=e+";"}),o=o.substring(0,o.length-1)}let s={url:(r=this._mapConfig,{DRIVING_ROUTE_URL:r.routingServer+"/trackingData"}).DRIVING_ROUTE_URL,body:{sPoint:e,ePoint:i,wayPoints:o,st:1}},a=yield mt.get(s,this._mapConfig).catch(t=>null);if(!a)return;a=a.result;let A=a.rows[0].routelatlon.split(";");n=this.unique(A)}else{let e="";t.forEach(t=>{e+=t.join(",")+";"}),e=e.substring(0,e.length-1),n=e.split(";")}var r;let o=[],s=new Date("2021-08-12 12:00:00").getTime(),a=Math.ceil(e/(n.length-1));for(let t=0,e=n.length;t<e;t++)if(n[t]){let e=n[t].split(","),i=parseFloat(e[0]),r=parseFloat(e[1]),A=parseFloat(e[2]||0);o.push({latitude:r,longitude:i,alt:A,timestamp:s+t*a})}return{data:o,total:o.length}}))}processPart(t){const{onRender:e}=this._options;this._dataSource.process(t.url).then(()=>{this._instance=this._dataSource.entities.getById(this._id);let i=Bt.getEngine(this._userViewer).animation.viewModel;if(i.pauseViewModel.toggled){let t=i.pauseViewModel.command;t.canExecute&&t()}e&&e(new I(t.url[1].position.cartographicDegrees[1],t.url[1].position.cartographicDegrees[2],t.url[1].position.cartographicDegrees[3]))})}remove(t={}){const{ended:e}=t;this._instance&&Bt.getEngine(this._userViewer).dataSources.remove(this._dataSource,!0)&&(this._instance=null,this._dataSource=null,this._modelEvent=null,Bt.getLayerCache(this._userViewer).remove(this),this._popup&&(this._popup.remove(),this._popup=null,Bt.getEngine(this._userViewer).clock.onTick.removeEventListener(this._popupEvent),this._popupEvent=null),at(!0,e))}followPerspective(){this._instance&&(Bt.getEngine(this._userViewer).trackedEntity=this._instance,this._instance.viewFrom=new f.Cartesian3(100,100,100))}removeFollowPerspective(){this._instance&&(Bt.getEngine(this._userViewer).trackedEntity=void 0)}on(t){const{event:e,handler:i}=t;this._modelEvent.on(e,i,this)}off(t){const{event:e}=t;this._modelEvent.off(e,this)}play(){if(!this._isRunning){let t=Bt.getEngine(this._userViewer).animation.viewModel.pauseViewModel.command;t.canExecute&&(t(),this._isRunning=!0)}}pause(){if(this._isRunning){let t=Bt.getEngine(this._userViewer).animation.viewModel.pauseViewModel.command;t.canExecute&&(t(),this._isRunning=!1)}}setMultiple(t){this._instance&&(Bt.getEngine(this._userViewer).clock.multiplier=t)}setVisible(t){t?(this._dataSource&&(this._dataSource.entities.show=!0),this._popup&&this._popup.show()):(this._dataSource&&(this._dataSource.entities.show=!1),this._popup&&this._popup.hide())}unique(t){let e=[t[0]];for(let i=1;i<t.length;i++)t[i]!==e[e.length-1]&&e.push(t[i]);return e}}var mu=i(3),yu=i.n(mu),vu=i(4),_u=function(t,e,i,n){return new(i||(i=Promise))((function(r,o){function s(t){try{A(n.next(t))}catch(t){o(t)}}function a(t){try{A(n.throw(t))}catch(t){o(t)}}function A(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(s,a)}A((n=n.apply(t,e||[])).next())}))};class wu{constructor(t){this._instance=null,this._trackData=[],this._firstISO="",this._lastISO="",this._relationISO={},this._id=$("Vehicle"),this._layerType="model",this._emitFirstEvent=!1,this._modelUrl="",this._options=t,this._userViewer=t.viewer}get viewer(){return this._userViewer.viewer.instance}addToViewer(t){return _u(this,void 0,void 0,(function*(){const{ended:e}=t;this._mapConfig=this._userViewer.viewer.mapConfig,this._modelEvent=new Br,this._userViewer.viewer.layerCache.add(this);let i=this;const{gbid:n,popup:r}=this._options;let o={clientId:$(),traceType:3,appName:"public_space",serviceName:"device_base",traceZoom:0,gbids:[n],currentZoom:11},s={url:ut(this._mapConfig).SUBSCRIBE_GPS_DEVICE,body:o},a=yield mt.post(s,this._mapConfig).catch(t=>{At("c040301",e)});if(!a)return;let A=a.result.traceId,l=new yu.a(""+ut(this._mapConfig).WS_SERVER);this._stompClient=vu.Stomp.over(l),this._stompClient.connect({username:"public_space-device_base$"+$()},()=>{this._stompClient.subscribe("/topic/trace/"+A,t=>{let e=JSON.parse(t.body);i.handlerData(e)})}),this._dataSource=new f.CzmlDataSource,this.viewer.dataSources.add(this._dataSource),r&&(this._popupEvent=()=>{let t=this._dataSource.entities.getById(this._id);if(t){let e=new f.Cartesian3(...t.position._property._interpolationResult),i=Y.CartesianToWGS84(e);this._popup?this._popup.setProperty({position:new I(i.lng,i.lat,i.alt)}):(this._popup=new Qr({viewer:this._userViewer,position:new I(i.lng,i.lat,i.alt),element:r.element,anchor:r.anchor,offset:r.offset}),this._userViewer.addLayer({layer:this._popup}))}},this.viewer.clock.onTick.addEventListener(this._popupEvent)),at(!0,e)}))}handlerData(t){return _u(this,void 0,void 0,(function*(){let e=t.data;if(!e)return;const{onMessage:i,gbid:n,ended:r}=this._options,{longitude:o,latitude:s,altitude:a,timestamp:A}=e;i&&i({gbid:n,properties:e});let l=new Date(A).getTime();this._firstISO||(this._firstISO=new Date(l).toISOString(),this._relationISO={current:this._firstISO,next:this._firstISO});let c=new Date(A).getTime()+864e5;this._lastISO=new Date(c).toISOString(),this._relationISO={current:this._relationISO.next,next:new Date(A).toISOString()};let u=new Date(A).getTime()-new Date(this._firstISO).getTime(),h=c-new Date(this._firstISO).getTime(),p={longitude:o,latitude:s,alt:a?parseFloat(a):0,time:u/1e3};if(this._trackData.length>4&&(this._trackData.splice(this._trackData.length-4,4),this._instance&&this._instance.position.removeSample(this._instance.position._property._times[this._instance.position._property._times.length-1])),this._trackData.push(p.time,p.longitude,p.latitude,p.alt),this._trackData.length>4){let t,e=this._trackData.length,i=f.Cartesian3.fromDegrees(this._trackData[e-3],this._trackData[e-2],this._trackData[e-1]),n=f.Cartesian3.fromDegrees(this._trackData[e-3-4],this._trackData[e-2-4],this._trackData[e-1-4]);n.equals(i)&&this._direction?t=this._direction:(t=f.Cartesian3.subtract(i,n,new f.Cartesian3),this._direction=t);let r=new f.Ray(i,t),o=new f.Cartesian3;f.Ray.getPoint(r,100,o);let s=Y.CartesianToWGS84(o);this._trackData.push(p.time+86400,s.lng,s.lat,s.alt)}const{czmlCfg:d,onRender:g}=this._options;if("object"==typeof d)if(d.id){let t=d;if(t.id=this._id,t.model&&t.model.gltf){if(!this._modelUrl){const e=yield _t(this._mapConfig,t.model.gltf);if(!e)return void At("c030101",r);this._modelUrl=e}t.model.gltf=this._modelUrl}t.position.epoch=this._firstISO,t.position.cartographicDegrees=this._trackData,t.path=Object.assign(Object.assign({},t.path),{leadTime:0,trailTime:h/1e3}),this._part={url:[{id:"document",version:"1.0",clock:{interval:`${this._firstISO}/${this._lastISO}`,currentTime:""+this._relationISO.current}},t]}}else{let t=d.model,e=d.path,i=d.label,n=d.cylinder,o=d.billboard;const s={id:""+this._id,orientation:{velocityReference:"#position"},path:{material:{solidColor:{color:{rgba:e.color?[e.color[0],e.color[1],e.color[2],255*e.color[3]]:[255,255,0,255]}}},width:e.width||3,show:!Object(f.defined)(e.show)||e.show,leadTime:0,trailTime:h/1e3},position:{interpolationAlgorithm:"GEODESIC",interpolationDegree:1,epoch:""+this._firstISO,cartographicDegrees:this._trackData}};if(o&&(s.billboard={show:!!Object(f.defined)(o.show)&&o.show,image:{uri:o.url||""},width:o.width||void 0,height:o.height||void 0,scale:o.scale||1,pixelOffset:{cartesian2:o.pixelOffset||[0,0]},eyeOffset:{cartesian:o.eyeOffset||[0,0,0]},rotation:o.rotation||0,horizontalOrigin:et(o.horizontalOrigin),verticalOrigin:it(o.verticalOrigin),sizeInMeters:o.sizeInMeters||!1,scaleByDistance:{nearFarScalar:o.scaleByDistance||void 0},translucencyByDistance:{nearFarScalar:o.translucencyByDistance||void 0},pixelOffsetScaleByDistance:{nearFarScalar:o.pixelOffsetScaleByDistance||void 0}}),t){if(!this._modelUrl){const e=yield _t(this._mapConfig,t.id);if(!e)return void At("c030101",r);this._modelUrl=e}s.model={show:!Object(f.defined)(t.show)||t.show,gltf:this._modelUrl,scale:t.scale||1,silhouetteColor:t.outline&&t.outline.color?[t.outline.color[0],t.outline.color[1],t.outline.color[2],255*t.outline.color[3]]:void 0,silhouetteSize:t.outline&&t.outline.width?t.outline.width:void 0}}n&&(s.cylinder={length:n.length||100,topRadius:0,bottomRadius:n.bottomRadius||500,material:{solidColor:{color:{rgba:n.color?[n.color[0],n.color[1],n.color[2],255*n.color[3]]:[255,255,0,255]}}},heightReference:"CLAMP_TO_GROUND",show:!!Object(f.defined)(n.show)&&n.show}),i&&(s.label={fillColor:[{rgba:i.color?[i.color[0],i.color[1],i.color[2],255*i.color[3]]:[255,255,0,255]}],font:"bold 10pt Segoe UI Semibold",horizontalOrigin:"CENTER",outlineColor:{rgba:i.outlineColor?[i.outlineColor[0],i.outlineColor[1],i.outlineColor[2],255*i.outlineColor[3]]:[255,255,0,255]},pixelOffset:{cartesian2:[0,-50]},scale:1,show:!!Object(f.defined)(i.show)&&i.show,style:"FILL",text:i.text||"",verticalOrigin:"CENTER"}),this._part={url:[{id:"document",version:"1.0",clock:{interval:`${this._firstISO}/${this._lastISO}`,currentTime:""+this._relationISO.current}},s]}}else if("string"==typeof d){let t={url:d,body:{}},e=yield mt.get(t,this._mapConfig);if(e.id=this._id,e.model&&e.model.gltf){if(!this._modelUrl){const t=yield _t(this._mapConfig,e.model.gltf);if(!t)return void At("c030101",r);this._modelUrl=t}e.model.gltf=this._modelUrl}e.position.epoch=this._firstISO,e.position.cartographicDegrees=this._trackData,e.path=Object.assign(Object.assign({},e.path),{leadTime:0,trailTime:h/1e3}),this._part={url:[{id:"document",version:"1.0",clock:{interval:`${this._firstISO}/${this._lastISO}`,currentTime:""+this._relationISO.current}},e]}}this._trackData.length>=8&&this._dataSource.process(this._part.url).then(()=>{this._instance=this._dataSource.entities.getById(this._id),g&&!this._emitFirstEvent&&(g(new I(this._part.url[1].position.cartographicDegrees[1],this._part.url[1].position.cartographicDegrees[2],this._part.url[1].position.cartographicDegrees[3])),this._emitFirstEvent=!0)})}))}remove(t={}){const{ended:e}=t;null!=this._stompClient&&(this._stompClient.disconnect(),this._stompClient=null),this._instance&&this.viewer.dataSources.remove(this._dataSource,!0)&&(this._instance=null,this._dataSource=null,this._modelEvent=null,this._userViewer.viewer.layerCache.remove(this),this._popup&&(this._popup.remove(),this._popup=null,this.viewer.clock.onTick.removeEventListener(this._popupEvent),this._popupEvent=null),at(!0,e))}followPerspective(){this._instance&&(this.viewer.trackedEntity=this._instance,this._instance.viewFrom=new f.Cartesian3(100,100,100))}removeFollowPerspective(){this._instance&&(this.viewer.trackedEntity=void 0)}on(t){const{event:e,handler:i}=t;this._modelEvent.on(e,i,this)}off(t){const{event:e}=t;this._modelEvent.off(e,this)}setVisible(t){t?(this._dataSource&&(this._dataSource.entities.show=!0),this._popup&&this._popup.show()):(this._dataSource&&(this._dataSource.entities.show=!1),this._popup&&this._popup.hide())}}var Cu=function(t,e,i,n){return new(i||(i=Promise))((function(r,o){function s(t){try{A(n.next(t))}catch(t){o(t)}}function a(t){try{A(n.throw(t))}catch(t){o(t)}}function A(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(s,a)}A((n=n.apply(t,e||[])).next())}))};class Bu{constructor(t){this._trackDatas={},this._concernList=[],this._popupList=[],this._isHideNoConcern=!1,this._modelUrls={},this._prevTimestamp={},this._traceId="",this._options=t,this._userViewer=t.viewer,this._mapConfig=this._userViewer.viewer.mapConfig,this._trackEvent=new Sr(this._userViewer.viewer.instance)}addToViewer(t){return Cu(this,void 0,void 0,(function*(){const{ended:e}=t,{icons:i,gbids:n}=this._options;if(!(yield this.handlerIcons(i)))return void At("c030101",e);let r=this,o={traceZoom:5,gbids:n,currentZoom:18},s={url:ut(this._mapConfig).SUBSCRIBE_INTERSECTION,body:o},a=(yield mt.post(s,{})).result;this._traceId=a.traceId,at(!0,e),this._frame=()=>{for(let t in this._trackDatas){let e=Date.now()-this._prevTimestamp[t]-1500,i=this._trackDatas[t].object,n=this._trackDatas[t].points;if(n&&n.length>1&&e>0){let r=n[0],o=n[1];if(e>o.timestamp-r.timestamp){this._prevTimestamp[t]+=o.timestamp-r.timestamp,n.shift();continue}let s=ee(r.point,o.point),a=e/(o.timestamp-r.timestamp),A=re(Mt([r.point,o.point]),a*ne(r.point,o.point)).geometry.coordinates,l=Object(g.findIndex)(this._popupList,{vNo:i.props.plateNo});if(l>-1)if(this._popupList[l].instance){let t=this._popupList[l].instance;t&&t.setProperty({position:new I(A[0],A[1],0)})}else{let t=this._popupList[l].popup,e=new Qr({viewer:this._userViewer,position:new I(A[0],A[1],0),element:t.element,anchor:t.anchor,offset:t.offset});e.addToViewer({ended:()=>{}}),this._popupList[l].instance=e}if(i){let t=f.Cartesian3.fromDegrees(A[0],A[1]);if(i.position=t,0!==s){let e=new f.HeadingPitchRoll(f.Math.toRadians(s-90),0,0),n=f.Transforms.headingPitchRollQuaternion(t,e);i.orientation=n}}}}},this._userViewer.viewer.instance.clock.onTick.addEventListener(this._frame);let A=new yu.a(""+ut(this._mapConfig).WS_SERVER);this._stompClient=vu.Stomp.over(A),this._stompClient.debug=function(){},this._stompClient.connect({username:"public_space-device_base$"+$()},()=>{this._stompClient.subscribe("/topic/scTrace/"+this._traceId,t=>{let e=JSON.parse(t.body);r.handlerData(e)})})}))}handlerData(t){return Cu(this,void 0,void 0,(function*(){if(!t)return;const{onmessage:e}=this._options,{objID:i,disappearFlag:n,objPlaceLongitude:r,objPlaceLatitude:o,objType:s,objAngle:a,plateNo:A,timestamp:l}=t;if(this._prevTimestamp[i]||(this._prevTimestamp[i]=Date.now()),1===n)delete this._prevTimestamp[i],this._trackDatas[i]&&(this._userViewer.viewer.instance.entities.remove(this._trackDatas[i].object),delete this._trackDatas[i]),"unknown"!=A&&""!=A&&this.removePopup({vehPlate:A});else{if(this._trackDatas[i])this._trackDatas[i].object.props=Object.assign({},t),this._isHideNoConcern?A&&this._concernList.indexOf(A)>-1?this._trackDatas[i].object.show=!0:this._trackDatas[i].object.show=!1:this._trackDatas[i].object.show=!0;else{let e=f.Cartesian3.fromDegrees(r,o,0),n=new f.HeadingPitchRoll(f.Math.toRadians(a-90),0,0),l={position:e,orientation:f.Transforms.headingPitchRollQuaternion(e,n),props:Object.assign({},t)};this._modelUrls[s]&&(l.model={uri:this._modelUrls[s].url,scale:this._modelUrls[s].scale}),this._isHideNoConcern&&(A&&this._concernList.indexOf(A)>-1?l.show=!0:l.show=!1),this._trackDatas[i]={},this._trackDatas[i].object=this._userViewer.viewer.instance.entities.add(l)}if(this._trackDatas[i].points||(this._trackDatas[i].points=[]),this._trackDatas[i].points.push({timestamp:l,point:[r,o]}),e){let t=[];for(let e in this._trackDatas)t.push(this._trackDatas[e].object.props);e(t)}}}))}setAttentions(t){const{attentions:e=[],ended:i}=t;this._concernList=e,at(this._concernList,i)}showAttentions(t={}){const{ended:e}=t;this._isHideNoConcern=!0,at(!0,e)}showAll(t={}){const{ended:e}=t;this._isHideNoConcern=!1,at(!0,e)}setPerspective(t){const{vehPlate:e,ended:i}=t;for(let t in this._trackDatas){let n=this._trackDatas[t].object;if(n.props.plateNo&&n.props.plateNo===e){let t=this._userViewer.getCurrentCameraInfo().data;this._userViewer.zoomToPosition({position:new I(n.props.objPlaceLongitude,n.props.objPlaceLatitude,t.alt,0,-90,0)}),at(!0,i)}}}followPerspective(t){const{vehPlate:e,ended:i}=t;for(let t in this._trackDatas){let n=this._trackDatas[t].object;n.props.plateNo&&n.props.plateNo===e&&(this._userViewer.viewer.instance.trackedEntity=n,at(!0,i))}}removeFollowPerspective(t={}){const{ended:e}=t;this._userViewer.viewer.instance.trackedEntity=void 0,at(!0,e)}addPopup(t){const{vehPlate:e,popup:i,ended:n}=t;-1===Object(g.findIndex)(this._popupList,{vNo:e})&&(this._popupList.push({vNo:e,popup:i}),at(!0,n))}removePopup(t){const{vehPlate:e,ended:i}=t;let n=Object(g.findIndex)(this._popupList,{vNo:e});if(n>-1){let t=this._popupList[n].instance;t&&t.remove(),delete this._popupList[n],at(!0,i)}}clearAllPopup(t={}){const{ended:e}=t;this._popupList.forEach(t=>{t.instance&&t.instance.remove()}),this._popupList=[],at(!0,e)}on(t){this._trackEvent.on(t,this._trackDatas)}off(t){this._trackEvent.off(t)}remove(t={}){return Cu(this,void 0,void 0,(function*(){const{ended:e}=t;null!=this._stompClient&&(this._stompClient.disconnect(),this._stompClient=null);let i={traceId:this._traceId};(yield this.postXhrCancelNetwork(i))||At("c040301",e);for(let t in this._trackDatas)this._userViewer.viewer.instance.entities.remove(this._trackDatas[t].object),delete this._trackDatas[t];this._concernList=[],this.clearAllPopup(),this._userViewer.viewer.instance.clock.onTick.removeEventListener(this._frame),at(!0,e)}))}setIcons(t){return Cu(this,void 0,void 0,(function*(){const{icons:e,ended:i}=t;(yield this.handlerIcons(e))?at(!0,i):At("c030101",i)}))}handlerIcons(t){return Cu(this,void 0,void 0,(function*(){let e=t.map(t=>vt(this._mapConfig,t.modelId)),i=yield this.checkModelLoaded(e);return new Promise((e,n)=>{if(i&&Array.isArray(i)&&i.length){i.every(t=>t&&t.startsWith("http"))||e(!1),t.forEach((t,e)=>{this._modelUrls[t.type]={url:i[e],scale:t.scale||1}}),e(!0)}else e(!1)})}))}checkModelLoaded(t){return Cu(this,void 0,void 0,(function*(){return new Promise((e,i)=>{Promise.all(t).then(t=>{e(t)}).catch(t=>{e(t)})})}))}postXhrCancelNetwork(t){return Cu(this,void 0,void 0,(function*(){return new Promise((e,i)=>{let n={url:ut(this._mapConfig).UNSUBSCRIBE_INTERSECTION,body:t};mt.post(n,{}).then(t=>{200===t.status&&e(!0)}).catch(t=>{e(!1)})})}))}}var bu=function(t,e,i,n){return new(i||(i=Promise))((function(r,o){function s(t){try{A(n.next(t))}catch(t){o(t)}}function a(t){try{A(n.throw(t))}catch(t){o(t)}}function A(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(s,a)}A((n=n.apply(t,e||[])).next())}))};class Eu{constructor(t){this._traceId="",this._options=t,this._userViewer=t.viewer,this._mapConfig=this._userViewer.viewer.mapConfig}addToViewer(t){return bu(this,void 0,void 0,(function*(){const{ended:e}=t,{vehPlate:i,gbids:n,onmessage:r}=this._options;let o={gbids:n,carNo:i,appName:"public_space",serviceName:"device_base"},s={url:ut(this._mapConfig).SUBSCRIBE_ELECTRONIC,body:o},a=(yield mt.post(s,{})).result;this._traceId=a.traceId;let A=new yu.a(""+ut(this._mapConfig).WS_SERVER);this._stompClient=vu.Stomp.over(A),this._stompClient.debug=function(){},at(!0,e),this._stompClient.connect({username:"public_space-device_base$"+$()},()=>{this._stompClient.subscribe("/topic/elcTrace/"+this._traceId,t=>{let e=JSON.parse(t.body);r&&r(e)})})}))}remove(t){return bu(this,void 0,void 0,(function*(){const{ended:e}=t;null!=this._stompClient&&(this._stompClient.disconnect(),this._stompClient=null);let i={traceId:this._traceId};(yield this.postXhrCancelNetwork(i))||At("c040301",e),at(!0,e)}))}updateGbids(t={}){const{gbids:e,ended:i}=t;let n={traceId:this._traceId,gbids:e},r={url:ut(this._mapConfig).UPDATE_MONITOR_DEVICE,body:n};mt.post(r,{}).then(t=>{200===t.status&&t.result&&at(t.result,i)}).catch(t=>{At(t,i)})}postXhrCancelNetwork(t){return bu(this,void 0,void 0,(function*(){return new Promise((e,i)=>{let n={url:ut(this._mapConfig).UNSUBSCRIBE_ELECTRONIC,body:t};mt.post(n,{}).then(t=>{200===t.status&&e(!0)}).catch(t=>{e(!1)})})}))}}class Su{constructor(t,e,i){this.userViewer=i,this.lineLayer=null,this.init(t,e)}get viewer(){return this.userViewer.viewer.instance}init(t,e){const i=e["line-width"],n=e["line-color"],r=!!Object(f.defined)(e["line-style"])&&e["line-style"],o=t.features[0].geometry.coordinates,s=Object(g.flattenDeep)(o),a=f.Cartesian3.fromDegreesArray(s);let A,l=0;const c=Math.floor(e["line-distance"]/2e3);if(!1!==r){let t=this.userViewer.viewer.mapConfig.distUrl+"Imgs/";0===r?t+="arrow_blue.jpg":1===r?t+="arrow_red.jpg":2===r?t+="arrow_yellow.jpg":3===r&&(t+="arrow_green.jpg");const e=new f.CallbackProperty(()=>{let t=this.userViewer.getCurrentCameraInfo().data.alt;return t>5e3?l=10:t>2e3&&t<5e3?l=30:t>1e3&&t<2e3?l=40:t>200&&t<1e3?l=100:t>50&&t<200?l=300:t>0&&t<50&&(l=1e3),new f.Cartesian2(l*c,1)},!1);A=new f.ImageMaterialProperty({image:t,repeat:e})}else A=f.Color.fromCssColorString(n);this.lineLayer?this.lineLayer.polyline.positions=a:(this.lineLayer=new f.Entity({polyline:{clampToGround:!0,positions:a,width:i,material:A}}),this.viewer.entities.add(this.lineLayer))}update(t,e){this.init(t,e)}setVisible(t){this.lineLayer.show=t}destroy(){this.viewer.entities.remove(this.lineLayer)}addEvent(t,e){this.lineLayer.on(t,e)}removeEvent(t){this.lineLayer.off(t)}}i(59);var xu=function(t,e,i,n){return new(i||(i=Promise))((function(r,o){function s(t){try{A(n.next(t))}catch(t){o(t)}}function a(t){try{A(n.throw(t))}catch(t){o(t)}}function A(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(s,a)}A((n=n.apply(t,e||[])).next())}))};class Iu{constructor(t){this._data=null,this._geojson=null,this.sMarker={},this.eMarker={},this.markers=[],this.isDrag=!1,this._options=Object.assign({policy:"leastTime"},t),this._userViewer=t.viewer,this._mapConfig=this._userViewer.viewer.mapConfig,this._planOptions={startPoint:[],endPoint:[],wayPoints:[],avoidPolygons:[]}}addToViewer(t){return xu(this,void 0,void 0,(function*(){const{ended:e}=t;at(!0,e)}))}search(t,e,i){(t||e||i)&&(this.isDrag=!1),t&&(this._planOptions.startPoint=t),e&&(this._planOptions.endPoint=e),i&&(this._planOptions.wayPoints=i);const n=this.getPolicyParams();this.requestPlanData({extraParams:n}).then(t=>{void 0!==this._options.routeVisible&&!0!==this._options.routeVisible||this.renderLayer(),void 0!==this._options.markerVisible&&!0!==this._options.markerVisible||this.renderMarkers();const e=this._data,i=this.getPointsAndAreas();this._options.updateHandler&&this._options.updateHandler(e,i)})}setWayPoints(t){this._planOptions.wayPoints=t,this.isDrag=!1,this.search()}getWayPoints(){return this._planOptions.wayPoints}clearWayPoints(){this._planOptions.wayPoints=[],this.isDrag=!1,this.search()}setAvoidPolygons(t){this._planOptions.avoidPolygons=t,this.isDrag=!1,this.search()}getAvoidPolygons(){return this._planOptions.avoidPolygons}clearAvoidPolygons(){this._planOptions.avoidPolygons=[],this.isDrag=!1,this.search()}remove(t={}){const{ended:e}=t;this.clearMarkers(),this.clearAllLayer(),this._data=this._geojson=this._options=null,at(!0,e)}on(t){const{event:e,handler:i}=t}off(t){const{event:e}=t}initMarkers(){let t=document.createElement("div");t.className="kmap-road-plan-marker-start-img";let e=new Qr({viewer:this._userViewer,anchor:"bottom",position:new I(...this._planOptions.startPoint),element:t});this._userViewer.addLayer({layer:e}),this.sMarker.marker=e,this.sMarker.tag="start",e.setDraggable(!0),e.on({event:"dragend",handler:t=>{this.markerDragHandler(t,this.sMarker)}});var i=document.createElement("div");i.className="kmap-road-plan-marker-end-img";let n=new Qr({viewer:this._userViewer,anchor:"bottom",position:new I(...this._planOptions.endPoint),element:i});this._userViewer.addLayer({layer:n}),this.eMarker.marker=n,this.eMarker.tag="end",n.setDraggable(!0),n.on({event:"dragend",handler:t=>{this.markerDragHandler(t,this.eMarker)}})}updateMarkers(){this.sMarker.marker.setStyle({position:new I(...this._planOptions.startPoint)}),this.eMarker.marker.setStyle({position:new I(...this._planOptions.endPoint)})}addWayToPointMarker(t){var e=document.createElement("div"),i=document.createElement("div");i.setAttribute("style","\n\t\t\t\tcursor: pointer;\n\t\t\t\twidth: 20px;\n\t\t\t\theight: 20px;\n\t\t\t\ttext-align: center;\n\t\t\t\tline-height: 18px;\n\t\t\t\tfont-size: 12px;\n\t\t\t\tborder-radius: 10px;\n\t\t\t\tbackground-color: white;\n\t\t\t\tborder: 1px solid #ddd;\n\t\t\t\tfont-weight: bold;\n\t\t\t\tposition: absolute;\n\t\t\t\tright: -10px;\n\t\t\t\ttop: -10px;\n\t\t\t\tcolor: #000;\n\t\t\t"),i.innerHTML="X",e.className="kmap-road-plan-marker-middle-img";let n=new Qr({viewer:this._userViewer,anchor:"bottom",position:new I(...t),element:e});this._userViewer.addLayer({layer:n});let r={marker:n,point:t,tag:"middle-"+this.markers.length,closeButton:i};this.markers.push(r),n.setDraggable(!0),n.on({event:"dragend",handler:t=>{this.markerDragHandler(t,r)}})}markerDragHandler(t,e){this.isDrag=!0;const i=e.marker.getPosition(),n=[i.lng,i.lat];let r=e.tag;if("start"===r)this.sMarker.point=this._planOptions.startPoint=n,this.search();else if("end"===r)this.eMarker.point=this._planOptions.endPoint=n,this.search();else{let t=this.getMarkerIndex(e);null!==t&&(this.markers[t].point=this._planOptions.wayPoints[t]=n,this.search())}}getMarkerIndex(t){let e=t.tag,i=this.markers.length;for(let t=0;t<i;t++)if(this.markers[t].tag===e)return t;return null}clearMarkers(){this.sMarker&&this.sMarker.marker&&(this.sMarker.marker.remove(),this.sMarker={}),this.eMarker&&this.eMarker.marker&&(this.eMarker.marker.remove(),this.eMarker={}),this.removeWaypointsMarker()}removeWaypointsMarker(){if(this.markers&&this.markers.length>0){let t=this.markers.length;for(let e=0;e<t;e++)this.markers[e].marker.remove();this.markers=[]}}clearAllLayer(){this._roadLayer&&this._roadLayer.destroy(),this._roadLayer=null}setRouteVisible(t){this._roadLayer&&this._roadLayer.setVisible(t)}setMarkerVisible(t){if(t){if(this.sMarker&&this.sMarker.marker&&this.sMarker.marker.show(),this.eMarker&&this.eMarker.marker&&this.eMarker.marker.show(),this.markers&&this.markers.length>0){let t=this.markers.length;for(let e=0;e<t;e++)this.markers[e].marker.show()}}else if(this.sMarker&&this.sMarker.marker&&this.sMarker.marker.hide(),this.eMarker&&this.eMarker.marker&&this.eMarker.marker.hide(),this.markers&&this.markers.length>0){let t=this.markers.length;for(let e=0;e<t;e++)this.markers[e].marker.hide()}}renderMarkers(){this.sMarker.marker&&this.eMarker.marker?this.isDrag||this.updateMarkers():this.initMarkers(),this.isDrag||(this.removeWaypointsMarker(),this._planOptions.wayPoints&&this._planOptions.wayPoints.length&&this._planOptions.wayPoints.forEach(t=>{this.addWayToPointMarker(t)}))}renderLayer(){const{lineWidth:t=6,lineStyle:e,lineColor:i="red"}=this._options,n={"line-color":i,"line-width":t,"line-style":e};n["line-distance"]=this._data&&this._data[0].distance,this._roadLayer?this._roadLayer.update(this._geojson,n):this._roadLayer=new Su(this._geojson,n,this._userViewer)}requestPlanData(t){return new Promise((e,i)=>{const{ferry:n,encryption:r,alternativeRoute:o,solutionMarker:s,policy:a}=this._options,{startPoint:A,endPoint:l,wayPoints:c,avoidPolygons:u}=this._planOptions,{extraParams:h,timeStamp:p}=t,d=this.getRouteDetailParam(),f=c.map(t=>t.join(",")).join(";"),g=this.polygonToString(u),m=Object.assign(Object.assign({},h),{startPoint:A,endPoint:l,waypoints:f,avoidArea:g,ferry:n,encryption:r,routeDetail:d,alternativeRoute:(!c||!c.length)&&o});"leastTime"!==a&&"leastDistance"!==a&&delete m.avoidArea,this.getDrivingRouteData(m).then(t=>{this.dealRequestData(t),e(p)}).catch(t=>{i({error:t,timeStamp:p})})})}dealRequestData(t){this._data=t.paths,this._geojson=this.parseRouteData(t)}parseRouteData(t){let e;try{const{paths:i}=t;i.forEach((t,e)=>{t.points_encoded&&(i[e]=Object.assign(Object.assign({},i[e]),{points:tt(t.points,!1)}))}),e=i.some(t=>!t.points.coordinates.length)}catch(t){e=!0}if(!e){const{paths:e}=t,i=this.createGeoJson();return e.forEach((t,e)=>{const n=0===e;i.features.unshift({type:"Feature",properties:{time:Math.round(t.time/6e4),mainRoute:n,alternativeRoute:!n,index:e},geometry:t.points})}),i.features.forEach((t,e)=>{t.properties.solutionIndex=i.features.length-e}),i}console.error("请求缺少必要信息，解析出错")}polygonToString(t){if(!t||t&&!t.length)return"";if(Array.isArray(t[0][0])&&!Array.isArray(t[0][0][0])){let e="";return t.forEach(t=>{let i="";t.forEach(t=>{i+=t.toString()+";"}),i=i.substring(0,i.length-1),e+=i+"|",i=""}),e.substring(0,e.length-1)}if(Array.isArray(t[0])&&!Array.isArray(t[0][0])){let e="";return t.forEach(t=>{e+=t.toString()+";"}),e.substring(0,e.length-1)}}getDrivingRouteData(t){return new Promise((e,i)=>{const{startPoint:n,endPoint:r,waypoints:o,avoidArea:s,strategy:a,ferry:A,encryption:l,routeDetail:c,alternativeRoute:u}=t,h={sPoint:n,ePoint:r,strategy:a,ferry:A?0:1,alternativeRoute:u?1:0,pointsEncoded:l};o&&(h.wayPoints=o),s&&(h.avoidArea=s),c&&(h.showFields=c.join(","));const p={body:h,url:ht(this._mapConfig).DRIVING_ROUTE};mt.post(p,this._mapConfig).then(t=>{"200"===t.code?e(t.result.kdResource):i("获取信息时出现异常")}).catch(t=>{i(t)})})}getRouteDetailParam(){let t;const{routeDetail:e}=this._options;if(e&&e.length){const i=[];e.includes("streetName")&&i.push("street_name"),e.includes("maxSpeed")&&i.push("max_speed"),i.length&&(t=i)}return t}createGeoJson(t){const e={type:"FeatureCollection",features:[]};return t&&(e.features=t),e}getPolicyParams(){const{policy:t}=this._options,e={};switch(t){case"leastDistance":e.strategy=32;break;case"avoidHighWay":e.strategy=35;break;case"avoidFastWay":e.strategy=36;break;case"roadFirst":e.strategy=37;break;default:e.strategy=38}return e}getPointsAndAreas(){return{startPoint:this._planOptions.startPoint.slice(),endPoint:this._planOptions.endPoint.slice(),wayPoints:this._planOptions.wayPoints.slice(),avoidPolygons:this._planOptions.avoidPolygons.slice()}}}var Fu=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},Ou=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let Pu=class{constructor(t){t.czml&&(t.czmlCfg=t.czml),this._instance=new du(t)}addToViewer(t){this._instance.addToViewer(t)}remove(t={}){this._instance.remove(t)}on(t){t.event=gr[t.event],this._instance.on(t)}off(t){t.event=gr[t.event],this._instance.off(t)}play(){this._instance.play()}pause(){this._instance.pause()}followPerspective(){this._instance.followPerspective()}removeFollowPerspective(){this._instance.removeFollowPerspective()}show(){this._instance.setVisible(!0)}hide(){this._instance.setVisible(!1)}};Fu([R(is.addToViewer),Ou("design:type",Function),Ou("design:paramtypes",[Object]),Ou("design:returntype",void 0)],Pu.prototype,"addToViewer",null),Fu([R(is.remove),Ou("design:type",Function),Ou("design:paramtypes",[Object]),Ou("design:returntype",void 0)],Pu.prototype,"remove",null),Fu([R(is.on),Ou("design:type",Function),Ou("design:paramtypes",[Object]),Ou("design:returntype",void 0)],Pu.prototype,"on",null),Fu([R(is.off),Ou("design:type",Function),Ou("design:paramtypes",[Object]),Ou("design:returntype",void 0)],Pu.prototype,"off",null),Pu=Fu([H({viewer:{type:k.Object,required:!0},serviceName:{type:k.String,required:!0},gbid:{type:k.String,required:!0},startTime:{type:k.String,required:!0},endTime:{type:k.String,required:!0},czmlCfg:{type:[k.Object,k.String],children:{model:{type:k.Object,children:{id:{type:[k.Number,k.String]},scale:{type:k.Number},outline:{type:k.Object}}},path:{type:k.Object,children:{show:{type:k.Boolean},width:{type:k.Number},color:{type:k.Array}}},label:{type:k.Object,children:{show:{type:k.Boolean},text:{type:k.String},color:{type:k.Array}}}}},popup:{type:k.Object},theme:{type:k.String}}),Ou("design:paramtypes",[Object])],Pu);var Tu=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},Lu=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let Mu=class{constructor(t){t.czml&&(t.czmlCfg=t.czml),this._instance=new gu(t)}addToViewer(t){this._instance.addToViewer(t)}remove(t={}){this._instance.remove(t)}on(t){t.event=gr[t.event],this._instance.on(t)}off(t){t.event=gr[t.event],this._instance.off(t)}play(){this._instance.play()}pause(){this._instance.pause()}show(){this._instance.setVisible(!0)}hide(){this._instance.setVisible(!1)}followPerspective(){this._instance.followPerspective()}removeFollowPerspective(){this._instance.removeFollowPerspective()}setMultiple(t){this._instance.setMultiple(t)}};Tu([R(is.addToViewer),Lu("design:type",Function),Lu("design:paramtypes",[Object]),Lu("design:returntype",void 0)],Mu.prototype,"addToViewer",null),Tu([R(is.remove),Lu("design:type",Function),Lu("design:paramtypes",[Object]),Lu("design:returntype",void 0)],Mu.prototype,"remove",null),Tu([R(is.on),Lu("design:type",Function),Lu("design:paramtypes",[Object]),Lu("design:returntype",void 0)],Mu.prototype,"on",null),Tu([R(is.off),Lu("design:type",Function),Lu("design:paramtypes",[Object]),Lu("design:returntype",void 0)],Mu.prototype,"off",null),Tu([N([{type:k.Number,required:!0}]),Lu("design:type",Function),Lu("design:paramtypes",[Number]),Lu("design:returntype",void 0)],Mu.prototype,"setMultiple",null),Mu=Tu([H({viewer:{type:k.Object,required:!0},points:{type:k.Array,required:!0,validator:function(t){return t.length>1},message:"points length >=2"},isPlan:{type:k.Boolean},duration:{type:k.Number},czmlCfg:{type:[k.Object,k.String],children:{model:{type:k.Object,children:{id:{type:[k.Number,k.String]},scale:{type:k.Number},outline:{type:k.Object}}},path:{type:k.Object,children:{show:{type:k.Boolean},width:{type:k.Number},color:{type:k.Array}}},label:{type:k.Object,children:{show:{type:k.Boolean},text:{type:k.String},color:{type:k.Array}}},cylinder:{type:k.Object,children:{show:{type:k.Boolean},bottomRadius:{type:k.Number},length:{type:k.Number},color:{type:k.Array}}}}},popup:{type:k.Object}}),Lu("design:paramtypes",[Object])],Mu);var Uu=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},Du=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let Qu=class{constructor(t){t.czml&&(t.czmlCfg=t.czml),this._instance=new wu(t)}addToViewer(t){this._instance.addToViewer(t)}remove(t={}){this._instance.remove(t)}followPerspective(){this._instance.followPerspective()}removeFollowPerspective(){this._instance.removeFollowPerspective()}on(t){t.event=gr[t.event],this._instance.on(t)}off(t){t.event=gr[t.event],this._instance.off(t)}show(){this._instance.setVisible(!0)}hide(){this._instance.setVisible(!1)}};Uu([R(is.addToViewer),Du("design:type",Function),Du("design:paramtypes",[Object]),Du("design:returntype",void 0)],Qu.prototype,"addToViewer",null),Uu([R(is.remove),Du("design:type",Function),Du("design:paramtypes",[Object]),Du("design:returntype",void 0)],Qu.prototype,"remove",null),Uu([R(is.on),Du("design:type",Function),Du("design:paramtypes",[Object]),Du("design:returntype",void 0)],Qu.prototype,"on",null),Uu([R(is.off),Du("design:type",Function),Du("design:paramtypes",[Object]),Du("design:returntype",void 0)],Qu.prototype,"off",null),Qu=Uu([H({viewer:{type:k.Object,required:!0},gbid:{type:k.String,required:!0},czmlCfg:{type:[k.Object,k.String],children:{model:{type:k.Object,children:{id:{type:[k.Number,k.String]},scale:{type:k.Number},outline:{type:k.Object}}},path:{type:k.Object,children:{show:{type:k.Boolean},width:{type:k.Number},color:{type:k.Array}}},label:{type:k.Object,children:{show:{type:k.Boolean},text:{type:k.String},color:{type:k.Array}}},cylinder:{type:k.Object,children:{show:{type:k.Boolean},bottomRadius:{type:k.Number},length:{type:k.Number},color:{type:k.Array}}}}},popup:{type:k.Object}}),Du("design:paramtypes",[Object])],Qu);var Ru=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},Nu=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let Hu=class{constructor(t){this._instance=new Bu(t)}addToViewer(t){this._instance.addToViewer(t)}remove(t={}){this._instance.remove(t)}setAttentions(t){this._instance.setAttentions(t)}showAttentions(t){this._instance.showAttentions(t)}showAll(t){this._instance.showAll(t)}setPerspective(t){this._instance.setPerspective(t)}followPerspective(t){this._instance.followPerspective(t)}removeFollowPerspective(t){this._instance.removeFollowPerspective(t)}addPopup(t){this._instance.addPopup(t)}removePopup(t){this._instance.removePopup(t)}clearAllPopup(t){this._instance.clearAllPopup(t)}setIcons(t){this._instance.setIcons(t)}on(t){this._instance.on(t)}off(t){this._instance.off(t)}};Ru([R(is.addToViewer),Nu("design:type",Function),Nu("design:paramtypes",[Object]),Nu("design:returntype",void 0)],Hu.prototype,"addToViewer",null),Ru([R(is.remove),Nu("design:type",Function),Nu("design:paramtypes",[Object]),Nu("design:returntype",void 0)],Hu.prototype,"remove",null),Ru([R({attentions:{type:k.Array},ended:{type:k.Function}}),Nu("design:type",Function),Nu("design:paramtypes",[Object]),Nu("design:returntype",void 0)],Hu.prototype,"setAttentions",null),Ru([R({ended:{type:k.Function}}),Nu("design:type",Function),Nu("design:paramtypes",[Object]),Nu("design:returntype",void 0)],Hu.prototype,"showAttentions",null),Ru([R({ended:{type:k.Function}}),Nu("design:type",Function),Nu("design:paramtypes",[Object]),Nu("design:returntype",void 0)],Hu.prototype,"showAll",null),Ru([R({vehPlate:{type:k.String},ended:{type:k.Function}}),Nu("design:type",Function),Nu("design:paramtypes",[Object]),Nu("design:returntype",void 0)],Hu.prototype,"setPerspective",null),Ru([R({vehPlate:{type:k.String},ended:{type:k.Function}}),Nu("design:type",Function),Nu("design:paramtypes",[Object]),Nu("design:returntype",void 0)],Hu.prototype,"followPerspective",null),Ru([R({ended:{type:k.Function}}),Nu("design:type",Function),Nu("design:paramtypes",[Object]),Nu("design:returntype",void 0)],Hu.prototype,"removeFollowPerspective",null),Ru([R({vehPlate:{type:k.String,validator:function(t){return""!==t}},popup:{type:k.Object},ended:{type:k.Function}}),Nu("design:type",Function),Nu("design:paramtypes",[Object]),Nu("design:returntype",void 0)],Hu.prototype,"addPopup",null),Ru([R({vehPlate:{type:k.String},ended:{type:k.Function}}),Nu("design:type",Function),Nu("design:paramtypes",[Object]),Nu("design:returntype",void 0)],Hu.prototype,"removePopup",null),Ru([R({ended:{type:k.Function}}),Nu("design:type",Function),Nu("design:paramtypes",[Object]),Nu("design:returntype",void 0)],Hu.prototype,"clearAllPopup",null),Ru([R({icons:{type:k.Array},ended:{type:k.Function}}),Nu("design:type",Function),Nu("design:paramtypes",[Object]),Nu("design:returntype",void 0)],Hu.prototype,"setIcons",null),Ru([R(is.on),Nu("design:type",Function),Nu("design:paramtypes",[Object]),Nu("design:returntype",void 0)],Hu.prototype,"on",null),Ru([R(is.off),Nu("design:type",Function),Nu("design:paramtypes",[Object]),Nu("design:returntype",void 0)],Hu.prototype,"off",null),Hu=Ru([H(),Nu("design:paramtypes",[Object])],Hu);var ku=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},Vu=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let ju=class{constructor(t){this._instance=new Eu(t)}addToViewer(t){this._instance.addToViewer(t)}remove(t={}){this._instance.remove(t)}updateGbids(t){this._instance.updateGbids(t)}};ku([R(is.addToViewer),Vu("design:type",Function),Vu("design:paramtypes",[Object]),Vu("design:returntype",void 0)],ju.prototype,"addToViewer",null),ku([R(is.remove),Vu("design:type",Function),Vu("design:paramtypes",[Object]),Vu("design:returntype",void 0)],ju.prototype,"remove",null),ku([R({gbids:{type:k.Array},ended:{type:k.Function}}),Vu("design:type",Function),Vu("design:paramtypes",[Object]),Vu("design:returntype",void 0)],ju.prototype,"updateGbids",null),ju=ku([H({viewer:{type:k.Object,required:!0},gbids:{type:k.Array,required:!0},vehPlate:{type:k.String,required:!0}}),Vu("design:paramtypes",[Object])],ju);var Gu=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},Ku=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let zu=class{constructor(t){this._instance=new Iu(t)}addToViewer(t){this._instance.addToViewer(t)}remove(t={}){this._instance.remove(t)}search(t,e,i){this._instance.search(t,e,i)}setWayPoints(t){this._instance.setWayPoints(t)}setAvoidPolygons(t){this._instance.setAvoidPolygons(t)}getWayPoints(){return this._instance.getWayPoints()}getAvoidPolygons(){return this._instance.getAvoidPolygons()}on(t){t.event=gr[t.event],this._instance.on(t)}off(t){t.event=gr[t.event],this._instance.off(t)}showRoute(){this._instance.setRouteVisible(!0)}hideRoute(){this._instance.setRouteVisible(!1)}showMarker(){this._instance.setMarkerVisible(!0)}hideMarker(){this._instance.setMarkerVisible(!1)}};Gu([R(is.addToViewer),Ku("design:type",Function),Ku("design:paramtypes",[Object]),Ku("design:returntype",void 0)],zu.prototype,"addToViewer",null),Gu([R(is.remove),Ku("design:type",Function),Ku("design:paramtypes",[Object]),Ku("design:returntype",void 0)],zu.prototype,"remove",null),Gu([N([{type:k.Array},{type:k.Array},{type:k.Array,validator:function(t){return void 0===t[0]||t[0]&&Array.isArray(t[0])},message:"incorrect format of wayPoints!"}]),Ku("design:type",Function),Ku("design:paramtypes",[Array,Array,Array]),Ku("design:returntype",void 0)],zu.prototype,"search",null),Gu([N([{type:k.Array,required:!0,validator:function(t){return void 0===t[0]||t[0]&&Array.isArray(t[0])},message:"incorrect format of wayPoints!"}]),Ku("design:type",Function),Ku("design:paramtypes",[Array]),Ku("design:returntype",void 0)],zu.prototype,"setWayPoints",null),Gu([N([{type:k.Array,required:!0}]),Ku("design:type",Function),Ku("design:paramtypes",[Array]),Ku("design:returntype",void 0)],zu.prototype,"setAvoidPolygons",null),Gu([R(is.on),Ku("design:type",Function),Ku("design:paramtypes",[Object]),Ku("design:returntype",void 0)],zu.prototype,"on",null),Gu([R(is.off),Ku("design:type",Function),Ku("design:paramtypes",[Object]),Ku("design:returntype",void 0)],zu.prototype,"off",null),zu=Gu([H({viewer:{type:k.Object,required:!0},alternativeRoute:{type:k.Boolean},routeDetail:{type:k.Array,validator:t=>0===t.length||(1===t.length?"streetName"===t[0]||"maxSpeed"===t[0]:2===t.length&&("streetName"===t[0]&&"maxSpeed"===t[1]||"maxSpeed"===t[0]&&"streetName"===t[1]))},markerVisible:{type:k.Boolean},routeVisible:{type:k.Boolean},policy:{type:k.String,validator:t=>["leastTime","leastDistance","avoidHighWay","avoidFastWay","roadFirst"].indexOf(t)>-1},ferry:{type:k.Boolean},lineColor:{type:k.String},lineWidth:{type:k.Number},updateHandler:{type:k.Function}}),Ku("design:paramtypes",[Object])],zu);class Wu{constructor(t){this.options={},this.mode="translate",this._isDynamicLength=!1;const{viewer:e}=t;this.userViewer=e,this.options=t,this.mode=this.options.mode||"translate",this._length=this.options.length||0,this._isDynamicLength=!this.options.length,this.primitiveCollection=new f.PrimitiveCollection,this.viewer.scene.primitives.add(this.primitiveCollection),this.userViewer.viewer.transformControl=this}get viewer(){return this.userViewer.viewer.instance}attach(t){var e,i,n;t.getInstance()instanceof Nr?console.error("Invalid Model Type"):(this._isDynamicLength&&(null===(n=null===(i=null===(e=null==t?void 0:t._modelInstance)||void 0===e?void 0:e.modelInstance)||void 0===i?void 0:i.boundingSphere)||void 0===n?void 0:n.radius)&&(this._length=2*Math.ceil(t._modelInstance.modelInstance.boundingSphere.radius)),this.detach(),this.model=t.getInstance(),this.model._attachControl=this,this.originScale=this.model._transformParams.scale,this.primitiveCollection.length?this.update():this.init(this.model.getPositionMatrix()),this.setVisible())}detach(){this.model&&(this.model._attachControl=null,this.model=null,this.hideAll())}setMode(t){this.model&&(this.mode=t,this.update(),this.setVisible())}init(t){this.addAxes(t),this.bindEvent()}update(){const t=this.model.getPositionMatrix(),e=this.calAxesMatrix(t),i=this.calPlaneMatrix(t,"xy"),n=this.calPlaneMatrix(t,"yz"),r=this.calPlaneMatrix(t,"zx"),o=this.calRotationMatrix(t,"x"),s=this.calRotationMatrix(t,"y"),a=this.calRotationMatrix(t,"z");this.primitiveCollection.get(0).modelMatrix=this.primitiveCollection.get(1).modelMatrix=this.primitiveCollection.get(2).modelMatrix=this.primitiveCollection.get(9).modelMatrix=e,this.primitiveCollection.get(3).modelMatrix=i,this.primitiveCollection.get(4).modelMatrix=n,this.primitiveCollection.get(5).modelMatrix=r,this.primitiveCollection.get(6).modelMatrix=o,this.primitiveCollection.get(7).modelMatrix=s,this.primitiveCollection.get(8).modelMatrix=a}addAxes(t){const e=this.calAxesMatrix(t),i=new f.Primitive({geometryInstances:this.generateGeometry("polyline","axes-x"),appearance:this.generateAppearance("polyline","#f00"),modelMatrix:e}),n=new f.Primitive({geometryInstances:this.generateGeometry("polyline","axes-y"),appearance:this.generateAppearance("polyline","#0f0"),modelMatrix:e}),r=new f.Primitive({geometryInstances:this.generateGeometry("polyline","axes-z"),appearance:this.generateAppearance("polyline","#00f"),modelMatrix:e}),o=new f.Primitive({geometryInstances:this.generateGeometry("plane","plane-xy"),appearance:this.generateAppearance("plane","#00f"),modelMatrix:this.calPlaneMatrix(t,"xy")}),s=new f.Primitive({geometryInstances:this.generateGeometry("plane","plane-yz"),appearance:this.generateAppearance("plane","#f00"),modelMatrix:this.calPlaneMatrix(t,"yz")}),a=new f.Primitive({geometryInstances:this.generateGeometry("plane","plane-zx"),appearance:this.generateAppearance("plane","#0f0"),modelMatrix:this.calPlaneMatrix(t,"zx")}),A=new f.Primitive({geometryInstances:this.generateGeometry("rotation","rotation-rx"),appearance:this.generateAppearance("rotation","#f00"),modelMatrix:this.calRotationMatrix(t,"x")}),l=new f.Primitive({geometryInstances:this.generateGeometry("rotation","rotation-ry"),appearance:this.generateAppearance("rotation","#0f0"),modelMatrix:this.calRotationMatrix(t,"y")}),c=new f.Primitive({geometryInstances:this.generateGeometry("rotation","rotation-rz"),appearance:this.generateAppearance("rotation","#00f"),modelMatrix:this.calRotationMatrix(t,"z")}),u=new f.Primitive({geometryInstances:this.generateGeometry("polyline","scale-sx"),appearance:this.generateAppearance("polyline","#f00"),modelMatrix:e});this.primitiveCollection.add(i,0),this.primitiveCollection.add(n,1),this.primitiveCollection.add(r,2),this.primitiveCollection.add(o,3),this.primitiveCollection.add(s,4),this.primitiveCollection.add(a,5),this.primitiveCollection.add(A,6),this.primitiveCollection.add(l,7),this.primitiveCollection.add(c,8),this.primitiveCollection.add(u,9)}bindEvent(){const{updateHandler:t}=this.options,e=this.viewer.scene;this._eventHanlder=new f.ScreenSpaceEventHandler(e.canvas);let i,n,r=new f.Matrix4,o=!1,s="",a={xy:null,yz:null,zx:null};this._eventHanlder.setInputAction(A=>{let l=e.pick(A.position);if(l&&l.id&&"string"==typeof l.id&&(l.id.startsWith("axes")||l.id.startsWith("plane")||l.id.startsWith("rotation")||l.id.startsWith("scale"))&&!o){e.screenSpaceCameraController.enableRotate=!1,e.screenSpaceCameraController.enableTranslate=!1,o=!0,s=l.id.split("-")[1],r=f.Matrix4.clone(this.model.getPositionMatrix(),new f.Matrix4);const c=this.viewer.scene.camera.getPickRay(A.position,new f.Ray);a=this.generatePlane(r);const u=f.IntersectionTests.rayPlane(c,this.getTargetPlane(s,a));"translate"===this.mode&&(n=this.generateRealPlane(u)),i=f.Matrix4.multiplyByPoint(f.Matrix4.inverse(r,new f.Matrix4),u,new f.Cartesian3),this.startCoordinate=this.model.getProps().position,t&&t(this.startCoordinate)}},f.ScreenSpaceEventType.LEFT_DOWN),this._eventHanlder.setInputAction(i=>{if(o){o=!1,r=new f.Matrix4,e.screenSpaceCameraController.enableRotate=!0,e.screenSpaceCameraController.enableTranslate=!0;const i=this.model.getProps().position;return this.model._transformParams&&(this.originScale=this.model._transformParams.scale),void(t&&t(i))}},f.ScreenSpaceEventType.LEFT_UP),this._eventHanlder.setInputAction(t=>{if(!t.endPosition)return void this.clearColor();var e=this.viewer.scene.pick(t.endPosition);e||this.clearColor();const A=e&&e.primitive;if(A&&A._instanceIds&&"string"==typeof A._instanceIds[0]&&(A._instanceIds[0].startsWith("axes")||A._instanceIds[0].startsWith("plane")||A._instanceIds[0].startsWith("rotation")||A._instanceIds[0].startsWith("scale"))){this.clearColor();const t=A._instanceIds[0].split("-")[1];(!o||o&&t===s)&&this.setAxesColor(t)}else this.clearColor();if(!o)return;this.setAxesColor(s);const l=this.viewer.scene.camera.getPickRay(t.endPosition,new f.Ray),c=f.IntersectionTests.rayPlane(l,"z"===s?n:this.getTargetPlane(s,a));if(!c)return;const u=f.Matrix4.multiplyByPoint(f.Matrix4.inverse(r,new f.Matrix4),c,new f.Cartesian3),h=f.Cartesian3.subtract(u,i,new f.Cartesian3);"translate"===this.mode?this.updateModel([h.x,h.y,h.z],s):"rotate"===this.mode?this.updateModel([i,u],s):"scale"===this.mode&&this.updateModel([h.x],s),this.update()},f.ScreenSpaceEventType.MOUSE_MOVE)}updateModel(t,e){const i=["x","y","z","xy","yz","zx"].includes(e),n=["rx","ry","rz"].includes(e),r=["sx"].includes(e);if(i){const i=this.startCoordinate,n=[i.lng,i.lat],r=t[0],o=t[1],s=t[2],a=Math.abs(r),A=Math.abs(o),l=new f.Cartesian2(0,0),c=new f.Cartesian2(0,1);let u=[],h=i;if("x"===e){const t=r>0?90:270;u=Wn.getPointByRhumbLine({point:n,distance:a,bearing:t,units:"meters"}),h=new I(u[0],i.lat,i.alt,i.heading,i.pitch,i.roll)}else if("y"===e){const t=o>0?0:180;u=Wn.getPointByRhumbLine({point:n,distance:A,bearing:t,units:"meters"}),h=new I(i.lng,u[1],i.alt,i.heading,i.pitch,i.roll)}else if("z"===e)h=new I(i.lng,i.lat,i.alt+s,i.heading,i.pitch,i.roll);else if("xy"===e){const e=new f.Cartesian2(t[0],t[1]),o=f.Math.toDegrees(f.Cartesian2.angleBetween(c,e)),s=f.Cartesian2.distance(l,e),a=r>0?o:360-o;u=Wn.getPointByRhumbLine({point:n,distance:s,bearing:a,units:"meters"}),h=new I(u[0],u[1],i.alt,i.heading,i.pitch,i.roll)}else if("yz"===e){const t=o>0?0:180;u=Wn.getPointByRhumbLine({point:n,distance:A,bearing:t,units:"meters"}),h=new I(i.lng,u[1],i.alt+s,i.heading,i.pitch,i.roll)}else if("zx"===e){const t=r>0?90:270;u=Wn.getPointByRhumbLine({point:n,distance:a,bearing:t,units:"meters"}),h=new I(u[0],i.lat,i.alt+s,i.heading,i.pitch,i.roll)}this.model.setPosition(h)}else if(n){const i=t[0],n=t[1];let r=this.startCoordinate;if("rx"===e){const t=this.startCoordinate.heading,e=f.Cartesian2.normalize(new f.Cartesian2(i.x,i.y),new f.Cartesian2),o=f.Cartesian2.normalize(new f.Cartesian2(n.x,n.y),new f.Cartesian2);let s=f.Math.toDegrees(f.Cartesian2.angleBetween(e,o));f.Cartesian2.cross(e,o)<0&&(s=-1*s+360),r=new I(r.lng,r.lat,r.alt,(t+s)%360,r.pitch,r.roll)}else if("ry"===e){const t=this.startCoordinate.pitch,e=f.Cartesian2.normalize(new f.Cartesian2(i.y,i.z),new f.Cartesian2),o=f.Cartesian2.normalize(new f.Cartesian2(n.y,n.z),new f.Cartesian2);let s=f.Math.toDegrees(f.Cartesian2.angleBetween(e,o));f.Cartesian2.cross(e,o)<0&&(s=-1*s+360),r=new I(r.lng,r.lat,r.alt,r.heading,(t+s)%360,r.roll)}else if("rz"===e){const t=this.startCoordinate.roll,e=f.Cartesian2.normalize(new f.Cartesian2(i.x,i.z),new f.Cartesian2),o=f.Cartesian2.normalize(new f.Cartesian2(n.x,n.z),new f.Cartesian2);let s=f.Math.toDegrees(f.Cartesian2.angleBetween(e,o));f.Cartesian2.cross(e,o)>0&&(s=-1*s+360),r=new I(r.lng,r.lat,r.alt,r.heading,r.pitch,(t+s)%360)}this.model.setPosition(r)}else if(r){const e=this.model.getPosition(),i=this.viewer.camera.positionWC,n=f.Cartesian3.distance(e,i),r=t[0]/n*50,[o,s,a]=this.originScale,A=[o+r,s+r,a+r];this.model.scale(A)}}destroy(t={}){const{ended:e}=t;this.detach(),this.primitiveCollection.removeAll(),this._eventHanlder.destroy(),at(!0,e)}calAxesMatrix(t){return f.Matrix4.multiplyByUniformScale(t,this._length,new f.Matrix4)}calPlaneMatrix(t,e){const i=Math.ceil(this._length/5),n=f.Matrix4.clone(t);if("xy"===e){const t=f.Matrix4.fromTranslation(f.Cartesian3.fromArray([i,i,0]));f.Matrix4.multiply(n,t,n);const e=f.Matrix4.fromScale(new f.Cartesian3(i,i,i));f.Matrix4.multiply(n,e,n)}else if("yz"===e){const t=f.Matrix4.fromTranslation(f.Cartesian3.fromArray([0,i,i]));f.Matrix4.multiply(n,t,n);const e=f.Matrix4.fromScale(new f.Cartesian3(i,i,i));f.Matrix4.multiply(n,e,n);const r=f.Matrix3.fromRotationY(f.Math.PI_OVER_TWO),o=f.Matrix4.fromRotationTranslation(r);f.Matrix4.multiply(n,o,n)}else if("zx"===e){const t=f.Matrix4.fromTranslation(f.Cartesian3.fromArray([i,0,i]));f.Matrix4.multiply(n,t,n);const e=f.Matrix4.fromScale(new f.Cartesian3(i,i,i));f.Matrix4.multiply(n,e,n);const r=f.Matrix3.fromRotationX(f.Math.PI_OVER_TWO),o=f.Matrix4.fromRotationTranslation(r);f.Matrix4.multiply(n,o,n)}return n}calRotationMatrix(t,e){const i=f.Matrix4.clone(t);if("y"===e){const t=f.Matrix3.fromRotationY(f.Math.PI_OVER_TWO),e=f.Matrix4.fromRotationTranslation(t),n=f.Matrix4.multiply(i,e,new f.Matrix4);return f.Matrix4.multiplyByUniformScale(n,this._length,new f.Matrix4)}if("z"===e){const t=f.Matrix3.fromRotationX(f.Math.PI_OVER_TWO),e=f.Matrix4.fromRotationTranslation(t),n=f.Matrix4.multiply(i,e,new f.Matrix4);return f.Matrix4.multiplyByUniformScale(n,this._length,new f.Matrix4)}return f.Matrix4.multiplyByUniformScale(i,this._length,new f.Matrix4)}clearColor(){this.primitiveCollection.length&&(this.primitiveCollection.get(0).appearance.material=f.Material.fromType("PolylineArrow",{color:f.Color.RED}),this.primitiveCollection.get(9).appearance.material=f.Material.fromType("PolylineArrow",{color:f.Color.RED}),this.primitiveCollection.get(1).appearance.material=f.Material.fromType("PolylineArrow",{color:f.Color.GREEN}),this.primitiveCollection.get(2).appearance.material=f.Material.fromType("PolylineArrow",{color:f.Color.BLUE}),this.primitiveCollection.get(3).appearance.material=this.primitiveCollection.get(8).appearance.material=f.Material.fromType("Color",{color:f.Color.BLUE}),this.primitiveCollection.get(4).appearance.material=this.primitiveCollection.get(6).appearance.material=f.Material.fromType("Color",{color:f.Color.RED}),this.primitiveCollection.get(5).appearance.material=this.primitiveCollection.get(7).appearance.material=f.Material.fromType("Color",{color:f.Color.GREEN}))}setAxesColor(t){let e,i;"x"===t?(e=0,i="polyline"):"y"===t?(e=1,i="polyline"):"z"===t?(e=2,i="polyline"):"xy"===t?(e=3,i="plane"):"yz"===t?(e=4,i="plane"):"zx"===t?(e=5,i="plane"):"rx"===t?(e=6,i="rotate"):"ry"===t?(e=7,i="rotate"):"rz"===t?(e=8,i="rotate"):"sx"===t&&(e=9,i="polyline"),this.primitiveCollection.get(e).appearance.material="polyline"===i?f.Material.fromType("PolylineArrow",{color:f.Color.YELLOW}):f.Material.fromType("Color",{color:f.Color.YELLOW})}generatePlane(t){const e=this.model.getPosition(),i=f.Matrix4.multiplyByPoint(t,new f.Cartesian3(1,0,0),new f.Cartesian3),n=f.Cartesian3.normalize(f.Cartesian3.subtract(i,e,new f.Cartesian3),new f.Cartesian3),r=f.Matrix4.multiplyByPoint(t,new f.Cartesian3(0,1,0),new f.Cartesian3),o=f.Cartesian3.normalize(f.Cartesian3.subtract(r,e,new f.Cartesian3),new f.Cartesian3),s=f.Matrix4.multiplyByPoint(t,new f.Cartesian3(0,0,1),new f.Cartesian3),a=f.Cartesian3.normalize(f.Cartesian3.subtract(s,e,new f.Cartesian3),new f.Cartesian3);return{xy:f.Plane.fromPointNormal(e,a),yz:f.Plane.fromPointNormal(e,n),zx:f.Plane.fromPointNormal(e,o)}}generateRealPlane(t){const e=this.viewer.camera.direction;return f.Plane.fromPointNormal(t,e)}getTargetPlane(t,e){return"x"===t||"y"===t||"xy"===t||"rx"===t||"sx"===t?e.xy:"z"===t||"zx"===t||"rz"===t?e.zx:"yz"===t||"ry"===t?e.yz:void 0}generateAppearance(t,e){return"polyline"===t?new f.PolylineMaterialAppearance({material:f.Material.fromType("PolylineArrow",{color:f.Color.fromCssColorString(e)}),renderState:{depthTest:{enabled:!1}}}):"plane"===t?new f.MaterialAppearance({material:f.Material.fromType("Color",{color:f.Color.fromCssColorString(e)}),renderState:{depthTest:{enabled:!1}}}):"rotation"===t?new f.PolylineMaterialAppearance({material:f.Material.fromType("Color",{color:f.Color.fromCssColorString(e)}),renderState:{depthTest:{enabled:!1}}}):void 0}generateGeometry(t,e){const{width:i=10}=this.options;if("polyline"===t){let t;return"axes-x"===e||"scale-sx"===e?t=[f.Cartesian3.ZERO,f.Cartesian3.UNIT_X]:"axes-y"===e?t=[f.Cartesian3.ZERO,new f.Cartesian3(.001,1,0)]:"axes-z"===e&&(t=[f.Cartesian3.ZERO,f.Cartesian3.UNIT_Z]),new f.GeometryInstance({geometry:new f.PolylineGeometry({positions:t,width:2*i,arcType:f.ArcType.NONE}),id:e})}if("plane"===t)return new f.GeometryInstance({geometry:new f.PlaneGeometry,id:e});if("rotation"===t){const t=[];for(let e=1;e<=361;e++)t.push(new f.Cartesian3(Math.cos(f.Math.toRadians(e)),Math.sin(f.Math.toRadians(e))));return t.push(t[t.length-1]),new f.GeometryInstance({geometry:new f.PolylineGeometry({positions:t,width:i,vertexFormat:f.PolylineMaterialAppearance.VERTEX_FORMAT}),id:e})}}setVisible(){const{showPlane:t=!0}=this.options;for(let t=0;t<this.primitiveCollection.length;t++)this.primitiveCollection.get(t).show=!0;if(Object(f.defined)(t)&&!1===t||"rotate"===this.mode||"scale"===this.mode)for(let t=3;t<6;t++)this.primitiveCollection.get(t).show=!1;if("translate"===this.mode){for(let t=6;t<9;t++)this.primitiveCollection.get(t).show=!1;this.primitiveCollection.get(9).show=!1}else if("rotate"===this.mode){for(let t=0;t<3;t++)this.primitiveCollection.get(t).show=!1;this.primitiveCollection.get(9).show=!1}else if("scale"===this.mode){for(let t=0;t<3;t++)this.primitiveCollection.get(t).show=!1;for(let t=6;t<9;t++)this.primitiveCollection.get(t).show=!1}}hideAll(){for(let t=0;t<this.primitiveCollection.length;t++)this.primitiveCollection.get(t).show=!1}}class qu{constructor(t){this.options={},this.mode="rotate";const{viewer:e}=t;this.userViewer=e,this.options=t,this.billboardsCollection=new f.BillboardCollection,this.viewer.scene.primitives.add(this.billboardsCollection),this.mode=this.options.mode||"rotate",this.primitiveCollection=new f.PrimitiveCollection,this.viewer.scene.primitives.add(this.primitiveCollection),this.controlParams={scale:{width:16,height:16},rotate:{width:28,height:39}},this.userViewer.viewer.billboardControl=this,this.options.length||(this._moveEndFn=()=>{this._length=this.getMatchLength(),this.model&&this.update()},this.viewer.camera.moveEnd.addEventListener(this._moveEndFn))}get viewer(){return this.userViewer.viewer.instance}attach(t){this._length||(this._length=this.getMatchLength()),this.detach(),this.model=t.getInstance(),this.model._attachControl=this,this.billboardsCollection.length?this.update():this.init(this.model.getPositionMatrix()),this.setVisible()}detach(){this.model&&(this.model._attachControl=null,this.model=null,this.hideAll())}setMode(t){this.model&&(this.mode=t,this.update(),this.setVisible())}init(t){this.addControl(t),this.bindEvent()}update(){const t=this.model.getEntity();this.billboardsCollection.get(0).position=this.billboardsCollection.get(1).position=this.billboardsCollection.get(2).position=this.billboardsCollection.get(3).position=this.billboardsCollection.get(4).position=this.billboardsCollection.get(5).position=t.position.getValue(),this.reCal();const e=this.model.getPositionMatrix(),i=this.calAxesMatrix(e);this.primitiveCollection.get(0).modelMatrix=this.primitiveCollection.get(1).modelMatrix=this.primitiveCollection.get(2).modelMatrix=i}addControl(t){const e=this.model.getEntity(),i=e.billboard,n=e.position.getValue(),r=i.width.getValue(),o=i.height.getValue(),s=this.controlParams.scale.width,a=this.controlParams.scale.height,A=r/2,l=o/2,c=this.controlParams.rotate.width,u=this.controlParams.rotate.height,h=this.userViewer.viewer.mapConfig.distUrl+"Imgs/scale.png",p=this.userViewer.viewer.mapConfig.distUrl+"Imgs/rotate.png",d=this.userViewer.viewer.mapConfig.distUrl+"Imgs/border.png",g=this.getOffsetByVertical(i.verticalOrigin,l);this.billboardsCollection.add({id:"bscale-tl",position:n,image:h,width:s,height:a,pixelOffset:new f.Cartesian2(-A,-l+g)}),this.billboardsCollection.add({id:"bscale-tr",position:n,image:h,width:s,height:a,pixelOffset:new f.Cartesian2(A,-l+g)}),this.billboardsCollection.add({id:"bscale-br",position:n,image:h,width:s,height:a,pixelOffset:new f.Cartesian2(A,l+g)}),this.billboardsCollection.add({id:"bscale-bl",position:n,image:h,width:s,height:a,pixelOffset:new f.Cartesian2(-A,l+g)}),this.billboardsCollection.add({id:"brotate",position:n,image:p,width:c,height:u,pixelOffset:new f.Cartesian2(0,-l-u/2+g)}),this.billboardsCollection.add({id:"bborder",position:n,image:d,width:r,height:o,pixelOffset:new f.Cartesian2(0,g)});const m=this.calAxesMatrix(t),y=new f.Primitive({geometryInstances:this.generateGeometry("baxes-x"),appearance:this.generateAppearance("#f00"),modelMatrix:m}),v=new f.Primitive({geometryInstances:this.generateGeometry("baxes-y"),appearance:this.generateAppearance("#0f0"),modelMatrix:m}),_=new f.Primitive({geometryInstances:this.generateGeometry("baxes-z"),appearance:this.generateAppearance("#00f"),modelMatrix:m});this.primitiveCollection.add(y,0),this.primitiveCollection.add(v,1),this.primitiveCollection.add(_,2)}bindEvent(){const{updateHandler:t}=this.options,e=this.viewer.scene;this._eventHanlder=new f.ScreenSpaceEventHandler(e.canvas);let i,n,r,o,s,a,A,l,c,u=!1,h=0,p=0;const d=this.controlParams.rotate.height;let g,m,y=new f.Matrix4,v="",_={xy:null,yz:null,zx:null};this._eventHanlder.setInputAction(w=>{const C=w.position,B=this.viewer.scene.pick(C);if(B&&B.id&&"string"==typeof B.id&&(B.id.startsWith("bscale-")||B.id.startsWith("brotate")||B.id.startsWith("baxes"))&&(A=B.id,e.screenSpaceCameraController.enableRotate=!1,e.screenSpaceCameraController.enableTranslate=!1,!u))if(u=!0,B.id.startsWith("baxes")){o="translate",v=B.id.split("-")[1],y=f.Matrix4.clone(this.model.getPositionMatrix(),new f.Matrix4);const e=this.viewer.scene.camera.getPickRay(w.position,new f.Ray);_=this.generatePlane(y);const i=f.IntersectionTests.rayPlane(e,this.getTargetPlane(v,_));m=this.generateRealPlane(i),g=f.Matrix4.multiplyByPoint(f.Matrix4.inverse(y,new f.Matrix4),i,new f.Cartesian3),this.startCoordinate=this.model.getProps().position,t&&t(this.startCoordinate)}else{s=this.model.getEntity(),a=s.billboard,this.hideAll(),i=C,h=a.width.getValue(),p=a.height.getValue();const e=h/2,A=p/2,u=this.getOffsetByVertical(a.verticalOrigin,A);B.id.startsWith("bscale-")?o="scale":B.id.startsWith("brotate")&&(o="rotate",n=Y.CartesianToWindowPosition(s.position.getValue(),this.userViewer),n.y+=u,r=f.Math.toDegrees(a.rotation||0),l=new f.Cartesian2(0,-A-d/2+u),c={tl:new f.Cartesian2(-e,-A+u),tr:new f.Cartesian2(e,-A+u),br:new f.Cartesian2(e,A+u),bl:new f.Cartesian2(-e,A+u)}),t&&t({width:a.width.getValue(),height:a.height.getValue(),rotation:f.Math.toDegrees(a.rotation||0)})}},f.ScreenSpaceEventType.LEFT_DOWN),this._eventHanlder.setInputAction(()=>{if(u){if(u=!1,this.viewer.scene.screenSpaceCameraController.enableRotate=!0,this.viewer.scene.screenSpaceCameraController.enableTranslate=!0,"translate"===o){y=new f.Matrix4;const e=this.model.getProps().position;t&&t(e)}else this.setVisible(),t&&t({width:a.width.getValue(),height:a.height.getValue(),rotation:f.Math.toDegrees(a.rotation||0)});o=null}},f.ScreenSpaceEventType.LEFT_UP),this._eventHanlder.setInputAction(t=>{if(u)if("scale"===o){const e=t.endPosition;if(!e)return;let n=[e.x-i.x,e.y-i.y];"bscale-tl"===A?n=[-1*n[0],-1*n[1]]:"bscale-tr"===A?n=[n[0],-1*n[1]]:"bscale-bl"===A&&(n=[-1*n[0],n[1]]);const r=(h+n[0])/h,o=(p+n[1])/p,s=Math.min(r,o);a.width=h*s,a.height=p*s,this.reCal()}else if("rotate"===o){const e=t.endPosition;if(!e)return;const o=[i.x-n.x,i.y-n.y],s=f.Cartesian2.normalize(new f.Cartesian2(o[0],o[1]),new f.Cartesian2),A=[e.x-n.x,e.y-n.y],l=f.Cartesian2.normalize(new f.Cartesian2(A[0],A[1]),new f.Cartesian2);let c=f.Math.toDegrees(f.Cartesian2.angleBetween(s,l));f.Cartesian2.cross(s,l)<0&&(c=-1*c+360),c=parseInt(r+(360-c))%360,a.rotation=f.Math.toRadians(c),this.reCal()}else if("translate"===o){if(!t.endPosition)return void this.clearColor();var e=this.viewer.scene.pick(t.endPosition);e||this.clearColor();const i=e&&e.primitive;if(i&&i._instanceIds&&"string"==typeof i._instanceIds[0]&&i._instanceIds[0].startsWith("baxes")){this.clearColor();const t=i._instanceIds[0].split("-")[1];(!u||u&&t===v)&&this.setAxesColor(t)}else this.clearColor();if(!u)return;this.setAxesColor(v);const n=this.viewer.scene.camera.getPickRay(t.endPosition,new f.Ray),r=f.IntersectionTests.rayPlane(n,"z"===v?m:this.getTargetPlane(v,_));if(!r)return;const o=f.Matrix4.multiplyByPoint(f.Matrix4.inverse(y,new f.Matrix4),r,new f.Cartesian3),s=f.Cartesian3.subtract(o,g,new f.Cartesian3);this.updateModel([s.x,s.y,s.z],v),this.update()}},f.ScreenSpaceEventType.MOUSE_MOVE)}destroy(t={}){const{ended:e}=t;this.detach(),this.billboardsCollection.removeAll(),this.primitiveCollection.removeAll(),this._eventHanlder.destroy(),this.viewer.camera.moveEnd.removeEventListener(this._moveEndFn),this._moveEndFn=null,at(!0,e)}setProperty(t){const{length:e}=t;this._length=e,this.update()}setVisible(){for(let t=0;t<this.billboardsCollection.length;t++)this.billboardsCollection.get(t).show=!0;for(let t=0;t<this.primitiveCollection.length;t++)this.primitiveCollection.get(t).show=!0;if("translate"===this.mode)for(let t=0;t<this.billboardsCollection.length;t++)this.billboardsCollection.get(t).show=!1;else if("rotate"===this.mode||"scale"===this.mode)for(let t=0;t<this.primitiveCollection.length;t++)this.primitiveCollection.get(t).show=!1}hideAll(){for(let t=0;t<this.billboardsCollection.length;t++)this.billboardsCollection.get(t).show=!1;for(let t=0;t<this.primitiveCollection.length;t++)this.primitiveCollection.get(t).show=!1}calLocation(t,e,i){const n=f.Math.toRadians(i),r=Math.sin(n),o=Math.cos(n),s=e[0],a=e[1],A=f.Matrix3.fromArray([o,r,0,-r,o,0,(1-o)*s+r*a,(1-o)*a-r*s,1]),l=new f.Cartesian3(t.x,t.y,1),c=f.Matrix3.multiplyByVector(A,l,new f.Cartesian3);return new f.Cartesian2(c.x,c.y)}reCal(){const t=this.model.getEntity().billboard,e=t.width,i=t.height,n=e/2,r=i/2,o=this.controlParams.rotate.height,s=this.getOffsetByVertical(t.verticalOrigin,r),a=new f.Cartesian2(0,-r-o/2+s),A=new f.Cartesian2(-n,-r+s),l=new f.Cartesian2(n,-r+s),c=new f.Cartesian2(n,r+s),u=new f.Cartesian2(-n,r+s),h=new f.Cartesian2(0,s),p=f.Math.toDegrees(t.rotation||0),d=[0,s],g=this.calLocation(a,d,360-p);this.billboardsCollection.get(4).pixelOffset=g,this.billboardsCollection.get(4).rotation=t.rotation||0;const m=this.calLocation(A,d,360-p),y=this.calLocation(l,d,360-p),v=this.calLocation(c,d,360-p),_=this.calLocation(u,d,360-p),w=this.calLocation(h,d,360-p);this.billboardsCollection.get(0).pixelOffset=m,this.billboardsCollection.get(0).rotation=t.rotation||0,this.billboardsCollection.get(1).pixelOffset=y,this.billboardsCollection.get(1).rotation=t.rotation||0,this.billboardsCollection.get(2).pixelOffset=v,this.billboardsCollection.get(2).rotation=t.rotation||0,this.billboardsCollection.get(3).pixelOffset=_,this.billboardsCollection.get(3).rotation=t.rotation||0,this.billboardsCollection.get(5).width=e,this.billboardsCollection.get(5).height=i,this.billboardsCollection.get(5).rotation=t.rotation||0,this.billboardsCollection.get(5).pixelOffset=w}calAxesMatrix(t){return f.Matrix4.multiplyByUniformScale(t,this._length,new f.Matrix4)}generateGeometry(t){const{width:e=10}=this.options;let i;return"baxes-x"===t?i=[f.Cartesian3.ZERO,f.Cartesian3.UNIT_X]:"baxes-y"===t?i=[f.Cartesian3.ZERO,new f.Cartesian3(.001,1,0)]:"baxes-z"===t&&(i=[f.Cartesian3.ZERO,f.Cartesian3.UNIT_Z]),new f.GeometryInstance({geometry:new f.PolylineGeometry({positions:i,width:2*e,arcType:f.ArcType.NONE}),id:t})}generateAppearance(t){return new f.PolylineMaterialAppearance({material:f.Material.fromType("PolylineArrow",{color:f.Color.fromCssColorString(t)}),renderState:{depthTest:{enabled:!1}}})}generatePlane(t){const e=this.model.getPosition(),i=f.Matrix4.multiplyByPoint(t,new f.Cartesian3(1,0,0),new f.Cartesian3),n=f.Cartesian3.normalize(f.Cartesian3.subtract(i,e,new f.Cartesian3),new f.Cartesian3),r=f.Matrix4.multiplyByPoint(t,new f.Cartesian3(0,1,0),new f.Cartesian3),o=f.Cartesian3.normalize(f.Cartesian3.subtract(r,e,new f.Cartesian3),new f.Cartesian3),s=f.Matrix4.multiplyByPoint(t,new f.Cartesian3(0,0,1),new f.Cartesian3),a=f.Cartesian3.normalize(f.Cartesian3.subtract(s,e,new f.Cartesian3),new f.Cartesian3);return{xy:f.Plane.fromPointNormal(e,a),yz:f.Plane.fromPointNormal(e,n),zx:f.Plane.fromPointNormal(e,o)}}getTargetPlane(t,e){return"x"===t||"y"===t?e.xy:"z"===t?e.zx:void 0}generateRealPlane(t){const e=this.viewer.camera.direction;return f.Plane.fromPointNormal(t,e)}clearColor(){this.primitiveCollection.length&&(this.primitiveCollection.get(0).appearance.material=f.Material.fromType("PolylineArrow",{color:f.Color.RED}),this.primitiveCollection.get(1).appearance.material=f.Material.fromType("PolylineArrow",{color:f.Color.GREEN}),this.primitiveCollection.get(2).appearance.material=f.Material.fromType("PolylineArrow",{color:f.Color.BLUE}))}setAxesColor(t){let e;"x"===t?e=0:"y"===t?e=1:"z"===t&&(e=2),this.primitiveCollection.get(e).appearance.material=f.Material.fromType("PolylineArrow",{color:f.Color.YELLOW})}updateModel(t,e){const i=this.startCoordinate,n=[i.lng,i.lat],r=t[0],o=t[1],s=t[2],a=Math.abs(r),A=Math.abs(o);let l=[],c=i;if("x"===e){const t=r>0?90:270;l=Wn.getPointByRhumbLine({point:n,distance:a,bearing:t,units:"meters"}),c=new I(l[0],i.lat,i.alt,i.heading,i.pitch,i.roll)}else if("y"===e){const t=o>0?0:180;l=Wn.getPointByRhumbLine({point:n,distance:A,bearing:t,units:"meters"}),c=new I(i.lng,l[1],i.alt,i.heading,i.pitch,i.roll)}else"z"===e&&(c=new I(i.lng,i.lat,i.alt+s,i.heading,i.pitch,i.roll));this.model.setPosition(c)}getOffsetByVertical(t,e){if(!t)return 0;let i=0;switch(t.getValue()){case-1:i=e;break;case 1:i=-e;break;default:i=0}return i}getMatchLength(){const t=this.userViewer.getZoom();return t?t<=6?3e4:7===t?2e4:8===t?12e3:9===t?8e3:10===t?5e3:11===t?3e3:12===t?1300:13===t?700:14===t?500:15===t?400:16===t?200:17===t?100:18===t?50:t>=19?10:void 0:100}}class Xu{constructor(t){this.options={};const{viewer:e}=t;this.userViewer=e,this.options=t,this.primitiveCollection=new f.PrimitiveCollection,this.viewer.scene.primitives.add(this.primitiveCollection),this.userViewer.viewer.translateControl=this}get viewer(){return this.userViewer.viewer.instance}attach(t){this.detach(),this.point=t,this.updatePosition=t,this.primitiveCollection.length?this.update():this.init(this.point),this.setVisible()}detach(){this.point&&(this.point=null,this.updatePosition=null,this.hideAll())}init(t){this.addAxes(this.generateMatrix(t)),this.bindEvent()}update(){const t=this.generateMatrix(this.updatePosition),e=this.calAxesMatrix(t),i=this.calPlaneMatrix(t,"xy"),n=this.calPlaneMatrix(t,"yz"),r=this.calPlaneMatrix(t,"zx");this.primitiveCollection.get(0).modelMatrix=this.primitiveCollection.get(1).modelMatrix=this.primitiveCollection.get(2).modelMatrix=e,this.primitiveCollection.get(3).modelMatrix=i,this.primitiveCollection.get(4).modelMatrix=n,this.primitiveCollection.get(5).modelMatrix=r}addAxes(t){const e=this.calAxesMatrix(t),i=new f.Primitive({geometryInstances:this.generateGeometry("polyline","axes-x"),appearance:this.generateAppearance("polyline","#f00"),modelMatrix:e}),n=new f.Primitive({geometryInstances:this.generateGeometry("polyline","axes-y"),appearance:this.generateAppearance("polyline","#0f0"),modelMatrix:e}),r=new f.Primitive({geometryInstances:this.generateGeometry("polyline","axes-z"),appearance:this.generateAppearance("polyline","#00f"),modelMatrix:e}),o=new f.Primitive({geometryInstances:this.generateGeometry("plane","plane-xy"),appearance:this.generateAppearance("plane","#00f"),modelMatrix:this.calPlaneMatrix(t,"xy")}),s=new f.Primitive({geometryInstances:this.generateGeometry("plane","plane-yz"),appearance:this.generateAppearance("plane","#f00"),modelMatrix:this.calPlaneMatrix(t,"yz")}),a=new f.Primitive({geometryInstances:this.generateGeometry("plane","plane-zx"),appearance:this.generateAppearance("plane","#0f0"),modelMatrix:this.calPlaneMatrix(t,"zx")});this.primitiveCollection.add(i,0),this.primitiveCollection.add(n,1),this.primitiveCollection.add(r,2),this.primitiveCollection.add(o,3),this.primitiveCollection.add(s,4),this.primitiveCollection.add(a,5)}bindEvent(){const{updateHandler:t}=this.options,e=this.viewer.scene;this._eventHanlder=new f.ScreenSpaceEventHandler(e.canvas);let i,n,r=new f.Matrix4,o=!1,s="",a={xy:null,yz:null,zx:null};this._eventHanlder.setInputAction(A=>{let l=e.pick(A.position);if(l&&l.id&&"string"==typeof l.id&&(l.id.startsWith("axes")||l.id.startsWith("plane"))&&!o){e.screenSpaceCameraController.enableRotate=!1,e.screenSpaceCameraController.enableTranslate=!1,o=!0,s=l.id.split("-")[1],r=this.generateMatrix(this.updatePosition);const c=this.viewer.scene.camera.getPickRay(A.position,new f.Ray);a=this.generatePlane(r);const u=f.IntersectionTests.rayPlane(c,this.getTargetPlane(s,a));n=this.generateRealPlane(u),i=f.Matrix4.multiplyByPoint(f.Matrix4.inverse(r,new f.Matrix4),u,new f.Cartesian3),this.startCoordinate=this.updatePosition,t&&t(this.startCoordinate)}},f.ScreenSpaceEventType.LEFT_DOWN),this._eventHanlder.setInputAction(i=>{if(o)return o=!1,r=new f.Matrix4,e.screenSpaceCameraController.enableRotate=!0,e.screenSpaceCameraController.enableTranslate=!0,void(t&&t(this.updatePosition))},f.ScreenSpaceEventType.LEFT_UP),this._eventHanlder.setInputAction(e=>{if(!e.endPosition)return void this.clearColor();var A=this.viewer.scene.pick(e.endPosition);A||this.clearColor();const l=A&&A.primitive;if(l&&l._instanceIds&&"string"==typeof l._instanceIds[0]&&(l._instanceIds[0].startsWith("axes")||l._instanceIds[0].startsWith("plane"))){this.clearColor();const t=l._instanceIds[0].split("-")[1];(!o||o&&t===s)&&this.setAxesColor(t)}else this.clearColor();if(!o)return;this.setAxesColor(s);const c=this.viewer.scene.camera.getPickRay(e.endPosition,new f.Ray),u=f.IntersectionTests.rayPlane(c,"z"===s?n:this.getTargetPlane(s,a));if(!u)return;const h=f.Matrix4.multiplyByPoint(f.Matrix4.inverse(r,new f.Matrix4),u,new f.Cartesian3),p=f.Cartesian3.subtract(h,i,new f.Cartesian3);this.updateModel([p.x,p.y,p.z],s),this.update(),t&&t(this.updatePosition)},f.ScreenSpaceEventType.MOUSE_MOVE)}updateModel(t,e){const i=this.startCoordinate,n=[i.lng,i.lat],r=t[0],o=t[1],s=t[2],a=Math.abs(r),A=Math.abs(o),l=new f.Cartesian2(0,0),c=new f.Cartesian2(0,1);let u=[],h=i;if("x"===e){const t=r>0?90:270;u=Wn.getPointByRhumbLine({point:n,distance:a,bearing:t,units:"meters"}),h=new I(u[0],i.lat,i.alt,i.heading,i.pitch,i.roll)}else if("y"===e){const t=o>0?0:180;u=Wn.getPointByRhumbLine({point:n,distance:A,bearing:t,units:"meters"}),h=new I(i.lng,u[1],i.alt,i.heading,i.pitch,i.roll)}else if("z"===e)h=new I(i.lng,i.lat,i.alt+s,i.heading,i.pitch,i.roll);else if("xy"===e){const e=new f.Cartesian2(t[0],t[1]),o=f.Math.toDegrees(f.Cartesian2.angleBetween(c,e)),s=f.Cartesian2.distance(l,e),a=r>0?o:360-o;u=Wn.getPointByRhumbLine({point:n,distance:s,bearing:a,units:"meters"}),h=new I(u[0],u[1],i.alt,i.heading,i.pitch,i.roll)}else if("yz"===e){const t=o>0?0:180;u=Wn.getPointByRhumbLine({point:n,distance:A,bearing:t,units:"meters"}),h=new I(i.lng,u[1],i.alt+s,i.heading,i.pitch,i.roll)}else if("zx"===e){const t=r>0?90:270;u=Wn.getPointByRhumbLine({point:n,distance:a,bearing:t,units:"meters"}),h=new I(u[0],i.lat,i.alt+s,i.heading,i.pitch,i.roll)}this.updatePosition=h}destroy(t={}){const{ended:e}=t;this.detach(),this.primitiveCollection.removeAll(),this._eventHanlder.destroy(),at(!0,e)}calAxesMatrix(t){const{length:e=100}=this.options;return f.Matrix4.multiplyByUniformScale(t,e,new f.Matrix4)}calPlaneMatrix(t,e){const{length:i=100}=this.options,n=i/5,r=f.Matrix4.clone(t);if("xy"===e){const t=f.Matrix4.fromTranslation(f.Cartesian3.fromArray([n,n,0]));f.Matrix4.multiply(r,t,r);const e=f.Matrix4.fromScale(new f.Cartesian3(n,n,n));f.Matrix4.multiply(r,e,r)}else if("yz"===e){const t=f.Matrix4.fromTranslation(f.Cartesian3.fromArray([0,n,n]));f.Matrix4.multiply(r,t,r);const e=f.Matrix4.fromScale(new f.Cartesian3(n,n,n));f.Matrix4.multiply(r,e,r);const i=f.Matrix3.fromRotationY(f.Math.PI_OVER_TWO),o=f.Matrix4.fromRotationTranslation(i);f.Matrix4.multiply(r,o,r)}else if("zx"===e){const t=f.Matrix4.fromTranslation(f.Cartesian3.fromArray([n,0,n]));f.Matrix4.multiply(r,t,r);const e=f.Matrix4.fromScale(new f.Cartesian3(n,n,n));f.Matrix4.multiply(r,e,r);const i=f.Matrix3.fromRotationX(f.Math.PI_OVER_TWO),o=f.Matrix4.fromRotationTranslation(i);f.Matrix4.multiply(r,o,r)}return r}clearColor(){this.primitiveCollection.length&&(this.primitiveCollection.get(0).appearance.material=f.Material.fromType("PolylineArrow",{color:f.Color.RED}),this.primitiveCollection.get(1).appearance.material=f.Material.fromType("PolylineArrow",{color:f.Color.GREEN}),this.primitiveCollection.get(2).appearance.material=f.Material.fromType("PolylineArrow",{color:f.Color.BLUE}),this.primitiveCollection.get(3).appearance.material=f.Material.fromType("Color",{color:f.Color.BLUE}),this.primitiveCollection.get(4).appearance.material=f.Material.fromType("Color",{color:f.Color.RED}),this.primitiveCollection.get(5).appearance.material=f.Material.fromType("Color",{color:f.Color.GREEN}))}setAxesColor(t){let e,i;"x"===t?(e=0,i="polyline"):"y"===t?(e=1,i="polyline"):"z"===t?(e=2,i="polyline"):"xy"===t?(e=3,i="plane"):"yz"===t?(e=4,i="plane"):"zx"===t&&(e=5,i="plane"),this.primitiveCollection.get(e).appearance.material="polyline"===i?f.Material.fromType("PolylineArrow",{color:f.Color.YELLOW}):f.Material.fromType("Color",{color:f.Color.YELLOW})}generatePlane(t){const e=this.getCartesian(t),i=f.Matrix4.multiplyByPoint(t,new f.Cartesian3(1,0,0),new f.Cartesian3),n=f.Cartesian3.normalize(f.Cartesian3.subtract(i,e,new f.Cartesian3),new f.Cartesian3),r=f.Matrix4.multiplyByPoint(t,new f.Cartesian3(0,1,0),new f.Cartesian3),o=f.Cartesian3.normalize(f.Cartesian3.subtract(r,e,new f.Cartesian3),new f.Cartesian3),s=f.Matrix4.multiplyByPoint(t,new f.Cartesian3(0,0,1),new f.Cartesian3),a=f.Cartesian3.normalize(f.Cartesian3.subtract(s,e,new f.Cartesian3),new f.Cartesian3);return{xy:f.Plane.fromPointNormal(e,a),yz:f.Plane.fromPointNormal(e,n),zx:f.Plane.fromPointNormal(e,o)}}generateRealPlane(t){const e=this.viewer.camera.direction;return f.Plane.fromPointNormal(t,e)}getTargetPlane(t,e){return"x"===t||"y"===t||"xy"===t?e.xy:"z"===t||"zx"===t?e.zx:"yz"===t?e.yz:void 0}generateAppearance(t,e){return"polyline"===t?new f.PolylineMaterialAppearance({material:f.Material.fromType("PolylineArrow",{color:f.Color.fromCssColorString(e)}),renderState:{depthTest:{enabled:!1}}}):"plane"===t?new f.MaterialAppearance({material:f.Material.fromType("Color",{color:f.Color.fromCssColorString(e)}),renderState:{depthTest:{enabled:!1}}}):void 0}generateGeometry(t,e){const{width:i=10,length:n=100}=this.options;if("polyline"===t){let t;return"axes-x"===e?t=[f.Cartesian3.ZERO,f.Cartesian3.UNIT_X]:"axes-y"===e?t=[f.Cartesian3.ZERO,new f.Cartesian3(.001,1,0)]:"axes-z"===e&&(t=[f.Cartesian3.ZERO,f.Cartesian3.UNIT_Z]),new f.GeometryInstance({geometry:new f.PolylineGeometry({positions:t,width:2*i,arcType:f.ArcType.NONE}),id:e})}if("plane"===t)return new f.GeometryInstance({geometry:new f.PlaneGeometry,id:e})}setVisible(){const{showPlane:t=!0}=this.options;for(let t=0;t<this.primitiveCollection.length;t++)this.primitiveCollection.get(t).show=!0;if(Object(f.defined)(t)&&!1===t)for(let t=3;t<6;t++)this.primitiveCollection.get(t).show=!1}hideAll(){for(let t=0;t<this.primitiveCollection.length;t++)this.primitiveCollection.get(t).show=!1}generateMatrix(t){const e=Y.WGS84ToCartesian(t);return f.Transforms.eastNorthUpToFixedFrame(e,f.Ellipsoid.WGS84)}getCartesian(t){return f.Matrix4.getTranslation(t,new f.Cartesian3)}}var Yu=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},Ju=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let Zu=class{constructor(t){t.viewer.viewer.transformControl?this._instance=t.viewer.viewer.transformControl:this._instance=new Wu(t)}attach(t){t&&this._instance.attach(t)}detach(){this._instance.detach()}setMode(t){this._instance.setMode(t)}destroy(){this._instance.destroy()}};Yu([N([{type:k.String,required:!0,validator:t=>["translate","rotate","scale"].indexOf(t)>-1,message:"Mode must be translate, rotate, or scale"}]),Ju("design:type",Function),Ju("design:paramtypes",[String]),Ju("design:returntype",void 0)],Zu.prototype,"setMode",null),Zu=Yu([H({viewer:{type:k.Object,required:!0},length:{type:k.Number},width:{type:k.Number},showPlane:{type:k.Boolean}}),Ju("design:paramtypes",[Object])],Zu);var $u=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},th=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let eh=class{constructor(t){t.viewer.viewer.billboardControl?this._instance=t.viewer.viewer.billboardControl:this._instance=new qu(t)}attach(t){t&&this._instance.attach(t)}detach(){this._instance.detach()}setMode(t){this._instance.setMode(t)}destroy(){this._instance.destroy()}setProperty(t){this._instance.setProperty(t)}};$u([N([{type:k.String,required:!0,validator:t=>["translate","rotate","scale","all"].indexOf(t)>-1,message:"Mode must be one of translate、rotate、scale、all"}]),th("design:type",Function),th("design:paramtypes",[String]),th("design:returntype",void 0)],eh.prototype,"setMode",null),eh=$u([H({viewer:{type:k.Object,required:!0}}),th("design:paramtypes",[Object])],eh);var ih=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},nh=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let rh=class{constructor(t){t.viewer.viewer.translateControl?this._instance=t.viewer.viewer.translateControl:this._instance=new Xu(t)}attach(t){this._instance&&t&&this._instance.attach(t)}detach(){this._instance&&this._instance.detach()}destroy(){this._instance.destroy(),this._instance=null}};rh=ih([H({viewer:{type:k.Object,required:!0},length:{type:k.Number},width:{type:k.Number},showPlane:{type:k.Boolean}}),nh("design:paramtypes",[Object])],rh);var oh=function(t,e,i,n){return new(i||(i=Promise))((function(r,o){function s(t){try{A(n.next(t))}catch(t){o(t)}}function a(t){try{A(n.throw(t))}catch(t){o(t)}}function A(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(s,a)}A((n=n.apply(t,e||[])).next())}))};var sh=function(t,e,i,n){return new(i||(i=Promise))((function(r,o){function s(t){try{A(n.next(t))}catch(t){o(t)}}function a(t){try{A(n.throw(t))}catch(t){o(t)}}function A(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(s,a)}A((n=n.apply(t,e||[])).next())}))};class ah extends class{constructor(t){this.options=t,this.userViewer=t.viewer}addToViewer(t){}init(){return oh(this,void 0,void 0,(function*(){const t=yield this.getEcharts();this.initCharts(t)}))}initCharts(t){!function(t){const e={};function i(n){if(e[n])return e[n].exports;const r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;const n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(let e in t)i.d(n,e,function(e){return t[e]}.bind(null,e));return n},i.n=function(t){let e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){t.exports=i(1)},function(e,i,n){t?n(2).load():console.error("missing echarts lib")},function(e,i,n){function r(t,e){for(let i=0;i<e.length;i++){let n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}n.r(i);let o=function(){function e(t,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this._viewer=t,this.dimensions=["lng","lat"],this._mapOffset=[0,0],this._api=i}let i,n,o;return i=e,o=[{key:"create",value:function(i,n){let r;i.eachComponent("GLMap",(function(i){(r=new e(t.cesiumViewer,n)).setMapOffset(i.__mapOffset||[0,0]),i.coordinateSystem=r})),i.eachSeries((function(t){"GLMap"===t.get("coordinateSystem")&&(t.coordinateSystem=r)}))}},{key:"dimensions",get:function(){return["lng","lat"]}}],(n=[{key:"setMapOffset",value:function(t){return this._mapOffset=t,this}},{key:"getViewer",value:function(){return this._viewer}},{key:"dataToPoint",value:function(t){let e=this._viewer.scene,i=[0,0],n=f.Cartesian3.fromDegrees(t[0],t[1]);if(!n)return i;if(e.mode===f.SceneMode.SCENE3D&&f.Cartesian3.angleBetween(e.camera.position,n)>f.Math.toRadians(80))return!1;let r=e.cartesianToCanvasCoordinates(n);return r?[r.x-this._mapOffset[0],r.y-this._mapOffset[1]]:i}},{key:"pointToData",value:function(t){let e=this._mapOffset,i=viewer.scene.globe.ellipsoid,n=new f.Cartesian3(t[1]+e,t[2]+e[2],0),r=i.cartesianToCartographic(n);return[r.lng,r.lat]}},{key:"getViewRect",value:function(){let e=this._api;return new t.graphic.BoundingRect(0,0,e.getWidth(),e.getHeight())}},{key:"getRoamTransform",value:function(){return t.matrix.create()}}])&&r(i.prototype,n),o&&r(i,o),e}();function s(){t.registerCoordinateSystem("GLMap",o),t.registerAction({type:"GLMapRoam",event:"GLMapRoam",update:"updateLayout"},(function(t,e){}))}t.extendComponentModel({type:"GLMap",getViewer:function(){return t.cesiumViewer},defaultOption:{roam:!1}}),t.extendComponentView({type:"GLMap",init:function(e,i){this.api=i,t.cesiumViewer.scene.postRender.addEventListener(this.moveHandler,this)},moveHandler:function(t,e){this.api.dispatchAction({type:"GLMapRoam"})},render:function(t,e,i){},dispose:function(e){t.cesiumViewer.scene.postRender.removeEventListener(this.moveHandler,this)}}),n.d(i,"load",(function(){return s}))}]),t.cesiumViewer=this.userViewer.viewer.instance;this.ChartsBase=class{constructor(t,e){this._mapContainer=t,this._overlay=this._createChartOverlay(),this._overlay.setOption(e)}_createChartOverlay(){const e=this._mapContainer.scene;e.canvas.setAttribute("tabIndex",0);const i=document.createElement("div");i.style.position="absolute",i.style.top="0px",i.style.left="0px",i.style.width=e.canvas.width+"px",i.style.height=e.canvas.height+"px",i.style.pointerEvents="none";const n=document.getElementsByClassName("echartMap").length;return i.setAttribute("id","ysCesium-echarts--"+n),i.setAttribute("class","echartMap"),this._mapContainer.container.appendChild(i),this._echartsContainer=i,t.init(i)}dispose(){this._echartsContainer&&(this._mapContainer.container.removeChild(this._echartsContainer),this._echartsContainer=null),this._overlay&&(this._overlay.dispose(),this._overlay=null)}updateOverlay(t){this._overlay&&this._overlay.setOption(t)}getMap(){return this._mapContainer}getOverlay(){return this._overlay}show(){this._echartsContainer.style.visibility="visible"}hide(){this._echartsContainer.style.visibility="hidden"}}}getEcharts(){return oh(this,void 0,void 0,(function*(){return window.echarts||(yield this.createEcharts()),window.echarts}))}createEcharts(){return oh(this,void 0,void 0,(function*(){return new Promise((t,e)=>{const i=document.createElement("script");i.setAttribute("type","text/javascript");const n=Bt.getMapConfig(this.userViewer).distUrl+"Imgs/echarts.min.js";i.src=n,document.getElementsByTagName("head")[0].appendChild(i),i.onload=()=>{t(!0)}})}))}show(){this.instance&&this.instance.show()}hide(){this.instance&&this.instance.hide()}remove(){this.instance&&this.instance.dispose(),this.instance=null}}{constructor(t){super(t)}addToViewer(t){return sh(this,void 0,void 0,(function*(){const{ended:e}=t;yield this.init();const{option:i={}}=this.options;i.animation=!1,this.instance=new this.ChartsBase(this.userViewer.viewer.instance,i),at(!0,e)}))}}var Ah=function(t,e,i,n){var r,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,i,s):r(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s},lh=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};let ch=class{constructor(t){this.instance=new ah(t)}addToViewer(t){this.instance.addToViewer(t)}remove(t={}){this.instance.remove(t)}show(){this.instance.show()}hide(){this.instance.hide()}};Ah([R(is.addToViewer),lh("design:type",Function),lh("design:paramtypes",[Object]),lh("design:returntype",void 0)],ch.prototype,"addToViewer",null),Ah([R(is.remove),lh("design:type",Function),lh("design:paramtypes",[Object]),lh("design:returntype",void 0)],ch.prototype,"remove",null),ch=Ah([H({viewer:{type:k.Object,required:!0},option:{type:k.Object,required:!0}}),lh("design:paramtypes",[Object])],ch);const uh=x,hh=E,ph=S,dh=f.LightSourceType,fh=Object.assign({},f.ShadowMode),gh=Object.assign({},f.LabelStyle),mh=Object.assign({},f.HorizontalOrigin),yh=Object.assign({},f.VerticalOrigin),vh=Object.assign({},f.HeightReference),_h={POI:"poi",ROAD:"road",CROSS:"cross",ROAD_SECTION:"roadSection",WATER_FACE:"waterFace"},wh=Object.assign(Object.assign({HorizontalOrigin:mh,VerticalOrigin:yh,HeightReference:vh,LabelStyle:gh,ShadowMode:fh},f.LightSourceType),{FENCE_MATERIAL_TYPE:ph,CLUSTER_STYLE_SHAPE:hh,ARROW_TYPE:uh,BasicDataType:_h});e.default=Object.assign(Object.assign({},r),{version:"4.8.0",buildTime:"2023-12-29 15:19:09"})},function(t,e,i){"use strict";i.r(e);var n=i(0),r="attribute vec4 position;\r\nattribute vec3 normal;\r\n\r\nvarying vec3 v_position;\r\nvarying vec3 v_positionWC;\r\nvarying vec3 v_positionEC;\r\nvarying vec3 v_normalEC;\r\n\r\nvoid main()\r\n{\r\n    gl_Position = czm_modelViewProjection * position;\r\n    v_position = vec3(position);\r\n    v_positionWC = (czm_model * position).xyz;\r\n    v_positionEC = (czm_modelView * position).xyz;\r\n    v_normalEC = czm_normal * normal;\r\n}",o='#ifdef GL_OES_standard_derivatives\r\n#extension GL_OES_standard_derivatives : enable\r\n#endif\r\n\r\nuniform bool u_showIntersection;\r\nuniform bool u_showThroughEllipsoid;\r\n\r\nuniform float u_radius;\r\nuniform float u_xHalfAngle;\r\nuniform float u_yHalfAngle;\r\nuniform float u_normalDirection;\r\nuniform float u_type;\r\n\r\nvarying vec3 v_position;\r\nvarying vec3 v_positionWC;\r\nvarying vec3 v_positionEC;\r\nvarying vec3 v_normalEC;\r\n\r\nvec4 getColor(float sensorRadius, vec3 pointEC)\r\n{\r\n    czm_materialInput materialInput;\r\n\r\n    vec3 pointMC = (czm_inverseModelView * vec4(pointEC, 1.0)).xyz;\r\n    materialInput.st = sensor2dTextureCoordinates(sensorRadius, pointMC);\r\n    materialInput.str = pointMC / sensorRadius;\r\n\r\n    vec3 positionToEyeEC = -v_positionEC;\r\n    materialInput.positionToEyeEC = positionToEyeEC;\r\n\r\n    vec3 normalEC = normalize(v_normalEC);\r\n    materialInput.normalEC = u_normalDirection * normalEC;\r\n\r\n    czm_material material = czm_getMaterial(materialInput);\r\n\r\n    return mix(czm_phong(normalize(positionToEyeEC), material,czm_lightDirectionEC), vec4(material.diffuse, material.alpha), 0.4);\r\n\r\n}\r\n\r\nbool isOnBoundary(float value, float epsilon)\r\n{\r\n    float width = getIntersectionWidth();\r\n    float tolerance = width * epsilon;\r\n\r\n#ifdef GL_OES_standard_derivatives\r\n    float delta = max(abs(dFdx(value)), abs(dFdy(value)));\r\n    float pixels = width * delta;\r\n    float temp = abs(value);\r\n    // There are a couple things going on here.\r\n    // First we test the value at the current fragment to see if it is within the tolerance.\r\n    // We also want to check if the value of an adjacent pixel is within the tolerance,\r\n    // but we don\'t want to admit points that are obviously not on the surface.\r\n    // For example, if we are looking for "value" to be close to 0, but value is 1 and the adjacent value is 2,\r\n    // then the delta would be 1 and "temp - delta" would be "1 - 1" which is zero even though neither of\r\n    // the points is close to zero.\r\n    return temp < tolerance && temp < pixels || (delta < 10.0 * tolerance && temp - delta < tolerance && temp < pixels);\r\n#else\r\n    return abs(value) < tolerance;\r\n#endif\r\n}\r\n\r\nvec4 shade(bool isOnBoundary)\r\n{\r\n    if (u_showIntersection && isOnBoundary)\r\n    {\r\n        return getIntersectionColor();\r\n    }\r\n    if(u_type == 1.0){\r\n        return getLineColor();\r\n    }\r\n    return getColor(u_radius, v_positionEC);\r\n}\r\n\r\nfloat ellipsoidSurfaceFunction(vec3 inverseRadii, vec3 point)\r\n{\r\n    vec3 scaled = inverseRadii * point;\r\n    return dot(scaled, scaled) - 1.0;\r\n}\r\n\r\nvoid main()\r\n{\r\n    vec3 sensorVertexWC = czm_model[3].xyz;      // (0.0, 0.0, 0.0) in model coordinates\r\n    vec3 sensorVertexEC = czm_modelView[3].xyz;  // (0.0, 0.0, 0.0) in model coordinates\r\n\r\n    //vec3 pixDir = normalize(v_position);\r\n    float positionX = v_position.x;\r\n    float positionY = v_position.y;\r\n    float positionZ = v_position.z;\r\n\r\n    vec3 zDir = vec3(0.0, 0.0, 1.0);\r\n    vec3 lineX = vec3(positionX, 0 ,positionZ);\r\n    vec3 lineY = vec3(0, positionY, positionZ);\r\n    float resX = dot(normalize(lineX), zDir);\r\n    if(resX < cos(u_xHalfAngle)-0.00001){\r\n        discard;\r\n    }\r\n    float resY = dot(normalize(lineY), zDir);\r\n    if(resY < cos(u_yHalfAngle)-0.00001){\r\n        discard;\r\n    }\r\n\r\n\r\n    //czm_ellipsoid ellipsoid = czm_getWgs84EllipsoidEC();\r\n    float ellipsoidValue = ellipsoidSurfaceFunction(czm_ellipsoidInverseRadii, v_positionWC);\r\n\r\n    // Occluded by the ellipsoid?\r\n\tif (!u_showThroughEllipsoid)\r\n\t{\r\n\t    // Discard if in the ellipsoid\r\n\t    // PERFORMANCE_IDEA: A coarse check for ellipsoid intersection could be done on the CPU first.\r\n\t    if (ellipsoidValue < 0.0)\r\n\t    {\r\n            discard;\r\n\t    }\r\n\r\n\t    // Discard if in the sensor\'s shadow\r\n\t    if (inSensorShadow(sensorVertexWC, czm_ellipsoidInverseRadii, v_positionWC))\r\n\t    {\r\n\t        discard;\r\n\t    }\r\n    }\r\n\r\n    // Notes: Each surface functions should have an associated tolerance based on the floating point error.\r\n    bool isOnEllipsoid = isOnBoundary(ellipsoidValue, czm_epsilon3);\r\n    //isOnEllipsoid = false;\r\n    //if((resX >= 0.8 && resX <= 0.81)||(resY >= 0.8 && resY <= 0.81)){\r\n    /*if(false){\r\n        gl_FragColor = vec4(1.0,0.0,0.0,1.0);\r\n    }else{\r\n        gl_FragColor = shade(isOnEllipsoid);\r\n    }\r\n*/\r\n    gl_FragColor = shade(isOnEllipsoid);\r\n\r\n}',s="uniform vec4 u_intersectionColor;\r\nuniform float u_intersectionWidth;\r\nuniform vec4 u_lineColor;\r\n\r\nbool inSensorShadow(vec3 coneVertexWC, vec3 inverseRadii, vec3 pointWC)\r\n{\r\n    // Diagonal matrix from the unscaled ellipsoid space to the scaled space.    \r\n    vec3 D = inverseRadii;\r\n\r\n    // Sensor vertex in the scaled ellipsoid space\r\n    vec3 q = D * coneVertexWC;\r\n    float qMagnitudeSquared = dot(q, q);\r\n    float test = qMagnitudeSquared - 1.0;\r\n    \r\n    // Sensor vertex to fragment vector in the ellipsoid's scaled space\r\n    vec3 temp = D * pointWC - q;\r\n    float d = dot(temp, q);\r\n    \r\n    // Behind silhouette plane and inside silhouette cone\r\n    return (d < -test) && (d / length(temp) < -sqrt(test));\r\n}\r\n\r\n///////////////////////////////////////////////////////////////////////////////\r\n\r\nvec4 getLineColor()\r\n{\r\n    return u_lineColor;\r\n}\r\n\r\nvec4 getIntersectionColor()\r\n{\r\n    return u_intersectionColor;\r\n}\r\n\r\nfloat getIntersectionWidth()\r\n{\r\n    return u_intersectionWidth;\r\n}\r\n\r\nvec2 sensor2dTextureCoordinates(float sensorRadius, vec3 pointMC)\r\n{\r\n    // (s, t) both in the range [0, 1]\r\n    float t = pointMC.z / sensorRadius;\r\n    float s = 1.0 + (atan(pointMC.y, pointMC.x) / czm_twoPi);\r\n    s = s - floor(s);\r\n    \r\n    return vec2(s, t);\r\n}\r\n",a=n.BoundingSphere,A=n.Cartesian3,l=n.Color,c=n.combine,u=n.ComponentDatatype,h=n.defaultValue,p=n.defined,d=(Object.defineProperties,n.destroyObject),f=n.DeveloperError,g=n.Matrix4,m=n.PrimitiveType,y=n.Buffer,v=n.BufferUsage,_=n.DrawCommand,w=n.Pass,C=n.RenderState,B=n.ShaderProgram,b=n.ShaderSource,E=n.VertexArray,S=n.BlendingState,x=n.CullFace,I=n.Material,F=n.SceneMode,O=n.VertexFormat,P=n.Math,T=n.Matrix3,L=(g=n.Matrix4,n.JulianDate),M=(n.BoxGeometry,n.EllipsoidGeometry,Math.sin),U=Math.cos,D=Math.tan,Q=Math.atan,R=(Math.asin,{position:0,normal:1});function N(t){var e=this;t=h(t,h.EMPTY_OBJECT),this.show=h(t.show,!0),this.slice=h(t.slice,32),this.modelMatrix=g.clone(t.modelMatrix,new g),this._modelMatrix=new g,this._computedModelMatrix=new g,this._computedScanPlaneModelMatrix=new g,this.radius=h(t.radius,Number.POSITIVE_INFINITY),this._radius=void 0,this.xHalfAngle=h(t.xHalfAngle,0),this._xHalfAngle=void 0,this.yHalfAngle=h(t.yHalfAngle,0),this._yHalfAngle=void 0,this.lineColor=h(t.lineColor,l.WHITE),this.showSectorLines=h(t.showSectorLines,!0),this.showSectorSegmentLines=h(t.showSectorSegmentLines,!0),this.showLateralSurfaces=h(t.showLateralSurfaces,!0),this.material=p(t.material)?t.material:I.fromType(I.ColorType),this._material=void 0,this._translucent=void 0,this.lateralSurfaceMaterial=p(t.lateralSurfaceMaterial)?t.lateralSurfaceMaterial:I.fromType(I.ColorType),this._lateralSurfaceMaterial=void 0,this._lateralSurfaceTranslucent=void 0,this.showDomeSurfaces=h(t.showDomeSurfaces,!0),this.domeSurfaceMaterial=p(t.domeSurfaceMaterial)?t.domeSurfaceMaterial:I.fromType(I.ColorType),this._domeSurfaceMaterial=void 0,this.showDomeLines=h(t.showDomeLines,!0),this.showIntersection=h(t.showIntersection,!0),this.intersectionColor=h(t.intersectionColor,l.WHITE),this.intersectionWidth=h(t.intersectionWidth,5),this.showThroughEllipsoid=h(t.showThroughEllipsoid,!1),this._showThroughEllipsoid=void 0,this.showScanPlane=h(t.showScanPlane,!0),this.scanPlaneColor=h(t.scanPlaneColor,l.WHITE),this.scanPlaneMode=h(t.scanPlaneMode,"horizontal"),this.scanPlaneRate=h(t.scanPlaneRate,10),this._scanePlaneXHalfAngle=0,this._scanePlaneYHalfAngle=0,this._time=L.now(),this._boundingSphere=new a,this._boundingSphereWC=new a,this._sectorFrontCommand=new _({owner:this,primitiveType:m.TRIANGLES,boundingVolume:this._boundingSphereWC}),this._sectorBackCommand=new _({owner:this,primitiveType:m.TRIANGLES,boundingVolume:this._boundingSphereWC}),this._sectorVA=void 0,this._sectorLineCommand=new _({owner:this,primitiveType:m.LINES,boundingVolume:this._boundingSphereWC}),this._sectorLineVA=void 0,this._sectorSegmentLineCommand=new _({owner:this,primitiveType:m.LINES,boundingVolume:this._boundingSphereWC}),this._sectorSegmentLineVA=void 0,this._domeFrontCommand=new _({owner:this,primitiveType:m.TRIANGLES,boundingVolume:this._boundingSphereWC}),this._domeBackCommand=new _({owner:this,primitiveType:m.TRIANGLES,boundingVolume:this._boundingSphereWC}),this._domeVA=void 0,this._domeLineCommand=new _({owner:this,primitiveType:m.LINES,boundingVolume:this._boundingSphereWC}),this._domeLineVA=void 0,this._scanPlaneFrontCommand=new _({owner:this,primitiveType:m.TRIANGLES,boundingVolume:this._boundingSphereWC}),this._scanPlaneBackCommand=new _({owner:this,primitiveType:m.TRIANGLES,boundingVolume:this._boundingSphereWC}),this._scanRadialCommand=void 0,this._colorCommands=[],this._frontFaceRS=void 0,this._backFaceRS=void 0,this._sp=void 0,this._uniforms={u_type:function(){return 0},u_xHalfAngle:function(){return e.xHalfAngle},u_yHalfAngle:function(){return e.yHalfAngle},u_radius:function(){return e.radius},u_showThroughEllipsoid:function(){return e.showThroughEllipsoid},u_showIntersection:function(){return e.showIntersection},u_intersectionColor:function(){return e.intersectionColor},u_intersectionWidth:function(){return e.intersectionWidth},u_normalDirection:function(){return 1},u_lineColor:function(){return e.lineColor}},this._scanUniforms={u_xHalfAngle:function(){return e._scanePlaneXHalfAngle},u_yHalfAngle:function(){return e._scanePlaneYHalfAngle},u_radius:function(){return e.radius},u_color:function(){return e.scanPlaneColor},u_showThroughEllipsoid:function(){return e.showThroughEllipsoid},u_showIntersection:function(){return e.showIntersection},u_intersectionColor:function(){return e.intersectionColor},u_intersectionWidth:function(){return e.intersectionWidth},u_normalDirection:function(){return 1},u_lineColor:function(){return e.lineColor}}}N.prototype.update=function(t){var e=t.mode;if(this.show&&e===F.SCENE3D){var i=!1,l=!1,c=!1,h=this.xHalfAngle,p=this.yHalfAngle;if(h<0||p<0)throw new f("halfAngle must be greater than or equal to zero.");if(0!=h&&0!=p){this._xHalfAngle===h&&this._yHalfAngle===p||(this._xHalfAngle=h,this._yHalfAngle=p,i=!0);var d=this.radius;if(d<0)throw new f("this.radius must be greater than or equal to zero.");var m=!1;this._radius!==d&&(m=!0,this._radius=d,this._boundingSphere=new a(A.ZERO,this.radius)),(!g.equals(this.modelMatrix,this._modelMatrix)||m)&&(g.clone(this.modelMatrix,this._modelMatrix),g.multiplyByUniformScale(this.modelMatrix,this.radius,this._computedModelMatrix),a.transform(this._boundingSphere,this.modelMatrix,this._boundingSphereWC));var _=this.showThroughEllipsoid;this._showThroughEllipsoid!==this.showThroughEllipsoid&&(this._showThroughEllipsoid=_,l=!0);var I=this.material;this._material!==I&&(this._material=I,l=!0,c=!0);var M=I.isTranslucent();if(this._translucent!==M&&(this._translucent=M,l=!0),this.showScanPlane){var N=t.time,K=L.secondsDifference(N,this._time);K<0&&(this._time=L.clone(N,this._time));var z,W=Math.max(K%this.scanPlaneRate/this.scanPlaneRate,0);if("horizontal"==this.scanPlaneMode){var q=U(z=2*p*W-p),X=D(h),Y=Q(q*X);this._scanePlaneXHalfAngle=Y,this._scanePlaneYHalfAngle=z,n.Matrix3.fromRotationX(this._scanePlaneYHalfAngle,H)}else{z=2*h*W-h;var J=D(p),Z=U(z),$=Q(Z*J);this._scanePlaneXHalfAngle=z,this._scanePlaneYHalfAngle=$,n.Matrix3.fromRotationY(this._scanePlaneXHalfAngle,H)}n.Matrix4.multiplyByMatrix3(this.modelMatrix,H,this._computedScanPlaneModelMatrix),g.multiplyByUniformScale(this._computedScanPlaneModelMatrix,this.radius,this._computedScanPlaneModelMatrix)}i&&function(t,e){var i=e.context,r=V(t,t.xHalfAngle,t.yHalfAngle),o=function(t,e){var i=t.xHalfAngle,r=t.yHalfAngle,o=e.zoy,s=e.zox,a=[],A=T.fromRotationY(i,H);a.push(o.map((function(t){return T.multiplyByVector(A,t,new n.Cartesian3)})));A=T.fromRotationX(-r,H);a.push(s.map((function(t){return T.multiplyByVector(A,t,new n.Cartesian3)})).reverse());A=T.fromRotationY(-i,H);a.push(o.map((function(t){return T.multiplyByVector(A,t,new n.Cartesian3)})).reverse());A=T.fromRotationX(r,H);return a.push(s.map((function(t){return T.multiplyByVector(A,t,new n.Cartesian3)}))),a}(t,r);t.showLateralSurfaces&&(t._sectorVA=function(t,e){for(var i=Array.prototype.concat.apply([],e).length-e.length,n=new Float32Array(18*i),r=0,o=0,s=e.length;o<s;o++){var a=e[o],l=A.normalize(A.cross(a[0],a[a.length-1],k),k),c=0;for(i=a.length-1;c<i;c++)n[r++]=0,n[r++]=0,n[r++]=0,n[r++]=-l.x,n[r++]=-l.y,n[r++]=-l.z,n[r++]=a[c].x,n[r++]=a[c].y,n[r++]=a[c].z,n[r++]=-l.x,n[r++]=-l.y,n[r++]=-l.z,n[r++]=a[c+1].x,n[r++]=a[c+1].y,n[r++]=a[c+1].z,n[r++]=-l.x,n[r++]=-l.y,n[r++]=-l.z}var h=y.createVertexBuffer({context:t,typedArray:n,usage:v.STATIC_DRAW}),p=6*Float32Array.BYTES_PER_ELEMENT,d=[{index:R.position,vertexBuffer:h,componentsPerAttribute:3,componentDatatype:u.FLOAT,offsetInBytes:0,strideInBytes:p},{index:R.normal,vertexBuffer:h,componentsPerAttribute:3,componentDatatype:u.FLOAT,offsetInBytes:3*Float32Array.BYTES_PER_ELEMENT,strideInBytes:p}];return new E({context:t,attributes:d})}(i,o));t.showSectorLines&&(t._sectorLineVA=function(t,e){for(var i=e.length,n=new Float32Array(9*i),r=0,o=0,s=e.length;o<s;o++){var a=e[o];n[r++]=0,n[r++]=0,n[r++]=0,n[r++]=a[0].x,n[r++]=a[0].y,n[r++]=a[0].z}var A=y.createVertexBuffer({context:t,typedArray:n,usage:v.STATIC_DRAW}),l=3*Float32Array.BYTES_PER_ELEMENT,c=[{index:R.position,vertexBuffer:A,componentsPerAttribute:3,componentDatatype:u.FLOAT,offsetInBytes:0,strideInBytes:l}];return new E({context:t,attributes:c})}(i,o));t.showSectorSegmentLines&&(t._sectorSegmentLineVA=function(t,e){for(var i=Array.prototype.concat.apply([],e).length-e.length,n=new Float32Array(9*i),r=0,o=0,s=e.length;o<s;o++){var a=e[o],A=0;for(i=a.length-1;A<i;A++)n[r++]=a[A].x,n[r++]=a[A].y,n[r++]=a[A].z,n[r++]=a[A+1].x,n[r++]=a[A+1].y,n[r++]=a[A+1].z}var l=y.createVertexBuffer({context:t,typedArray:n,usage:v.STATIC_DRAW}),c=3*Float32Array.BYTES_PER_ELEMENT,h=[{index:R.position,vertexBuffer:l,componentsPerAttribute:3,componentDatatype:u.FLOAT,offsetInBytes:0,strideInBytes:c}];return new E({context:t,attributes:h})}(i,o));t.showDomeSurfaces&&(t._domeVA=function(t){var e=n.EllipsoidGeometry.createGeometry(new n.EllipsoidGeometry({vertexFormat:O.POSITION_ONLY,stackPartitions:32,slicePartitions:32}));return E.fromGeometry({context:t,geometry:e,attributeLocations:R,bufferUsage:v.STATIC_DRAW,interleave:!1})}(i));t.showDomeLines&&(t._domeLineVA=function(t){var e=n.EllipsoidOutlineGeometry.createGeometry(new n.EllipsoidOutlineGeometry({vertexFormat:O.POSITION_ONLY,stackPartitions:32,slicePartitions:32}));return E.fromGeometry({context:t,geometry:e,attributeLocations:R,bufferUsage:v.STATIC_DRAW,interleave:!1})}(i));if(t.showScanPlane)if("horizontal"==t.scanPlaneMode){var s=V(t,P.PI_OVER_TWO,0);t._scanPlaneVA=j(i,s.zox)}else{s=V(t,0,P.PI_OVER_TWO);t._scanPlaneVA=j(i,s.zoy)}}(this,t),l&&function(t,e,i){i?(t._frontFaceRS=C.fromCache({depthTest:{enabled:!e},depthMask:!1,blending:S.ALPHA_BLEND,cull:{enabled:!0,face:x.BACK}}),t._backFaceRS=C.fromCache({depthTest:{enabled:!e},depthMask:!1,blending:S.ALPHA_BLEND,cull:{enabled:!0,face:x.FRONT}}),t._pickRS=C.fromCache({depthTest:{enabled:!e},depthMask:!1,blending:S.ALPHA_BLEND})):(t._frontFaceRS=C.fromCache({depthTest:{enabled:!e},depthMask:!0}),t._pickRS=C.fromCache({depthTest:{enabled:!0},depthMask:!0}))}(this,_,M),c&&function(t,e,i){(function(t,e,i){var n=e.context,a=r,A=new b({sources:[s,i.shaderSource,o]});t._sp=B.replaceCache({context:n,shaderProgram:t._sp,vertexShaderSource:a,fragmentShaderSource:A,attributeLocations:R});var l=new b({sources:[s,i.shaderSource,o],pickColorQualifier:"uniform"});t._pickSP=B.replaceCache({context:n,shaderProgram:t._pickSP,vertexShaderSource:a,fragmentShaderSource:l,attributeLocations:R})})(t,e,i),t.showScanPlane&&function(t,e,i){var n=e.context,r=new b({sources:[s,i.shaderSource,'#ifdef GL_OES_standard_derivatives\r\n#extension GL_OES_standard_derivatives : enable\r\n#endif\r\n\r\nuniform bool u_showIntersection;\r\nuniform bool u_showThroughEllipsoid;\r\n\r\nuniform float u_radius;\r\nuniform float u_xHalfAngle;\r\nuniform float u_yHalfAngle;\r\nuniform float u_normalDirection;\r\nuniform vec4 u_color;\r\n\r\nvarying vec3 v_position;\r\nvarying vec3 v_positionWC;\r\nvarying vec3 v_positionEC;\r\nvarying vec3 v_normalEC;\r\n\r\nvec4 getColor(float sensorRadius, vec3 pointEC)\r\n{\r\n    czm_materialInput materialInput;\r\n\r\n    vec3 pointMC = (czm_inverseModelView * vec4(pointEC, 1.0)).xyz;\r\n    materialInput.st = sensor2dTextureCoordinates(sensorRadius, pointMC);\r\n    materialInput.str = pointMC / sensorRadius;\r\n\r\n    vec3 positionToEyeEC = -v_positionEC;\r\n    materialInput.positionToEyeEC = positionToEyeEC;\r\n\r\n    vec3 normalEC = normalize(v_normalEC);\r\n    materialInput.normalEC = u_normalDirection * normalEC;\r\n\r\n    czm_material material = czm_getMaterial(materialInput);\r\n\r\n    material.diffuse = u_color.rgb;\r\n    material.alpha = u_color.a;\r\n\r\n    return mix(czm_phong(normalize(positionToEyeEC), material,czm_lightDirectionEC), vec4(material.diffuse, material.alpha), 0.4);\r\n\r\n}\r\n\r\nbool isOnBoundary(float value, float epsilon)\r\n{\r\n    float width = getIntersectionWidth();\r\n    float tolerance = width * epsilon;\r\n\r\n#ifdef GL_OES_standard_derivatives\r\n    float delta = max(abs(dFdx(value)), abs(dFdy(value)));\r\n    float pixels = width * delta;\r\n    float temp = abs(value);\r\n    // There are a couple things going on here.\r\n    // First we test the value at the current fragment to see if it is within the tolerance.\r\n    // We also want to check if the value of an adjacent pixel is within the tolerance,\r\n    // but we don\'t want to admit points that are obviously not on the surface.\r\n    // For example, if we are looking for "value" to be close to 0, but value is 1 and the adjacent value is 2,\r\n    // then the delta would be 1 and "temp - delta" would be "1 - 1" which is zero even though neither of\r\n    // the points is close to zero.\r\n    return temp < tolerance && temp < pixels || (delta < 10.0 * tolerance && temp - delta < tolerance && temp < pixels);\r\n#else\r\n    return abs(value) < tolerance;\r\n#endif\r\n}\r\n\r\nvec4 shade(bool isOnBoundary)\r\n{\r\n    if (u_showIntersection && isOnBoundary)\r\n    {\r\n        return getIntersectionColor();\r\n    }\r\n    return getColor(u_radius, v_positionEC);\r\n}\r\n\r\nfloat ellipsoidSurfaceFunction(vec3 inverseRadii, vec3 point)\r\n{\r\n    vec3 scaled = inverseRadii * point;\r\n    return dot(scaled, scaled) - 1.0;\r\n}\r\n\r\nvoid main()\r\n{\r\n    vec3 sensorVertexWC = czm_model[3].xyz;      // (0.0, 0.0, 0.0) in model coordinates\r\n    vec3 sensorVertexEC = czm_modelView[3].xyz;  // (0.0, 0.0, 0.0) in model coordinates\r\n\r\n    //vec3 pixDir = normalize(v_position);\r\n    float positionX = v_position.x;\r\n    float positionY = v_position.y;\r\n    float positionZ = v_position.z;\r\n\r\n    vec3 zDir = vec3(0.0, 0.0, 1.0);\r\n    vec3 lineX = vec3(positionX, 0 ,positionZ);\r\n    vec3 lineY = vec3(0, positionY, positionZ);\r\n    float resX = dot(normalize(lineX), zDir);\r\n    if(resX < cos(u_xHalfAngle) - 0.0001){\r\n        discard;\r\n    }\r\n    float resY = dot(normalize(lineY), zDir);\r\n    if(resY < cos(u_yHalfAngle)- 0.0001){\r\n        discard;\r\n    }\r\n\r\n\r\n    //czm_ellipsoid ellipsoid = czm_getWgs84EllipsoidEC();\r\n    float ellipsoidValue = ellipsoidSurfaceFunction(czm_ellipsoidInverseRadii, v_positionWC);\r\n\r\n    // Occluded by the ellipsoid?\r\n\tif (!u_showThroughEllipsoid)\r\n\t{\r\n\t    // Discard if in the ellipsoid\r\n\t    // PERFORMANCE_IDEA: A coarse check for ellipsoid intersection could be done on the CPU first.\r\n\t    if (ellipsoidValue < 0.0)\r\n\t    {\r\n            discard;\r\n\t    }\r\n\r\n\t    // Discard if in the sensor\'s shadow\r\n\t    if (inSensorShadow(sensorVertexWC, czm_ellipsoidInverseRadii, v_positionWC))\r\n\t    {\r\n\t        discard;\r\n\t    }\r\n    }\r\n\r\n    // Notes: Each surface functions should have an associated tolerance based on the floating point error.\r\n    bool isOnEllipsoid = isOnBoundary(ellipsoidValue, czm_epsilon3);\r\n    gl_FragColor = shade(isOnEllipsoid);\r\n\r\n}']});t._scanePlaneSP=B.replaceCache({context:n,shaderProgram:t._scanePlaneSP,vertexShaderSource:"attribute vec4 position;\r\nattribute vec3 normal;\r\n\r\nvarying vec3 v_position;\r\nvarying vec3 v_positionWC;\r\nvarying vec3 v_positionEC;\r\nvarying vec3 v_normalEC;\r\n\r\nvoid main()\r\n{\r\n    gl_Position = czm_modelViewProjection * position;\r\n    v_position = vec3(position);\r\n    v_positionWC = (czm_model * position).xyz;\r\n    v_positionEC = (czm_modelView * position).xyz;\r\n    v_normalEC = czm_normal * normal;\r\n}",fragmentShaderSource:r,attributeLocations:R})}(t,e,i)}(this,t,I),(l||c)&&function(t,e){t._colorCommands.length=0;var i=e?w.TRANSLUCENT:w.OPAQUE;t.showLateralSurfaces&&G(t,t._sectorFrontCommand,t._sectorBackCommand,t._frontFaceRS,t._backFaceRS,t._sp,t._sectorVA,t._uniforms,t._computedModelMatrix,e,i);t.showSectorLines&&G(t,t._sectorLineCommand,void 0,t._frontFaceRS,t._backFaceRS,t._sp,t._sectorLineVA,t._uniforms,t._computedModelMatrix,e,i,!0);t.showSectorSegmentLines&&G(t,t._sectorSegmentLineCommand,void 0,t._frontFaceRS,t._backFaceRS,t._sp,t._sectorSegmentLineVA,t._uniforms,t._computedModelMatrix,e,i,!0);t.showDomeSurfaces&&G(t,t._domeFrontCommand,t._domeBackCommand,t._frontFaceRS,t._backFaceRS,t._sp,t._domeVA,t._uniforms,t._computedModelMatrix,e,i);t.showDomeLines&&G(t,t._domeLineCommand,void 0,t._frontFaceRS,t._backFaceRS,t._sp,t._domeLineVA,t._uniforms,t._computedModelMatrix,e,i,!0);t.showScanPlane&&G(t,t._scanPlaneFrontCommand,t._scanPlaneBackCommand,t._frontFaceRS,t._backFaceRS,t._scanePlaneSP,t._scanPlaneVA,t._scanUniforms,t._computedScanPlaneModelMatrix,e,i)}(this,M);var tt=t.commandList,et=t.passes,it=this._colorCommands;if(et.render)for(var nt=0,rt=it.length;nt<rt;nt++){var ot=it[nt];tt.push(ot)}}}},N.prototype.isDestroyed=function(){return!1},N.prototype.destroy=function(){return this._sp=this._sp&&this._sp.destroy(),this._pickSP=this._pickSP&&this._pickSP.destroy(),this._pickId=this._pickId&&this._pickId.destroy(),d(this)};var H=new T,k=new A;function V(t,e,i){for(var n=t.slice,r=U(i),o=D(i),s=U(e),a=D(e),l=Q(s*o),c=Q(r*a),u=[],h=0;h<n;h++){var p=2*l*h/(n-1)-l;u.push(new A(0,M(p),U(p)))}var d=[];for(h=0;h<n;h++){p=2*c*h/(n-1)-c;d.push(new A(M(p),0,U(p)))}return{zoy:u,zox:d}}function j(t,e){for(var i=e.length-1,n=new Float32Array(9*i),r=0,o=0;o<i;o++)n[r++]=0,n[r++]=0,n[r++]=0,n[r++]=e[o].x,n[r++]=e[o].y,n[r++]=e[o].z,n[r++]=e[o+1].x,n[r++]=e[o+1].y,n[r++]=e[o+1].z;var s=y.createVertexBuffer({context:t,typedArray:n,usage:v.STATIC_DRAW}),a=3*Float32Array.BYTES_PER_ELEMENT,A=[{index:R.position,vertexBuffer:s,componentsPerAttribute:3,componentDatatype:u.FLOAT,offsetInBytes:0,strideInBytes:a}];return new E({context:t,attributes:A})}function G(t,e,i,n,r,o,s,a,A,l,u,h){l&&i&&(i.vertexArray=s,i.renderState=r,i.shaderProgram=o,i.uniformMap=c(a,t._material._uniforms),i.uniformMap.u_normalDirection=function(){return-1},i.pass=u,i.modelMatrix=A,t._colorCommands.push(i)),e.vertexArray=s,e.renderState=n,e.shaderProgram=o,e.uniformMap=c(a,t._material._uniforms),h&&(e.uniformMap.u_type=function(){return 1}),e.pass=u,e.modelMatrix=A,t._colorCommands.push(e)}var K=n.defaultValue,z=n.defined,W=Object.defineProperties,q=n.DeveloperError,X=n.Event,Y=n.createMaterialPropertyDescriptor,J=n.createPropertyDescriptor;function Z(t){this._show=void 0,this._radius=void 0,this._xHalfAngle=void 0,this._yHalfAngle=void 0,this._lineColor=void 0,this._showSectorLines=void 0,this._showSectorSegmentLines=void 0,this._showLateralSurfaces=void 0,this._material=void 0,this._showDomeSurfaces=void 0,this._showDomeLines=void 0,this._showIntersection=void 0,this._intersectionColor=void 0,this._intersectionWidth=void 0,this._showThroughEllipsoid=void 0,this._gaze=void 0,this._showScanPlane=void 0,this._scanPlaneColor=void 0,this._scanPlaneMode=void 0,this._scanPlaneRate=void 0,this._definitionChanged=new X,this.merge(K(t,K.EMPTY_OBJECT))}W(Z.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:J("show"),radius:J("radius"),xHalfAngle:J("xHalfAngle"),yHalfAngle:J("yHalfAngle"),lineColor:J("lineColor"),showSectorLines:J("showSectorLines"),showSectorSegmentLines:J("showSectorSegmentLines"),showLateralSurfaces:J("showLateralSurfaces"),material:Y("material"),showDomeSurfaces:J("showDomeSurfaces"),showDomeLines:J("showDomeLines "),showIntersection:J("showIntersection"),intersectionColor:J("intersectionColor"),intersectionWidth:J("intersectionWidth"),showThroughEllipsoid:J("showThroughEllipsoid"),gaze:J("gaze"),showScanPlane:J("showScanPlane"),scanPlaneColor:J("scanPlaneColor"),scanPlaneMode:J("scanPlaneMode"),scanPlaneRate:J("scanPlaneRate")}),Z.prototype.clone=function(t){return z(t)||(t=new Z),t.show=this.show,t.radius=this.radius,t.xHalfAngle=this.xHalfAngle,t.yHalfAngle=this.yHalfAngle,t.lineColor=this.lineColor,t.showSectorLines=this.showSectorLines,t.showSectorSegmentLines=this.showSectorSegmentLines,t.showLateralSurfaces=this.showLateralSurfaces,t.material=this.material,t.showDomeSurfaces=this.showDomeSurfaces,t.showDomeLines=this.showDomeLines,t.showIntersection=this.showIntersection,t.intersectionColor=this.intersectionColor,t.intersectionWidth=this.intersectionWidth,t.showThroughEllipsoid=this.showThroughEllipsoid,t.gaze=this.gaze,t.showScanPlane=this.showScanPlane,t.scanPlaneColor=this.scanPlaneColor,t.scanPlaneMode=this.scanPlaneMode,t.scanPlaneRate=this.scanPlaneRate,t},Z.prototype.merge=function(t){if(!z(t))throw new q("source is required.");this.show=K(this.show,t.show),this.radius=K(this.radius,t.radius),this.xHalfAngle=K(this.xHalfAngle,t.xHalfAngle),this.yHalfAngle=K(this.yHalfAngle,t.yHalfAngle),this.lineColor=K(this.lineColor,t.lineColor),this.showSectorLines=K(this.showSectorLines,t.showSectorLines),this.showSectorSegmentLines=K(this.showSectorSegmentLines,t.showSectorSegmentLines),this.showLateralSurfaces=K(this.showLateralSurfaces,t.showLateralSurfaces),this.material=K(this.material,t.material),this.showDomeSurfaces=K(this.showDomeSurfaces,t.showDomeSurfaces),this.showDomeLines=K(this.showDomeLines,t.showDomeLines),this.showIntersection=K(this.showIntersection,t.showIntersection),this.intersectionColor=K(this.intersectionColor,t.intersectionColor),this.intersectionWidth=K(this.intersectionWidth,t.intersectionWidth),this.showThroughEllipsoid=K(this.showThroughEllipsoid,t.showThroughEllipsoid),this.gaze=K(this.gaze,t.gaze),this.showScanPlane=K(this.showScanPlane,t.showScanPlane),this.scanPlaneColor=K(this.scanPlaneColor,t.scanPlaneColor),this.scanPlaneMode=K(this.scanPlaneMode,t.scanPlaneMode),this.scanPlaneRate=K(this.scanPlaneRate,t.scanPlaneRate)};var $=n.defined;function tt(t,e,i){var n=e[t.id];if($(n)){var r=n.primitive;i.remove(r),r.isDestroyed()||r.destroy(),delete e[t.id]}}var et=n.AssociativeArray,it=n.Cartesian3,nt=n.Color,rt=n.defined,ot=n.destroyObject,st=n.DeveloperError,at=n.Matrix3,At=n.Matrix4,lt=n.Quaternion,ct=n.MaterialProperty,ut=n.Property,ht=new at,pt=(new At,new it),dt=new it,ft=new lt,gt=new it,mt=new lt,yt=function(t,e){if(!rt(t))throw new st("scene is required.");if(!rt(e))throw new st("entityCollection is required.");e.collectionChanged.addEventListener(yt.prototype._onCollectionChanged,this),this._scene=t,this._primitives=t.primitives,this._entityCollection=e,this._hash={},this._entitiesToVisualize=new et,this._onCollectionChanged(e,e.values,[],[])};yt.prototype.update=function(t){if(!rt(t))throw new st("time is required.");for(var e=this._entitiesToVisualize.values,i=this._hash,r=this._primitives,o=0,s=e.length;o<s;o++){var a,A,l,c,u=e[o],h=u._rectangularSensor,p=i[u.id],d=u.isShowing&&u.isAvailable(t)&&ut.getValueOrDefault(h._show,t,!0);if(d&&(a=ut.getValueOrUndefined(u._position,t,pt),w=ut.getValueOrUndefined(u._orientation,t,ft),A=ut.getValueOrUndefined(h._radius,t),l=ut.getValueOrUndefined(h._xHalfAngle,t),c=ut.getValueOrUndefined(h._yHalfAngle,t),d=rt(a)&&rt(l)&&rt(c)),d){var f=rt(p)?p.primitive:void 0;rt(f)||((f=new N).id=u,r.add(f),p={primitive:f,position:void 0,orientation:void 0},i[u.id]=p);var g=ut.getValueOrUndefined(h._gaze,t);if(rt(g)){var m=ut.getValueOrUndefined(g._position,t,dt);if(!rt(a)||!rt(m))continue;var y=it.subtract(a,m,gt),v=it.angleBetween(n.Cartesian3.UNIT_Z,y),_=it.cross(n.Cartesian3.UNIT_Z,y,gt),w=lt.fromAxisAngle(_,v-Math.PI,mt);A=it.distance(a,m),f.modelMatrix=At.fromRotationTranslation(at.fromQuaternion(w,ht),a,f.modelMatrix)}else it.equals(a,p.position)&&lt.equals(w,p.orientation)||(rt(w)?(f.modelMatrix=At.fromRotationTranslation(at.fromQuaternion(w,ht),a,f.modelMatrix),p.position=it.clone(a,p.position),p.orientation=lt.clone(w,p.orientation)):(f.modelMatrix=n.Transforms.eastNorthUpToFixedFrame(a),p.position=it.clone(a,p.position)));f.show=!0,f.gaze=g,f.radius=A,f.xHalfAngle=l,f.yHalfAngle=c,f.lineColor=ut.getValueOrDefault(h._lineColor,t,nt.WHITE),f.showSectorLines=ut.getValueOrDefault(h._showSectorLines,t,!0),f.showSectorSegmentLines=ut.getValueOrDefault(h._showSectorSegmentLines,t,!0),f.showLateralSurfaces=ut.getValueOrDefault(h._showLateralSurfaces,t,!0),f.material=ct.getValue(t,h._material,f.material),f.showDomeSurfaces=ut.getValueOrDefault(h._showDomeSurfaces,t,!0),f.showDomeLines=ut.getValueOrDefault(h._showDomeLines,t,!0),f.showIntersection=ut.getValueOrDefault(h._showIntersection,t,!0),f.intersectionColor=ut.getValueOrDefault(h._intersectionColor,t,nt.WHITE),f.intersectionWidth=ut.getValueOrDefault(h._intersectionWidth,t,1),f.showThroughEllipsoid=ut.getValueOrDefault(h._showThroughEllipsoid,t,!0),f.scanPlaneMode=ut.getValueOrDefault(h._scanPlaneMode,t),f.scanPlaneColor=ut.getValueOrDefault(h._scanPlaneColor,t,nt.WHITE),f.showScanPlane=ut.getValueOrDefault(h._showScanPlane,t,!0),f.scanPlaneRate=ut.getValueOrDefault(h._scanPlaneRate,t,1)}else rt(p)&&(p.primitive.show=!1)}return!0},yt.prototype.isDestroyed=function(){return!1},yt.prototype.destroy=function(){for(var t=this._entitiesToVisualize.values,e=this._hash,i=this._primitives,n=t.length-1;n>-1;n--)tt(t[n],e,i);return ot(this)},yt.prototype._onCollectionChanged=function(t,e,i,n){var r,o,s=this._entitiesToVisualize,a=this._hash,A=this._primitives;for(r=e.length-1;r>-1;r--)o=e[r],rt(o._rectangularSensor)&&rt(o._position)&&s.set(o.id,o);for(r=n.length-1;r>-1;r--)o=n[r],rt(o._rectangularSensor)&&rt(o._position)?s.set(o.id,o):(tt(o,a,A),s.remove(o.id));for(r=i.length-1;r>-1;r--)tt(o=i[r],a,A),s.remove(o.id)};var vt=n.BoundingSphere,_t=n.Cartesian3,wt=n.Check,Ct=n.ComponentDatatype,Bt=n.defaultValue,bt=(n.defined,n.Geometry),Et=n.GeometryAttribute,St=n.GeometryAttributes,xt=n.PrimitiveType,It=n.VertexFormat,Ft=n.Math,Ot=n.GeometryPipeline,Pt=n.IndexDatatype,Tt=(n.Ellipsoid,Math.cos),Lt=Math.sin;function Mt(t){var e=(t=Bt(t,Bt.EMPTY_OBJECT)).angle,i=t.radius,n=Math.round(Bt(t.stackPartitions,12)),r=Math.round(Bt(t.slicePartitions,64));wt.typeOf.number("angle",e),wt.typeOf.number("radius",i);var o=Bt(t.vertexFormat,It.DEFAULT);this._angle=e,this._radius=i,this._stackPartitions=n,this._slicePartitions=r,this._vertexFormat=o}Mt.fromDimensions=function(t){var e=(t=Bt(t,Bt.EMPTY_OBJECT)).angle,i=t.radius,n=t.stackPartitions,r=t.slicePartitions;return wt.typeOf.number("angle",e),wt.typeOf.number("radius",i),wt.typeOf.number.greaterThanOrEquals("angle",e,0),wt.typeOf.number.greaterThanOrEquals("height",height,0),new Mt({angle:e,radius:i,stackPartitions:n,slicePartitions:r,vertexFormat:t.vertexFormat})},Mt.createGeometry=function(t){console.time("createGeometry");var e,i=t._angle,n=t._radius,r=t._stackPartitions+1,o=t._slicePartitions+1,s=t._vertexFormat,a=new St,A=3*(o-1)+6*(o-1)*(r-2)+1*(o-1)*3,l=r*o,c=Pt.createTypedArray(l,A),u=new Float64Array(3*l+3*(o-1)*3);if(s.position){for(var h=0,p=new Array(o),d=new Array(o),f=0;f<o;f++){var g=Ft.TWO_PI*f/(o-1);p[f]=Tt(g),d[f]=Lt(g),u[h++]=0,u[h++]=0,u[h++]=-n}for(f=1;f<r;f++)for(var m=i*f/(r-1),y=Lt(m),v=n*y,_=n*y,w=n*Tt(m),C=0;C<o;C++)u[h++]=p[C]*v,u[h++]=d[C]*_,u[h++]=-w;e=h;for(f=0;f<o-1;f++)u[h++]=0,u[h++]=0,u[h++]=0,u[h++]=u[e-3*(o-f-1)],u[h++]=u[e-3*(o-f-1)+1],u[h++]=u[e-3*(o-f-1)+2],u[h++]=u[e-3*(o-f)],u[h++]=u[e-3*(o-f)+1],u[h++]=u[e-3*(o-f)+2];a.position=new Et({componentDatatype:Ct.DOUBLE,componentsPerAttribute:3,values:u})}var B,b,E=0;for(C=0;C<o-1;C++)c[E++]=o+C,c[E++]=o+C+1,c[E++]=C+1;for(f=1;f<r-1;f++)for(B=f*o,b=(f+1)*o,C=0;C<o-1;C++)c[E++]=b+C,c[E++]=b+C+1,c[E++]=B+C+1,c[E++]=b+C,c[E++]=B+C+1,c[E++]=B+C;f=0;for(var S=3*(o-1);f<S;f++)c[E++]=f+e/3;var x=new bt({attributes:a,indices:c,primitiveType:xt.TRIANGLES,boundingSphere:new vt(_t.ZERO,n)});return x=Ot.computeNormal(x),console.timeEnd("createGeometry"),x};var Ut=n.BoundingSphere,Dt=n.Cartesian3,Qt=n.ComponentDatatype,Rt=n.defaultValue,Nt=(n.defined,n.DeveloperError),Ht=(n.Ellipsoid,n.Geometry),kt=n.GeometryAttribute,Vt=n.GeometryAttributes,jt=n.IndexDatatype,Gt=n.Math,Kt=n.PrimitiveType,zt=(new Dt(1,1,1),Math.cos),Wt=Math.sin;function qt(t){var e=(t=Rt(t,Rt.EMPTY_OBJECT)).angle,i=t.radius,n=Math.round(Rt(t.stackPartitions,10)),r=Math.round(Rt(t.slicePartitions,8)),o=Math.round(Rt(t.subdivisions,128));if(n<1)throw new Nt("options.stackPartitions cannot be less than 1");if(r<0)throw new Nt("options.slicePartitions cannot be less than 0");if(o<0)throw new Nt("options.subdivisions must be greater than or equal to zero.");this._angle=e,this._radius=i,this._stackPartitions=n,this._slicePartitions=r,this._subdivisions=o}qt.createGeometry=function(t){var e=t._angle,i=t._radius;if(!(i<=0||e<=0)){var n,r,o,s,a,A,l=t._stackPartitions,c=t._slicePartitions,u=t._subdivisions,h=u*(l+c-1),p=h-c+2,d=new Float64Array(3*p),f=jt.createTypedArray(p,2*h),g=0,m=new Array(u),y=new Array(u);for(n=0;n<u;n++)o=Gt.TWO_PI*n/u,m[n]=zt(o),y[n]=Wt(o);for(n=1;n<l;n++)for(a=zt(s=e*n/(l-1)),A=Wt(s),r=0;r<u;r++)d[g++]=i*m[r]*A,d[g++]=i*y[r]*A,d[g++]=-i*a;for(m.length=c,y.length=c,n=0;n<c;n++)o=Gt.TWO_PI*n/c,m[n]=zt(o),y[n]=Wt(o);for(d[g++]=0,d[g++]=0,d[g++]=-i,n=1;n<u;n++)for(a=zt(s=e*n/u),A=Wt(s),r=0;r<c;r++)d[g++]=i*m[r]*A,d[g++]=i*y[r]*A,d[g++]=-i*a;for(g=0,n=0;n<l-1;++n){var v=n*u;for(r=0;r<u-1;++r)f[g++]=v+r,f[g++]=v+r+1;f[g++]=v+u-1,f[g++]=v}var _=u*(l-1);for(r=1;r<c+1;++r)f[g++]=_,f[g++]=_+r;for(n=0;n<u-2;++n){var w=n*c+1+_,C=(n+1)*c+1+_;for(r=0;r<c-1;++r)f[g++]=C+r,f[g++]=w+r;f[g++]=C+c-1,f[g++]=w+c-1}var B=new Vt({position:new kt({componentDatatype:Qt.DOUBLE,componentsPerAttribute:3,values:d})});return new Ht({attributes:B,indices:f,primitiveType:Kt.LINES,boundingSphere:new Ut(Dt.ZERO,i)})}};var Xt=n.defaultValue,Yt=n.defined,Jt=Object.defineProperties,Zt=n.DeveloperError,$t=n.Event,te=n.createMaterialPropertyDescriptor,ee=n.createPropertyDescriptor;function ie(t){this._angle=void 0,this._angleSubscription=void 0,this._radius=void 0,this._radiusSubscription=void 0,this._stack=void 0,this._stackSubscription=void 0,this._slice=void 0,this._sliceSubscription=void 0,this._color=void 0,this._colorSubscription=void 0,this._show=void 0,this._showSubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._color=void 0,this._colorSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._definitionChanged=new $t,this._gaze=void 0,this._gazeSubscription=void 0,this.merge(Xt(t,Xt.EMPTY_OBJECT))}Jt(ie.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:ee("show"),material:te("material"),fill:ee("fill"),shadows:ee("shadows"),distanceDisplayCondition:ee("distanceDisplayCondition")}),ie.prototype.clone=function(t){return Yt(t)?(t.angle=this.angle,t.radius=this.radius,t.stack=this.stack,t.slice=this.slice,t.show=this.show,t.material=this.material,t.color=this.color,t.fill=this.fill,t.outline=this.outline,t.outlineColor=this.outlineColor,t.outlineWidth=this.outlineWidth,t.shadows=this.shadows,t.distanceDisplayCondition=this.distanceDisplayCondition,t.gaze=this.gaze,t):new ie(this)},ie.prototype.merge=function(t){if(!Yt(t))throw new Zt("source is required.");this.angle=Xt(this.angle,t.angle),this.radius=Xt(this.radius,t.radius),this.stack=Xt(this.stack,t.stack),this.slice=Xt(this.slice,t.slice),this.show=Xt(this.show,t.show),this.color=Xt(this.color,t.color),this.material=Xt(this.material,t.material),this.fill=Xt(this.fill,t.fill),this.outline=Xt(this.outline,t.outline),this.outlineColor=Xt(this.outlineColor,t.outlineColor),this.outlineWidth=Xt(this.outlineWidth,t.outlineWidth),this.shadows=Xt(this.shadows,t.shadows),this.distanceDisplayCondition=Xt(this.distanceDisplayCondition,t.distanceDisplayCondition),this.gaze=Xt(this.gaze,t.gaze)};var ne,re=n.Entity,oe=n.Event,se=n.ConstantPositionProperty,ae=n.createPropertyDescriptor,Ae=n.DistanceDisplayCondition;n.DistanceDisplayConditionGeometryInstanceAttribute;function le(t){return new se(t)}function ce(t){t=t||{},this._position=void 0,this._orientation=void 0,this._show=void 0;var e=t.conicArcSensor;e instanceof ie||(e=new ie(e)),this._conicArcSensor=e,this._distanceDisplayCondition=new Ae,this._geometry=void 0,this._outlineGeometry=void 0,this._definitionChanged=new oe,this.merge(t)}Object.defineProperties(ce.prototype,{position:(ne="position",ae(ne,void 0,le)),orientation:ae("orientation"),show:ae("show")}),ce.prototype.merge=function(t){this.position=t.position,this.orientation=t.orientation,this.show=t.show},ce.prototype.gazeAt=function(t){t instanceof re&&(this._conicArcSensor.gaze=t)};n.defaultValue;var ue=n.defined,he=(n.Viewer,n.Transforms),pe=n.DeveloperError,de=(n.ColorGeometryInstanceAttribute,n.Color),fe=n.Primitive,ge=n.PerInstanceColorAppearance,me=n.Cartesian3,ye=(n.VertexFormat,n.Quaternion),ve=n.Matrix3,_e=n.Matrix4,we=n.Property;n.Event,n.DistanceDisplayCondition,n.DistanceDisplayConditionGeometryInstanceAttribute;function Ce(t){var e=this;if(!ue(t))throw new pe("viewer is required.");this._viewer=t;var i=t.scene;this._scene=i;var n=t.clock;this._clock=n,this._primitives=i.primitives,this._primitive=void 0,this._outlinePrimitive=void 0,this._conicArcSensorCollection=[],n.onTick.addEventListener((function(){e.update()}))}var Be=new ve,be=new _e,Ee=new me,Se=new me,xe=new me,Ie=new ye;Ce.prototype.add=function(t){return t instanceof ce||(t=new ce(t)),this._conicArcSensorCollection.push(t),t},Ce.prototype.remove=function(t){var e=this._conicArcSensorCollection.indexOf(t);-1!==e&&this._conicArcSensorCollection.splice(e,1)},Ce.prototype.removeAll=function(){this._conicArcSensorCollection.length=0},Ce.prototype.update=function(){var t=this._clock.currentTime,e=this._conicArcSensorCollection,i=this._primitives,r=this._primitive,o=this._outlinePrimitive,s=[],a=[];ue(r)&&i.removeAndDestroy(r),ue(o)&&i.removeAndDestroy(o);for(var A=0,l=e.length;A<l;A++){var c=e[A],u=c._conicArcSensor;if(we.getValueOrDefault(u.show,t,!0)){var h=u.angle,p=u.radius,d=u.stack,f=u.slice;if(ue(h))if(we.getValueOrDefault(c.show,t,!0)){var g=we.getValueOrUndefined(c.position,t,Ee);if(ue(g)){var m,y=u.gaze;if(ue(y)){var v=we.getValueOrUndefined(y.position,t,Se);if(!ue(g)||!ue(v))continue;var _=me.subtract(g,v,xe),w=me.angleBetween(n.Cartesian3.UNIT_Z,_),C=me.cross(n.Cartesian3.UNIT_Z,_,xe),B=ye.fromAxisAngle(C,w,Ie),b=me.distance(g,v);p=1,m=_e.fromRotationTranslation(n.Matrix3.multiplyByScalar(ve.fromQuaternion(B,Be),b,Be),g,be)}else{B=we.getValueOrUndefined(c.orientation,t,Ie);m=ue(B)?_e.fromRotationTranslation(ve.fromQuaternion(B,Be),g,be):he.eastNorthUpToFixedFrame(g,void 0,be)}if(ue(m)){var E,S=c._geometry;if(!ue(S))E=new Mt({vertexFormat:n.VertexFormat.POSITION_AND_NORMAL,angle:h,radius:p,stackPartitions:d,slicePartitions:f}),c._geometry=Mt.createGeometry(E),S=c._geometry;var x=u.color,I=u.outline,F=u.outlineWidth;ue(F)||(F=1);var O=u.outlineColor;ue(O)||(O=de.WHITE);var P=new n.GeometryInstance({geometry:S,modelMatrix:m,attributes:{color:n.ColorGeometryInstanceAttribute.fromColor(x)}});if(s.push(P),I){var T,L=c._outlineGeometry;if(!ue(L))T=new qt({vertexFormat:n.VertexFormat.POSITION_ONLY,angle:h,radius:p}),c._outlineGeometry=qt.createGeometry(T),L=c._outlineGeometry;P=new n.GeometryInstance({geometry:L,modelMatrix:m,attributes:{color:n.ColorGeometryInstanceAttribute.fromColor(O)}});a.push(P)}}}}}}s.length>0&&(this._primitive=this._primitives.add(new fe({asynchronous:!1,geometryInstances:s,appearance:new ge({flat:!1,translucent:!0,closed:!0})}))),a.length>0&&(this._outlinePrimitive=this._primitives.add(new fe({asynchronous:!1,geometryInstances:a,appearance:new ge({flat:!0,translucent:!0,renderState:{lineWidth:this._scene.clampLineWidth(F)}})})))},n.RectangularSensorPrimitive=N,n.RectangularSensorGraphics=Z,n.RectangularSensorVisualizer=yt,n.ConicArcSensorGeometry=Mt,n.ConicArcSensorOutlineGeometry=qt,n.ConicArcSensorGraphics=ie,n.ConicArcSensorCollection=Ce;var Fe=n.DataSourceDisplay,Oe=Fe.defaultVisualizersCallback;Fe.defaultVisualizersCallback=function(t,e,i){var n=i.entities;return Oe(t,e,i).concat([new yt(t,n)])}}]).default}));