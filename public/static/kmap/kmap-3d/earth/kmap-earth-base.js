/**
 * @license
 * Cesium - https://github.com/CesiumGS/cesium
 * Version 1.99
 *
 * Copyright 2011-2022 Cesium Contributors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * Columbus View (Pat. Pend.)
 *
 * Portions licensed separately.
 * See https://github.com/CesiumGS/cesium/blob/main/LICENSE.md for full licensing details.
 */

window.KMapEarthBase=(()=>{var Tye=Object.create;var mP=Object.defineProperty;var Eye=Object.getOwnPropertyDescriptor;var bye=Object.getOwnPropertyNames;var Sye=Object.getPrototypeOf,wye=Object.prototype.hasOwnProperty;var vp=(t=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(t,{get:(n,i)=>(typeof require!="undefined"?require:n)[i]}):t)(function(t){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+t+'" is not supported')});var Za=(t,n)=>()=>(n||t((n={exports:{}}).exports,n),n.exports),Dye=(t,n)=>{for(var i in n)mP(t,i,{get:n[i],enumerable:!0})},yY=(t,n,i,o)=>{if(n&&typeof n=="object"||typeof n=="function")for(let r of bye(n))!wye.call(t,r)&&r!==i&&mP(t,r,{get:()=>n[r],enumerable:!(o=Eye(n,r))||o.enumerable});return t};var yo=(t,n,i)=>(i=t!=null?Tye(Sye(t)):{},yY(n||!t||!t.__esModule?mP(i,"default",{value:t,enumerable:!0}):i,t)),vye=t=>yY(mP({},"__esModule",{value:!0}),t);var pP=Za((Apt,CY)=>{var tm=function(t){t==null&&(t=new Date().getTime()),this.N=624,this.M=397,this.MATRIX_A=2567483615,this.UPPER_MASK=2147483648,this.LOWER_MASK=2147483647,this.mt=new Array(this.N),this.mti=this.N+1,t.constructor==Array?this.init_by_array(t,t.length):this.init_seed(t)};tm.prototype.init_seed=function(t){for(this.mt[0]=t>>>0,this.mti=1;this.mti<this.N;this.mti++){var t=this.mt[this.mti-1]^this.mt[this.mti-1]>>>30;this.mt[this.mti]=(((t&4294901760)>>>16)*1812433253<<16)+(t&65535)*1812433253+this.mti,this.mt[this.mti]>>>=0}};tm.prototype.init_by_array=function(t,n){var i,o,r;for(this.init_seed(19650218),i=1,o=0,r=this.N>n?this.N:n;r;r--){var s=this.mt[i-1]^this.mt[i-1]>>>30;this.mt[i]=(this.mt[i]^(((s&4294901760)>>>16)*1664525<<16)+(s&65535)*1664525)+t[o]+o,this.mt[i]>>>=0,i++,o++,i>=this.N&&(this.mt[0]=this.mt[this.N-1],i=1),o>=n&&(o=0)}for(r=this.N-1;r;r--){var s=this.mt[i-1]^this.mt[i-1]>>>30;this.mt[i]=(this.mt[i]^(((s&4294901760)>>>16)*1566083941<<16)+(s&65535)*1566083941)-i,this.mt[i]>>>=0,i++,i>=this.N&&(this.mt[0]=this.mt[this.N-1],i=1)}this.mt[0]=2147483648};tm.prototype.random_int=function(){var t,n=new Array(0,this.MATRIX_A);if(this.mti>=this.N){var i;for(this.mti==this.N+1&&this.init_seed(5489),i=0;i<this.N-this.M;i++)t=this.mt[i]&this.UPPER_MASK|this.mt[i+1]&this.LOWER_MASK,this.mt[i]=this.mt[i+this.M]^t>>>1^n[t&1];for(;i<this.N-1;i++)t=this.mt[i]&this.UPPER_MASK|this.mt[i+1]&this.LOWER_MASK,this.mt[i]=this.mt[i+(this.M-this.N)]^t>>>1^n[t&1];t=this.mt[this.N-1]&this.UPPER_MASK|this.mt[0]&this.LOWER_MASK,this.mt[this.N-1]=this.mt[this.M-1]^t>>>1^n[t&1],this.mti=0}return t=this.mt[this.mti++],t^=t>>>11,t^=t<<7&2636928640,t^=t<<15&4022730752,t^=t>>>18,t>>>0};tm.prototype.random_int31=function(){return this.random_int()>>>1};tm.prototype.random_incl=function(){return this.random_int()*(1/4294967295)};tm.prototype.random=function(){return this.random_int()*(1/4294967296)};tm.prototype.random_excl=function(){return(this.random_int()+.5)*(1/4294967296)};tm.prototype.random_long=function(){var t=this.random_int()>>>5,n=this.random_int()>>>6;return(t*67108864+n)*(1/9007199254740992)};CY.exports=tm});var tX=Za((tC,nC)=>{/*! https://mths.be/punycode v1.4.0 by @mathias */(function(t){var n=typeof tC=="object"&&tC&&!tC.nodeType&&tC,i=typeof nC=="object"&&nC&&!nC.nodeType&&nC,o=typeof global=="object"&&global;(o.global===o||o.window===o||o.self===o)&&(t=o);var r,s=2147483647,a=36,c=1,l=26,u=38,d=700,h=72,_=128,y="-",p=/^xn--/,C=/[^\x20-\x7E]/,x=/[\x2E\u3002\uFF0E\uFF61]/g,T={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},E=a-c,S=Math.floor,w=String.fromCharCode,D;function I(U){throw new RangeError(T[U])}function O(U,G){for(var k=U.length,X=[];k--;)X[k]=G(U[k]);return X}function M(U,G){var k=U.split("@"),X="";k.length>1&&(X=k[0]+"@",U=k[1]),U=U.replace(x,".");var Y=U.split("."),K=O(Y,G).join(".");return X+K}function L(U){for(var G=[],k=0,X=U.length,Y,K;k<X;)Y=U.charCodeAt(k++),Y>=55296&&Y<=56319&&k<X?(K=U.charCodeAt(k++),(K&64512)==56320?G.push(((Y&1023)<<10)+(K&1023)+65536):(G.push(Y),k--)):G.push(Y);return G}function F(U){return O(U,function(G){var k="";return G>65535&&(G-=65536,k+=w(G>>>10&1023|55296),G=56320|G&1023),k+=w(G),k}).join("")}function g(U){return U-48<10?U-22:U-65<26?U-65:U-97<26?U-97:a}function b(U,G){return U+22+75*(U<26)-((G!=0)<<5)}function v(U,G,k){var X=0;for(U=k?S(U/d):U>>1,U+=S(U/G);U>E*l>>1;X+=a)U=S(U/E);return S(X+(E+1)*U/(U+u))}function P(U){var G=[],k=U.length,X,Y=0,K=_,j=h,Z,Q,me,_e,re,fe,ge,be,Be;for(Z=U.lastIndexOf(y),Z<0&&(Z=0),Q=0;Q<Z;++Q)U.charCodeAt(Q)>=128&&I("not-basic"),G.push(U.charCodeAt(Q));for(me=Z>0?Z+1:0;me<k;){for(_e=Y,re=1,fe=a;me>=k&&I("invalid-input"),ge=g(U.charCodeAt(me++)),(ge>=a||ge>S((s-Y)/re))&&I("overflow"),Y+=ge*re,be=fe<=j?c:fe>=j+l?l:fe-j,!(ge<be);fe+=a)Be=a-be,re>S(s/Be)&&I("overflow"),re*=Be;X=G.length+1,j=v(Y-_e,X,_e==0),S(Y/X)>s-K&&I("overflow"),K+=S(Y/X),Y%=X,G.splice(Y++,0,K)}return F(G)}function R(U){var G,k,X,Y,K,j,Z,Q,me,_e,re,fe=[],ge,be,Be,ke;for(U=L(U),ge=U.length,G=_,k=0,K=h,j=0;j<ge;++j)re=U[j],re<128&&fe.push(w(re));for(X=Y=fe.length,Y&&fe.push(y);X<ge;){for(Z=s,j=0;j<ge;++j)re=U[j],re>=G&&re<Z&&(Z=re);for(be=X+1,Z-G>S((s-k)/be)&&I("overflow"),k+=(Z-G)*be,G=Z,j=0;j<ge;++j)if(re=U[j],re<G&&++k>s&&I("overflow"),re==G){for(Q=k,me=a;_e=me<=K?c:me>=K+l?l:me-K,!(Q<_e);me+=a)ke=Q-_e,Be=a-_e,fe.push(w(b(_e+ke%Be,0))),Q=S(ke/Be);fe.push(w(b(Q,0))),K=v(k,be,X==Y),k=0,++X}++k,++G}return fe.join("")}function V(U){return M(U,function(G){return p.test(G)?P(G.slice(4).toLowerCase()):G})}function H(U){return M(U,function(G){return C.test(G)?"xn--"+R(G):G})}if(r={version:"1.3.2",ucs2:{decode:L,encode:F},decode:P,encode:R,toASCII:H,toUnicode:V},typeof define=="function"&&typeof define.amd=="object"&&define.amd)define("punycode",function(){return r});else if(n&&i)if(nC.exports==n)i.exports=r;else for(D in r)r.hasOwnProperty(D)&&(n[D]=r[D]);else t.punycode=r})(tC)});var iX=Za((nX,NP)=>{/*!
 * URI.js - Mutating URLs
 * IPv6 Support
 *
 * Version: 1.19.11
 *
 * Author: Rodney Rehm
 * Web: http://medialize.github.io/URI.js/
 *
 * Licensed under
 *   MIT License http://www.opensource.org/licenses/mit-license
 *
 */(function(t,n){"use strict";typeof NP=="object"&&NP.exports?NP.exports=n():typeof define=="function"&&define.amd?define(n):t.IPv6=n(t)})(nX,function(t){"use strict";var n=t&&t.IPv6;function i(r){var s=r.toLowerCase(),a=s.split(":"),c=a.length,l=8;a[0]===""&&a[1]===""&&a[2]===""?(a.shift(),a.shift()):a[0]===""&&a[1]===""?a.shift():a[c-1]===""&&a[c-2]===""&&a.pop(),c=a.length,a[c-1].indexOf(".")!==-1&&(l=7);var u;for(u=0;u<c&&a[u]!=="";u++);if(u<l)for(a.splice(u,1,"0000");a.length<l;)a.splice(u,0,"0000");for(var d,h=0;h<l;h++){d=a[h].split("");for(var _=0;_<3&&(d[0]==="0"&&d.length>1);_++)d.splice(0,1);a[h]=d.join("")}var y=-1,p=0,C=0,x=-1,T=!1;for(h=0;h<l;h++)T?a[h]==="0"?C+=1:(T=!1,C>p&&(y=x,p=C)):a[h]==="0"&&(T=!0,x=h,C=1);C>p&&(y=x,p=C),p>1&&a.splice(y,p,""),c=a.length;var E="";for(a[0]===""&&(E=":"),h=0;h<c&&(E+=a[h],h!==c-1);h++)E+=":";return a[c-1]===""&&(E+=":"),E}function o(){return t.IPv6===this&&(t.IPv6=n),this}return{best:i,noConflict:o}})});var rX=Za((oX,VP)=>{/*!
 * URI.js - Mutating URLs
 * Second Level Domain (SLD) Support
 *
 * Version: 1.19.11
 *
 * Author: Rodney Rehm
 * Web: http://medialize.github.io/URI.js/
 *
 * Licensed under
 *   MIT License http://www.opensource.org/licenses/mit-license
 *
 */(function(t,n){"use strict";typeof VP=="object"&&VP.exports?VP.exports=n():typeof define=="function"&&define.amd?define(n):t.SecondLevelDomains=n(t)})(oX,function(t){"use strict";var n=t&&t.SecondLevelDomains,i={list:{ac:" com gov mil net org ",ae:" ac co gov mil name net org pro sch ",af:" com edu gov net org ",al:" com edu gov mil net org ",ao:" co ed gv it og pb ",ar:" com edu gob gov int mil net org tur ",at:" ac co gv or ",au:" asn com csiro edu gov id net org ",ba:" co com edu gov mil net org rs unbi unmo unsa untz unze ",bb:" biz co com edu gov info net org store tv ",bh:" biz cc com edu gov info net org ",bn:" com edu gov net org ",bo:" com edu gob gov int mil net org tv ",br:" adm adv agr am arq art ato b bio blog bmd cim cng cnt com coop ecn edu eng esp etc eti far flog fm fnd fot fst g12 ggf gov imb ind inf jor jus lel mat med mil mus net nom not ntr odo org ppg pro psc psi qsl rec slg srv tmp trd tur tv vet vlog wiki zlg ",bs:" com edu gov net org ",bz:" du et om ov rg ",ca:" ab bc mb nb nf nl ns nt nu on pe qc sk yk ",ck:" biz co edu gen gov info net org ",cn:" ac ah bj com cq edu fj gd gov gs gx gz ha hb he hi hl hn jl js jx ln mil net nm nx org qh sc sd sh sn sx tj tw xj xz yn zj ",co:" com edu gov mil net nom org ",cr:" ac c co ed fi go or sa ",cy:" ac biz com ekloges gov ltd name net org parliament press pro tm ",do:" art com edu gob gov mil net org sld web ",dz:" art asso com edu gov net org pol ",ec:" com edu fin gov info med mil net org pro ",eg:" com edu eun gov mil name net org sci ",er:" com edu gov ind mil net org rochest w ",es:" com edu gob nom org ",et:" biz com edu gov info name net org ",fj:" ac biz com info mil name net org pro ",fk:" ac co gov net nom org ",fr:" asso com f gouv nom prd presse tm ",gg:" co net org ",gh:" com edu gov mil org ",gn:" ac com gov net org ",gr:" com edu gov mil net org ",gt:" com edu gob ind mil net org ",gu:" com edu gov net org ",hk:" com edu gov idv net org ",hu:" 2000 agrar bolt casino city co erotica erotika film forum games hotel info ingatlan jogasz konyvelo lakas media news org priv reklam sex shop sport suli szex tm tozsde utazas video ",id:" ac co go mil net or sch web ",il:" ac co gov idf k12 muni net org ",in:" ac co edu ernet firm gen gov i ind mil net nic org res ",iq:" com edu gov i mil net org ",ir:" ac co dnssec gov i id net org sch ",it:" edu gov ",je:" co net org ",jo:" com edu gov mil name net org sch ",jp:" ac ad co ed go gr lg ne or ",ke:" ac co go info me mobi ne or sc ",kh:" com edu gov mil net org per ",ki:" biz com de edu gov info mob net org tel ",km:" asso com coop edu gouv k medecin mil nom notaires pharmaciens presse tm veterinaire ",kn:" edu gov net org ",kr:" ac busan chungbuk chungnam co daegu daejeon es gangwon go gwangju gyeongbuk gyeonggi gyeongnam hs incheon jeju jeonbuk jeonnam k kg mil ms ne or pe re sc seoul ulsan ",kw:" com edu gov net org ",ky:" com edu gov net org ",kz:" com edu gov mil net org ",lb:" com edu gov net org ",lk:" assn com edu gov grp hotel int ltd net ngo org sch soc web ",lr:" com edu gov net org ",lv:" asn com conf edu gov id mil net org ",ly:" com edu gov id med net org plc sch ",ma:" ac co gov m net org press ",mc:" asso tm ",me:" ac co edu gov its net org priv ",mg:" com edu gov mil nom org prd tm ",mk:" com edu gov inf name net org pro ",ml:" com edu gov net org presse ",mn:" edu gov org ",mo:" com edu gov net org ",mt:" com edu gov net org ",mv:" aero biz com coop edu gov info int mil museum name net org pro ",mw:" ac co com coop edu gov int museum net org ",mx:" com edu gob net org ",my:" com edu gov mil name net org sch ",nf:" arts com firm info net other per rec store web ",ng:" biz com edu gov mil mobi name net org sch ",ni:" ac co com edu gob mil net nom org ",np:" com edu gov mil net org ",nr:" biz com edu gov info net org ",om:" ac biz co com edu gov med mil museum net org pro sch ",pe:" com edu gob mil net nom org sld ",ph:" com edu gov i mil net ngo org ",pk:" biz com edu fam gob gok gon gop gos gov net org web ",pl:" art bialystok biz com edu gda gdansk gorzow gov info katowice krakow lodz lublin mil net ngo olsztyn org poznan pwr radom slupsk szczecin torun warszawa waw wroc wroclaw zgora ",pr:" ac biz com edu est gov info isla name net org pro prof ",ps:" com edu gov net org plo sec ",pw:" belau co ed go ne or ",ro:" arts com firm info nom nt org rec store tm www ",rs:" ac co edu gov in org ",sb:" com edu gov net org ",sc:" com edu gov net org ",sh:" co com edu gov net nom org ",sl:" com edu gov net org ",st:" co com consulado edu embaixada gov mil net org principe saotome store ",sv:" com edu gob org red ",sz:" ac co org ",tr:" av bbs bel biz com dr edu gen gov info k12 name net org pol tel tsk tv web ",tt:" aero biz cat co com coop edu gov info int jobs mil mobi museum name net org pro tel travel ",tw:" club com ebiz edu game gov idv mil net org ",mu:" ac co com gov net or org ",mz:" ac co edu gov org ",na:" co com ",nz:" ac co cri geek gen govt health iwi maori mil net org parliament school ",pa:" abo ac com edu gob ing med net nom org sld ",pt:" com edu gov int net nome org publ ",py:" com edu gov mil net org ",qa:" com edu gov mil net org ",re:" asso com nom ",ru:" ac adygeya altai amur arkhangelsk astrakhan bashkiria belgorod bir bryansk buryatia cbg chel chelyabinsk chita chukotka chuvashia com dagestan e-burg edu gov grozny int irkutsk ivanovo izhevsk jar joshkar-ola kalmykia kaluga kamchatka karelia kazan kchr kemerovo khabarovsk khakassia khv kirov koenig komi kostroma kranoyarsk kuban kurgan kursk lipetsk magadan mari mari-el marine mil mordovia mosreg msk murmansk nalchik net nnov nov novosibirsk nsk omsk orenburg org oryol penza perm pp pskov ptz rnd ryazan sakhalin samara saratov simbirsk smolensk spb stavropol stv surgut tambov tatarstan tom tomsk tsaritsyn tsk tula tuva tver tyumen udm udmurtia ulan-ude vladikavkaz vladimir vladivostok volgograd vologda voronezh vrn vyatka yakutia yamal yekaterinburg yuzhno-sakhalinsk ",rw:" ac co com edu gouv gov int mil net ",sa:" com edu gov med net org pub sch ",sd:" com edu gov info med net org tv ",se:" a ac b bd c d e f g h i k l m n o org p parti pp press r s t tm u w x y z ",sg:" com edu gov idn net org per ",sn:" art com edu gouv org perso univ ",sy:" com edu gov mil net news org ",th:" ac co go in mi net or ",tj:" ac biz co com edu go gov info int mil name net nic org test web ",tn:" agrinet com defense edunet ens fin gov ind info intl mincom nat net org perso rnrt rns rnu tourism ",tz:" ac co go ne or ",ua:" biz cherkassy chernigov chernovtsy ck cn co com crimea cv dn dnepropetrovsk donetsk dp edu gov if in ivano-frankivsk kh kharkov kherson khmelnitskiy kiev kirovograd km kr ks kv lg lugansk lutsk lviv me mk net nikolaev od odessa org pl poltava pp rovno rv sebastopol sumy te ternopil uzhgorod vinnica vn zaporizhzhe zhitomir zp zt ",ug:" ac co go ne or org sc ",uk:" ac bl british-library co cym gov govt icnet jet lea ltd me mil mod national-library-scotland nel net nhs nic nls org orgn parliament plc police sch scot soc ",us:" dni fed isa kids nsn ",uy:" com edu gub mil net org ",ve:" co com edu gob info mil net org web ",vi:" co com k12 net org ",vn:" ac biz com edu gov health info int name net org pro ",ye:" co com gov ltd me net org plc ",yu:" ac co edu gov org ",za:" ac agric alt bourse city co cybernet db edu gov grondar iaccess imt inca landesign law mil net ngo nis nom olivetti org pix school tm web ",zm:" ac co com edu gov net org sch ",com:"ar br cn de eu gb gr hu jpn kr no qc ru sa se uk us uy za ",net:"gb jp se uk ",org:"ae",de:"com "},has:function(o){var r=o.lastIndexOf(".");if(r<=0||r>=o.length-1)return!1;var s=o.lastIndexOf(".",r-1);if(s<=0||s>=r-1)return!1;var a=i.list[o.slice(r+1)];return a?a.indexOf(" "+o.slice(s+1,r)+" ")>=0:!1},is:function(o){var r=o.lastIndexOf(".");if(r<=0||r>=o.length-1)return!1;var s=o.lastIndexOf(".",r-1);if(s>=0)return!1;var a=i.list[o.slice(r+1)];return a?a.indexOf(" "+o.slice(0,r)+" ")>=0:!1},get:function(o){var r=o.lastIndexOf(".");if(r<=0||r>=o.length-1)return null;var s=o.lastIndexOf(".",r-1);if(s<=0||s>=r-1)return null;var a=i.list[o.slice(r+1)];return!a||a.indexOf(" "+o.slice(s+1,r)+" ")<0?null:o.slice(s+1)},noConflict:function(){return t.SecondLevelDomains===this&&(t.SecondLevelDomains=n),this}};return i})});var gl=Za((sX,kP)=>{/*!
 * URI.js - Mutating URLs
 *
 * Version: 1.19.11
 *
 * Author: Rodney Rehm
 * Web: http://medialize.github.io/URI.js/
 *
 * Licensed under
 *   MIT License http://www.opensource.org/licenses/mit-license
 *
 */(function(t,n){"use strict";typeof kP=="object"&&kP.exports?kP.exports=n(tX(),iX(),rX()):typeof define=="function"&&define.amd?define(["./punycode","./IPv6","./SecondLevelDomains"],n):t.URI=n(t.punycode,t.IPv6,t.SecondLevelDomains,t)})(sX,function(t,n,i,o){"use strict";var r=o&&o.URI;function s(b,v){var P=arguments.length>=1,R=arguments.length>=2;if(!(this instanceof s))return P?R?new s(b,v):new s(b):new s;if(b===void 0){if(P)throw new TypeError("undefined is not a valid argument for URI");typeof location!="undefined"?b=location.href+"":b=""}if(b===null&&P)throw new TypeError("null is not a valid argument for URI");return this.href(b),v!==void 0?this.absoluteTo(v):this}function a(b){return/^[0-9]+$/.test(b)}s.version="1.19.11";var c=s.prototype,l=Object.prototype.hasOwnProperty;function u(b){return b.replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")}function d(b){return b===void 0?"Undefined":String(Object.prototype.toString.call(b)).slice(8,-1)}function h(b){return d(b)==="Array"}function _(b,v){var P={},R,V;if(d(v)==="RegExp")P=null;else if(h(v))for(R=0,V=v.length;R<V;R++)P[v[R]]=!0;else P[v]=!0;for(R=0,V=b.length;R<V;R++){var H=P&&P[b[R]]!==void 0||!P&&v.test(b[R]);H&&(b.splice(R,1),V--,R--)}return b}function y(b,v){var P,R;if(h(v)){for(P=0,R=v.length;P<R;P++)if(!y(b,v[P]))return!1;return!0}var V=d(v);for(P=0,R=b.length;P<R;P++)if(V==="RegExp"){if(typeof b[P]=="string"&&b[P].match(v))return!0}else if(b[P]===v)return!0;return!1}function p(b,v){if(!h(b)||!h(v)||b.length!==v.length)return!1;b.sort(),v.sort();for(var P=0,R=b.length;P<R;P++)if(b[P]!==v[P])return!1;return!0}function C(b){var v=/^\/+|\/+$/g;return b.replace(v,"")}s._parts=function(){return{protocol:null,username:null,password:null,hostname:null,urn:null,port:null,path:null,query:null,fragment:null,preventInvalidHostname:s.preventInvalidHostname,duplicateQueryParameters:s.duplicateQueryParameters,escapeQuerySpace:s.escapeQuerySpace}},s.preventInvalidHostname=!1,s.duplicateQueryParameters=!1,s.escapeQuerySpace=!0,s.protocol_expression=/^[a-z][a-z0-9.+-]*$/i,s.idn_expression=/[^a-z0-9\._-]/i,s.punycode_expression=/(xn--)/i,s.ip4_expression=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,s.ip6_expression=/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/,s.find_uri_expression=/\b((?:[a-z][\w-]+:(?:\/{1,3}|[a-z0-9%])|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?«»“”‘’]))/ig,s.findUri={start:/\b(?:([a-z][a-z0-9.+-]*:\/\/)|www\.)/gi,end:/[\s\r\n]|$/,trim:/[`!()\[\]{};:'".,<>?«»“”„‘’]+$/,parens:/(\([^\)]*\)|\[[^\]]*\]|\{[^}]*\}|<[^>]*>)/g},s.leading_whitespace_expression=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,s.ascii_tab_whitespace=/[\u0009\u000A\u000D]+/g,s.defaultPorts={http:"80",https:"443",ftp:"21",gopher:"70",ws:"80",wss:"443"},s.hostProtocols=["http","https"],s.invalid_hostname_characters=/[^a-zA-Z0-9\.\-:_]/,s.domAttributes={a:"href",blockquote:"cite",link:"href",base:"href",script:"src",form:"action",img:"src",area:"href",iframe:"src",embed:"src",source:"src",track:"src",input:"src",audio:"src",video:"src"},s.getDomAttribute=function(b){if(!(!b||!b.nodeName)){var v=b.nodeName.toLowerCase();if(!(v==="input"&&b.type!=="image"))return s.domAttributes[v]}};function x(b){return escape(b)}function T(b){return encodeURIComponent(b).replace(/[!'()*]/g,x).replace(/\*/g,"%2A")}s.encode=T,s.decode=decodeURIComponent,s.iso8859=function(){s.encode=escape,s.decode=unescape},s.unicode=function(){s.encode=T,s.decode=decodeURIComponent},s.characters={pathname:{encode:{expression:/%(24|26|2B|2C|3B|3D|3A|40)/ig,map:{"%24":"$","%26":"&","%2B":"+","%2C":",","%3B":";","%3D":"=","%3A":":","%40":"@"}},decode:{expression:/[\/\?#]/g,map:{"/":"%2F","?":"%3F","#":"%23"}}},reserved:{encode:{expression:/%(21|23|24|26|27|28|29|2A|2B|2C|2F|3A|3B|3D|3F|40|5B|5D)/ig,map:{"%3A":":","%2F":"/","%3F":"?","%23":"#","%5B":"[","%5D":"]","%40":"@","%21":"!","%24":"$","%26":"&","%27":"'","%28":"(","%29":")","%2A":"*","%2B":"+","%2C":",","%3B":";","%3D":"="}}},urnpath:{encode:{expression:/%(21|24|27|28|29|2A|2B|2C|3B|3D|40)/ig,map:{"%21":"!","%24":"$","%27":"'","%28":"(","%29":")","%2A":"*","%2B":"+","%2C":",","%3B":";","%3D":"=","%40":"@"}},decode:{expression:/[\/\?#:]/g,map:{"/":"%2F","?":"%3F","#":"%23",":":"%3A"}}}},s.encodeQuery=function(b,v){var P=s.encode(b+"");return v===void 0&&(v=s.escapeQuerySpace),v?P.replace(/%20/g,"+"):P},s.decodeQuery=function(b,v){b+="",v===void 0&&(v=s.escapeQuerySpace);try{return s.decode(v?b.replace(/\+/g,"%20"):b)}catch(P){return b}};var E={encode:"encode",decode:"decode"},S,w=function(b,v){return function(P){try{return s[v](P+"").replace(s.characters[b][v].expression,function(R){return s.characters[b][v].map[R]})}catch(R){return P}}};for(S in E)s[S+"PathSegment"]=w("pathname",E[S]),s[S+"UrnPathSegment"]=w("urnpath",E[S]);var D=function(b,v,P){return function(R){var V;P?V=function(k){return s[v](s[P](k))}:V=s[v];for(var H=(R+"").split(b),U=0,G=H.length;U<G;U++)H[U]=V(H[U]);return H.join(b)}};s.decodePath=D("/","decodePathSegment"),s.decodeUrnPath=D(":","decodeUrnPathSegment"),s.recodePath=D("/","encodePathSegment","decode"),s.recodeUrnPath=D(":","encodeUrnPathSegment","decode"),s.encodeReserved=w("reserved","encode"),s.parse=function(b,v){var P;return v||(v={preventInvalidHostname:s.preventInvalidHostname}),b=b.replace(s.leading_whitespace_expression,""),b=b.replace(s.ascii_tab_whitespace,""),P=b.indexOf("#"),P>-1&&(v.fragment=b.substring(P+1)||null,b=b.substring(0,P)),P=b.indexOf("?"),P>-1&&(v.query=b.substring(P+1)||null,b=b.substring(0,P)),b=b.replace(/^(https?|ftp|wss?)?:+[/\\]*/i,"$1://"),b=b.replace(/^[/\\]{2,}/i,"//"),b.substring(0,2)==="//"?(v.protocol=null,b=b.substring(2),b=s.parseAuthority(b,v)):(P=b.indexOf(":"),P>-1&&(v.protocol=b.substring(0,P)||null,v.protocol&&!v.protocol.match(s.protocol_expression)?v.protocol=void 0:b.substring(P+1,P+3).replace(/\\/g,"/")==="//"?(b=b.substring(P+3),b=s.parseAuthority(b,v)):(b=b.substring(P+1),v.urn=!0))),v.path=b,v},s.parseHost=function(b,v){b||(b=""),b=b.replace(/\\/g,"/");var P=b.indexOf("/"),R,V;if(P===-1&&(P=b.length),b.charAt(0)==="[")R=b.indexOf("]"),v.hostname=b.substring(1,R)||null,v.port=b.substring(R+2,P)||null,v.port==="/"&&(v.port=null);else{var H=b.indexOf(":"),U=b.indexOf("/"),G=b.indexOf(":",H+1);G!==-1&&(U===-1||G<U)?(v.hostname=b.substring(0,P)||null,v.port=null):(V=b.substring(0,P).split(":"),v.hostname=V[0]||null,v.port=V[1]||null)}return v.hostname&&b.substring(P).charAt(0)!=="/"&&(P++,b="/"+b),v.preventInvalidHostname&&s.ensureValidHostname(v.hostname,v.protocol),v.port&&s.ensureValidPort(v.port),b.substring(P)||"/"},s.parseAuthority=function(b,v){return b=s.parseUserinfo(b,v),s.parseHost(b,v)},s.parseUserinfo=function(b,v){var P=b,R=b.indexOf("\\");R!==-1&&(b=b.replace(/\\/g,"/"));var V=b.indexOf("/"),H=b.lastIndexOf("@",V>-1?V:b.length-1),U;return H>-1&&(V===-1||H<V)?(U=b.substring(0,H).split(":"),v.username=U[0]?s.decode(U[0]):null,U.shift(),v.password=U[0]?s.decode(U.join(":")):null,b=P.substring(H+1)):(v.username=null,v.password=null),b},s.parseQuery=function(b,v){if(!b)return{};if(b=b.replace(/&+/g,"&").replace(/^\?*&*|&+$/g,""),!b)return{};for(var P={},R=b.split("&"),V=R.length,H,U,G,k=0;k<V;k++)H=R[k].split("="),U=s.decodeQuery(H.shift(),v),G=H.length?s.decodeQuery(H.join("="),v):null,U!=="__proto__"&&(l.call(P,U)?((typeof P[U]=="string"||P[U]===null)&&(P[U]=[P[U]]),P[U].push(G)):P[U]=G);return P},s.build=function(b){var v="",P=!1;return b.protocol&&(v+=b.protocol+":"),!b.urn&&(v||b.hostname)&&(v+="//",P=!0),v+=s.buildAuthority(b)||"",typeof b.path=="string"&&(b.path.charAt(0)!=="/"&&P&&(v+="/"),v+=b.path),typeof b.query=="string"&&b.query&&(v+="?"+b.query),typeof b.fragment=="string"&&b.fragment&&(v+="#"+b.fragment),v},s.buildHost=function(b){var v="";if(b.hostname)s.ip6_expression.test(b.hostname)?v+="["+b.hostname+"]":v+=b.hostname;else return"";return b.port&&(v+=":"+b.port),v},s.buildAuthority=function(b){return s.buildUserinfo(b)+s.buildHost(b)},s.buildUserinfo=function(b){var v="";return b.username&&(v+=s.encode(b.username)),b.password&&(v+=":"+s.encode(b.password)),v&&(v+="@"),v},s.buildQuery=function(b,v,P){var R="",V,H,U,G;for(H in b)if(H!=="__proto__"&&l.call(b,H))if(h(b[H]))for(V={},U=0,G=b[H].length;U<G;U++)b[H][U]!==void 0&&V[b[H][U]+""]===void 0&&(R+="&"+s.buildQueryParameter(H,b[H][U],P),v!==!0&&(V[b[H][U]+""]=!0));else b[H]!==void 0&&(R+="&"+s.buildQueryParameter(H,b[H],P));return R.substring(1)},s.buildQueryParameter=function(b,v,P){return s.encodeQuery(b,P)+(v!==null?"="+s.encodeQuery(v,P):"")},s.addQuery=function(b,v,P){if(typeof v=="object")for(var R in v)l.call(v,R)&&s.addQuery(b,R,v[R]);else if(typeof v=="string"){if(b[v]===void 0){b[v]=P;return}else typeof b[v]=="string"&&(b[v]=[b[v]]);h(P)||(P=[P]),b[v]=(b[v]||[]).concat(P)}else throw new TypeError("URI.addQuery() accepts an object, string as the name parameter")},s.setQuery=function(b,v,P){if(typeof v=="object")for(var R in v)l.call(v,R)&&s.setQuery(b,R,v[R]);else if(typeof v=="string")b[v]=P===void 0?null:P;else throw new TypeError("URI.setQuery() accepts an object, string as the name parameter")},s.removeQuery=function(b,v,P){var R,V,H;if(h(v))for(R=0,V=v.length;R<V;R++)b[v[R]]=void 0;else if(d(v)==="RegExp")for(H in b)v.test(H)&&(b[H]=void 0);else if(typeof v=="object")for(H in v)l.call(v,H)&&s.removeQuery(b,H,v[H]);else if(typeof v=="string")P!==void 0?d(P)==="RegExp"?!h(b[v])&&P.test(b[v])?b[v]=void 0:b[v]=_(b[v],P):b[v]===String(P)&&(!h(P)||P.length===1)?b[v]=void 0:h(b[v])&&(b[v]=_(b[v],P)):b[v]=void 0;else throw new TypeError("URI.removeQuery() accepts an object, string, RegExp as the first parameter")},s.hasQuery=function(b,v,P,R){switch(d(v)){case"String":break;case"RegExp":for(var V in b)if(l.call(b,V)&&v.test(V)&&(P===void 0||s.hasQuery(b,V,P)))return!0;return!1;case"Object":for(var H in v)if(l.call(v,H)&&!s.hasQuery(b,H,v[H]))return!1;return!0;default:throw new TypeError("URI.hasQuery() accepts a string, regular expression or object as the name parameter")}switch(d(P)){case"Undefined":return v in b;case"Boolean":var U=Boolean(h(b[v])?b[v].length:b[v]);return P===U;case"Function":return!!P(b[v],v,b);case"Array":if(!h(b[v]))return!1;var G=R?y:p;return G(b[v],P);case"RegExp":return h(b[v])?R?y(b[v],P):!1:Boolean(b[v]&&b[v].match(P));case"Number":P=String(P);case"String":return h(b[v])?R?y(b[v],P):!1:b[v]===P;default:throw new TypeError("URI.hasQuery() accepts undefined, boolean, string, number, RegExp, Function as the value parameter")}},s.joinPaths=function(){for(var b=[],v=[],P=0,R=0;R<arguments.length;R++){var V=new s(arguments[R]);b.push(V);for(var H=V.segment(),U=0;U<H.length;U++)typeof H[U]=="string"&&v.push(H[U]),H[U]&&P++}if(!v.length||!P)return new s("");var G=new s("").segment(v);return(b[0].path()===""||b[0].path().slice(0,1)==="/")&&G.path("/"+G.path()),G.normalize()},s.commonPath=function(b,v){var P=Math.min(b.length,v.length),R;for(R=0;R<P;R++)if(b.charAt(R)!==v.charAt(R)){R--;break}return R<1?b.charAt(0)===v.charAt(0)&&b.charAt(0)==="/"?"/":"":((b.charAt(R)!=="/"||v.charAt(R)!=="/")&&(R=b.substring(0,R).lastIndexOf("/")),b.substring(0,R+1))},s.withinString=function(b,v,P){P||(P={});var R=P.start||s.findUri.start,V=P.end||s.findUri.end,H=P.trim||s.findUri.trim,U=P.parens||s.findUri.parens,G=/[a-z0-9-]=["']?$/i;for(R.lastIndex=0;;){var k=R.exec(b);if(!k)break;var X=k.index;if(P.ignoreHtml){var Y=b.slice(Math.max(X-3,0),X);if(Y&&G.test(Y))continue}for(var K=X+b.slice(X).search(V),j=b.slice(X,K),Z=-1;;){var Q=U.exec(j);if(!Q)break;var me=Q.index+Q[0].length;Z=Math.max(Z,me)}if(Z>-1?j=j.slice(0,Z)+j.slice(Z).replace(H,""):j=j.replace(H,""),!(j.length<=k[0].length)&&!(P.ignore&&P.ignore.test(j))){K=X+j.length;var _e=v(j,X,K,b);if(_e===void 0){R.lastIndex=K;continue}_e=String(_e),b=b.slice(0,X)+_e+b.slice(K),R.lastIndex=X+_e.length}}return R.lastIndex=0,b},s.ensureValidHostname=function(b,v){var P=!!b,R=!!v,V=!1;if(R&&(V=y(s.hostProtocols,v)),V&&!P)throw new TypeError("Hostname cannot be empty, if protocol is "+v);if(b&&b.match(s.invalid_hostname_characters)){if(!t)throw new TypeError('Hostname "'+b+'" contains characters other than [A-Z0-9.-:_] and Punycode.js is not available');if(t.toASCII(b).match(s.invalid_hostname_characters))throw new TypeError('Hostname "'+b+'" contains characters other than [A-Z0-9.-:_]')}},s.ensureValidPort=function(b){if(!!b){var v=Number(b);if(!(a(v)&&v>0&&v<65536))throw new TypeError('Port "'+b+'" is not a valid port')}},s.noConflict=function(b){if(b){var v={URI:this.noConflict()};return o.URITemplate&&typeof o.URITemplate.noConflict=="function"&&(v.URITemplate=o.URITemplate.noConflict()),o.IPv6&&typeof o.IPv6.noConflict=="function"&&(v.IPv6=o.IPv6.noConflict()),o.SecondLevelDomains&&typeof o.SecondLevelDomains.noConflict=="function"&&(v.SecondLevelDomains=o.SecondLevelDomains.noConflict()),v}else o.URI===this&&(o.URI=r);return this},c.build=function(b){return b===!0?this._deferred_build=!0:(b===void 0||this._deferred_build)&&(this._string=s.build(this._parts),this._deferred_build=!1),this},c.clone=function(){return new s(this)},c.valueOf=c.toString=function(){return this.build(!1)._string};function I(b){return function(v,P){return v===void 0?this._parts[b]||"":(this._parts[b]=v||null,this.build(!P),this)}}function O(b,v){return function(P,R){return P===void 0?this._parts[b]||"":(P!==null&&(P=P+"",P.charAt(0)===v&&(P=P.substring(1))),this._parts[b]=P,this.build(!R),this)}}c.protocol=I("protocol"),c.username=I("username"),c.password=I("password"),c.hostname=I("hostname"),c.port=I("port"),c.query=O("query","?"),c.fragment=O("fragment","#"),c.search=function(b,v){var P=this.query(b,v);return typeof P=="string"&&P.length?"?"+P:P},c.hash=function(b,v){var P=this.fragment(b,v);return typeof P=="string"&&P.length?"#"+P:P},c.pathname=function(b,v){if(b===void 0||b===!0){var P=this._parts.path||(this._parts.hostname?"/":"");return b?(this._parts.urn?s.decodeUrnPath:s.decodePath)(P):P}else return this._parts.urn?this._parts.path=b?s.recodeUrnPath(b):"":this._parts.path=b?s.recodePath(b):"/",this.build(!v),this},c.path=c.pathname,c.href=function(b,v){var P;if(b===void 0)return this.toString();this._string="",this._parts=s._parts();var R=b instanceof s,V=typeof b=="object"&&(b.hostname||b.path||b.pathname);if(b.nodeName){var H=s.getDomAttribute(b);b=b[H]||"",V=!1}if(!R&&V&&b.pathname!==void 0&&(b=b.toString()),typeof b=="string"||b instanceof String)this._parts=s.parse(String(b),this._parts);else if(R||V){var U=R?b._parts:b;for(P in U)P!=="query"&&l.call(this._parts,P)&&(this._parts[P]=U[P]);U.query&&this.query(U.query,!1)}else throw new TypeError("invalid input");return this.build(!v),this},c.is=function(b){var v=!1,P=!1,R=!1,V=!1,H=!1,U=!1,G=!1,k=!this._parts.urn;switch(this._parts.hostname&&(k=!1,P=s.ip4_expression.test(this._parts.hostname),R=s.ip6_expression.test(this._parts.hostname),v=P||R,V=!v,H=V&&i&&i.has(this._parts.hostname),U=V&&s.idn_expression.test(this._parts.hostname),G=V&&s.punycode_expression.test(this._parts.hostname)),b.toLowerCase()){case"relative":return k;case"absolute":return!k;case"domain":case"name":return V;case"sld":return H;case"ip":return v;case"ip4":case"ipv4":case"inet4":return P;case"ip6":case"ipv6":case"inet6":return R;case"idn":return U;case"url":return!this._parts.urn;case"urn":return!!this._parts.urn;case"punycode":return G}return null};var M=c.protocol,L=c.port,F=c.hostname;c.protocol=function(b,v){if(b&&(b=b.replace(/:(\/\/)?$/,""),!b.match(s.protocol_expression)))throw new TypeError('Protocol "'+b+`" contains characters other than [A-Z0-9.+-] or doesn't start with [A-Z]`);return M.call(this,b,v)},c.scheme=c.protocol,c.port=function(b,v){return this._parts.urn?b===void 0?"":this:(b!==void 0&&(b===0&&(b=null),b&&(b+="",b.charAt(0)===":"&&(b=b.substring(1)),s.ensureValidPort(b))),L.call(this,b,v))},c.hostname=function(b,v){if(this._parts.urn)return b===void 0?"":this;if(b!==void 0){var P={preventInvalidHostname:this._parts.preventInvalidHostname},R=s.parseHost(b,P);if(R!=="/")throw new TypeError('Hostname "'+b+'" contains characters other than [A-Z0-9.-]');b=P.hostname,this._parts.preventInvalidHostname&&s.ensureValidHostname(b,this._parts.protocol)}return F.call(this,b,v)},c.origin=function(b,v){if(this._parts.urn)return b===void 0?"":this;if(b===void 0){var P=this.protocol(),R=this.authority();return R?(P?P+"://":"")+this.authority():""}else{var V=s(b);return this.protocol(V.protocol()).authority(V.authority()).build(!v),this}},c.host=function(b,v){if(this._parts.urn)return b===void 0?"":this;if(b===void 0)return this._parts.hostname?s.buildHost(this._parts):"";var P=s.parseHost(b,this._parts);if(P!=="/")throw new TypeError('Hostname "'+b+'" contains characters other than [A-Z0-9.-]');return this.build(!v),this},c.authority=function(b,v){if(this._parts.urn)return b===void 0?"":this;if(b===void 0)return this._parts.hostname?s.buildAuthority(this._parts):"";var P=s.parseAuthority(b,this._parts);if(P!=="/")throw new TypeError('Hostname "'+b+'" contains characters other than [A-Z0-9.-]');return this.build(!v),this},c.userinfo=function(b,v){if(this._parts.urn)return b===void 0?"":this;if(b===void 0){var P=s.buildUserinfo(this._parts);return P&&P.substring(0,P.length-1)}else return b[b.length-1]!=="@"&&(b+="@"),s.parseUserinfo(b,this._parts),this.build(!v),this},c.resource=function(b,v){var P;return b===void 0?this.path()+this.search()+this.hash():(P=s.parse(b),this._parts.path=P.path,this._parts.query=P.query,this._parts.fragment=P.fragment,this.build(!v),this)},c.subdomain=function(b,v){if(this._parts.urn)return b===void 0?"":this;if(b===void 0){if(!this._parts.hostname||this.is("IP"))return"";var P=this._parts.hostname.length-this.domain().length-1;return this._parts.hostname.substring(0,P)||""}else{var R=this._parts.hostname.length-this.domain().length,V=this._parts.hostname.substring(0,R),H=new RegExp("^"+u(V));if(b&&b.charAt(b.length-1)!=="."&&(b+="."),b.indexOf(":")!==-1)throw new TypeError("Domains cannot contain colons");return b&&s.ensureValidHostname(b,this._parts.protocol),this._parts.hostname=this._parts.hostname.replace(H,b),this.build(!v),this}},c.domain=function(b,v){if(this._parts.urn)return b===void 0?"":this;if(typeof b=="boolean"&&(v=b,b=void 0),b===void 0){if(!this._parts.hostname||this.is("IP"))return"";var P=this._parts.hostname.match(/\./g);if(P&&P.length<2)return this._parts.hostname;var R=this._parts.hostname.length-this.tld(v).length-1;return R=this._parts.hostname.lastIndexOf(".",R-1)+1,this._parts.hostname.substring(R)||""}else{if(!b)throw new TypeError("cannot set domain empty");if(b.indexOf(":")!==-1)throw new TypeError("Domains cannot contain colons");if(s.ensureValidHostname(b,this._parts.protocol),!this._parts.hostname||this.is("IP"))this._parts.hostname=b;else{var V=new RegExp(u(this.domain())+"$");this._parts.hostname=this._parts.hostname.replace(V,b)}return this.build(!v),this}},c.tld=function(b,v){if(this._parts.urn)return b===void 0?"":this;if(typeof b=="boolean"&&(v=b,b=void 0),b===void 0){if(!this._parts.hostname||this.is("IP"))return"";var P=this._parts.hostname.lastIndexOf("."),R=this._parts.hostname.substring(P+1);return v!==!0&&i&&i.list[R.toLowerCase()]&&i.get(this._parts.hostname)||R}else{var V;if(b)if(b.match(/[^a-zA-Z0-9-]/))if(i&&i.is(b))V=new RegExp(u(this.tld())+"$"),this._parts.hostname=this._parts.hostname.replace(V,b);else throw new TypeError('TLD "'+b+'" contains characters other than [A-Z0-9]');else{if(!this._parts.hostname||this.is("IP"))throw new ReferenceError("cannot set TLD on non-domain host");V=new RegExp(u(this.tld())+"$"),this._parts.hostname=this._parts.hostname.replace(V,b)}else throw new TypeError("cannot set TLD empty");return this.build(!v),this}},c.directory=function(b,v){if(this._parts.urn)return b===void 0?"":this;if(b===void 0||b===!0){if(!this._parts.path&&!this._parts.hostname)return"";if(this._parts.path==="/")return"/";var P=this._parts.path.length-this.filename().length-1,R=this._parts.path.substring(0,P)||(this._parts.hostname?"/":"");return b?s.decodePath(R):R}else{var V=this._parts.path.length-this.filename().length,H=this._parts.path.substring(0,V),U=new RegExp("^"+u(H));return this.is("relative")||(b||(b="/"),b.charAt(0)!=="/"&&(b="/"+b)),b&&b.charAt(b.length-1)!=="/"&&(b+="/"),b=s.recodePath(b),this._parts.path=this._parts.path.replace(U,b),this.build(!v),this}},c.filename=function(b,v){if(this._parts.urn)return b===void 0?"":this;if(typeof b!="string"){if(!this._parts.path||this._parts.path==="/")return"";var P=this._parts.path.lastIndexOf("/"),R=this._parts.path.substring(P+1);return b?s.decodePathSegment(R):R}else{var V=!1;b.charAt(0)==="/"&&(b=b.substring(1)),b.match(/\.?\//)&&(V=!0);var H=new RegExp(u(this.filename())+"$");return b=s.recodePath(b),this._parts.path=this._parts.path.replace(H,b),V?this.normalizePath(v):this.build(!v),this}},c.suffix=function(b,v){if(this._parts.urn)return b===void 0?"":this;if(b===void 0||b===!0){if(!this._parts.path||this._parts.path==="/")return"";var P=this.filename(),R=P.lastIndexOf("."),V,H;return R===-1?"":(V=P.substring(R+1),H=/^[a-z0-9%]+$/i.test(V)?V:"",b?s.decodePathSegment(H):H)}else{b.charAt(0)==="."&&(b=b.substring(1));var U=this.suffix(),G;if(U)b?G=new RegExp(u(U)+"$"):G=new RegExp(u("."+U)+"$");else{if(!b)return this;this._parts.path+="."+s.recodePath(b)}return G&&(b=s.recodePath(b),this._parts.path=this._parts.path.replace(G,b)),this.build(!v),this}},c.segment=function(b,v,P){var R=this._parts.urn?":":"/",V=this.path(),H=V.substring(0,1)==="/",U=V.split(R);if(b!==void 0&&typeof b!="number"&&(P=v,v=b,b=void 0),b!==void 0&&typeof b!="number")throw new Error('Bad segment "'+b+'", must be 0-based integer');if(H&&U.shift(),b<0&&(b=Math.max(U.length+b,0)),v===void 0)return b===void 0?U:U[b];if(b===null||U[b]===void 0)if(h(v)){U=[];for(var G=0,k=v.length;G<k;G++)!v[G].length&&(!U.length||!U[U.length-1].length)||(U.length&&!U[U.length-1].length&&U.pop(),U.push(C(v[G])))}else(v||typeof v=="string")&&(v=C(v),U[U.length-1]===""?U[U.length-1]=v:U.push(v));else v?U[b]=C(v):U.splice(b,1);return H&&U.unshift(""),this.path(U.join(R),P)},c.segmentCoded=function(b,v,P){var R,V,H;if(typeof b!="number"&&(P=v,v=b,b=void 0),v===void 0){if(R=this.segment(b,v,P),!h(R))R=R!==void 0?s.decode(R):void 0;else for(V=0,H=R.length;V<H;V++)R[V]=s.decode(R[V]);return R}if(!h(v))v=typeof v=="string"||v instanceof String?s.encode(v):v;else for(V=0,H=v.length;V<H;V++)v[V]=s.encode(v[V]);return this.segment(b,v,P)};var g=c.query;return c.query=function(b,v){if(b===!0)return s.parseQuery(this._parts.query,this._parts.escapeQuerySpace);if(typeof b=="function"){var P=s.parseQuery(this._parts.query,this._parts.escapeQuerySpace),R=b.call(this,P);return this._parts.query=s.buildQuery(R||P,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),this.build(!v),this}else return b!==void 0&&typeof b!="string"?(this._parts.query=s.buildQuery(b,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),this.build(!v),this):g.call(this,b,v)},c.setQuery=function(b,v,P){var R=s.parseQuery(this._parts.query,this._parts.escapeQuerySpace);if(typeof b=="string"||b instanceof String)R[b]=v!==void 0?v:null;else if(typeof b=="object")for(var V in b)l.call(b,V)&&(R[V]=b[V]);else throw new TypeError("URI.addQuery() accepts an object, string as the name parameter");return this._parts.query=s.buildQuery(R,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),typeof b!="string"&&(P=v),this.build(!P),this},c.addQuery=function(b,v,P){var R=s.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return s.addQuery(R,b,v===void 0?null:v),this._parts.query=s.buildQuery(R,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),typeof b!="string"&&(P=v),this.build(!P),this},c.removeQuery=function(b,v,P){var R=s.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return s.removeQuery(R,b,v),this._parts.query=s.buildQuery(R,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),typeof b!="string"&&(P=v),this.build(!P),this},c.hasQuery=function(b,v,P){var R=s.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return s.hasQuery(R,b,v,P)},c.setSearch=c.setQuery,c.addSearch=c.addQuery,c.removeSearch=c.removeQuery,c.hasSearch=c.hasQuery,c.normalize=function(){return this._parts.urn?this.normalizeProtocol(!1).normalizePath(!1).normalizeQuery(!1).normalizeFragment(!1).build():this.normalizeProtocol(!1).normalizeHostname(!1).normalizePort(!1).normalizePath(!1).normalizeQuery(!1).normalizeFragment(!1).build()},c.normalizeProtocol=function(b){return typeof this._parts.protocol=="string"&&(this._parts.protocol=this._parts.protocol.toLowerCase(),this.build(!b)),this},c.normalizeHostname=function(b){return this._parts.hostname&&(this.is("IDN")&&t?this._parts.hostname=t.toASCII(this._parts.hostname):this.is("IPv6")&&n&&(this._parts.hostname=n.best(this._parts.hostname)),this._parts.hostname=this._parts.hostname.toLowerCase(),this.build(!b)),this},c.normalizePort=function(b){return typeof this._parts.protocol=="string"&&this._parts.port===s.defaultPorts[this._parts.protocol]&&(this._parts.port=null,this.build(!b)),this},c.normalizePath=function(b){var v=this._parts.path;if(!v)return this;if(this._parts.urn)return this._parts.path=s.recodeUrnPath(this._parts.path),this.build(!b),this;if(this._parts.path==="/")return this;v=s.recodePath(v);var P,R="",V,H;for(v.charAt(0)!=="/"&&(P=!0,v="/"+v),(v.slice(-3)==="/.."||v.slice(-2)==="/.")&&(v+="/"),v=v.replace(/(\/(\.\/)+)|(\/\.$)/g,"/").replace(/\/{2,}/g,"/"),P&&(R=v.substring(1).match(/^(\.\.\/)+/)||"",R&&(R=R[0]));V=v.search(/\/\.\.(\/|$)/),V!==-1;){if(V===0){v=v.substring(3);continue}H=v.substring(0,V).lastIndexOf("/"),H===-1&&(H=V),v=v.substring(0,H)+v.substring(V+3)}return P&&this.is("relative")&&(v=R+v.substring(1)),this._parts.path=v,this.build(!b),this},c.normalizePathname=c.normalizePath,c.normalizeQuery=function(b){return typeof this._parts.query=="string"&&(this._parts.query.length?this.query(s.parseQuery(this._parts.query,this._parts.escapeQuerySpace)):this._parts.query=null,this.build(!b)),this},c.normalizeFragment=function(b){return this._parts.fragment||(this._parts.fragment=null,this.build(!b)),this},c.normalizeSearch=c.normalizeQuery,c.normalizeHash=c.normalizeFragment,c.iso8859=function(){var b=s.encode,v=s.decode;s.encode=escape,s.decode=decodeURIComponent;try{this.normalize()}finally{s.encode=b,s.decode=v}return this},c.unicode=function(){var b=s.encode,v=s.decode;s.encode=T,s.decode=unescape;try{this.normalize()}finally{s.encode=b,s.decode=v}return this},c.readable=function(){var b=this.clone();b.username("").password("").normalize();var v="";if(b._parts.protocol&&(v+=b._parts.protocol+"://"),b._parts.hostname&&(b.is("punycode")&&t?(v+=t.toUnicode(b._parts.hostname),b._parts.port&&(v+=":"+b._parts.port)):v+=b.host()),b._parts.hostname&&b._parts.path&&b._parts.path.charAt(0)!=="/"&&(v+="/"),v+=b.path(!0),b._parts.query){for(var P="",R=0,V=b._parts.query.split("&"),H=V.length;R<H;R++){var U=(V[R]||"").split("=");P+="&"+s.decodeQuery(U[0],this._parts.escapeQuerySpace).replace(/&/g,"%26"),U[1]!==void 0&&(P+="="+s.decodeQuery(U[1],this._parts.escapeQuerySpace).replace(/&/g,"%26"))}v+="?"+P.substring(1)}return v+=s.decodeQuery(b.hash(),!0),v},c.absoluteTo=function(b){var v=this.clone(),P=["protocol","username","password","hostname","port"],R,V,H;if(this._parts.urn)throw new Error("URNs do not have any generally defined hierarchical components");if(b instanceof s||(b=new s(b)),v._parts.protocol||(v._parts.protocol=b._parts.protocol,this._parts.hostname))return v;for(V=0;H=P[V];V++)v._parts[H]=b._parts[H];return v._parts.path?(v._parts.path.substring(-2)===".."&&(v._parts.path+="/"),v.path().charAt(0)!=="/"&&(R=b.directory(),R=R||(b.path().indexOf("/")===0?"/":""),v._parts.path=(R?R+"/":"")+v._parts.path,v.normalizePath())):(v._parts.path=b._parts.path,v._parts.query||(v._parts.query=b._parts.query)),v.build(),v},c.relativeTo=function(b){var v=this.clone().normalize(),P,R,V,H,U;if(v._parts.urn)throw new Error("URNs do not have any generally defined hierarchical components");if(b=new s(b).normalize(),P=v._parts,R=b._parts,H=v.path(),U=b.path(),H.charAt(0)!=="/")throw new Error("URI is already relative");if(U.charAt(0)!=="/")throw new Error("Cannot calculate a URI relative to another relative URI");if(P.protocol===R.protocol&&(P.protocol=null),P.username!==R.username||P.password!==R.password||P.protocol!==null||P.username!==null||P.password!==null)return v.build();if(P.hostname===R.hostname&&P.port===R.port)P.hostname=null,P.port=null;else return v.build();if(H===U)return P.path="",v.build();if(V=s.commonPath(H,U),!V)return v.build();var G=R.path.substring(V.length).replace(/[^\/]*$/,"").replace(/.*?\//g,"../");return P.path=G+P.path.substring(V.length)||"./",v.build()},c.equals=function(b){var v=this.clone(),P=new s(b),R={},V={},H={},U,G,k;if(v.normalize(),P.normalize(),v.toString()===P.toString())return!0;if(U=v.query(),G=P.query(),v.query(""),P.query(""),v.toString()!==P.toString()||U.length!==G.length)return!1;R=s.parseQuery(U,this._parts.escapeQuerySpace),V=s.parseQuery(G,this._parts.escapeQuerySpace);for(k in R)if(l.call(R,k)){if(h(R[k])){if(!p(R[k],V[k]))return!1}else if(R[k]!==V[k])return!1;H[k]=!0}for(k in V)if(l.call(V,k)&&!H[k])return!1;return!0},c.preventInvalidHostname=function(b){return this._parts.preventInvalidHostname=!!b,this},c.duplicateQueryParameters=function(b){return this._parts.duplicateQueryParameters=!!b,this},c.escapeQuerySpace=function(b){return this._parts.escapeQuerySpace=!!b,this},s})});var zJ=Za((w8,D8)=>{/*! @license DOMPurify 2.4.5 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.5/LICENSE */(function(t,n){typeof w8=="object"&&typeof D8!="undefined"?D8.exports=n():typeof define=="function"&&define.amd?define(n):(t=typeof globalThis!="undefined"?globalThis:t||self,t.DOMPurify=n())})(w8,function(){"use strict";function t(ye){return t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Oe){return typeof Oe}:function(Oe){return Oe&&typeof Symbol=="function"&&Oe.constructor===Symbol&&Oe!==Symbol.prototype?"symbol":typeof Oe},t(ye)}function n(ye,Oe){return n=Object.setPrototypeOf||function(Xt,En){return Xt.__proto__=En,Xt},n(ye,Oe)}function i(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(ye){return!1}}function o(ye,Oe,Ye){return i()?o=Reflect.construct:o=function(En,Vi,ki){var Xi=[null];Xi.push.apply(Xi,Vi);var li=Function.bind.apply(En,Xi),Le=new li;return ki&&n(Le,ki.prototype),Le},o.apply(null,arguments)}function r(ye){return s(ye)||a(ye)||c(ye)||u()}function s(ye){if(Array.isArray(ye))return l(ye)}function a(ye){if(typeof Symbol!="undefined"&&ye[Symbol.iterator]!=null||ye["@@iterator"]!=null)return Array.from(ye)}function c(ye,Oe){if(!!ye){if(typeof ye=="string")return l(ye,Oe);var Ye=Object.prototype.toString.call(ye).slice(8,-1);if(Ye==="Object"&&ye.constructor&&(Ye=ye.constructor.name),Ye==="Map"||Ye==="Set")return Array.from(ye);if(Ye==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Ye))return l(ye,Oe)}}function l(ye,Oe){(Oe==null||Oe>ye.length)&&(Oe=ye.length);for(var Ye=0,Xt=new Array(Oe);Ye<Oe;Ye++)Xt[Ye]=ye[Ye];return Xt}function u(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var d=Object.hasOwnProperty,h=Object.setPrototypeOf,_=Object.isFrozen,y=Object.getPrototypeOf,p=Object.getOwnPropertyDescriptor,C=Object.freeze,x=Object.seal,T=Object.create,E=typeof Reflect!="undefined"&&Reflect,S=E.apply,w=E.construct;S||(S=function(Oe,Ye,Xt){return Oe.apply(Ye,Xt)}),C||(C=function(Oe){return Oe}),x||(x=function(Oe){return Oe}),w||(w=function(Oe,Ye){return o(Oe,r(Ye))});var D=V(Array.prototype.forEach),I=V(Array.prototype.pop),O=V(Array.prototype.push),M=V(String.prototype.toLowerCase),L=V(String.prototype.toString),F=V(String.prototype.match),g=V(String.prototype.replace),b=V(String.prototype.indexOf),v=V(String.prototype.trim),P=V(RegExp.prototype.test),R=H(TypeError);function V(ye){return function(Oe){for(var Ye=arguments.length,Xt=new Array(Ye>1?Ye-1:0),En=1;En<Ye;En++)Xt[En-1]=arguments[En];return S(ye,Oe,Xt)}}function H(ye){return function(){for(var Oe=arguments.length,Ye=new Array(Oe),Xt=0;Xt<Oe;Xt++)Ye[Xt]=arguments[Xt];return w(ye,Ye)}}function U(ye,Oe,Ye){Ye=Ye||M,h&&h(ye,null);for(var Xt=Oe.length;Xt--;){var En=Oe[Xt];if(typeof En=="string"){var Vi=Ye(En);Vi!==En&&(_(Oe)||(Oe[Xt]=Vi),En=Vi)}ye[En]=!0}return ye}function G(ye){var Oe=T(null),Ye;for(Ye in ye)S(d,ye,[Ye])===!0&&(Oe[Ye]=ye[Ye]);return Oe}function k(ye,Oe){for(;ye!==null;){var Ye=p(ye,Oe);if(Ye){if(Ye.get)return V(Ye.get);if(typeof Ye.value=="function")return V(Ye.value)}ye=y(ye)}function Xt(En){return console.warn("fallback value for",En),null}return Xt}var X=C(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Y=C(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),K=C(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),j=C(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Z=C(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),Q=C(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),me=C(["#text"]),_e=C(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),re=C(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),fe=C(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),ge=C(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),be=x(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Be=x(/<%[\w\W]*|[\w\W]*%>/gm),ke=x(/\${[\w\W]*}/gm),qe=x(/^data-[\-\w.\u00B7-\uFFFF]/),Nt=x(/^aria-[\-\w]+$/),Wt=x(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),un=x(/^(?:\w+script|data):/i),_t=x(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Rn=x(/^html$/i),oi=function(){return typeof window=="undefined"?null:window},lt=function(Oe,Ye){if(t(Oe)!=="object"||typeof Oe.createPolicy!="function")return null;var Xt=null,En="data-tt-policy-suffix";Ye.currentScript&&Ye.currentScript.hasAttribute(En)&&(Xt=Ye.currentScript.getAttribute(En));var Vi="dompurify"+(Xt?"#"+Xt:"");try{return Oe.createPolicy(Vi,{createHTML:function(Xi){return Xi},createScriptURL:function(Xi){return Xi}})}catch(ki){return console.warn("TrustedTypes policy "+Vi+" could not be created."),null}};function Yt(){var ye=arguments.length>0&&arguments[0]!==void 0?arguments[0]:oi(),Oe=function(Se){return Yt(Se)};if(Oe.version="2.4.5",Oe.removed=[],!ye||!ye.document||ye.document.nodeType!==9)return Oe.isSupported=!1,Oe;var Ye=ye.document,Xt=ye.document,En=ye.DocumentFragment,Vi=ye.HTMLTemplateElement,ki=ye.Node,Xi=ye.Element,li=ye.NodeFilter,Le=ye.NamedNodeMap,nt=Le===void 0?ye.NamedNodeMap||ye.MozNamedAttrMap:Le,Qe=ye.HTMLFormElement,Xe=ye.DOMParser,dt=ye.trustedTypes,Mt=Xi.prototype,bn=k(Mt,"cloneNode"),To=k(Mt,"nextSibling"),Go=k(Mt,"childNodes"),Kr=k(Mt,"parentNode");if(typeof Vi=="function"){var As=Xt.createElement("template");As.content&&As.content.ownerDocument&&(Xt=As.content.ownerDocument)}var io=lt(dt,Ye),Ri=io?io.createHTML(""):"",hr=Xt,Dr=hr.implementation,ru=hr.createNodeIterator,Ui=hr.createDocumentFragment,Ur=hr.getElementsByTagName,Xs=Ye.importNode,mr={};try{mr=G(Xt).documentMode?Xt.documentMode:{}}catch(An){}var ha={};Oe.isSupported=typeof Kr=="function"&&Dr&&typeof Dr.createHTMLDocument!="undefined"&&mr!==9;var or=be,Oc=Be,Rc=ke,fb=qe,Cs=Nt,Zh=un,UA=_t,db=Wt,Wo=null,Ja=U({},[].concat(r(X),r(Y),r(K),r(Z),r(me))),vr=null,aP=U({},[].concat(r(_e),r(re),r(fe),r(ge))),Pr=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),hb=null,Lz=null,$q=!0,Fz=!0,eY=!1,tY=!0,zA=!1,l0=!1,Nz=!1,Vz=!1,HA=!1,cP=!1,lP=!1,nY=!0,iY=!1,hye="user-content-",kz=!0,mb=!1,GA={},WA=null,oY=U({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),rY=null,sY=U({},["audio","video","img","source","image","track"]),Uz=null,aY=U({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),uP="http://www.w3.org/1998/Math/MathML",fP="http://www.w3.org/2000/svg",Qh="http://www.w3.org/1999/xhtml",jA=Qh,zz=!1,Hz=null,mye=U({},[uP,fP,Qh],L),u0,pye=["application/xhtml+xml","text/html"],_ye="text/html",xs,qA=null,gye=Xt.createElement("form"),cY=function(Se){return Se instanceof RegExp||Se instanceof Function},Gz=function(Se){qA&&qA===Se||((!Se||t(Se)!=="object")&&(Se={}),Se=G(Se),u0=pye.indexOf(Se.PARSER_MEDIA_TYPE)===-1?u0=_ye:u0=Se.PARSER_MEDIA_TYPE,xs=u0==="application/xhtml+xml"?L:M,Wo="ALLOWED_TAGS"in Se?U({},Se.ALLOWED_TAGS,xs):Ja,vr="ALLOWED_ATTR"in Se?U({},Se.ALLOWED_ATTR,xs):aP,Hz="ALLOWED_NAMESPACES"in Se?U({},Se.ALLOWED_NAMESPACES,L):mye,Uz="ADD_URI_SAFE_ATTR"in Se?U(G(aY),Se.ADD_URI_SAFE_ATTR,xs):aY,rY="ADD_DATA_URI_TAGS"in Se?U(G(sY),Se.ADD_DATA_URI_TAGS,xs):sY,WA="FORBID_CONTENTS"in Se?U({},Se.FORBID_CONTENTS,xs):oY,hb="FORBID_TAGS"in Se?U({},Se.FORBID_TAGS,xs):{},Lz="FORBID_ATTR"in Se?U({},Se.FORBID_ATTR,xs):{},GA="USE_PROFILES"in Se?Se.USE_PROFILES:!1,$q=Se.ALLOW_ARIA_ATTR!==!1,Fz=Se.ALLOW_DATA_ATTR!==!1,eY=Se.ALLOW_UNKNOWN_PROTOCOLS||!1,tY=Se.ALLOW_SELF_CLOSE_IN_ATTR!==!1,zA=Se.SAFE_FOR_TEMPLATES||!1,l0=Se.WHOLE_DOCUMENT||!1,HA=Se.RETURN_DOM||!1,cP=Se.RETURN_DOM_FRAGMENT||!1,lP=Se.RETURN_TRUSTED_TYPE||!1,Vz=Se.FORCE_BODY||!1,nY=Se.SANITIZE_DOM!==!1,iY=Se.SANITIZE_NAMED_PROPS||!1,kz=Se.KEEP_CONTENT!==!1,mb=Se.IN_PLACE||!1,db=Se.ALLOWED_URI_REGEXP||db,jA=Se.NAMESPACE||Qh,Pr=Se.CUSTOM_ELEMENT_HANDLING||{},Se.CUSTOM_ELEMENT_HANDLING&&cY(Se.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Pr.tagNameCheck=Se.CUSTOM_ELEMENT_HANDLING.tagNameCheck),Se.CUSTOM_ELEMENT_HANDLING&&cY(Se.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Pr.attributeNameCheck=Se.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),Se.CUSTOM_ELEMENT_HANDLING&&typeof Se.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(Pr.allowCustomizedBuiltInElements=Se.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),zA&&(Fz=!1),cP&&(HA=!0),GA&&(Wo=U({},r(me)),vr=[],GA.html===!0&&(U(Wo,X),U(vr,_e)),GA.svg===!0&&(U(Wo,Y),U(vr,re),U(vr,ge)),GA.svgFilters===!0&&(U(Wo,K),U(vr,re),U(vr,ge)),GA.mathMl===!0&&(U(Wo,Z),U(vr,fe),U(vr,ge))),Se.ADD_TAGS&&(Wo===Ja&&(Wo=G(Wo)),U(Wo,Se.ADD_TAGS,xs)),Se.ADD_ATTR&&(vr===aP&&(vr=G(vr)),U(vr,Se.ADD_ATTR,xs)),Se.ADD_URI_SAFE_ATTR&&U(Uz,Se.ADD_URI_SAFE_ATTR,xs),Se.FORBID_CONTENTS&&(WA===oY&&(WA=G(WA)),U(WA,Se.FORBID_CONTENTS,xs)),kz&&(Wo["#text"]=!0),l0&&U(Wo,["html","head","body"]),Wo.table&&(U(Wo,["tbody"]),delete hb.tbody),C&&C(Se),qA=Se)},lY=U({},["mi","mo","mn","ms","mtext"]),uY=U({},["foreignobject","desc","title","annotation-xml"]),yye=U({},["title","style","font","a","script"]),dP=U({},Y);U(dP,K),U(dP,j);var Wz=U({},Z);U(Wz,Q);var Aye=function(Se){var gt=Kr(Se);(!gt||!gt.tagName)&&(gt={namespaceURI:jA,tagName:"template"});var Ht=M(Se.tagName),oo=M(gt.tagName);return Hz[Se.namespaceURI]?Se.namespaceURI===fP?gt.namespaceURI===Qh?Ht==="svg":gt.namespaceURI===uP?Ht==="svg"&&(oo==="annotation-xml"||lY[oo]):Boolean(dP[Ht]):Se.namespaceURI===uP?gt.namespaceURI===Qh?Ht==="math":gt.namespaceURI===fP?Ht==="math"&&uY[oo]:Boolean(Wz[Ht]):Se.namespaceURI===Qh?gt.namespaceURI===fP&&!uY[oo]||gt.namespaceURI===uP&&!lY[oo]?!1:!Wz[Ht]&&(yye[Ht]||!dP[Ht]):!!(u0==="application/xhtml+xml"&&Hz[Se.namespaceURI]):!1},$h=function(Se){O(Oe.removed,{element:Se});try{Se.parentNode.removeChild(Se)}catch(gt){try{Se.outerHTML=Ri}catch(Ht){Se.remove()}}},jz=function(Se,gt){try{O(Oe.removed,{attribute:gt.getAttributeNode(Se),from:gt})}catch(Ht){O(Oe.removed,{attribute:null,from:gt})}if(gt.removeAttribute(Se),Se==="is"&&!vr[Se])if(HA||cP)try{$h(gt)}catch(Ht){}else try{gt.setAttribute(Se,"")}catch(Ht){}},fY=function(Se){var gt,Ht;if(Vz)Se="<remove></remove>"+Se;else{var oo=F(Se,/^[\r\n\t ]+/);Ht=oo&&oo[0]}u0==="application/xhtml+xml"&&jA===Qh&&(Se='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+Se+"</body></html>");var Mc=io?io.createHTML(Se):Se;if(jA===Qh)try{gt=new Xe().parseFromString(Mc,u0)}catch(Ks){}if(!gt||!gt.documentElement){gt=Dr.createDocument(jA,"template",null);try{gt.documentElement.innerHTML=zz?Ri:Mc}catch(Ks){}}var ma=gt.body||gt.documentElement;return Se&&Ht&&ma.insertBefore(Xt.createTextNode(Ht),ma.childNodes[0]||null),jA===Qh?Ur.call(gt,l0?"html":"body")[0]:l0?gt.documentElement:ma},dY=function(Se){return ru.call(Se.ownerDocument||Se,Se,li.SHOW_ELEMENT|li.SHOW_COMMENT|li.SHOW_TEXT,null,!1)},Cye=function(Se){return Se instanceof Qe&&(typeof Se.nodeName!="string"||typeof Se.textContent!="string"||typeof Se.removeChild!="function"||!(Se.attributes instanceof nt)||typeof Se.removeAttribute!="function"||typeof Se.setAttribute!="function"||typeof Se.namespaceURI!="string"||typeof Se.insertBefore!="function"||typeof Se.hasChildNodes!="function")},pb=function(Se){return t(ki)==="object"?Se instanceof ki:Se&&t(Se)==="object"&&typeof Se.nodeType=="number"&&typeof Se.nodeName=="string"},em=function(Se,gt,Ht){!ha[Se]||D(ha[Se],function(oo){oo.call(Oe,gt,Ht,qA)})},hY=function(Se){var gt;if(em("beforeSanitizeElements",Se,null),Cye(Se)||P(/[\u0080-\uFFFF]/,Se.nodeName))return $h(Se),!0;var Ht=xs(Se.nodeName);if(em("uponSanitizeElement",Se,{tagName:Ht,allowedTags:Wo}),Se.hasChildNodes()&&!pb(Se.firstElementChild)&&(!pb(Se.content)||!pb(Se.content.firstElementChild))&&P(/<[/\w]/g,Se.innerHTML)&&P(/<[/\w]/g,Se.textContent)||Ht==="select"&&P(/<template/i,Se.innerHTML))return $h(Se),!0;if(!Wo[Ht]||hb[Ht]){if(!hb[Ht]&&pY(Ht)&&(Pr.tagNameCheck instanceof RegExp&&P(Pr.tagNameCheck,Ht)||Pr.tagNameCheck instanceof Function&&Pr.tagNameCheck(Ht)))return!1;if(kz&&!WA[Ht]){var oo=Kr(Se)||Se.parentNode,Mc=Go(Se)||Se.childNodes;if(Mc&&oo)for(var ma=Mc.length,Ks=ma-1;Ks>=0;--Ks)oo.insertBefore(bn(Mc[Ks],!0),To(Se))}return $h(Se),!0}return Se instanceof Xi&&!Aye(Se)||(Ht==="noscript"||Ht==="noembed")&&P(/<\/no(script|embed)/i,Se.innerHTML)?($h(Se),!0):(zA&&Se.nodeType===3&&(gt=Se.textContent,gt=g(gt,or," "),gt=g(gt,Oc," "),gt=g(gt,Rc," "),Se.textContent!==gt&&(O(Oe.removed,{element:Se.cloneNode()}),Se.textContent=gt)),em("afterSanitizeElements",Se,null),!1)},mY=function(Se,gt,Ht){if(nY&&(gt==="id"||gt==="name")&&(Ht in Xt||Ht in gye))return!1;if(!(Fz&&!Lz[gt]&&P(fb,gt))){if(!($q&&P(Cs,gt))){if(!vr[gt]||Lz[gt]){if(!(pY(Se)&&(Pr.tagNameCheck instanceof RegExp&&P(Pr.tagNameCheck,Se)||Pr.tagNameCheck instanceof Function&&Pr.tagNameCheck(Se))&&(Pr.attributeNameCheck instanceof RegExp&&P(Pr.attributeNameCheck,gt)||Pr.attributeNameCheck instanceof Function&&Pr.attributeNameCheck(gt))||gt==="is"&&Pr.allowCustomizedBuiltInElements&&(Pr.tagNameCheck instanceof RegExp&&P(Pr.tagNameCheck,Ht)||Pr.tagNameCheck instanceof Function&&Pr.tagNameCheck(Ht))))return!1}else if(!Uz[gt]){if(!P(db,g(Ht,UA,""))){if(!((gt==="src"||gt==="xlink:href"||gt==="href")&&Se!=="script"&&b(Ht,"data:")===0&&rY[Se])){if(!(eY&&!P(Zh,g(Ht,UA,"")))){if(Ht)return!1}}}}}}return!0},pY=function(Se){return Se.indexOf("-")>0},_Y=function(Se){var gt,Ht,oo,Mc;em("beforeSanitizeAttributes",Se,null);var ma=Se.attributes;if(!!ma){var Ks={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:vr};for(Mc=ma.length;Mc--;){gt=ma[Mc];var hP=gt,Ts=hP.name,qz=hP.namespaceURI;if(Ht=Ts==="value"?gt.value:v(gt.value),oo=xs(Ts),Ks.attrName=oo,Ks.attrValue=Ht,Ks.keepAttr=!0,Ks.forceKeepAttr=void 0,em("uponSanitizeAttribute",Se,Ks),Ht=Ks.attrValue,!Ks.forceKeepAttr&&(jz(Ts,Se),!!Ks.keepAttr)){if(!tY&&P(/\/>/i,Ht)){jz(Ts,Se);continue}zA&&(Ht=g(Ht,or," "),Ht=g(Ht,Oc," "),Ht=g(Ht,Rc," "));var gY=xs(Se.nodeName);if(!!mY(gY,oo,Ht)){if(iY&&(oo==="id"||oo==="name")&&(jz(Ts,Se),Ht=hye+Ht),io&&t(dt)==="object"&&typeof dt.getAttributeType=="function"&&!qz)switch(dt.getAttributeType(gY,oo)){case"TrustedHTML":Ht=io.createHTML(Ht);break;case"TrustedScriptURL":Ht=io.createScriptURL(Ht);break}try{qz?Se.setAttributeNS(qz,Ts,Ht):Se.setAttribute(Ts,Ht),I(Oe.removed)}catch(Xmt){}}}}em("afterSanitizeAttributes",Se,null)}},xye=function An(Se){var gt,Ht=dY(Se);for(em("beforeSanitizeShadowDOM",Se,null);gt=Ht.nextNode();)em("uponSanitizeShadowNode",gt,null),!hY(gt)&&(gt.content instanceof En&&An(gt.content),_Y(gt));em("afterSanitizeShadowDOM",Se,null)};return Oe.sanitize=function(An){var Se=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},gt,Ht,oo,Mc,ma;if(zz=!An,zz&&(An="<!-->"),typeof An!="string"&&!pb(An)){if(typeof An.toString!="function")throw R("toString is not a function");if(An=An.toString(),typeof An!="string")throw R("dirty is not a string, aborting")}if(!Oe.isSupported){if(t(ye.toStaticHTML)==="object"||typeof ye.toStaticHTML=="function"){if(typeof An=="string")return ye.toStaticHTML(An);if(pb(An))return ye.toStaticHTML(An.outerHTML)}return An}if(Nz||Gz(Se),Oe.removed=[],typeof An=="string"&&(mb=!1),mb){if(An.nodeName){var Ks=xs(An.nodeName);if(!Wo[Ks]||hb[Ks])throw R("root node is forbidden and cannot be sanitized in-place")}}else if(An instanceof ki)gt=fY("<!---->"),Ht=gt.ownerDocument.importNode(An,!0),Ht.nodeType===1&&Ht.nodeName==="BODY"||Ht.nodeName==="HTML"?gt=Ht:gt.appendChild(Ht);else{if(!HA&&!zA&&!l0&&An.indexOf("<")===-1)return io&&lP?io.createHTML(An):An;if(gt=fY(An),!gt)return HA?null:lP?Ri:""}gt&&Vz&&$h(gt.firstChild);for(var hP=dY(mb?An:gt);oo=hP.nextNode();)oo.nodeType===3&&oo===Mc||hY(oo)||(oo.content instanceof En&&xye(oo.content),_Y(oo),Mc=oo);if(Mc=null,mb)return An;if(HA){if(cP)for(ma=Ui.call(gt.ownerDocument);gt.firstChild;)ma.appendChild(gt.firstChild);else ma=gt;return(vr.shadowroot||vr.shadowrootmod)&&(ma=Xs.call(Ye,ma,!0)),ma}var Ts=l0?gt.outerHTML:gt.innerHTML;return l0&&Wo["!doctype"]&&gt.ownerDocument&&gt.ownerDocument.doctype&&gt.ownerDocument.doctype.name&&P(Rn,gt.ownerDocument.doctype.name)&&(Ts="<!DOCTYPE "+gt.ownerDocument.doctype.name+`>
`+Ts),zA&&(Ts=g(Ts,or," "),Ts=g(Ts,Oc," "),Ts=g(Ts,Rc," ")),io&&lP?io.createHTML(Ts):Ts},Oe.setConfig=function(An){Gz(An),Nz=!0},Oe.clearConfig=function(){qA=null,Nz=!1},Oe.isValidAttribute=function(An,Se,gt){qA||Gz({});var Ht=xs(An),oo=xs(Se);return mY(Ht,oo,gt)},Oe.addHook=function(An,Se){typeof Se=="function"&&(ha[An]=ha[An]||[],O(ha[An],Se))},Oe.removeHook=function(An){if(ha[An])return I(ha[An])},Oe.removeHooks=function(An){ha[An]&&(ha[An]=[])},Oe.removeAllHooks=function(){ha={}},Oe}var si=Yt();return si})});var yte=Za((GS,bL)=>{(function(t){"use strict";var n="Compound",i="Identifier",o="MemberExpression",r="Literal",s="ThisExpression",a="CallExpression",c="UnaryExpression",l="BinaryExpression",u="LogicalExpression",d="ConditionalExpression",h="ArrayExpression",_=46,y=44,p=39,C=34,x=40,T=41,E=91,S=93,w=63,D=59,I=58,O=function(K,j){var Z=new Error(K+" at character "+j);throw Z.index=j,Z.description=K,Z},M=!0,L={"-":M,"!":M,"~":M,"+":M},F={"||":1,"&&":2,"|":3,"^":4,"&":5,"==":6,"!=":6,"===":6,"!==":6,"<":7,">":7,"<=":7,">=":7,"<<":8,">>":8,">>>":8,"+":9,"-":9,"*":10,"/":10,"%":10},g=function(K){var j=0,Z;for(var Q in K)(Z=Q.length)>j&&K.hasOwnProperty(Q)&&(j=Z);return j},b=g(L),v=g(F),P={true:!0,false:!1,null:null},R="this",V=function(K){return F[K]||0},H=function(K,j,Z){var Q=K==="||"||K==="&&"?u:l;return{type:Q,operator:K,left:j,right:Z}},U=function(K){return K>=48&&K<=57},G=function(K){return K===36||K===95||K>=65&&K<=90||K>=97&&K<=122||K>=128&&!F[String.fromCharCode(K)]},k=function(K){return K===36||K===95||K>=65&&K<=90||K>=97&&K<=122||K>=48&&K<=57||K>=128&&!F[String.fromCharCode(K)]},X=function(K){for(var j=0,Z=K.charAt,Q=K.charCodeAt,me=function(ye){return Z.call(K,ye)},_e=function(ye){return Q.call(K,ye)},re=K.length,fe=function(){for(var ye=_e(j);ye===32||ye===9||ye===10||ye===13;)ye=_e(++j)},ge=function(){var ye=Be(),Oe,Ye;if(fe(),_e(j)===w){if(j++,Oe=ge(),Oe||O("Expected expression",j),fe(),_e(j)===I)return j++,Ye=ge(),Ye||O("Expected expression",j),{type:d,test:ye,consequent:Oe,alternate:Ye};O("Expected :",j)}else return ye},be=function(){fe();for(var ye,Oe=K.substr(j,v),Ye=Oe.length;Ye>0;){if(F.hasOwnProperty(Oe)&&(!G(_e(j))||j+Oe.length<K.length&&!k(_e(j+Oe.length))))return j+=Ye,Oe;Oe=Oe.substr(0,--Ye)}return!1},Be=function(){var ye,Oe,Ye,Xt,En,Vi,ki,Xi,li,Le;if(ki=ke(),Ye=be(),!Ye)return ki;for(Vi={value:Ye,prec:V(Ye)},Xi=ke(),Xi||O("Expected expression after "+Ye,j),En=[ki,Vi,Xi];(Ye=be())&&(Xt=V(Ye),Xt!==0);){for(Vi={value:Ye,prec:Xt},Le=Ye;En.length>2&&Xt<=En[En.length-2].prec;)Xi=En.pop(),Ye=En.pop().value,ki=En.pop(),Oe=H(Ye,ki,Xi),En.push(Oe);Oe=ke(),Oe||O("Expected expression after "+Le,j),En.push(Vi,Oe)}for(li=En.length-1,Oe=En[li];li>1;)Oe=H(En[li-1].value,En[li-2],Oe),li-=2;return Oe},ke=function(){var ye,Oe,Ye;if(fe(),ye=_e(j),U(ye)||ye===_)return qe();if(ye===p||ye===C)return Nt();if(ye===E)return oi();for(Oe=K.substr(j,b),Ye=Oe.length;Ye>0;){if(L.hasOwnProperty(Oe)&&(!G(_e(j))||j+Oe.length<K.length&&!k(_e(j+Oe.length))))return j+=Ye,{type:c,operator:Oe,argument:ke(),prefix:!0};Oe=Oe.substr(0,--Ye)}return G(ye)||ye===x?_t():!1},qe=function(){for(var ye="",Oe,Ye;U(_e(j));)ye+=me(j++);if(_e(j)===_)for(ye+=me(j++);U(_e(j));)ye+=me(j++);if(Oe=me(j),Oe==="e"||Oe==="E"){for(ye+=me(j++),Oe=me(j),(Oe==="+"||Oe==="-")&&(ye+=me(j++));U(_e(j));)ye+=me(j++);U(_e(j-1))||O("Expected exponent ("+ye+me(j)+")",j)}return Ye=_e(j),G(Ye)?O("Variable names cannot start with a number ("+ye+me(j)+")",j):Ye===_&&O("Unexpected period",j),{type:r,value:parseFloat(ye),raw:ye}},Nt=function(){for(var ye="",Oe=me(j++),Ye=!1,Xt;j<re;)if(Xt=me(j++),Xt===Oe){Ye=!0;break}else if(Xt==="\\")switch(Xt=me(j++),Xt){case"n":ye+=`
`;break;case"r":ye+="\r";break;case"t":ye+="	";break;case"b":ye+="\b";break;case"f":ye+="\f";break;case"v":ye+="\v";break;default:ye+=Xt}else ye+=Xt;return Ye||O('Unclosed quote after "'+ye+'"',j),{type:r,value:ye,raw:Oe+ye+Oe}},Wt=function(){var ye=_e(j),Oe=j,Ye;for(G(ye)?j++:O("Unexpected "+me(j),j);j<re&&(ye=_e(j),k(ye));)j++;return Ye=K.slice(Oe,j),P.hasOwnProperty(Ye)?{type:r,value:P[Ye],raw:Ye}:Ye===R?{type:s}:{type:i,name:Ye}},un=function(ye){for(var Oe,Ye=[],Xt,En=!1,Vi=0;j<re;)if(fe(),Oe=_e(j),Oe===ye){En=!0,j++,ye===T&&Vi&&Vi>=Ye.length&&O("Unexpected token "+String.fromCharCode(ye),j);break}else if(Oe===y){if(j++,Vi++,Vi!==Ye.length){if(ye===T)O("Unexpected token ,",j);else if(ye===S)for(var ki=Ye.length;ki<Vi;ki++)Ye.push(null)}}else Xt=ge(),(!Xt||Xt.type===n)&&O("Expected comma",j),Ye.push(Xt);return En||O("Expected "+String.fromCharCode(ye),j),Ye},_t=function(){var ye,Oe;for(ye=_e(j),ye===x?Oe=Rn():Oe=Wt(),fe(),ye=_e(j);ye===_||ye===E||ye===x;)j++,ye===_?(fe(),Oe={type:o,computed:!1,object:Oe,property:Wt()}):ye===E?(Oe={type:o,computed:!0,object:Oe,property:ge()},fe(),ye=_e(j),ye!==S&&O("Unclosed [",j),j++):ye===x&&(Oe={type:a,arguments:un(T),callee:Oe}),fe(),ye=_e(j);return Oe},Rn=function(){j++;var ye=ge();if(fe(),_e(j)===T)return j++,ye;O("Unclosed (",j)},oi=function(){return j++,{type:h,elements:un(S)}},lt=[],Yt,si;j<re;)Yt=_e(j),Yt===D||Yt===y?j++:(si=ge())?lt.push(si):j<re&&O('Unexpected "'+me(j)+'"',j);return lt.length===1?lt[0]:{type:n,body:lt}};if(X.version="0.3.5",X.toString=function(){return"JavaScript Expression Parser (JSEP) v"+X.version},X.addUnaryOp=function(K){return b=Math.max(K.length,b),L[K]=M,this},X.addBinaryOp=function(K,j){return v=Math.max(K.length,v),F[K]=j,this},X.addLiteral=function(K,j){return P[K]=j,this},X.removeUnaryOp=function(K){return delete L[K],K.length===b&&(b=g(L)),this},X.removeAllUnaryOps=function(){return L={},b=0,this},X.removeBinaryOp=function(K){return delete F[K],K.length===v&&(v=g(F)),this},X.removeAllBinaryOps=function(){return F={},v=0,this},X.removeLiteral=function(K){return delete P[K],this},X.removeAllLiterals=function(){return P={},this},typeof GS=="undefined"){var Y=t.jsep;t.jsep=X,X.noConflict=function(){return t.jsep===X&&(t.jsep=Y),X}}else typeof bL!="undefined"&&bL.exports?GS=bL.exports=X:GS.parse=X})(GS)});var Pne=Za((Cln,vne)=>{"use strict";vne.exports=Ike;var QS=1e20;function Ike(t,n){n||(n={});var i=n.cutoff==null?.25:n.cutoff,o=n.radius==null?8:n.radius,r=n.channel||0,s,a,c,l,u,d,h,_,y,p,C;if(ArrayBuffer.isView(t)||Array.isArray(t)){if(!n.width||!n.height)throw Error("For raw data width and height should be provided by options");s=n.width,a=n.height,l=t,n.stride?d=n.stride:d=Math.floor(t.length/s/a)}else window.HTMLCanvasElement&&t instanceof window.HTMLCanvasElement?(_=t,h=_.getContext("2d"),s=_.width,a=_.height,y=h.getImageData(0,0,s,a),l=y.data,d=4):window.CanvasRenderingContext2D&&t instanceof window.CanvasRenderingContext2D?(_=t.canvas,h=t,s=_.width,a=_.height,y=h.getImageData(0,0,s,a),l=y.data,d=4):window.ImageData&&t instanceof window.ImageData&&(y=t,s=t.width,a=t.height,l=y.data,d=4);if(c=Math.max(s,a),window.Uint8ClampedArray&&l instanceof window.Uint8ClampedArray||window.Uint8Array&&l instanceof window.Uint8Array)for(u=l,l=Array(s*a),p=0,C=Math.floor(u.length/d);p<C;p++)l[p]=u[p*d+r]/255;else if(d!==1)throw Error("Raw data can have only 1 value per pixel");var x=Array(s*a),T=Array(s*a),E=Array(c),S=Array(c),w=Array(c+1),D=Array(c);for(p=0,C=s*a;p<C;p++){var I=l[p];x[p]=I===1?0:I===0?QS:Math.pow(Math.max(0,.5-I),2),T[p]=I===1?QS:I===0?0:Math.pow(Math.max(0,I-.5),2)}wne(x,s,a,E,S,D,w),wne(T,s,a,E,S,D,w);var O=window.Float32Array?new Float32Array(s*a):new Array(s*a);for(p=0,C=s*a;p<C;p++)O[p]=Math.min(Math.max(1-((x[p]-T[p])/o+i),0),1);return O}function wne(t,n,i,o,r,s,a){for(var c=0;c<n;c++){for(var l=0;l<i;l++)o[l]=t[l*n+c];for(Dne(o,r,s,a,i),l=0;l<i;l++)t[l*n+c]=r[l]}for(l=0;l<i;l++){for(c=0;c<n;c++)o[c]=t[l*n+c];for(Dne(o,r,s,a,n),c=0;c<n;c++)t[l*n+c]=Math.sqrt(r[c])}}function Dne(t,n,i,o,r){i[0]=0,o[0]=-QS,o[1]=+QS;for(var s=1,a=0;s<r;s++){for(var c=(t[s]+s*s-(t[i[a]]+i[a]*i[a]))/(2*s-2*i[a]);c<=o[a];)a--,c=(t[s]+s*s-(t[i[a]]+i[a]*i[a]))/(2*s-2*i[a]);a++,i[a]=s,o[a]=c,o[a+1]=+QS}for(s=0,a=0;s<r;s++){for(;o[a+1]<s;)a++;n[s]=(s-i[a])*(s-i[a])+t[i[a]]}}});var Mne=Za((Nln,KL)=>{function zke(){var t=0,n=1,i=2,o=3,r=4,s=5,a=6,c=7,l=8,u=9,d=10,h=11,_=12,y=13,p=14,C=15,x=16,T=17,E=0,S=1,w=2,D=3,I=4;function O(g,b){return 55296<=g.charCodeAt(b)&&g.charCodeAt(b)<=56319&&56320<=g.charCodeAt(b+1)&&g.charCodeAt(b+1)<=57343}function M(g,b){b===void 0&&(b=0);var v=g.charCodeAt(b);if(55296<=v&&v<=56319&&b<g.length-1){var P=v,R=g.charCodeAt(b+1);return 56320<=R&&R<=57343?(P-55296)*1024+(R-56320)+65536:P}if(56320<=v&&v<=57343&&b>=1){var P=g.charCodeAt(b-1),R=v;return 55296<=P&&P<=56319?(P-55296)*1024+(R-56320)+65536:R}return v}function L(g,b,v){var P=[g].concat(b).concat([v]),R=P[P.length-2],V=v,H=P.lastIndexOf(p);if(H>1&&P.slice(1,H).every(function(k){return k==o})&&[o,y,T].indexOf(g)==-1)return w;var U=P.lastIndexOf(r);if(U>0&&P.slice(1,U).every(function(k){return k==r})&&[_,r].indexOf(R)==-1)return P.filter(function(k){return k==r}).length%2==1?D:I;if(R==t&&V==n)return E;if(R==i||R==t||R==n)return V==p&&b.every(function(k){return k==o})?w:S;if(V==i||V==t||V==n)return S;if(R==a&&(V==a||V==c||V==u||V==d))return E;if((R==u||R==c)&&(V==c||V==l))return E;if((R==d||R==l)&&V==l)return E;if(V==o||V==C)return E;if(V==s)return E;if(R==_)return E;var G=P.indexOf(o)!=-1?P.lastIndexOf(o)-1:P.length-2;return[y,T].indexOf(P[G])!=-1&&P.slice(G+1,-1).every(function(k){return k==o})&&V==p||R==C&&[x,T].indexOf(V)!=-1?E:b.indexOf(r)!=-1?w:R==r&&V==r?E:S}this.nextBreak=function(g,b){if(b===void 0&&(b=0),b<0)return 0;if(b>=g.length-1)return g.length;for(var v=F(M(g,b)),P=[],R=b+1;R<g.length;R++)if(!O(g,R-1)){var V=F(M(g,R));if(L(v,P,V))return R;P.push(V)}return g.length},this.splitGraphemes=function(g){for(var b=[],v=0,P;(P=this.nextBreak(g,v))<g.length;)b.push(g.slice(v,P)),v=P;return v<g.length&&b.push(g.slice(v)),b},this.iterateGraphemes=function(g){var b=0,v={next:function(){var P,R;return(R=this.nextBreak(g,b))<g.length?(P=g.slice(b,R),b=R,{value:P,done:!1}):b<g.length?(P=g.slice(b),b=g.length,{value:P,done:!1}):{value:void 0,done:!0}}.bind(this)};return typeof Symbol!="undefined"&&Symbol.iterator&&(v[Symbol.iterator]=function(){return v}),v},this.countGraphemes=function(g){for(var b=0,v=0,P;(P=this.nextBreak(g,v))<g.length;)v=P,b++;return v<g.length&&b++,b};function F(g){return 1536<=g&&g<=1541||g==1757||g==1807||g==2274||g==3406||g==69821||70082<=g&&g<=70083||g==72250||72326<=g&&g<=72329||g==73030?_:g==13?t:g==10?n:0<=g&&g<=9||11<=g&&g<=12||14<=g&&g<=31||127<=g&&g<=159||g==173||g==1564||g==6158||g==8203||8206<=g&&g<=8207||g==8232||g==8233||8234<=g&&g<=8238||8288<=g&&g<=8292||g==8293||8294<=g&&g<=8303||55296<=g&&g<=57343||g==65279||65520<=g&&g<=65528||65529<=g&&g<=65531||113824<=g&&g<=113827||119155<=g&&g<=119162||g==917504||g==917505||917506<=g&&g<=917535||917632<=g&&g<=917759||918e3<=g&&g<=921599?i:768<=g&&g<=879||1155<=g&&g<=1159||1160<=g&&g<=1161||1425<=g&&g<=1469||g==1471||1473<=g&&g<=1474||1476<=g&&g<=1477||g==1479||1552<=g&&g<=1562||1611<=g&&g<=1631||g==1648||1750<=g&&g<=1756||1759<=g&&g<=1764||1767<=g&&g<=1768||1770<=g&&g<=1773||g==1809||1840<=g&&g<=1866||1958<=g&&g<=1968||2027<=g&&g<=2035||2070<=g&&g<=2073||2075<=g&&g<=2083||2085<=g&&g<=2087||2089<=g&&g<=2093||2137<=g&&g<=2139||2260<=g&&g<=2273||2275<=g&&g<=2306||g==2362||g==2364||2369<=g&&g<=2376||g==2381||2385<=g&&g<=2391||2402<=g&&g<=2403||g==2433||g==2492||g==2494||2497<=g&&g<=2500||g==2509||g==2519||2530<=g&&g<=2531||2561<=g&&g<=2562||g==2620||2625<=g&&g<=2626||2631<=g&&g<=2632||2635<=g&&g<=2637||g==2641||2672<=g&&g<=2673||g==2677||2689<=g&&g<=2690||g==2748||2753<=g&&g<=2757||2759<=g&&g<=2760||g==2765||2786<=g&&g<=2787||2810<=g&&g<=2815||g==2817||g==2876||g==2878||g==2879||2881<=g&&g<=2884||g==2893||g==2902||g==2903||2914<=g&&g<=2915||g==2946||g==3006||g==3008||g==3021||g==3031||g==3072||3134<=g&&g<=3136||3142<=g&&g<=3144||3146<=g&&g<=3149||3157<=g&&g<=3158||3170<=g&&g<=3171||g==3201||g==3260||g==3263||g==3266||g==3270||3276<=g&&g<=3277||3285<=g&&g<=3286||3298<=g&&g<=3299||3328<=g&&g<=3329||3387<=g&&g<=3388||g==3390||3393<=g&&g<=3396||g==3405||g==3415||3426<=g&&g<=3427||g==3530||g==3535||3538<=g&&g<=3540||g==3542||g==3551||g==3633||3636<=g&&g<=3642||3655<=g&&g<=3662||g==3761||3764<=g&&g<=3769||3771<=g&&g<=3772||3784<=g&&g<=3789||3864<=g&&g<=3865||g==3893||g==3895||g==3897||3953<=g&&g<=3966||3968<=g&&g<=3972||3974<=g&&g<=3975||3981<=g&&g<=3991||3993<=g&&g<=4028||g==4038||4141<=g&&g<=4144||4146<=g&&g<=4151||4153<=g&&g<=4154||4157<=g&&g<=4158||4184<=g&&g<=4185||4190<=g&&g<=4192||4209<=g&&g<=4212||g==4226||4229<=g&&g<=4230||g==4237||g==4253||4957<=g&&g<=4959||5906<=g&&g<=5908||5938<=g&&g<=5940||5970<=g&&g<=5971||6002<=g&&g<=6003||6068<=g&&g<=6069||6071<=g&&g<=6077||g==6086||6089<=g&&g<=6099||g==6109||6155<=g&&g<=6157||6277<=g&&g<=6278||g==6313||6432<=g&&g<=6434||6439<=g&&g<=6440||g==6450||6457<=g&&g<=6459||6679<=g&&g<=6680||g==6683||g==6742||6744<=g&&g<=6750||g==6752||g==6754||6757<=g&&g<=6764||6771<=g&&g<=6780||g==6783||6832<=g&&g<=6845||g==6846||6912<=g&&g<=6915||g==6964||6966<=g&&g<=6970||g==6972||g==6978||7019<=g&&g<=7027||7040<=g&&g<=7041||7074<=g&&g<=7077||7080<=g&&g<=7081||7083<=g&&g<=7085||g==7142||7144<=g&&g<=7145||g==7149||7151<=g&&g<=7153||7212<=g&&g<=7219||7222<=g&&g<=7223||7376<=g&&g<=7378||7380<=g&&g<=7392||7394<=g&&g<=7400||g==7405||g==7412||7416<=g&&g<=7417||7616<=g&&g<=7673||7675<=g&&g<=7679||g==8204||8400<=g&&g<=8412||8413<=g&&g<=8416||g==8417||8418<=g&&g<=8420||8421<=g&&g<=8432||11503<=g&&g<=11505||g==11647||11744<=g&&g<=11775||12330<=g&&g<=12333||12334<=g&&g<=12335||12441<=g&&g<=12442||g==42607||42608<=g&&g<=42610||42612<=g&&g<=42621||42654<=g&&g<=42655||42736<=g&&g<=42737||g==43010||g==43014||g==43019||43045<=g&&g<=43046||43204<=g&&g<=43205||43232<=g&&g<=43249||43302<=g&&g<=43309||43335<=g&&g<=43345||43392<=g&&g<=43394||g==43443||43446<=g&&g<=43449||g==43452||g==43493||43561<=g&&g<=43566||43569<=g&&g<=43570||43573<=g&&g<=43574||g==43587||g==43596||g==43644||g==43696||43698<=g&&g<=43700||43703<=g&&g<=43704||43710<=g&&g<=43711||g==43713||43756<=g&&g<=43757||g==43766||g==44005||g==44008||g==44013||g==64286||65024<=g&&g<=65039||65056<=g&&g<=65071||65438<=g&&g<=65439||g==66045||g==66272||66422<=g&&g<=66426||68097<=g&&g<=68099||68101<=g&&g<=68102||68108<=g&&g<=68111||68152<=g&&g<=68154||g==68159||68325<=g&&g<=68326||g==69633||69688<=g&&g<=69702||69759<=g&&g<=69761||69811<=g&&g<=69814||69817<=g&&g<=69818||69888<=g&&g<=69890||69927<=g&&g<=69931||69933<=g&&g<=69940||g==70003||70016<=g&&g<=70017||70070<=g&&g<=70078||70090<=g&&g<=70092||70191<=g&&g<=70193||g==70196||70198<=g&&g<=70199||g==70206||g==70367||70371<=g&&g<=70378||70400<=g&&g<=70401||g==70460||g==70462||g==70464||g==70487||70502<=g&&g<=70508||70512<=g&&g<=70516||70712<=g&&g<=70719||70722<=g&&g<=70724||g==70726||g==70832||70835<=g&&g<=70840||g==70842||g==70845||70847<=g&&g<=70848||70850<=g&&g<=70851||g==71087||71090<=g&&g<=71093||71100<=g&&g<=71101||71103<=g&&g<=71104||71132<=g&&g<=71133||71219<=g&&g<=71226||g==71229||71231<=g&&g<=71232||g==71339||g==71341||71344<=g&&g<=71349||g==71351||71453<=g&&g<=71455||71458<=g&&g<=71461||71463<=g&&g<=71467||72193<=g&&g<=72198||72201<=g&&g<=72202||72243<=g&&g<=72248||72251<=g&&g<=72254||g==72263||72273<=g&&g<=72278||72281<=g&&g<=72283||72330<=g&&g<=72342||72344<=g&&g<=72345||72752<=g&&g<=72758||72760<=g&&g<=72765||g==72767||72850<=g&&g<=72871||72874<=g&&g<=72880||72882<=g&&g<=72883||72885<=g&&g<=72886||73009<=g&&g<=73014||g==73018||73020<=g&&g<=73021||73023<=g&&g<=73029||g==73031||92912<=g&&g<=92916||92976<=g&&g<=92982||94095<=g&&g<=94098||113821<=g&&g<=113822||g==119141||119143<=g&&g<=119145||119150<=g&&g<=119154||119163<=g&&g<=119170||119173<=g&&g<=119179||119210<=g&&g<=119213||119362<=g&&g<=119364||121344<=g&&g<=121398||121403<=g&&g<=121452||g==121461||g==121476||121499<=g&&g<=121503||121505<=g&&g<=121519||122880<=g&&g<=122886||122888<=g&&g<=122904||122907<=g&&g<=122913||122915<=g&&g<=122916||122918<=g&&g<=122922||125136<=g&&g<=125142||125252<=g&&g<=125258||917536<=g&&g<=917631||917760<=g&&g<=917999?o:127462<=g&&g<=127487?r:g==2307||g==2363||2366<=g&&g<=2368||2377<=g&&g<=2380||2382<=g&&g<=2383||2434<=g&&g<=2435||2495<=g&&g<=2496||2503<=g&&g<=2504||2507<=g&&g<=2508||g==2563||2622<=g&&g<=2624||g==2691||2750<=g&&g<=2752||g==2761||2763<=g&&g<=2764||2818<=g&&g<=2819||g==2880||2887<=g&&g<=2888||2891<=g&&g<=2892||g==3007||3009<=g&&g<=3010||3014<=g&&g<=3016||3018<=g&&g<=3020||3073<=g&&g<=3075||3137<=g&&g<=3140||3202<=g&&g<=3203||g==3262||3264<=g&&g<=3265||3267<=g&&g<=3268||3271<=g&&g<=3272||3274<=g&&g<=3275||3330<=g&&g<=3331||3391<=g&&g<=3392||3398<=g&&g<=3400||3402<=g&&g<=3404||3458<=g&&g<=3459||3536<=g&&g<=3537||3544<=g&&g<=3550||3570<=g&&g<=3571||g==3635||g==3763||3902<=g&&g<=3903||g==3967||g==4145||4155<=g&&g<=4156||4182<=g&&g<=4183||g==4228||g==6070||6078<=g&&g<=6085||6087<=g&&g<=6088||6435<=g&&g<=6438||6441<=g&&g<=6443||6448<=g&&g<=6449||6451<=g&&g<=6456||6681<=g&&g<=6682||g==6741||g==6743||6765<=g&&g<=6770||g==6916||g==6965||g==6971||6973<=g&&g<=6977||6979<=g&&g<=6980||g==7042||g==7073||7078<=g&&g<=7079||g==7082||g==7143||7146<=g&&g<=7148||g==7150||7154<=g&&g<=7155||7204<=g&&g<=7211||7220<=g&&g<=7221||g==7393||7410<=g&&g<=7411||g==7415||43043<=g&&g<=43044||g==43047||43136<=g&&g<=43137||43188<=g&&g<=43203||43346<=g&&g<=43347||g==43395||43444<=g&&g<=43445||43450<=g&&g<=43451||43453<=g&&g<=43456||43567<=g&&g<=43568||43571<=g&&g<=43572||g==43597||g==43755||43758<=g&&g<=43759||g==43765||44003<=g&&g<=44004||44006<=g&&g<=44007||44009<=g&&g<=44010||g==44012||g==69632||g==69634||g==69762||69808<=g&&g<=69810||69815<=g&&g<=69816||g==69932||g==70018||70067<=g&&g<=70069||70079<=g&&g<=70080||70188<=g&&g<=70190||70194<=g&&g<=70195||g==70197||70368<=g&&g<=70370||70402<=g&&g<=70403||g==70463||70465<=g&&g<=70468||70471<=g&&g<=70472||70475<=g&&g<=70477||70498<=g&&g<=70499||70709<=g&&g<=70711||70720<=g&&g<=70721||g==70725||70833<=g&&g<=70834||g==70841||70843<=g&&g<=70844||g==70846||g==70849||71088<=g&&g<=71089||71096<=g&&g<=71099||g==71102||71216<=g&&g<=71218||71227<=g&&g<=71228||g==71230||g==71340||71342<=g&&g<=71343||g==71350||71456<=g&&g<=71457||g==71462||72199<=g&&g<=72200||g==72249||72279<=g&&g<=72280||g==72343||g==72751||g==72766||g==72873||g==72881||g==72884||94033<=g&&g<=94078||g==119142||g==119149?s:4352<=g&&g<=4447||43360<=g&&g<=43388?a:4448<=g&&g<=4519||55216<=g&&g<=55238?c:4520<=g&&g<=4607||55243<=g&&g<=55291?l:g==44032||g==44060||g==44088||g==44116||g==44144||g==44172||g==44200||g==44228||g==44256||g==44284||g==44312||g==44340||g==44368||g==44396||g==44424||g==44452||g==44480||g==44508||g==44536||g==44564||g==44592||g==44620||g==44648||g==44676||g==44704||g==44732||g==44760||g==44788||g==44816||g==44844||g==44872||g==44900||g==44928||g==44956||g==44984||g==45012||g==45040||g==45068||g==45096||g==45124||g==45152||g==45180||g==45208||g==45236||g==45264||g==45292||g==45320||g==45348||g==45376||g==45404||g==45432||g==45460||g==45488||g==45516||g==45544||g==45572||g==45600||g==45628||g==45656||g==45684||g==45712||g==45740||g==45768||g==45796||g==45824||g==45852||g==45880||g==45908||g==45936||g==45964||g==45992||g==46020||g==46048||g==46076||g==46104||g==46132||g==46160||g==46188||g==46216||g==46244||g==46272||g==46300||g==46328||g==46356||g==46384||g==46412||g==46440||g==46468||g==46496||g==46524||g==46552||g==46580||g==46608||g==46636||g==46664||g==46692||g==46720||g==46748||g==46776||g==46804||g==46832||g==46860||g==46888||g==46916||g==46944||g==46972||g==47e3||g==47028||g==47056||g==47084||g==47112||g==47140||g==47168||g==47196||g==47224||g==47252||g==47280||g==47308||g==47336||g==47364||g==47392||g==47420||g==47448||g==47476||g==47504||g==47532||g==47560||g==47588||g==47616||g==47644||g==47672||g==47700||g==47728||g==47756||g==47784||g==47812||g==47840||g==47868||g==47896||g==47924||g==47952||g==47980||g==48008||g==48036||g==48064||g==48092||g==48120||g==48148||g==48176||g==48204||g==48232||g==48260||g==48288||g==48316||g==48344||g==48372||g==48400||g==48428||g==48456||g==48484||g==48512||g==48540||g==48568||g==48596||g==48624||g==48652||g==48680||g==48708||g==48736||g==48764||g==48792||g==48820||g==48848||g==48876||g==48904||g==48932||g==48960||g==48988||g==49016||g==49044||g==49072||g==49100||g==49128||g==49156||g==49184||g==49212||g==49240||g==49268||g==49296||g==49324||g==49352||g==49380||g==49408||g==49436||g==49464||g==49492||g==49520||g==49548||g==49576||g==49604||g==49632||g==49660||g==49688||g==49716||g==49744||g==49772||g==49800||g==49828||g==49856||g==49884||g==49912||g==49940||g==49968||g==49996||g==50024||g==50052||g==50080||g==50108||g==50136||g==50164||g==50192||g==50220||g==50248||g==50276||g==50304||g==50332||g==50360||g==50388||g==50416||g==50444||g==50472||g==50500||g==50528||g==50556||g==50584||g==50612||g==50640||g==50668||g==50696||g==50724||g==50752||g==50780||g==50808||g==50836||g==50864||g==50892||g==50920||g==50948||g==50976||g==51004||g==51032||g==51060||g==51088||g==51116||g==51144||g==51172||g==51200||g==51228||g==51256||g==51284||g==51312||g==51340||g==51368||g==51396||g==51424||g==51452||g==51480||g==51508||g==51536||g==51564||g==51592||g==51620||g==51648||g==51676||g==51704||g==51732||g==51760||g==51788||g==51816||g==51844||g==51872||g==51900||g==51928||g==51956||g==51984||g==52012||g==52040||g==52068||g==52096||g==52124||g==52152||g==52180||g==52208||g==52236||g==52264||g==52292||g==52320||g==52348||g==52376||g==52404||g==52432||g==52460||g==52488||g==52516||g==52544||g==52572||g==52600||g==52628||g==52656||g==52684||g==52712||g==52740||g==52768||g==52796||g==52824||g==52852||g==52880||g==52908||g==52936||g==52964||g==52992||g==53020||g==53048||g==53076||g==53104||g==53132||g==53160||g==53188||g==53216||g==53244||g==53272||g==53300||g==53328||g==53356||g==53384||g==53412||g==53440||g==53468||g==53496||g==53524||g==53552||g==53580||g==53608||g==53636||g==53664||g==53692||g==53720||g==53748||g==53776||g==53804||g==53832||g==53860||g==53888||g==53916||g==53944||g==53972||g==54e3||g==54028||g==54056||g==54084||g==54112||g==54140||g==54168||g==54196||g==54224||g==54252||g==54280||g==54308||g==54336||g==54364||g==54392||g==54420||g==54448||g==54476||g==54504||g==54532||g==54560||g==54588||g==54616||g==54644||g==54672||g==54700||g==54728||g==54756||g==54784||g==54812||g==54840||g==54868||g==54896||g==54924||g==54952||g==54980||g==55008||g==55036||g==55064||g==55092||g==55120||g==55148||g==55176?u:44033<=g&&g<=44059||44061<=g&&g<=44087||44089<=g&&g<=44115||44117<=g&&g<=44143||44145<=g&&g<=44171||44173<=g&&g<=44199||44201<=g&&g<=44227||44229<=g&&g<=44255||44257<=g&&g<=44283||44285<=g&&g<=44311||44313<=g&&g<=44339||44341<=g&&g<=44367||44369<=g&&g<=44395||44397<=g&&g<=44423||44425<=g&&g<=44451||44453<=g&&g<=44479||44481<=g&&g<=44507||44509<=g&&g<=44535||44537<=g&&g<=44563||44565<=g&&g<=44591||44593<=g&&g<=44619||44621<=g&&g<=44647||44649<=g&&g<=44675||44677<=g&&g<=44703||44705<=g&&g<=44731||44733<=g&&g<=44759||44761<=g&&g<=44787||44789<=g&&g<=44815||44817<=g&&g<=44843||44845<=g&&g<=44871||44873<=g&&g<=44899||44901<=g&&g<=44927||44929<=g&&g<=44955||44957<=g&&g<=44983||44985<=g&&g<=45011||45013<=g&&g<=45039||45041<=g&&g<=45067||45069<=g&&g<=45095||45097<=g&&g<=45123||45125<=g&&g<=45151||45153<=g&&g<=45179||45181<=g&&g<=45207||45209<=g&&g<=45235||45237<=g&&g<=45263||45265<=g&&g<=45291||45293<=g&&g<=45319||45321<=g&&g<=45347||45349<=g&&g<=45375||45377<=g&&g<=45403||45405<=g&&g<=45431||45433<=g&&g<=45459||45461<=g&&g<=45487||45489<=g&&g<=45515||45517<=g&&g<=45543||45545<=g&&g<=45571||45573<=g&&g<=45599||45601<=g&&g<=45627||45629<=g&&g<=45655||45657<=g&&g<=45683||45685<=g&&g<=45711||45713<=g&&g<=45739||45741<=g&&g<=45767||45769<=g&&g<=45795||45797<=g&&g<=45823||45825<=g&&g<=45851||45853<=g&&g<=45879||45881<=g&&g<=45907||45909<=g&&g<=45935||45937<=g&&g<=45963||45965<=g&&g<=45991||45993<=g&&g<=46019||46021<=g&&g<=46047||46049<=g&&g<=46075||46077<=g&&g<=46103||46105<=g&&g<=46131||46133<=g&&g<=46159||46161<=g&&g<=46187||46189<=g&&g<=46215||46217<=g&&g<=46243||46245<=g&&g<=46271||46273<=g&&g<=46299||46301<=g&&g<=46327||46329<=g&&g<=46355||46357<=g&&g<=46383||46385<=g&&g<=46411||46413<=g&&g<=46439||46441<=g&&g<=46467||46469<=g&&g<=46495||46497<=g&&g<=46523||46525<=g&&g<=46551||46553<=g&&g<=46579||46581<=g&&g<=46607||46609<=g&&g<=46635||46637<=g&&g<=46663||46665<=g&&g<=46691||46693<=g&&g<=46719||46721<=g&&g<=46747||46749<=g&&g<=46775||46777<=g&&g<=46803||46805<=g&&g<=46831||46833<=g&&g<=46859||46861<=g&&g<=46887||46889<=g&&g<=46915||46917<=g&&g<=46943||46945<=g&&g<=46971||46973<=g&&g<=46999||47001<=g&&g<=47027||47029<=g&&g<=47055||47057<=g&&g<=47083||47085<=g&&g<=47111||47113<=g&&g<=47139||47141<=g&&g<=47167||47169<=g&&g<=47195||47197<=g&&g<=47223||47225<=g&&g<=47251||47253<=g&&g<=47279||47281<=g&&g<=47307||47309<=g&&g<=47335||47337<=g&&g<=47363||47365<=g&&g<=47391||47393<=g&&g<=47419||47421<=g&&g<=47447||47449<=g&&g<=47475||47477<=g&&g<=47503||47505<=g&&g<=47531||47533<=g&&g<=47559||47561<=g&&g<=47587||47589<=g&&g<=47615||47617<=g&&g<=47643||47645<=g&&g<=47671||47673<=g&&g<=47699||47701<=g&&g<=47727||47729<=g&&g<=47755||47757<=g&&g<=47783||47785<=g&&g<=47811||47813<=g&&g<=47839||47841<=g&&g<=47867||47869<=g&&g<=47895||47897<=g&&g<=47923||47925<=g&&g<=47951||47953<=g&&g<=47979||47981<=g&&g<=48007||48009<=g&&g<=48035||48037<=g&&g<=48063||48065<=g&&g<=48091||48093<=g&&g<=48119||48121<=g&&g<=48147||48149<=g&&g<=48175||48177<=g&&g<=48203||48205<=g&&g<=48231||48233<=g&&g<=48259||48261<=g&&g<=48287||48289<=g&&g<=48315||48317<=g&&g<=48343||48345<=g&&g<=48371||48373<=g&&g<=48399||48401<=g&&g<=48427||48429<=g&&g<=48455||48457<=g&&g<=48483||48485<=g&&g<=48511||48513<=g&&g<=48539||48541<=g&&g<=48567||48569<=g&&g<=48595||48597<=g&&g<=48623||48625<=g&&g<=48651||48653<=g&&g<=48679||48681<=g&&g<=48707||48709<=g&&g<=48735||48737<=g&&g<=48763||48765<=g&&g<=48791||48793<=g&&g<=48819||48821<=g&&g<=48847||48849<=g&&g<=48875||48877<=g&&g<=48903||48905<=g&&g<=48931||48933<=g&&g<=48959||48961<=g&&g<=48987||48989<=g&&g<=49015||49017<=g&&g<=49043||49045<=g&&g<=49071||49073<=g&&g<=49099||49101<=g&&g<=49127||49129<=g&&g<=49155||49157<=g&&g<=49183||49185<=g&&g<=49211||49213<=g&&g<=49239||49241<=g&&g<=49267||49269<=g&&g<=49295||49297<=g&&g<=49323||49325<=g&&g<=49351||49353<=g&&g<=49379||49381<=g&&g<=49407||49409<=g&&g<=49435||49437<=g&&g<=49463||49465<=g&&g<=49491||49493<=g&&g<=49519||49521<=g&&g<=49547||49549<=g&&g<=49575||49577<=g&&g<=49603||49605<=g&&g<=49631||49633<=g&&g<=49659||49661<=g&&g<=49687||49689<=g&&g<=49715||49717<=g&&g<=49743||49745<=g&&g<=49771||49773<=g&&g<=49799||49801<=g&&g<=49827||49829<=g&&g<=49855||49857<=g&&g<=49883||49885<=g&&g<=49911||49913<=g&&g<=49939||49941<=g&&g<=49967||49969<=g&&g<=49995||49997<=g&&g<=50023||50025<=g&&g<=50051||50053<=g&&g<=50079||50081<=g&&g<=50107||50109<=g&&g<=50135||50137<=g&&g<=50163||50165<=g&&g<=50191||50193<=g&&g<=50219||50221<=g&&g<=50247||50249<=g&&g<=50275||50277<=g&&g<=50303||50305<=g&&g<=50331||50333<=g&&g<=50359||50361<=g&&g<=50387||50389<=g&&g<=50415||50417<=g&&g<=50443||50445<=g&&g<=50471||50473<=g&&g<=50499||50501<=g&&g<=50527||50529<=g&&g<=50555||50557<=g&&g<=50583||50585<=g&&g<=50611||50613<=g&&g<=50639||50641<=g&&g<=50667||50669<=g&&g<=50695||50697<=g&&g<=50723||50725<=g&&g<=50751||50753<=g&&g<=50779||50781<=g&&g<=50807||50809<=g&&g<=50835||50837<=g&&g<=50863||50865<=g&&g<=50891||50893<=g&&g<=50919||50921<=g&&g<=50947||50949<=g&&g<=50975||50977<=g&&g<=51003||51005<=g&&g<=51031||51033<=g&&g<=51059||51061<=g&&g<=51087||51089<=g&&g<=51115||51117<=g&&g<=51143||51145<=g&&g<=51171||51173<=g&&g<=51199||51201<=g&&g<=51227||51229<=g&&g<=51255||51257<=g&&g<=51283||51285<=g&&g<=51311||51313<=g&&g<=51339||51341<=g&&g<=51367||51369<=g&&g<=51395||51397<=g&&g<=51423||51425<=g&&g<=51451||51453<=g&&g<=51479||51481<=g&&g<=51507||51509<=g&&g<=51535||51537<=g&&g<=51563||51565<=g&&g<=51591||51593<=g&&g<=51619||51621<=g&&g<=51647||51649<=g&&g<=51675||51677<=g&&g<=51703||51705<=g&&g<=51731||51733<=g&&g<=51759||51761<=g&&g<=51787||51789<=g&&g<=51815||51817<=g&&g<=51843||51845<=g&&g<=51871||51873<=g&&g<=51899||51901<=g&&g<=51927||51929<=g&&g<=51955||51957<=g&&g<=51983||51985<=g&&g<=52011||52013<=g&&g<=52039||52041<=g&&g<=52067||52069<=g&&g<=52095||52097<=g&&g<=52123||52125<=g&&g<=52151||52153<=g&&g<=52179||52181<=g&&g<=52207||52209<=g&&g<=52235||52237<=g&&g<=52263||52265<=g&&g<=52291||52293<=g&&g<=52319||52321<=g&&g<=52347||52349<=g&&g<=52375||52377<=g&&g<=52403||52405<=g&&g<=52431||52433<=g&&g<=52459||52461<=g&&g<=52487||52489<=g&&g<=52515||52517<=g&&g<=52543||52545<=g&&g<=52571||52573<=g&&g<=52599||52601<=g&&g<=52627||52629<=g&&g<=52655||52657<=g&&g<=52683||52685<=g&&g<=52711||52713<=g&&g<=52739||52741<=g&&g<=52767||52769<=g&&g<=52795||52797<=g&&g<=52823||52825<=g&&g<=52851||52853<=g&&g<=52879||52881<=g&&g<=52907||52909<=g&&g<=52935||52937<=g&&g<=52963||52965<=g&&g<=52991||52993<=g&&g<=53019||53021<=g&&g<=53047||53049<=g&&g<=53075||53077<=g&&g<=53103||53105<=g&&g<=53131||53133<=g&&g<=53159||53161<=g&&g<=53187||53189<=g&&g<=53215||53217<=g&&g<=53243||53245<=g&&g<=53271||53273<=g&&g<=53299||53301<=g&&g<=53327||53329<=g&&g<=53355||53357<=g&&g<=53383||53385<=g&&g<=53411||53413<=g&&g<=53439||53441<=g&&g<=53467||53469<=g&&g<=53495||53497<=g&&g<=53523||53525<=g&&g<=53551||53553<=g&&g<=53579||53581<=g&&g<=53607||53609<=g&&g<=53635||53637<=g&&g<=53663||53665<=g&&g<=53691||53693<=g&&g<=53719||53721<=g&&g<=53747||53749<=g&&g<=53775||53777<=g&&g<=53803||53805<=g&&g<=53831||53833<=g&&g<=53859||53861<=g&&g<=53887||53889<=g&&g<=53915||53917<=g&&g<=53943||53945<=g&&g<=53971||53973<=g&&g<=53999||54001<=g&&g<=54027||54029<=g&&g<=54055||54057<=g&&g<=54083||54085<=g&&g<=54111||54113<=g&&g<=54139||54141<=g&&g<=54167||54169<=g&&g<=54195||54197<=g&&g<=54223||54225<=g&&g<=54251||54253<=g&&g<=54279||54281<=g&&g<=54307||54309<=g&&g<=54335||54337<=g&&g<=54363||54365<=g&&g<=54391||54393<=g&&g<=54419||54421<=g&&g<=54447||54449<=g&&g<=54475||54477<=g&&g<=54503||54505<=g&&g<=54531||54533<=g&&g<=54559||54561<=g&&g<=54587||54589<=g&&g<=54615||54617<=g&&g<=54643||54645<=g&&g<=54671||54673<=g&&g<=54699||54701<=g&&g<=54727||54729<=g&&g<=54755||54757<=g&&g<=54783||54785<=g&&g<=54811||54813<=g&&g<=54839||54841<=g&&g<=54867||54869<=g&&g<=54895||54897<=g&&g<=54923||54925<=g&&g<=54951||54953<=g&&g<=54979||54981<=g&&g<=55007||55009<=g&&g<=55035||55037<=g&&g<=55063||55065<=g&&g<=55091||55093<=g&&g<=55119||55121<=g&&g<=55147||55149<=g&&g<=55175||55177<=g&&g<=55203?d:g==9757||g==9977||9994<=g&&g<=9997||g==127877||127938<=g&&g<=127940||g==127943||127946<=g&&g<=127948||128066<=g&&g<=128067||128070<=g&&g<=128080||g==128110||128112<=g&&g<=128120||g==128124||128129<=g&&g<=128131||128133<=g&&g<=128135||g==128170||128372<=g&&g<=128373||g==128378||g==128400||128405<=g&&g<=128406||128581<=g&&g<=128583||128587<=g&&g<=128591||g==128675||128692<=g&&g<=128694||g==128704||g==128716||129304<=g&&g<=129308||129310<=g&&g<=129311||g==129318||129328<=g&&g<=129337||129341<=g&&g<=129342||129489<=g&&g<=129501?y:127995<=g&&g<=127999?p:g==8205?C:g==9792||g==9794||9877<=g&&g<=9878||g==9992||g==10084||g==127752||g==127806||g==127859||g==127891||g==127908||g==127912||g==127979||g==127981||g==128139||128187<=g&&g<=128188||g==128295||g==128300||g==128488||g==128640||g==128658?x:128102<=g&&g<=128105?T:h}return this}typeof KL!="undefined"&&KL.exports&&(KL.exports=zke)});var Eie=Za((Mmn,N5)=>{"use strict";N5.exports=yF;N5.exports.default=yF;function yF(t,n,i){i=i||2;var o=n&&n.length,r=o?n[0]*i:t.length,s=Cie(t,0,r,i,!0),a=[];if(!s||s.next===s.prev)return a;var c,l,u,d,h,_,y;if(o&&(s=Aze(t,n,s,i)),t.length>80*i){c=u=t[0],l=d=t[1];for(var p=i;p<r;p+=i)h=t[p],_=t[p+1],h<c&&(c=h),_<l&&(l=_),h>u&&(u=h),_>d&&(d=_);y=Math.max(u-c,d-l),y=y!==0?32767/y:0}return yw(s,a,i,c,l,y,0),a}function Cie(t,n,i,o,r){var s,a;if(r===F5(t,n,i,o)>0)for(s=n;s<i;s+=o)a=Aie(s,t[s],t[s+1],a);else for(s=i-o;s>=n;s-=o)a=Aie(s,t[s],t[s+1],a);return a&&AF(a,a.next)&&(Cw(a),a=a.next),a}function _y(t,n){if(!t)return t;n||(n=t);var i=t,o;do if(o=!1,!i.steiner&&(AF(i,i.next)||xr(i.prev,i,i.next)===0)){if(Cw(i),i=n=i.prev,i===i.next)break;o=!0}else i=i.next;while(o||i!==n);return n}function yw(t,n,i,o,r,s,a){if(!!t){!a&&s&&bze(t,o,r,s);for(var c=t,l,u;t.prev!==t.next;){if(l=t.prev,u=t.next,s?_ze(t,o,r,s):pze(t)){n.push(l.i/i|0),n.push(t.i/i|0),n.push(u.i/i|0),Cw(t),t=u.next,c=u.next;continue}if(t=u,t===c){a?a===1?(t=gze(_y(t),n,i),yw(t,n,i,o,r,s,2)):a===2&&yze(t,n,i,o,r,s):yw(_y(t),n,i,o,r,s,1);break}}}}function pze(t){var n=t.prev,i=t,o=t.next;if(xr(n,i,o)>=0)return!1;for(var r=n.x,s=i.x,a=o.x,c=n.y,l=i.y,u=o.y,d=r<s?r<a?r:a:s<a?s:a,h=c<l?c<u?c:u:l<u?l:u,_=r>s?r>a?r:a:s>a?s:a,y=c>l?c>u?c:u:l>u?l:u,p=o.next;p!==n;){if(p.x>=d&&p.x<=_&&p.y>=h&&p.y<=y&&Ux(r,c,s,l,a,u,p.x,p.y)&&xr(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function _ze(t,n,i,o){var r=t.prev,s=t,a=t.next;if(xr(r,s,a)>=0)return!1;for(var c=r.x,l=s.x,u=a.x,d=r.y,h=s.y,_=a.y,y=c<l?c<u?c:u:l<u?l:u,p=d<h?d<_?d:_:h<_?h:_,C=c>l?c>u?c:u:l>u?l:u,x=d>h?d>_?d:_:h>_?h:_,T=M5(y,p,n,i,o),E=M5(C,x,n,i,o),S=t.prevZ,w=t.nextZ;S&&S.z>=T&&w&&w.z<=E;){if(S.x>=y&&S.x<=C&&S.y>=p&&S.y<=x&&S!==r&&S!==a&&Ux(c,d,l,h,u,_,S.x,S.y)&&xr(S.prev,S,S.next)>=0||(S=S.prevZ,w.x>=y&&w.x<=C&&w.y>=p&&w.y<=x&&w!==r&&w!==a&&Ux(c,d,l,h,u,_,w.x,w.y)&&xr(w.prev,w,w.next)>=0))return!1;w=w.nextZ}for(;S&&S.z>=T;){if(S.x>=y&&S.x<=C&&S.y>=p&&S.y<=x&&S!==r&&S!==a&&Ux(c,d,l,h,u,_,S.x,S.y)&&xr(S.prev,S,S.next)>=0)return!1;S=S.prevZ}for(;w&&w.z<=E;){if(w.x>=y&&w.x<=C&&w.y>=p&&w.y<=x&&w!==r&&w!==a&&Ux(c,d,l,h,u,_,w.x,w.y)&&xr(w.prev,w,w.next)>=0)return!1;w=w.nextZ}return!0}function gze(t,n,i){var o=t;do{var r=o.prev,s=o.next.next;!AF(r,s)&&xie(r,o,o.next,s)&&Aw(r,s)&&Aw(s,r)&&(n.push(r.i/i|0),n.push(o.i/i|0),n.push(s.i/i|0),Cw(o),Cw(o.next),o=t=s),o=o.next}while(o!==t);return _y(o)}function yze(t,n,i,o,r,s){var a=t;do{for(var c=a.next.next;c!==a.prev;){if(a.i!==c.i&&Dze(a,c)){var l=Tie(a,c);a=_y(a,a.next),l=_y(l,l.next),yw(a,n,i,o,r,s,0),yw(l,n,i,o,r,s,0);return}c=c.next}a=a.next}while(a!==t)}function Aze(t,n,i,o){var r=[],s,a,c,l,u;for(s=0,a=n.length;s<a;s++)c=n[s]*o,l=s<a-1?n[s+1]*o:t.length,u=Cie(t,c,l,o,!1),u===u.next&&(u.steiner=!0),r.push(wze(u));for(r.sort(Cze),s=0;s<r.length;s++)i=xze(r[s],i);return i}function Cze(t,n){return t.x-n.x}function xze(t,n){var i=Tze(t,n);if(!i)return n;var o=Tie(i,t);return _y(o,o.next),_y(i,i.next)}function Tze(t,n){var i=n,o=t.x,r=t.y,s=-1/0,a;do{if(r<=i.y&&r>=i.next.y&&i.next.y!==i.y){var c=i.x+(r-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(c<=o&&c>s&&(s=c,a=i.x<i.next.x?i:i.next,c===o))return a}i=i.next}while(i!==n);if(!a)return null;var l=a,u=a.x,d=a.y,h=1/0,_;i=a;do o>=i.x&&i.x>=u&&o!==i.x&&Ux(r<d?o:s,r,u,d,r<d?s:o,r,i.x,i.y)&&(_=Math.abs(r-i.y)/(o-i.x),Aw(i,t)&&(_<h||_===h&&(i.x>a.x||i.x===a.x&&Eze(a,i)))&&(a=i,h=_)),i=i.next;while(i!==l);return a}function Eze(t,n){return xr(t.prev,t,n.prev)<0&&xr(n.next,t,t.next)<0}function bze(t,n,i,o){var r=t;do r.z===0&&(r.z=M5(r.x,r.y,n,i,o)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,Sze(r)}function Sze(t){var n,i,o,r,s,a,c,l,u=1;do{for(i=t,t=null,s=null,a=0;i;){for(a++,o=i,c=0,n=0;n<u&&(c++,o=o.nextZ,!!o);n++);for(l=u;c>0||l>0&&o;)c!==0&&(l===0||!o||i.z<=o.z)?(r=i,i=i.nextZ,c--):(r=o,o=o.nextZ,l--),s?s.nextZ=r:t=r,r.prevZ=s,s=r;i=o}s.nextZ=null,u*=2}while(a>1);return t}function M5(t,n,i,o,r){return t=(t-i)*r|0,n=(n-o)*r|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,t|n<<1}function wze(t){var n=t,i=t;do(n.x<i.x||n.x===i.x&&n.y<i.y)&&(i=n),n=n.next;while(n!==t);return i}function Ux(t,n,i,o,r,s,a,c){return(r-a)*(n-c)>=(t-a)*(s-c)&&(t-a)*(o-c)>=(i-a)*(n-c)&&(i-a)*(s-c)>=(r-a)*(o-c)}function Dze(t,n){return t.next.i!==n.i&&t.prev.i!==n.i&&!vze(t,n)&&(Aw(t,n)&&Aw(n,t)&&Pze(t,n)&&(xr(t.prev,t,n.prev)||xr(t,n.prev,n))||AF(t,n)&&xr(t.prev,t,t.next)>0&&xr(n.prev,n,n.next)>0)}function xr(t,n,i){return(n.y-t.y)*(i.x-n.x)-(n.x-t.x)*(i.y-n.y)}function AF(t,n){return t.x===n.x&&t.y===n.y}function xie(t,n,i,o){var r=gF(xr(t,n,i)),s=gF(xr(t,n,o)),a=gF(xr(i,o,t)),c=gF(xr(i,o,n));return!!(r!==s&&a!==c||r===0&&_F(t,i,n)||s===0&&_F(t,o,n)||a===0&&_F(i,t,o)||c===0&&_F(i,n,o))}function _F(t,n,i){return n.x<=Math.max(t.x,i.x)&&n.x>=Math.min(t.x,i.x)&&n.y<=Math.max(t.y,i.y)&&n.y>=Math.min(t.y,i.y)}function gF(t){return t>0?1:t<0?-1:0}function vze(t,n){var i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==n.i&&i.next.i!==n.i&&xie(i,i.next,t,n))return!0;i=i.next}while(i!==t);return!1}function Aw(t,n){return xr(t.prev,t,t.next)<0?xr(t,n,t.next)>=0&&xr(t,t.prev,n)>=0:xr(t,n,t.prev)<0||xr(t,t.next,n)<0}function Pze(t,n){var i=t,o=!1,r=(t.x+n.x)/2,s=(t.y+n.y)/2;do i.y>s!=i.next.y>s&&i.next.y!==i.y&&r<(i.next.x-i.x)*(s-i.y)/(i.next.y-i.y)+i.x&&(o=!o),i=i.next;while(i!==t);return o}function Tie(t,n){var i=new L5(t.i,t.x,t.y),o=new L5(n.i,n.x,n.y),r=t.next,s=n.prev;return t.next=n,n.prev=t,i.next=r,r.prev=i,o.next=i,i.prev=o,s.next=o,o.prev=s,o}function Aie(t,n,i,o){var r=new L5(t,n,i);return o?(r.next=o.next,r.prev=o,o.next.prev=r,o.next=r):(r.prev=r,r.next=r),r}function Cw(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function L5(t,n,i){this.i=t,this.x=n,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}yF.deviation=function(t,n,i,o){var r=n&&n.length,s=r?n[0]*i:t.length,a=Math.abs(F5(t,0,s,i));if(r)for(var c=0,l=n.length;c<l;c++){var u=n[c]*i,d=c<l-1?n[c+1]*i:t.length;a-=Math.abs(F5(t,u,d,i))}var h=0;for(c=0;c<o.length;c+=3){var _=o[c]*i,y=o[c+1]*i,p=o[c+2]*i;h+=Math.abs((t[_]-t[p])*(t[y+1]-t[_+1])-(t[_]-t[y])*(t[p+1]-t[_+1]))}return a===0&&h===0?0:Math.abs((h-a)/a)};function F5(t,n,i,o){for(var r=0,s=n,a=i-o;s<i;s+=o)r+=(t[a]-t[s])*(t[s+1]+t[a+1]),a=s;return r}yF.flatten=function(t){for(var n=t[0][0].length,i={vertices:[],holes:[],dimensions:n},o=0,r=0;r<t.length;r++){for(var s=0;s<t[r].length;s++)for(var a=0;a<n;a++)i.vertices.push(t[r][s][a]);r>0&&(o+=t[r-1].length,i.holes.push(o))}return i}});var Fae=Za((h9,m9)=>{(function(t,n){typeof h9=="object"&&typeof m9!="undefined"?m9.exports=n():typeof define=="function"&&define.amd?define(n):(t=t||self).RBush=n()})(h9,function(){"use strict";function t(x,T,E,S,w){(function D(I,O,M,L,F){for(;L>M;){if(L-M>600){var g=L-M+1,b=O-M+1,v=Math.log(g),P=.5*Math.exp(2*v/3),R=.5*Math.sqrt(v*P*(g-P)/g)*(b-g/2<0?-1:1),V=Math.max(M,Math.floor(O-b*P/g+R)),H=Math.min(L,Math.floor(O+(g-b)*P/g+R));D(I,O,V,H,F)}var U=I[O],G=M,k=L;for(n(I,M,O),F(I[L],U)>0&&n(I,M,L);G<k;){for(n(I,G,k),G++,k--;F(I[G],U)<0;)G++;for(;F(I[k],U)>0;)k--}F(I[M],U)===0?n(I,M,k):n(I,++k,L),k<=O&&(M=k+1),O<=k&&(L=k-1)}})(x,T,E||0,S||x.length-1,w||i)}function n(x,T,E){var S=x[T];x[T]=x[E],x[E]=S}function i(x,T){return x<T?-1:x>T?1:0}var o=function(x){x===void 0&&(x=9),this._maxEntries=Math.max(4,x),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function r(x,T,E){if(!E)return T.indexOf(x);for(var S=0;S<T.length;S++)if(E(x,T[S]))return S;return-1}function s(x,T){a(x,0,x.children.length,T,x)}function a(x,T,E,S,w){w||(w=p(null)),w.minX=1/0,w.minY=1/0,w.maxX=-1/0,w.maxY=-1/0;for(var D=T;D<E;D++){var I=x.children[D];c(w,x.leaf?S(I):I)}return w}function c(x,T){return x.minX=Math.min(x.minX,T.minX),x.minY=Math.min(x.minY,T.minY),x.maxX=Math.max(x.maxX,T.maxX),x.maxY=Math.max(x.maxY,T.maxY),x}function l(x,T){return x.minX-T.minX}function u(x,T){return x.minY-T.minY}function d(x){return(x.maxX-x.minX)*(x.maxY-x.minY)}function h(x){return x.maxX-x.minX+(x.maxY-x.minY)}function _(x,T){return x.minX<=T.minX&&x.minY<=T.minY&&T.maxX<=x.maxX&&T.maxY<=x.maxY}function y(x,T){return T.minX<=x.maxX&&T.minY<=x.maxY&&T.maxX>=x.minX&&T.maxY>=x.minY}function p(x){return{children:x,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function C(x,T,E,S,w){for(var D=[T,E];D.length;)if(!((E=D.pop())-(T=D.pop())<=S)){var I=T+Math.ceil((E-T)/S/2)*S;t(x,I,T,E,w),D.push(T,I,I,E)}}return o.prototype.all=function(){return this._all(this.data,[])},o.prototype.search=function(x){var T=this.data,E=[];if(!y(x,T))return E;for(var S=this.toBBox,w=[];T;){for(var D=0;D<T.children.length;D++){var I=T.children[D],O=T.leaf?S(I):I;y(x,O)&&(T.leaf?E.push(I):_(x,O)?this._all(I,E):w.push(I))}T=w.pop()}return E},o.prototype.collides=function(x){var T=this.data;if(!y(x,T))return!1;for(var E=[];T;){for(var S=0;S<T.children.length;S++){var w=T.children[S],D=T.leaf?this.toBBox(w):w;if(y(x,D)){if(T.leaf||_(x,D))return!0;E.push(w)}}T=E.pop()}return!1},o.prototype.load=function(x){if(!x||!x.length)return this;if(x.length<this._minEntries){for(var T=0;T<x.length;T++)this.insert(x[T]);return this}var E=this._build(x.slice(),0,x.length-1,0);if(this.data.children.length)if(this.data.height===E.height)this._splitRoot(this.data,E);else{if(this.data.height<E.height){var S=this.data;this.data=E,E=S}this._insert(E,this.data.height-E.height-1,!0)}else this.data=E;return this},o.prototype.insert=function(x){return x&&this._insert(x,this.data.height-1),this},o.prototype.clear=function(){return this.data=p([]),this},o.prototype.remove=function(x,T){if(!x)return this;for(var E,S,w,D=this.data,I=this.toBBox(x),O=[],M=[];D||O.length;){if(D||(D=O.pop(),S=O[O.length-1],E=M.pop(),w=!0),D.leaf){var L=r(x,D.children,T);if(L!==-1)return D.children.splice(L,1),O.push(D),this._condense(O),this}w||D.leaf||!_(D,I)?S?(E++,D=S.children[E],w=!1):D=null:(O.push(D),M.push(E),E=0,S=D,D=D.children[0])}return this},o.prototype.toBBox=function(x){return x},o.prototype.compareMinX=function(x,T){return x.minX-T.minX},o.prototype.compareMinY=function(x,T){return x.minY-T.minY},o.prototype.toJSON=function(){return this.data},o.prototype.fromJSON=function(x){return this.data=x,this},o.prototype._all=function(x,T){for(var E=[];x;)x.leaf?T.push.apply(T,x.children):E.push.apply(E,x.children),x=E.pop();return T},o.prototype._build=function(x,T,E,S){var w,D=E-T+1,I=this._maxEntries;if(D<=I)return s(w=p(x.slice(T,E+1)),this.toBBox),w;S||(S=Math.ceil(Math.log(D)/Math.log(I)),I=Math.ceil(D/Math.pow(I,S-1))),(w=p([])).leaf=!1,w.height=S;var O=Math.ceil(D/I),M=O*Math.ceil(Math.sqrt(I));C(x,T,E,M,this.compareMinX);for(var L=T;L<=E;L+=M){var F=Math.min(L+M-1,E);C(x,L,F,O,this.compareMinY);for(var g=L;g<=F;g+=O){var b=Math.min(g+O-1,F);w.children.push(this._build(x,g,b,S-1))}}return s(w,this.toBBox),w},o.prototype._chooseSubtree=function(x,T,E,S){for(;S.push(T),!T.leaf&&S.length-1!==E;){for(var w=1/0,D=1/0,I=void 0,O=0;O<T.children.length;O++){var M=T.children[O],L=d(M),F=(g=x,b=M,(Math.max(b.maxX,g.maxX)-Math.min(b.minX,g.minX))*(Math.max(b.maxY,g.maxY)-Math.min(b.minY,g.minY))-L);F<D?(D=F,w=L<w?L:w,I=M):F===D&&L<w&&(w=L,I=M)}T=I||T.children[0]}var g,b;return T},o.prototype._insert=function(x,T,E){var S=E?x:this.toBBox(x),w=[],D=this._chooseSubtree(S,this.data,T,w);for(D.children.push(x),c(D,S);T>=0&&w[T].children.length>this._maxEntries;)this._split(w,T),T--;this._adjustParentBBoxes(S,w,T)},o.prototype._split=function(x,T){var E=x[T],S=E.children.length,w=this._minEntries;this._chooseSplitAxis(E,w,S);var D=this._chooseSplitIndex(E,w,S),I=p(E.children.splice(D,E.children.length-D));I.height=E.height,I.leaf=E.leaf,s(E,this.toBBox),s(I,this.toBBox),T?x[T-1].children.push(I):this._splitRoot(E,I)},o.prototype._splitRoot=function(x,T){this.data=p([x,T]),this.data.height=x.height+1,this.data.leaf=!1,s(this.data,this.toBBox)},o.prototype._chooseSplitIndex=function(x,T,E){for(var S,w,D,I,O,M,L,F=1/0,g=1/0,b=T;b<=E-T;b++){var v=a(x,0,b,this.toBBox),P=a(x,b,E,this.toBBox),R=(w=v,D=P,I=void 0,O=void 0,M=void 0,L=void 0,I=Math.max(w.minX,D.minX),O=Math.max(w.minY,D.minY),M=Math.min(w.maxX,D.maxX),L=Math.min(w.maxY,D.maxY),Math.max(0,M-I)*Math.max(0,L-O)),V=d(v)+d(P);R<F?(F=R,S=b,g=V<g?V:g):R===F&&V<g&&(g=V,S=b)}return S||E-T},o.prototype._chooseSplitAxis=function(x,T,E){var S=x.leaf?this.compareMinX:l,w=x.leaf?this.compareMinY:u;this._allDistMargin(x,T,E,S)<this._allDistMargin(x,T,E,w)&&x.children.sort(S)},o.prototype._allDistMargin=function(x,T,E,S){x.children.sort(S);for(var w=this.toBBox,D=a(x,0,T,w),I=a(x,E-T,E,w),O=h(D)+h(I),M=T;M<E-T;M++){var L=x.children[M];c(D,x.leaf?w(L):L),O+=h(D)}for(var F=E-T-1;F>=T;F--){var g=x.children[F];c(I,x.leaf?w(g):g),O+=h(I)}return O},o.prototype._adjustParentBBoxes=function(x,T,E){for(var S=E;S>=0;S--)c(T[S],x)},o.prototype._condense=function(x){for(var T=x.length-1,E=void 0;T>=0;T--)x[T].children.length===0?T>0?(E=x[T-1].children).splice(E.indexOf(x[T]),1):this.clear():s(x[T],this.toBBox)},o})});var m7=Za((exports,module)=>{/*!
 * protobuf.js v7.1.0 (c) 2016, daniel wirtz
 * compiled fri, 09 sep 2022 03:02:57 utc
 * licensed under the bsd-3-clause license
 * see: https://github.com/dcodeio/protobuf.js for details
 */(function(undefined){"use strict";(function(n,i,o){function r(a){var c=i[a];return c||n[a][0].call(c=i[a]={exports:{}},r,c,c.exports),c.exports}var s=r(o[0]);s.util.global.protobuf=s,typeof define=="function"&&define.amd&&define(["long"],function(a){return a&&a.isLong&&(s.util.Long=a,s.configure()),s}),typeof module=="object"&&module&&module.exports&&(module.exports=s)})({1:[function(t,n,i){"use strict";n.exports=o;function o(r,s){for(var a=new Array(arguments.length-1),c=0,l=2,u=!0;l<arguments.length;)a[c++]=arguments[l++];return new Promise(function(h,_){a[c]=function(p){if(u)if(u=!1,p)_(p);else{for(var C=new Array(arguments.length-1),x=0;x<C.length;)C[x++]=arguments[x];h.apply(null,C)}};try{r.apply(s||null,a)}catch(y){u&&(u=!1,_(y))}})}},{}],2:[function(t,n,i){"use strict";var o=i;o.length=function(u){var d=u.length;if(!d)return 0;for(var h=0;--d%4>1&&u.charAt(d)==="=";)++h;return Math.ceil(u.length*3)/4-h};for(var r=new Array(64),s=new Array(123),a=0;a<64;)s[r[a]=a<26?a+65:a<52?a+71:a<62?a-4:a-59|43]=a++;o.encode=function(u,d,h){for(var _=null,y=[],p=0,C=0,x;d<h;){var T=u[d++];switch(C){case 0:y[p++]=r[T>>2],x=(T&3)<<4,C=1;break;case 1:y[p++]=r[x|T>>4],x=(T&15)<<2,C=2;break;case 2:y[p++]=r[x|T>>6],y[p++]=r[T&63],C=0;break}p>8191&&((_||(_=[])).push(String.fromCharCode.apply(String,y)),p=0)}return C&&(y[p++]=r[x],y[p++]=61,C===1&&(y[p++]=61)),_?(p&&_.push(String.fromCharCode.apply(String,y.slice(0,p))),_.join("")):String.fromCharCode.apply(String,y.slice(0,p))};var c="invalid encoding";o.decode=function(u,d,h){for(var _=h,y=0,p,C=0;C<u.length;){var x=u.charCodeAt(C++);if(x===61&&y>1)break;if((x=s[x])===undefined)throw Error(c);switch(y){case 0:p=x,y=1;break;case 1:d[h++]=p<<2|(x&48)>>4,p=x,y=2;break;case 2:d[h++]=(p&15)<<4|(x&60)>>2,p=x,y=3;break;case 3:d[h++]=(p&3)<<6|x,y=0;break}}if(y===1)throw Error(c);return h-_},o.test=function(u){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(u)}},{}],3:[function(t,n,i){"use strict";n.exports=o;function o(){this._listeners={}}o.prototype.on=function(s,a,c){return(this._listeners[s]||(this._listeners[s]=[])).push({fn:a,ctx:c||this}),this},o.prototype.off=function(s,a){if(s===undefined)this._listeners={};else if(a===undefined)this._listeners[s]=[];else for(var c=this._listeners[s],l=0;l<c.length;)c[l].fn===a?c.splice(l,1):++l;return this},o.prototype.emit=function(s){var a=this._listeners[s];if(a){for(var c=[],l=1;l<arguments.length;)c.push(arguments[l++]);for(l=0;l<a.length;)a[l].fn.apply(a[l++].ctx,c)}return this}},{}],4:[function(t,n,i){"use strict";n.exports=o(o);function o(l){return typeof Float32Array!="undefined"?function(){var u=new Float32Array([-0]),d=new Uint8Array(u.buffer),h=d[3]===128;function _(x,T,E){u[0]=x,T[E]=d[0],T[E+1]=d[1],T[E+2]=d[2],T[E+3]=d[3]}function y(x,T,E){u[0]=x,T[E]=d[3],T[E+1]=d[2],T[E+2]=d[1],T[E+3]=d[0]}l.writeFloatLE=h?_:y,l.writeFloatBE=h?y:_;function p(x,T){return d[0]=x[T],d[1]=x[T+1],d[2]=x[T+2],d[3]=x[T+3],u[0]}function C(x,T){return d[3]=x[T],d[2]=x[T+1],d[1]=x[T+2],d[0]=x[T+3],u[0]}l.readFloatLE=h?p:C,l.readFloatBE=h?C:p}():function(){function u(h,_,y,p){var C=_<0?1:0;if(C&&(_=-_),_===0)h(1/_>0?0:2147483648,y,p);else if(isNaN(_))h(2143289344,y,p);else if(_>34028234663852886e22)h((C<<31|2139095040)>>>0,y,p);else if(_<11754943508222875e-54)h((C<<31|Math.round(_/1401298464324817e-60))>>>0,y,p);else{var x=Math.floor(Math.log(_)/Math.LN2),T=Math.round(_*Math.pow(2,-x)*8388608)&8388607;h((C<<31|x+127<<23|T)>>>0,y,p)}}l.writeFloatLE=u.bind(null,r),l.writeFloatBE=u.bind(null,s);function d(h,_,y){var p=h(_,y),C=(p>>31)*2+1,x=p>>>23&255,T=p&8388607;return x===255?T?NaN:C*(1/0):x===0?C*1401298464324817e-60*T:C*Math.pow(2,x-150)*(T+8388608)}l.readFloatLE=d.bind(null,a),l.readFloatBE=d.bind(null,c)}(),typeof Float64Array!="undefined"?function(){var u=new Float64Array([-0]),d=new Uint8Array(u.buffer),h=d[7]===128;function _(x,T,E){u[0]=x,T[E]=d[0],T[E+1]=d[1],T[E+2]=d[2],T[E+3]=d[3],T[E+4]=d[4],T[E+5]=d[5],T[E+6]=d[6],T[E+7]=d[7]}function y(x,T,E){u[0]=x,T[E]=d[7],T[E+1]=d[6],T[E+2]=d[5],T[E+3]=d[4],T[E+4]=d[3],T[E+5]=d[2],T[E+6]=d[1],T[E+7]=d[0]}l.writeDoubleLE=h?_:y,l.writeDoubleBE=h?y:_;function p(x,T){return d[0]=x[T],d[1]=x[T+1],d[2]=x[T+2],d[3]=x[T+3],d[4]=x[T+4],d[5]=x[T+5],d[6]=x[T+6],d[7]=x[T+7],u[0]}function C(x,T){return d[7]=x[T],d[6]=x[T+1],d[5]=x[T+2],d[4]=x[T+3],d[3]=x[T+4],d[2]=x[T+5],d[1]=x[T+6],d[0]=x[T+7],u[0]}l.readDoubleLE=h?p:C,l.readDoubleBE=h?C:p}():function(){function u(h,_,y,p,C,x){var T=p<0?1:0;if(T&&(p=-p),p===0)h(0,C,x+_),h(1/p>0?0:2147483648,C,x+y);else if(isNaN(p))h(0,C,x+_),h(2146959360,C,x+y);else if(p>17976931348623157e292)h(0,C,x+_),h((T<<31|2146435072)>>>0,C,x+y);else{var E;if(p<22250738585072014e-324)E=p/5e-324,h(E>>>0,C,x+_),h((T<<31|E/4294967296)>>>0,C,x+y);else{var S=Math.floor(Math.log(p)/Math.LN2);S===1024&&(S=1023),E=p*Math.pow(2,-S),h(E*4503599627370496>>>0,C,x+_),h((T<<31|S+1023<<20|E*1048576&1048575)>>>0,C,x+y)}}}l.writeDoubleLE=u.bind(null,r,0,4),l.writeDoubleBE=u.bind(null,s,4,0);function d(h,_,y,p,C){var x=h(p,C+_),T=h(p,C+y),E=(T>>31)*2+1,S=T>>>20&2047,w=4294967296*(T&1048575)+x;return S===2047?w?NaN:E*(1/0):S===0?E*5e-324*w:E*Math.pow(2,S-1075)*(w+4503599627370496)}l.readDoubleLE=d.bind(null,a,0,4),l.readDoubleBE=d.bind(null,c,4,0)}(),l}function r(l,u,d){u[d]=l&255,u[d+1]=l>>>8&255,u[d+2]=l>>>16&255,u[d+3]=l>>>24}function s(l,u,d){u[d]=l>>>24,u[d+1]=l>>>16&255,u[d+2]=l>>>8&255,u[d+3]=l&255}function a(l,u){return(l[u]|l[u+1]<<8|l[u+2]<<16|l[u+3]<<24)>>>0}function c(l,u){return(l[u]<<24|l[u+1]<<16|l[u+2]<<8|l[u+3])>>>0}},{}],5:[function(require,module,exports){"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(t){}return null}},{}],6:[function(t,n,i){"use strict";n.exports=o;function o(r,s,a){var c=a||8192,l=c>>>1,u=null,d=c;return function(_){if(_<1||_>l)return r(_);d+_>c&&(u=r(c),d=0);var y=s.call(u,d,d+=_);return d&7&&(d=(d|7)+1),y}}},{}],7:[function(t,n,i){"use strict";var o=i;o.length=function(s){for(var a=0,c=0,l=0;l<s.length;++l)c=s.charCodeAt(l),c<128?a+=1:c<2048?a+=2:(c&64512)===55296&&(s.charCodeAt(l+1)&64512)===56320?(++l,a+=4):a+=3;return a},o.read=function(s,a,c){var l=c-a;if(l<1)return"";for(var u=null,d=[],h=0,_;a<c;)_=s[a++],_<128?d[h++]=_:_>191&&_<224?d[h++]=(_&31)<<6|s[a++]&63:_>239&&_<365?(_=((_&7)<<18|(s[a++]&63)<<12|(s[a++]&63)<<6|s[a++]&63)-65536,d[h++]=55296+(_>>10),d[h++]=56320+(_&1023)):d[h++]=(_&15)<<12|(s[a++]&63)<<6|s[a++]&63,h>8191&&((u||(u=[])).push(String.fromCharCode.apply(String,d)),h=0);return u?(h&&u.push(String.fromCharCode.apply(String,d.slice(0,h))),u.join("")):String.fromCharCode.apply(String,d.slice(0,h))},o.write=function(s,a,c){for(var l=c,u,d,h=0;h<s.length;++h)u=s.charCodeAt(h),u<128?a[c++]=u:u<2048?(a[c++]=u>>6|192,a[c++]=u&63|128):(u&64512)===55296&&((d=s.charCodeAt(h+1))&64512)===56320?(u=65536+((u&1023)<<10)+(d&1023),++h,a[c++]=u>>18|240,a[c++]=u>>12&63|128,a[c++]=u>>6&63|128,a[c++]=u&63|128):(a[c++]=u>>12|224,a[c++]=u>>6&63|128,a[c++]=u&63|128);return c-l}},{}],8:[function(t,n,i){"use strict";var o=i;o.build="minimal",o.Writer=t(16),o.BufferWriter=t(17),o.Reader=t(9),o.BufferReader=t(10),o.util=t(15),o.rpc=t(12),o.roots=t(11),o.configure=r;function r(){o.util._configure(),o.Writer._configure(o.BufferWriter),o.Reader._configure(o.BufferReader)}r()},{10:10,11:11,12:12,15:15,16:16,17:17,9:9}],9:[function(t,n,i){"use strict";n.exports=l;var o=t(15),r,s=o.LongBits,a=o.utf8;function c(p,C){return RangeError("index out of range: "+p.pos+" + "+(C||1)+" > "+p.len)}function l(p){this.buf=p,this.pos=0,this.len=p.length}var u=typeof Uint8Array!="undefined"?function(C){if(C instanceof Uint8Array||Array.isArray(C))return new l(C);throw Error("illegal buffer")}:function(C){if(Array.isArray(C))return new l(C);throw Error("illegal buffer")},d=function(){return o.Buffer?function(x){return(l.create=function(E){return o.Buffer.isBuffer(E)?new r(E):u(E)})(x)}:u};l.create=d(),l.prototype._slice=o.Array.prototype.subarray||o.Array.prototype.slice,l.prototype.uint32=function(){var C=4294967295;return function(){if(C=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(C=(C|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(C=(C|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(C=(C|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(C=(C|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return C;if((this.pos+=5)>this.len)throw this.pos=this.len,c(this,10);return C}}(),l.prototype.int32=function(){return this.uint32()|0},l.prototype.sint32=function(){var C=this.uint32();return C>>>1^-(C&1)|0};function h(){var p=new s(0,0),C=0;if(this.len-this.pos>4){for(;C<4;++C)if(p.lo=(p.lo|(this.buf[this.pos]&127)<<C*7)>>>0,this.buf[this.pos++]<128)return p;if(p.lo=(p.lo|(this.buf[this.pos]&127)<<28)>>>0,p.hi=(p.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return p;C=0}else{for(;C<3;++C){if(this.pos>=this.len)throw c(this);if(p.lo=(p.lo|(this.buf[this.pos]&127)<<C*7)>>>0,this.buf[this.pos++]<128)return p}return p.lo=(p.lo|(this.buf[this.pos++]&127)<<C*7)>>>0,p}if(this.len-this.pos>4){for(;C<5;++C)if(p.hi=(p.hi|(this.buf[this.pos]&127)<<C*7+3)>>>0,this.buf[this.pos++]<128)return p}else for(;C<5;++C){if(this.pos>=this.len)throw c(this);if(p.hi=(p.hi|(this.buf[this.pos]&127)<<C*7+3)>>>0,this.buf[this.pos++]<128)return p}throw Error("invalid varint encoding")}l.prototype.bool=function(){return this.uint32()!==0};function _(p,C){return(p[C-4]|p[C-3]<<8|p[C-2]<<16|p[C-1]<<24)>>>0}l.prototype.fixed32=function(){if(this.pos+4>this.len)throw c(this,4);return _(this.buf,this.pos+=4)},l.prototype.sfixed32=function(){if(this.pos+4>this.len)throw c(this,4);return _(this.buf,this.pos+=4)|0};function y(){if(this.pos+8>this.len)throw c(this,8);return new s(_(this.buf,this.pos+=4),_(this.buf,this.pos+=4))}l.prototype.float=function(){if(this.pos+4>this.len)throw c(this,4);var C=o.float.readFloatLE(this.buf,this.pos);return this.pos+=4,C},l.prototype.double=function(){if(this.pos+8>this.len)throw c(this,4);var C=o.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,C},l.prototype.bytes=function(){var C=this.uint32(),x=this.pos,T=this.pos+C;if(T>this.len)throw c(this,C);return this.pos+=C,Array.isArray(this.buf)?this.buf.slice(x,T):x===T?new this.buf.constructor(0):this._slice.call(this.buf,x,T)},l.prototype.string=function(){var C=this.bytes();return a.read(C,0,C.length)},l.prototype.skip=function(C){if(typeof C=="number"){if(this.pos+C>this.len)throw c(this,C);this.pos+=C}else do if(this.pos>=this.len)throw c(this);while(this.buf[this.pos++]&128);return this},l.prototype.skipType=function(p){switch(p){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(p=this.uint32()&7)!==4;)this.skipType(p);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+p+" at offset "+this.pos)}return this},l._configure=function(p){r=p,l.create=d(),r._configure();var C=o.Long?"toLong":"toNumber";o.merge(l.prototype,{int64:function(){return h.call(this)[C](!1)},uint64:function(){return h.call(this)[C](!0)},sint64:function(){return h.call(this).zzDecode()[C](!1)},fixed64:function(){return y.call(this)[C](!0)},sfixed64:function(){return y.call(this)[C](!1)}})}},{15:15}],10:[function(t,n,i){"use strict";n.exports=s;var o=t(9);(s.prototype=Object.create(o.prototype)).constructor=s;var r=t(15);function s(a){o.call(this,a)}s._configure=function(){r.Buffer&&(s.prototype._slice=r.Buffer.prototype.slice)},s.prototype.string=function(){var c=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+c,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+c,this.len))},s._configure()},{15:15,9:9}],11:[function(t,n,i){"use strict";n.exports={}},{}],12:[function(t,n,i){"use strict";var o=i;o.Service=t(13)},{13:13}],13:[function(t,n,i){"use strict";n.exports=r;var o=t(15);(r.prototype=Object.create(o.EventEmitter.prototype)).constructor=r;function r(s,a,c){if(typeof s!="function")throw TypeError("rpcImpl must be a function");o.EventEmitter.call(this),this.rpcImpl=s,this.requestDelimited=Boolean(a),this.responseDelimited=Boolean(c)}r.prototype.rpcCall=function s(a,c,l,u,d){if(!u)throw TypeError("request must be specified");var h=this;if(!d)return o.asPromise(s,h,a,c,l,u);if(!h.rpcImpl)return setTimeout(function(){d(Error("already ended"))},0),undefined;try{return h.rpcImpl(a,c[h.requestDelimited?"encodeDelimited":"encode"](u).finish(),function(y,p){if(y)return h.emit("error",y,a),d(y);if(p===null)return h.end(!0),undefined;if(!(p instanceof l))try{p=l[h.responseDelimited?"decodeDelimited":"decode"](p)}catch(C){return h.emit("error",C,a),d(C)}return h.emit("data",p,a),d(null,p)})}catch(_){return h.emit("error",_,a),setTimeout(function(){d(_)},0),undefined}},r.prototype.end=function(a){return this.rpcImpl&&(a||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},{15:15}],14:[function(t,n,i){"use strict";n.exports=r;var o=t(15);function r(l,u){this.lo=l>>>0,this.hi=u>>>0}var s=r.zero=new r(0,0);s.toNumber=function(){return 0},s.zzEncode=s.zzDecode=function(){return this},s.length=function(){return 1};var a=r.zeroHash="\0\0\0\0\0\0\0\0";r.fromNumber=function(u){if(u===0)return s;var d=u<0;d&&(u=-u);var h=u>>>0,_=(u-h)/4294967296>>>0;return d&&(_=~_>>>0,h=~h>>>0,++h>4294967295&&(h=0,++_>4294967295&&(_=0))),new r(h,_)},r.from=function(u){if(typeof u=="number")return r.fromNumber(u);if(o.isString(u))if(o.Long)u=o.Long.fromString(u);else return r.fromNumber(parseInt(u,10));return u.low||u.high?new r(u.low>>>0,u.high>>>0):s},r.prototype.toNumber=function(u){if(!u&&this.hi>>>31){var d=~this.lo+1>>>0,h=~this.hi>>>0;return d||(h=h+1>>>0),-(d+h*4294967296)}return this.lo+this.hi*4294967296},r.prototype.toLong=function(u){return o.Long?new o.Long(this.lo|0,this.hi|0,Boolean(u)):{low:this.lo|0,high:this.hi|0,unsigned:Boolean(u)}};var c=String.prototype.charCodeAt;r.fromHash=function(u){return u===a?s:new r((c.call(u,0)|c.call(u,1)<<8|c.call(u,2)<<16|c.call(u,3)<<24)>>>0,(c.call(u,4)|c.call(u,5)<<8|c.call(u,6)<<16|c.call(u,7)<<24)>>>0)},r.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},r.prototype.zzEncode=function(){var u=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^u)>>>0,this.lo=(this.lo<<1^u)>>>0,this},r.prototype.zzDecode=function(){var u=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^u)>>>0,this.hi=(this.hi>>>1^u)>>>0,this},r.prototype.length=function(){var u=this.lo,d=(this.lo>>>28|this.hi<<4)>>>0,h=this.hi>>>24;return h===0?d===0?u<16384?u<128?1:2:u<2097152?3:4:d<16384?d<128?5:6:d<2097152?7:8:h<128?9:10}},{15:15}],15:[function(t,n,i){"use strict";var o=i;o.asPromise=t(1),o.base64=t(2),o.EventEmitter=t(3),o.float=t(4),o.inquire=t(5),o.utf8=t(7),o.pool=t(6),o.LongBits=t(14),o.isNode=Boolean(typeof global!="undefined"&&global&&global.process&&global.process.versions&&global.process.versions.node),o.global=o.isNode&&global||typeof window!="undefined"&&window||typeof self!="undefined"&&self||this,o.emptyArray=Object.freeze?Object.freeze([]):[],o.emptyObject=Object.freeze?Object.freeze({}):{},o.isInteger=Number.isInteger||function(c){return typeof c=="number"&&isFinite(c)&&Math.floor(c)===c},o.isString=function(c){return typeof c=="string"||c instanceof String},o.isObject=function(c){return c&&typeof c=="object"},o.isset=o.isSet=function(c,l){var u=c[l];return u!=null&&c.hasOwnProperty(l)?typeof u!="object"||(Array.isArray(u)?u.length:Object.keys(u).length)>0:!1},o.Buffer=function(){try{var a=o.inquire("buffer").Buffer;return a.prototype.utf8Write?a:null}catch(c){return null}}(),o._Buffer_from=null,o._Buffer_allocUnsafe=null,o.newBuffer=function(c){return typeof c=="number"?o.Buffer?o._Buffer_allocUnsafe(c):new o.Array(c):o.Buffer?o._Buffer_from(c):typeof Uint8Array=="undefined"?c:new Uint8Array(c)},o.Array=typeof Uint8Array!="undefined"?Uint8Array:Array,o.Long=o.global.dcodeIO&&o.global.dcodeIO.Long||o.global.Long||o.inquire("long"),o.key2Re=/^true|false|0|1$/,o.key32Re=/^-?(?:0|[1-9][0-9]*)$/,o.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,o.longToHash=function(c){return c?o.LongBits.from(c).toHash():o.LongBits.zeroHash},o.longFromHash=function(c,l){var u=o.LongBits.fromHash(c);return o.Long?o.Long.fromBits(u.lo,u.hi,l):u.toNumber(Boolean(l))};function r(a,c,l){for(var u=Object.keys(c),d=0;d<u.length;++d)(a[u[d]]===undefined||!l)&&(a[u[d]]=c[u[d]]);return a}o.merge=r,o.lcFirst=function(c){return c.charAt(0).toLowerCase()+c.substring(1)};function s(a){function c(l,u){if(!(this instanceof c))return new c(l,u);Object.defineProperty(this,"message",{get:function(){return l}}),Error.captureStackTrace?Error.captureStackTrace(this,c):Object.defineProperty(this,"stack",{value:new Error().stack||""}),u&&r(this,u)}return c.prototype=Object.create(Error.prototype,{constructor:{value:c,writable:!0,enumerable:!1,configurable:!0},name:{get(){return a},set:undefined,enumerable:!1,configurable:!0},toString:{value(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),c}o.newError=s,o.ProtocolError=s("ProtocolError"),o.oneOfGetter=function(c){for(var l={},u=0;u<c.length;++u)l[c[u]]=1;return function(){for(var d=Object.keys(this),h=d.length-1;h>-1;--h)if(l[d[h]]===1&&this[d[h]]!==undefined&&this[d[h]]!==null)return d[h]}},o.oneOfSetter=function(c){return function(l){for(var u=0;u<c.length;++u)c[u]!==l&&delete this[c[u]]}},o.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},o._configure=function(){var a=o.Buffer;if(!a){o._Buffer_from=o._Buffer_allocUnsafe=null;return}o._Buffer_from=a.from!==Uint8Array.from&&a.from||function(l,u){return new a(l,u)},o._Buffer_allocUnsafe=a.allocUnsafe||function(l){return new a(l)}}},{1:1,14:14,2:2,3:3,4:4,5:5,6:6,7:7}],16:[function(t,n,i){"use strict";n.exports=h;var o=t(15),r,s=o.LongBits,a=o.base64,c=o.utf8;function l(S,w,D){this.fn=S,this.len=w,this.next=undefined,this.val=D}function u(){}function d(S){this.head=S.head,this.tail=S.tail,this.len=S.len,this.next=S.states}function h(){this.len=0,this.head=new l(u,0,0),this.tail=this.head,this.states=null}var _=function(){return o.Buffer?function(){return(h.create=function(){return new r})()}:function(){return new h}};h.create=_(),h.alloc=function(w){return new o.Array(w)},o.Array!==Array&&(h.alloc=o.pool(h.alloc,o.Array.prototype.subarray)),h.prototype._push=function(w,D,I){return this.tail=this.tail.next=new l(w,D,I),this.len+=D,this};function y(S,w,D){w[D]=S&255}function p(S,w,D){for(;S>127;)w[D++]=S&127|128,S>>>=7;w[D]=S}function C(S,w){this.len=S,this.next=undefined,this.val=w}C.prototype=Object.create(l.prototype),C.prototype.fn=p,h.prototype.uint32=function(w){return this.len+=(this.tail=this.tail.next=new C((w=w>>>0)<128?1:w<16384?2:w<2097152?3:w<268435456?4:5,w)).len,this},h.prototype.int32=function(w){return w<0?this._push(x,10,s.fromNumber(w)):this.uint32(w)},h.prototype.sint32=function(w){return this.uint32((w<<1^w>>31)>>>0)};function x(S,w,D){for(;S.hi;)w[D++]=S.lo&127|128,S.lo=(S.lo>>>7|S.hi<<25)>>>0,S.hi>>>=7;for(;S.lo>127;)w[D++]=S.lo&127|128,S.lo=S.lo>>>7;w[D++]=S.lo}h.prototype.uint64=function(w){var D=s.from(w);return this._push(x,D.length(),D)},h.prototype.int64=h.prototype.uint64,h.prototype.sint64=function(w){var D=s.from(w).zzEncode();return this._push(x,D.length(),D)},h.prototype.bool=function(w){return this._push(y,1,w?1:0)};function T(S,w,D){w[D]=S&255,w[D+1]=S>>>8&255,w[D+2]=S>>>16&255,w[D+3]=S>>>24}h.prototype.fixed32=function(w){return this._push(T,4,w>>>0)},h.prototype.sfixed32=h.prototype.fixed32,h.prototype.fixed64=function(w){var D=s.from(w);return this._push(T,4,D.lo)._push(T,4,D.hi)},h.prototype.sfixed64=h.prototype.fixed64,h.prototype.float=function(w){return this._push(o.float.writeFloatLE,4,w)},h.prototype.double=function(w){return this._push(o.float.writeDoubleLE,8,w)};var E=o.Array.prototype.set?function(w,D,I){D.set(w,I)}:function(w,D,I){for(var O=0;O<w.length;++O)D[I+O]=w[O]};h.prototype.bytes=function(w){var D=w.length>>>0;if(!D)return this._push(y,1,0);if(o.isString(w)){var I=h.alloc(D=a.length(w));a.decode(w,I,0),w=I}return this.uint32(D)._push(E,D,w)},h.prototype.string=function(w){var D=c.length(w);return D?this.uint32(D)._push(c.write,D,w):this._push(y,1,0)},h.prototype.fork=function(){return this.states=new d(this),this.head=this.tail=new l(u,0,0),this.len=0,this},h.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new l(u,0,0),this.len=0),this},h.prototype.ldelim=function(){var w=this.head,D=this.tail,I=this.len;return this.reset().uint32(I),I&&(this.tail.next=w.next,this.tail=D,this.len+=I),this},h.prototype.finish=function(){for(var w=this.head.next,D=this.constructor.alloc(this.len),I=0;w;)w.fn(w.val,D,I),I+=w.len,w=w.next;return D},h._configure=function(S){r=S,h.create=_(),r._configure()}},{15:15}],17:[function(t,n,i){"use strict";n.exports=s;var o=t(16);(s.prototype=Object.create(o.prototype)).constructor=s;var r=t(15);function s(){o.call(this)}s._configure=function(){s.alloc=r._Buffer_allocUnsafe,s.writeBytesBuffer=r.Buffer&&r.Buffer.prototype instanceof Uint8Array&&r.Buffer.prototype.set.name==="set"?function(l,u,d){u.set(l,d)}:function(l,u,d){if(l.copy)l.copy(u,d,0,l.length);else for(var h=0;h<l.length;)u[d++]=l[h++]}},s.prototype.bytes=function(l){r.isString(l)&&(l=r._Buffer_from(l,"base64"));var u=l.length>>>0;return this.uint32(u),u&&this._push(s.writeBytesBuffer,u,l),this};function a(c,l,u){c.length<40?r.utf8.write(c,l,u):l.utf8Write?l.utf8Write(c,u):l.write(c,u)}s.prototype.string=function(l){var u=r.Buffer.byteLength(l);return this.uint32(u),u&&this._push(a,u,l),this},s._configure()},{15:15,16:16}]},{},[8])})()});var T_e=Za(($fi,yU)=>{/* Copyright 2015-2018 Esri. Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0 @preserve */(function(){var t=function(){var r={};r.defaultNoDataValue=-34027999387901484e22,r.decode=function(d,h){h=h||{};var _=h.encodedMaskData||h.encodedMaskData===null,y=l(d,h.inputOffset||0,_),p=h.noDataValue!==null?h.noDataValue:r.defaultNoDataValue,C=s(y,h.pixelType||Float32Array,h.encodedMaskData,p,h.returnMask),x={width:y.width,height:y.height,pixelData:C.resultPixels,minValue:C.minValue,maxValue:y.pixels.maxValue,noDataValue:p};return C.resultMask&&(x.maskData=C.resultMask),h.returnEncodedMask&&y.mask&&(x.encodedMaskData=y.mask.bitset?y.mask.bitset:null),h.returnFileInfo&&(x.fileInfo=a(y),h.computeUsedBitDepths&&(x.fileInfo.bitDepths=c(y))),x};var s=function(d,h,_,y,p){var C=0,x=d.pixels.numBlocksX,T=d.pixels.numBlocksY,E=Math.floor(d.width/x),S=Math.floor(d.height/T),w=2*d.maxZError,D=Number.MAX_VALUE,I;_=_||(d.mask?d.mask.bitset:null);var O,M;O=new h(d.width*d.height),p&&_&&(M=new Uint8Array(d.width*d.height));for(var L=new Float32Array(E*S),F,g,b=0;b<=T;b++){var v=b!==T?S:d.height%T;if(v!==0)for(var P=0;P<=x;P++){var R=P!==x?E:d.width%x;if(R!==0){var V=b*d.width*S+P*E,H=d.width-R,U=d.pixels.blocks[C],G,k,X;U.encoding<2?(U.encoding===0?G=U.rawData:(u(U.stuffedData,U.bitsPerPixel,U.numValidPixels,U.offset,w,L,d.pixels.maxValue),G=L),k=0):U.encoding===2?X=0:X=U.offset;var Y;if(_)for(g=0;g<v;g++){for(V&7&&(Y=_[V>>3],Y<<=V&7),F=0;F<R;F++)V&7||(Y=_[V>>3]),Y&128?(M&&(M[V]=1),I=U.encoding<2?G[k++]:X,D=D>I?I:D,O[V++]=I):(M&&(M[V]=0),O[V++]=y),Y<<=1;V+=H}else if(U.encoding<2)for(g=0;g<v;g++){for(F=0;F<R;F++)I=G[k++],D=D>I?I:D,O[V++]=I;V+=H}else for(D=D>X?X:D,g=0;g<v;g++){for(F=0;F<R;F++)O[V++]=X;V+=H}if(U.encoding===1&&k!==U.numValidPixels)throw"Block and Mask do not match";C++}}}return{resultPixels:O,resultMask:M,minValue:D}},a=function(d){return{fileIdentifierString:d.fileIdentifierString,fileVersion:d.fileVersion,imageType:d.imageType,height:d.height,width:d.width,maxZError:d.maxZError,eofOffset:d.eofOffset,mask:d.mask?{numBlocksX:d.mask.numBlocksX,numBlocksY:d.mask.numBlocksY,numBytes:d.mask.numBytes,maxValue:d.mask.maxValue}:null,pixels:{numBlocksX:d.pixels.numBlocksX,numBlocksY:d.pixels.numBlocksY,numBytes:d.pixels.numBytes,maxValue:d.pixels.maxValue,noDataValue:d.noDataValue}}},c=function(d){for(var h=d.pixels.numBlocksX*d.pixels.numBlocksY,_={},y=0;y<h;y++){var p=d.pixels.blocks[y];p.encoding===0?_.float32=!0:p.encoding===1?_[p.bitsPerPixel]=!0:_[0]=!0}return Object.keys(_)},l=function(d,h,_){var y={},p=new Uint8Array(d,h,10);if(y.fileIdentifierString=String.fromCharCode.apply(null,p),y.fileIdentifierString.trim()!=="CntZImage")throw"Unexpected file identifier string: "+y.fileIdentifierString;h+=10;var C=new DataView(d,h,24);if(y.fileVersion=C.getInt32(0,!0),y.imageType=C.getInt32(4,!0),y.height=C.getUint32(8,!0),y.width=C.getUint32(12,!0),y.maxZError=C.getFloat64(16,!0),h+=24,!_)if(C=new DataView(d,h,16),y.mask={},y.mask.numBlocksY=C.getUint32(0,!0),y.mask.numBlocksX=C.getUint32(4,!0),y.mask.numBytes=C.getUint32(8,!0),y.mask.maxValue=C.getFloat32(12,!0),h+=16,y.mask.numBytes>0){var x=new Uint8Array(Math.ceil(y.width*y.height/8));C=new DataView(d,h,y.mask.numBytes);var T=C.getInt16(0,!0),E=2,S=0;do{if(T>0)for(;T--;)x[S++]=C.getUint8(E++);else{var w=C.getUint8(E++);for(T=-T;T--;)x[S++]=w}T=C.getInt16(E,!0),E+=2}while(E<y.mask.numBytes);if(T!==-32768||S<x.length)throw"Unexpected end of mask RLE encoding";y.mask.bitset=x,h+=y.mask.numBytes}else(y.mask.numBytes|y.mask.numBlocksY|y.mask.maxValue)===0&&(y.mask.bitset=new Uint8Array(Math.ceil(y.width*y.height/8)));C=new DataView(d,h,16),y.pixels={},y.pixels.numBlocksY=C.getUint32(0,!0),y.pixels.numBlocksX=C.getUint32(4,!0),y.pixels.numBytes=C.getUint32(8,!0),y.pixels.maxValue=C.getFloat32(12,!0),h+=16;var D=y.pixels.numBlocksX,I=y.pixels.numBlocksY,O=D+(y.width%D>0?1:0),M=I+(y.height%I>0?1:0);y.pixels.blocks=new Array(O*M);for(var L=0,F=0;F<M;F++)for(var g=0;g<O;g++){var b=0,v=d.byteLength-h;C=new DataView(d,h,Math.min(10,v));var P={};y.pixels.blocks[L++]=P;var R=C.getUint8(0);if(b++,P.encoding=R&63,P.encoding>3)throw"Invalid block encoding ("+P.encoding+")";if(P.encoding===2){h++;continue}if(R!==0&&R!==2){if(R>>=6,P.offsetType=R,R===2)P.offset=C.getInt8(1),b++;else if(R===1)P.offset=C.getInt16(1,!0),b+=2;else if(R===0)P.offset=C.getFloat32(1,!0),b+=4;else throw"Invalid block offset type";if(P.encoding===1)if(R=C.getUint8(b),b++,P.bitsPerPixel=R&63,R>>=6,P.numValidPixelsType=R,R===2)P.numValidPixels=C.getUint8(b),b++;else if(R===1)P.numValidPixels=C.getUint16(b,!0),b+=2;else if(R===0)P.numValidPixels=C.getUint32(b,!0),b+=4;else throw"Invalid valid pixel count type"}if(h+=b,P.encoding!==3){var V,H;if(P.encoding===0){var U=(y.pixels.numBytes-1)/4;if(U!==Math.floor(U))throw"uncompressed block has invalid length";V=new ArrayBuffer(U*4),H=new Uint8Array(V),H.set(new Uint8Array(d,h,U*4));var G=new Float32Array(V);P.rawData=G,h+=U*4}else if(P.encoding===1){var k=Math.ceil(P.numValidPixels*P.bitsPerPixel/8),X=Math.ceil(k/4);V=new ArrayBuffer(X*4),H=new Uint8Array(V),H.set(new Uint8Array(d,h,k)),P.stuffedData=new Uint32Array(V),h+=k}}}return y.eofOffset=h,y},u=function(d,h,_,y,p,C,x){var T=(1<<h)-1,E=0,S,w=0,D,I,O=Math.ceil((x-y)/p),M=d.length*4-Math.ceil(h*_/8);for(d[d.length-1]<<=8*M,S=0;S<_;S++){if(w===0&&(I=d[E++],w=32),w>=h)D=I>>>w-h&T,w-=h;else{var L=h-w;D=(I&T)<<L&T,I=d[E++],w=32-L,D+=I>>>w}C[S]=D<O?y+D*p:x}return C};return r}(),n=function(){"use strict";var r={unstuff:function(l,u,d,h,_,y,p,C){var x=(1<<d)-1,T=0,E,S=0,w,D,I,O,M=l.length*4-Math.ceil(d*h/8);if(l[l.length-1]<<=8*M,_)for(E=0;E<h;E++)S===0&&(D=l[T++],S=32),S>=d?(w=D>>>S-d&x,S-=d):(I=d-S,w=(D&x)<<I&x,D=l[T++],S=32-I,w+=D>>>S),u[E]=_[w];else for(O=Math.ceil((C-y)/p),E=0;E<h;E++)S===0&&(D=l[T++],S=32),S>=d?(w=D>>>S-d&x,S-=d):(I=d-S,w=(D&x)<<I&x,D=l[T++],S=32-I,w+=D>>>S),u[E]=w<O?y+w*p:C},unstuffLUT:function(l,u,d,h,_,y){var p=(1<<u)-1,C=0,x=0,T=0,E=0,S=0,w,D=[],I=l.length*4-Math.ceil(u*d/8);l[l.length-1]<<=8*I;var O=Math.ceil((y-h)/_);for(x=0;x<d;x++)E===0&&(w=l[C++],E=32),E>=u?(S=w>>>E-u&p,E-=u):(T=u-E,S=(w&p)<<T&p,w=l[C++],E=32-T,S+=w>>>E),D[x]=S<O?h+S*_:y;return D.unshift(h),D},unstuff2:function(l,u,d,h,_,y,p,C){var x=(1<<d)-1,T=0,E,S=0,w=0,D,I,O;if(_)for(E=0;E<h;E++)S===0&&(I=l[T++],S=32,w=0),S>=d?(D=I>>>w&x,S-=d,w+=d):(O=d-S,D=I>>>w&x,I=l[T++],S=32-O,D|=(I&(1<<O)-1)<<d-O,w=O),u[E]=_[D];else{var M=Math.ceil((C-y)/p);for(E=0;E<h;E++)S===0&&(I=l[T++],S=32,w=0),S>=d?(D=I>>>w&x,S-=d,w+=d):(O=d-S,D=I>>>w&x,I=l[T++],S=32-O,D|=(I&(1<<O)-1)<<d-O,w=O),u[E]=D<M?y+D*p:C}return u},unstuffLUT2:function(l,u,d,h,_,y){var p=(1<<u)-1,C=0,x=0,T=0,E=0,S=0,w=0,D,I=[],O=Math.ceil((y-h)/_);for(x=0;x<d;x++)E===0&&(D=l[C++],E=32,w=0),E>=u?(S=D>>>w&p,E-=u,w+=u):(T=u-E,S=D>>>w&p,D=l[C++],E=32-T,S|=(D&(1<<T)-1)<<u-T,w=T),I[x]=S<O?h+S*_:y;return I.unshift(h),I},originalUnstuff:function(l,u,d,h){var _=(1<<d)-1,y=0,p,C=0,x,T,E,S=l.length*4-Math.ceil(d*h/8);for(l[l.length-1]<<=8*S,p=0;p<h;p++)C===0&&(T=l[y++],C=32),C>=d?(x=T>>>C-d&_,C-=d):(E=d-C,x=(T&_)<<E&_,T=l[y++],C=32-E,x+=T>>>C),u[p]=x;return u},originalUnstuff2:function(l,u,d,h){var _=(1<<d)-1,y=0,p,C=0,x=0,T,E,S;for(p=0;p<h;p++)C===0&&(E=l[y++],C=32,x=0),C>=d?(T=E>>>x&_,C-=d,x+=d):(S=d-C,T=E>>>x&_,E=l[y++],C=32-S,T|=(E&(1<<S)-1)<<d-S,x=S),u[p]=T;return u}},s={HUFFMAN_LUT_BITS_MAX:12,computeChecksumFletcher32:function(l){for(var u=65535,d=65535,h=l.length,_=Math.floor(h/2),y=0;_;){var p=_>=359?359:_;_-=p;do u+=l[y++]<<8,d+=u+=l[y++];while(--p);u=(u&65535)+(u>>>16),d=(d&65535)+(d>>>16)}return h&1&&(d+=u+=l[y]<<8),u=(u&65535)+(u>>>16),d=(d&65535)+(d>>>16),(d<<16|u)>>>0},readHeaderInfo:function(l,u){var d=u.ptr,h=new Uint8Array(l,d,6),_={};if(_.fileIdentifierString=String.fromCharCode.apply(null,h),_.fileIdentifierString.lastIndexOf("Lerc2",0)!==0)throw"Unexpected file identifier string (expect Lerc2 ): "+_.fileIdentifierString;d+=6;var y=new DataView(l,d,8),p=y.getInt32(0,!0);_.fileVersion=p,d+=4,p>=3&&(_.checksum=y.getUint32(4,!0),d+=4),y=new DataView(l,d,12),_.height=y.getUint32(0,!0),_.width=y.getUint32(4,!0),d+=8,p>=4?(_.numDims=y.getUint32(8,!0),d+=4):_.numDims=1,y=new DataView(l,d,40),_.numValidPixel=y.getUint32(0,!0),_.microBlockSize=y.getInt32(4,!0),_.blobSize=y.getInt32(8,!0),_.imageType=y.getInt32(12,!0),_.maxZError=y.getFloat64(16,!0),_.zMin=y.getFloat64(24,!0),_.zMax=y.getFloat64(32,!0),d+=40,u.headerInfo=_,u.ptr=d;var C,x;if(p>=3&&(x=p>=4?52:48,C=this.computeChecksumFletcher32(new Uint8Array(l,d-x,_.blobSize-14)),C!==_.checksum))throw"Checksum failed.";return!0},checkMinMaxRanges:function(l,u){var d=u.headerInfo,h=this.getDataTypeArray(d.imageType),_=d.numDims*this.getDataTypeSize(d.imageType),y=this.readSubArray(l,u.ptr,h,_),p=this.readSubArray(l,u.ptr+_,h,_);u.ptr+=2*_;var C,x=!0;for(C=0;C<d.numDims;C++)if(y[C]!==p[C]){x=!1;break}return d.minValues=y,d.maxValues=p,x},readSubArray:function(l,u,d,h){var _;if(d===Uint8Array)_=new Uint8Array(l,u,h);else{var y=new ArrayBuffer(h),p=new Uint8Array(y);p.set(new Uint8Array(l,u,h)),_=new d(y)}return _},readMask:function(l,u){var d=u.ptr,h=u.headerInfo,_=h.width*h.height,y=h.numValidPixel,p=new DataView(l,d,4),C={};if(C.numBytes=p.getUint32(0,!0),d+=4,(y===0||_===y)&&C.numBytes!==0)throw"invalid mask";var x,T;if(y===0)x=new Uint8Array(Math.ceil(_/8)),C.bitset=x,T=new Uint8Array(_),u.pixels.resultMask=T,d+=C.numBytes;else if(C.numBytes>0){x=new Uint8Array(Math.ceil(_/8)),p=new DataView(l,d,C.numBytes);var E=p.getInt16(0,!0),S=2,w=0,D=0;do{if(E>0)for(;E--;)x[w++]=p.getUint8(S++);else for(D=p.getUint8(S++),E=-E;E--;)x[w++]=D;E=p.getInt16(S,!0),S+=2}while(S<C.numBytes);if(E!==-32768||w<x.length)throw"Unexpected end of mask RLE encoding";T=new Uint8Array(_);var I=0,O=0;for(O=0;O<_;O++)O&7?(I=x[O>>3],I<<=O&7):I=x[O>>3],I&128&&(T[O]=1);u.pixels.resultMask=T,C.bitset=x,d+=C.numBytes}return u.ptr=d,u.mask=C,!0},readDataOneSweep:function(l,u,d){var h=u.ptr,_=u.headerInfo,y=_.numDims,p=_.width*_.height,C=_.imageType,x=_.numValidPixel*s.getDataTypeSize(C)*y,T,E=u.pixels.resultMask;if(d===Uint8Array)T=new Uint8Array(l,h,x);else{var S=new ArrayBuffer(x),w=new Uint8Array(S);w.set(new Uint8Array(l,h,x)),T=new d(S)}if(T.length===p*y)u.pixels.resultPixels=T;else{u.pixels.resultPixels=new d(p*y);var D=0,I=0,O=0,M=0;if(y>1)for(O=0;O<y;O++)for(M=O*p,I=0;I<p;I++)E[I]&&(u.pixels.resultPixels[M+I]=T[D++]);else for(I=0;I<p;I++)E[I]&&(u.pixels.resultPixels[I]=T[D++])}return h+=x,u.ptr=h,!0},readHuffmanTree:function(l,u){var d=this.HUFFMAN_LUT_BITS_MAX,h=new DataView(l,u.ptr,16);u.ptr+=16;var _=h.getInt32(0,!0);if(_<2)throw"unsupported Huffman version";var y=h.getInt32(4,!0),p=h.getInt32(8,!0),C=h.getInt32(12,!0);if(p>=C)return!1;var x=new Uint32Array(C-p);s.decodeBits(l,u,x);var T=[],E,S,w,D;for(E=p;E<C;E++)S=E-(E<y?0:y),T[S]={first:x[E-p],second:null};var I=l.byteLength-u.ptr,O=Math.ceil(I/4),M=new ArrayBuffer(O*4),L=new Uint8Array(M);L.set(new Uint8Array(l,u.ptr,I));var F=new Uint32Array(M),g=0,b,v=0;for(b=F[0],E=p;E<C;E++)S=E-(E<y?0:y),D=T[S].first,D>0&&(T[S].second=b<<g>>>32-D,32-g>=D?(g+=D,g===32&&(g=0,v++,b=F[v])):(g+=D-32,v++,b=F[v],T[S].second|=b>>>32-g));var P=0,R=0,V=new a;for(E=0;E<T.length;E++)T[E]!==void 0&&(P=Math.max(P,T[E].first));P>=d?R=d:R=P,P>=30&&console.log("WARning, large NUM LUT BITS IS "+P);var H=[],U,G,k,X,Y,K;for(E=p;E<C;E++)if(S=E-(E<y?0:y),D=T[S].first,D>0)if(U=[D,S],D<=R)for(G=T[S].second<<R-D,k=1<<R-D,w=0;w<k;w++)H[G|w]=U;else for(G=T[S].second,K=V,X=D-1;X>=0;X--)Y=G>>>X&1,Y?(K.right||(K.right=new a),K=K.right):(K.left||(K.left=new a),K=K.left),X===0&&!K.val&&(K.val=U[1]);return{decodeLut:H,numBitsLUTQick:R,numBitsLUT:P,tree:V,stuffedData:F,srcPtr:v,bitPos:g}},readHuffman:function(l,u,d){var h=u.headerInfo,_=h.numDims,y=u.headerInfo.height,p=u.headerInfo.width,C=p*y,x=this.readHuffmanTree(l,u),T=x.decodeLut,E=x.tree,S=x.stuffedData,w=x.srcPtr,D=x.bitPos,I=x.numBitsLUTQick,O=x.numBitsLUT,M=u.headerInfo.imageType===0?128:0,L,F,g,b=u.pixels.resultMask,v,P,R,V,H,U,G,k=0;D>0&&(w++,D=0);var X=S[w],Y=u.encodeMode===1,K=new d(C*_),j=K,Z;for(Z=0;Z<h.numDims;Z++){if(_>1&&(j=new d(K.buffer,C*Z,C),k=0),u.headerInfo.numValidPixel===p*y)for(U=0,V=0;V<y;V++)for(H=0;H<p;H++,U++){if(F=0,v=X<<D>>>32-I,P=v,32-D<I&&(v|=S[w+1]>>>64-D-I,P=v),T[P])F=T[P][1],D+=T[P][0];else for(v=X<<D>>>32-O,P=v,32-D<O&&(v|=S[w+1]>>>64-D-O,P=v),L=E,G=0;G<O;G++)if(R=v>>>O-G-1&1,L=R?L.right:L.left,!(L.left||L.right)){F=L.val,D=D+G+1;break}D>=32&&(D-=32,w++,X=S[w]),g=F-M,Y?(H>0?g+=k:V>0?g+=j[U-p]:g+=k,g&=255,j[U]=g,k=g):j[U]=g}else for(U=0,V=0;V<y;V++)for(H=0;H<p;H++,U++)if(b[U]){if(F=0,v=X<<D>>>32-I,P=v,32-D<I&&(v|=S[w+1]>>>64-D-I,P=v),T[P])F=T[P][1],D+=T[P][0];else for(v=X<<D>>>32-O,P=v,32-D<O&&(v|=S[w+1]>>>64-D-O,P=v),L=E,G=0;G<O;G++)if(R=v>>>O-G-1&1,L=R?L.right:L.left,!(L.left||L.right)){F=L.val,D=D+G+1;break}D>=32&&(D-=32,w++,X=S[w]),g=F-M,Y?(H>0&&b[U-1]?g+=k:V>0&&b[U-p]?g+=j[U-p]:g+=k,g&=255,j[U]=g,k=g):j[U]=g}u.ptr=u.ptr+(w+1)*4+(D>0?4:0)}u.pixels.resultPixels=K},decodeBits:function(l,u,d,h,_){{var y=u.headerInfo,p=y.fileVersion,C=0,x=new DataView(l,u.ptr,5),T=x.getUint8(0);C++;var E=T>>6,S=E===0?4:3-E,w=(T&32)>0,D=T&31,I=0;if(S===1)I=x.getUint8(C),C++;else if(S===2)I=x.getUint16(C,!0),C+=2;else if(S===4)I=x.getUint32(C,!0),C+=4;else throw"Invalid valid pixel count type";var O=2*y.maxZError,M,L,F,g,b,v,P,R,V,H,U=y.numDims>1?y.maxValues[_]:y.zMax;if(w){for(u.counter.lut++,R=x.getUint8(C),V=D,C++,g=Math.ceil((R-1)*D/8),b=Math.ceil(g/4),L=new ArrayBuffer(b*4),F=new Uint8Array(L),u.ptr+=C,F.set(new Uint8Array(l,u.ptr,g)),P=new Uint32Array(L),u.ptr+=g,H=0;R-1>>>H;)H++;g=Math.ceil(I*H/8),b=Math.ceil(g/4),L=new ArrayBuffer(b*4),F=new Uint8Array(L),F.set(new Uint8Array(l,u.ptr,g)),M=new Uint32Array(L),u.ptr+=g,p>=3?v=r.unstuffLUT2(P,D,R-1,h,O,U):v=r.unstuffLUT(P,D,R-1,h,O,U),p>=3?r.unstuff2(M,d,H,I,v):r.unstuff(M,d,H,I,v)}else u.counter.bitstuffer++,H=D,u.ptr+=C,H>0&&(g=Math.ceil(I*H/8),b=Math.ceil(g/4),L=new ArrayBuffer(b*4),F=new Uint8Array(L),F.set(new Uint8Array(l,u.ptr,g)),M=new Uint32Array(L),u.ptr+=g,p>=3?h==null?r.originalUnstuff2(M,d,H,I):r.unstuff2(M,d,H,I,!1,h,O,U):h==null?r.originalUnstuff(M,d,H,I):r.unstuff(M,d,H,I,!1,h,O,U))}},readTiles:function(l,u,d){var h=u.headerInfo,_=h.width,y=h.height,p=h.microBlockSize,C=h.imageType,x=s.getDataTypeSize(C),T=Math.ceil(_/p),E=Math.ceil(y/p);u.pixels.numBlocksY=E,u.pixels.numBlocksX=T,u.pixels.ptr=0;var S=0,w=0,D=0,I=0,O=0,M=0,L=0,F=0,g=0,b=0,v=0,P=0,R=0,V=0,H=0,U=0,G,k,X,Y,K,j,Z=new d(p*p),Q=y%p||p,me=_%p||p,_e,re,fe=h.numDims,ge,be=u.pixels.resultMask,Be=u.pixels.resultPixels;for(D=0;D<E;D++)for(O=D!==E-1?p:Q,I=0;I<T;I++)for(M=I!==T-1?p:me,v=D*_*p+I*p,P=_-M,ge=0;ge<fe;ge++){if(fe>1&&(Be=new d(u.pixels.resultPixels.buffer,_*y*ge*x,_*y)),L=l.byteLength-u.ptr,G=new DataView(l,u.ptr,Math.min(10,L)),k={},U=0,F=G.getUint8(0),U++,g=F>>6&255,b=F>>2&15,b!==(I*p>>3&15))throw"integrity issue";if(j=F&3,j>3)throw u.ptr+=U,"Invalid block encoding ("+j+")";if(j===2){u.counter.constant++,u.ptr+=U;continue}else if(j===0){if(u.counter.uncompressed++,u.ptr+=U,R=O*M*x,V=l.byteLength-u.ptr,R=R<V?R:V,X=new ArrayBuffer(R%x===0?R:R+x-R%x),Y=new Uint8Array(X),Y.set(new Uint8Array(l,u.ptr,R)),K=new d(X),H=0,be)for(S=0;S<O;S++){for(w=0;w<M;w++)be[v]&&(Be[v]=K[H++]),v++;v+=P}else for(S=0;S<O;S++){for(w=0;w<M;w++)Be[v++]=K[H++];v+=P}u.ptr+=H*x}else if(_e=s.getDataTypeUsed(C,g),re=s.getOnePixel(k,U,_e,G),U+=s.getDataTypeSize(_e),j===3)if(u.ptr+=U,u.counter.constantoffset++,be)for(S=0;S<O;S++){for(w=0;w<M;w++)be[v]&&(Be[v]=re),v++;v+=P}else for(S=0;S<O;S++){for(w=0;w<M;w++)Be[v++]=re;v+=P}else if(u.ptr+=U,s.decodeBits(l,u,Z,re,ge),U=0,be)for(S=0;S<O;S++){for(w=0;w<M;w++)be[v]&&(Be[v]=Z[U++]),v++;v+=P}else for(S=0;S<O;S++){for(w=0;w<M;w++)Be[v++]=Z[U++];v+=P}}},formatFileInfo:function(l){return{fileIdentifierString:l.headerInfo.fileIdentifierString,fileVersion:l.headerInfo.fileVersion,imageType:l.headerInfo.imageType,height:l.headerInfo.height,width:l.headerInfo.width,numValidPixel:l.headerInfo.numValidPixel,microBlockSize:l.headerInfo.microBlockSize,blobSize:l.headerInfo.blobSize,maxZError:l.headerInfo.maxZError,pixelType:s.getPixelType(l.headerInfo.imageType),eofOffset:l.eofOffset,mask:l.mask?{numBytes:l.mask.numBytes}:null,pixels:{numBlocksX:l.pixels.numBlocksX,numBlocksY:l.pixels.numBlocksY,maxValue:l.headerInfo.zMax,minValue:l.headerInfo.zMin,noDataValue:l.noDataValue}}},constructConstantSurface:function(l){var u=l.headerInfo.zMax,d=l.headerInfo.numDims,h=l.headerInfo.height*l.headerInfo.width,_=h*d,y=0,p=0,C=0,x=l.pixels.resultMask;if(x)if(d>1)for(y=0;y<d;y++)for(C=y*h,p=0;p<h;p++)x[p]&&(l.pixels.resultPixels[C+p]=u);else for(p=0;p<h;p++)x[p]&&(l.pixels.resultPixels[p]=u);else if(l.pixels.resultPixels.fill)l.pixels.resultPixels.fill(u);else for(p=0;p<_;p++)l.pixels.resultPixels[p]=u},getDataTypeArray:function(l){var u;switch(l){case 0:u=Int8Array;break;case 1:u=Uint8Array;break;case 2:u=Int16Array;break;case 3:u=Uint16Array;break;case 4:u=Int32Array;break;case 5:u=Uint32Array;break;case 6:u=Float32Array;break;case 7:u=Float64Array;break;default:u=Float32Array}return u},getPixelType:function(l){var u;switch(l){case 0:u="S8";break;case 1:u="U8";break;case 2:u="S16";break;case 3:u="U16";break;case 4:u="S32";break;case 5:u="U32";break;case 6:u="F32";break;case 7:u="F64";break;default:u="F32"}return u},isValidPixelValue:function(l,u){if(u==null)return!1;var d;switch(l){case 0:d=u>=-128&&u<=127;break;case 1:d=u>=0&&u<=255;break;case 2:d=u>=-32768&&u<=32767;break;case 3:d=u>=0&&u<=65536;break;case 4:d=u>=-2147483648&&u<=2147483647;break;case 5:d=u>=0&&u<=4294967296;break;case 6:d=u>=-34027999387901484e22&&u<=34027999387901484e22;break;case 7:d=u>=5e-324&&u<=17976931348623157e292;break;default:d=!1}return d},getDataTypeSize:function(l){var u=0;switch(l){case 0:case 1:u=1;break;case 2:case 3:u=2;break;case 4:case 5:case 6:u=4;break;case 7:u=8;break;default:u=l}return u},getDataTypeUsed:function(l,u){var d=l;switch(l){case 2:case 4:d=l-u;break;case 3:case 5:d=l-2*u;break;case 6:u===0?d=l:u===1?d=2:d=1;break;case 7:u===0?d=l:d=l-2*u+1;break;default:d=l;break}return d},getOnePixel:function(l,u,d,h){var _=0;switch(d){case 0:_=h.getInt8(u);break;case 1:_=h.getUint8(u);break;case 2:_=h.getInt16(u,!0);break;case 3:_=h.getUint16(u,!0);break;case 4:_=h.getInt32(u,!0);break;case 5:_=h.getUInt32(u,!0);break;case 6:_=h.getFloat32(u,!0);break;case 7:_=h.getFloat64(u,!0);break;default:throw"the decoder does not understand this pixel type"}return _}},a=function(l,u,d){this.val=l,this.left=u,this.right=d},c={decode:function(l,u){u=u||{};var d=u.noDataValue,h=0,_={};if(_.ptr=u.inputOffset||0,_.pixels={},!!s.readHeaderInfo(l,_)){var y=_.headerInfo,p=y.fileVersion,C=s.getDataTypeArray(y.imageType);s.readMask(l,_),y.numValidPixel!==y.width*y.height&&!_.pixels.resultMask&&(_.pixels.resultMask=u.maskData);var x=y.width*y.height;if(_.pixels.resultPixels=new C(x*y.numDims),_.counter={onesweep:0,uncompressed:0,lut:0,bitstuffer:0,constant:0,constantoffset:0},y.numValidPixel!==0)if(y.zMax===y.zMin)s.constructConstantSurface(_);else if(p>=4&&s.checkMinMaxRanges(l,_))s.constructConstantSurface(_);else{var T=new DataView(l,_.ptr,2),E=T.getUint8(0);if(_.ptr++,E)s.readDataOneSweep(l,_,C);else if(p>1&&y.imageType<=1&&Math.abs(y.maxZError-.5)<1e-5){var S=T.getUint8(1);if(_.ptr++,_.encodeMode=S,S>2||p<4&&S>1)throw"Invalid Huffman flag "+S;S?s.readHuffman(l,_,C):s.readTiles(l,_,C)}else s.readTiles(l,_,C)}_.eofOffset=_.ptr;var w;u.inputOffset?(w=_.headerInfo.blobSize+u.inputOffset-_.ptr,Math.abs(w)>=1&&(_.eofOffset=u.inputOffset+_.headerInfo.blobSize)):(w=_.headerInfo.blobSize-_.ptr,Math.abs(w)>=1&&(_.eofOffset=_.headerInfo.blobSize));var D={width:y.width,height:y.height,pixelData:_.pixels.resultPixels,minValue:y.zMin,maxValue:y.zMax,validPixelCount:y.numValidPixel,dimCount:y.numDims,dimStats:{minValues:y.minValues,maxValues:y.maxValues},maskData:_.pixels.resultMask};if(_.pixels.resultMask&&s.isValidPixelValue(y.imageType,d)){var I=_.pixels.resultMask;for(h=0;h<x;h++)I[h]||(D.pixelData[h]=d);D.noDataValue=d}return _.noDataValue=d,u.returnFileInfo&&(D.fileInfo=s.formatFileInfo(_)),D}},getBandCount:function(l){var u=0,d=0,h={};for(h.ptr=0,h.pixels={};d<l.byteLength-58;)s.readHeaderInfo(l,h),d+=h.headerInfo.blobSize,u++,h.ptr=d;return u}};return c}(),i=function(){var r=new ArrayBuffer(4),s=new Uint8Array(r),a=new Uint32Array(r);return a[0]=1,s[0]===1}(),o={decode:function(r,s){if(!i)throw"Big endian system is not supported.";s=s||{};var a=s.inputOffset||0,c=new Uint8Array(r,a,10),l=String.fromCharCode.apply(null,c),u,d;if(l.trim()==="CntZImage")u=t,d=1;else if(l.substring(0,5)==="Lerc2")u=n,d=2;else throw"Unexpected file identifier string: "+l;for(var h=0,_=r.byteLength-10,y,p=[],C,x,T={width:0,height:0,pixels:[],pixelType:s.pixelType,mask:null,statistics:[]};a<_;){var E=u.decode(r,{inputOffset:a,encodedMaskData:y,maskData:x,returnMask:h===0,returnEncodedMask:h===0,returnFileInfo:!0,pixelType:s.pixelType||null,noDataValue:s.noDataValue||null});a=E.fileInfo.eofOffset,h===0&&(y=E.encodedMaskData,x=E.maskData,T.width=E.width,T.height=E.height,T.dimCount=E.dimCount||1,T.pixelType=E.pixelType||E.fileInfo.pixelType,T.mask=E.maskData),d>1&&E.fileInfo.mask&&E.fileInfo.mask.numBytes>0&&p.push(E.maskData),h++,T.pixels.push(E.pixelData),T.statistics.push({minValue:E.minValue,maxValue:E.maxValue,noDataValue:E.noDataValue,dimStats:E.dimStats})}var S,w,D;if(d>1&&p.length>1){for(D=T.width*T.height,T.bandMasks=p,x=new Uint8Array(D),x.set(p[0]),S=1;S<p.length;S++)for(C=p[S],w=0;w<D;w++)x[w]=x[w]&C[w];T.maskData=x}return T}};typeof define=="function"&&define.amd?define([],function(){return o}):typeof yU!="undefined"&&yU.exports?yU.exports=o:this.Lerc=o})()});var J0e=Za((uvi,K0e)=>{K0e.exports={webm:"data:video/webm;base64,GkXfowEAAAAAAAAfQoaBAUL3gQFC8oEEQvOBCEKChHdlYm1Ch4EEQoWBAhhTgGcBAAAAAAAVkhFNm3RALE27i1OrhBVJqWZTrIHfTbuMU6uEFlSua1OsggEwTbuMU6uEHFO7a1OsghV17AEAAAAAAACkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmAQAAAAAAAEUq17GDD0JATYCNTGF2ZjU1LjMzLjEwMFdBjUxhdmY1NS4zMy4xMDBzpJBlrrXf3DCDVB8KcgbMpcr+RImIQJBgAAAAAAAWVK5rAQAAAAAAD++uAQAAAAAAADLXgQFzxYEBnIEAIrWcg3VuZIaFVl9WUDiDgQEj44OEAmJaAOABAAAAAAAABrCBsLqBkK4BAAAAAAAPq9eBAnPFgQKcgQAitZyDdW5khohBX1ZPUkJJU4OBAuEBAAAAAAAAEZ+BArWIQOdwAAAAAABiZIEgY6JPbwIeVgF2b3JiaXMAAAAAAoC7AAAAAAAAgLUBAAAAAAC4AQN2b3JiaXMtAAAAWGlwaC5PcmcgbGliVm9yYmlzIEkgMjAxMDExMDEgKFNjaGF1ZmVudWdnZXQpAQAAABUAAABlbmNvZGVyPUxhdmM1NS41Mi4xMDIBBXZvcmJpcyVCQ1YBAEAAACRzGCpGpXMWhBAaQlAZ4xxCzmvsGUJMEYIcMkxbyyVzkCGkoEKIWyiB0JBVAABAAACHQXgUhIpBCCGEJT1YkoMnPQghhIg5eBSEaUEIIYQQQgghhBBCCCGERTlokoMnQQgdhOMwOAyD5Tj4HIRFOVgQgydB6CCED0K4moOsOQghhCQ1SFCDBjnoHITCLCiKgsQwuBaEBDUojILkMMjUgwtCiJqDSTX4GoRnQXgWhGlBCCGEJEFIkIMGQcgYhEZBWJKDBjm4FITLQagahCo5CB+EIDRkFQCQAACgoiiKoigKEBqyCgDIAAAQQFEUx3EcyZEcybEcCwgNWQUAAAEACAAAoEiKpEiO5EiSJFmSJVmSJVmS5omqLMuyLMuyLMsyEBqyCgBIAABQUQxFcRQHCA1ZBQBkAAAIoDiKpViKpWiK54iOCISGrAIAgAAABAAAEDRDUzxHlETPVFXXtm3btm3btm3btm3btm1blmUZCA1ZBQBAAAAQ0mlmqQaIMAMZBkJDVgEACAAAgBGKMMSA0JBVAABAAACAGEoOogmtOd+c46BZDppKsTkdnEi1eZKbirk555xzzsnmnDHOOeecopxZDJoJrTnnnMSgWQqaCa0555wnsXnQmiqtOeeccc7pYJwRxjnnnCateZCajbU555wFrWmOmkuxOeecSLl5UptLtTnnnHPOOeecc84555zqxekcnBPOOeecqL25lpvQxTnnnE/G6d6cEM4555xzzjnnnHPOOeecIDRkFQAABABAEIaNYdwpCNLnaCBGEWIaMulB9+gwCRqDnELq0ehopJQ6CCWVcVJKJwgNWQUAAAIAQAghhRRSSCGFFFJIIYUUYoghhhhyyimnoIJKKqmooowyyyyzzDLLLLPMOuyssw47DDHEEEMrrcRSU2011lhr7jnnmoO0VlprrbVSSimllFIKQkNWAQAgAAAEQgYZZJBRSCGFFGKIKaeccgoqqIDQkFUAACAAgAAAAABP8hzRER3RER3RER3RER3R8RzPESVREiVREi3TMjXTU0VVdWXXlnVZt31b2IVd933d933d+HVhWJZlWZZlWZZlWZZlWZZlWZYgNGQVAAACAAAghBBCSCGFFFJIKcYYc8w56CSUEAgNWQUAAAIACAAAAHAUR3EcyZEcSbIkS9IkzdIsT/M0TxM9URRF0zRV0RVdUTdtUTZl0zVdUzZdVVZtV5ZtW7Z125dl2/d93/d93/d93/d93/d9XQdCQ1YBABIAADqSIymSIimS4ziOJElAaMgqAEAGAEAAAIriKI7jOJIkSZIlaZJneZaomZrpmZ4qqkBoyCoAABAAQAAAAAAAAIqmeIqpeIqoeI7oiJJomZaoqZoryqbsuq7ruq7ruq7ruq7ruq7ruq7ruq7ruq7ruq7ruq7ruq7ruq4LhIasAgAkAAB0JEdyJEdSJEVSJEdygNCQVQCADACAAAAcwzEkRXIsy9I0T/M0TxM90RM901NFV3SB0JBVAAAgAIAAAAAAAAAMybAUy9EcTRIl1VItVVMt1VJF1VNVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVN0zRNEwgNWQkAkAEAkBBTLS3GmgmLJGLSaqugYwxS7KWxSCpntbfKMYUYtV4ah5RREHupJGOKQcwtpNApJq3WVEKFFKSYYyoVUg5SIDRkhQAQmgHgcBxAsixAsiwAAAAAAAAAkDQN0DwPsDQPAAAAAAAAACRNAyxPAzTPAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABA0jRA8zxA8zwAAAAAAAAA0DwP8DwR8EQRAAAAAAAAACzPAzTRAzxRBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABA0jRA8zxA8zwAAAAAAAAAsDwP8EQR0DwRAAAAAAAAACzPAzxRBDzRAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAEOAAABBgIRQasiIAiBMAcEgSJAmSBM0DSJYFTYOmwTQBkmVB06BpME0AAAAAAAAAAAAAJE2DpkHTIIoASdOgadA0iCIAAAAAAAAAAAAAkqZB06BpEEWApGnQNGgaRBEAAAAAAAAAAAAAzzQhihBFmCbAM02IIkQRpgkAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAGHAAAAgwoQwUGrIiAIgTAHA4imUBAIDjOJYFAACO41gWAABYliWKAABgWZooAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAYcAAACDChDBQashIAiAIAcCiKZQHHsSzgOJYFJMmyAJYF0DyApgFEEQAIAAAocAAACLBBU2JxgEJDVgIAUQAABsWxLE0TRZKkaZoniiRJ0zxPFGma53meacLzPM80IYqiaJoQRVE0TZimaaoqME1VFQAAUOAAABBgg6bE4gCFhqwEAEICAByKYlma5nmeJ4qmqZokSdM8TxRF0TRNU1VJkqZ5niiKommapqqyLE3zPFEURdNUVVWFpnmeKIqiaaqq6sLzPE8URdE0VdV14XmeJ4qiaJqq6roQRVE0TdNUTVV1XSCKpmmaqqqqrgtETxRNU1Vd13WB54miaaqqq7ouEE3TVFVVdV1ZBpimaaqq68oyQFVV1XVdV5YBqqqqruu6sgxQVdd1XVmWZQCu67qyLMsCAAAOHAAAAoygk4wqi7DRhAsPQKEhKwKAKAAAwBimFFPKMCYhpBAaxiSEFEImJaXSUqogpFJSKRWEVEoqJaOUUmopVRBSKamUCkIqJZVSAADYgQMA2IGFUGjISgAgDwCAMEYpxhhzTiKkFGPOOScRUoox55yTSjHmnHPOSSkZc8w556SUzjnnnHNSSuacc845KaVzzjnnnJRSSuecc05KKSWEzkEnpZTSOeecEwAAVOAAABBgo8jmBCNBhYasBABSAQAMjmNZmuZ5omialiRpmud5niiapiZJmuZ5nieKqsnzPE8URdE0VZXneZ4oiqJpqirXFUXTNE1VVV2yLIqmaZqq6rowTdNUVdd1XZimaaqq67oubFtVVdV1ZRm2raqq6rqyDFzXdWXZloEsu67s2rIAAPAEBwCgAhtWRzgpGgssNGQlAJABAEAYg5BCCCFlEEIKIYSUUggJAAAYcAAACDChDBQashIASAUAAIyx1lprrbXWQGettdZaa62AzFprrbXWWmuttdZaa6211lJrrbXWWmuttdZaa6211lprrbXWWmuttdZaa6211lprrbXWWmuttdZaa6211lprrbXWWmstpZRSSimllFJKKaWUUkoppZRSSgUA+lU4APg/2LA6wknRWGChISsBgHAAAMAYpRhzDEIppVQIMeacdFRai7FCiDHnJKTUWmzFc85BKCGV1mIsnnMOQikpxVZjUSmEUlJKLbZYi0qho5JSSq3VWIwxqaTWWoutxmKMSSm01FqLMRYjbE2ptdhqq7EYY2sqLbQYY4zFCF9kbC2m2moNxggjWywt1VprMMYY3VuLpbaaizE++NpSLDHWXAAAd4MDAESCjTOsJJ0VjgYXGrISAAgJACAQUooxxhhzzjnnpFKMOeaccw5CCKFUijHGnHMOQgghlIwx5pxzEEIIIYRSSsaccxBCCCGEkFLqnHMQQgghhBBKKZ1zDkIIIYQQQimlgxBCCCGEEEoopaQUQgghhBBCCKmklEIIIYRSQighlZRSCCGEEEIpJaSUUgohhFJCCKGElFJKKYUQQgillJJSSimlEkoJJYQSUikppRRKCCGUUkpKKaVUSgmhhBJKKSWllFJKIYQQSikFAAAcOAAABBhBJxlVFmGjCRcegEJDVgIAZAAAkKKUUiktRYIipRikGEtGFXNQWoqocgxSzalSziDmJJaIMYSUk1Qy5hRCDELqHHVMKQYtlRhCxhik2HJLoXMOAAAAQQCAgJAAAAMEBTMAwOAA4XMQdAIERxsAgCBEZohEw0JweFAJEBFTAUBigkIuAFRYXKRdXECXAS7o4q4DIQQhCEEsDqCABByccMMTb3jCDU7QKSp1IAAAAAAADADwAACQXAAREdHMYWRobHB0eHyAhIiMkAgAAAAAABcAfAAAJCVAREQ0cxgZGhscHR4fICEiIyQBAIAAAgAAAAAggAAEBAQAAAAAAAIAAAAEBB9DtnUBAAAAAAAEPueBAKOFggAAgACjzoEAA4BwBwCdASqwAJAAAEcIhYWIhYSIAgIABhwJ7kPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99YAD+/6tQgKOFggADgAqjhYIAD4AOo4WCACSADqOZgQArADECAAEQEAAYABhYL/QACIBDmAYAAKOFggA6gA6jhYIAT4AOo5mBAFMAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCAGSADqOFggB6gA6jmYEAewAxAgABEBAAGAAYWC/0AAiAQ5gGAACjhYIAj4AOo5mBAKMAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCAKSADqOFggC6gA6jmYEAywAxAgABEBAAGAAYWC/0AAiAQ5gGAACjhYIAz4AOo4WCAOSADqOZgQDzADECAAEQEAAYABhYL/QACIBDmAYAAKOFggD6gA6jhYIBD4AOo5iBARsAEQIAARAQFGAAYWC/0AAiAQ5gGACjhYIBJIAOo4WCATqADqOZgQFDADECAAEQEAAYABhYL/QACIBDmAYAAKOFggFPgA6jhYIBZIAOo5mBAWsAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCAXqADqOFggGPgA6jmYEBkwAxAgABEBAAGAAYWC/0AAiAQ5gGAACjhYIBpIAOo4WCAbqADqOZgQG7ADECAAEQEAAYABhYL/QACIBDmAYAAKOFggHPgA6jmYEB4wAxAgABEBAAGAAYWC/0AAiAQ5gGAACjhYIB5IAOo4WCAfqADqOZgQILADECAAEQEAAYABhYL/QACIBDmAYAAKOFggIPgA6jhYICJIAOo5mBAjMAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCAjqADqOFggJPgA6jmYECWwAxAgABEBAAGAAYWC/0AAiAQ5gGAACjhYICZIAOo4WCAnqADqOZgQKDADECAAEQEAAYABhYL/QACIBDmAYAAKOFggKPgA6jhYICpIAOo5mBAqsAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCArqADqOFggLPgA6jmIEC0wARAgABEBAUYABhYL/QACIBDmAYAKOFggLkgA6jhYIC+oAOo5mBAvsAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCAw+ADqOZgQMjADECAAEQEAAYABhYL/QACIBDmAYAAKOFggMkgA6jhYIDOoAOo5mBA0sAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCA0+ADqOFggNkgA6jmYEDcwAxAgABEBAAGAAYWC/0AAiAQ5gGAACjhYIDeoAOo4WCA4+ADqOZgQObADECAAEQEAAYABhYL/QACIBDmAYAAKOFggOkgA6jhYIDuoAOo5mBA8MAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCA8+ADqOFggPkgA6jhYID+oAOo4WCBA+ADhxTu2sBAAAAAAAAEbuPs4EDt4r3gQHxghEr8IEK",mp4:"data:video/mp4;base64,AAAAHGZ0eXBNNFYgAAACAGlzb21pc28yYXZjMQAAAAhmcmVlAAAGF21kYXTeBAAAbGliZmFhYyAxLjI4AABCAJMgBDIARwAAArEGBf//rdxF6b3m2Ui3lizYINkj7u94MjY0IC0gY29yZSAxNDIgcjIgOTU2YzhkOCAtIEguMjY0L01QRUctNCBBVkMgY29kZWMgLSBDb3B5bGVmdCAyMDAzLTIwMTQgLSBodHRwOi8vd3d3LnZpZGVvbGFuLm9yZy94MjY0Lmh0bWwgLSBvcHRpb25zOiBjYWJhYz0wIHJlZj0zIGRlYmxvY2s9MTowOjAgYW5hbHlzZT0weDE6MHgxMTEgbWU9aGV4IHN1Ym1lPTcgcHN5PTEgcHN5X3JkPTEuMDA6MC4wMCBtaXhlZF9yZWY9MSBtZV9yYW5nZT0xNiBjaHJvbWFfbWU9MSB0cmVsbGlzPTEgOHg4ZGN0PTAgY3FtPTAgZGVhZHpvbmU9MjEsMTEgZmFzdF9wc2tpcD0xIGNocm9tYV9xcF9vZmZzZXQ9LTIgdGhyZWFkcz02IGxvb2thaGVhZF90aHJlYWRzPTEgc2xpY2VkX3RocmVhZHM9MCBucj0wIGRlY2ltYXRlPTEgaW50ZXJsYWNlZD0wIGJsdXJheV9jb21wYXQ9MCBjb25zdHJhaW5lZF9pbnRyYT0wIGJmcmFtZXM9MCB3ZWlnaHRwPTAga2V5aW50PTI1MCBrZXlpbnRfbWluPTI1IHNjZW5lY3V0PTQwIGludHJhX3JlZnJlc2g9MCByY19sb29rYWhlYWQ9NDAgcmM9Y3JmIG1idHJlZT0xIGNyZj0yMy4wIHFjb21wPTAuNjAgcXBtaW49MCBxcG1heD02OSBxcHN0ZXA9NCB2YnZfbWF4cmF0ZT03NjggdmJ2X2J1ZnNpemU9MzAwMCBjcmZfbWF4PTAuMCBuYWxfaHJkPW5vbmUgZmlsbGVyPTAgaXBfcmF0aW89MS40MCBhcT0xOjEuMDAAgAAAAFZliIQL8mKAAKvMnJycnJycnJycnXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXiEASZACGQAjgCEASZACGQAjgAAAAAdBmjgX4GSAIQBJkAIZACOAAAAAB0GaVAX4GSAhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZpgL8DJIQBJkAIZACOAIQBJkAIZACOAAAAABkGagC/AySEASZACGQAjgAAAAAZBmqAvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZrAL8DJIQBJkAIZACOAAAAABkGa4C/AySEASZACGQAjgCEASZACGQAjgAAAAAZBmwAvwMkhAEmQAhkAI4AAAAAGQZsgL8DJIQBJkAIZACOAIQBJkAIZACOAAAAABkGbQC/AySEASZACGQAjgCEASZACGQAjgAAAAAZBm2AvwMkhAEmQAhkAI4AAAAAGQZuAL8DJIQBJkAIZACOAIQBJkAIZACOAAAAABkGboC/AySEASZACGQAjgAAAAAZBm8AvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZvgL8DJIQBJkAIZACOAAAAABkGaAC/AySEASZACGQAjgCEASZACGQAjgAAAAAZBmiAvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZpAL8DJIQBJkAIZACOAAAAABkGaYC/AySEASZACGQAjgCEASZACGQAjgAAAAAZBmoAvwMkhAEmQAhkAI4AAAAAGQZqgL8DJIQBJkAIZACOAIQBJkAIZACOAAAAABkGawC/AySEASZACGQAjgAAAAAZBmuAvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZsAL8DJIQBJkAIZACOAAAAABkGbIC/AySEASZACGQAjgCEASZACGQAjgAAAAAZBm0AvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZtgL8DJIQBJkAIZACOAAAAABkGbgCvAySEASZACGQAjgCEASZACGQAjgAAAAAZBm6AnwMkhAEmQAhkAI4AhAEmQAhkAI4AhAEmQAhkAI4AhAEmQAhkAI4AAAAhubW9vdgAAAGxtdmhkAAAAAAAAAAAAAAAAAAAD6AAABDcAAQAAAQAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAzB0cmFrAAAAXHRraGQAAAADAAAAAAAAAAAAAAABAAAAAAAAA+kAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAALAAAACQAAAAAAAkZWR0cwAAABxlbHN0AAAAAAAAAAEAAAPpAAAAAAABAAAAAAKobWRpYQAAACBtZGhkAAAAAAAAAAAAAAAAAAB1MAAAdU5VxAAAAAAALWhkbHIAAAAAAAAAAHZpZGUAAAAAAAAAAAAAAABWaWRlb0hhbmRsZXIAAAACU21pbmYAAAAUdm1oZAAAAAEAAAAAAAAAAAAAACRkaW5mAAAAHGRyZWYAAAAAAAAAAQAAAAx1cmwgAAAAAQAAAhNzdGJsAAAAr3N0c2QAAAAAAAAAAQAAAJ9hdmMxAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAALAAkABIAAAASAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGP//AAAALWF2Y0MBQsAN/+EAFWdCwA3ZAsTsBEAAAPpAADqYA8UKkgEABWjLg8sgAAAAHHV1aWRraEDyXyRPxbo5pRvPAyPzAAAAAAAAABhzdHRzAAAAAAAAAAEAAAAeAAAD6QAAABRzdHNzAAAAAAAAAAEAAAABAAAAHHN0c2MAAAAAAAAAAQAAAAEAAAABAAAAAQAAAIxzdHN6AAAAAAAAAAAAAAAeAAADDwAAAAsAAAALAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAAiHN0Y28AAAAAAAAAHgAAAEYAAANnAAADewAAA5gAAAO0AAADxwAAA+MAAAP2AAAEEgAABCUAAARBAAAEXQAABHAAAASMAAAEnwAABLsAAATOAAAE6gAABQYAAAUZAAAFNQAABUgAAAVkAAAFdwAABZMAAAWmAAAFwgAABd4AAAXxAAAGDQAABGh0cmFrAAAAXHRraGQAAAADAAAAAAAAAAAAAAACAAAAAAAABDcAAAAAAAAAAAAAAAEBAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAkZWR0cwAAABxlbHN0AAAAAAAAAAEAAAQkAAADcAABAAAAAAPgbWRpYQAAACBtZGhkAAAAAAAAAAAAAAAAAAC7gAAAykBVxAAAAAAALWhkbHIAAAAAAAAAAHNvdW4AAAAAAAAAAAAAAABTb3VuZEhhbmRsZXIAAAADi21pbmYAAAAQc21oZAAAAAAAAAAAAAAAJGRpbmYAAAAcZHJlZgAAAAAAAAABAAAADHVybCAAAAABAAADT3N0YmwAAABnc3RzZAAAAAAAAAABAAAAV21wNGEAAAAAAAAAAQAAAAAAAAAAAAIAEAAAAAC7gAAAAAAAM2VzZHMAAAAAA4CAgCIAAgAEgICAFEAVBbjYAAu4AAAADcoFgICAAhGQBoCAgAECAAAAIHN0dHMAAAAAAAAAAgAAADIAAAQAAAAAAQAAAkAAAAFUc3RzYwAAAAAAAAAbAAAAAQAAAAEAAAABAAAAAgAAAAIAAAABAAAAAwAAAAEAAAABAAAABAAAAAIAAAABAAAABgAAAAEAAAABAAAABwAAAAIAAAABAAAACAAAAAEAAAABAAAACQAAAAIAAAABAAAACgAAAAEAAAABAAAACwAAAAIAAAABAAAADQAAAAEAAAABAAAADgAAAAIAAAABAAAADwAAAAEAAAABAAAAEAAAAAIAAAABAAAAEQAAAAEAAAABAAAAEgAAAAIAAAABAAAAFAAAAAEAAAABAAAAFQAAAAIAAAABAAAAFgAAAAEAAAABAAAAFwAAAAIAAAABAAAAGAAAAAEAAAABAAAAGQAAAAIAAAABAAAAGgAAAAEAAAABAAAAGwAAAAIAAAABAAAAHQAAAAEAAAABAAAAHgAAAAIAAAABAAAAHwAAAAQAAAABAAAA4HN0c3oAAAAAAAAAAAAAADMAAAAaAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAACMc3RjbwAAAAAAAAAfAAAALAAAA1UAAANyAAADhgAAA6IAAAO+AAAD0QAAA+0AAAQAAAAEHAAABC8AAARLAAAEZwAABHoAAASWAAAEqQAABMUAAATYAAAE9AAABRAAAAUjAAAFPwAABVIAAAVuAAAFgQAABZ0AAAWwAAAFzAAABegAAAX7AAAGFwAAAGJ1ZHRhAAAAWm1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAAALWlsc3QAAAAlqXRvbwAAAB1kYXRhAAAAAQAAAABMYXZmNTUuMzMuMTAw"}});var Q0e=Za((fvi,Z0e)=>{var{webm:bmt,mp4:Smt}=J0e(),Kq=()=>typeof navigator!="undefined"&&parseFloat((""+(/CPU.*OS ([0-9_]{3,4})[0-9_]{0,1}|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_",".").replace("_",""))<10&&!window.MSStream,Jq=()=>"wakeLock"in navigator,Zq=class{constructor(){if(this.enabled=!1,Jq()){this._wakeLock=null;let n=()=>{this._wakeLock!==null&&document.visibilityState==="visible"&&this.enable()};document.addEventListener("visibilitychange",n),document.addEventListener("fullscreenchange",n)}else Kq()?this.noSleepTimer=null:(this.noSleepVideo=document.createElement("video"),this.noSleepVideo.setAttribute("title","No Sleep"),this.noSleepVideo.setAttribute("playsinline",""),this._addSourceToVideo(this.noSleepVideo,"webm",bmt),this._addSourceToVideo(this.noSleepVideo,"mp4",Smt),this.noSleepVideo.addEventListener("loadedmetadata",()=>{this.noSleepVideo.duration<=1?this.noSleepVideo.setAttribute("loop",""):this.noSleepVideo.addEventListener("timeupdate",()=>{this.noSleepVideo.currentTime>.5&&(this.noSleepVideo.currentTime=Math.random())})}))}_addSourceToVideo(n,i,o){var r=document.createElement("source");r.src=o,r.type=`video/${i}`,n.appendChild(r)}get isEnabled(){return this.enabled}enable(){return Jq()?navigator.wakeLock.request("screen").then(n=>{this._wakeLock=n,this.enabled=!0,console.log("Wake Lock active."),this._wakeLock.addEventListener("release",()=>{console.log("Wake Lock released.")})}).catch(n=>{throw this.enabled=!1,console.error(`${n.name}, ${n.message}`),n}):Kq()?(this.disable(),console.warn(`
        NoSleep enabled for older iOS devices. This can interrupt
        active or long-running network requests from completing successfully.
        See https://github.com/richtr/NoSleep.js/issues/15 for more details.
      `),this.noSleepTimer=window.setInterval(()=>{document.hidden||(window.location.href=window.location.href.split("#")[0],window.setTimeout(window.stop,0))},15e3),this.enabled=!0,Promise.resolve()):this.noSleepVideo.play().then(i=>(this.enabled=!0,i)).catch(i=>{throw this.enabled=!1,i})}disable(){Jq()?(this._wakeLock&&this._wakeLock.release(),this._wakeLock=null):Kq()?this.noSleepTimer&&(console.warn(`
          NoSleep now disabled for older iOS devices.
        `),window.clearInterval(this.noSleepTimer),this.noSleepTimer=null):this.noSleepVideo.pause(),this.enabled=!1}};Z0e.exports=Zq});var Ymt={};Dye(Ymt,{AlphaMode:()=>pm,AlphaPipelineStage:()=>iM,Animation:()=>L4,AnimationViewModel:()=>F4,Appearance:()=>Zi,ApproximateTerrainHeights:()=>ri,ArcGISTiledElevationTerrainProvider:()=>kfe,ArcGisMapServerImageryProvider:()=>Hg,ArcType:()=>Zt,ArticulationStageType:()=>rc,AssociativeArray:()=>yt,AttributeCompression:()=>zn,AttributeType:()=>nn,AutoExposure:()=>YV,AutomaticUniforms:()=>Hp,Axis:()=>vo,AxisAlignedBoundingBox:()=>C0,B3dmLoader:()=>_R,B3dmParser:()=>pR,BaseLayerPicker:()=>k4,BaseLayerPickerViewModel:()=>N4,BatchTable:()=>ox,BatchTableHierarchy:()=>jC,BatchTexture:()=>qc,BatchTexturePipelineStage:()=>oM,Billboard:()=>ho,BillboardCollection:()=>vu,BillboardGraphics:()=>Qa,BillboardVisualizer:()=>vP,BingMapsGeocoderService:()=>zfe,BingMapsImageryProvider:()=>JV,BingMapsStyle:()=>XV,BlendEquation:()=>Aa,BlendFunction:()=>Eo,BlendOption:()=>bo,BlendingState:()=>ln,BoundingRectangle:()=>He,BoundingSphere:()=>ae,BoundingSphereState:()=>rt,BoxEmitter:()=>nme,BoxGeometry:()=>Cl,BoxGeometryUpdater:()=>TL,BoxGraphics:()=>dx,BoxOutlineGeometry:()=>Ld,BrdfLutGenerator:()=>ZV,Buffer:()=>ut,BufferLoader:()=>RC,BufferUsage:()=>Fe,CPUStylingPipelineStage:()=>cM,CallbackProperty:()=>rh,Camera:()=>lo,CameraEventAggregator:()=>sk,CameraEventType:()=>Pi,CameraFlightPath:()=>QV,Cartesian2:()=>W,Cartesian3:()=>m,Cartesian4:()=>se,Cartographic:()=>de,CartographicGeocoderService:()=>U3,CatmullRomSpline:()=>Wfe,Cesium3DContentGroup:()=>wx,Cesium3DTile:()=>Lu,Cesium3DTileBatchTable:()=>E_,Cesium3DTileColorBlendMode:()=>Bl,Cesium3DTileContent:()=>Mme,Cesium3DTileContentFactory:()=>Fx,Cesium3DTileContentState:()=>So,Cesium3DTileContentType:()=>Os,Cesium3DTileFeature:()=>Ds,Cesium3DTileFeatureTable:()=>Zd,Cesium3DTileOptimizationHint:()=>kf,Cesium3DTileOptimizations:()=>PF,Cesium3DTilePass:()=>er,Cesium3DTilePassState:()=>yd,Cesium3DTilePointFeature:()=>O_,Cesium3DTileRefine:()=>Or,Cesium3DTileStyle:()=>OE,Cesium3DTileStyleEngine:()=>LF,Cesium3DTilesInspector:()=>j4,Cesium3DTilesInspectorViewModel:()=>G4,Cesium3DTileset:()=>$c,Cesium3DTilesetCache:()=>BF,Cesium3DTilesetGraphics:()=>Ax,Cesium3DTilesetHeatmap:()=>RF,Cesium3DTilesetMetadata:()=>vF,Cesium3DTilesetMostDetailedTraversal:()=>uw,Cesium3DTilesetStatistics:()=>j_,Cesium3DTilesetTraversal:()=>Km,Cesium3DTilesetVisualizer:()=>kF,CesiumInspector:()=>X4,CesiumInspectorViewModel:()=>q4,CesiumTerrainProvider:()=>W3,CesiumWidget:()=>K4,Check:()=>Ki,CheckerboardMaterialProperty:()=>Dw,CircleEmitter:()=>ck,CircleGeometry:()=>Zfe,CircleOutlineGeometry:()=>Qfe,ClassificationModelDrawCommand:()=>LR,ClassificationPipelineStage:()=>rM,ClassificationPrimitive:()=>wS,ClassificationType:()=>Un,ClearCommand:()=>Qn,ClippingPlane:()=>IC,ClippingPlaneCollection:()=>Qs,Clock:()=>_h,ClockRange:()=>Nr,ClockStep:()=>po,ClockViewModel:()=>D4,CloudCollection:()=>zme,CloudType:()=>sv,Color:()=>z,ColorBlendMode:()=>oc,ColorGeometryInstanceAttribute:()=>Lt,ColorMaterialProperty:()=>Rt,Command:()=>C0e,ComponentDatatype:()=>J,Composite3DTileContent:()=>EL,CompositeEntityCollection:()=>Doe,CompositeMaterialProperty:()=>Bw,CompositePositionProperty:()=>ia,CompositeProperty:()=>pc,CompressedTextureBuffer:()=>r1,ComputeCommand:()=>Pf,ComputeEngine:()=>AV,ConditionsExpression:()=>ak,ConeEmitter:()=>Hme,ConstantPositionProperty:()=>Jc,ConstantProperty:()=>Kn,ConstantSpline:()=>bR,ContentMetadata:()=>dF,Context:()=>EV,ContextLimits:()=>Ut,CoplanarPolygonGeometry:()=>RN,CoplanarPolygonGeometryLibrary:()=>V_,CoplanarPolygonOutlineGeometry:()=>Gf,CornerType:()=>wi,CorridorGeometry:()=>oT,CorridorGeometryLibrary:()=>Bi,CorridorGeometryUpdater:()=>KF,CorridorGraphics:()=>mx,CorridorOutlineGeometry:()=>XF,Credit:()=>Jt,CreditDisplay:()=>Ek,CubeMap:()=>tc,CubeMapFace:()=>cm,CubicRealPolynomial:()=>xC,CullFace:()=>xi,CullingVolume:()=>$s,CumulusCloud:()=>af,CustomDataSource:()=>eN,CustomHeightmapTerrainProvider:()=>ede,CustomShader:()=>w0e,CustomShaderMode:()=>f_,CustomShaderPipelineStage:()=>pM,CustomShaderTranslucencyMode:()=>W0,CylinderGeometry:()=>tN,CylinderGeometryLibrary:()=>sT,CylinderGeometryUpdater:()=>iN,CylinderGraphics:()=>px,CylinderOutlineGeometry:()=>nN,CzmlDataSource:()=>mN,DataSource:()=>Fr,DataSourceClock:()=>gh,DataSourceCollection:()=>_N,DataSourceDisplay:()=>r2,DebugAppearance:()=>_pe,DebugCameraPrimitive:()=>Cp,DebugInspector:()=>Sk,DebugModelMatrixPrimitive:()=>Dk,DefaultProxy:()=>nde,DepthFunction:()=>cc,DepthPlane:()=>Pk,DequantizationPipelineStage:()=>_M,DerivedCommand:()=>Kg,DeveloperError:()=>Ce,DeviceOrientationCameraController:()=>Bk,DirectionalLight:()=>Tpe,DiscardEmptyTileImagePolicy:()=>tv,DiscardMissingTileImagePolicy:()=>qV,DistanceDisplayCondition:()=>wt,DistanceDisplayConditionGeometryInstanceAttribute:()=>Vn,DoubleEndedPriorityQueue:()=>rde,DoublyLinkedList:()=>IF,DracoLoader:()=>Jp,DrawCommand:()=>et,DynamicGeometryBatch:()=>CT,DynamicGeometryUpdater:()=>ei,EarthOrientationParameters:()=>KP,EarthOrientationParametersSample:()=>m0,EasingFunction:()=>Vr,EllipseGeometry:()=>il,EllipseGeometryLibrary:()=>Vl,EllipseGeometryUpdater:()=>SN,EllipseGraphics:()=>_x,EllipseOutlineGeometry:()=>Wu,Ellipsoid:()=>oe,EllipsoidGeodesic:()=>Of,EllipsoidGeometry:()=>Vs,EllipsoidGeometryUpdater:()=>wN,EllipsoidGraphics:()=>gx,EllipsoidOutlineGeometry:()=>Mu,EllipsoidPrimitive:()=>Rk,EllipsoidRhumbLine:()=>Ia,EllipsoidSurfaceAppearance:()=>bpe,EllipsoidTangentPlane:()=>Ca,EllipsoidTerrainProvider:()=>Lg,EllipsoidalOccluder:()=>Q_,Empty3DTileContent:()=>gw,EncodedCartesian3:()=>Hn,Entity:()=>Qo,EntityCluster:()=>Uu,EntityCollection:()=>Ms,EntityView:()=>c2,Event:()=>Ae,EventHelper:()=>Mr,ExpandBySTC:()=>xt,Expression:()=>Mf,ExpressionNodeType:()=>ht,ExtrapolationType:()=>zu,FeatureDetection:()=>Vt,FeatureIdPipelineStage:()=>G0,Fog:()=>Nk,ForEach:()=>ve,FrameRateMonitor:()=>Vk,FrameState:()=>kk,Framebuffer:()=>Xo,FramebufferManager:()=>ci,FrustumCommands:()=>Uk,FrustumGeometry:()=>CE,FrustumOutlineGeometry:()=>J3,Fullscreen:()=>gr,FullscreenButton:()=>$4,FullscreenButtonViewModel:()=>Z4,GeoJsonDataSource:()=>o3,GeoJsonLoader:()=>yR,GeocodeType:()=>nA,Geocoder:()=>nz,GeocoderService:()=>fde,GeocoderViewModel:()=>ez,GeographicProjection:()=>Ci,GeographicTilingScheme:()=>Wi,Geometry:()=>at,Geometry3DTileContent:()=>RL,GeometryAttribute:()=>we,GeometryAttributes:()=>cn,GeometryFactory:()=>hde,GeometryInstance:()=>Ct,GeometryInstanceAttribute:()=>uc,GeometryOffsetAttribute:()=>en,GeometryPipeline:()=>Fn,GeometryPipelineStage:()=>AM,GeometryType:()=>yf,GeometryUpdater:()=>ti,GeometryVisualizer:()=>KN,GetFeatureInfoFormat:()=>kE,Globe:()=>fU,GlobeDepth:()=>dU,GlobeSurfaceShaderSet:()=>Hk,GlobeSurfaceTile:()=>Td,GlobeSurfaceTileProvider:()=>eU,GlobeTranslucency:()=>tU,GlobeTranslucencyFramebuffer:()=>hU,GlobeTranslucencyState:()=>mU,GltfBufferViewLoader:()=>Yb,GltfDracoLoader:()=>Xb,GltfImageLoader:()=>Kb,GltfIndexBufferLoader:()=>Jb,GltfJsonLoader:()=>Qb,GltfLoader:()=>i_,GltfLoaderUtil:()=>El,GltfStructuralMetadataLoader:()=>nR,GltfTextureLoader:()=>$b,GltfVertexBufferLoader:()=>eS,GoogleEarthEnterpriseImageryProvider:()=>C_e,GoogleEarthEnterpriseMapsProvider:()=>_k,GoogleEarthEnterpriseMetadata:()=>Uh,GoogleEarthEnterpriseTerrainData:()=>UD,GoogleEarthEnterpriseTerrainProvider:()=>Tde,GoogleEarthEnterpriseTileInformation:()=>Q3,GpxDataSource:()=>y3,GregorianDate:()=>Op,GridImageryProvider:()=>x_e,GridMaterialProperty:()=>zw,GroundGeometryUpdater:()=>Wn,GroundPolylineGeometry:()=>lx,GroundPolylinePrimitive:()=>eh,GroundPrimitive:()=>Kc,GroupMetadata:()=>Ew,HeadingPitchRange:()=>Ku,HeadingPitchRoll:()=>yl,Heap:()=>WP,HeightReference:()=>Ge,HeightmapEncoding:()=>dd,HeightmapTerrainData:()=>ka,HeightmapTessellator:()=>MD,HermitePolynomialApproximation:()=>rN,HermiteSpline:()=>N0,HilbertOrder:()=>WS,HomeButton:()=>rz,HomeButtonViewModel:()=>iz,HorizontalOrigin:()=>ui,I3SDataProvider:()=>b_e,I3SFeature:()=>pU,I3SField:()=>_U,I3SGeometry:()=>Dv,I3SLayer:()=>Pv,I3SNode:()=>vv,I3dmLoader:()=>ER,I3dmParser:()=>CR,Iau2000Orientation:()=>nV,Iau2006XysData:()=>JP,Iau2006XysSample:()=>hC,IauOrientationAxes:()=>iV,IauOrientationParameters:()=>tV,ImageBasedLighting:()=>zC,ImageBasedLightingPipelineStage:()=>zR,ImageMaterialProperty:()=>$0,Imagery:()=>yv,ImageryLayer:()=>lf,ImageryLayerCollection:()=>iU,ImageryLayerFeatureInfo:()=>Hh,ImageryProvider:()=>fl,ImageryState:()=>ii,Implicit3DTileContent:()=>YS,ImplicitAvailabilityBitstream:()=>jS,ImplicitMetadataView:()=>qS,ImplicitSubdivisionScheme:()=>jr,ImplicitSubtree:()=>VL,ImplicitSubtreeMetadata:()=>NL,ImplicitTileCoordinates:()=>NF,ImplicitTileset:()=>FF,IndexDatatype:()=>Ne,InfoBox:()=>cz,InfoBoxViewModel:()=>sz,InspectorShared:()=>o0,InstanceAttributeSemantic:()=>Gr,InstancingPipelineStage:()=>$R,InterpolationAlgorithm:()=>Vde,InterpolationType:()=>Gd,Intersect:()=>jt,IntersectionTests:()=>ji,Intersections2D:()=>Rg,Interval:()=>Fc,InvertClassification:()=>Iv,Ion:()=>Lh,IonGeocoderService:()=>rV,IonImageryProvider:()=>qg,IonResource:()=>Fh,IonWorldImageryStyle:()=>Yg,Iso8601:()=>Ue,JobScheduler:()=>CU,JobType:()=>Sa,JsonMetadataTable:()=>jp,JulianDate:()=>te,KTX2Transcoder:()=>s1,KeyboardEventModifier:()=>aa,KmlCamera:()=>A3,KmlDataSource:()=>O3,KmlLookAt:()=>C3,KmlTour:()=>T3,KmlTourFlyTo:()=>b3,KmlTourWait:()=>S3,Label:()=>hy,LabelCollection:()=>jm,LabelGraphics:()=>th,LabelStyle:()=>Lo,LabelVisualizer:()=>JN,LagrangePolynomialApproximation:()=>sN,LeapSecond:()=>Mi,Light:()=>w_e,LightSource:()=>gV,LightSourceType:()=>Ha,LightingModel:()=>vm,LightingPipelineStage:()=>xM,LinearApproximation:()=>uT,LinearSpline:()=>F0,ManagedArray:()=>Eu,MapMode2D:()=>Zl,MapProjection:()=>Ude,MapboxImageryProvider:()=>gk,MapboxStyleImageryProvider:()=>v_e,Material:()=>$i,MaterialAppearance:()=>ro,MaterialPipelineStage:()=>EM,MaterialProperty:()=>Zo,Math:()=>B,Matrix2:()=>Ji,Matrix3:()=>$,Matrix4:()=>N,MetadataClass:()=>Yd,MetadataClassProperty:()=>v0,MetadataComponentType:()=>In,MetadataEntity:()=>Nn,MetadataEnum:()=>$O,MetadataEnumValue:()=>QO,MetadataPipelineStage:()=>Bf,MetadataSchema:()=>Xd,MetadataSchemaLoader:()=>tS,MetadataSemantic:()=>kL,MetadataTable:()=>wf,MetadataTableProperty:()=>BO,MetadataType:()=>Pn,MipmapHint:()=>lm,Model:()=>Au,Model3DTileContent:()=>zm,ModelAlphaOptions:()=>kM,ModelAnimation:()=>vR,ModelAnimationChannel:()=>DR,ModelAnimationCollection:()=>IR,ModelAnimationLoop:()=>ac,ModelAnimationState:()=>Qd,ModelArticulation:()=>WR,ModelArticulationStage:()=>HR,ModelClippingPlanesPipelineStage:()=>YR,ModelColorPipelineStage:()=>z0,ModelComponents:()=>It,ModelDrawCommand:()=>NR,ModelFeature:()=>BR,ModelFeatureTable:()=>OR,ModelGraphics:()=>y_,ModelLightingOptions:()=>QM,ModelMatrixUpdateStage:()=>eM,ModelNode:()=>XR,ModelRenderResources:()=>GM,ModelRuntimeNode:()=>nM,ModelRuntimePrimitive:()=>NM,ModelSceneGraph:()=>tL,ModelSilhouettePipelineStage:()=>YM,ModelSkin:()=>VM,ModelSplitterPipelineStage:()=>JM,ModelStatistics:()=>nL,ModelType:()=>sr,ModelUtility:()=>on,ModelVisualizer:()=>QN,Moon:()=>EU,MorphTargetsPipelineStage:()=>SM,MorphWeightSpline:()=>zde,MortonOrder:()=>wy,Multiple3DTileContent:()=>pF,MultisampleFramebuffer:()=>dR,NavigationHelpButton:()=>fz,NavigationHelpButtonViewModel:()=>lz,NearFarScalar:()=>Pt,NeverTileDiscardPolicy:()=>P_e,NodeRenderResources:()=>ZM,NodeStatisticsPipelineStage:()=>tM,NodeTransformationProperty:()=>yx,OIT:()=>bU,Occluder:()=>uV,OctahedralProjectedCubeMap:()=>Kd,OffsetGeometryInstanceAttribute:()=>Gi,OpenCageGeocoderService:()=>Wde,OpenStreetMapImageryProvider:()=>KE,OrderedGroundPrimitiveCollection:()=>yN,OrientedBoundingBox:()=>_i,OrthographicFrustum:()=>$t,OrthographicOffCenterFrustum:()=>Br,Packable:()=>jde,PackableForInterpolation:()=>qde,Particle:()=>Ov,ParticleBurst:()=>M_e,ParticleEmitter:()=>F_e,ParticleSystem:()=>k_e,Pass:()=>Te,PassState:()=>wc,PathGraphics:()=>A_,PathVisualizer:()=>$N,PeliasGeocoderService:()=>oV,PerInstanceColorAppearance:()=>tn,PerformanceDisplay:()=>Qg,PerformanceWatchdog:()=>mz,PerformanceWatchdogViewModel:()=>dz,PerspectiveFrustum:()=>yi,PerspectiveOffCenterFrustum:()=>ll,PickDepth:()=>vU,PickDepthFramebuffer:()=>PU,PickFramebuffer:()=>IU,Picking:()=>NU,PickingPipelineStage:()=>wM,PinBuilder:()=>Tg,PixelDatatype:()=>je,PixelFormat:()=>st,Plane:()=>rn,PlaneGeometry:()=>PN,PlaneGeometryUpdater:()=>ON,PlaneGraphics:()=>xL,PlaneOutlineGeometry:()=>BN,PntsLoader:()=>oL,PntsParser:()=>ix,PointCloud:()=>UU,PointCloudEyeDomeLighting:()=>o_,PointCloudShading:()=>xm,PointCloudStylingPipelineStage:()=>vM,PointGraphics:()=>Cx,PointLight:()=>Uhe,PointPrimitive:()=>Fs,PointPrimitiveCollection:()=>Nw,PointVisualizer:()=>e2,PolygonGeometry:()=>IT,PolygonGeometryLibrary:()=>Gn,PolygonGeometryUpdater:()=>NN,PolygonGraphics:()=>nh,PolygonHierarchy:()=>Zc,PolygonOutlineGeometry:()=>FN,PolygonPipeline:()=>ni,Polyline:()=>Lf,PolylineArrowMaterialProperty:()=>Hw,PolylineCollection:()=>M_,PolylineColorAppearance:()=>Wr,PolylineDashMaterialProperty:()=>Gw,PolylineGeometry:()=>_g,PolylineGeometryUpdater:()=>n2,PolylineGlowMaterialProperty:()=>Ww,PolylineGraphics:()=>dc,PolylineMaterialAppearance:()=>na,PolylineOutlineMaterialProperty:()=>Oy,PolylinePipeline:()=>Si,PolylineVisualizer:()=>o2,PolylineVolumeGeometry:()=>VN,PolylineVolumeGeometryLibrary:()=>mh,PolylineVolumeGeometryUpdater:()=>UN,PolylineVolumeGraphics:()=>xx,PolylineVolumeOutlineGeometry:()=>kN,PositionProperty:()=>g_,PositionPropertyArray:()=>eg,PostProcessStage:()=>go,PostProcessStageCollection:()=>r4,PostProcessStageComposite:()=>pl,PostProcessStageLibrary:()=>Sd,PostProcessStageSampleMode:()=>hf,PostProcessStageTextureCache:()=>tb,Primitive:()=>Sn,PrimitiveCollection:()=>Nl,PrimitiveLoadPlan:()=>UC,PrimitiveOutlineGenerator:()=>kC,PrimitiveOutlinePipelineStage:()=>BM,PrimitivePipeline:()=>rx,PrimitiveRenderResources:()=>$M,PrimitiveState:()=>Cr,PrimitiveStatisticsPipelineStage:()=>OM,PrimitiveType:()=>Re,ProjectionPicker:()=>yz,ProjectionPickerViewModel:()=>_z,Property:()=>q,PropertyArray:()=>jw,PropertyAttribute:()=>OC,PropertyAttributeProperty:()=>PO,PropertyBag:()=>Pl,PropertyTable:()=>Uc,PropertyTexture:()=>BC,PropertyTextureProperty:()=>vO,ProviderViewModel:()=>ys,Proxy:()=>Kde,QuadraticRealPolynomial:()=>Vc,QuadtreeOccluders:()=>oU,QuadtreePrimitive:()=>uU,QuadtreeTile:()=>sU,QuadtreeTileLoadState:()=>js,QuadtreeTileProvider:()=>gge,QuantizedMeshTerrainData:()=>pE,QuarticRealPolynomial:()=>R1,Quaternion:()=>Me,QuaternionSpline:()=>wR,Queue:()=>gy,Ray:()=>dn,Rectangle:()=>le,RectangleCollisionChecker:()=>kT,RectangleGeometry:()=>LT,RectangleGeometryLibrary:()=>_s,RectangleGeometryUpdater:()=>zN,RectangleGraphics:()=>ih,RectangleOutlineGeometry:()=>Wx,ReferenceFrame:()=>no,ReferenceProperty:()=>ng,RenderState:()=>Ve,Renderbuffer:()=>mu,RenderbufferFormat:()=>Hc,Request:()=>qo,RequestErrorEvent:()=>rm,RequestScheduler:()=>ec,RequestState:()=>ai,RequestType:()=>Qr,Resource:()=>Ie,ResourceCache:()=>fo,ResourceCacheKey:()=>Sl,ResourceCacheStatistics:()=>tR,ResourceLoader:()=>eo,ResourceLoaderState:()=>kt,Rotation:()=>Xf,RuntimeError:()=>he,S2Cell:()=>P_,SDFSettings:()=>Is,SampledPositionProperty:()=>oa,SampledProperty:()=>Hu,Sampler:()=>pn,ScaledPositionProperty:()=>hp,Scene:()=>T4,SceneFramebuffer:()=>JE,SceneMode:()=>ne,SceneMode2DPipelineStage:()=>RM,SceneModePicker:()=>wz,SceneModePickerViewModel:()=>bz,SceneTransforms:()=>Yi,SceneTransitioner:()=>a4,ScreenSpaceCameraController:()=>_4,ScreenSpaceEventHandler:()=>nf,ScreenSpaceEventType:()=>yn,SelectedFeatureIdPipelineStage:()=>j0,SelectionIndicator:()=>Tz,SelectionIndicatorViewModel:()=>Cz,ShaderBuilder:()=>HM,ShaderCache:()=>CV,ShaderDestination:()=>Ee,ShaderFunction:()=>zM,ShaderProgram:()=>qt,ShaderSource:()=>ze,ShaderStruct:()=>UM,ShadowMap:()=>e0,ShadowMapShader:()=>bp,ShadowMode:()=>gn,ShadowVolumeAppearance:()=>xu,ShowGeometryInstanceAttribute:()=>mn,Simon1994PlanetaryPositions:()=>sA,SimplePolylineGeometry:()=>Ohe,SingleTileImageryProvider:()=>yk,SkinningPipelineStage:()=>LM,SkyAtmosphere:()=>E4,SkyBox:()=>vC,SphereEmitter:()=>f0e,SphereGeometry:()=>Rhe,SphereOutlineGeometry:()=>H_,Spherical:()=>aN,Spline:()=>to,SplitDirection:()=>Wc,Splitter:()=>Vv,SpotLight:()=>zhe,StaticGeometryColorBatch:()=>ed,StaticGeometryPerMaterialBatch:()=>nd,StaticGroundGeometryColorBatch:()=>oD,StaticGroundGeometryPerMaterialBatch:()=>WN,StaticGroundPolylinePerMaterialBatch:()=>i2,StaticOutlineGeometryBatch:()=>rD,StencilConstants:()=>Ot,StencilFunction:()=>kn,StencilOperation:()=>ft,SteppedSpline:()=>SR,StripeMaterialProperty:()=>qw,StripeOrientation:()=>yh,StructuralMetadata:()=>Ea,StyleCommandsNeeded:()=>$d,StyleExpression:()=>d0e,Sun:()=>b4,SunLight:()=>Ug,SunPostProcess:()=>A4,SupportedImageFormats:()=>rR,SvgPathBindingHandler:()=>SV,TaskProcessor:()=>fi,TerrainData:()=>Rh,TerrainEncoding:()=>Tc,TerrainExaggeration:()=>kc,TerrainFillMesh:()=>xv,TerrainMesh:()=>hd,TerrainOffsetProperty:()=>bx,TerrainProvider:()=>Yr,TerrainQuantization:()=>Hs,TerrainState:()=>_o,Texture:()=>St,TextureAtlas:()=>uy,TextureCache:()=>xV,TextureMagnificationFilter:()=>Qi,TextureManager:()=>I4,TextureMinificationFilter:()=>fn,TextureUniform:()=>D0e,TextureWrap:()=>Mn,TileAvailability:()=>Mh,TileBoundingRegion:()=>Hf,TileBoundingS2Cell:()=>EF,TileBoundingSphere:()=>G_,TileBoundingVolume:()=>h0e,TileCoordinatesImageryProvider:()=>S4,TileDiscardPolicy:()=>m0e,TileEdge:()=>hn,TileImagery:()=>Av,TileMapServiceImageryProvider:()=>hA,TileMetadata:()=>hF,TileOrientedBoundingBox:()=>Wf,TileProviderError:()=>qn,TileReplacementQueue:()=>cU,TileSelectionResult:()=>Xn,TileState:()=>p0e,Tileset3DTileContent:()=>HL,TilesetMetadata:()=>DF,TilesetPipelineStage:()=>kR,TilingScheme:()=>Mhe,TimeConstants:()=>Yn,TimeDynamicImagery:()=>UE,TimeDynamicPointCloud:()=>Zv,TimeInterval:()=>xn,TimeIntervalCollection:()=>Lr,TimeIntervalCollectionPositionProperty:()=>og,TimeIntervalCollectionProperty:()=>rg,TimeStandard:()=>jn,Timeline:()=>Pz,TimelineHighlightRange:()=>Dz,TimelineTrack:()=>vz,Tipsify:()=>G1,ToggleButtonViewModel:()=>MA,Tonemapper:()=>DA,Transforms:()=>vt,TranslationRotationScale:()=>H0,TranslucentTileClassification:()=>OU,TridiagonalSystemSolver:()=>fS,TrustedServers:()=>Sb,TweenCollection:()=>nb,UniformState:()=>TV,UniformType:()=>$v,UrlTemplateImageryProvider:()=>qa,VERSION:()=>qmt,VRButton:()=>Rz,VRButtonViewModel:()=>Bz,VRTheWorldTerrainProvider:()=>Nhe,VaryingType:()=>v0e,Vector3DTileBatch:()=>Fm,Vector3DTileClampedPolylines:()=>sF,Vector3DTileContent:()=>cF,Vector3DTileGeometry:()=>S_,Vector3DTilePoints:()=>tF,Vector3DTilePolygons:()=>nF,Vector3DTilePolylines:()=>Lx,Vector3DTilePrimitive:()=>Dx,VelocityOrientationProperty:()=>lN,VelocityVectorProperty:()=>yT,VertexArray:()=>$n,VertexArrayFacade:()=>I_,VertexAttributeSemantic:()=>Tt,VertexFormat:()=>De,VerticalOrigin:()=>vn,VideoSynchronizer:()=>Lhe,View:()=>QE,Viewer:()=>sye,ViewportQuad:()=>A0e,Visibility:()=>fr,Visualizer:()=>Dfe,VulkanConstants:()=>Vhe,WallGeometry:()=>qN,WallGeometryLibrary:()=>GT,WallGeometryUpdater:()=>XN,WallGraphics:()=>C_,WallOutlineGeometry:()=>YN,WebGLConstants:()=>ee,WebMapServiceImageryProvider:()=>Ck,WebMapTileServiceImageryProvider:()=>xk,WebMercatorProjection:()=>bi,WebMercatorTilingScheme:()=>Xr,WindingOrder:()=>$r,WireframeIndexGenerator:()=>yS,WireframePipelineStage:()=>FM,_shadersAcesTonemappingStage:()=>zU,_shadersAdditiveBlend:()=>g4,_shadersAdjustTranslucentFS:()=>XD,_shadersAllMaterialAppearanceFS:()=>$P,_shadersAllMaterialAppearanceVS:()=>e1,_shadersAmbientOcclusionGenerate:()=>HU,_shadersAmbientOcclusionModulate:()=>GU,_shadersAspectRampMaterial:()=>f1,_shadersAtmosphereCommon:()=>zg,_shadersBasicMaterialAppearanceFS:()=>t1,_shadersBasicMaterialAppearanceVS:()=>n1,_shadersBillboardCollectionFS:()=>GL,_shadersBillboardCollectionVS:()=>WL,_shadersBlackAndWhite:()=>WU,_shadersBloomComposite:()=>jU,_shadersBrdfLutGeneratorFS:()=>wV,_shadersBrightPass:()=>y4,_shadersBrightness:()=>qU,_shadersBumpMapMaterial:()=>d1,_shadersCPUStylingStageFS:()=>aM,_shadersCPUStylingStageVS:()=>sM,_shadersCheckerboardMaterial:()=>h1,_shadersCloudCollectionFS:()=>DV,_shadersCloudCollectionVS:()=>vV,_shadersCloudNoiseFS:()=>PV,_shadersCloudNoiseVS:()=>IV,_shadersCompareAndPackTranslucentDepth:()=>BV,_shadersCompositeOITFS:()=>OV,_shadersCompositeTranslucentClassification:()=>ZE,_shadersContrastBias:()=>YU,_shadersCustomShaderStageFS:()=>uM,_shadersCustomShaderStageVS:()=>lM,_shadersCzmBuiltins:()=>DC,_shadersDepthOfField:()=>XU,_shadersDepthPlaneFS:()=>RV,_shadersDepthPlaneVS:()=>MV,_shadersDepthView:()=>KU,_shadersDepthViewPacked:()=>T0e,_shadersDotMaterial:()=>m1,_shadersEdgeDetection:()=>JU,_shadersElevationBandMaterial:()=>p1,_shadersElevationContourMaterial:()=>_1,_shadersElevationRampMaterial:()=>g1,_shadersEllipsoidFS:()=>KD,_shadersEllipsoidSurfaceAppearanceFS:()=>Mk,_shadersEllipsoidSurfaceAppearanceVS:()=>Lk,_shadersEllipsoidVS:()=>JD,_shadersFXAA:()=>QU,_shadersFXAA3_11:()=>LV,_shadersFadeMaterial:()=>y1,_shadersFeatureIdStageFS:()=>fM,_shadersFeatureIdStageVS:()=>dM,_shadersFilmicTonemapping:()=>ZU,_shadersGaussianBlur1D:()=>SA,_shadersGeometryStageFS:()=>gM,_shadersGeometryStageVS:()=>yM,_shadersGlobeFS:()=>FV,_shadersGlobeVS:()=>NV,_shadersGridMaterial:()=>A1,_shadersGroundAtmosphere:()=>ZD,_shadersHSBToRGB:()=>bB,_shadersHSLToRGB:()=>SB,_shadersImageBasedLightingStageFS:()=>UR,_shadersInstancingStageCommon:()=>KR,_shadersInstancingStageVS:()=>JR,_shadersLegacyInstancingStageVS:()=>ZR,_shadersLensFlare:()=>$U,_shadersLightingStageFS:()=>CM,_shadersMaterialStageFS:()=>TM,_shadersMetadataStageFS:()=>hM,_shadersMetadataStageVS:()=>mM,_shadersModelClippingPlanesStageFS:()=>qR,_shadersModelColorStageFS:()=>jR,_shadersModelFS:()=>RR,_shadersModelSilhouetteStageFS:()=>WM,_shadersModelSilhouetteStageVS:()=>jM,_shadersModelSplitterStageFS:()=>XM,_shadersModelVS:()=>MR,_shadersModifiedReinhardTonemapping:()=>e4,_shadersMorphTargetsStageVS:()=>bM,_shadersNightVision:()=>t4,_shadersNormalMapMaterial:()=>C1,_shadersOctahedralProjectionAtlasFS:()=>aR,_shadersOctahedralProjectionFS:()=>cR,_shadersOctahedralProjectionVS:()=>lR,_shadersPassThrough:()=>tu,_shadersPassThroughDepth:()=>_A,_shadersPerInstanceColorAppearanceFS:()=>P1,_shadersPerInstanceColorAppearanceVS:()=>I1,_shadersPerInstanceFlatColorAppearanceFS:()=>AC,_shadersPerInstanceFlatColorAppearanceVS:()=>B1,_shadersPointCloudEyeDomeLighting:()=>mR,_shadersPointCloudStylingStageVS:()=>DM,_shadersPointPrimitiveCollectionFS:()=>Py,_shadersPointPrimitiveCollectionVS:()=>QF,_shadersPolylineArrowMaterial:()=>x1,_shadersPolylineColorAppearanceVS:()=>AL,_shadersPolylineCommon:()=>Tu,_shadersPolylineDashMaterial:()=>T1,_shadersPolylineFS:()=>ux,_shadersPolylineGlowMaterial:()=>E1,_shadersPolylineMaterialAppearanceVS:()=>CL,_shadersPolylineOutlineMaterial:()=>b1,_shadersPolylineShadowVolumeFS:()=>pL,_shadersPolylineShadowVolumeMorphFS:()=>_L,_shadersPolylineShadowVolumeMorphVS:()=>gL,_shadersPolylineShadowVolumeVS:()=>yL,_shadersPolylineVS:()=>JL,_shadersPrimitiveOutlineStageFS:()=>IM,_shadersPrimitiveOutlineStageVS:()=>PM,_shadersRGBToHSB:()=>ZB,_shadersRGBToHSL:()=>QB,_shadersRGBToXYZ:()=>$B,_shadersReinhardTonemapping:()=>n4,_shadersReprojectWebMercatorFS:()=>VV,_shadersReprojectWebMercatorVS:()=>kV,_shadersRimLightingMaterial:()=>S1,_shadersSelectedFeatureIdStageCommon:()=>_S,_shadersShadowVolumeAppearanceFS:()=>SS,_shadersShadowVolumeAppearanceVS:()=>sL,_shadersShadowVolumeFS:()=>X0,_shadersSilhouette:()=>i4,_shadersSkinningStageVS:()=>MM,_shadersSkyAtmosphereCommon:()=>QD,_shadersSkyAtmosphereFS:()=>UV,_shadersSkyAtmosphereVS:()=>zV,_shadersSkyBoxFS:()=>EO,_shadersSkyBoxVS:()=>bO,_shadersSlopeRampMaterial:()=>w1,_shadersStripeMaterial:()=>D1,_shadersSunFS:()=>HV,_shadersSunTextureFS:()=>GV,_shadersSunVS:()=>WV,_shadersTexturedMaterialAppearanceFS:()=>i1,_shadersTexturedMaterialAppearanceVS:()=>o1,_shadersVector3DTileClampedPolylinesFS:()=>rF,_shadersVector3DTileClampedPolylinesVS:()=>oF,_shadersVector3DTilePolylinesVS:()=>iF,_shadersVectorTileVS:()=>HS,_shadersViewportQuadFS:()=>jV,_shadersViewportQuadVS:()=>wE,_shadersWater:()=>v1,_shadersXYZToRGB:()=>TO,_shadersacesTonemapping:()=>XI,_shadersalphaWeight:()=>KI,_shadersantialias:()=>JI,_shadersapproximateSphericalCoordinates:()=>ZI,_shadersbackFacing:()=>QI,_shadersbranchFreeTernary:()=>$I,_shaderscascadeColor:()=>eB,_shaderscascadeDistance:()=>tB,_shaderscascadeMatrix:()=>nB,_shaderscascadeWeights:()=>iB,_shaderscolumbusViewMorph:()=>oB,_shaderscomputePosition:()=>rB,_shaderscosineAndSine:()=>sB,_shadersdecompressTextureCoordinates:()=>aB,_shadersdefaultPbrMaterial:()=>cB,_shadersdegreesPerRadian:()=>tI,_shadersdepthClamp:()=>lB,_shadersdepthRange:()=>nI,_shadersdepthRangeStruct:()=>VI,_shaderseastNorthUpToEyeCoordinates:()=>uB,_shadersellipsoidContainsPoint:()=>fB,_shadersellipsoidWgs84TextureCoordinates:()=>dB,_shadersepsilon1:()=>iI,_shadersepsilon2:()=>oI,_shadersepsilon3:()=>rI,_shadersepsilon4:()=>sI,_shadersepsilon5:()=>aI,_shadersepsilon6:()=>cI,_shadersepsilon7:()=>lI,_shadersequalsEpsilon:()=>hB,_shaderseyeOffset:()=>mB,_shaderseyeToWindowCoordinates:()=>pB,_shadersfastApproximateAtan:()=>_B,_shadersfog:()=>gB,_shadersgammaCorrect:()=>yB,_shadersgeodeticSurfaceNormal:()=>AB,_shadersgeometryInput:()=>kI,_shadersgetDefaultMaterial:()=>CB,_shadersgetLambertDiffuse:()=>xB,_shadersgetSpecular:()=>TB,_shadersgetWaterNoise:()=>EB,_shadershue:()=>wB,_shadersinfinity:()=>uI,_shadersinverseGamma:()=>DB,_shadersisEmpty:()=>vB,_shadersisFull:()=>PB,_shaderslatitudeToWebMercatorFraction:()=>IB,_shaderslineDistance:()=>OB,_shaderslinearToSrgb:()=>BB,_shadersluminance:()=>RB,_shadersmaterial:()=>UI,_shadersmaterialInput:()=>zI,_shadersmetersPerPixel:()=>MB,_shadersmodelMaterial:()=>HI,_shadersmodelToWindowCoordinates:()=>LB,_shadersmodelVertexOutput:()=>GI,_shadersmultiplyWithColorBalance:()=>FB,_shadersnearFarScalar:()=>NB,_shadersoctDecode:()=>VB,_shadersoneOverPi:()=>fI,_shadersoneOverTwoPi:()=>dI,_shaderspackDepth:()=>kB,_shaderspassCesium3DTile:()=>hI,_shaderspassCesium3DTileClassification:()=>mI,_shaderspassCesium3DTileClassificationIgnoreShow:()=>pI,_shaderspassClassification:()=>_I,_shaderspassCompute:()=>gI,_shaderspassEnvironment:()=>yI,_shaderspassGlobe:()=>AI,_shaderspassOpaque:()=>CI,_shaderspassOverlay:()=>xI,_shaderspassTerrainClassification:()=>TI,_shaderspassTranslucent:()=>EI,_shaderspbrLighting:()=>UB,_shaderspbrMetallicRoughnessMaterial:()=>zB,_shaderspbrParameters:()=>WI,_shaderspbrSpecularGlossinessMaterial:()=>HB,_shadersphong:()=>GB,_shaderspi:()=>bI,_shaderspiOverFour:()=>SI,_shaderspiOverSix:()=>wI,_shaderspiOverThree:()=>DI,_shaderspiOverTwo:()=>vI,_shadersplaneDistance:()=>WB,_shaderspointAlongRay:()=>jB,_shadersradiansPerDegree:()=>PI,_shadersray:()=>jI,_shadersrayEllipsoidIntersectionInterval:()=>qB,_shadersraySegment:()=>qI,_shadersraySphereIntersectionInterval:()=>YB,_shadersreadDepth:()=>XB,_shadersreadNonPerspective:()=>KB,_shadersreverseLogDepth:()=>JB,_shadersround:()=>eO,_shaderssampleOctahedralProjection:()=>tO,_shaderssaturation:()=>nO,_shaderssceneMode2D:()=>II,_shaderssceneMode3D:()=>BI,_shaderssceneModeColumbusView:()=>OI,_shaderssceneModeMorphing:()=>RI,_shadersshadowDepthCompare:()=>iO,_shadersshadowParameters:()=>YI,_shadersshadowVisibility:()=>oO,_shaderssignNotZero:()=>rO,_shaderssolarRadius:()=>MI,_shaderssphericalHarmonics:()=>sO,_shaderssrgbToLinear:()=>aO,_shaderstangentToEyeSpaceMatrix:()=>cO,_shadersthreePiOver2:()=>LI,_shaderstransformPlane:()=>lO,_shaderstranslateRelativeToEye:()=>uO,_shaderstranslucentPhong:()=>fO,_shaderstranspose:()=>dO,_shaderstwoPi:()=>FI,_shadersunpackDepth:()=>hO,_shadersunpackFloat:()=>mO,_shadersunpackUint:()=>pO,_shadersvalueTransform:()=>_O,_shadersvertexLogDepth:()=>gO,_shaderswebMercatorMaxLatitude:()=>NI,_shaderswindowToEyeCoordinates:()=>yO,_shaderswriteDepthClamp:()=>AO,_shaderswriteLogDepth:()=>CO,_shaderswriteNonPerspective:()=>xO,addBuffer:()=>WO,addDefaults:()=>MO,addExtensionsRequired:()=>zO,addExtensionsUsed:()=>Df,addPipelineExtras:()=>I0,addToArray:()=>fs,appendForwardSlash:()=>UP,arrayRemoveDuplicates:()=>Co,barycentricCoordinates:()=>TC,binarySearch:()=>jo,buildDrawCommand:()=>VR,buildModuleUrl:()=>Qt,clone:()=>tt,combine:()=>At,computeFlyToLocationForRectangle:()=>RE,createBillboardPointCallback:()=>Ix,createCommand:()=>Tn,createDefaultImageryProviderViewModels:()=>U4,createDefaultTerrainProviderViewModels:()=>z4,createElevationBandMaterial:()=>qme,createGuid:()=>Bn,createMaterialPropertyDescriptor:()=>Po,createOsmBuildings:()=>Yme,createPropertyDescriptor:()=>ce,createRawPropertyDescriptor:()=>vl,createTangentSpaceDebugPrimitive:()=>Xme,createTaskProcessorWorker:()=>dye,createUniform:()=>V1,createUniformArray:()=>k1,createWorldImagery:()=>Xg,createWorldTerrain:()=>q3,decodeGoogleEarthEnterpriseData:()=>Y3,decodeVectorPolylinePositions:()=>aF,defaultValue:()=>A,defer:()=>Zr,defined:()=>f,deprecationWarning:()=>ws,destroyObject:()=>ue,exportKml:()=>eue,findAccessorMinMax:()=>FC,findContentMetadata:()=>Nx,findGroupMetadata:()=>Vx,findTileMetadata:()=>mF,forEachTextureInMaterial:()=>Zb,formatError:()=>_p,freezeRenderState:()=>gJ,getAbsoluteUri:()=>Lp,getAccessorByteStride:()=>Tl,getBaseUri:()=>zP,getBinaryAccessor:()=>_u,getClipAndStyleCode:()=>zk,getClippingFunction:()=>zE,getComponentReader:()=>Wp,getElement:()=>On,getExtensionFromUri:()=>iC,getFilenameFromUri:()=>$_,getImageFromTypedArray:()=>Z3,getImagePixels:()=>Id,getJsonFromTypedArray:()=>Ko,getMagic:()=>Wd,getStringFromTypedArray:()=>bl,getTimestamp:()=>Fi,hasExtension:()=>Li,heightReferenceOnEntityPropertyChanged:()=>x_,isBitSet:()=>Sc,isBlobUri:()=>oC,isCrossOriginUrl:()=>rC,isDataUri:()=>Fp,isLeapYear:()=>Rp,knockout:()=>xe,knockout_3_5_1:()=>DE,knockout_es5:()=>bV,loadAndExecuteScript:()=>sC,loadCubeMap:()=>Q1,loadImageFromTypedArray:()=>MC,loadKTX2:()=>xl,mergeSort:()=>oA,modernizeShader:()=>eI,moveTechniqueRenderStates:()=>UO,moveTechniquesToExtension:()=>HO,numberOfComponentsForType:()=>du,objectToQuery:()=>aC,oneTimeWarning:()=>Bt,parseBatchTable:()=>s_,parseBoundingVolumeSemantics:()=>UL,parseFeatureMetadataLegacy:()=>RO,parseGlb:()=>NO,parseResponseHeaders:()=>GP,parseStructuralMetadata:()=>OO,pointInsideTriangle:()=>Yde,preprocess3DTileContent:()=>kx,queryToObject:()=>cu,readAccessorPacked:()=>jO,removeExtension:()=>NC,removeExtensionsRequired:()=>FO,removeExtensionsUsed:()=>LC,removePipelineExtras:()=>kO,removeUnusedElements:()=>GO,resizeImageToNextPowerOfTwo:()=>B0,sampleTerrain:()=>ZN,sampleTerrainMostDetailed:()=>dg,scaleToGeodeticSurface:()=>KA,subdivideArray:()=>aL,subscribeAndEvaluate:()=>da,updateAccessorComponentTypes:()=>YO,updateVersion:()=>ZO,usesExtension:()=>yr,viewerCesium3DTilesInspectorMixin:()=>aye,viewerCesiumInspectorMixin:()=>cye,viewerDragDropMixin:()=>uye,viewerPerformanceWatchdogMixin:()=>fye,webGLConstantToGlslType:()=>khe,wrapFunction:()=>_V,writeTextToCanvas:()=>Ox});function AY(t,n){return t!=null?t:n}AY.EMPTY_OBJECT=Object.freeze({});var A=AY;function Pye(t){return t!=null}var f=Pye;function f0(t){this.name="DeveloperError",this.message=t;let n;try{throw new Error}catch(i){n=i.stack}this.stack=n}f(Object.create)&&(f0.prototype=Object.create(Error.prototype),f0.prototype.constructor=f0);f0.prototype.toString=function(){let t=`${this.name}: ${this.message}`;return f(this.stack)&&(t+=`
${this.stack.toString()}`),t};f0.throwInstantiationError=function(){throw new f0("This function defines an interface and should not be called directly.")};var Ce=f0;var Jr={};Jr.typeOf={};function Iye(t){return`${t} is required, actual value was undefined`}function YA(t,n,i){return`Expected ${i} to be typeof ${n}, actual typeof was ${t}`}Jr.defined=function(t,n){if(!f(n))throw new Ce(Iye(t))};Jr.typeOf.func=function(t,n){if(typeof n!="function")throw new Ce(YA(typeof n,"function",t))};Jr.typeOf.string=function(t,n){if(typeof n!="string")throw new Ce(YA(typeof n,"string",t))};Jr.typeOf.number=function(t,n){if(typeof n!="number")throw new Ce(YA(typeof n,"number",t))};Jr.typeOf.number.lessThan=function(t,n,i){if(Jr.typeOf.number(t,n),n>=i)throw new Ce(`Expected ${t} to be less than ${i}, actual value was ${n}`)};Jr.typeOf.number.lessThanOrEquals=function(t,n,i){if(Jr.typeOf.number(t,n),n>i)throw new Ce(`Expected ${t} to be less than or equal to ${i}, actual value was ${n}`)};Jr.typeOf.number.greaterThan=function(t,n,i){if(Jr.typeOf.number(t,n),n<=i)throw new Ce(`Expected ${t} to be greater than ${i}, actual value was ${n}`)};Jr.typeOf.number.greaterThanOrEquals=function(t,n,i){if(Jr.typeOf.number(t,n),n<i)throw new Ce(`Expected ${t} to be greater than or equal to ${i}, actual value was ${n}`)};Jr.typeOf.object=function(t,n){if(typeof n!="object")throw new Ce(YA(typeof n,"object",t))};Jr.typeOf.bool=function(t,n){if(typeof n!="boolean")throw new Ce(YA(typeof n,"boolean",t))};Jr.typeOf.bigint=function(t,n){if(typeof n!="bigint")throw new Ce(YA(typeof n,"bigint",t))};Jr.typeOf.number.equals=function(t,n,i,o){if(Jr.typeOf.number(t,i),Jr.typeOf.number(n,o),i!==o)throw new Ce(`${t} must be equal to ${n}, the actual values are ${i} and ${o}`)};var Ki=Jr;function _b(){this._listeners=[],this._scopes=[],this._toRemove=[],this._insideRaiseEvent=!1}Object.defineProperties(_b.prototype,{numberOfListeners:{get:function(){return this._listeners.length-this._toRemove.length}}});_b.prototype.addEventListener=function(t,n){this._listeners.push(t),this._scopes.push(n);let i=this;return function(){i.removeEventListener(t,n)}};_b.prototype.removeEventListener=function(t,n){let i=this._listeners,o=this._scopes,r=-1;for(let s=0;s<i.length;s++)if(i[s]===t&&o[s]===n){r=s;break}return r!==-1?(this._insideRaiseEvent?(this._toRemove.push(r),i[r]=void 0,o[r]=void 0):(i.splice(r,1),o.splice(r,1)),!0):!1};function Bye(t,n){return n-t}_b.prototype.raiseEvent=function(){this._insideRaiseEvent=!0;let t,n=this._listeners,i=this._scopes,o=n.length;for(t=0;t<o;t++){let s=n[t];f(s)&&n[t].apply(i[t],arguments)}let r=this._toRemove;if(o=r.length,o>0){for(r.sort(Bye),t=0;t<o;t++){let s=r[t];n.splice(s,1),i.splice(s,1)}r.length=0}this._insideRaiseEvent=!1};var Ae=_b;function Pp(t){this._value=void 0,this._hasClone=!1,this._hasEquals=!1,this._definitionChanged=new Ae,this.setValue(t)}Object.defineProperties(Pp.prototype,{isConstant:{value:!0},definitionChanged:{get:function(){return this._definitionChanged}}});Pp.prototype.getValue=function(t,n){return this._hasClone?this._value.clone(n):this._value};Pp.prototype.setValue=function(t){let n=this._value;if(n!==t){let i=f(t),o=i&&typeof t.clone=="function",r=i&&typeof t.equals=="function";(!r||!t.equals(n))&&(this._hasClone=o,this._hasEquals=r,this._value=o?t.clone(this._value):t,this._definitionChanged.raiseEvent(this))}};Pp.prototype.equals=function(t){return this===t||t instanceof Pp&&(!this._hasEquals&&this._value===t._value||this._hasEquals&&this._value.equals(t._value))};Pp.prototype.valueOf=function(){return this._value};Pp.prototype.toString=function(){return String(this._value)};var Kn=Pp;function Oye(t,n,i,o,r){return{configurable:o,get:function(){return this[n]},set:function(s){let a=this[n],c=this[i];f(c)&&(c(),this[i]=void 0),s!==void 0&&(!f(s)||!f(s.getValue))&&f(r)&&(s=r(s)),a!==s&&(this[n]=s,this._definitionChanged.raiseEvent(this,t,s,a)),f(s)&&f(s.definitionChanged)&&(this[i]=s.definitionChanged.addEventListener(function(){this._definitionChanged.raiseEvent(this,t,s,s)},this))}}}function Rye(t){return new Kn(t)}function Mye(t,n,i){return Oye(t,`_${t.toString()}`,`_${t.toString()}Subscription`,A(n,!1),A(i,Rye))}var ce=Mye;function gb(t){this._definitionChanged=new Ae,this._show=void 0,this._showSubscription=void 0,this._image=void 0,this._imageSubscription=void 0,this._scale=void 0,this._scaleSubscription=void 0,this._pixelOffset=void 0,this._pixelOffsetSubscription=void 0,this._eyeOffset=void 0,this._eyeOffsetSubscription=void 0,this._horizontalOrigin=void 0,this._horizontalOriginSubscription=void 0,this._verticalOrigin=void 0,this._verticalOriginSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._color=void 0,this._colorSubscription=void 0,this._rotation=void 0,this._rotationSubscription=void 0,this._alignedAxis=void 0,this._alignedAxisSubscription=void 0,this._sizeInMeters=void 0,this._sizeInMetersSubscription=void 0,this._width=void 0,this._widthSubscription=void 0,this._height=void 0,this._heightSubscription=void 0,this._scaleByDistance=void 0,this._scaleByDistanceSubscription=void 0,this._translucencyByDistance=void 0,this._translucencyByDistanceSubscription=void 0,this._pixelOffsetScaleByDistance=void 0,this._pixelOffsetScaleByDistanceSubscription=void 0,this._imageSubRegion=void 0,this._imageSubRegionSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._disableDepthTestDistance=void 0,this._disableDepthTestDistanceSubscription=void 0,this.merge(A(t,A.EMPTY_OBJECT))}Object.defineProperties(gb.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:ce("show"),image:ce("image"),scale:ce("scale"),pixelOffset:ce("pixelOffset"),eyeOffset:ce("eyeOffset"),horizontalOrigin:ce("horizontalOrigin"),verticalOrigin:ce("verticalOrigin"),heightReference:ce("heightReference"),color:ce("color"),rotation:ce("rotation"),alignedAxis:ce("alignedAxis"),sizeInMeters:ce("sizeInMeters"),width:ce("width"),height:ce("height"),scaleByDistance:ce("scaleByDistance"),translucencyByDistance:ce("translucencyByDistance"),pixelOffsetScaleByDistance:ce("pixelOffsetScaleByDistance"),imageSubRegion:ce("imageSubRegion"),distanceDisplayCondition:ce("distanceDisplayCondition"),disableDepthTestDistance:ce("disableDepthTestDistance")});gb.prototype.clone=function(t){return f(t)?(t.show=this._show,t.image=this._image,t.scale=this._scale,t.pixelOffset=this._pixelOffset,t.eyeOffset=this._eyeOffset,t.horizontalOrigin=this._horizontalOrigin,t.verticalOrigin=this._verticalOrigin,t.heightReference=this._heightReference,t.color=this._color,t.rotation=this._rotation,t.alignedAxis=this._alignedAxis,t.sizeInMeters=this._sizeInMeters,t.width=this._width,t.height=this._height,t.scaleByDistance=this._scaleByDistance,t.translucencyByDistance=this._translucencyByDistance,t.pixelOffsetScaleByDistance=this._pixelOffsetScaleByDistance,t.imageSubRegion=this._imageSubRegion,t.distanceDisplayCondition=this._distanceDisplayCondition,t.disableDepthTestDistance=this._disableDepthTestDistance,t):new gb(this)};gb.prototype.merge=function(t){this.show=A(this._show,t.show),this.image=A(this._image,t.image),this.scale=A(this._scale,t.scale),this.pixelOffset=A(this._pixelOffset,t.pixelOffset),this.eyeOffset=A(this._eyeOffset,t.eyeOffset),this.horizontalOrigin=A(this._horizontalOrigin,t.horizontalOrigin),this.verticalOrigin=A(this._verticalOrigin,t.verticalOrigin),this.heightReference=A(this._heightReference,t.heightReference),this.color=A(this._color,t.color),this.rotation=A(this._rotation,t.rotation),this.alignedAxis=A(this._alignedAxis,t.alignedAxis),this.sizeInMeters=A(this._sizeInMeters,t.sizeInMeters),this.width=A(this._width,t.width),this.height=A(this._height,t.height),this.scaleByDistance=A(this._scaleByDistance,t.scaleByDistance),this.translucencyByDistance=A(this._translucencyByDistance,t.translucencyByDistance),this.pixelOffsetScaleByDistance=A(this._pixelOffsetScaleByDistance,t.pixelOffsetScaleByDistance),this.imageSubRegion=A(this._imageSubRegion,t.imageSubRegion),this.distanceDisplayCondition=A(this._distanceDisplayCondition,t.distanceDisplayCondition),this.disableDepthTestDistance=A(this._disableDepthTestDistance,t.disableDepthTestDistance)};var Qa=gb;function d0(){this._array=[],this._hash={}}Object.defineProperties(d0.prototype,{length:{get:function(){return this._array.length}},values:{get:function(){return this._array}}});d0.prototype.contains=function(t){return f(this._hash[t])};d0.prototype.set=function(t,n){let i=this._hash[t];n!==i&&(this.remove(t),this._hash[t]=n,this._array.push(n))};d0.prototype.get=function(t){return this._hash[t]};d0.prototype.remove=function(t){let n=this._hash[t],i=f(n);if(i){let o=this._array;o.splice(o.indexOf(n),1),delete this._hash[t]}return i};d0.prototype.removeAll=function(){let t=this._array;t.length>0&&(this._hash={},t.length=0)};var yt=d0;var Yz=yo(pP(),1);var it={};it.EPSILON1=.1;it.EPSILON2=.01;it.EPSILON3=.001;it.EPSILON4=1e-4;it.EPSILON5=1e-5;it.EPSILON6=1e-6;it.EPSILON7=1e-7;it.EPSILON8=1e-8;it.EPSILON9=1e-9;it.EPSILON10=1e-10;it.EPSILON11=1e-11;it.EPSILON12=1e-12;it.EPSILON13=1e-13;it.EPSILON14=1e-14;it.EPSILON15=1e-15;it.EPSILON16=1e-16;it.EPSILON17=1e-17;it.EPSILON18=1e-18;it.EPSILON19=1e-19;it.EPSILON20=1e-20;it.EPSILON21=1e-21;it.GRAVITATIONALPARAMETER=3986004418e5;it.SOLAR_RADIUS=6955e5;it.LUNAR_RADIUS=1737400;it.SIXTY_FOUR_KILOBYTES=64*1024;it.FOUR_GIGABYTES=4*1024*1024*1024;it.sign=A(Math.sign,function(n){return n=+n,n===0||n!==n?n:n>0?1:-1});it.signNotZero=function(t){return t<0?-1:1};it.toSNorm=function(t,n){return n=A(n,255),Math.round((it.clamp(t,-1,1)*.5+.5)*n)};it.fromSNorm=function(t,n){return n=A(n,255),it.clamp(t,0,n)/n*2-1};it.normalize=function(t,n,i){return i=Math.max(i-n,0),i===0?0:it.clamp((t-n)/i,0,1)};it.sinh=A(Math.sinh,function(n){return(Math.exp(n)-Math.exp(-n))/2});it.cosh=A(Math.cosh,function(n){return(Math.exp(n)+Math.exp(-n))/2});it.lerp=function(t,n,i){return(1-i)*t+i*n};it.PI=Math.PI;it.ONE_OVER_PI=1/Math.PI;it.PI_OVER_TWO=Math.PI/2;it.PI_OVER_THREE=Math.PI/3;it.PI_OVER_FOUR=Math.PI/4;it.PI_OVER_SIX=Math.PI/6;it.THREE_PI_OVER_TWO=3*Math.PI/2;it.TWO_PI=2*Math.PI;it.ONE_OVER_TWO_PI=1/(2*Math.PI);it.RADIANS_PER_DEGREE=Math.PI/180;it.DEGREES_PER_RADIAN=180/Math.PI;it.RADIANS_PER_ARCSECOND=it.RADIANS_PER_DEGREE/3600;it.toRadians=function(t){return t*it.RADIANS_PER_DEGREE};it.toDegrees=function(t){return t*it.DEGREES_PER_RADIAN};it.convertLongitudeRange=function(t){let n=it.TWO_PI,i=t-Math.floor(t/n)*n;return i<-Math.PI?i+n:i>=Math.PI?i-n:i};it.clampToLatitudeRange=function(t){return it.clamp(t,-1*it.PI_OVER_TWO,it.PI_OVER_TWO)};it.negativePiToPi=function(t){return t>=-it.PI&&t<=it.PI?t:it.zeroToTwoPi(t+it.PI)-it.PI};it.zeroToTwoPi=function(t){if(t>=0&&t<=it.TWO_PI)return t;let n=it.mod(t,it.TWO_PI);return Math.abs(n)<it.EPSILON14&&Math.abs(t)>it.EPSILON14?it.TWO_PI:n};it.mod=function(t,n){return it.sign(t)===it.sign(n)&&Math.abs(t)<Math.abs(n)?t:(t%n+n)%n};it.equalsEpsilon=function(t,n,i,o){i=A(i,0),o=A(o,i);let r=Math.abs(t-n);return r<=o||r<=i*Math.max(Math.abs(t),Math.abs(n))};it.lessThan=function(t,n,i){return t-n<-i};it.lessThanOrEquals=function(t,n,i){return t-n<i};it.greaterThan=function(t,n,i){return t-n>i};it.greaterThanOrEquals=function(t,n,i){return t-n>-i};var _P=[1];it.factorial=function(t){let n=_P.length;if(t>=n){let i=_P[n-1];for(let o=n;o<=t;o++){let r=i*o;_P.push(r),i=r}}return _P[t]};it.incrementWrap=function(t,n,i){return i=A(i,0),++t,t>n&&(t=i),t};it.isPowerOfTwo=function(t){return t!==0&&(t&t-1)===0};it.nextPowerOfTwo=function(t){return--t,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,++t,t};it.previousPowerOfTwo=function(t){return t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,t|=t>>32,t=(t>>>0)-(t>>>1),t};it.clamp=function(t,n,i){return t<n?n:t>i?i:t};var xY=new Yz.default;it.setRandomNumberSeed=function(t){xY=new Yz.default(t)};it.nextRandomNumber=function(){return xY.random()};it.randomBetween=function(t,n){return it.nextRandomNumber()*(n-t)+t};it.acosClamped=function(t){return Math.acos(it.clamp(t,-1,1))};it.asinClamped=function(t){return Math.asin(it.clamp(t,-1,1))};it.chordLength=function(t,n){return 2*n*Math.sin(t*.5)};it.logBase=function(t,n){return Math.log(t)/Math.log(n)};it.cbrt=A(Math.cbrt,function(n){let i=Math.pow(Math.abs(n),.3333333333333333);return n<0?-i:i});it.log2=A(Math.log2,function(n){return Math.log(n)*Math.LOG2E});it.fog=function(t,n){let i=t*n;return 1-Math.exp(-(i*i))};it.fastApproximateAtan=function(t){return t*(-.1784*Math.abs(t)-.0663*t*t+1.0301)};it.fastApproximateAtan2=function(t,n){let i,o=Math.abs(t);i=Math.abs(n);let r=Math.max(o,i);i=Math.min(o,i);let s=i/r;return o=it.fastApproximateAtan(s),o=Math.abs(n)>Math.abs(t)?it.PI_OVER_TWO-o:o,o=t<0?it.PI-o:o,o=n<0?-o:o,o};var B=it;function Dt(t,n){this.x=A(t,0),this.y=A(n,0)}Dt.fromElements=function(t,n,i){return f(i)?(i.x=t,i.y=n,i):new Dt(t,n)};Dt.clone=function(t,n){if(!!f(t))return f(n)?(n.x=t.x,n.y=t.y,n):new Dt(t.x,t.y)};Dt.fromCartesian3=Dt.clone;Dt.fromCartesian4=Dt.clone;Dt.packedLength=2;Dt.pack=function(t,n,i){return i=A(i,0),n[i++]=t.x,n[i]=t.y,n};Dt.unpack=function(t,n,i){return n=A(n,0),f(i)||(i=new Dt),i.x=t[n++],i.y=t[n],i};Dt.packArray=function(t,n){let i=t.length,o=i*2;f(n)?!Array.isArray(n)&&n.length!==o||n.length!==o&&(n.length=o):n=new Array(o);for(let r=0;r<i;++r)Dt.pack(t[r],n,r*2);return n};Dt.unpackArray=function(t,n){let i=t.length;f(n)?n.length=i/2:n=new Array(i/2);for(let o=0;o<i;o+=2){let r=o/2;n[r]=Dt.unpack(t,o,n[r])}return n};Dt.fromArray=Dt.unpack;Dt.maximumComponent=function(t){return Math.max(t.x,t.y)};Dt.minimumComponent=function(t){return Math.min(t.x,t.y)};Dt.minimumByComponent=function(t,n,i){return i.x=Math.min(t.x,n.x),i.y=Math.min(t.y,n.y),i};Dt.maximumByComponent=function(t,n,i){return i.x=Math.max(t.x,n.x),i.y=Math.max(t.y,n.y),i};Dt.clamp=function(t,n,i,o){let r=B.clamp(t.x,n.x,i.x),s=B.clamp(t.y,n.y,i.y);return o.x=r,o.y=s,o};Dt.magnitudeSquared=function(t){return t.x*t.x+t.y*t.y};Dt.magnitude=function(t){return Math.sqrt(Dt.magnitudeSquared(t))};var gP=new Dt;Dt.distance=function(t,n){return Dt.subtract(t,n,gP),Dt.magnitude(gP)};Dt.distanceSquared=function(t,n){return Dt.subtract(t,n,gP),Dt.magnitudeSquared(gP)};Dt.normalize=function(t,n){let i=Dt.magnitude(t);return n.x=t.x/i,n.y=t.y/i,n};Dt.dot=function(t,n){return t.x*n.x+t.y*n.y};Dt.cross=function(t,n){return t.x*n.y-t.y*n.x};Dt.multiplyComponents=function(t,n,i){return i.x=t.x*n.x,i.y=t.y*n.y,i};Dt.divideComponents=function(t,n,i){return i.x=t.x/n.x,i.y=t.y/n.y,i};Dt.add=function(t,n,i){return i.x=t.x+n.x,i.y=t.y+n.y,i};Dt.subtract=function(t,n,i){return i.x=t.x-n.x,i.y=t.y-n.y,i};Dt.multiplyByScalar=function(t,n,i){return i.x=t.x*n,i.y=t.y*n,i};Dt.divideByScalar=function(t,n,i){return i.x=t.x/n,i.y=t.y/n,i};Dt.negate=function(t,n){return n.x=-t.x,n.y=-t.y,n};Dt.abs=function(t,n){return n.x=Math.abs(t.x),n.y=Math.abs(t.y),n};var TY=new Dt;Dt.lerp=function(t,n,i,o){return Dt.multiplyByScalar(n,i,TY),o=Dt.multiplyByScalar(t,1-i,o),Dt.add(TY,o,o)};var EY=new Dt,bY=new Dt;Dt.angleBetween=function(t,n){return Dt.normalize(t,EY),Dt.normalize(n,bY),B.acosClamped(Dt.dot(EY,bY))};var Lye=new Dt;Dt.mostOrthogonalAxis=function(t,n){let i=Dt.normalize(t,Lye);return Dt.abs(i,i),i.x<=i.y?n=Dt.clone(Dt.UNIT_X,n):n=Dt.clone(Dt.UNIT_Y,n),n};Dt.equals=function(t,n){return t===n||f(t)&&f(n)&&t.x===n.x&&t.y===n.y};Dt.equalsArray=function(t,n,i){return t.x===n[i]&&t.y===n[i+1]};Dt.equalsEpsilon=function(t,n,i,o){return t===n||f(t)&&f(n)&&B.equalsEpsilon(t.x,n.x,i,o)&&B.equalsEpsilon(t.y,n.y,i,o)};Dt.ZERO=Object.freeze(new Dt(0,0));Dt.ONE=Object.freeze(new Dt(1,1));Dt.UNIT_X=Object.freeze(new Dt(1,0));Dt.UNIT_Y=Object.freeze(new Dt(0,1));Dt.prototype.clone=function(t){return Dt.clone(this,t)};Dt.prototype.equals=function(t){return Dt.equals(this,t)};Dt.prototype.equalsEpsilon=function(t,n,i){return Dt.equalsEpsilon(this,t,n,i)};Dt.prototype.toString=function(){return`(${this.x}, ${this.y})`};var W=Dt;function Je(t,n,i){this.x=A(t,0),this.y=A(n,0),this.z=A(i,0)}Je.fromSpherical=function(t,n){f(n)||(n=new Je);let i=t.clock,o=t.cone,r=A(t.magnitude,1),s=r*Math.sin(o);return n.x=s*Math.cos(i),n.y=s*Math.sin(i),n.z=r*Math.cos(o),n};Je.fromElements=function(t,n,i,o){return f(o)?(o.x=t,o.y=n,o.z=i,o):new Je(t,n,i)};Je.clone=function(t,n){if(!!f(t))return f(n)?(n.x=t.x,n.y=t.y,n.z=t.z,n):new Je(t.x,t.y,t.z)};Je.fromCartesian4=Je.clone;Je.packedLength=3;Je.pack=function(t,n,i){return i=A(i,0),n[i++]=t.x,n[i++]=t.y,n[i]=t.z,n};Je.unpack=function(t,n,i){return n=A(n,0),f(i)||(i=new Je),i.x=t[n++],i.y=t[n++],i.z=t[n],i};Je.packArray=function(t,n){let i=t.length,o=i*3;f(n)?!Array.isArray(n)&&n.length!==o||n.length!==o&&(n.length=o):n=new Array(o);for(let r=0;r<i;++r)Je.pack(t[r],n,r*3);return n};Je.unpackArray=function(t,n){let i=t.length;f(n)?n.length=i/3:n=new Array(i/3);for(let o=0;o<i;o+=3){let r=o/3;n[r]=Je.unpack(t,o,n[r])}return n};Je.fromArray=Je.unpack;Je.maximumComponent=function(t){return Math.max(t.x,t.y,t.z)};Je.minimumComponent=function(t){return Math.min(t.x,t.y,t.z)};Je.minimumByComponent=function(t,n,i){return i.x=Math.min(t.x,n.x),i.y=Math.min(t.y,n.y),i.z=Math.min(t.z,n.z),i};Je.maximumByComponent=function(t,n,i){return i.x=Math.max(t.x,n.x),i.y=Math.max(t.y,n.y),i.z=Math.max(t.z,n.z),i};Je.clamp=function(t,n,i,o){let r=B.clamp(t.x,n.x,i.x),s=B.clamp(t.y,n.y,i.y),a=B.clamp(t.z,n.z,i.z);return o.x=r,o.y=s,o.z=a,o};Je.magnitudeSquared=function(t){return t.x*t.x+t.y*t.y+t.z*t.z};Je.magnitude=function(t){return Math.sqrt(Je.magnitudeSquared(t))};var AP=new Je;Je.distance=function(t,n){return Je.subtract(t,n,AP),Je.magnitude(AP)};Je.distanceSquared=function(t,n){return Je.subtract(t,n,AP),Je.magnitudeSquared(AP)};Je.normalize=function(t,n){let i=Je.magnitude(t);return n.x=t.x/i,n.y=t.y/i,n.z=t.z/i,n};Je.dot=function(t,n){return t.x*n.x+t.y*n.y+t.z*n.z};Je.multiplyComponents=function(t,n,i){return i.x=t.x*n.x,i.y=t.y*n.y,i.z=t.z*n.z,i};Je.divideComponents=function(t,n,i){return i.x=t.x/n.x,i.y=t.y/n.y,i.z=t.z/n.z,i};Je.add=function(t,n,i){return i.x=t.x+n.x,i.y=t.y+n.y,i.z=t.z+n.z,i};Je.subtract=function(t,n,i){return i.x=t.x-n.x,i.y=t.y-n.y,i.z=t.z-n.z,i};Je.multiplyByScalar=function(t,n,i){return i.x=t.x*n,i.y=t.y*n,i.z=t.z*n,i};Je.divideByScalar=function(t,n,i){return i.x=t.x/n,i.y=t.y/n,i.z=t.z/n,i};Je.negate=function(t,n){return n.x=-t.x,n.y=-t.y,n.z=-t.z,n};Je.abs=function(t,n){return n.x=Math.abs(t.x),n.y=Math.abs(t.y),n.z=Math.abs(t.z),n};var SY=new Je;Je.lerp=function(t,n,i,o){return Je.multiplyByScalar(n,i,SY),o=Je.multiplyByScalar(t,1-i,o),Je.add(SY,o,o)};var yP=new Je,Xz=new Je;Je.angleBetween=function(t,n){Je.normalize(t,yP),Je.normalize(n,Xz);let i=Je.dot(yP,Xz),o=Je.magnitude(Je.cross(yP,Xz,yP));return Math.atan2(o,i)};var Fye=new Je;Je.mostOrthogonalAxis=function(t,n){let i=Je.normalize(t,Fye);return Je.abs(i,i),i.x<=i.y?i.x<=i.z?n=Je.clone(Je.UNIT_X,n):n=Je.clone(Je.UNIT_Z,n):i.y<=i.z?n=Je.clone(Je.UNIT_Y,n):n=Je.clone(Je.UNIT_Z,n),n};Je.projectVector=function(t,n,i){let o=Je.dot(t,n)/Je.dot(n,n);return Je.multiplyByScalar(n,o,i)};Je.equals=function(t,n){return t===n||f(t)&&f(n)&&t.x===n.x&&t.y===n.y&&t.z===n.z};Je.equalsArray=function(t,n,i){return t.x===n[i]&&t.y===n[i+1]&&t.z===n[i+2]};Je.equalsEpsilon=function(t,n,i,o){return t===n||f(t)&&f(n)&&B.equalsEpsilon(t.x,n.x,i,o)&&B.equalsEpsilon(t.y,n.y,i,o)&&B.equalsEpsilon(t.z,n.z,i,o)};Je.cross=function(t,n,i){let o=t.x,r=t.y,s=t.z,a=n.x,c=n.y,l=n.z,u=r*l-s*c,d=s*a-o*l,h=o*c-r*a;return i.x=u,i.y=d,i.z=h,i};Je.midpoint=function(t,n,i){return i.x=(t.x+n.x)*.5,i.y=(t.y+n.y)*.5,i.z=(t.z+n.z)*.5,i};Je.fromDegrees=function(t,n,i,o,r){return t=B.toRadians(t),n=B.toRadians(n),Je.fromRadians(t,n,i,o,r)};var su=new Je,XA=new Je,Nye=new Je(6378137*6378137,6378137*6378137,6356752314245179e-9*6356752314245179e-9);Je.fromRadians=function(t,n,i,o,r){i=A(i,0);let s=f(o)?o.radiiSquared:Nye,a=Math.cos(n);su.x=a*Math.cos(t),su.y=a*Math.sin(t),su.z=Math.sin(n),su=Je.normalize(su,su),Je.multiplyComponents(s,su,XA);let c=Math.sqrt(Je.dot(su,XA));return XA=Je.divideByScalar(XA,c,XA),su=Je.multiplyByScalar(su,i,su),f(r)||(r=new Je),Je.add(XA,su,r)};Je.fromDegreesArray=function(t,n,i){let o=t.length;f(i)?i.length=o/2:i=new Array(o/2);for(let r=0;r<o;r+=2){let s=t[r],a=t[r+1],c=r/2;i[c]=Je.fromDegrees(s,a,0,n,i[c])}return i};Je.fromRadiansArray=function(t,n,i){let o=t.length;f(i)?i.length=o/2:i=new Array(o/2);for(let r=0;r<o;r+=2){let s=t[r],a=t[r+1],c=r/2;i[c]=Je.fromRadians(s,a,0,n,i[c])}return i};Je.fromDegreesArrayHeights=function(t,n,i){let o=t.length;f(i)?i.length=o/3:i=new Array(o/3);for(let r=0;r<o;r+=3){let s=t[r],a=t[r+1],c=t[r+2],l=r/3;i[l]=Je.fromDegrees(s,a,c,n,i[l])}return i};Je.fromRadiansArrayHeights=function(t,n,i){let o=t.length;f(i)?i.length=o/3:i=new Array(o/3);for(let r=0;r<o;r+=3){let s=t[r],a=t[r+1],c=t[r+2],l=r/3;i[l]=Je.fromRadians(s,a,c,n,i[l])}return i};Je.ZERO=Object.freeze(new Je(0,0,0));Je.ONE=Object.freeze(new Je(1,1,1));Je.UNIT_X=Object.freeze(new Je(1,0,0));Je.UNIT_Y=Object.freeze(new Je(0,1,0));Je.UNIT_Z=Object.freeze(new Je(0,0,1));Je.prototype.clone=function(t){return Je.clone(this,t)};Je.prototype.equals=function(t){return Je.equals(this,t)};Je.prototype.equalsEpsilon=function(t,n,i){return Je.equalsEpsilon(this,t,n,i)};Je.prototype.toString=function(){return`(${this.x}, ${this.y}, ${this.z})`};var m=Je;var Vye=new m,kye=new m;function Uye(t,n,i,o,r){let s=t.x,a=t.y,c=t.z,l=n.x,u=n.y,d=n.z,h=s*s*l*l,_=a*a*u*u,y=c*c*d*d,p=h+_+y,C=Math.sqrt(1/p),x=m.multiplyByScalar(t,C,Vye);if(p<o)return isFinite(C)?m.clone(x,r):void 0;let T=i.x,E=i.y,S=i.z,w=kye;w.x=x.x*T*2,w.y=x.y*E*2,w.z=x.z*S*2;let D=(1-C)*m.magnitude(t)/(.5*m.magnitude(w)),I=0,O,M,L,F,g,b,v,P,R,V,H;do{D-=I,L=1/(1+D*T),F=1/(1+D*E),g=1/(1+D*S),b=L*L,v=F*F,P=g*g,R=b*L,V=v*F,H=P*g,O=h*b+_*v+y*P-1,M=h*R*T+_*V*E+y*H*S;let U=-2*M;I=O/U}while(Math.abs(O)>B.EPSILON12);return f(r)?(r.x=s*L,r.y=a*F,r.z=c*g,r):new m(s*L,a*F,c*g)}var KA=Uye;function zr(t,n,i){this.longitude=A(t,0),this.latitude=A(n,0),this.height=A(i,0)}zr.fromRadians=function(t,n,i,o){return i=A(i,0),f(o)?(o.longitude=t,o.latitude=n,o.height=i,o):new zr(t,n,i)};zr.fromDegrees=function(t,n,i,o){return t=B.toRadians(t),n=B.toRadians(n),zr.fromRadians(t,n,i,o)};var zye=new m,Hye=new m,Gye=new m,Wye=new m(1/6378137,1/6378137,1/6356752314245179e-9),jye=new m(1/(6378137*6378137),1/(6378137*6378137),1/(6356752314245179e-9*6356752314245179e-9)),qye=B.EPSILON1;zr.fromCartesian=function(t,n,i){let o=f(n)?n.oneOverRadii:Wye,r=f(n)?n.oneOverRadiiSquared:jye,s=f(n)?n._centerToleranceSquared:qye,a=KA(t,o,r,s,Hye);if(!f(a))return;let c=m.multiplyComponents(a,r,zye);c=m.normalize(c,c);let l=m.subtract(t,a,Gye),u=Math.atan2(c.y,c.x),d=Math.asin(c.z),h=B.sign(m.dot(l,t))*m.magnitude(l);return f(i)?(i.longitude=u,i.latitude=d,i.height=h,i):new zr(u,d,h)};zr.toCartesian=function(t,n,i){return m.fromRadians(t.longitude,t.latitude,t.height,n,i)};zr.clone=function(t,n){if(!!f(t))return f(n)?(n.longitude=t.longitude,n.latitude=t.latitude,n.height=t.height,n):new zr(t.longitude,t.latitude,t.height)};zr.equals=function(t,n){return t===n||f(t)&&f(n)&&t.longitude===n.longitude&&t.latitude===n.latitude&&t.height===n.height};zr.equalsEpsilon=function(t,n,i){return i=A(i,0),t===n||f(t)&&f(n)&&Math.abs(t.longitude-n.longitude)<=i&&Math.abs(t.latitude-n.latitude)<=i&&Math.abs(t.height-n.height)<=i};zr.ZERO=Object.freeze(new zr(0,0,0));zr.prototype.clone=function(t){return zr.clone(this,t)};zr.prototype.equals=function(t){return zr.equals(this,t)};zr.prototype.equalsEpsilon=function(t,n){return zr.equalsEpsilon(this,t,n)};zr.prototype.toString=function(){return`(${this.longitude}, ${this.latitude}, ${this.height})`};var de=zr;function DY(t,n,i,o){n=A(n,0),i=A(i,0),o=A(o,0),t._radii=new m(n,i,o),t._radiiSquared=new m(n*n,i*i,o*o),t._radiiToTheFourth=new m(n*n*n*n,i*i*i*i,o*o*o*o),t._oneOverRadii=new m(n===0?0:1/n,i===0?0:1/i,o===0?0:1/o),t._oneOverRadiiSquared=new m(n===0?0:1/(n*n),i===0?0:1/(i*i),o===0?0:1/(o*o)),t._minimumRadius=Math.min(n,i,o),t._maximumRadius=Math.max(n,i,o),t._centerToleranceSquared=B.EPSILON1,t._radiiSquared.z!==0&&(t._squaredXOverSquaredZ=t._radiiSquared.x/t._radiiSquared.z)}function zi(t,n,i){this._radii=void 0,this._radiiSquared=void 0,this._radiiToTheFourth=void 0,this._oneOverRadii=void 0,this._oneOverRadiiSquared=void 0,this._minimumRadius=void 0,this._maximumRadius=void 0,this._centerToleranceSquared=void 0,this._squaredXOverSquaredZ=void 0,DY(this,t,n,i)}Object.defineProperties(zi.prototype,{radii:{get:function(){return this._radii}},radiiSquared:{get:function(){return this._radiiSquared}},radiiToTheFourth:{get:function(){return this._radiiToTheFourth}},oneOverRadii:{get:function(){return this._oneOverRadii}},oneOverRadiiSquared:{get:function(){return this._oneOverRadiiSquared}},minimumRadius:{get:function(){return this._minimumRadius}},maximumRadius:{get:function(){return this._maximumRadius}}});zi.clone=function(t,n){if(!f(t))return;let i=t._radii;return f(n)?(m.clone(i,n._radii),m.clone(t._radiiSquared,n._radiiSquared),m.clone(t._radiiToTheFourth,n._radiiToTheFourth),m.clone(t._oneOverRadii,n._oneOverRadii),m.clone(t._oneOverRadiiSquared,n._oneOverRadiiSquared),n._minimumRadius=t._minimumRadius,n._maximumRadius=t._maximumRadius,n._centerToleranceSquared=t._centerToleranceSquared,n):new zi(i.x,i.y,i.z)};zi.fromCartesian3=function(t,n){return f(n)||(n=new zi),f(t)&&DY(n,t.x,t.y,t.z),n};zi.WGS84=Object.freeze(new zi(6378137,6378137,6356752314245179e-9));zi.UNIT_SPHERE=Object.freeze(new zi(1,1,1));zi.MOON=Object.freeze(new zi(B.LUNAR_RADIUS,B.LUNAR_RADIUS,B.LUNAR_RADIUS));zi.prototype.clone=function(t){return zi.clone(this,t)};zi.packedLength=m.packedLength;zi.pack=function(t,n,i){return i=A(i,0),m.pack(t._radii,n,i),n};zi.unpack=function(t,n,i){n=A(n,0);let o=m.unpack(t,n);return zi.fromCartesian3(o,i)};zi.prototype.geocentricSurfaceNormal=m.normalize;zi.prototype.geodeticSurfaceNormalCartographic=function(t,n){let i=t.longitude,o=t.latitude,r=Math.cos(o),s=r*Math.cos(i),a=r*Math.sin(i),c=Math.sin(o);return f(n)||(n=new m),n.x=s,n.y=a,n.z=c,m.normalize(n,n)};zi.prototype.geodeticSurfaceNormal=function(t,n){if(!m.equalsEpsilon(t,m.ZERO,B.EPSILON14))return f(n)||(n=new m),n=m.multiplyComponents(t,this._oneOverRadiiSquared,n),m.normalize(n,n)};var Yye=new m,Xye=new m;zi.prototype.cartographicToCartesian=function(t,n){let i=Yye,o=Xye;this.geodeticSurfaceNormalCartographic(t,i),m.multiplyComponents(this._radiiSquared,i,o);let r=Math.sqrt(m.dot(i,o));return m.divideByScalar(o,r,o),m.multiplyByScalar(i,t.height,i),f(n)||(n=new m),m.add(o,i,n)};zi.prototype.cartographicArrayToCartesianArray=function(t,n){let i=t.length;f(n)?n.length=i:n=new Array(i);for(let o=0;o<i;o++)n[o]=this.cartographicToCartesian(t[o],n[o]);return n};var Kye=new m,Jye=new m,Zye=new m;zi.prototype.cartesianToCartographic=function(t,n){let i=this.scaleToGeodeticSurface(t,Jye);if(!f(i))return;let o=this.geodeticSurfaceNormal(i,Kye),r=m.subtract(t,i,Zye),s=Math.atan2(o.y,o.x),a=Math.asin(o.z),c=B.sign(m.dot(r,t))*m.magnitude(r);return f(n)?(n.longitude=s,n.latitude=a,n.height=c,n):new de(s,a,c)};zi.prototype.cartesianArrayToCartographicArray=function(t,n){let i=t.length;f(n)?n.length=i:n=new Array(i);for(let o=0;o<i;++o)n[o]=this.cartesianToCartographic(t[o],n[o]);return n};zi.prototype.scaleToGeodeticSurface=function(t,n){return KA(t,this._oneOverRadii,this._oneOverRadiiSquared,this._centerToleranceSquared,n)};zi.prototype.scaleToGeocentricSurface=function(t,n){f(n)||(n=new m);let i=t.x,o=t.y,r=t.z,s=this._oneOverRadiiSquared,a=1/Math.sqrt(i*i*s.x+o*o*s.y+r*r*s.z);return m.multiplyByScalar(t,a,n)};zi.prototype.transformPositionToScaledSpace=function(t,n){return f(n)||(n=new m),m.multiplyComponents(t,this._oneOverRadii,n)};zi.prototype.transformPositionFromScaledSpace=function(t,n){return f(n)||(n=new m),m.multiplyComponents(t,this._radii,n)};zi.prototype.equals=function(t){return this===t||f(t)&&m.equals(this._radii,t._radii)};zi.prototype.toString=function(){return this._radii.toString()};zi.prototype.getSurfaceNormalIntersectionWithZAxis=function(t,n,i){n=A(n,0);let o=this._squaredXOverSquaredZ;if(f(i)||(i=new m),i.x=0,i.y=0,i.z=t.z*(1-o),!(Math.abs(i.z)>=this._radii.z-n))return i};var Qye=[.14887433898163,.43339539412925,.67940956829902,.86506336668898,.97390652851717,0],$ye=[.29552422471475,.26926671930999,.21908636251598,.14945134915058,.066671344308684,0];function wY(t,n,i){let o=.5*(n+t),r=.5*(n-t),s=0;for(let a=0;a<5;a++){let c=r*Qye[a];s+=$ye[a]*(i(o+c)+i(o-c))}return s*=r,s}zi.prototype.surfaceArea=function(t){let n=t.west,i=t.east,o=t.south,r=t.north;for(;i<n;)i+=B.TWO_PI;let s=this._radiiSquared,a=s.x,c=s.y,l=s.z,u=a*c;return wY(o,r,function(d){let h=Math.cos(d),_=Math.sin(d);return Math.cos(d)*wY(n,i,function(y){let p=Math.cos(y),C=Math.sin(y);return Math.sqrt(u*_*_+l*(c*p*p+a*C*C)*h*h)})})};var oe=zi;function CP(t){this._ellipsoid=A(t,oe.WGS84),this._semimajorAxis=this._ellipsoid.maximumRadius,this._oneOverSemimajorAxis=1/this._semimajorAxis}Object.defineProperties(CP.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}});CP.prototype.project=function(t,n){let i=this._semimajorAxis,o=t.longitude*i,r=t.latitude*i,s=t.height;return f(n)?(n.x=o,n.y=r,n.z=s,n):new m(o,r,s)};CP.prototype.unproject=function(t,n){let i=this._oneOverSemimajorAxis,o=t.x*i,r=t.y*i,s=t.z;return f(n)?(n.longitude=o,n.latitude=r,n.height=s,n):new de(o,r,s)};var Ci=CP;var eAe={OUTSIDE:-1,INTERSECTING:0,INSIDE:1},jt=Object.freeze(eAe);function Ln(t,n,i,o){this.west=A(t,0),this.south=A(n,0),this.east=A(i,0),this.north=A(o,0)}Object.defineProperties(Ln.prototype,{width:{get:function(){return Ln.computeWidth(this)}},height:{get:function(){return Ln.computeHeight(this)}}});Ln.packedLength=4;Ln.pack=function(t,n,i){return i=A(i,0),n[i++]=t.west,n[i++]=t.south,n[i++]=t.east,n[i]=t.north,n};Ln.unpack=function(t,n,i){return n=A(n,0),f(i)||(i=new Ln),i.west=t[n++],i.south=t[n++],i.east=t[n++],i.north=t[n],i};Ln.computeWidth=function(t){let n=t.east,i=t.west;return n<i&&(n+=B.TWO_PI),n-i};Ln.computeHeight=function(t){return t.north-t.south};Ln.fromDegrees=function(t,n,i,o,r){return t=B.toRadians(A(t,0)),n=B.toRadians(A(n,0)),i=B.toRadians(A(i,0)),o=B.toRadians(A(o,0)),f(r)?(r.west=t,r.south=n,r.east=i,r.north=o,r):new Ln(t,n,i,o)};Ln.fromRadians=function(t,n,i,o,r){return f(r)?(r.west=A(t,0),r.south=A(n,0),r.east=A(i,0),r.north=A(o,0),r):new Ln(t,n,i,o)};Ln.fromCartographicArray=function(t,n){let i=Number.MAX_VALUE,o=-Number.MAX_VALUE,r=Number.MAX_VALUE,s=-Number.MAX_VALUE,a=Number.MAX_VALUE,c=-Number.MAX_VALUE;for(let l=0,u=t.length;l<u;l++){let d=t[l];i=Math.min(i,d.longitude),o=Math.max(o,d.longitude),a=Math.min(a,d.latitude),c=Math.max(c,d.latitude);let h=d.longitude>=0?d.longitude:d.longitude+B.TWO_PI;r=Math.min(r,h),s=Math.max(s,h)}return o-i>s-r&&(i=r,o=s,o>B.PI&&(o=o-B.TWO_PI),i>B.PI&&(i=i-B.TWO_PI)),f(n)?(n.west=i,n.south=a,n.east=o,n.north=c,n):new Ln(i,a,o,c)};Ln.fromCartesianArray=function(t,n,i){n=A(n,oe.WGS84);let o=Number.MAX_VALUE,r=-Number.MAX_VALUE,s=Number.MAX_VALUE,a=-Number.MAX_VALUE,c=Number.MAX_VALUE,l=-Number.MAX_VALUE;for(let u=0,d=t.length;u<d;u++){let h=n.cartesianToCartographic(t[u]);o=Math.min(o,h.longitude),r=Math.max(r,h.longitude),c=Math.min(c,h.latitude),l=Math.max(l,h.latitude);let _=h.longitude>=0?h.longitude:h.longitude+B.TWO_PI;s=Math.min(s,_),a=Math.max(a,_)}return r-o>a-s&&(o=s,r=a,r>B.PI&&(r=r-B.TWO_PI),o>B.PI&&(o=o-B.TWO_PI)),f(i)?(i.west=o,i.south=c,i.east=r,i.north=l,i):new Ln(o,c,r,l)};Ln.clone=function(t,n){if(!!f(t))return f(n)?(n.west=t.west,n.south=t.south,n.east=t.east,n.north=t.north,n):new Ln(t.west,t.south,t.east,t.north)};Ln.equalsEpsilon=function(t,n,i){return i=A(i,0),t===n||f(t)&&f(n)&&Math.abs(t.west-n.west)<=i&&Math.abs(t.south-n.south)<=i&&Math.abs(t.east-n.east)<=i&&Math.abs(t.north-n.north)<=i};Ln.prototype.clone=function(t){return Ln.clone(this,t)};Ln.prototype.equals=function(t){return Ln.equals(this,t)};Ln.equals=function(t,n){return t===n||f(t)&&f(n)&&t.west===n.west&&t.south===n.south&&t.east===n.east&&t.north===n.north};Ln.prototype.equalsEpsilon=function(t,n){return Ln.equalsEpsilon(this,t,n)};Ln.validate=function(t){};Ln.southwest=function(t,n){return f(n)?(n.longitude=t.west,n.latitude=t.south,n.height=0,n):new de(t.west,t.south)};Ln.northwest=function(t,n){return f(n)?(n.longitude=t.west,n.latitude=t.north,n.height=0,n):new de(t.west,t.north)};Ln.northeast=function(t,n){return f(n)?(n.longitude=t.east,n.latitude=t.north,n.height=0,n):new de(t.east,t.north)};Ln.southeast=function(t,n){return f(n)?(n.longitude=t.east,n.latitude=t.south,n.height=0,n):new de(t.east,t.south)};Ln.center=function(t,n){let i=t.east,o=t.west;i<o&&(i+=B.TWO_PI);let r=B.negativePiToPi((o+i)*.5),s=(t.south+t.north)*.5;return f(n)?(n.longitude=r,n.latitude=s,n.height=0,n):new de(r,s)};Ln.intersection=function(t,n,i){let o=t.east,r=t.west,s=n.east,a=n.west;o<r&&s>0?o+=B.TWO_PI:s<a&&o>0&&(s+=B.TWO_PI),o<r&&a<0?a+=B.TWO_PI:s<a&&r<0&&(r+=B.TWO_PI);let c=B.negativePiToPi(Math.max(r,a)),l=B.negativePiToPi(Math.min(o,s));if((t.west<t.east||n.west<n.east)&&l<=c)return;let u=Math.max(t.south,n.south),d=Math.min(t.north,n.north);if(!(u>=d))return f(i)?(i.west=c,i.south=u,i.east=l,i.north=d,i):new Ln(c,u,l,d)};Ln.simpleIntersection=function(t,n,i){let o=Math.max(t.west,n.west),r=Math.max(t.south,n.south),s=Math.min(t.east,n.east),a=Math.min(t.north,n.north);if(!(r>=a||o>=s))return f(i)?(i.west=o,i.south=r,i.east=s,i.north=a,i):new Ln(o,r,s,a)};Ln.union=function(t,n,i){f(i)||(i=new Ln);let o=t.east,r=t.west,s=n.east,a=n.west;o<r&&s>0?o+=B.TWO_PI:s<a&&o>0&&(s+=B.TWO_PI),o<r&&a<0?a+=B.TWO_PI:s<a&&r<0&&(r+=B.TWO_PI);let c=B.negativePiToPi(Math.min(r,a)),l=B.negativePiToPi(Math.max(o,s));return i.west=c,i.south=Math.min(t.south,n.south),i.east=l,i.north=Math.max(t.north,n.north),i};Ln.expand=function(t,n,i){return f(i)||(i=new Ln),i.west=Math.min(t.west,n.longitude),i.south=Math.min(t.south,n.latitude),i.east=Math.max(t.east,n.longitude),i.north=Math.max(t.north,n.latitude),i};Ln.contains=function(t,n){let i=n.longitude,o=n.latitude,r=t.west,s=t.east;return s<r&&(s+=B.TWO_PI,i<0&&(i+=B.TWO_PI)),(i>r||B.equalsEpsilon(i,r,B.EPSILON14))&&(i<s||B.equalsEpsilon(i,s,B.EPSILON14))&&o>=t.south&&o<=t.north};var tAe=new de;Ln.subsample=function(t,n,i,o){n=A(n,oe.WGS84),i=A(i,0),f(o)||(o=[]);let r=0,s=t.north,a=t.south,c=t.east,l=t.west,u=tAe;u.height=i,u.longitude=l,u.latitude=s,o[r]=n.cartographicToCartesian(u,o[r]),r++,u.longitude=c,o[r]=n.cartographicToCartesian(u,o[r]),r++,u.latitude=a,o[r]=n.cartographicToCartesian(u,o[r]),r++,u.longitude=l,o[r]=n.cartographicToCartesian(u,o[r]),r++,s<0?u.latitude=s:a>0?u.latitude=a:u.latitude=0;for(let d=1;d<8;++d)u.longitude=-Math.PI+d*B.PI_OVER_TWO,Ln.contains(t,u)&&(o[r]=n.cartographicToCartesian(u,o[r]),r++);return u.latitude===0&&(u.longitude=l,o[r]=n.cartographicToCartesian(u,o[r]),r++,u.longitude=c,o[r]=n.cartographicToCartesian(u,o[r]),r++),o.length=r,o};Ln.subsection=function(t,n,i,o,r,s){if(f(s)||(s=new Ln),t.west<=t.east){let c=t.east-t.west;s.west=t.west+n*c,s.east=t.west+o*c}else{let c=B.TWO_PI+t.east-t.west;s.west=B.negativePiToPi(t.west+n*c),s.east=B.negativePiToPi(t.west+o*c)}let a=t.north-t.south;return s.south=t.south+i*a,s.north=t.south+r*a,n===1&&(s.west=t.east),o===1&&(s.east=t.east),i===1&&(s.south=t.north),r===1&&(s.north=t.north),s};Ln.MAX_VALUE=Object.freeze(new Ln(-Math.PI,-B.PI_OVER_TWO,Math.PI,B.PI_OVER_TWO));var le=Ln;function pr(t,n,i,o){this.x=A(t,0),this.y=A(n,0),this.width=A(i,0),this.height=A(o,0)}pr.packedLength=4;pr.pack=function(t,n,i){return i=A(i,0),n[i++]=t.x,n[i++]=t.y,n[i++]=t.width,n[i]=t.height,n};pr.unpack=function(t,n,i){return n=A(n,0),f(i)||(i=new pr),i.x=t[n++],i.y=t[n++],i.width=t[n++],i.height=t[n],i};pr.fromPoints=function(t,n){if(f(n)||(n=new pr),!f(t)||t.length===0)return n.x=0,n.y=0,n.width=0,n.height=0,n;let i=t.length,o=t[0].x,r=t[0].y,s=t[0].x,a=t[0].y;for(let c=1;c<i;c++){let l=t[c],u=l.x,d=l.y;o=Math.min(u,o),s=Math.max(u,s),r=Math.min(d,r),a=Math.max(d,a)}return n.x=o,n.y=r,n.width=s-o,n.height=a-r,n};var nAe=new Ci,iAe=new de,oAe=new de;pr.fromRectangle=function(t,n,i){if(f(i)||(i=new pr),!f(t))return i.x=0,i.y=0,i.width=0,i.height=0,i;n=A(n,nAe);let o=n.project(le.southwest(t,iAe)),r=n.project(le.northeast(t,oAe));return W.subtract(r,o,r),i.x=o.x,i.y=o.y,i.width=r.x,i.height=r.y,i};pr.clone=function(t,n){if(!!f(t))return f(n)?(n.x=t.x,n.y=t.y,n.width=t.width,n.height=t.height,n):new pr(t.x,t.y,t.width,t.height)};pr.union=function(t,n,i){f(i)||(i=new pr);let o=Math.min(t.x,n.x),r=Math.min(t.y,n.y),s=Math.max(t.x+t.width,n.x+n.width),a=Math.max(t.y+t.height,n.y+n.height);return i.x=o,i.y=r,i.width=s-o,i.height=a-r,i};pr.expand=function(t,n,i){i=pr.clone(t,i);let o=n.x-i.x,r=n.y-i.y;return o>i.width?i.width=o:o<0&&(i.width-=o,i.x=n.x),r>i.height?i.height=r:r<0&&(i.height-=r,i.y=n.y),i};pr.intersect=function(t,n){let i=t.x,o=t.y,r=n.x,s=n.y;return i>r+n.width||i+t.width<r||o+t.height<s||o>s+n.height?jt.OUTSIDE:jt.INTERSECTING};pr.equals=function(t,n){return t===n||f(t)&&f(n)&&t.x===n.x&&t.y===n.y&&t.width===n.width&&t.height===n.height};pr.prototype.clone=function(t){return pr.clone(this,t)};pr.prototype.intersect=function(t){return pr.intersect(this,t)};pr.prototype.equals=function(t){return pr.equals(this,t)};var He=pr;var Ip,_r={requestFullscreen:void 0,exitFullscreen:void 0,fullscreenEnabled:void 0,fullscreenElement:void 0,fullscreenchange:void 0,fullscreenerror:void 0},Lc={};Object.defineProperties(Lc,{element:{get:function(){if(!!Lc.supportsFullscreen())return document[_r.fullscreenElement]}},changeEventName:{get:function(){if(!!Lc.supportsFullscreen())return _r.fullscreenchange}},errorEventName:{get:function(){if(!!Lc.supportsFullscreen())return _r.fullscreenerror}},enabled:{get:function(){if(!!Lc.supportsFullscreen())return document[_r.fullscreenEnabled]}},fullscreen:{get:function(){if(!!Lc.supportsFullscreen())return Lc.element!==null}}});Lc.supportsFullscreen=function(){if(f(Ip))return Ip;Ip=!1;let t=document.body;if(typeof t.requestFullscreen=="function")return _r.requestFullscreen="requestFullscreen",_r.exitFullscreen="exitFullscreen",_r.fullscreenEnabled="fullscreenEnabled",_r.fullscreenElement="fullscreenElement",_r.fullscreenchange="fullscreenchange",_r.fullscreenerror="fullscreenerror",Ip=!0,Ip;let n=["webkit","moz","o","ms","khtml"],i;for(let o=0,r=n.length;o<r;++o){let s=n[o];i=`${s}RequestFullscreen`,typeof t[i]=="function"?(_r.requestFullscreen=i,Ip=!0):(i=`${s}RequestFullScreen`,typeof t[i]=="function"&&(_r.requestFullscreen=i,Ip=!0)),i=`${s}ExitFullscreen`,typeof document[i]=="function"?_r.exitFullscreen=i:(i=`${s}CancelFullScreen`,typeof document[i]=="function"&&(_r.exitFullscreen=i)),i=`${s}FullscreenEnabled`,document[i]!==void 0?_r.fullscreenEnabled=i:(i=`${s}FullScreenEnabled`,document[i]!==void 0&&(_r.fullscreenEnabled=i)),i=`${s}FullscreenElement`,document[i]!==void 0?_r.fullscreenElement=i:(i=`${s}FullScreenElement`,document[i]!==void 0&&(_r.fullscreenElement=i)),i=`${s}fullscreenchange`,document[`on${i}`]!==void 0&&(s==="ms"&&(i="MSFullscreenChange"),_r.fullscreenchange=i),i=`${s}fullscreenerror`,document[`on${i}`]!==void 0&&(s==="ms"&&(i="MSFullscreenError"),_r.fullscreenerror=i)}return Ip};Lc.requestFullscreen=function(t,n){!Lc.supportsFullscreen()||t[_r.requestFullscreen]({vrDisplay:n})};Lc.exitFullscreen=function(){!Lc.supportsFullscreen()||document[_r.exitFullscreen]()};Lc._names=_r;var gr=Lc;var pa;typeof navigator!="undefined"?pa=navigator:pa={};function h0(t){let n=t.split(".");for(let i=0,o=n.length;i<o;++i)n[i]=parseInt(n[i],10);return n}var xP,vY;function eH(){if(!f(xP)&&(xP=!1,!DP())){let t=/ Chrome\/([\.0-9]+)/.exec(pa.userAgent);t!==null&&(xP=!0,vY=h0(t[1]))}return xP}function rAe(){return eH()&&vY}var TP,PY;function IY(){if(!f(TP)&&(TP=!1,!eH()&&!DP()&&/ Safari\/[\.0-9]+/.test(pa.userAgent))){let t=/ Version\/([\.0-9]+)/.exec(pa.userAgent);t!==null&&(TP=!0,PY=h0(t[1]))}return TP}function sAe(){return IY()&&PY}var EP,Qz;function BY(){if(!f(EP)){EP=!1;let t=/ AppleWebKit\/([\.0-9]+)(\+?)/.exec(pa.userAgent);t!==null&&(EP=!0,Qz=h0(t[1]),Qz.isNightly=!!t[2])}return EP}function aAe(){return BY()&&Qz}var yb,$z;function OY(){if(!f(yb)){yb=!1;let t;pa.appName==="Microsoft Internet Explorer"?(t=/MSIE ([0-9]{1,}[\.0-9]{0,})/.exec(pa.userAgent),t!==null&&(yb=!0,$z=h0(t[1]))):pa.appName==="Netscape"&&(t=/Trident\/.*rv:([0-9]{1,}[\.0-9]{0,})/.exec(pa.userAgent),t!==null&&(yb=!0,$z=h0(t[1])))}return yb}function cAe(){return OY()&&$z}var bP,RY;function DP(){if(!f(bP)){bP=!1;let t=/ Edg\/([\.0-9]+)/.exec(pa.userAgent);t!==null&&(bP=!0,RY=h0(t[1]))}return bP}function lAe(){return DP()&&RY}var SP,MY;function tH(){if(!f(SP)){SP=!1;let t=/Firefox\/([\.0-9]+)/.exec(pa.userAgent);t!==null&&(SP=!0,MY=h0(t[1]))}return SP}var Kz;function uAe(){return f(Kz)||(Kz=/Windows/i.test(pa.appVersion)),Kz}var Jz;function fAe(){return f(Jz)||(Jz=navigator.platform==="iPhone"||navigator.platform==="iPod"||navigator.platform==="iPad"),Jz}function dAe(){return tH()&&MY}var Zz;function hAe(){return f(Zz)||(Zz=!tH()&&typeof PointerEvent!="undefined"&&(!f(pa.pointerEnabled)||pa.pointerEnabled)),Zz}var LY,wP;function FY(){if(!f(wP)){let t=document.createElement("canvas");t.setAttribute("style","image-rendering: -moz-crisp-edges;image-rendering: pixelated;");let n=t.style.imageRendering;wP=f(n)&&n!=="",wP&&(LY=n)}return wP}function mAe(){return FY()?LY:void 0}function $a(){return $a._result}$a._promise=void 0;$a._result=void 0;$a.initialize=function(){return f($a._promise)||($a._promise=new Promise(t=>{let n=new Image;n.onload=function(){$a._result=n.width>0&&n.height>0,t($a._result)},n.onerror=function(){$a._result=!1,t($a._result)},n.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA"})),$a._promise};Object.defineProperties($a,{initialized:{get:function(){return f($a._result)}}});var JA=[];typeof ArrayBuffer!="undefined"&&(JA.push(Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array),typeof Uint8ClampedArray!="undefined"&&JA.push(Uint8ClampedArray),typeof Uint8ClampedArray!="undefined"&&JA.push(Uint8ClampedArray),typeof BigInt64Array!="undefined"&&JA.push(BigInt64Array),typeof BigUint64Array!="undefined"&&JA.push(BigUint64Array));var Pd={isChrome:eH,chromeVersion:rAe,isSafari:IY,safariVersion:sAe,isWebkit:BY,webkitVersion:aAe,isInternetExplorer:OY,internetExplorerVersion:cAe,isEdge:DP,edgeVersion:lAe,isFirefox:tH,firefoxVersion:dAe,isWindows:uAe,isIPadOrIOS:fAe,hardwareConcurrency:A(pa.hardwareConcurrency,3),supportsPointerEvents:hAe,supportsImageRenderingPixelated:FY,supportsWebP:$a,imageRenderingValue:mAe,typedArrayTypes:JA};Pd.supportsBasis=function(t){return Pd.supportsWebAssembly()&&t.context.supportsBasis};Pd.supportsFullscreen=function(){return gr.supportsFullscreen()};Pd.supportsTypedArrays=function(){return typeof ArrayBuffer!="undefined"};Pd.supportsBigInt64Array=function(){return typeof BigInt64Array!="undefined"};Pd.supportsBigUint64Array=function(){return typeof BigUint64Array!="undefined"};Pd.supportsBigInt=function(){return typeof BigInt!="undefined"};Pd.supportsWebWorkers=function(){return typeof Worker!="undefined"};Pd.supportsWebAssembly=function(){return typeof WebAssembly!="undefined"};var Vt=Pd;function nH(t,n,i){return i<0&&(i+=1),i>1&&(i-=1),i*6<1?t+(n-t)*6*i:i*2<1?n:i*3<2?t+(n-t)*(2/3-i)*6:t}function ie(t,n,i,o){this.red=A(t,1),this.green=A(n,1),this.blue=A(i,1),this.alpha=A(o,1)}ie.fromCartesian4=function(t,n){return f(n)?(n.red=t.x,n.green=t.y,n.blue=t.z,n.alpha=t.w,n):new ie(t.x,t.y,t.z,t.w)};ie.fromBytes=function(t,n,i,o,r){return t=ie.byteToFloat(A(t,255)),n=ie.byteToFloat(A(n,255)),i=ie.byteToFloat(A(i,255)),o=ie.byteToFloat(A(o,255)),f(r)?(r.red=t,r.green=n,r.blue=i,r.alpha=o,r):new ie(t,n,i,o)};ie.fromAlpha=function(t,n,i){return f(i)?(i.red=t.red,i.green=t.green,i.blue=t.blue,i.alpha=n,i):new ie(t.red,t.green,t.blue,n)};var iH,oH,nm;Vt.supportsTypedArrays()&&(iH=new ArrayBuffer(4),oH=new Uint32Array(iH),nm=new Uint8Array(iH));ie.fromRgba=function(t,n){return oH[0]=t,ie.fromBytes(nm[0],nm[1],nm[2],nm[3],n)};ie.fromHsl=function(t,n,i,o,r){t=A(t,0)%1,n=A(n,0),i=A(i,0),o=A(o,1);let s=i,a=i,c=i;if(n!==0){let l;i<.5?l=i*(1+n):l=i+n-i*n;let u=2*i-l;s=nH(u,l,t+1/3),a=nH(u,l,t),c=nH(u,l,t-1/3)}return f(r)?(r.red=s,r.green=a,r.blue=c,r.alpha=o,r):new ie(s,a,c,o)};ie.fromRandom=function(t,n){t=A(t,A.EMPTY_OBJECT);let i=t.red;if(!f(i)){let a=A(t.minimumRed,0),c=A(t.maximumRed,1);i=a+B.nextRandomNumber()*(c-a)}let o=t.green;if(!f(o)){let a=A(t.minimumGreen,0),c=A(t.maximumGreen,1);o=a+B.nextRandomNumber()*(c-a)}let r=t.blue;if(!f(r)){let a=A(t.minimumBlue,0),c=A(t.maximumBlue,1);r=a+B.nextRandomNumber()*(c-a)}let s=t.alpha;if(!f(s)){let a=A(t.minimumAlpha,0),c=A(t.maximumAlpha,1);s=a+B.nextRandomNumber()*(c-a)}return f(n)?(n.red=i,n.green=o,n.blue=r,n.alpha=s,n):new ie(i,o,r,s)};var pAe=/^#([0-9a-f])([0-9a-f])([0-9a-f])([0-9a-f])?$/i,_Ae=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})?$/i,gAe=/^rgba?\(\s*([0-9.]+%?)\s*,\s*([0-9.]+%?)\s*,\s*([0-9.]+%?)(?:\s*,\s*([0-9.]+))?\s*\)$/i,yAe=/^hsla?\(\s*([0-9.]+)\s*,\s*([0-9.]+%)\s*,\s*([0-9.]+%)(?:\s*,\s*([0-9.]+))?\s*\)$/i;ie.fromCssColorString=function(t,n){f(n)||(n=new ie),t=t.replace(/\s/g,"");let i=ie[t.toUpperCase()];if(f(i))return ie.clone(i,n),n;let o=pAe.exec(t);return o!==null?(n.red=parseInt(o[1],16)/15,n.green=parseInt(o[2],16)/15,n.blue=parseInt(o[3],16)/15,n.alpha=parseInt(A(o[4],"f"),16)/15,n):(o=_Ae.exec(t),o!==null?(n.red=parseInt(o[1],16)/255,n.green=parseInt(o[2],16)/255,n.blue=parseInt(o[3],16)/255,n.alpha=parseInt(A(o[4],"ff"),16)/255,n):(o=gAe.exec(t),o!==null?(n.red=parseFloat(o[1])/(o[1].substr(-1)==="%"?100:255),n.green=parseFloat(o[2])/(o[2].substr(-1)==="%"?100:255),n.blue=parseFloat(o[3])/(o[3].substr(-1)==="%"?100:255),n.alpha=parseFloat(A(o[4],"1.0")),n):(o=yAe.exec(t),o!==null?ie.fromHsl(parseFloat(o[1])/360,parseFloat(o[2])/100,parseFloat(o[3])/100,parseFloat(A(o[4],"1.0")),n):(n=void 0,n))))};ie.packedLength=4;ie.pack=function(t,n,i){return i=A(i,0),n[i++]=t.red,n[i++]=t.green,n[i++]=t.blue,n[i]=t.alpha,n};ie.unpack=function(t,n,i){return n=A(n,0),f(i)||(i=new ie),i.red=t[n++],i.green=t[n++],i.blue=t[n++],i.alpha=t[n],i};ie.byteToFloat=function(t){return t/255};ie.floatToByte=function(t){return t===1?255:t*256|0};ie.clone=function(t,n){if(!!f(t))return f(n)?(n.red=t.red,n.green=t.green,n.blue=t.blue,n.alpha=t.alpha,n):new ie(t.red,t.green,t.blue,t.alpha)};ie.equals=function(t,n){return t===n||f(t)&&f(n)&&t.red===n.red&&t.green===n.green&&t.blue===n.blue&&t.alpha===n.alpha};ie.equalsArray=function(t,n,i){return t.red===n[i]&&t.green===n[i+1]&&t.blue===n[i+2]&&t.alpha===n[i+3]};ie.prototype.clone=function(t){return ie.clone(this,t)};ie.prototype.equals=function(t){return ie.equals(this,t)};ie.prototype.equalsEpsilon=function(t,n){return this===t||f(t)&&Math.abs(this.red-t.red)<=n&&Math.abs(this.green-t.green)<=n&&Math.abs(this.blue-t.blue)<=n&&Math.abs(this.alpha-t.alpha)<=n};ie.prototype.toString=function(){return`(${this.red}, ${this.green}, ${this.blue}, ${this.alpha})`};ie.prototype.toCssColorString=function(){let t=ie.floatToByte(this.red),n=ie.floatToByte(this.green),i=ie.floatToByte(this.blue);return this.alpha===1?`rgb(${t},${n},${i})`:`rgba(${t},${n},${i},${this.alpha})`};ie.prototype.toCssHexString=function(){let t=ie.floatToByte(this.red).toString(16);t.length<2&&(t=`0${t}`);let n=ie.floatToByte(this.green).toString(16);n.length<2&&(n=`0${n}`);let i=ie.floatToByte(this.blue).toString(16);if(i.length<2&&(i=`0${i}`),this.alpha<1){let o=ie.floatToByte(this.alpha).toString(16);return o.length<2&&(o=`0${o}`),`#${t}${n}${i}${o}`}return`#${t}${n}${i}`};ie.prototype.toBytes=function(t){let n=ie.floatToByte(this.red),i=ie.floatToByte(this.green),o=ie.floatToByte(this.blue),r=ie.floatToByte(this.alpha);return f(t)?(t[0]=n,t[1]=i,t[2]=o,t[3]=r,t):[n,i,o,r]};ie.prototype.toRgba=function(){return nm[0]=ie.floatToByte(this.red),nm[1]=ie.floatToByte(this.green),nm[2]=ie.floatToByte(this.blue),nm[3]=ie.floatToByte(this.alpha),oH[0]};ie.prototype.brighten=function(t,n){return t=1-t,n.red=1-(1-this.red)*t,n.green=1-(1-this.green)*t,n.blue=1-(1-this.blue)*t,n.alpha=this.alpha,n};ie.prototype.darken=function(t,n){return t=1-t,n.red=this.red*t,n.green=this.green*t,n.blue=this.blue*t,n.alpha=this.alpha,n};ie.prototype.withAlpha=function(t,n){return ie.fromAlpha(this,t,n)};ie.add=function(t,n,i){return i.red=t.red+n.red,i.green=t.green+n.green,i.blue=t.blue+n.blue,i.alpha=t.alpha+n.alpha,i};ie.subtract=function(t,n,i){return i.red=t.red-n.red,i.green=t.green-n.green,i.blue=t.blue-n.blue,i.alpha=t.alpha-n.alpha,i};ie.multiply=function(t,n,i){return i.red=t.red*n.red,i.green=t.green*n.green,i.blue=t.blue*n.blue,i.alpha=t.alpha*n.alpha,i};ie.divide=function(t,n,i){return i.red=t.red/n.red,i.green=t.green/n.green,i.blue=t.blue/n.blue,i.alpha=t.alpha/n.alpha,i};ie.mod=function(t,n,i){return i.red=t.red%n.red,i.green=t.green%n.green,i.blue=t.blue%n.blue,i.alpha=t.alpha%n.alpha,i};ie.lerp=function(t,n,i,o){return o.red=B.lerp(t.red,n.red,i),o.green=B.lerp(t.green,n.green,i),o.blue=B.lerp(t.blue,n.blue,i),o.alpha=B.lerp(t.alpha,n.alpha,i),o};ie.multiplyByScalar=function(t,n,i){return i.red=t.red*n,i.green=t.green*n,i.blue=t.blue*n,i.alpha=t.alpha*n,i};ie.divideByScalar=function(t,n,i){return i.red=t.red/n,i.green=t.green/n,i.blue=t.blue/n,i.alpha=t.alpha/n,i};ie.ALICEBLUE=Object.freeze(ie.fromCssColorString("#F0F8FF"));ie.ANTIQUEWHITE=Object.freeze(ie.fromCssColorString("#FAEBD7"));ie.AQUA=Object.freeze(ie.fromCssColorString("#00FFFF"));ie.AQUAMARINE=Object.freeze(ie.fromCssColorString("#7FFFD4"));ie.AZURE=Object.freeze(ie.fromCssColorString("#F0FFFF"));ie.BEIGE=Object.freeze(ie.fromCssColorString("#F5F5DC"));ie.BISQUE=Object.freeze(ie.fromCssColorString("#FFE4C4"));ie.BLACK=Object.freeze(ie.fromCssColorString("#000000"));ie.BLANCHEDALMOND=Object.freeze(ie.fromCssColorString("#FFEBCD"));ie.BLUE=Object.freeze(ie.fromCssColorString("#0000FF"));ie.BLUEVIOLET=Object.freeze(ie.fromCssColorString("#8A2BE2"));ie.BROWN=Object.freeze(ie.fromCssColorString("#A52A2A"));ie.BURLYWOOD=Object.freeze(ie.fromCssColorString("#DEB887"));ie.CADETBLUE=Object.freeze(ie.fromCssColorString("#5F9EA0"));ie.CHARTREUSE=Object.freeze(ie.fromCssColorString("#7FFF00"));ie.CHOCOLATE=Object.freeze(ie.fromCssColorString("#D2691E"));ie.CORAL=Object.freeze(ie.fromCssColorString("#FF7F50"));ie.CORNFLOWERBLUE=Object.freeze(ie.fromCssColorString("#6495ED"));ie.CORNSILK=Object.freeze(ie.fromCssColorString("#FFF8DC"));ie.CRIMSON=Object.freeze(ie.fromCssColorString("#DC143C"));ie.CYAN=Object.freeze(ie.fromCssColorString("#00FFFF"));ie.DARKBLUE=Object.freeze(ie.fromCssColorString("#00008B"));ie.DARKCYAN=Object.freeze(ie.fromCssColorString("#008B8B"));ie.DARKGOLDENROD=Object.freeze(ie.fromCssColorString("#B8860B"));ie.DARKGRAY=Object.freeze(ie.fromCssColorString("#A9A9A9"));ie.DARKGREEN=Object.freeze(ie.fromCssColorString("#006400"));ie.DARKGREY=ie.DARKGRAY;ie.DARKKHAKI=Object.freeze(ie.fromCssColorString("#BDB76B"));ie.DARKMAGENTA=Object.freeze(ie.fromCssColorString("#8B008B"));ie.DARKOLIVEGREEN=Object.freeze(ie.fromCssColorString("#556B2F"));ie.DARKORANGE=Object.freeze(ie.fromCssColorString("#FF8C00"));ie.DARKORCHID=Object.freeze(ie.fromCssColorString("#9932CC"));ie.DARKRED=Object.freeze(ie.fromCssColorString("#8B0000"));ie.DARKSALMON=Object.freeze(ie.fromCssColorString("#E9967A"));ie.DARKSEAGREEN=Object.freeze(ie.fromCssColorString("#8FBC8F"));ie.DARKSLATEBLUE=Object.freeze(ie.fromCssColorString("#483D8B"));ie.DARKSLATEGRAY=Object.freeze(ie.fromCssColorString("#2F4F4F"));ie.DARKSLATEGREY=ie.DARKSLATEGRAY;ie.DARKTURQUOISE=Object.freeze(ie.fromCssColorString("#00CED1"));ie.DARKVIOLET=Object.freeze(ie.fromCssColorString("#9400D3"));ie.DEEPPINK=Object.freeze(ie.fromCssColorString("#FF1493"));ie.DEEPSKYBLUE=Object.freeze(ie.fromCssColorString("#00BFFF"));ie.DIMGRAY=Object.freeze(ie.fromCssColorString("#696969"));ie.DIMGREY=ie.DIMGRAY;ie.DODGERBLUE=Object.freeze(ie.fromCssColorString("#1E90FF"));ie.FIREBRICK=Object.freeze(ie.fromCssColorString("#B22222"));ie.FLORALWHITE=Object.freeze(ie.fromCssColorString("#FFFAF0"));ie.FORESTGREEN=Object.freeze(ie.fromCssColorString("#228B22"));ie.FUCHSIA=Object.freeze(ie.fromCssColorString("#FF00FF"));ie.GAINSBORO=Object.freeze(ie.fromCssColorString("#DCDCDC"));ie.GHOSTWHITE=Object.freeze(ie.fromCssColorString("#F8F8FF"));ie.GOLD=Object.freeze(ie.fromCssColorString("#FFD700"));ie.GOLDENROD=Object.freeze(ie.fromCssColorString("#DAA520"));ie.GRAY=Object.freeze(ie.fromCssColorString("#808080"));ie.GREEN=Object.freeze(ie.fromCssColorString("#008000"));ie.GREENYELLOW=Object.freeze(ie.fromCssColorString("#ADFF2F"));ie.GREY=ie.GRAY;ie.HONEYDEW=Object.freeze(ie.fromCssColorString("#F0FFF0"));ie.HOTPINK=Object.freeze(ie.fromCssColorString("#FF69B4"));ie.INDIANRED=Object.freeze(ie.fromCssColorString("#CD5C5C"));ie.INDIGO=Object.freeze(ie.fromCssColorString("#4B0082"));ie.IVORY=Object.freeze(ie.fromCssColorString("#FFFFF0"));ie.KHAKI=Object.freeze(ie.fromCssColorString("#F0E68C"));ie.LAVENDER=Object.freeze(ie.fromCssColorString("#E6E6FA"));ie.LAVENDAR_BLUSH=Object.freeze(ie.fromCssColorString("#FFF0F5"));ie.LAWNGREEN=Object.freeze(ie.fromCssColorString("#7CFC00"));ie.LEMONCHIFFON=Object.freeze(ie.fromCssColorString("#FFFACD"));ie.LIGHTBLUE=Object.freeze(ie.fromCssColorString("#ADD8E6"));ie.LIGHTCORAL=Object.freeze(ie.fromCssColorString("#F08080"));ie.LIGHTCYAN=Object.freeze(ie.fromCssColorString("#E0FFFF"));ie.LIGHTGOLDENRODYELLOW=Object.freeze(ie.fromCssColorString("#FAFAD2"));ie.LIGHTGRAY=Object.freeze(ie.fromCssColorString("#D3D3D3"));ie.LIGHTGREEN=Object.freeze(ie.fromCssColorString("#90EE90"));ie.LIGHTGREY=ie.LIGHTGRAY;ie.LIGHTPINK=Object.freeze(ie.fromCssColorString("#FFB6C1"));ie.LIGHTSEAGREEN=Object.freeze(ie.fromCssColorString("#20B2AA"));ie.LIGHTSKYBLUE=Object.freeze(ie.fromCssColorString("#87CEFA"));ie.LIGHTSLATEGRAY=Object.freeze(ie.fromCssColorString("#778899"));ie.LIGHTSLATEGREY=ie.LIGHTSLATEGRAY;ie.LIGHTSTEELBLUE=Object.freeze(ie.fromCssColorString("#B0C4DE"));ie.LIGHTYELLOW=Object.freeze(ie.fromCssColorString("#FFFFE0"));ie.LIME=Object.freeze(ie.fromCssColorString("#00FF00"));ie.LIMEGREEN=Object.freeze(ie.fromCssColorString("#32CD32"));ie.LINEN=Object.freeze(ie.fromCssColorString("#FAF0E6"));ie.MAGENTA=Object.freeze(ie.fromCssColorString("#FF00FF"));ie.MAROON=Object.freeze(ie.fromCssColorString("#800000"));ie.MEDIUMAQUAMARINE=Object.freeze(ie.fromCssColorString("#66CDAA"));ie.MEDIUMBLUE=Object.freeze(ie.fromCssColorString("#0000CD"));ie.MEDIUMORCHID=Object.freeze(ie.fromCssColorString("#BA55D3"));ie.MEDIUMPURPLE=Object.freeze(ie.fromCssColorString("#9370DB"));ie.MEDIUMSEAGREEN=Object.freeze(ie.fromCssColorString("#3CB371"));ie.MEDIUMSLATEBLUE=Object.freeze(ie.fromCssColorString("#7B68EE"));ie.MEDIUMSPRINGGREEN=Object.freeze(ie.fromCssColorString("#00FA9A"));ie.MEDIUMTURQUOISE=Object.freeze(ie.fromCssColorString("#48D1CC"));ie.MEDIUMVIOLETRED=Object.freeze(ie.fromCssColorString("#C71585"));ie.MIDNIGHTBLUE=Object.freeze(ie.fromCssColorString("#191970"));ie.MINTCREAM=Object.freeze(ie.fromCssColorString("#F5FFFA"));ie.MISTYROSE=Object.freeze(ie.fromCssColorString("#FFE4E1"));ie.MOCCASIN=Object.freeze(ie.fromCssColorString("#FFE4B5"));ie.NAVAJOWHITE=Object.freeze(ie.fromCssColorString("#FFDEAD"));ie.NAVY=Object.freeze(ie.fromCssColorString("#000080"));ie.OLDLACE=Object.freeze(ie.fromCssColorString("#FDF5E6"));ie.OLIVE=Object.freeze(ie.fromCssColorString("#808000"));ie.OLIVEDRAB=Object.freeze(ie.fromCssColorString("#6B8E23"));ie.ORANGE=Object.freeze(ie.fromCssColorString("#FFA500"));ie.ORANGERED=Object.freeze(ie.fromCssColorString("#FF4500"));ie.ORCHID=Object.freeze(ie.fromCssColorString("#DA70D6"));ie.PALEGOLDENROD=Object.freeze(ie.fromCssColorString("#EEE8AA"));ie.PALEGREEN=Object.freeze(ie.fromCssColorString("#98FB98"));ie.PALETURQUOISE=Object.freeze(ie.fromCssColorString("#AFEEEE"));ie.PALEVIOLETRED=Object.freeze(ie.fromCssColorString("#DB7093"));ie.PAPAYAWHIP=Object.freeze(ie.fromCssColorString("#FFEFD5"));ie.PEACHPUFF=Object.freeze(ie.fromCssColorString("#FFDAB9"));ie.PERU=Object.freeze(ie.fromCssColorString("#CD853F"));ie.PINK=Object.freeze(ie.fromCssColorString("#FFC0CB"));ie.PLUM=Object.freeze(ie.fromCssColorString("#DDA0DD"));ie.POWDERBLUE=Object.freeze(ie.fromCssColorString("#B0E0E6"));ie.PURPLE=Object.freeze(ie.fromCssColorString("#800080"));ie.RED=Object.freeze(ie.fromCssColorString("#FF0000"));ie.ROSYBROWN=Object.freeze(ie.fromCssColorString("#BC8F8F"));ie.ROYALBLUE=Object.freeze(ie.fromCssColorString("#4169E1"));ie.SADDLEBROWN=Object.freeze(ie.fromCssColorString("#8B4513"));ie.SALMON=Object.freeze(ie.fromCssColorString("#FA8072"));ie.SANDYBROWN=Object.freeze(ie.fromCssColorString("#F4A460"));ie.SEAGREEN=Object.freeze(ie.fromCssColorString("#2E8B57"));ie.SEASHELL=Object.freeze(ie.fromCssColorString("#FFF5EE"));ie.SIENNA=Object.freeze(ie.fromCssColorString("#A0522D"));ie.SILVER=Object.freeze(ie.fromCssColorString("#C0C0C0"));ie.SKYBLUE=Object.freeze(ie.fromCssColorString("#87CEEB"));ie.SLATEBLUE=Object.freeze(ie.fromCssColorString("#6A5ACD"));ie.SLATEGRAY=Object.freeze(ie.fromCssColorString("#708090"));ie.SLATEGREY=ie.SLATEGRAY;ie.SNOW=Object.freeze(ie.fromCssColorString("#FFFAFA"));ie.SPRINGGREEN=Object.freeze(ie.fromCssColorString("#00FF7F"));ie.STEELBLUE=Object.freeze(ie.fromCssColorString("#4682B4"));ie.TAN=Object.freeze(ie.fromCssColorString("#D2B48C"));ie.TEAL=Object.freeze(ie.fromCssColorString("#008080"));ie.THISTLE=Object.freeze(ie.fromCssColorString("#D8BFD8"));ie.TOMATO=Object.freeze(ie.fromCssColorString("#FF6347"));ie.TURQUOISE=Object.freeze(ie.fromCssColorString("#40E0D0"));ie.VIOLET=Object.freeze(ie.fromCssColorString("#EE82EE"));ie.WHEAT=Object.freeze(ie.fromCssColorString("#F5DEB3"));ie.WHITE=Object.freeze(ie.fromCssColorString("#FFFFFF"));ie.WHITESMOKE=Object.freeze(ie.fromCssColorString("#F5F5F5"));ie.YELLOW=Object.freeze(ie.fromCssColorString("#FFFF00"));ie.YELLOWGREEN=Object.freeze(ie.fromCssColorString("#9ACD32"));ie.TRANSPARENT=Object.freeze(new ie(0,0,0,0));var z=ie;function AAe(){return!0}function CAe(t,n){n=A(n,"This object was destroyed, i.e., destroy() was called.");function i(){}for(let o in t)typeof t[o]=="function"&&(t[o]=i);t.isDestroyed=AAe}var ue=CAe;function _l(t,n){t=A(t,0),this._near=t,n=A(n,Number.MAX_VALUE),this._far=n}Object.defineProperties(_l.prototype,{near:{get:function(){return this._near},set:function(t){this._near=t}},far:{get:function(){return this._far},set:function(t){this._far=t}}});_l.packedLength=2;_l.pack=function(t,n,i){return i=A(i,0),n[i++]=t.near,n[i]=t.far,n};_l.unpack=function(t,n,i){return n=A(n,0),f(i)||(i=new _l),i.near=t[n++],i.far=t[n],i};_l.equals=function(t,n){return t===n||f(t)&&f(n)&&t.near===n.near&&t.far===n.far};_l.clone=function(t,n){if(!!f(t))return f(n)||(n=new _l),n.near=t.near,n.far=t.far,n};_l.prototype.clone=function(t){return _l.clone(this,t)};_l.prototype.equals=function(t){return _l.equals(this,t)};var wt=_l;function au(t,n,i,o){this.near=A(t,0),this.nearValue=A(n,0),this.far=A(i,1),this.farValue=A(o,0)}au.clone=function(t,n){if(!!f(t))return f(n)?(n.near=t.near,n.nearValue=t.nearValue,n.far=t.far,n.farValue=t.farValue,n):new au(t.near,t.nearValue,t.far,t.farValue)};au.packedLength=4;au.pack=function(t,n,i){return i=A(i,0),n[i++]=t.near,n[i++]=t.nearValue,n[i++]=t.far,n[i]=t.farValue,n};au.unpack=function(t,n,i){return n=A(n,0),f(i)||(i=new au),i.near=t[n++],i.nearValue=t[n++],i.far=t[n++],i.farValue=t[n],i};au.equals=function(t,n){return t===n||f(t)&&f(n)&&t.near===n.near&&t.nearValue===n.nearValue&&t.far===n.far&&t.farValue===n.farValue};au.prototype.clone=function(t){return au.clone(this,t)};au.prototype.equals=function(t){return au.equals(this,t)};var Pt=au;var xAe={NONE:0,CLAMP_TO_GROUND:1,RELATIVE_TO_GROUND:2},Ge=Object.freeze(xAe);var TAe={CENTER:0,LEFT:1,RIGHT:-1},ui=Object.freeze(TAe);var EAe={CENTER:0,BOTTOM:1,BASELINE:2,TOP:-1},vn=Object.freeze(EAe);var bAe={DONE:0,PENDING:1,FAILED:2},rt=Object.freeze(bAe);function gf(){Ce.throwInstantiationError()}Object.defineProperties(gf.prototype,{isConstant:{get:Ce.throwInstantiationError},definitionChanged:{get:Ce.throwInstantiationError}});gf.prototype.getValue=Ce.throwInstantiationError;gf.prototype.equals=Ce.throwInstantiationError;gf.equals=function(t,n){return t===n||f(t)&&t.equals(n)};gf.arrayEquals=function(t,n){if(t===n)return!0;if(!f(t)||!f(n)||t.length!==n.length)return!1;let i=t.length;for(let o=0;o<i;o++)if(!gf.equals(t[o],n[o]))return!1;return!0};gf.isConstant=function(t){return!f(t)||t.isConstant};gf.getValueOrUndefined=function(t,n,i){return f(t)?t.getValue(n,i):void 0};gf.getValueOrDefault=function(t,n,i,o){return f(t)?A(t.getValue(n,o),i):i};gf.getValueOrClonedDefault=function(t,n,i,o){let r;return f(t)&&(r=t.getValue(n,o)),f(r)||(r=i.clone(r)),r};var q=gf;var SAe=z.WHITE,wAe=m.ZERO,DAe=Ge.NONE,vAe=W.ZERO,PAe=1,IAe=0,BAe=m.ZERO,OAe=ui.CENTER,RAe=vn.CENTER,MAe=!1,LAe=new m,FAe=new z,NAe=new m,VAe=new W,kAe=new Pt,UAe=new Pt,zAe=new Pt,HAe=new He,GAe=new wt;function NY(t){this.entity=t,this.billboard=void 0,this.textureValue=void 0}function Bp(t,n){n.collectionChanged.addEventListener(Bp.prototype._onCollectionChanged,this),this._cluster=t,this._entityCollection=n,this._items=new yt,this._onCollectionChanged(n,n.values,[],[])}Bp.prototype.update=function(t){let n=this._items.values,i=this._cluster;for(let o=0,r=n.length;o<r;o++){let s=n[o],a=s.entity,c=a._billboard,l,u=s.billboard,d=a.isShowing&&a.isAvailable(t)&&q.getValueOrDefault(c._show,t,!0),h;if(d&&(h=q.getValueOrUndefined(a._position,t,LAe),l=q.getValueOrUndefined(c._image,t),d=f(h)&&f(l)),!d){rH(s,a,i);continue}q.isConstant(a._position)||(i._clusterDirty=!0),f(u)||(u=i.getBillboard(a),u.id=a,u.image=void 0,s.billboard=u),u.show=d,(!f(u.image)||s.textureValue!==l)&&(u.image=l,s.textureValue=l),u.position=h,u.color=q.getValueOrDefault(c._color,t,SAe,FAe),u.eyeOffset=q.getValueOrDefault(c._eyeOffset,t,wAe,NAe),u.heightReference=q.getValueOrDefault(c._heightReference,t,DAe),u.pixelOffset=q.getValueOrDefault(c._pixelOffset,t,vAe,VAe),u.scale=q.getValueOrDefault(c._scale,t,PAe),u.rotation=q.getValueOrDefault(c._rotation,t,IAe),u.alignedAxis=q.getValueOrDefault(c._alignedAxis,t,BAe),u.horizontalOrigin=q.getValueOrDefault(c._horizontalOrigin,t,OAe),u.verticalOrigin=q.getValueOrDefault(c._verticalOrigin,t,RAe),u.width=q.getValueOrUndefined(c._width,t),u.height=q.getValueOrUndefined(c._height,t),u.scaleByDistance=q.getValueOrUndefined(c._scaleByDistance,t,kAe),u.translucencyByDistance=q.getValueOrUndefined(c._translucencyByDistance,t,UAe),u.pixelOffsetScaleByDistance=q.getValueOrUndefined(c._pixelOffsetScaleByDistance,t,zAe),u.sizeInMeters=q.getValueOrDefault(c._sizeInMeters,t,MAe),u.distanceDisplayCondition=q.getValueOrUndefined(c._distanceDisplayCondition,t,GAe),u.disableDepthTestDistance=q.getValueOrUndefined(c._disableDepthTestDistance,t);let _=q.getValueOrUndefined(c._imageSubRegion,t,HAe);f(_)&&u.setImageSubRegion(u._imageId,_)}return!0};Bp.prototype.getBoundingSphere=function(t,n){let i=this._items.get(t.id);if(!f(i)||!f(i.billboard))return rt.FAILED;let o=i.billboard;if(o.heightReference===Ge.NONE)n.center=m.clone(o.position,n.center);else{if(!f(o._clampedPosition))return rt.PENDING;n.center=m.clone(o._clampedPosition,n.center)}return n.radius=0,rt.DONE};Bp.prototype.isDestroyed=function(){return!1};Bp.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(Bp.prototype._onCollectionChanged,this);let t=this._entityCollection.values;for(let n=0;n<t.length;n++)this._cluster.removeBillboard(t[n]);return ue(this)};Bp.prototype._onCollectionChanged=function(t,n,i,o){let r,s,a=this._items,c=this._cluster;for(r=n.length-1;r>-1;r--)s=n[r],f(s._billboard)&&f(s._position)&&a.set(s.id,new NY(s));for(r=o.length-1;r>-1;r--)s=o[r],f(s._billboard)&&f(s._position)?a.contains(s.id)||a.set(s.id,new NY(s)):(rH(a.get(s.id),s,c),a.remove(s.id));for(r=i.length-1;r>-1;r--)s=i[r],rH(a.get(s.id),s,c),a.remove(s.id)};function rH(t,n,i){f(t)&&(t.billboard=void 0,i.removeBillboard(n))}var vP=Bp;function WAe(t,n){this.start=A(t,0),this.stop=A(n,0)}var Fc=WAe;function Ze(t,n,i,o,r,s,a,c,l){this[0]=A(t,0),this[1]=A(o,0),this[2]=A(a,0),this[3]=A(n,0),this[4]=A(r,0),this[5]=A(c,0),this[6]=A(i,0),this[7]=A(s,0),this[8]=A(l,0)}Ze.packedLength=9;Ze.pack=function(t,n,i){return i=A(i,0),n[i++]=t[0],n[i++]=t[1],n[i++]=t[2],n[i++]=t[3],n[i++]=t[4],n[i++]=t[5],n[i++]=t[6],n[i++]=t[7],n[i++]=t[8],n};Ze.unpack=function(t,n,i){return n=A(n,0),f(i)||(i=new Ze),i[0]=t[n++],i[1]=t[n++],i[2]=t[n++],i[3]=t[n++],i[4]=t[n++],i[5]=t[n++],i[6]=t[n++],i[7]=t[n++],i[8]=t[n++],i};Ze.packArray=function(t,n){let i=t.length,o=i*9;f(n)?!Array.isArray(n)&&n.length!==o||n.length!==o&&(n.length=o):n=new Array(o);for(let r=0;r<i;++r)Ze.pack(t[r],n,r*9);return n};Ze.unpackArray=function(t,n){let i=t.length;f(n)?n.length=i/9:n=new Array(i/9);for(let o=0;o<i;o+=9){let r=o/9;n[r]=Ze.unpack(t,o,n[r])}return n};Ze.clone=function(t,n){if(!!f(t))return f(n)?(n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n):new Ze(t[0],t[3],t[6],t[1],t[4],t[7],t[2],t[5],t[8])};Ze.fromArray=Ze.unpack;Ze.fromColumnMajorArray=function(t,n){return Ze.clone(t,n)};Ze.fromRowMajorArray=function(t,n){return f(n)?(n[0]=t[0],n[1]=t[3],n[2]=t[6],n[3]=t[1],n[4]=t[4],n[5]=t[7],n[6]=t[2],n[7]=t[5],n[8]=t[8],n):new Ze(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])};Ze.fromQuaternion=function(t,n){let i=t.x*t.x,o=t.x*t.y,r=t.x*t.z,s=t.x*t.w,a=t.y*t.y,c=t.y*t.z,l=t.y*t.w,u=t.z*t.z,d=t.z*t.w,h=t.w*t.w,_=i-a-u+h,y=2*(o-d),p=2*(r+l),C=2*(o+d),x=-i+a-u+h,T=2*(c-s),E=2*(r-l),S=2*(c+s),w=-i-a+u+h;return f(n)?(n[0]=_,n[1]=C,n[2]=E,n[3]=y,n[4]=x,n[5]=S,n[6]=p,n[7]=T,n[8]=w,n):new Ze(_,y,p,C,x,T,E,S,w)};Ze.fromHeadingPitchRoll=function(t,n){let i=Math.cos(-t.pitch),o=Math.cos(-t.heading),r=Math.cos(t.roll),s=Math.sin(-t.pitch),a=Math.sin(-t.heading),c=Math.sin(t.roll),l=i*o,u=-r*a+c*s*o,d=c*a+r*s*o,h=i*a,_=r*o+c*s*a,y=-c*o+r*s*a,p=-s,C=c*i,x=r*i;return f(n)?(n[0]=l,n[1]=h,n[2]=p,n[3]=u,n[4]=_,n[5]=C,n[6]=d,n[7]=y,n[8]=x,n):new Ze(l,u,d,h,_,y,p,C,x)};Ze.fromScale=function(t,n){return f(n)?(n[0]=t.x,n[1]=0,n[2]=0,n[3]=0,n[4]=t.y,n[5]=0,n[6]=0,n[7]=0,n[8]=t.z,n):new Ze(t.x,0,0,0,t.y,0,0,0,t.z)};Ze.fromUniformScale=function(t,n){return f(n)?(n[0]=t,n[1]=0,n[2]=0,n[3]=0,n[4]=t,n[5]=0,n[6]=0,n[7]=0,n[8]=t,n):new Ze(t,0,0,0,t,0,0,0,t)};Ze.fromCrossProduct=function(t,n){return f(n)?(n[0]=0,n[1]=t.z,n[2]=-t.y,n[3]=-t.z,n[4]=0,n[5]=t.x,n[6]=t.y,n[7]=-t.x,n[8]=0,n):new Ze(0,-t.z,t.y,t.z,0,-t.x,-t.y,t.x,0)};Ze.fromRotationX=function(t,n){let i=Math.cos(t),o=Math.sin(t);return f(n)?(n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=i,n[5]=o,n[6]=0,n[7]=-o,n[8]=i,n):new Ze(1,0,0,0,i,-o,0,o,i)};Ze.fromRotationY=function(t,n){let i=Math.cos(t),o=Math.sin(t);return f(n)?(n[0]=i,n[1]=0,n[2]=-o,n[3]=0,n[4]=1,n[5]=0,n[6]=o,n[7]=0,n[8]=i,n):new Ze(i,0,o,0,1,0,-o,0,i)};Ze.fromRotationZ=function(t,n){let i=Math.cos(t),o=Math.sin(t);return f(n)?(n[0]=i,n[1]=o,n[2]=0,n[3]=-o,n[4]=i,n[5]=0,n[6]=0,n[7]=0,n[8]=1,n):new Ze(i,-o,0,o,i,0,0,0,1)};Ze.toArray=function(t,n){return f(n)?(n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n):[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8]]};Ze.getElementIndex=function(t,n){return t*3+n};Ze.getColumn=function(t,n,i){let o=n*3,r=t[o],s=t[o+1],a=t[o+2];return i.x=r,i.y=s,i.z=a,i};Ze.setColumn=function(t,n,i,o){o=Ze.clone(t,o);let r=n*3;return o[r]=i.x,o[r+1]=i.y,o[r+2]=i.z,o};Ze.getRow=function(t,n,i){let o=t[n],r=t[n+3],s=t[n+6];return i.x=o,i.y=r,i.z=s,i};Ze.setRow=function(t,n,i,o){return o=Ze.clone(t,o),o[n]=i.x,o[n+3]=i.y,o[n+6]=i.z,o};var jAe=new m;Ze.setScale=function(t,n,i){let o=Ze.getScale(t,jAe),r=n.x/o.x,s=n.y/o.y,a=n.z/o.z;return i[0]=t[0]*r,i[1]=t[1]*r,i[2]=t[2]*r,i[3]=t[3]*s,i[4]=t[4]*s,i[5]=t[5]*s,i[6]=t[6]*a,i[7]=t[7]*a,i[8]=t[8]*a,i};var qAe=new m;Ze.setUniformScale=function(t,n,i){let o=Ze.getScale(t,qAe),r=n/o.x,s=n/o.y,a=n/o.z;return i[0]=t[0]*r,i[1]=t[1]*r,i[2]=t[2]*r,i[3]=t[3]*s,i[4]=t[4]*s,i[5]=t[5]*s,i[6]=t[6]*a,i[7]=t[7]*a,i[8]=t[8]*a,i};var sH=new m;Ze.getScale=function(t,n){return n.x=m.magnitude(m.fromElements(t[0],t[1],t[2],sH)),n.y=m.magnitude(m.fromElements(t[3],t[4],t[5],sH)),n.z=m.magnitude(m.fromElements(t[6],t[7],t[8],sH)),n};var VY=new m;Ze.getMaximumScale=function(t){return Ze.getScale(t,VY),m.maximumComponent(VY)};var YAe=new m;Ze.setRotation=function(t,n,i){let o=Ze.getScale(t,YAe);return i[0]=n[0]*o.x,i[1]=n[1]*o.x,i[2]=n[2]*o.x,i[3]=n[3]*o.y,i[4]=n[4]*o.y,i[5]=n[5]*o.y,i[6]=n[6]*o.z,i[7]=n[7]*o.z,i[8]=n[8]*o.z,i};var XAe=new m;Ze.getRotation=function(t,n){let i=Ze.getScale(t,XAe);return n[0]=t[0]/i.x,n[1]=t[1]/i.x,n[2]=t[2]/i.x,n[3]=t[3]/i.y,n[4]=t[4]/i.y,n[5]=t[5]/i.y,n[6]=t[6]/i.z,n[7]=t[7]/i.z,n[8]=t[8]/i.z,n};Ze.multiply=function(t,n,i){let o=t[0]*n[0]+t[3]*n[1]+t[6]*n[2],r=t[1]*n[0]+t[4]*n[1]+t[7]*n[2],s=t[2]*n[0]+t[5]*n[1]+t[8]*n[2],a=t[0]*n[3]+t[3]*n[4]+t[6]*n[5],c=t[1]*n[3]+t[4]*n[4]+t[7]*n[5],l=t[2]*n[3]+t[5]*n[4]+t[8]*n[5],u=t[0]*n[6]+t[3]*n[7]+t[6]*n[8],d=t[1]*n[6]+t[4]*n[7]+t[7]*n[8],h=t[2]*n[6]+t[5]*n[7]+t[8]*n[8];return i[0]=o,i[1]=r,i[2]=s,i[3]=a,i[4]=c,i[5]=l,i[6]=u,i[7]=d,i[8]=h,i};Ze.add=function(t,n,i){return i[0]=t[0]+n[0],i[1]=t[1]+n[1],i[2]=t[2]+n[2],i[3]=t[3]+n[3],i[4]=t[4]+n[4],i[5]=t[5]+n[5],i[6]=t[6]+n[6],i[7]=t[7]+n[7],i[8]=t[8]+n[8],i};Ze.subtract=function(t,n,i){return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],i[3]=t[3]-n[3],i[4]=t[4]-n[4],i[5]=t[5]-n[5],i[6]=t[6]-n[6],i[7]=t[7]-n[7],i[8]=t[8]-n[8],i};Ze.multiplyByVector=function(t,n,i){let o=n.x,r=n.y,s=n.z,a=t[0]*o+t[3]*r+t[6]*s,c=t[1]*o+t[4]*r+t[7]*s,l=t[2]*o+t[5]*r+t[8]*s;return i.x=a,i.y=c,i.z=l,i};Ze.multiplyByScalar=function(t,n,i){return i[0]=t[0]*n,i[1]=t[1]*n,i[2]=t[2]*n,i[3]=t[3]*n,i[4]=t[4]*n,i[5]=t[5]*n,i[6]=t[6]*n,i[7]=t[7]*n,i[8]=t[8]*n,i};Ze.multiplyByScale=function(t,n,i){return i[0]=t[0]*n.x,i[1]=t[1]*n.x,i[2]=t[2]*n.x,i[3]=t[3]*n.y,i[4]=t[4]*n.y,i[5]=t[5]*n.y,i[6]=t[6]*n.z,i[7]=t[7]*n.z,i[8]=t[8]*n.z,i};Ze.multiplyByUniformScale=function(t,n,i){return i[0]=t[0]*n,i[1]=t[1]*n,i[2]=t[2]*n,i[3]=t[3]*n,i[4]=t[4]*n,i[5]=t[5]*n,i[6]=t[6]*n,i[7]=t[7]*n,i[8]=t[8]*n,i};Ze.negate=function(t,n){return n[0]=-t[0],n[1]=-t[1],n[2]=-t[2],n[3]=-t[3],n[4]=-t[4],n[5]=-t[5],n[6]=-t[6],n[7]=-t[7],n[8]=-t[8],n};Ze.transpose=function(t,n){let i=t[0],o=t[3],r=t[6],s=t[1],a=t[4],c=t[7],l=t[2],u=t[5],d=t[8];return n[0]=i,n[1]=o,n[2]=r,n[3]=s,n[4]=a,n[5]=c,n[6]=l,n[7]=u,n[8]=d,n};function KAe(t){let n=0;for(let i=0;i<9;++i){let o=t[i];n+=o*o}return Math.sqrt(n)}var aH=[1,0,0],cH=[2,2,1];function JAe(t){let n=0;for(let i=0;i<3;++i){let o=t[Ze.getElementIndex(cH[i],aH[i])];n+=2*o*o}return Math.sqrt(n)}function ZAe(t,n){let i=B.EPSILON15,o=0,r=1;for(let u=0;u<3;++u){let d=Math.abs(t[Ze.getElementIndex(cH[u],aH[u])]);d>o&&(r=u,o=d)}let s=1,a=0,c=aH[r],l=cH[r];if(Math.abs(t[Ze.getElementIndex(l,c)])>i){let u=t[Ze.getElementIndex(l,l)],d=t[Ze.getElementIndex(c,c)],h=t[Ze.getElementIndex(l,c)],_=(u-d)/2/h,y;_<0?y=-1/(-_+Math.sqrt(1+_*_)):y=1/(_+Math.sqrt(1+_*_)),s=1/Math.sqrt(1+y*y),a=y*s}return n=Ze.clone(Ze.IDENTITY,n),n[Ze.getElementIndex(c,c)]=n[Ze.getElementIndex(l,l)]=s,n[Ze.getElementIndex(l,c)]=a,n[Ze.getElementIndex(c,l)]=-a,n}var PP=new Ze,kY=new Ze;Ze.computeEigenDecomposition=function(t,n){let i=B.EPSILON20,o=10,r=0,s=0;f(n)||(n={});let a=n.unitary=Ze.clone(Ze.IDENTITY,n.unitary),c=n.diagonal=Ze.clone(t,n.diagonal),l=i*KAe(c);for(;s<o&&JAe(c)>l;)ZAe(c,PP),Ze.transpose(PP,kY),Ze.multiply(c,PP,c),Ze.multiply(kY,c,c),Ze.multiply(a,PP,a),++r>2&&(++s,r=0);return n};Ze.abs=function(t,n){return n[0]=Math.abs(t[0]),n[1]=Math.abs(t[1]),n[2]=Math.abs(t[2]),n[3]=Math.abs(t[3]),n[4]=Math.abs(t[4]),n[5]=Math.abs(t[5]),n[6]=Math.abs(t[6]),n[7]=Math.abs(t[7]),n[8]=Math.abs(t[8]),n};Ze.determinant=function(t){let n=t[0],i=t[3],o=t[6],r=t[1],s=t[4],a=t[7],c=t[2],l=t[5],u=t[8];return n*(s*u-l*a)+r*(l*o-i*u)+c*(i*a-s*o)};Ze.inverse=function(t,n){let i=t[0],o=t[1],r=t[2],s=t[3],a=t[4],c=t[5],l=t[6],u=t[7],d=t[8],h=Ze.determinant(t);n[0]=a*d-u*c,n[1]=u*r-o*d,n[2]=o*c-a*r,n[3]=l*c-s*d,n[4]=i*d-l*r,n[5]=s*r-i*c,n[6]=s*u-l*a,n[7]=l*o-i*u,n[8]=i*a-s*o;let _=1/h;return Ze.multiplyByScalar(n,_,n)};var QAe=new Ze;Ze.inverseTranspose=function(t,n){return Ze.inverse(Ze.transpose(t,QAe),n)};Ze.equals=function(t,n){return t===n||f(t)&&f(n)&&t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]&&t[4]===n[4]&&t[5]===n[5]&&t[6]===n[6]&&t[7]===n[7]&&t[8]===n[8]};Ze.equalsEpsilon=function(t,n,i){return i=A(i,0),t===n||f(t)&&f(n)&&Math.abs(t[0]-n[0])<=i&&Math.abs(t[1]-n[1])<=i&&Math.abs(t[2]-n[2])<=i&&Math.abs(t[3]-n[3])<=i&&Math.abs(t[4]-n[4])<=i&&Math.abs(t[5]-n[5])<=i&&Math.abs(t[6]-n[6])<=i&&Math.abs(t[7]-n[7])<=i&&Math.abs(t[8]-n[8])<=i};Ze.IDENTITY=Object.freeze(new Ze(1,0,0,0,1,0,0,0,1));Ze.ZERO=Object.freeze(new Ze(0,0,0,0,0,0,0,0,0));Ze.COLUMN0ROW0=0;Ze.COLUMN0ROW1=1;Ze.COLUMN0ROW2=2;Ze.COLUMN1ROW0=3;Ze.COLUMN1ROW1=4;Ze.COLUMN1ROW2=5;Ze.COLUMN2ROW0=6;Ze.COLUMN2ROW1=7;Ze.COLUMN2ROW2=8;Object.defineProperties(Ze.prototype,{length:{get:function(){return Ze.packedLength}}});Ze.prototype.clone=function(t){return Ze.clone(this,t)};Ze.prototype.equals=function(t){return Ze.equals(this,t)};Ze.equalsArray=function(t,n,i){return t[0]===n[i]&&t[1]===n[i+1]&&t[2]===n[i+2]&&t[3]===n[i+3]&&t[4]===n[i+4]&&t[5]===n[i+5]&&t[6]===n[i+6]&&t[7]===n[i+7]&&t[8]===n[i+8]};Ze.prototype.equalsEpsilon=function(t,n){return Ze.equalsEpsilon(this,t,n)};Ze.prototype.toString=function(){return`(${this[0]}, ${this[3]}, ${this[6]})
(${this[1]}, ${this[4]}, ${this[7]})
(${this[2]}, ${this[5]}, ${this[8]})`};var $=Ze;function mt(t,n,i,o){this.x=A(t,0),this.y=A(n,0),this.z=A(i,0),this.w=A(o,0)}mt.fromElements=function(t,n,i,o,r){return f(r)?(r.x=t,r.y=n,r.z=i,r.w=o,r):new mt(t,n,i,o)};mt.fromColor=function(t,n){return f(n)?(n.x=t.red,n.y=t.green,n.z=t.blue,n.w=t.alpha,n):new mt(t.red,t.green,t.blue,t.alpha)};mt.clone=function(t,n){if(!!f(t))return f(n)?(n.x=t.x,n.y=t.y,n.z=t.z,n.w=t.w,n):new mt(t.x,t.y,t.z,t.w)};mt.packedLength=4;mt.pack=function(t,n,i){return i=A(i,0),n[i++]=t.x,n[i++]=t.y,n[i++]=t.z,n[i]=t.w,n};mt.unpack=function(t,n,i){return n=A(n,0),f(i)||(i=new mt),i.x=t[n++],i.y=t[n++],i.z=t[n++],i.w=t[n],i};mt.packArray=function(t,n){let i=t.length,o=i*4;f(n)?!Array.isArray(n)&&n.length!==o||n.length!==o&&(n.length=o):n=new Array(o);for(let r=0;r<i;++r)mt.pack(t[r],n,r*4);return n};mt.unpackArray=function(t,n){let i=t.length;f(n)?n.length=i/4:n=new Array(i/4);for(let o=0;o<i;o+=4){let r=o/4;n[r]=mt.unpack(t,o,n[r])}return n};mt.fromArray=mt.unpack;mt.maximumComponent=function(t){return Math.max(t.x,t.y,t.z,t.w)};mt.minimumComponent=function(t){return Math.min(t.x,t.y,t.z,t.w)};mt.minimumByComponent=function(t,n,i){return i.x=Math.min(t.x,n.x),i.y=Math.min(t.y,n.y),i.z=Math.min(t.z,n.z),i.w=Math.min(t.w,n.w),i};mt.maximumByComponent=function(t,n,i){return i.x=Math.max(t.x,n.x),i.y=Math.max(t.y,n.y),i.z=Math.max(t.z,n.z),i.w=Math.max(t.w,n.w),i};mt.clamp=function(t,n,i,o){let r=B.clamp(t.x,n.x,i.x),s=B.clamp(t.y,n.y,i.y),a=B.clamp(t.z,n.z,i.z),c=B.clamp(t.w,n.w,i.w);return o.x=r,o.y=s,o.z=a,o.w=c,o};mt.magnitudeSquared=function(t){return t.x*t.x+t.y*t.y+t.z*t.z+t.w*t.w};mt.magnitude=function(t){return Math.sqrt(mt.magnitudeSquared(t))};var IP=new mt;mt.distance=function(t,n){return mt.subtract(t,n,IP),mt.magnitude(IP)};mt.distanceSquared=function(t,n){return mt.subtract(t,n,IP),mt.magnitudeSquared(IP)};mt.normalize=function(t,n){let i=mt.magnitude(t);return n.x=t.x/i,n.y=t.y/i,n.z=t.z/i,n.w=t.w/i,n};mt.dot=function(t,n){return t.x*n.x+t.y*n.y+t.z*n.z+t.w*n.w};mt.multiplyComponents=function(t,n,i){return i.x=t.x*n.x,i.y=t.y*n.y,i.z=t.z*n.z,i.w=t.w*n.w,i};mt.divideComponents=function(t,n,i){return i.x=t.x/n.x,i.y=t.y/n.y,i.z=t.z/n.z,i.w=t.w/n.w,i};mt.add=function(t,n,i){return i.x=t.x+n.x,i.y=t.y+n.y,i.z=t.z+n.z,i.w=t.w+n.w,i};mt.subtract=function(t,n,i){return i.x=t.x-n.x,i.y=t.y-n.y,i.z=t.z-n.z,i.w=t.w-n.w,i};mt.multiplyByScalar=function(t,n,i){return i.x=t.x*n,i.y=t.y*n,i.z=t.z*n,i.w=t.w*n,i};mt.divideByScalar=function(t,n,i){return i.x=t.x/n,i.y=t.y/n,i.z=t.z/n,i.w=t.w/n,i};mt.negate=function(t,n){return n.x=-t.x,n.y=-t.y,n.z=-t.z,n.w=-t.w,n};mt.abs=function(t,n){return n.x=Math.abs(t.x),n.y=Math.abs(t.y),n.z=Math.abs(t.z),n.w=Math.abs(t.w),n};var UY=new mt;mt.lerp=function(t,n,i,o){return mt.multiplyByScalar(n,i,UY),o=mt.multiplyByScalar(t,1-i,o),mt.add(UY,o,o)};var $Ae=new mt;mt.mostOrthogonalAxis=function(t,n){let i=mt.normalize(t,$Ae);return mt.abs(i,i),i.x<=i.y?i.x<=i.z?i.x<=i.w?n=mt.clone(mt.UNIT_X,n):n=mt.clone(mt.UNIT_W,n):i.z<=i.w?n=mt.clone(mt.UNIT_Z,n):n=mt.clone(mt.UNIT_W,n):i.y<=i.z?i.y<=i.w?n=mt.clone(mt.UNIT_Y,n):n=mt.clone(mt.UNIT_W,n):i.z<=i.w?n=mt.clone(mt.UNIT_Z,n):n=mt.clone(mt.UNIT_W,n),n};mt.equals=function(t,n){return t===n||f(t)&&f(n)&&t.x===n.x&&t.y===n.y&&t.z===n.z&&t.w===n.w};mt.equalsArray=function(t,n,i){return t.x===n[i]&&t.y===n[i+1]&&t.z===n[i+2]&&t.w===n[i+3]};mt.equalsEpsilon=function(t,n,i,o){return t===n||f(t)&&f(n)&&B.equalsEpsilon(t.x,n.x,i,o)&&B.equalsEpsilon(t.y,n.y,i,o)&&B.equalsEpsilon(t.z,n.z,i,o)&&B.equalsEpsilon(t.w,n.w,i,o)};mt.ZERO=Object.freeze(new mt(0,0,0,0));mt.ONE=Object.freeze(new mt(1,1,1,1));mt.UNIT_X=Object.freeze(new mt(1,0,0,0));mt.UNIT_Y=Object.freeze(new mt(0,1,0,0));mt.UNIT_Z=Object.freeze(new mt(0,0,1,0));mt.UNIT_W=Object.freeze(new mt(0,0,0,1));mt.prototype.clone=function(t){return mt.clone(this,t)};mt.prototype.equals=function(t){return mt.equals(this,t)};mt.prototype.equalsEpsilon=function(t,n,i){return mt.equalsEpsilon(this,t,n,i)};mt.prototype.toString=function(){return`(${this.x}, ${this.y}, ${this.z}, ${this.w})`};var lH=new Float32Array(1),_a=new Uint8Array(lH.buffer),eCe=new Uint32Array([287454020]),tCe=new Uint8Array(eCe.buffer),zY=tCe[0]===68;mt.packFloat=function(t,n){return f(n)||(n=new mt),lH[0]=t,zY?(n.x=_a[0],n.y=_a[1],n.z=_a[2],n.w=_a[3]):(n.x=_a[3],n.y=_a[2],n.z=_a[1],n.w=_a[0]),n};mt.unpackFloat=function(t){return zY?(_a[0]=t.x,_a[1]=t.y,_a[2]=t.z,_a[3]=t.w):(_a[0]=t.w,_a[1]=t.z,_a[2]=t.y,_a[3]=t.x),lH[0]};var se=mt;function Ab(t){this.name="RuntimeError",this.message=t;let n;try{throw new Error}catch(i){n=i.stack}this.stack=n}f(Object.create)&&(Ab.prototype=Object.create(Error.prototype),Ab.prototype.constructor=Ab);Ab.prototype.toString=function(){let t=`${this.name}: ${this.message}`;return f(this.stack)&&(t+=`
${this.stack.toString()}`),t};var he=Ab;function Ke(t,n,i,o,r,s,a,c,l,u,d,h,_,y,p,C){this[0]=A(t,0),this[1]=A(r,0),this[2]=A(l,0),this[3]=A(_,0),this[4]=A(n,0),this[5]=A(s,0),this[6]=A(u,0),this[7]=A(y,0),this[8]=A(i,0),this[9]=A(a,0),this[10]=A(d,0),this[11]=A(p,0),this[12]=A(o,0),this[13]=A(c,0),this[14]=A(h,0),this[15]=A(C,0)}Ke.packedLength=16;Ke.pack=function(t,n,i){return i=A(i,0),n[i++]=t[0],n[i++]=t[1],n[i++]=t[2],n[i++]=t[3],n[i++]=t[4],n[i++]=t[5],n[i++]=t[6],n[i++]=t[7],n[i++]=t[8],n[i++]=t[9],n[i++]=t[10],n[i++]=t[11],n[i++]=t[12],n[i++]=t[13],n[i++]=t[14],n[i]=t[15],n};Ke.unpack=function(t,n,i){return n=A(n,0),f(i)||(i=new Ke),i[0]=t[n++],i[1]=t[n++],i[2]=t[n++],i[3]=t[n++],i[4]=t[n++],i[5]=t[n++],i[6]=t[n++],i[7]=t[n++],i[8]=t[n++],i[9]=t[n++],i[10]=t[n++],i[11]=t[n++],i[12]=t[n++],i[13]=t[n++],i[14]=t[n++],i[15]=t[n],i};Ke.packArray=function(t,n){let i=t.length,o=i*16;f(n)?!Array.isArray(n)&&n.length!==o||n.length!==o&&(n.length=o):n=new Array(o);for(let r=0;r<i;++r)Ke.pack(t[r],n,r*16);return n};Ke.unpackArray=function(t,n){let i=t.length;f(n)?n.length=i/16:n=new Array(i/16);for(let o=0;o<i;o+=16){let r=o/16;n[r]=Ke.unpack(t,o,n[r])}return n};Ke.clone=function(t,n){if(!!f(t))return f(n)?(n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n):new Ke(t[0],t[4],t[8],t[12],t[1],t[5],t[9],t[13],t[2],t[6],t[10],t[14],t[3],t[7],t[11],t[15])};Ke.fromArray=Ke.unpack;Ke.fromColumnMajorArray=function(t,n){return Ke.clone(t,n)};Ke.fromRowMajorArray=function(t,n){return f(n)?(n[0]=t[0],n[1]=t[4],n[2]=t[8],n[3]=t[12],n[4]=t[1],n[5]=t[5],n[6]=t[9],n[7]=t[13],n[8]=t[2],n[9]=t[6],n[10]=t[10],n[11]=t[14],n[12]=t[3],n[13]=t[7],n[14]=t[11],n[15]=t[15],n):new Ke(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])};Ke.fromRotationTranslation=function(t,n,i){return n=A(n,m.ZERO),f(i)?(i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=0,i[4]=t[3],i[5]=t[4],i[6]=t[5],i[7]=0,i[8]=t[6],i[9]=t[7],i[10]=t[8],i[11]=0,i[12]=n.x,i[13]=n.y,i[14]=n.z,i[15]=1,i):new Ke(t[0],t[3],t[6],n.x,t[1],t[4],t[7],n.y,t[2],t[5],t[8],n.z,0,0,0,1)};Ke.fromTranslationQuaternionRotationScale=function(t,n,i,o){f(o)||(o=new Ke);let r=i.x,s=i.y,a=i.z,c=n.x*n.x,l=n.x*n.y,u=n.x*n.z,d=n.x*n.w,h=n.y*n.y,_=n.y*n.z,y=n.y*n.w,p=n.z*n.z,C=n.z*n.w,x=n.w*n.w,T=c-h-p+x,E=2*(l-C),S=2*(u+y),w=2*(l+C),D=-c+h-p+x,I=2*(_-d),O=2*(u-y),M=2*(_+d),L=-c-h+p+x;return o[0]=T*r,o[1]=w*r,o[2]=O*r,o[3]=0,o[4]=E*s,o[5]=D*s,o[6]=M*s,o[7]=0,o[8]=S*a,o[9]=I*a,o[10]=L*a,o[11]=0,o[12]=t.x,o[13]=t.y,o[14]=t.z,o[15]=1,o};Ke.fromTranslationRotationScale=function(t,n){return Ke.fromTranslationQuaternionRotationScale(t.translation,t.rotation,t.scale,n)};Ke.fromTranslation=function(t,n){return Ke.fromRotationTranslation($.IDENTITY,t,n)};Ke.fromScale=function(t,n){return f(n)?(n[0]=t.x,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=t.y,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=t.z,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n):new Ke(t.x,0,0,0,0,t.y,0,0,0,0,t.z,0,0,0,0,1)};Ke.fromUniformScale=function(t,n){return f(n)?(n[0]=t,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=t,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=t,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n):new Ke(t,0,0,0,0,t,0,0,0,0,t,0,0,0,0,1)};Ke.fromRotation=function(t,n){return f(n)||(n=new Ke),n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=0,n[4]=t[3],n[5]=t[4],n[6]=t[5],n[7]=0,n[8]=t[6],n[9]=t[7],n[10]=t[8],n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n};var ZA=new m,QA=new m,Cb=new m;Ke.fromCamera=function(t,n){let i=t.position,o=t.direction,r=t.up;m.normalize(o,ZA),m.normalize(m.cross(ZA,r,QA),QA),m.normalize(m.cross(QA,ZA,Cb),Cb);let s=QA.x,a=QA.y,c=QA.z,l=ZA.x,u=ZA.y,d=ZA.z,h=Cb.x,_=Cb.y,y=Cb.z,p=i.x,C=i.y,x=i.z,T=s*-p+a*-C+c*-x,E=h*-p+_*-C+y*-x,S=l*p+u*C+d*x;return f(n)?(n[0]=s,n[1]=h,n[2]=-l,n[3]=0,n[4]=a,n[5]=_,n[6]=-u,n[7]=0,n[8]=c,n[9]=y,n[10]=-d,n[11]=0,n[12]=T,n[13]=E,n[14]=S,n[15]=1,n):new Ke(s,a,c,T,h,_,y,E,-l,-u,-d,S,0,0,0,1)};Ke.computePerspectiveFieldOfView=function(t,n,i,o,r){let a=1/Math.tan(t*.5),c=a/n,l=(o+i)/(i-o),u=2*o*i/(i-o);return r[0]=c,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=a,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=l,r[11]=-1,r[12]=0,r[13]=0,r[14]=u,r[15]=0,r};Ke.computeOrthographicOffCenter=function(t,n,i,o,r,s,a){let c=1/(n-t),l=1/(o-i),u=1/(s-r),d=-(n+t)*c,h=-(o+i)*l,_=-(s+r)*u;return c*=2,l*=2,u*=-2,a[0]=c,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=l,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=u,a[11]=0,a[12]=d,a[13]=h,a[14]=_,a[15]=1,a};Ke.computePerspectiveOffCenter=function(t,n,i,o,r,s,a){let c=2*r/(n-t),l=2*r/(o-i),u=(n+t)/(n-t),d=(o+i)/(o-i),h=-(s+r)/(s-r),_=-1,y=-2*s*r/(s-r);return a[0]=c,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=l,a[6]=0,a[7]=0,a[8]=u,a[9]=d,a[10]=h,a[11]=_,a[12]=0,a[13]=0,a[14]=y,a[15]=0,a};Ke.computeInfinitePerspectiveOffCenter=function(t,n,i,o,r,s){let a=2*r/(n-t),c=2*r/(o-i),l=(n+t)/(n-t),u=(o+i)/(o-i),d=-1,h=-1,_=-2*r;return s[0]=a,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=c,s[6]=0,s[7]=0,s[8]=l,s[9]=u,s[10]=d,s[11]=h,s[12]=0,s[13]=0,s[14]=_,s[15]=0,s};Ke.computeViewportTransformation=function(t,n,i,o){f(o)||(o=new Ke),t=A(t,A.EMPTY_OBJECT);let r=A(t.x,0),s=A(t.y,0),a=A(t.width,0),c=A(t.height,0);n=A(n,0),i=A(i,1);let l=a*.5,u=c*.5,d=(i-n)*.5,h=l,_=u,y=d,p=r+l,C=s+u,x=n+d,T=1;return o[0]=h,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=_,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=y,o[11]=0,o[12]=p,o[13]=C,o[14]=x,o[15]=T,o};Ke.computeView=function(t,n,i,o,r){return r[0]=o.x,r[1]=i.x,r[2]=-n.x,r[3]=0,r[4]=o.y,r[5]=i.y,r[6]=-n.y,r[7]=0,r[8]=o.z,r[9]=i.z,r[10]=-n.z,r[11]=0,r[12]=-m.dot(o,t),r[13]=-m.dot(i,t),r[14]=m.dot(n,t),r[15]=1,r};Ke.toArray=function(t,n){return f(n)?(n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n):[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15]]};Ke.getElementIndex=function(t,n){return t*4+n};Ke.getColumn=function(t,n,i){let o=n*4,r=t[o],s=t[o+1],a=t[o+2],c=t[o+3];return i.x=r,i.y=s,i.z=a,i.w=c,i};Ke.setColumn=function(t,n,i,o){o=Ke.clone(t,o);let r=n*4;return o[r]=i.x,o[r+1]=i.y,o[r+2]=i.z,o[r+3]=i.w,o};Ke.getRow=function(t,n,i){let o=t[n],r=t[n+4],s=t[n+8],a=t[n+12];return i.x=o,i.y=r,i.z=s,i.w=a,i};Ke.setRow=function(t,n,i,o){return o=Ke.clone(t,o),o[n]=i.x,o[n+4]=i.y,o[n+8]=i.z,o[n+12]=i.w,o};Ke.setTranslation=function(t,n,i){return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[8]=t[8],i[9]=t[9],i[10]=t[10],i[11]=t[11],i[12]=n.x,i[13]=n.y,i[14]=n.z,i[15]=t[15],i};var nCe=new m;Ke.setScale=function(t,n,i){let o=Ke.getScale(t,nCe),r=n.x/o.x,s=n.y/o.y,a=n.z/o.z;return i[0]=t[0]*r,i[1]=t[1]*r,i[2]=t[2]*r,i[3]=t[3],i[4]=t[4]*s,i[5]=t[5]*s,i[6]=t[6]*s,i[7]=t[7],i[8]=t[8]*a,i[9]=t[9]*a,i[10]=t[10]*a,i[11]=t[11],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15],i};var iCe=new m;Ke.setUniformScale=function(t,n,i){let o=Ke.getScale(t,iCe),r=n/o.x,s=n/o.y,a=n/o.z;return i[0]=t[0]*r,i[1]=t[1]*r,i[2]=t[2]*r,i[3]=t[3],i[4]=t[4]*s,i[5]=t[5]*s,i[6]=t[6]*s,i[7]=t[7],i[8]=t[8]*a,i[9]=t[9]*a,i[10]=t[10]*a,i[11]=t[11],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15],i};var uH=new m;Ke.getScale=function(t,n){return n.x=m.magnitude(m.fromElements(t[0],t[1],t[2],uH)),n.y=m.magnitude(m.fromElements(t[4],t[5],t[6],uH)),n.z=m.magnitude(m.fromElements(t[8],t[9],t[10],uH)),n};var HY=new m;Ke.getMaximumScale=function(t){return Ke.getScale(t,HY),m.maximumComponent(HY)};var oCe=new m;Ke.setRotation=function(t,n,i){let o=Ke.getScale(t,oCe);return i[0]=n[0]*o.x,i[1]=n[1]*o.x,i[2]=n[2]*o.x,i[3]=t[3],i[4]=n[3]*o.y,i[5]=n[4]*o.y,i[6]=n[5]*o.y,i[7]=t[7],i[8]=n[6]*o.z,i[9]=n[7]*o.z,i[10]=n[8]*o.z,i[11]=t[11],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15],i};var rCe=new m;Ke.getRotation=function(t,n){let i=Ke.getScale(t,rCe);return n[0]=t[0]/i.x,n[1]=t[1]/i.x,n[2]=t[2]/i.x,n[3]=t[4]/i.y,n[4]=t[5]/i.y,n[5]=t[6]/i.y,n[6]=t[8]/i.z,n[7]=t[9]/i.z,n[8]=t[10]/i.z,n};Ke.multiply=function(t,n,i){let o=t[0],r=t[1],s=t[2],a=t[3],c=t[4],l=t[5],u=t[6],d=t[7],h=t[8],_=t[9],y=t[10],p=t[11],C=t[12],x=t[13],T=t[14],E=t[15],S=n[0],w=n[1],D=n[2],I=n[3],O=n[4],M=n[5],L=n[6],F=n[7],g=n[8],b=n[9],v=n[10],P=n[11],R=n[12],V=n[13],H=n[14],U=n[15],G=o*S+c*w+h*D+C*I,k=r*S+l*w+_*D+x*I,X=s*S+u*w+y*D+T*I,Y=a*S+d*w+p*D+E*I,K=o*O+c*M+h*L+C*F,j=r*O+l*M+_*L+x*F,Z=s*O+u*M+y*L+T*F,Q=a*O+d*M+p*L+E*F,me=o*g+c*b+h*v+C*P,_e=r*g+l*b+_*v+x*P,re=s*g+u*b+y*v+T*P,fe=a*g+d*b+p*v+E*P,ge=o*R+c*V+h*H+C*U,be=r*R+l*V+_*H+x*U,Be=s*R+u*V+y*H+T*U,ke=a*R+d*V+p*H+E*U;return i[0]=G,i[1]=k,i[2]=X,i[3]=Y,i[4]=K,i[5]=j,i[6]=Z,i[7]=Q,i[8]=me,i[9]=_e,i[10]=re,i[11]=fe,i[12]=ge,i[13]=be,i[14]=Be,i[15]=ke,i};Ke.add=function(t,n,i){return i[0]=t[0]+n[0],i[1]=t[1]+n[1],i[2]=t[2]+n[2],i[3]=t[3]+n[3],i[4]=t[4]+n[4],i[5]=t[5]+n[5],i[6]=t[6]+n[6],i[7]=t[7]+n[7],i[8]=t[8]+n[8],i[9]=t[9]+n[9],i[10]=t[10]+n[10],i[11]=t[11]+n[11],i[12]=t[12]+n[12],i[13]=t[13]+n[13],i[14]=t[14]+n[14],i[15]=t[15]+n[15],i};Ke.subtract=function(t,n,i){return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],i[3]=t[3]-n[3],i[4]=t[4]-n[4],i[5]=t[5]-n[5],i[6]=t[6]-n[6],i[7]=t[7]-n[7],i[8]=t[8]-n[8],i[9]=t[9]-n[9],i[10]=t[10]-n[10],i[11]=t[11]-n[11],i[12]=t[12]-n[12],i[13]=t[13]-n[13],i[14]=t[14]-n[14],i[15]=t[15]-n[15],i};Ke.multiplyTransformation=function(t,n,i){let o=t[0],r=t[1],s=t[2],a=t[4],c=t[5],l=t[6],u=t[8],d=t[9],h=t[10],_=t[12],y=t[13],p=t[14],C=n[0],x=n[1],T=n[2],E=n[4],S=n[5],w=n[6],D=n[8],I=n[9],O=n[10],M=n[12],L=n[13],F=n[14],g=o*C+a*x+u*T,b=r*C+c*x+d*T,v=s*C+l*x+h*T,P=o*E+a*S+u*w,R=r*E+c*S+d*w,V=s*E+l*S+h*w,H=o*D+a*I+u*O,U=r*D+c*I+d*O,G=s*D+l*I+h*O,k=o*M+a*L+u*F+_,X=r*M+c*L+d*F+y,Y=s*M+l*L+h*F+p;return i[0]=g,i[1]=b,i[2]=v,i[3]=0,i[4]=P,i[5]=R,i[6]=V,i[7]=0,i[8]=H,i[9]=U,i[10]=G,i[11]=0,i[12]=k,i[13]=X,i[14]=Y,i[15]=1,i};Ke.multiplyByMatrix3=function(t,n,i){let o=t[0],r=t[1],s=t[2],a=t[4],c=t[5],l=t[6],u=t[8],d=t[9],h=t[10],_=n[0],y=n[1],p=n[2],C=n[3],x=n[4],T=n[5],E=n[6],S=n[7],w=n[8],D=o*_+a*y+u*p,I=r*_+c*y+d*p,O=s*_+l*y+h*p,M=o*C+a*x+u*T,L=r*C+c*x+d*T,F=s*C+l*x+h*T,g=o*E+a*S+u*w,b=r*E+c*S+d*w,v=s*E+l*S+h*w;return i[0]=D,i[1]=I,i[2]=O,i[3]=0,i[4]=M,i[5]=L,i[6]=F,i[7]=0,i[8]=g,i[9]=b,i[10]=v,i[11]=0,i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15],i};Ke.multiplyByTranslation=function(t,n,i){let o=n.x,r=n.y,s=n.z,a=o*t[0]+r*t[4]+s*t[8]+t[12],c=o*t[1]+r*t[5]+s*t[9]+t[13],l=o*t[2]+r*t[6]+s*t[10]+t[14];return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[8]=t[8],i[9]=t[9],i[10]=t[10],i[11]=t[11],i[12]=a,i[13]=c,i[14]=l,i[15]=t[15],i};Ke.multiplyByScale=function(t,n,i){let o=n.x,r=n.y,s=n.z;return o===1&&r===1&&s===1?Ke.clone(t,i):(i[0]=o*t[0],i[1]=o*t[1],i[2]=o*t[2],i[3]=t[3],i[4]=r*t[4],i[5]=r*t[5],i[6]=r*t[6],i[7]=t[7],i[8]=s*t[8],i[9]=s*t[9],i[10]=s*t[10],i[11]=t[11],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15],i)};Ke.multiplyByUniformScale=function(t,n,i){return i[0]=t[0]*n,i[1]=t[1]*n,i[2]=t[2]*n,i[3]=t[3],i[4]=t[4]*n,i[5]=t[5]*n,i[6]=t[6]*n,i[7]=t[7],i[8]=t[8]*n,i[9]=t[9]*n,i[10]=t[10]*n,i[11]=t[11],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15],i};Ke.multiplyByVector=function(t,n,i){let o=n.x,r=n.y,s=n.z,a=n.w,c=t[0]*o+t[4]*r+t[8]*s+t[12]*a,l=t[1]*o+t[5]*r+t[9]*s+t[13]*a,u=t[2]*o+t[6]*r+t[10]*s+t[14]*a,d=t[3]*o+t[7]*r+t[11]*s+t[15]*a;return i.x=c,i.y=l,i.z=u,i.w=d,i};Ke.multiplyByPointAsVector=function(t,n,i){let o=n.x,r=n.y,s=n.z,a=t[0]*o+t[4]*r+t[8]*s,c=t[1]*o+t[5]*r+t[9]*s,l=t[2]*o+t[6]*r+t[10]*s;return i.x=a,i.y=c,i.z=l,i};Ke.multiplyByPoint=function(t,n,i){let o=n.x,r=n.y,s=n.z,a=t[0]*o+t[4]*r+t[8]*s+t[12],c=t[1]*o+t[5]*r+t[9]*s+t[13],l=t[2]*o+t[6]*r+t[10]*s+t[14];return i.x=a,i.y=c,i.z=l,i};Ke.multiplyByScalar=function(t,n,i){return i[0]=t[0]*n,i[1]=t[1]*n,i[2]=t[2]*n,i[3]=t[3]*n,i[4]=t[4]*n,i[5]=t[5]*n,i[6]=t[6]*n,i[7]=t[7]*n,i[8]=t[8]*n,i[9]=t[9]*n,i[10]=t[10]*n,i[11]=t[11]*n,i[12]=t[12]*n,i[13]=t[13]*n,i[14]=t[14]*n,i[15]=t[15]*n,i};Ke.negate=function(t,n){return n[0]=-t[0],n[1]=-t[1],n[2]=-t[2],n[3]=-t[3],n[4]=-t[4],n[5]=-t[5],n[6]=-t[6],n[7]=-t[7],n[8]=-t[8],n[9]=-t[9],n[10]=-t[10],n[11]=-t[11],n[12]=-t[12],n[13]=-t[13],n[14]=-t[14],n[15]=-t[15],n};Ke.transpose=function(t,n){let i=t[1],o=t[2],r=t[3],s=t[6],a=t[7],c=t[11];return n[0]=t[0],n[1]=t[4],n[2]=t[8],n[3]=t[12],n[4]=i,n[5]=t[5],n[6]=t[9],n[7]=t[13],n[8]=o,n[9]=s,n[10]=t[10],n[11]=t[14],n[12]=r,n[13]=a,n[14]=c,n[15]=t[15],n};Ke.abs=function(t,n){return n[0]=Math.abs(t[0]),n[1]=Math.abs(t[1]),n[2]=Math.abs(t[2]),n[3]=Math.abs(t[3]),n[4]=Math.abs(t[4]),n[5]=Math.abs(t[5]),n[6]=Math.abs(t[6]),n[7]=Math.abs(t[7]),n[8]=Math.abs(t[8]),n[9]=Math.abs(t[9]),n[10]=Math.abs(t[10]),n[11]=Math.abs(t[11]),n[12]=Math.abs(t[12]),n[13]=Math.abs(t[13]),n[14]=Math.abs(t[14]),n[15]=Math.abs(t[15]),n};Ke.equals=function(t,n){return t===n||f(t)&&f(n)&&t[12]===n[12]&&t[13]===n[13]&&t[14]===n[14]&&t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[4]===n[4]&&t[5]===n[5]&&t[6]===n[6]&&t[8]===n[8]&&t[9]===n[9]&&t[10]===n[10]&&t[3]===n[3]&&t[7]===n[7]&&t[11]===n[11]&&t[15]===n[15]};Ke.equalsEpsilon=function(t,n,i){return i=A(i,0),t===n||f(t)&&f(n)&&Math.abs(t[0]-n[0])<=i&&Math.abs(t[1]-n[1])<=i&&Math.abs(t[2]-n[2])<=i&&Math.abs(t[3]-n[3])<=i&&Math.abs(t[4]-n[4])<=i&&Math.abs(t[5]-n[5])<=i&&Math.abs(t[6]-n[6])<=i&&Math.abs(t[7]-n[7])<=i&&Math.abs(t[8]-n[8])<=i&&Math.abs(t[9]-n[9])<=i&&Math.abs(t[10]-n[10])<=i&&Math.abs(t[11]-n[11])<=i&&Math.abs(t[12]-n[12])<=i&&Math.abs(t[13]-n[13])<=i&&Math.abs(t[14]-n[14])<=i&&Math.abs(t[15]-n[15])<=i};Ke.getTranslation=function(t,n){return n.x=t[12],n.y=t[13],n.z=t[14],n};Ke.getMatrix3=function(t,n){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[4],n[4]=t[5],n[5]=t[6],n[6]=t[8],n[7]=t[9],n[8]=t[10],n};var sCe=new $,aCe=new $,cCe=new se,lCe=new se(0,0,0,1);Ke.inverse=function(t,n){let i=t[0],o=t[4],r=t[8],s=t[12],a=t[1],c=t[5],l=t[9],u=t[13],d=t[2],h=t[6],_=t[10],y=t[14],p=t[3],C=t[7],x=t[11],T=t[15],E=_*T,S=y*x,w=h*T,D=y*C,I=h*x,O=_*C,M=d*T,L=y*p,F=d*x,g=_*p,b=d*C,v=h*p,P=E*c+D*l+I*u-(S*c+w*l+O*u),R=S*a+M*l+g*u-(E*a+L*l+F*u),V=w*a+L*c+b*u-(D*a+M*c+v*u),H=O*a+F*c+v*l-(I*a+g*c+b*l),U=S*o+w*r+O*s-(E*o+D*r+I*s),G=E*i+L*r+F*s-(S*i+M*r+g*s),k=D*i+M*o+v*s-(w*i+L*o+b*s),X=I*i+g*o+b*r-(O*i+F*o+v*r);E=r*u,S=s*l,w=o*u,D=s*c,I=o*l,O=r*c,M=i*u,L=s*a,F=i*l,g=r*a,b=i*c,v=o*a;let Y=E*C+D*x+I*T-(S*C+w*x+O*T),K=S*p+M*x+g*T-(E*p+L*x+F*T),j=w*p+L*C+b*T-(D*p+M*C+v*T),Z=O*p+F*C+v*x-(I*p+g*C+b*x),Q=w*_+O*y+S*h-(I*y+E*h+D*_),me=F*y+E*d+L*_-(M*_+g*y+S*d),_e=M*h+v*y+D*d-(b*y+w*d+L*h),re=b*_+I*d+g*h-(F*h+v*_+O*d),fe=i*P+o*R+r*V+s*H;if(Math.abs(fe)<B.EPSILON21){if($.equalsEpsilon(Ke.getMatrix3(t,sCe),aCe,B.EPSILON7)&&se.equals(Ke.getRow(t,3,cCe),lCe))return n[0]=0,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=0,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=0,n[11]=0,n[12]=-t[12],n[13]=-t[13],n[14]=-t[14],n[15]=1,n;throw new he("matrix is not invertible because its determinate is zero.")}return fe=1/fe,n[0]=P*fe,n[1]=R*fe,n[2]=V*fe,n[3]=H*fe,n[4]=U*fe,n[5]=G*fe,n[6]=k*fe,n[7]=X*fe,n[8]=Y*fe,n[9]=K*fe,n[10]=j*fe,n[11]=Z*fe,n[12]=Q*fe,n[13]=me*fe,n[14]=_e*fe,n[15]=re*fe,n};Ke.inverseTransformation=function(t,n){let i=t[0],o=t[1],r=t[2],s=t[4],a=t[5],c=t[6],l=t[8],u=t[9],d=t[10],h=t[12],_=t[13],y=t[14],p=-i*h-o*_-r*y,C=-s*h-a*_-c*y,x=-l*h-u*_-d*y;return n[0]=i,n[1]=s,n[2]=l,n[3]=0,n[4]=o,n[5]=a,n[6]=u,n[7]=0,n[8]=r,n[9]=c,n[10]=d,n[11]=0,n[12]=p,n[13]=C,n[14]=x,n[15]=1,n};var uCe=new Ke;Ke.inverseTranspose=function(t,n){return Ke.inverse(Ke.transpose(t,uCe),n)};Ke.IDENTITY=Object.freeze(new Ke(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1));Ke.ZERO=Object.freeze(new Ke(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0));Ke.COLUMN0ROW0=0;Ke.COLUMN0ROW1=1;Ke.COLUMN0ROW2=2;Ke.COLUMN0ROW3=3;Ke.COLUMN1ROW0=4;Ke.COLUMN1ROW1=5;Ke.COLUMN1ROW2=6;Ke.COLUMN1ROW3=7;Ke.COLUMN2ROW0=8;Ke.COLUMN2ROW1=9;Ke.COLUMN2ROW2=10;Ke.COLUMN2ROW3=11;Ke.COLUMN3ROW0=12;Ke.COLUMN3ROW1=13;Ke.COLUMN3ROW2=14;Ke.COLUMN3ROW3=15;Object.defineProperties(Ke.prototype,{length:{get:function(){return Ke.packedLength}}});Ke.prototype.clone=function(t){return Ke.clone(this,t)};Ke.prototype.equals=function(t){return Ke.equals(this,t)};Ke.equalsArray=function(t,n,i){return t[0]===n[i]&&t[1]===n[i+1]&&t[2]===n[i+2]&&t[3]===n[i+3]&&t[4]===n[i+4]&&t[5]===n[i+5]&&t[6]===n[i+6]&&t[7]===n[i+7]&&t[8]===n[i+8]&&t[9]===n[i+9]&&t[10]===n[i+10]&&t[11]===n[i+11]&&t[12]===n[i+12]&&t[13]===n[i+13]&&t[14]===n[i+14]&&t[15]===n[i+15]};Ke.prototype.equalsEpsilon=function(t,n){return Ke.equalsEpsilon(this,t,n)};Ke.prototype.toString=function(){return`(${this[0]}, ${this[4]}, ${this[8]}, ${this[12]})
(${this[1]}, ${this[5]}, ${this[9]}, ${this[13]})
(${this[2]}, ${this[6]}, ${this[10]}, ${this[14]})
(${this[3]}, ${this[7]}, ${this[11]}, ${this[15]})`};var N=Ke;function an(t,n){this.center=m.clone(A(t,m.ZERO)),this.radius=A(n,0)}var hH=new m,mH=new m,pH=new m,_H=new m,gH=new m,yH=new m,AH=new m,Es=new m,CH=new m,xH=new m,TH=new m,EH=new m,fCe=4/3*B.PI;an.fromPoints=function(t,n){if(f(n)||(n=new an),!f(t)||t.length===0)return n.center=m.clone(m.ZERO,n.center),n.radius=0,n;let i=m.clone(t[0],AH),o=m.clone(i,hH),r=m.clone(i,mH),s=m.clone(i,pH),a=m.clone(i,_H),c=m.clone(i,gH),l=m.clone(i,yH),u=t.length,d;for(d=1;d<u;d++){m.clone(t[d],i);let M=i.x,L=i.y,F=i.z;M<o.x&&m.clone(i,o),M>a.x&&m.clone(i,a),L<r.y&&m.clone(i,r),L>c.y&&m.clone(i,c),F<s.z&&m.clone(i,s),F>l.z&&m.clone(i,l)}let h=m.magnitudeSquared(m.subtract(a,o,Es)),_=m.magnitudeSquared(m.subtract(c,r,Es)),y=m.magnitudeSquared(m.subtract(l,s,Es)),p=o,C=a,x=h;_>x&&(x=_,p=r,C=c),y>x&&(x=y,p=s,C=l);let T=CH;T.x=(p.x+C.x)*.5,T.y=(p.y+C.y)*.5,T.z=(p.z+C.z)*.5;let E=m.magnitudeSquared(m.subtract(C,T,Es)),S=Math.sqrt(E),w=xH;w.x=o.x,w.y=r.y,w.z=s.z;let D=TH;D.x=a.x,D.y=c.y,D.z=l.z;let I=m.midpoint(w,D,EH),O=0;for(d=0;d<u;d++){m.clone(t[d],i);let M=m.magnitude(m.subtract(i,I,Es));M>O&&(O=M);let L=m.magnitudeSquared(m.subtract(i,T,Es));if(L>E){let F=Math.sqrt(L);S=(S+F)*.5,E=S*S;let g=F-S;T.x=(S*T.x+g*i.x)/F,T.y=(S*T.y+g*i.y)/F,T.z=(S*T.z+g*i.z)/F}}return S<O?(m.clone(T,n.center),n.radius=S):(m.clone(I,n.center),n.radius=O),n};var dCe=new Ci,hCe=new m,mCe=new m,fH=new de,dH=new de;an.fromRectangle2D=function(t,n,i){return an.fromRectangleWithHeights2D(t,n,0,0,i)};an.fromRectangleWithHeights2D=function(t,n,i,o,r){if(f(r)||(r=new an),!f(t))return r.center=m.clone(m.ZERO,r.center),r.radius=0,r;n=A(n,dCe),le.southwest(t,fH),fH.height=i,le.northeast(t,dH),dH.height=o;let s=n.project(fH,hCe),a=n.project(dH,mCe),c=a.x-s.x,l=a.y-s.y,u=a.z-s.z;r.radius=Math.sqrt(c*c+l*l+u*u)*.5;let d=r.center;return d.x=s.x+c*.5,d.y=s.y+l*.5,d.z=s.z+u*.5,r};var pCe=[];an.fromRectangle3D=function(t,n,i,o){if(n=A(n,oe.WGS84),i=A(i,0),f(o)||(o=new an),!f(t))return o.center=m.clone(m.ZERO,o.center),o.radius=0,o;let r=le.subsample(t,n,i,pCe);return an.fromPoints(r,o)};an.fromVertices=function(t,n,i,o){if(f(o)||(o=new an),!f(t)||t.length===0)return o.center=m.clone(m.ZERO,o.center),o.radius=0,o;n=A(n,m.ZERO),i=A(i,3);let r=AH;r.x=t[0]+n.x,r.y=t[1]+n.y,r.z=t[2]+n.z;let s=m.clone(r,hH),a=m.clone(r,mH),c=m.clone(r,pH),l=m.clone(r,_H),u=m.clone(r,gH),d=m.clone(r,yH),h=t.length,_;for(_=0;_<h;_+=i){let F=t[_]+n.x,g=t[_+1]+n.y,b=t[_+2]+n.z;r.x=F,r.y=g,r.z=b,F<s.x&&m.clone(r,s),F>l.x&&m.clone(r,l),g<a.y&&m.clone(r,a),g>u.y&&m.clone(r,u),b<c.z&&m.clone(r,c),b>d.z&&m.clone(r,d)}let y=m.magnitudeSquared(m.subtract(l,s,Es)),p=m.magnitudeSquared(m.subtract(u,a,Es)),C=m.magnitudeSquared(m.subtract(d,c,Es)),x=s,T=l,E=y;p>E&&(E=p,x=a,T=u),C>E&&(E=C,x=c,T=d);let S=CH;S.x=(x.x+T.x)*.5,S.y=(x.y+T.y)*.5,S.z=(x.z+T.z)*.5;let w=m.magnitudeSquared(m.subtract(T,S,Es)),D=Math.sqrt(w),I=xH;I.x=s.x,I.y=a.y,I.z=c.z;let O=TH;O.x=l.x,O.y=u.y,O.z=d.z;let M=m.midpoint(I,O,EH),L=0;for(_=0;_<h;_+=i){r.x=t[_]+n.x,r.y=t[_+1]+n.y,r.z=t[_+2]+n.z;let F=m.magnitude(m.subtract(r,M,Es));F>L&&(L=F);let g=m.magnitudeSquared(m.subtract(r,S,Es));if(g>w){let b=Math.sqrt(g);D=(D+b)*.5,w=D*D;let v=b-D;S.x=(D*S.x+v*r.x)/b,S.y=(D*S.y+v*r.y)/b,S.z=(D*S.z+v*r.z)/b}}return D<L?(m.clone(S,o.center),o.radius=D):(m.clone(M,o.center),o.radius=L),o};an.fromEncodedCartesianVertices=function(t,n,i){if(f(i)||(i=new an),!f(t)||!f(n)||t.length!==n.length||t.length===0)return i.center=m.clone(m.ZERO,i.center),i.radius=0,i;let o=AH;o.x=t[0]+n[0],o.y=t[1]+n[1],o.z=t[2]+n[2];let r=m.clone(o,hH),s=m.clone(o,mH),a=m.clone(o,pH),c=m.clone(o,_H),l=m.clone(o,gH),u=m.clone(o,yH),d=t.length,h;for(h=0;h<d;h+=3){let L=t[h]+n[h],F=t[h+1]+n[h+1],g=t[h+2]+n[h+2];o.x=L,o.y=F,o.z=g,L<r.x&&m.clone(o,r),L>c.x&&m.clone(o,c),F<s.y&&m.clone(o,s),F>l.y&&m.clone(o,l),g<a.z&&m.clone(o,a),g>u.z&&m.clone(o,u)}let _=m.magnitudeSquared(m.subtract(c,r,Es)),y=m.magnitudeSquared(m.subtract(l,s,Es)),p=m.magnitudeSquared(m.subtract(u,a,Es)),C=r,x=c,T=_;y>T&&(T=y,C=s,x=l),p>T&&(T=p,C=a,x=u);let E=CH;E.x=(C.x+x.x)*.5,E.y=(C.y+x.y)*.5,E.z=(C.z+x.z)*.5;let S=m.magnitudeSquared(m.subtract(x,E,Es)),w=Math.sqrt(S),D=xH;D.x=r.x,D.y=s.y,D.z=a.z;let I=TH;I.x=c.x,I.y=l.y,I.z=u.z;let O=m.midpoint(D,I,EH),M=0;for(h=0;h<d;h+=3){o.x=t[h]+n[h],o.y=t[h+1]+n[h+1],o.z=t[h+2]+n[h+2];let L=m.magnitude(m.subtract(o,O,Es));L>M&&(M=L);let F=m.magnitudeSquared(m.subtract(o,E,Es));if(F>S){let g=Math.sqrt(F);w=(w+g)*.5,S=w*w;let b=g-w;E.x=(w*E.x+b*o.x)/g,E.y=(w*E.y+b*o.y)/g,E.z=(w*E.z+b*o.z)/g}}return w<M?(m.clone(E,i.center),i.radius=w):(m.clone(O,i.center),i.radius=M),i};an.fromCornerPoints=function(t,n,i){f(i)||(i=new an);let o=m.midpoint(t,n,i.center);return i.radius=m.distance(o,n),i};an.fromEllipsoid=function(t,n){return f(n)||(n=new an),m.clone(m.ZERO,n.center),n.radius=t.maximumRadius,n};var _Ce=new m;an.fromBoundingSpheres=function(t,n){if(f(n)||(n=new an),!f(t)||t.length===0)return n.center=m.clone(m.ZERO,n.center),n.radius=0,n;let i=t.length;if(i===1)return an.clone(t[0],n);if(i===2)return an.union(t[0],t[1],n);let o=[],r;for(r=0;r<i;r++)o.push(t[r].center);n=an.fromPoints(o,n);let s=n.center,a=n.radius;for(r=0;r<i;r++){let c=t[r];a=Math.max(a,m.distance(s,c.center,_Ce)+c.radius)}return n.radius=a,n};var gCe=new m,yCe=new m,ACe=new m;an.fromOrientedBoundingBox=function(t,n){f(n)||(n=new an);let i=t.halfAxes,o=$.getColumn(i,0,gCe),r=$.getColumn(i,1,yCe),s=$.getColumn(i,2,ACe);return m.add(o,r,o),m.add(o,s,o),n.center=m.clone(t.center,n.center),n.radius=m.magnitude(o),n};var CCe=new m,xCe=new m;an.fromTransformation=function(t,n){f(n)||(n=new an);let i=N.getTranslation(t,CCe),o=N.getScale(t,xCe),r=.5*m.magnitude(o);return n.center=m.clone(i,n.center),n.radius=r,n};an.clone=function(t,n){if(!!f(t))return f(n)?(n.center=m.clone(t.center,n.center),n.radius=t.radius,n):new an(t.center,t.radius)};an.packedLength=4;an.pack=function(t,n,i){i=A(i,0);let o=t.center;return n[i++]=o.x,n[i++]=o.y,n[i++]=o.z,n[i]=t.radius,n};an.unpack=function(t,n,i){n=A(n,0),f(i)||(i=new an);let o=i.center;return o.x=t[n++],o.y=t[n++],o.z=t[n++],i.radius=t[n],i};var TCe=new m,ECe=new m;an.union=function(t,n,i){f(i)||(i=new an);let o=t.center,r=t.radius,s=n.center,a=n.radius,c=m.subtract(s,o,TCe),l=m.magnitude(c);if(r>=l+a)return t.clone(i),i;if(a>=l+r)return n.clone(i),i;let u=(r+l+a)*.5,d=m.multiplyByScalar(c,(-r+u)/l,ECe);return m.add(d,o,d),m.clone(d,i.center),i.radius=u,i};var bCe=new m;an.expand=function(t,n,i){i=an.clone(t,i);let o=m.magnitude(m.subtract(n,i.center,bCe));return o>i.radius&&(i.radius=o),i};an.intersectPlane=function(t,n){let i=t.center,o=t.radius,r=n.normal,s=m.dot(r,i)+n.distance;return s<-o?jt.OUTSIDE:s<o?jt.INTERSECTING:jt.INSIDE};an.transform=function(t,n,i){return f(i)||(i=new an),i.center=N.multiplyByPoint(n,t.center,i.center),i.radius=N.getMaximumScale(n)*t.radius,i};var SCe=new m;an.distanceSquaredTo=function(t,n){let i=m.subtract(t.center,n,SCe),o=m.magnitude(i)-t.radius;return o<=0?0:o*o};an.transformWithoutScale=function(t,n,i){return f(i)||(i=new an),i.center=N.multiplyByPoint(n,t.center,i.center),i.radius=t.radius,i};var wCe=new m;an.computePlaneDistances=function(t,n,i,o){f(o)||(o=new Fc);let r=m.subtract(t.center,n,wCe),s=m.dot(i,r);return o.start=s-t.radius,o.stop=s+t.radius,o};var GY=new m,DCe=new m,vCe=new m,PCe=new m,ICe=new m,BCe=new de,WY=new Array(8);for(let t=0;t<8;++t)WY[t]=new m;var OCe=new Ci;an.projectTo2D=function(t,n,i){n=A(n,OCe);let o=n.ellipsoid,r=t.center,s=t.radius,a;m.equals(r,m.ZERO)?a=m.clone(m.UNIT_X,GY):a=o.geodeticSurfaceNormal(r,GY);let c=m.cross(m.UNIT_Z,a,DCe);m.normalize(c,c);let l=m.cross(a,c,vCe);m.normalize(l,l),m.multiplyByScalar(a,s,a),m.multiplyByScalar(l,s,l),m.multiplyByScalar(c,s,c);let u=m.negate(l,ICe),d=m.negate(c,PCe),h=WY,_=h[0];m.add(a,l,_),m.add(_,c,_),_=h[1],m.add(a,l,_),m.add(_,d,_),_=h[2],m.add(a,u,_),m.add(_,d,_),_=h[3],m.add(a,u,_),m.add(_,c,_),m.negate(a,a),_=h[4],m.add(a,l,_),m.add(_,c,_),_=h[5],m.add(a,l,_),m.add(_,d,_),_=h[6],m.add(a,u,_),m.add(_,d,_),_=h[7],m.add(a,u,_),m.add(_,c,_);let y=h.length;for(let T=0;T<y;++T){let E=h[T];m.add(r,E,E);let S=o.cartesianToCartographic(E,BCe);n.project(S,E)}i=an.fromPoints(h,i),r=i.center;let p=r.x,C=r.y,x=r.z;return r.x=x,r.y=p,r.z=C,i};an.isOccluded=function(t,n){return!n.isBoundingSphereVisible(t)};an.equals=function(t,n){return t===n||f(t)&&f(n)&&m.equals(t.center,n.center)&&t.radius===n.radius};an.prototype.intersectPlane=function(t){return an.intersectPlane(this,t)};an.prototype.distanceSquaredTo=function(t){return an.distanceSquaredTo(this,t)};an.prototype.computePlaneDistances=function(t,n,i){return an.computePlaneDistances(this,t,n,i)};an.prototype.isOccluded=function(t){return an.isOccluded(this,t)};an.prototype.equals=function(t){return an.equals(this,t)};an.prototype.clone=function(t){return an.clone(this,t)};an.prototype.volume=function(){let t=this.radius;return fCe*t*t*t};var ae=an;var RCe={DEPTH_BUFFER_BIT:256,STENCIL_BUFFER_BIT:1024,COLOR_BUFFER_BIT:16384,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA_SATURATE:776,FUNC_ADD:32774,BLEND_EQUATION:32777,BLEND_EQUATION_RGB:32777,BLEND_EQUATION_ALPHA:34877,FUNC_SUBTRACT:32778,FUNC_REVERSE_SUBTRACT:32779,BLEND_DST_RGB:32968,BLEND_SRC_RGB:32969,BLEND_DST_ALPHA:32970,BLEND_SRC_ALPHA:32971,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,BLEND_COLOR:32773,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,ARRAY_BUFFER_BINDING:34964,ELEMENT_ARRAY_BUFFER_BINDING:34965,STREAM_DRAW:35040,STATIC_DRAW:35044,DYNAMIC_DRAW:35048,BUFFER_SIZE:34660,BUFFER_USAGE:34661,CURRENT_VERTEX_ATTRIB:34342,FRONT:1028,BACK:1029,FRONT_AND_BACK:1032,CULL_FACE:2884,BLEND:3042,DITHER:3024,STENCIL_TEST:2960,DEPTH_TEST:2929,SCISSOR_TEST:3089,POLYGON_OFFSET_FILL:32823,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_COVERAGE:32928,NO_ERROR:0,INVALID_ENUM:1280,INVALID_VALUE:1281,INVALID_OPERATION:1282,OUT_OF_MEMORY:1285,CW:2304,CCW:2305,LINE_WIDTH:2849,ALIASED_POINT_SIZE_RANGE:33901,ALIASED_LINE_WIDTH_RANGE:33902,CULL_FACE_MODE:2885,FRONT_FACE:2886,DEPTH_RANGE:2928,DEPTH_WRITEMASK:2930,DEPTH_CLEAR_VALUE:2931,DEPTH_FUNC:2932,STENCIL_CLEAR_VALUE:2961,STENCIL_FUNC:2962,STENCIL_FAIL:2964,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STENCIL_BACK_FUNC:34816,STENCIL_BACK_FAIL:34817,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,VIEWPORT:2978,SCISSOR_BOX:3088,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,UNPACK_ALIGNMENT:3317,PACK_ALIGNMENT:3333,MAX_TEXTURE_SIZE:3379,MAX_VIEWPORT_DIMS:3386,SUBPIXEL_BITS:3408,RED_BITS:3410,GREEN_BITS:3411,BLUE_BITS:3412,ALPHA_BITS:3413,DEPTH_BITS:3414,STENCIL_BITS:3415,POLYGON_OFFSET_UNITS:10752,POLYGON_OFFSET_FACTOR:32824,TEXTURE_BINDING_2D:32873,SAMPLE_BUFFERS:32936,SAMPLES:32937,SAMPLE_COVERAGE_VALUE:32938,SAMPLE_COVERAGE_INVERT:32939,COMPRESSED_TEXTURE_FORMATS:34467,DONT_CARE:4352,FASTEST:4353,NICEST:4354,GENERATE_MIPMAP_HINT:33170,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DEPTH_COMPONENT:6402,ALPHA:6406,RGB:6407,RGBA:6408,LUMINANCE:6409,LUMINANCE_ALPHA:6410,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,FRAGMENT_SHADER:35632,VERTEX_SHADER:35633,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VARYING_VECTORS:36348,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_FRAGMENT_UNIFORM_VECTORS:36349,SHADER_TYPE:35663,DELETE_STATUS:35712,LINK_STATUS:35714,VALIDATE_STATUS:35715,ATTACHED_SHADERS:35717,ACTIVE_UNIFORMS:35718,ACTIVE_ATTRIBUTES:35721,SHADING_LANGUAGE_VERSION:35724,CURRENT_PROGRAM:35725,NEVER:512,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,NOTEQUAL:517,GEQUAL:518,ALWAYS:519,KEEP:7680,REPLACE:7681,INCR:7682,DECR:7683,INVERT:5386,INCR_WRAP:34055,DECR_WRAP:34056,VENDOR:7936,RENDERER:7937,VERSION:7938,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TEXTURE_2D:3553,TEXTURE:5890,TEXTURE_CUBE_MAP:34067,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,MAX_CUBE_MAP_TEXTURE_SIZE:34076,TEXTURE0:33984,TEXTURE1:33985,TEXTURE2:33986,TEXTURE3:33987,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE30:34014,TEXTURE31:34015,ACTIVE_TEXTURE:34016,REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,IMPLEMENTATION_COLOR_READ_TYPE:35738,IMPLEMENTATION_COLOR_READ_FORMAT:35739,COMPILE_STATUS:35713,LOW_FLOAT:36336,MEDIUM_FLOAT:36337,HIGH_FLOAT:36338,LOW_INT:36339,MEDIUM_INT:36340,HIGH_INT:36341,FRAMEBUFFER:36160,RENDERBUFFER:36161,RGBA4:32854,RGB5_A1:32855,RGB565:36194,DEPTH_COMPONENT16:33189,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,DEPTH_STENCIL:34041,RENDERBUFFER_WIDTH:36162,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_STENCIL_SIZE:36181,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,COLOR_ATTACHMENT0:36064,DEPTH_ATTACHMENT:36096,STENCIL_ATTACHMENT:36128,DEPTH_STENCIL_ATTACHMENT:33306,NONE:0,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_UNSUPPORTED:36061,FRAMEBUFFER_BINDING:36006,RENDERBUFFER_BINDING:36007,MAX_RENDERBUFFER_SIZE:34024,INVALID_FRAMEBUFFER_OPERATION:1286,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,CONTEXT_LOST_WEBGL:37442,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,BROWSER_DEFAULT_WEBGL:37444,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGBA_ASTC_4x4_WEBGL:37808,COMPRESSED_RGB_ETC1_WEBGL:36196,COMPRESSED_RGBA_BPTC_UNORM:36492,HALF_FLOAT_OES:36193,DOUBLE:5130,READ_BUFFER:3074,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_ROWS:3315,UNPACK_SKIP_PIXELS:3316,PACK_ROW_LENGTH:3330,PACK_SKIP_ROWS:3331,PACK_SKIP_PIXELS:3332,COLOR:6144,DEPTH:6145,STENCIL:6146,RED:6403,RGB8:32849,RGBA8:32856,RGB10_A2:32857,TEXTURE_BINDING_3D:32874,UNPACK_SKIP_IMAGES:32877,UNPACK_IMAGE_HEIGHT:32878,TEXTURE_3D:32879,TEXTURE_WRAP_R:32882,MAX_3D_TEXTURE_SIZE:32883,UNSIGNED_INT_2_10_10_10_REV:33640,MAX_ELEMENTS_VERTICES:33e3,MAX_ELEMENTS_INDICES:33001,TEXTURE_MIN_LOD:33082,TEXTURE_MAX_LOD:33083,TEXTURE_BASE_LEVEL:33084,TEXTURE_MAX_LEVEL:33085,MIN:32775,MAX:32776,DEPTH_COMPONENT24:33190,MAX_TEXTURE_LOD_BIAS:34045,TEXTURE_COMPARE_MODE:34892,TEXTURE_COMPARE_FUNC:34893,CURRENT_QUERY:34917,QUERY_RESULT:34918,QUERY_RESULT_AVAILABLE:34919,STREAM_READ:35041,STREAM_COPY:35042,STATIC_READ:35045,STATIC_COPY:35046,DYNAMIC_READ:35049,DYNAMIC_COPY:35050,MAX_DRAW_BUFFERS:34852,DRAW_BUFFER0:34853,DRAW_BUFFER1:34854,DRAW_BUFFER2:34855,DRAW_BUFFER3:34856,DRAW_BUFFER4:34857,DRAW_BUFFER5:34858,DRAW_BUFFER6:34859,DRAW_BUFFER7:34860,DRAW_BUFFER8:34861,DRAW_BUFFER9:34862,DRAW_BUFFER10:34863,DRAW_BUFFER11:34864,DRAW_BUFFER12:34865,DRAW_BUFFER13:34866,DRAW_BUFFER14:34867,DRAW_BUFFER15:34868,MAX_FRAGMENT_UNIFORM_COMPONENTS:35657,MAX_VERTEX_UNIFORM_COMPONENTS:35658,SAMPLER_3D:35679,SAMPLER_2D_SHADOW:35682,FRAGMENT_SHADER_DERIVATIVE_HINT:35723,PIXEL_PACK_BUFFER:35051,PIXEL_UNPACK_BUFFER:35052,PIXEL_PACK_BUFFER_BINDING:35053,PIXEL_UNPACK_BUFFER_BINDING:35055,FLOAT_MAT2x3:35685,FLOAT_MAT2x4:35686,FLOAT_MAT3x2:35687,FLOAT_MAT3x4:35688,FLOAT_MAT4x2:35689,FLOAT_MAT4x3:35690,SRGB:35904,SRGB8:35905,SRGB8_ALPHA8:35907,COMPARE_REF_TO_TEXTURE:34894,RGBA32F:34836,RGB32F:34837,RGBA16F:34842,RGB16F:34843,VERTEX_ATTRIB_ARRAY_INTEGER:35069,MAX_ARRAY_TEXTURE_LAYERS:35071,MIN_PROGRAM_TEXEL_OFFSET:35076,MAX_PROGRAM_TEXEL_OFFSET:35077,MAX_VARYING_COMPONENTS:35659,TEXTURE_2D_ARRAY:35866,TEXTURE_BINDING_2D_ARRAY:35869,R11F_G11F_B10F:35898,UNSIGNED_INT_10F_11F_11F_REV:35899,RGB9_E5:35901,UNSIGNED_INT_5_9_9_9_REV:35902,TRANSFORM_FEEDBACK_BUFFER_MODE:35967,MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS:35968,TRANSFORM_FEEDBACK_VARYINGS:35971,TRANSFORM_FEEDBACK_BUFFER_START:35972,TRANSFORM_FEEDBACK_BUFFER_SIZE:35973,TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN:35976,RASTERIZER_DISCARD:35977,MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS:35978,MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS:35979,INTERLEAVED_ATTRIBS:35980,SEPARATE_ATTRIBS:35981,TRANSFORM_FEEDBACK_BUFFER:35982,TRANSFORM_FEEDBACK_BUFFER_BINDING:35983,RGBA32UI:36208,RGB32UI:36209,RGBA16UI:36214,RGB16UI:36215,RGBA8UI:36220,RGB8UI:36221,RGBA32I:36226,RGB32I:36227,RGBA16I:36232,RGB16I:36233,RGBA8I:36238,RGB8I:36239,RED_INTEGER:36244,RGB_INTEGER:36248,RGBA_INTEGER:36249,SAMPLER_2D_ARRAY:36289,SAMPLER_2D_ARRAY_SHADOW:36292,SAMPLER_CUBE_SHADOW:36293,UNSIGNED_INT_VEC2:36294,UNSIGNED_INT_VEC3:36295,UNSIGNED_INT_VEC4:36296,INT_SAMPLER_2D:36298,INT_SAMPLER_3D:36299,INT_SAMPLER_CUBE:36300,INT_SAMPLER_2D_ARRAY:36303,UNSIGNED_INT_SAMPLER_2D:36306,UNSIGNED_INT_SAMPLER_3D:36307,UNSIGNED_INT_SAMPLER_CUBE:36308,UNSIGNED_INT_SAMPLER_2D_ARRAY:36311,DEPTH_COMPONENT32F:36012,DEPTH32F_STENCIL8:36013,FLOAT_32_UNSIGNED_INT_24_8_REV:36269,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE:33297,FRAMEBUFFER_ATTACHMENT_RED_SIZE:33298,FRAMEBUFFER_ATTACHMENT_GREEN_SIZE:33299,FRAMEBUFFER_ATTACHMENT_BLUE_SIZE:33300,FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE:33301,FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE:33302,FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE:33303,FRAMEBUFFER_DEFAULT:33304,UNSIGNED_INT_24_8:34042,DEPTH24_STENCIL8:35056,UNSIGNED_NORMALIZED:35863,DRAW_FRAMEBUFFER_BINDING:36006,READ_FRAMEBUFFER:36008,DRAW_FRAMEBUFFER:36009,READ_FRAMEBUFFER_BINDING:36010,RENDERBUFFER_SAMPLES:36011,FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER:36052,MAX_COLOR_ATTACHMENTS:36063,COLOR_ATTACHMENT1:36065,COLOR_ATTACHMENT2:36066,COLOR_ATTACHMENT3:36067,COLOR_ATTACHMENT4:36068,COLOR_ATTACHMENT5:36069,COLOR_ATTACHMENT6:36070,COLOR_ATTACHMENT7:36071,COLOR_ATTACHMENT8:36072,COLOR_ATTACHMENT9:36073,COLOR_ATTACHMENT10:36074,COLOR_ATTACHMENT11:36075,COLOR_ATTACHMENT12:36076,COLOR_ATTACHMENT13:36077,COLOR_ATTACHMENT14:36078,COLOR_ATTACHMENT15:36079,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:36182,MAX_SAMPLES:36183,HALF_FLOAT:5131,RG:33319,RG_INTEGER:33320,R8:33321,RG8:33323,R16F:33325,R32F:33326,RG16F:33327,RG32F:33328,R8I:33329,R8UI:33330,R16I:33331,R16UI:33332,R32I:33333,R32UI:33334,RG8I:33335,RG8UI:33336,RG16I:33337,RG16UI:33338,RG32I:33339,RG32UI:33340,VERTEX_ARRAY_BINDING:34229,R8_SNORM:36756,RG8_SNORM:36757,RGB8_SNORM:36758,RGBA8_SNORM:36759,SIGNED_NORMALIZED:36764,COPY_READ_BUFFER:36662,COPY_WRITE_BUFFER:36663,COPY_READ_BUFFER_BINDING:36662,COPY_WRITE_BUFFER_BINDING:36663,UNIFORM_BUFFER:35345,UNIFORM_BUFFER_BINDING:35368,UNIFORM_BUFFER_START:35369,UNIFORM_BUFFER_SIZE:35370,MAX_VERTEX_UNIFORM_BLOCKS:35371,MAX_FRAGMENT_UNIFORM_BLOCKS:35373,MAX_COMBINED_UNIFORM_BLOCKS:35374,MAX_UNIFORM_BUFFER_BINDINGS:35375,MAX_UNIFORM_BLOCK_SIZE:35376,MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS:35377,MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS:35379,UNIFORM_BUFFER_OFFSET_ALIGNMENT:35380,ACTIVE_UNIFORM_BLOCKS:35382,UNIFORM_TYPE:35383,UNIFORM_SIZE:35384,UNIFORM_BLOCK_INDEX:35386,UNIFORM_OFFSET:35387,UNIFORM_ARRAY_STRIDE:35388,UNIFORM_MATRIX_STRIDE:35389,UNIFORM_IS_ROW_MAJOR:35390,UNIFORM_BLOCK_BINDING:35391,UNIFORM_BLOCK_DATA_SIZE:35392,UNIFORM_BLOCK_ACTIVE_UNIFORMS:35394,UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES:35395,UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER:35396,UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER:35398,INVALID_INDEX:4294967295,MAX_VERTEX_OUTPUT_COMPONENTS:37154,MAX_FRAGMENT_INPUT_COMPONENTS:37157,MAX_SERVER_WAIT_TIMEOUT:37137,OBJECT_TYPE:37138,SYNC_CONDITION:37139,SYNC_STATUS:37140,SYNC_FLAGS:37141,SYNC_FENCE:37142,SYNC_GPU_COMMANDS_COMPLETE:37143,UNSIGNALED:37144,SIGNALED:37145,ALREADY_SIGNALED:37146,TIMEOUT_EXPIRED:37147,CONDITION_SATISFIED:37148,WAIT_FAILED:37149,SYNC_FLUSH_COMMANDS_BIT:1,VERTEX_ATTRIB_ARRAY_DIVISOR:35070,ANY_SAMPLES_PASSED:35887,ANY_SAMPLES_PASSED_CONSERVATIVE:36202,SAMPLER_BINDING:35097,RGB10_A2UI:36975,INT_2_10_10_10_REV:36255,TRANSFORM_FEEDBACK:36386,TRANSFORM_FEEDBACK_PAUSED:36387,TRANSFORM_FEEDBACK_ACTIVE:36388,TRANSFORM_FEEDBACK_BINDING:36389,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_SRGB8_ETC2:37493,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37494,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37495,COMPRESSED_RGBA8_ETC2_EAC:37496,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37497,TEXTURE_IMMUTABLE_FORMAT:37167,MAX_ELEMENT_INDEX:36203,TEXTURE_IMMUTABLE_LEVELS:33503,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047},ee=Object.freeze(RCe);var Cn={BYTE:ee.BYTE,UNSIGNED_BYTE:ee.UNSIGNED_BYTE,SHORT:ee.SHORT,UNSIGNED_SHORT:ee.UNSIGNED_SHORT,INT:ee.INT,UNSIGNED_INT:ee.UNSIGNED_INT,FLOAT:ee.FLOAT,DOUBLE:ee.DOUBLE};Cn.getSizeInBytes=function(t){switch(t){case Cn.BYTE:return Int8Array.BYTES_PER_ELEMENT;case Cn.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case Cn.SHORT:return Int16Array.BYTES_PER_ELEMENT;case Cn.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case Cn.INT:return Int32Array.BYTES_PER_ELEMENT;case Cn.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case Cn.FLOAT:return Float32Array.BYTES_PER_ELEMENT;case Cn.DOUBLE:return Float64Array.BYTES_PER_ELEMENT}};Cn.fromTypedArray=function(t){if(t instanceof Int8Array)return Cn.BYTE;if(t instanceof Uint8Array)return Cn.UNSIGNED_BYTE;if(t instanceof Int16Array)return Cn.SHORT;if(t instanceof Uint16Array)return Cn.UNSIGNED_SHORT;if(t instanceof Int32Array)return Cn.INT;if(t instanceof Uint32Array)return Cn.UNSIGNED_INT;if(t instanceof Float32Array)return Cn.FLOAT;if(t instanceof Float64Array)return Cn.DOUBLE};Cn.validate=function(t){return f(t)&&(t===Cn.BYTE||t===Cn.UNSIGNED_BYTE||t===Cn.SHORT||t===Cn.UNSIGNED_SHORT||t===Cn.INT||t===Cn.UNSIGNED_INT||t===Cn.FLOAT||t===Cn.DOUBLE)};Cn.createTypedArray=function(t,n){switch(t){case Cn.BYTE:return new Int8Array(n);case Cn.UNSIGNED_BYTE:return new Uint8Array(n);case Cn.SHORT:return new Int16Array(n);case Cn.UNSIGNED_SHORT:return new Uint16Array(n);case Cn.INT:return new Int32Array(n);case Cn.UNSIGNED_INT:return new Uint32Array(n);case Cn.FLOAT:return new Float32Array(n);case Cn.DOUBLE:return new Float64Array(n)}};Cn.createArrayBufferView=function(t,n,i,o){switch(i=A(i,0),o=A(o,(n.byteLength-i)/Cn.getSizeInBytes(t)),t){case Cn.BYTE:return new Int8Array(n,i,o);case Cn.UNSIGNED_BYTE:return new Uint8Array(n,i,o);case Cn.SHORT:return new Int16Array(n,i,o);case Cn.UNSIGNED_SHORT:return new Uint16Array(n,i,o);case Cn.INT:return new Int32Array(n,i,o);case Cn.UNSIGNED_INT:return new Uint32Array(n,i,o);case Cn.FLOAT:return new Float32Array(n,i,o);case Cn.DOUBLE:return new Float64Array(n,i,o)}};Cn.fromName=function(t){switch(t){case"BYTE":return Cn.BYTE;case"UNSIGNED_BYTE":return Cn.UNSIGNED_BYTE;case"SHORT":return Cn.SHORT;case"UNSIGNED_SHORT":return Cn.UNSIGNED_SHORT;case"INT":return Cn.INT;case"UNSIGNED_INT":return Cn.UNSIGNED_INT;case"FLOAT":return Cn.FLOAT;case"DOUBLE":return Cn.DOUBLE}};var J=Object.freeze(Cn);var MCe={NONE:0,TRIANGLES:1,LINES:2,POLYLINES:3},yf=Object.freeze(MCe);function Gt(t,n,i,o){this[0]=A(t,0),this[1]=A(i,0),this[2]=A(n,0),this[3]=A(o,0)}Gt.packedLength=4;Gt.pack=function(t,n,i){return i=A(i,0),n[i++]=t[0],n[i++]=t[1],n[i++]=t[2],n[i++]=t[3],n};Gt.unpack=function(t,n,i){return n=A(n,0),f(i)||(i=new Gt),i[0]=t[n++],i[1]=t[n++],i[2]=t[n++],i[3]=t[n++],i};Gt.packArray=function(t,n){let i=t.length,o=i*4;f(n)?!Array.isArray(n)&&n.length!==o||n.length!==o&&(n.length=o):n=new Array(o);for(let r=0;r<i;++r)Gt.pack(t[r],n,r*4);return n};Gt.unpackArray=function(t,n){let i=t.length;f(n)?n.length=i/4:n=new Array(i/4);for(let o=0;o<i;o+=4){let r=o/4;n[r]=Gt.unpack(t,o,n[r])}return n};Gt.clone=function(t,n){if(!!f(t))return f(n)?(n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n):new Gt(t[0],t[2],t[1],t[3])};Gt.fromArray=Gt.unpack;Gt.fromColumnMajorArray=function(t,n){return Gt.clone(t,n)};Gt.fromRowMajorArray=function(t,n){return f(n)?(n[0]=t[0],n[1]=t[2],n[2]=t[1],n[3]=t[3],n):new Gt(t[0],t[1],t[2],t[3])};Gt.fromScale=function(t,n){return f(n)?(n[0]=t.x,n[1]=0,n[2]=0,n[3]=t.y,n):new Gt(t.x,0,0,t.y)};Gt.fromUniformScale=function(t,n){return f(n)?(n[0]=t,n[1]=0,n[2]=0,n[3]=t,n):new Gt(t,0,0,t)};Gt.fromRotation=function(t,n){let i=Math.cos(t),o=Math.sin(t);return f(n)?(n[0]=i,n[1]=o,n[2]=-o,n[3]=i,n):new Gt(i,-o,o,i)};Gt.toArray=function(t,n){return f(n)?(n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n):[t[0],t[1],t[2],t[3]]};Gt.getElementIndex=function(t,n){return t*2+n};Gt.getColumn=function(t,n,i){let o=n*2,r=t[o],s=t[o+1];return i.x=r,i.y=s,i};Gt.setColumn=function(t,n,i,o){o=Gt.clone(t,o);let r=n*2;return o[r]=i.x,o[r+1]=i.y,o};Gt.getRow=function(t,n,i){let o=t[n],r=t[n+2];return i.x=o,i.y=r,i};Gt.setRow=function(t,n,i,o){return o=Gt.clone(t,o),o[n]=i.x,o[n+2]=i.y,o};var LCe=new W;Gt.setScale=function(t,n,i){let o=Gt.getScale(t,LCe),r=n.x/o.x,s=n.y/o.y;return i[0]=t[0]*r,i[1]=t[1]*r,i[2]=t[2]*s,i[3]=t[3]*s,i};var FCe=new W;Gt.setUniformScale=function(t,n,i){let o=Gt.getScale(t,FCe),r=n/o.x,s=n/o.y;return i[0]=t[0]*r,i[1]=t[1]*r,i[2]=t[2]*s,i[3]=t[3]*s,i};var jY=new W;Gt.getScale=function(t,n){return n.x=W.magnitude(W.fromElements(t[0],t[1],jY)),n.y=W.magnitude(W.fromElements(t[2],t[3],jY)),n};var qY=new W;Gt.getMaximumScale=function(t){return Gt.getScale(t,qY),W.maximumComponent(qY)};var NCe=new W;Gt.setRotation=function(t,n,i){let o=Gt.getScale(t,NCe);return i[0]=n[0]*o.x,i[1]=n[1]*o.x,i[2]=n[2]*o.y,i[3]=n[3]*o.y,i};var VCe=new W;Gt.getRotation=function(t,n){let i=Gt.getScale(t,VCe);return n[0]=t[0]/i.x,n[1]=t[1]/i.x,n[2]=t[2]/i.y,n[3]=t[3]/i.y,n};Gt.multiply=function(t,n,i){let o=t[0]*n[0]+t[2]*n[1],r=t[0]*n[2]+t[2]*n[3],s=t[1]*n[0]+t[3]*n[1],a=t[1]*n[2]+t[3]*n[3];return i[0]=o,i[1]=s,i[2]=r,i[3]=a,i};Gt.add=function(t,n,i){return i[0]=t[0]+n[0],i[1]=t[1]+n[1],i[2]=t[2]+n[2],i[3]=t[3]+n[3],i};Gt.subtract=function(t,n,i){return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],i[3]=t[3]-n[3],i};Gt.multiplyByVector=function(t,n,i){let o=t[0]*n.x+t[2]*n.y,r=t[1]*n.x+t[3]*n.y;return i.x=o,i.y=r,i};Gt.multiplyByScalar=function(t,n,i){return i[0]=t[0]*n,i[1]=t[1]*n,i[2]=t[2]*n,i[3]=t[3]*n,i};Gt.multiplyByScale=function(t,n,i){return i[0]=t[0]*n.x,i[1]=t[1]*n.x,i[2]=t[2]*n.y,i[3]=t[3]*n.y,i};Gt.multiplyByUniformScale=function(t,n,i){return i[0]=t[0]*n,i[1]=t[1]*n,i[2]=t[2]*n,i[3]=t[3]*n,i};Gt.negate=function(t,n){return n[0]=-t[0],n[1]=-t[1],n[2]=-t[2],n[3]=-t[3],n};Gt.transpose=function(t,n){let i=t[0],o=t[2],r=t[1],s=t[3];return n[0]=i,n[1]=o,n[2]=r,n[3]=s,n};Gt.abs=function(t,n){return n[0]=Math.abs(t[0]),n[1]=Math.abs(t[1]),n[2]=Math.abs(t[2]),n[3]=Math.abs(t[3]),n};Gt.equals=function(t,n){return t===n||f(t)&&f(n)&&t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]};Gt.equalsArray=function(t,n,i){return t[0]===n[i]&&t[1]===n[i+1]&&t[2]===n[i+2]&&t[3]===n[i+3]};Gt.equalsEpsilon=function(t,n,i){return i=A(i,0),t===n||f(t)&&f(n)&&Math.abs(t[0]-n[0])<=i&&Math.abs(t[1]-n[1])<=i&&Math.abs(t[2]-n[2])<=i&&Math.abs(t[3]-n[3])<=i};Gt.IDENTITY=Object.freeze(new Gt(1,0,0,1));Gt.ZERO=Object.freeze(new Gt(0,0,0,0));Gt.COLUMN0ROW0=0;Gt.COLUMN0ROW1=1;Gt.COLUMN1ROW0=2;Gt.COLUMN1ROW1=3;Object.defineProperties(Gt.prototype,{length:{get:function(){return Gt.packedLength}}});Gt.prototype.clone=function(t){return Gt.clone(this,t)};Gt.prototype.equals=function(t){return Gt.equals(this,t)};Gt.prototype.equalsEpsilon=function(t,n){return Gt.equalsEpsilon(this,t,n)};Gt.prototype.toString=function(){return`(${this[0]}, ${this[2]})
(${this[1]}, ${this[3]})`};var Ji=Gt;var Js={POINTS:ee.POINTS,LINES:ee.LINES,LINE_LOOP:ee.LINE_LOOP,LINE_STRIP:ee.LINE_STRIP,TRIANGLES:ee.TRIANGLES,TRIANGLE_STRIP:ee.TRIANGLE_STRIP,TRIANGLE_FAN:ee.TRIANGLE_FAN};Js.isLines=function(t){return t===Js.LINES||t===Js.LINE_LOOP||t===Js.LINE_STRIP};Js.isTriangles=function(t){return t===Js.TRIANGLES||t===Js.TRIANGLE_STRIP||t===Js.TRIANGLE_FAN};Js.validate=function(t){return t===Js.POINTS||t===Js.LINES||t===Js.LINE_LOOP||t===Js.LINE_STRIP||t===Js.TRIANGLES||t===Js.TRIANGLE_STRIP||t===Js.TRIANGLE_FAN};var Re=Object.freeze(Js);function $e(t,n,i,o){this.x=A(t,0),this.y=A(n,0),this.z=A(i,0),this.w=A(o,0)}var xb=new m;$e.fromAxisAngle=function(t,n,i){let o=n/2,r=Math.sin(o);xb=m.normalize(t,xb);let s=xb.x*r,a=xb.y*r,c=xb.z*r,l=Math.cos(o);return f(i)?(i.x=s,i.y=a,i.z=c,i.w=l,i):new $e(s,a,c,l)};var kCe=[1,2,0],UCe=new Array(3);$e.fromRotationMatrix=function(t,n){let i,o,r,s,a,c=t[$.COLUMN0ROW0],l=t[$.COLUMN1ROW1],u=t[$.COLUMN2ROW2],d=c+l+u;if(d>0)i=Math.sqrt(d+1),a=.5*i,i=.5/i,o=(t[$.COLUMN1ROW2]-t[$.COLUMN2ROW1])*i,r=(t[$.COLUMN2ROW0]-t[$.COLUMN0ROW2])*i,s=(t[$.COLUMN0ROW1]-t[$.COLUMN1ROW0])*i;else{let h=kCe,_=0;l>c&&(_=1),u>c&&u>l&&(_=2);let y=h[_],p=h[y];i=Math.sqrt(t[$.getElementIndex(_,_)]-t[$.getElementIndex(y,y)]-t[$.getElementIndex(p,p)]+1);let C=UCe;C[_]=.5*i,i=.5/i,a=(t[$.getElementIndex(p,y)]-t[$.getElementIndex(y,p)])*i,C[y]=(t[$.getElementIndex(y,_)]+t[$.getElementIndex(_,y)])*i,C[p]=(t[$.getElementIndex(p,_)]+t[$.getElementIndex(_,p)])*i,o=-C[0],r=-C[1],s=-C[2]}return f(n)?(n.x=o,n.y=r,n.z=s,n.w=a,n):new $e(o,r,s,a)};var YY=new $e,XY=new $e,bH=new $e,KY=new $e;$e.fromHeadingPitchRoll=function(t,n){return KY=$e.fromAxisAngle(m.UNIT_X,t.roll,YY),bH=$e.fromAxisAngle(m.UNIT_Y,-t.pitch,n),n=$e.multiply(bH,KY,bH),XY=$e.fromAxisAngle(m.UNIT_Z,-t.heading,YY),$e.multiply(XY,n,n)};var BP=new m,SH=new m,Af=new $e,JY=new $e,OP=new $e;$e.packedLength=4;$e.pack=function(t,n,i){return i=A(i,0),n[i++]=t.x,n[i++]=t.y,n[i++]=t.z,n[i]=t.w,n};$e.unpack=function(t,n,i){return n=A(n,0),f(i)||(i=new $e),i.x=t[n],i.y=t[n+1],i.z=t[n+2],i.w=t[n+3],i};$e.packedInterpolationLength=3;$e.convertPackedArrayForInterpolation=function(t,n,i,o){$e.unpack(t,i*4,OP),$e.conjugate(OP,OP);for(let r=0,s=i-n+1;r<s;r++){let a=r*3;$e.unpack(t,(n+r)*4,Af),$e.multiply(Af,OP,Af),Af.w<0&&$e.negate(Af,Af),$e.computeAxis(Af,BP);let c=$e.computeAngle(Af);f(o)||(o=[]),o[a]=BP.x*c,o[a+1]=BP.y*c,o[a+2]=BP.z*c}};$e.unpackInterpolationResult=function(t,n,i,o,r){f(r)||(r=new $e),m.fromArray(t,0,SH);let s=m.magnitude(SH);return $e.unpack(n,o*4,JY),s===0?$e.clone($e.IDENTITY,Af):$e.fromAxisAngle(SH,s,Af),$e.multiply(Af,JY,r)};$e.clone=function(t,n){if(!!f(t))return f(n)?(n.x=t.x,n.y=t.y,n.z=t.z,n.w=t.w,n):new $e(t.x,t.y,t.z,t.w)};$e.conjugate=function(t,n){return n.x=-t.x,n.y=-t.y,n.z=-t.z,n.w=t.w,n};$e.magnitudeSquared=function(t){return t.x*t.x+t.y*t.y+t.z*t.z+t.w*t.w};$e.magnitude=function(t){return Math.sqrt($e.magnitudeSquared(t))};$e.normalize=function(t,n){let i=1/$e.magnitude(t),o=t.x*i,r=t.y*i,s=t.z*i,a=t.w*i;return n.x=o,n.y=r,n.z=s,n.w=a,n};$e.inverse=function(t,n){let i=$e.magnitudeSquared(t);return n=$e.conjugate(t,n),$e.multiplyByScalar(n,1/i,n)};$e.add=function(t,n,i){return i.x=t.x+n.x,i.y=t.y+n.y,i.z=t.z+n.z,i.w=t.w+n.w,i};$e.subtract=function(t,n,i){return i.x=t.x-n.x,i.y=t.y-n.y,i.z=t.z-n.z,i.w=t.w-n.w,i};$e.negate=function(t,n){return n.x=-t.x,n.y=-t.y,n.z=-t.z,n.w=-t.w,n};$e.dot=function(t,n){return t.x*n.x+t.y*n.y+t.z*n.z+t.w*n.w};$e.multiply=function(t,n,i){let o=t.x,r=t.y,s=t.z,a=t.w,c=n.x,l=n.y,u=n.z,d=n.w,h=a*c+o*d+r*u-s*l,_=a*l-o*u+r*d+s*c,y=a*u+o*l-r*c+s*d,p=a*d-o*c-r*l-s*u;return i.x=h,i.y=_,i.z=y,i.w=p,i};$e.multiplyByScalar=function(t,n,i){return i.x=t.x*n,i.y=t.y*n,i.z=t.z*n,i.w=t.w*n,i};$e.divideByScalar=function(t,n,i){return i.x=t.x/n,i.y=t.y/n,i.z=t.z/n,i.w=t.w/n,i};$e.computeAxis=function(t,n){let i=t.w;if(Math.abs(i-1)<B.EPSILON6)return n.x=n.y=n.z=0,n;let o=1/Math.sqrt(1-i*i);return n.x=t.x*o,n.y=t.y*o,n.z=t.z*o,n};$e.computeAngle=function(t){return Math.abs(t.w-1)<B.EPSILON6?0:2*Math.acos(t.w)};var wH=new $e;$e.lerp=function(t,n,i,o){return wH=$e.multiplyByScalar(n,i,wH),o=$e.multiplyByScalar(t,1-i,o),$e.add(wH,o,o)};var ZY=new $e,DH=new $e,vH=new $e;$e.slerp=function(t,n,i,o){let r=$e.dot(t,n),s=n;if(r<0&&(r=-r,s=ZY=$e.negate(n,ZY)),1-r<B.EPSILON6)return $e.lerp(t,s,i,o);let a=Math.acos(r);return DH=$e.multiplyByScalar(t,Math.sin((1-i)*a),DH),vH=$e.multiplyByScalar(s,Math.sin(i*a),vH),o=$e.add(DH,vH,o),$e.multiplyByScalar(o,1/Math.sin(a),o)};$e.log=function(t,n){let i=B.acosClamped(t.w),o=0;return i!==0&&(o=i/Math.sin(i)),m.multiplyByScalar(t,o,n)};$e.exp=function(t,n){let i=m.magnitude(t),o=0;return i!==0&&(o=Math.sin(i)/i),n.x=t.x*o,n.y=t.y*o,n.z=t.z*o,n.w=Math.cos(i),n};var zCe=new m,HCe=new m,Tb=new $e,$A=new $e;$e.computeInnerQuadrangle=function(t,n,i,o){let r=$e.conjugate(n,Tb);$e.multiply(r,i,$A);let s=$e.log($A,zCe);$e.multiply(r,t,$A);let a=$e.log($A,HCe);return m.add(s,a,s),m.multiplyByScalar(s,.25,s),m.negate(s,s),$e.exp(s,Tb),$e.multiply(n,Tb,o)};$e.squad=function(t,n,i,o,r,s){let a=$e.slerp(t,n,r,Tb),c=$e.slerp(i,o,r,$A);return $e.slerp(a,c,2*r*(1-r),s)};var GCe=new $e,QY=1.9011074535173003,RP=Vt.supportsTypedArrays()?new Float32Array(8):[],MP=Vt.supportsTypedArrays()?new Float32Array(8):[],im=Vt.supportsTypedArrays()?new Float32Array(8):[],om=Vt.supportsTypedArrays()?new Float32Array(8):[];for(let t=0;t<7;++t){let n=t+1,i=2*n+1;RP[t]=1/(n*i),MP[t]=n/i}RP[7]=QY/(8*17);MP[7]=QY*8/17;$e.fastSlerp=function(t,n,i,o){let r=$e.dot(t,n),s;r>=0?s=1:(s=-1,r=-r);let a=r-1,c=1-i,l=i*i,u=c*c;for(let y=7;y>=0;--y)im[y]=(RP[y]*l-MP[y])*a,om[y]=(RP[y]*u-MP[y])*a;let d=s*i*(1+im[0]*(1+im[1]*(1+im[2]*(1+im[3]*(1+im[4]*(1+im[5]*(1+im[6]*(1+im[7])))))))),h=c*(1+om[0]*(1+om[1]*(1+om[2]*(1+om[3]*(1+om[4]*(1+om[5]*(1+om[6]*(1+om[7])))))))),_=$e.multiplyByScalar(t,h,GCe);return $e.multiplyByScalar(n,d,o),$e.add(_,o,o)};$e.fastSquad=function(t,n,i,o,r,s){let a=$e.fastSlerp(t,n,r,Tb),c=$e.fastSlerp(i,o,r,$A);return $e.fastSlerp(a,c,2*r*(1-r),s)};$e.equals=function(t,n){return t===n||f(t)&&f(n)&&t.x===n.x&&t.y===n.y&&t.z===n.z&&t.w===n.w};$e.equalsEpsilon=function(t,n,i){return i=A(i,0),t===n||f(t)&&f(n)&&Math.abs(t.x-n.x)<=i&&Math.abs(t.y-n.y)<=i&&Math.abs(t.z-n.z)<=i&&Math.abs(t.w-n.w)<=i};$e.ZERO=Object.freeze(new $e(0,0,0,0));$e.IDENTITY=Object.freeze(new $e(0,0,0,1));$e.prototype.clone=function(t){return $e.clone(this,t)};$e.prototype.equals=function(t){return $e.equals(this,t)};$e.prototype.equalsEpsilon=function(t,n){return $e.equalsEpsilon(this,t,n)};$e.prototype.toString=function(){return`(${this.x}, ${this.y}, ${this.z}, ${this.w})`};var Me=$e;function WCe(t,n,i){let o=0,r=t.length-1,s,a;for(;o<=r;){if(s=~~((o+r)/2),a=i(t[s],n),a<0){o=s+1;continue}if(a>0){r=s-1;continue}return s}return~(r+1)}var jo=WCe;function jCe(t,n,i,o,r){this.xPoleWander=t,this.yPoleWander=n,this.xPoleOffset=i,this.yPoleOffset=o,this.ut1MinusUtc=r}var m0=jCe;function qCe(t,n,i,o,r,s,a,c){this.year=t,this.month=n,this.day=i,this.hour=o,this.minute=r,this.second=s,this.millisecond=a,this.isLeapSecond=c}var Op=qCe;function YCe(t){return t%4===0&&t%100!==0||t%400===0}var Rp=YCe;function XCe(t,n){this.julianDate=t,this.offset=n}var Mi=XCe;var KCe={SECONDS_PER_MILLISECOND:.001,SECONDS_PER_MINUTE:60,MINUTES_PER_HOUR:60,HOURS_PER_DAY:24,SECONDS_PER_HOUR:3600,MINUTES_PER_DAY:1440,SECONDS_PER_DAY:86400,DAYS_PER_JULIAN_CENTURY:36525,PICOSECOND:1e-9,MODIFIED_JULIAN_DATE_DIFFERENCE:24000005e-1},Yn=Object.freeze(KCe);var JCe={UTC:0,TAI:1},jn=Object.freeze(JCe);var eX=new Op,PH=[31,28,31,30,31,30,31,31,30,31,30,31],IH=29;function BH(t,n){return Et.compare(t.julianDate,n.julianDate)}var eC=new Mi;function FP(t){eC.julianDate=t;let n=Et.leapSeconds,i=jo(n,eC,BH);i<0&&(i=~i),i>=n.length&&(i=n.length-1);let o=n[i].offset;i>0&&Et.secondsDifference(n[i].julianDate,t)>o&&(i--,o=n[i].offset),Et.addSeconds(t,o,t)}function $Y(t,n){eC.julianDate=t;let i=Et.leapSeconds,o=jo(i,eC,BH);if(o<0&&(o=~o),o===0)return Et.addSeconds(t,-i[0].offset,n);if(o>=i.length)return Et.addSeconds(t,-i[o-1].offset,n);let r=Et.secondsDifference(i[o].julianDate,t);if(r===0)return Et.addSeconds(t,-i[o].offset,n);if(!(r<=1))return Et.addSeconds(t,-i[--o].offset,n)}function Mp(t,n,i){let o=n/Yn.SECONDS_PER_DAY|0;return t+=o,n-=Yn.SECONDS_PER_DAY*o,n<0&&(t--,n+=Yn.SECONDS_PER_DAY),i.dayNumber=t,i.secondsOfDay=n,i}function OH(t,n,i,o,r,s,a){let c=(n-14)/12|0,l=t+4800+c,u=(1461*l/4|0)+(367*(n-2-12*c)/12|0)-(3*((l+100)/100|0)/4|0)+i-32075;o=o-12,o<0&&(o+=24);let d=s+(o*Yn.SECONDS_PER_HOUR+r*Yn.SECONDS_PER_MINUTE+a*Yn.SECONDS_PER_MILLISECOND);return d>=43200&&(u-=1),[u,d]}var ZCe=/^(\d{4})$/,QCe=/^(\d{4})-(\d{2})$/,$Ce=/^(\d{4})-?(\d{3})$/,exe=/^(\d{4})-?W(\d{2})-?(\d{1})?$/,txe=/^(\d{4})-?(\d{2})-?(\d{2})$/,RH=/([Z+\-])?(\d{2})?:?(\d{2})?$/,nxe=/^(\d{2})(\.\d+)?/.source+RH.source,ixe=/^(\d{2}):?(\d{2})(\.\d+)?/.source+RH.source,oxe=/^(\d{2}):?(\d{2}):?(\d{2})(\.\d+)?/.source+RH.source;function Et(t,n,i){this.dayNumber=void 0,this.secondsOfDay=void 0,t=A(t,0),n=A(n,0),i=A(i,jn.UTC);let o=t|0;n=n+(t-o)*Yn.SECONDS_PER_DAY,Mp(o,n,this),i===jn.UTC&&FP(this)}Et.fromGregorianDate=function(t,n){let i=OH(t.year,t.month,t.day,t.hour,t.minute,t.second,t.millisecond);return f(n)?(Mp(i[0],i[1],n),FP(n),n):new Et(i[0],i[1],jn.UTC)};Et.fromDate=function(t,n){let i=OH(t.getUTCFullYear(),t.getUTCMonth()+1,t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),t.getUTCMilliseconds());return f(n)?(Mp(i[0],i[1],n),FP(n),n):new Et(i[0],i[1],jn.UTC)};Et.fromIso8601=function(t,n){t=t.replace(",",".");let i=t.split("T"),o,r=1,s=1,a=0,c=0,l=0,u=0,d=i[0],h=i[1],_,y;if(i=d.match(txe),i!==null)o=+i[1],r=+i[2],s=+i[3];else if(i=d.match(QCe),i!==null)o=+i[1],r=+i[2];else if(i=d.match(ZCe),i!==null)o=+i[1];else{let T;if(i=d.match($Ce),i!==null)o=+i[1],T=+i[2],y=Rp(o);else if(i=d.match(exe),i!==null){o=+i[1];let E=+i[2],S=+i[3]||0,w=new Date(Date.UTC(o,0,4));T=E*7+S-w.getUTCDay()-3}_=new Date(Date.UTC(o,0,1)),_.setUTCDate(T),r=_.getUTCMonth()+1,s=_.getUTCDate()}y=Rp(o);let p;if(f(h)){i=h.match(oxe),i!==null?(a=+i[1],c=+i[2],l=+i[3],u=+(i[4]||0)*1e3,p=5):(i=h.match(ixe),i!==null?(a=+i[1],c=+i[2],l=+(i[3]||0)*60,p=4):(i=h.match(nxe),i!==null&&(a=+i[1],c=+(i[2]||0)*60,p=3)));let T=i[p],E=+i[p+1],S=+(i[p+2]||0);switch(T){case"+":a=a-E,c=c-S;break;case"-":a=a+E,c=c+S;break;case"Z":break;default:c=c+new Date(Date.UTC(o,r-1,s,a,c)).getTimezoneOffset();break}}let C=l===60;for(C&&l--;c>=60;)c-=60,a++;for(;a>=24;)a-=24,s++;for(_=y&&r===2?IH:PH[r-1];s>_;)s-=_,r++,r>12&&(r-=12,o++),_=y&&r===2?IH:PH[r-1];for(;c<0;)c+=60,a--;for(;a<0;)a+=24,s--;for(;s<1;)r--,r<1&&(r+=12,o--),_=y&&r===2?IH:PH[r-1],s+=_;let x=OH(o,r,s,a,c,l,u);return f(n)?(Mp(x[0],x[1],n),FP(n)):n=new Et(x[0],x[1],jn.UTC),C&&Et.addSeconds(n,1,n),n};Et.now=function(t){return Et.fromDate(new Date,t)};var LP=new Et(0,0,jn.TAI);Et.toGregorianDate=function(t,n){let i=!1,o=$Y(t,LP);f(o)||(Et.addSeconds(t,-1,LP),o=$Y(LP,LP),i=!0);let r=o.dayNumber,s=o.secondsOfDay;s>=43200&&(r+=1);let a=r+68569|0,c=4*a/146097|0;a=a-((146097*c+3)/4|0)|0;let l=4e3*(a+1)/1461001|0;a=a-(1461*l/4|0)+31|0;let u=80*a/2447|0,d=a-(2447*u/80|0)|0;a=u/11|0;let h=u+2-12*a|0,_=100*(c-49)+l+a|0,y=s/Yn.SECONDS_PER_HOUR|0,p=s-y*Yn.SECONDS_PER_HOUR,C=p/Yn.SECONDS_PER_MINUTE|0;p=p-C*Yn.SECONDS_PER_MINUTE;let x=p|0,T=(p-x)/Yn.SECONDS_PER_MILLISECOND;return y+=12,y>23&&(y-=24),i&&(x+=1),f(n)?(n.year=_,n.month=h,n.day=d,n.hour=y,n.minute=C,n.second=x,n.millisecond=T,n.isLeapSecond=i,n):new Op(_,h,d,y,C,x,T,i)};Et.toDate=function(t){let n=Et.toGregorianDate(t,eX),i=n.second;return n.isLeapSecond&&(i-=1),new Date(Date.UTC(n.year,n.month-1,n.day,n.hour,n.minute,i,n.millisecond))};Et.toIso8601=function(t,n){let i=Et.toGregorianDate(t,eX),o=i.year,r=i.month,s=i.day,a=i.hour,c=i.minute,l=i.second,u=i.millisecond;o===1e4&&r===1&&s===1&&a===0&&c===0&&l===0&&u===0&&(o=9999,r=12,s=31,a=24);let d;return!f(n)&&u!==0?(d=(u*.01).toString().replace(".",""),`${o.toString().padStart(4,"0")}-${r.toString().padStart(2,"0")}-${s.toString().padStart(2,"0")}T${a.toString().padStart(2,"0")}:${c.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}.${d}Z`):!f(n)||n===0?`${o.toString().padStart(4,"0")}-${r.toString().padStart(2,"0")}-${s.toString().padStart(2,"0")}T${a.toString().padStart(2,"0")}:${c.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}Z`:(d=(u*.01).toFixed(n).replace(".","").slice(0,n),`${o.toString().padStart(4,"0")}-${r.toString().padStart(2,"0")}-${s.toString().padStart(2,"0")}T${a.toString().padStart(2,"0")}:${c.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}.${d}Z`)};Et.clone=function(t,n){if(!!f(t))return f(n)?(n.dayNumber=t.dayNumber,n.secondsOfDay=t.secondsOfDay,n):new Et(t.dayNumber,t.secondsOfDay,jn.TAI)};Et.compare=function(t,n){let i=t.dayNumber-n.dayNumber;return i!==0?i:t.secondsOfDay-n.secondsOfDay};Et.equals=function(t,n){return t===n||f(t)&&f(n)&&t.dayNumber===n.dayNumber&&t.secondsOfDay===n.secondsOfDay};Et.equalsEpsilon=function(t,n,i){return i=A(i,0),t===n||f(t)&&f(n)&&Math.abs(Et.secondsDifference(t,n))<=i};Et.totalDays=function(t){return t.dayNumber+t.secondsOfDay/Yn.SECONDS_PER_DAY};Et.secondsDifference=function(t,n){return(t.dayNumber-n.dayNumber)*Yn.SECONDS_PER_DAY+(t.secondsOfDay-n.secondsOfDay)};Et.daysDifference=function(t,n){let i=t.dayNumber-n.dayNumber,o=(t.secondsOfDay-n.secondsOfDay)/Yn.SECONDS_PER_DAY;return i+o};Et.computeTaiMinusUtc=function(t){eC.julianDate=t;let n=Et.leapSeconds,i=jo(n,eC,BH);return i<0&&(i=~i,--i,i<0&&(i=0)),n[i].offset};Et.addSeconds=function(t,n,i){return Mp(t.dayNumber,t.secondsOfDay+n,i)};Et.addMinutes=function(t,n,i){let o=t.secondsOfDay+n*Yn.SECONDS_PER_MINUTE;return Mp(t.dayNumber,o,i)};Et.addHours=function(t,n,i){let o=t.secondsOfDay+n*Yn.SECONDS_PER_HOUR;return Mp(t.dayNumber,o,i)};Et.addDays=function(t,n,i){let o=t.dayNumber+n;return Mp(o,t.secondsOfDay,i)};Et.lessThan=function(t,n){return Et.compare(t,n)<0};Et.lessThanOrEquals=function(t,n){return Et.compare(t,n)<=0};Et.greaterThan=function(t,n){return Et.compare(t,n)>0};Et.greaterThanOrEquals=function(t,n){return Et.compare(t,n)>=0};Et.prototype.clone=function(t){return Et.clone(this,t)};Et.prototype.equals=function(t){return Et.equals(this,t)};Et.prototype.equalsEpsilon=function(t,n){return Et.equalsEpsilon(this,t,n)};Et.prototype.toString=function(){return Et.toIso8601(this)};Et.leapSeconds=[new Mi(new Et(2441317,43210,jn.TAI),10),new Mi(new Et(2441499,43211,jn.TAI),11),new Mi(new Et(2441683,43212,jn.TAI),12),new Mi(new Et(2442048,43213,jn.TAI),13),new Mi(new Et(2442413,43214,jn.TAI),14),new Mi(new Et(2442778,43215,jn.TAI),15),new Mi(new Et(2443144,43216,jn.TAI),16),new Mi(new Et(2443509,43217,jn.TAI),17),new Mi(new Et(2443874,43218,jn.TAI),18),new Mi(new Et(2444239,43219,jn.TAI),19),new Mi(new Et(2444786,43220,jn.TAI),20),new Mi(new Et(2445151,43221,jn.TAI),21),new Mi(new Et(2445516,43222,jn.TAI),22),new Mi(new Et(2446247,43223,jn.TAI),23),new Mi(new Et(2447161,43224,jn.TAI),24),new Mi(new Et(2447892,43225,jn.TAI),25),new Mi(new Et(2448257,43226,jn.TAI),26),new Mi(new Et(2448804,43227,jn.TAI),27),new Mi(new Et(2449169,43228,jn.TAI),28),new Mi(new Et(2449534,43229,jn.TAI),29),new Mi(new Et(2450083,43230,jn.TAI),30),new Mi(new Et(2450630,43231,jn.TAI),31),new Mi(new Et(2451179,43232,jn.TAI),32),new Mi(new Et(2453736,43233,jn.TAI),33),new Mi(new Et(2454832,43234,jn.TAI),34),new Mi(new Et(2456109,43235,jn.TAI),35),new Mi(new Et(2457204,43236,jn.TAI),36),new Mi(new Et(2457754,43237,jn.TAI),37)];var te=Et;var fC=yo(gl(),1);function rxe(t){return(t.length===0||t[t.length-1]!=="/")&&(t=`${t}/`),t}var UP=rxe;function aX(t,n){if(t===null||typeof t!="object")return t;n=A(n,!1);let i=new t.constructor;for(let o in t)if(t.hasOwnProperty(o)){let r=t[o];n&&(r=aX(r,n)),i[o]=r}return i}var tt=aX;function cX(t,n,i){i=A(i,!1);let o={},r=f(t),s=f(n),a,c,l;if(r)for(a in t)t.hasOwnProperty(a)&&(c=t[a],s&&i&&typeof c=="object"&&n.hasOwnProperty(a)?(l=n[a],typeof l=="object"?o[a]=cX(c,l,i):o[a]=c):o[a]=c);if(s)for(a in n)n.hasOwnProperty(a)&&!o.hasOwnProperty(a)&&(l=n[a],o[a]=l);return o}var At=cX;function sxe(){let t,n,i=new Promise(function(o,r){t=o,n=r});return{resolve:t,reject:n,promise:i}}var Zr=sxe;var lX=yo(gl(),1);function MH(t,n){let i;return typeof document!="undefined"&&(i=document),MH._implementation(t,n,i)}MH._implementation=function(t,n,i){if(!f(n)){if(typeof i=="undefined")return t;n=A(i.baseURI,i.location.href)}let o=new lX.default(t);return o.scheme()!==""?o.toString():o.absoluteTo(n).toString()};var Lp=MH;var uX=yo(gl(),1);function axe(t,n){let i="",o=t.lastIndexOf("/");return o!==-1&&(i=t.substring(0,o+1)),n&&(t=new uX.default(t),t.query().length!==0&&(i+=`?${t.query()}`),t.fragment().length!==0&&(i+=`#${t.fragment()}`)),i}var zP=axe;var fX=yo(gl(),1);function cxe(t){let n=new fX.default(t);n.normalize();let i=n.path(),o=i.lastIndexOf("/");return o!==-1&&(i=i.substr(o+1)),o=i.lastIndexOf("."),o===-1?i="":i=i.substr(o+1),i}var iC=cxe;var dX={};function lxe(t,n,i){f(n)||(n=t.width),f(i)||(i=t.height);let o=dX[n];f(o)||(o={},dX[n]=o);let r=o[i];if(!f(r)){let s=document.createElement("canvas");s.width=n,s.height=i,r=s.getContext("2d"),r.globalCompositeOperation="copy",o[i]=r}return r.drawImage(t,0,0,n,i),r.getImageData(0,0,n,i).data}var Id=lxe;var uxe=/^blob:/i;function fxe(t){return uxe.test(t)}var oC=fxe;var Bd;function dxe(t){f(Bd)||(Bd=document.createElement("a")),Bd.href=window.location.href;let n=Bd.host,i=Bd.protocol;return Bd.href=t,Bd.href=Bd.href,i!==Bd.protocol||n!==Bd.host}var rC=dxe;var hxe=/^data:/i;function mxe(t){return hxe.test(t)}var Fp=mxe;function pxe(t){let n=document.createElement("script");return n.async=!0,n.src=t,new Promise((i,o)=>{window.crossOriginIsolated&&n.setAttribute("crossorigin","anonymous");let r=document.getElementsByTagName("head")[0];n.onload=function(){n.onload=void 0,r.removeChild(n),i()},n.onerror=function(s){o(s)},r.appendChild(n)})}var sC=pxe;function _xe(t){let n="";for(let i in t)if(t.hasOwnProperty(i)){let o=t[i],r=`${encodeURIComponent(i)}=`;if(Array.isArray(o))for(let s=0,a=o.length;s<a;++s)n+=`${r+encodeURIComponent(o[s])}&`;else n+=`${r+encodeURIComponent(o)}&`}return n=n.slice(0,-1),n}var aC=_xe;function gxe(t){let n={};if(t==="")return n;let i=t.replace(/\+/g,"%20").split(/[&;]/);for(let o=0,r=i.length;o<r;++o){let s=i[o].split("="),a=decodeURIComponent(s[0]),c=s[1];f(c)?c=decodeURIComponent(c):c="";let l=n[a];typeof l=="string"?n[a]=[l,c]:Array.isArray(l)?l.push(c):n[a]=c}return n}var cu=gxe;var yxe={UNISSUED:0,ISSUED:1,ACTIVE:2,RECEIVED:3,CANCELLED:4,FAILED:5},ai=Object.freeze(yxe);var Axe={TERRAIN:0,IMAGERY:1,TILES3D:2,OTHER:3},Qr=Object.freeze(Axe);function HP(t){t=A(t,A.EMPTY_OBJECT);let n=A(t.throttleByServer,!1),i=A(t.throttle,!1);this.url=t.url,this.requestFunction=t.requestFunction,this.cancelFunction=t.cancelFunction,this.priorityFunction=t.priorityFunction,this.priority=A(t.priority,0),this.throttle=i,this.throttleByServer=n,this.type=A(t.type,Qr.OTHER),this.serverKey=void 0,this.state=ai.UNISSUED,this.deferred=void 0,this.cancelled=!1}HP.prototype.cancel=function(){this.cancelled=!0};HP.prototype.clone=function(t){return f(t)?(t.url=this.url,t.requestFunction=this.requestFunction,t.cancelFunction=this.cancelFunction,t.priorityFunction=this.priorityFunction,t.priority=this.priority,t.throttle=this.throttle,t.throttleByServer=this.throttleByServer,t.type=this.type,t.serverKey=this.serverKey,t.state=this.RequestState.UNISSUED,t.deferred=void 0,t.cancelled=!1,t):new HP(this)};var qo=HP;function Cxe(t){let n={};if(!t)return n;let i=t.split(`\r
`);for(let o=0;o<i.length;++o){let r=i[o],s=r.indexOf(": ");if(s>0){let a=r.substring(0,s),c=r.substring(s+2);n[a]=c}}return n}var GP=Cxe;function hX(t,n,i){this.statusCode=t,this.response=n,this.responseHeaders=i,typeof this.responseHeaders=="string"&&(this.responseHeaders=GP(this.responseHeaders))}hX.prototype.toString=function(){let t="Request has failed.";return f(this.statusCode)&&(t+=` Status Code: ${this.statusCode}`),t};var rm=hX;var Eb=yo(gl(),1);function p0(t){this._comparator=t.comparator,this._array=[],this._length=0,this._maximumLength=void 0}Object.defineProperties(p0.prototype,{length:{get:function(){return this._length}},internalArray:{get:function(){return this._array}},maximumLength:{get:function(){return this._maximumLength},set:function(t){let n=this._length;if(t<n){let i=this._array;for(let o=t;o<n;++o)i[o]=void 0;this._length=t,i.length=t}this._maximumLength=t}},comparator:{get:function(){return this._comparator}}});function LH(t,n,i){let o=t[n];t[n]=t[i],t[i]=o}p0.prototype.reserve=function(t){t=A(t,this._length),this._array.length=t};p0.prototype.heapify=function(t){t=A(t,0);let n=this._length,i=this._comparator,o=this._array,r=-1,s=!0;for(;s;){let a=2*(t+1),c=a-1;c<n&&i(o[c],o[t])<0?r=c:r=t,a<n&&i(o[a],o[r])<0&&(r=a),r!==t?(LH(o,r,t),t=r):s=!1}};p0.prototype.resort=function(){let t=this._length;for(let n=Math.ceil(t/2);n>=0;--n)this.heapify(n)};p0.prototype.insert=function(t){let n=this._array,i=this._comparator,o=this._maximumLength,r=this._length++;for(r<n.length?n[r]=t:n.push(t);r!==0;){let a=Math.floor((r-1)/2);if(i(n[r],n[a])<0)LH(n,r,a),r=a;else break}let s;return f(o)&&this._length>o&&(s=n[o],this._length=o),s};p0.prototype.pop=function(t){if(t=A(t,0),this._length===0)return;let n=this._array,i=n[t];return LH(n,t,--this._length),this.heapify(t),n[this._length]=void 0,i};var WP=p0;function xxe(t,n){return t.priority-n.priority}var Hi={numberOfAttemptedRequests:0,numberOfActiveRequests:0,numberOfCancelledRequests:0,numberOfCancelledActiveRequests:0,numberOfFailedRequests:0,numberOfActiveRequestsEver:0,lastNumberOfActiveRequests:0},cC=20,ga=new WP({comparator:xxe});ga.maximumLength=cC;ga.reserve(cC);var Od=[],sm={},Txe=typeof document!="undefined"?new Eb.default(document.location.href):new Eb.default,jP=new Ae;function Oo(){}Oo.maximumRequests=50;Oo.maximumRequestsPerServer=6;Oo.requestsByServer={"api.cesium.com:443":18,"assets.cesium.com:443":18};Oo.throttleRequests=!0;Oo.debugShowStatistics=!1;Oo.requestCompletedEvent=jP;Object.defineProperties(Oo,{statistics:{get:function(){return Hi}},priorityHeapLength:{get:function(){return cC},set:function(t){if(t<cC)for(;ga.length>t;){let n=ga.pop();_0(n)}cC=t,ga.maximumLength=t,ga.reserve(t)}}});function mX(t){f(t.priorityFunction)&&(t.priority=t.priorityFunction())}Oo.serverHasOpenSlots=function(t,n){n=A(n,1);let i=A(Oo.requestsByServer[t],Oo.maximumRequestsPerServer);return sm[t]+n<=i};Oo.heapHasOpenSlots=function(t){return ga.length+t<=cC};function pX(t){return t.state===ai.UNISSUED&&(t.state=ai.ISSUED,t.deferred=Zr()),t.deferred.promise}function Exe(t){return function(n){if(t.state===ai.CANCELLED)return;let i=t.deferred;--Hi.numberOfActiveRequests,--sm[t.serverKey],jP.raiseEvent(),t.state=ai.RECEIVED,t.deferred=void 0,i.resolve(n)}}function bxe(t){return function(n){t.state!==ai.CANCELLED&&(++Hi.numberOfFailedRequests,--Hi.numberOfActiveRequests,--sm[t.serverKey],jP.raiseEvent(n),t.state=ai.FAILED,t.deferred.reject(n))}}function _X(t){let n=pX(t);return t.state=ai.ACTIVE,Od.push(t),++Hi.numberOfActiveRequests,++Hi.numberOfActiveRequestsEver,++sm[t.serverKey],t.requestFunction().then(Exe(t)).catch(bxe(t)),n}function _0(t){let n=t.state===ai.ACTIVE;if(t.state=ai.CANCELLED,++Hi.numberOfCancelledRequests,f(t.deferred)){let i=t.deferred;t.deferred=void 0,i.reject()}n&&(--Hi.numberOfActiveRequests,--sm[t.serverKey],++Hi.numberOfCancelledActiveRequests),f(t.cancelFunction)&&t.cancelFunction()}Oo.update=function(){let t,n,i=0,o=Od.length;for(t=0;t<o;++t){if(n=Od[t],n.cancelled&&_0(n),n.state!==ai.ACTIVE){++i;continue}i>0&&(Od[t-i]=n)}Od.length-=i;let r=ga.internalArray,s=ga.length;for(t=0;t<s;++t)mX(r[t]);ga.resort();let a=Math.max(Oo.maximumRequests-Od.length,0),c=0;for(;c<a&&ga.length>0;){if(n=ga.pop(),n.cancelled){_0(n);continue}if(n.throttleByServer&&!Oo.serverHasOpenSlots(n.serverKey)){_0(n);continue}_X(n),++c}Sxe()};Oo.getServerKey=function(t){let n=new Eb.default(t);n.scheme()===""&&(n=new Eb.default(t).absoluteTo(Txe),n.normalize());let i=n.authority();/:/.test(i)||(i=`${i}:${n.scheme()==="https"?"443":"80"}`);let o=sm[i];return f(o)||(sm[i]=0),i};Oo.request=function(t){if(Fp(t.url)||oC(t.url))return jP.raiseEvent(),t.state=ai.RECEIVED,t.requestFunction();if(++Hi.numberOfAttemptedRequests,f(t.serverKey)||(t.serverKey=Oo.getServerKey(t.url)),Oo.throttleRequests&&t.throttleByServer&&!Oo.serverHasOpenSlots(t.serverKey))return;if(!Oo.throttleRequests||!t.throttle)return _X(t);if(Od.length>=Oo.maximumRequests)return;mX(t);let n=ga.insert(t);if(f(n)){if(n===t)return;_0(n)}return pX(t)};function Sxe(){!Oo.debugShowStatistics||(Hi.numberOfActiveRequests===0&&Hi.lastNumberOfActiveRequests>0&&(Hi.numberOfAttemptedRequests>0&&(console.log(`Number of attempted requests: ${Hi.numberOfAttemptedRequests}`),Hi.numberOfAttemptedRequests=0),Hi.numberOfCancelledRequests>0&&(console.log(`Number of cancelled requests: ${Hi.numberOfCancelledRequests}`),Hi.numberOfCancelledRequests=0),Hi.numberOfCancelledActiveRequests>0&&(console.log(`Number of cancelled active requests: ${Hi.numberOfCancelledActiveRequests}`),Hi.numberOfCancelledActiveRequests=0),Hi.numberOfFailedRequests>0&&(console.log(`Number of failed requests: ${Hi.numberOfFailedRequests}`),Hi.numberOfFailedRequests=0)),Hi.lastNumberOfActiveRequests=Hi.numberOfActiveRequests)}Oo.clearForSpecs=function(){for(;ga.length>0;){let n=ga.pop();_0(n)}let t=Od.length;for(let n=0;n<t;++n)_0(Od[n]);Od.length=0,sm={},Hi.numberOfAttemptedRequests=0,Hi.numberOfActiveRequests=0,Hi.numberOfCancelledRequests=0,Hi.numberOfCancelledActiveRequests=0,Hi.numberOfFailedRequests=0,Hi.numberOfActiveRequestsEver=0,Hi.lastNumberOfActiveRequests=0};Oo.numberOfActiveRequestsByServer=function(t){return sm[t]};Oo.requestHeap=ga;var ec=Oo;var gX=yo(gl(),1);var bb={},lC={};bb.add=function(t,n){let i=`${t.toLowerCase()}:${n}`;f(lC[i])||(lC[i]=!0)};bb.remove=function(t,n){let i=`${t.toLowerCase()}:${n}`;f(lC[i])&&delete lC[i]};function wxe(t){let n=new gX.default(t);n.normalize();let i=n.authority();if(i.length!==0){if(n.authority(i),i.indexOf("@")!==-1&&(i=i.split("@")[1]),i.indexOf(":")===-1){let o=n.scheme();if(o.length===0&&(o=window.location.protocol,o=o.substring(0,o.length-1)),o==="http")i+=":80";else if(o==="https")i+=":443";else return}return i}}bb.contains=function(t){let n=wxe(t);return!!(f(n)&&f(lC[n]))};bb.clear=function(){lC={}};var Sb=bb;var CX=function(){try{let t=new XMLHttpRequest;return t.open("GET","#",!0),t.responseType="blob",t.responseType==="blob"}catch(t){return!1}}();function NH(t,n,i,o){let r=t.query();if(r.length===0)return{};let s;if(r.indexOf("=")===-1){let a={};a[r]=void 0,s=a}else s=cu(r);i?n._queryParameters=YP(s,n._queryParameters,o):n._queryParameters=s,t.search("")}function Dxe(t,n){let i=n._queryParameters,o=Object.keys(i);o.length===1&&!f(i[o[0]])?t.search(o[0]):t.search(aC(i))}function Rd(t,n){return f(t)?f(t.clone)?t.clone():tt(t):n}function VH(t){if(t.state===ai.ISSUED||t.state===ai.ACTIVE)throw new he("The Resource is already being fetched.");t.state=ai.UNISSUED,t.deferred=void 0}function YP(t,n,i){if(!i)return At(t,n);let o=tt(t,!0);for(let r in n)if(n.hasOwnProperty(r)){let s=o[r],a=n[r];f(s)?(Array.isArray(s)||(s=o[r]=[s]),o[r]=s.concat(a)):o[r]=Array.isArray(a)?a.slice():a}return o}function bt(t){t=A(t,A.EMPTY_OBJECT),typeof t=="string"&&(t={url:t}),this._url=void 0,this._templateValues=Rd(t.templateValues,{}),this._queryParameters=Rd(t.queryParameters,{}),this.headers=Rd(t.headers,{}),this.request=A(t.request,new qo),this.proxy=t.proxy,this.retryCallback=t.retryCallback,this.retryAttempts=A(t.retryAttempts,0),this._retryCount=0;let n=new fC.default(t.url);NH(n,this,!0,!0),n.fragment(""),this._url=n.toString()}bt.createIfNeeded=function(t){return t instanceof bt?t.getDerivedResource({request:t.request}):typeof t!="string"?t:new bt({url:t})};var uC;bt.supportsImageBitmapOptions=function(){if(f(uC))return uC;if(typeof createImageBitmap!="function")return uC=Promise.resolve(!1),uC;let t="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAABGdBTUEAAE4g3rEiDgAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAADElEQVQI12Ng6GAAAAEUAIngE3ZiAAAAAElFTkSuQmCC";return uC=bt.fetchBlob({url:t}).then(function(n){let i={imageOrientation:"flipY",premultiplyAlpha:"none",colorSpaceConversion:"none"};return Promise.all([createImageBitmap(n,i),createImageBitmap(n)])}).then(function(n){let i=Id(n[0]),o=Id(n[1]);return i[1]!==o[1]}).catch(function(){return!1}),uC};Object.defineProperties(bt,{isBlobSupported:{get:function(){return CX}}});Object.defineProperties(bt.prototype,{queryParameters:{get:function(){return this._queryParameters}},templateValues:{get:function(){return this._templateValues}},url:{get:function(){return this.getUrlComponent(!0,!0)},set:function(t){let n=new fC.default(t);NH(n,this,!1),n.fragment(""),this._url=n.toString()}},extension:{get:function(){return iC(this._url)}},isDataUri:{get:function(){return Fp(this._url)}},isBlobUri:{get:function(){return oC(this._url)}},isCrossOriginUrl:{get:function(){return rC(this._url)}},hasHeaders:{get:function(){return Object.keys(this.headers).length>0}}});bt.prototype.toString=function(){return this.getUrlComponent(!0,!0)};bt.prototype.getUrlComponent=function(t,n){if(this.isDataUri)return this._url;let i=new fC.default(this._url);t&&Dxe(i,this);let o=i.toString().replace(/%7B/g,"{").replace(/%7D/g,"}"),r=this._templateValues;return o=o.replace(/{(.*?)}/g,function(s,a){let c=r[a];return f(c)?encodeURIComponent(c):s}),n&&f(this.proxy)&&(o=this.proxy.getURL(o)),o};bt.prototype.setQueryParameters=function(t,n){n?this._queryParameters=YP(this._queryParameters,t,!1):this._queryParameters=YP(t,this._queryParameters,!1)};bt.prototype.appendQueryParameters=function(t){this._queryParameters=YP(t,this._queryParameters,!0)};bt.prototype.setTemplateValues=function(t,n){n?this._templateValues=At(this._templateValues,t):this._templateValues=At(t,this._templateValues)};bt.prototype.getDerivedResource=function(t){let n=this.clone();if(n._retryCount=0,f(t.url)){let i=new fC.default(t.url),o=A(t.preserveQueryParameters,!1);if(NH(i,n,!0,o),i.fragment(""),i.scheme()!=="")n._url=i.toString();else if(n._url=i.absoluteTo(new fC.default(Lp(this._url))).toString(),t.urlDomains){let r=Math.floor(Math.random()*t.urlDomains.length),s=t.urlDomains[r],a=i.toString(),c=n._url.split(a)[0],l=decodeURI(c),u=t.urlDomains.filter(_=>l.indexOf(_)>-1),d=encodeURI(u[0]),h=c.split(d)[1];n._url=`${s}${h}${a}`}}return f(t.queryParameters)&&(n._queryParameters=At(t.queryParameters,n._queryParameters)),f(t.templateValues)&&(n._templateValues=At(t.templateValues,n.templateValues)),f(t.headers)&&(n.headers=At(t.headers,n.headers)),f(t.proxy)&&(n.proxy=t.proxy),f(t.request)&&(n.request=t.request),f(t.retryCallback)&&(n.retryCallback=t.retryCallback),f(t.retryAttempts)&&(n.retryAttempts=t.retryAttempts),n};bt.prototype.retryOnError=function(t){let n=this.retryCallback;if(typeof n!="function"||this._retryCount>=this.retryAttempts)return Promise.resolve(!1);let i=this;return Promise.resolve(n(this,t)).then(function(o){return++i._retryCount,o})};bt.prototype.clone=function(t){return f(t)||(t=new bt({url:this._url})),t._url=this._url,t._queryParameters=tt(this._queryParameters),t._templateValues=tt(this._templateValues),t.headers=tt(this.headers),t.proxy=this.proxy,t.retryCallback=this.retryCallback,t.retryAttempts=this.retryAttempts,t._retryCount=0,t.request=this.request.clone(),t};bt.prototype.getBaseUri=function(t){return zP(this.getUrlComponent(t),t)};bt.prototype.appendForwardSlash=function(){this._url=UP(this._url)};bt.prototype.fetchArrayBuffer=function(){return this.fetch({responseType:"arraybuffer"})};bt.fetchArrayBuffer=function(t){return new bt(t).fetchArrayBuffer()};bt.prototype.fetchBlob=function(){return this.fetch({responseType:"blob"})};bt.fetchBlob=function(t){return new bt(t).fetchBlob()};bt.prototype.fetchImage=function(t){t=A(t,A.EMPTY_OBJECT);let n=A(t.preferImageBitmap,!1),i=A(t.preferBlob,!1),o=A(t.flipY,!1),r=A(t.skipColorSpaceConversion,!1);if(VH(this.request),!CX||this.isDataUri||this.isBlobUri||!this.hasHeaders&&!i)return FH({resource:this,flipY:o,skipColorSpaceConversion:r,preferImageBitmap:n});let s=this.fetchBlob();if(!f(s))return;let a,c,l,u;return bt.supportsImageBitmapOptions().then(function(d){return a=d,c=a&&n,s}).then(function(d){if(!f(d))return;if(u=d,c)return bt.createImageBitmapFromBlob(d,{flipY:o,premultiplyAlpha:!1,skipColorSpaceConversion:r});let h=window.URL.createObjectURL(d);return l=new bt({url:h}),FH({resource:l,flipY:o,skipColorSpaceConversion:r,preferImageBitmap:!1})}).then(function(d){if(!!f(d))return d.blob=u,c||window.URL.revokeObjectURL(l.url),d}).catch(function(d){return f(l)&&window.URL.revokeObjectURL(l.url),d.blob=u,Promise.reject(d)})};function FH(t){let n=t.resource,i=t.flipY,o=t.skipColorSpaceConversion,r=t.preferImageBitmap,s=n.request;s.url=n.url,s.requestFunction=function(){let c=!1;!n.isDataUri&&!n.isBlobUri&&(c=n.isCrossOriginUrl);let l=Zr();return bt._Implementations.createImage(s,c,l,i,o,r),l.promise};let a=ec.request(s);if(!!f(a))return a.catch(function(c){return s.state!==ai.FAILED?Promise.reject(c):n.retryOnError(c).then(function(l){return l?(s.state=ai.UNISSUED,s.deferred=void 0,FH({resource:n,flipY:i,skipColorSpaceConversion:o,preferImageBitmap:r})):Promise.reject(c)})})}bt.fetchImage=function(t){return new bt(t).fetchImage({flipY:t.flipY,skipColorSpaceConversion:t.skipColorSpaceConversion,preferBlob:t.preferBlob,preferImageBitmap:t.preferImageBitmap})};bt.prototype.fetchText=function(){return this.fetch({responseType:"text"})};bt.fetchText=function(t){return new bt(t).fetchText()};bt.prototype.fetchJson=function(){let t=this.fetch({responseType:"text",headers:{Accept:"application/json,*/*;q=0.01"}});if(!!f(t))return t.then(function(n){if(!!f(n))return JSON.parse(n)})};bt.fetchJson=function(t){return new bt(t).fetchJson()};bt.prototype.fetchXML=function(){return this.fetch({responseType:"document",overrideMimeType:"text/xml"})};bt.fetchXML=function(t){return new bt(t).fetchXML()};bt.prototype.fetchJsonp=function(t){t=A(t,"callback"),VH(this.request);let n;do n=`loadJsonp${B.nextRandomNumber().toString().substring(2,8)}`;while(f(window[n]));return xX(this,t,n)};function xX(t,n,i){let o={};o[n]=i,t.setQueryParameters(o);let r=t.request;r.url=t.url,r.requestFunction=function(){let a=Zr();return window[i]=function(c){a.resolve(c);try{delete window[i]}catch(l){window[i]=void 0}},bt._Implementations.loadAndExecuteScript(t.url,i,a),a.promise};let s=ec.request(r);if(!!f(s))return s.catch(function(a){return r.state!==ai.FAILED?Promise.reject(a):t.retryOnError(a).then(function(c){return c?(r.state=ai.UNISSUED,r.deferred=void 0,xX(t,n,i)):Promise.reject(a)})})}bt.fetchJsonp=function(t){return new bt(t).fetchJsonp(t.callbackParameterName)};bt.prototype._makeRequest=function(t){let n=this;VH(n.request);let i=n.request;i.url=n.url,i.requestFunction=function(){let r=t.responseType,s=At(t.headers,n.headers),a=t.overrideMimeType,c=t.method,l=t.data,u=Zr(),d=bt._Implementations.loadWithXhr(n.url,r,c,l,s,u,a);return f(d)&&f(d.abort)&&(i.cancelFunction=function(){d.abort()}),u.promise};let o=ec.request(i);if(!!f(o))return o.then(function(r){return i.cancelFunction=void 0,r}).catch(function(r){return i.cancelFunction=void 0,i.state!==ai.FAILED?Promise.reject(r):n.retryOnError(r).then(function(s){return s?(i.state=ai.UNISSUED,i.deferred=void 0,n.fetch(t)):Promise.reject(r)})})};var vxe=/^data:(.*?)(;base64)?,(.*)$/;function qP(t,n){let i=decodeURIComponent(n);return t?atob(i):i}function yX(t,n){let i=qP(t,n),o=new ArrayBuffer(i.length),r=new Uint8Array(o);for(let s=0;s<i.length;s++)r[s]=i.charCodeAt(s);return o}function Pxe(t,n){n=A(n,"");let i=t[1],o=!!t[2],r=t[3],s,a;switch(n){case"":case"text":return qP(o,r);case"arraybuffer":return yX(o,r);case"blob":return s=yX(o,r),new Blob([s],{type:i});case"document":return a=new DOMParser,a.parseFromString(qP(o,r),i);case"json":return JSON.parse(qP(o,r));default:}}bt.prototype.fetch=function(t){return t=Rd(t,{}),t.method="GET",this._makeRequest(t)};bt.fetch=function(t){return new bt(t).fetch({responseType:t.responseType,overrideMimeType:t.overrideMimeType})};bt.prototype.delete=function(t){return t=Rd(t,{}),t.method="DELETE",this._makeRequest(t)};bt.delete=function(t){return new bt(t).delete({responseType:t.responseType,overrideMimeType:t.overrideMimeType,data:t.data})};bt.prototype.head=function(t){return t=Rd(t,{}),t.method="HEAD",this._makeRequest(t)};bt.head=function(t){return new bt(t).head({responseType:t.responseType,overrideMimeType:t.overrideMimeType})};bt.prototype.options=function(t){return t=Rd(t,{}),t.method="OPTIONS",this._makeRequest(t)};bt.options=function(t){return new bt(t).options({responseType:t.responseType,overrideMimeType:t.overrideMimeType})};bt.prototype.post=function(t,n){return Ki.defined("data",t),n=Rd(n,{}),n.method="POST",n.data=t,this._makeRequest(n)};bt.post=function(t){return new bt(t).post(t.data,{responseType:t.responseType,overrideMimeType:t.overrideMimeType})};bt.prototype.put=function(t,n){return Ki.defined("data",t),n=Rd(n,{}),n.method="PUT",n.data=t,this._makeRequest(n)};bt.put=function(t){return new bt(t).put(t.data,{responseType:t.responseType,overrideMimeType:t.overrideMimeType})};bt.prototype.patch=function(t,n){return Ki.defined("data",t),n=Rd(n,{}),n.method="PATCH",n.data=t,this._makeRequest(n)};bt.patch=function(t){return new bt(t).patch(t.data,{responseType:t.responseType,overrideMimeType:t.overrideMimeType})};bt._Implementations={};bt._Implementations.loadImageElement=function(t,n,i){let o=new Image;o.onload=function(){o.naturalWidth===0&&o.naturalHeight===0&&o.width===0&&o.height===0&&(o.width=300,o.height=150),i.resolve(o)},o.onerror=function(r){i.reject(r)},n&&(Sb.contains(t)?o.crossOrigin="use-credentials":o.crossOrigin=""),o.src=t};bt._Implementations.createImage=function(t,n,i,o,r,s){let a=t.url;bt.supportsImageBitmapOptions().then(function(c){if(!(c&&s)){bt._Implementations.loadImageElement(a,n,i);return}let l="blob",u="GET",d=Zr(),h=bt._Implementations.loadWithXhr(a,l,u,void 0,void 0,d,void 0,void 0,void 0);return f(h)&&f(h.abort)&&(t.cancelFunction=function(){h.abort()}),d.promise.then(function(_){if(!f(_)){i.reject(new he(`Successfully retrieved ${a} but it contained no content.`));return}return bt.createImageBitmapFromBlob(_,{flipY:o,premultiplyAlpha:!1,skipColorSpaceConversion:r})}).then(function(_){i.resolve(_)})}).catch(function(c){i.reject(c)})};bt.createImageBitmapFromBlob=function(t,n){return Ki.defined("options",n),Ki.typeOf.bool("options.flipY",n.flipY),Ki.typeOf.bool("options.premultiplyAlpha",n.premultiplyAlpha),Ki.typeOf.bool("options.skipColorSpaceConversion",n.skipColorSpaceConversion),createImageBitmap(t,{imageOrientation:n.flipY?"flipY":"none",premultiplyAlpha:n.premultiplyAlpha?"premultiply":"none",colorSpaceConversion:n.skipColorSpaceConversion?"none":"default"})};function AX(t,n){switch(n){case"text":return t.toString("utf8");case"json":return JSON.parse(t.toString("utf8"));default:return new Uint8Array(t).buffer}}function Ixe(t,n,i,o,r,s,a){let c,l;Promise.all([import("url"),import("zlib")]).then(([u,d])=>(c=u.parse(t),l=d,c.protocol==="https:"?import("https"):import("http"))).then(u=>{let d={protocol:c.protocol,hostname:c.hostname,port:c.port,path:c.path,query:c.query,method:i,headers:r};u.request(d).on("response",function(h){if(h.statusCode<200||h.statusCode>=300){s.reject(new rm(h.statusCode,h,h.headers));return}let _=[];h.on("data",function(y){_.push(y)}),h.on("end",function(){let y=Buffer.concat(_);h.headers["content-encoding"]==="gzip"?l.gunzip(y,function(p,C){p?s.reject(new he("Error decompressing response.")):s.resolve(AX(C,n))}):s.resolve(AX(y,n))})}).on("error",function(h){s.reject(new rm)}).end()})}var Bxe=typeof XMLHttpRequest=="undefined";bt._Implementations.loadWithXhr=function(t,n,i,o,r,s,a){let c=vxe.exec(t);if(c!==null){s.resolve(Pxe(c,n));return}if(Bxe){Ixe(t,n,i,o,r,s,a);return}let l=new XMLHttpRequest;if(Sb.contains(t)&&(l.withCredentials=!0),l.open(i,t,!0),f(a)&&f(l.overrideMimeType)&&l.overrideMimeType(a),f(r))for(let d in r)r.hasOwnProperty(d)&&l.setRequestHeader(d,r[d]);f(n)&&(l.responseType=n);let u=!1;return typeof t=="string"&&(u=t.indexOf("file://")===0||typeof window!="undefined"&&window.location.origin==="file://"),l.onload=function(){if((l.status<200||l.status>=300)&&!(u&&l.status===0)){s.reject(new rm(l.status,l.response,l.getAllResponseHeaders()));return}let d=l.response,h=l.responseType;if(i==="HEAD"||i==="OPTIONS"){let y=l.getAllResponseHeaders().trim().split(/[\r\n]+/),p={};y.forEach(function(C){let x=C.split(": "),T=x.shift();p[T]=x.join(": ")}),s.resolve(p);return}if(l.status===204)s.resolve();else if(f(d)&&(!f(n)||h===n))s.resolve(d);else if(n==="json"&&typeof d=="string")try{s.resolve(JSON.parse(d))}catch(_){s.reject(_)}else(h===""||h==="document")&&f(l.responseXML)&&l.responseXML.hasChildNodes()?s.resolve(l.responseXML):(h===""||h==="text")&&f(l.responseText)?s.resolve(l.responseText):s.reject(new he("Invalid XMLHttpRequest response type."))},l.onerror=function(d){s.reject(new rm)},l.send(o),l};bt._Implementations.loadAndExecuteScript=function(t,n,i){return sC(t,n).catch(function(o){i.reject(o)})};bt._DefaultImplementations={};bt._DefaultImplementations.createImage=bt._Implementations.createImage;bt._DefaultImplementations.loadWithXhr=bt._Implementations.loadWithXhr;bt._DefaultImplementations.loadAndExecuteScript=bt._Implementations.loadAndExecuteScript;bt.DEFAULT=Object.freeze(new bt({url:typeof document=="undefined"?"":document.location.href.split("?")[0]}));var Ie=bt;function XP(t){if(t=A(t,A.EMPTY_OBJECT),this._dates=void 0,this._samples=void 0,this._dateColumn=-1,this._xPoleWanderRadiansColumn=-1,this._yPoleWanderRadiansColumn=-1,this._ut1MinusUtcSecondsColumn=-1,this._xCelestialPoleOffsetRadiansColumn=-1,this._yCelestialPoleOffsetRadiansColumn=-1,this._taiMinusUtcSecondsColumn=-1,this._columnCount=0,this._lastIndex=-1,this._downloadPromise=void 0,this._dataError=void 0,this._addNewLeapSeconds=A(t.addNewLeapSeconds,!0),f(t.data))kH(this,t.data);else if(f(t.url)){let n=Ie.createIfNeeded(t.url),i=this;this._downloadPromise=n.fetchJson().then(function(o){kH(i,o)}).catch(function(){i._dataError=`An error occurred while retrieving the EOP data from the URL ${n.url}.`})}else kH(this,{columnNames:["dateIso8601","modifiedJulianDateUtc","xPoleWanderRadians","yPoleWanderRadians","ut1MinusUtcSeconds","lengthOfDayCorrectionSeconds","xCelestialPoleOffsetRadians","yCelestialPoleOffsetRadians","taiMinusUtcSeconds"],samples:[]})}XP.NONE=Object.freeze({getPromiseToLoad:function(){return Promise.resolve()},compute:function(t,n){return f(n)?(n.xPoleWander=0,n.yPoleWander=0,n.xPoleOffset=0,n.yPoleOffset=0,n.ut1MinusUtc=0):n=new m0(0,0,0,0,0),n}});XP.prototype.getPromiseToLoad=function(){return Promise.resolve(this._downloadPromise)};XP.prototype.compute=function(t,n){if(!f(this._samples)){if(f(this._dataError))throw new he(this._dataError);return}if(f(n)||(n=new m0(0,0,0,0,0)),this._samples.length===0)return n.xPoleWander=0,n.yPoleWander=0,n.xPoleOffset=0,n.yPoleOffset=0,n.ut1MinusUtc=0,n;let i=this._dates,o=this._lastIndex,r=0,s=0;if(f(o)){let c=i[o],l=i[o+1],u=te.lessThanOrEquals(c,t),d=!f(l),h=d||te.greaterThanOrEquals(l,t);if(u&&h)return r=o,!d&&l.equals(t)&&++r,s=r+1,EX(this,i,this._samples,t,r,s,n),n}let a=jo(i,t,te.compare,this._dateColumn);return a>=0?(a<i.length-1&&i[a+1].equals(t)&&++a,r=a,s=a):(s=~a,r=s-1,r<0&&(r=0)),this._lastIndex=r,EX(this,i,this._samples,t,r,s,n),n};function Oxe(t,n){return te.compare(t.julianDate,n)}function kH(t,n){if(!f(n.columnNames)){t._dataError="Error in loaded EOP data: The columnNames property is required.";return}if(!f(n.samples)){t._dataError="Error in loaded EOP data: The samples property is required.";return}let i=n.columnNames.indexOf("modifiedJulianDateUtc"),o=n.columnNames.indexOf("xPoleWanderRadians"),r=n.columnNames.indexOf("yPoleWanderRadians"),s=n.columnNames.indexOf("ut1MinusUtcSeconds"),a=n.columnNames.indexOf("xCelestialPoleOffsetRadians"),c=n.columnNames.indexOf("yCelestialPoleOffsetRadians"),l=n.columnNames.indexOf("taiMinusUtcSeconds");if(i<0||o<0||r<0||s<0||a<0||c<0||l<0){t._dataError="Error in loaded EOP data: The columnNames property must include modifiedJulianDateUtc, xPoleWanderRadians, yPoleWanderRadians, ut1MinusUtcSeconds, xCelestialPoleOffsetRadians, yCelestialPoleOffsetRadians, and taiMinusUtcSeconds columns";return}let u=t._samples=n.samples,d=t._dates=[];t._dateColumn=i,t._xPoleWanderRadiansColumn=o,t._yPoleWanderRadiansColumn=r,t._ut1MinusUtcSecondsColumn=s,t._xCelestialPoleOffsetRadiansColumn=a,t._yCelestialPoleOffsetRadiansColumn=c,t._taiMinusUtcSecondsColumn=l,t._columnCount=n.columnNames.length,t._lastIndex=void 0;let h,_=t._addNewLeapSeconds;for(let y=0,p=u.length;y<p;y+=t._columnCount){let C=u[y+i],x=u[y+l],T=C+Yn.MODIFIED_JULIAN_DATE_DIFFERENCE,E=new te(T,x,jn.TAI);if(d.push(E),_){if(x!==h&&f(h)){let S=te.leapSeconds,w=jo(S,E,Oxe);if(w<0){let D=new Mi(E,x);S.splice(~w,0,D)}}h=x}}}function TX(t,n,i,o,r){let s=i*o;r.xPoleWander=n[s+t._xPoleWanderRadiansColumn],r.yPoleWander=n[s+t._yPoleWanderRadiansColumn],r.xPoleOffset=n[s+t._xCelestialPoleOffsetRadiansColumn],r.yPoleOffset=n[s+t._yCelestialPoleOffsetRadiansColumn],r.ut1MinusUtc=n[s+t._ut1MinusUtcSecondsColumn]}function wb(t,n,i){return n+t*(i-n)}function EX(t,n,i,o,r,s,a){let c=t._columnCount;if(s>n.length-1)return a.xPoleWander=0,a.yPoleWander=0,a.xPoleOffset=0,a.yPoleOffset=0,a.ut1MinusUtc=0,a;let l=n[r],u=n[s];if(l.equals(u)||o.equals(l))return TX(t,i,r,c,a),a;if(o.equals(u))return TX(t,i,s,c,a),a;let d=te.secondsDifference(o,l)/te.secondsDifference(u,l),h=r*c,_=s*c,y=i[h+t._ut1MinusUtcSecondsColumn],p=i[_+t._ut1MinusUtcSecondsColumn],C=p-y;if(C>.5||C<-.5){let x=i[h+t._taiMinusUtcSecondsColumn],T=i[_+t._taiMinusUtcSecondsColumn];x!==T&&(u.equals(o)?y=p:p-=T-x)}return a.xPoleWander=wb(d,i[h+t._xPoleWanderRadiansColumn],i[_+t._xPoleWanderRadiansColumn]),a.yPoleWander=wb(d,i[h+t._yPoleWanderRadiansColumn],i[_+t._yPoleWanderRadiansColumn]),a.xPoleOffset=wb(d,i[h+t._xCelestialPoleOffsetRadiansColumn],i[_+t._xCelestialPoleOffsetRadiansColumn]),a.yPoleOffset=wb(d,i[h+t._yCelestialPoleOffsetRadiansColumn],i[_+t._yCelestialPoleOffsetRadiansColumn]),a.ut1MinusUtc=wb(d,y,p),a}var KP=XP;function ya(t,n,i){this.heading=A(t,0),this.pitch=A(n,0),this.roll=A(i,0)}ya.fromQuaternion=function(t,n){f(n)||(n=new ya);let i=2*(t.w*t.y-t.z*t.x),o=1-2*(t.x*t.x+t.y*t.y),r=2*(t.w*t.x+t.y*t.z),s=1-2*(t.y*t.y+t.z*t.z),a=2*(t.w*t.z+t.x*t.y);return n.heading=-Math.atan2(a,s),n.roll=Math.atan2(r,o),n.pitch=-B.asinClamped(i),n};ya.fromDegrees=function(t,n,i,o){return f(o)||(o=new ya),o.heading=t*B.RADIANS_PER_DEGREE,o.pitch=n*B.RADIANS_PER_DEGREE,o.roll=i*B.RADIANS_PER_DEGREE,o};ya.clone=function(t,n){if(!!f(t))return f(n)?(n.heading=t.heading,n.pitch=t.pitch,n.roll=t.roll,n):new ya(t.heading,t.pitch,t.roll)};ya.equals=function(t,n){return t===n||f(t)&&f(n)&&t.heading===n.heading&&t.pitch===n.pitch&&t.roll===n.roll};ya.equalsEpsilon=function(t,n,i,o){return t===n||f(t)&&f(n)&&B.equalsEpsilon(t.heading,n.heading,i,o)&&B.equalsEpsilon(t.pitch,n.pitch,i,o)&&B.equalsEpsilon(t.roll,n.roll,i,o)};ya.prototype.clone=function(t){return ya.clone(this,t)};ya.prototype.equals=function(t){return ya.equals(this,t)};ya.prototype.equalsEpsilon=function(t,n,i){return ya.equalsEpsilon(this,t,n,i)};ya.prototype.toString=function(){return`(${this.heading}, ${this.pitch}, ${this.roll})`};var yl=ya;var bX=/((?:.*\/)|^)Cesium\.js(?:\?|\#|$)/;function Rxe(){let t=document.getElementsByTagName("script");for(let n=0,i=t.length;n<i;++n){let o=t[n].getAttribute("src"),r=bX.exec(o);if(r!==null)return r[1]}}var dC;function SX(t){return typeof document=="undefined"?t:(f(dC)||(dC=document.createElement("a")),dC.href=t,dC.href=dC.href,dC.href)}var g0;function wX(){if(f(g0))return g0;let t;return typeof CESIUM_BASE_URL!="undefined"?t=CESIUM_BASE_URL:typeof define=="object"&&f(define.amd)&&!define.amd.toUrlUndefined&&f(vp.toUrl)?t=Lp("..",y0("Core/buildModuleUrl.js")):t=Rxe(),g0=new Ie({url:SX(t)}),g0.appendForwardSlash(),g0}function Mxe(t){return SX(vp.toUrl(`../${t}`))}function UH(t){return wX().getDerivedResource({url:t}).url}var Db;function y0(t){return f(Db)||(typeof define=="object"&&f(define.amd)&&!define.amd.toUrlUndefined&&f(vp.toUrl)?Db=Mxe:Db=UH,Db=UH),Db(t)}y0._cesiumScriptRegex=bX;y0._buildModuleUrlFromBaseUrl=UH;y0._clearBaseResource=function(){g0=void 0};y0.setBaseUrl=function(t){g0=Ie.DEFAULT.getDerivedResource({url:t})};y0.getCesiumBaseUrl=wX;var Qt=y0;function Lxe(t,n,i){this.x=t,this.y=n,this.s=i}var hC=Lxe;function GH(t){t=A(t,A.EMPTY_OBJECT),this._xysFileUrlTemplate=Ie.createIfNeeded(t.xysFileUrlTemplate),this._interpolationOrder=A(t.interpolationOrder,9),this._sampleZeroJulianEphemerisDate=A(t.sampleZeroJulianEphemerisDate,24423965e-1),this._sampleZeroDateTT=new te(this._sampleZeroJulianEphemerisDate,0,jn.TAI),this._stepSizeDays=A(t.stepSizeDays,1),this._samplesPerXysFile=A(t.samplesPerXysFile,1e3),this._totalSamples=A(t.totalSamples,27426),this._samples=new Array(this._totalSamples*3),this._chunkDownloadsInProgress=[];let n=this._interpolationOrder,i=this._denominators=new Array(n+1),o=this._xTable=new Array(n+1),r=Math.pow(this._stepSizeDays,n);for(let s=0;s<=n;++s){i[s]=r,o[s]=s*this._stepSizeDays;for(let a=0;a<=n;++a)a!==s&&(i[s]*=s-a);i[s]=1/i[s]}this._work=new Array(n+1),this._coef=new Array(n+1)}var Fxe=new te(0,0,jn.TAI);function zH(t,n,i){let o=Fxe;return o.dayNumber=n,o.secondsOfDay=i,te.daysDifference(o,t._sampleZeroDateTT)}GH.prototype.preload=function(t,n,i,o){let r=zH(this,t,n),s=zH(this,i,o),a=r/this._stepSizeDays-this._interpolationOrder/2|0;a<0&&(a=0);let c=s/this._stepSizeDays-this._interpolationOrder/2|0+this._interpolationOrder;c>=this._totalSamples&&(c=this._totalSamples-1);let l=a/this._samplesPerXysFile|0,u=c/this._samplesPerXysFile|0,d=[];for(let h=l;h<=u;++h)d.push(HH(this,h));return Promise.all(d)};GH.prototype.computeXysRadians=function(t,n,i){let o=zH(this,t,n);if(o<0)return;let r=o/this._stepSizeDays|0;if(r>=this._totalSamples)return;let s=this._interpolationOrder,a=r-(s/2|0);a<0&&(a=0);let c=a+s;c>=this._totalSamples&&(c=this._totalSamples-1,a=c-s,a<0&&(a=0));let l=!1,u=this._samples;if(f(u[a*3])||(HH(this,a/this._samplesPerXysFile|0),l=!0),f(u[c*3])||(HH(this,c/this._samplesPerXysFile|0),l=!0),l)return;f(i)?(i.x=0,i.y=0,i.s=0):i=new hC(0,0,0);let d=o-a*this._stepSizeDays,h=this._work,_=this._denominators,y=this._coef,p=this._xTable,C,x;for(C=0;C<=s;++C)h[C]=d-p[C];for(C=0;C<=s;++C){for(y[C]=1,x=0;x<=s;++x)x!==C&&(y[C]*=h[x]);y[C]*=_[C];let T=(a+C)*3;i.x+=y[C]*u[T++],i.y+=y[C]*u[T++],i.s+=y[C]*u[T]}return i};function HH(t,n){if(t._chunkDownloadsInProgress[n])return t._chunkDownloadsInProgress[n];let i,o=t._xysFileUrlTemplate;f(o)?i=o.getDerivedResource({templateValues:{0:n}}):i=new Ie({url:Qt(`Assets/IAU2006_XYS/IAU2006_XYS_${n}.json`)});let r=i.fetchJson().then(function(s){t._chunkDownloadsInProgress[n]=!1;let a=t._samples,c=s.samples,l=n*t._samplesPerXysFile*3;for(let u=0,d=c.length;u<d;++u)a[l+u]=c[u]});return t._chunkDownloadsInProgress[n]=r,r}var JP=GH;var Ii={},WH={up:{south:"east",north:"west",west:"south",east:"north"},down:{south:"west",north:"east",west:"north",east:"south"},south:{up:"west",down:"east",west:"down",east:"up"},north:{up:"east",down:"west",west:"up",east:"down"},west:{up:"north",down:"south",north:"down",south:"up"},east:{up:"south",down:"north",north:"up",south:"down"}},mC={north:[-1,0,0],east:[0,1,0],up:[0,0,1],south:[1,0,0],west:[0,-1,0],down:[0,0,-1]},jH={},Nc={east:new m,north:new m,up:new m,west:new m,south:new m,down:new m},Np=new m,Vp=new m,kp=new m;Ii.localFrameToFixedFrameGenerator=function(t,n){if(!WH.hasOwnProperty(t)||!WH[t].hasOwnProperty(n))throw new Ce("firstAxis and secondAxis must be east, north, up, west, south or down.");let i=WH[t][n],o,r=t+n;return f(jH[r])?o=jH[r]:(o=function(s,a,c){if(f(c)||(c=new N),m.equalsEpsilon(s,m.ZERO,B.EPSILON14))m.unpack(mC[t],0,Np),m.unpack(mC[n],0,Vp),m.unpack(mC[i],0,kp);else if(B.equalsEpsilon(s.x,0,B.EPSILON14)&&B.equalsEpsilon(s.y,0,B.EPSILON14)){let l=B.sign(s.z);m.unpack(mC[t],0,Np),t!=="east"&&t!=="west"&&m.multiplyByScalar(Np,l,Np),m.unpack(mC[n],0,Vp),n!=="east"&&n!=="west"&&m.multiplyByScalar(Vp,l,Vp),m.unpack(mC[i],0,kp),i!=="east"&&i!=="west"&&m.multiplyByScalar(kp,l,kp)}else{a=A(a,oe.WGS84),a.geodeticSurfaceNormal(s,Nc.up);let l=Nc.up,u=Nc.east;u.x=-s.y,u.y=s.x,u.z=0,m.normalize(u,Nc.east),m.cross(l,u,Nc.north),m.multiplyByScalar(Nc.up,-1,Nc.down),m.multiplyByScalar(Nc.east,-1,Nc.west),m.multiplyByScalar(Nc.north,-1,Nc.south),Np=Nc[t],Vp=Nc[n],kp=Nc[i]}return c[0]=Np.x,c[1]=Np.y,c[2]=Np.z,c[3]=0,c[4]=Vp.x,c[5]=Vp.y,c[6]=Vp.z,c[7]=0,c[8]=kp.x,c[9]=kp.y,c[10]=kp.z,c[11]=0,c[12]=s.x,c[13]=s.y,c[14]=s.z,c[15]=1,c},jH[r]=o),o};Ii.eastNorthUpToFixedFrame=Ii.localFrameToFixedFrameGenerator("east","north");Ii.northEastDownToFixedFrame=Ii.localFrameToFixedFrameGenerator("north","east");Ii.northUpEastToFixedFrame=Ii.localFrameToFixedFrameGenerator("north","up");Ii.northWestUpToFixedFrame=Ii.localFrameToFixedFrameGenerator("north","west");var Nxe=new Me,Vxe=new m(1,1,1),kxe=new N;Ii.headingPitchRollToFixedFrame=function(t,n,i,o,r){o=A(o,Ii.eastNorthUpToFixedFrame);let s=Me.fromHeadingPitchRoll(n,Nxe),a=N.fromTranslationQuaternionRotationScale(m.ZERO,s,Vxe,kxe);return r=o(t,i,r),N.multiply(r,a,r)};var Uxe=new N,zxe=new $;Ii.headingPitchRollQuaternion=function(t,n,i,o,r){let s=Ii.headingPitchRollToFixedFrame(t,n,i,o,Uxe),a=N.getMatrix3(s,zxe);return Me.fromRotationMatrix(a,r)};var Hxe=new m(1,1,1),Gxe=new m,DX=new N,Wxe=new N,jxe=new $,qxe=new Me;Ii.fixedFrameToHeadingPitchRoll=function(t,n,i,o){n=A(n,oe.WGS84),i=A(i,Ii.eastNorthUpToFixedFrame),f(o)||(o=new yl);let r=N.getTranslation(t,Gxe);if(m.equals(r,m.ZERO))return o.heading=0,o.pitch=0,o.roll=0,o;let s=N.inverseTransformation(i(r,n,DX),DX),a=N.setScale(t,Hxe,Wxe);a=N.setTranslation(a,m.ZERO,a),s=N.multiply(s,a,s);let c=Me.fromRotationMatrix(N.getMatrix3(s,jxe),qxe);return c=Me.normalize(c,c),yl.fromQuaternion(c,o)};var Yxe=6*3600+41*60+50.54841,Xxe=8640184812866e-6,Kxe=.093104,Jxe=-62e-7,Zxe=11772758384668e-32,Qxe=72921158553e-15,$xe=B.TWO_PI/86400,ZP=new te;Ii.computeTemeToPseudoFixedMatrix=function(t,n){ZP=te.addSeconds(t,-te.computeTaiMinusUtc(t),ZP);let i=ZP.dayNumber,o=ZP.secondsOfDay,r,s=i-2451545;o>=43200?r=(s+.5)/Yn.DAYS_PER_JULIAN_CENTURY:r=(s-.5)/Yn.DAYS_PER_JULIAN_CENTURY;let c=(Yxe+r*(Xxe+r*(Kxe+r*Jxe)))*$xe%B.TWO_PI,l=Qxe+Zxe*(i-24515455e-1),u=(o+Yn.SECONDS_PER_DAY*.5)%Yn.SECONDS_PER_DAY,d=c+l*u,h=Math.cos(d),_=Math.sin(d);return f(n)?(n[0]=h,n[1]=-_,n[2]=0,n[3]=_,n[4]=h,n[5]=0,n[6]=0,n[7]=0,n[8]=1,n):new $(h,_,0,-_,h,0,0,0,1)};Ii.iau2006XysData=new JP;Ii.earthOrientationParameters=KP.NONE;var XH=32.184,eTe=2451545;Ii.preloadIcrfFixed=function(t){let n=t.start.dayNumber,i=t.start.secondsOfDay+XH,o=t.stop.dayNumber,r=t.stop.secondsOfDay+XH,s=Ii.iau2006XysData.preload(n,i,o,r),a=Ii.earthOrientationParameters.getPromiseToLoad();return Promise.all([s,a])};Ii.computeIcrfToFixedMatrix=function(t,n){f(n)||(n=new $);let i=Ii.computeFixedToIcrfMatrix(t,n);if(!!f(i))return $.transpose(i,n)};var tTe=new hC(0,0,0),nTe=new m0(0,0,0,0,0,0),qH=new $,YH=new $;Ii.computeFixedToIcrfMatrix=function(t,n){f(n)||(n=new $);let i=Ii.earthOrientationParameters.compute(t,nTe);if(!f(i))return;let o=t.dayNumber,r=t.secondsOfDay+XH,s=Ii.iau2006XysData.computeXysRadians(o,r,tTe);if(!f(s))return;let a=s.x+i.xPoleOffset,c=s.y+i.yPoleOffset,l=1/(1+Math.sqrt(1-a*a-c*c)),u=qH;u[0]=1-l*a*a,u[3]=-l*a*c,u[6]=a,u[1]=-l*a*c,u[4]=1-l*c*c,u[7]=c,u[2]=-a,u[5]=-c,u[8]=1-l*(a*a+c*c);let d=$.fromRotationZ(-s.s,YH),h=$.multiply(u,d,qH),_=t.dayNumber,y=t.secondsOfDay-te.computeTaiMinusUtc(t)+i.ut1MinusUtc,p=_-2451545,C=y/Yn.SECONDS_PER_DAY,x=.779057273264+C+.00273781191135448*(p+C);x=x%1*B.TWO_PI;let T=$.fromRotationZ(x,YH),E=$.multiply(h,T,qH),S=Math.cos(i.xPoleWander),w=Math.cos(i.yPoleWander),D=Math.sin(i.xPoleWander),I=Math.sin(i.yPoleWander),O=o-eTe+r/Yn.SECONDS_PER_DAY;O/=36525;let M=-47e-6*O*B.RADIANS_PER_DEGREE/3600,L=Math.cos(M),F=Math.sin(M),g=YH;return g[0]=S*L,g[1]=S*F,g[2]=D,g[3]=-w*F+I*D*L,g[4]=w*L+I*D*F,g[5]=-I*S,g[6]=-I*F-w*D*L,g[7]=I*L-w*D*F,g[8]=w*S,$.multiply(E,g,n)};var iTe=new se;Ii.pointToWindowCoordinates=function(t,n,i,o){return o=Ii.pointToGLWindowCoordinates(t,n,i,o),o.y=2*n[5]-o.y,o};Ii.pointToGLWindowCoordinates=function(t,n,i,o){f(o)||(o=new W);let r=iTe;return N.multiplyByVector(t,se.fromElements(i.x,i.y,i.z,1,r),r),se.multiplyByScalar(r,1/r.w,r),N.multiplyByVector(n,r,r),W.fromCartesian4(r,o)};var oTe=new m,rTe=new m,sTe=new m;Ii.rotationMatrixFromPositionVelocity=function(t,n,i,o){let r=A(i,oe.WGS84).geodeticSurfaceNormal(t,oTe),s=m.cross(n,r,rTe);m.equalsEpsilon(s,m.ZERO,B.EPSILON6)&&(s=m.clone(m.UNIT_X,s));let a=m.cross(s,n,sTe);return m.normalize(a,a),m.cross(n,a,s),m.negate(s,s),m.normalize(s,s),f(o)||(o=new $),o[0]=n.x,o[1]=n.y,o[2]=n.z,o[3]=s.x,o[4]=s.y,o[5]=s.z,o[6]=a.x,o[7]=a.y,o[8]=a.z,o};var vX=new N(0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,1),PX=new de,IX=new m,aTe=new m,cTe=new $,KH=new N,BX=new N;Ii.basisTo2D=function(t,n,i){let o=N.getTranslation(n,aTe),r=t.ellipsoid,s=r.cartesianToCartographic(o,PX),a=t.project(s,IX);m.fromElements(a.z,a.x,a.y,a);let c=Ii.eastNorthUpToFixedFrame(o,r,KH),l=N.inverseTransformation(c,BX),u=N.getMatrix3(n,cTe),d=N.multiplyByMatrix3(l,u,i);return N.multiply(vX,d,i),N.setTranslation(i,a,i),i};Ii.wgs84To2DModelMatrix=function(t,n,i){let o=t.ellipsoid,r=Ii.eastNorthUpToFixedFrame(n,o,KH),s=N.inverseTransformation(r,BX),a=o.cartesianToCartographic(n,PX),c=t.project(a,IX);m.fromElements(c.z,c.x,c.y,c);let l=N.fromTranslation(c,KH);return N.multiply(vX,s,i),N.multiply(l,i,i),i};var vt=Ii;function JH(t){t=A(t,A.EMPTY_OBJECT),this.attributes=t.attributes,this.indices=t.indices,this.primitiveType=A(t.primitiveType,Re.TRIANGLES),this.boundingSphere=t.boundingSphere,this.geometryType=A(t.geometryType,yf.NONE),this.boundingSphereCV=t.boundingSphereCV,this.offsetAttribute=t.offsetAttribute}JH.computeNumberOfVertices=function(t){let n=-1;for(let i in t.attributes)if(t.attributes.hasOwnProperty(i)&&f(t.attributes[i])&&f(t.attributes[i].values)){let o=t.attributes[i];n=o.values.length/o.componentsPerAttribute}return n};var lTe=new de,uTe=new m,OX=new N,fTe=[new de,new de,new de],dTe=[new W,new W,new W],hTe=[new W,new W,new W],mTe=new m,pTe=new Me,_Te=new N,gTe=new Ji;JH._textureCoordinateRotationPoints=function(t,n,i,o){let r,s=le.center(o,lTe),a=de.toCartesian(s,i,uTe),c=vt.eastNorthUpToFixedFrame(a,i,OX),l=N.inverse(c,OX),u=dTe,d=fTe;d[0].longitude=o.west,d[0].latitude=o.south,d[1].longitude=o.west,d[1].latitude=o.north,d[2].longitude=o.east,d[2].latitude=o.south;let h=mTe;for(r=0;r<3;r++)de.toCartesian(d[r],i,h),h=N.multiplyByPointAsVector(l,h,h),u[r].x=h.x,u[r].y=h.y;let _=Me.fromAxisAngle(m.UNIT_Z,-n,pTe),y=$.fromQuaternion(_,_Te),p=t.length,C=Number.POSITIVE_INFINITY,x=Number.POSITIVE_INFINITY,T=Number.NEGATIVE_INFINITY,E=Number.NEGATIVE_INFINITY;for(r=0;r<p;r++)h=N.multiplyByPointAsVector(l,t[r],h),h=$.multiplyByVector(y,h,h),C=Math.min(C,h.x),x=Math.min(x,h.y),T=Math.max(T,h.x),E=Math.max(E,h.y);let S=Ji.fromRotation(n,gTe),w=hTe;w[0].x=C,w[0].y=x,w[1].x=C,w[1].y=E,w[2].x=T,w[2].y=x;let D=u[0],I=u[2].x-D.x,O=u[1].y-D.y;for(r=0;r<3;r++){let b=w[r];Ji.multiplyByVector(S,b,b),b.x=(b.x-D.x)/I,b.y=(b.y-D.y)/O}let M=w[0],L=w[1],F=w[2],g=new Array(6);return W.pack(M,g),W.pack(L,g,2),W.pack(F,g,4),g};var at=JH;function yTe(t){t=A(t,A.EMPTY_OBJECT),this.componentDatatype=t.componentDatatype,this.componentsPerAttribute=t.componentsPerAttribute,this.normalize=A(t.normalize,!1),this.values=t.values}var we=yTe;function ATe(t){t=A(t,A.EMPTY_OBJECT),this.position=t.position,this.normal=t.normal,this.st=t.st,this.bitangent=t.bitangent,this.tangent=t.tangent,this.color=t.color}var cn=ATe;var CTe={NONE:0,TOP:1,ALL:2},en=Object.freeze(CTe);function Hr(t){t=A(t,A.EMPTY_OBJECT),this.position=A(t.position,!1),this.normal=A(t.normal,!1),this.st=A(t.st,!1),this.bitangent=A(t.bitangent,!1),this.tangent=A(t.tangent,!1),this.color=A(t.color,!1)}Hr.POSITION_ONLY=Object.freeze(new Hr({position:!0}));Hr.POSITION_AND_NORMAL=Object.freeze(new Hr({position:!0,normal:!0}));Hr.POSITION_NORMAL_AND_ST=Object.freeze(new Hr({position:!0,normal:!0,st:!0}));Hr.POSITION_AND_ST=Object.freeze(new Hr({position:!0,st:!0}));Hr.POSITION_AND_COLOR=Object.freeze(new Hr({position:!0,color:!0}));Hr.ALL=Object.freeze(new Hr({position:!0,normal:!0,st:!0,tangent:!0,bitangent:!0}));Hr.DEFAULT=Hr.POSITION_NORMAL_AND_ST;Hr.packedLength=6;Hr.pack=function(t,n,i){return i=A(i,0),n[i++]=t.position?1:0,n[i++]=t.normal?1:0,n[i++]=t.st?1:0,n[i++]=t.tangent?1:0,n[i++]=t.bitangent?1:0,n[i]=t.color?1:0,n};Hr.unpack=function(t,n,i){return n=A(n,0),f(i)||(i=new Hr),i.position=t[n++]===1,i.normal=t[n++]===1,i.st=t[n++]===1,i.tangent=t[n++]===1,i.bitangent=t[n++]===1,i.color=t[n]===1,i};Hr.clone=function(t,n){if(!!f(t))return f(n)||(n=new Hr),n.position=t.position,n.normal=t.normal,n.st=t.st,n.tangent=t.tangent,n.bitangent=t.bitangent,n.color=t.color,n};var De=Hr;var xTe=new m;function Al(t){t=A(t,A.EMPTY_OBJECT);let n=t.minimum,i=t.maximum,o=A(t.vertexFormat,De.DEFAULT);this._minimum=m.clone(n),this._maximum=m.clone(i),this._vertexFormat=o,this._offsetAttribute=t.offsetAttribute,this._workerName="createBoxGeometry"}Al.fromDimensions=function(t){t=A(t,A.EMPTY_OBJECT);let n=t.dimensions,i=m.multiplyByScalar(n,.5,new m);return new Al({minimum:m.negate(i,new m),maximum:i,vertexFormat:t.vertexFormat,offsetAttribute:t.offsetAttribute})};Al.fromAxisAlignedBoundingBox=function(t){return new Al({minimum:t.minimum,maximum:t.maximum})};Al.packedLength=2*m.packedLength+De.packedLength+1;Al.pack=function(t,n,i){return i=A(i,0),m.pack(t._minimum,n,i),m.pack(t._maximum,n,i+m.packedLength),De.pack(t._vertexFormat,n,i+2*m.packedLength),n[i+2*m.packedLength+De.packedLength]=A(t._offsetAttribute,-1),n};var MX=new m,LX=new m,FX=new De,RX={minimum:MX,maximum:LX,vertexFormat:FX,offsetAttribute:void 0};Al.unpack=function(t,n,i){n=A(n,0);let o=m.unpack(t,n,MX),r=m.unpack(t,n+m.packedLength,LX),s=De.unpack(t,n+2*m.packedLength,FX),a=t[n+2*m.packedLength+De.packedLength];return f(i)?(i._minimum=m.clone(o,i._minimum),i._maximum=m.clone(r,i._maximum),i._vertexFormat=De.clone(s,i._vertexFormat),i._offsetAttribute=a===-1?void 0:a,i):(RX.offsetAttribute=a===-1?void 0:a,new Al(RX))};Al.createGeometry=function(t){let n=t._minimum,i=t._maximum,o=t._vertexFormat;if(m.equals(n,i))return;let r=new cn,s,a;if(o.position&&(o.st||o.normal||o.tangent||o.bitangent)){if(o.position&&(a=new Float64Array(6*4*3),a[0]=n.x,a[1]=n.y,a[2]=i.z,a[3]=i.x,a[4]=n.y,a[5]=i.z,a[6]=i.x,a[7]=i.y,a[8]=i.z,a[9]=n.x,a[10]=i.y,a[11]=i.z,a[12]=n.x,a[13]=n.y,a[14]=n.z,a[15]=i.x,a[16]=n.y,a[17]=n.z,a[18]=i.x,a[19]=i.y,a[20]=n.z,a[21]=n.x,a[22]=i.y,a[23]=n.z,a[24]=i.x,a[25]=n.y,a[26]=n.z,a[27]=i.x,a[28]=i.y,a[29]=n.z,a[30]=i.x,a[31]=i.y,a[32]=i.z,a[33]=i.x,a[34]=n.y,a[35]=i.z,a[36]=n.x,a[37]=n.y,a[38]=n.z,a[39]=n.x,a[40]=i.y,a[41]=n.z,a[42]=n.x,a[43]=i.y,a[44]=i.z,a[45]=n.x,a[46]=n.y,a[47]=i.z,a[48]=n.x,a[49]=i.y,a[50]=n.z,a[51]=i.x,a[52]=i.y,a[53]=n.z,a[54]=i.x,a[55]=i.y,a[56]=i.z,a[57]=n.x,a[58]=i.y,a[59]=i.z,a[60]=n.x,a[61]=n.y,a[62]=n.z,a[63]=i.x,a[64]=n.y,a[65]=n.z,a[66]=i.x,a[67]=n.y,a[68]=i.z,a[69]=n.x,a[70]=n.y,a[71]=i.z,r.position=new we({componentDatatype:J.DOUBLE,componentsPerAttribute:3,values:a})),o.normal){let u=new Float32Array(72);u[0]=0,u[1]=0,u[2]=1,u[3]=0,u[4]=0,u[5]=1,u[6]=0,u[7]=0,u[8]=1,u[9]=0,u[10]=0,u[11]=1,u[12]=0,u[13]=0,u[14]=-1,u[15]=0,u[16]=0,u[17]=-1,u[18]=0,u[19]=0,u[20]=-1,u[21]=0,u[22]=0,u[23]=-1,u[24]=1,u[25]=0,u[26]=0,u[27]=1,u[28]=0,u[29]=0,u[30]=1,u[31]=0,u[32]=0,u[33]=1,u[34]=0,u[35]=0,u[36]=-1,u[37]=0,u[38]=0,u[39]=-1,u[40]=0,u[41]=0,u[42]=-1,u[43]=0,u[44]=0,u[45]=-1,u[46]=0,u[47]=0,u[48]=0,u[49]=1,u[50]=0,u[51]=0,u[52]=1,u[53]=0,u[54]=0,u[55]=1,u[56]=0,u[57]=0,u[58]=1,u[59]=0,u[60]=0,u[61]=-1,u[62]=0,u[63]=0,u[64]=-1,u[65]=0,u[66]=0,u[67]=-1,u[68]=0,u[69]=0,u[70]=-1,u[71]=0,r.normal=new we({componentDatatype:J.FLOAT,componentsPerAttribute:3,values:u})}if(o.st){let u=new Float32Array(48);u[0]=0,u[1]=0,u[2]=1,u[3]=0,u[4]=1,u[5]=1,u[6]=0,u[7]=1,u[8]=1,u[9]=0,u[10]=0,u[11]=0,u[12]=0,u[13]=1,u[14]=1,u[15]=1,u[16]=0,u[17]=0,u[18]=1,u[19]=0,u[20]=1,u[21]=1,u[22]=0,u[23]=1,u[24]=1,u[25]=0,u[26]=0,u[27]=0,u[28]=0,u[29]=1,u[30]=1,u[31]=1,u[32]=1,u[33]=0,u[34]=0,u[35]=0,u[36]=0,u[37]=1,u[38]=1,u[39]=1,u[40]=0,u[41]=0,u[42]=1,u[43]=0,u[44]=1,u[45]=1,u[46]=0,u[47]=1,r.st=new we({componentDatatype:J.FLOAT,componentsPerAttribute:2,values:u})}if(o.tangent){let u=new Float32Array(72);u[0]=1,u[1]=0,u[2]=0,u[3]=1,u[4]=0,u[5]=0,u[6]=1,u[7]=0,u[8]=0,u[9]=1,u[10]=0,u[11]=0,u[12]=-1,u[13]=0,u[14]=0,u[15]=-1,u[16]=0,u[17]=0,u[18]=-1,u[19]=0,u[20]=0,u[21]=-1,u[22]=0,u[23]=0,u[24]=0,u[25]=1,u[26]=0,u[27]=0,u[28]=1,u[29]=0,u[30]=0,u[31]=1,u[32]=0,u[33]=0,u[34]=1,u[35]=0,u[36]=0,u[37]=-1,u[38]=0,u[39]=0,u[40]=-1,u[41]=0,u[42]=0,u[43]=-1,u[44]=0,u[45]=0,u[46]=-1,u[47]=0,u[48]=-1,u[49]=0,u[50]=0,u[51]=-1,u[52]=0,u[53]=0,u[54]=-1,u[55]=0,u[56]=0,u[57]=-1,u[58]=0,u[59]=0,u[60]=1,u[61]=0,u[62]=0,u[63]=1,u[64]=0,u[65]=0,u[66]=1,u[67]=0,u[68]=0,u[69]=1,u[70]=0,u[71]=0,r.tangent=new we({componentDatatype:J.FLOAT,componentsPerAttribute:3,values:u})}if(o.bitangent){let u=new Float32Array(72);u[0]=0,u[1]=1,u[2]=0,u[3]=0,u[4]=1,u[5]=0,u[6]=0,u[7]=1,u[8]=0,u[9]=0,u[10]=1,u[11]=0,u[12]=0,u[13]=1,u[14]=0,u[15]=0,u[16]=1,u[17]=0,u[18]=0,u[19]=1,u[20]=0,u[21]=0,u[22]=1,u[23]=0,u[24]=0,u[25]=0,u[26]=1,u[27]=0,u[28]=0,u[29]=1,u[30]=0,u[31]=0,u[32]=1,u[33]=0,u[34]=0,u[35]=1,u[36]=0,u[37]=0,u[38]=1,u[39]=0,u[40]=0,u[41]=1,u[42]=0,u[43]=0,u[44]=1,u[45]=0,u[46]=0,u[47]=1,u[48]=0,u[49]=0,u[50]=1,u[51]=0,u[52]=0,u[53]=1,u[54]=0,u[55]=0,u[56]=1,u[57]=0,u[58]=0,u[59]=1,u[60]=0,u[61]=0,u[62]=1,u[63]=0,u[64]=0,u[65]=1,u[66]=0,u[67]=0,u[68]=1,u[69]=0,u[70]=0,u[71]=1,r.bitangent=new we({componentDatatype:J.FLOAT,componentsPerAttribute:3,values:u})}s=new Uint16Array(6*2*3),s[0]=0,s[1]=1,s[2]=2,s[3]=0,s[4]=2,s[5]=3,s[6]=4+2,s[7]=4+1,s[8]=4+0,s[9]=4+3,s[10]=4+2,s[11]=4+0,s[12]=8+0,s[13]=8+1,s[14]=8+2,s[15]=8+0,s[16]=8+2,s[17]=8+3,s[18]=12+2,s[19]=12+1,s[20]=12+0,s[21]=12+3,s[22]=12+2,s[23]=12+0,s[24]=16+2,s[25]=16+1,s[26]=16+0,s[27]=16+3,s[28]=16+2,s[29]=16+0,s[30]=20+0,s[31]=20+1,s[32]=20+2,s[33]=20+0,s[34]=20+2,s[35]=20+3}else a=new Float64Array(8*3),a[0]=n.x,a[1]=n.y,a[2]=n.z,a[3]=i.x,a[4]=n.y,a[5]=n.z,a[6]=i.x,a[7]=i.y,a[8]=n.z,a[9]=n.x,a[10]=i.y,a[11]=n.z,a[12]=n.x,a[13]=n.y,a[14]=i.z,a[15]=i.x,a[16]=n.y,a[17]=i.z,a[18]=i.x,a[19]=i.y,a[20]=i.z,a[21]=n.x,a[22]=i.y,a[23]=i.z,r.position=new we({componentDatatype:J.DOUBLE,componentsPerAttribute:3,values:a}),s=new Uint16Array(6*2*3),s[0]=4,s[1]=5,s[2]=6,s[3]=4,s[4]=6,s[5]=7,s[6]=1,s[7]=0,s[8]=3,s[9]=1,s[10]=3,s[11]=2,s[12]=1,s[13]=6,s[14]=5,s[15]=1,s[16]=2,s[17]=6,s[18]=2,s[19]=3,s[20]=7,s[21]=2,s[22]=7,s[23]=6,s[24]=3,s[25]=0,s[26]=4,s[27]=3,s[28]=4,s[29]=7,s[30]=0,s[31]=1,s[32]=5,s[33]=0,s[34]=5,s[35]=4;let c=m.subtract(i,n,xTe),l=m.magnitude(c)*.5;if(f(t._offsetAttribute)){let u=a.length,d=t._offsetAttribute===en.NONE?0:1,h=new Uint8Array(u/3).fill(d);r.applyOffset=new we({componentDatatype:J.UNSIGNED_BYTE,componentsPerAttribute:1,values:h})}return new at({attributes:r,indices:s,primitiveType:Re.TRIANGLES,boundingSphere:new ae(m.ZERO,l),offsetAttribute:t._offsetAttribute})};var ZH;Al.getUnitBox=function(){return f(ZH)||(ZH=Al.createGeometry(Al.fromDimensions({dimensions:new m(1,1,1),vertexFormat:De.POSITION_ONLY}))),ZH};var Cl=Al;var TTe=new m;function Md(t){t=A(t,A.EMPTY_OBJECT);let n=t.minimum,i=t.maximum;this._min=m.clone(n),this._max=m.clone(i),this._offsetAttribute=t.offsetAttribute,this._workerName="createBoxOutlineGeometry"}Md.fromDimensions=function(t){t=A(t,A.EMPTY_OBJECT);let n=t.dimensions,i=m.multiplyByScalar(n,.5,new m);return new Md({minimum:m.negate(i,new m),maximum:i,offsetAttribute:t.offsetAttribute})};Md.fromAxisAlignedBoundingBox=function(t){return new Md({minimum:t.minimum,maximum:t.maximum})};Md.packedLength=2*m.packedLength+1;Md.pack=function(t,n,i){return i=A(i,0),m.pack(t._min,n,i),m.pack(t._max,n,i+m.packedLength),n[i+m.packedLength*2]=A(t._offsetAttribute,-1),n};var VX=new m,kX=new m,NX={minimum:VX,maximum:kX,offsetAttribute:void 0};Md.unpack=function(t,n,i){n=A(n,0);let o=m.unpack(t,n,VX),r=m.unpack(t,n+m.packedLength,kX),s=t[n+m.packedLength*2];return f(i)?(i._min=m.clone(o,i._min),i._max=m.clone(r,i._max),i._offsetAttribute=s===-1?void 0:s,i):(NX.offsetAttribute=s===-1?void 0:s,new Md(NX))};Md.createGeometry=function(t){let n=t._min,i=t._max;if(m.equals(n,i))return;let o=new cn,r=new Uint16Array(12*2),s=new Float64Array(8*3);s[0]=n.x,s[1]=n.y,s[2]=n.z,s[3]=i.x,s[4]=n.y,s[5]=n.z,s[6]=i.x,s[7]=i.y,s[8]=n.z,s[9]=n.x,s[10]=i.y,s[11]=n.z,s[12]=n.x,s[13]=n.y,s[14]=i.z,s[15]=i.x,s[16]=n.y,s[17]=i.z,s[18]=i.x,s[19]=i.y,s[20]=i.z,s[21]=n.x,s[22]=i.y,s[23]=i.z,o.position=new we({componentDatatype:J.DOUBLE,componentsPerAttribute:3,values:s}),r[0]=4,r[1]=5,r[2]=5,r[3]=6,r[4]=6,r[5]=7,r[6]=7,r[7]=4,r[8]=0,r[9]=1,r[10]=1,r[11]=2,r[12]=2,r[13]=3,r[14]=3,r[15]=0,r[16]=0,r[17]=4,r[18]=1,r[19]=5,r[20]=2,r[21]=6,r[22]=3,r[23]=7;let a=m.subtract(i,n,TTe),c=m.magnitude(a)*.5;if(f(t._offsetAttribute)){let l=s.length,u=t._offsetAttribute===en.NONE?0:1,d=new Uint8Array(l/3).fill(u);o.applyOffset=new we({componentDatatype:J.UNSIGNED_BYTE,componentsPerAttribute:1,values:d})}return new at({attributes:o,indices:r,primitiveType:Re.LINES,boundingSphere:new ae(m.ZERO,c),offsetAttribute:t._offsetAttribute})};var Ld=Md;function pC(t,n,i,o){t=A(t,1),n=A(n,1),i=A(i,1),o=A(o,1),this.value=new Uint8Array([z.floatToByte(t),z.floatToByte(n),z.floatToByte(i),z.floatToByte(o)])}Object.defineProperties(pC.prototype,{componentDatatype:{get:function(){return J.UNSIGNED_BYTE}},componentsPerAttribute:{get:function(){return 4}},normalize:{get:function(){return!0}}});pC.fromColor=function(t){return new pC(t.red,t.green,t.blue,t.alpha)};pC.toValue=function(t,n){return f(n)?t.toBytes(n):new Uint8Array(t.toBytes())};pC.equals=function(t,n){return t===n||f(t)&&f(n)&&t.value[0]===n.value[0]&&t.value[1]===n.value[1]&&t.value[2]===n.value[2]&&t.value[3]===n.value[3]};var Lt=pC;function vb(t,n){t=A(t,0),n=A(n,Number.MAX_VALUE),this.value=new Float32Array([t,n])}Object.defineProperties(vb.prototype,{componentDatatype:{get:function(){return J.FLOAT}},componentsPerAttribute:{get:function(){return 2}},normalize:{get:function(){return!1}}});vb.fromDistanceDisplayCondition=function(t){return new vb(t.near,t.far)};vb.toValue=function(t,n){return f(n)?(n[0]=t.near,n[1]=t.far,n):new Float32Array([t.near,t.far])};var Vn=vb;function ETe(t){t=A(t,A.EMPTY_OBJECT),this.geometry=t.geometry,this.modelMatrix=N.clone(A(t.modelMatrix,N.IDENTITY)),this.id=t.id,this.pickPrimitive=t.pickPrimitive,this.attributes=A(t.attributes,{}),this.westHemisphereGeometry=void 0,this.eastHemisphereGeometry=void 0}var Ct=ETe;function Ro(t){t=A(t,A.EMPTY_OBJECT),this.start=f(t.start)?te.clone(t.start):new te,this.stop=f(t.stop)?te.clone(t.stop):new te,this.data=t.data,this.isStartIncluded=A(t.isStartIncluded,!0),this.isStopIncluded=A(t.isStopIncluded,!0)}Object.defineProperties(Ro.prototype,{isEmpty:{get:function(){let t=te.compare(this.stop,this.start);return t<0||t===0&&(!this.isStartIncluded||!this.isStopIncluded)}}});var _C={start:void 0,stop:void 0,isStartIncluded:void 0,isStopIncluded:void 0,data:void 0};Ro.fromIso8601=function(t,n){let i=t.iso8601.split("/");if(i.length!==2)throw new Ce("options.iso8601 is an invalid ISO 8601 interval.");let o=te.fromIso8601(i[0]),r=te.fromIso8601(i[1]),s=A(t.isStartIncluded,!0),a=A(t.isStopIncluded,!0),c=t.data;return f(n)?(n.start=o,n.stop=r,n.isStartIncluded=s,n.isStopIncluded=a,n.data=c,n):(_C.start=o,_C.stop=r,_C.isStartIncluded=s,_C.isStopIncluded=a,_C.data=c,new Ro(_C))};Ro.toIso8601=function(t,n){return`${te.toIso8601(t.start,n)}/${te.toIso8601(t.stop,n)}`};Ro.clone=function(t,n){if(!!f(t))return f(n)?(n.start=t.start,n.stop=t.stop,n.isStartIncluded=t.isStartIncluded,n.isStopIncluded=t.isStopIncluded,n.data=t.data,n):new Ro(t)};Ro.equals=function(t,n,i){return t===n||f(t)&&f(n)&&(t.isEmpty&&n.isEmpty||t.isStartIncluded===n.isStartIncluded&&t.isStopIncluded===n.isStopIncluded&&te.equals(t.start,n.start)&&te.equals(t.stop,n.stop)&&(t.data===n.data||f(i)&&i(t.data,n.data)))};Ro.equalsEpsilon=function(t,n,i,o){return i=A(i,0),t===n||f(t)&&f(n)&&(t.isEmpty&&n.isEmpty||t.isStartIncluded===n.isStartIncluded&&t.isStopIncluded===n.isStopIncluded&&te.equalsEpsilon(t.start,n.start,i)&&te.equalsEpsilon(t.stop,n.stop,i)&&(t.data===n.data||f(o)&&o(t.data,n.data)))};Ro.intersect=function(t,n,i,o){if(!f(n))return Ro.clone(Ro.EMPTY,i);let r=t.start,s=t.stop,a=n.start,c=n.stop,l=te.greaterThanOrEquals(a,r)&&te.greaterThanOrEquals(s,a),u=!l&&te.lessThanOrEquals(a,r)&&te.lessThanOrEquals(r,c);if(!l&&!u)return Ro.clone(Ro.EMPTY,i);let d=t.isStartIncluded,h=t.isStopIncluded,_=n.isStartIncluded,y=n.isStopIncluded,p=te.lessThan(s,c);return f(i)||(i=new Ro),i.start=l?a:r,i.isStartIncluded=d&&_||!te.equals(a,r)&&(l&&_||u&&d),i.stop=p?s:c,i.isStopIncluded=p?h:h&&y||!te.equals(c,s)&&y,i.data=f(o)?o(t.data,n.data):t.data,i};Ro.contains=function(t,n){if(t.isEmpty)return!1;let i=te.compare(t.start,n);if(i===0)return t.isStartIncluded;let o=te.compare(n,t.stop);return o===0?t.isStopIncluded:i<0&&o<0};Ro.prototype.clone=function(t){return Ro.clone(this,t)};Ro.prototype.equals=function(t,n){return Ro.equals(this,t,n)};Ro.prototype.equalsEpsilon=function(t,n,i){return Ro.equalsEpsilon(this,t,n,i)};Ro.prototype.toString=function(){return Ro.toIso8601(this)};Ro.EMPTY=Object.freeze(new Ro({start:new te,stop:new te,isStartIncluded:!1,isStopIncluded:!1}));var xn=Ro;var UX=Object.freeze(te.fromIso8601("0000-01-01T00:00:00Z")),zX=Object.freeze(te.fromIso8601("9999-12-31T24:00:00Z")),bTe=Object.freeze(new xn({start:UX,stop:zX})),STe={MINIMUM_VALUE:UX,MAXIMUM_VALUE:zX,MAXIMUM_INTERVAL:bTe},Ue=STe;function Pb(t,n,i){t=A(t,0),n=A(n,0),i=A(i,0),this.value=new Float32Array([t,n,i])}Object.defineProperties(Pb.prototype,{componentDatatype:{get:function(){return J.FLOAT}},componentsPerAttribute:{get:function(){return 3}},normalize:{get:function(){return!1}}});Pb.fromCartesian3=function(t){return new Pb(t.x,t.y,t.z)};Pb.toValue=function(t,n){return f(n)||(n=new Float32Array([t.x,t.y,t.z])),n[0]=t.x,n[1]=t.y,n[2]=t.z,n};var Gi=Pb;function QP(t){t=A(t,!0),this.value=QP.toValue(t)}Object.defineProperties(QP.prototype,{componentDatatype:{get:function(){return J.UNSIGNED_BYTE}},componentsPerAttribute:{get:function(){return 1}},normalize:{get:function(){return!1}}});QP.toValue=function(t,n){return f(n)?(n[0]=t,n):new Uint8Array([t])};var mn=QP;var $P=`varying vec3 v_positionEC;
varying vec3 v_normalEC;
varying vec3 v_tangentEC;
varying vec3 v_bitangentEC;
varying vec2 v_st;
void main()
{
vec3 positionToEyeEC = -v_positionEC;
mat3 tangentToEyeMatrix = czm_tangentToEyeSpaceMatrix(v_normalEC, v_tangentEC, v_bitangentEC);
vec3 normalEC = normalize(v_normalEC);
#ifdef FACE_FORWARD
normalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);
#endif
czm_materialInput materialInput;
materialInput.normalEC = normalEC;
materialInput.tangentToEyeMatrix = tangentToEyeMatrix;
materialInput.positionToEyeEC = positionToEyeEC;
materialInput.st = v_st;
czm_material material = czm_getMaterial(materialInput);
#ifdef FLAT
gl_FragColor = vec4(material.diffuse + material.emission, material.alpha);
#else
gl_FragColor = czm_phong(normalize(positionToEyeEC), material, czm_lightDirectionEC);
#endif
}
`;var e1=`attribute vec3 position3DHigh;
attribute vec3 position3DLow;
attribute vec3 normal;
attribute vec3 tangent;
attribute vec3 bitangent;
attribute vec2 st;
attribute float batchId;
varying vec3 v_positionEC;
varying vec3 v_normalEC;
varying vec3 v_tangentEC;
varying vec3 v_bitangentEC;
varying vec2 v_st;
void main()
{
vec4 p = czm_computePosition();
v_positionEC = (czm_modelViewRelativeToEye * p).xyz;
v_normalEC = czm_normal * normal;
v_tangentEC = czm_normal * tangent;
v_bitangentEC = czm_normal * bitangent;
v_st = st;
gl_Position = czm_modelViewProjectionRelativeToEye * p;
}
`;var t1=`varying vec3 v_positionEC;
varying vec3 v_normalEC;
void main()
{
vec3 positionToEyeEC = -v_positionEC;
vec3 normalEC = normalize(v_normalEC);
#ifdef FACE_FORWARD
normalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);
#endif
czm_materialInput materialInput;
materialInput.normalEC = normalEC;
materialInput.positionToEyeEC = positionToEyeEC;
czm_material material = czm_getMaterial(materialInput);
#ifdef FLAT
gl_FragColor = vec4(material.diffuse + material.emission, material.alpha);
#else
gl_FragColor = czm_phong(normalize(positionToEyeEC), material, czm_lightDirectionEC);
#endif
}
`;var n1=`attribute vec3 position3DHigh;
attribute vec3 position3DLow;
attribute vec3 normal;
attribute float batchId;
varying vec3 v_positionEC;
varying vec3 v_normalEC;
void main()
{
vec4 p = czm_computePosition();
v_positionEC = (czm_modelViewRelativeToEye * p).xyz;
v_normalEC = czm_normal * normal;
gl_Position = czm_modelViewProjectionRelativeToEye * p;
}
`;var i1=`varying vec3 v_positionEC;
varying vec3 v_normalEC;
varying vec2 v_st;
void main()
{
vec3 positionToEyeEC = -v_positionEC;
vec3 normalEC = normalize(v_normalEC);
#ifdef FACE_FORWARD
normalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);
#endif
czm_materialInput materialInput;
materialInput.normalEC = normalEC;
materialInput.positionToEyeEC = positionToEyeEC;
materialInput.st = v_st;
czm_material material = czm_getMaterial(materialInput);
#ifdef FLAT
gl_FragColor = vec4(material.diffuse + material.emission, material.alpha);
#else
gl_FragColor = czm_phong(normalize(positionToEyeEC), material, czm_lightDirectionEC);
#endif
}
`;var o1=`attribute vec3 position3DHigh;
attribute vec3 position3DLow;
attribute vec3 normal;
attribute vec2 st;
attribute float batchId;
varying vec3 v_positionEC;
varying vec3 v_normalEC;
varying vec2 v_st;
void main()
{
vec4 p = czm_computePosition();
v_positionEC = (czm_modelViewRelativeToEye * p).xyz;
v_normalEC = czm_normal * normal;
v_st = st;
gl_Position = czm_modelViewProjectionRelativeToEye * p;
}
`;var wTe={ADD:ee.FUNC_ADD,SUBTRACT:ee.FUNC_SUBTRACT,REVERSE_SUBTRACT:ee.FUNC_REVERSE_SUBTRACT,MIN:ee.MIN,MAX:ee.MAX},Aa=Object.freeze(wTe);var DTe={ZERO:ee.ZERO,ONE:ee.ONE,SOURCE_COLOR:ee.SRC_COLOR,ONE_MINUS_SOURCE_COLOR:ee.ONE_MINUS_SRC_COLOR,DESTINATION_COLOR:ee.DST_COLOR,ONE_MINUS_DESTINATION_COLOR:ee.ONE_MINUS_DST_COLOR,SOURCE_ALPHA:ee.SRC_ALPHA,ONE_MINUS_SOURCE_ALPHA:ee.ONE_MINUS_SRC_ALPHA,DESTINATION_ALPHA:ee.DST_ALPHA,ONE_MINUS_DESTINATION_ALPHA:ee.ONE_MINUS_DST_ALPHA,CONSTANT_COLOR:ee.CONSTANT_COLOR,ONE_MINUS_CONSTANT_COLOR:ee.ONE_MINUS_CONSTANT_COLOR,CONSTANT_ALPHA:ee.CONSTANT_ALPHA,ONE_MINUS_CONSTANT_ALPHA:ee.ONE_MINUS_CONSTANT_ALPHA,SOURCE_ALPHA_SATURATE:ee.SRC_ALPHA_SATURATE},Eo=Object.freeze(DTe);var vTe={DISABLED:Object.freeze({enabled:!1}),ALPHA_BLEND:Object.freeze({enabled:!0,equationRgb:Aa.ADD,equationAlpha:Aa.ADD,functionSourceRgb:Eo.SOURCE_ALPHA,functionSourceAlpha:Eo.ONE,functionDestinationRgb:Eo.ONE_MINUS_SOURCE_ALPHA,functionDestinationAlpha:Eo.ONE_MINUS_SOURCE_ALPHA}),PRE_MULTIPLIED_ALPHA_BLEND:Object.freeze({enabled:!0,equationRgb:Aa.ADD,equationAlpha:Aa.ADD,functionSourceRgb:Eo.ONE,functionSourceAlpha:Eo.ONE,functionDestinationRgb:Eo.ONE_MINUS_SOURCE_ALPHA,functionDestinationAlpha:Eo.ONE_MINUS_SOURCE_ALPHA}),ADDITIVE_BLEND:Object.freeze({enabled:!0,equationRgb:Aa.ADD,equationAlpha:Aa.ADD,functionSourceRgb:Eo.SOURCE_ALPHA,functionSourceAlpha:Eo.ONE,functionDestinationRgb:Eo.ONE,functionDestinationAlpha:Eo.ONE})},ln=Object.freeze(vTe);var PTe={FRONT:ee.FRONT,BACK:ee.BACK,FRONT_AND_BACK:ee.FRONT_AND_BACK},xi=Object.freeze(PTe);function gC(t){t=A(t,A.EMPTY_OBJECT),this.material=t.material,this.translucent=A(t.translucent,!0),this._vertexShaderSource=t.vertexShaderSource,this._fragmentShaderSource=t.fragmentShaderSource,this._renderState=t.renderState,this._closed=A(t.closed,!1)}Object.defineProperties(gC.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}}});gC.prototype.getFragmentShaderSource=function(){let t=[];return this.flat&&t.push("#define FLAT"),this.faceForward&&t.push("#define FACE_FORWARD"),f(this.material)&&t.push(this.material.shaderSource),t.push(this.fragmentShaderSource),t.join(`
`)};gC.prototype.isTranslucent=function(){return f(this.material)&&this.material.isTranslucent()||!f(this.material)&&this.translucent};gC.prototype.getRenderState=function(){let t=this.isTranslucent(),n=tt(this.renderState,!1);return t?(n.depthMask=!1,n.blending=ln.ALPHA_BLEND):n.depthMask=!0,n};gC.getDefaultRenderState=function(t,n,i){let o={depthTest:{enabled:!0}};return t&&(o.depthMask=!1,o.blending=ln.ALPHA_BLEND),n&&(o.cull={enabled:!0,face:xi.BACK}),f(i)&&(o=At(i,o,!0)),o};var Zi=gC;function ITe(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){let n=Math.random()*16|0;return(t==="x"?n:n&3|8).toString(16)})}var Bn=ITe;function yC(t,n,i,o,r){this._format=t,this._datatype=n,this._width=i,this._height=o,this._buffer=r}Object.defineProperties(yC.prototype,{internalFormat:{get:function(){return this._format}},pixelDatatype:{get:function(){return this._datatype}},width:{get:function(){return this._width}},height:{get:function(){return this._height}},bufferView:{get:function(){return this._buffer}}});yC.clone=function(t){if(!!f(t))return new yC(t._format,t._datatype,t._width,t._height,t._buffer)};yC.prototype.clone=function(){return yC.clone(this)};var r1=yC;var HX=yo(gl(),1);function GX(){if(!f(Zs._canTransferArrayBuffer)){let t=new Worker(jX("Workers/transferTypedArrayTest.js"));t.postMessage=A(t.webkitPostMessage,t.postMessage);let n=99,i=new Int8Array([n]);try{t.postMessage({array:i},[i.buffer])}catch(r){return Zs._canTransferArrayBuffer=!1,Zs._canTransferArrayBuffer}let o=Zr();t.onmessage=function(r){let s=r.data.array,a=f(s)&&s[0]===n;o.resolve(a),t.terminate(),Zs._canTransferArrayBuffer=a},Zs._canTransferArrayBuffer=o.promise}return Zs._canTransferArrayBuffer}var $H=new Ae;function WX(t,n){--t._activeTasks;let i=n.id;if(!f(i))return;let o=t._deferreds,r=o[i];if(f(n.error)){let s=n.error;s.name==="RuntimeError"?(s=new he(n.error.message),s.stack=n.error.stack):s.name==="DeveloperError"&&(s=new Ce(n.error.message),s.stack=n.error.stack),$H.raiseEvent(s),r.reject(s)}else $H.raiseEvent(),r.resolve(n.result);delete o[i]}function jX(t){let n=Qt(t);if(rC(n)){let i=`importScripts("${n}");`,o;try{o=new Blob([i],{type:"application/javascript"})}catch(s){let a=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,c=new a;c.append(i),o=c.getBlob("application/javascript")}n=(window.URL||window.webkitURL).createObjectURL(o)}return n}var QH;function BTe(){return f(QH)||(QH=jX("Workers/cesiumWorkerBootstrapper.js")),QH}function qX(t){let n=new Worker(BTe());n.postMessage=A(n.webkitPostMessage,n.postMessage);let i={loaderConfig:{paths:{Workers:Qt("Workers")},baseUrl:Qt.getCesiumBaseUrl().url},workerModule:t._workerPath};return n.postMessage(i),n.onmessage=function(o){WX(t,o.data)},n}function OTe(t,n){let i={modulePath:void 0,wasmBinaryFile:void 0,wasmBinary:void 0};if(!Vt.supportsWebAssembly()){if(!f(n.fallbackModulePath))throw new he(`This browser does not support Web Assembly, and no backup module was provided for ${t._workerPath}`);return i.modulePath=Qt(n.fallbackModulePath),Promise.resolve(i)}return i.modulePath=Qt(n.modulePath),i.wasmBinaryFile=Qt(n.wasmBinaryFile),Ie.fetchArrayBuffer({url:i.wasmBinaryFile}).then(function(o){return i.wasmBinary=o,i})}function Zs(t,n){let i=new HX.default(t);this._workerPath=i.scheme().length!==0&&i.fragment().length===0?t:Zs._workerModulePrefix+t,this._maximumActiveTasks=A(n,Number.POSITIVE_INFINITY),this._activeTasks=0,this._deferreds={},this._nextID=0}var RTe=[];Zs.prototype.scheduleTask=function(t,n){if(f(this._worker)||(this._worker=qX(this)),this._activeTasks>=this._maximumActiveTasks)return;++this._activeTasks;let i=this;return Promise.resolve(GX()).then(function(o){f(n)?o||(n.length=0):n=RTe;let r=i._nextID++,s=Zr();return i._deferreds[r]=s,i._worker.postMessage({id:r,parameters:t,canTransferArrayBuffer:o},n),s.promise})};Zs.prototype.initWebAssemblyModule=function(t){f(this._worker)||(this._worker=qX(this));let n=Zr(),i=this,o=this._worker;return OTe(this,t).then(function(r){return Promise.resolve(GX()).then(function(s){let a,c=r.wasmBinary;f(c)&&s&&(a=[c]),o.onmessage=function(l){o.onmessage=function(u){WX(i,u.data)},n.resolve(l.data)},o.postMessage({webAssemblyConfig:r},a)})}),n.promise};Zs.prototype.isDestroyed=function(){return!1};Zs.prototype.destroy=function(){return f(this._worker)&&this._worker.terminate(),ue(this)};Zs.taskCompletedEvent=$H;Zs._defaultWorkerModulePrefix="Workers/";Zs._workerModulePrefix=Zs._defaultWorkerModulePrefix;Zs._canTransferArrayBuffer=void 0;var fi=Zs;function am(){}am._transcodeTaskProcessor=new fi("transcodeKTX2",Number.POSITIVE_INFINITY);am._readyPromise=void 0;function MTe(){let t=am._transcodeTaskProcessor.initWebAssemblyModule({modulePath:"ThirdParty/Workers/basis_transcoder.js",wasmBinaryFile:"ThirdParty/basis_transcoder.wasm"}).then(function(){return am._transcodeTaskProcessor});am._readyPromise=t}am.transcode=function(t,n){return f(am._readyPromise)||MTe(),am._readyPromise.then(function(i){let o;if(t instanceof ArrayBuffer){let r=new Uint8Array(t);return o={supportedTargetFormats:n,ktx2Buffer:r},i.scheduleTask(o,[t])}return o={supportedTargetFormats:n,ktx2Buffer:t},i.scheduleTask(o,[t.buffer])}).then(function(i){let o=i.length,r=Object.keys(i[0]),s=r.length,a;for(a=0;a<o;a++){let c=i[a];for(let l=0;l<s;l++){let u=c[r[l]];c[r[l]]=new r1(u.internalFormat,u.datatype,u.width,u.height,u.levelBuffer)}}if(s===1){for(a=0;a<o;++a)i[a]=i[a][r[0]];o===1&&(i=i[0])}return i}).catch(function(i){throw i})};var s1=am;var YX;XX.setKTX2SupportedFormats=function(t,n,i,o,r,s){YX={s3tc:t,pvrtc:n,astc:i,etc:o,etc1:r,bc7:s}};function XX(t){let n;return t instanceof ArrayBuffer||ArrayBuffer.isView(t)?n=Promise.resolve(t):n=Ie.createIfNeeded(t).fetchArrayBuffer(),n.then(function(i){return s1.transcode(i,YX)})}var xl=XX;var pi={UNSIGNED_BYTE:ee.UNSIGNED_BYTE,UNSIGNED_SHORT:ee.UNSIGNED_SHORT,UNSIGNED_INT:ee.UNSIGNED_INT,FLOAT:ee.FLOAT,HALF_FLOAT:ee.HALF_FLOAT_OES,UNSIGNED_INT_24_8:ee.UNSIGNED_INT_24_8,UNSIGNED_SHORT_4_4_4_4:ee.UNSIGNED_SHORT_4_4_4_4,UNSIGNED_SHORT_5_5_5_1:ee.UNSIGNED_SHORT_5_5_5_1,UNSIGNED_SHORT_5_6_5:ee.UNSIGNED_SHORT_5_6_5};pi.toWebGLConstant=function(t,n){switch(t){case pi.UNSIGNED_BYTE:return ee.UNSIGNED_BYTE;case pi.UNSIGNED_SHORT:return ee.UNSIGNED_SHORT;case pi.UNSIGNED_INT:return ee.UNSIGNED_INT;case pi.FLOAT:return ee.FLOAT;case pi.HALF_FLOAT:return n.webgl2?ee.HALF_FLOAT:ee.HALF_FLOAT_OES;case pi.UNSIGNED_INT_24_8:return ee.UNSIGNED_INT_24_8;case pi.UNSIGNED_SHORT_4_4_4_4:return ee.UNSIGNED_SHORT_4_4_4_4;case pi.UNSIGNED_SHORT_5_5_5_1:return ee.UNSIGNED_SHORT_5_5_5_1;case pi.UNSIGNED_SHORT_5_6_5:return pi.UNSIGNED_SHORT_5_6_5}};pi.isPacked=function(t){return t===pi.UNSIGNED_INT_24_8||t===pi.UNSIGNED_SHORT_4_4_4_4||t===pi.UNSIGNED_SHORT_5_5_5_1||t===pi.UNSIGNED_SHORT_5_6_5};pi.sizeInBytes=function(t){switch(t){case pi.UNSIGNED_BYTE:return 1;case pi.UNSIGNED_SHORT:case pi.UNSIGNED_SHORT_4_4_4_4:case pi.UNSIGNED_SHORT_5_5_5_1:case pi.UNSIGNED_SHORT_5_6_5:case pi.HALF_FLOAT:return 2;case pi.UNSIGNED_INT:case pi.FLOAT:case pi.UNSIGNED_INT_24_8:return 4}};pi.validate=function(t){return t===pi.UNSIGNED_BYTE||t===pi.UNSIGNED_SHORT||t===pi.UNSIGNED_INT||t===pi.FLOAT||t===pi.HALF_FLOAT||t===pi.UNSIGNED_INT_24_8||t===pi.UNSIGNED_SHORT_4_4_4_4||t===pi.UNSIGNED_SHORT_5_5_5_1||t===pi.UNSIGNED_SHORT_5_6_5};var je=Object.freeze(pi);var ot={DEPTH_COMPONENT:ee.DEPTH_COMPONENT,DEPTH_STENCIL:ee.DEPTH_STENCIL,ALPHA:ee.ALPHA,RGB:ee.RGB,RGBA:ee.RGBA,LUMINANCE:ee.LUMINANCE,LUMINANCE_ALPHA:ee.LUMINANCE_ALPHA,RGB_DXT1:ee.COMPRESSED_RGB_S3TC_DXT1_EXT,RGBA_DXT1:ee.COMPRESSED_RGBA_S3TC_DXT1_EXT,RGBA_DXT3:ee.COMPRESSED_RGBA_S3TC_DXT3_EXT,RGBA_DXT5:ee.COMPRESSED_RGBA_S3TC_DXT5_EXT,RGB_PVRTC_4BPPV1:ee.COMPRESSED_RGB_PVRTC_4BPPV1_IMG,RGB_PVRTC_2BPPV1:ee.COMPRESSED_RGB_PVRTC_2BPPV1_IMG,RGBA_PVRTC_4BPPV1:ee.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG,RGBA_PVRTC_2BPPV1:ee.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG,RGBA_ASTC:ee.COMPRESSED_RGBA_ASTC_4x4_WEBGL,RGB_ETC1:ee.COMPRESSED_RGB_ETC1_WEBGL,RGB8_ETC2:ee.COMPRESSED_RGB8_ETC2,RGBA8_ETC2_EAC:ee.COMPRESSED_RGBA8_ETC2_EAC,RGBA_BC7:ee.COMPRESSED_RGBA_BPTC_UNORM};ot.componentsLength=function(t){switch(t){case ot.RGB:return 3;case ot.RGBA:return 4;case ot.LUMINANCE_ALPHA:return 2;case ot.ALPHA:case ot.LUMINANCE:return 1;default:return 1}};ot.validate=function(t){return t===ot.DEPTH_COMPONENT||t===ot.DEPTH_STENCIL||t===ot.ALPHA||t===ot.RGB||t===ot.RGBA||t===ot.LUMINANCE||t===ot.LUMINANCE_ALPHA||t===ot.RGB_DXT1||t===ot.RGBA_DXT1||t===ot.RGBA_DXT3||t===ot.RGBA_DXT5||t===ot.RGB_PVRTC_4BPPV1||t===ot.RGB_PVRTC_2BPPV1||t===ot.RGBA_PVRTC_4BPPV1||t===ot.RGBA_PVRTC_2BPPV1||t===ot.RGBA_ASTC||t===ot.RGB_ETC1||t===ot.RGB8_ETC2||t===ot.RGBA8_ETC2_EAC||t===ot.RGBA_BC7};ot.isColorFormat=function(t){return t===ot.ALPHA||t===ot.RGB||t===ot.RGBA||t===ot.LUMINANCE||t===ot.LUMINANCE_ALPHA};ot.isDepthFormat=function(t){return t===ot.DEPTH_COMPONENT||t===ot.DEPTH_STENCIL};ot.isCompressedFormat=function(t){return t===ot.RGB_DXT1||t===ot.RGBA_DXT1||t===ot.RGBA_DXT3||t===ot.RGBA_DXT5||t===ot.RGB_PVRTC_4BPPV1||t===ot.RGB_PVRTC_2BPPV1||t===ot.RGBA_PVRTC_4BPPV1||t===ot.RGBA_PVRTC_2BPPV1||t===ot.RGBA_ASTC||t===ot.RGB_ETC1||t===ot.RGB8_ETC2||t===ot.RGBA8_ETC2_EAC||t===ot.RGBA_BC7};ot.isDXTFormat=function(t){return t===ot.RGB_DXT1||t===ot.RGBA_DXT1||t===ot.RGBA_DXT3||t===ot.RGBA_DXT5};ot.isPVRTCFormat=function(t){return t===ot.RGB_PVRTC_4BPPV1||t===ot.RGB_PVRTC_2BPPV1||t===ot.RGBA_PVRTC_4BPPV1||t===ot.RGBA_PVRTC_2BPPV1};ot.isASTCFormat=function(t){return t===ot.RGBA_ASTC};ot.isETC1Format=function(t){return t===ot.RGB_ETC1};ot.isETC2Format=function(t){return t===ot.RGB8_ETC2||t===ot.RGBA8_ETC2_EAC};ot.isBC7Format=function(t){return t===ot.RGBA_BC7};ot.compressedTextureSizeInBytes=function(t,n,i){switch(t){case ot.RGB_DXT1:case ot.RGBA_DXT1:case ot.RGB_ETC1:case ot.RGB8_ETC2:return Math.floor((n+3)/4)*Math.floor((i+3)/4)*8;case ot.RGBA_DXT3:case ot.RGBA_DXT5:case ot.RGBA_ASTC:case ot.RGBA8_ETC2_EAC:return Math.floor((n+3)/4)*Math.floor((i+3)/4)*16;case ot.RGB_PVRTC_4BPPV1:case ot.RGBA_PVRTC_4BPPV1:return Math.floor((Math.max(n,8)*Math.max(i,8)*4+7)/8);case ot.RGB_PVRTC_2BPPV1:case ot.RGBA_PVRTC_2BPPV1:return Math.floor((Math.max(n,16)*Math.max(i,8)*2+7)/8);case ot.RGBA_BC7:return Math.ceil(n/4)*Math.ceil(i/4)*16;default:return 0}};ot.textureSizeInBytes=function(t,n,i,o){let r=ot.componentsLength(t);return je.isPacked(n)&&(r=1),r*je.sizeInBytes(n)*i*o};ot.alignmentInBytes=function(t,n,i){let o=ot.textureSizeInBytes(t,n,i,1)%4;return o===0?4:o===2?2:1};ot.createTypedArray=function(t,n,i,o){let r,s=je.sizeInBytes(n);s===Uint8Array.BYTES_PER_ELEMENT?r=Uint8Array:s===Uint16Array.BYTES_PER_ELEMENT?r=Uint16Array:s===Float32Array.BYTES_PER_ELEMENT&&n===je.FLOAT?r=Float32Array:r=Uint32Array;let a=ot.componentsLength(t)*i*o;return new r(a)};ot.flipY=function(t,n,i,o,r){if(r===1)return t;let s=ot.createTypedArray(n,i,o,r),a=ot.componentsLength(n),c=o*a;for(let l=0;l<r;++l){let u=l*o*a,d=(r-l-1)*o*a;for(let h=0;h<c;++h)s[d+h]=t[u+h]}return s};ot.toInternalFormat=function(t,n,i){if(!i.webgl2)return t;if(t===ot.DEPTH_STENCIL)return ee.DEPTH24_STENCIL8;if(t===ot.DEPTH_COMPONENT){if(n===je.UNSIGNED_SHORT)return ee.DEPTH_COMPONENT16;if(n===je.UNSIGNED_INT)return ee.DEPTH_COMPONENT24}if(n===je.FLOAT)switch(t){case ot.RGBA:return ee.RGBA32F;case ot.RGB:return ee.RGB32F;case ot.RG:return ee.RG32F;case ot.R:return ee.R32F}if(n===je.HALF_FLOAT)switch(t){case ot.RGBA:return ee.RGBA16F;case ot.RGB:return ee.RGB16F;case ot.RG:return ee.RG16F;case ot.R:return ee.R16F}return t};var st=Object.freeze(ot);var rr={_maximumCombinedTextureImageUnits:0,_maximumCubeMapSize:0,_maximumFragmentUniformVectors:0,_maximumTextureImageUnits:0,_maximumRenderbufferSize:0,_maximumTextureSize:0,_maximumVaryingVectors:0,_maximumVertexAttributes:0,_maximumVertexTextureImageUnits:0,_maximumVertexUniformVectors:0,_minimumAliasedLineWidth:0,_maximumAliasedLineWidth:0,_minimumAliasedPointSize:0,_maximumAliasedPointSize:0,_maximumViewportWidth:0,_maximumViewportHeight:0,_maximumTextureFilterAnisotropy:0,_maximumDrawBuffers:0,_maximumColorAttachments:0,_maximumSamples:0,_highpFloatSupported:!1,_highpIntSupported:!1};Object.defineProperties(rr,{maximumCombinedTextureImageUnits:{get:function(){return rr._maximumCombinedTextureImageUnits}},maximumCubeMapSize:{get:function(){return rr._maximumCubeMapSize}},maximumFragmentUniformVectors:{get:function(){return rr._maximumFragmentUniformVectors}},maximumTextureImageUnits:{get:function(){return rr._maximumTextureImageUnits}},maximumRenderbufferSize:{get:function(){return rr._maximumRenderbufferSize}},maximumTextureSize:{get:function(){return rr._maximumTextureSize}},maximumVaryingVectors:{get:function(){return rr._maximumVaryingVectors}},maximumVertexAttributes:{get:function(){return rr._maximumVertexAttributes}},maximumVertexTextureImageUnits:{get:function(){return rr._maximumVertexTextureImageUnits}},maximumVertexUniformVectors:{get:function(){return rr._maximumVertexUniformVectors}},minimumAliasedLineWidth:{get:function(){return rr._minimumAliasedLineWidth}},maximumAliasedLineWidth:{get:function(){return rr._maximumAliasedLineWidth}},minimumAliasedPointSize:{get:function(){return rr._minimumAliasedPointSize}},maximumAliasedPointSize:{get:function(){return rr._maximumAliasedPointSize}},maximumViewportWidth:{get:function(){return rr._maximumViewportWidth}},maximumViewportHeight:{get:function(){return rr._maximumViewportHeight}},maximumTextureFilterAnisotropy:{get:function(){return rr._maximumTextureFilterAnisotropy}},maximumDrawBuffers:{get:function(){return rr._maximumDrawBuffers}},maximumColorAttachments:{get:function(){return rr._maximumColorAttachments}},maximumSamples:{get:function(){return rr._maximumSamples}},highpFloatSupported:{get:function(){return rr._highpFloatSupported}},highpIntSupported:{get:function(){return rr._highpIntSupported}}});var Ut=rr;function a1(t,n,i,o,r,s,a,c,l,u,d){this._context=t,this._texture=n,this._textureTarget=i,this._targetFace=o,this._pixelDatatype=a,this._internalFormat=r,this._pixelFormat=s,this._size=c,this._preMultiplyAlpha=l,this._flipY=u,this._initialized=d}Object.defineProperties(a1.prototype,{pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},_target:{get:function(){return this._targetFace}}});a1.prototype.copyFrom=function(t){let n=A(t.xOffset,0),i=A(t.yOffset,0),o=t.source,r=this._context._gl,s=this._textureTarget,a=this._targetFace;r.activeTexture(r.TEXTURE0),r.bindTexture(s,this._texture);let c=o.width,l=o.height,u=o.arrayBufferView,d=this._size,h=this._pixelFormat,_=this._internalFormat,y=this._pixelDatatype,p=this._preMultiplyAlpha,C=this._flipY,x=A(t.skipColorSpaceConversion,!1),T=4;f(u)&&(T=st.alignmentInBytes(h,y,c)),r.pixelStorei(r.UNPACK_ALIGNMENT,T),x?r.pixelStorei(r.UNPACK_COLORSPACE_CONVERSION_WEBGL,r.NONE):r.pixelStorei(r.UNPACK_COLORSPACE_CONVERSION_WEBGL,r.BROWSER_DEFAULT_WEBGL);let E=!1;if(!this._initialized){if(n===0&&i===0&&c===d&&l===d)f(u)?(r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!1),C&&(u=st.flipY(u,h,y,d,d)),r.texImage2D(a,0,_,d,d,0,h,je.toWebGLConstant(y,this._context),u)):(r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,p),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,C),r.texImage2D(a,0,_,h,je.toWebGLConstant(y,this._context),o)),E=!0;else{r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!1);let S=st.createTypedArray(h,y,d,d);r.texImage2D(a,0,_,d,d,0,h,je.toWebGLConstant(y,this._context),S)}this._initialized=!0}E||(f(u)?(r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!1),C&&(u=st.flipY(u,h,y,c,l)),r.texSubImage2D(a,0,n,i,c,l,h,je.toWebGLConstant(y,this._context),u)):(r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,p),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,C),r.texSubImage2D(a,0,n,i,h,je.toWebGLConstant(y,this._context),o))),r.bindTexture(s,null)};a1.prototype.copyFromFramebuffer=function(t,n,i,o,r,s){t=A(t,0),n=A(n,0),i=A(i,0),o=A(o,0),r=A(r,this._size),s=A(s,this._size);let a=this._context._gl,c=this._textureTarget;a.activeTexture(a.TEXTURE0),a.bindTexture(c,this._texture),a.copyTexSubImage2D(this._targetFace,0,t,n,i,o,r,s),a.bindTexture(c,null),this._initialized=!0};var cm=a1;var c1={DONT_CARE:ee.DONT_CARE,FASTEST:ee.FASTEST,NICEST:ee.NICEST,validate:function(t){return t===c1.DONT_CARE||t===c1.FASTEST||t===c1.NICEST}},lm=Object.freeze(c1);var l1={NEAREST:ee.NEAREST,LINEAR:ee.LINEAR};l1.validate=function(t){return t===l1.NEAREST||t===l1.LINEAR};var Qi=Object.freeze(l1);var Up={NEAREST:ee.NEAREST,LINEAR:ee.LINEAR,NEAREST_MIPMAP_NEAREST:ee.NEAREST_MIPMAP_NEAREST,LINEAR_MIPMAP_NEAREST:ee.LINEAR_MIPMAP_NEAREST,NEAREST_MIPMAP_LINEAR:ee.NEAREST_MIPMAP_LINEAR,LINEAR_MIPMAP_LINEAR:ee.LINEAR_MIPMAP_LINEAR};Up.validate=function(t){return t===Up.NEAREST||t===Up.LINEAR||t===Up.NEAREST_MIPMAP_NEAREST||t===Up.LINEAR_MIPMAP_NEAREST||t===Up.NEAREST_MIPMAP_LINEAR||t===Up.LINEAR_MIPMAP_LINEAR};var fn=Object.freeze(Up);var u1={CLAMP_TO_EDGE:ee.CLAMP_TO_EDGE,REPEAT:ee.REPEAT,MIRRORED_REPEAT:ee.MIRRORED_REPEAT,validate:function(t){return t===u1.CLAMP_TO_EDGE||t===u1.REPEAT||t===u1.MIRRORED_REPEAT}},Mn=Object.freeze(u1);function Ib(t){t=A(t,A.EMPTY_OBJECT);let n=A(t.wrapS,Mn.CLAMP_TO_EDGE),i=A(t.wrapT,Mn.CLAMP_TO_EDGE),o=A(t.minificationFilter,fn.LINEAR),r=A(t.magnificationFilter,Qi.LINEAR),s=f(t.maximumAnisotropy)?t.maximumAnisotropy:1;this._wrapS=n,this._wrapT=i,this._minificationFilter=o,this._magnificationFilter=r,this._maximumAnisotropy=s}Object.defineProperties(Ib.prototype,{wrapS:{get:function(){return this._wrapS}},wrapT:{get:function(){return this._wrapT}},minificationFilter:{get:function(){return this._minificationFilter}},magnificationFilter:{get:function(){return this._magnificationFilter}},maximumAnisotropy:{get:function(){return this._maximumAnisotropy}}});Ib.equals=function(t,n){return t===n||f(t)&&f(n)&&t._wrapS===n._wrapS&&t._wrapT===n._wrapT&&t._minificationFilter===n._minificationFilter&&t._magnificationFilter===n._magnificationFilter&&t._maximumAnisotropy===n._maximumAnisotropy};Ib.NEAREST=Object.freeze(new Ib({wrapS:Mn.CLAMP_TO_EDGE,wrapT:Mn.CLAMP_TO_EDGE,minificationFilter:fn.NEAREST,magnificationFilter:Qi.NEAREST}));var pn=Ib;function Bb(t){t=A(t,A.EMPTY_OBJECT);let n=t.context,i=t.source,o,r;if(f(i)){let E=[i.positiveX,i.negativeX,i.positiveY,i.negativeY,i.positiveZ,i.negativeZ];o=E[0].width,r=E[0].height}else o=t.width,r=t.height;let s=o,a=A(t.pixelDatatype,je.UNSIGNED_BYTE),c=A(t.pixelFormat,st.RGBA),l=st.toInternalFormat(c,a,n),u=st.textureSizeInBytes(c,a,s,s)*6,d=t.preMultiplyAlpha||c===st.RGB||c===st.LUMINANCE,h=A(t.flipY,!0),_=A(t.skipColorSpaceConversion,!1),y=n._gl,p=y.TEXTURE_CUBE_MAP,C=y.createTexture();y.activeTexture(y.TEXTURE0),y.bindTexture(p,C);function x(E,S,w,D,I){let O=S.arrayBufferView;f(O)||(O=S.bufferView);let M=4;f(O)&&(M=st.alignmentInBytes(c,a,o)),y.pixelStorei(y.UNPACK_ALIGNMENT,M),I?y.pixelStorei(y.UNPACK_COLORSPACE_CONVERSION_WEBGL,y.NONE):y.pixelStorei(y.UNPACK_COLORSPACE_CONVERSION_WEBGL,y.BROWSER_DEFAULT_WEBGL),f(O)?(y.pixelStorei(y.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),y.pixelStorei(y.UNPACK_FLIP_Y_WEBGL,!1),D&&(O=st.flipY(O,c,a,s,s)),y.texImage2D(E,0,l,s,s,0,c,je.toWebGLConstant(a,n),O)):(y.pixelStorei(y.UNPACK_PREMULTIPLY_ALPHA_WEBGL,w),y.pixelStorei(y.UNPACK_FLIP_Y_WEBGL,D),y.texImage2D(E,0,l,c,je.toWebGLConstant(a,n),S))}f(i)?(x(y.TEXTURE_CUBE_MAP_POSITIVE_X,i.positiveX,d,h,_),x(y.TEXTURE_CUBE_MAP_NEGATIVE_X,i.negativeX,d,h,_),x(y.TEXTURE_CUBE_MAP_POSITIVE_Y,i.positiveY,d,h,_),x(y.TEXTURE_CUBE_MAP_NEGATIVE_Y,i.negativeY,d,h,_),x(y.TEXTURE_CUBE_MAP_POSITIVE_Z,i.positiveZ,d,h,_),x(y.TEXTURE_CUBE_MAP_NEGATIVE_Z,i.negativeZ,d,h,_)):(y.texImage2D(y.TEXTURE_CUBE_MAP_POSITIVE_X,0,l,s,s,0,c,je.toWebGLConstant(a,n),null),y.texImage2D(y.TEXTURE_CUBE_MAP_NEGATIVE_X,0,l,s,s,0,c,je.toWebGLConstant(a,n),null),y.texImage2D(y.TEXTURE_CUBE_MAP_POSITIVE_Y,0,l,s,s,0,c,je.toWebGLConstant(a,n),null),y.texImage2D(y.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,l,s,s,0,c,je.toWebGLConstant(a,n),null),y.texImage2D(y.TEXTURE_CUBE_MAP_POSITIVE_Z,0,l,s,s,0,c,je.toWebGLConstant(a,n),null),y.texImage2D(y.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,l,s,s,0,c,je.toWebGLConstant(a,n),null)),y.bindTexture(p,null),this._context=n,this._textureFilterAnisotropic=n._textureFilterAnisotropic,this._textureTarget=p,this._texture=C,this._pixelFormat=c,this._pixelDatatype=a,this._size=s,this._hasMipmap=!1,this._sizeInBytes=u,this._preMultiplyAlpha=d,this._flipY=h,this._sampler=void 0;let T=f(i);this._positiveX=new cm(n,C,p,y.TEXTURE_CUBE_MAP_POSITIVE_X,l,c,a,s,d,h,T),this._negativeX=new cm(n,C,p,y.TEXTURE_CUBE_MAP_NEGATIVE_X,l,c,a,s,d,h,T),this._positiveY=new cm(n,C,p,y.TEXTURE_CUBE_MAP_POSITIVE_Y,l,c,a,s,d,h,T),this._negativeY=new cm(n,C,p,y.TEXTURE_CUBE_MAP_NEGATIVE_Y,l,c,a,s,d,h,T),this._positiveZ=new cm(n,C,p,y.TEXTURE_CUBE_MAP_POSITIVE_Z,l,c,a,s,d,h,T),this._negativeZ=new cm(n,C,p,y.TEXTURE_CUBE_MAP_NEGATIVE_Z,l,c,a,s,d,h,T),this.sampler=f(t.sampler)?t.sampler:new pn}Object.defineProperties(Bb.prototype,{positiveX:{get:function(){return this._positiveX}},negativeX:{get:function(){return this._negativeX}},positiveY:{get:function(){return this._positiveY}},negativeY:{get:function(){return this._negativeY}},positiveZ:{get:function(){return this._positiveZ}},negativeZ:{get:function(){return this._negativeZ}},sampler:{get:function(){return this._sampler},set:function(t){let n=t.minificationFilter,i=t.magnificationFilter,o=n===fn.NEAREST_MIPMAP_NEAREST||n===fn.NEAREST_MIPMAP_LINEAR||n===fn.LINEAR_MIPMAP_NEAREST||n===fn.LINEAR_MIPMAP_LINEAR,r=this._context,s=this._pixelDatatype;(s===je.FLOAT&&!r.textureFloatLinear||s===je.HALF_FLOAT&&!r.textureHalfFloatLinear)&&(n=o?fn.NEAREST_MIPMAP_NEAREST:fn.NEAREST,i=Qi.NEAREST);let a=r._gl,c=this._textureTarget;a.activeTexture(a.TEXTURE0),a.bindTexture(c,this._texture),a.texParameteri(c,a.TEXTURE_MIN_FILTER,n),a.texParameteri(c,a.TEXTURE_MAG_FILTER,i),a.texParameteri(c,a.TEXTURE_WRAP_S,t.wrapS),a.texParameteri(c,a.TEXTURE_WRAP_T,t.wrapT),f(this._textureFilterAnisotropic)&&a.texParameteri(c,this._textureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,t.maximumAnisotropy),a.bindTexture(c,null),this._sampler=t}},pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},width:{get:function(){return this._size}},height:{get:function(){return this._size}},sizeInBytes:{get:function(){return this._hasMipmap?Math.floor(this._sizeInBytes*4/3):this._sizeInBytes}},preMultiplyAlpha:{get:function(){return this._preMultiplyAlpha}},flipY:{get:function(){return this._flipY}},_target:{get:function(){return this._textureTarget}}});Bb.prototype.generateMipmap=function(t){t=A(t,lm.DONT_CARE),this._hasMipmap=!0;let n=this._context._gl,i=this._textureTarget;n.hint(n.GENERATE_MIPMAP_HINT,t),n.activeTexture(n.TEXTURE0),n.bindTexture(i,this._texture),n.generateMipmap(i),n.bindTexture(i,null)};Bb.prototype.isDestroyed=function(){return!1};Bb.prototype.destroy=function(){return this._context._gl.deleteTexture(this._texture),this._positiveX=ue(this._positiveX),this._negativeX=ue(this._negativeX),this._positiveY=ue(this._positiveY),this._negativeY=ue(this._negativeY),this._positiveZ=ue(this._positiveZ),this._negativeZ=ue(this._negativeZ),ue(this)};var tc=Bb;function Cf(t){t=A(t,A.EMPTY_OBJECT);let n=t.context,i=t.width,o=t.height,r=t.source;f(r)&&(f(i)||(i=A(r.videoWidth,r.width)),f(o)||(o=A(r.videoHeight,r.height)));let s=A(t.pixelFormat,st.RGBA),a=A(t.pixelDatatype,je.UNSIGNED_BYTE),c=st.toInternalFormat(s,a,n),l=st.isCompressedFormat(c),u=t.preMultiplyAlpha||s===st.RGB||s===st.LUMINANCE,d=A(t.flipY,!0),h=A(t.skipColorSpaceConversion,!1),_=!0,y=n._gl,p=y.TEXTURE_2D,C=y.createTexture();y.activeTexture(y.TEXTURE0),y.bindTexture(p,C);let x=4;if(f(r)&&f(r.arrayBufferView)&&!l&&(x=st.alignmentInBytes(s,a,i)),y.pixelStorei(y.UNPACK_ALIGNMENT,x),h?y.pixelStorei(y.UNPACK_COLORSPACE_CONVERSION_WEBGL,y.NONE):y.pixelStorei(y.UNPACK_COLORSPACE_CONVERSION_WEBGL,y.BROWSER_DEFAULT_WEBGL),f(r))if(f(r.arrayBufferView)){y.pixelStorei(y.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),y.pixelStorei(y.UNPACK_FLIP_Y_WEBGL,!1);let E=r.arrayBufferView,S,w,D;if(l){if(y.compressedTexImage2D(p,0,c,i,o,0,E),f(r.mipLevels))for(w=i,D=o,S=0;S<r.mipLevels.length;++S)w=Math.floor(w/2)|0,w<1&&(w=1),D=Math.floor(D/2)|0,D<1&&(D=1),y.compressedTexImage2D(p,S+1,c,w,D,0,r.mipLevels[S])}else if(d&&(E=st.flipY(E,s,a,i,o)),y.texImage2D(p,0,c,i,o,0,s,je.toWebGLConstant(a,n),E),f(r.mipLevels))for(w=i,D=o,S=0;S<r.mipLevels.length;++S)w=Math.floor(w/2)|0,w<1&&(w=1),D=Math.floor(D/2)|0,D<1&&(D=1),y.texImage2D(p,S+1,c,w,D,0,s,je.toWebGLConstant(a,n),r.mipLevels[S])}else f(r.framebuffer)?(y.pixelStorei(y.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),y.pixelStorei(y.UNPACK_FLIP_Y_WEBGL,!1),r.framebuffer!==n.defaultFramebuffer&&r.framebuffer._bind(),y.copyTexImage2D(p,0,c,r.xOffset,r.yOffset,i,o,0),r.framebuffer!==n.defaultFramebuffer&&r.framebuffer._unBind()):(y.pixelStorei(y.UNPACK_PREMULTIPLY_ALPHA_WEBGL,u),y.pixelStorei(y.UNPACK_FLIP_Y_WEBGL,d),y.texImage2D(p,0,c,s,je.toWebGLConstant(a,n),r));else y.texImage2D(p,0,c,i,o,0,s,je.toWebGLConstant(a,n),null),_=!1;y.bindTexture(p,null);let T;l?T=st.compressedTextureSizeInBytes(s,i,o):T=st.textureSizeInBytes(s,a,i,o),this._id=Bn(),this._context=n,this._textureFilterAnisotropic=n._textureFilterAnisotropic,this._textureTarget=p,this._texture=C,this._internalFormat=c,this._pixelFormat=s,this._pixelDatatype=a,this._width=i,this._height=o,this._dimensions=new W(i,o),this._hasMipmap=!1,this._sizeInBytes=T,this._preMultiplyAlpha=u,this._flipY=d,this._initialized=_,this._sampler=void 0,this.sampler=f(t.sampler)?t.sampler:new pn}Cf.create=function(t){return new Cf(t)};Cf.fromFramebuffer=function(t){t=A(t,A.EMPTY_OBJECT);let n=t.context,i=n._gl,o=A(t.pixelFormat,st.RGB),r=A(t.framebufferXOffset,0),s=A(t.framebufferYOffset,0),a=A(t.width,i.drawingBufferWidth),c=A(t.height,i.drawingBufferHeight),l=t.framebuffer;return new Cf({context:n,width:a,height:c,pixelFormat:o,source:{framebuffer:f(l)?l:n.defaultFramebuffer,xOffset:r,yOffset:s,width:a,height:c}})};Object.defineProperties(Cf.prototype,{id:{get:function(){return this._id}},sampler:{get:function(){return this._sampler},set:function(t){let n=t.minificationFilter,i=t.magnificationFilter,o=this._context,r=this._pixelFormat,s=this._pixelDatatype,a=n===fn.NEAREST_MIPMAP_NEAREST||n===fn.NEAREST_MIPMAP_LINEAR||n===fn.LINEAR_MIPMAP_NEAREST||n===fn.LINEAR_MIPMAP_LINEAR;(s===je.FLOAT&&!o.textureFloatLinear||s===je.HALF_FLOAT&&!o.textureHalfFloatLinear)&&(n=a?fn.NEAREST_MIPMAP_NEAREST:fn.NEAREST,i=Qi.NEAREST),o.webgl2&&st.isDepthFormat(r)&&(n=fn.NEAREST,i=Qi.NEAREST);let c=o._gl,l=this._textureTarget;c.activeTexture(c.TEXTURE0),c.bindTexture(l,this._texture),c.texParameteri(l,c.TEXTURE_MIN_FILTER,n),c.texParameteri(l,c.TEXTURE_MAG_FILTER,i),c.texParameteri(l,c.TEXTURE_WRAP_S,t.wrapS),c.texParameteri(l,c.TEXTURE_WRAP_T,t.wrapT),f(this._textureFilterAnisotropic)&&c.texParameteri(l,this._textureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,t.maximumAnisotropy),c.bindTexture(l,null),this._sampler=t}},pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},dimensions:{get:function(){return this._dimensions}},preMultiplyAlpha:{get:function(){return this._preMultiplyAlpha}},flipY:{get:function(){return this._flipY}},width:{get:function(){return this._width}},height:{get:function(){return this._height}},sizeInBytes:{get:function(){return this._hasMipmap?Math.floor(this._sizeInBytes*4/3):this._sizeInBytes}},_target:{get:function(){return this._textureTarget}}});Cf.prototype.copyFrom=function(t){let n=A(t.xOffset,0),i=A(t.yOffset,0),o=t.source,r=this._context,s=r._gl,a=this._textureTarget;s.activeTexture(s.TEXTURE0),s.bindTexture(a,this._texture);let c=o.width,l=o.height,u=o.arrayBufferView,d=this._width,h=this._height,_=this._internalFormat,y=this._pixelFormat,p=this._pixelDatatype,C=this._preMultiplyAlpha,x=this._flipY,T=A(t.skipColorSpaceConversion,!1),E=4;f(u)&&(E=st.alignmentInBytes(y,p,c)),s.pixelStorei(s.UNPACK_ALIGNMENT,E),T?s.pixelStorei(s.UNPACK_COLORSPACE_CONVERSION_WEBGL,s.NONE):s.pixelStorei(s.UNPACK_COLORSPACE_CONVERSION_WEBGL,s.BROWSER_DEFAULT_WEBGL);let S=!1;if(!this._initialized){if(n===0&&i===0&&c===d&&l===h)f(u)?(s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,!1),x&&(u=st.flipY(u,y,p,d,h)),s.texImage2D(a,0,_,d,h,0,y,je.toWebGLConstant(p,r),u)):(s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,C),s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,x),s.texImage2D(a,0,_,y,je.toWebGLConstant(p,r),o)),S=!0;else{s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,!1);let w=st.createTypedArray(y,p,d,h);s.texImage2D(a,0,_,d,h,0,y,je.toWebGLConstant(p,r),w)}this._initialized=!0}S||(f(u)?(s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,!1),x&&(u=st.flipY(u,y,p,c,l)),s.texSubImage2D(a,0,n,i,c,l,y,je.toWebGLConstant(p,r),u)):(s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,C),s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,x),s.texSubImage2D(a,0,n,i,y,je.toWebGLConstant(p,r),o))),s.bindTexture(a,null)};Cf.prototype.copyFromFramebuffer=function(t,n,i,o,r,s){t=A(t,0),n=A(n,0),i=A(i,0),o=A(o,0),r=A(r,this._width),s=A(s,this._height);let a=this._context._gl,c=this._textureTarget;a.activeTexture(a.TEXTURE0),a.bindTexture(c,this._texture),a.copyTexSubImage2D(c,0,t,n,i,o,r,s),a.bindTexture(c,null),this._initialized=!0};Cf.prototype.generateMipmap=function(t){t=A(t,lm.DONT_CARE),this._hasMipmap=!0;let n=this._context._gl,i=this._textureTarget;n.hint(n.GENERATE_MIPMAP_HINT,t),n.activeTexture(n.TEXTURE0),n.bindTexture(i,this._texture),n.generateMipmap(i),n.bindTexture(i,null)};Cf.prototype.isDestroyed=function(){return!1};Cf.prototype.destroy=function(){return this._context._gl.deleteTexture(this._texture),ue(this)};var St=Cf;var f1=`uniform sampler2D image;
czm_material czm_getMaterial(czm_materialInput materialInput)
{
czm_material material = czm_getDefaultMaterial(materialInput);
vec4 rampColor = texture2D(image, vec2(materialInput.aspect / (2.0 * czm_pi), 0.5));
rampColor = czm_gammaCorrect(rampColor);
material.diffuse = rampColor.rgb;
material.alpha = rampColor.a;
return material;
}
`;var d1=`uniform sampler2D image;
uniform float strength;
uniform vec2 repeat;
czm_material czm_getMaterial(czm_materialInput materialInput)
{
czm_material material = czm_getDefaultMaterial(materialInput);
vec2 st = materialInput.st;
vec2 centerPixel = fract(repeat * st);
float centerBump = texture2D(image, centerPixel).channel;
float imageWidth = float(imageDimensions.x);
vec2 rightPixel = fract(repeat * (st + vec2(1.0 / imageWidth, 0.0)));
float rightBump = texture2D(image, rightPixel).channel;
float imageHeight = float(imageDimensions.y);
vec2 leftPixel = fract(repeat * (st + vec2(0.0, 1.0 / imageHeight)));
float topBump = texture2D(image, leftPixel).channel;
vec3 normalTangentSpace = normalize(vec3(centerBump - rightBump, centerBump - topBump, clamp(1.0 - strength, 0.1, 1.0)));
vec3 normalEC = materialInput.tangentToEyeMatrix * normalTangentSpace;
material.normal = normalEC;
material.diffuse = vec3(0.01);
return material;
}
`;var h1=`uniform vec4 lightColor;
uniform vec4 darkColor;
uniform vec2 repeat;
czm_material czm_getMaterial(czm_materialInput materialInput)
{
czm_material material = czm_getDefaultMaterial(materialInput);
vec2 st = materialInput.st;
float b = mod(floor(repeat.s * st.s) + floor(repeat.t * st.t), 2.0);
float scaledWidth = fract(repeat.s * st.s);
scaledWidth = abs(scaledWidth - floor(scaledWidth + 0.5));
float scaledHeight = fract(repeat.t * st.t);
scaledHeight = abs(scaledHeight - floor(scaledHeight + 0.5));
float value = min(scaledWidth, scaledHeight);
vec4 currentColor = mix(lightColor, darkColor, b);
vec4 color = czm_antialias(lightColor, darkColor, currentColor, value, 0.03);
color = czm_gammaCorrect(color);
material.diffuse = color.rgb;
material.alpha = color.a;
return material;
}
`;var m1=`uniform vec4 lightColor;
uniform vec4 darkColor;
uniform vec2 repeat;
czm_material czm_getMaterial(czm_materialInput materialInput)
{
czm_material material = czm_getDefaultMaterial(materialInput);
float b = smoothstep(0.3, 0.32, length(fract(repeat * materialInput.st) - 0.5));
vec4 color = mix(lightColor, darkColor, b);
color = czm_gammaCorrect(color);
material.diffuse = color.rgb;
material.alpha = color.a;
return material;
}
`;var p1=`uniform sampler2D heights;
uniform sampler2D colors;
float getHeight(int idx, float invTexSize)
{
vec2 uv = vec2((float(idx) + 0.5) * invTexSize, 0.5);
#ifdef OES_texture_float
return texture2D(heights, uv).x;
#else
return czm_unpackFloat(texture2D(heights, uv));
#endif
}
czm_material czm_getMaterial(czm_materialInput materialInput)
{
czm_material material = czm_getDefaultMaterial(materialInput);
float height = materialInput.height;
float invTexSize = 1.0 / float(heightsDimensions.x);
float minHeight = getHeight(0, invTexSize);
float maxHeight = getHeight(heightsDimensions.x - 1, invTexSize);
if (height < minHeight || height > maxHeight) {
material.diffuse = vec3(0.0);
material.alpha = 0.0;
return material;
}
int idxBelow = 0;
int idxAbove = heightsDimensions.x;
float heightBelow = minHeight;
float heightAbove = maxHeight;
const int maxIterations = 16;
for (int i = 0; i < maxIterations; i++) {
if (idxBelow >= idxAbove - 1) {
break;
}
int idxMid = (idxBelow + idxAbove) / 2;
float heightTex = getHeight(idxMid, invTexSize);
if (height > heightTex) {
idxBelow = idxMid;
heightBelow = heightTex;
} else {
idxAbove = idxMid;
heightAbove = heightTex;
}
}
float lerper = heightBelow == heightAbove ? 1.0 : (height - heightBelow) / (heightAbove - heightBelow);
vec2 colorUv = vec2(invTexSize * (float(idxBelow) + 0.5 + lerper), 0.5);
vec4 color = texture2D(colors, colorUv);
if (color.a > 0.0)
{
color.rgb /= color.a;
}
color.rgb = czm_gammaCorrect(color.rgb);
material.diffuse = color.rgb;
material.alpha = color.a;
return material;
}
`;var _1=`#ifdef GL_OES_standard_derivatives
#extension GL_OES_standard_derivatives : enable
#endif
uniform vec4 color;
uniform float spacing;
uniform float width;
czm_material czm_getMaterial(czm_materialInput materialInput)
{
czm_material material = czm_getDefaultMaterial(materialInput);
float distanceToContour = mod(materialInput.height, spacing);
#ifdef GL_OES_standard_derivatives
float dxc = abs(dFdx(materialInput.height));
float dyc = abs(dFdy(materialInput.height));
float dF = max(dxc, dyc) * czm_pixelRatio * width;
float alpha = (distanceToContour < dF) ? 1.0 : 0.0;
#else
float alpha = (distanceToContour < (czm_pixelRatio * width)) ? 1.0 : 0.0;
#endif
vec4 outColor = czm_gammaCorrect(vec4(color.rgb, alpha * color.a));
material.diffuse = outColor.rgb;
material.alpha = outColor.a;
return material;
}
`;var g1=`uniform sampler2D image;
uniform float minimumHeight;
uniform float maximumHeight;
czm_material czm_getMaterial(czm_materialInput materialInput)
{
czm_material material = czm_getDefaultMaterial(materialInput);
float scaledHeight = clamp((materialInput.height - minimumHeight) / (maximumHeight - minimumHeight), 0.0, 1.0);
vec4 rampColor = texture2D(image, vec2(scaledHeight, 0.5));
rampColor = czm_gammaCorrect(rampColor);
material.diffuse = rampColor.rgb;
material.alpha = rampColor.a;
return material;
}
`;var y1=`uniform vec4 fadeInColor;
uniform vec4 fadeOutColor;
uniform float maximumDistance;
uniform bool repeat;
uniform vec2 fadeDirection;
uniform vec2 time;
float getTime(float t, float coord)
{
float scalar = 1.0 / maximumDistance;
float q  = distance(t, coord) * scalar;
if (repeat)
{
float r = distance(t, coord + 1.0) * scalar;
float s = distance(t, coord - 1.0) * scalar;
q = min(min(r, s), q);
}
return clamp(q, 0.0, 1.0);
}
czm_material czm_getMaterial(czm_materialInput materialInput)
{
czm_material material = czm_getDefaultMaterial(materialInput);
vec2 st = materialInput.st;
float s = getTime(time.x, st.s) * fadeDirection.s;
float t = getTime(time.y, st.t) * fadeDirection.t;
float u = length(vec2(s, t));
vec4 color = mix(fadeInColor, fadeOutColor, u);
color = czm_gammaCorrect(color);
material.emission = color.rgb;
material.alpha = color.a;
return material;
}
`;var A1=`#ifdef GL_OES_standard_derivatives
#extension GL_OES_standard_derivatives : enable
#endif
uniform vec4 color;
uniform float cellAlpha;
uniform vec2 lineCount;
uniform vec2 lineThickness;
uniform vec2 lineOffset;
czm_material czm_getMaterial(czm_materialInput materialInput)
{
czm_material material = czm_getDefaultMaterial(materialInput);
vec2 st = materialInput.st;
float scaledWidth = fract(lineCount.s * st.s - lineOffset.s);
scaledWidth = abs(scaledWidth - floor(scaledWidth + 0.5));
float scaledHeight = fract(lineCount.t * st.t - lineOffset.t);
scaledHeight = abs(scaledHeight - floor(scaledHeight + 0.5));
float value;
#ifdef GL_OES_standard_derivatives
const float fuzz = 1.2;
vec2 thickness = (lineThickness * czm_pixelRatio) - 1.0;
vec2 dx = abs(dFdx(st));
vec2 dy = abs(dFdy(st));
vec2 dF = vec2(max(dx.s, dy.s), max(dx.t, dy.t)) * lineCount;
value = min(
smoothstep(dF.s * thickness.s, dF.s * (fuzz + thickness.s), scaledWidth),
smoothstep(dF.t * thickness.t, dF.t * (fuzz + thickness.t), scaledHeight));
#else
const float fuzz = 0.05;
vec2 range = 0.5 - (lineThickness * 0.05);
value = min(
1.0 - smoothstep(range.s, range.s + fuzz, scaledWidth),
1.0 - smoothstep(range.t, range.t + fuzz, scaledHeight));
#endif
float dRim = 1.0 - abs(dot(materialInput.normalEC, normalize(materialInput.positionToEyeEC)));
float sRim = smoothstep(0.8, 1.0, dRim);
value *= (1.0 - sRim);
vec4 halfColor;
halfColor.rgb = color.rgb * 0.5;
halfColor.a = color.a * (1.0 - ((1.0 - cellAlpha) * value));
halfColor = czm_gammaCorrect(halfColor);
material.diffuse = halfColor.rgb;
material.emission = halfColor.rgb;
material.alpha = halfColor.a;
return material;
}
`;var C1=`uniform sampler2D image;
uniform float strength;
uniform vec2 repeat;
czm_material czm_getMaterial(czm_materialInput materialInput)
{
czm_material material = czm_getDefaultMaterial(materialInput);
vec4 textureValue = texture2D(image, fract(repeat * materialInput.st));
vec3 normalTangentSpace = textureValue.channels;
normalTangentSpace.xy = normalTangentSpace.xy * 2.0 - 1.0;
normalTangentSpace.z = clamp(1.0 - strength, 0.1, 1.0);
normalTangentSpace = normalize(normalTangentSpace);
vec3 normalEC = materialInput.tangentToEyeMatrix * normalTangentSpace;
material.normal = normalEC;
return material;
}
`;var x1=`#ifdef GL_OES_standard_derivatives
#extension GL_OES_standard_derivatives : enable
#endif
uniform vec4 color;
float getPointOnLine(vec2 p0, vec2 p1, float x)
{
float slope = (p0.y - p1.y) / (p0.x - p1.x);
return slope * (x - p0.x) + p0.y;
}
czm_material czm_getMaterial(czm_materialInput materialInput)
{
czm_material material = czm_getDefaultMaterial(materialInput);
vec2 st = materialInput.st;
#ifdef GL_OES_standard_derivatives
float base = 1.0 - abs(fwidth(st.s)) * 10.0 * czm_pixelRatio;
#else
float base = 0.975;
#endif
vec2 center = vec2(1.0, 0.5);
float ptOnUpperLine = getPointOnLine(vec2(base, 1.0), center, st.s);
float ptOnLowerLine = getPointOnLine(vec2(base, 0.0), center, st.s);
float halfWidth = 0.15;
float s = step(0.5 - halfWidth, st.t);
s *= 1.0 - step(0.5 + halfWidth, st.t);
s *= 1.0 - step(base, st.s);
float t = step(base, materialInput.st.s);
t *= 1.0 - step(ptOnUpperLine, st.t);
t *= step(ptOnLowerLine, st.t);
float dist;
if (st.s < base)
{
float d1 = abs(st.t - (0.5 - halfWidth));
float d2 = abs(st.t - (0.5 + halfWidth));
dist = min(d1, d2);
}
else
{
float d1 = czm_infinity;
if (st.t < 0.5 - halfWidth && st.t > 0.5 + halfWidth)
{
d1 = abs(st.s - base);
}
float d2 = abs(st.t - ptOnUpperLine);
float d3 = abs(st.t - ptOnLowerLine);
dist = min(min(d1, d2), d3);
}
vec4 outsideColor = vec4(0.0);
vec4 currentColor = mix(outsideColor, color, clamp(s + t, 0.0, 1.0));
vec4 outColor = czm_antialias(outsideColor, color, currentColor, dist);
outColor = czm_gammaCorrect(outColor);
material.diffuse = outColor.rgb;
material.alpha = outColor.a;
return material;
}
`;var T1=`uniform vec4 color;
uniform vec4 gapColor;
uniform float dashLength;
uniform float dashPattern;
varying float v_polylineAngle;
const float maskLength = 16.0;
mat2 rotate(float rad) {
float c = cos(rad);
float s = sin(rad);
return mat2(
c, s,
-s, c
);
}
czm_material czm_getMaterial(czm_materialInput materialInput)
{
czm_material material = czm_getDefaultMaterial(materialInput);
vec2 pos = rotate(v_polylineAngle) * gl_FragCoord.xy;
float dashPosition = fract(pos.x / (dashLength * czm_pixelRatio));
float maskIndex = floor(dashPosition * maskLength);
float maskTest = floor(dashPattern / pow(2.0, maskIndex));
vec4 fragColor = (mod(maskTest, 2.0) < 1.0) ? gapColor : color;
if (fragColor.a < 0.005) {
discard;
}
fragColor = czm_gammaCorrect(fragColor);
material.emission = fragColor.rgb;
material.alpha = fragColor.a;
return material;
}
`;var E1=`uniform vec4 color;
uniform float glowPower;
uniform float taperPower;
czm_material czm_getMaterial(czm_materialInput materialInput)
{
czm_material material = czm_getDefaultMaterial(materialInput);
vec2 st = materialInput.st;
float glow = glowPower / abs(st.t - 0.5) - (glowPower / 0.5);
if (taperPower <= 0.99999) {
glow *= min(1.0, taperPower / (0.5 - st.s * 0.5) - (taperPower / 0.5));
}
vec4 fragColor;
fragColor.rgb = max(vec3(glow - 1.0 + color.rgb), color.rgb);
fragColor.a = clamp(0.0, 1.0, glow) * color.a;
fragColor = czm_gammaCorrect(fragColor);
material.emission = fragColor.rgb;
material.alpha = fragColor.a;
return material;
}
`;var b1=`uniform vec4 color;
uniform vec4 outlineColor;
uniform float outlineWidth;
varying float v_width;
czm_material czm_getMaterial(czm_materialInput materialInput)
{
czm_material material = czm_getDefaultMaterial(materialInput);
vec2 st = materialInput.st;
float halfInteriorWidth =  0.5 * (v_width - outlineWidth) / v_width;
float b = step(0.5 - halfInteriorWidth, st.t);
b *= 1.0 - step(0.5 + halfInteriorWidth, st.t);
float d1 = abs(st.t - (0.5 - halfInteriorWidth));
float d2 = abs(st.t - (0.5 + halfInteriorWidth));
float dist = min(d1, d2);
vec4 currentColor = mix(outlineColor, color, b);
vec4 outColor = czm_antialias(outlineColor, color, currentColor, dist);
outColor = czm_gammaCorrect(outColor);
material.diffuse = outColor.rgb;
material.alpha = outColor.a;
return material;
}
`;var S1=`uniform vec4 color;
uniform vec4 rimColor;
uniform float width;
czm_material czm_getMaterial(czm_materialInput materialInput)
{
czm_material material = czm_getDefaultMaterial(materialInput);
float d = 1.0 - dot(materialInput.normalEC, normalize(materialInput.positionToEyeEC));
float s = smoothstep(1.0 - width, 1.0, d);
vec4 outColor = czm_gammaCorrect(color);
vec4 outRimColor = czm_gammaCorrect(rimColor);
material.diffuse = outColor.rgb;
material.emission = outRimColor.rgb * s;
material.alpha = mix(outColor.a, outRimColor.a, s);
return material;
}
`;var w1=`uniform sampler2D image;
czm_material czm_getMaterial(czm_materialInput materialInput)
{
czm_material material = czm_getDefaultMaterial(materialInput);
vec4 rampColor = texture2D(image, vec2(materialInput.slope / (czm_pi / 2.0), 0.5));
rampColor = czm_gammaCorrect(rampColor);
material.diffuse = rampColor.rgb;
material.alpha = rampColor.a;
return material;
}
`;var D1=`uniform vec4 evenColor;
uniform vec4 oddColor;
uniform float offset;
uniform float repeat;
uniform bool horizontal;
czm_material czm_getMaterial(czm_materialInput materialInput)
{
czm_material material = czm_getDefaultMaterial(materialInput);
float coord = mix(materialInput.st.s, materialInput.st.t, float(horizontal));
float value = fract((coord - offset) * (repeat * 0.5));
float dist = min(value, min(abs(value - 0.5), 1.0 - value));
vec4 currentColor = mix(evenColor, oddColor, step(0.5, value));
vec4 color = czm_antialias(evenColor, oddColor, currentColor, dist);
color = czm_gammaCorrect(color);
material.diffuse = color.rgb;
material.alpha = color.a;
return material;
}
`;var v1=`uniform sampler2D specularMap;
uniform sampler2D normalMap;
uniform vec4 baseWaterColor;
uniform vec4 blendColor;
uniform float frequency;
uniform float animationSpeed;
uniform float amplitude;
uniform float specularIntensity;
uniform float fadeFactor;
czm_material czm_getMaterial(czm_materialInput materialInput)
{
czm_material material = czm_getDefaultMaterial(materialInput);
float time = czm_frameNumber * animationSpeed;
float fade = max(1.0, (length(materialInput.positionToEyeEC) / 10000000000.0) * frequency * fadeFactor);
float specularMapValue = texture2D(specularMap, materialInput.st).r;
vec4 noise = czm_getWaterNoise(normalMap, materialInput.st * frequency, time, 0.0);
vec3 normalTangentSpace = noise.xyz * vec3(1.0, 1.0, (1.0 / amplitude));
normalTangentSpace.xy /= fade;
normalTangentSpace = mix(vec3(0.0, 0.0, 50.0), normalTangentSpace, specularMapValue);
normalTangentSpace = normalize(normalTangentSpace);
float tsPerturbationRatio = clamp(dot(normalTangentSpace, vec3(0.0, 0.0, 1.0)), 0.0, 1.0);
material.alpha = mix(blendColor.a, baseWaterColor.a, specularMapValue) * specularMapValue;
material.diffuse = mix(blendColor.rgb, baseWaterColor.rgb, specularMapValue);
material.diffuse += (0.1 * tsPerturbationRatio);
material.diffuse = material.diffuse;
material.normal = normalize(materialInput.tangentToEyeMatrix * normalTangentSpace);
material.specular = specularIntensity;
material.shininess = 10.0;
return material;
}
`;function We(t){this.type=void 0,this.shaderSource=void 0,this.materials=void 0,this.uniforms=void 0,this._uniforms=void 0,this.translucent=void 0,this._minificationFilter=A(t.minificationFilter,fn.LINEAR),this._magnificationFilter=A(t.magnificationFilter,Qi.LINEAR),this._strict=void 0,this._template=void 0,this._count=void 0,this._texturePaths={},this._loadedImages=[],this._loadedCubeMaps=[],this._textures={},this._updateFunctions=[],this._defaultTexture=void 0,LTe(t,this),Object.defineProperties(this,{type:{value:this.type,writable:!1}}),f(We._uniformList[this.type])||(We._uniformList[this.type]=Object.keys(this._uniforms))}We._uniformList={};We.fromType=function(t,n){let i=new We({fabric:{type:t}});if(f(n))for(let o in n)n.hasOwnProperty(o)&&(i.uniforms[o]=n[o]);return i};We.prototype.isTranslucent=function(){if(f(this.translucent))return typeof this.translucent=="function"?this.translucent():this.translucent;let t=!0,n=this._translucentFunctions,i=n.length;for(let o=0;o<i;++o){let r=n[o];if(typeof r=="function"?t=t&&r():t=t&&r,!t)break}return t};We.prototype.update=function(t){this._defaultTexture=t.defaultTexture;let n,i,o=this._loadedImages,r=o.length;for(n=0;n<r;++n){let l=o[n];i=l.id;let u=l.image,d;Array.isArray(u)&&(d=u.slice(1,u.length).map(function(C){return C.bufferView}),u=u[0]);let h=new pn({minificationFilter:this._minificationFilter,magnificationFilter:this._magnificationFilter}),_;f(u.internalFormat)?_=new St({context:t,pixelFormat:u.internalFormat,width:u.width,height:u.height,source:{arrayBufferView:u.bufferView,mipLevels:d},sampler:h}):_=new St({context:t,source:u,sampler:h});let y=this._textures[i];f(y)&&y!==this._defaultTexture&&y.destroy(),this._textures[i]=_;let p=`${i}Dimensions`;if(this.uniforms.hasOwnProperty(p)){let C=this.uniforms[p];C.x=_._width,C.y=_._height}}o.length=0;let s=this._loadedCubeMaps;for(r=s.length,n=0;n<r;++n){let l=s[n];i=l.id;let u=l.images,d=new tc({context:t,source:{positiveX:u[0],negativeX:u[1],positiveY:u[2],negativeY:u[3],positiveZ:u[4],negativeZ:u[5]},sampler:new pn({minificationFilter:this._minificationFilter,magnificationFilter:this._magnificationFilter})});this._textures[i]=d}s.length=0;let a=this._updateFunctions;for(r=a.length,n=0;n<r;++n)a[n](this,t);let c=this.materials;for(let l in c)c.hasOwnProperty(l)&&c[l].update(t)};We.prototype.isDestroyed=function(){return!1};We.prototype.destroy=function(){let t=this._textures;for(let i in t)if(t.hasOwnProperty(i)){let o=t[i];o!==this._defaultTexture&&o.destroy()}let n=this.materials;for(let i in n)n.hasOwnProperty(i)&&n[i].destroy();return ue(this)};function LTe(t,n){t=A(t,A.EMPTY_OBJECT),n._strict=A(t.strict,!1),n._count=A(t.count,0),n._template=tt(A(t.fabric,A.EMPTY_OBJECT)),n._template.uniforms=tt(A(n._template.uniforms,A.EMPTY_OBJECT)),n._template.materials=tt(A(n._template.materials,A.EMPTY_OBJECT)),n.type=f(n._template.type)?n._template.type:Bn(),n.shaderSource="",n.materials={},n.uniforms={},n._uniforms={},n._translucentFunctions=[];let i,o=We._materialCache.getMaterial(n.type);if(f(o)){let s=tt(o.fabric,!0);n._template=At(n._template,s,!0),i=o.translucent}kTe(n),f(o)||We._materialCache.addMaterial(n.type,n),zTe(n),jTe(n),YTe(n);let r=n._translucentFunctions.length===0?!0:void 0;if(i=A(i,r),i=A(t.translucent,i),f(i))if(typeof i=="function"){let s=function(){return i(n)};n._translucentFunctions.push(s)}else n._translucentFunctions.push(i)}function e8(t,n,i,o){if(f(t)){for(let r in t)if(t.hasOwnProperty(r)){let s=n.indexOf(r)!==-1;(o&&!s||!o&&s)&&i(r,n)}}}function KX(t,n){}function FTe(t,n){}var NTe=["type","materials","uniforms","components","source"],VTe=["diffuse","specular","shininess","normal","emission","alpha"];function kTe(t){let n=t._template,i=n.uniforms,o=n.materials,r=n.components;e8(n,NTe,KX,!0),e8(r,VTe,KX,!0);let s=[];for(let a in o)o.hasOwnProperty(a)&&s.push(a);e8(i,s,FTe,!1)}function UTe(t,n){let i=n._template.materials;for(let o in i)if(i.hasOwnProperty(o)&&t.indexOf(o)>-1)return!0;return!1}function zTe(t){let n=t._template.components,i=t._template.source;if(f(i))t.shaderSource+=`${i}
`;else{if(t.shaderSource+=`czm_material czm_getMaterial(czm_materialInput materialInput)
{
`,t.shaderSource+=`czm_material material = czm_getDefaultMaterial(materialInput);
`,f(n)){let o=Object.keys(t._template.materials).length>0;for(let r in n)if(n.hasOwnProperty(r))if(r==="diffuse"||r==="emission"){let a=o&&UTe(n[r],t)?n[r]:`czm_gammaCorrect(${n[r]})`;t.shaderSource+=`material.${r} = ${a}; 
`}else r==="alpha"?t.shaderSource+=`material.alpha = ${n.alpha}; 
`:t.shaderSource+=`material.${r} = ${n[r]};
`}t.shaderSource+=`return material;
}
`}}var JX={mat2:Ji,mat3:$,mat4:N},HTe=/\.ktx2$/i;function GTe(t){let n;return function(i,o){let r=i.uniforms,s=r[t],a=n!==s,c=!f(s)||s===We.DefaultImageId;n=s;let l=i._textures[t],u,d;if(s instanceof HTMLVideoElement){if(s.readyState>=2){if(a&&f(l)&&(l!==o.defaultTexture&&l.destroy(),l=void 0),!f(l)||l===o.defaultTexture){let _=new pn({minificationFilter:i._minificationFilter,magnificationFilter:i._magnificationFilter});l=new St({context:o,source:s,sampler:_}),i._textures[t]=l;return}l.copyFrom({source:s})}else f(l)||(i._textures[t]=o.defaultTexture);return}if(s instanceof St&&s!==l){i._texturePaths[t]=void 0;let _=i._textures[t];f(_)&&_!==i._defaultTexture&&_.destroy(),i._textures[t]=s,u=`${t}Dimensions`,r.hasOwnProperty(u)&&(d=r[u],d.x=s._width,d.y=s._height);return}if(a&&f(l)&&c&&(l!==i._defaultTexture&&l.destroy(),l=void 0),f(l)||(i._texturePaths[t]=void 0,l=i._textures[t]=i._defaultTexture,u=`${t}Dimensions`,r.hasOwnProperty(u)&&(d=r[u],d.x=l._width,d.y=l._height)),c)return;let h=s instanceof Ie;if(!f(i._texturePaths[t])||h&&s.url!==i._texturePaths[t].url||!h&&s!==i._texturePaths[t]){if(typeof s=="string"||h){let _=h?s:Ie.createIfNeeded(s),y;HTe.test(_.url)?y=xl(_.url):y=_.fetchImage(),Promise.resolve(y).then(function(p){i._loadedImages.push({id:t,image:p})}).catch(function(){f(l)&&l!==i._defaultTexture&&l.destroy(),i._textures[t]=i._defaultTexture})}else(s instanceof HTMLCanvasElement||s instanceof HTMLImageElement)&&i._loadedImages.push({id:t,image:s});i._texturePaths[t]=s}}}function WTe(t){return function(n,i){let o=n.uniforms[t];if(o instanceof tc){let s=n._textures[t];s!==n._defaultTexture&&s.destroy(),n._texturePaths[t]=void 0,n._textures[t]=o;return}if(f(n._textures[t])||(n._texturePaths[t]=void 0,n._textures[t]=i.defaultCubeMap),o===We.DefaultCubeMapId)return;let r=o.positiveX+o.negativeX+o.positiveY+o.negativeY+o.positiveZ+o.negativeZ;if(r!==n._texturePaths[t]){let s=[Ie.createIfNeeded(o.positiveX).fetchImage(),Ie.createIfNeeded(o.negativeX).fetchImage(),Ie.createIfNeeded(o.positiveY).fetchImage(),Ie.createIfNeeded(o.negativeY).fetchImage(),Ie.createIfNeeded(o.positiveZ).fetchImage(),Ie.createIfNeeded(o.negativeZ).fetchImage()];Promise.all(s).then(function(a){n._loadedCubeMaps.push({id:t,images:a})}),n._texturePaths[t]=r}}}function jTe(t){let n=t._template.uniforms;for(let i in n)n.hasOwnProperty(i)&&ZX(t,i)}function ZX(t,n){let i=t._strict,o=t._template.uniforms,r=o[n],s=qTe(r),a;if(s==="channels")a=Ob(t,n,r,!1);else{if(s==="sampler2D"){let u=`${n}Dimensions`;XTe(t,u)>0&&(o[u]={type:"ivec3",x:1,y:1},ZX(t,u))}if(!new RegExp(`uniform\\s+${s}\\s+${n}\\s*;`).test(t.shaderSource)){let u=`uniform ${s} ${n};`;t.shaderSource=u+t.shaderSource}let l=`${n}_${t._count++}`;if(a=Ob(t,n,l),t.uniforms[n]=r,s==="sampler2D")t._uniforms[l]=function(){return t._textures[n]},t._updateFunctions.push(GTe(n));else if(s==="samplerCube")t._uniforms[l]=function(){return t._textures[n]},t._updateFunctions.push(WTe(n));else if(s.indexOf("mat")!==-1){let u=new JX[s];t._uniforms[l]=function(){return JX[s].fromColumnMajorArray(t.uniforms[n],u)}}else t._uniforms[l]=function(){return t.uniforms[n]}}}function qTe(t){let n=t.type;if(!f(n)){let i=typeof t;if(i==="number")n="float";else if(i==="boolean")n="bool";else if(i==="string"||t instanceof Ie||t instanceof HTMLCanvasElement||t instanceof HTMLImageElement)/^([rgba]){1,4}$/i.test(t)?n="channels":t===We.DefaultCubeMapId?n="samplerCube":n="sampler2D";else if(i==="object")if(Array.isArray(t))(t.length===4||t.length===9||t.length===16)&&(n=`mat${Math.sqrt(t.length)}`);else{let o=0;for(let r in t)t.hasOwnProperty(r)&&(o+=1);o>=2&&o<=4?n=`vec${o}`:o===6&&(n="samplerCube")}}return n}function YTe(t){let n=t._strict,i=t._template.materials;for(let o in i)if(i.hasOwnProperty(o)){let r=new We({strict:n,fabric:i[o],count:t._count});t._count=r._count,t._uniforms=At(t._uniforms,r._uniforms,!0),t.materials[o]=r,t._translucentFunctions=t._translucentFunctions.concat(r._translucentFunctions);let s="czm_getMaterial",a=`${s}_${t._count++}`;Ob(r,s,a),t.shaderSource=r.shaderSource+t.shaderSource;let c=`${a}(materialInput)`,l=Ob(t,o,c)}}function Ob(t,n,i,o){o=A(o,!0);let r=0,s="([\\w])?",a=`([\\w${o?".":""}])?`,c=new RegExp(a+n+s,"g");return t.shaderSource=t.shaderSource.replace(c,function(l,u,d){return u||d?l:(r+=1,i)}),r}function XTe(t,n,i){return Ob(t,n,n,i)}We._materialCache={_materials:{},addMaterial:function(t,n){this._materials[t]=n},getMaterial:function(t){return this._materials[t]}};We.DefaultImageId="czm_defaultImage";We.DefaultCubeMapId="czm_defaultCubeMap";We.ColorType="Color";We._materialCache.addMaterial(We.ColorType,{fabric:{type:We.ColorType,uniforms:{color:new z(1,0,0,.5)},components:{diffuse:"color.rgb",alpha:"color.a"}},translucent:function(t){return t.uniforms.color.alpha<1}});We.ImageType="Image";We._materialCache.addMaterial(We.ImageType,{fabric:{type:We.ImageType,uniforms:{image:We.DefaultImageId,repeat:new W(1,1),color:new z(1,1,1,1)},components:{diffuse:"texture2D(image, fract(repeat * materialInput.st)).rgb * color.rgb",alpha:"texture2D(image, fract(repeat * materialInput.st)).a * color.a"}},translucent:function(t){return t.uniforms.color.alpha<1}});We.DiffuseMapType="DiffuseMap";We._materialCache.addMaterial(We.DiffuseMapType,{fabric:{type:We.DiffuseMapType,uniforms:{image:We.DefaultImageId,channels:"rgb",repeat:new W(1,1)},components:{diffuse:"texture2D(image, fract(repeat * materialInput.st)).channels"}},translucent:!1});We.AlphaMapType="AlphaMap";We._materialCache.addMaterial(We.AlphaMapType,{fabric:{type:We.AlphaMapType,uniforms:{image:We.DefaultImageId,channel:"a",repeat:new W(1,1)},components:{alpha:"texture2D(image, fract(repeat * materialInput.st)).channel"}},translucent:!0});We.SpecularMapType="SpecularMap";We._materialCache.addMaterial(We.SpecularMapType,{fabric:{type:We.SpecularMapType,uniforms:{image:We.DefaultImageId,channel:"r",repeat:new W(1,1)},components:{specular:"texture2D(image, fract(repeat * materialInput.st)).channel"}},translucent:!1});We.EmissionMapType="EmissionMap";We._materialCache.addMaterial(We.EmissionMapType,{fabric:{type:We.EmissionMapType,uniforms:{image:We.DefaultImageId,channels:"rgb",repeat:new W(1,1)},components:{emission:"texture2D(image, fract(repeat * materialInput.st)).channels"}},translucent:!1});We.BumpMapType="BumpMap";We._materialCache.addMaterial(We.BumpMapType,{fabric:{type:We.BumpMapType,uniforms:{image:We.DefaultImageId,channel:"r",strength:.8,repeat:new W(1,1)},source:d1},translucent:!1});We.NormalMapType="NormalMap";We._materialCache.addMaterial(We.NormalMapType,{fabric:{type:We.NormalMapType,uniforms:{image:We.DefaultImageId,channels:"rgb",strength:.8,repeat:new W(1,1)},source:C1},translucent:!1});We.GridType="Grid";We._materialCache.addMaterial(We.GridType,{fabric:{type:We.GridType,uniforms:{color:new z(0,1,0,1),cellAlpha:.1,lineCount:new W(8,8),lineThickness:new W(1,1),lineOffset:new W(0,0)},source:A1},translucent:function(t){let n=t.uniforms;return n.color.alpha<1||n.cellAlpha<1}});We.StripeType="Stripe";We._materialCache.addMaterial(We.StripeType,{fabric:{type:We.StripeType,uniforms:{horizontal:!0,evenColor:new z(1,1,1,.5),oddColor:new z(0,0,1,.5),offset:0,repeat:5},source:D1},translucent:function(t){let n=t.uniforms;return n.evenColor.alpha<1||n.oddColor.alpha<1}});We.CheckerboardType="Checkerboard";We._materialCache.addMaterial(We.CheckerboardType,{fabric:{type:We.CheckerboardType,uniforms:{lightColor:new z(1,1,1,.5),darkColor:new z(0,0,0,.5),repeat:new W(5,5)},source:h1},translucent:function(t){let n=t.uniforms;return n.lightColor.alpha<1||n.darkColor.alpha<1}});We.DotType="Dot";We._materialCache.addMaterial(We.DotType,{fabric:{type:We.DotType,uniforms:{lightColor:new z(1,1,0,.75),darkColor:new z(0,1,1,.75),repeat:new W(5,5)},source:m1},translucent:function(t){let n=t.uniforms;return n.lightColor.alpha<1||n.darkColor.alpha<1}});We.WaterType="Water";We._materialCache.addMaterial(We.WaterType,{fabric:{type:We.WaterType,uniforms:{baseWaterColor:new z(.2,.3,.6,1),blendColor:new z(0,1,.699,1),specularMap:We.DefaultImageId,normalMap:We.DefaultImageId,frequency:10,animationSpeed:.01,amplitude:1,specularIntensity:.5,fadeFactor:1},source:v1},translucent:function(t){let n=t.uniforms;return n.baseWaterColor.alpha<1||n.blendColor.alpha<1}});We.RimLightingType="RimLighting";We._materialCache.addMaterial(We.RimLightingType,{fabric:{type:We.RimLightingType,uniforms:{color:new z(1,0,0,.7),rimColor:new z(1,1,1,.4),width:.3},source:S1},translucent:function(t){let n=t.uniforms;return n.color.alpha<1||n.rimColor.alpha<1}});We.FadeType="Fade";We._materialCache.addMaterial(We.FadeType,{fabric:{type:We.FadeType,uniforms:{fadeInColor:new z(1,0,0,1),fadeOutColor:new z(0,0,0,0),maximumDistance:.5,repeat:!0,fadeDirection:{x:!0,y:!0},time:new W(.5,.5)},source:y1},translucent:function(t){let n=t.uniforms;return n.fadeInColor.alpha<1||n.fadeOutColor.alpha<1}});We.PolylineArrowType="PolylineArrow";We._materialCache.addMaterial(We.PolylineArrowType,{fabric:{type:We.PolylineArrowType,uniforms:{color:new z(1,1,1,1)},source:x1},translucent:!0});We.PolylineDashType="PolylineDash";We._materialCache.addMaterial(We.PolylineDashType,{fabric:{type:We.PolylineDashType,uniforms:{color:new z(1,0,1,1),gapColor:new z(0,0,0,0),dashLength:16,dashPattern:255},source:T1},translucent:!0});We.PolylineGlowType="PolylineGlow";We._materialCache.addMaterial(We.PolylineGlowType,{fabric:{type:We.PolylineGlowType,uniforms:{color:new z(0,.5,1,1),glowPower:.25,taperPower:1},source:E1},translucent:!0});We.PolylineOutlineType="PolylineOutline";We._materialCache.addMaterial(We.PolylineOutlineType,{fabric:{type:We.PolylineOutlineType,uniforms:{color:new z(1,1,1,1),outlineColor:new z(1,0,0,1),outlineWidth:1},source:b1},translucent:function(t){let n=t.uniforms;return n.color.alpha<1||n.outlineColor.alpha<1}});We.ElevationContourType="ElevationContour";We._materialCache.addMaterial(We.ElevationContourType,{fabric:{type:We.ElevationContourType,uniforms:{spacing:100,color:new z(1,0,0,1),width:1},source:_1},translucent:!1});We.ElevationRampType="ElevationRamp";We._materialCache.addMaterial(We.ElevationRampType,{fabric:{type:We.ElevationRampType,uniforms:{image:We.DefaultImageId,minimumHeight:0,maximumHeight:1e4},source:g1},translucent:!1});We.SlopeRampMaterialType="SlopeRamp";We._materialCache.addMaterial(We.SlopeRampMaterialType,{fabric:{type:We.SlopeRampMaterialType,uniforms:{image:We.DefaultImageId},source:w1},translucent:!1});We.AspectRampMaterialType="AspectRamp";We._materialCache.addMaterial(We.AspectRampMaterialType,{fabric:{type:We.AspectRampMaterialType,uniforms:{image:We.DefaultImageId},source:f1},translucent:!1});We.ElevationBandType="ElevationBand";We._materialCache.addMaterial(We.ElevationBandType,{fabric:{type:We.ElevationBandType,uniforms:{heights:We.DefaultImageId,colors:We.DefaultImageId},source:p1},translucent:!0});var $i=We;function A0(t){t=A(t,A.EMPTY_OBJECT);let n=A(t.translucent,!0),i=A(t.closed,!1),o=A(t.materialSupport,A0.MaterialSupport.TEXTURED);this.material=f(t.material)?t.material:$i.fromType($i.ColorType),this.translucent=n,this._vertexShaderSource=A(t.vertexShaderSource,o.vertexShaderSource),this._fragmentShaderSource=A(t.fragmentShaderSource,o.fragmentShaderSource),this._renderState=Zi.getDefaultRenderState(n,i,t.renderState),this._closed=i,this._materialSupport=o,this._vertexFormat=o.vertexFormat,this._flat=A(t.flat,!1),this._faceForward=A(t.faceForward,!i)}Object.defineProperties(A0.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},materialSupport:{get:function(){return this._materialSupport}},vertexFormat:{get:function(){return this._vertexFormat}},flat:{get:function(){return this._flat}},faceForward:{get:function(){return this._faceForward}}});A0.prototype.getFragmentShaderSource=Zi.prototype.getFragmentShaderSource;A0.prototype.isTranslucent=Zi.prototype.isTranslucent;A0.prototype.getRenderState=Zi.prototype.getRenderState;A0.MaterialSupport={BASIC:Object.freeze({vertexFormat:De.POSITION_AND_NORMAL,vertexShaderSource:n1,fragmentShaderSource:t1}),TEXTURED:Object.freeze({vertexFormat:De.POSITION_NORMAL_AND_ST,vertexShaderSource:o1,fragmentShaderSource:i1}),ALL:Object.freeze({vertexFormat:De.ALL,vertexShaderSource:e1,fragmentShaderSource:$P})};var ro=A0;var P1=`varying vec3 v_positionEC;
varying vec3 v_normalEC;
varying vec4 v_color;
void main()
{
vec3 positionToEyeEC = -v_positionEC;
vec3 normalEC = normalize(v_normalEC);
#ifdef FACE_FORWARD
normalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);
#endif
vec4 color = czm_gammaCorrect(v_color);
czm_materialInput materialInput;
materialInput.normalEC = normalEC;
materialInput.positionToEyeEC = positionToEyeEC;
czm_material material = czm_getDefaultMaterial(materialInput);
material.diffuse = color.rgb;
material.alpha = color.a;
gl_FragColor = czm_phong(normalize(positionToEyeEC), material, czm_lightDirectionEC);
}
`;var I1=`attribute vec3 position3DHigh;
attribute vec3 position3DLow;
attribute vec3 normal;
attribute vec4 color;
attribute float batchId;
varying vec3 v_positionEC;
varying vec3 v_normalEC;
varying vec4 v_color;
void main()
{
vec4 p = czm_computePosition();
v_positionEC = (czm_modelViewRelativeToEye * p).xyz;
v_normalEC = czm_normal * normal;
v_color = color;
gl_Position = czm_modelViewProjectionRelativeToEye * p;
}
`;var AC=`varying vec4 v_color;
void main()
{
gl_FragColor = czm_gammaCorrect(v_color);
}
`;var B1=`attribute vec3 position3DHigh;
attribute vec3 position3DLow;
attribute vec4 color;
attribute float batchId;
varying vec4 v_color;
void main()
{
vec4 p = czm_computePosition();
v_color = color;
gl_Position = czm_modelViewProjectionRelativeToEye * p;
}
`;function um(t){t=A(t,A.EMPTY_OBJECT);let n=A(t.translucent,!0),i=A(t.closed,!1),o=A(t.flat,!1),r=o?B1:I1,s=o?AC:P1,a=o?um.FLAT_VERTEX_FORMAT:um.VERTEX_FORMAT;this.material=void 0,this.translucent=n,this._vertexShaderSource=A(t.vertexShaderSource,r),this._fragmentShaderSource=A(t.fragmentShaderSource,s),this._renderState=Zi.getDefaultRenderState(n,i,t.renderState),this._closed=i,this._vertexFormat=a,this._flat=o,this._faceForward=A(t.faceForward,!i)}Object.defineProperties(um.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},vertexFormat:{get:function(){return this._vertexFormat}},flat:{get:function(){return this._flat}},faceForward:{get:function(){return this._faceForward}}});um.VERTEX_FORMAT=De.POSITION_AND_NORMAL;um.FLAT_VERTEX_FORMAT=De.POSITION_ONLY;um.prototype.getFragmentShaderSource=Zi.prototype.getFragmentShaderSource;um.prototype.isTranslucent=Zi.prototype.isTranslucent;um.prototype.getRenderState=Zi.prototype.getRenderState;var tn=um;function CC(t){this._definitionChanged=new Ae,this._color=void 0,this._colorSubscription=void 0,this.color=t}Object.defineProperties(CC.prototype,{isConstant:{get:function(){return q.isConstant(this._color)}},definitionChanged:{get:function(){return this._definitionChanged}},color:ce("color")});CC.prototype.getType=function(t){return"Color"};CC.prototype.getValue=function(t,n){return f(n)||(n={}),n.color=q.getValueOrClonedDefault(this._color,t,z.WHITE,n.color),n};CC.prototype.equals=function(t){return this===t||t instanceof CC&&q.equals(this._color,t._color)};var Rt=CC;function zp(t){t=A(t,A.EMPTY_OBJECT),this._ellipsoid=A(t.ellipsoid,oe.WGS84),this._rectangle=A(t.rectangle,le.MAX_VALUE),this._projection=new Ci(this._ellipsoid),this._numberOfLevelZeroTilesX=A(t.numberOfLevelZeroTilesX,2),this._numberOfLevelZeroTilesY=A(t.numberOfLevelZeroTilesY,1)}Object.defineProperties(zp.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},rectangle:{get:function(){return this._rectangle}},projection:{get:function(){return this._projection}}});zp.prototype.getNumberOfXTilesAtLevel=function(t){return this._numberOfLevelZeroTilesX<<t};zp.prototype.getNumberOfYTilesAtLevel=function(t){return this._numberOfLevelZeroTilesY<<t};zp.prototype.rectangleToNativeRectangle=function(t,n){let i=B.toDegrees(t.west),o=B.toDegrees(t.south),r=B.toDegrees(t.east),s=B.toDegrees(t.north);return f(n)?(n.west=i,n.south=o,n.east=r,n.north=s,n):new le(i,o,r,s)};zp.prototype.tileXYToNativeRectangle=function(t,n,i,o){let r=this.tileXYToRectangle(t,n,i,o);return r.west=B.toDegrees(r.west),r.south=B.toDegrees(r.south),r.east=B.toDegrees(r.east),r.north=B.toDegrees(r.north),r};zp.prototype.tileXYToRectangle=function(t,n,i,o){let r=this._rectangle,s=this.getNumberOfXTilesAtLevel(i),a=this.getNumberOfYTilesAtLevel(i),c=r.width/s,l=t*c+r.west,u=(t+1)*c+r.west,d=r.height/a,h=r.north-n*d,_=r.north-(n+1)*d;return f(o)||(o=new le(l,_,u,h)),o.west=l,o.south=_,o.east=u,o.north=h,o};zp.prototype.positionToTileXY=function(t,n,i){let o=this._rectangle;if(!le.contains(o,t))return;let r=this.getNumberOfXTilesAtLevel(n),s=this.getNumberOfYTilesAtLevel(n),a=o.width/r,c=o.height/s,l=t.longitude;o.east<o.west&&(l+=B.TWO_PI);let u=(l-o.west)/a|0;u>=r&&(u=r-1);let d=(o.north-t.latitude)/c|0;return d>=s&&(d=s-1),f(i)?(i.x=u,i.y=d,i):new W(u,d)};var Wi=zp;var QX=new m,$X=new m,eK=new de,t8=new m,KTe=new m,tK=new ae,JTe=new Wi,Rb=[new de,new de,new de,new de],Mb=new W,Ir={};Ir.initialize=function(){let t=Ir._initPromise;return f(t)||(t=Ie.fetchJson(Qt("Assets/approximateTerrainHeights.json")).then(function(n){Ir._terrainHeights=n}),Ir._initPromise=t),t};Ir.getMinimumMaximumHeights=function(t,n){n=A(n,oe.WGS84);let i=nK(t),o=Ir._defaultMinTerrainHeight,r=Ir._defaultMaxTerrainHeight;if(f(i)){let s=`${i.level}-${i.x}-${i.y}`,a=Ir._terrainHeights[s];f(a)&&(o=a[0],r=a[1]),n.cartographicToCartesian(le.northeast(t,eK),QX),n.cartographicToCartesian(le.southwest(t,eK),$X),m.midpoint($X,QX,t8);let c=n.scaleToGeodeticSurface(t8,KTe);if(f(c)){let l=m.distance(t8,c);o=Math.min(o,-l)}else o=Ir._defaultMinTerrainHeight}return o=Math.max(Ir._defaultMinTerrainHeight,o),{minimumTerrainHeight:o,maximumTerrainHeight:r}};Ir.getBoundingSphere=function(t,n){n=A(n,oe.WGS84);let i=nK(t),o=Ir._defaultMaxTerrainHeight;if(f(i)){let s=`${i.level}-${i.x}-${i.y}`,a=Ir._terrainHeights[s];f(a)&&(o=a[1])}let r=ae.fromRectangle3D(t,n,0);return ae.fromRectangle3D(t,n,o,tK),ae.union(r,tK,r)};function nK(t){de.fromRadians(t.east,t.north,0,Rb[0]),de.fromRadians(t.west,t.north,0,Rb[1]),de.fromRadians(t.east,t.south,0,Rb[2]),de.fromRadians(t.west,t.south,0,Rb[3]);let n=0,i=0,o=0,r=0,s=Ir._terrainHeightsMaxLevel,a;for(a=0;a<=s;++a){let c=!1;for(let l=0;l<4;++l){let u=Rb[l];if(JTe.positionToTileXY(u,a,Mb),l===0)o=Mb.x,r=Mb.y;else if(o!==Mb.x||r!==Mb.y){c=!0;break}}if(c)break;n=o,i=r}if(a!==0)return{x:n,y:i,level:a>s?s:a-1}}Ir._terrainHeightsMaxLevel=6;Ir._defaultMaxTerrainHeight=9e3;Ir._defaultMinTerrainHeight=-1e5;Ir._terrainHeights=void 0;Ir._initPromise=void 0;Object.defineProperties(Ir,{initialized:{get:function(){return f(Ir._terrainHeights)}}});var ri=Ir;function nc(t,n,i){this.minimum=m.clone(A(t,m.ZERO)),this.maximum=m.clone(A(n,m.ZERO)),f(i)?i=m.clone(i):i=m.midpoint(this.minimum,this.maximum,new m),this.center=i}nc.fromCorners=function(t,n,i){return f(i)||(i=new nc),i.minimum=m.clone(t,i.minimum),i.maximum=m.clone(n,i.maximum),i.center=m.midpoint(t,n,i.center),i};nc.fromPoints=function(t,n){if(f(n)||(n=new nc),!f(t)||t.length===0)return n.minimum=m.clone(m.ZERO,n.minimum),n.maximum=m.clone(m.ZERO,n.maximum),n.center=m.clone(m.ZERO,n.center),n;let i=t[0].x,o=t[0].y,r=t[0].z,s=t[0].x,a=t[0].y,c=t[0].z,l=t.length;for(let h=1;h<l;h++){let _=t[h],y=_.x,p=_.y,C=_.z;i=Math.min(y,i),s=Math.max(y,s),o=Math.min(p,o),a=Math.max(p,a),r=Math.min(C,r),c=Math.max(C,c)}let u=n.minimum;u.x=i,u.y=o,u.z=r;let d=n.maximum;return d.x=s,d.y=a,d.z=c,n.center=m.midpoint(u,d,n.center),n};nc.clone=function(t,n){if(!!f(t))return f(n)?(n.minimum=m.clone(t.minimum,n.minimum),n.maximum=m.clone(t.maximum,n.maximum),n.center=m.clone(t.center,n.center),n):new nc(t.minimum,t.maximum,t.center)};nc.equals=function(t,n){return t===n||f(t)&&f(n)&&m.equals(t.center,n.center)&&m.equals(t.minimum,n.minimum)&&m.equals(t.maximum,n.maximum)};var O1=new m;nc.intersectPlane=function(t,n){O1=m.subtract(t.maximum,t.minimum,O1);let i=m.multiplyByScalar(O1,.5,O1),o=n.normal,r=i.x*Math.abs(o.x)+i.y*Math.abs(o.y)+i.z*Math.abs(o.z),s=m.dot(t.center,o)+n.distance;return s-r>0?jt.INSIDE:s+r<0?jt.OUTSIDE:jt.INTERSECTING};nc.prototype.clone=function(t){return nc.clone(this,t)};nc.prototype.intersectPlane=function(t){return nc.intersectPlane(this,t)};nc.prototype.equals=function(t){return nc.equals(this,t)};var C0=nc;var n8={};n8.computeDiscriminant=function(t,n,i){return n*n-4*t*i};function iK(t,n,i){let o=t+n;return B.sign(t)!==B.sign(n)&&Math.abs(o/Math.max(Math.abs(t),Math.abs(n)))<i?0:o}n8.computeRealRoots=function(t,n,i){let o;if(t===0)return n===0?[]:[-i/n];if(n===0){if(i===0)return[0,0];let l=Math.abs(i),u=Math.abs(t);if(l<u&&l/u<B.EPSILON14)return[0,0];if(l>u&&u/l<B.EPSILON14)return[];if(o=-i/t,o<0)return[];let d=Math.sqrt(o);return[-d,d]}else if(i===0)return o=-n/t,o<0?[o,0]:[0,o];let r=n*n,s=4*t*i,a=iK(r,-s,B.EPSILON14);if(a<0)return[];let c=-.5*iK(n,B.sign(n)*Math.sqrt(a),B.EPSILON14);return n>0?[c/t,i/c]:[i/c,c/t]};var Vc=n8;var o8={};o8.computeDiscriminant=function(t,n,i,o){let r=t*t,s=n*n,a=i*i,c=o*o;return 18*t*n*i*o+s*a-27*r*c-4*(t*a*i+s*n*o)};function i8(t,n,i,o){let r=t,s=n/3,a=i/3,c=o,l=r*a,u=s*c,d=s*s,h=a*a,_=r*a-d,y=r*c-s*a,p=s*c-h,C=4*_*p-y*y,x,T;if(C<0){let X,Y,K;d*u>=l*h?(X=r,Y=_,K=-2*s*_+r*y):(X=c,Y=p,K=-c*y+2*a*p);let Z=-(K<0?-1:1)*Math.abs(X)*Math.sqrt(-C);T=-K+Z;let Q=T/2,me=Q<0?-Math.pow(-Q,1/3):Math.pow(Q,1/3),_e=T===Z?-me:-Y/me;return x=Y<=0?me+_e:-K/(me*me+_e*_e+Y),d*u>=l*h?[(x-s)/r]:[-c/(x+a)]}let E=_,S=-2*s*_+r*y,w=p,D=-c*y+2*a*p,I=Math.sqrt(C),O=Math.sqrt(3)/2,M=Math.abs(Math.atan2(r*I,-S)/3);x=2*Math.sqrt(-E);let L=Math.cos(M);T=x*L;let F=x*(-L/2-O*Math.sin(M)),g=T+F>2*s?T-s:F-s,b=r,v=g/b;M=Math.abs(Math.atan2(c*I,-D)/3),x=2*Math.sqrt(-w),L=Math.cos(M),T=x*L,F=x*(-L/2-O*Math.sin(M));let P=-c,R=T+F<2*a?T+a:F+a,V=P/R,H=b*R,U=-g*R-b*P,G=g*P,k=(a*U-s*G)/(-s*U+a*H);return v<=k?v<=V?k<=V?[v,k,V]:[v,V,k]:[V,v,k]:v<=V?[k,v,V]:k<=V?[k,V,v]:[V,k,v]}o8.computeRealRoots=function(t,n,i,o){let r,s;if(t===0)return Vc.computeRealRoots(n,i,o);if(n===0){if(i===0){if(o===0)return[0,0,0];s=-o/t;let a=s<0?-Math.pow(-s,1/3):Math.pow(s,1/3);return[a,a,a]}else if(o===0)return r=Vc.computeRealRoots(t,0,i),r.Length===0?[0]:[r[0],0,r[1]];return i8(t,0,i,o)}else{if(i===0)return o===0?(s=-n/t,s<0?[s,0,0]:[0,0,s]):i8(t,n,0,o);if(o===0)return r=Vc.computeRealRoots(t,n,i),r.length===0?[0]:r[1]<=0?[r[0],r[1],0]:r[0]>=0?[0,r[0],r[1]]:[r[0],0,r[1]]}return i8(t,n,i,o)};var xC=o8;var r8={};r8.computeDiscriminant=function(t,n,i,o,r){let s=t*t,a=s*t,c=n*n,l=c*n,u=i*i,d=u*i,h=o*o,_=h*o,y=r*r,p=y*r;return c*u*h-4*l*_-4*t*d*h+18*t*n*i*_-27*s*h*h+256*a*p+r*(18*l*i*o-4*c*d+16*t*u*u-80*t*n*u*o-6*t*c*h+144*s*i*h)+y*(144*t*c*i-27*c*c-128*s*u-192*s*n*o)};function xf(t,n,i,o){let r=t*t,s=n-3*r/8,a=i-n*t/2+r*t/8,c=o-i*t/4+n*r/16-3*r*r/256,l=xC.computeRealRoots(1,2*s,s*s-4*c,-a*a);if(l.length>0){let u=-t/4,d=l[l.length-1];if(Math.abs(d)<B.EPSILON14){let h=Vc.computeRealRoots(1,s,c);if(h.length===2){let _=h[0],y=h[1],p;if(_>=0&&y>=0){let C=Math.sqrt(_),x=Math.sqrt(y);return[u-x,u-C,u+C,u+x]}else{if(_>=0&&y<0)return p=Math.sqrt(_),[u-p,u+p];if(_<0&&y>=0)return p=Math.sqrt(y),[u-p,u+p]}}return[]}else if(d>0){let h=Math.sqrt(d),_=(s+d-a/h)/2,y=(s+d+a/h)/2,p=Vc.computeRealRoots(1,h,_),C=Vc.computeRealRoots(1,-h,y);return p.length!==0?(p[0]+=u,p[1]+=u,C.length!==0?(C[0]+=u,C[1]+=u,p[1]<=C[0]?[p[0],p[1],C[0],C[1]]:C[1]<=p[0]?[C[0],C[1],p[0],p[1]]:p[0]>=C[0]&&p[1]<=C[1]?[C[0],p[0],p[1],C[1]]:C[0]>=p[0]&&C[1]<=p[1]?[p[0],C[0],C[1],p[1]]:p[0]>C[0]&&p[0]<C[1]?[C[0],p[0],C[1],p[1]]:[p[0],C[0],p[1],C[1]]):p):C.length!==0?(C[0]+=u,C[1]+=u,C):[]}}return[]}function Lb(t,n,i,o){let r=i*i,s=n*n,a=t*t,c=-2*n,l=i*t+s-4*o,u=a*o-i*n*t+r,d=xC.computeRealRoots(1,c,l,u);if(d.length>0){let h=d[0],_=n-h,y=_*_,p=t/2,C=_/2,x=y-4*o,T=y+4*Math.abs(o),E=a-4*h,S=a+4*Math.abs(h),w,D;if(h<0||x*S<E*T){let b=Math.sqrt(E);w=b/2,D=b===0?0:(t*C-i)/b}else{let b=Math.sqrt(x);w=b===0?0:(t*C-i)/b,D=b/2}let I,O;p===0&&w===0?(I=0,O=0):B.sign(p)===B.sign(w)?(I=p+w,O=h/I):(O=p-w,I=h/O);let M,L;C===0&&D===0?(M=0,L=0):B.sign(C)===B.sign(D)?(M=C+D,L=o/M):(L=C-D,M=o/L);let F=Vc.computeRealRoots(1,I,M),g=Vc.computeRealRoots(1,O,L);if(F.length!==0)return g.length!==0?F[1]<=g[0]?[F[0],F[1],g[0],g[1]]:g[1]<=F[0]?[g[0],g[1],F[0],F[1]]:F[0]>=g[0]&&F[1]<=g[1]?[g[0],F[0],F[1],g[1]]:g[0]>=F[0]&&g[1]<=F[1]?[F[0],g[0],g[1],F[1]]:F[0]>g[0]&&F[0]<g[1]?[g[0],F[0],g[1],F[1]]:[F[0],g[0],F[1],g[1]]:F;if(g.length!==0)return g}return[]}r8.computeRealRoots=function(t,n,i,o,r){if(Math.abs(t)<B.EPSILON15)return xC.computeRealRoots(n,i,o,r);let s=n/t,a=i/t,c=o/t,l=r/t,u=s<0?1:0;switch(u+=a<0?u+1:u,u+=c<0?u+1:u,u+=l<0?u+1:u,u){case 0:return xf(s,a,c,l);case 1:return Lb(s,a,c,l);case 2:return Lb(s,a,c,l);case 3:return xf(s,a,c,l);case 4:return xf(s,a,c,l);case 5:return Lb(s,a,c,l);case 6:return xf(s,a,c,l);case 7:return xf(s,a,c,l);case 8:return Lb(s,a,c,l);case 9:return xf(s,a,c,l);case 10:return xf(s,a,c,l);case 11:return Lb(s,a,c,l);case 12:return xf(s,a,c,l);case 13:return xf(s,a,c,l);case 14:return xf(s,a,c,l);case 15:return xf(s,a,c,l);default:return}};var R1=r8;function M1(t,n){n=m.clone(A(n,m.ZERO)),m.equals(n,m.ZERO)||m.normalize(n,n),this.origin=m.clone(A(t,m.ZERO)),this.direction=n}M1.clone=function(t,n){if(!!f(t))return f(n)?(n.origin=m.clone(t.origin),n.direction=m.clone(t.direction),n):new M1(t.origin,t.direction)};M1.getPoint=function(t,n,i){return f(i)||(i=new m),i=m.multiplyByScalar(t.direction,n,i),m.add(t.origin,i,i)};var dn=M1;var Yo={};Yo.rayPlane=function(t,n,i){f(i)||(i=new m);let o=t.origin,r=t.direction,s=n.normal,a=m.dot(s,r);if(Math.abs(a)<B.EPSILON15)return;let c=(-n.distance-m.dot(s,o))/a;if(!(c<0))return i=m.multiplyByScalar(r,c,i),m.add(o,i,i)};var ZTe=new m,QTe=new m,fK=new m,oK=new m,rK=new m;Yo.rayTriangleParametric=function(t,n,i,o,r){r=A(r,!1);let s=t.origin,a=t.direction,c=m.subtract(i,n,ZTe),l=m.subtract(o,n,QTe),u=m.cross(a,l,fK),d=m.dot(c,u),h,_,y,p,C;if(r){if(d<B.EPSILON6||(h=m.subtract(s,n,oK),y=m.dot(h,u),y<0||y>d)||(_=m.cross(h,c,rK),p=m.dot(a,_),p<0||y+p>d))return;C=m.dot(l,_)/d}else{if(Math.abs(d)<B.EPSILON6)return;let x=1/d;if(h=m.subtract(s,n,oK),y=m.dot(h,u)*x,y<0||y>1||(_=m.cross(h,c,rK),p=m.dot(a,_)*x,p<0||y+p>1))return;C=m.dot(l,_)*x}return C};Yo.rayTriangle=function(t,n,i,o,r,s){let a=Yo.rayTriangleParametric(t,n,i,o,r);if(!(!f(a)||a<0))return f(s)||(s=new m),m.multiplyByScalar(t.direction,a,s),m.add(t.origin,s,s)};var $Te=new dn;Yo.lineSegmentTriangle=function(t,n,i,o,r,s,a){let c=$Te;m.clone(t,c.origin),m.subtract(n,t,c.direction),m.normalize(c.direction,c.direction);let l=Yo.rayTriangleParametric(c,i,o,r,s);if(!(!f(l)||l<0||l>m.distance(t,n)))return f(a)||(a=new m),m.multiplyByScalar(c.direction,l,a),m.add(c.origin,a,a)};function eEe(t,n,i,o){let r=n*n-4*t*i;if(r<0)return;if(r>0){let a=1/(2*t),c=Math.sqrt(r),l=(-n+c)*a,u=(-n-c)*a;return l<u?(o.root0=l,o.root1=u):(o.root0=u,o.root1=l),o}let s=-n/(2*t);if(s!==0)return o.root0=o.root1=s,o}var tEe={root0:0,root1:0};function dK(t,n,i){f(i)||(i=new Fc);let o=t.origin,r=t.direction,s=n.center,a=n.radius*n.radius,c=m.subtract(o,s,fK),l=m.dot(r,r),u=2*m.dot(r,c),d=m.magnitudeSquared(c)-a,h=eEe(l,u,d,tEe);if(!!f(h))return i.start=h.root0,i.stop=h.root1,i}Yo.raySphere=function(t,n,i){if(i=dK(t,n,i),!(!f(i)||i.stop<0))return i.start=Math.max(i.start,0),i};var nEe=new dn;Yo.lineSegmentSphere=function(t,n,i,o){let r=nEe;m.clone(t,r.origin);let s=m.subtract(n,t,r.direction),a=m.magnitude(s);if(m.normalize(s,s),o=dK(r,i,o),!(!f(o)||o.stop<0||o.start>a))return o.start=Math.max(o.start,0),o.stop=Math.min(o.stop,a),o};var iEe=new m,oEe=new m;Yo.rayEllipsoid=function(t,n){let i=n.oneOverRadii,o=m.multiplyComponents(i,t.origin,iEe),r=m.multiplyComponents(i,t.direction,oEe),s=m.magnitudeSquared(o),a=m.dot(o,r),c,l,u,d,h;if(s>1){if(a>=0)return;let _=a*a;if(c=s-1,l=m.magnitudeSquared(r),u=l*c,_<u)return;if(_>u){d=a*a-u,h=-a+Math.sqrt(d);let p=h/l,C=c/h;return p<C?new Fc(p,C):{start:C,stop:p}}let y=Math.sqrt(c/l);return new Fc(y,y)}else if(s<1)return c=s-1,l=m.magnitudeSquared(r),u=l*c,d=a*a-u,h=-a+Math.sqrt(d),new Fc(0,h/l);if(a<0)return l=m.magnitudeSquared(r),new Fc(0,-a/l)};function x0(t,n,i){let o=t+n;return B.sign(t)!==B.sign(n)&&Math.abs(o/Math.max(Math.abs(t),Math.abs(n)))<i?0:o}function rEe(t,n,i,o,r){let s=o*o,a=r*r,c=(t[$.COLUMN1ROW1]-t[$.COLUMN2ROW2])*a,l=r*(o*x0(t[$.COLUMN1ROW0],t[$.COLUMN0ROW1],B.EPSILON15)+n.y),u=t[$.COLUMN0ROW0]*s+t[$.COLUMN2ROW2]*a+o*n.x+i,d=a*x0(t[$.COLUMN2ROW1],t[$.COLUMN1ROW2],B.EPSILON15),h=r*(o*x0(t[$.COLUMN2ROW0],t[$.COLUMN0ROW2])+n.z),_,y=[];if(h===0&&d===0){if(_=Vc.computeRealRoots(c,l,u),_.length===0)return y;let M=_[0],L=Math.sqrt(Math.max(1-M*M,0));if(y.push(new m(o,r*M,r*-L)),y.push(new m(o,r*M,r*L)),_.length===2){let F=_[1],g=Math.sqrt(Math.max(1-F*F,0));y.push(new m(o,r*F,r*-g)),y.push(new m(o,r*F,r*g))}return y}let p=h*h,C=d*d,x=c*c,T=h*d,E=x+C,S=2*(l*c+T),w=2*u*c+l*l-C+p,D=2*(u*l-T),I=u*u-p;if(E===0&&S===0&&w===0&&D===0)return y;_=R1.computeRealRoots(E,S,w,D,I);let O=_.length;if(O===0)return y;for(let M=0;M<O;++M){let L=_[M],F=L*L,g=Math.max(1-F,0),b=Math.sqrt(g),v;B.sign(c)===B.sign(u)?v=x0(c*F+u,l*L,B.EPSILON12):B.sign(u)===B.sign(l*L)?v=x0(c*F,l*L+u,B.EPSILON12):v=x0(c*F+l*L,u,B.EPSILON12);let P=x0(d*L,h,B.EPSILON15),R=v*P;R<0?y.push(new m(o,r*L,r*b)):R>0?y.push(new m(o,r*L,r*-b)):b!==0?(y.push(new m(o,r*L,r*-b)),y.push(new m(o,r*L,r*b)),++M):y.push(new m(o,r*L,r*b))}return y}var s8=new m,sK=new m,aK=new m,L1=new m,sEe=new m,aEe=new $,cEe=new $,lEe=new $,uEe=new $,fEe=new $,cK=new $,lK=new $,uK=new m,dEe=new m,hEe=new de;Yo.grazingAltitudeLocation=function(t,n){let i=t.origin,o=t.direction;if(!m.equals(i,m.ZERO)){let I=n.geodeticSurfaceNormal(i,s8);if(m.dot(o,I)>=0)return i}let r=f(this.rayEllipsoid(t,n)),s=n.transformPositionToScaledSpace(o,s8),a=m.normalize(s,s),c=m.mostOrthogonalAxis(s,L1),l=m.normalize(m.cross(c,a,sK),sK),u=m.normalize(m.cross(a,l,aK),aK),d=aEe;d[0]=a.x,d[1]=a.y,d[2]=a.z,d[3]=l.x,d[4]=l.y,d[5]=l.z,d[6]=u.x,d[7]=u.y,d[8]=u.z;let h=$.transpose(d,cEe),_=$.fromScale(n.radii,lEe),y=$.fromScale(n.oneOverRadii,uEe),p=fEe;p[0]=0,p[1]=-o.z,p[2]=o.y,p[3]=o.z,p[4]=0,p[5]=-o.x,p[6]=-o.y,p[7]=o.x,p[8]=0;let C=$.multiply($.multiply(h,y,cK),p,cK),x=$.multiply($.multiply(C,_,lK),d,lK),T=$.multiplyByVector(C,i,sEe),E=rEe(x,m.negate(T,s8),0,0,1),S,w,D=E.length;if(D>0){let I=m.clone(m.ZERO,dEe),O=Number.NEGATIVE_INFINITY;for(let L=0;L<D;++L){S=$.multiplyByVector(_,$.multiplyByVector(d,E[L],uK),uK);let F=m.normalize(m.subtract(S,i,L1),L1),g=m.dot(F,o);g>O&&(O=g,I=m.clone(S,I))}let M=n.cartesianToCartographic(I,hEe);return O=B.clamp(O,0,1),w=m.magnitude(m.subtract(I,i,L1))*Math.sqrt(1-O*O),w=r?-w:w,M.height=w,n.cartographicToCartesian(M,new m)}};var mEe=new m;Yo.lineSegmentPlane=function(t,n,i,o){f(o)||(o=new m);let r=m.subtract(n,t,mEe),s=i.normal,a=m.dot(s,r);if(Math.abs(a)<B.EPSILON6)return;let c=m.dot(s,t),l=-(i.distance+c)/a;if(!(l<0||l>1))return m.multiplyByScalar(r,l,o),m.add(t,o,o),o};Yo.trianglePlaneIntersection=function(t,n,i,o){let r=o.normal,s=o.distance,a=m.dot(r,t)+s<0,c=m.dot(r,n)+s<0,l=m.dot(r,i)+s<0,u=0;u+=a?1:0,u+=c?1:0,u+=l?1:0;let d,h;if((u===1||u===2)&&(d=new m,h=new m),u===1){if(a)return Yo.lineSegmentPlane(t,n,o,d),Yo.lineSegmentPlane(t,i,o,h),{positions:[t,n,i,d,h],indices:[0,3,4,1,2,4,1,4,3]};if(c)return Yo.lineSegmentPlane(n,i,o,d),Yo.lineSegmentPlane(n,t,o,h),{positions:[t,n,i,d,h],indices:[1,3,4,2,0,4,2,4,3]};if(l)return Yo.lineSegmentPlane(i,t,o,d),Yo.lineSegmentPlane(i,n,o,h),{positions:[t,n,i,d,h],indices:[2,3,4,0,1,4,0,4,3]}}else if(u===2)if(a)if(c){if(!l)return Yo.lineSegmentPlane(t,i,o,d),Yo.lineSegmentPlane(n,i,o,h),{positions:[t,n,i,d,h],indices:[0,1,4,0,4,3,2,3,4]}}else return Yo.lineSegmentPlane(i,n,o,d),Yo.lineSegmentPlane(t,n,o,h),{positions:[t,n,i,d,h],indices:[2,0,4,2,4,3,1,3,4]};else return Yo.lineSegmentPlane(n,t,o,d),Yo.lineSegmentPlane(i,t,o,h),{positions:[t,n,i,d,h],indices:[1,2,4,1,4,3,0,3,4]}};var ji=Yo;function cs(t,n){this.normal=m.clone(t),this.distance=n}cs.fromPointNormal=function(t,n,i){let o=-m.dot(n,t);return f(i)?(m.clone(n,i.normal),i.distance=o,i):new cs(n,o)};var pEe=new m;cs.fromCartesian4=function(t,n){let i=m.fromCartesian4(t,pEe),o=t.w;return f(n)?(m.clone(i,n.normal),n.distance=o,n):new cs(i,o)};cs.getPointDistance=function(t,n){return m.dot(t.normal,n)+t.distance};var _Ee=new m;cs.projectPointOntoPlane=function(t,n,i){f(i)||(i=new m);let o=cs.getPointDistance(t,n),r=m.multiplyByScalar(t.normal,o,_Ee);return m.subtract(n,r,i)};var gEe=new N,yEe=new se,AEe=new m;cs.transform=function(t,n,i){let o=t.normal,r=t.distance,s=N.inverseTranspose(n,gEe),a=se.fromElements(o.x,o.y,o.z,r,yEe);a=N.multiplyByVector(s,a,a);let c=m.fromCartesian4(a,AEe);return a=se.divideByScalar(a,m.magnitude(c),a),cs.fromCartesian4(a,i)};cs.clone=function(t,n){return f(n)?(m.clone(t.normal,n.normal),n.distance=t.distance,n):new cs(t.normal,t.distance)};cs.equals=function(t,n){return t.distance===n.distance&&m.equals(t.normal,n.normal)};cs.ORIGIN_XY_PLANE=Object.freeze(new cs(m.UNIT_Z,0));cs.ORIGIN_YZ_PLANE=Object.freeze(new cs(m.UNIT_X,0));cs.ORIGIN_ZX_PLANE=Object.freeze(new cs(m.UNIT_Y,0));var rn=cs;var a8=new se;function Fd(t,n){n=A(n,oe.WGS84),t=n.scaleToGeodeticSurface(t);let i=vt.eastNorthUpToFixedFrame(t,n);this._ellipsoid=n,this._origin=t,this._xAxis=m.fromCartesian4(N.getColumn(i,0,a8)),this._yAxis=m.fromCartesian4(N.getColumn(i,1,a8));let o=m.fromCartesian4(N.getColumn(i,2,a8));this._plane=rn.fromPointNormal(t,o)}Object.defineProperties(Fd.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},origin:{get:function(){return this._origin}},plane:{get:function(){return this._plane}},xAxis:{get:function(){return this._xAxis}},yAxis:{get:function(){return this._yAxis}},zAxis:{get:function(){return this._plane.normal}}});var CEe=new C0;Fd.fromPoints=function(t,n){let i=C0.fromPoints(t,CEe);return new Fd(i.center,n)};var hK=new dn,F1=new m;Fd.prototype.projectPointOntoPlane=function(t,n){let i=hK;i.origin=t,m.normalize(t,i.direction);let o=ji.rayPlane(i,this._plane,F1);if(f(o)||(m.negate(i.direction,i.direction),o=ji.rayPlane(i,this._plane,F1)),f(o)){let r=m.subtract(o,this._origin,o),s=m.dot(this._xAxis,r),a=m.dot(this._yAxis,r);return f(n)?(n.x=s,n.y=a,n):new W(s,a)}};Fd.prototype.projectPointsOntoPlane=function(t,n){f(n)||(n=[]);let i=0,o=t.length;for(let r=0;r<o;r++){let s=this.projectPointOntoPlane(t[r],n[i]);f(s)&&(n[i]=s,i++)}return n.length=i,n};Fd.prototype.projectPointToNearestOnPlane=function(t,n){f(n)||(n=new W);let i=hK;i.origin=t,m.clone(this._plane.normal,i.direction);let o=ji.rayPlane(i,this._plane,F1);f(o)||(m.negate(i.direction,i.direction),o=ji.rayPlane(i,this._plane,F1));let r=m.subtract(o,this._origin,o),s=m.dot(this._xAxis,r),a=m.dot(this._yAxis,r);return n.x=s,n.y=a,n};Fd.prototype.projectPointsToNearestOnPlane=function(t,n){f(n)||(n=[]);let i=t.length;n.length=i;for(let o=0;o<i;o++)n[o]=this.projectPointToNearestOnPlane(t[o],n[o]);return n};var xEe=new m;Fd.prototype.projectPointOntoEllipsoid=function(t,n){f(n)||(n=new m);let i=this._ellipsoid,o=this._origin,r=this._xAxis,s=this._yAxis,a=xEe;return m.multiplyByScalar(r,t.x,a),n=m.add(o,a,n),m.multiplyByScalar(s,t.y,a),m.add(n,a,n),i.scaleToGeocentricSurface(n,n),n};Fd.prototype.projectPointsOntoEllipsoid=function(t,n){let i=t.length;f(n)?n.length=i:n=new Array(i);for(let o=0;o<i;++o)n[o]=this.projectPointOntoEllipsoid(t[o],n[o]);return n};var Ca=Fd;function Ti(t,n){this.center=m.clone(A(t,m.ZERO)),this.halfAxes=$.clone(A(n,$.ZERO))}Ti.packedLength=m.packedLength+$.packedLength;Ti.pack=function(t,n,i){return i=A(i,0),m.pack(t.center,n,i),$.pack(t.halfAxes,n,i+m.packedLength),n};Ti.unpack=function(t,n,i){return n=A(n,0),f(i)||(i=new Ti),m.unpack(t,n,i.center),$.unpack(t,n+m.packedLength,i.halfAxes),i};var TEe=new m,EEe=new m,bEe=new m,SEe=new m,wEe=new m,DEe=new m,vEe=new $,PEe={unitary:new $,diagonal:new $};Ti.fromPoints=function(t,n){if(f(n)||(n=new Ti),!f(t)||t.length===0)return n.halfAxes=$.ZERO,n.center=m.ZERO,n;let i,o=t.length,r=m.clone(t[0],TEe);for(i=1;i<o;i++)m.add(r,t[i],r);let s=1/o;m.multiplyByScalar(r,s,r);let a=0,c=0,l=0,u=0,d=0,h=0,_;for(i=0;i<o;i++)_=m.subtract(t[i],r,EEe),a+=_.x*_.x,c+=_.x*_.y,l+=_.x*_.z,u+=_.y*_.y,d+=_.y*_.z,h+=_.z*_.z;a*=s,c*=s,l*=s,u*=s,d*=s,h*=s;let y=vEe;y[0]=a,y[1]=c,y[2]=l,y[3]=c,y[4]=u,y[5]=d,y[6]=l,y[7]=d,y[8]=h;let p=$.computeEigenDecomposition(y,PEe),C=$.clone(p.unitary,n.halfAxes),x=$.getColumn(C,0,SEe),T=$.getColumn(C,1,wEe),E=$.getColumn(C,2,DEe),S=-Number.MAX_VALUE,w=-Number.MAX_VALUE,D=-Number.MAX_VALUE,I=Number.MAX_VALUE,O=Number.MAX_VALUE,M=Number.MAX_VALUE;for(i=0;i<o;i++)_=t[i],S=Math.max(m.dot(x,_),S),w=Math.max(m.dot(T,_),w),D=Math.max(m.dot(E,_),D),I=Math.min(m.dot(x,_),I),O=Math.min(m.dot(T,_),O),M=Math.min(m.dot(E,_),M);x=m.multiplyByScalar(x,.5*(I+S),x),T=m.multiplyByScalar(T,.5*(O+w),T),E=m.multiplyByScalar(E,.5*(M+D),E);let L=m.add(x,T,n.center);m.add(L,E,L);let F=bEe;return F.x=S-I,F.y=w-O,F.z=D-M,m.multiplyByScalar(F,.5,F),$.multiplyByScale(n.halfAxes,F,n.halfAxes),n};var AK=new m,IEe=new m;function mK(t,n,i,o,r,s,a,c,l,u,d){f(d)||(d=new Ti);let h=d.halfAxes;$.setColumn(h,0,n,h),$.setColumn(h,1,i,h),$.setColumn(h,2,o,h);let _=AK;_.x=(r+s)/2,_.y=(a+c)/2,_.z=(l+u)/2;let y=IEe;y.x=(s-r)/2,y.y=(c-a)/2,y.z=(u-l)/2;let p=d.center;return _=$.multiplyByVector(h,_,_),m.add(t,_,p),$.multiplyByScale(h,y,h),d}var pK=new de,BEe=new m,OEe=new de,REe=new de,MEe=new de,LEe=new de,FEe=new de,NEe=new m,_K=new m,VEe=new m,gK=new m,kEe=new m,UEe=new W,zEe=new W,HEe=new W,GEe=new W,WEe=new W,jEe=new m,qEe=new m,YEe=new m,XEe=new m,KEe=new W,JEe=new m,ZEe=new m,QEe=new m,$Ee=new rn(m.UNIT_X,0);Ti.fromRectangle=function(t,n,i,o,r){n=A(n,0),i=A(i,0),o=A(o,oe.WGS84);let s,a,c,l,u,d,h;if(t.width<=B.PI){let O=le.center(t,pK),M=o.cartographicToCartesian(O,BEe),L=new Ca(M,o);h=L.plane;let F=O.longitude,g=t.south<0&&t.north>0?0:O.latitude,b=de.fromRadians(F,t.north,i,OEe),v=de.fromRadians(t.west,t.north,i,REe),P=de.fromRadians(t.west,g,i,MEe),R=de.fromRadians(t.west,t.south,i,LEe),V=de.fromRadians(F,t.south,i,FEe),H=o.cartographicToCartesian(b,NEe),U=o.cartographicToCartesian(v,_K),G=o.cartographicToCartesian(P,VEe),k=o.cartographicToCartesian(R,gK),X=o.cartographicToCartesian(V,kEe),Y=L.projectPointToNearestOnPlane(H,UEe),K=L.projectPointToNearestOnPlane(U,zEe),j=L.projectPointToNearestOnPlane(G,HEe),Z=L.projectPointToNearestOnPlane(k,GEe),Q=L.projectPointToNearestOnPlane(X,WEe);return s=Math.min(K.x,j.x,Z.x),a=-s,l=Math.max(K.y,Y.y),c=Math.min(Z.y,Q.y),v.height=R.height=n,U=o.cartographicToCartesian(v,_K),k=o.cartographicToCartesian(R,gK),u=Math.min(rn.getPointDistance(h,U),rn.getPointDistance(h,k)),d=i,mK(L.origin,L.xAxis,L.yAxis,L.zAxis,s,a,c,l,u,d,r)}let _=t.south>0,y=t.north<0,p=_?t.south:y?t.north:0,C=le.center(t,pK).longitude,x=m.fromRadians(C,p,i,o,jEe);x.z=0;let E=Math.abs(x.x)<B.EPSILON10&&Math.abs(x.y)<B.EPSILON10?m.UNIT_X:m.normalize(x,qEe),S=m.UNIT_Z,w=m.cross(E,S,YEe);h=rn.fromPointNormal(x,E,$Ee);let D=m.fromRadians(C+B.PI_OVER_TWO,p,i,o,XEe);a=m.dot(rn.projectPointOntoPlane(h,D,KEe),w),s=-a,l=m.fromRadians(0,t.north,y?n:i,o,JEe).z,c=m.fromRadians(0,t.south,_?n:i,o,ZEe).z;let I=m.fromRadians(t.east,p,i,o,QEe);return u=rn.getPointDistance(h,I),d=0,mK(x,w,S,E,s,a,c,l,u,d,r)};Ti.fromTransformation=function(t,n){return f(n)||(n=new Ti),n.center=N.getTranslation(t,n.center),n.halfAxes=N.getMatrix3(t,n.halfAxes),n.halfAxes=$.multiplyByScalar(n.halfAxes,.5,n.halfAxes),n};Ti.clone=function(t,n){if(!!f(t))return f(n)?(m.clone(t.center,n.center),$.clone(t.halfAxes,n.halfAxes),n):new Ti(t.center,t.halfAxes)};Ti.intersectPlane=function(t,n){let i=t.center,o=n.normal,r=t.halfAxes,s=o.x,a=o.y,c=o.z,l=Math.abs(s*r[$.COLUMN0ROW0]+a*r[$.COLUMN0ROW1]+c*r[$.COLUMN0ROW2])+Math.abs(s*r[$.COLUMN1ROW0]+a*r[$.COLUMN1ROW1]+c*r[$.COLUMN1ROW2])+Math.abs(s*r[$.COLUMN2ROW0]+a*r[$.COLUMN2ROW1]+c*r[$.COLUMN2ROW2]),u=m.dot(o,i)+n.distance;return u<=-l?jt.OUTSIDE:u>=l?jt.INSIDE:jt.INTERSECTING};var CK=new m,xK=new m,TK=new m,ebe=new m,yK=new m,tbe=new m;Ti.distanceSquaredTo=function(t,n){let i=m.subtract(n,t.center,AK),o=t.halfAxes,r=$.getColumn(o,0,CK),s=$.getColumn(o,1,xK),a=$.getColumn(o,2,TK),c=m.magnitude(r),l=m.magnitude(s),u=m.magnitude(a),d=!0,h=!0,_=!0;c>0?m.divideByScalar(r,c,r):d=!1,l>0?m.divideByScalar(s,l,s):h=!1,u>0?m.divideByScalar(a,u,a):_=!1;let y=!d+!h+!_,p,C,x;if(y===1){let w=r;p=s,C=a,h?_||(w=a,C=r):(w=s,p=r),x=m.cross(p,C,yK),w===r?r=x:w===s?s=x:w===a&&(a=x)}else if(y===2){p=r,h?p=s:_&&(p=a);let w=m.UNIT_Y;w.equalsEpsilon(p,B.EPSILON3)&&(w=m.UNIT_X),C=m.cross(p,w,ebe),m.normalize(C,C),x=m.cross(p,C,yK),m.normalize(x,x),p===r?(s=C,a=x):p===s?(a=C,r=x):p===a&&(r=C,s=x)}else y===3&&(r=m.UNIT_X,s=m.UNIT_Y,a=m.UNIT_Z);let T=tbe;T.x=m.dot(i,r),T.y=m.dot(i,s),T.z=m.dot(i,a);let E=0,S;return T.x<-c?(S=T.x+c,E+=S*S):T.x>c&&(S=T.x-c,E+=S*S),T.y<-l?(S=T.y+l,E+=S*S):T.y>l&&(S=T.y-l,E+=S*S),T.z<-u?(S=T.z+u,E+=S*S):T.z>u&&(S=T.z-u,E+=S*S),E};var nbe=new m,ibe=new m;Ti.computePlaneDistances=function(t,n,i,o){f(o)||(o=new Fc);let r=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY,a=t.center,c=t.halfAxes,l=$.getColumn(c,0,CK),u=$.getColumn(c,1,xK),d=$.getColumn(c,2,TK),h=m.add(l,u,nbe);m.add(h,d,h),m.add(h,a,h);let _=m.subtract(h,n,ibe),y=m.dot(i,_);return r=Math.min(y,r),s=Math.max(y,s),m.add(a,l,h),m.add(h,u,h),m.subtract(h,d,h),m.subtract(h,n,_),y=m.dot(i,_),r=Math.min(y,r),s=Math.max(y,s),m.add(a,l,h),m.subtract(h,u,h),m.add(h,d,h),m.subtract(h,n,_),y=m.dot(i,_),r=Math.min(y,r),s=Math.max(y,s),m.add(a,l,h),m.subtract(h,u,h),m.subtract(h,d,h),m.subtract(h,n,_),y=m.dot(i,_),r=Math.min(y,r),s=Math.max(y,s),m.subtract(a,l,h),m.add(h,u,h),m.add(h,d,h),m.subtract(h,n,_),y=m.dot(i,_),r=Math.min(y,r),s=Math.max(y,s),m.subtract(a,l,h),m.add(h,u,h),m.subtract(h,d,h),m.subtract(h,n,_),y=m.dot(i,_),r=Math.min(y,r),s=Math.max(y,s),m.subtract(a,l,h),m.subtract(h,u,h),m.add(h,d,h),m.subtract(h,n,_),y=m.dot(i,_),r=Math.min(y,r),s=Math.max(y,s),m.subtract(a,l,h),m.subtract(h,u,h),m.subtract(h,d,h),m.subtract(h,n,_),y=m.dot(i,_),r=Math.min(y,r),s=Math.max(y,s),o.start=r,o.stop=s,o};var obe=new m,rbe=new m,sbe=new m;Ti.computeCorners=function(t,n){f(n)||(n=[new m,new m,new m,new m,new m,new m,new m,new m]);let i=t.center,o=t.halfAxes,r=$.getColumn(o,0,obe),s=$.getColumn(o,1,rbe),a=$.getColumn(o,2,sbe);return m.clone(i,n[0]),m.subtract(n[0],r,n[0]),m.subtract(n[0],s,n[0]),m.subtract(n[0],a,n[0]),m.clone(i,n[1]),m.subtract(n[1],r,n[1]),m.subtract(n[1],s,n[1]),m.add(n[1],a,n[1]),m.clone(i,n[2]),m.subtract(n[2],r,n[2]),m.add(n[2],s,n[2]),m.subtract(n[2],a,n[2]),m.clone(i,n[3]),m.subtract(n[3],r,n[3]),m.add(n[3],s,n[3]),m.add(n[3],a,n[3]),m.clone(i,n[4]),m.add(n[4],r,n[4]),m.subtract(n[4],s,n[4]),m.subtract(n[4],a,n[4]),m.clone(i,n[5]),m.add(n[5],r,n[5]),m.subtract(n[5],s,n[5]),m.add(n[5],a,n[5]),m.clone(i,n[6]),m.add(n[6],r,n[6]),m.add(n[6],s,n[6]),m.subtract(n[6],a,n[6]),m.clone(i,n[7]),m.add(n[7],r,n[7]),m.add(n[7],s,n[7]),m.add(n[7],a,n[7]),n};var abe=new $;Ti.computeTransformation=function(t,n){f(n)||(n=new N);let i=t.center,o=$.multiplyByUniformScale(t.halfAxes,2,abe);return N.fromRotationTranslation(o,i,n)};var cbe=new ae;Ti.isOccluded=function(t,n){let i=ae.fromOrientedBoundingBox(t,cbe);return!n.isBoundingSphereVisible(i)};Ti.prototype.intersectPlane=function(t){return Ti.intersectPlane(this,t)};Ti.prototype.distanceSquaredTo=function(t){return Ti.distanceSquaredTo(this,t)};Ti.prototype.computePlaneDistances=function(t,n,i){return Ti.computePlaneDistances(this,t,n,i)};Ti.prototype.computeCorners=function(t){return Ti.computeCorners(this,t)};Ti.prototype.computeTransformation=function(t){return Ti.computeTransformation(this,t)};Ti.prototype.isOccluded=function(t){return Ti.isOccluded(this,t)};Ti.equals=function(t,n){return t===n||f(t)&&f(n)&&m.equals(t.center,n.center)&&$.equals(t.halfAxes,n.halfAxes)};Ti.prototype.clone=function(t){return Ti.clone(this,t)};Ti.prototype.equals=function(t){return Ti.equals(this,t)};var _i=Ti;var N1={};N1.getHeight=function(t,n,i){return(t-i)*n+i};var lbe=new m;N1.getPosition=function(t,n,i,o,r){let s=n.cartesianToCartographic(t,lbe),a=N1.getHeight(s.height,i,o);return m.fromRadians(s.longitude,s.latitude,a,n,r)};var kc=N1;var ube=new m;function ct(t){this._size=t.size,this._datatype=t.datatype,this.getValue=t.getValue}var bs={};bs[ee.FLOAT]="float";bs[ee.FLOAT_VEC2]="vec2";bs[ee.FLOAT_VEC3]="vec3";bs[ee.FLOAT_VEC4]="vec4";bs[ee.INT]="int";bs[ee.INT_VEC2]="ivec2";bs[ee.INT_VEC3]="ivec3";bs[ee.INT_VEC4]="ivec4";bs[ee.BOOL]="bool";bs[ee.BOOL_VEC2]="bvec2";bs[ee.BOOL_VEC3]="bvec3";bs[ee.BOOL_VEC4]="bvec4";bs[ee.FLOAT_MAT2]="mat2";bs[ee.FLOAT_MAT3]="mat3";bs[ee.FLOAT_MAT4]="mat4";bs[ee.SAMPLER_2D]="sampler2D";bs[ee.SAMPLER_CUBE]="samplerCube";ct.prototype.getDeclaration=function(t){let n=`uniform ${bs[this._datatype]} ${t}`,i=this._size;return i===1?n+=";":n+=`[${i.toString()}];`,n};var fbe={czm_viewport:new ct({size:1,datatype:ee.FLOAT_VEC4,getValue:function(t){return t.viewportCartesian4}}),czm_viewportOrthographic:new ct({size:1,datatype:ee.FLOAT_MAT4,getValue:function(t){return t.viewportOrthographic}}),czm_viewportTransformation:new ct({size:1,datatype:ee.FLOAT_MAT4,getValue:function(t){return t.viewportTransformation}}),czm_globeDepthTexture:new ct({size:1,datatype:ee.SAMPLER_2D,getValue:function(t){return t.globeDepthTexture}}),czm_model:new ct({size:1,datatype:ee.FLOAT_MAT4,getValue:function(t){return t.model}}),czm_inverseModel:new ct({size:1,datatype:ee.FLOAT_MAT4,getValue:function(t){return t.inverseModel}}),czm_view:new ct({size:1,datatype:ee.FLOAT_MAT4,getValue:function(t){return t.view}}),czm_view3D:new ct({size:1,datatype:ee.FLOAT_MAT4,getValue:function(t){return t.view3D}}),czm_viewRotation:new ct({size:1,datatype:ee.FLOAT_MAT3,getValue:function(t){return t.viewRotation}}),czm_viewRotation3D:new ct({size:1,datatype:ee.FLOAT_MAT3,getValue:function(t){return t.viewRotation3D}}),czm_inverseView:new ct({size:1,datatype:ee.FLOAT_MAT4,getValue:function(t){return t.inverseView}}),czm_inverseView3D:new ct({size:1,datatype:ee.FLOAT_MAT4,getValue:function(t){return t.inverseView3D}}),czm_inverseViewRotation:new ct({size:1,datatype:ee.FLOAT_MAT3,getValue:function(t){return t.inverseViewRotation}}),czm_inverseViewRotation3D:new ct({size:1,datatype:ee.FLOAT_MAT3,getValue:function(t){return t.inverseViewRotation3D}}),czm_projection:new ct({size:1,datatype:ee.FLOAT_MAT4,getValue:function(t){return t.projection}}),czm_inverseProjection:new ct({size:1,datatype:ee.FLOAT_MAT4,getValue:function(t){return t.inverseProjection}}),czm_infiniteProjection:new ct({size:1,datatype:ee.FLOAT_MAT4,getValue:function(t){return t.infiniteProjection}}),czm_modelView:new ct({size:1,datatype:ee.FLOAT_MAT4,getValue:function(t){return t.modelView}}),czm_modelView3D:new ct({size:1,datatype:ee.FLOAT_MAT4,getValue:function(t){return t.modelView3D}}),czm_modelViewRelativeToEye:new ct({size:1,datatype:ee.FLOAT_MAT4,getValue:function(t){return t.modelViewRelativeToEye}}),czm_inverseModelView:new ct({size:1,datatype:ee.FLOAT_MAT4,getValue:function(t){return t.inverseModelView}}),czm_inverseModelView3D:new ct({size:1,datatype:ee.FLOAT_MAT4,getValue:function(t){return t.inverseModelView3D}}),czm_viewProjection:new ct({size:1,datatype:ee.FLOAT_MAT4,getValue:function(t){return t.viewProjection}}),czm_inverseViewProjection:new ct({size:1,datatype:ee.FLOAT_MAT4,getValue:function(t){return t.inverseViewProjection}}),czm_modelViewProjection:new ct({size:1,datatype:ee.FLOAT_MAT4,getValue:function(t){return t.modelViewProjection}}),czm_inverseModelViewProjection:new ct({size:1,datatype:ee.FLOAT_MAT4,getValue:function(t){return t.inverseModelViewProjection}}),czm_modelViewProjectionRelativeToEye:new ct({size:1,datatype:ee.FLOAT_MAT4,getValue:function(t){return t.modelViewProjectionRelativeToEye}}),czm_modelViewInfiniteProjection:new ct({size:1,datatype:ee.FLOAT_MAT4,getValue:function(t){return t.modelViewInfiniteProjection}}),czm_orthographicIn3D:new ct({size:1,datatype:ee.FLOAT,getValue:function(t){return t.orthographicIn3D?1:0}}),czm_normal:new ct({size:1,datatype:ee.FLOAT_MAT3,getValue:function(t){return t.normal}}),czm_normal3D:new ct({size:1,datatype:ee.FLOAT_MAT3,getValue:function(t){return t.normal3D}}),czm_inverseNormal:new ct({size:1,datatype:ee.FLOAT_MAT3,getValue:function(t){return t.inverseNormal}}),czm_inverseNormal3D:new ct({size:1,datatype:ee.FLOAT_MAT3,getValue:function(t){return t.inverseNormal3D}}),czm_eyeHeight:new ct({size:1,datatype:ee.FLOAT,getValue:function(t){return t.eyeHeight}}),czm_eyeHeight2D:new ct({size:1,datatype:ee.FLOAT_VEC2,getValue:function(t){return t.eyeHeight2D}}),czm_entireFrustum:new ct({size:1,datatype:ee.FLOAT_VEC2,getValue:function(t){return t.entireFrustum}}),czm_currentFrustum:new ct({size:1,datatype:ee.FLOAT_VEC2,getValue:function(t){return t.currentFrustum}}),czm_frustumPlanes:new ct({size:1,datatype:ee.FLOAT_VEC4,getValue:function(t){return t.frustumPlanes}}),czm_farDepthFromNearPlusOne:new ct({size:1,datatype:ee.FLOAT,getValue:function(t){return t.farDepthFromNearPlusOne}}),czm_log2FarDepthFromNearPlusOne:new ct({size:1,datatype:ee.FLOAT,getValue:function(t){return t.log2FarDepthFromNearPlusOne}}),czm_oneOverLog2FarDepthFromNearPlusOne:new ct({size:1,datatype:ee.FLOAT,getValue:function(t){return t.oneOverLog2FarDepthFromNearPlusOne}}),czm_sunPositionWC:new ct({size:1,datatype:ee.FLOAT_VEC3,getValue:function(t){return t.sunPositionWC}}),czm_sunPositionColumbusView:new ct({size:1,datatype:ee.FLOAT_VEC3,getValue:function(t){return t.sunPositionColumbusView}}),czm_sunDirectionEC:new ct({size:1,datatype:ee.FLOAT_VEC3,getValue:function(t){return t.sunDirectionEC}}),czm_sunDirectionWC:new ct({size:1,datatype:ee.FLOAT_VEC3,getValue:function(t){return t.sunDirectionWC}}),czm_moonDirectionEC:new ct({size:1,datatype:ee.FLOAT_VEC3,getValue:function(t){return t.moonDirectionEC}}),czm_lightDirectionEC:new ct({size:1,datatype:ee.FLOAT_VEC3,getValue:function(t){return t.lightDirectionEC}}),czm_lightDirectionWC:new ct({size:1,datatype:ee.FLOAT_VEC3,getValue:function(t){return t.lightDirectionWC}}),czm_lightColor:new ct({size:1,datatype:ee.FLOAT_VEC3,getValue:function(t){return t.lightColor}}),czm_lightColorHdr:new ct({size:1,datatype:ee.FLOAT_VEC3,getValue:function(t){return t.lightColorHdr}}),czm_encodedCameraPositionMCHigh:new ct({size:1,datatype:ee.FLOAT_VEC3,getValue:function(t){return t.encodedCameraPositionMCHigh}}),czm_encodedCameraPositionMCLow:new ct({size:1,datatype:ee.FLOAT_VEC3,getValue:function(t){return t.encodedCameraPositionMCLow}}),czm_cameraPositionWC:new ct({size:1,datatype:ee.FLOAT_VEC3,getValue:function(t){return t._cameraPosition}}),czm_viewerPositionWC:new ct({size:1,datatype:ee.FLOAT_VEC3,getValue:function(t){return N.getTranslation(t.inverseView,ube)}}),czm_frameNumber:new ct({size:1,datatype:ee.FLOAT,getValue:function(t){return t.frameState.frameNumber}}),czm_morphTime:new ct({size:1,datatype:ee.FLOAT,getValue:function(t){return t.frameState.morphTime}}),czm_sceneMode:new ct({size:1,datatype:ee.FLOAT,getValue:function(t){return t.frameState.mode}}),czm_pass:new ct({size:1,datatype:ee.FLOAT,getValue:function(t){return t.pass}}),czm_backgroundColor:new ct({size:1,datatype:ee.FLOAT_VEC4,getValue:function(t){return t.backgroundColor}}),czm_brdfLut:new ct({size:1,datatype:ee.SAMPLER_2D,getValue:function(t){return t.brdfLut}}),czm_environmentMap:new ct({size:1,datatype:ee.SAMPLER_CUBE,getValue:function(t){return t.environmentMap}}),czm_specularEnvironmentMaps:new ct({size:1,datatype:ee.SAMPLER_2D,getValue:function(t){return t.specularEnvironmentMaps}}),czm_specularEnvironmentMapSize:new ct({size:1,datatype:ee.FLOAT_VEC2,getValue:function(t){return t.specularEnvironmentMapsDimensions}}),czm_specularEnvironmentMapsMaximumLOD:new ct({size:1,datatype:ee.FLOAT,getValue:function(t){return t.specularEnvironmentMapsMaximumLOD}}),czm_sphericalHarmonicCoefficients:new ct({size:9,datatype:ee.FLOAT_VEC3,getValue:function(t){return t.sphericalHarmonicCoefficients}}),czm_temeToPseudoFixed:new ct({size:1,datatype:ee.FLOAT_MAT3,getValue:function(t){return t.temeToPseudoFixedMatrix}}),czm_pixelRatio:new ct({size:1,datatype:ee.FLOAT,getValue:function(t){return t.pixelRatio}}),czm_fogDensity:new ct({size:1,datatype:ee.FLOAT,getValue:function(t){return t.fogDensity}}),czm_splitPosition:new ct({size:1,datatype:ee.FLOAT,getValue:function(t){return t.splitPosition}}),czm_geometricToleranceOverMeter:new ct({size:1,datatype:ee.FLOAT,getValue:function(t){return t.geometricToleranceOverMeter}}),czm_minimumDisableDepthTestDistance:new ct({size:1,datatype:ee.FLOAT,getValue:function(t){return t.minimumDisableDepthTestDistance}}),czm_invertClassificationColor:new ct({size:1,datatype:ee.FLOAT_VEC4,getValue:function(t){return t.invertClassificationColor}}),czm_gamma:new ct({size:1,datatype:ee.FLOAT,getValue:function(t){return t.gamma}}),czm_ellipsoidRadii:new ct({size:1,datatype:ee.FLOAT_VEC3,getValue:function(t){return t.ellipsoid.radii}}),czm_ellipsoidInverseRadii:new ct({size:1,datatype:ee.FLOAT_VEC3,getValue:function(t){return t.ellipsoid.oneOverRadii}}),czm_extendLightSwitch:new ct({size:1,datatype:ee.BOOL_VEC4,getValue:function(t){return t.extendLightSwitch||new se(!1,!1,!1,!1)}}),czm_extendAmbientLightColor:new ct({size:1,datatype:ee.FLOAT_VEC3,getValue:function(t){return t.extendAmbientLightColor||new z(0,0,0)}}),czm_extendAmbientLightBrightness:new ct({size:1,datatype:ee.FLOAT,getValue:function(t){return t.extendAmbientLightBrightness||1}}),czm_extendPointLightColor:new ct({size:1,datatype:ee.FLOAT_VEC3,getValue:function(t){return t.extendPointLightColor||new z(0,0,0)}}),czm_extendPointLightBrightness:new ct({size:1,datatype:ee.FLOAT,getValue:function(t){return t.extendPointLightBrightness||1}}),czm_extendPointLightPositionWC:new ct({size:1,datatype:ee.FLOAT_VEC3,getValue:function(t){return t.extendPointLightPositionWC||new m(0,0,0)}}),czm_extendPointLightPositionEC:new ct({size:1,datatype:ee.FLOAT_VEC3,getValue:function(t){return t.extendPointLightPositionEC||new m(0,0,0)}}),czm_extendPointLightDistance:new ct({size:1,datatype:ee.FLOAT,getValue:function(t){return t.extendPointLightDistance||0}}),czm_extendSpotLightColor:new ct({size:1,datatype:ee.FLOAT_VEC3,getValue:function(t){return t.extendSpotLightColor||new z(0,0,0)}}),czm_extendSpotLightBrightness:new ct({size:1,datatype:ee.FLOAT,getValue:function(t){return t.extendSpotLightBrightness||1}}),czm_extendSpotLightPositionWC:new ct({size:1,datatype:ee.FLOAT_VEC3,getValue:function(t){return t.extendSpotLightPositionWC||new m(0,0,0)}}),czm_extendSpotLightPositionEC:new ct({size:1,datatype:ee.FLOAT_VEC3,getValue:function(t){return t.extendSpotLightPositionEC||new m(0,0,0)}}),czm_extendSpotLightDirectionWC:new ct({size:1,datatype:ee.FLOAT_VEC3,getValue:function(t){return t.extendSpotLightDirectionWC||new m(0,0,0)}}),czm_extendSpotLightDirectionEC:new ct({size:1,datatype:ee.FLOAT_VEC3,getValue:function(t){return t.extendSpotLightDirectionEC||new m(0,0,0)}}),czm_extendSpotLightDistance:new ct({size:1,datatype:ee.FLOAT,getValue:function(t){return t.extendSpotLightDistance||0}}),czm_extendSpotLightCosNum:new ct({size:1,datatype:ee.FLOAT,getValue:function(t){return t.extendSpotLightCosNum||0}}),czm_extendParallelLight1Direction:new ct({size:1,datatype:ee.FLOAT_VEC3,getValue:function(t){return t.extendParallelLight1Direction||0}}),czm_extendParallelLight1Brightness:new ct({size:1,datatype:ee.FLOAT,getValue:function(t){return t.extendParallelLight1Brightness||0}}),czm_extendParallelLight1Color:new ct({size:1,datatype:ee.FLOAT_VEC3,getValue:function(t){return t.extendParallelLight1Color||0}}),czm_extendParallelLight1Enable:new ct({size:1,datatype:ee.BOOL,getValue:function(t){return t.extendParallelLight1Enable||0}}),czm_extendParallelLight2Direction:new ct({size:1,datatype:ee.FLOAT_VEC3,getValue:function(t){return t.extendParallelLight2Direction||0}}),czm_extendParallelLight2Brightness:new ct({size:1,datatype:ee.FLOAT,getValue:function(t){return t.extendParallelLight2Brightness||0}}),czm_extendParallelLight2Color:new ct({size:1,datatype:ee.FLOAT_VEC3,getValue:function(t){return t.extendParallelLight2Color||0}}),czm_extendParallelLight2Enable:new ct({size:1,datatype:ee.BOOL,getValue:function(t){return t.extendParallelLight2Enable||0}})},Hp=fbe;function dbe(t,n,i,o){switch(n.type){case t.FLOAT:return new EK(t,n,i,o);case t.FLOAT_VEC2:return new bK(t,n,i,o);case t.FLOAT_VEC3:return new SK(t,n,i,o);case t.FLOAT_VEC4:return new wK(t,n,i,o);case t.SAMPLER_2D:case t.SAMPLER_CUBE:return new c8(t,n,i,o);case t.INT:case t.BOOL:return new DK(t,n,i,o);case t.INT_VEC2:case t.BOOL_VEC2:return new vK(t,n,i,o);case t.INT_VEC3:case t.BOOL_VEC3:return new PK(t,n,i,o);case t.INT_VEC4:case t.BOOL_VEC4:return new IK(t,n,i,o);case t.FLOAT_MAT2:return new BK(t,n,i,o);case t.FLOAT_MAT3:return new OK(t,n,i,o);case t.FLOAT_MAT4:return new RK(t,n,i,o);default:throw new he(`Unrecognized uniform type: ${n.type} for uniform "${i}".`)}}function EK(t,n,i,o){this.name=i,this.value=void 0,this._value=0,this._gl=t,this._location=o}EK.prototype.set=function(){this.value!==this._value&&(this._value=this.value,this._gl.uniform1f(this._location,this.value))};function bK(t,n,i,o){this.name=i,this.value=void 0,this._value=new W,this._gl=t,this._location=o}bK.prototype.set=function(){let t=this.value;W.equals(t,this._value)||(W.clone(t,this._value),this._gl.uniform2f(this._location,t.x,t.y))};function SK(t,n,i,o){this.name=i,this.value=void 0,this._value=void 0,this._gl=t,this._location=o}SK.prototype.set=function(){let t=this.value;f(t.red)?z.equals(t,this._value)||(this._value=z.clone(t,this._value),this._gl.uniform3f(this._location,t.red,t.green,t.blue)):f(t.x)&&(m.equals(t,this._value)||(this._value=m.clone(t,this._value),this._gl.uniform3f(this._location,t.x,t.y,t.z)))};function wK(t,n,i,o){this.name=i,this.value=void 0,this._value=void 0,this._gl=t,this._location=o}wK.prototype.set=function(){let t=this.value;f(t.red)?z.equals(t,this._value)||(this._value=z.clone(t,this._value),this._gl.uniform4f(this._location,t.red,t.green,t.blue,t.alpha)):f(t.x)&&(se.equals(t,this._value)||(this._value=se.clone(t,this._value),this._gl.uniform4f(this._location,t.x,t.y,t.z,t.w)))};function c8(t,n,i,o){this.name=i,this.value=void 0,this._gl=t,this._location=o,this.textureUnitIndex=void 0}c8.prototype.set=function(){let t=this._gl;t.activeTexture(t.TEXTURE0+this.textureUnitIndex);let n=this.value;t.bindTexture(n._target,n._texture)};c8.prototype._setSampler=function(t){return this.textureUnitIndex=t,this._gl.uniform1i(this._location,t),t+1};function DK(t,n,i,o){this.name=i,this.value=void 0,this._value=0,this._gl=t,this._location=o}DK.prototype.set=function(){this.value!==this._value&&(this._value=this.value,this._gl.uniform1i(this._location,this.value))};function vK(t,n,i,o){this.name=i,this.value=void 0,this._value=new W,this._gl=t,this._location=o}vK.prototype.set=function(){let t=this.value;W.equals(t,this._value)||(W.clone(t,this._value),this._gl.uniform2i(this._location,t.x,t.y))};function PK(t,n,i,o){this.name=i,this.value=void 0,this._value=new m,this._gl=t,this._location=o}PK.prototype.set=function(){let t=this.value;m.equals(t,this._value)||(m.clone(t,this._value),this._gl.uniform3i(this._location,t.x,t.y,t.z))};function IK(t,n,i,o){this.name=i,this.value=void 0,this._value=new se,this._gl=t,this._location=o}IK.prototype.set=function(){let t=this.value;se.equals(t,this._value)||(se.clone(t,this._value),this._gl.uniform4i(this._location,t.x,t.y,t.z,t.w))};var hbe=new Float32Array(4);function BK(t,n,i,o){this.name=i,this.value=void 0,this._value=new Ji,this._gl=t,this._location=o}BK.prototype.set=function(){if(!Ji.equalsArray(this.value,this._value,0)){Ji.clone(this.value,this._value);let t=Ji.toArray(this.value,hbe);this._gl.uniformMatrix2fv(this._location,!1,t)}};var mbe=new Float32Array(9);function OK(t,n,i,o){this.name=i,this.value=void 0,this._value=new $,this._gl=t,this._location=o}OK.prototype.set=function(){if(!$.equalsArray(this.value,this._value,0)){$.clone(this.value,this._value);let t=$.toArray(this.value,mbe);this._gl.uniformMatrix3fv(this._location,!1,t)}};var pbe=new Float32Array(16);function RK(t,n,i,o){this.name=i,this.value=void 0,this._value=new N,this._gl=t,this._location=o}RK.prototype.set=function(){if(!N.equalsArray(this.value,this._value,0)){N.clone(this.value,this._value);let t=N.toArray(this.value,pbe);this._gl.uniformMatrix4fv(this._location,!1,t)}};var V1=dbe;function _be(t,n,i,o){switch(n.type){case t.FLOAT:return new MK(t,n,i,o);case t.FLOAT_VEC2:return new LK(t,n,i,o);case t.FLOAT_VEC3:return new FK(t,n,i,o);case t.FLOAT_VEC4:return new NK(t,n,i,o);case t.SAMPLER_2D:case t.SAMPLER_CUBE:return new l8(t,n,i,o);case t.INT:case t.BOOL:return new VK(t,n,i,o);case t.INT_VEC2:case t.BOOL_VEC2:return new kK(t,n,i,o);case t.INT_VEC3:case t.BOOL_VEC3:return new UK(t,n,i,o);case t.INT_VEC4:case t.BOOL_VEC4:return new zK(t,n,i,o);case t.FLOAT_MAT2:return new HK(t,n,i,o);case t.FLOAT_MAT3:return new GK(t,n,i,o);case t.FLOAT_MAT4:return new WK(t,n,i,o);default:throw new he(`Unrecognized uniform type: ${n.type} for uniform "${i}".`)}}function MK(t,n,i,o){let r=o.length;this.name=i,this.value=new Array(r),this._value=new Float32Array(r),this._gl=t,this._location=o[0]}MK.prototype.set=function(){let t=this.value,n=t.length,i=this._value,o=!1;for(let r=0;r<n;++r){let s=t[r];s!==i[r]&&(i[r]=s,o=!0)}o&&this._gl.uniform1fv(this._location,i)};function LK(t,n,i,o){let r=o.length;this.name=i,this.value=new Array(r),this._value=new Float32Array(r*2),this._gl=t,this._location=o[0]}LK.prototype.set=function(){let t=this.value,n=t.length,i=this._value,o=!1,r=0;for(let s=0;s<n;++s){let a=t[s];W.equalsArray(a,i,r)||(W.pack(a,i,r),o=!0),r+=2}o&&this._gl.uniform2fv(this._location,i)};function FK(t,n,i,o){let r=o.length;this.name=i,this.value=new Array(r),this._value=new Float32Array(r*3),this._gl=t,this._location=o[0]}FK.prototype.set=function(){let t=this.value,n=t.length,i=this._value,o=!1,r=0;for(let s=0;s<n;++s){let a=t[s];f(a.red)?(a.red!==i[r]||a.green!==i[r+1]||a.blue!==i[r+2])&&(i[r]=a.red,i[r+1]=a.green,i[r+2]=a.blue,o=!0):f(a.x)&&(m.equalsArray(a,i,r)||(m.pack(a,i,r),o=!0)),r+=3}o&&this._gl.uniform3fv(this._location,i)};function NK(t,n,i,o){let r=o.length;this.name=i,this.value=new Array(r),this._value=new Float32Array(r*4),this._gl=t,this._location=o[0]}NK.prototype.set=function(){let t=this.value,n=t.length,i=this._value,o=!1,r=0;for(let s=0;s<n;++s){let a=t[s];f(a.red)?z.equalsArray(a,i,r)||(z.pack(a,i,r),o=!0):f(a.x)&&(se.equalsArray(a,i,r)||(se.pack(a,i,r),o=!0)),r+=4}o&&this._gl.uniform4fv(this._location,i)};function l8(t,n,i,o){let r=o.length;this.name=i,this.value=new Array(r),this._value=new Float32Array(r),this._gl=t,this._locations=o,this.textureUnitIndex=void 0}l8.prototype.set=function(){let t=this._gl,n=t.TEXTURE0+this.textureUnitIndex,i=this.value,o=i.length;for(let r=0;r<o;++r){let s=i[r];t.activeTexture(n+r),t.bindTexture(s._target,s._texture)}};l8.prototype._setSampler=function(t){this.textureUnitIndex=t;let n=this._locations,i=n.length;for(let o=0;o<i;++o){let r=t+o;this._gl.uniform1i(n[o],r)}return t+i};function VK(t,n,i,o){let r=o.length;this.name=i,this.value=new Array(r),this._value=new Int32Array(r),this._gl=t,this._location=o[0]}VK.prototype.set=function(){let t=this.value,n=t.length,i=this._value,o=!1;for(let r=0;r<n;++r){let s=t[r];s!==i[r]&&(i[r]=s,o=!0)}o&&this._gl.uniform1iv(this._location,i)};function kK(t,n,i,o){let r=o.length;this.name=i,this.value=new Array(r),this._value=new Int32Array(r*2),this._gl=t,this._location=o[0]}kK.prototype.set=function(){let t=this.value,n=t.length,i=this._value,o=!1,r=0;for(let s=0;s<n;++s){let a=t[s];W.equalsArray(a,i,r)||(W.pack(a,i,r),o=!0),r+=2}o&&this._gl.uniform2iv(this._location,i)};function UK(t,n,i,o){let r=o.length;this.name=i,this.value=new Array(r),this._value=new Int32Array(r*3),this._gl=t,this._location=o[0]}UK.prototype.set=function(){let t=this.value,n=t.length,i=this._value,o=!1,r=0;for(let s=0;s<n;++s){let a=t[s];m.equalsArray(a,i,r)||(m.pack(a,i,r),o=!0),r+=3}o&&this._gl.uniform3iv(this._location,i)};function zK(t,n,i,o){let r=o.length;this.name=i,this.value=new Array(r),this._value=new Int32Array(r*4),this._gl=t,this._location=o[0]}zK.prototype.set=function(){let t=this.value,n=t.length,i=this._value,o=!1,r=0;for(let s=0;s<n;++s){let a=t[s];se.equalsArray(a,i,r)||(se.pack(a,i,r),o=!0),r+=4}o&&this._gl.uniform4iv(this._location,i)};function HK(t,n,i,o){let r=o.length;this.name=i,this.value=new Array(r),this._value=new Float32Array(r*4),this._gl=t,this._location=o[0]}HK.prototype.set=function(){let t=this.value,n=t.length,i=this._value,o=!1,r=0;for(let s=0;s<n;++s){let a=t[s];Ji.equalsArray(a,i,r)||(Ji.pack(a,i,r),o=!0),r+=4}o&&this._gl.uniformMatrix2fv(this._location,!1,i)};function GK(t,n,i,o){let r=o.length;this.name=i,this.value=new Array(r),this._value=new Float32Array(r*9),this._gl=t,this._location=o[0]}GK.prototype.set=function(){let t=this.value,n=t.length,i=this._value,o=!1,r=0;for(let s=0;s<n;++s){let a=t[s];$.equalsArray(a,i,r)||($.pack(a,i,r),o=!0),r+=9}o&&this._gl.uniformMatrix3fv(this._location,!1,i)};function WK(t,n,i,o){let r=o.length;this.name=i,this.value=new Array(r),this._value=new Float32Array(r*16),this._gl=t,this._location=o[0]}WK.prototype.set=function(){let t=this.value,n=t.length,i=this._value,o=!1,r=0;for(let s=0;s<n;++s){let a=t[s];N.equalsArray(a,i,r)||(N.pack(a,i,r),o=!0),r+=16}o&&this._gl.uniformMatrix4fv(this._location,!1,i)};var k1=_be;var gbe=0;function fm(t){let n=t.vertexShaderText,i=t.fragmentShaderText;typeof spector!="undefined"&&(n=n.replace(/^#line/gm,"//#line"),i=i.replace(/^#line/gm,"//#line"));let o=ybe(n,i);this._gl=t.gl,this._logShaderCompilation=t.logShaderCompilation,this._debugShaders=t.debugShaders,this._attributeLocations=t.attributeLocations,this._program=void 0,this._numberOfVertexAttributes=void 0,this._vertexAttributes=void 0,this._uniformsByName=void 0,this._uniforms=void 0,this._automaticUniforms=void 0,this._manualUniforms=void 0,this._duplicateUniformNames=o.duplicateUniformNames,this._cachedShader=void 0,this.maximumTextureUnitIndex=void 0,this._vertexShaderSource=t.vertexShaderSource,this._vertexShaderText=t.vertexShaderText,this._fragmentShaderSource=t.fragmentShaderSource,this._fragmentShaderText=o.fragmentShaderText,this.id=gbe++}fm.fromCache=function(t){return t=A(t,A.EMPTY_OBJECT),t.context.shaderCache.getShaderProgram(t)};fm.replaceCache=function(t){return t=A(t,A.EMPTY_OBJECT),t.context.shaderCache.replaceShaderProgram(t)};Object.defineProperties(fm.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},vertexAttributes:{get:function(){return U1(this),this._vertexAttributes}},numberOfVertexAttributes:{get:function(){return U1(this),this._numberOfVertexAttributes}},allUniforms:{get:function(){return U1(this),this._uniformsByName}}});function jK(t){let n=[],i=t.match(/uniform.*?(?![^{]*})(?=[=\[;])/g);if(f(i)){let o=i.length;for(let r=0;r<o;r++){let s=i[r].trim(),a=s.slice(s.lastIndexOf(" ")+1);n.push(a)}}return n}function ybe(t,n){let i={};if(!Ut.highpFloatSupported||!Ut.highpIntSupported){let o,r,s,a,c=jK(t),l=jK(n),u=c.length,d=l.length;for(o=0;o<u;o++)for(r=0;r<d;r++)if(c[o]===l[r]){s=c[o],a=`czm_mediump_${s}`;let h=new RegExp(`${s}\\b`,"g");n=n.replace(h,a),i[a]=s}}return{fragmentShaderText:n,duplicateUniformNames:i}}var Nd="[Cesium WebGL] ";function Abe(t,n){let i=n._vertexShaderText,o=n._fragmentShaderText,r=t.createShader(t.VERTEX_SHADER);t.shaderSource(r,i),t.compileShader(r);let s=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(s,o),t.compileShader(s);let a=t.createProgram();t.attachShader(a,r),t.attachShader(a,s);let c=n._attributeLocations;if(f(c))for(let _ in c)c.hasOwnProperty(_)&&t.bindAttribLocation(a,c[_],_);t.linkProgram(a);let l;if(t.getProgramParameter(a,t.LINK_STATUS))return n._logShaderCompilation&&(l=t.getShaderInfoLog(r),f(l)&&l.length>0&&console.log(`${Nd}Vertex shader compile log: ${l}`),l=t.getShaderInfoLog(s),f(l)&&l.length>0&&console.log(`${Nd}Fragment shader compile log: ${l}`),l=t.getProgramInfoLog(a),f(l)&&l.length>0&&console.log(`${Nd}Shader program link log: ${l}`)),t.deleteShader(r),t.deleteShader(s),a;let u,d=n._debugShaders;throw t.getShaderParameter(s,t.COMPILE_STATUS)?t.getShaderParameter(r,t.COMPILE_STATUS)?(l=t.getProgramInfoLog(a),console.error(`${Nd}Shader program link log: ${l}`),h(r,"vertex"),h(s,"fragment"),u=`Program failed to link.  Link log: ${l}`):(l=t.getShaderInfoLog(r),console.error(`${Nd}Vertex shader compile log: ${l}`),console.error(`${Nd} Vertex shader source:
${i}`),u=`Vertex shader failed to compile.  Compile log: ${l}`):(l=t.getShaderInfoLog(s),console.error(`${Nd}Fragment shader compile log: ${l}`),console.error(`${Nd} Fragment shader source:
${o}`),u=`Fragment shader failed to compile.  Compile log: ${l}`),t.deleteShader(r),t.deleteShader(s),t.deleteProgram(a),new he(u);function h(_,y){if(!f(d))return;let p=d.getTranslatedShaderSource(_);if(p===""){console.error(`${Nd}${y} shader translation failed.`);return}console.error(`${Nd}Translated ${y} shaderSource:
${p}`)}}function Cbe(t,n,i){let o={};for(let r=0;r<i;++r){let s=t.getActiveAttrib(n,r),a=t.getAttribLocation(n,s.name);o[s.name]={name:s.name,type:s.type,index:a}}return o}function xbe(t,n){let i={},o=[],r=[],s=t.getProgramParameter(n,t.ACTIVE_UNIFORMS);for(let a=0;a<s;++a){let c=t.getActiveUniform(n,a),l="[0]",u=c.name.indexOf(l,c.name.length-l.length)!==-1?c.name.slice(0,c.name.length-3):c.name;if(u.indexOf("gl_")!==0)if(c.name.indexOf("[")<0){let d=t.getUniformLocation(n,u);if(d!==null){let h=V1(t,c,u,d);i[u]=h,o.push(h),h._setSampler&&r.push(h)}}else{let d,h,_,y,p=u.indexOf("[");if(p>=0){if(d=i[u.slice(0,p)],!f(d))continue;h=d._locations,h.length<=1&&(_=d.value,y=t.getUniformLocation(n,u),y!==null&&(h.push(y),_.push(t.getUniform(n,y))))}else{h=[];for(let C=0;C<c.size;++C)y=t.getUniformLocation(n,`${u}[${C}]`),y!==null&&h.push(y);d=k1(t,c,u,h),i[u]=d,o.push(d),d._setSampler&&r.push(d)}}}return{uniformsByName:i,uniforms:o,samplerUniforms:r}}function Tbe(t,n){let i=[],o=[];for(let r in n)if(n.hasOwnProperty(r)){let s=n[r],a=r,c=t._duplicateUniformNames[a];f(c)&&(s.name=c,a=c);let l=Hp[a];f(l)?i.push({uniform:s,automaticUniform:l}):o.push(s)}return{automaticUniforms:i,manualUniforms:o}}function Ebe(t,n,i){t.useProgram(n);let o=0,r=i.length;for(let s=0;s<r;++s)o=i[s]._setSampler(o);return t.useProgram(null),o}function U1(t){f(t._program)||qK(t)}function qK(t){let n=t._program,i=t._gl,o=Abe(i,t,t._debugShaders),r=i.getProgramParameter(o,i.ACTIVE_ATTRIBUTES),s=xbe(i,o),a=Tbe(t,s.uniformsByName);t._program=o,t._numberOfVertexAttributes=r,t._vertexAttributes=Cbe(i,o,r),t._uniformsByName=s.uniformsByName,t._uniforms=s.uniforms,t._automaticUniforms=a.automaticUniforms,t._manualUniforms=a.manualUniforms,t.maximumTextureUnitIndex=Ebe(i,o,s.samplerUniforms),n&&t._gl.deleteProgram(n),typeof spector!="undefined"&&(t._program.__SPECTOR_rebuildProgram=function(c,l,u,d){let h=t._vertexShaderText,_=t._fragmentShaderText,y=/ ! = /g;t._vertexShaderText=c.replace(y," != "),t._fragmentShaderText=l.replace(y," != ");try{qK(t),u(t._program)}catch(p){t._vertexShaderText=h,t._fragmentShaderText=_;let x=/(?:Compile|Link) error: ([^]*)/.exec(p.message);d(x?x[1]:p.message)}})}fm.prototype._bind=function(){U1(this),this._gl.useProgram(this._program)};fm.prototype._setUniforms=function(t,n,i){let o,r;if(f(t)){let c=this._manualUniforms;for(o=c.length,r=0;r<o;++r){let l=c[r];l.value=t[l.name]()}}let s=this._automaticUniforms;for(o=s.length,r=0;r<o;++r){let c=s[r];c.uniform.value=c.automaticUniform.getValue(n)}let a=this._uniforms;for(o=a.length,r=0;r<o;++r)a[r].set();if(i){let c=this._gl,l=this._program;c.validateProgram(l)}};fm.prototype.isDestroyed=function(){return!1};fm.prototype.destroy=function(){this._cachedShader.cache.releaseShaderProgram(this)};fm.prototype.finalDestroy=function(){return this._gl.deleteProgram(this._program),ue(this)};var qt=fm;var bbe=["Khronos glTF Blender I/O v0.9.36","obj2gltf"],YK={trustGenerator:["fanfan","cesiumlab"],canvasScale:{x:1,y:1},tailorBrightNum:1.1,enableTailorBright:!1,_defaultExcavateAnalysis:{splitNum:30,showSelfOnly:!1,dig_pos_x:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],dig_pos_y:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],dig_pos_z:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],rect_dig:[0,0,0,0,0,0,0,0,0],dig_max_index:0,excavateHeight:0,excavateMinHeight:9999,excavatePerPoint:!1},excavateAnalysis:{splitNum:30,showSelfOnly:!1,dig_pos_x:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],dig_pos_y:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],dig_pos_z:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],rect_dig:[0,0,0,0,0,0,0,0,0],dig_max_index:0,excavateHeight:0,excavateMinHeight:9999,excavatePerPoint:!1},resetExcavateAnalysis:function(){this.excavateAnalysis=tt(this._defaultExcavateAnalysis)},_defaultTilesEditor:{floodVar:[0,0,0,0],IsYaPing:[!1,!1,!1,!1],modelLight:2.2,b3dmOffset:void 0,editVar:[!1,!1,!1,!1],floodColor:[0,0,0,.5],heightVar:[0,0]},tilesEditor:{floodVar:[0,0,0,0],IsYaPing:[!1,!1,!1,!1],modelLight:2.2,b3dmOffset:void 0,editVar:[!1,!1,!1,!1],floodColor:[0,0,0,.5],heightVar:[0,0]},resetTilesEditor:function(){this.tilesEditor=tt(this._defaultTilesEditor)},underEarth:{cullFace:void 0,enable:void 0,enableDepth:100,enableSkirt:!1},occlusionOpen:!0,ableTilesFbo:!1,mirror:{MirrorEnable:!1,MirrorProjectionMatrix:new N,MirrorViewMatrix:new N},bloomTiles:{fgNum:0,blurRadius:3,brightStrength:9,ableBloom:!1},bloomElse:{fgNum:0,blurRadius:2,brightStrength:20},bloomTools:{},tailorTiles:{contrast:.5},baseMap:{blend:!1,color:new z(1,1,1,0)},Gltf:{ableUvMove:!1},Light:{point:{able:!1,color:new z(0,0,0)},spot:{able:!1,color:new z(0,0,0)},mbient:{able:!1,color:new z(0,0,0)},parallel:{able:!1,color:new z(0,0,0)}},GridTileOpt:{cameraMoving:!1,allowRequestImg:!0},isSelfGltf:function(t){return!!(t.asset&&t.asset.generator&&bbe.indexOf(t.asset.generator)>=0)},lightObj:{extendLightSwitch:new se(!1,!1,!1,!1),extendAmbientLightColor:new z(0,0,0),extendAmbientLightBrightness:1,extendPointLightColor:new z(0,0,0),extendPointLightPositionWC:new m,extendPointLightPositionEC:new m,extendPointLightDistance:0,extendPointLightBrightness:1,extendSpotLightColor:new z(0,0,0),extendSpotLightPositionWC:new m,extendSpotLightPositionEC:new m,extendSpotLightDirectionWC:new m,extendSpotLightDirectionEC:new m,extendSpotLightDistance:0,extendSpotLightAngle:0,extendSpotLightBrightness:1,extendParallelLight1Direction:new m,extendParallelLight1Brightness:1,extendParallelLight1Color:new z(0,0,0),extendParallelLight1Enable:!1,extendParallelLight2Direction:new m,extendParallelLight2Brightness:1,extendParallelLight2Color:new z(0,0,0),extendParallelLight2Enable:!1},updateLight:function(t){t.extendLightSwitch=this.lightObj.extendLightSwitch,t.extendLightSwitch.x&&(t.extendAmbientLightBrightness=this.lightObj.extendAmbientLightBrightness,t.extendAmbientLightColor=this.lightObj.extendAmbientLightColor),t.extendLightSwitch.y&&(t.extendPointLightBrightness=this.lightObj.extendPointLightBrightness/10,t.extendPointLightColor=this.lightObj.extendPointLightColor,t.extendPointLightDistance=this.lightObj.extendPointLightDistance,t.extendPointLightPositionWC=this.lightObj.extendPointLightPositionWC,t.extendPointLightPositionEC=N.multiplyByPoint(t.modelView,t.extendPointLightPositionWC,new m)),t.extendLightSwitch.z&&(t.extendSpotLightBrightness=this.lightObj.extendSpotLightBrightness/10,t.extendSpotLightPositionWC=this.lightObj.extendSpotLightPositionWC,t.extendSpotLightColor=this.lightObj.extendSpotLightColor,t.extendSpotLightDistance=this.lightObj.extendSpotLightDistance,t.extendSpotLightCosNum=Math.cos(B.toRadians(this.lightObj.extendSpotLightAngle/2)),t.extendSpotLightDirectionWC=m.normalize(m.negate(this.lightObj.extendSpotLightDirectionWC,new m),new m),t.extendSpotLightDirectionEC=m.normalize($.multiplyByVector(t.viewRotation3D,t.extendSpotLightDirectionWC,new m),new m),t.extendSpotLightPositionEC=N.multiplyByPoint(t.modelView,t.extendSpotLightPositionWC,new m)),t.extendParallelLight1Enable=this.lightObj.extendParallelLight1Enable,t.extendParallelLight1Enable&&(t.extendParallelLight1Direction=m.normalize($.multiplyByVector(t.viewRotation3D,this.lightObj.extendParallelLight1Direction,new m),new m),t.extendParallelLight1Brightness=this.lightObj.extendParallelLight1Brightness,t.extendParallelLight1Color=this.lightObj.extendParallelLight1Color),t.extendParallelLight2Enable=this.lightObj.extendParallelLight2Enable,t.extendParallelLight2Enable&&(t.extendParallelLight2Direction=m.normalize($.multiplyByVector(t.viewRotation3D,this.lightObj.extendParallelLight2Direction,new m),new m),t.extendParallelLight2Brightness=this.lightObj.extendParallelLight2Brightness,t.extendParallelLight2Color=this.lightObj.extendParallelLight2Color)},bloomInside:{fgNum:0,blurRadius:5.5,brightStrength:11},_bloomSizeScale:2,enableGlobeLight:!1,_inverSceneDefinition:.5,definitionChange:!1,bloomSizeChange:!1,throttleByServer:!1,createViewportQuadCommand:function(t,n,i,o){return o=A(o,A.EMPTY_OBJECT),new et({vertexArray:t.getViewportQuadVertexArray(),primitiveType:Re.TRIANGLES,renderState:o.renderState,shaderProgram:qt.fromCache({context:t,vertexShaderSource:n,fragmentShaderSource:i,attributeLocations:{position:0,textureCoordinates:1}}),uniformMap:o.uniformMap,owner:o.owner,framebuffer:o.framebuffer,pass:o.pass})}};Object.defineProperty(YK,"inverSceneDefinition",{get:function(){return this._inverSceneDefinition},set:function(t){t=t||1,this.definitionChange=!0,this._inverSceneDefinition=t}});var xt=YK;function u8(t,n,i){let o=t._gl;o.framebufferTexture2D(o.FRAMEBUFFER,n,i._target,i._texture,0)}function z1(t,n,i){let o=t._gl;o.framebufferRenderbuffer(o.FRAMEBUFFER,n,o.RENDERBUFFER,i._getRenderbuffer())}function Tf(t){t=A(t,A.EMPTY_OBJECT);let i=t.context._gl,o=Ut.maximumColorAttachments;this._gl=i,this._framebuffer=i.createFramebuffer(),this._colorTextures=[],this._colorRenderbuffers=[],this._activeColorAttachments=[],this._depthTexture=void 0,this._depthRenderbuffer=void 0,this._stencilRenderbuffer=void 0,this._depthStencilTexture=void 0,this._depthStencilRenderbuffer=void 0,this.destroyAttachments=A(t.destroyAttachments,!0);let r=f(t.depthTexture)||f(t.depthRenderbuffer),s=f(t.depthStencilTexture)||f(t.depthStencilRenderbuffer);this._bind();let a,c,l,u,d;if(f(t.colorTextures)){let h=t.colorTextures;for(u=this._colorTextures.length=this._activeColorAttachments.length=h.length,l=0;l<u;++l)a=h[l],d=this._gl.COLOR_ATTACHMENT0+l,u8(this,d,a),this._activeColorAttachments[l]=d,this._colorTextures[l]=a}if(f(t.colorRenderbuffers)){let h=t.colorRenderbuffers;for(u=this._colorRenderbuffers.length=this._activeColorAttachments.length=h.length,l=0;l<u;++l)c=h[l],d=this._gl.COLOR_ATTACHMENT0+l,z1(this,d,c),this._activeColorAttachments[l]=d,this._colorRenderbuffers[l]=c}f(t.depthTexture)&&(a=t.depthTexture,u8(this,this._gl.DEPTH_ATTACHMENT,a),this._depthTexture=a),f(t.depthRenderbuffer)&&(c=t.depthRenderbuffer,z1(this,this._gl.DEPTH_ATTACHMENT,c),this._depthRenderbuffer=c),f(t.stencilRenderbuffer)&&(c=t.stencilRenderbuffer,z1(this,this._gl.STENCIL_ATTACHMENT,c),this._stencilRenderbuffer=c),f(t.depthStencilTexture)&&(a=t.depthStencilTexture,u8(this,this._gl.DEPTH_STENCIL_ATTACHMENT,a),this._depthStencilTexture=a),f(t.depthStencilRenderbuffer)&&(c=t.depthStencilRenderbuffer,z1(this,this._gl.DEPTH_STENCIL_ATTACHMENT,c),this._depthStencilRenderbuffer=c),this._unBind()}Object.defineProperties(Tf.prototype,{status:{get:function(){this._bind();let t=this._gl.checkFramebufferStatus(this._gl.FRAMEBUFFER);return this._unBind(),t}},numberOfColorAttachments:{get:function(){return this._activeColorAttachments.length}},depthTexture:{get:function(){return this._depthTexture}},depthRenderbuffer:{get:function(){return this._depthRenderbuffer}},stencilRenderbuffer:{get:function(){return this._stencilRenderbuffer}},depthStencilTexture:{get:function(){return this._depthStencilTexture}},depthStencilRenderbuffer:{get:function(){return this._depthStencilRenderbuffer}},hasDepthAttachment:{get:function(){return!!(this.depthTexture||this.depthRenderbuffer||this.depthStencilTexture||this.depthStencilRenderbuffer)}}});Tf.prototype._bind=function(){let t=this._gl;t.bindFramebuffer(t.FRAMEBUFFER,this._framebuffer)};Tf.prototype._unBind=function(){let t=this._gl;t.bindFramebuffer(t.FRAMEBUFFER,null)};Tf.prototype.bindDraw=function(){let t=this._gl;t.bindFramebuffer(t.DRAW_FRAMEBUFFER,this._framebuffer)};Tf.prototype.bindRead=function(){let t=this._gl;t.bindFramebuffer(t.READ_FRAMEBUFFER,this._framebuffer)};Tf.prototype._getActiveColorAttachments=function(){return this._activeColorAttachments};Tf.prototype.getColorTexture=function(t){return this._colorTextures[t]};Tf.prototype.getColorRenderbuffer=function(t){return this._colorRenderbuffers[t]};Tf.prototype.isDestroyed=function(){return!1};Tf.prototype.destroy=function(){if(this.destroyAttachments){let t=0,n=this._colorTextures,i=n.length;for(;t<i;++t){let r=n[t];f(r)&&r.destroy()}let o=this._colorRenderbuffers;for(i=o.length,t=0;t<i;++t){let r=o[t];f(r)&&r.destroy()}this._depthTexture=this._depthTexture&&this._depthTexture.destroy(),this._depthRenderbuffer=this._depthRenderbuffer&&this._depthRenderbuffer.destroy(),this._stencilRenderbuffer=this._stencilRenderbuffer&&this._stencilRenderbuffer.destroy(),this._depthStencilTexture=this._depthStencilTexture&&this._depthStencilTexture.destroy(),this._depthStencilRenderbuffer=this._depthStencilRenderbuffer&&this._depthStencilRenderbuffer.destroy()}return this._gl.deleteFramebuffer(this._framebuffer),ue(this)};var Xo=Tf;var qi={SCALAR:"SCALAR",VEC2:"VEC2",VEC3:"VEC3",VEC4:"VEC4",MAT2:"MAT2",MAT3:"MAT3",MAT4:"MAT4"};qi.getMathType=function(t){switch(t){case qi.SCALAR:return Number;case qi.VEC2:return W;case qi.VEC3:return m;case qi.VEC4:return se;case qi.MAT2:return Ji;case qi.MAT3:return $;case qi.MAT4:return N}};qi.getNumberOfComponents=function(t){switch(t){case qi.SCALAR:return 1;case qi.VEC2:return 2;case qi.VEC3:return 3;case qi.VEC4:case qi.MAT2:return 4;case qi.MAT3:return 9;case qi.MAT4:return 16}};qi.getAttributeLocationCount=function(t){switch(t){case qi.SCALAR:case qi.VEC2:case qi.VEC3:case qi.VEC4:return 1;case qi.MAT2:return 2;case qi.MAT3:return 3;case qi.MAT4:return 4}};qi.getGlslType=function(t){switch(t){case qi.SCALAR:return"float";case qi.VEC2:return"vec2";case qi.VEC3:return"vec3";case qi.VEC4:return"vec4";case qi.MAT2:return"mat2";case qi.MAT3:return"mat3";case qi.MAT4:return"mat4"}};var nn=Object.freeze(qi);var XK=1/256,KK=256,uo={};uo.octEncodeInRange=function(t,n,i){if(i.x=t.x/(Math.abs(t.x)+Math.abs(t.y)+Math.abs(t.z)),i.y=t.y/(Math.abs(t.x)+Math.abs(t.y)+Math.abs(t.z)),t.z<0){let o=i.x,r=i.y;i.x=(1-Math.abs(r))*B.signNotZero(o),i.y=(1-Math.abs(o))*B.signNotZero(r)}return i.x=B.toSNorm(i.x,n),i.y=B.toSNorm(i.y,n),i};uo.octEncode=function(t,n){return uo.octEncodeInRange(t,255,n)};var Fb=new W,JK=new Uint8Array(1);function H1(t){return JK[0]=t,JK[0]}uo.octEncodeToCartesian4=function(t,n){return uo.octEncodeInRange(t,65535,Fb),n.x=H1(Fb.x*XK),n.y=H1(Fb.x),n.z=H1(Fb.y*XK),n.w=H1(Fb.y),n};uo.octDecodeInRange=function(t,n,i,o){if(o.x=B.fromSNorm(t,i),o.y=B.fromSNorm(n,i),o.z=1-(Math.abs(o.x)+Math.abs(o.y)),o.z<0){let r=o.x;o.x=(1-Math.abs(o.y))*B.signNotZero(r),o.y=(1-Math.abs(r))*B.signNotZero(o.y)}return m.normalize(o,o)};uo.octDecode=function(t,n,i){return uo.octDecodeInRange(t,n,255,i)};uo.octDecodeFromCartesian4=function(t,n){let i=t.x,o=t.y,r=t.z,s=t.w,a=i*KK+o,c=r*KK+s;return uo.octDecodeInRange(a,c,65535,n)};uo.octPackFloat=function(t){return 256*t.x+t.y};var d8=new W;uo.octEncodeFloat=function(t){return uo.octEncode(t,d8),uo.octPackFloat(d8)};uo.octDecodeFloat=function(t,n){let i=t/256,o=Math.floor(i),r=(i-o)*256;return uo.octDecode(o,r,n)};uo.octPack=function(t,n,i,o){let r=uo.octEncodeFloat(t),s=uo.octEncodeFloat(n),a=uo.octEncode(i,d8);return o.x=65536*a.x+r,o.y=65536*a.y+s,o};uo.octUnpack=function(t,n,i,o){let r=t.x/65536,s=Math.floor(r),a=(r-s)*65536;r=t.y/65536;let c=Math.floor(r),l=(r-c)*65536;uo.octDecodeFloat(a,n),uo.octDecodeFloat(l,i),uo.octDecode(s,c,o)};uo.compressTextureCoordinates=function(t){let n=t.x*4095|0,i=t.y*4095|0;return 4096*n+i};uo.decompressTextureCoordinates=function(t,n){let i=t/4096,o=Math.floor(i);return n.x=o/4095,n.y=(t-o*4096)/4095,n};function f8(t){return t>>1^-(t&1)}uo.zigZagDeltaDecode=function(t,n,i){let o=t.length,r=0,s=0,a=0;for(let c=0;c<o;++c)r+=f8(t[c]),s+=f8(n[c]),t[c]=r,n[c]=s,f(i)&&(a+=f8(i[c]),i[c]=a)};uo.dequantize=function(t,n,i,o){let r=nn.getNumberOfComponents(i),s;switch(n){case J.BYTE:s=127;break;case J.UNSIGNED_BYTE:s=255;break;case J.SHORT:s=32767;break;case J.UNSIGNED_SHORT:s=65535;break;case J.INT:s=2147483647;break;case J.UNSIGNED_INT:s=4294967295;break}let a=new Float32Array(o*r);for(let c=0;c<o;c++)for(let l=0;l<r;l++){let u=c*r+l;a[u]=Math.max(t[u]/s,-1)}return a};uo.decodeRGB565=function(t,n){let i=t.length;f(n)||(n=new Float32Array(i*3));let o=(1<<5)-1,r=(1<<6)-1,s=1/31,a=1/63;for(let c=0;c<i;c++){let l=t[c],u=l>>11,d=l>>5&r,h=l&o,_=3*c;n[_]=u*s,n[_+1]=d*a,n[_+2]=h*s}return n};var zn=uo;var ZK=new m,QK=new m,$K=new m;function Sbe(t,n,i,o,r){f(r)||(r=new m);let s,a,c,l,u,d,h,_;if(f(n.z)){if(m.equalsEpsilon(t,n,B.EPSILON14))return m.clone(m.UNIT_X,r);if(m.equalsEpsilon(t,i,B.EPSILON14))return m.clone(m.UNIT_Y,r);if(m.equalsEpsilon(t,o,B.EPSILON14))return m.clone(m.UNIT_Z,r);s=m.subtract(i,n,ZK),a=m.subtract(o,n,QK),c=m.subtract(t,n,$K),l=m.dot(s,s),u=m.dot(s,a),d=m.dot(s,c),h=m.dot(a,a),_=m.dot(a,c)}else{if(W.equalsEpsilon(t,n,B.EPSILON14))return m.clone(m.UNIT_X,r);if(W.equalsEpsilon(t,i,B.EPSILON14))return m.clone(m.UNIT_Y,r);if(W.equalsEpsilon(t,o,B.EPSILON14))return m.clone(m.UNIT_Z,r);s=W.subtract(i,n,ZK),a=W.subtract(o,n,QK),c=W.subtract(t,n,$K),l=W.dot(s,s),u=W.dot(s,a),d=W.dot(s,c),h=W.dot(a,a),_=W.dot(a,c)}r.y=h*d-u*_,r.z=l*_-u*d;let y=l*h-u*u;if(y!==0)return r.y/=y,r.z/=y,r.x=1-r.y-r.z,r}var TC=Sbe;function Vd(){this.high=m.clone(m.ZERO),this.low=m.clone(m.ZERO)}Vd.encode=function(t,n){f(n)||(n={high:0,low:0});let i;return t>=0?(i=Math.floor(t/65536)*65536,n.high=i,n.low=t-i):(i=Math.floor(-t/65536)*65536,n.high=-i,n.low=t+i),n};var dm={high:0,low:0};Vd.fromCartesian=function(t,n){f(n)||(n=new Vd);let i=n.high,o=n.low;return Vd.encode(t.x,dm),i.x=dm.high,o.x=dm.low,Vd.encode(t.y,dm),i.y=dm.high,o.y=dm.low,Vd.encode(t.z,dm),i.z=dm.high,o.z=dm.low,n};var h8=new Vd;Vd.writeElements=function(t,n,i){Vd.fromCartesian(t,h8);let o=h8.high,r=h8.low;n[i]=o.x,n[i+1]=o.y,n[i+2]=o.z,n[i+3]=r.x,n[i+4]=r.y,n[i+5]=r.z};var Hn=Vd;var ls={UNSIGNED_BYTE:ee.UNSIGNED_BYTE,UNSIGNED_SHORT:ee.UNSIGNED_SHORT,UNSIGNED_INT:ee.UNSIGNED_INT};ls.getSizeInBytes=function(t){switch(t){case ls.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case ls.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case ls.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT}};ls.fromSizeInBytes=function(t){switch(t){case 2:return ls.UNSIGNED_SHORT;case 4:return ls.UNSIGNED_INT;case 1:return ls.UNSIGNED_BYTE}};ls.validate=function(t){return f(t)&&(t===ls.UNSIGNED_BYTE||t===ls.UNSIGNED_SHORT||t===ls.UNSIGNED_INT)};ls.createTypedArray=function(t,n){return t>=B.SIXTY_FOUR_KILOBYTES?new Uint32Array(n):new Uint16Array(n)};ls.createTypedArrayFromArrayBuffer=function(t,n,i,o){return t>=B.SIXTY_FOUR_KILOBYTES?new Uint32Array(n,i,o):new Uint16Array(n,i,o)};ls.fromTypedArray=function(t){if(t instanceof Uint8Array)return ls.UNSIGNED_BYTE;if(t instanceof Uint16Array)return ls.UNSIGNED_SHORT;if(t instanceof Uint32Array)return ls.UNSIGNED_INT};var Ne=Object.freeze(ls);var m8={};m8.calculateACMR=function(t){t=A(t,A.EMPTY_OBJECT);let n=t.indices,i=t.maximumIndex,o=A(t.cacheSize,24),r=n.length;if(!f(i)){i=0;let c=0,l=n[c];for(;c<r;)l>i&&(i=l),++c,l=n[c]}let s=[];for(let c=0;c<i+1;c++)s[c]=0;let a=o+1;for(let c=0;c<r;++c)a-s[n[c]]>o&&(s[n[c]]=a,++a);return(a-o+1)/(r/3)};m8.tipsify=function(t){t=A(t,A.EMPTY_OBJECT);let n=t.indices,i=t.maximumIndex,o=A(t.cacheSize,24),r;function s(g,b,v,P){for(;b.length>=1;){let R=b[b.length-1];if(b.splice(b.length-1,1),g[R].numLiveTriangles>0)return R}for(;r<P;){if(g[r].numLiveTriangles>0)return++r,r-1;++r}return-1}function a(g,b,v,P,R,V,H){let U=-1,G,k=-1,X=0;for(;X<v.length;){let Y=v[X];P[Y].numLiveTriangles&&(G=0,R-P[Y].timeStamp+2*P[Y].numLiveTriangles<=b&&(G=R-P[Y].timeStamp),(G>k||k===-1)&&(k=G,U=Y)),++X}return U===-1?s(P,V,g,H):U}let c=n.length,l=0,u=0,d=n[u],h=c;if(f(i))l=i+1;else{for(;u<h;)d>l&&(l=d),++u,d=n[u];if(l===-1)return 0;++l}let _=[],y;for(y=0;y<l;y++)_[y]={numLiveTriangles:0,timeStamp:0,vertexTriangles:[]};u=0;let p=0;for(;u<h;)_[n[u]].vertexTriangles.push(p),++_[n[u]].numLiveTriangles,_[n[u+1]].vertexTriangles.push(p),++_[n[u+1]].numLiveTriangles,_[n[u+2]].vertexTriangles.push(p),++_[n[u+2]].numLiveTriangles,++p,u+=3;let C=0,x=o+1;r=1;let T=[],E=[],S,w,D=0,I=[],O=c/3,M=[];for(y=0;y<O;y++)M[y]=!1;let L,F;for(;C!==-1;){T=[],w=_[C],F=w.vertexTriangles.length;for(let g=0;g<F;++g)if(p=w.vertexTriangles[g],!M[p]){M[p]=!0,u=p+p+p;for(let b=0;b<3;++b)L=n[u],T.push(L),E.push(L),I[D]=L,++D,S=_[L],--S.numLiveTriangles,x-S.timeStamp>o&&(S.timeStamp=x,++x),++u}C=a(n,o,T,_,x,E,l)}return I};var G1=m8;var ic={};function J1(t,n,i,o,r){t[n++]=i,t[n++]=o,t[n++]=o,t[n++]=r,t[n++]=r,t[n]=i}function wbe(t){let n=t.length,i=n/3*6,o=Ne.createTypedArray(n,i),r=0;for(let s=0;s<n;s+=3,r+=6)J1(o,r,t[s],t[s+1],t[s+2]);return o}function Dbe(t){let n=t.length;if(n>=3){let i=(n-2)*6,o=Ne.createTypedArray(n,i);J1(o,0,t[0],t[1],t[2]);let r=6;for(let s=3;s<n;++s,r+=6)J1(o,r,t[s-1],t[s],t[s-2]);return o}return new Uint16Array}function vbe(t){if(t.length>0){let n=t.length-1,i=(n-1)*6,o=Ne.createTypedArray(n,i),r=t[0],s=0;for(let a=1;a<n;++a,s+=6)J1(o,s,r,t[a],t[a+1]);return o}return new Uint16Array}ic.toWireframe=function(t){let n=t.indices;if(f(n)){switch(t.primitiveType){case Re.TRIANGLES:t.indices=wbe(n);break;case Re.TRIANGLE_STRIP:t.indices=Dbe(n);break;case Re.TRIANGLE_FAN:t.indices=vbe(n);break}t.primitiveType=Re.LINES}return t};ic.createLineSegmentsForVectors=function(t,n,i){n=A(n,"normal"),i=A(i,1e4);let o=t.attributes.position.values,r=t.attributes[n].values,s=o.length,a=new Float64Array(2*s),c=0;for(let d=0;d<s;d+=3)a[c++]=o[d],a[c++]=o[d+1],a[c++]=o[d+2],a[c++]=o[d]+r[d]*i,a[c++]=o[d+1]+r[d+1]*i,a[c++]=o[d+2]+r[d+2]*i;let l,u=t.boundingSphere;return f(u)&&(l=new ae(u.center,u.radius+i)),new at({attributes:{position:new we({componentDatatype:J.DOUBLE,componentsPerAttribute:3,values:a})},primitiveType:Re.LINES,boundingSphere:l})};ic.createAttributeLocations=function(t){let n=["position","positionHigh","positionLow","position3DHigh","position3DLow","position2DHigh","position2DLow","pickColor","normal","st","tangent","bitangent","extrudeDirection","compressedAttributes"],i=t.attributes,o={},r=0,s,a=n.length;for(s=0;s<a;++s){let c=n[s];f(i[c])&&(o[c]=r++)}for(let c in i)i.hasOwnProperty(c)&&!f(o[c])&&(o[c]=r++);return o};ic.reorderForPreVertexCache=function(t){let n=at.computeNumberOfVertices(t),i=t.indices;if(f(i)){let o=new Int32Array(n);for(let _=0;_<n;_++)o[_]=-1;let r=i,s=r.length,a=Ne.createTypedArray(n,s),c=0,l=0,u=0,d;for(;c<s;)d=o[r[c]],d!==-1?a[l]=d:(d=r[c],o[d]=u,a[l]=u,++u),++c,++l;t.indices=a;let h=t.attributes;for(let _ in h)if(h.hasOwnProperty(_)&&f(h[_])&&f(h[_].values)){let y=h[_],p=y.values,C=0,x=y.componentsPerAttribute,T=J.createTypedArray(y.componentDatatype,u*x);for(;C<n;){let E=o[C];if(E!==-1)for(let S=0;S<x;S++)T[x*E+S]=p[x*C+S];++C}y.values=T}}return t};ic.reorderForPostVertexCache=function(t,n){let i=t.indices;if(t.primitiveType===Re.TRIANGLES&&f(i)){let o=i.length,r=0;for(let s=0;s<o;s++)i[s]>r&&(r=i[s]);t.indices=G1.tipsify({indices:i,maximumIndex:r,cacheSize:n})}return t};function eJ(t){let n={};for(let i in t)if(t.hasOwnProperty(i)&&f(t[i])&&f(t[i].values)){let o=t[i];n[i]=new we({componentDatatype:o.componentDatatype,componentsPerAttribute:o.componentsPerAttribute,normalize:o.normalize,values:[]})}return n}function Pbe(t,n,i){for(let o in n)if(n.hasOwnProperty(o)&&f(n[o])&&f(n[o].values)){let r=n[o];for(let s=0;s<r.componentsPerAttribute;++s)t[o].values.push(r.values[i*r.componentsPerAttribute+s])}}ic.fitToUnsignedShortIndices=function(t){let n=[],i=at.computeNumberOfVertices(t);if(f(t.indices)&&i>=B.SIXTY_FOUR_KILOBYTES){let o=[],r=[],s=0,a=eJ(t.attributes),c=t.indices,l=c.length,u;t.primitiveType===Re.TRIANGLES?u=3:t.primitiveType===Re.LINES?u=2:t.primitiveType===Re.POINTS&&(u=1);for(let d=0;d<l;d+=u){for(let h=0;h<u;++h){let _=c[d+h],y=o[_];f(y)||(y=s++,o[_]=y,Pbe(a,t.attributes,_)),r.push(y)}s+u>=B.SIXTY_FOUR_KILOBYTES&&(n.push(new at({attributes:a,indices:r,primitiveType:t.primitiveType,boundingSphere:t.boundingSphere,boundingSphereCV:t.boundingSphereCV})),o=[],r=[],s=0,a=eJ(t.attributes))}r.length!==0&&n.push(new at({attributes:a,indices:r,primitiveType:t.primitiveType,boundingSphere:t.boundingSphere,boundingSphereCV:t.boundingSphereCV}))}else n.push(t);return n};var tJ=new m,Ibe=new de;ic.projectTo2D=function(t,n,i,o,r){let s=t.attributes[n];r=f(r)?r:new Ci;let a=r.ellipsoid,c=s.values,l=new Float64Array(c.length),u=0;for(let d=0;d<c.length;d+=3){let h=m.fromArray(c,d,tJ),_=a.cartesianToCartographic(h,Ibe),y=r.project(_,tJ);l[u++]=y.x,l[u++]=y.y,l[u++]=y.z}return t.attributes[i]=s,t.attributes[o]=new we({componentDatatype:J.DOUBLE,componentsPerAttribute:3,values:l}),delete t.attributes[n],t};var p8={high:0,low:0};ic.encodeAttribute=function(t,n,i,o){let r=t.attributes[n],s=r.values,a=s.length,c=new Float32Array(a),l=new Float32Array(a);for(let d=0;d<a;++d)Hn.encode(s[d],p8),c[d]=p8.high,l[d]=p8.low;let u=r.componentsPerAttribute;return t.attributes[i]=new we({componentDatatype:J.FLOAT,componentsPerAttribute:u,values:c}),t.attributes[o]=new we({componentDatatype:J.FLOAT,componentsPerAttribute:u,values:l}),delete t.attributes[n],t};var bf=new m;function _8(t,n){if(f(n)){let i=n.values,o=i.length;for(let r=0;r<o;r+=3)m.unpack(i,r,bf),N.multiplyByPoint(t,bf,bf),m.pack(bf,i,r)}}function g8(t,n){if(f(n)){let i=n.values,o=i.length;for(let r=0;r<o;r+=3)m.unpack(i,r,bf),$.multiplyByVector(t,bf,bf),bf=m.normalize(bf,bf),m.pack(bf,i,r)}}var W1=new N,j1=new $;ic.transformToWorldCoordinates=function(t){let n=t.modelMatrix;if(N.equals(n,N.IDENTITY))return t;let i=t.geometry.attributes;_8(n,i.position),_8(n,i.prevPosition),_8(n,i.nextPosition),(f(i.normal)||f(i.tangent)||f(i.bitangent))&&(N.inverse(n,W1),N.transpose(W1,W1),N.getMatrix3(W1,j1),g8(j1,i.normal),g8(j1,i.tangent),g8(j1,i.bitangent));let o=t.geometry.boundingSphere;return f(o)&&(t.geometry.boundingSphere=ae.transform(o,n,o)),t.modelMatrix=N.clone(N.IDENTITY),t};function Bbe(t,n){let i=t.length,o={},r=t[0][n].attributes,s;for(s in r)if(r.hasOwnProperty(s)&&f(r[s])&&f(r[s].values)){let a=r[s],c=a.values.length,l=!0;for(let u=1;u<i;++u){let d=t[u][n].attributes[s];if(!f(d)||a.componentDatatype!==d.componentDatatype||a.componentsPerAttribute!==d.componentsPerAttribute||a.normalize!==d.normalize){l=!1;break}c+=d.values.length}l&&(o[s]=new we({componentDatatype:a.componentDatatype,componentsPerAttribute:a.componentsPerAttribute,normalize:a.normalize,values:J.createTypedArray(a.componentDatatype,c)}))}return o}var Obe=new m;function y8(t,n){let i=t.length,o,r,s,a,c=t[0].modelMatrix,l=f(t[0][n].indices),u=t[0][n].primitiveType,d=Bbe(t,n),h,_,y;for(o in d)if(d.hasOwnProperty(o))for(h=d[o].values,a=0,r=0;r<i;++r)for(_=t[r][n].attributes[o].values,y=_.length,s=0;s<y;++s)h[a++]=_[s];let p;if(l){let E=0;for(r=0;r<i;++r)E+=t[r][n].indices.length;let S=at.computeNumberOfVertices(new at({attributes:d,primitiveType:Re.POINTS})),w=Ne.createTypedArray(S,E),D=0,I=0;for(r=0;r<i;++r){let O=t[r][n].indices,M=O.length;for(a=0;a<M;++a)w[D++]=I+O[a];I+=at.computeNumberOfVertices(t[r][n])}p=w}let C=new m,x=0,T;for(r=0;r<i;++r){if(T=t[r][n].boundingSphere,!f(T)){C=void 0;break}m.add(T.center,C,C)}if(f(C))for(m.divideByScalar(C,i,C),r=0;r<i;++r){T=t[r][n].boundingSphere;let E=m.magnitude(m.subtract(T.center,C,Obe))+T.radius;E>x&&(x=E)}return new at({attributes:d,indices:p,primitiveType:u,boundingSphere:f(C)?new ae(C,x):void 0})}ic.combineInstances=function(t){let n=[],i=[],o=t.length;for(let s=0;s<o;++s){let a=t[s];f(a.geometry)?n.push(a):f(a.westHemisphereGeometry)&&f(a.eastHemisphereGeometry)&&i.push(a)}let r=[];return n.length>0&&r.push(y8(n,"geometry")),i.length>0&&(r.push(y8(i,"westHemisphereGeometry")),r.push(y8(i,"eastHemisphereGeometry"))),r};var lu=new m,Nb=new m,EC=new m,bC=new m;ic.computeNormal=function(t){let n=t.indices,i=t.attributes,o=i.position.values,r=i.position.values.length/3,s=n.length,a=new Array(r),c=new Array(s/3),l=new Array(s),u;for(u=0;u<r;u++)a[u]={indexOffset:0,count:0,currentCount:0};let d=0;for(u=0;u<s;u+=3){let p=n[u],C=n[u+1],x=n[u+2],T=p*3,E=C*3,S=x*3;Nb.x=o[T],Nb.y=o[T+1],Nb.z=o[T+2],EC.x=o[E],EC.y=o[E+1],EC.z=o[E+2],bC.x=o[S],bC.y=o[S+1],bC.z=o[S+2],a[p].count++,a[C].count++,a[x].count++,m.subtract(EC,Nb,EC),m.subtract(bC,Nb,bC),c[d]=m.cross(EC,bC,new m),d++}let h=0;for(u=0;u<r;u++)a[u].indexOffset+=h,h+=a[u].count;d=0;let _;for(u=0;u<s;u+=3){_=a[n[u]];let p=_.indexOffset+_.currentCount;l[p]=d,_.currentCount++,_=a[n[u+1]],p=_.indexOffset+_.currentCount,l[p]=d,_.currentCount++,_=a[n[u+2]],p=_.indexOffset+_.currentCount,l[p]=d,_.currentCount++,d++}let y=new Float32Array(r*3);for(u=0;u<r;u++){let p=u*3;if(_=a[u],m.clone(m.ZERO,lu),_.count>0){for(d=0;d<_.count;d++)m.add(lu,c[l[_.indexOffset+d]],lu);m.equalsEpsilon(m.ZERO,lu,B.EPSILON10)&&m.clone(c[l[_.indexOffset]],lu)}m.equalsEpsilon(m.ZERO,lu,B.EPSILON10)&&(lu.z=1),m.normalize(lu,lu),y[p]=lu.x,y[p+1]=lu.y,y[p+2]=lu.z}return t.attributes.normal=new we({componentDatatype:J.FLOAT,componentsPerAttribute:3,values:y}),t};var Rbe=new m,nJ=new m,Mbe=new m;ic.computeTangentAndBitangent=function(t){let n=t.attributes,i=t.indices,o=t.attributes.position.values,r=t.attributes.normal.values,s=t.attributes.st.values,a=t.attributes.position.values.length/3,c=i.length,l=new Array(a*3),u;for(u=0;u<l.length;u++)l[u]=0;let d,h,_;for(u=0;u<c;u+=3){let C=i[u],x=i[u+1],T=i[u+2];d=C*3,h=x*3,_=T*3;let E=C*2,S=x*2,w=T*2,D=o[d],I=o[d+1],O=o[d+2],M=s[E],L=s[E+1],F=s[S+1]-L,g=s[w+1]-L,b=1/((s[S]-M)*g-(s[w]-M)*F),v=(g*(o[h]-D)-F*(o[_]-D))*b,P=(g*(o[h+1]-I)-F*(o[_+1]-I))*b,R=(g*(o[h+2]-O)-F*(o[_+2]-O))*b;l[d]+=v,l[d+1]+=P,l[d+2]+=R,l[h]+=v,l[h+1]+=P,l[h+2]+=R,l[_]+=v,l[_+1]+=P,l[_+2]+=R}let y=new Float32Array(a*3),p=new Float32Array(a*3);for(u=0;u<a;u++){d=u*3,h=d+1,_=d+2;let C=m.fromArray(r,d,Rbe),x=m.fromArray(l,d,Mbe),T=m.dot(C,x);m.multiplyByScalar(C,T,nJ),m.normalize(m.subtract(x,nJ,x),x),y[d]=x.x,y[h]=x.y,y[_]=x.z,m.normalize(m.cross(C,x,x),x),p[d]=x.x,p[h]=x.y,p[_]=x.z}return t.attributes.tangent=new we({componentDatatype:J.FLOAT,componentsPerAttribute:3,values:y}),t.attributes.bitangent=new we({componentDatatype:J.FLOAT,componentsPerAttribute:3,values:p}),t};var Vb=new W,Ef=new m,iJ=new m,oJ=new m,q1=new W;ic.compressVertices=function(t){let n=t.attributes.extrudeDirection,i,o;if(f(n)){let I=n.values;o=I.length/3;let O=new Float32Array(o*2),M=0;for(i=0;i<o;++i){if(m.fromArray(I,i*3,Ef),m.equals(Ef,m.ZERO)){M+=2;continue}q1=zn.octEncodeInRange(Ef,65535,q1),O[M++]=q1.x,O[M++]=q1.y}return t.attributes.compressedAttributes=new we({componentDatatype:J.FLOAT,componentsPerAttribute:2,values:O}),delete t.attributes.extrudeDirection,t}let r=t.attributes.normal,s=t.attributes.st,a=f(r),c=f(s);if(!a&&!c)return t;let l=t.attributes.tangent,u=t.attributes.bitangent,d=f(l),h=f(u),_,y,p,C;a&&(_=r.values),c&&(y=s.values),d&&(p=l.values),h&&(C=u.values),o=(a?_.length:y.length)/(a?3:2);let E=o,S=c&&a?2:1;S+=d||h?1:0,E*=S;let w=new Float32Array(E),D=0;for(i=0;i<o;++i){c&&(W.fromArray(y,i*2,Vb),w[D++]=zn.compressTextureCoordinates(Vb));let I=i*3;a&&f(p)&&f(C)?(m.fromArray(_,I,Ef),m.fromArray(p,I,iJ),m.fromArray(C,I,oJ),zn.octPack(Ef,iJ,oJ,Vb),w[D++]=Vb.x,w[D++]=Vb.y):(a&&(m.fromArray(_,I,Ef),w[D++]=zn.octEncodeFloat(Ef)),d&&(m.fromArray(p,I,Ef),w[D++]=zn.octEncodeFloat(Ef)),h&&(m.fromArray(C,I,Ef),w[D++]=zn.octEncodeFloat(Ef)))}return t.attributes.compressedAttributes=new we({componentDatatype:J.FLOAT,componentsPerAttribute:S,values:w}),a&&delete t.attributes.normal,c&&delete t.attributes.st,h&&delete t.attributes.bitangent,d&&delete t.attributes.tangent,t};function Lbe(t){if(f(t.indices))return t;let n=at.computeNumberOfVertices(t),i=Ne.createTypedArray(n,n);for(let o=0;o<n;++o)i[o]=o;return t.indices=i,t}function Fbe(t){let n=at.computeNumberOfVertices(t),i=Ne.createTypedArray(n,(n-2)*3);i[0]=1,i[1]=0,i[2]=2;let o=3;for(let r=3;r<n;++r)i[o++]=r-1,i[o++]=0,i[o++]=r;return t.indices=i,t.primitiveType=Re.TRIANGLES,t}function Nbe(t){let n=at.computeNumberOfVertices(t),i=Ne.createTypedArray(n,(n-2)*3);i[0]=0,i[1]=1,i[2]=2,n>3&&(i[3]=0,i[4]=2,i[5]=3);let o=6;for(let r=3;r<n-1;r+=2)i[o++]=r,i[o++]=r-1,i[o++]=r+1,r+2<n&&(i[o++]=r,i[o++]=r+1,i[o++]=r+2);return t.indices=i,t.primitiveType=Re.TRIANGLES,t}function Vbe(t){if(f(t.indices))return t;let n=at.computeNumberOfVertices(t),i=Ne.createTypedArray(n,n);for(let o=0;o<n;++o)i[o]=o;return t.indices=i,t}function kbe(t){let n=at.computeNumberOfVertices(t),i=Ne.createTypedArray(n,(n-1)*2);i[0]=0,i[1]=1;let o=2;for(let r=2;r<n;++r)i[o++]=r-1,i[o++]=r;return t.indices=i,t.primitiveType=Re.LINES,t}function Ube(t){let n=at.computeNumberOfVertices(t),i=Ne.createTypedArray(n,n*2);i[0]=0,i[1]=1;let o=2;for(let r=2;r<n;++r)i[o++]=r-1,i[o++]=r;return i[o++]=n-1,i[o]=0,t.indices=i,t.primitiveType=Re.LINES,t}function zbe(t){switch(t.primitiveType){case Re.TRIANGLE_FAN:return Fbe(t);case Re.TRIANGLE_STRIP:return Nbe(t);case Re.TRIANGLES:return Lbe(t);case Re.LINE_STRIP:return kbe(t);case Re.LINE_LOOP:return Ube(t);case Re.LINES:return Vbe(t)}return t}function Gp(t,n){Math.abs(t.y)<B.EPSILON6&&(n?t.y=-B.EPSILON6:t.y=B.EPSILON6)}function Hbe(t,n,i){if(t.y!==0&&n.y!==0&&i.y!==0){Gp(t,t.y<0),Gp(n,n.y<0),Gp(i,i.y<0);return}let o=Math.abs(t.y),r=Math.abs(n.y),s=Math.abs(i.y),a;o>r?o>s?a=B.sign(t.y):a=B.sign(i.y):r>s?a=B.sign(n.y):a=B.sign(i.y);let c=a<0;Gp(t,c),Gp(n,c),Gp(i,c)}var rJ=new m;function uu(t,n,i,o){m.add(t,m.multiplyByScalar(m.subtract(n,t,rJ),t.y/(t.y-n.y),rJ),i),m.clone(i,o),Gp(i,!0),Gp(o,!1)}var T0=new m,E0=new m,b0=new m,S0=new m,A8={positions:new Array(7),indices:new Array(3*3)};function Gbe(t,n,i){if(t.x>=0||n.x>=0||i.x>=0)return;Hbe(t,n,i);let o=t.y<0,r=n.y<0,s=i.y<0,a=0;a+=o?1:0,a+=r?1:0,a+=s?1:0;let c=A8.indices;a===1?(c[1]=3,c[2]=4,c[5]=6,c[7]=6,c[8]=5,o?(uu(t,n,T0,b0),uu(t,i,E0,S0),c[0]=0,c[3]=1,c[4]=2,c[6]=1):r?(uu(n,i,T0,b0),uu(n,t,E0,S0),c[0]=1,c[3]=2,c[4]=0,c[6]=2):s&&(uu(i,t,T0,b0),uu(i,n,E0,S0),c[0]=2,c[3]=0,c[4]=1,c[6]=0)):a===2&&(c[2]=4,c[4]=4,c[5]=3,c[7]=5,c[8]=6,o?r?s||(uu(i,t,T0,b0),uu(i,n,E0,S0),c[0]=0,c[1]=1,c[3]=0,c[6]=2):(uu(n,i,T0,b0),uu(n,t,E0,S0),c[0]=2,c[1]=0,c[3]=2,c[6]=1):(uu(t,n,T0,b0),uu(t,i,E0,S0),c[0]=1,c[1]=2,c[3]=1,c[6]=0));let l=A8.positions;return l[0]=t,l[1]=n,l[2]=i,l.length=3,(a===1||a===2)&&(l[3]=T0,l[4]=E0,l[5]=b0,l[6]=S0,l.length=7),A8}function sJ(t,n){let i=t.attributes;if(i.position.values.length===0)return;for(let r in i)if(i.hasOwnProperty(r)&&f(i[r])&&f(i[r].values)){let s=i[r];s.values=J.createTypedArray(s.componentDatatype,s.values)}let o=at.computeNumberOfVertices(t);return t.indices=Ne.createTypedArray(o,t.indices),n&&(t.boundingSphere=ae.fromVertices(i.position.values)),t}function wC(t){let n=t.attributes,i={};for(let o in n)if(n.hasOwnProperty(o)&&f(n[o])&&f(n[o].values)){let r=n[o];i[o]=new we({componentDatatype:r.componentDatatype,componentsPerAttribute:r.componentsPerAttribute,normalize:r.normalize,values:[]})}return new at({attributes:i,indices:[],primitiveType:t.primitiveType})}function E8(t,n,i){let o=f(t.geometry.boundingSphere);n=sJ(n,o),i=sJ(i,o),f(i)&&!f(n)?t.geometry=i:!f(i)&&f(n)?t.geometry=n:(t.westHemisphereGeometry=n,t.eastHemisphereGeometry=i,t.geometry=void 0)}function b8(t,n){let i=new t,o=new t,r=new t;return function(s,a,c,l,u,d,h,_){let y=t.fromArray(u,s*n,i),p=t.fromArray(u,a*n,o),C=t.fromArray(u,c*n,r);t.multiplyByScalar(y,l.x,y),t.multiplyByScalar(p,l.y,p),t.multiplyByScalar(C,l.z,C);let x=t.add(y,p,y);t.add(x,C,x),_&&t.normalize(x,x),t.pack(x,d,h*n)}}var Wbe=b8(se,4),K1=b8(m,3),dJ=b8(W,2),jbe=function(t,n,i,o,r,s,a){let c=r[t]*o.x,l=r[n]*o.y,u=r[i]*o.z;s[a]=c+l+u>B.EPSILON6?1:0},kb=new m,C8=new m,x8=new m,qbe=new m;function Y1(t,n,i,o,r,s,a,c,l,u,d,h,_,y,p,C){if(!f(s)&&!f(a)&&!f(c)&&!f(l)&&!f(u)&&y===0)return;let x=m.fromArray(r,t*3,kb),T=m.fromArray(r,n*3,C8),E=m.fromArray(r,i*3,x8),S=TC(o,x,T,E,qbe);if(!!f(S)){if(f(s)&&K1(t,n,i,S,s,h.normal.values,C,!0),f(u)){let w=m.fromArray(u,t*3,kb),D=m.fromArray(u,n*3,C8),I=m.fromArray(u,i*3,x8);m.multiplyByScalar(w,S.x,w),m.multiplyByScalar(D,S.y,D),m.multiplyByScalar(I,S.z,I);let O;!m.equals(w,m.ZERO)||!m.equals(D,m.ZERO)||!m.equals(I,m.ZERO)?(O=m.add(w,D,w),m.add(O,I,O),m.normalize(O,O)):(O=kb,O.x=0,O.y=0,O.z=0),m.pack(O,h.extrudeDirection.values,C*3)}if(f(d)&&jbe(t,n,i,S,d,h.applyOffset.values,C),f(a)&&K1(t,n,i,S,a,h.tangent.values,C,!0),f(c)&&K1(t,n,i,S,c,h.bitangent.values,C,!0),f(l)&&dJ(t,n,i,S,l,h.st.values,C),y>0)for(let w=0;w<y;w++){let D=_[w];Ybe(t,n,i,S,C,p[D],h[D])}}}function Ybe(t,n,i,o,r,s,a){let c=s.componentsPerAttribute,l=s.values,u=a.values;switch(c){case 4:Wbe(t,n,i,o,l,u,r,!1);break;case 3:K1(t,n,i,o,l,u,r,!1);break;case 2:dJ(t,n,i,o,l,u,r,!1);break;default:u[r]=l[t]*o.x+l[n]*o.y+l[i]*o.z}}function kd(t,n,i,o,r,s){let a=t.position.values.length/3;if(r!==-1){let c=o[r],l=i[c];return l===-1?(i[c]=a,t.position.values.push(s.x,s.y,s.z),n.push(a),a):(n.push(l),l)}return t.position.values.push(s.x,s.y,s.z),n.push(a),a}var Xbe={position:!0,normal:!0,bitangent:!0,tangent:!0,st:!0,extrudeDirection:!0,applyOffset:!0};function aJ(t){let n=t.geometry,i=n.attributes,o=i.position.values,r=f(i.normal)?i.normal.values:void 0,s=f(i.bitangent)?i.bitangent.values:void 0,a=f(i.tangent)?i.tangent.values:void 0,c=f(i.st)?i.st.values:void 0,l=f(i.extrudeDirection)?i.extrudeDirection.values:void 0,u=f(i.applyOffset)?i.applyOffset.values:void 0,d=n.indices,h=[];for(let O in i)i.hasOwnProperty(O)&&!Xbe[O]&&f(i[O])&&h.push(O);let _=h.length,y=wC(n),p=wC(n),C,x,T,E,S,w=[];w.length=o.length/3;let D=[];for(D.length=o.length/3,S=0;S<w.length;++S)w[S]=-1,D[S]=-1;let I=d.length;for(S=0;S<I;S+=3){let O=d[S],M=d[S+1],L=d[S+2],F=m.fromArray(o,O*3),g=m.fromArray(o,M*3),b=m.fromArray(o,L*3),v=Gbe(F,g,b);if(f(v)&&v.positions.length>3){let P=v.positions,R=v.indices,V=R.length;for(let H=0;H<V;++H){let U=R[H],G=P[U];G.y<0?(C=p.attributes,x=p.indices,T=w):(C=y.attributes,x=y.indices,T=D),E=kd(C,x,T,d,U<3?S+U:-1,G),Y1(O,M,L,G,o,r,a,s,c,l,u,C,h,_,i,E)}}else f(v)&&(F=v.positions[0],g=v.positions[1],b=v.positions[2]),F.y<0?(C=p.attributes,x=p.indices,T=w):(C=y.attributes,x=y.indices,T=D),E=kd(C,x,T,d,S,F),Y1(O,M,L,F,o,r,a,s,c,l,u,C,h,_,i,E),E=kd(C,x,T,d,S+1,g),Y1(O,M,L,g,o,r,a,s,c,l,u,C,h,_,i,E),E=kd(C,x,T,d,S+2,b),Y1(O,M,L,b,o,r,a,s,c,l,u,C,h,_,i,E)}E8(t,p,y)}var hJ=rn.fromPointNormal(m.ZERO,m.UNIT_Y),Kbe=new m,Jbe=new m;function SC(t,n,i,o,r,s,a){if(!f(a))return;let c=m.fromArray(o,t*3,kb);m.equalsEpsilon(c,i,B.EPSILON10)?s.applyOffset.values[r]=a[t]:s.applyOffset.values[r]=a[n]}function cJ(t){let n=t.geometry,i=n.attributes,o=i.position.values,r=f(i.applyOffset)?i.applyOffset.values:void 0,s=n.indices,a=wC(n),c=wC(n),l,u=s.length,d=[];d.length=o.length/3;let h=[];for(h.length=o.length/3,l=0;l<d.length;++l)d[l]=-1,h[l]=-1;for(l=0;l<u;l+=2){let _=s[l],y=s[l+1],p=m.fromArray(o,_*3,kb),C=m.fromArray(o,y*3,C8),x;Math.abs(p.y)<B.EPSILON6&&(p.y<0?p.y=-B.EPSILON6:p.y=B.EPSILON6),Math.abs(C.y)<B.EPSILON6&&(C.y<0?C.y=-B.EPSILON6:C.y=B.EPSILON6);let T=a.attributes,E=a.indices,S=h,w=c.attributes,D=c.indices,I=d,O=ji.lineSegmentPlane(p,C,hJ,x8);if(f(O)){let M=m.multiplyByScalar(m.UNIT_Y,5*B.EPSILON9,Kbe);p.y<0&&(m.negate(M,M),T=c.attributes,E=c.indices,S=d,w=a.attributes,D=a.indices,I=h);let L=m.add(O,M,Jbe);x=kd(T,E,S,s,l,p),SC(_,y,p,o,x,T,r),x=kd(T,E,S,s,-1,L),SC(_,y,L,o,x,T,r),m.negate(M,M),m.add(O,M,L),x=kd(w,D,I,s,-1,L),SC(_,y,L,o,x,w,r),x=kd(w,D,I,s,l+1,C),SC(_,y,C,o,x,w,r)}else{let M,L,F;p.y<0?(M=c.attributes,L=c.indices,F=d):(M=a.attributes,L=a.indices,F=h),x=kd(M,L,F,s,l,p),SC(_,y,p,o,x,M,r),x=kd(M,L,F,s,l+1,C),SC(_,y,C,o,x,M,r)}}E8(t,c,a)}var lJ=new W,Zbe=new W,mJ=new m,pJ=new m,T8=new m,Qbe=new m,$be=new m,eSe=new m,uJ=new se;function fJ(t){let n=t.attributes,i=n.position.values,o=n.prevPosition.values,r=n.nextPosition.values,s=i.length;for(let a=0;a<s;a+=3){let c=m.unpack(i,a,mJ);if(c.x>0)continue;let l=m.unpack(o,a,pJ);(c.y<0&&l.y>0||c.y>0&&l.y<0)&&(a-3>0?(o[a]=i[a-3],o[a+1]=i[a-2],o[a+2]=i[a-1]):m.pack(c,o,a));let u=m.unpack(r,a,T8);(c.y<0&&u.y>0||c.y>0&&u.y<0)&&(a+3<s?(r[a]=i[a+3],r[a+1]=i[a+4],r[a+2]=i[a+5]):m.pack(c,r,a))}}var tSe=5*B.EPSILON9,X1=B.EPSILON6;function nSe(t){let n=t.geometry,i=n.attributes,o=i.position.values,r=i.prevPosition.values,s=i.nextPosition.values,a=i.expandAndWidth.values,c=f(i.st)?i.st.values:void 0,l=f(i.color)?i.color.values:void 0,u=wC(n),d=wC(n),h,_,y,p=!1,C=o.length/3;for(h=0;h<C;h+=4){let x=h,T=h+2,E=m.fromArray(o,x*3,mJ),S=m.fromArray(o,T*3,pJ);if(Math.abs(E.y)<X1)for(E.y=X1*(S.y<0?-1:1),o[h*3+1]=E.y,o[(h+1)*3+1]=E.y,_=x*3;_<x*3+4*3;_+=3)r[_]=o[h*3],r[_+1]=o[h*3+1],r[_+2]=o[h*3+2];if(Math.abs(S.y)<X1)for(S.y=X1*(E.y<0?-1:1),o[(h+2)*3+1]=S.y,o[(h+3)*3+1]=S.y,_=x*3;_<x*3+4*3;_+=3)s[_]=o[(h+2)*3],s[_+1]=o[(h+2)*3+1],s[_+2]=o[(h+2)*3+2];let w=u.attributes,D=u.indices,I=d.attributes,O=d.indices,M=ji.lineSegmentPlane(E,S,hJ,Qbe);if(f(M)){p=!0;let L=m.multiplyByScalar(m.UNIT_Y,tSe,$be);E.y<0&&(m.negate(L,L),w=d.attributes,D=d.indices,I=u.attributes,O=u.indices);let F=m.add(M,L,eSe);w.position.values.push(E.x,E.y,E.z,E.x,E.y,E.z),w.position.values.push(F.x,F.y,F.z),w.position.values.push(F.x,F.y,F.z),w.prevPosition.values.push(r[x*3],r[x*3+1],r[x*3+2]),w.prevPosition.values.push(r[x*3+3],r[x*3+4],r[x*3+5]),w.prevPosition.values.push(E.x,E.y,E.z,E.x,E.y,E.z),w.nextPosition.values.push(F.x,F.y,F.z),w.nextPosition.values.push(F.x,F.y,F.z),w.nextPosition.values.push(F.x,F.y,F.z),w.nextPosition.values.push(F.x,F.y,F.z),m.negate(L,L),m.add(M,L,F),I.position.values.push(F.x,F.y,F.z),I.position.values.push(F.x,F.y,F.z),I.position.values.push(S.x,S.y,S.z,S.x,S.y,S.z),I.prevPosition.values.push(F.x,F.y,F.z),I.prevPosition.values.push(F.x,F.y,F.z),I.prevPosition.values.push(F.x,F.y,F.z),I.prevPosition.values.push(F.x,F.y,F.z),I.nextPosition.values.push(S.x,S.y,S.z,S.x,S.y,S.z),I.nextPosition.values.push(s[T*3],s[T*3+1],s[T*3+2]),I.nextPosition.values.push(s[T*3+3],s[T*3+4],s[T*3+5]);let g=W.fromArray(a,x*2,lJ),b=Math.abs(g.y);w.expandAndWidth.values.push(-1,b,1,b),w.expandAndWidth.values.push(-1,-b,1,-b),I.expandAndWidth.values.push(-1,b,1,b),I.expandAndWidth.values.push(-1,-b,1,-b);let v=m.magnitudeSquared(m.subtract(M,E,T8));if(v/=m.magnitudeSquared(m.subtract(S,E,T8)),f(l)){let P=se.fromArray(l,x*4,uJ),R=se.fromArray(l,T*4,uJ),V=B.lerp(P.x,R.x,v),H=B.lerp(P.y,R.y,v),U=B.lerp(P.z,R.z,v),G=B.lerp(P.w,R.w,v);for(_=x*4;_<x*4+2*4;++_)w.color.values.push(l[_]);for(w.color.values.push(V,H,U,G),w.color.values.push(V,H,U,G),I.color.values.push(V,H,U,G),I.color.values.push(V,H,U,G),_=T*4;_<T*4+2*4;++_)I.color.values.push(l[_])}if(f(c)){let P=W.fromArray(c,x*2,lJ),R=W.fromArray(c,(h+3)*2,Zbe),V=B.lerp(P.x,R.x,v);for(_=x*2;_<x*2+2*2;++_)w.st.values.push(c[_]);for(w.st.values.push(V,P.y),w.st.values.push(V,R.y),I.st.values.push(V,P.y),I.st.values.push(V,R.y),_=T*2;_<T*2+2*2;++_)I.st.values.push(c[_])}y=w.position.values.length/3-4,D.push(y,y+2,y+1),D.push(y+1,y+2,y+3),y=I.position.values.length/3-4,O.push(y,y+2,y+1),O.push(y+1,y+2,y+3)}else{let L,F;for(E.y<0?(L=d.attributes,F=d.indices):(L=u.attributes,F=u.indices),L.position.values.push(E.x,E.y,E.z),L.position.values.push(E.x,E.y,E.z),L.position.values.push(S.x,S.y,S.z),L.position.values.push(S.x,S.y,S.z),_=h*3;_<h*3+4*3;++_)L.prevPosition.values.push(r[_]),L.nextPosition.values.push(s[_]);for(_=h*2;_<h*2+4*2;++_)L.expandAndWidth.values.push(a[_]),f(c)&&L.st.values.push(c[_]);if(f(l))for(_=h*4;_<h*4+4*4;++_)L.color.values.push(l[_]);y=L.position.values.length/3-4,F.push(y,y+2,y+1),F.push(y+1,y+2,y+3)}}p&&(fJ(d),fJ(u)),E8(t,d,u)}ic.splitLongitude=function(t){let n=t.geometry,i=n.boundingSphere;if(f(i)&&(i.center.x-i.radius>0||ae.intersectPlane(i,rn.ORIGIN_ZX_PLANE)!==jt.INTERSECTING))return t;if(n.geometryType!==yf.NONE)switch(n.geometryType){case yf.POLYLINES:nSe(t);break;case yf.TRIANGLES:aJ(t);break;case yf.LINES:cJ(t);break}else zbe(n),n.primitiveType===Re.TRIANGLES?aJ(t):n.primitiveType===Re.LINES&&cJ(t);return t};var Fn=ic;var Z1={STREAM_DRAW:ee.STREAM_DRAW,STATIC_DRAW:ee.STATIC_DRAW,DYNAMIC_DRAW:ee.DYNAMIC_DRAW,validate:function(t){return t===Z1.STREAM_DRAW||t===Z1.STATIC_DRAW||t===Z1.DYNAMIC_DRAW}},Fe=Object.freeze(Z1);function iSe(t,n,i){let o={flipY:!0,skipColorSpaceConversion:i,preferImageBitmap:!0},r=[Ie.createIfNeeded(n.positiveX).fetchImage(o),Ie.createIfNeeded(n.negativeX).fetchImage(o),Ie.createIfNeeded(n.positiveY).fetchImage(o),Ie.createIfNeeded(n.negativeY).fetchImage(o),Ie.createIfNeeded(n.positiveZ).fetchImage(o),Ie.createIfNeeded(n.negativeZ).fetchImage(o)];return Promise.all(r).then(function(s){return new tc({context:t,source:{positiveX:s[0],negativeX:s[1],positiveY:s[2],negativeY:s[3],positiveZ:s[4],negativeZ:s[5]}})})}var Q1=iSe;var $1={CLOCKWISE:ee.CW,COUNTER_CLOCKWISE:ee.CCW};$1.validate=function(t){return t===$1.CLOCKWISE||t===$1.COUNTER_CLOCKWISE};var $r=Object.freeze($1);function _J(t){if(typeof t!="object"||t===null)return t;let n,i=Object.keys(t);for(let o=0;o<i.length;o++)n=i[o],t.hasOwnProperty(n)&&n!=="_applyFunctions"&&(t[n]=_J(t[n]));return Object.freeze(t)}var gJ=_J;function zd(t){let n=A(t,A.EMPTY_OBJECT),i=A(n.cull,A.EMPTY_OBJECT),o=A(n.polygonOffset,A.EMPTY_OBJECT),r=A(n.scissorTest,A.EMPTY_OBJECT),s=A(r.rectangle,A.EMPTY_OBJECT),a=A(n.depthRange,A.EMPTY_OBJECT),c=A(n.depthTest,A.EMPTY_OBJECT),l=A(n.colorMask,A.EMPTY_OBJECT),u=A(n.blending,A.EMPTY_OBJECT),d=A(u.color,A.EMPTY_OBJECT),h=A(n.stencilTest,A.EMPTY_OBJECT),_=A(h.frontOperation,A.EMPTY_OBJECT),y=A(h.backOperation,A.EMPTY_OBJECT),p=A(n.sampleCoverage,A.EMPTY_OBJECT),C=n.viewport;this.frontFace=A(n.frontFace,$r.COUNTER_CLOCKWISE),this.cull={enabled:A(i.enabled,!1),face:A(i.face,ee.BACK)},this.lineWidth=A(n.lineWidth,1),this.polygonOffset={enabled:A(o.enabled,!1),factor:A(o.factor,0),units:A(o.units,0)},this.scissorTest={enabled:A(r.enabled,!1),rectangle:He.clone(s)},this.depthRange={near:A(a.near,0),far:A(a.far,1)},this.depthTest={enabled:A(c.enabled,!1),func:A(c.func,ee.LESS)},this.colorMask={red:A(l.red,!0),green:A(l.green,!0),blue:A(l.blue,!0),alpha:A(l.alpha,!0)},this.depthMask=A(n.depthMask,!0),this.stencilMask=A(n.stencilMask,-1),this.blending={enabled:A(u.enabled,!1),color:new z(A(d.red,0),A(d.green,0),A(d.blue,0),A(d.alpha,0)),equationRgb:A(u.equationRgb,ee.FUNC_ADD),equationAlpha:A(u.equationAlpha,ee.FUNC_ADD),functionSourceRgb:A(u.functionSourceRgb,ee.ONE),functionSourceAlpha:A(u.functionSourceAlpha,ee.ONE),functionDestinationRgb:A(u.functionDestinationRgb,ee.ZERO),functionDestinationAlpha:A(u.functionDestinationAlpha,ee.ZERO)},this.stencilTest={enabled:A(h.enabled,!1),frontFunction:A(h.frontFunction,ee.ALWAYS),backFunction:A(h.backFunction,ee.ALWAYS),reference:A(h.reference,0),mask:A(h.mask,-1),frontOperation:{fail:A(_.fail,ee.KEEP),zFail:A(_.zFail,ee.KEEP),zPass:A(_.zPass,ee.KEEP)},backOperation:{fail:A(y.fail,ee.KEEP),zFail:A(y.zFail,ee.KEEP),zPass:A(y.zPass,ee.KEEP)}},this.sampleCoverage={enabled:A(p.enabled,!1),value:A(p.value,1),invert:A(p.invert,!1)},this.viewport=f(C)?new He(C.x,C.y,C.width,C.height):void 0,this.id=0,this._applyFunctions=[]}var oSe=0,Ud={};zd.fromCache=function(t){let n=JSON.stringify(t),i=Ud[n];if(f(i))return++i.referenceCount,i.state;let o=new zd(t),r=JSON.stringify(o);return i=Ud[r],f(i)||(o.id=oSe++,i={referenceCount:0,state:o},Ud[r]=i),++i.referenceCount,Ud[n]={referenceCount:1,state:i.state},i.state};zd.removeFromCache=function(t){let n=new zd(t),i=JSON.stringify(n),o=Ud[i],r=JSON.stringify(t),s=Ud[r];f(s)&&(--s.referenceCount,s.referenceCount===0&&(delete Ud[r],f(o)&&--o.referenceCount)),f(o)&&o.referenceCount===0&&delete Ud[i]};zd.getCache=function(){return Ud};zd.clearCache=function(){Ud={}};function w0(t,n,i){i?t.enable(n):t.disable(n)}function yJ(t,n){t.frontFace(n.frontFace)}function AJ(t,n){let i=n.cull,o=i.enabled;w0(t,t.CULL_FACE,o),o&&t.cullFace(i.face)}function CJ(t,n){t.lineWidth(n.lineWidth)}function xJ(t,n){let i=n.polygonOffset,o=i.enabled;w0(t,t.POLYGON_OFFSET_FILL,o),o&&t.polygonOffset(i.factor,i.units)}function TJ(t,n,i){let o=n.scissorTest,r=f(i.scissorTest)?i.scissorTest.enabled:o.enabled;if(w0(t,t.SCISSOR_TEST,r),r){let s=f(i.scissorTest)?i.scissorTest.rectangle:o.rectangle;t.scissor(s.x,s.y,s.width,s.height)}}function EJ(t,n){let i=n.depthRange;t.depthRange(i.near,i.far)}function bJ(t,n){let i=n.depthTest,o=i.enabled;w0(t,t.DEPTH_TEST,o),o&&t.depthFunc(i.func)}function SJ(t,n){let i=n.colorMask;t.colorMask(i.red,i.green,i.blue,i.alpha)}function wJ(t,n){t.depthMask(n.depthMask)}function DJ(t,n){t.stencilMask(n.stencilMask)}function rSe(t,n){t.blendColor(n.red,n.green,n.blue,n.alpha)}function vJ(t,n,i){let o=n.blending,r=f(i.blendingEnabled)?i.blendingEnabled:o.enabled;w0(t,t.BLEND,r),r&&(rSe(t,o.color),t.blendEquationSeparate(o.equationRgb,o.equationAlpha),t.blendFuncSeparate(o.functionSourceRgb,o.functionDestinationRgb,o.functionSourceAlpha,o.functionDestinationAlpha))}function PJ(t,n){let i=n.stencilTest,o=i.enabled;if(w0(t,t.STENCIL_TEST,o),o){let r=i.frontFunction,s=i.backFunction,a=i.reference,c=i.mask;t.stencilFunc(r,a,c),t.stencilFuncSeparate(t.BACK,s,a,c),t.stencilFuncSeparate(t.FRONT,r,a,c);let l=i.frontOperation,u=l.fail,d=l.zFail,h=l.zPass;t.stencilOpSeparate(t.FRONT,u,d,h);let _=i.backOperation,y=_.fail,p=_.zFail,C=_.zPass;t.stencilOpSeparate(t.BACK,y,p,C)}}function IJ(t,n){let i=n.sampleCoverage,o=i.enabled;w0(t,t.SAMPLE_COVERAGE,o),o&&t.sampleCoverage(i.value,i.invert)}var sSe=new He;function BJ(t,n,i){let o=A(n.viewport,i.viewport);f(o)||(o=sSe,o.width=i.context.drawingBufferWidth,o.height=i.context.drawingBufferHeight),i.context.uniformState.viewport=o,t.viewport(o.x,o.y,o.width,o.height)}zd.apply=function(t,n,i){yJ(t,n),AJ(t,n),CJ(t,n),xJ(t,n),EJ(t,n),bJ(t,n),SJ(t,n),wJ(t,n),DJ(t,n),PJ(t,n),IJ(t,n),TJ(t,n,i),vJ(t,n,i),BJ(t,n,i)};function aSe(t,n){let i=[];return t.frontFace!==n.frontFace&&i.push(yJ),(t.cull.enabled!==n.cull.enabled||t.cull.face!==n.cull.face)&&i.push(AJ),t.lineWidth!==n.lineWidth&&i.push(CJ),(t.polygonOffset.enabled!==n.polygonOffset.enabled||t.polygonOffset.factor!==n.polygonOffset.factor||t.polygonOffset.units!==n.polygonOffset.units)&&i.push(xJ),(t.depthRange.near!==n.depthRange.near||t.depthRange.far!==n.depthRange.far)&&i.push(EJ),(t.depthTest.enabled!==n.depthTest.enabled||t.depthTest.func!==n.depthTest.func)&&i.push(bJ),(t.colorMask.red!==n.colorMask.red||t.colorMask.green!==n.colorMask.green||t.colorMask.blue!==n.colorMask.blue||t.colorMask.alpha!==n.colorMask.alpha)&&i.push(SJ),t.depthMask!==n.depthMask&&i.push(wJ),t.stencilMask!==n.stencilMask&&i.push(DJ),(t.stencilTest.enabled!==n.stencilTest.enabled||t.stencilTest.frontFunction!==n.stencilTest.frontFunction||t.stencilTest.backFunction!==n.stencilTest.backFunction||t.stencilTest.reference!==n.stencilTest.reference||t.stencilTest.mask!==n.stencilTest.mask||t.stencilTest.frontOperation.fail!==n.stencilTest.frontOperation.fail||t.stencilTest.frontOperation.zFail!==n.stencilTest.frontOperation.zFail||t.stencilTest.backOperation.fail!==n.stencilTest.backOperation.fail||t.stencilTest.backOperation.zFail!==n.stencilTest.backOperation.zFail||t.stencilTest.backOperation.zPass!==n.stencilTest.backOperation.zPass)&&i.push(PJ),(t.sampleCoverage.enabled!==n.sampleCoverage.enabled||t.sampleCoverage.value!==n.sampleCoverage.value||t.sampleCoverage.invert!==n.sampleCoverage.invert)&&i.push(IJ),i}zd.partialApply=function(t,n,i,o,r,s){if(n!==i){let d=i._applyFunctions[n.id];f(d)||(d=aSe(n,i),i._applyFunctions[n.id]=d);let h=d.length;for(let _=0;_<h;++_)d[_](t,i)}let a=f(o.scissorTest)?o.scissorTest:n.scissorTest,c=f(r.scissorTest)?r.scissorTest:i.scissorTest;(a!==c||s)&&TJ(t,i,r);let l=f(o.blendingEnabled)?o.blendingEnabled:n.blending.enabled,u=f(r.blendingEnabled)?r.blendingEnabled:i.blending.enabled;(l!==u||u&&n.blending!==i.blending)&&vJ(t,i,r),(n!==i||o!==r||o.context!==r.context)&&BJ(t,i,r)};zd.getState=function(t){return{frontFace:t.frontFace,cull:{enabled:t.cull.enabled,face:t.cull.face},lineWidth:t.lineWidth,polygonOffset:{enabled:t.polygonOffset.enabled,factor:t.polygonOffset.factor,units:t.polygonOffset.units},scissorTest:{enabled:t.scissorTest.enabled,rectangle:He.clone(t.scissorTest.rectangle)},depthRange:{near:t.depthRange.near,far:t.depthRange.far},depthTest:{enabled:t.depthTest.enabled,func:t.depthTest.func},colorMask:{red:t.colorMask.red,green:t.colorMask.green,blue:t.colorMask.blue,alpha:t.colorMask.alpha},depthMask:t.depthMask,stencilMask:t.stencilMask,blending:{enabled:t.blending.enabled,color:z.clone(t.blending.color),equationRgb:t.blending.equationRgb,equationAlpha:t.blending.equationAlpha,functionSourceRgb:t.blending.functionSourceRgb,functionSourceAlpha:t.blending.functionSourceAlpha,functionDestinationRgb:t.blending.functionDestinationRgb,functionDestinationAlpha:t.blending.functionDestinationAlpha},stencilTest:{enabled:t.stencilTest.enabled,frontFunction:t.stencilTest.frontFunction,backFunction:t.stencilTest.backFunction,reference:t.stencilTest.reference,mask:t.stencilTest.mask,frontOperation:{fail:t.stencilTest.frontOperation.fail,zFail:t.stencilTest.frontOperation.zFail,zPass:t.stencilTest.frontOperation.zPass},backOperation:{fail:t.stencilTest.backOperation.fail,zFail:t.stencilTest.backOperation.zFail,zPass:t.stencilTest.backOperation.zPass}},sampleCoverage:{enabled:t.sampleCoverage.enabled,value:t.sampleCoverage.value,invert:t.sampleCoverage.invert},viewport:f(t.viewport)?He.clone(t.viewport):void 0}};var Ve=zd;function cSe(t,n){let i=/#define OUTPUT_DECLARATION/,o=t.split(`
`);if(/#version 300 es/g.test(t))return t;let r=-1,s,a;for(s=0;s<o.length;++s)if(a=o[s],i.test(a)){r=s;break}if(r===-1)throw new Ce("Could not find a #define OUTPUT_DECLARATION!");let c=[];for(s=0;s<10;s++){let C=`gl_FragData\\[${s}\\]`,x=`czm_out${s}`;new RegExp(C,"g").test(t)&&(OJ(x,c),Hd(C,x,o),o.splice(r,0,`layout(location = ${s}) out vec4 ${x};`),r+=1)}let l="czm_fragColor";uSe("gl_FragColor",o)&&(OJ(l,c),Hd("gl_FragColor",l,o),o.splice(r,0,"layout(location = 0) out vec4 czm_fragColor;"),r+=1);let u=dSe(c,o),d={};for(s=0;s<o.length;s++){a=o[s];for(let C in u)u.hasOwnProperty(C)&&new RegExp(`(layout)[^]+(out)[^]+(${C})[^]+`,"g").test(a)&&(d[a]=C)}for(let C in d)if(d.hasOwnProperty(C)){let x=d[C],T=o.indexOf(C),E=u[x],S=E.length;for(let w=0;w<S;w++)o.splice(T,0,E[w]);T+=S+1;for(let w=S-1;w>=0;w--)o.splice(T,0,`#endif //${E[w]}`)}let h="WEBGL_2",_=`#define ${h}`,y="#version 300 es",p=!1;for(s=0;s<o.length;s++)if(/#version/.test(o[s])){o[s]=y,p=!0;break}return p||o.splice(0,0,y),o.splice(1,0,_),S8("EXT_draw_buffers",h,o),S8("EXT_frag_depth",h,o),S8("OES_standard_derivatives",h,o),Hd("texture2D","texture",o),Hd("texture3D","texture",o),Hd("textureCube","texture",o),Hd("gl_FragDepthEXT","gl_FragDepth",o),n?Hd("varying","in",o):(Hd("attribute","in",o),Hd("varying","out",o)),fSe(o)}function Hd(t,n,i){let o=`(^|[^\\w])(${t})($|[^\\w])`,r=new RegExp(o,"g"),s=i.length;for(let a=0;a<s;++a){let c=i[a];i[a]=c.replace(r,`$1${n}$3`)}}function lSe(t,n,i){let o=i.length;for(let r=0;r<o;++r){let s=i[r];i[r]=s.replace(t,n)}}function uSe(t,n){let i=`(^|[^\\w])(${t})($|[^\\w])`,o=new RegExp(i,"g"),r=n.length;for(let s=0;s<r;++s){let a=n[s];if(o.test(a))return!0}return!1}function fSe(t){let n="",i=t.length;for(let o=0;o<i;++o)n+=`${t[o]}
`;return n}function OJ(t,n){n.indexOf(t)===-1&&n.push(t)}function dSe(t,n){let i={},o=t.length,r=[];for(let s=0;s<n.length;++s){let a=n[s],c=/(#ifdef|#if)/g.test(a),l=/#else/g.test(a),u=/#endif/g.test(a);if(c)r.push(a);else if(l){let h=r[r.length-1].replace("ifdef","ifndef");/if/g.test(h)&&(h=h.replace(/(#if\s+)(\S*)([^]*)/,"$1!($2)$3")),r.pop(),r.push(h)}else if(u)r.pop();else if(!/layout/g.test(a))for(let d=0;d<o;++d){let h=t[d];a.indexOf(h)!==-1&&(f(i[h])?i[h]=i[h].filter(function(_){return r.indexOf(_)>=0}):i[h]=r.slice())}}return i}function S8(t,n,i){let o=`#extension\\s+GL_${t}\\s+:\\s+[a-zA-Z0-9]+\\s*$`;lSe(new RegExp(o,"g"),"",i),Hd(`GL_${t}`,n,i)}var eI=cSe;var tI=`const float czm_degreesPerRadian = 57.29577951308232;
`;var nI=`const czm_depthRangeStruct czm_depthRange = czm_depthRangeStruct(0.0, 1.0);
`;var iI=`const float czm_epsilon1 = 0.1;
`;var oI=`const float czm_epsilon2 = 0.01;
`;var rI=`const float czm_epsilon3 = 0.001;
`;var sI=`const float czm_epsilon4 = 0.0001;
`;var aI=`const float czm_epsilon5 = 0.00001;
`;var cI=`const float czm_epsilon6 = 0.000001;
`;var lI=`const float czm_epsilon7 = 0.0000001;
`;var uI=`const float czm_infinity = 5906376272000.0;
`;var fI=`const float czm_oneOverPi = 0.3183098861837907;
`;var dI=`const float czm_oneOverTwoPi = 0.15915494309189535;
`;var hI=`const float czm_passCesium3DTile = 4.0;
`;var mI=`const float czm_passCesium3DTileClassification = 5.0;
`;var pI=`const float czm_passCesium3DTileClassificationIgnoreShow = 6.0;
`;var _I=`const float czm_passClassification = 7.0;
`;var gI=`const float czm_passCompute = 1.0;
`;var yI=`const float czm_passEnvironment = 0.0;
`;var AI=`const float czm_passGlobe = 2.0;
`;var CI=`const float czm_passOpaque = 7.0;
`;var xI=`const float czm_passOverlay = 9.0;
`;var TI=`const float czm_passTerrainClassification = 3.0;
`;var EI=`const float czm_passTranslucent = 8.0;
`;var bI=`const float czm_pi = 3.141592653589793;
`;var SI=`const float czm_piOverFour = 0.7853981633974483;
`;var wI=`const float czm_piOverSix = 0.5235987755982988;
`;var DI=`const float czm_piOverThree = 1.0471975511965976;
`;var vI=`const float czm_piOverTwo = 1.5707963267948966;
`;var PI=`const float czm_radiansPerDegree = 0.017453292519943295;
`;var II=`const float czm_sceneMode2D = 2.0;
`;var BI=`const float czm_sceneMode3D = 3.0;
`;var OI=`const float czm_sceneModeColumbusView = 1.0;
`;var RI=`const float czm_sceneModeMorphing = 0.0;
`;var MI=`const float czm_solarRadius = 695500000.0;
`;var LI=`const float czm_threePiOver2 = 4.71238898038469;
`;var FI=`const float czm_twoPi = 6.283185307179586;
`;var NI=`const float czm_webMercatorMaxLatitude = 1.4844222297453324;
`;var VI=`struct czm_depthRangeStruct
{
float near;
float far;
};
`;var kI=`struct czm_geometryInput
{
vec3 normal;
vec3 color;
float metalness;
float roughness;
};
`;var UI=`struct czm_material
{
vec3 diffuse;
float specular;
float shininess;
vec3 normal;
vec3 emission;
float alpha;
};
`;var zI=`struct czm_materialInput
{
float s;
vec2 st;
vec3 str;
vec3 normalEC;
mat3 tangentToEyeMatrix;
vec3 positionToEyeEC;
float height;
float slope;
float aspect;
};
`;var HI=`struct czm_modelMaterial {
vec3 diffuse;
float alpha;
vec3 specular;
float roughness;
vec3 normalEC;
float occlusion;
vec3 emissive;
};
`;var GI=`struct czm_modelVertexOutput {
vec3 positionMC;
float pointSize;
};
`;var WI=`struct czm_pbrParameters
{
vec3 diffuseColor;
float roughness;
vec3 f0;
};
`;var jI=`struct czm_ray
{
vec3 origin;
vec3 direction;
};
`;var qI=`struct czm_raySegment
{
float start;
float stop;
};
const czm_raySegment czm_emptyRaySegment = czm_raySegment(-czm_infinity, -czm_infinity);
const czm_raySegment czm_fullRaySegment = czm_raySegment(0.0, czm_infinity);
`;var YI=`struct czm_shadowParameters
{
#ifdef USE_CUBE_MAP_SHADOW
vec3 texCoords;
#else
vec2 texCoords;
#endif
float depthBias;
float depth;
float nDotL;
vec2 texelStepSize;
float normalShadingSmooth;
float darkness;
};
`;var XI=`vec3 czm_acesTonemapping(vec3 color) {
float g = 0.985;
float a = 0.065;
float b = 0.0001;
float c = 0.433;
float d = 0.238;
color = (color * (color + a) - b) / (color * (g * color + c) + d);
color = clamp(color, 0.0, 1.0);
return color;
}
`;var KI=`float czm_alphaWeight(float a)
{
float z = (gl_FragCoord.z - czm_viewportTransformation[3][2]) / czm_viewportTransformation[2][2];
return pow(a + 0.01, 4.0) + max(1e-2, min(3.0 * 1e3, 0.003 / (1e-5 + pow(abs(z) / 200.0, 4.0))));
}
`;var JI=`vec4 czm_antialias(vec4 color1, vec4 color2, vec4 currentColor, float dist, float fuzzFactor)
{
float val1 = clamp(dist / fuzzFactor, 0.0, 1.0);
float val2 = clamp((dist - 0.5) / fuzzFactor, 0.0, 1.0);
val1 = val1 * (1.0 - val2);
val1 = val1 * val1 * (3.0 - (2.0 * val1));
val1 = pow(val1, 0.5);
vec4 midColor = (color1 + color2) * 0.5;
return mix(midColor, currentColor, val1);
}
vec4 czm_antialias(vec4 color1, vec4 color2, vec4 currentColor, float dist)
{
return czm_antialias(color1, color2, currentColor, dist, 0.1);
}
`;var ZI=`vec2 czm_approximateSphericalCoordinates(vec3 normal) {
float latitudeApproximation = czm_fastApproximateAtan(sqrt(normal.x * normal.x + normal.y * normal.y), normal.z);
float longitudeApproximation = czm_fastApproximateAtan(normal.x, normal.y);
return vec2(latitudeApproximation, longitudeApproximation);
}
`;var QI=`bool czm_backFacing()
{
return gl_FrontFacing == false;
}
`;var $I=`float czm_branchFreeTernary(bool comparison, float a, float b) {
float useA = float(comparison);
return a * useA + b * (1.0 - useA);
}
vec2 czm_branchFreeTernary(bool comparison, vec2 a, vec2 b) {
float useA = float(comparison);
return a * useA + b * (1.0 - useA);
}
vec3 czm_branchFreeTernary(bool comparison, vec3 a, vec3 b) {
float useA = float(comparison);
return a * useA + b * (1.0 - useA);
}
vec4 czm_branchFreeTernary(bool comparison, vec4 a, vec4 b) {
float useA = float(comparison);
return a * useA + b * (1.0 - useA);
}
`;var eB=`vec4 czm_cascadeColor(vec4 weights)
{
return vec4(1.0, 0.0, 0.0, 1.0) * weights.x +
vec4(0.0, 1.0, 0.0, 1.0) * weights.y +
vec4(0.0, 0.0, 1.0, 1.0) * weights.z +
vec4(1.0, 0.0, 1.0, 1.0) * weights.w;
}
`;var tB=`uniform vec4 shadowMap_cascadeDistances;
float czm_cascadeDistance(vec4 weights)
{
return dot(shadowMap_cascadeDistances, weights);
}
`;var nB=`uniform mat4 shadowMap_cascadeMatrices[4];
mat4 czm_cascadeMatrix(vec4 weights)
{
return shadowMap_cascadeMatrices[0] * weights.x +
shadowMap_cascadeMatrices[1] * weights.y +
shadowMap_cascadeMatrices[2] * weights.z +
shadowMap_cascadeMatrices[3] * weights.w;
}
`;var iB=`uniform vec4 shadowMap_cascadeSplits[2];
vec4 czm_cascadeWeights(float depthEye)
{
vec4 near = step(shadowMap_cascadeSplits[0], vec4(depthEye));
vec4 far = step(depthEye, shadowMap_cascadeSplits[1]);
return near * far;
}
`;var oB=`vec4 czm_columbusViewMorph(vec4 position2D, vec4 position3D, float time)
{
vec3 p = mix(position2D.xyz, position3D.xyz, time);
return vec4(p, 1.0);
}
`;var rB=`vec4 czm_computePosition();
`;var sB=`vec2 cordic(float angle)
{
vec2 vector = vec2(6.0725293500888267e-1, 0.0);
float sense = (angle < 0.0) ? -1.0 : 1.0;
mat2 rotation = mat2(1.0, sense, -sense, 1.0);
vector = rotation * vector;
angle -= sense * 7.8539816339744828e-1;
sense = (angle < 0.0) ? -1.0 : 1.0;
float factor = sense * 5.0e-1;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 4.6364760900080609e-1;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 2.5e-1;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 2.4497866312686414e-1;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 1.25e-1;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 1.2435499454676144e-1;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 6.25e-2;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 6.2418809995957350e-2;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 3.125e-2;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 3.1239833430268277e-2;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 1.5625e-2;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 1.5623728620476831e-2;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 7.8125e-3;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 7.8123410601011111e-3;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 3.90625e-3;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 3.9062301319669718e-3;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 1.953125e-3;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 1.9531225164788188e-3;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 9.765625e-4;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 9.7656218955931946e-4;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 4.8828125e-4;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 4.8828121119489829e-4;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 2.44140625e-4;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 2.4414062014936177e-4;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 1.220703125e-4;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 1.2207031189367021e-4;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 6.103515625e-5;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 6.1035156174208773e-5;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 3.0517578125e-5;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 3.0517578115526096e-5;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 1.52587890625e-5;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 1.5258789061315762e-5;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 7.62939453125e-6;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 7.6293945311019700e-6;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 3.814697265625e-6;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 3.8146972656064961e-6;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 1.9073486328125e-6;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 1.9073486328101870e-6;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 9.5367431640625e-7;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 9.5367431640596084e-7;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 4.76837158203125e-7;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 4.7683715820308884e-7;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 2.384185791015625e-7;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
angle -= sense * 2.3841857910155797e-7;
sense = (angle < 0.0) ? -1.0 : 1.0;
factor = sense * 1.1920928955078125e-7;
rotation[0][1] = factor;
rotation[1][0] = -factor;
vector = rotation * vector;
return vector;
}
vec2 czm_cosineAndSine(float angle)
{
if (angle < -czm_piOverTwo || angle > czm_piOverTwo)
{
if (angle < 0.0)
{
return -cordic(angle + czm_pi);
}
else
{
return -cordic(angle - czm_pi);
}
}
else
{
return cordic(angle);
}
}
`;var aB=`vec2 czm_decompressTextureCoordinates(float encoded)
{
float temp = encoded / 4096.0;
float xZeroTo4095 = floor(temp);
float stx = xZeroTo4095 / 4095.0;
float sty = (encoded - xZeroTo4095 * 4096.0) / 4095.0;
return vec2(stx, sty);
}
`;var cB=`czm_pbrParameters czm_defaultPbrMaterial()
{
czm_pbrParameters results;
results.diffuseColor = vec3(1.0);
results.roughness = 1.0;
const vec3 REFLECTANCE_DIELECTRIC = vec3(0.04);
results.f0 = REFLECTANCE_DIELECTRIC;
return results;
}
`;var lB=`#if defined(GL_EXT_frag_depth) && !defined(LOG_DEPTH)
varying float v_WindowZ;
#endif
vec4 czm_depthClamp(vec4 coords)
{
#ifndef LOG_DEPTH
#ifdef GL_EXT_frag_depth
v_WindowZ = (0.5 * (coords.z / coords.w) + 0.5) * coords.w;
coords.z = 0.0;
#else
coords.z = min(coords.z, coords.w);
#endif
#endif
return coords;
}
`;var uB=`mat3 czm_eastNorthUpToEyeCoordinates(vec3 positionMC, vec3 normalEC)
{
vec3 tangentMC = normalize(vec3(-positionMC.y, positionMC.x, 0.0));
vec3 tangentEC = normalize(czm_normal3D * tangentMC);
vec3 bitangentEC = normalize(cross(normalEC, tangentEC));
return mat3(
tangentEC.x,   tangentEC.y,   tangentEC.z,
bitangentEC.x, bitangentEC.y, bitangentEC.z,
normalEC.x,    normalEC.y,    normalEC.z);
}
`;var fB=`bool czm_ellipsoidContainsPoint(vec3 ellipsoid_inverseRadii, vec3 point)
{
vec3 scaled = ellipsoid_inverseRadii * (czm_inverseModelView * vec4(point, 1.0)).xyz;
return (dot(scaled, scaled) <= 1.0);
}
`;var dB=`vec2 czm_ellipsoidWgs84TextureCoordinates(vec3 normal)
{
return vec2(atan(normal.y, normal.x) * czm_oneOverTwoPi + 0.5, asin(normal.z) * czm_oneOverPi + 0.5);
}
`;var hB=`bool czm_equalsEpsilon(vec4 left, vec4 right, float epsilon) {
return all(lessThanEqual(abs(left - right), vec4(epsilon)));
}
bool czm_equalsEpsilon(vec3 left, vec3 right, float epsilon) {
return all(lessThanEqual(abs(left - right), vec3(epsilon)));
}
bool czm_equalsEpsilon(vec2 left, vec2 right, float epsilon) {
return all(lessThanEqual(abs(left - right), vec2(epsilon)));
}
bool czm_equalsEpsilon(float left, float right, float epsilon) {
return (abs(left - right) <= epsilon);
}
`;var mB=`vec4 czm_eyeOffset(vec4 positionEC, vec3 eyeOffset)
{
vec4 p = positionEC;
vec4 zEyeOffset = normalize(p) * eyeOffset.z;
p.xy += eyeOffset.xy + zEyeOffset.xy;
p.z += zEyeOffset.z;
return p;
}
`;var pB=`vec4 czm_eyeToWindowCoordinates(vec4 positionEC)
{
vec4 q = czm_projection * positionEC;
q.xyz /= q.w;
q.xyz = (czm_viewportTransformation * vec4(q.xyz, 1.0)).xyz;
return q;
}
`;var _B=`float czm_fastApproximateAtan(float x) {
return x * (-0.1784 * x - 0.0663 * x * x + 1.0301);
}
float czm_fastApproximateAtan(float x, float y) {
float t = abs(x);
float opposite = abs(y);
float adjacent = max(t, opposite);
opposite = min(t, opposite);
t = czm_fastApproximateAtan(opposite / adjacent);
t = czm_branchFreeTernary(abs(y) > abs(x), czm_piOverTwo - t, t);
t = czm_branchFreeTernary(x < 0.0, czm_pi - t, t);
t = czm_branchFreeTernary(y < 0.0, -t, t);
return t;
}
`;var gB=`vec3 czm_fog(float distanceToCamera, vec3 color, vec3 fogColor)
{
float scalar = distanceToCamera * czm_fogDensity;
float fog = 1.0 - exp(-(scalar * scalar));
return mix(color, fogColor, fog);
}
vec3 czm_fog(float distanceToCamera, vec3 color, vec3 fogColor, float fogModifierConstant)
{
float scalar = distanceToCamera * czm_fogDensity;
float fog = 1.0 - exp(-((fogModifierConstant * scalar + fogModifierConstant) * (scalar * (1.0 + fogModifierConstant))));
return mix(color, fogColor, fog);
}
`;var yB=`vec3 czm_gammaCorrect(vec3 color) {
#ifdef HDR
color = pow(color, vec3(czm_gamma));
#endif
return color;
}
vec4 czm_gammaCorrect(vec4 color) {
#ifdef HDR
color.rgb = pow(color.rgb, vec3(czm_gamma));
#endif
return color;
}
`;var AB=`vec3 czm_geodeticSurfaceNormal(vec3 positionOnEllipsoid, vec3 ellipsoidCenter, vec3 oneOverEllipsoidRadiiSquared)
{
return normalize((positionOnEllipsoid - ellipsoidCenter) * oneOverEllipsoidRadiiSquared);
}
`;var CB=`czm_material czm_getDefaultMaterial(czm_materialInput materialInput)
{
czm_material material;
material.diffuse = vec3(0.0);
material.specular = 0.0;
material.shininess = 1.0;
material.normal = materialInput.normalEC;
material.emission = vec3(0.0);
material.alpha = 1.0;
return material;
}
`;var xB=`float czm_getLambertDiffuse(vec3 lightDirectionEC, vec3 normalEC)
{
return max(dot(lightDirectionEC, normalEC), 0.0);
}
`;var TB=`float czm_getSpecular(vec3 lightDirectionEC, vec3 toEyeEC, vec3 normalEC, float shininess)
{
vec3 toReflectedLight = reflect(-lightDirectionEC, normalEC);
float specular = max(dot(toReflectedLight, toEyeEC), 0.0);
return pow(specular, max(shininess, czm_epsilon2));
}
`;var EB=`vec4 czm_getWaterNoise(sampler2D normalMap, vec2 uv, float time, float angleInRadians)
{
float cosAngle = cos(angleInRadians);
float sinAngle = sin(angleInRadians);
vec2 s0 = vec2(1.0/17.0, 0.0);
vec2 s1 = vec2(-1.0/29.0, 0.0);
vec2 s2 = vec2(1.0/101.0, 1.0/59.0);
vec2 s3 = vec2(-1.0/109.0, -1.0/57.0);
s0 = vec2((cosAngle * s0.x) - (sinAngle * s0.y), (sinAngle * s0.x) + (cosAngle * s0.y));
s1 = vec2((cosAngle * s1.x) - (sinAngle * s1.y), (sinAngle * s1.x) + (cosAngle * s1.y));
s2 = vec2((cosAngle * s2.x) - (sinAngle * s2.y), (sinAngle * s2.x) + (cosAngle * s2.y));
s3 = vec2((cosAngle * s3.x) - (sinAngle * s3.y), (sinAngle * s3.x) + (cosAngle * s3.y));
vec2 uv0 = (uv/103.0) + (time * s0);
vec2 uv1 = uv/107.0 + (time * s1) + vec2(0.23);
vec2 uv2 = uv/vec2(897.0, 983.0) + (time * s2) + vec2(0.51);
vec2 uv3 = uv/vec2(991.0, 877.0) + (time * s3) + vec2(0.71);
uv0 = fract(uv0);
uv1 = fract(uv1);
uv2 = fract(uv2);
uv3 = fract(uv3);
vec4 noise = (texture2D(normalMap, uv0)) +
(texture2D(normalMap, uv1)) +
(texture2D(normalMap, uv2)) +
(texture2D(normalMap, uv3));
return ((noise / 4.0) - 0.5) * 2.0;
}
`;var bB=`const vec4 K_HSB2RGB = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);
vec3 czm_HSBToRGB(vec3 hsb)
{
vec3 p = abs(fract(hsb.xxx + K_HSB2RGB.xyz) * 6.0 - K_HSB2RGB.www);
return hsb.z * mix(K_HSB2RGB.xxx, clamp(p - K_HSB2RGB.xxx, 0.0, 1.0), hsb.y);
}
`;var SB=`vec3 hueToRGB(float hue)
{
float r = abs(hue * 6.0 - 3.0) - 1.0;
float g = 2.0 - abs(hue * 6.0 - 2.0);
float b = 2.0 - abs(hue * 6.0 - 4.0);
return clamp(vec3(r, g, b), 0.0, 1.0);
}
vec3 czm_HSLToRGB(vec3 hsl)
{
vec3 rgb = hueToRGB(hsl.x);
float c = (1.0 - abs(2.0 * hsl.z - 1.0)) * hsl.y;
return (rgb - 0.5) * c + hsl.z;
}
`;var wB=`vec3 czm_hue(vec3 rgb, float adjustment)
{
const mat3 toYIQ = mat3(0.299,     0.587,     0.114,
0.595716, -0.274453, -0.321263,
0.211456, -0.522591,  0.311135);
const mat3 toRGB = mat3(1.0,  0.9563,  0.6210,
1.0, -0.2721, -0.6474,
1.0, -1.107,   1.7046);
vec3 yiq = toYIQ * rgb;
float hue = atan(yiq.z, yiq.y) + adjustment;
float chroma = sqrt(yiq.z * yiq.z + yiq.y * yiq.y);
vec3 color = vec3(yiq.x, chroma * cos(hue), chroma * sin(hue));
return toRGB * color;
}
`;var DB=`vec3 czm_inverseGamma(vec3 color) {
return pow(color, vec3(1.0 / czm_gamma));
}
`;var vB=`bool czm_isEmpty(czm_raySegment interval)
{
return (interval.stop < 0.0);
}
`;var PB=`bool czm_isFull(czm_raySegment interval)
{
return (interval.start == 0.0 && interval.stop == czm_infinity);
}
`;var IB=`float czm_latitudeToWebMercatorFraction(float latitude, float southMercatorY, float oneOverMercatorHeight)
{
float sinLatitude = sin(latitude);
float mercatorY = 0.5 * log((1.0 + sinLatitude) / (1.0 - sinLatitude));
return (mercatorY - southMercatorY) * oneOverMercatorHeight;
}
`;var BB=`vec3 czm_linearToSrgb(vec3 linearIn)
{
return pow(linearIn, vec3(1.0/2.2));
}
vec4 czm_linearToSrgb(vec4 linearIn)
{
vec3 srgbOut = pow(linearIn.rgb, vec3(1.0/2.2));
return vec4(srgbOut, linearIn.a);
}
`;var OB=`float czm_lineDistance(vec2 point1, vec2 point2, vec2 point) {
return abs((point2.y - point1.y) * point.x - (point2.x - point1.x) * point.y + point2.x * point1.y - point2.y * point1.x) / distance(point2, point1);
}
`;var RB=`float czm_luminance(vec3 rgb)
{
const vec3 W = vec3(0.2125, 0.7154, 0.0721);
return dot(rgb, W);
}
`;var MB=`float czm_metersPerPixel(vec4 positionEC, float pixelRatio)
{
float width = czm_viewport.z;
float height = czm_viewport.w;
float pixelWidth;
float pixelHeight;
float top = czm_frustumPlanes.x;
float bottom = czm_frustumPlanes.y;
float left = czm_frustumPlanes.z;
float right = czm_frustumPlanes.w;
if (czm_sceneMode == czm_sceneMode2D || czm_orthographicIn3D == 1.0)
{
float frustumWidth = right - left;
float frustumHeight = top - bottom;
pixelWidth = frustumWidth / width;
pixelHeight = frustumHeight / height;
}
else
{
float distanceToPixel = -positionEC.z;
float inverseNear = 1.0 / czm_currentFrustum.x;
float tanTheta = top * inverseNear;
pixelHeight = 2.0 * distanceToPixel * tanTheta / height;
tanTheta = right * inverseNear;
pixelWidth = 2.0 * distanceToPixel * tanTheta / width;
}
return max(pixelWidth, pixelHeight) * pixelRatio;
}
float czm_metersPerPixel(vec4 positionEC)
{
return czm_metersPerPixel(positionEC, czm_pixelRatio);
}
`;var LB=`vec4 czm_modelToWindowCoordinates(vec4 position)
{
vec4 q = czm_modelViewProjection * position;
q.xyz /= q.w;
q.xyz = (czm_viewportTransformation * vec4(q.xyz, 1.0)).xyz;
return q;
}
`;var FB=`vec3 czm_multiplyWithColorBalance(vec3 left, vec3 right)
{
const vec3 W = vec3(0.2125, 0.7154, 0.0721);
vec3 target = left * right;
float leftLuminance = dot(left, W);
float rightLuminance = dot(right, W);
float targetLuminance = dot(target, W);
return ((leftLuminance + rightLuminance) / (2.0 * targetLuminance)) * target;
}
`;var NB=`float czm_nearFarScalar(vec4 nearFarScalar, float cameraDistSq)
{
float valueAtMin = nearFarScalar.y;
float valueAtMax = nearFarScalar.w;
float nearDistanceSq = nearFarScalar.x * nearFarScalar.x;
float farDistanceSq = nearFarScalar.z * nearFarScalar.z;
float t = (cameraDistSq - nearDistanceSq) / (farDistanceSq - nearDistanceSq);
t = pow(clamp(t, 0.0, 1.0), 0.2);
return mix(valueAtMin, valueAtMax, t);
}
`;var VB=`vec3 czm_octDecode(vec2 encoded, float range)
{
if (encoded.x == 0.0 && encoded.y == 0.0) {
return vec3(0.0, 0.0, 0.0);
}
encoded = encoded / range * 2.0 - 1.0;
vec3 v = vec3(encoded.x, encoded.y, 1.0 - abs(encoded.x) - abs(encoded.y));
if (v.z < 0.0)
{
v.xy = (1.0 - abs(v.yx)) * czm_signNotZero(v.xy);
}
return normalize(v);
}
vec3 czm_octDecode(vec2 encoded)
{
return czm_octDecode(encoded, 255.0);
}
vec3 czm_octDecode(float encoded)
{
float temp = encoded / 256.0;
float x = floor(temp);
float y = (temp - x) * 256.0;
return czm_octDecode(vec2(x, y));
}
void czm_octDecode(vec2 encoded, out vec3 vector1, out vec3 vector2, out vec3 vector3)
{
float temp = encoded.x / 65536.0;
float x = floor(temp);
float encodedFloat1 = (temp - x) * 65536.0;
temp = encoded.y / 65536.0;
float y = floor(temp);
float encodedFloat2 = (temp - y) * 65536.0;
vector1 = czm_octDecode(encodedFloat1);
vector2 = czm_octDecode(encodedFloat2);
vector3 = czm_octDecode(vec2(x, y));
}
`;var kB=`vec4 czm_packDepth(float depth)
{
vec4 enc = vec4(1.0, 255.0, 65025.0, 16581375.0) * depth;
enc = fract(enc);
enc -= enc.yzww * vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0, 0.0);
return enc;
}
`;var UB=`vec3 lambertianDiffuse(vec3 diffuseColor)
{
return diffuseColor / czm_pi;
}
vec3 fresnelSchlick2(vec3 f0, vec3 f90, float VdotH)
{
return f0 + (f90 - f0) * pow(clamp(1.0 - VdotH, 0.0, 1.0), 5.0);
}
float smithVisibilityG1(float NdotV, float roughness)
{
float k = (roughness + 1.0) * (roughness + 1.0) / 8.0;
return NdotV / (NdotV * (1.0 - k) + k);
}
float smithVisibilityGGX(float roughness, float NdotL, float NdotV)
{
return (
smithVisibilityG1(NdotL, roughness) *
smithVisibilityG1(NdotV, roughness)
);
}
float GGX(float roughness, float NdotH)
{
float roughnessSquared = roughness * roughness;
float f = (NdotH * roughnessSquared - NdotH) * NdotH + 1.0;
return roughnessSquared / (czm_pi * f * f);
}
vec3 czm_pbrLighting(
vec3 positionEC,
vec3 normalEC,
vec3 lightDirectionEC,
vec3 lightColorHdr,
czm_pbrParameters pbrParameters
)
{
vec3 v = -normalize(positionEC);
vec3 l = normalize(lightDirectionEC);
vec3 h = normalize(v + l);
vec3 n = normalEC;
float NdotL = clamp(dot(n, l), 0.001, 1.0);
float NdotV = abs(dot(n, v)) + 0.001;
float NdotH = clamp(dot(n, h), 0.0, 1.0);
float LdotH = clamp(dot(l, h), 0.0, 1.0);
float VdotH = clamp(dot(v, h), 0.0, 1.0);
vec3 f0 = pbrParameters.f0;
float reflectance = max(max(f0.r, f0.g), f0.b);
vec3 f90 = vec3(clamp(reflectance * 25.0, 0.0, 1.0));
vec3 F = fresnelSchlick2(f0, f90, VdotH);
float alpha = pbrParameters.roughness;
float G = smithVisibilityGGX(alpha, NdotL, NdotV);
float D = GGX(alpha, NdotH);
vec3 specularContribution = F * G * D / (4.0 * NdotL * NdotV);
vec3 diffuseColor = pbrParameters.diffuseColor;
vec3 diffuseContribution = (1.0 - F) * lambertianDiffuse(diffuseColor);
return (diffuseContribution + specularContribution) * NdotL * lightColorHdr;
}
`;var zB=`czm_pbrParameters czm_pbrMetallicRoughnessMaterial(
vec3 baseColor,
float metallic,
float roughness
)
{
czm_pbrParameters results;
roughness = clamp(roughness, 0.0, 1.0);
results.roughness = roughness * roughness;
metallic = clamp(metallic, 0.0, 1.0);
const vec3 REFLECTANCE_DIELECTRIC = vec3(0.04);
vec3 f0 = mix(REFLECTANCE_DIELECTRIC, baseColor, metallic);
results.f0 = f0;
results.diffuseColor = baseColor * (1.0 - f0) * (1.0 - metallic);
return results;
}
`;var HB=`czm_pbrParameters czm_pbrSpecularGlossinessMaterial(
vec3 diffuse,
vec3 specular,
float glossiness
)
{
czm_pbrParameters results;
float roughness = 1.0 - glossiness;
results.roughness = roughness * roughness;
results.diffuseColor = diffuse * (1.0 - max(max(specular.r, specular.g), specular.b));
results.f0 = specular;
return results;
}
`;var GB=`float czm_private_getLambertDiffuseOfMaterial(vec3 lightDirectionEC, czm_material material)
{
return czm_getLambertDiffuse(lightDirectionEC, material.normal);
}
float czm_private_getSpecularOfMaterial(vec3 lightDirectionEC, vec3 toEyeEC, czm_material material)
{
return czm_getSpecular(lightDirectionEC, toEyeEC, material.normal, material.shininess);
}
vec4 czm_phong(vec3 toEye, czm_material material, vec3 lightDirectionEC)
{
float diffuse = czm_private_getLambertDiffuseOfMaterial(vec3(0.0, 0.0, 1.0), material);
if (czm_sceneMode == czm_sceneMode3D) {
diffuse += czm_private_getLambertDiffuseOfMaterial(vec3(0.0, 1.0, 0.0), material);
}
float specular = czm_private_getSpecularOfMaterial(lightDirectionEC, toEye, material);
vec3 materialDiffuse = material.diffuse * 0.5;
vec3 ambient = materialDiffuse;
vec3 color = ambient + material.emission;
color += materialDiffuse * diffuse * czm_lightColor;
color += material.specular * specular * czm_lightColor;
return vec4(color, material.alpha);
}
vec4 czm_private_phong(vec3 toEye, czm_material material, vec3 lightDirectionEC)
{
float diffuse = czm_private_getLambertDiffuseOfMaterial(lightDirectionEC, material);
float specular = czm_private_getSpecularOfMaterial(lightDirectionEC, toEye, material);
vec3 ambient = vec3(0.0);
vec3 color = ambient + material.emission;
color += material.diffuse * diffuse * czm_lightColor;
color += material.specular * specular * czm_lightColor;
return vec4(color, material.alpha);
}
`;var WB=`float czm_planeDistance(vec4 plane, vec3 point) {
return (dot(plane.xyz, point) + plane.w);
}
float czm_planeDistance(vec3 planeNormal, float planeDistance, vec3 point) {
return (dot(planeNormal, point) + planeDistance);
}
`;var jB=`vec3 czm_pointAlongRay(czm_ray ray, float time)
{
return ray.origin + (time * ray.direction);
}
`;var qB=`czm_raySegment czm_rayEllipsoidIntersectionInterval(czm_ray ray, vec3 ellipsoid_center, vec3 ellipsoid_inverseRadii)
{
vec3 q = ellipsoid_inverseRadii * (czm_inverseModelView * vec4(ray.origin, 1.0)).xyz;
vec3 w = ellipsoid_inverseRadii * (czm_inverseModelView * vec4(ray.direction, 0.0)).xyz;
q = q - ellipsoid_inverseRadii * (czm_inverseModelView * vec4(ellipsoid_center, 1.0)).xyz;
float q2 = dot(q, q);
float qw = dot(q, w);
if (q2 > 1.0)
{
if (qw >= 0.0)
{
return czm_emptyRaySegment;
}
else
{
float qw2 = qw * qw;
float difference = q2 - 1.0;
float w2 = dot(w, w);
float product = w2 * difference;
if (qw2 < product)
{
return czm_emptyRaySegment;
}
else if (qw2 > product)
{
float discriminant = qw * qw - product;
float temp = -qw + sqrt(discriminant);
float root0 = temp / w2;
float root1 = difference / temp;
if (root0 < root1)
{
czm_raySegment i = czm_raySegment(root0, root1);
return i;
}
else
{
czm_raySegment i = czm_raySegment(root1, root0);
return i;
}
}
else
{
float root = sqrt(difference / w2);
czm_raySegment i = czm_raySegment(root, root);
return i;
}
}
}
else if (q2 < 1.0)
{
float difference = q2 - 1.0;
float w2 = dot(w, w);
float product = w2 * difference;
float discriminant = qw * qw - product;
float temp = -qw + sqrt(discriminant);
czm_raySegment i = czm_raySegment(0.0, temp / w2);
return i;
}
else
{
if (qw < 0.0)
{
float w2 = dot(w, w);
czm_raySegment i = czm_raySegment(0.0, -qw / w2);
return i;
}
else
{
return czm_emptyRaySegment;
}
}
}
`;var YB=`czm_raySegment czm_raySphereIntersectionInterval(czm_ray ray, vec3 center, float radius)
{
vec3 o = ray.origin;
vec3 d = ray.direction;
vec3 oc = o - center;
float a = dot(d, d);
float b = 2.0 * dot(d, oc);
float c = dot(oc, oc) - (radius * radius);
float det = (b * b) - (4.0 * a * c);
if (det < 0.0) {
return czm_emptyRaySegment;
}
float sqrtDet = sqrt(det);
float t0 = (-b - sqrtDet) / (2.0 * a);
float t1 = (-b + sqrtDet) / (2.0 * a);
czm_raySegment result = czm_raySegment(t0, t1);
return result;
}
`;var XB=`float czm_readDepth(sampler2D depthTexture, vec2 texCoords)
{
return czm_reverseLogDepth(texture2D(depthTexture, texCoords).r);
}
`;var KB=`float czm_readNonPerspective(float value, float oneOverW) {
return value * oneOverW;
}
vec2 czm_readNonPerspective(vec2 value, float oneOverW) {
return value * oneOverW;
}
vec3 czm_readNonPerspective(vec3 value, float oneOverW) {
return value * oneOverW;
}
vec4 czm_readNonPerspective(vec4 value, float oneOverW) {
return value * oneOverW;
}
`;var JB=`float czm_reverseLogDepth(float logZ)
{
#ifdef LOG_DEPTH
float near = czm_currentFrustum.x;
float far = czm_currentFrustum.y;
float log2Depth = logZ * czm_log2FarDepthFromNearPlusOne;
float depthFromNear = pow(2.0, log2Depth) - 1.0;
return far * (1.0 - near / (depthFromNear + near)) / (far - near);
#endif
return logZ;
}
`;var ZB=`const vec4 K_RGB2HSB = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);
vec3 czm_RGBToHSB(vec3 rgb)
{
vec4 p = mix(vec4(rgb.bg, K_RGB2HSB.wz), vec4(rgb.gb, K_RGB2HSB.xy), step(rgb.b, rgb.g));
vec4 q = mix(vec4(p.xyw, rgb.r), vec4(rgb.r, p.yzx), step(p.x, rgb.r));
float d = q.x - min(q.w, q.y);
return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + czm_epsilon7)), d / (q.x + czm_epsilon7), q.x);
}
`;var QB=`vec3 RGBtoHCV(vec3 rgb)
{
vec4 p = (rgb.g < rgb.b) ? vec4(rgb.bg, -1.0, 2.0 / 3.0) : vec4(rgb.gb, 0.0, -1.0 / 3.0);
vec4 q = (rgb.r < p.x) ? vec4(p.xyw, rgb.r) : vec4(rgb.r, p.yzx);
float c = q.x - min(q.w, q.y);
float h = abs((q.w - q.y) / (6.0 * c + czm_epsilon7) + q.z);
return vec3(h, c, q.x);
}
vec3 czm_RGBToHSL(vec3 rgb)
{
vec3 hcv = RGBtoHCV(rgb);
float l = hcv.z - hcv.y * 0.5;
float s = hcv.y / (1.0 - abs(l * 2.0 - 1.0) + czm_epsilon7);
return vec3(hcv.x, s, l);
}
`;var $B=`vec3 czm_RGBToXYZ(vec3 rgb)
{
const mat3 RGB2XYZ = mat3(0.4124, 0.2126, 0.0193,
0.3576, 0.7152, 0.1192,
0.1805, 0.0722, 0.9505);
vec3 xyz = RGB2XYZ * rgb;
vec3 Yxy;
Yxy.r = xyz.g;
float temp = dot(vec3(1.0), xyz);
Yxy.gb = xyz.rg / temp;
return Yxy;
}
`;var eO=`float czm_round(float value) {
return floor(value + 0.5);
}
vec2 czm_round(vec2 value) {
return floor(value + 0.5);
}
vec3 czm_round(vec3 value) {
return floor(value + 0.5);
}
vec4 czm_round(vec4 value) {
return floor(value + 0.5);
}
`;var tO=`vec3 czm_sampleOctahedralProjectionWithFiltering(sampler2D projectedMap, vec2 textureSize, vec3 direction, float lod)
{
direction /= dot(vec3(1.0), abs(direction));
vec2 rev = abs(direction.zx) - vec2(1.0);
vec2 neg = vec2(direction.x < 0.0 ? rev.x : -rev.x,
direction.z < 0.0 ? rev.y : -rev.y);
vec2 uv = direction.y < 0.0 ? neg : direction.xz;
vec2 coord = 0.5 * uv + vec2(0.5);
vec2 pixel = 1.0 / textureSize;
if (lod > 0.0)
{
float scale = 1.0 / pow(2.0, lod);
float offset = ((textureSize.y + 1.0) / textureSize.x);
coord.x *= offset;
coord *= scale;
coord.x += offset + pixel.x;
coord.y += (1.0 - (1.0 / pow(2.0, lod - 1.0))) + pixel.y * (lod - 1.0) * 2.0;
}
else
{
coord.x *= (textureSize.y / textureSize.x);
}
#ifndef OES_texture_float_linear
vec3 color1 = texture2D(projectedMap, coord + vec2(0.0, pixel.y)).rgb;
vec3 color2 = texture2D(projectedMap, coord + vec2(pixel.x, 0.0)).rgb;
vec3 color3 = texture2D(projectedMap, coord + pixel).rgb;
vec3 color4 = texture2D(projectedMap, coord).rgb;
vec2 texturePosition = coord * textureSize;
float fu = fract(texturePosition.x);
float fv = fract(texturePosition.y);
vec3 average1 = mix(color4, color2, fu);
vec3 average2 = mix(color1, color3, fu);
vec3 color = mix(average1, average2, fv);
#else
vec3 color = texture2D(projectedMap, coord).rgb;
#endif
return color;
}
vec3 czm_sampleOctahedralProjection(sampler2D projectedMap, vec2 textureSize, vec3 direction, float lod, float maxLod) {
float currentLod = floor(lod + 0.5);
float nextLod = min(currentLod + 1.0, maxLod);
vec3 colorCurrentLod = czm_sampleOctahedralProjectionWithFiltering(projectedMap, textureSize, direction, currentLod);
vec3 colorNextLod = czm_sampleOctahedralProjectionWithFiltering(projectedMap, textureSize, direction, nextLod);
return mix(colorNextLod, colorCurrentLod, nextLod - lod);
}
`;var nO=`vec3 czm_saturation(vec3 rgb, float adjustment)
{
const vec3 W = vec3(0.2125, 0.7154, 0.0721);
vec3 intensity = vec3(dot(rgb, W));
return mix(intensity, rgb, adjustment);
}
`;var iO=`float czm_sampleShadowMap(highp samplerCube shadowMap, vec3 d)
{
return czm_unpackDepth(textureCube(shadowMap, d));
}
float czm_sampleShadowMap(highp sampler2D shadowMap, vec2 uv)
{
#ifdef USE_SHADOW_DEPTH_TEXTURE
return texture2D(shadowMap, uv).r;
#else
return czm_unpackDepth(texture2D(shadowMap, uv));
#endif
}
float czm_shadowDepthCompare(samplerCube shadowMap, vec3 uv, float depth)
{
return step(depth, czm_sampleShadowMap(shadowMap, uv));
}
float czm_shadowDepthCompare(sampler2D shadowMap, vec2 uv, float depth)
{
return step(depth, czm_sampleShadowMap(shadowMap, uv));
}
`;var oO=`float czm_private_shadowVisibility(float visibility, float nDotL, float normalShadingSmooth, float darkness)
{
#ifdef USE_NORMAL_SHADING
#ifdef USE_NORMAL_SHADING_SMOOTH
float strength = clamp(nDotL / normalShadingSmooth, 0.0, 1.0);
#else
float strength = step(0.0, nDotL);
#endif
visibility *= strength;
#endif
visibility = max(visibility, darkness);
return visibility;
}
#ifdef USE_CUBE_MAP_SHADOW
float czm_shadowVisibility(samplerCube shadowMap, czm_shadowParameters shadowParameters)
{
float depthBias = shadowParameters.depthBias;
float depth = shadowParameters.depth;
float nDotL = shadowParameters.nDotL;
float normalShadingSmooth = shadowParameters.normalShadingSmooth;
float darkness = shadowParameters.darkness;
vec3 uvw = shadowParameters.texCoords;
depth -= depthBias;
float visibility = czm_shadowDepthCompare(shadowMap, uvw, depth);
return czm_private_shadowVisibility(visibility, nDotL, normalShadingSmooth, darkness);
}
#else
float czm_shadowVisibility(sampler2D shadowMap, czm_shadowParameters shadowParameters)
{
float depthBias = shadowParameters.depthBias;
float depth = shadowParameters.depth;
float nDotL = shadowParameters.nDotL;
float normalShadingSmooth = shadowParameters.normalShadingSmooth;
float darkness = shadowParameters.darkness;
vec2 uv = shadowParameters.texCoords;
depth -= depthBias;
#ifdef USE_SOFT_SHADOWS
vec2 texelStepSize = shadowParameters.texelStepSize;
float radius = 1.0;
float dx0 = -texelStepSize.x * radius;
float dy0 = -texelStepSize.y * radius;
float dx1 = texelStepSize.x * radius;
float dy1 = texelStepSize.y * radius;
float visibility = (
czm_shadowDepthCompare(shadowMap, uv, depth) +
czm_shadowDepthCompare(shadowMap, uv + vec2(dx0, dy0), depth) +
czm_shadowDepthCompare(shadowMap, uv + vec2(0.0, dy0), depth) +
czm_shadowDepthCompare(shadowMap, uv + vec2(dx1, dy0), depth) +
czm_shadowDepthCompare(shadowMap, uv + vec2(dx0, 0.0), depth) +
czm_shadowDepthCompare(shadowMap, uv + vec2(dx1, 0.0), depth) +
czm_shadowDepthCompare(shadowMap, uv + vec2(dx0, dy1), depth) +
czm_shadowDepthCompare(shadowMap, uv + vec2(0.0, dy1), depth) +
czm_shadowDepthCompare(shadowMap, uv + vec2(dx1, dy1), depth)
) * (1.0 / 9.0);
#else
float visibility = czm_shadowDepthCompare(shadowMap, uv, depth);
#endif
return czm_private_shadowVisibility(visibility, nDotL, normalShadingSmooth, darkness);
}
#endif
`;var rO=`float czm_signNotZero(float value)
{
return value >= 0.0 ? 1.0 : -1.0;
}
vec2 czm_signNotZero(vec2 value)
{
return vec2(czm_signNotZero(value.x), czm_signNotZero(value.y));
}
vec3 czm_signNotZero(vec3 value)
{
return vec3(czm_signNotZero(value.x), czm_signNotZero(value.y), czm_signNotZero(value.z));
}
vec4 czm_signNotZero(vec4 value)
{
return vec4(czm_signNotZero(value.x), czm_signNotZero(value.y), czm_signNotZero(value.z), czm_signNotZero(value.w));
}
`;var sO=`vec3 czm_sphericalHarmonics(vec3 normal, vec3 coefficients[9])
{
vec3 L00 = coefficients[0];
vec3 L1_1 = coefficients[1];
vec3 L10 = coefficients[2];
vec3 L11 = coefficients[3];
vec3 L2_2 = coefficients[4];
vec3 L2_1 = coefficients[5];
vec3 L20 = coefficients[6];
vec3 L21 = coefficients[7];
vec3 L22 = coefficients[8];
float x = normal.x;
float y = normal.y;
float z = normal.z;
return
L00
+ L1_1 * y
+ L10 * z
+ L11 * x
+ L2_2 * (y * x)
+ L2_1 * (y * z)
+ L20 * (3.0 * z * z - 1.0)
+ L21 * (z * x)
+ L22 * (x * x - y * y);
}
`;var aO=`vec3 czm_srgbToLinear(vec3 srgbIn)
{
return pow(srgbIn, vec3(2.2));
}
vec4 czm_srgbToLinear(vec4 srgbIn)
{
vec3 linearOut = pow(srgbIn.rgb, vec3(2.2));
return vec4(linearOut, srgbIn.a);
}
`;var cO=`mat3 czm_tangentToEyeSpaceMatrix(vec3 normalEC, vec3 tangentEC, vec3 bitangentEC)
{
vec3 normal = normalize(normalEC);
vec3 tangent = normalize(tangentEC);
vec3 bitangent = normalize(bitangentEC);
return mat3(tangent.x  , tangent.y  , tangent.z,
bitangent.x, bitangent.y, bitangent.z,
normal.x   , normal.y   , normal.z);
}
`;var lO=`vec4 czm_transformPlane(vec4 plane, mat4 transform) {
vec4 transformedPlane = transform * plane;
float normalMagnitude = length(transformedPlane.xyz);
return transformedPlane / normalMagnitude;
}
`;var uO=`vec4 czm_translateRelativeToEye(vec3 high, vec3 low)
{
vec3 highDifference = high - czm_encodedCameraPositionMCHigh;
vec3 lowDifference = low - czm_encodedCameraPositionMCLow;
return vec4(highDifference + lowDifference, 1.0);
}
`;var fO=`vec4 czm_translucentPhong(vec3 toEye, czm_material material, vec3 lightDirectionEC)
{
float diffuse = czm_getLambertDiffuse(vec3(0.0, 0.0, 1.0), material.normal);
if (czm_sceneMode == czm_sceneMode3D) {
diffuse += czm_getLambertDiffuse(vec3(0.0, 1.0, 0.0), material.normal);
}
diffuse = clamp(diffuse, 0.0, 1.0);
float specular = czm_getSpecular(lightDirectionEC, toEye, material.normal, material.shininess);
vec3 materialDiffuse = material.diffuse * 0.5;
vec3 ambient = materialDiffuse;
vec3 color = ambient + material.emission;
color += materialDiffuse * diffuse * czm_lightColor;
color += material.specular * specular * czm_lightColor;
return vec4(color, material.alpha);
}
`;var dO=`mat2 czm_transpose(mat2 matrix)
{
return mat2(
matrix[0][0], matrix[1][0],
matrix[0][1], matrix[1][1]);
}
mat3 czm_transpose(mat3 matrix)
{
return mat3(
matrix[0][0], matrix[1][0], matrix[2][0],
matrix[0][1], matrix[1][1], matrix[2][1],
matrix[0][2], matrix[1][2], matrix[2][2]);
}
mat4 czm_transpose(mat4 matrix)
{
return mat4(
matrix[0][0], matrix[1][0], matrix[2][0], matrix[3][0],
matrix[0][1], matrix[1][1], matrix[2][1], matrix[3][1],
matrix[0][2], matrix[1][2], matrix[2][2], matrix[3][2],
matrix[0][3], matrix[1][3], matrix[2][3], matrix[3][3]);
}
`;var hO=`float czm_unpackDepth(vec4 packedDepth)
{
return dot(packedDepth, vec4(1.0, 1.0 / 255.0, 1.0 / 65025.0, 1.0 / 16581375.0));
}
`;var mO=`float czm_unpackFloat(vec4 packedFloat)
{
packedFloat = floor(packedFloat * 255.0 + 0.5);
float sign = 1.0 - step(128.0, packedFloat[3]) * 2.0;
float exponent = 2.0 * mod(packedFloat[3], 128.0) + step(128.0, packedFloat[2]) - 127.0;
if (exponent == -127.0)
{
return 0.0;
}
float mantissa = mod(packedFloat[2], 128.0) * 65536.0 + packedFloat[1] * 256.0 + packedFloat[0] + float(0x800000);
float result = sign * exp2(exponent - 23.0) * mantissa;
return result;
}
`;var pO=`int czm_unpackUint(float packedValue) {
float rounded = czm_round(packedValue * 255.0);
return int(rounded);
}
int czm_unpackUint(vec2 packedValue) {
vec2 rounded = czm_round(packedValue * 255.0);
return int(dot(rounded, vec2(1.0, 256.0)));
}
int czm_unpackUint(vec3 packedValue) {
vec3 rounded = czm_round(packedValue * 255.0);
return int(dot(rounded, vec3(1.0, 256.0, 65536.0)));
}
int czm_unpackUint(vec4 packedValue) {
vec4 rounded = czm_round(packedValue * 255.0);
return int(dot(rounded, vec4(1.0, 256.0, 65536.0, 16777216.0)));
}
`;var _O=`float czm_valueTransform(float offset, float scale, float value) {
return scale * value + offset;
}
vec2 czm_valueTransform(vec2 offset, vec2 scale, vec2 value) {
return scale * value + offset;
}
vec3 czm_valueTransform(vec3 offset, vec3 scale, vec3 value) {
return scale * value + offset;
}
vec4 czm_valueTransform(vec4 offset, vec4 scale, vec4 value) {
return scale * value + offset;
}
mat2 czm_valueTransform(mat2 offset, mat2 scale, mat2 value) {
return matrixCompMult(scale, value) + offset;
}
mat3 czm_valueTransform(mat3 offset, mat3 scale, mat3 value) {
return matrixCompMult(scale, value) + offset;
}
mat4 czm_valueTransform(mat4 offset, mat4 scale, mat4 value) {
return matrixCompMult(scale, value) + offset;
}
`;var gO=`#ifdef LOG_DEPTH
varying float v_depthFromNearPlusOne;
#ifdef SHADOW_MAP
varying vec3 v_logPositionEC;
#endif
#endif
vec4 czm_updatePositionDepth(vec4 coords) {
#if defined(LOG_DEPTH)
#ifdef SHADOW_MAP
vec3 logPositionEC = (czm_inverseProjection * coords).xyz;
v_logPositionEC = logPositionEC;
#endif
coords.z = clamp(coords.z / coords.w, -1.0, 1.0) * coords.w;
#endif
return coords;
}
void czm_vertexLogDepth()
{
#ifdef LOG_DEPTH
v_depthFromNearPlusOne = (gl_Position.w - czm_currentFrustum.x) + 1.0;
gl_Position = czm_updatePositionDepth(gl_Position);
#endif
}
void czm_vertexLogDepth(vec4 clipCoords)
{
#ifdef LOG_DEPTH
v_depthFromNearPlusOne = (clipCoords.w - czm_currentFrustum.x) + 1.0;
czm_updatePositionDepth(clipCoords);
#endif
}
`;var yO=`vec4 czm_windowToEyeCoordinates(vec4 fragmentCoordinate)
{
float x = 2.0 * (fragmentCoordinate.x - czm_viewport.x) / czm_viewport.z - 1.0;
float y = 2.0 * (fragmentCoordinate.y - czm_viewport.y) / czm_viewport.w - 1.0;
float z = (fragmentCoordinate.z - czm_viewportTransformation[3][2]) / czm_viewportTransformation[2][2];
vec4 q = vec4(x, y, z, 1.0);
q /= fragmentCoordinate.w;
if (!(czm_inverseProjection == mat4(0.0)))
{
q = czm_inverseProjection * q;
}
else
{
float top = czm_frustumPlanes.x;
float bottom = czm_frustumPlanes.y;
float left = czm_frustumPlanes.z;
float right = czm_frustumPlanes.w;
float near = czm_currentFrustum.x;
float far = czm_currentFrustum.y;
q.x = (q.x * (right - left) + left + right) * 0.5;
q.y = (q.y * (top - bottom) + bottom + top) * 0.5;
q.z = (q.z * (near - far) - near - far) * 0.5;
q.w = 1.0;
}
return q;
}
vec4 czm_windowToEyeCoordinates(vec2 fragmentCoordinateXY, float depthOrLogDepth)
{
#ifdef LOG_DEPTH
float near = czm_currentFrustum.x;
float far = czm_currentFrustum.y;
float log2Depth = depthOrLogDepth * czm_log2FarDepthFromNearPlusOne;
float depthFromNear = pow(2.0, log2Depth) - 1.0;
float depthFromCamera = depthFromNear + near;
vec4 windowCoord = vec4(fragmentCoordinateXY, far * (1.0 - near / depthFromCamera) / (far - near), 1.0);
vec4 eyeCoordinate = czm_windowToEyeCoordinates(windowCoord);
eyeCoordinate.w = 1.0 / depthFromCamera;
return eyeCoordinate;
#else
vec4 windowCoord = vec4(fragmentCoordinateXY, depthOrLogDepth, 1.0);
vec4 eyeCoordinate = czm_windowToEyeCoordinates(windowCoord);
#endif
return eyeCoordinate;
}
`;var AO=`#if defined(GL_EXT_frag_depth) && !defined(LOG_DEPTH)
varying float v_WindowZ;
#endif
void czm_writeDepthClamp()
{
#if defined(GL_EXT_frag_depth) && !defined(LOG_DEPTH)
gl_FragDepthEXT = clamp(v_WindowZ * gl_FragCoord.w, 0.0, 1.0);
#endif
}
`;var CO=`#ifdef LOG_DEPTH
varying float v_depthFromNearPlusOne;
#ifdef POLYGON_OFFSET
uniform vec2 u_polygonOffset;
#ifdef GL_OES_standard_derivatives
#extension GL_OES_standard_derivatives : enable
#endif
#endif
#endif
void czm_writeLogDepth(float depth)
{
#if defined(GL_EXT_frag_depth) && defined(LOG_DEPTH)
if (depth <= 0.9999999 || depth > czm_farDepthFromNearPlusOne) {
discard;
}
#ifdef POLYGON_OFFSET
float factor = u_polygonOffset[0];
float units = u_polygonOffset[1];
#ifdef GL_OES_standard_derivatives
if (factor != 0.0) {
float x = dFdx(depth);
float y = dFdy(depth);
float m = sqrt(x * x + y * y);
depth += m * factor;
}
#endif
#endif
gl_FragDepthEXT = log2(depth) * czm_oneOverLog2FarDepthFromNearPlusOne;
#ifdef POLYGON_OFFSET
gl_FragDepthEXT += czm_epsilon7 * units;
#endif
#endif
}
void czm_writeLogDepth() {
#ifdef LOG_DEPTH
czm_writeLogDepth(v_depthFromNearPlusOne);
#endif
}
`;var xO=`float czm_writeNonPerspective(float value, float w) {
return value * w;
}
vec2 czm_writeNonPerspective(vec2 value, float w) {
return value * w;
}
vec3 czm_writeNonPerspective(vec3 value, float w) {
return value * w;
}
vec4 czm_writeNonPerspective(vec4 value, float w) {
return value * w;
}
`;var TO=`vec3 czm_XYZToRGB(vec3 Yxy)
{
const mat3 XYZ2RGB = mat3( 3.2405, -0.9693,  0.0556,
-1.5371,  1.8760, -0.2040,
-0.4985,  0.0416,  1.0572);
vec3 xyz;
xyz.r = Yxy.r * Yxy.g / Yxy.b;
xyz.g = Yxy.r;
xyz.b = Yxy.r * (1.0 - Yxy.g - Yxy.b) / Yxy.b;
return XYZ2RGB * xyz;
}
`;var DC={czm_degreesPerRadian:tI,czm_depthRange:nI,czm_epsilon1:iI,czm_epsilon2:oI,czm_epsilon3:rI,czm_epsilon4:sI,czm_epsilon5:aI,czm_epsilon6:cI,czm_epsilon7:lI,czm_infinity:uI,czm_oneOverPi:fI,czm_oneOverTwoPi:dI,czm_passCesium3DTile:hI,czm_passCesium3DTileClassification:mI,czm_passCesium3DTileClassificationIgnoreShow:pI,czm_passClassification:_I,czm_passCompute:gI,czm_passEnvironment:yI,czm_passGlobe:AI,czm_passOpaque:CI,czm_passOverlay:xI,czm_passTerrainClassification:TI,czm_passTranslucent:EI,czm_pi:bI,czm_piOverFour:SI,czm_piOverSix:wI,czm_piOverThree:DI,czm_piOverTwo:vI,czm_radiansPerDegree:PI,czm_sceneMode2D:II,czm_sceneMode3D:BI,czm_sceneModeColumbusView:OI,czm_sceneModeMorphing:RI,czm_solarRadius:MI,czm_threePiOver2:LI,czm_twoPi:FI,czm_webMercatorMaxLatitude:NI,czm_depthRangeStruct:VI,czm_geometryInput:kI,czm_material:UI,czm_materialInput:zI,czm_modelMaterial:HI,czm_modelVertexOutput:GI,czm_pbrParameters:WI,czm_ray:jI,czm_raySegment:qI,czm_shadowParameters:YI,czm_acesTonemapping:XI,czm_alphaWeight:KI,czm_antialias:JI,czm_approximateSphericalCoordinates:ZI,czm_backFacing:QI,czm_branchFreeTernary:$I,czm_cascadeColor:eB,czm_cascadeDistance:tB,czm_cascadeMatrix:nB,czm_cascadeWeights:iB,czm_columbusViewMorph:oB,czm_computePosition:rB,czm_cosineAndSine:sB,czm_decompressTextureCoordinates:aB,czm_defaultPbrMaterial:cB,czm_depthClamp:lB,czm_eastNorthUpToEyeCoordinates:uB,czm_ellipsoidContainsPoint:fB,czm_ellipsoidWgs84TextureCoordinates:dB,czm_equalsEpsilon:hB,czm_eyeOffset:mB,czm_eyeToWindowCoordinates:pB,czm_fastApproximateAtan:_B,czm_fog:gB,czm_gammaCorrect:yB,czm_geodeticSurfaceNormal:AB,czm_getDefaultMaterial:CB,czm_getLambertDiffuse:xB,czm_getSpecular:TB,czm_getWaterNoise:EB,czm_HSBToRGB:bB,czm_HSLToRGB:SB,czm_hue:wB,czm_inverseGamma:DB,czm_isEmpty:vB,czm_isFull:PB,czm_latitudeToWebMercatorFraction:IB,czm_linearToSrgb:BB,czm_lineDistance:OB,czm_luminance:RB,czm_metersPerPixel:MB,czm_modelToWindowCoordinates:LB,czm_multiplyWithColorBalance:FB,czm_nearFarScalar:NB,czm_octDecode:VB,czm_packDepth:kB,czm_pbrLighting:UB,czm_pbrMetallicRoughnessMaterial:zB,czm_pbrSpecularGlossinessMaterial:HB,czm_phong:GB,czm_planeDistance:WB,czm_pointAlongRay:jB,czm_rayEllipsoidIntersectionInterval:qB,czm_raySphereIntersectionInterval:YB,czm_readDepth:XB,czm_readNonPerspective:KB,czm_reverseLogDepth:JB,czm_RGBToHSB:ZB,czm_RGBToHSL:QB,czm_RGBToXYZ:$B,czm_round:eO,czm_sampleOctahedralProjection:tO,czm_saturation:nO,czm_shadowDepthCompare:iO,czm_shadowVisibility:oO,czm_signNotZero:rO,czm_sphericalHarmonics:sO,czm_srgbToLinear:aO,czm_tangentToEyeSpaceMatrix:cO,czm_transformPlane:lO,czm_translateRelativeToEye:uO,czm_translucentPhong:fO,czm_transpose:dO,czm_unpackDepth:hO,czm_unpackFloat:mO,czm_unpackUint:pO,czm_valueTransform:_O,czm_vertexLogDepth:gO,czm_windowToEyeCoordinates:yO,czm_writeDepthClamp:AO,czm_writeLogDepth:CO,czm_writeNonPerspective:xO,czm_XYZToRGB:TO};function RJ(t){return t=t.replace(/\/\/.*/g,""),t.replace(/\/\*\*[\s\S]*?\*\//gm,function(n){let i=n.match(/\n/gm).length,o="";for(let r=0;r<i;++r)o+=`
`;return o})}function MJ(t,n,i){let o;for(let r=0;r<i.length;++r)i[r].name===t&&(o=i[r]);return f(o)||(n=RJ(n),o={name:t,glslSource:n,dependsOn:[],requiredBy:[],evaluated:!1},i.push(o)),o}function LJ(t,n){if(t.evaluated)return;t.evaluated=!0;let i=t.glslSource.match(/\bczm_[a-zA-Z0-9_]*/g);f(i)&&i!==null&&(i=i.filter(function(o,r){return i.indexOf(o)===r}),i.forEach(function(o){if(o!==t.name&&us._czmBuiltinsAndUniforms.hasOwnProperty(o)){let r=MJ(o,us._czmBuiltinsAndUniforms[o],n);t.dependsOn.push(r),r.requiredBy.push(t),LJ(r,n)}}))}function hSe(t){let n=[],i=[];for(;t.length>0;){let r=t.pop();i.push(r),r.requiredBy.length===0&&n.push(r)}for(;n.length>0;){let r=n.shift();t.push(r);for(let s=0;s<r.dependsOn.length;++s){let a=r.dependsOn[s],c=a.requiredBy.indexOf(r);a.requiredBy.splice(c,1),a.requiredBy.length===0&&n.push(a)}}let o=[];for(let r=0;r<i.length;++r)i[r].requiredBy.length!==0&&o.push(i[r])}function mSe(t){let n=[],i=MJ("main",t,n);LJ(i,n),hSe(n);let o="";for(let r=n.length-1;r>=0;--r)o=`${o+n[r].glslSource}
`;return o.replace(i.glslSource,"")}function FJ(t,n,i){let o,r,s="",a=t.sources;if(f(a))for(o=0,r=a.length;o<r;++o)s+=`
#line 0
${a[o]}`;s=RJ(s);let c;s=s.replace(/#version\s+(.*?)\n/gm,function(y,p){return c=p,`
`});let l=[];s=s.replace(/#extension.*\n/gm,function(y){return l.push(y),`
`}),s=s.replace(/precision\s(lowp|mediump|highp)\s(float|int);/,"");let u=t.pickColorQualifier;f(u)&&(s=us.createPickFragmentShaderSource(s,u));let d="";f(c)&&(d=`#version ${c}
`);let h=l.length;for(o=0;o<h;o++)d+=l[o];n&&(d+=`#ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    precision highp int;
#else
    precision mediump float;
    precision mediump int;
    #define highp mediump
#endif

`);let _=t.defines;if(f(_))for(o=0,r=_.length;o<r;++o){let y=_[o];y.length!==0&&(d+=`#define ${y}
`)}return i.webgl2&&(d+=`#define OUTPUT_DECLARATION

`),i.textureFloatLinear&&(d+=`#define OES_texture_float_linear

`),i.floatingPointTexture&&(d+=`#define OES_texture_float

`),t.includeBuiltIns&&(d+=mSe(s)),d+=`
#line 0
`,d+=s,i.webgl2&&(d=eI(d,n,!0)),d}function us(t){t=A(t,A.EMPTY_OBJECT);let n=t.pickColorQualifier;this.defines=f(t.defines)?t.defines.slice(0):[],this.sources=f(t.sources)?t.sources.slice(0):[],this.pickColorQualifier=n,this.includeBuiltIns=A(t.includeBuiltIns,!0)}us.prototype.clone=function(){return new us({sources:this.sources,defines:this.defines,pickColorQualifier:this.pickColorQualifier,includeBuiltIns:this.includeBuiltIns})};us.replaceMain=function(t,n){return n=`void ${n}()`,t.replace(/void\s+main\s*\(\s*(?:void)?\s*\)/g,n)};us.prototype.getCacheKey=function(){let n=this.defines.slice().sort().join(","),i=this.pickColorQualifier,o=this.includeBuiltIns,r=this.sources.join(`
`);return`${n}:${i}:${o}:${r}`};us.prototype.createCombinedVertexShader=function(t){return FJ(this,!1,t)};us.prototype.createCombinedFragmentShader=function(t){return FJ(this,!0,t)};us._czmBuiltinsAndUniforms={};for(let t in DC)DC.hasOwnProperty(t)&&(us._czmBuiltinsAndUniforms[t]=DC[t]);for(let t in Hp)if(Hp.hasOwnProperty(t)){let n=Hp[t];typeof n.getDeclaration=="function"&&(us._czmBuiltinsAndUniforms[t]=n.getDeclaration(t))}us.createPickVertexShaderSource=function(t){return`${us.replaceMain(t,"czm_old_main")}
attribute vec4 pickColor; 
varying vec4 czm_pickColor; 
void main() 
{ 
    czm_old_main(); 
    czm_pickColor = pickColor; 
}`};us.createPickFragmentShaderSource=function(t,n){let i=us.replaceMain(t,"czm_old_main"),o=`${n} vec4 czm_pickColor; 
void main() 
{ 
    czm_old_main(); 
    if (gl_FragColor.a == 0.0) { 
       discard; 
    } 
    gl_FragColor = czm_pickColor; 
}`;return`${i}
${o}`};function pSe(t,n){let i=t.defines,o=i.length;for(let r=0;r<o;++r)if(i[r]===n)return!0;return!1}function NJ(t,n){let i=t.sources,o=i.length;for(let r=0;r<o;++r)if(i[r].indexOf(n)!==-1)return!0;return!1}function VJ(t,n){let i=n.length;for(let o=0;o<i;++o){let r=n[o];if(NJ(t,r))return r}}var _Se=["v_normalEC","v_normal"];us.findNormalVarying=function(t){return NJ(t,"#ifdef HAS_NORMALS")?pSe(t,"HAS_NORMALS")?"v_normalEC":void 0:VJ(t,_Se)};var gSe=["v_positionEC"];us.findPositionVarying=function(t){return VJ(t,gSe)};var ze=us;function fu(t){t=A(t,A.EMPTY_OBJECT);let n=t.context._gl,i=t.bufferTarget,o=t.typedArray,r=t.sizeInBytes,s=t.usage,a=f(o);a&&(r=o.byteLength);let c=n.createBuffer();n.bindBuffer(i,c),n.bufferData(i,a?o:r,s),n.bindBuffer(i,null),this._id=Bn(),this._gl=n,this._webgl2=t.context._webgl2,this._bufferTarget=i,this._sizeInBytes=r,this._usage=s,this._buffer=c,this.vertexArrayDestroyable=!0}fu.createVertexBuffer=function(t){return new fu({context:t.context,bufferTarget:ee.ARRAY_BUFFER,typedArray:t.typedArray,sizeInBytes:t.sizeInBytes,usage:t.usage})};fu.createIndexBuffer=function(t){let n=t.context,i=t.indexDatatype,o=Ne.getSizeInBytes(i),r=new fu({context:n,bufferTarget:ee.ELEMENT_ARRAY_BUFFER,typedArray:t.typedArray,sizeInBytes:t.sizeInBytes,usage:t.usage}),s=r.sizeInBytes/o;return Object.defineProperties(r,{indexDatatype:{get:function(){return i}},bytesPerIndex:{get:function(){return o}},numberOfIndices:{get:function(){return s}}}),r};Object.defineProperties(fu.prototype,{sizeInBytes:{get:function(){return this._sizeInBytes}},usage:{get:function(){return this._usage}}});fu.prototype._getBuffer=function(){return this._buffer};fu.prototype.copyFromArrayView=function(t,n){n=A(n,0);let i=this._gl,o=this._bufferTarget;i.bindBuffer(o,this._buffer),i.bufferSubData(o,n,t),i.bindBuffer(o,null)};fu.prototype.copyFromBuffer=function(t,n,i,o){let r=ee.COPY_READ_BUFFER,s=ee.COPY_WRITE_BUFFER,a=this._gl;a.bindBuffer(s,this._buffer),a.bindBuffer(r,t._buffer),a.copyBufferSubData(r,s,n,i,o),a.bindBuffer(s,null),a.bindBuffer(r,null)};fu.prototype.getBufferData=function(t,n,i,o){n=A(n,0),i=A(i,0);let r=this._gl,s=ee.COPY_READ_BUFFER;r.bindBuffer(s,this._buffer),r.getBufferSubData(s,n,t,i,o),r.bindBuffer(s,null)};fu.prototype.isDestroyed=function(){return!1};fu.prototype.destroy=function(){return this._gl.deleteBuffer(this._buffer),ue(this)};var ut=fu;function ySe(t,n,i,o){let r=f(n.vertexBuffer),s=f(n.value),a=n.value?n.value.length:n.componentsPerAttribute,c={index:A(n.index,i),enabled:A(n.enabled,!0),vertexBuffer:n.vertexBuffer,value:s?n.value.slice(0):void 0,componentsPerAttribute:a,componentDatatype:A(n.componentDatatype,J.FLOAT),normalize:A(n.normalize,!1),offsetInBytes:A(n.offsetInBytes,0),strideInBytes:A(n.strideInBytes,0),instanceDivisor:A(n.instanceDivisor,0)};if(r)c.vertexAttrib=function(l){let u=this.index;l.bindBuffer(l.ARRAY_BUFFER,this.vertexBuffer._getBuffer()),l.vertexAttribPointer(u,this.componentsPerAttribute,this.componentDatatype,this.normalize,this.strideInBytes,this.offsetInBytes),l.enableVertexAttribArray(u),this.instanceDivisor>0&&(o.glVertexAttribDivisor(u,this.instanceDivisor),o._vertexAttribDivisors[u]=this.instanceDivisor,o._previousDrawInstanced=!0)},c.disableVertexAttribArray=function(l){l.disableVertexAttribArray(this.index),this.instanceDivisor>0&&o.glVertexAttribDivisor(i,0)};else{switch(c.componentsPerAttribute){case 1:c.vertexAttrib=function(l){l.vertexAttrib1fv(this.index,this.value)};break;case 2:c.vertexAttrib=function(l){l.vertexAttrib2fv(this.index,this.value)};break;case 3:c.vertexAttrib=function(l){l.vertexAttrib3fv(this.index,this.value)};break;case 4:c.vertexAttrib=function(l){l.vertexAttrib4fv(this.index,this.value)};break}c.disableVertexAttribArray=function(l){}}t.push(c)}function UJ(t,n,i){for(let o=0;o<n.length;++o){let r=n[o];r.enabled&&r.vertexAttrib(t)}f(i)&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,i._getBuffer())}function hm(t){t=A(t,A.EMPTY_OBJECT);let n=t.context,i=n._gl,o=t.attributes,r=t.indexBuffer,s,a=[],c=1,l=!1,u=!1,d=o.length;for(s=0;s<d;++s)ySe(a,o[s],s,n);for(d=a.length,s=0;s<d;++s){let _=a[s];if(f(_.vertexBuffer)&&_.instanceDivisor===0){let y=_.strideInBytes||_.componentsPerAttribute*J.getSizeInBytes(_.componentDatatype);c=_.vertexBuffer.sizeInBytes/y;break}}for(s=0;s<d;++s)a[s].instanceDivisor>0&&(l=!0),f(a[s].value)&&(u=!0);let h;n.vertexArrayObject&&(h=n.glCreateVertexArray(),n.glBindVertexArray(h),UJ(i,a,r),n.glBindVertexArray(null)),this._numberOfVertices=c,this._hasInstancedAttributes=l,this._hasConstantAttributes=u,this._context=n,this._gl=i,this._vao=h,this._attributes=a,this._indexBuffer=r}function kJ(t){return t.values.length/t.componentsPerAttribute}function ASe(t){return J.getSizeInBytes(t.componentDatatype)*t.componentsPerAttribute}function CSe(t){let n,i,o,r=[];for(i in t)t.hasOwnProperty(i)&&f(t[i])&&f(t[i].values)&&(r.push(i),t[i].componentDatatype===J.DOUBLE&&(t[i].componentDatatype=J.FLOAT,t[i].values=J.createTypedArray(J.FLOAT,t[i].values)));let s,a=r.length;if(a>0)for(s=kJ(t[r[0]]),n=1;n<a;++n){let u=kJ(t[r[n]]);if(u!==s)throw new he(`Each attribute list must have the same number of vertices.  Attribute ${r[n]} has a different number of vertices (${u.toString()}) than attribute ${r[0]} (${s.toString()}).`)}r.sort(function(u,d){return J.getSizeInBytes(t[d].componentDatatype)-J.getSizeInBytes(t[u].componentDatatype)});let c=0,l={};for(n=0;n<a;++n)i=r[n],o=t[i],l[i]=c,c+=ASe(o);if(c>0){let u=J.getSizeInBytes(t[r[0]].componentDatatype),d=c%u;d!==0&&(c+=u-d);let h=s*c,_=new ArrayBuffer(h),y={};for(n=0;n<a;++n){i=r[n];let p=J.getSizeInBytes(t[i].componentDatatype);y[i]={pointer:J.createTypedArray(t[i].componentDatatype,_),index:l[i]/p,strideInComponentType:c/p}}for(n=0;n<s;++n)for(let p=0;p<a;++p){i=r[p],o=t[i];let C=o.values,x=y[i],T=x.pointer,E=o.componentsPerAttribute;for(let S=0;S<E;++S)T[x.index+S]=C[n*E+S];x.index+=x.strideInComponentType}return{buffer:_,offsetsInBytes:l,vertexSizeInBytes:c}}}hm.fromGeometry=function(t){t=A(t,A.EMPTY_OBJECT);let n=t.context,i=A(t.geometry,A.EMPTY_OBJECT),o=A(t.bufferUsage,Fe.DYNAMIC_DRAW),r=A(t.attributeLocations,A.EMPTY_OBJECT),s=A(t.interleave,!1),a=t.vertexArrayAttributes,c,l,u,d=f(a)?a:[],h=i.attributes;if(s){let p=CSe(h);if(f(p)){u=ut.createVertexBuffer({context:n,typedArray:p.buffer,usage:o});let C=p.offsetsInBytes,x=p.vertexSizeInBytes;for(c in h)h.hasOwnProperty(c)&&f(h[c])&&(l=h[c],f(l.values)?d.push({index:r[c],vertexBuffer:u,componentDatatype:l.componentDatatype,componentsPerAttribute:l.componentsPerAttribute,normalize:l.normalize,offsetInBytes:C[c],strideInBytes:x}):d.push({index:r[c],value:l.value,componentDatatype:l.componentDatatype,normalize:l.normalize}))}}else for(c in h)if(h.hasOwnProperty(c)&&f(h[c])){l=h[c];let p=l.componentDatatype;p===J.DOUBLE&&(p=J.FLOAT),u=void 0,f(l.values)&&(u=ut.createVertexBuffer({context:n,typedArray:J.createTypedArray(p,l.values),usage:o})),d.push({index:r[c],vertexBuffer:u,value:l.value,componentDatatype:p,componentsPerAttribute:l.componentsPerAttribute,normalize:l.normalize})}let _,y=i.indices;return f(y)&&(at.computeNumberOfVertices(i)>=B.SIXTY_FOUR_KILOBYTES&&n.elementIndexUint?_=ut.createIndexBuffer({context:n,typedArray:new Uint32Array(y),usage:o,indexDatatype:Ne.UNSIGNED_INT}):_=ut.createIndexBuffer({context:n,typedArray:new Uint16Array(y),usage:o,indexDatatype:Ne.UNSIGNED_SHORT})),new hm({context:n,attributes:d,indexBuffer:_})};Object.defineProperties(hm.prototype,{numberOfAttributes:{get:function(){return this._attributes.length}},numberOfVertices:{get:function(){return this._numberOfVertices}},indexBuffer:{get:function(){return this._indexBuffer}}});hm.prototype.getAttribute=function(t){return this._attributes[t]};function xSe(t){let n=t._context,i=t._hasInstancedAttributes;if(!i&&!n._previousDrawInstanced)return;n._previousDrawInstanced=i;let o=n._vertexAttribDivisors,r=t._attributes,s=Ut.maximumVertexAttributes,a;if(i){let c=r.length;for(a=0;a<c;++a){let l=r[a];if(l.enabled){let u=l.instanceDivisor,d=l.index;u!==o[d]&&(n.glVertexAttribDivisor(d,u),o[d]=u)}}}else for(a=0;a<s;++a)o[a]>0&&(n.glVertexAttribDivisor(a,0),o[a]=0)}function TSe(t,n){let i=t._attributes,o=i.length;for(let r=0;r<o;++r){let s=i[r];s.enabled&&f(s.value)&&s.vertexAttrib(n)}}hm.prototype._bind=function(){f(this._vao)?(this._context.glBindVertexArray(this._vao),this._context.instancedArrays&&xSe(this),this._hasConstantAttributes&&TSe(this,this._gl)):UJ(this._gl,this._attributes,this._indexBuffer)};hm.prototype._unBind=function(){if(f(this._vao))this._context.glBindVertexArray(null);else{let t=this._attributes,n=this._gl;for(let i=0;i<t.length;++i){let o=t[i];o.enabled&&o.disableVertexAttribArray(n)}this._indexBuffer&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,null)}};hm.prototype.isDestroyed=function(){return!1};hm.prototype.destroy=function(){let t=this._attributes;for(let i=0;i<t.length;++i){let o=t[i].vertexBuffer;f(o)&&!o.isDestroyed()&&o.vertexArrayDestroyable&&o.destroy()}let n=this._indexBuffer;return f(n)&&!n.isDestroyed()&&n.vertexArrayDestroyable&&n.destroy(),f(this._vao)&&this._context.glDeleteVertexArray(this._vao),ue(this)};var $n=hm;var EO=`uniform samplerCube u_cubeMap;
varying vec3 v_texCoord;
void main()
{
vec4 color = textureCube(u_cubeMap, normalize(v_texCoord));
gl_FragColor = vec4(czm_gammaCorrect(color).rgb, czm_morphTime);
}
`;var bO=`attribute vec3 position;
uniform mat3 u_rotateMatrix;
varying vec3 v_texCoord;
void main()
{
vec3 p = czm_viewRotation * u_rotateMatrix * (czm_temeToPseudoFixed * (czm_entireFrustum.y * position));
gl_Position = czm_projection * vec4(p, 1.0);
v_texCoord = position.xyz;
}
`;var SO={MORPHING:0,COLUMBUS_VIEW:1,SCENE2D:2,SCENE3D:3};SO.getMorphTime=function(t){return t===SO.SCENE3D?1:t===SO.MORPHING?void 0:0};var ne=Object.freeze(SO);function wO(t){this.sources=t.sources,this._sources=void 0,this.nearGround=t.nearGround,this.mirrorEnable=A(t.mirrorEnable,!0),this.show=A(t.show,!0),this._command=new et({modelMatrix:N.clone(N.IDENTITY),owner:this}),this._cubeMap=void 0,this._attributeLocations=void 0,this._useHdr=void 0}wO.prototype.update=function(t,n){let i=this;if(!this.show||t.mode!==ne.SCENE3D&&t.mode!==ne.MORPHING||!t.passes.render)return;let o=t.context;if(this._sources!==this.sources){this._sources=this.sources;let s=this.sources;typeof s.positiveX=="string"?Q1(o,this._sources).then(function(a){i._cubeMap=i._cubeMap&&i._cubeMap.destroy(),i._cubeMap=a}):(this._cubeMap=this._cubeMap&&this._cubeMap.destroy(),this._cubeMap=new tc({context:o,source:s}))}let r=this._command;if(!f(r.vertexArray)){r.uniformMap={u_cubeMap:function(){return i._cubeMap},u_rotateMatrix:function(){return i.nearGround?(r.modelMatrix=vt.eastNorthUpToFixedFrame(t.camera._positionWC),N.getMatrix3(r.modelMatrix,new $)):$.IDENTITY}};let s=Cl.createGeometry(Cl.fromDimensions({dimensions:new m(2,2,2),vertexFormat:De.POSITION_ONLY})),a=this._attributeLocations=Fn.createAttributeLocations(s);r.vertexArray=$n.fromGeometry({context:o,geometry:s,attributeLocations:a,bufferUsage:Fe.STATIC_DRAW}),r.renderState=Ve.fromCache({blending:ln.ALPHA_BLEND})}if(!f(r.shaderProgram)||this._useHdr!==n){let s=new ze({defines:[n?"HDR":""],sources:[EO]});r.shaderProgram=qt.fromCache({context:o,vertexShaderSource:bO,fragmentShaderSource:s,attributeLocations:this._attributeLocations}),this._useHdr=n}if(!!f(this._cubeMap))return r};wO.prototype.isDestroyed=function(){return!1};wO.prototype.destroy=function(){let t=this._command;return t.vertexArray=t.vertexArray&&t.vertexArray.destroy(),t.shaderProgram=t.shaderProgram&&t.shaderProgram.destroy(),this._cubeMap=this._cubeMap&&this._cubeMap.destroy(),ue(this)};var vC=wO;var HJ=yo(zJ(),1);var ESe=0,v8={};function mm(t,n){let i,o=t;f(v8[o])?i=v8[o]:(i=ESe++,v8[o]=i),n=A(n,!1),this._id=i,this._html=t,this._showOnScreen=n,this._element=void 0}Object.defineProperties(mm.prototype,{html:{get:function(){return this._html}},id:{get:function(){return this._id}},showOnScreen:{get:function(){return this._showOnScreen},set:function(t){this._showOnScreen=t}},element:{get:function(){if(!f(this._element)){let t=HJ.default.sanitize(this._html),n=document.createElement("div");n._creditId=this._id,n.style.display="inline",n.innerHTML=t;let i=n.querySelectorAll("a");for(let o=0;o<i.length;o++)i[o].setAttribute("target","_blank");this._element=n}return this._element}}});mm.equals=function(t,n){return t===n||f(t)&&f(n)&&t._id===n._id&&t._showOnScreen===n._showOnScreen};mm.prototype.equals=function(t){return mm.equals(this,t)};mm.getIonCredit=function(t){let n=f(t.collapsible)&&!t.collapsible,i=new mm(t.html,n);return i._isIon=i.html.indexOf("ion-credit.png")!==-1,i};mm.clone=function(t){if(f(t))return new mm(t.html,t.showOnScreen)};var Jt=mm;var bSe={ENVIRONMENT:0,COMPUTE:1,GLOBE:2,TERRAIN_CLASSIFICATION:3,CESIUM_3D_TILE:4,CESIUM_3D_TILE_CLASSIFICATION:5,CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW:6,OPAQUE:7,TRANSLUCENT:8,OVERLAY:9,NUMBER_OF_PASSES:10},Te=Object.freeze(bSe);function PC(t,n){this._distance=n,this._normal=new GJ(t,this),this.onChangeCallback=void 0,this.index=-1}Object.defineProperties(PC.prototype,{distance:{get:function(){return this._distance},set:function(t){f(this.onChangeCallback)&&t!==this._distance&&this.onChangeCallback(this.index),this._distance=t}},normal:{get:function(){return this._normal},set:function(t){f(this.onChangeCallback)&&!m.equals(this._normal._cartesian3,t)&&this.onChangeCallback(this.index),m.clone(t,this._normal._cartesian3)}}});PC.fromPlane=function(t,n){return f(n)?(n.normal=t.normal,n.distance=t.distance):n=new PC(t.normal,t.distance),n};PC.clone=function(t,n){return f(n)?(n.normal=t.normal,n.distance=t.distance,n):new PC(t.normal,t.distance)};function GJ(t,n){this._clippingPlane=n,this._cartesian3=m.clone(t)}Object.defineProperties(GJ.prototype,{x:{get:function(){return this._cartesian3.x},set:function(t){f(this._clippingPlane.onChangeCallback)&&t!==this._cartesian3.x&&this._clippingPlane.onChangeCallback(this._clippingPlane.index),this._cartesian3.x=t}},y:{get:function(){return this._cartesian3.y},set:function(t){f(this._clippingPlane.onChangeCallback)&&t!==this._cartesian3.y&&this._clippingPlane.onChangeCallback(this._clippingPlane.index),this._cartesian3.y=t}},z:{get:function(){return this._cartesian3.z},set:function(t){f(this._clippingPlane.onChangeCallback)&&t!==this._cartesian3.z&&this._clippingPlane.onChangeCallback(this._clippingPlane.index),this._cartesian3.z=t}}});var IC=PC;function xa(t){t=A(t,A.EMPTY_OBJECT),this._planes=[],this._dirtyIndex=-1,this._multipleDirtyPlanes=!1,this._enabled=A(t.enabled,!0),this.modelMatrix=N.clone(A(t.modelMatrix,N.IDENTITY)),this.edgeColor=z.clone(A(t.edgeColor,z.WHITE)),this.edgeWidth=A(t.edgeWidth,0),this.planeAdded=new Ae,this.planeRemoved=new Ae,this._owner=void 0;let n=A(t.unionClippingRegions,!1);this._unionClippingRegions=n,this._testIntersection=n?XJ:KJ,this._uint8View=void 0,this._float32View=void 0,this._clippingPlanesTexture=void 0;let i=t.planes;if(f(i)){let o=i.length;for(let r=0;r<o;++r)this.add(i[r])}}function XJ(t){return t===jt.OUTSIDE}function KJ(t){return t===jt.INSIDE}Object.defineProperties(xa.prototype,{length:{get:function(){return this._planes.length}},unionClippingRegions:{get:function(){return this._unionClippingRegions},set:function(t){this._unionClippingRegions!==t&&(this._unionClippingRegions=t,this._testIntersection=t?XJ:KJ)}},enabled:{get:function(){return this._enabled},set:function(t){this._enabled!==t&&(this._enabled=t)}},texture:{get:function(){return this._clippingPlanesTexture}},owner:{get:function(){return this._owner}},clippingPlanesState:{get:function(){return this._unionClippingRegions?this._planes.length:-this._planes.length}}});function WJ(t,n){t._multipleDirtyPlanes=t._multipleDirtyPlanes||t._dirtyIndex!==-1&&t._dirtyIndex!==n,t._dirtyIndex=n}xa.prototype.add=function(t){let n=this._planes.length,i=this;t.onChangeCallback=function(o){WJ(i,o)},t.index=n,WJ(this,n),this._planes.push(t),this.planeAdded.raiseEvent(t,n)};xa.prototype.get=function(t){return this._planes[t]};function JJ(t,n){let i=t.length;for(let o=0;o<i;++o)if(rn.equals(t[o],n))return o;return-1}xa.prototype.contains=function(t){return JJ(this._planes,t)!==-1};xa.prototype.remove=function(t){let n=this._planes,i=JJ(n,t);if(i===-1)return!1;t instanceof IC&&(t.onChangeCallback=void 0,t.index=-1);let o=n.length-1;for(let r=i;r<o;++r){let s=n[r+1];n[r]=s,s instanceof IC&&(s.index=r)}return this._multipleDirtyPlanes=!0,n.length=o,this.planeRemoved.raiseEvent(t,i),!0};xa.prototype.removeAll=function(){let t=this._planes,n=t.length;for(let i=0;i<n;++i){let o=t[i];o instanceof IC&&(o.onChangeCallback=void 0,o.index=-1),this.planeRemoved.raiseEvent(o,i)}this._multipleDirtyPlanes=!0,this._planes=[]};var SSe=new se,wSe=new se;function jJ(t,n,i){let o=t._uint8View,r=t._planes,s=0;for(let a=n;a<i;++a){let c=r[a],l=zn.octEncodeToCartesian4(c.normal,wSe);o[s]=l.x,o[s+1]=l.y,o[s+2]=l.z,o[s+3]=l.w;let u=se.packFloat(c.distance,SSe);o[s+4]=u.x,o[s+5]=u.y,o[s+6]=u.z,o[s+7]=u.w,s+=8}}function qJ(t,n,i){let o=t._float32View,r=t._planes,s=0;for(let a=n;a<i;++a){let c=r[a],l=c.normal;o[s]=l.x,o[s+1]=l.y,o[s+2]=l.z,o[s+3]=c.distance,s+=4}}function ZJ(t,n){let i=Ut.maximumTextureSize;return n.x=Math.min(t,i),n.y=Math.ceil(t/n.x),n}var DSe=new W;xa.prototype.update=function(t){let n=this._clippingPlanesTexture,i=t.context,o=xa.useFloatTexture(i),r=o?this.length:this.length*2;if(f(n)){let a=n.width*n.height;(a<r||r<.25*a)&&(n.destroy(),n=void 0,this._clippingPlanesTexture=void 0)}if(this.length===0)return;if(!f(n)){let a=ZJ(r,DSe);a.y*=2,o?(n=new St({context:i,width:a.x,height:a.y,pixelFormat:st.RGBA,pixelDatatype:je.FLOAT,sampler:pn.NEAREST,flipY:!1}),this._float32View=new Float32Array(a.x*a.y*4)):(n=new St({context:i,width:a.x,height:a.y,pixelFormat:st.RGBA,pixelDatatype:je.UNSIGNED_BYTE,sampler:pn.NEAREST,flipY:!1}),this._uint8View=new Uint8Array(a.x*a.y*4)),this._clippingPlanesTexture=n,this._multipleDirtyPlanes=!0}let s=this._dirtyIndex;if(!(!this._multipleDirtyPlanes&&s===-1)){if(this._multipleDirtyPlanes)o?(qJ(this,0,this._planes.length),n.copyFrom({source:{width:n.width,height:n.height,arrayBufferView:this._float32View}})):(jJ(this,0,this._planes.length),n.copyFrom({source:{width:n.width,height:n.height,arrayBufferView:this._uint8View}}));else{let a=0,c=0;o?(c=Math.floor(s/n.width),a=Math.floor(s-c*n.width),qJ(this,s,s+1),n.copyFrom({source:{width:1,height:1,arrayBufferView:this._float32View},xOffset:a,yOffset:c})):(c=Math.floor(s*2/n.width),a=Math.floor(s*2-c*n.width),jJ(this,s,s+1),n.copyFrom({source:{width:2,height:1,arrayBufferView:this._uint8View},xOffset:a,yOffset:c}))}this._multipleDirtyPlanes=!1,this._dirtyIndex=-1}};var vSe=new N,YJ=new rn(m.UNIT_X,0);xa.prototype.computeIntersectionWithBoundingVolume=function(t,n){let i=this._planes,o=i.length,r=this.modelMatrix;f(n)&&(r=N.multiply(n,r,vSe));let s=jt.INSIDE;!this.unionClippingRegions&&o>0&&(s=jt.OUTSIDE);for(let a=0;a<o;++a){let c=i[a];rn.transform(c,r,YJ);let l=t.intersectPlane(YJ);if(l===jt.INTERSECTING)s=l;else if(this._testIntersection(l))return l}return s};xa.setOwner=function(t,n,i){t!==n[i]&&(n[i]=n[i]&&n[i].destroy(),f(t)&&(t._owner=n,n[i]=t))};xa.useFloatTexture=function(t){return t.floatingPointTexture};xa.getTextureResolution=function(t,n,i){let o=t.texture;if(f(o))return i.x=o.width,i.y=o.height,i;let r=xa.useFloatTexture(n)?t.length:t.length*2,s=ZJ(r,i);return s.y*=2,s};xa.prototype.isDestroyed=function(){return!1};xa.prototype.destroy=function(){return this._clippingPlanesTexture=this._clippingPlanesTexture&&this._clippingPlanesTexture.destroy(),ue(this)};var Qs=xa;var Ub={HIGHLIGHT:0,REPLACE:1,MIX:2};Ub.getColorBlend=function(t,n){if(t===Ub.HIGHLIGHT)return 0;if(t===Ub.REPLACE)return 1;if(t===Ub.MIX)return B.clamp(n,B.EPSILON4,1)};var oc=Object.freeze(Ub);var PSe={XTRANSLATE:"xTranslate",YTRANSLATE:"yTranslate",ZTRANSLATE:"zTranslate",XROTATE:"xRotate",YROTATE:"yRotate",ZROTATE:"zRotate",XSCALE:"xScale",YSCALE:"yScale",ZSCALE:"zScale",UNIFORMSCALE:"uniformScale"},rc=Object.freeze(PSe);var ISe={STEP:0,LINEAR:1,CUBICSPLINE:2},Gd=Object.freeze(ISe);function BSe(t){switch(t){case"SCALAR":return 1;case"VEC2":return 2;case"VEC3":return 3;case"VEC4":case"MAT2":return 4;case"MAT3":return 9;case"MAT4":return 16}}var du=BSe;function OSe(t,n){let i=n.bufferView;if(f(i)){let o=t.bufferViews[i];if(f(o.byteStride)&&o.byteStride>0)return o.byteStride}return J.getSizeInBytes(n.componentType)*du(n.type)}var Tl=OSe;function RSe(t){switch(t){case J.BYTE:return function(n,i,o,r,s){for(let a=0;a<o;++a)s[a]=n.getInt8(i+a*r)};case J.UNSIGNED_BYTE:return function(n,i,o,r,s){for(let a=0;a<o;++a)s[a]=n.getUint8(i+a*r)};case J.SHORT:return function(n,i,o,r,s){for(let a=0;a<o;++a)s[a]=n.getInt16(i+a*r,!0)};case J.UNSIGNED_SHORT:return function(n,i,o,r,s){for(let a=0;a<o;++a)s[a]=n.getUint16(i+a*r,!0)};case J.INT:return function(n,i,o,r,s){for(let a=0;a<o;++a)s[a]=n.getInt32(i+a*r,!0)};case J.UNSIGNED_INT:return function(n,i,o,r,s){for(let a=0;a<o;++a)s[a]=n.getUint32(i+a*r,!0)};case J.FLOAT:return function(n,i,o,r,s){for(let a=0;a<o;++a)s[a]=n.getFloat32(i+a*r,!0)};case J.DOUBLE:return function(n,i,o,r,s){for(let a=0;a<o;++a)s[a]=n.getFloat64(i+a*r,!0)}}}var Wp=RSe;function Ss(){}Object.defineProperties(Ss.prototype,{class:{get:function(){Ce.throwInstantiationError()}}});Ss.prototype.hasProperty=function(t){Ce.throwInstantiationError()};Ss.prototype.hasPropertyBySemantic=function(t){Ce.throwInstantiationError()};Ss.prototype.getPropertyIds=function(t){Ce.throwInstantiationError()};Ss.prototype.getProperty=function(t){Ce.throwInstantiationError()};Ss.prototype.setProperty=function(t,n){Ce.throwInstantiationError()};Ss.prototype.getPropertyBySemantic=function(t){Ce.throwInstantiationError()};Ss.prototype.setPropertyBySemantic=function(t,n){Ce.throwInstantiationError()};Ss.hasProperty=function(t,n,i){if(f(n[t]))return!0;let o=i.properties;if(!f(o))return!1;let r=o[t];return!!(f(r)&&f(r.default))};Ss.hasPropertyBySemantic=function(t,n,i){let o=i.propertiesBySemantic;if(!f(o))return!1;let r=o[t];return f(r)};Ss.getPropertyIds=function(t,n,i){i=f(i)?i:[],i.length=0;for(let r in t)t.hasOwnProperty(r)&&f(t[r])&&i.push(r);let o=n.properties;if(f(o))for(let r in o)o.hasOwnProperty(r)&&!f(t[r])&&f(o[r].default)&&i.push(r);return i};Ss.getProperty=function(t,n,i){let o=i.properties[t],r=n[t];Array.isArray(r)&&(r=r.slice());let s=!0;if(r=o.handleNoData(r),!f(r)&&f(o.default))return r=tt(o.default,!0),o.unpackVectorAndMatrixTypes(r,s);if(!!f(r))return r=o.normalize(r),r=o.applyValueTransform(r),o.unpackVectorAndMatrixTypes(r,s)};Ss.setProperty=function(t,n,i,o){if(!f(i[t]))return!1;Array.isArray(n)&&(n=n.slice());let r,s=o.properties;f(s)&&(r=s[t]);let a=!0;return f(r)&&(n=r.packVectorAndMatrixTypes(n,a),n=r.unapplyValueTransform(n),n=r.unnormalize(n)),i[t]=n,!0};Ss.getPropertyBySemantic=function(t,n,i){let o=i.propertiesBySemantic;if(!f(o))return;let r=o[t];if(f(r))return Ss.getProperty(r.id,n,i)};Ss.setPropertyBySemantic=function(t,n,i,o){let r=o.propertiesBySemantic;if(!f(r))return!1;let s=o.propertiesBySemantic[t];return f(s)?Ss.setProperty(s.id,n,i,o):!1};var Nn=Ss;var QJ={};function zb(t){this._count=t.count,this._properties=tt(t.properties,!0)}zb.prototype.hasProperty=function(t){return Nn.hasProperty(t,this._properties,QJ)};zb.prototype.getPropertyIds=function(t){return Nn.getPropertyIds(this._properties,QJ,t)};zb.prototype.getProperty=function(t,n){let i=this._properties[n];if(f(i))return tt(i[t],!0)};zb.prototype.setProperty=function(t,n,i){let o=this._properties[n];f(o)||(o=new Array(this._count),this._properties[n]=o),o[t]=tt(i,!0)};var jp=zb;function Ta(t){t=A(t,A.EMPTY_OBJECT),this._name=t.name,this._id=t.id,this._count=t.count,this._extras=t.extras,this._extensions=t.extensions,this._metadataTable=t.metadataTable,this._jsonMetadataTable=t.jsonMetadataTable,this._batchTableHierarchy=t.batchTableHierarchy}Object.defineProperties(Ta.prototype,{name:{get:function(){return this._name}},id:{get:function(){return this._id}},count:{get:function(){return this._count}},class:{get:function(){if(f(this._metadataTable))return this._metadataTable.class}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}},byteLength:{get:function(){let t=0;return f(this._metadataTable)&&(t+=this._metadataTable.byteLength),f(this._batchTableHierarchy)&&(t+=this._batchTableHierarchy.byteLength),t}}});Ta.prototype.hasProperty=function(t,n){return!!(f(this._metadataTable)&&this._metadataTable.hasProperty(n)||f(this._batchTableHierarchy)&&this._batchTableHierarchy.hasProperty(t,n)||f(this._jsonMetadataTable)&&this._jsonMetadataTable.hasProperty(n))};Ta.prototype.hasPropertyBySemantic=function(t,n){return f(this._metadataTable)?this._metadataTable.hasPropertyBySemantic(n):!1};Ta.prototype.propertyExists=function(t){return!!(f(this._metadataTable)&&this._metadataTable.hasProperty(t)||f(this._batchTableHierarchy)&&this._batchTableHierarchy.propertyExists(t)||f(this._jsonMetadataTable)&&this._jsonMetadataTable.hasProperty(t))};Ta.prototype.propertyExistsBySemantic=function(t){return f(this._metadataTable)?this._metadataTable.hasPropertyBySemantic(t):!1};var P8=[];Ta.prototype.getPropertyIds=function(t,n){return n=f(n)?n:[],n.length=0,f(this._metadataTable)&&n.push.apply(n,this._metadataTable.getPropertyIds(P8)),f(this._batchTableHierarchy)&&n.push.apply(n,this._batchTableHierarchy.getPropertyIds(t,P8)),f(this._jsonMetadataTable)&&n.push.apply(n,this._jsonMetadataTable.getPropertyIds(P8)),n};Ta.prototype.getProperty=function(t,n){let i;if(f(this._metadataTable)&&(i=this._metadataTable.getProperty(t,n),f(i))||f(this._batchTableHierarchy)&&(i=this._batchTableHierarchy.getProperty(t,n),f(i))||f(this._jsonMetadataTable)&&(i=this._jsonMetadataTable.getProperty(t,n),f(i)))return i};Ta.prototype.setProperty=function(t,n,i){f(this._metadataTable)&&this._metadataTable.setProperty(t,n,i)||f(this._batchTableHierarchy)&&this._batchTableHierarchy.setProperty(t,n,i)||(f(this._jsonMetadataTable)||(this._jsonMetadataTable=new jp({count:this._count,properties:{}})),this._jsonMetadataTable.setProperty(t,n,i))};Ta.prototype.getPropertyBySemantic=function(t,n){if(f(this._metadataTable))return this._metadataTable.getPropertyBySemantic(t,n)};Ta.prototype.setPropertyBySemantic=function(t,n,i){return f(this._metadataTable)?this._metadataTable.setPropertyBySemantic(t,n,i):!1};Ta.prototype.getPropertyTypedArray=function(t){if(f(this._metadataTable))return this._metadataTable.getPropertyTypedArray(t)};Ta.prototype.getPropertyTypedArrayBySemantic=function(t){if(f(this._metadataTable))return this._metadataTable.getPropertyTypedArrayBySemantic(t)};Ta.prototype.isClass=function(t,n){let i=this._batchTableHierarchy;return f(i)?i.isClass(t,n):!1};Ta.prototype.isExactClass=function(t,n){return this.getExactClassName(t)===n};Ta.prototype.getExactClassName=function(t){let n=this._batchTableHierarchy;if(!!f(n))return n.getClassName(t)};var Uc=Ta;var MSe={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"},pm=Object.freeze(MSe);var Mo={};function LSe(){this.octEncoded=!1,this.octEncodedZXY=!1,this.normalizationRange=void 0,this.quantizedVolumeOffset=void 0,this.quantizedVolumeDimensions=void 0,this.quantizedVolumeStepSize=void 0,this.componentDatatype=void 0,this.type=void 0}function FSe(){this.name=void 0,this.semantic=void 0,this.setIndex=void 0,this.componentDatatype=void 0,this.type=void 0,this.normalized=!1,this.count=void 0,this.min=void 0,this.max=void 0,this.constant=void 0,this.quantization=void 0,this.typedArray=void 0,this.buffer=void 0,this.byteOffset=0,this.byteStride=void 0}function NSe(){this.indexDatatype=void 0,this.count=void 0,this.buffer=void 0,this.typedArray=void 0}function VSe(){this.featureCount=void 0,this.nullFeatureId=void 0,this.propertyTableId=void 0,this.setIndex=void 0,this.label=void 0,this.positionalLabel=void 0}function kSe(){this.featureCount=void 0,this.nullFeatureId=void 0,this.propertyTableId=void 0,this.offset=0,this.repeat=void 0,this.label=void 0,this.positionalLabel=void 0}function USe(){this.featureCount=void 0,this.nullFeatureId=void 0,this.propertyTableId=void 0,this.textureReader=void 0,this.label=void 0,this.positionalLabel=void 0}function zSe(){this.attributes=[]}function HSe(){this.attributes=[],this.morphTargets=[],this.indices=void 0,this.material=void 0,this.primitiveType=void 0,this.featureIds=[],this.propertyTextureIds=[],this.propertyAttributeIds=[],this.outlineCoordinates=void 0}function GSe(){this.attributes=[],this.featureIds=[],this.transformInWorldSpace=!1}function WSe(){this.index=void 0,this.joints=[],this.inverseBindMatrices=[]}function jSe(){this.name=void 0,this.index=void 0,this.children=[],this.primitives=[],this.instances=void 0,this.skin=void 0,this.matrix=void 0,this.translation=void 0,this.rotation=void 0,this.scale=void 0,this.morphWeights=[],this.articulationName=void 0}function qSe(){this.nodes=[]}var YSe={TRANSLATION:"translation",ROTATION:"rotation",SCALE:"scale",WEIGHTS:"weights"};function XSe(){this.input=[],this.interpolation=void 0,this.output=[]}function KSe(){this.node=void 0,this.path=void 0}function JSe(){this.sampler=void 0,this.target=void 0}function ZSe(){this.name=void 0,this.samplers=[],this.channels=[]}function QSe(){this.name=void 0,this.type=void 0,this.minimumValue=void 0,this.maximumValue=void 0,this.initialValue=void 0}function $Se(){this.name=void 0,this.stages=[]}function $J(){this.credits=[]}function ewe(){this.asset=new $J,this.scene=void 0,this.nodes=[],this.skins=[],this.animations=[],this.articulations=[],this.structuralMetadata=void 0,this.upAxis=void 0,this.forwardAxis=void 0,this.transform=N.clone(N.IDENTITY)}function twe(){this.texture=void 0,this.index=void 0,this.texCoord=0,this.transform=$.clone($.IDENTITY),this.channels=void 0}function qp(){this.baseColorTexture=void 0,this.metallicRoughnessTexture=void 0,this.baseColorFactor=se.clone(qp.DEFAULT_BASE_COLOR_FACTOR),this.metallicFactor=qp.DEFAULT_METALLIC_FACTOR,this.roughnessFactor=qp.DEFAULT_ROUGHNESS_FACTOR}qp.DEFAULT_BASE_COLOR_FACTOR=se.ONE;qp.DEFAULT_METALLIC_FACTOR=1;qp.DEFAULT_ROUGHNESS_FACTOR=1;function D0(){this.diffuseTexture=void 0,this.specularGlossinessTexture=void 0,this.diffuseFactor=se.clone(D0.DEFAULT_DIFFUSE_FACTOR),this.specularFactor=m.clone(D0.DEFAULT_SPECULAR_FACTOR),this.glossinessFactor=D0.DEFAULT_GLOSSINESS_FACTOR}D0.DEFAULT_DIFFUSE_FACTOR=se.ONE;D0.DEFAULT_SPECULAR_FACTOR=m.ONE;D0.DEFAULT_GLOSSINESS_FACTOR=1;function I8(){this.metallicRoughness=new qp,this.specularGlossiness=void 0,this.emissiveTexture=void 0,this.normalTexture=void 0,this.occlusionTexture=void 0,this.emissiveFactor=m.clone(I8.DEFAULT_EMISSIVE_FACTOR),this.alphaMode=pm.OPAQUE,this.alphaCutoff=.5,this.doubleSided=!1,this.unlit=!1}I8.DEFAULT_EMISSIVE_FACTOR=m.ZERO;Mo.Quantization=LSe;Mo.Attribute=FSe;Mo.Indices=NSe;Mo.FeatureIdAttribute=VSe;Mo.FeatureIdTexture=USe;Mo.FeatureIdImplicitRange=kSe;Mo.MorphTarget=zSe;Mo.Primitive=HSe;Mo.Instances=GSe;Mo.Skin=WSe;Mo.Node=jSe;Mo.Scene=qSe;Mo.AnimatedPropertyType=Object.freeze(YSe);Mo.AnimationSampler=XSe;Mo.AnimationTarget=KSe;Mo.AnimationChannel=JSe;Mo.Animation=ZSe;Mo.ArticulationStage=QSe;Mo.Articulation=$Se;Mo.Asset=$J;Mo.Components=ewe;Mo.TextureReader=twe;Mo.MetallicRoughness=qp;Mo.SpecularGlossiness=D0;Mo.Material=I8;var It=Mo;var DO={};DO.getImageIdFromTexture=function(t){t=A(t,A.EMPTY_OBJECT);let n=t.gltf,i=t.textureId,o=t.supportedImageFormats,r=n.textures[i],s=r.extensions;if(f(s)){if(o.webp&&f(s.EXT_texture_webp))return s.EXT_texture_webp.source;if(o.basis&&f(s.KHR_texture_basisu))return s.KHR_texture_basisu.source}return r.source};DO.createSampler=function(t){t=A(t,A.EMPTY_OBJECT);let n=t.gltf,i=t.textureInfo,o=A(t.compressedTextureNoMipmap,!1),r=Mn.REPEAT,s=Mn.REPEAT,a=fn.LINEAR,c=Qi.LINEAR,l=i.index,d=n.textures[l].sampler;if(f(d)){let y=n.samplers[d];r=A(y.wrapS,r),s=A(y.wrapT,s),a=A(y.minFilter,a),c=A(y.magFilter,c)}let h=!1,_=i.extensions;return f(_)&&f(_.KHR_texture_transform)&&(h=!0),(o||h)&&a!==fn.LINEAR&&a!==fn.NEAREST&&(a===fn.NEAREST_MIPMAP_NEAREST||a===fn.NEAREST_MIPMAP_LINEAR?a=fn.NEAREST:a=fn.LINEAR),new pn({wrapS:r,wrapT:s,minificationFilter:a,magnificationFilter:c})};var nwe=new W(1,1);DO.createModelTextureReader=function(t){t=A(t,A.EMPTY_OBJECT);let n=t.textureInfo,i=t.channels,o=t.texture,r=A(n.texCoord,0),s,a=A(n.extensions,A.EMPTY_OBJECT).KHR_texture_transform;if(f(a)){r=A(a.texCoord,r);let l=f(a.offset)?W.unpack(a.offset):W.ZERO,u=A(a.rotation,0),d=f(a.scale)?W.unpack(a.scale):nwe;u=-u,s=new $(Math.cos(u)*d.x,-Math.sin(u)*d.y,l.x,Math.sin(u)*d.x,Math.cos(u)*d.y,l.y,0,0,1)}let c=new It.TextureReader;return c.index=n.index,c.texture=o,c.texCoord=r,c.transform=s,c.channels=i,c};var El=DO;var Do={SCALAR:"SCALAR",VEC2:"VEC2",VEC3:"VEC3",VEC4:"VEC4",MAT2:"MAT2",MAT3:"MAT3",MAT4:"MAT4",BOOLEAN:"BOOLEAN",STRING:"STRING",ENUM:"ENUM"};Do.isVectorType=function(t){switch(t){case Do.VEC2:case Do.VEC3:case Do.VEC4:return!0;default:return!1}};Do.isMatrixType=function(t){switch(t){case Do.MAT2:case Do.MAT3:case Do.MAT4:return!0;default:return!1}};Do.getComponentCount=function(t){switch(t){case Do.SCALAR:case Do.STRING:case Do.ENUM:case Do.BOOLEAN:return 1;case Do.VEC2:return 2;case Do.VEC3:return 3;case Do.VEC4:return 4;case Do.MAT2:return 4;case Do.MAT3:return 9;case Do.MAT4:return 16}};Do.getMathType=function(t){switch(t){case Do.VEC2:return W;case Do.VEC3:return m;case Do.VEC4:return se;case Do.MAT2:return Ji;case Do.MAT3:return $;case Do.MAT4:return N;default:return}};var Pn=Object.freeze(Do);var Ft={INT8:"INT8",UINT8:"UINT8",INT16:"INT16",UINT16:"UINT16",INT32:"INT32",UINT32:"UINT32",INT64:"INT64",UINT64:"UINT64",FLOAT32:"FLOAT32",FLOAT64:"FLOAT64"};Ft.getMinimum=function(t){switch(t){case Ft.INT8:return-128;case Ft.UINT8:return 0;case Ft.INT16:return-32768;case Ft.UINT16:return 0;case Ft.INT32:return-2147483648;case Ft.UINT32:return 0;case Ft.INT64:return Vt.supportsBigInt()?BigInt("-9223372036854775808"):-Math.pow(2,63);case Ft.UINT64:return Vt.supportsBigInt()?BigInt(0):0;case Ft.FLOAT32:return-34028234663852886e22;case Ft.FLOAT64:return-Number.MAX_VALUE}};Ft.getMaximum=function(t){switch(t){case Ft.INT8:return 127;case Ft.UINT8:return 255;case Ft.INT16:return 32767;case Ft.UINT16:return 65535;case Ft.INT32:return 2147483647;case Ft.UINT32:return 4294967295;case Ft.INT64:return Vt.supportsBigInt()?BigInt("9223372036854775807"):Math.pow(2,63)-1;case Ft.UINT64:return Vt.supportsBigInt()?BigInt("18446744073709551615"):Math.pow(2,64)-1;case Ft.FLOAT32:return 34028234663852886e22;case Ft.FLOAT64:return Number.MAX_VALUE}};Ft.isNumericType=function(t){switch(t){case Ft.INT8:case Ft.UINT8:case Ft.INT16:case Ft.UINT16:case Ft.INT32:case Ft.UINT32:case Ft.INT64:case Ft.UINT64:case Ft.FLOAT32:case Ft.FLOAT64:return!0;default:return!1}};Ft.isIntegerType=function(t){switch(t){case Ft.INT8:case Ft.UINT8:case Ft.INT16:case Ft.UINT16:case Ft.INT32:case Ft.UINT32:case Ft.INT64:case Ft.UINT64:return!0;default:return!1}};Ft.isUnsignedIntegerType=function(t){switch(t){case Ft.UINT8:case Ft.UINT16:case Ft.UINT32:case Ft.UINT64:return!0;default:return!1}};Ft.isVectorCompatible=function(t){switch(t){case Ft.INT8:case Ft.UINT8:case Ft.INT16:case Ft.UINT16:case Ft.INT32:case Ft.UINT32:case Ft.FLOAT32:case Ft.FLOAT64:return!0;default:return!1}};Ft.normalize=function(t,n){return Math.max(Number(t)/Number(Ft.getMaximum(n)),-1)};Ft.unnormalize=function(t,n){let i=Ft.getMaximum(n),o=Ft.isUnsignedIntegerType(n)?0:-i;return t=B.sign(t)*Math.round(Math.abs(t)*Number(i)),(n===Ft.INT64||n===Ft.UINT64)&&Vt.supportsBigInt()&&(t=BigInt(t)),t>i?i:t<o?o:t};Ft.applyValueTransform=function(t,n,i){return i*t+n};Ft.unapplyValueTransform=function(t,n,i){return i===0?0:(t-n)/i};Ft.getSizeInBytes=function(t){switch(t){case Ft.INT8:case Ft.UINT8:return 1;case Ft.INT16:case Ft.UINT16:return 2;case Ft.INT32:case Ft.UINT32:return 4;case Ft.INT64:case Ft.UINT64:return 8;case Ft.FLOAT32:return 4;case Ft.FLOAT64:return 8}};var In=Object.freeze(Ft);function Hb(t){t=A(t,A.EMPTY_OBJECT);let n=t.property,i=t.classProperty,o=t.textures,r=f(n.channels)?n.channels:[0],s=n,a=El.createModelTextureReader({textureInfo:s,channels:rwe(r),texture:o[s.index]});this._min=n.min,this._max=n.max;let c=n.offset,l=n.scale,u=i.hasValueTransform||f(c)||f(l);c=A(c,i.offset),l=A(l,i.scale),c=i.unpackVectorAndMatrixTypes(c),l=i.unpackVectorAndMatrixTypes(l),this._offset=c,this._scale=l,this._hasValueTransform=u,this._textureReader=a,this._classProperty=i,this._extras=n.extras,this._extensions=n.extensions}Object.defineProperties(Hb.prototype,{textureReader:{get:function(){return this._textureReader}},hasValueTransform:{get:function(){return this._hasValueTransform}},offset:{get:function(){return this._offset}},scale:{get:function(){return this._scale}},classProperty:{get:function(){return this._classProperty}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}});Hb.prototype.isGpuCompatible=function(){let t=this._classProperty,n=t.type,i=t.componentType;return t.isArray?!t.isVariableLengthArray&&t.arrayLength<=4&&n===Pn.SCALAR&&i===In.UINT8:Pn.isVectorType(n)||n===Pn.SCALAR?i===In.UINT8:!1};var iwe=[void 0,"float","vec2","vec3","vec4"],owe=[void 0,"int","ivec2","ivec3","ivec4"];Hb.prototype.getGlslType=function(){let t=this._classProperty,n=Pn.getComponentCount(t.type);return t.isArray&&(n=t.arrayLength),t.normalized?iwe[n]:owe[n]};Hb.prototype.unpackInShader=function(t){return this._classProperty.normalized?t:`${this.getGlslType()}(255.0 * ${t})`};function rwe(t){return t.map(function(n){return"rgba".charAt(n)}).join("")}var vO=Hb;function B8(t){t=A(t,A.EMPTY_OBJECT);let n=t.propertyTexture,i=t.class,o=t.textures,r=n.extensions,s=n.extras,a={};if(f(n.properties))for(let c in n.properties)n.properties.hasOwnProperty(c)&&(a[c]=new vO({property:n.properties[c],classProperty:i.properties[c],textures:o}));this._name=t.name,this._id=t.id,this._class=i,this._properties=a,this._extras=s,this._extensions=r}Object.defineProperties(B8.prototype,{name:{get:function(){return this._name}},id:{get:function(){return this._id}},class:{get:function(){return this._class}},properties:{get:function(){return this._properties}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}});B8.prototype.getProperty=function(t){return this._properties[t]};var BC=B8;function eZ(t){t=A(t,A.EMPTY_OBJECT);let n=t.property,i=t.classProperty;this._attribute=n.attribute,this._classProperty=i,this._min=n.min,this._max=n.max;let o=n.offset,r=n.scale,s=i.hasValueTransform||f(o)||f(r);o=A(o,i.offset),r=A(r,i.scale),o=i.unpackVectorAndMatrixTypes(o),r=i.unpackVectorAndMatrixTypes(r),this._offset=o,this._scale=r,this._hasValueTransform=s,this._extras=n.extras,this._extensions=n.extensions}Object.defineProperties(eZ.prototype,{attribute:{get:function(){return this._attribute}},hasValueTransform:{get:function(){return this._hasValueTransform}},offset:{get:function(){return this._offset}},scale:{get:function(){return this._scale}},classProperty:{get:function(){return this._classProperty}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}});var PO=eZ;function O8(t){t=A(t,A.EMPTY_OBJECT);let n=t.propertyAttribute,i=t.class,o={};if(f(n.properties))for(let r in n.properties)n.properties.hasOwnProperty(r)&&(o[r]=new PO({property:n.properties[r],classProperty:i.properties[r]}));this._name=t.name,this._id=t.id,this._class=i,this._properties=o,this._extras=n.extras,this._extensions=n.extensions}Object.defineProperties(O8.prototype,{name:{get:function(){return this._name}},id:{get:function(){return this._id}},class:{get:function(){return this._class}},properties:{get:function(){return this._properties}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}});O8.prototype.getProperty=function(t){return this._properties[t]};var OC=O8;function Gb(t){t=A(t,A.EMPTY_OBJECT),this._schema=t.schema;let n=t.propertyTables;this._propertyTableCount=f(n)?n.length:0,this._propertyTables=n,this._propertyTextures=t.propertyTextures,this._propertyAttributes=t.propertyAttributes,this._statistics=t.statistics,this._extras=t.extras,this._extensions=t.extensions}Object.defineProperties(Gb.prototype,{schema:{get:function(){return this._schema}},statistics:{get:function(){return this._statistics}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}},propertyTableCount:{get:function(){return this._propertyTableCount}},propertyTables:{get:function(){return this._propertyTables}},propertyTextures:{get:function(){return this._propertyTextures}},propertyAttributes:{get:function(){return this._propertyAttributes}},propertyTablesByteLength:{get:function(){if(!f(this._propertyTables))return 0;let t=0,n=this._propertyTables.length;for(let i=0;i<n;i++)t+=this._propertyTables[i].byteLength;return t}}});Gb.prototype.getPropertyTable=function(t){return this._propertyTables[t]};Gb.prototype.getPropertyTexture=function(t){return this._propertyTextures[t]};Gb.prototype.getPropertyAttribute=function(t){return this._propertyAttributes[t]};var Ea=Gb;function Yp(t,n,i){return n=A(n,0),i=A(i,t.byteLength-n),t=t.subarray(n,n+i),Yp.decode(t)}Yp.decodeWithTextDecoder=function(t){return new TextDecoder("utf-8").decode(t)};Yp.decodeWithFromCharCode=function(t){let n="",i=swe(t),o=i.length;for(let r=0;r<o;++r){let s=i[r];s<=65535?n+=String.fromCharCode(s):(s-=65536,n+=String.fromCharCode((s>>10)+55296,(s&1023)+56320))}return n};function Wb(t,n,i){return n<=t&&t<=i}function swe(t){let n=0,i=0,o=0,r=128,s=191,a=[],c=t.length;for(let l=0;l<c;++l){let u=t[l];if(o===0){if(Wb(u,0,127)){a.push(u);continue}if(Wb(u,194,223)){o=1,n=u&31;continue}if(Wb(u,224,239)){u===224&&(r=160),u===237&&(s=159),o=2,n=u&15;continue}if(Wb(u,240,244)){u===240&&(r=144),u===244&&(s=143),o=3,n=u&7;continue}throw new he("String decoding failed.")}if(!Wb(u,r,s)){n=o=i=0,r=128,s=191,--l;continue}r=128,s=191,n=n<<6|u&63,++i,i===o&&(a.push(n),n=o=i=0)}return a}typeof TextDecoder!="undefined"?Yp.decode=Yp.decodeWithTextDecoder:Yp.decode=Yp.decodeWithFromCharCode;var bl=Yp;var tZ={};function jb(t,n){f(tZ[t])||(tZ[t]=!0,console.warn(A(n,t)))}jb.geometryOutlines="Entity geometry outlines are unsupported on terrain. Outlines will be disabled. To enable outlines, disable geometry terrain clamping by explicitly setting height to 0.";jb.geometryZIndex="Entity geometry with zIndex are unsupported when height or extrudedHeight are defined.  zIndex will be ignored";jb.geometryHeightReference="Entity corridor, ellipse, polygon or rectangle with heightReference must also have a defined height.  heightReference will be ignored";jb.geometryExtrudedHeightReference="Entity corridor, ellipse, polygon or rectangle with extrudedHeightReference must also have a defined extrudedHeight.  extrudedHeightReference will be ignored";var Bt=jb;function sc(t){t=A(t,A.EMPTY_OBJECT);let n=t.id,i=t.property,o=awe(i),r=cwe(i,t.enums),s=r.componentType,a=f(s)&&In.isIntegerType(s)&&A(i.normalized,!1);this._id=n,this._name=i.name,this._description=i.description,this._semantic=i.semantic,this._isLegacyExtension=o,this._type=r.type,this._componentType=s,this._enumType=r.enumType,this._valueType=r.valueType,this._isArray=r.isArray,this._isVariableLengthArray=r.isVariableLengthArray,this._arrayLength=r.arrayLength,this._min=i.min,this._max=i.max,this._normalized=a;let c=i.offset,l=i.scale,u=f(c)||f(l),d=!0;f(c)||(c=this.expandConstant(0,d)),f(l)||(l=this.expandConstant(1,d)),this._offset=c,this._scale=l,this._hasValueTransform=u,this._noData=i.noData,this._default=i.default;let h;f(o)?o?h=f(i.optional)?!i.optional:!0:h=A(i.required,!1):h=!1,this._required=h,this._extras=i.extras,this._extensions=i.extensions}Object.defineProperties(sc.prototype,{id:{get:function(){return this._id}},name:{get:function(){return this._name}},description:{get:function(){return this._description}},type:{get:function(){return this._type}},enumType:{get:function(){return this._enumType}},componentType:{get:function(){return this._componentType}},valueType:{get:function(){return this._valueType}},isArray:{get:function(){return this._isArray}},isVariableLengthArray:{get:function(){return this._isVariableLengthArray}},arrayLength:{get:function(){return this._arrayLength}},normalized:{get:function(){return this._normalized}},max:{get:function(){return this._max}},min:{get:function(){return this._min}},noData:{get:function(){return this._noData}},default:{get:function(){return this._default}},required:{get:function(){return this._required}},semantic:{get:function(){return this._semantic}},hasValueTransform:{get:function(){return this._hasValueTransform}},offset:{get:function(){return this._offset}},scale:{get:function(){return this._scale}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}});function awe(t){if(t.type==="ARRAY")return!0;let n=t.type;if(n===Pn.SCALAR||Pn.isMatrixType(n)||Pn.isVectorType(n))return!1;if(In.isNumericType(n))return!0;if(f(t.noData)||f(t.scale)||f(t.offset)||f(t.required)||f(t.count)||f(t.array)||f(t.optional))return!1}function cwe(t,n){let i=t.type,o=t.componentType,r=i==="ARRAY",s,a,c;r?(s=!0,a=t.componentCount,c=!f(a)):t.array?(s=!0,a=t.count,c=!f(t.count)):(s=!1,a=void 0,c=!1);let l;if(f(t.enumType)&&(l=n[t.enumType]),i===Pn.ENUM)return{type:i,componentType:void 0,enumType:l,valueType:l.valueType,isArray:s,isVariableLengthArray:c,arrayLength:a};if(r&&o===Pn.ENUM)return{type:o,componentType:void 0,enumType:l,valueType:l.valueType,isArray:s,isVariableLengthArray:c,arrayLength:a};if(i===Pn.SCALAR||Pn.isMatrixType(i)||Pn.isVectorType(i))return{type:i,componentType:o,enumType:void 0,valueType:o,isArray:s,isVariableLengthArray:c,arrayLength:a};if(i===Pn.BOOLEAN||i===Pn.STRING)return{type:i,componentType:void 0,enumType:void 0,valueType:void 0,isArray:s,isVariableLengthArray:c,arrayLength:a};if(r&&(o===Pn.BOOLEAN||o===Pn.STRING))return{type:o,componentType:void 0,enumType:void 0,valueType:void 0,isArray:s,isVariableLengthArray:c,arrayLength:a};if(f(o)&&In.isNumericType(o))return{type:Pn.SCALAR,componentType:o,enumType:void 0,valueType:o,isArray:s,isVariableLengthArray:c,arrayLength:a};if(In.isNumericType(i))return{type:Pn.SCALAR,componentType:i,enumType:void 0,valueType:i,isArray:s,isVariableLengthArray:c,arrayLength:a}}sc.prototype.normalize=function(t){return this._normalized?R8(t,this._valueType,In.normalize):t};sc.prototype.unnormalize=function(t){return this._normalized?R8(t,this._valueType,In.unnormalize):t};sc.prototype.applyValueTransform=function(t){return!this._hasValueTransform||this._isVariableLengthArray?t:sc.valueTransformInPlace(t,this._offset,this._scale,In.applyValueTransform)};sc.prototype.unapplyValueTransform=function(t){return!this._hasValueTransform||this._isVariableLengthArray?t:sc.valueTransformInPlace(t,this._offset,this._scale,In.unapplyValueTransform)};sc.prototype.expandConstant=function(t,n){n=A(n,!1);let i=this._isArray,o=this._arrayLength,r=Pn.getComponentCount(this._type),s=i&&r>1;if(!i&&r===1)return t;if(!i)return new Array(r).fill(t);if(!s)return new Array(o).fill(t);if(!n)return new Array(this._arrayLength*r).fill(t);let a=new Array(r).fill(t);return new Array(this._arrayLength).fill(a)};sc.prototype.handleNoData=function(t){let n=this._noData;if(!f(n))return t;if(!rZ(t,n))return t};function rZ(t,n){if(!Array.isArray(t))return t===n;if(!Array.isArray(n)||t.length!==n.length)return!1;for(let i=0;i<t.length;i++)if(!rZ(t[i],n[i]))return!1;return!0}sc.prototype.unpackVectorAndMatrixTypes=function(t,n){n=A(n,!1);let i=Pn.getMathType(this._type),o=this._isArray,r=Pn.getComponentCount(this._type),s=o&&r>1;return f(i)?n&&s?t.map(function(a){return i.unpack(a)}):o?i.unpackArray(t):i.unpack(t):t};sc.prototype.packVectorAndMatrixTypes=function(t,n){n=A(n,!1);let i=Pn.getMathType(this._type),o=this._isArray,r=Pn.getComponentCount(this._type),s=o&&r>1;return f(i)?n&&s?t.map(function(a){return i.pack(a,[])}):o?i.packArray(t,[]):i.pack(t,[]):t};sc.prototype.validate=function(t){if(!(!f(t)&&f(this._default)))return this._required&&!f(t)?"required property must have a value":this._isArray?lwe(this,t):sZ(this,t)};function lwe(t,n){if(!Array.isArray(n))return`value ${n} must be an array`;let i=n.length;if(!t._isVariableLengthArray&&i!==t._arrayLength)return"Array length does not match property.arrayLength";for(let o=0;o<i;o++){let r=sZ(t,n[o]);if(f(r))return r}}function sZ(t,n){let i=t._type,o=t._componentType,r=t._enumType,s=t._normalized;return Pn.isVectorType(i)?uwe(n,i,o):Pn.isMatrixType(i)?fwe(n,i,o):i===Pn.STRING?dwe(n):i===Pn.BOOLEAN?hwe(n):i===Pn.ENUM?mwe(n,r):pwe(n,o,s)}function uwe(t,n,i){if(!In.isVectorCompatible(i))return`componentType ${i} is incompatible with vector type ${n}`;if(n===Pn.VEC2&&!(t instanceof W))return`vector value ${t} must be a Cartesian2`;if(n===Pn.VEC3&&!(t instanceof m))return`vector value ${t} must be a Cartesian3`;if(n===Pn.VEC4&&!(t instanceof se))return`vector value ${t} must be a Cartesian4`}function fwe(t,n,i){if(!In.isVectorCompatible(i))return`componentType ${i} is incompatible with matrix type ${n}`;if(n===Pn.MAT2&&!(t instanceof Ji))return`matrix value ${t} must be a Matrix2`;if(n===Pn.MAT3&&!(t instanceof $))return`matrix value ${t} must be a Matrix3`;if(n===Pn.MAT4&&!(t instanceof N))return`matrix value ${t} must be a Matrix4`}function dwe(t){if(typeof t!="string")return IO(t,Pn.STRING)}function hwe(t){if(typeof t!="boolean")return IO(t,Pn.BOOLEAN)}function mwe(t,n){let i=typeof t;if(f(n))return i!=="string"||!f(n.valuesByName[t])?`value ${t} is not a valid enum name for ${n.id}`:void 0}function pwe(t,n,i){let o=typeof t;switch(n){case In.INT8:case In.UINT8:case In.INT16:case In.UINT16:case In.INT32:case In.UINT32:case In.FLOAT32:case In.FLOAT64:return o!=="number"?IO(t,n):isFinite(t)?iZ(t,n,i):oZ(t,n);case In.INT64:case In.UINT64:return o!=="number"&&o!=="bigint"?IO(t,n):o==="number"&&!isFinite(t)?oZ(t,n):iZ(t,n,i)}}function IO(t,n){return`value ${t} does not match type ${n}`}function nZ(t,n,i){let o=`value ${t} is out of range for type ${n}`;return i&&(o+=" (normalized)"),o}function iZ(t,n,i){if(i){let o=In.isUnsignedIntegerType(n)?0:-1,r=1;return t<o||t>r?nZ(t,n,i):void 0}if(t<In.getMinimum(n)||t>In.getMaximum(n))return nZ(t,n,i)}function oZ(t,n){return`value ${t} of type ${n} must be finite`}function R8(t,n,i){if(!Array.isArray(t))return i(t,n);for(let o=0;o<t.length;o++)t[o]=R8(t[o],n,i);return t}sc.valueTransformInPlace=function(t,n,i,o){if(!Array.isArray(t))return o(t,n,i);for(let r=0;r<t.length;r++)t[r]=sc.valueTransformInPlace(t[r],n[r],i[r],o);return t};var v0=sc;function qb(t){t=A(t,A.EMPTY_OBJECT);let n=t.count,i=t.property,o=t.classProperty,r=t.bufferViews,s=o.type,a=o.isArray,c=o.isVariableLengthArray,l=o.valueType,u=o.enumType,d=s===Pn.STRING,h=s===Pn.BOOLEAN,_=0,y;if(c){let g=A(i.arrayOffsetType,i.offsetType);g=A(In[g],In.UINT32);let b=A(i.arrayOffsets,i.arrayOffsetBufferView);y=new M8(r[b],g,n+1),_+=y.typedArray.byteLength}let p=Pn.getComponentCount(s),C;c?C=y.get(n)-y.get(0):a?C=n*o.arrayLength:C=n;let x=p*C,T;if(d){let g=A(i.stringOffsetType,i.offsetType);g=A(In[g],In.UINT32);let b=A(i.stringOffsets,i.stringOffsetBufferView);T=new M8(r[b],g,x+1),_+=T.typedArray.byteLength}(d||h)&&(l=In.UINT8);let E;d?E=T.get(x)-T.get(0):h?E=Math.ceil(x/8):E=x;let S=A(i.values,i.bufferView),w=new M8(r[S],l,E);_+=w.typedArray.byteLength;let D=i.offset,I=i.scale,O=o.hasValueTransform||f(D)||f(I);D=A(D,o.offset),I=A(I,o.scale),D=aZ(D),I=aZ(I);let M,L,F=this;d?M=function(g){return ywe(g,F._values,F._stringOffsets)}:h?(M=function(g){return Awe(g,F._values)},L=function(g,b){Cwe(g,F._values,b)}):f(u)?(M=function(g){let b=F._values.get(g);return u.namesByValue[b]},L=function(g,b){let v=u.valuesByName[b];F._values.set(g,v)}):(M=function(g){return F._values.get(g)},L=function(g,b){F._values.set(g,b)}),this._arrayOffsets=y,this._stringOffsets=T,this._values=w,this._classProperty=o,this._count=n,this._vectorComponentCount=p,this._min=i.min,this._max=i.max,this._offset=D,this._scale=I,this._hasValueTransform=O,this._getValue=M,this._setValue=L,this._unpackedValues=void 0,this._extras=i.extras,this._extensions=i.extensions,this._byteLength=_}Object.defineProperties(qb.prototype,{hasValueTransform:{get:function(){return this._hasValueTransform}},offset:{get:function(){return this._offset}},scale:{get:function(){return this._scale}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}},byteLength:{get:function(){return this._byteLength}}});qb.prototype.get=function(t){let n=_we(this,t);return n=this._classProperty.handleNoData(n),f(n)?(n=this._classProperty.normalize(n),n=vwe(this,n),this._classProperty.unpackVectorAndMatrixTypes(n)):(n=this._classProperty.default,this._classProperty.unpackVectorAndMatrixTypes(n))};qb.prototype.set=function(t,n){let i=this._classProperty;n=i.packVectorAndMatrixTypes(n),n=Pwe(this,n),n=i.unnormalize(n),gwe(this,t,n)};qb.prototype.getTypedArray=function(){if(f(this._values))return this._values.typedArray};function aZ(t){if(!Array.isArray(t))return t;let n=[];for(let i=0;i<t.length;i++){let o=t[i];Array.isArray(o)?n.push.apply(n,o):n.push(o)}return n}function _we(t,n){lZ(t)&&uZ(t);let i=t._classProperty,o=i.isArray,r=i.type,s=Pn.getComponentCount(r);if(f(t._unpackedValues)){let a=t._unpackedValues[n];return o?tt(a,!0):a}return!o&&s===1?t._getValue(n):cZ(t,i,n)}function cZ(t,n,i){let o,r;if(n.isVariableLengthArray){o=t._arrayOffsets.get(i),r=t._arrayOffsets.get(i+1)-o;let a=Pn.getComponentCount(n.type);o*=a,r*=a}else{let c=A(n.arrayLength,1)*t._vectorComponentCount;o=i*c,r=c}let s=new Array(r);for(let a=0;a<r;a++)s[a]=t._getValue(o+a);return s}function gwe(t,n,i){wwe(t,n,i)&&uZ(t);let o=t._classProperty,r=o.isArray,s=o.type,a=Pn.getComponentCount(s);if(f(t._unpackedValues)){o.isArray&&(i=tt(i,!0)),t._unpackedValues[n]=i;return}if(!r&&a===1){t._setValue(n,i);return}let c,l;if(o.isVariableLengthArray)c=t._arrayOffsets.get(n),l=t._arrayOffsets.get(n+1)-c;else{let d=A(o.arrayLength,1)*t._vectorComponentCount;c=n*d,l=d}for(let u=0;u<l;++u)t._setValue(c+u,i[u])}function ywe(t,n,i){let o=i.get(t),r=i.get(t+1)-o;return bl(n.typedArray,o,r)}function Awe(t,n){let i=t>>3,o=t%8;return(n.typedArray[i]>>o&1)===1}function Cwe(t,n,i){let o=t>>3,r=t%8;i?n.typedArray[o]|=1<<r:n.typedArray[o]&=~(1<<r)}function xwe(t,n){let i=n.dataView,o=t*8,r=0,s=(i.getUint8(o+7)&128)>0,a=!0;for(let c=0;c<8;++c){let l=i.getUint8(o+c);s&&(a?l!==0&&(l=~(l-1)&255,a=!1):l=~l&255),r+=l*Math.pow(256,c)}return s&&(r=-r),r}function Twe(t,n){let i=n.dataView,o=t*8,r=BigInt(0),s=(i.getUint8(o+7)&128)>0,a=!0;for(let c=0;c<8;++c){let l=i.getUint8(o+c);s&&(a?l!==0&&(l=~(l-1)&255,a=!1):l=~l&255),r+=BigInt(l)*(BigInt(1)<<BigInt(c*8))}return s&&(r=-r),r}function Ewe(t,n){let i=n.dataView,o=t*8,r=i.getUint32(o,!0),s=i.getUint32(o+4,!0);return r+4294967296*s}function bwe(t,n){let i=n.dataView,o=t*8,r=BigInt(i.getUint32(o,!0)),s=BigInt(i.getUint32(o+4,!0));return r+BigInt(4294967296)*s}function Swe(t){switch(t){case In.INT8:return J.BYTE;case In.UINT8:return J.UNSIGNED_BYTE;case In.INT16:return J.SHORT;case In.UINT16:return J.UNSIGNED_SHORT;case In.INT32:return J.INT;case In.UINT32:return J.UNSIGNED_INT;case In.FLOAT32:return J.FLOAT;case In.FLOAT64:return J.DOUBLE}}function lZ(t){if(f(t._unpackedValues))return!1;let n=t._classProperty,i=n.type,o=n.valueType;return i===Pn.STRING||o===In.INT64&&!Vt.supportsBigInt64Array()||o===In.UINT64&&!Vt.supportsBigUint64Array()}function wwe(t,n,i){if(lZ(t))return!0;let o=t._arrayOffsets;if(f(o)){let r=o.get(n+1)-o.get(n),s=i.length;if(r!==s)return!0}return!1}function uZ(t){t._unpackedValues=Dwe(t),t._arrayOffsets=void 0,t._stringOffsets=void 0,t._values=void 0}function Dwe(t){let n=t._count,i=new Array(n),o=t._classProperty,r=o.isArray,s=o.type,a=Pn.getComponentCount(s);if(!r&&a===1){for(let c=0;c<n;++c)i[c]=t._getValue(c);return i}for(let c=0;c<n;c++)i[c]=cZ(t,o,c);return i}function vwe(t,n){let o=t._classProperty.isVariableLengthArray;return!t._hasValueTransform||o?n:v0.valueTransformInPlace(n,t._offset,t._scale,In.applyValueTransform)}function Pwe(t,n){let o=t._classProperty.isVariableLengthArray;return!t._hasValueTransform||o?n:v0.valueTransformInPlace(n,t._offset,t._scale,In.unapplyValueTransform)}function M8(t,n,i){let o=this,r,s,a;if(n===In.INT64)Vt.supportsBigInt()?Vt.supportsBigInt64Array()?(r=new BigInt64Array(t.buffer,t.byteOffset,i),a=function(c,l){o.typedArray[c]=BigInt(l)}):(r=new Uint8Array(t.buffer,t.byteOffset,i*8),s=function(c){return Twe(c,o)}):(Bt("INT64 type is not fully supported on this platform. Values greater than 2^53 - 1 or less than -(2^53 - 1) may lose precision when read."),r=new Uint8Array(t.buffer,t.byteOffset,i*8),s=function(c){return xwe(c,o)});else if(n===In.UINT64)Vt.supportsBigInt()?Vt.supportsBigUint64Array()?(r=new BigUint64Array(t.buffer,t.byteOffset,i),a=function(c,l){o.typedArray[c]=BigInt(l)}):(r=new Uint8Array(t.buffer,t.byteOffset,i*8),s=function(c){return bwe(c,o)}):(Bt("UINT64 type is not fully supported on this platform. Values greater than 2^53 - 1 may lose precision when read."),r=new Uint8Array(t.buffer,t.byteOffset,i*8),s=function(c){return Ewe(c,o)});else{let c=Swe(n);r=J.createArrayBufferView(c,t.buffer,t.byteOffset,i),a=function(l,u){o.typedArray[l]=u}}f(s)||(s=function(c){return o.typedArray[c]}),this.typedArray=r,this.dataView=new DataView(r.buffer,r.byteOffset),this.get=s,this.set=a,this._componentType=n}var BO=qb;function Sf(t){t=A(t,A.EMPTY_OBJECT);let n=t.count,i=t.class,o=0,r={};if(f(t.properties)){for(let s in t.properties)if(t.properties.hasOwnProperty(s)){let a=new BO({count:n,property:t.properties[s],classProperty:i.properties[s],bufferViews:t.bufferViews});r[s]=a,o+=a.byteLength}}this._count=n,this._class=i,this._properties=r,this._byteLength=o}Object.defineProperties(Sf.prototype,{count:{get:function(){return this._count}},class:{get:function(){return this._class}},byteLength:{get:function(){return this._byteLength}}});Sf.prototype.hasProperty=function(t){return Nn.hasProperty(t,this._properties,this._class)};Sf.prototype.hasPropertyBySemantic=function(t){return Nn.hasPropertyBySemantic(t,this._properties,this._class)};Sf.prototype.getPropertyIds=function(t){return Nn.getPropertyIds(this._properties,this._class,t)};Sf.prototype.getProperty=function(t,n){let i=this._properties[n],o;return f(i)?o=i.get(t):o=Iwe(this._class,n),o};Sf.prototype.setProperty=function(t,n,i){let o=this._properties[n];return f(o)?(o.set(t,i),!0):!1};Sf.prototype.getPropertyBySemantic=function(t,n){let i,o=this._class.propertiesBySemantic;if(f(o)&&(i=o[n]),f(i))return this.getProperty(t,i.id)};Sf.prototype.setPropertyBySemantic=function(t,n,i){let o,r=this._class.propertiesBySemantic;return f(r)&&(o=r[n]),f(o)?this.setProperty(t,o.id,i):!1};Sf.prototype.getPropertyTypedArray=function(t){let n=this._properties[t];if(f(n))return n.getTypedArray()};Sf.prototype.getPropertyTypedArrayBySemantic=function(t){let n,i=this._class.propertiesBySemantic;if(f(i)&&(n=i[t]),f(n))return this.getPropertyTypedArray(n.id)};function Iwe(t,n){let i=t.properties;if(!f(i))return;let o=i[n];if(f(o)&&f(o.default)){let r=o.default;return o.isArray&&(r=tt(r,!0)),r=o.normalize(r),o.unpackVectorAndMatrixTypes(r)}}var wf=Sf;function Bwe(t){t=A(t,A.EMPTY_OBJECT);let n=t.extension,i=t.schema,o=[];if(f(n.propertyTables))for(let a=0;a<n.propertyTables.length;a++){let c=n.propertyTables[a],l=i.classes[c.class],u=new wf({count:c.count,properties:c.properties,class:l,bufferViews:t.bufferViews});o.push(new Uc({id:a,name:c.name,count:c.count,metadataTable:u,extras:c.extras,extensions:c.extensions}))}let r=[];if(f(n.propertyTextures))for(let a=0;a<n.propertyTextures.length;a++){let c=n.propertyTextures[a];r.push(new BC({id:a,name:c.name,propertyTexture:c,class:i.classes[c.class],textures:t.textures}))}let s=[];if(f(n.propertyAttributes))for(let a=0;a<n.propertyAttributes.length;a++){let c=n.propertyAttributes[a];s.push(new OC({id:a,name:c.name,class:i.classes[c.class],propertyAttribute:c}))}return new Ea({schema:i,propertyTables:o,propertyTextures:r,propertyAttributes:s,statistics:n.statistics,extras:n.extras,extensions:n.extensions})}var OO=Bwe;function Owe(t){t=A(t,A.EMPTY_OBJECT);let n=t.extension,i=t.schema,o,r=[],s;if(f(n.featureTables))for(s=Object.keys(n.featureTables).sort(),o=0;o<s.length;o++){let c=s[o],l=n.featureTables[c],u=i.classes[l.class],d=new wf({count:l.count,properties:l.properties,class:u,bufferViews:t.bufferViews});r.push(new Uc({id:c,count:l.count,metadataTable:d,extras:l.extras,extensions:l.extensions}))}let a=[];if(f(n.featureTextures))for(s=Object.keys(n.featureTextures).sort(),o=0;o<s.length;o++){let c=s[o],l=n.featureTextures[c];a.push(new BC({id:c,propertyTexture:Rwe(l),class:i.classes[l.class],textures:t.textures}))}return new Ea({schema:i,propertyTables:r,propertyTextures:a,statistics:n.statistics,extras:n.extras,extensions:n.extensions})}function Rwe(t){let n={class:t.class,properties:{}},i=t.properties;for(let o in i)if(i.hasOwnProperty(o)){let r=i[o],s={channels:Mwe(r.channels),extras:r.extras,extensions:r.extensions};n.properties[o]=At(r.texture,s,!0)}return n}function Mwe(t){let n=t.length,i=new Array(n);for(let o=0;o<n;o++)i[o]="rgba".indexOf(t[o]);return i}var RO=Owe;function Xp(){}Object.defineProperties(Xp.prototype,{promise:{get:function(){Ce.throwInstantiationError()}},cacheKey:{get:function(){Ce.throwInstantiationError()}}});Xp.prototype.load=function(){Ce.throwInstantiationError()};Xp.prototype.unload=function(){};Xp.prototype.process=function(t){};Xp.prototype.getError=function(t,n){f(n)&&(t+=`
${n.message}`);let i=new he(t);return f(n)&&(i.stack=`Original stack:
${n.stack}
Handler stack:
${i.stack}`),i};Xp.prototype.isDestroyed=function(){return!1};Xp.prototype.destroy=function(){return this.unload(),ue(this)};var eo=Xp;var Lwe={UNLOADED:0,LOADING:1,PROCESSING:2,READY:3,FAILED:4},kt=Object.freeze(Lwe);function _m(t){t=A(t,A.EMPTY_OBJECT);let n=t.typedArray,i=t.resource,o=t.cacheKey;this._typedArray=n,this._resource=i,this._cacheKey=o,this._state=kt.UNLOADED,this._promise=void 0}f(Object.create)&&(_m.prototype=Object.create(eo.prototype),_m.prototype.constructor=_m);Object.defineProperties(_m.prototype,{promise:{get:function(){return this._promise}},cacheKey:{get:function(){return this._cacheKey}},typedArray:{get:function(){return this._typedArray}}});_m.prototype.load=function(){return f(this._typedArray)?this._promise=Promise.resolve(this):this._promise=Fwe(this),this._promise};function Fwe(t){let n=t._resource;return t._state=kt.LOADING,_m._fetchArrayBuffer(n).then(function(i){if(!t.isDestroyed())return t._typedArray=new Uint8Array(i),t._state=kt.READY,t}).catch(function(i){if(t.isDestroyed())return;t._state=kt.FAILED;let o=`Failed to load external buffer: ${n.url}`;return Promise.reject(t.getError(o,i))})}_m._fetchArrayBuffer=function(t){return t.fetchArrayBuffer()};_m.prototype.unload=function(){this._typedArray=void 0};var RC=_m;function Nwe(t,n){return f(t)&&f(t.extensions)&&f(t.extensions[n])}var Li=Nwe;var zLt=function(){"use strict";var t="B9h79tEBBBENQ9gEUEU9gEUB9gBB9gVUUUUUEU9gDUUEU9gLUUUUEU9gVUUUUUB9gLUUUUB9gIUUUEU9gD99UE99I8ayDILEVLEVLOOOOORRVBWWBEdddLVE9wEIIVIEBEOWEUEC+g/KEKR/QIhO9tw9t9vv95DBh9f9f939h79t9f9j9h229f9jT9vv7BB8a9tw79o9v9wT9fw9u9j9v9kw9WwvTw949C919m9mwvBE8f9tw79o9v9wT9fw9u9j9v9kw9WwvTw949C919m9mwv9C9v919u9kBDe9tw79o9v9wT9fw9u9j9v9kw9WwvTw949Wwv79p9v9uBIy9tw79o9v9wT9fw9u9j9v9kw69u9kw949C919m9mwvBL8e9tw79o9v9wT9fw9u9j9v9kw69u9kw949C919m9mwv9C9v919u9kBV8a9tw79o9v9wT9fw9u9j9v9kw69u9kw949Wwv79p9v9uBOe9tw79o9v9wT9fw9u9j9v9kw69u9kw949Twg91w9u9jwBRA9tw79o9v9wT9fw9u9j9v9kw69u9kw949Twg91w9u9jw9C9v919u9kBWl9tw79o9v9wT9fw9u9j9v9kws9p2Twv9P9jTBdk9tw79o9v9wT9fw9u9j9v9kws9p2Twv9R919hTBQl9tw79o9v9wT9fw9u9j9v9kws9p2Twvt949wBKe9tw79o9v9wT9f9v9wT9p9t9p96w9WwvTw94j9h9j9owBpA9tw79o9v9wT9f9v9wT9p9t9p96w9WwvTw94j9h9j9ow9TTv9p9wBSA9tw79o9v9wT9f9v9wT9p9t9p96w9WwvTw94swT9j9o9Sw9t9h9wBZL79iv9rBhdWEBCEKDxcQ+1tyDBK/hKEyU8jJJJJBCJO9rGV8kJJJJBCBHODNALCEFAE0MBABCBrB+Q+KJJBC+gEv86BBAVCJDFCBCJDZ+TJJJB8aDNAItMBAVCJDFADALZmJJJB8aKABAEFHRABCEFHWAVALFCBCBCJDAL9rALCfE0eZ+TJJJB8aAVAVCJDFALZmJJJBHdCJ/ABAL9uHEDNDNALtMBAEC/wfBgGECJDAECJD6eHQCBHKINAKAI9PMEAdCJLFCBCJDZ+TJJJB8aAQAIAK9rAKAQFAI6eGXCSFGECL4CIFCD4HMADAKAL2FHpDNDNDNDNDNAEC9wgGStMBCBHZCEHhApHoAWHaXEKDNAXtMBCBHaCEHhApHcINAdAaFrBBHxAcHECBHOINAdCJLFAOFAErBBGqAx9rGxCETAxCkTCk91CR4786BBAEALFHEAqHxAOCEFGOAX9HMBKARAW9rAM6MIAWCBAMZ+TJJJBGEtMIAEAMFHWAcCEFHcAaCEFGaAL6HhAaAL9HMBXVKKARAW9rAM6MOAWCBAMZ+TJJJB8aCEHEINAWGxAMFHWALAEGOsMLDNARAW9rAM6MBAOCEFHEAWCBAMZ+TJJJB8aAxMEKKCBHWAOAL6MOXIKINDNAXtMBAdAZFrBBHxCBHEAoHOINAdCJLFAEFAOrBBGqAx9rGxCETAxCkTCk91CR4786BBAOALFHOAqHxAECEFGEAX9HMBKKARAa9rAM6MEARAaCBAMZ+TJJJBGlAMFGW9rCk6MDCBHkAdCJLFHcINAdCJLFAkFHyCWH8aCZHaCEHqINDNDNAqCE9HMBCUHOAyrBBMECBHODNINAOGECSsMEAECEFHOAcAEFCEFrBBtMBKKCUCBAECS6eHOXEKAqCETC/+fffEgHOCUAqTCU7CfEgHxCBHEINAOAxAcAEFrBB9NFHOAECEFGECZ9HMBKKAOAaAOAa6GEeHaAqA8aAEeH8aAqCETGqCW6MBKDNDNDNDNA8aCUFpDIEBKAlAkCO4FGEAErBBCDCIA8aCLseAkCI4COgTv86BBA8aCW9HMEAWAy8pBB83BBAWCWFAyCWF8pBB83BBAWCZFHWXDKAlAkCO4FGEAErBBCEAkCI4COgTv86BBKDNCWA8a9tGeMBINAWCB86BBAWCEFHWXBKKCUA8aTCU7HqCBH3AcH5INA5HEAeHxCBHOINAErBBGaAqAaAqCfEgGy6eAOCfEgA8aTvHOAECEFHEAxCUFGxMBKAWAO86BBA5AeFH5AWCEFHWA3AeFG3CZ6MBKCBHEINDNAcAEFrBBGOAy6MBAWAO86BBAWCEFHWKAECEFGECZ9HMBKKDNAkCZFGkAS9PMBAcCZFHcARAW9rCl0MEKKAkAS6MEAWtMEAoCEFHoAZCEFGZAL6HhAWHaAZALsMIXBKKCBHWAhCEgtMEXLKCBHWAhCEgMIKAdApAXCUFAL2FALZmJJJB8aAXAKFHKAWMBKCBHOXDKCBHOARAW9rCAALALCA6e6MEDNALC8f0MBAWCBCAAL9rGEZ+TJJJBAEFHWKAWAdCJDFALZmJJJBALFAB9rHOXEKCBHOKAVCJOF8kJJJJBAOK9HEEUAECAAECA0eABCJ/ABAE9uC/wfBgGDCJDADCJD6eGDFCUFAD9uAE2ADCL4CIFCD4ADv2FCEFKMBCBABbD+Q+KJJBK/YSE3U8jJJJJBC/AE9rGL8kJJJJBCBHVDNAICI9uGOChFAE0MBABCBYDn+KJJBGVC/gEv86BBALC/ABFCfECJEZ+TJJJB8aALCuFGR9CU83IBALC8wFGW9CU83IBALCYFGd9CU83IBALCAFGQ9CU83IBALCkFGK9CU83IBALCZFGX9CU83IBAL9CU83IWAL9CU83IBABAEFC9wFHMABCEFGpAOFHEDNAItMBCMCSAVCB9KGSeHZAVCE9IHhCBHoCBHaCBHcCBHxCBHqINDNAEAM9NMBCBHVXIKAqCUFHVADAcCDTFGOYDBHlAOCWFYDBHkAOCLFYDBHyCBH8aDNDNINALC/ABFAVCSgCITFGOYDLHeDNDNDNAOYDBGOAl9HMBAeAysMEKDNAOAy9HMBAeAk9HMBA8aCEFH8aXEKAOAk9HMEAeAl9HMEA8aCDFH8aKA8aC870MDAxCUFHVADA8aCIgCX2GOC+Y1JJBFYDBAcFCDTFYDBHeADAOCn1JJBFYDBAcFCDTFYDBHkADAOC+Q1JJBFYDBAcFCDTFYDBHlCBHODNINDNALAVCSgCDTFYDBAe9HMBAOHyXDKCUHyAVCUFHVAOCEFGOCZ9HMBKKAyCB9KAyAZ9IgGVCU7AeAosGOgH3DNDNDNDNDNAyCBCSAOeAVeGVCS9HMBAhMBAeAeAaAeCEFAasGVeGaCEFsMECMCSAVeHVKApAVA8aCDTC/wEgv86BBAVCS9HMEAeAa9rGVCETAVC8f917HVINAEAVCfB0CRTAVCfBgv86BBAECEFHEAVCJE6HOAVCR4HVAOtMBKAeHaXDKCpHVApA8aCDTCpv86BBAeHaKAVtMBAVAZ9IMEKALAxCDTFAebDBAxCEFCSgHxKAoA3FHoALC/ABFAqCITFGVAkbDLAVAebDBALC/ABFAqCEFCSgGVCITFGOAebDLAOAlbDBAVCEFHOXIKAVCUFHVA8aCLFG8aC/AB9HMBKKDNADCEAkAosCETAyAoseCX2GVC+Q1JJBFYDBAcFCDTFYDBGltADAVCn1JJBFYDBAcFCDTFYDBG8aCEsgADAVC+Y1JJBFYDBAcFCDTFYDBGyCDsgAoCB9HgASgG5CE9HMBAR9CU83IBAW9CU83IBAd9CU83IBAQ9CU83IBAK9CU83IBAX9CU83IBAL9CU83IWAL9CU83IBCBHoKCBHeAxCUFGVHODNINDNALAOCSgCDTFYDBA8a9HMBAeHkXDKCUHkAOCUFHOAeCEFGeCZ9HMBKKCBHODNINDNALAVCSgCDTFYDBAy9HMBAOHeXDKCUHeAVCUFHVAOCEFGOCZ9HMBKKAoAlAosG8eFH3DNDNAkCM0MBAkCEFHkXEKCBCSA8aA3sGVeHkA3AVFH3KDNDNAeCM0MBAeCEFHeXEKCBCSAyA3sGVeHeA3AVFH3KC9+CUA8eeH8fAeAkCLTvHOCBHVDNDNDNINAVCJ1JJBFrBBAOCfEgsMEAVCEFGVCZ9HMBXDKKAlAo9HAVCM0vA5vMBApAVC/wEv86BBXEKApA8f86BBAEAO86BBAECEFHEKDNA8eMBAlAa9rGVCETAVC8f917HVINAEAVCfB0GOCRTAVCfBgv86BBAVCR4HVAECEFHEAOMBKAlHaKDNAkCS9HMBA8aAa9rGVCETAVC8f917HVINAEAVCfB0GOCRTAVCfBgv86BBAVCR4HVAECEFHEAOMBKA8aHaKDNAeCS9HMBAyAa9rGVCETAVC8f917HVINAEAVCfB0GOCRTAVCfBgv86BBAVCR4HVAECEFHEAOMBKAyHaKALAxCDTFAlbDBAxCEFCSgHVDNDNAkpZBEEEEEEEEEEEEEEBEKALAVCDTFA8abDBAxCDFCSgHVKDNDNAepZBEEEEEEEEEEEEEEBEKALAVCDTFAybDBAVCEFCSgHVKALC/ABFAqCITFGOAlbDLAOA8abDBALC/ABFAqCEFCSgCITFGOA8abDLAOAybDBALC/ABFAqCDFCSgCITFGOAybDLAOAlbDBAqCIFHOAVHxA3HoKApCEFHpAOCSgHqAcCIFGcAI6MBKKCBHVAEAM0MBCBHVINAEAVFAVCJ1JJBFrBB86BBAVCEFGVCZ9HMBKAEAB9rAVFHVKALC/AEF8kJJJJBAVKzEEUCBHDDNINADCEFGDC8f0MECEADTAE6MBKKADCRFCfEgCR9uCI2CDFABCI9u2ChFKMBCBABbDn+KJJBK+cDEWU8jJJJJBCZ9rHLCBHVDNAICVFAE0MBCBHOABCBrBn+KJJBC/QEv86BBAL9CB83IWABCEFHRABAEFC98FHWDNAItMBCBHdINDNARAW6MBCBSKADAdCDTFYDBGQALCWFAOAQALCWFAOCDTFYDB9rGEAEC8f91GEFAE7C507GOCDTFGKYDB9rGEC8e91C9+gAECDT7AOvHEINARAECfB0GVCRTAECfBgv86BBAECR4HEARCEFHRAVMBKAKAQbDBAdCEFGdAI9HMBKKCBHVARAW0MBARCBbBBARAB9rCLFHVKAVKbEEUCBHDDNINADCEFGDC8f0MECEADTAE6MBKKADCWFCfEgCR9uAB2CVFK+DVLI99DUI99LUDNAEtMBCUADCETCUFTCU7+yHVDNDNCUAICUFTCU7+yGOjBBBzmGR+LjBBB9P9dtMBAR+oHWXEKCJJJJ94HWKCBHICBHdINALCLFiDBGRjBBBBjBBJzALiDBGQ+LAR+LmALCWFiDBGK+LmGR+VARjBBBB9beGRnHXAQARnHRALCXFiDBHQDNDNAKjBBBB9gtMBAXHKXEKjBBJzAR+L+TGKAK+MAXjBBBB9geHKjBBJzAX+L+TGXAX+MARjBBBB9geHRKDNDNAQjBBJ+/AQjBBJ+/9geGXjBBJzAXjBBJz9feAVnjBBBzjBBB+/AQjBBBB9gemGQ+LjBBB9P9dtMBAQ+oHMXEKCJJJJ94HMKDNDNAKjBBJ+/AKjBBJ+/9geGQjBBJzAQjBBJz9feAOnjBBBzjBBB+/AKjBBBB9gemGQ+LjBBB9P9dtMBAQ+oHpXEKCJJJJ94HpKDNDNARjBBJ+/ARjBBJ+/9geGQjBBJzAQjBBJz9feAOnjBBBzjBBB+/ARjBBBB9gemGR+LjBBB9P9dtMBAR+oHSXEKCJJJJ94HSKDNDNADCL9HMBABAdFGZAS86BBAZCIFAM86BBAZCDFAW86BBAZCEFAp86BBXEKABAIFGZAS87EBAZCOFAM87EBAZCLFAW87EBAZCDFAp87EBKALCZFHLAICWFHIAdCLFHdAECUFGEMBKKK/KLLD99EUD99EUDNAEtMBDNDNCUAICUFTCU7+yGVjBBBzmGO+LjBBB9P9dtMBAO+oHIXEKCJJJJ94HIKAIC/8fIgHRINABCOFCICDALCLFiDB+LALiDB+L9eGIALCWFiDB+LALAICDTFiDB+L9eeGIALCXFiDB+LALAICDTFiDB+L9eeGIARv87EBDNDNALAICEFCIgCDTFiDBj/zL+1znjBBJ+/jBBJzALAICDTFiDBjBBBB9deGOnGWjBBJ+/AWjBBJ+/9geGdjBBJzAdjBBJz9feAVnjBBBzjBBB+/AWjBBBB9gemGW+LjBBB9P9dtMBAW+oHQXEKCJJJJ94HQKABAQ87EBDNDNAOALAICDFCIgCDTFiDBj/zL+1znnGWjBBJ+/AWjBBJ+/9geGdjBBJzAdjBBJz9feAVnjBBBzjBBB+/AWjBBBB9gemGW+LjBBB9P9dtMBAW+oHQXEKCJJJJ94HQKABCDFAQ87EBDNDNAOALAICUFCIgCDTFiDBj/zL+1znnGOjBBJ+/AOjBBJ+/9geGWjBBJzAWjBBJz9feAVnjBBBzjBBB+/AOjBBBB9gemGO+LjBBB9P9dtMBAO+oHIXEKCJJJJ94HIKABCLFAI87EBABCWFHBALCZFHLAECUFGEMBKKK+7DDWUE998jJJJJBCZ9rGV8kJJJJBDNAEtMBADCL6MBCEAI9rHOADCD4GDCEADCE0eHRADCDTHWCBHdINC+cUHDALHIARHQINAIiDBAVCXFZ+XJJJB8aAVYDXGKADADAK9IeHDAICLFHIAQCUFGQMBKAOADFGICkTHKCBHDCBAI9rHXARHIINDNDNALADFiDBGMAXZ+WJJJBjBBBzjBBB+/AMjBBBB9gemGM+LjBBB9P9dtMBAM+oHQXEKCJJJJ94HQKABADFAQCfffRgAKvbDBADCLFHDAICUFGIMBKABAWFHBALAWFHLAdCEFGdAE9HMBKKAVCZF8kJJJJBK/tKDcUI998jJJJJBC+QD9rGV8kJJJJBAVC+oEFCBC/kBZ+TJJJB8aCBHODNADtMBCBHOAItMBDNABAE9HMBAVCUADCDTGOADCffffI0eCBYD1+KJJBhJJJJBBGEbD+oEAVCEbD1DAEABAOZmJJJB8aKAVC+YEFCWFCBbDBAV9CB83I+YEAVC+YEFAEADAIAVC+oEFZ+NJJJBCUAICDTGRAICffffI0eGWCBYD1+KJJBhJJJJBBHOAVC+oEFAVYD1DGdCDTFAObDBAVAdCEFGQbD1DAOAVYD+YEGKARZmJJJBHXAVC+oEFAQCDTFADCI9uGMCBYD1+KJJBhJJJJBBGObDBAVAdCDFGRbD1DAOCBAMZ+TJJJBHpAVC+oEFARCDTFAWCBYD1+KJJBhJJJJBBGSbDBAVAdCIFGQbD1DAXHOASHRINARALiDBALAOYDBGWCWAWCW6eCDTFC/EBFiDBmuDBAOCLFHOARCLFHRAICUFGIMBKAVC+oEFAQCDTFCUAMCDTADCffff970eCBYD1+KJJBhJJJJBBGQbDBAVAdCLFbD1DDNADCI6MBAMCEAMCE0eHIAEHOAQHRINARASAOYDBCDTFiDBASAOCLFYDBCDTFiDBmASAOCWFYDBCDTFiDBmuDBAOCXFHOARCLFHRAICUFGIMBKKAVC/MBFHZAVYD+cEHhAVYD+gEHoAVHOCBHWCBHRCBHaCEHcINAOHxCIHqAEARCI2GlCDTFGOCWFYDBHkAOYDBHDABAaCX2FGICLFAOCLFYDBGdbDBAIADbDBAICWFAkbDBApARFCE86BBAZAkbDWAZAdbDLAZADbDBAQARCDTFCBbDBDNAWtMBCIHqAxHIINDNAIYDBGOADsMBAOAdsMBAOAksMBAZAqCDTFAObDBAqCEFHqKAICLFHIAWCUFGWMBKKAaCEFHaAXADCDTFGOAOYDBCUFbDBAXAdCDTFGOAOYDBCUFbDBAXAkCDTFGOAOYDBCUFbDBCBHWINAoAhAEAWAlFCDTFYDBCDTGIFYDBCDTFGkHOAKAIFGdYDBGDHIDNADtMBDNINAOYDBARsMEAOCLFHOAICUFGItMDXBKKAOADCDTAkFC98FYDBbDBAdAdYDBCUFbDBKAWCEFGWCI9HMBKDNDNDNAqtMBCUHRjBBBBHyCBHOINASAZAOCDTFYDBCDTGIFGWiDBH8aAWALCBAOCEFGdAOCS0eCDTFiDBALAXAIFYDBGOCWAOCW6eCDTFC/EBFiDBmGeuDBDNAKAIFYDBGWtMBAeA8a+THeAoAhAIFYDBCDTFHOAWCDTHIINAQAOYDBGWCDTFGDAeADiDBmG8auDBA8aAyAyA8a9dGDeHyAWARADeHRAOCLFHOAIC98FGIMBKKAdHOAdAq9HMBKARCU9HMEKAcAM9PMEINDNApAcFrBBMBAcHRXDKAMAcCEFGc9HMBXDKKAqCZAqCZ6eHWAZHOAxHZARCU9HMEKKAVYD1DHOKAOCDTAVC+oEFFC98FHRDNINAOtMEARYDBCBYD+E+KJJBh+BJJJBBARC98FHRAOCUFHOXBKKAVC+QDF8kJJJJBK/uLEVUCUAICDTGVAICffffI0eGOCBYD1+KJJBhJJJJBBHRALALYD9gGWCDTFARbDBALAWCEFbD9gABARbDBAOCBYD1+KJJBhJJJJBBHRALALYD9gGOCDTFARbDBALAOCEFbD9gABARbDLCUADCDTADCffffI0eCBYD1+KJJBhJJJJBBHRALALYD9gGOCDTFARbDBALAOCEFbD9gABARbDWABYDBCBAVZ+TJJJB8aADCI9uHWDNADtMBABYDBHOAEHLADHRINAOALYDBCDTFGVAVYDBCEFbDBALCLFHLARCUFGRMBKKDNAItMBABYDBHLABYDLHRCBHVAIHOINARAVbDBARCLFHRALYDBAVFHVALCLFHLAOCUFGOMBKKDNADCI6MBAWCEAWCE0eHdABYDLHRABYDWHVCBHLINAECWFYDBHOAECLFYDBHDARAEYDBCDTFGWAWYDBGWCEFbDBAVAWCDTFALbDBARADCDTFGDADYDBGDCEFbDBAVADCDTFALbDBARAOCDTFGOAOYDBGOCEFbDBAVAOCDTFALbDBAECXFHEAdALCEFGL9HMBKKDNAItMBABYDLHEABYDBHLINAEAEYDBALYDB9rbDBALCLFHLAECLFHEAICUFGIMBKKKqBABAEADAIC+01JJBZ+MJJJBKqBABAEADAIC+c+JJJBZ+MJJJBK9dEEUABCfEAICDTZ+TJJJBHLCBHIDNADtMBINDNALAEYDBCDTFGBYDBCU9HMBABAIbDBAICEFHIKAECLFHEADCUFGDMBKKAIK9TEIUCBCBYD+M+KJJBGEABCIFC98gFGBbD+M+KJJBDNDNABzBCZTGD9NMBCUHIABAD9rCffIFCZ4NBCUsMEKAEHIKAIK/lEEEUDNDNAEABvCIgtMBABHIXEKDNDNADCZ9PMBABHIXEKABHIINAIAEYDBbDBAICLFAECLFYDBbDBAICWFAECWFYDBbDBAICXFAECXFYDBbDBAICZFHIAECZFHEADC9wFGDCS0MBKKADCL6MBINAIAEYDBbDBAECLFHEAICLFHIADC98FGDCI0MBKKDNADtMBINAIAErBB86BBAICEFHIAECEFHEADCUFGDMBKKABK/AEEDUDNDNABCIgtMBABHIXEKAECfEgC+B+C+EW2HLDNDNADCZ9PMBABHIXEKABHIINAIALbDBAICXFALbDBAICWFALbDBAICLFALbDBAICZFHIADC9wFGDCS0MBKKADCL6MBINAIALbDBAICLFHIADC98FGDCI0MBKKDNADtMBINAIAE86BBAICEFHIADCUFGDMBKKABK9TEIUCBCBYD+M+KJJBGEABCIFC98gFGBbD+M+KJJBDNDNABzBCZTGD9NMBCUHIABAD9rCffIFCZ4NBCUsMEKAEHIKAIK9+EIUzBHEDNDNCBYD+M+KJJBGDAECZTGI9NMBCUHEADAI9rCffIFCZ4NBCUsMEKADHEKCBABAE9rCIFC98gCBYD+M+KJJBFGDbD+M+KJJBDNADzBCZTGE9NMBADAE9rCffIFCZ4NB8aKKXBABAEZ+YJJJBK+BEEIUDNAB+8GDCl4GICfEgGLCfEsMBDNALMBDNABjBBBB9cMBAECBbDBABSKABjBBJ9fnAEZ+XJJJBHBAEAEYDBCNFbDBABSKAEAICfEgC+CUFbDBADCfff+D94gCJJJ/4Iv++HBKABK+gEBDNDNAECJE9IMBABjBBBUnHBDNAECfE9PMBAEC+BUFHEXDKABjBBBUnHBAECPDAECPD6eC+C9+FHEXEKAEC+BU9KMBABjBBJXnHBDNAEC+b9+9NMBAEC/mBFHEXEKABjBBJXnHBAEC+299AEC+2990eC/MEFHEKABAEClTCJJJ/8IF++nKK+eDDBCJWK+EDB4+H9W9n94+p+Gw+J9o+YE9pBBBBBBEBBBDBBBEBBBDBBBBBBBDBBBBBBBEBBBBBBB+L29Hz/69+9Kz/n/76z/RG97z/Z/O9Xz8j/b85z/+/U9Yz/B/K9hz+2/z9dz9E+L9Mz59a8kz+R/t3z+a+Zyz79ohz/J4++8++y+d9v8+BBBB9S+49+z8r+Hbz9m9m/m8+l/Z/O8+/8+pg89Q/X+j878r+Hq8++m+b/E87BBBBBBJzBBJzBBJz+e/v/n8++y+dSz9I/h/68+XD/r8+/H0838+/w+nOzBBBB+wv9o8+UF888+9I/h/68+9C9g/l89/N/M9M89/d8kO8+BBBBF+8Tz9M836zs+2azl/Zpzz818ez9E+LXz/u98f8+819e/68+BC+EQKXEBBBDBBBAwBB",n=new Uint8Array([32,0,65,2,1,106,34,33,3,128,11,4,13,64,6,253,10,7,15,116,127,5,8,12,40,16,19,54,20,9,27,255,113,17,42,67,24,23,146,148,18,14,22,45,70,69,56,114,101,21,25,63,75,136,108,28,118,29,73,115]);if(typeof WebAssembly!="object")return{supported:!1};var i,o=WebAssembly.instantiate(r(t),{}).then(function(_){i=_.instance,i.exports.__wasm_call_ctors(),i.exports.meshopt_encodeVertexVersion(0),i.exports.meshopt_encodeIndexVersion(1)});function r(_){for(var y=new Uint8Array(_.length),p=0;p<_.length;++p){var C=_.charCodeAt(p);y[p]=C>96?C-71:C>64?C-65:C>47?C+4:C>46?63:62}for(var x=0,p=0;p<_.length;++p)y[x++]=y[p]<60?n[y[p]]:(y[p]-60)*64+y[++p];return y.buffer.slice(0,x)}function s(_){if(!_)throw new Error("Assertion failed")}function a(_){return new Uint8Array(_.buffer,_.byteOffset,_.byteLength)}function c(_,y,p){var C=i.exports.sbrk,x=C(_.length*4),T=C(y*4),E=new Uint8Array(i.exports.memory.buffer),S=a(_);E.set(S,x),p&&p(x,x,_.length,y);var w=i.exports.meshopt_optimizeVertexFetchRemap(T,x,_.length,y);E=new Uint8Array(i.exports.memory.buffer);var D=new Uint32Array(y);new Uint8Array(D.buffer).set(E.subarray(T,T+y*4)),S.set(E.subarray(x,x+_.length*4)),C(x-C(0));for(var I=0;I<_.length;++I)_[I]=D[_[I]];return[D,w]}function l(_,y,p,C,x){var T=i.exports.sbrk,E=T(y),S=T(C*x),w=new Uint8Array(i.exports.memory.buffer);w.set(a(p),S);var D=_(E,y,S,C,x),I=new Uint8Array(D);return I.set(w.subarray(E,E+D)),T(E-T(0)),I}function u(_){for(var y=0,p=0;p<_.length;++p){var C=_[p];y=y<C?C:y}return y}function d(_,y){if(s(y==2||y==4),y==4)return new Uint32Array(_.buffer,_.byteOffset,_.byteLength/4);var p=new Uint16Array(_.buffer,_.byteOffset,_.byteLength/2);return new Uint32Array(p)}function h(_,y,p,C,x,T){var E=i.exports.sbrk,S=E(p*C),w=E(p*T),D=new Uint8Array(i.exports.memory.buffer);D.set(a(y),w),_(S,p,C,x,w);var I=new Uint8Array(p*C);return I.set(D.subarray(S,S+p*C)),E(S-E(0)),I}return{ready:o,supported:!0,reorderMesh:function(_,y,p){var C=y?p?i.exports.meshopt_optimizeVertexCacheStrip:i.exports.meshopt_optimizeVertexCache:void 0;return c(_,u(_)+1,C)},encodeVertexBuffer:function(_,y,p){s(p>0&&p<=256),s(p%4==0);var C=i.exports.meshopt_encodeVertexBufferBound(y,p);return l(i.exports.meshopt_encodeVertexBuffer,C,_,y,p)},encodeIndexBuffer:function(_,y,p){s(p==2||p==4),s(y%3==0);var C=d(_,p),x=i.exports.meshopt_encodeIndexBufferBound(y,u(C)+1);return l(i.exports.meshopt_encodeIndexBuffer,x,C,y,4)},encodeIndexSequence:function(_,y,p){s(p==2||p==4);var C=d(_,p),x=i.exports.meshopt_encodeIndexSequenceBound(y,u(C)+1);return l(i.exports.meshopt_encodeIndexSequence,x,C,y,4)},encodeGltfBuffer:function(_,y,p,C){var x={ATTRIBUTES:this.encodeVertexBuffer,TRIANGLES:this.encodeIndexBuffer,INDICES:this.encodeIndexSequence};return s(x[C]),x[C](_,y,p)},encodeFilterOct:function(_,y,p,C){return s(p==4||p==8),s(C>=1&&C<=16),h(i.exports.meshopt_encodeFilterOct,_,y,p,C,16)},encodeFilterQuat:function(_,y,p,C){return s(p==8),s(C>=4&&C<=16),h(i.exports.meshopt_encodeFilterQuat,_,y,p,C,16)},encodeFilterExp:function(_,y,p,C){return s(p>0&&p%4==0),s(C>=1&&C<=24),h(i.exports.meshopt_encodeFilterExp,_,y,p,C,p)}}}();var fZ=function(){"use strict";var t="B9h79tEBBBE8fV9gBB9gVUUUUUEU9gIUUUB9gEUEU9gIUUUEUIKQBEEEDDDILLVIEBEOWEUEC+Q/IEKR/LEdO9tw9t9vv95DBh9f9f939h79t9f9j9h229f9jT9vv7BB8a9tw79o9v9wT9f9kw9j9v9kw9WwvTw949C919m9mwvBEy9tw79o9v9wT9f9kw9j9v9kw69u9kw949C919m9mwvBDe9tw79o9v9wT9f9kw9j9v9kw69u9kw949Twg91w9u9jwBIl9tw79o9v9wT9f9kw9j9v9kws9p2Twv9P9jTBLk9tw79o9v9wT9f9kw9j9v9kws9p2Twv9R919hTBVl9tw79o9v9wT9f9kw9j9v9kws9p2Twvt949wBOL79iv9rBRQ+p8yQDBK/3SEZU8jJJJJBCJ/EB9rGV8kJJJJBC9+HODNADCEFAL0MBCUHOAIrBBC+gE9HMBAVAIALFGRAD9rADZ1JJJBHWCJ/ABAD9uHOAICEFHLDNADtMBAOC/wfBgGOCJDAOCJD6eHdCBHQINAQAE9PMEAdAEAQ9rAQAdFAE6eGKCSFGOCL4CIFCD4HXDNDNDNDNAOC9wgGMtMBCBHpCEHSAWCJDFHZALHhINARAh9rAX6MIDNARAhAXFGL9rCk6MBCZHOINAWCJ/CBFAOGIFGOC9wFHoDNDNDNDNDNAhAIC9wFGaCO4FrBBAaCI4COg4CIgpLBEDIBKAo9CB83IBAoCWF9CB83IBXIKAoALrBLALrBBGaCO4GcAcCIsGce86BBAOCgFALCLFAcFGorBBAaCL4CIgGcAcCIsGce86BBAOCvFAoAcFGorBBAaCD4CIgGcAcCIsGce86BBAOC7FAoAcFGorBBAaCIgGaAaCIsGae86BBAOCTFAoAaFGarBBALrBEGoCO4GcAcCIsGce86BBAOC91FAaAcFGarBBAoCL4CIgGcAcCIsGce86BBAOC4FAaAcFGarBBAoCD4CIgGcAcCIsGce86BBAOC93FAaAcFGarBBAoCIgGoAoCIsGoe86BBAOC94FAaAoFGarBBALrBDGoCO4GcAcCIsGce86BBAOC95FAaAcFGarBBAoCL4CIgGcAcCIsGce86BBAOC96FAaAcFGarBBAoCD4CIgGcAcCIsGce86BBAOC97FAaAcFGarBBAoCIgGoAoCIsGoe86BBAOC98FAaAoFGorBBALrBIGLCO4GaAaCIsGae86BBAOC99FAoAaFGorBBALCL4CIgGaAaCIsGae86BBAOC9+FAoAaFGorBBALCD4CIgGaAaCIsGae86BBAOCUFAoAaFGOrBBALCIgGLALCIsGLe86BBAOALFHLXDKAoALrBWALrBBGaCL4GcAcCSsGce86BBAOCgFALCWFAcFGorBBAaCSgGaAaCSsGae86BBAOCvFAoAaFGorBBALrBEGaCL4GcAcCSsGce86BBAOC7FAoAcFGorBBAaCSgGaAaCSsGae86BBAOCTFAoAaFGorBBALrBDGaCL4GcAcCSsGce86BBAOC91FAoAcFGorBBAaCSgGaAaCSsGae86BBAOC4FAoAaFGorBBALrBIGaCL4GcAcCSsGce86BBAOC93FAoAcFGorBBAaCSgGaAaCSsGae86BBAOC94FAoAaFGorBBALrBLGaCL4GcAcCSsGce86BBAOC95FAoAcFGorBBAaCSgGaAaCSsGae86BBAOC96FAoAaFGorBBALrBVGaCL4GcAcCSsGce86BBAOC97FAoAcFGorBBAaCSgGaAaCSsGae86BBAOC98FAoAaFGorBBALrBOGaCL4GcAcCSsGce86BBAOC99FAoAcFGorBBAaCSgGaAaCSsGae86BBAOC9+FAoAaFGorBBALrBRGLCL4GaAaCSsGae86BBAOCUFAoAaFGOrBBALCSgGLALCSsGLe86BBAOALFHLXEKAoAL8pBB83BBAoCWFALCWF8pBB83BBALCZFHLKDNAIAM9PMBAICZFHOARAL9rCl0MEKKAIAM6MIALtMIDNAKtMBAWApFrBBHoCBHOAZHIINAIAWCJ/CBFAOFrBBGaCE4CBAaCEg9r7AoFGo86BBAIADFHIAOCEFGOAK9HMBKKAZCEFHZApCEFGpAD6HSALHhApAD9HMEXVKKCBHLASCEgMDXIKALAXAD2FHcDNAKtMBCBHhCEHSAWCJDFHMINARAL9rAX6MIALtMDALAXFHLAWAhFrBBHoCBHOAMHIINAIAWCJ/CBFAOFrBBGaCE4CBAaCEg9r7AoFGo86BBAIADFHIAOCEFGOAK9HMBKAMCEFHMAhCEFGhAD6HSAhAD9HMBKAcHLXIKCBHOCEHSINARAL9rAX6MDALtMEALAXFHLAOCEFGOAD6HSADAO9HMBKAcHLXDKCBHLASCEgtMEKC9+HOXIKABAQAD2FAWCJDFAKAD2Z1JJJB8aAWAWCJDFAKCUFAD2FADZ1JJJB8aAKAQFHQALMBKC9+HOXEKCBC99ARAL9rADCAADCA0eseHOKAVCJ/EBF8kJJJJBAOK/YZEhU8jJJJJBC/AE9rGV8kJJJJBC9+HODNAECI9uGRChFAL0MBCUHOAIrBBGWC/wEgC/gE9HMBAWCSgGdCE0MBAVC/ABFCfECJEZ+JJJJB8aAVCuF9CU83IBAVC8wF9CU83IBAVCYF9CU83IBAVCAF9CU83IBAVCkF9CU83IBAVCZF9CU83IBAV9CU83IWAV9CU83IBAIALFC9wFHQAICEFGWARFHODNAEtMBCMCSAdCEseHKCBHXCBHMCBHdCBHICBHLINDNAOAQ9NMBC9+HOXIKDNDNAWrBBGRC/vE0MBAVC/ABFALARCL4CU7FCSgCITFGpYDLHSApYDBHZDNARCSgGpAK9PMBAVAIARCU7FCSgCDTFYDBAXApeHRAptHpDNDNADCD9HMBABAdCETFGhAZ87EBAhCDFAS87EBAhCLFAR87EBXEKABAdCDTFGhAZbDBAhCLFASbDBAhCWFARbDBKAXApFHXAVC/ABFALCITFGhARbDBAhASbDLAVAICDTFARbDBAVC/ABFALCEFCSgGLCITFGhAZbDBAhARbDLAIApFHIALCEFHLXDKDNDNApCSsMBAMApFApC987FCEFHMXEKAOCEFHRAO8sBBGpCfEgHhDNDNApCU9MMBARHOXEKAOCVFHOAhCfBgHhCRHpDNINAR8sBBGoCfBgApTAhvHhAoCU9KMEARCEFHRApCRFGpC8j9HMBXDKKARCEFHOKAhCE4CBAhCEg9r7AMFHMKDNDNADCD9HMBABAdCETFGRAZ87EBARCDFAS87EBARCLFAM87EBXEKABAdCDTFGRAZbDBARCLFASbDBARCWFAMbDBKAVC/ABFALCITFGRAMbDBARASbDLAVAICDTFAMbDBAVC/ABFALCEFCSgGLCITFGRAZbDBARAMbDLAICEFHIALCEFHLXEKDNARCPE0MBAXCEFGoAVAIAQARCSgFrBBGpCL49rCSgCDTFYDBApCZ6GheHRAVAIAp9rCSgCDTFYDBAoAhFGSApCSgGoeHpAotHoDNDNADCD9HMBABAdCETFGZAX87EBAZCDFAR87EBAZCLFAp87EBXEKABAdCDTFGZAXbDBAZCLFARbDBAZCWFApbDBKAVAICDTFAXbDBAVC/ABFALCITFGZARbDBAZAXbDLAVAICEFGICSgCDTFARbDBAVC/ABFALCEFCSgCITFGZApbDBAZARbDLAVAIAhFCSgGICDTFApbDBAVC/ABFALCDFCSgGLCITFGRAXbDBARApbDLALCEFHLAIAoFHIASAoFHXXEKAXCBAOrBBGZeGaARC/+EsGRFHSAZCSgHcAZCL4HxDNDNAZCS0MBASCEFHoXEKASHoAVAIAx9rCSgCDTFYDBHSKDNDNAcMBAoCEFHXXEKAoHXAVAIAZ9rCSgCDTFYDBHoKDNDNARtMBAOCEFHRXEKAOCDFHRAO8sBEGhCfEgHpDNAhCU9KMBAOCOFHaApCfBgHpCRHODNINAR8sBBGhCfBgAOTApvHpAhCU9KMEARCEFHRAOCRFGOC8j9HMBKAaHRXEKARCEFHRKApCE4CBApCEg9r7AMFGMHaKDNDNAxCSsMBARHpXEKARCEFHpAR8sBBGOCfEgHhDNAOCU9KMBARCVFHSAhCfBgHhCRHODNINAp8sBBGRCfBgAOTAhvHhARCU9KMEApCEFHpAOCRFGOC8j9HMBKASHpXEKApCEFHpKAhCE4CBAhCEg9r7AMFGMHSKDNDNAcCSsMBApHOXEKApCEFHOAp8sBBGRCfEgHhDNARCU9KMBApCVFHoAhCfBgHhCRHRDNINAO8sBBGpCfBgARTAhvHhApCU9KMEAOCEFHOARCRFGRC8j9HMBKAoHOXEKAOCEFHOKAhCE4CBAhCEg9r7AMFGMHoKDNDNADCD9HMBABAdCETFGRAa87EBARCDFAS87EBARCLFAo87EBXEKABAdCDTFGRAabDBARCLFASbDBARCWFAobDBKAVC/ABFALCITFGRASbDBARAabDLAVAICDTFAabDBAVC/ABFALCEFCSgCITFGRAobDBARASbDLAVAICEFGICSgCDTFASbDBAVC/ABFALCDFCSgCITFGRAabDBARAobDLAVAIAZCZ6AxCSsvFGICSgCDTFAobDBAIActAcCSsvFHIALCIFHLKAWCEFHWALCSgHLAICSgHIAdCIFGdAE6MBKKCBC99AOAQseHOKAVC/AEF8kJJJJBAOK+LLEVU8jJJJJBCZ9rHVC9+HODNAECVFAL0MBCUHOAIrBBC/+EgC/QE9HMBAV9CB83IWAICEFHRAIALFC98FHWDNAEtMBDNADCDsMBCBHdINDNARAW6MBC9+SKARCEFHOAR8sBBGLCfEgHIDNDNALCU9MMBAOHRXEKARCVFHRAICfBgHICRHLDNINAO8sBBGDCfBgALTAIvHIADCU9KMEAOCEFHOALCRFGLC8j9HMBXDKKAOCEFHRKABAdCDTFAICD4CBAICE4CEg9r7AVCWFAICEgCDTvGOYDBFGLbDBAOALbDBAdCEFGdAE9HMBXDKKCBHdINDNARAW6MBC9+SKARCEFHOAR8sBBGLCfEgHIDNDNALCU9MMBAOHRXEKARCVFHRAICfBgHICRHLDNINAO8sBBGDCfBgALTAIvHIADCU9KMEAOCEFHOALCRFGLC8j9HMBXDKKAOCEFHRKABAdCETFAICD4CBAICE4CEg9r7AVCWFAICEgCDTvGOYDBFGL87EBAOALbDBAdCEFGdAE9HMBKKCBC99ARAWseHOKAOK+lVOEUE99DUD99EUD99DNDNADCL9HMBAEtMEINDNDNABCDFGD8sBB+yAB8sBBGI+yGL+L+TABCEFGV8sBBGO+yGR+L+TGWjBB/+9CAWAWnjBBBBAWAWjBBBB9gGdeGQ+MGKAQAICB9IeALmGWAWnAKAQAOCB9IeARmGQAQnmm+R+VGLnjBBBzjBBB+/AdemGR+LjBBB9P9dtMBAR+oHIXEKCJJJJ94HIKADAI86BBDNDNAQALnjBBBzjBBB+/AQjBBBB9gemGQ+LjBBB9P9dtMBAQ+oHDXEKCJJJJ94HDKAVAD86BBDNDNAWALnjBBBzjBBB+/AWjBBBB9gemGW+LjBBB9P9dtMBAW+oHDXEKCJJJJ94HDKABAD86BBABCLFHBAECUFGEMBXDKKAEtMBINDNDNABCLFGD8uEB+yAB8uEBGI+yGL+L+TABCDFGV8uEBGO+yGR+L+TGWjB/+fsAWAWnjBBBBAWAWjBBBB9gGdeGQ+MGKAQAICB9IeALmGWAWnAKAQAOCB9IeARmGQAQnmm+R+VGLnjBBBzjBBB+/AdemGR+LjBBB9P9dtMBAR+oHIXEKCJJJJ94HIKADAI87EBDNDNAQALnjBBBzjBBB+/AQjBBBB9gemGQ+LjBBB9P9dtMBAQ+oHDXEKCJJJJ94HDKAVAD87EBDNDNAWALnjBBBzjBBB+/AWjBBBB9gemGW+LjBBB9P9dtMBAW+oHDXEKCJJJJ94HDKABAD87EBABCWFHBAECUFGEMBKKK/SILIUI99IUE99DNAEtMBCBHIABHLINDNDNj/zL81zALCOF8uEBGVCIv+y+VGOAL8uEB+ynGRjB/+fsnjBBBzjBBB+/ARjBBBB9gemGW+LjBBB9P9dtMBAW+oHdXEKCJJJJ94HdKALCLF8uEBHQALCDF8uEBHKABAVCEFCIgAIvCETFAd87EBDNDNAOAK+ynGWjB/+fsnjBBBzjBBB+/AWjBBBB9gemGX+LjBBB9P9dtMBAX+oHKXEKCJJJJ94HKKABAVCDFCIgAIvCETFAK87EBDNDNAOAQ+ynGOjB/+fsnjBBBzjBBB+/AOjBBBB9gemGX+LjBBB9P9dtMBAX+oHQXEKCJJJJ94HQKABAVCUFCIgAIvCETFAQ87EBDNDNjBBJzARARn+TAWAWn+TAOAOn+TGRjBBBBARjBBBB9ge+RjB/+fsnjBBBzmGR+LjBBB9P9dtMBAR+oHQXEKCJJJJ94HQKABAVCIgAIvCETFAQ87EBALCWFHLAICLFHIAECUFGEMBKKK9MBDNADCD4AE2GEtMBINABABYDBGDCWTCW91+yADCE91CJJJ/8IFCJJJ98g++nuDBABCLFHBAECUFGEMBKKK9TEIUCBCBYDJ1JJBGEABCIFC98gFGBbDJ1JJBDNDNABzBCZTGD9NMBCUHIABAD9rCffIFCZ4NBCUsMEKAEHIKAIK/lEEEUDNDNAEABvCIgtMBABHIXEKDNDNADCZ9PMBABHIXEKABHIINAIAEYDBbDBAICLFAECLFYDBbDBAICWFAECWFYDBbDBAICXFAECXFYDBbDBAICZFHIAECZFHEADC9wFGDCS0MBKKADCL6MBINAIAEYDBbDBAECLFHEAICLFHIADC98FGDCI0MBKKDNADtMBINAIAErBB86BBAICEFHIAECEFHEADCUFGDMBKKABK/AEEDUDNDNABCIgtMBABHIXEKAECfEgC+B+C+EW2HLDNDNADCZ9PMBABHIXEKABHIINAIALbDBAICXFALbDBAICWFALbDBAICLFALbDBAICZFHIADC9wFGDCS0MBKKADCL6MBINAIALbDBAICLFHIADC98FGDCI0MBKKDNADtMBINAIAE86BBAICEFHIADCUFGDMBKKABKKKEBCJWKLZ9kBB",n="B9h79tEBBBEkL9gBB9gVUUUUUEU9gIUUUB9gEUEUIKQBBEBEEDDDILVE9wEEEVIEBEOWEUEC+Q/aEKR/LEdO9tw9t9vv95DBh9f9f939h79t9f9j9h229f9jT9vv7BB8a9tw79o9v9wT9f9kw9j9v9kw9WwvTw949C919m9mwvBDy9tw79o9v9wT9f9kw9j9v9kw69u9kw949C919m9mwvBLe9tw79o9v9wT9f9kw9j9v9kw69u9kw949Twg91w9u9jwBVl9tw79o9v9wT9f9kw9j9v9kws9p2Twv9P9jTBOk9tw79o9v9wT9f9kw9j9v9kws9p2Twv9R919hTBRl9tw79o9v9wT9f9kw9j9v9kws9p2Twvt949wBWL79iv9rBdQ/T9TQLBZIK9+EVU8jJJJJBCZ9rHBCBHEINCBHDCBHIINABCWFADFAICJUAEAD4CEgGLe86BBAIALFHIADCEFGDCW9HMBKAEC+Q+YJJBFAI86BBAECITC+Q1JJBFAB8pIW83IBAECEFGECJD9HMBKK/H8jLhUD97EUO978jJJJJBCJ/KB9rGV8kJJJJBC9+HODNADCEFAL0MBCUHOAIrBBC+gE9HMBAVAIALFGRAD9rAD/8QBBCJ/ABAD9uHOAICEFHLDNADtMBAOC/wfBgGOCJDAOCJD6eHWCBHdINAdAE9PMEAWAEAd9rAdAWFAE6eGQCSFGOC9wgGKCI2HXAKCETHMAOCL4CIFCD4HpABAdAD2FHSCBHZDNINCEHhALHoCBHaDNINARAo9rAp6MIAVCJ/CBFAaAK2FHcAoApFHLCBHIDNAKC/AB6MBARAL9rC/gB6MBCBHOINAcAOFHIDNDNDNDNDNAoAOCO4FrBBGxCIgpLBEDIBKAIPXBBBBBBBBBBBBBBBBPKLBXIKAIALPBBLALPBBBGqCLP+MEAqPMBZEhDoIaLcVxOqRlGqCDP+MEAqPMBZEhDoIaLcVxOqRlPXIIIIIIIIIIIIIIIIP9OGlPXIIIIIIIIIIIIIIIIP8jGqP5B9CJf/8/4/w/g/AB9+9Cu1+nGkCITC+Q1JJBFPBIBAkC+Q+YJJBFPBBBGyAyPMBBBBBBBBBBBBBBBBAqP5E9CJf/8/4/w/g/AB9+9Cu1+nGkCITC+Q1JJBFPBIBP9uPMBEDILVORZhoacxqlPpAlAqP9SPKLBALCLFAyPqBFAkC+Q+YJJBFrBBFHLXDKAIALPBBWALPBBBGqCLP+MEAqPMBZEhDoIaLcVxOqRlPXSSSSSSSSSSSSSSSSP9OGlPXSSSSSSSSSSSSSSSSP8jGqP5B9CJf/8/4/w/g/AB9+9Cu1+nGkCITC+Q1JJBFPBIBAkC+Q+YJJBFPBBBGyAyPMBBBBBBBBBBBBBBBBAqP5E9CJf/8/4/w/g/AB9+9Cu1+nGkCITC+Q1JJBFPBIBP9uPMBEDILVORZhoacxqlPpAlAqP9SPKLBALCWFAyPqBFAkC+Q+YJJBFrBBFHLXEKAIALPBBBPKLBALCZFHLKDNDNDNDNDNAxCD4CIgpLBEDIBKAIPXBBBBBBBBBBBBBBBBPKLZXIKAIALPBBLALPBBBGqCLP+MEAqPMBZEhDoIaLcVxOqRlGqCDP+MEAqPMBZEhDoIaLcVxOqRlPXIIIIIIIIIIIIIIIIP9OGlPXIIIIIIIIIIIIIIIIP8jGqP5B9CJf/8/4/w/g/AB9+9Cu1+nGkCITC+Q1JJBFPBIBAkC+Q+YJJBFPBBBGyAyPMBBBBBBBBBBBBBBBBAqP5E9CJf/8/4/w/g/AB9+9Cu1+nGkCITC+Q1JJBFPBIBP9uPMBEDILVORZhoacxqlPpAlAqP9SPKLZALCLFAyPqBFAkC+Q+YJJBFrBBFHLXDKAIALPBBWALPBBBGqCLP+MEAqPMBZEhDoIaLcVxOqRlPXSSSSSSSSSSSSSSSSP9OGlPXSSSSSSSSSSSSSSSSP8jGqP5B9CJf/8/4/w/g/AB9+9Cu1+nGkCITC+Q1JJBFPBIBAkC+Q+YJJBFPBBBGyAyPMBBBBBBBBBBBBBBBBAqP5E9CJf/8/4/w/g/AB9+9Cu1+nGkCITC+Q1JJBFPBIBP9uPMBEDILVORZhoacxqlPpAlAqP9SPKLZALCWFAyPqBFAkC+Q+YJJBFrBBFHLXEKAIALPBBBPKLZALCZFHLKDNDNDNDNDNAxCL4CIgpLBEDIBKAIPXBBBBBBBBBBBBBBBBPKLAXIKAIALPBBLALPBBBGqCLP+MEAqPMBZEhDoIaLcVxOqRlGqCDP+MEAqPMBZEhDoIaLcVxOqRlPXIIIIIIIIIIIIIIIIP9OGlPXIIIIIIIIIIIIIIIIP8jGqP5B9CJf/8/4/w/g/AB9+9Cu1+nGkCITC+Q1JJBFPBIBAkC+Q+YJJBFPBBBGyAyPMBBBBBBBBBBBBBBBBAqP5E9CJf/8/4/w/g/AB9+9Cu1+nGkCITC+Q1JJBFPBIBP9uPMBEDILVORZhoacxqlPpAlAqP9SPKLAALCLFAyPqBFAkC+Q+YJJBFrBBFHLXDKAIALPBBWALPBBBGqCLP+MEAqPMBZEhDoIaLcVxOqRlPXSSSSSSSSSSSSSSSSP9OGlPXSSSSSSSSSSSSSSSSP8jGqP5B9CJf/8/4/w/g/AB9+9Cu1+nGkCITC+Q1JJBFPBIBAkC+Q+YJJBFPBBBGyAyPMBBBBBBBBBBBBBBBBAqP5E9CJf/8/4/w/g/AB9+9Cu1+nGkCITC+Q1JJBFPBIBP9uPMBEDILVORZhoacxqlPpAlAqP9SPKLAALCWFAyPqBFAkC+Q+YJJBFrBBFHLXEKAIALPBBBPKLAALCZFHLKDNDNDNDNDNAxCO4pLBEDIBKAIPXBBBBBBBBBBBBBBBBPKL8wXIKAIALPBBLALPBBBGqCLP+MEAqPMBZEhDoIaLcVxOqRlGqCDP+MEAqPMBZEhDoIaLcVxOqRlPXIIIIIIIIIIIIIIIIP9OGlPXIIIIIIIIIIIIIIIIP8jGqP5B9CJf/8/4/w/g/AB9+9Cu1+nGxCITC+Q1JJBFPBIBAxC+Q+YJJBFPBBBGyAyPMBBBBBBBBBBBBBBBBAqP5E9CJf/8/4/w/g/AB9+9Cu1+nGxCITC+Q1JJBFPBIBP9uPMBEDILVORZhoacxqlPpAlAqP9SPKL8wALCLFAyPqBFAxC+Q+YJJBFrBBFHLXDKAIALPBBWALPBBBGqCLP+MEAqPMBZEhDoIaLcVxOqRlPXSSSSSSSSSSSSSSSSP9OGlPXSSSSSSSSSSSSSSSSP8jGqP5B9CJf/8/4/w/g/AB9+9Cu1+nGxCITC+Q1JJBFPBIBAxC+Q+YJJBFPBBBGyAyPMBBBBBBBBBBBBBBBBAqP5E9CJf/8/4/w/g/AB9+9Cu1+nGxCITC+Q1JJBFPBIBP9uPMBEDILVORZhoacxqlPpAlAqP9SPKL8wALCWFAyPqBFAxC+Q+YJJBFrBBFHLXEKAIALPBBBPKL8wALCZFHLKAOC/ABFHIAOCJEFAK0MEAIHOARAL9rC/fB0MBKKDNDNAIAK9PMBAICI4HOINARAL9rCk6MDAcAIFHxDNDNDNDNDNAoAICO4FrBBAOCOg4CIgpLBEDIBKAxPXBBBBBBBBBBBBBBBBPKLBXIKAxALPBBLALPBBBGqCLP+MEAqPMBZEhDoIaLcVxOqRlGqCDP+MEAqPMBZEhDoIaLcVxOqRlPXIIIIIIIIIIIIIIIIP9OGlPXIIIIIIIIIIIIIIIIP8jGqP5B9CJf/8/4/w/g/AB9+9Cu1+nGkCITC+Q1JJBFPBIBAkC+Q+YJJBFPBBBGyAyPMBBBBBBBBBBBBBBBBAqP5E9CJf/8/4/w/g/AB9+9Cu1+nGkCITC+Q1JJBFPBIBP9uPMBEDILVORZhoacxqlPpAlAqP9SPKLBALCLFAyPqBFAkC+Q+YJJBFrBBFHLXDKAxALPBBWALPBBBGqCLP+MEAqPMBZEhDoIaLcVxOqRlPXSSSSSSSSSSSSSSSSP9OGlPXSSSSSSSSSSSSSSSSP8jGqP5B9CJf/8/4/w/g/AB9+9Cu1+nGkCITC+Q1JJBFPBIBAkC+Q+YJJBFPBBBGyAyPMBBBBBBBBBBBBBBBBAqP5E9CJf/8/4/w/g/AB9+9Cu1+nGkCITC+Q1JJBFPBIBP9uPMBEDILVORZhoacxqlPpAlAqP9SPKLBALCWFAyPqBFAkC+Q+YJJBFrBBFHLXEKAxALPBBBPKLBALCZFHLKAOCDFHOAICZFGIAK6MBKKALtMBAaCI6HhALHoAaCEFGOHaAOCLsMDXEKKCBHLAhCEgMDKDNAKtMBAVCJDFAZFHIAVAZFPBDBHyCBHxINAIAVCJ/CBFAxFGOPBLBGlCEP9tAlPXEEEEEEEEEEEEEEEEGqP9OP9hP9RGlAOAKFPBLBG8aCEP9tA8aAqP9OP9hP9RG8aPMBZEhDoIaLcVxOqRlGeAOAMFPBLBG3CEP9tA3AqP9OP9hP9RG3AOAXFPBLBG5CEP9tA5AqP9OP9hP9RG5PMBZEhDoIaLcVxOqRlG8ePMBEZhDIoaLVcxORqlGqAqPMBEDIBEDIBEDIBEDIAyP9uGyP9aDBBAIADFGOAyAqAqPMLVORLVORLVORLVORP9uGyP9aDBBAOADFGOAyAqAqPMWdQKWdQKWdQKWdQKP9uGyP9aDBBAOADFGOAyAqAqPMXMpSXMpSXMpSXMpSP9uGyP9aDBBAOADFGOAyAeA8ePMWdkyQK8aeXM35pS8e8fGqAqPMBEDIBEDIBEDIBEDIP9uGyP9aDBBAOADFGOAyAqAqPMLVORLVORLVORLVORP9uGyP9aDBBAOADFGOAyAqAqPMWdQKWdQKWdQKWdQKP9uGyP9aDBBAOADFGOAyAqAqPMXMpSXMpSXMpSXMpSP9uGyP9aDBBAOADFGOAyAlA8aPMWkdyQ8aKeX3M5p8eS8fGlA3A5PMWkdyQ8aKeX3M5p8eS8fG8aPMBEZhDIoaLVcxORqlGqAqPMBEDIBEDIBEDIBEDIP9uGyP9aDBBAOADFGOAyAqAqPMLVORLVORLVORLVORP9uGyP9aDBBAOADFGOAyAqAqPMWdQKWdQKWdQKWdQKP9uGyP9aDBBAOADFGOAyAqAqPMXMpSXMpSXMpSXMpSP9uGyP9aDBBAOADFGOAyAlA8aPMWdkyQK8aeXM35pS8e8fGqAqPMBEDIBEDIBEDIBEDIP9uGyP9aDBBAOADFGOAyAqAqPMLVORLVORLVORLVORP9uGyP9aDBBAOADFGOAyAqAqPMWdQKWdQKWdQKWdQKP9uGyP9aDBBAOADFGOAyAqAqPMXMpSXMpSXMpSXMpSP9uGyP9aDBBAOADFHIAxCZFGxAK6MBKKAZCLFGZAD6MBKASAVCJDFAQAD2/8QBBAVAVCJDFAQCUFAD2FAD/8QBBAQAdFHdC9+HOALMEXIKKC9+HOXEKCBC99ARAL9rADCAADCA0eseHOKAVCJ/KBF8kJJJJBAOKWBZ+BJJJBK/UZEhU8jJJJJBC/AE9rGV8kJJJJBC9+HODNAECI9uGRChFAL0MBCUHOAIrBBGWC/wEgC/gE9HMBAWCSgGdCE0MBAVC/ABFCfECJE/8KBAVCuF9CU83IBAVC8wF9CU83IBAVCYF9CU83IBAVCAF9CU83IBAVCkF9CU83IBAVCZF9CU83IBAV9CU83IWAV9CU83IBAIALFC9wFHQAICEFGWARFHODNAEtMBCMCSAdCEseHKCBHXCBHMCBHdCBHICBHLINDNAOAQ9NMBC9+HOXIKDNDNAWrBBGRC/vE0MBAVC/ABFALARCL4CU7FCSgCITFGpYDLHSApYDBHZDNARCSgGpAK9PMBAVAIARCU7FCSgCDTFYDBAXApeHRAptHpDNDNADCD9HMBABAdCETFGhAZ87EBAhCDFAS87EBAhCLFAR87EBXEKABAdCDTFGhAZbDBAhCLFASbDBAhCWFARbDBKAXApFHXAVC/ABFALCITFGhARbDBAhASbDLAVAICDTFARbDBAVC/ABFALCEFCSgGLCITFGhAZbDBAhARbDLAIApFHIALCEFHLXDKDNDNApCSsMBAMApFApC987FCEFHMXEKAOCEFHRAO8sBBGpCfEgHhDNDNApCU9MMBARHOXEKAOCVFHOAhCfBgHhCRHpDNINAR8sBBGoCfBgApTAhvHhAoCU9KMEARCEFHRApCRFGpC8j9HMBXDKKARCEFHOKAhCE4CBAhCEg9r7AMFHMKDNDNADCD9HMBABAdCETFGRAZ87EBARCDFAS87EBARCLFAM87EBXEKABAdCDTFGRAZbDBARCLFASbDBARCWFAMbDBKAVC/ABFALCITFGRAMbDBARASbDLAVAICDTFAMbDBAVC/ABFALCEFCSgGLCITFGRAZbDBARAMbDLAICEFHIALCEFHLXEKDNARCPE0MBAXCEFGoAVAIAQARCSgFrBBGpCL49rCSgCDTFYDBApCZ6GheHRAVAIAp9rCSgCDTFYDBAoAhFGSApCSgGoeHpAotHoDNDNADCD9HMBABAdCETFGZAX87EBAZCDFAR87EBAZCLFAp87EBXEKABAdCDTFGZAXbDBAZCLFARbDBAZCWFApbDBKAVAICDTFAXbDBAVC/ABFALCITFGZARbDBAZAXbDLAVAICEFGICSgCDTFARbDBAVC/ABFALCEFCSgCITFGZApbDBAZARbDLAVAIAhFCSgGICDTFApbDBAVC/ABFALCDFCSgGLCITFGRAXbDBARApbDLALCEFHLAIAoFHIASAoFHXXEKAXCBAOrBBGZeGaARC/+EsGRFHSAZCSgHcAZCL4HxDNDNAZCS0MBASCEFHoXEKASHoAVAIAx9rCSgCDTFYDBHSKDNDNAcMBAoCEFHXXEKAoHXAVAIAZ9rCSgCDTFYDBHoKDNDNARtMBAOCEFHRXEKAOCDFHRAO8sBEGhCfEgHpDNAhCU9KMBAOCOFHaApCfBgHpCRHODNINAR8sBBGhCfBgAOTApvHpAhCU9KMEARCEFHRAOCRFGOC8j9HMBKAaHRXEKARCEFHRKApCE4CBApCEg9r7AMFGMHaKDNDNAxCSsMBARHpXEKARCEFHpAR8sBBGOCfEgHhDNAOCU9KMBARCVFHSAhCfBgHhCRHODNINAp8sBBGRCfBgAOTAhvHhARCU9KMEApCEFHpAOCRFGOC8j9HMBKASHpXEKApCEFHpKAhCE4CBAhCEg9r7AMFGMHSKDNDNAcCSsMBApHOXEKApCEFHOAp8sBBGRCfEgHhDNARCU9KMBApCVFHoAhCfBgHhCRHRDNINAO8sBBGpCfBgARTAhvHhApCU9KMEAOCEFHOARCRFGRC8j9HMBKAoHOXEKAOCEFHOKAhCE4CBAhCEg9r7AMFGMHoKDNDNADCD9HMBABAdCETFGRAa87EBARCDFAS87EBARCLFAo87EBXEKABAdCDTFGRAabDBARCLFASbDBARCWFAobDBKAVC/ABFALCITFGRASbDBARAabDLAVAICDTFAabDBAVC/ABFALCEFCSgCITFGRAobDBARASbDLAVAICEFGICSgCDTFASbDBAVC/ABFALCDFCSgCITFGRAabDBARAobDLAVAIAZCZ6AxCSsvFGICSgCDTFAobDBAIActAcCSsvFHIALCIFHLKAWCEFHWALCSgHLAICSgHIAdCIFGdAE6MBKKCBC99AOAQseHOKAVC/AEF8kJJJJBAOK+LLEVU8jJJJJBCZ9rHVC9+HODNAECVFAL0MBCUHOAIrBBC/+EgC/QE9HMBAV9CB83IWAICEFHRAIALFC98FHWDNAEtMBDNADCDsMBCBHdINDNARAW6MBC9+SKARCEFHOAR8sBBGLCfEgHIDNDNALCU9MMBAOHRXEKARCVFHRAICfBgHICRHLDNINAO8sBBGDCfBgALTAIvHIADCU9KMEAOCEFHOALCRFGLC8j9HMBXDKKAOCEFHRKABAdCDTFAICD4CBAICE4CEg9r7AVCWFAICEgCDTvGOYDBFGLbDBAOALbDBAdCEFGdAE9HMBXDKKCBHdINDNARAW6MBC9+SKARCEFHOAR8sBBGLCfEgHIDNDNALCU9MMBAOHRXEKARCVFHRAICfBgHICRHLDNINAO8sBBGDCfBgALTAIvHIADCU9KMEAOCEFHOALCRFGLC8j9HMBXDKKAOCEFHRKABAdCETFAICD4CBAICE4CEg9r7AVCWFAICEgCDTvGOYDBFGL87EBAOALbDBAdCEFGdAE9HMBKKCBC99ARAWseHOKAOK+epLIUO97EUE978jJJJJBCA9rHIDNDNADCL9HMBDNAEC98gGLtMBCBHVABHDINADADPBBBGOCkP+rECkP+sEP/6EGRAOCWP+rECkP+sEP/6EARP/gEAOCZP+rECkP+sEP/6EGWP/gEP/kEP/lEGdPXBBBBBBBBBBBBBBBBP+2EGQARPXBBBJBBBJBBBJBBBJGKP9OP9RP/kEGRPXBB/+9CBB/+9CBB/+9CBB/+9CARARP/mEAdAdP/mEAWAQAWAKP9OP9RP/kEGRARP/mEP/kEP/kEP/jEP/nEGWP/mEPXBBN0BBN0BBN0BBN0GQP/kEPXfBBBfBBBfBBBfBBBP9OAOPXBBBfBBBfBBBfBBBfP9OP9QARAWP/mEAQP/kECWP+rEPXBfBBBfBBBfBBBfBBP9OP9QAdAWP/mEAQP/kECZP+rEPXBBfBBBfBBBfBBBfBP9OP9QPKBBADCZFHDAVCLFGVAL6MBKKALAE9PMEAIAECIgGVCDTGDvCBCZAD9r/8KBAIABALCDTFGLAD/8QBBDNAVtMBAIAIPBLBGOCkP+rECkP+sEP/6EGRAOCWP+rECkP+sEP/6EARP/gEAOCZP+rECkP+sEP/6EGWP/gEP/kEP/lEGdPXBBBBBBBBBBBBBBBBP+2EGQARPXBBBJBBBJBBBJBBBJGKP9OP9RP/kEGRPXBB/+9CBB/+9CBB/+9CBB/+9CARARP/mEAdAdP/mEAWAQAWAKP9OP9RP/kEGRARP/mEP/kEP/kEP/jEP/nEGWP/mEPXBBN0BBN0BBN0BBN0GQP/kEPXfBBBfBBBfBBBfBBBP9OAOPXBBBfBBBfBBBfBBBfP9OP9QARAWP/mEAQP/kECWP+rEPXBfBBBfBBBfBBBfBBP9OP9QAdAWP/mEAQP/kECZP+rEPXBBfBBBfBBBfBBBfBP9OP9QPKLBKALAIAD/8QBBSKDNAEC98gGXtMBCBHVABHDINADCZFGLALPBBBGOPXBBBBBBffBBBBBBffGKP9OADPBBBGdAOPMLVORXMpScxql358e8fPXfUBBfUBBfUBBfUBBP9OP/6EAdAOPMBEDIWdQKZhoaky8aeGOCZP+sEP/6EGRP/gEAOCZP+rECZP+sEP/6EGWP/gEP/kEP/lEGOPXB/+fsB/+fsB/+fsB/+fsAWAOPXBBBBBBBBBBBBBBBBP+2EGQAWPXBBBJBBBJBBBJBBBJGMP9OP9RP/kEGWAWP/mEAOAOP/mEARAQARAMP9OP9RP/kEGOAOP/mEP/kEP/kEP/jEP/nEGRP/mEPXBBN0BBN0BBN0BBN0GQP/kECZP+rEAWARP/mEAQP/kEPXffBBffBBffBBffBBP9OP9QGWAOARP/mEAQP/kEPXffBBffBBffBBffBBP9OGOPMWdkyQK8aeXM35pS8e8fP9QPKBBADAdAKP9OAWAOPMBEZhDIoaLVcxORqlP9QPKBBADCAFHDAVCLFGVAX6MBKKAXAE9PMBAIAECIgGVCITGDFCBCAAD9r/8KBAIABAXCITFGLAD/8QBBDNAVtMBAIAIPBLZGOPXBBBBBBffBBBBBBffGKP9OAIPBLBGdAOPMLVORXMpScxql358e8fPXfUBBfUBBfUBBfUBBP9OP/6EAdAOPMBEDIWdQKZhoaky8aeGOCZP+sEP/6EGRP/gEAOCZP+rECZP+sEP/6EGWP/gEP/kEP/lEGOPXB/+fsB/+fsB/+fsB/+fsAWAOPXBBBBBBBBBBBBBBBBP+2EGQAWPXBBBJBBBJBBBJBBBJGMP9OP9RP/kEGWAWP/mEAOAOP/mEARAQARAMP9OP9RP/kEGOAOP/mEP/kEP/kEP/jEP/nEGRP/mEPXBBN0BBN0BBN0BBN0GQP/kECZP+rEAWARP/mEAQP/kEPXffBBffBBffBBffBBP9OP9QGWAOARP/mEAQP/kEPXffBBffBBffBBffBBP9OGOPMWdkyQK8aeXM35pS8e8fP9QPKLZAIAdAKP9OAWAOPMBEZhDIoaLVcxORqlP9QPKLBKALAIAD/8QBBKK/4WLLUE97EUV978jJJJJBC8w9rHIDNAEC98gGLtMBCBHVABHOINAIAOPBBBGRAOCZFGWPBBBGdPMLVORXMpScxql358e8fGQCZP+sEGKCLP+rEPKLBAOPXBBJzBBJzBBJzBBJzPX/zL81z/zL81z/zL81z/zL81zAKPXIBBBIBBBIBBBIBBBP9QP/6EP/nEGKARAdPMBEDIWdQKZhoaky8aeGRCZP+rECZP+sEP/6EP/mEGdAdP/mEAKARCZP+sEP/6EP/mEGXAXP/mEAKAQCZP+rECZP+sEP/6EP/mEGQAQP/mEP/kEP/kEP/lEPXBBBBBBBBBBBBBBBBP+4EP/jEPXB/+fsB/+fsB/+fsB/+fsGKP/mEPXBBN0BBN0BBN0BBN0GRP/kEPXffBBffBBffBBffBBGMP9OAXAKP/mEARP/kECZP+rEP9QGXAQAKP/mEARP/kECZP+rEAdAKP/mEARP/kEAMP9OP9QGKPMBEZhDIoaLVcxORqlGRP5BAIPBLBPeB+t+J83IBAOCWFARP5EAIPBLBPeE+t+J83IBAWAXAKPMWdkyQK8aeXM35pS8e8fGKP5BAIPBLBPeD+t+J83IBAOCkFAKP5EAIPBLBPeI+t+J83IBAOCAFHOAVCLFGVAL6MBKKDNALAE9PMBAIAECIgGVCITGOFCBCAAO9r/8KBAIABALCITFGWAO/8QBBDNAVtMBAIAIPBLBGRAIPBLZGdPMLVORXMpScxql358e8fGQCZP+sEGKCLP+rEPKLAAIPXBBJzBBJzBBJzBBJzPX/zL81z/zL81z/zL81z/zL81zAKPXIBBBIBBBIBBBIBBBP9QP/6EP/nEGKARAdPMBEDIWdQKZhoaky8aeGRCZP+rECZP+sEP/6EP/mEGdAdP/mEAKARCZP+sEP/6EP/mEGXAXP/mEAKAQCZP+rECZP+sEP/6EP/mEGQAQP/mEP/kEP/kEP/lEPXBBBBBBBBBBBBBBBBP+4EP/jEPXB/+fsB/+fsB/+fsB/+fsGKP/mEPXBBN0BBN0BBN0BBN0GRP/kEPXffBBffBBffBBffBBGMP9OAXAKP/mEARP/kECZP+rEP9QGXAQAKP/mEARP/kECZP+rEAdAKP/mEARP/kEAMP9OP9QGKPMBEZhDIoaLVcxORqlGRP5BAIPBLAPeB+t+J83IBAIARP5EAIPBLAPeE+t+J83IWAIAXAKPMWdkyQK8aeXM35pS8e8fGKP5BAIPBLAPeD+t+J83IZAIAKP5EAIPBLAPeI+t+J83IkKAWAIAO/8QBBKK+pDDIUE978jJJJJBC/AB9rHIDNADCD4AE2GLC98gGVtMBCBHDABHEINAEAEPBBBGOCWP+rECWP+sEP/6EAOCEP+sEPXBBJzBBJzBBJzBBJzP+uEPXBBJfBBJfBBJfBBJfP9OP/mEPKBBAECZFHEADCLFGDAV6MBKKDNAVAL9PMBAIALCIgGDCDTGEvCBC/ABAE9r/8KBAIABAVCDTFGVAE/8QBBDNADtMBAIAIPBLBGOCWP+rECWP+sEP/6EAOCEP+sEPXBBJzBBJzBBJzBBJzP+uEPXBBJfBBJfBBJfBBJfP9OP/mEPKLBKAVAIAE/8QBBKK9TEIUCBCBYDJ1JJBGEABCIFC98gFGBbDJ1JJBDNDNABzBCZTGD9NMBCUHIABAD9rCffIFCZ4NBCUsMEKAEHIKAIKKKEBCJWKLZ9tBB",i=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),o=new Uint8Array([32,0,65,2,1,106,34,33,3,128,11,4,13,64,6,253,10,7,15,116,127,5,8,12,40,16,19,54,20,9,27,255,113,17,42,67,24,23,146,148,18,14,22,45,70,69,56,114,101,21,25,63,75,136,108,28,118,29,73,115]);if(typeof WebAssembly!="object")return{supported:!1};var r=t;WebAssembly.validate(i)&&(r=n);var s,a=WebAssembly.instantiate(c(r),{}).then(function(h){s=h.instance,s.exports.__wasm_call_ctors()});function c(h){for(var _=new Uint8Array(h.length),y=0;y<h.length;++y){var p=h.charCodeAt(y);_[y]=p>96?p-71:p>64?p-65:p>47?p+4:p>46?63:62}for(var C=0,y=0;y<h.length;++y)_[C++]=_[y]<60?o[_[y]]:(_[y]-60)*64+_[++y];return _.buffer.slice(0,C)}function l(h,_,y,p,C,x){var T=s.exports.sbrk,E=y+3&-4,S=T(E*p),w=T(C.length),D=new Uint8Array(s.exports.memory.buffer);D.set(C,w);var I=h(S,y,p,w,C.length);if(I==0&&x&&x(S,E,p),_.set(D.subarray(S,S+y*p)),T(S-T(0)),I!=0)throw new Error("Malformed buffer data: "+I)}var u={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},d={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:a,supported:!0,decodeVertexBuffer:function(h,_,y,p,C){l(s.exports.meshopt_decodeVertexBuffer,h,_,y,p,s.exports[u[C]])},decodeIndexBuffer:function(h,_,y,p){l(s.exports.meshopt_decodeIndexBuffer,h,_,y,p)},decodeIndexSequence:function(h,_,y,p){l(s.exports.meshopt_decodeIndexSequence,h,_,y,p)},decodeGltfBuffer:function(h,_,y,p,C,x){l(s.exports[d[C]],h,_,y,p,s.exports[u[x]])}}}();var WLt=function(){"use strict";var t="B9h79tEBBBECd9gEUEU9gEUB9gBB9gQUUUUUUU99UUEU9gVUUUUUB9gLUUUUE999gIUUUE999gLUUUUEU9gIUUUEUIMXDILVORBWWBEWLVE9wEIIVIEBEOWEUECJ/JEKR7OO9tw9t9vv95DBh9f9f939h79t9f9j9h229f9jT9vv7BBZ9tw79o9v9wT9f79p9t9w29p9m95BEx9tw79o9v9wT9f79p9t9w29p9m959T9j9h2wBLA9tw79o9v9wT9f9v9wT9p9t9p96w9WwvTw94swT9j9o9Sw9t9h9wBVL79iv9rBOdWEBCEKDdQQ+stXDBK/48yIkUp99hU8jJJJJBCJ/BB9rGQ8kJJJJBAQCkFCBC/kBZ1JJJB8aCUALCDTGKALCffffI0eGXCBYD/s1JJBhJJJJBBHMAQCkFAQYD94GpCDTFAMbDBAQAMbDWAQApCEFbD94AXCBYD/s1JJBhJJJJBBHSAQCkFAQYD94GpCDTFASbDBAQASbDXAQApCEFbD94CUADCITADCffffE0eCBYD/s1JJBhJJJJBBHZAQCkFAQYD94GpCDTFAZbDBAQAZbDZAQApCEFbD94AQCWFAEADALCBZ+CJJJBAXCBYD/s1JJBhJJJJBBHhAQCkFAQYD94GpCDTFAhbDBAQApCEFbD94AXCBYD/s1JJBhJJJJBBHoAQCkFAQYD94GpCDTFAobDBAQApCEFbD94ALCD4ALFHaCEHcINAcGpCETHcApAa6MBKCBHxCUApCDTGaApCffffI0eCBYD/s1JJBhJJJJBBHcAQCkFAQYD94GqCDTFAcbDBAQAqCEFbD94AcCfEAaZ1JJJBHlDNALtMBAVCD4HkApCUFHqINAIAxAk2CDTFGyYDLGpCh4Ap7C+f+B+dd2AyYDBGpCh4Ap7C/d/o+b8j27AyYDWGpCh4Ap7C+3f/n8n27HaCBHpDNDNINAlAaAqgGaCDTFG8aYDBGcCUsMEAIAcAk2CDTFAyCXZ+LJJJBtMDApCEFGpAaFHaApAq9NMBXDKKA8aAxbDBAxHcKAhAxCDTFAcbDBAxCEFGxAL9HMBKCBHpAoHcINAcApbDBAcCLFHcALApCEFGp9HMBKCBHpAhHcAoHaINDNApAcYDBGqsMBAaAoAqCDTFGqYDBbDBAqApbDBKAcCLFHcAaCLFHaALApCEFGp9HMBKKCBHaALCBYD/s1JJBhJJJJBBHyAQCkFAQYD94GpCDTFAybDBAQApCEFbD94AXCBYD/s1JJBhJJJJBBHpAQCkFAQYD94GcCDTFApbDBAQAcCEFbD94AXCBYD/s1JJBhJJJJBBHcAQCkFAQYD94GqCDTFAcbDBAQAqCEFbD94ApCfEAKZ1JJJBHeAcCfEAKZ1JJJBH3DNALtMBAZCWFH5INDNAMAaCDTGpFYDBG8etMBAZASApFYDBCITFH8fA3ApFHAAeApFHxCBHkINDNDNA8fAkCITFYDBGlAa9HMBAxAabDBAAAabDBXEKDNAMAlCDTGKFYDBGHtMBAZASAKFYDBCITGpFYDBAasMEAHCUFH8aA5ApFHcCBHpINA8aApsMEApCEFHpAcYDBHqAcCWFHcAqAa9HMBKApAH6MEKA3AKFGpAaAlApYDBCUsebDBAxAlAaAxYDBCUsebDBKAkCEFGkA8e9HMBKKAaCEFGaAL9HMBKAhHcAoHaA3HqAeHkCBHpINDNDNApAcYDBG8a9HMBDNApAaYDBG8a9HMBAkYDBH8aDNAqYDBGlCU9HMBA8aCU9HMBAyApFCB86BBXIKAyApFHxDNApAlsMBApA8asMBAxCE86BBXIKAxCL86BBXDKDNApAoA8aCDTGlFYDB9HMBDNAqYDBGxCUsMBApAxsMBAkYDBGKCUsMBApAKsMBA3AlFYDBG8eCUsMBA8eA8asMBAeAlFYDBGlCUsMBAlA8asMBDNAhAxCDTFYDBAhAlCDTFYDB9HMBAhAKCDTFYDBAhA8eCDTFYDB9HMBAyApFCD86BBXLKAyApFCL86BBXIKAyApFCL86BBXDKAyApFCL86BBXEKAyApFAyA8aFrBB86BBKAcCLFHcAaCLFHaAqCLFHqAkCLFHkALApCEFGp9HMBKAWCEgtMBAyHpALHcINDNAprBBCE9HMBApCL86BBKApCEFHpAcCUFGcMBKKCBHkCUALCX2ALC/V+q/V+qE0eCBYD/s1JJBhJJJJBBHMAQCkFAQYD94GpCDTFAMbDBAQApCEFbD94AMAIALAVZ+DJJJB8aCUALC8s2GcALC/d/o/F8u0eCBYD/s1JJBhJJJJBBHpAQCkFAQYD94GaCDTFApbDBAQAaCEFbD94ApCBAcZ1JJJBHZDNADtMBAEHcINDNAMAcCLFYDBG8aCX2FGpiDBAMAcYDBGlCX2FGaiDBGG+TG8jAMAcCWFYDBGxCX2FGqCLFiDBAaCLFiDBG8k+TG8lnAqiDBAG+TG8mApCLFiDBA8k+TG8nn+TGYAYnA8nAqCWFiDBAaCWFiDBG8p+TGinA8lApCWFiDBA8p+TG8nn+TG8lA8lnA8nA8mnAiA8jn+TG8jA8jnmm+RG8mjBBBB9etMBAYA8m+VHYA8jA8m+VH8jA8lA8m+VH8lKAZAhAlCDTFYDBC8s2FGpA8lA8m+RG8mA8lnnG8nApiDBmuDBApA8jA8mA8jnG8rnGiApiDLmuDLApAYA8mAYnG8snGrApiDWmuDWApA8rA8lnG8rApiDXmuDXApA8sA8lnG8uApiDZmuDZApA8sA8jnG8sApiDcmuDcApA8lA8mAYA8pnA8lAGnA8kA8jnmm+MG8knGGnG8lApiDkmuDkApA8jAGnG8jApiD3muD3ApAYAGnGYApiDAmuDAApAGA8knGGApiD8kmuD8kApA8mApiDYmuDYAZAhA8aCDTFYDBC8s2FGpA8nApiDBmuDBApAiApiDLmuDLApArApiDWmuDWApA8rApiDXmuDXApA8uApiDZmuDZApA8sApiDcmuDcApA8lApiDkmuDkApA8jApiD3muD3ApAYApiDAmuDAApAGApiD8kmuD8kApA8mApiDYmuDYAZAhAxCDTFYDBC8s2FGpA8nApiDBmuDBApAiApiDLmuDLApArApiDWmuDWApA8rApiDXmuDXApA8uApiDZmuDZApA8sApiDcmuDcApA8lApiDkmuDkApA8jApiD3muD3ApAYApiDAmuDAApAGApiD8kmuD8kApA8mApiDYmuDYAcCXFHcAkCIFGkAD6MBKCBH8aAEHxINCBHcINAyAEAcC+81JJBFYDBGlA8aFCDTFYDBGaFrBBHpDNDNAyAxAcFYDBGqFrBBGkC99FCfEgCPE0MBApCEsMBApCD9HMEKDNAkCUFCfEgCE0MBAeAqCDTFYDBAa9HMEKDNApCUFCfEgCE0MBA3AaCDTFYDBAq9HMEKDNAkCV2ApFC+g1JJBFrBBtMBAhAaCDTFYDBAhAqCDTFYDB0MEKjBBACjBBJzApCEseH8mAkCEsHKAEAlCDTC+81JJBFYDBA8aFCDTFYDBHlDNAMAaCX2FGpCWFiDBAMAqCX2FGkCWFiDBG8k+TG8lA8lnApiDBAkiDBG8p+TG8jA8jnApCLFiDBAkCLFiDBG8n+TGYAYnmm+RGGjBBBB9etMBA8lAG+VH8lAYAG+VHYA8jAG+VH8jKjBBACA8mAKeH8sDNAMAlCX2FGpiDWA8k+TG8mA8lA8mA8lnApiDBA8p+TGrA8jnAYApiDLA8n+TG8rnmmGin+TG8mA8mnArA8jAin+TG8lA8lnA8rAYAin+TG8jA8jnmm+RGYjBBBB9etMBA8mAY+VH8mA8jAY+VH8jA8lAY+VH8lKAZAhAqCDTFYDBC8s2FGpA8lA8sAGnGYA8lnnGiApiDBmuDBApA8jAYA8jnG8snGrApiDLmuDLApA8mAYA8mnGGnG8rApiDWmuDWApA8sA8lnG8sApiDXmuDXApAGA8lnG8uApiDZmuDZApAGA8jnG8vApiDcmuDcApA8lAYA8mA8knA8lA8pnA8nA8jnmm+MG8knGGnG8lApiDkmuDkApA8jAGnG8jApiD3muD3ApA8mAGnG8mApiDAmuDAApAGA8knGGApiD8kmuD8kApAYApiDYmuDYAZAhAaCDTFYDBC8s2FGpAiApiDBmuDBApArApiDLmuDLApA8rApiDWmuDWApA8sApiDXmuDXApA8uApiDZmuDZApA8vApiDcmuDcApA8lApiDkmuDkApA8jApiD3muD3ApA8mApiDAmuDAApAGApiD8kmuD8kApAYApiDYmuDYKAcCLFGcCX9HMBKAxCXFHxA8aCIFG8aAD6MBKKDNABAEsMBABAEADCDTZ+HJJJB8aKCUADCX2ADC/V+q/V+qE0eCBYD/s1JJBhJJJJBBHAAQCkFAQYD94GpCDTFAAbDBAQApCEFbD94CUADCDTADCffffI0eCBYD/s1JJBhJJJJBBH5AQCkFAQYD94GpCDTFA5bDBAQApCEFbD94AXCBYD/s1JJBhJJJJBBHIAQCkFAQYD94GpCDTFAIbDBAQApCEFbD94ALCBYD/s1JJBhJJJJBBH8wAQCkFAQYD94GpCDTFA8wbDBAQApCEFbD94jBBBBHrDNADAO9NMBARARnH8sAACWFH8xAQYDZH8yAQYDXH8zAQYDWH80jBBBBHrINAQCWFABADGSALAhZ+CJJJBCBHHABHxCBHKINCBHpINDNAhAxApFYDBGaCDTGEFYDBGkAhABApC+81JJBFYDBAKFCDTFYDBGcCDTFYDBG8asMBAyAcFrBBGlCV2AyAaFrBBGqFC/Q1JJBFrBBGDAqCV2AlFG8eC/Q1JJBFrBBG8fvCfEgtMBDNA8eC+g1JJBFrBBtMBA8aAk0MEKDNAqAl9HMBAqCUFCfEgCE0MBAeAEFYDBAc9HMEKAAAHCX2FGqAcAaA8fCfEgGkebDLAqAaAcAkebDBAqADA8fgCfEgCB9HbDWAHCEFHHKApCLFGpCX9HMBKAxCXFHxAKCIFGKAS6MBKDNDNAHtMBAAHcAHH8aINAcCWFGljBBBBjBBJzAZAhAcYDBGaCDTFYDBC8s2FGpiDYG8l+VA8ljBBBB9beApiDWAMAcCLFGEYDBGqCX2FGkCWFiDBG8lnApiDZAkiDBG8jnApiDAmG8mA8mmmA8lnApiDLAkCLFiDBG8mnApiDcA8lnApiD3mG8lA8lmmA8mnApiDBA8jnApiDXA8mnApiDkmG8lA8lmmA8jnApiD8kmmm+LnGYjBBBBjBBJzAZAhAqAaAlYDBGkeGlCDTFYDBC8s2FGpiDYG8l+VA8ljBBBB9beApiDWAMAaAqAkeGxCX2FGkCWFiDBG8lnApiDZAkiDBG8jnApiDAmG8mA8mmmA8lnApiDLAkCLFiDBG8mnApiDcA8lnApiD3mG8lA8lmmA8mnApiDBA8jnApiDXA8mnApiDkmG8lA8lmmA8jnApiD8kmmm+LnG8lAYA8l9fGpeuDBAEAqAxApebDBAcAaAlApebDBAcCXFHcA8aCUFG8aMBKAQCJEFCBCJ/ABZ1JJJB8aA8xHpAHHcINAQCJEFApYDBCo4C/8zgFGaAaYDBCEFbDBApCXFHpAcCUFGcMBKCBHpCBHcINAQCJEFApFGaYDBHqAaAcbDBAqAcFHcApCLFGpCJ/AB9HMBKCBHpA8xHcINAQCJEFAcYDBCo4C/8zgFGaAaYDBGaCEFbDBA5AaCDTFApbDBAcCXFHcAHApCEFGp9HMBKASAO9rGaCI9uH81DNALtMBCBHpAIHcINAcApbDBAcCLFHcALApCEFGp9HMBKKCBHbA8wCBALZ1JJJBH83AaCo9uHuA81CE4H85CBH86CBHKDNINAAA5AKCDTFYDBCX2FGxiDWG8jA8s9eMEA86A819PMEjffUUH8lDNA85AH9PMBAAA5A85CDTFYDBCX2FiDWjBB/AznH8lKDNA8jA8l9etMBA86Au0MDKDNA83AhAxYDLG87CDTG88FYDBGaFG89rBBA83AhAxYDBGECDTG8+FYDBGzFGNrBBvMBDNA80AzCDTGpFYDBGqtMBA8yA8zApFYDBCITFHpAMAaCX2FG8eCWFHDA8eCLFHXAMAzCX2FG8fCWFHVA8fCLFHWCBHcCEHlDNINDNAIApYDBCDTFYDBGkAasMBAIApCLFYDBCDTFYDBG8aAasMBAMA8aCX2FG8aiDBAMAkCX2FGkiDBG8m+TG8lAWiDBAkCLFiDBGY+TGGnA8fiDBA8m+TG8kA8aCLFiDBAY+TG8jn+TA8lAXiDBAY+TG8pnA8eiDBA8m+TG8nA8jn+TnA8jAViDBAkCWFiDBGY+TGinAGA8aCWFiDBAY+TG8mn+TA8jADiDBAY+TGYnA8pA8mn+TnA8mA8knAiA8ln+TA8mA8nnAYA8ln+TnmmjBBBB9dMDKApCWFHpAcCEFGcAq6HlAqAc9HMBKKAlCEgtMBA85CEFH85XEKAxCWFHqAZAaC8s2FGpAZAzC8s2FGciDBApiDBmuDBApAciDLApiDLmuDLApAciDWApiDWmuDWApAciDXApiDXmuDXApAciDZApiDZmuDZApAciDcApiDcmuDcApAciDkApiDkmuDkApAciD3ApiD3muD3ApAciDAApiDAmuDAApAciD8kApiD8kmuD8kApAciDYApiDYmuDYDNDNDNDNAyAEFGcrBBC9+FpDEBDKAEHpINAIApCDTGpFAabDBAoApFYDBGpAE9HMBXIKKAoA88FYDBHpAoA8+FYDBHEAIA8+FA87bDBApH87KAIAECDTFA87bDBKANCE86BBA89CE86BBAqiDBG8lArArA8l9deHrAbCEFHbCECDAcrBBCEseA86FH86KAKCEFGKAH9HMBKKAbtMBDNALtMBCBHcAeHpINDNApYDBGaCUsMBDNAcAIAaCDTGqFYDBGa9HMBAeAqFYDBHaKApAabDBKApCLFHpALAcCEFGc9HMBKCBHcA3HpINDNApYDBGaCUsMBDNAcAIAaCDTGqFYDBGa9HMBA3AqFYDBHaKApAabDBKApCLFHpALAcCEFGc9HMBKKCBHDABHpCBHkINDNAIApYDBCDTFYDBGcAIApCLFYDBCDTFYDBGasMBAcAIApCWFYDBCDTFYDBGqsMBAaAqsMBABADCDTFG8aAcbDBA8aCLFAabDBA8aCWFAqbDBADCIFHDKApCXFHpAkCIFGkAS9PMDXBKKASHDXDKADAO0MBKKDNAdtMBAdAr+RuDBKAQYD94GpCDTAQCkFFC98FHhDNINAptMEAhYDBCBYD/w1JJBh+BJJJBBAhC98FHhApCUFHpXBKKAQCJ/BBF8kJJJJBADK/PLEOUABYDBCBAICDTZ1JJJB8aADCI9uHVDNADtMBABYDBHODNALtMBAEHRADHWINAOALARYDBCDTFYDBCDTFGdAdYDBCEFbDBARCLFHRAWCUFGWMBXDKKAEHRADHWINAOARYDBCDTFGdAdYDBCEFbDBARCLFHRAWCUFGWMBKKDNAItMBABYDBHRABYDLHWCBHdAIHOINAWAdbDBAWCLFHWARYDBAdFHdARCLFHRAOCUFGOMBKKDNADCI6MBAVCEAVCE0eHQABYDLHVABYDWHRINAECWFYDBHWAECLFYDBHdAEYDBHODNALtMBALAWCDTFYDBHWALAdCDTFYDBHdALAOCDTFYDBHOKARAVAOCDTFGDYDBCITFAdbDBARADYDBCITFAWbDLADADYDBCEFbDBARAVAdCDTFGDYDBCITFAWbDBARADYDBCITFAObDLADADYDBCEFbDBARAVAWCDTFGWYDBCITFAObDBARAWYDBCITFAdbDLAWAWYDBCEFbDBAECXFHEAQCUFGQMBKKDNAItMBABYDLHRABYDBHWINARARYDBAWYDB9rbDBAWCLFHWARCLFHRAICUFGIMBKKK+3LDOUV998jJJJJBCA9rGLCZFCWFCBYD11JJBbDBALCB8pDJ1JJB83IZALCWFCBYDn1JJBbDBALCB8pD+M1JJB83IBDNADtMBAICD4HVDNABtMBAVCDTHOCBHRAEHWINABARCX2FGIAEARAV2CDTFGdiDBuDBAIAdiDLuDLAIAdiDWuDWCBHIINALCZFAIFGdAWAIFiDBGQAdiDBGKAKAQ9eeuDBALAIFGdAQAdiDBGKAKAQ9deuDBAICLFGICX9HMBKAWAOFHWARCEFGRAD9HMBXDKKAVCDTHRCBHWINCBHIINALCZFAIFGdAEAIFiDBGQAdiDBGKAKAQ9eeuDBALAIFGdAQAdiDBGKAKAQ9deuDBAICLFGICX9HMBKAEARFHEAWCEFGWAD9HMBKKALiDBALiDZGK+TjBBBB+XGQALiDLALiDcGX+TGMAMAQ9deGQALiDWALiDkGM+TGpApAQ9deHpDNABtMBADtMBjBBBBjBBJzAp+VApjBBBB9beHQINABAQABiDBAK+TnuDBABCLFGIAQAIiDBAX+TnuDBABCWFGIAQAIiDBAM+TnuDBABCXFHBADCUFGDMBKKApK+qDIDUI99DUCBHI8jJJJJBCA9rGLCZFCWFCBYD11JJBbDBALCB8pDJ1JJB83IZALCWFCBYDn1JJBbDBALCB8pD+M1JJB83IBDNDNAEMBjBBJfHVjBBJfHOjBBJfHRXEKADCD4CDTHWINCBHDINALCZFADFGdABADFiDBGOAdiDBGRARAO9eeuDBALADFGdAOAdiDBGRARAO9deuDBADCLFGDCX9HMBKABAWFHBAICEFGIAE9HMBKALiDWALiDk+THRALiDLALiDc+THOALiDBALiDZ+THVKAVjBBBB+XGVAOAOAV9deGOARARAO9deK9dEEUABCfEAICDTZ1JJJBHLCBHIDNADtMBINDNALAEYDBCDTFGBYDBCU9HMBABAIbDBAICEFHIKAECLFHEADCUFGDMBKKAIK9TEIUCBCBYD/01JJBGEABCIFC98gFGBbD/01JJBDNDNABzBCZTGD9NMBCUHIABAD9rCffIFCZ4NBCUsMEKAEHIKAIK/lEEEUDNDNAEABvCIgtMBABHIXEKDNDNADCZ9PMBABHIXEKABHIINAIAEYDBbDBAICLFAECLFYDBbDBAICWFAECWFYDBbDBAICXFAECXFYDBbDBAICZFHIAECZFHEADC9wFGDCS0MBKKADCL6MBINAIAEYDBbDBAECLFHEAICLFHIADC98FGDCI0MBKKDNADtMBINAIAErBB86BBAICEFHIAECEFHEADCUFGDMBKKABK/AEEDUDNDNABCIgtMBABHIXEKAECfEgC+B+C+EW2HLDNDNADCZ9PMBABHIXEKABHIINAIALbDBAICXFALbDBAICWFALbDBAICLFALbDBAICZFHIADC9wFGDCS0MBKKADCL6MBINAIALbDBAICLFHIADC98FGDCI0MBKKDNADtMBINAIAE86BBAICEFHIADCUFGDMBKKABK9TEIUCBCBYD/01JJBGEABCIFC98gFGBbD/01JJBDNDNABzBCZTGD9NMBCUHIABAD9rCffIFCZ4NBCUsMEKAEHIKAIK9+EIUzBHEDNDNCBYD/01JJBGDAECZTGI9NMBCUHEADAI9rCffIFCZ4NBCUsMEKADHEKCBABAE9rCIFC98gCBYD/01JJBFGDbD/01JJBDNADzBCZTGE9NMBADAE9rCffIFCZ4NB8aKK6EIUCBHIDNADtMBDNINABrBBGLAErBBGV9HMEAECEFHEABCEFHBADCUFGDMBXDKKALAV9rHIKAIKK+CEDBCJWK9pffUUffUUffUUffUfffUfffUfBBBBBBBBEEEBEEBEBBEEEBEBBBBBEBEBBBBBEBBBDBBBBBBBBBBBBBBBEEEEEBEBBBBBEBBBBBEEBBBBBBC/sWKXEBBBDBBBJ9kBB",n=new Uint8Array([32,0,65,2,1,106,34,33,3,128,11,4,13,64,6,253,10,7,15,116,127,5,8,12,40,16,19,54,20,9,27,255,113,17,42,67,24,23,146,148,18,14,22,45,70,69,56,114,101,21,25,63,75,136,108,28,118,29,73,115]);if(typeof WebAssembly!="object")return{supported:!1};var i,o=WebAssembly.instantiate(r(t),{}).then(function(_){i=_.instance,i.exports.__wasm_call_ctors()});function r(_){for(var y=new Uint8Array(_.length),p=0;p<_.length;++p){var C=_.charCodeAt(p);y[p]=C>96?C-71:C>64?C-65:C>47?C+4:C>46?63:62}for(var x=0,p=0;p<_.length;++p)y[x++]=y[p]<60?n[y[p]]:(y[p]-60)*64+y[++p];return y.buffer.slice(0,x)}function s(_){if(!_)throw new Error("Assertion failed")}function a(_){return new Uint8Array(_.buffer,_.byteOffset,_.byteLength)}function c(_,y){var p=i.exports.sbrk,C=p(_.length*4),x=p(y*4),T=new Uint8Array(i.exports.memory.buffer),E=a(_);T.set(E,C);var S=i.exports.meshopt_optimizeVertexFetchRemap(x,C,_.length,y);T=new Uint8Array(i.exports.memory.buffer);var w=new Uint32Array(y);new Uint8Array(w.buffer).set(T.subarray(x,x+y*4)),E.set(T.subarray(C,C+_.length*4)),p(C-p(0));for(var D=0;D<_.length;++D)_[D]=w[_[D]];return[w,S]}function l(_){for(var y=0,p=0;p<_.length;++p){var C=_[p];y=y<C?C:y}return y}function u(_,y,p,C,x,T,E,S,w){var D=i.exports.sbrk,I=D(4),O=D(p*4),M=D(x*T),L=D(p*4),F=new Uint8Array(i.exports.memory.buffer);F.set(a(C),M),F.set(a(y),L);var g=_(O,L,p,M,x,T,E,S,w,I);F=new Uint8Array(i.exports.memory.buffer);var b=new Uint32Array(g);a(b).set(F.subarray(O,O+g*4));var v=new Float32Array(1);return a(v).set(F.subarray(I,I+4)),D(I-D(0)),[b,v[0]]}function d(_,y,p,C){var x=i.exports.sbrk,T=x(p*C),E=new Uint8Array(i.exports.memory.buffer);E.set(a(y),T);var S=_(T,p,C);return x(T-x(0)),S}var h={LockBorder:1};return{ready:o,supported:!0,compactMesh:function(_){s(_ instanceof Uint32Array||_ instanceof Int32Array||_ instanceof Uint16Array||_ instanceof Int16Array),s(_.length%3==0);var y=_.BYTES_PER_ELEMENT==4?_:new Uint32Array(_);return c(y,l(_)+1)},simplify:function(_,y,p,C,x,T){s(_ instanceof Uint32Array||_ instanceof Int32Array||_ instanceof Uint16Array||_ instanceof Int16Array),s(_.length%3==0),s(y instanceof Float32Array),s(y.length%p==0),s(p>=3),s(C%3==0);for(var E=0,S=0;S<(T?T.length:0);++S)E|=h[T[S]];var w=_.BYTES_PER_ELEMENT==4?_:new Uint32Array(_),D=u(i.exports.meshopt_simplify,w,_.length,y,y.length,p*4,C,x,E);return D[0]=_ instanceof Uint32Array?D[0]:new _.constructor(D[0]),D},getScale:function(_,y){return s(_ instanceof Float32Array),s(_.length%y==0),d(i.exports.meshopt_simplifyScale,_,_.length,y*4)}}}();function Kp(t){t=A(t,A.EMPTY_OBJECT);let n=t.resourceCache,i=t.gltf,o=t.bufferViewId,r=t.gltfResource,s=t.baseResource,a=t.cacheKey,c=i.bufferViews[o],l=c.buffer,u=c.byteOffset,d=c.byteLength,h=!1,_,y,p,C;if(Li(c,"EXT_meshopt_compression")){let T=c.extensions.EXT_meshopt_compression;l=T.buffer,u=A(T.byteOffset,0),d=T.byteLength,h=!0,_=T.byteStride,y=T.count,p=T.mode,C=A(T.filter,"NONE")}let x=i.buffers[l];this._hasMeshopt=h,this._meshoptByteStride=_,this._meshoptCount=y,this._meshoptMode=p,this._meshoptFilter=C,this._resourceCache=n,this._gltfResource=r,this._baseResource=s,this._buffer=x,this._bufferId=l,this._byteOffset=u,this._byteLength=d,this._cacheKey=a,this._bufferLoader=void 0,this._typedArray=void 0,this._state=kt.UNLOADED,this._promise=void 0,this._process=function(T,E){}}f(Object.create)&&(Kp.prototype=Object.create(eo.prototype),Kp.prototype.constructor=Kp);Object.defineProperties(Kp.prototype,{promise:{get:function(){return this._promise}},cacheKey:{get:function(){return this._cacheKey}},typedArray:{get:function(){return this._typedArray}}});Kp.prototype.load=function(){let t=Vwe(this);this._bufferLoader=t,this._state=kt.LOADING;let n=this,i=new Promise(function(o){n._process=function(r,s){if(!r._hasMeshopt||!f(r._typedArray)||r._state!==kt.PROCESSING)return;let a=r._meshoptCount,c=r._meshoptByteStride,l=new Uint8Array(a*c);fZ.decodeGltfBuffer(l,a,c,r._typedArray,r._meshoptMode,r._meshoptFilter),r._typedArray=l,r._state=kt.READY,o(r)}});return this._promise=t.promise.then(function(){if(n.isDestroyed())return;let o=t.typedArray,r=new Uint8Array(o.buffer,o.byteOffset+n._byteOffset,n._byteLength);return n.unload(),n._typedArray=r,n._hasMeshopt?(n._state=kt.PROCESSING,i):(n._state=kt.READY,n)}).catch(function(o){if(n.isDestroyed())return;n.unload(),n._state=kt.FAILED;let r="Failed to load buffer view";return Promise.reject(n.getError(r,o))}),this._promise};function Vwe(t){let n=t._resourceCache,i=t._buffer;if(f(i.uri)){let r=t._baseResource.getDerivedResource({url:i.uri});return n.loadExternalBuffer({resource:r})}return n.loadEmbeddedBuffer({parentResource:t._gltfResource,bufferId:t._bufferId})}Kp.prototype.process=function(t){return this._process(this,t)};Kp.prototype.unload=function(){f(this._bufferLoader)&&this._resourceCache.unload(this._bufferLoader),this._bufferLoader=void 0,this._typedArray=void 0};var Yb=Kp;function ba(){}ba._maxDecodingConcurrency=Math.max(Vt.hardwareConcurrency-1,1);ba._decoderTaskProcessor=void 0;ba._taskProcessorReady=!1;ba._getDecoderTaskProcessor=function(){if(!f(ba._decoderTaskProcessor)){let t=new fi("decodeDraco",ba._maxDecodingConcurrency);t.initWebAssemblyModule({modulePath:"ThirdParty/Workers/draco_decoder_nodejs.js",wasmBinaryFile:"ThirdParty/draco_decoder.wasm"}).then(function(){ba._taskProcessorReady=!0}),ba._decoderTaskProcessor=t}return ba._decoderTaskProcessor};ba.decodePointCloud=function(t){let n=ba._getDecoderTaskProcessor();if(!!ba._taskProcessorReady)return n.scheduleTask(t,[t.buffer.buffer])};ba.decodeBufferView=function(t){let n=ba._getDecoderTaskProcessor();if(!!ba._taskProcessorReady)return n.scheduleTask(t,[t.array.buffer])};var Jp=ba;function Zp(t){t=A(t,A.EMPTY_OBJECT);let n=t.resourceCache,i=t.gltf,o=t.draco,r=t.gltfResource,s=t.baseResource,a=t.cacheKey;this._resourceCache=n,this._gltfResource=r,this._baseResource=s,this._gltf=i,this._draco=o,this._cacheKey=a,this._bufferViewLoader=void 0,this._bufferViewTypedArray=void 0,this._decodePromise=void 0,this._decodedData=void 0,this._state=kt.UNLOADED,this._promise=void 0,this._process=function(c,l){}}f(Object.create)&&(Zp.prototype=Object.create(eo.prototype),Zp.prototype.constructor=Zp);Object.defineProperties(Zp.prototype,{promise:{get:function(){return this._promise}},cacheKey:{get:function(){return this._cacheKey}},decodedData:{get:function(){return this._decodedData}}});Zp.prototype.load=function(){let n=this._resourceCache.loadBufferView({gltf:this._gltf,bufferViewId:this._draco.bufferView,gltfResource:this._gltfResource,baseResource:this._baseResource});this._bufferViewLoader=n,this._state=kt.LOADING;let i=this,o=new Promise(function(r,s){i._process=function(a,c){if(!f(a._bufferViewTypedArray)||f(a._decodePromise))return;let l=a._draco,d=a._gltf.bufferViews,h=l.bufferView,_=d[h],y=l.attributes,p={array:new Uint8Array(a._bufferViewTypedArray),bufferView:_,compressedAttributes:y,dequantizeInShader:!0},C=Jp.decodeBufferView(p);!f(C)||(a._decodePromise=C.then(function(x){if(a.isDestroyed()){r();return}a.unload(),a._decodedData={indices:x.indexArray,vertexAttributes:x.attributeData},a._state=kt.READY,r(a)}).catch(function(x){if(a.isDestroyed()){r();return}s(x)}))}});return this._promise=n.promise.then(function(){if(!i.isDestroyed())return i._bufferViewTypedArray=n.typedArray,i._state=kt.PROCESSING,o}).catch(function(r){if(!i.isDestroyed())return kwe(i,r)}),this._promise};function kwe(t,n){t.unload(),t._state=kt.FAILED;let i="Failed to load Draco";return Promise.reject(t.getError(i,n))}Zp.prototype.process=function(t){return this._process(this,t)};Zp.prototype.unload=function(){f(this._bufferViewLoader)&&this._resourceCache.unload(this._bufferViewLoader),this._bufferViewLoader=void 0,this._bufferViewTypedArray=void 0,this._decodedData=void 0,this._gltf=void 0};var Xb=Zp;function Uwe(t){let n=t.uint8Array,i=t.format,o=t.request,r=A(t.flipY,!1),s=A(t.skipColorSpaceConversion,!1),a=new Blob([n],{type:i}),c;return Ie.supportsImageBitmapOptions().then(function(l){return l?Promise.resolve(Ie.createImageBitmapFromBlob(a,{flipY:r,premultiplyAlpha:!1,skipColorSpaceConversion:s})):(c=window.URL.createObjectURL(a),new Ie({url:c,request:o}).fetchImage({flipY:r,skipColorSpaceConversion:s}))}).then(function(l){return f(c)&&window.URL.revokeObjectURL(c),l}).catch(function(l){return f(c)&&window.URL.revokeObjectURL(c),Promise.reject(l)})}var MC=Uwe;function gm(t){t=A(t,A.EMPTY_OBJECT);let n=t.resourceCache,i=t.gltf,o=t.imageId,r=t.gltfResource,s=t.baseResource,a=t.cacheKey,c=i.images[o],l=c.bufferView,u=c.uri;this._resourceCache=n,this._gltfResource=r,this._baseResource=s,this._gltf=i,this._bufferViewId=l,this._uri=u,this._cacheKey=a,this._bufferViewLoader=void 0,this._image=void 0,this._mipLevels=void 0,this._state=kt.UNLOADED,this._promise=void 0}f(Object.create)&&(gm.prototype=Object.create(eo.prototype),gm.prototype.constructor=gm);Object.defineProperties(gm.prototype,{promise:{get:function(){return this._promise}},cacheKey:{get:function(){return this._cacheKey}},image:{get:function(){return this._image}},mipLevels:{get:function(){return this._mipLevels}}});gm.prototype.load=function(){return f(this._bufferViewId)?(this._promise=zwe(this),this._promise):(this._promise=Hwe(this),this._promise)};function dZ(t){let n;return Array.isArray(t)&&(n=t.slice(1,t.length).map(function(i){return i.bufferView}),t=t[0]),{image:t,mipLevels:n}}function zwe(t){let i=t._resourceCache.loadBufferView({gltf:t._gltf,bufferViewId:t._bufferViewId,gltfResource:t._gltfResource,baseResource:t._baseResource});return t._bufferViewLoader=i,t._state=kt.LOADING,i.promise.then(function(){if(t.isDestroyed())return;let o=i.typedArray;return Wwe(o).then(function(r){if(t.isDestroyed())return;let s=dZ(r);return t.unload(),t._image=s.image,t._mipLevels=s.mipLevels,t._state=kt.READY,t})}).catch(function(o){if(!t.isDestroyed())return hZ(t,o,"Failed to load embedded image")})}function Hwe(t){let n=t._baseResource,i=t._uri,o=n.getDerivedResource({url:i});return t._state=kt.LOADING,qwe(o).then(function(r){if(t.isDestroyed())return;let s=dZ(r);return t.unload(),t._image=s.image,t._mipLevels=s.mipLevels,t._state=kt.READY,t}).catch(function(r){if(!t.isDestroyed())return hZ(t,r,`Failed to load image: ${i}`)})}function hZ(t,n,i){return t.unload(),t._state=kt.FAILED,Promise.reject(t.getError(i,n))}function Gwe(t){let n=t.subarray(0,2),i=t.subarray(0,4),o=t.subarray(8,12);if(n[0]===255&&n[1]===216)return"image/jpeg";if(n[0]===137&&n[1]===80)return"image/png";if(n[0]===171&&n[1]===75)return"image/ktx2";if(i[0]===82&&i[1]===73&&i[2]===70&&i[3]===70&&o[0]===87&&o[1]===69&&o[2]===66&&o[3]===80)return"image/webp";throw new he("Image format is not recognized")}function Wwe(t){let n=Gwe(t);if(n==="image/ktx2"){let i=new Uint8Array(t);return xl(i)}return gm._loadImageFromTypedArray({uint8Array:t,format:n,flipY:!1,skipColorSpaceConversion:!0})}var jwe=/(^data:image\/ktx2)|(\.ktx2$)/i;function qwe(t){let n=t.url;return jwe.test(n)?xl(t):t.fetchImage({skipColorSpaceConversion:!0,preferImageBitmap:!0})}gm.prototype.unload=function(){f(this._bufferViewLoader)&&this._resourceCache.unload(this._bufferViewLoader),this._bufferViewLoader=void 0,this._uri=void 0,this._image=void 0,this._mipLevels=void 0,this._gltf=void 0};gm._loadImageFromTypedArray=MC;var Kb=gm;function Ywe(t,n){Bt(t,n)}var ws=Ywe;var Xwe={TEXTURE:0,PROGRAM:1,BUFFER:2,NUMBER_OF_JOB_TYPES:3},Sa=Object.freeze(Xwe);function Qp(t){t=A(t,A.EMPTY_OBJECT);let n=t.resourceCache,i=t.gltf,o=t.accessorId,r=t.gltfResource,s=t.baseResource,a=t.draco,c=t.cacheKey,l=A(t.asynchronous,!0),u=A(t.loadBuffer,!1),d=A(t.loadTypedArray,!1),h=i.accessors[o].componentType;this._resourceCache=n,this._gltfResource=r,this._baseResource=s,this._gltf=i,this._accessorId=o,this._indexDatatype=h,this._draco=a,this._cacheKey=c,this._asynchronous=l,this._loadBuffer=u,this._loadTypedArray=d,this._bufferViewLoader=void 0,this._dracoLoader=void 0,this._typedArray=void 0,this._buffer=void 0,this._state=kt.UNLOADED,this._promise=void 0,this._process=function(_,y){}}f(Object.create)&&(Qp.prototype=Object.create(eo.prototype),Qp.prototype.constructor=Qp);Object.defineProperties(Qp.prototype,{promise:{get:function(){return this._promise}},cacheKey:{get:function(){return this._cacheKey}},buffer:{get:function(){return this._buffer}},typedArray:{get:function(){return this._typedArray}},indexDatatype:{get:function(){return this._indexDatatype}}});var Kwe=new L8;Qp.prototype.load=function(){let t;f(this._draco)?t=Jwe(this):t=Zwe(this);let n=this,i=new Promise(function(o){n._process=function(r,s){if(r._state===kt.READY)return;let a=r._typedArray,c=r._indexDatatype;if(f(r._dracoLoader)&&r._dracoLoader.process(s),f(r._bufferViewLoader)&&r._bufferViewLoader.process(s),!f(a))return;let l;if(r._loadBuffer&&r._asynchronous){let u=Kwe;if(u.set(a,c,s.context),!s.jobScheduler.execute(u,Sa.BUFFER))return;l=u.buffer}else r._loadBuffer&&(l=mZ(a,c,s.context));r.unload(),r._buffer=l,r._typedArray=r._loadTypedArray?a:void 0,r._state=kt.READY,o(r)}});return this._promise=t.then(function(){if(!n.isDestroyed())return i}).catch(function(o){if(!n.isDestroyed())return $we(n,o)}),this._promise};function Jwe(t){let i=t._resourceCache.loadDraco({gltf:t._gltf,draco:t._draco,gltfResource:t._gltfResource,baseResource:t._baseResource});return t._dracoLoader=i,t._state=kt.LOADING,i.promise.then(function(){if(t.isDestroyed())return;let o=i.decodedData.indices.typedArray;return t._typedArray=o,t._indexDatatype=J.fromTypedArray(o),t._state=kt.PROCESSING,t})}function Zwe(t){let n=t._gltf,i=t._accessorId,r=n.accessors[i].bufferView,a=t._resourceCache.loadBufferView({gltf:n,bufferViewId:r,gltfResource:t._gltfResource,baseResource:t._baseResource});return t._state=kt.LOADING,t._bufferViewLoader=a,a.promise.then(function(){if(t.isDestroyed())return;let c=a.typedArray;return t._typedArray=Qwe(t,c),t._state=kt.PROCESSING,t})}function Qwe(t,n){let i=t._gltf,o=t._accessorId,r=i.accessors[o],s=r.count,a=r.componentType,c=Ne.getSizeInBytes(a),l=n.buffer,u=n.byteOffset+r.byteOffset;if(u%c!==0){let h=s*c,_=new Uint8Array(l,u,h);l=new Uint8Array(_).buffer,u=0,ws("index-buffer-unaligned",`The index array is not aligned to a ${c}-byte boundary.`)}let d;return a===Ne.UNSIGNED_BYTE?d=new Uint8Array(l,u,s):a===Ne.UNSIGNED_SHORT?d=new Uint16Array(l,u,s):a===Ne.UNSIGNED_INT&&(d=new Uint32Array(l,u,s)),d}function $we(t,n){t.unload(),t._state=kt.FAILED;let i="Failed to load index buffer";return n=t.getError(i,n),Promise.reject(n)}function L8(){this.typedArray=void 0,this.indexDatatype=void 0,this.context=void 0,this.buffer=void 0}L8.prototype.set=function(t,n,i){this.typedArray=t,this.indexDatatype=n,this.context=i};L8.prototype.execute=function(){this.buffer=mZ(this.typedArray,this.indexDatatype,this.context)};function mZ(t,n,i){let o=ut.createIndexBuffer({typedArray:t,context:i,usage:Fe.STATIC_DRAW,indexDatatype:n});return o.vertexArrayDestroyable=!1,o}Qp.prototype.process=function(t){return this._process(this,t)};Qp.prototype.unload=function(){f(this._buffer)&&this._buffer.destroy();let t=this._resourceCache;f(this._bufferViewLoader)&&t.unload(this._bufferViewLoader),f(this._dracoLoader)&&t.unload(this._dracoLoader),this._bufferViewLoader=void 0,this._dracoLoader=void 0,this._typedArray=void 0,this._buffer=void 0,this._gltf=void 0};var Jb=Qp;function eDe(t,n,i){return JSON.parse(bl(t,n,i))}var Ko=eDe;function tDe(t,n){return n=A(n,0),bl(t,n,Math.min(4,t.length))}var Wd=tDe;function nDe(t,n,i){if(i=A(i,!1),i){let o=t.indexOf(n);if(o>-1)return o}return t.push(n),t.length-1}var fs=nDe;function iDe(t,n){return f(t.extensionsUsed)&&t.extensionsUsed.indexOf(n)>=0}var yr=iDe;function zt(){}zt.objectLegacy=function(t,n){if(f(t)){for(let i in t)if(Object.prototype.hasOwnProperty.call(t,i)){let o=t[i],r=n(o,i);if(f(r))return r}}};zt.object=function(t,n){if(f(t)){let i=t.length;for(let o=0;o<i;o++){let r=t[o],s=n(r,o);if(f(s))return s}}};zt.topLevel=function(t,n,i){let o=t[n];return f(o)&&!Array.isArray(o)?zt.objectLegacy(o,i):zt.object(o,i)};zt.accessor=function(t,n){return zt.topLevel(t,"accessors",n)};zt.accessorWithSemantic=function(t,n,i){let o={};return zt.mesh(t,function(r){return zt.meshPrimitive(r,function(s){let a=zt.meshPrimitiveAttribute(s,function(c,l){if(l.indexOf(n)===0&&!f(o[c])){o[c]=!0;let u=i(c);if(f(u))return u}});return f(a)?a:zt.meshPrimitiveTarget(s,function(c){return zt.meshPrimitiveTargetAttribute(c,function(l,u){if(u.indexOf(n)===0&&!f(o[l])){o[l]=!0;let d=i(l);if(f(d))return d}})})})})};zt.accessorContainingVertexAttributeData=function(t,n){let i={};return zt.mesh(t,function(o){return zt.meshPrimitive(o,function(r){let s=zt.meshPrimitiveAttribute(r,function(a){if(!f(i[a])){i[a]=!0;let c=n(a);if(f(c))return c}});return f(s)?s:zt.meshPrimitiveTarget(r,function(a){return zt.meshPrimitiveTargetAttribute(a,function(c){if(!f(i[c])){i[c]=!0;let l=n(c);if(f(l))return l}})})})})};zt.accessorContainingIndexData=function(t,n){let i={};return zt.mesh(t,function(o){return zt.meshPrimitive(o,function(r){let s=r.indices;if(f(s)&&!f(i[s])){i[s]=!0;let a=n(s);if(f(a))return a}})})};zt.animation=function(t,n){return zt.topLevel(t,"animations",n)};zt.animationChannel=function(t,n){let i=t.channels;return zt.object(i,n)};zt.animationSampler=function(t,n){let i=t.samplers;return zt.object(i,n)};zt.buffer=function(t,n){return zt.topLevel(t,"buffers",n)};zt.bufferView=function(t,n){return zt.topLevel(t,"bufferViews",n)};zt.camera=function(t,n){return zt.topLevel(t,"cameras",n)};zt.image=function(t,n){return zt.topLevel(t,"images",n)};zt.material=function(t,n){return zt.topLevel(t,"materials",n)};zt.materialValue=function(t,n){let i=t.values;f(t.extensions)&&f(t.extensions.KHR_techniques_webgl)&&(i=t.extensions.KHR_techniques_webgl.values);for(let o in i)if(Object.prototype.hasOwnProperty.call(i,o)){let r=n(i[o],o);if(f(r))return r}};zt.mesh=function(t,n){return zt.topLevel(t,"meshes",n)};zt.meshPrimitive=function(t,n){let i=t.primitives;if(f(i)){let o=i.length;for(let r=0;r<o;r++){let s=i[r],a=n(s,r);if(f(a))return a}}};zt.meshPrimitiveAttribute=function(t,n){let i=t.attributes;for(let o in i)if(Object.prototype.hasOwnProperty.call(i,o)){let r=n(i[o],o);if(f(r))return r}};zt.meshPrimitiveTarget=function(t,n){let i=t.targets;if(f(i)){let o=i.length;for(let r=0;r<o;++r){let s=n(i[r],r);if(f(s))return s}}};zt.meshPrimitiveTargetAttribute=function(t,n){for(let i in t)if(Object.prototype.hasOwnProperty.call(t,i)){let o=t[i],r=n(o,i);if(f(r))return r}};zt.node=function(t,n){return zt.topLevel(t,"nodes",n)};zt.nodeInTree=function(t,n,i){let o=t.nodes;if(f(o)){let r=n.length;for(let s=0;s<r;s++){let a=n[s],c=o[a];if(f(c)){let l=i(c,a);if(f(l))return l;let u=c.children;if(f(u)&&(l=zt.nodeInTree(t,u,i),f(l)))return l}}}};zt.nodeInScene=function(t,n,i){let o=n.nodes;if(f(o))return zt.nodeInTree(t,o,i)};zt.program=function(t,n){return yr(t,"KHR_techniques_webgl")?zt.object(t.extensions.KHR_techniques_webgl.programs,n):zt.topLevel(t,"programs",n)};zt.sampler=function(t,n){return zt.topLevel(t,"samplers",n)};zt.scene=function(t,n){return zt.topLevel(t,"scenes",n)};zt.shader=function(t,n){return yr(t,"KHR_techniques_webgl")?zt.object(t.extensions.KHR_techniques_webgl.shaders,n):zt.topLevel(t,"shaders",n)};zt.skin=function(t,n){return zt.topLevel(t,"skins",n)};zt.skinJoint=function(t,n){let i=t.joints;if(f(i)){let o=i.length;for(let r=0;r<o;r++){let s=i[r],a=n(s);if(f(a))return a}}};zt.techniqueAttribute=function(t,n){let i=t.attributes;for(let o in i)if(Object.prototype.hasOwnProperty.call(i,o)){let r=n(i[o],o);if(f(r))return r}};zt.techniqueUniform=function(t,n){let i=t.uniforms;for(let o in i)if(Object.prototype.hasOwnProperty.call(i,o)){let r=n(i[o],o);if(f(r))return r}};zt.techniqueParameter=function(t,n){let i=t.parameters;for(let o in i)if(Object.prototype.hasOwnProperty.call(i,o)){let r=n(i[o],o);if(f(r))return r}};zt.technique=function(t,n){return yr(t,"KHR_techniques_webgl")?zt.object(t.extensions.KHR_techniques_webgl.techniques,n):zt.topLevel(t,"techniques",n)};zt.texture=function(t,n){return zt.topLevel(t,"textures",n)};var ve=zt;function oDe(t){ve.accessor(t,function(i){f(i.bufferView)&&(i.byteOffset=A(i.byteOffset,0))}),ve.bufferView(t,function(i){f(i.buffer)&&(i.byteOffset=A(i.byteOffset,0))}),ve.mesh(t,function(i){ve.meshPrimitive(i,function(o){if(o.mode=A(o.mode,ee.TRIANGLES),!f(o.material)){f(t.materials)||(t.materials=[]);let r={name:"default"};o.material=fs(t.materials,r)}})}),ve.accessorContainingVertexAttributeData(t,function(i){let o=t.accessors[i],r=o.bufferView;if(o.normalized=A(o.normalized,!1),f(r)){let s=t.bufferViews[r];s.byteStride=Tl(t,o),s.target=ee.ARRAY_BUFFER}}),ve.accessorContainingIndexData(t,function(i){let r=t.accessors[i].bufferView;if(f(r)){let s=t.bufferViews[r];s.target=ee.ELEMENT_ARRAY_BUFFER}}),ve.material(t,function(i){let o=A(i.extensions,A.EMPTY_OBJECT),r=o.KHR_materials_common;if(f(r)){let l=r.technique,u=f(r.values)?r.values:{};r.values=u,u.ambient=f(u.ambient)?u.ambient:[0,0,0,1],u.emission=f(u.emission)?u.emission:[0,0,0,1],u.transparency=A(u.transparency,1),l!=="CONSTANT"&&(u.diffuse=f(u.diffuse)?u.diffuse:[0,0,0,1],l!=="LAMBERT"&&(u.specular=f(u.specular)?u.specular:[0,0,0,1],u.shininess=A(u.shininess,0))),r.transparent=A(r.transparent,!1),r.doubleSided=A(r.doubleSided,!1);return}i.emissiveFactor=A(i.emissiveFactor,[0,0,0]),i.alphaMode=A(i.alphaMode,"OPAQUE"),i.doubleSided=A(i.doubleSided,!1),i.alphaMode==="MASK"&&(i.alphaCutoff=A(i.alphaCutoff,.5));let s=o.KHR_techniques_webgl;f(s)&&ve.materialValue(i,function(l){f(l.index)&&P0(l)}),P0(i.emissiveTexture),P0(i.normalTexture),P0(i.occlusionTexture);let a=i.pbrMetallicRoughness;f(a)&&(a.baseColorFactor=A(a.baseColorFactor,[1,1,1,1]),a.metallicFactor=A(a.metallicFactor,1),a.roughnessFactor=A(a.roughnessFactor,1),P0(a.baseColorTexture),P0(a.metallicRoughnessTexture));let c=o.KHR_materials_pbrSpecularGlossiness;f(c)&&(c.diffuseFactor=A(c.diffuseFactor,[1,1,1,1]),c.specularFactor=A(c.specularFactor,[1,1,1]),c.glossinessFactor=A(c.glossinessFactor,1),P0(c.specularGlossinessTexture))}),ve.animation(t,function(i){ve.animationSampler(i,function(o){o.interpolation=A(o.interpolation,"LINEAR")})});let n=rDe(t);return ve.node(t,function(i,o){f(n[o])||f(i.translation)||f(i.rotation)||f(i.scale)?(i.translation=A(i.translation,[0,0,0]),i.rotation=A(i.rotation,[0,0,0,1]),i.scale=A(i.scale,[1,1,1])):i.matrix=A(i.matrix,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}),ve.sampler(t,function(i){i.wrapS=A(i.wrapS,ee.REPEAT),i.wrapT=A(i.wrapT,ee.REPEAT)}),f(t.scenes)&&!f(t.scene)&&(t.scene=0),t}function rDe(t){let n={};return ve.animation(t,function(i){ve.animationChannel(i,function(o){let r=o.target,s=r.node,a=r.path;(a==="translation"||a==="rotation"||a==="scale")&&(n[s]=!0)})}),n}function P0(t){f(t)&&(t.texCoord=A(t.texCoord,0))}var MO=oDe;function sDe(t){return ve.shader(t,function(n){LO(n)}),ve.buffer(t,function(n){LO(n)}),ve.image(t,function(n){LO(n)}),LO(t),t}function LO(t){t.extras=f(t.extras)?t.extras:{},t.extras._pipeline=f(t.extras._pipeline)?t.extras._pipeline:{}}var I0=sDe;function aDe(t,n){let i=t.extensionsRequired;if(f(i)){let o=i.indexOf(n);o>=0&&i.splice(o,1),i.length===0&&delete t.extensionsRequired}}var FO=aDe;function cDe(t,n){let i=t.extensionsUsed;if(f(i)){let o=i.indexOf(n);o>=0&&i.splice(o,1),FO(t,n),i.length===0&&delete t.extensionsUsed}}var LC=cDe;var lDe=4;function uDe(t){if(Wd(t)!=="glTF")throw new he("File is not valid binary glTF");let i=pZ(t,0,5),o=i[1];if(o!==1&&o!==2)throw new he("Binary glTF version is not 1 or 2");return o===1?fDe(t,i):dDe(t,i)}function pZ(t,n,i){let o=new DataView(t.buffer),r=new Array(i);for(let s=0;s<i;++s)r[s]=o.getUint32(t.byteOffset+n+s*lDe,!0);return r}function fDe(t,n){let i=n[2],o=n[3];if(n[4]!==0)throw new he("Binary glTF scene format is not JSON");let s=20,a=s+o,c=bl(t,s,o),l=JSON.parse(c);I0(l);let u=t.subarray(a,i),d=l.buffers;if(f(d)&&Object.keys(d).length>0){let h=A(d.binary_glTF,d.KHR_binary_glTF);f(h)&&(h.extras._pipeline.source=u,delete h.uri)}return LC(l,"KHR_binary_glTF"),l}function dDe(t,n){let i=n[2],o=12,r,s;for(;o<i;){let a=pZ(t,o,2),c=a[0],l=a[1];o+=8;let u=t.subarray(o,o+c);if(o+=c,l===1313821514){let d=bl(u);r=JSON.parse(d),I0(r)}else l===5130562&&(s=u)}if(f(r)&&f(s)){let a=r.buffers;if(f(a)&&a.length>0){let c=a[0];c.extras._pipeline.source=s}}return r}var NO=uDe;function hDe(t){return ve.shader(t,function(n){VO(n)}),ve.buffer(t,function(n){VO(n)}),ve.image(t,function(n){VO(n)}),VO(t),t}function VO(t){!f(t.extras)||(f(t.extras._pipeline)&&delete t.extras._pipeline,Object.keys(t.extras).length===0&&delete t.extras)}var kO=hDe;function mDe(t,n){let i=t.extensionsUsed;f(i)||(i=[],t.extensionsUsed=i),fs(i,n,!0)}var Df=mDe;function pDe(t,n){let i=t.bufferViews,o=t.buffers,r=n.bufferView,s=du(n.type);if(!f(n.bufferView))return{min:new Array(s).fill(0),max:new Array(s).fill(0)};let a=new Array(s).fill(Number.POSITIVE_INFINITY),c=new Array(s).fill(Number.NEGATIVE_INFINITY),l=i[r],u=l.buffer,h=o[u].extras._pipeline.source,_=n.count,y=Tl(t,n),p=n.byteOffset+l.byteOffset+h.byteOffset,C=n.componentType,x=J.getSizeInBytes(C),T=new DataView(h.buffer),E=new Array(s),S=Wp(C);for(let w=0;w<_;w++){S(T,p,s,x,E);for(let D=0;D<s;D++){let I=E[D];a[D]=Math.min(a[D],I),c[D]=Math.max(c[D],I)}p+=y}return{min:a,max:c}}var FC=pDe;var _De=[ee.FUNC_ADD,ee.FUNC_ADD],gDe=[ee.ONE,ee.ZERO,ee.ONE,ee.ZERO];function _Z(t,n){let i=t.enable;return f(i)?i.indexOf(n)>-1:!1}var yDe=[ee.ZERO,ee.ONE,ee.SRC_COLOR,ee.ONE_MINUS_SRC_COLOR,ee.SRC_ALPHA,ee.ONE_MINUS_SRC_ALPHA,ee.DST_ALPHA,ee.ONE_MINUS_DST_ALPHA,ee.DST_COLOR,ee.ONE_MINUS_DST_COLOR];function ADe(t,n){if(!f(t))return n;for(let i=0;i<4;i++)if(yDe.indexOf(t[i])===-1)return n;return t}function CDe(t){let n={},i={},o=t.techniques;return f(o)&&(ve.technique(t,function(r,s){let a=r.states;if(f(a)){let c=i[s]={};if(_Z(a,ee.BLEND)){c.alphaMode="BLEND";let l=a.functions;f(l)&&(f(l.blendEquationSeparate)||f(l.blendFuncSeparate))&&(n[s]={blendEquation:A(l.blendEquationSeparate,_De),blendFactors:ADe(l.blendFuncSeparate,gDe)})}_Z(a,ee.CULL_FACE)||(c.doubleSided=!0),delete r.states}}),Object.keys(n).length>0&&(f(t.extensions)||(t.extensions={}),Df(t,"KHR_blend")),ve.material(t,function(r){if(f(r.technique)){let s=i[r.technique];ve.objectLegacy(s,function(c,l){r[l]=c});let a=n[r.technique];f(a)&&(f(r.extensions)||(r.extensions={}),r.extensions.KHR_blend=a)}})),t}var UO=CDe;function xDe(t,n){let i=t.extensionsRequired;f(i)||(i=[],t.extensionsRequired=i),fs(i,n,!0),Df(t,n)}var zO=xDe;function TDe(t){let n=t.techniques,i={},o={},r={};if(f(n)){let s={programs:[],shaders:[],techniques:[]},a=t.glExtensionsUsed;delete t.glExtensionsUsed,ve.technique(t,function(c,l){let u={name:c.name,program:void 0,attributes:{},uniforms:{}},d;if(ve.techniqueAttribute(c,function(h,_){d=c.parameters[h],u.attributes[_]={semantic:d.semantic}}),ve.techniqueUniform(c,function(h,_){d=c.parameters[h],u.uniforms[_]={count:d.count,node:d.node,type:d.type,semantic:d.semantic,value:d.value},f(i[l])||(i[l]={}),i[l][h]=_}),f(r[c.program]))u.program=r[c.program];else{let h=t.programs[c.program],_={name:h.name,fragmentShader:void 0,vertexShader:void 0,glExtensions:a},y=t.shaders[h.fragmentShader];_.fragmentShader=fs(s.shaders,y,!0);let p=t.shaders[h.vertexShader];_.vertexShader=fs(s.shaders,p,!0),u.program=fs(s.programs,_),r[c.program]=u.program}o[l]=fs(s.techniques,u)}),s.techniques.length>0&&(f(t.extensions)||(t.extensions={}),t.extensions.KHR_techniques_webgl=s,Df(t,"KHR_techniques_webgl"),zO(t,"KHR_techniques_webgl"))}return ve.material(t,function(s){if(f(s.technique)){let a={technique:o[s.technique]};ve.objectLegacy(s.values,function(c,l){f(a.values)||(a.values={});let u=i[s.technique][l];f(u)&&(a.values[u]=c)}),f(s.extensions)||(s.extensions={}),s.extensions.KHR_techniques_webgl=a}delete s.technique,delete s.values}),delete t.techniques,delete t.programs,delete t.shaders,t}var HO=TDe;function EDe(t,n){Ki.typeOf.object("material",t),Ki.defined("handler",n);let i=t.pbrMetallicRoughness;if(f(i)){if(f(i.baseColorTexture)){let r=i.baseColorTexture,s=n(r.index,r);if(f(s))return s}if(f(i.metallicRoughnessTexture)){let r=i.metallicRoughnessTexture,s=n(r.index,r);if(f(s))return s}}if(f(t.extensions)){let r=t.extensions.KHR_materials_pbrSpecularGlossiness;if(f(r)){if(f(r.diffuseTexture)){let a=r.diffuseTexture,c=n(a.index,a);if(f(c))return c}if(f(r.specularGlossinessTexture)){let a=r.specularGlossinessTexture,c=n(a.index,a);if(f(c))return c}}let s=t.extensions.KHR_materials_common;if(f(s)&&f(s.values)){let a=s.values.diffuse,c=s.values.ambient,l=s.values.emission,u=s.values.specular;if(f(a)&&f(a.index)){let d=n(a.index,a);if(f(d))return d}if(f(c)&&f(c.index)){let d=n(c.index,c);if(f(d))return d}if(f(l)&&f(l.index)){let d=n(l.index,l);if(f(d))return d}if(f(u)&&f(u.index)){let d=n(u.index,u);if(f(d))return d}}}let o=ve.materialValue(t,function(r){if(f(r.index)){let s=n(r.index,r);if(f(s))return s}});if(f(o))return o;if(f(t.emissiveTexture)){let r=t.emissiveTexture,s=n(r.index,r);if(f(s))return s}if(f(t.normalTexture)){let r=t.normalTexture,s=n(r.index,r);if(f(s))return s}if(f(t.occlusionTexture)){let r=t.occlusionTexture,s=n(r.index,r);if(f(s))return s}}var Zb=EDe;var gZ=["mesh","node","material","accessor","bufferView","buffer","texture","sampler","image"];function bDe(t,n){return n=A(n,gZ),gZ.forEach(function(i){n.indexOf(i)>-1&&wDe(t,i)}),t}var SDe={accessor:"accessors",buffer:"buffers",bufferView:"bufferViews",image:"images",node:"nodes",material:"materials",mesh:"meshes",sampler:"samplers",texture:"textures"};function wDe(t,n){let i=SDe[n],o=t[i];if(f(o)){let r=0,s=qd[n](t),a=o.length;for(let c=0;c<a;++c)s[c]||(jd[n](t,c-r),r++)}}function jd(){}jd.accessor=function(t,n){t.accessors.splice(n,1),ve.mesh(t,function(o){ve.meshPrimitive(o,function(r){ve.meshPrimitiveAttribute(r,function(a,c){a>n&&r.attributes[c]--}),ve.meshPrimitiveTarget(r,function(a){ve.meshPrimitiveTargetAttribute(a,function(c,l){c>n&&a[l]--})});let s=r.indices;f(s)&&s>n&&r.indices--})}),ve.skin(t,function(o){f(o.inverseBindMatrices)&&o.inverseBindMatrices>n&&o.inverseBindMatrices--}),ve.animation(t,function(o){ve.animationSampler(o,function(r){f(r.input)&&r.input>n&&r.input--,f(r.output)&&r.output>n&&r.output--})})};jd.buffer=function(t,n){t.buffers.splice(n,1),ve.bufferView(t,function(o){f(o.buffer)&&o.buffer>n&&o.buffer--,f(o.extensions)&&f(o.extensions.EXT_meshopt_compression)&&o.extensions.EXT_meshopt_compression.buffer--})};jd.bufferView=function(t,n){if(t.bufferViews.splice(n,1),ve.accessor(t,function(o){f(o.bufferView)&&o.bufferView>n&&o.bufferView--}),ve.shader(t,function(o){f(o.bufferView)&&o.bufferView>n&&o.bufferView--}),ve.image(t,function(o){f(o.bufferView)&&o.bufferView>n&&o.bufferView--}),yr(t,"KHR_draco_mesh_compression")&&ve.mesh(t,function(o){ve.meshPrimitive(o,function(r){f(r.extensions)&&f(r.extensions.KHR_draco_mesh_compression)&&r.extensions.KHR_draco_mesh_compression.bufferView>n&&r.extensions.KHR_draco_mesh_compression.bufferView--})}),yr(t,"EXT_feature_metadata")){let r=t.extensions.EXT_feature_metadata.featureTables;for(let s in r)if(r.hasOwnProperty(s)){let c=r[s].properties;if(f(c)){for(let l in c)if(c.hasOwnProperty(l)){let u=c[l];f(u.bufferView)&&u.bufferView>n&&u.bufferView--,f(u.arrayOffsetBufferView)&&u.arrayOffsetBufferView>n&&u.arrayOffsetBufferView--,f(u.stringOffsetBufferView)&&u.stringOffsetBufferView>n&&u.stringOffsetBufferView--}}}}if(yr(t,"EXT_structural_metadata")){let r=t.extensions.EXT_structural_metadata.propertyTables;if(f(r)){let s=r.length;for(let a=0;a<s;++a){let l=r[a].properties;for(let u in l)if(l.hasOwnProperty(u)){let d=l[u];f(d.values)&&d.values>n&&d.values--,f(d.arrayOffsets)&&d.arrayOffsets>n&&d.arrayOffsets--,f(d.stringOffsets)&&d.stringOffsets>n&&d.stringOffsets--}}}}};jd.image=function(t,n){t.images.splice(n,1),ve.texture(t,function(o){f(o.source)&&o.source>n&&--o.source;let r=o.extensions;f(r)&&f(r.EXT_texture_webp)&&r.EXT_texture_webp.source>n?--o.extensions.EXT_texture_webp.source:f(r)&&f(r.KHR_texture_basisu)&&r.KHR_texture_basisu.source>n&&--o.extensions.KHR_texture_basisu.source})};jd.mesh=function(t,n){t.meshes.splice(n,1),ve.node(t,function(o){f(o.mesh)&&(o.mesh>n?o.mesh--:o.mesh===n&&delete o.mesh)})};jd.node=function(t,n){t.nodes.splice(n,1),ve.skin(t,function(o){f(o.skeleton)&&o.skeleton>n&&o.skeleton--,o.joints=o.joints.map(function(r){return r>n?r-1:r})}),ve.animation(t,function(o){ve.animationChannel(o,function(r){f(r.target)&&f(r.target.node)&&r.target.node>n&&r.target.node--})}),ve.technique(t,function(o){ve.techniqueUniform(o,function(r){f(r.node)&&r.node>n&&r.node--})}),ve.node(t,function(o){!f(o.children)||(o.children=o.children.filter(function(r){return r!==n}).map(function(r){return r>n?r-1:r}))}),ve.scene(t,function(o){o.nodes=o.nodes.filter(function(r){return r!==n}).map(function(r){return r>n?r-1:r})})};jd.material=function(t,n){t.materials.splice(n,1),ve.mesh(t,function(o){ve.meshPrimitive(o,function(r){f(r.material)&&r.material>n&&r.material--})})};jd.sampler=function(t,n){t.samplers.splice(n,1),ve.texture(t,function(o){f(o.sampler)&&o.sampler>n&&--o.sampler})};jd.texture=function(t,n){if(t.textures.splice(n,1),ve.material(t,function(o){Zb(o,function(r,s){s.index>n&&--s.index})}),yr(t,"EXT_feature_metadata")){ve.mesh(t,function(s){ve.meshPrimitive(s,function(a){let c=a.extensions;if(f(c)&&f(c.EXT_feature_metadata)){let u=c.EXT_feature_metadata.featureIdTextures;if(f(u)){let d=u.length;for(let h=0;h<d;++h){let y=u[h].featureIds.texture;y.index>n&&--y.index}}}})});let r=t.extensions.EXT_feature_metadata.featureTextures;for(let s in r)if(r.hasOwnProperty(s)){let c=r[s].properties;if(f(c)){for(let l in c)if(c.hasOwnProperty(l)){let d=c[l].texture;d.index>n&&--d.index}}}}if(yr(t,"EXT_mesh_features")&&ve.mesh(t,function(o){ve.meshPrimitive(o,function(r){let s=r.extensions;if(f(s)&&f(s.EXT_mesh_features)){let c=s.EXT_mesh_features.featureIds;if(f(c)){let l=c.length;for(let u=0;u<l;++u){let d=c[u];f(d.texture)&&d.texture.index>n&&--d.texture.index}}}})}),yr(t,"EXT_structural_metadata")){let r=t.extensions.EXT_structural_metadata.propertyTextures;if(f(r)){let s=r.length;for(let a=0;a<s;++a){let l=r[a].properties;for(let u in l)if(l.hasOwnProperty(u)){let d=l[u];d.index>n&&--d.index}}}}};function qd(){}qd.accessor=function(t){let n={};return ve.mesh(t,function(i){ve.meshPrimitive(i,function(o){ve.meshPrimitiveAttribute(o,function(s){n[s]=!0}),ve.meshPrimitiveTarget(o,function(s){ve.meshPrimitiveTargetAttribute(s,function(a){n[a]=!0})});let r=o.indices;f(r)&&(n[r]=!0)})}),ve.skin(t,function(i){f(i.inverseBindMatrices)&&(n[i.inverseBindMatrices]=!0)}),ve.animation(t,function(i){ve.animationSampler(i,function(o){f(o.input)&&(n[o.input]=!0),f(o.output)&&(n[o.output]=!0)})}),yr(t,"EXT_mesh_gpu_instancing")&&ve.node(t,function(i){f(i.extensions)&&f(i.extensions.EXT_mesh_gpu_instancing)&&Object.keys(i.extensions.EXT_mesh_gpu_instancing.attributes).forEach(function(o){let r=i.extensions.EXT_mesh_gpu_instancing.attributes[o];n[r]=!0})}),n};qd.buffer=function(t){let n={};return ve.bufferView(t,function(i){f(i.buffer)&&(n[i.buffer]=!0),f(i.extensions)&&f(i.extensions.EXT_meshopt_compression)&&(n[i.extensions.EXT_meshopt_compression.buffer]=!0)}),n};qd.bufferView=function(t){let n={};if(ve.accessor(t,function(i){f(i.bufferView)&&(n[i.bufferView]=!0)}),ve.shader(t,function(i){f(i.bufferView)&&(n[i.bufferView]=!0)}),ve.image(t,function(i){f(i.bufferView)&&(n[i.bufferView]=!0)}),yr(t,"KHR_draco_mesh_compression")&&ve.mesh(t,function(i){ve.meshPrimitive(i,function(o){f(o.extensions)&&f(o.extensions.KHR_draco_mesh_compression)&&(n[o.extensions.KHR_draco_mesh_compression.bufferView]=!0)})}),yr(t,"EXT_feature_metadata")){let o=t.extensions.EXT_feature_metadata.featureTables;for(let r in o)if(o.hasOwnProperty(r)){let a=o[r].properties;if(f(a)){for(let c in a)if(a.hasOwnProperty(c)){let l=a[c];f(l.bufferView)&&(n[l.bufferView]=!0),f(l.arrayOffsetBufferView)&&(n[l.arrayOffsetBufferView]=!0),f(l.stringOffsetBufferView)&&(n[l.stringOffsetBufferView]=!0)}}}}if(yr(t,"EXT_structural_metadata")){let o=t.extensions.EXT_structural_metadata.propertyTables;if(f(o)){let r=o.length;for(let s=0;s<r;++s){let c=o[s].properties;for(let l in c)if(c.hasOwnProperty(l)){let u=c[l];f(u.values)&&(n[u.values]=!0),f(u.arrayOffsets)&&(n[u.arrayOffsets]=!0),f(u.stringOffsets)&&(n[u.stringOffsets]=!0)}}}}return n};qd.image=function(t){let n={};return ve.texture(t,function(i){f(i.source)&&(n[i.source]=!0),f(i.extensions)&&f(i.extensions.EXT_texture_webp)?n[i.extensions.EXT_texture_webp.source]=!0:f(i.extensions)&&f(i.extensions.KHR_texture_basisu)&&(n[i.extensions.KHR_texture_basisu.source]=!0)}),n};qd.mesh=function(t){let n={};return ve.node(t,function(i){if(f(i.mesh&&f(t.meshes))){let o=t.meshes[i.mesh];f(o)&&f(o.primitives)&&o.primitives.length>0&&(n[i.mesh]=!0)}}),n};function yZ(t,n,i){let o=t.nodes[n];return f(o.mesh)||f(o.camera)||f(o.skin)||f(o.weights)||f(o.extras)||f(o.extensions)&&Object.keys(o.extensions).length!==0||f(i[n])?!1:!f(o.children)||o.children.filter(function(r){return!yZ(t,r,i)}).length===0}qd.node=function(t){let n={};return ve.skin(t,function(i){f(i.skeleton)&&(n[i.skeleton]=!0),ve.skinJoint(i,function(o){n[o]=!0})}),ve.animation(t,function(i){ve.animationChannel(i,function(o){f(o.target)&&f(o.target.node)&&(n[o.target.node]=!0)})}),ve.technique(t,function(i){ve.techniqueUniform(i,function(o){f(o.node)&&(n[o.node]=!0)})}),ve.node(t,function(i,o){yZ(t,o,n)||(n[o]=!0)}),n};qd.material=function(t){let n={};return ve.mesh(t,function(i){ve.meshPrimitive(i,function(o){f(o.material)&&(n[o.material]=!0)})}),n};qd.texture=function(t){let n={};if(ve.material(t,function(i){Zb(i,function(o){n[o]=!0})}),yr(t,"EXT_feature_metadata")){ve.mesh(t,function(r){ve.meshPrimitive(r,function(s){let a=s.extensions;if(f(a)&&f(a.EXT_feature_metadata)){let l=a.EXT_feature_metadata.featureIdTextures;if(f(l)){let u=l.length;for(let d=0;d<u;++d){let _=l[d].featureIds.texture;n[_.index]=!0}}}})});let o=t.extensions.EXT_feature_metadata.featureTextures;for(let r in o)if(o.hasOwnProperty(r)){let a=o[r].properties;if(f(a)){for(let c in a)if(a.hasOwnProperty(c)){let u=a[c].texture;n[u.index]=!0}}}}if(yr(t,"EXT_mesh_features")&&ve.mesh(t,function(i){ve.meshPrimitive(i,function(o){let r=o.extensions;if(f(r)&&f(r.EXT_mesh_features)){let a=r.EXT_mesh_features.featureIds;if(f(a)){let c=a.length;for(let l=0;l<c;++l){let u=a[l];f(u.texture)&&(n[u.texture.index]=!0)}}}})}),yr(t,"EXT_structural_metadata")){let o=t.extensions.EXT_structural_metadata.propertyTextures;if(f(o)){let r=o.length;for(let s=0;s<r;++s){let c=o[s].properties;for(let l in c)if(c.hasOwnProperty(l)){let u=c[l];n[u.index]=!0}}}}return n};qd.sampler=function(t){let n={};return ve.texture(t,function(i){f(i.sampler)&&(n[i.sampler]=!0)}),n};var GO=bDe;function DDe(t,n){let i={byteLength:n.length,extras:{_pipeline:{source:n}}},r={buffer:fs(t.buffers,i),byteOffset:0,byteLength:n.length};return fs(t.bufferViews,r)}var WO=DDe;function vDe(t,n){let i=Tl(t,n),o=J.getSizeInBytes(n.componentType),r=du(n.type),s=n.count,a=new Array(r*s);if(!f(n.bufferView))return a.fill(0);let c=t.bufferViews[n.bufferView],l=t.buffers[c.buffer].extras._pipeline.source,u=n.byteOffset+c.byteOffset+l.byteOffset,d=new DataView(l.buffer),h=new Array(r),_=Wp(n.componentType);for(let y=0;y<s;++y){_(d,u,r,o,h);for(let p=0;p<r;++p)a[y*r+p]=h[p];u+=i}return a}var jO=vDe;function PDe(t){let n;return ve.accessorWithSemantic(t,"JOINTS_0",function(i){let o=t.accessors[i];n=o.componentType,n===ee.BYTE?qO(t,o,J.UNSIGNED_BYTE):n!==ee.UNSIGNED_BYTE&&n!==ee.UNSIGNED_SHORT&&qO(t,o,J.UNSIGNED_SHORT)}),ve.accessorWithSemantic(t,"WEIGHTS_0",function(i){let o=t.accessors[i];n=o.componentType,n===ee.BYTE?qO(t,o,J.UNSIGNED_BYTE):n===ee.SHORT&&qO(t,o,J.UNSIGNED_SHORT)}),t}function qO(t,n,i){let o=J.createTypedArray(i,jO(t,n)),r=new Uint8Array(o.buffer);n.bufferView=WO(t,r),n.componentType=i,n.byteOffset=0}var YO=PDe;function IDe(t,n){return LC(t,n),n==="CESIUM_RTC"&&BDe(t),F8(t,n)}function BDe(t){ve.technique(t,function(n){ve.techniqueUniform(n,function(i){i.semantic==="CESIUM_RTC_MODELVIEW"&&(i.semantic="MODELVIEW")})})}function F8(t,n){if(Array.isArray(t)){let i=t.length;for(let o=0;o<i;++o)F8(t[o],n)}else if(t!==null&&typeof t=="object"&&t.constructor===Object){let i=t.extensions,o;f(i)&&(o=i[n],f(o)&&(delete i[n],Object.keys(i).length===0&&delete t.extensions));for(let r in t)Object.prototype.hasOwnProperty.call(t,r)&&F8(t[r],n);return o}}var NC=IDe;var XO={.8:NDe,"1.0":ove,"2.0":void 0};function ODe(t,n){n=A(n,A.EMPTY_OBJECT);let i=n.targetVersion,o=t.version;t.asset=A(t.asset,{version:"1.0"}),t.asset.version=A(t.asset.version,"1.0"),o=A(o,t.asset.version).toString(),Object.prototype.hasOwnProperty.call(XO,o)||(f(o)&&(o=o.substring(0,3)),Object.prototype.hasOwnProperty.call(XO,o)||(o="1.0"));let r=XO[o];for(;f(r)&&o!==i;)r(t,n),o=t.asset.version,r=XO[o];return n.keepLegacyExtensions||(ave(t),cve(t)),t}function CZ(t){let n=t.materials;for(let i in n)if(Object.prototype.hasOwnProperty.call(n,i)){let o=n[i],r=o.instanceTechnique;f(r)&&(o.technique=r.technique,o.values=r.values,delete o.instanceTechnique)}}function RDe(t){let n=t.meshes;for(let i in n)if(Object.prototype.hasOwnProperty.call(n,i)){let r=n[i].primitives;if(f(r)){let s=r.length;for(let a=0;a<s;++a){let c=r[a],l=A(c.primitive,ee.TRIANGLES);c.mode=A(c.mode,l),delete c.primitive}}}}function MDe(t){let n=t.nodes,i=new m,o=new Me;for(let r in n)if(Object.prototype.hasOwnProperty.call(n,r)){let s=n[r];if(f(s.rotation)){let c=s.rotation;m.fromArray(c,0,i),Me.fromAxisAngle(i,c[3],o),s.rotation=[o.x,o.y,o.z,o.w]}let a=s.instanceSkin;f(a)&&(s.skeletons=a.skeletons,s.skin=a.skin,s.meshes=a.meshes,delete s.instanceSkin)}}function LDe(t){let n=t.animations,i=t.accessors,o=t.bufferViews,r=t.buffers,s={},a=new m,c=new Me;for(let l in n)if(Object.prototype.hasOwnProperty.call(n,l)){let u=n[l],d=u.channels,h=u.parameters,_=u.samplers;if(f(d)){let y=d.length;for(let p=0;p<y;++p){let C=d[p];if(C.target.path==="rotation"){let x=h[_[C.sampler].output];if(f(s[x]))continue;s[x]=!0;let T=i[x],E=o[T.bufferView],w=r[E.buffer].extras._pipeline.source,D=w.byteOffset+E.byteOffset+T.byteOffset,I=T.componentType,O=T.count,M=du(T.type),L=T.count*M,F=J.createArrayBufferView(I,w.buffer,D,L);for(let g=0;g<O;g++){let b=g*M;m.unpack(F,b,a);let v=F[b+3];Me.fromAxisAngle(a,v,c),Me.pack(c,F,b)}}}}}}function FDe(t){let n=t.techniques;for(let i in n)if(Object.prototype.hasOwnProperty.call(n,i)){let o=n[i],r=o.passes;if(f(r)){let s=A(o.pass,"defaultPass");if(Object.prototype.hasOwnProperty.call(r,s)){let a=r[s],c=a.instanceProgram;o.attributes=A(o.attributes,c.attributes),o.program=A(o.program,c.program),o.uniforms=A(o.uniforms,c.uniforms),o.states=A(o.states,a.states)}delete o.passes,delete o.pass}}}function NDe(t){f(t.asset)||(t.asset={});let n=t.asset;if(n.version="1.0",typeof n.profile=="string"){let i=n.profile.split(" ");n.profile={api:i[0],version:i[1]}}else n.profile={};if(f(t.version)&&delete t.version,CZ(t),RDe(t),MDe(t),LDe(t),FDe(t),f(t.allExtensions)&&(t.extensionsUsed=t.allExtensions,delete t.allExtensions),f(t.lights)){let i=A(t.extensions,{});t.extensions=i;let o=A(i.KHR_materials_common,{});i.KHR_materials_common=o,o.lights=t.lights,delete t.lights,Df(t,"KHR_materials_common")}}function VDe(t){let n=t.animations;for(let i in n)if(Object.prototype.hasOwnProperty.call(n,i)){let o=n[i],r=o.parameters;if(f(r)){let s=o.samplers;for(let a in s)if(Object.prototype.hasOwnProperty.call(s,a)){let c=s[a];c.input=r[c.input],c.output=r[c.output]}delete o.parameters}}}function AZ(t,n){let i=[];for(let o in t)if(Object.prototype.hasOwnProperty.call(t,o)){let r=t[o];n[o]=i.length,i.push(r),f(r.name)||(r.name=o)}return i}function kDe(t){let n,i={accessors:{},animations:{},buffers:{},bufferViews:{},cameras:{},images:{},materials:{},meshes:{},nodes:{},programs:{},samplers:{},scenes:{},shaders:{},skins:{},textures:{},techniques:{}},o,r={},s=t.nodes;for(let a in s)Object.prototype.hasOwnProperty.call(s,a)&&(o=s[a].jointName,f(o)&&(r[o]=a));for(let a in t)if(Object.prototype.hasOwnProperty.call(t,a)&&f(i[a])){let c={},l=t[a];t[a]=AZ(l,c),i[a]=c}for(o in r)Object.prototype.hasOwnProperty.call(r,o)&&(r[o]=i.nodes[r[o]]);f(t.scene)&&(t.scene=i.scenes[t.scene]),ve.bufferView(t,function(a){f(a.buffer)&&(a.buffer=i.buffers[a.buffer])}),ve.accessor(t,function(a){f(a.bufferView)&&(a.bufferView=i.bufferViews[a.bufferView])}),ve.shader(t,function(a){let c=a.extensions;if(f(c)){let l=c.KHR_binary_glTF;f(l)&&(a.bufferView=i.bufferViews[l.bufferView],delete c.KHR_binary_glTF),Object.keys(c).length===0&&delete a.extensions}}),ve.program(t,function(a){f(a.vertexShader)&&(a.vertexShader=i.shaders[a.vertexShader]),f(a.fragmentShader)&&(a.fragmentShader=i.shaders[a.fragmentShader])}),ve.technique(t,function(a){f(a.program)&&(a.program=i.programs[a.program]),ve.techniqueParameter(a,function(c){f(c.node)&&(c.node=i.nodes[c.node]);let l=c.value;typeof l=="string"&&(c.value={index:i.textures[l]})})}),ve.mesh(t,function(a){ve.meshPrimitive(a,function(c){f(c.indices)&&(c.indices=i.accessors[c.indices]),ve.meshPrimitiveAttribute(c,function(l,u){c.attributes[u]=i.accessors[l]}),f(c.material)&&(c.material=i.materials[c.material])})}),ve.node(t,function(a){let c=a.children;if(f(c)){let l=c.length;for(n=0;n<l;++n)c[n]=i.nodes[c[n]]}if(f(a.meshes)){let l=a.meshes,u=l.length;if(u>0)for(a.mesh=i.meshes[l[0]],n=1;n<u;++n){let d={mesh:i.meshes[l[n]]},h=fs(t.nodes,d);f(c)||(c=[],a.children=c),c.push(h)}delete a.meshes}if(f(a.camera)&&(a.camera=i.cameras[a.camera]),f(a.skin)&&(a.skin=i.skins[a.skin]),f(a.skeletons)){let l=a.skeletons;if(l.length>0&&f(a.skin)){let d=t.skins[a.skin];d.skeleton=i.nodes[l[0]]}delete a.skeletons}f(a.jointName)&&delete a.jointName}),ve.skin(t,function(a){f(a.inverseBindMatrices)&&(a.inverseBindMatrices=i.accessors[a.inverseBindMatrices]);let c=a.jointNames;if(f(c)){let l=[],u=c.length;for(n=0;n<u;++n)l[n]=r[c[n]];a.joints=l,delete a.jointNames}}),ve.scene(t,function(a){let c=a.nodes;if(f(c)){let l=c.length;for(n=0;n<l;++n)c[n]=i.nodes[c[n]]}}),ve.animation(t,function(a){let c={};a.samplers=AZ(a.samplers,c),ve.animationSampler(a,function(l){l.input=i.accessors[l.input],l.output=i.accessors[l.output]}),ve.animationChannel(a,function(l){l.sampler=c[l.sampler];let u=l.target;f(u)&&(u.node=i.nodes[u.id],delete u.id)})}),ve.material(t,function(a){f(a.technique)&&(a.technique=i.techniques[a.technique]),ve.materialValue(a,function(l,u){typeof l=="string"&&(a.values[u]={index:i.textures[l]})});let c=a.extensions;if(f(c)){let l=c.KHR_materials_common;f(l)&&f(l.values)&&ve.materialValue(l,function(u,d){typeof u=="string"&&(l.values[d]={index:i.textures[u]})})}}),ve.image(t,function(a){let c=a.extensions;if(f(c)){let l=c.KHR_binary_glTF;f(l)&&(a.bufferView=i.bufferViews[l.bufferView],a.mimeType=l.mimeType,delete c.KHR_binary_glTF),Object.keys(c).length===0&&delete a.extensions}}),ve.texture(t,function(a){f(a.sampler)&&(a.sampler=i.samplers[a.sampler]),f(a.source)&&(a.source=i.images[a.source])})}function UDe(t){ve.animation(t,function(n){ve.animationSampler(n,function(i){delete i.name})})}function zDe(t){for(let n in t)if(Object.prototype.hasOwnProperty.call(t,n)){let i=t[n];Array.isArray(i)&&i.length===0&&delete t[n]}ve.node(t,function(n){f(n.children)&&n.children.length===0&&delete n.children})}function HDe(t){let n=t.asset;delete n.profile,delete n.premultipliedAlpha}var GDe={CESIUM_RTC:!0,KHR_materials_common:!0,WEB3D_quantized_attributes:!0};function WDe(t){let n=t.extensionsUsed;if(t.extensionsRequired=A(t.extensionsRequired,[]),f(n)){let i=n.length;for(let o=0;o<i;++o){let r=n[o];f(GDe[r])&&t.extensionsRequired.push(r)}}}function jDe(t){ve.buffer(t,function(n){delete n.type})}function qDe(t){ve.texture(t,function(n){delete n.format,delete n.internalFormat,delete n.target,delete n.type})}function YDe(t){ve.mesh(t,function(n){ve.meshPrimitive(n,function(i){ve.meshPrimitiveAttribute(i,function(o,r){r==="TEXCOORD"?i.attributes.TEXCOORD_0=o:r==="COLOR"&&(i.attributes.COLOR_0=o)}),delete i.attributes.TEXCOORD,delete i.attributes.COLOR})}),ve.technique(t,function(n){ve.techniqueParameter(n,function(i){let o=i.semantic;f(o)&&(o==="TEXCOORD"?i.semantic="TEXCOORD_0":o==="COLOR"&&(i.semantic="COLOR_0"))})})}var XDe={POSITION:!0,NORMAL:!0,TANGENT:!0},KDe={COLOR:"COLOR",JOINT:"JOINTS",JOINTS:"JOINTS",TEXCOORD:"TEXCOORD",WEIGHT:"WEIGHTS",WEIGHTS:"WEIGHTS"};function JDe(t){let n={};ve.mesh(t,function(i){ve.meshPrimitive(i,function(o){ve.meshPrimitiveAttribute(o,function(r,s){if(s.charAt(0)!=="_"){let a=s.search(/_[0-9]+/g),c=s,l="_0";a>=0&&(c=s.substring(0,a),l=s.substring(a));let u,d=KDe[c];f(d)?(u=d+l,n[s]=u):f(XDe[c])||(u=`_${s}`,n[s]=u)}});for(let r in n)if(Object.prototype.hasOwnProperty.call(n,r)){let s=n[r],a=o.attributes[r];f(a)&&(delete o.attributes[r],o.attributes[s]=a)}})}),ve.technique(t,function(i){ve.techniqueParameter(i,function(o){let r=n[o.semantic];f(r)&&(o.semantic=r)})})}function ZDe(t){ve.camera(t,function(n){let i=n.perspective;if(f(i)){let o=i.aspectRatio;f(o)&&o===0&&delete i.aspectRatio;let r=i.yfov;f(r)&&r===0&&(i.yfov=1)}})}function N8(t,n){return f(n.byteStride)&&n.byteStride!==0?n.byteStride:Tl(t,n)}function QDe(t){ve.buffer(t,function(n){f(n.byteLength)||(n.byteLength=n.extras._pipeline.source.length)}),ve.accessor(t,function(n){let i=n.bufferView;if(f(i)){let o=t.bufferViews[i],r=N8(t,n),s=n.byteOffset+n.count*r;o.byteLength=Math.max(A(o.byteLength,0),s)}})}function $De(t){let n,i,o,r=t.bufferViews,s={};ve.accessorContainingVertexAttributeData(t,function(c){let l=t.accessors[c];f(l.bufferView)&&(s[l.bufferView]=!0)});let a={};ve.accessor(t,function(c){f(c.bufferView)&&(a[c.bufferView]=A(a[c.bufferView],[]),a[c.bufferView].push(c))});for(let c in a)if(Object.prototype.hasOwnProperty.call(a,c)){o=r[c];let l=a[c];l.sort(function(_,y){return _.byteOffset-y.byteOffset});let u=0,d=0,h=l.length;for(n=0;n<h;++n){let _=l[n],y=N8(t,_),p=_.byteOffset,C=_.count*y;delete _.byteStride;let x=n<h-1,T=x?N8(t,l[n+1]):void 0;if(y!==T){let E=tt(o,!0);s[c]&&(E.byteStride=y),E.byteOffset+=u,E.byteLength=p+C-u;let S=fs(r,E);for(i=d;i<=n;++i)_=l[i],_.bufferView=S,_.byteOffset=_.byteOffset-u;u=x?l[n+1].byteOffset:void 0,d=n+1}}}GO(t,["accessor","bufferView","buffer"])}function eve(t){ve.accessorWithSemantic(t,"POSITION",function(n){let i=t.accessors[n];if(!f(i.min)||!f(i.max)){let o=FC(t,i);i.min=o.min,i.max=o.max}})}function xZ(t){return(!f(t.children)||t.children.length===0)&&(!f(t.meshes)||t.meshes.length===0)&&!f(t.camera)&&!f(t.skin)&&!f(t.skeletons)&&!f(t.jointName)&&(!f(t.translation)||m.fromArray(t.translation).equals(m.ZERO))&&(!f(t.scale)||m.fromArray(t.scale).equals(new m(1,1,1)))&&(!f(t.rotation)||se.fromArray(t.rotation).equals(new se(0,0,0,1)))&&(!f(t.matrix)||N.fromColumnMajorArray(t.matrix).equals(N.IDENTITY))&&!f(t.extensions)&&!f(t.extras)}function TZ(t,n){ve.scene(t,function(i){let o=i.nodes;if(f(o)){let r=o.length;for(let s=r;s>=0;--s)if(o[s]===n){o.splice(s,1);return}}}),ve.node(t,function(i,o){if(f(i.children)){let r=i.children.indexOf(n);r>-1&&(i.children.splice(r,1),xZ(i)&&TZ(t,o))}}),delete t.nodes[n]}function tve(t){return ve.node(t,function(n,i){xZ(n)&&TZ(t,i)}),t}function nve(t){ve.animation(t,function(n){ve.animationSampler(n,function(i){let o=t.accessors[i.input];if(!f(o.min)||!f(o.max)){let r=FC(t,o);o.min=r.min,o.max=r.max}})})}function ive(t){ve.accessor(t,function(n){if(f(n.min)||f(n.max)){let i=FC(t,n);f(n.min)&&(n.min=i.min),f(n.max)&&(n.max=i.max)}})}function ove(t){t.asset=A(t.asset,{}),t.asset.version="2.0",CZ(t),VDe(t),tve(t),kDe(t),UDe(t),HDe(t),WDe(t),QDe(t),$De(t),eve(t),nve(t),ive(t),jDe(t),qDe(t),YDe(t),JDe(t),YO(t),ZDe(t),UO(t),HO(t),zDe(t)}var rve=["u_tex","u_diffuse","u_emission"],sve=["u_diffuse"];function V8(t){t.pbrMetallicRoughness=f(t.pbrMetallicRoughness)?t.pbrMetallicRoughness:{},t.pbrMetallicRoughness.roughnessFactor=1,t.pbrMetallicRoughness.metallicFactor=0}function KO(t){return f(t.index)}function JO(t){return Array.isArray(t)&&t.length===4}function EZ(t){let n=new Array(4);n[3]=t[3];for(let i=0;i<3;i++){let o=t[i];o<=.04045?n[i]=t[i]*.07739938080495357:n[i]=Math.pow((o+.055)*.9478672985781991,2.4)}return n}function ave(t){ve.material(t,function(n){ve.materialValue(n,function(i,o){rve.indexOf(o)!==-1&&KO(i)?(V8(n),n.pbrMetallicRoughness.baseColorTexture=i):sve.indexOf(o)!==-1&&JO(i)&&(V8(n),n.pbrMetallicRoughness.baseColorFactor=EZ(i))})}),NC(t,"KHR_techniques_webgl"),NC(t,"KHR_blend")}function cve(t){ve.material(t,function(n){let i=A(n.extensions,A.EMPTY_OBJECT).KHR_materials_common;if(f(i)){i.technique==="CONSTANT"&&(Df(t,"KHR_materials_unlit"),n.extensions=f(n.extensions)?n.extensions:{},n.extensions.KHR_materials_unlit={});let r=f(i.values)?i.values:{},s=r.ambient,a=r.diffuse,c=r.emission,l=r.transparency,u=i.doubleSided,d=i.transparent;V8(n),f(s)&&(JO(s)?n.emissiveFactor=s.slice(0,3):KO(s)&&(n.emissiveTexture=s)),f(a)&&(JO(a)?n.pbrMetallicRoughness.baseColorFactor=EZ(a):KO(a)&&(n.pbrMetallicRoughness.baseColorTexture=a)),f(u)&&(n.doubleSided=u),f(c)&&(JO(c)?n.emissiveFactor=c.slice(0,3):KO(c)&&(n.emissiveTexture=c)),f(l)&&(f(n.pbrMetallicRoughness.baseColorFactor)?n.pbrMetallicRoughness.baseColorFactor[3]*=l:n.pbrMetallicRoughness.baseColorFactor=[1,1,1,l]),f(d)&&(n.alphaMode=d?"BLEND":"OPAQUE")}}),NC(t,"KHR_materials_common")}var ZO=ODe;function $p(t){t=A(t,A.EMPTY_OBJECT);let n=t.resourceCache,i=t.gltfResource,o=t.baseResource,r=t.typedArray,s=t.gltfJson,a=t.cacheKey;this._resourceCache=n,this._gltfResource=i,this._baseResource=o,this._typedArray=r,this._gltfJson=s,this._cacheKey=a,this._gltf=void 0,this._bufferLoaders=[],this._state=kt.UNLOADED,this._promise=void 0}f(Object.create)&&($p.prototype=Object.create(eo.prototype),$p.prototype.constructor=$p);Object.defineProperties($p.prototype,{promise:{get:function(){return this._promise}},cacheKey:{get:function(){return this._cacheKey}},gltf:{get:function(){return this._gltf}}});$p.prototype.load=function(){this._state=kt.LOADING;let t;f(this._gltfJson)?t=bZ(this,this._gltfJson):f(this._typedArray)?t=SZ(this,this._typedArray):t=lve(this);let n=this;return this._promise=t.then(function(i){if(!n.isDestroyed())return n._gltf=i,n._state=kt.READY,n}).catch(function(i){if(!n.isDestroyed())return uve(n,i)}),this._promise};function lve(t){return t._fetchGltf().then(function(n){if(t.isDestroyed())return;let i=new Uint8Array(n);return SZ(t,i)})}function uve(t,n){t.unload(),t._state=kt.FAILED;let i=`Failed to load glTF: ${t._gltfResource.url}`;return Promise.reject(t.getError(i,n))}function fve(t,n){if(f(n.asset)&&n.asset.version==="2.0"&&!yr(n,"KHR_techniques_webgl")&&!yr(n,"KHR_materials_common"))return Promise.resolve();let i=[];return ve.buffer(n,function(o){if(!f(o.extras._pipeline.source)&&f(o.uri)){let r=t._baseResource.getDerivedResource({url:o.uri}),a=t._resourceCache.loadExternalBuffer({resource:r});t._bufferLoaders.push(a),i.push(a.promise.then(function(c){o.extras._pipeline.source=c.typedArray}))}}),Promise.all(i).then(function(){ZO(n)})}function dve(t){let n=[];return ve.buffer(t,function(i){let o=i.uri;!f(i.extras._pipeline.source)&&f(o)&&Fp(o)&&(delete i.uri,n.push(Ie.fetchArrayBuffer(o).then(function(r){i.extras._pipeline.source=new Uint8Array(r)})))}),Promise.all(n)}function hve(t,n){let i=[];return ve.buffer(n,function(o,r){let s=o.extras._pipeline.source;if(f(s)&&!f(o.uri)){let c=t._resourceCache.loadEmbeddedBuffer({parentResource:t._gltfResource,bufferId:r,typedArray:s});t._bufferLoaders.push(c),i.push(c.promise)}}),Promise.all(i)}function bZ(t,n){return I0(n),dve(n).then(function(){return fve(t,n)}).then(function(){return MO(n),hve(t,n)}).then(function(){return kO(n),n})}function SZ(t,n){let i;return Wd(n)==="glTF"?i=NO(n):i=Ko(n),bZ(t,i)}$p.prototype.unload=function(){let t=this._bufferLoaders,n=t.length;for(let i=0;i<n;++i)this._resourceCache.unload(t[i]);this._bufferLoaders.length=0,this._gltf=void 0};$p.prototype._fetchGltf=function(){return this._gltfResource.fetchArrayBuffer()};var Qb=$p;function mve(t){let n=document.createElement("canvas");return n.width=B.nextPowerOfTwo(t.width),n.height=B.nextPowerOfTwo(t.height),n.getContext("2d").drawImage(t,0,0,t.width,t.height,0,0,n.width,n.height),n}var B0=mve;function e_(t){t=A(t,A.EMPTY_OBJECT);let n=t.resourceCache,i=t.gltf,o=t.textureInfo,r=t.gltfResource,s=t.baseResource,a=t.supportedImageFormats,c=t.cacheKey,l=A(t.asynchronous,!0),u=o.index,d=El.getImageIdFromTexture({gltf:i,textureId:u,supportedImageFormats:a});this._resourceCache=n,this._gltf=i,this._textureInfo=o,this._imageId=d,this._gltfResource=r,this._baseResource=s,this._cacheKey=c,this._asynchronous=l,this._imageLoader=void 0,this._image=void 0,this._mipLevels=void 0,this._texture=void 0,this._state=kt.UNLOADED,this._promise=void 0,this._process=function(h,_){}}f(Object.create)&&(e_.prototype=Object.create(eo.prototype),e_.prototype.constructor=e_);Object.defineProperties(e_.prototype,{promise:{get:function(){return this._promise}},cacheKey:{get:function(){return this._cacheKey}},texture:{get:function(){return this._texture}}});var pve=new k8;e_.prototype.load=function(){let n=this._resourceCache.loadImage({gltf:this._gltf,imageId:this._imageId,gltfResource:this._gltfResource,baseResource:this._baseResource});this._imageLoader=n,this._state=kt.LOADING;let i=this,o=new Promise(function(r){i._process=function(s,a){if(f(s._texture)||!f(s._image))return;let c;if(s._asynchronous){let l=pve;if(l.set(s._gltf,s._textureInfo,s._image,s._mipLevels,a.context),!a.jobScheduler.execute(l,Sa.TEXTURE))return;c=l.texture}else c=wZ(s._gltf,s._textureInfo,s._image,s._mipLevels,a.context);s.unload(),s._texture=c,s._state=kt.READY,r(s)}});return this._promise=n.promise.then(function(){if(!i.isDestroyed())return i._image=n.image,i._mipLevels=n.mipLevels,i._state=kt.PROCESSING,o}).catch(function(r){if(i.isDestroyed())return;i.unload(),i._state=kt.FAILED;let s="Failed to load texture";return Promise.reject(i.getError(s,r))}),this._promise};function k8(){this.gltf=void 0,this.textureInfo=void 0,this.image=void 0,this.context=void 0,this.texture=void 0}k8.prototype.set=function(t,n,i,o,r){this.gltf=t,this.textureInfo=n,this.image=i,this.mipLevels=o,this.context=r};k8.prototype.execute=function(){this.texture=wZ(this.gltf,this.textureInfo,this.image,this.mipLevels,this.context)};function wZ(t,n,i,o,r){let s=i.internalFormat,a=!1;st.isCompressedFormat(s)&&!f(o)&&(a=!0);let c=El.createSampler({gltf:t,textureInfo:n,compressedTextureNoMipmap:a}),l=c.minificationFilter,u=c.wrapS,d=c.wrapT,h=l===fn.NEAREST_MIPMAP_NEAREST||l===fn.NEAREST_MIPMAP_LINEAR||l===fn.LINEAR_MIPMAP_NEAREST||l===fn.LINEAR_MIPMAP_LINEAR,_=!f(s)&&h,y=_||u===Mn.REPEAT||u===Mn.MIRRORED_REPEAT||d===Mn.REPEAT||d===Mn.MIRRORED_REPEAT,p=!B.isPowerOfTwo(i.width)||!B.isPowerOfTwo(i.height),C=y&&p,x;return f(s)?(!r.webgl2&&st.isCompressedFormat(s)&&p&&y&&console.warn("Compressed texture uses REPEAT or MIRRORED_REPEAT texture wrap mode and dimensions are not powers of two. The texture may be rendered incorrectly."),x=St.create({context:r,source:{arrayBufferView:i.bufferView,mipLevels:o},width:i.width,height:i.height,pixelFormat:i.internalFormat,sampler:c})):(C&&(i=B0(i)),x=St.create({context:r,source:i,sampler:c,flipY:!1,skipColorSpaceConversion:!0})),_&&x.generateMipmap(),x}e_.prototype.process=function(t){return this._process(this,t)};e_.prototype.unload=function(){f(this._texture)&&this._texture.destroy(),f(this._imageLoader)&&this._resourceCache.unload(this._imageLoader),this._imageLoader=void 0,this._image=void 0,this._mipLevels=void 0,this._texture=void 0,this._gltf=void 0};var $b=e_;function t_(t){t=A(t,A.EMPTY_OBJECT);let n=t.resourceCache,i=t.gltf,o=t.gltfResource,r=t.baseResource,s=t.bufferViewId,a=t.draco,c=t.attributeSemantic,l=t.accessorId,u=t.cacheKey,d=A(t.asynchronous,!0),h=A(t.loadBuffer,!1),_=A(t.loadTypedArray,!1);this._resourceCache=n,this._gltfResource=o,this._baseResource=r,this._gltf=i,this._bufferViewId=s,this._draco=a,this._attributeSemantic=c,this._accessorId=l,this._cacheKey=u,this._asynchronous=d,this._loadBuffer=h,this._loadTypedArray=_,this._bufferViewLoader=void 0,this._dracoLoader=void 0,this._quantization=void 0,this._typedArray=void 0,this._buffer=void 0,this._state=kt.UNLOADED,this._promise=void 0,this._process=function(y,p){}}f(Object.create)&&(t_.prototype=Object.create(eo.prototype),t_.prototype.constructor=t_);Object.defineProperties(t_.prototype,{promise:{get:function(){return this._promise}},cacheKey:{get:function(){return this._cacheKey}},buffer:{get:function(){return this._buffer}},typedArray:{get:function(){return this._typedArray}},quantization:{get:function(){return this._quantization}}});t_.prototype.load=function(){let t;f(this._draco)?t=gve(this):t=yve(this);let n=this,i=new U8,o=new Promise(function(r){n._process=function(s,a){if(s._state===kt.READY)return;let c=s._typedArray;if(f(s._dracoLoader)&&s._dracoLoader.process(a),f(s._bufferViewLoader)&&s._bufferViewLoader.process(a),!f(c))return;let l;if(s._loadBuffer&&s._asynchronous){let u=i;if(u.set(c,a.context),!a.jobScheduler.execute(u,Sa.BUFFER))return;l=u.buffer}else s._loadBuffer&&(l=DZ(c,a.context));s.unload(),s._buffer=l,s._typedArray=s._loadTypedArray?c:void 0,s._state=kt.READY,r(s)}});return this._promise=t.then(function(){if(!n.isDestroyed())return o}).catch(function(r){if(!n.isDestroyed())return Ave(n,r)}),this._promise};function _ve(t,n,i,o){let s=(1<<t.quantizationBits)-1,a=1/s,c=new It.Quantization;if(c.componentDatatype=n,c.octEncoded=t.octEncoded,c.octEncodedZXY=!0,c.type=o,c.octEncoded)c.type=nn.VEC2,c.normalizationRange=s;else{let l=nn.getMathType(o);if(l===Number){let u=t.range;c.quantizedVolumeOffset=t.minValues[0],c.quantizedVolumeDimensions=u,c.normalizationRange=s,c.quantizedVolumeStepSize=u*a}else{c.quantizedVolumeOffset=l.unpack(t.minValues),c.normalizationRange=l.unpack(new Array(i).fill(s));let u=new Array(i).fill(t.range);c.quantizedVolumeDimensions=l.unpack(u);let d=u.map(function(h){return h*a});c.quantizedVolumeStepSize=l.unpack(d)}}return c}function gve(t){let i=t._resourceCache.loadDraco({gltf:t._gltf,draco:t._draco,gltfResource:t._gltfResource,baseResource:t._baseResource});return t._dracoLoader=i,t._state=kt.LOADING,i.promise.then(function(){if(t.isDestroyed())return;let o=i.decodedData.vertexAttributes,r=t._attributeSemantic,s=o[r],a=t._accessorId,l=t._gltf.accessors[a].type,u=s.array,d=s.data.quantization;return f(d)&&(t._quantization=_ve(d,s.data.componentDatatype,s.data.componentsPerAttribute,l)),t._typedArray=new Uint8Array(u.buffer,u.byteOffset,u.byteLength),t._state=kt.PROCESSING,t})}function yve(t){let i=t._resourceCache.loadBufferView({gltf:t._gltf,bufferViewId:t._bufferViewId,gltfResource:t._gltfResource,baseResource:t._baseResource});return t._state=kt.LOADING,t._bufferViewLoader=i,i.promise.then(function(){if(!t.isDestroyed())return t._typedArray=i.typedArray,t._state=kt.PROCESSING,t})}function Ave(t,n){t.unload(),t._state=kt.FAILED;let i="Failed to load vertex buffer";return n=t.getError(i,n),Promise.reject(n)}function U8(){this.typedArray=void 0,this.context=void 0,this.buffer=void 0}U8.prototype.set=function(t,n){this.typedArray=t,this.context=n};U8.prototype.execute=function(){this.buffer=DZ(this.typedArray,this.context)};function DZ(t,n){let i=ut.createVertexBuffer({typedArray:t,context:n,usage:Fe.STATIC_DRAW});return i.vertexArrayDestroyable=!1,i}t_.prototype.process=function(t){return this._process(this,t)};t_.prototype.unload=function(){f(this._buffer)&&this._buffer.destroy();let t=this._resourceCache;f(this._bufferViewLoader)&&t.unload(this._bufferViewLoader),f(this._dracoLoader)&&t.unload(this._dracoLoader),this._bufferViewLoader=void 0,this._dracoLoader=void 0,this._typedArray=void 0,this._buffer=void 0,this._gltf=void 0};var eS=t_;function z8(t){t=A(t,A.EMPTY_OBJECT);let n=t.id,i=t.class,o={},r={};for(let s in i.properties)if(i.properties.hasOwnProperty(s)){let a=new v0({id:s,property:i.properties[s],enums:t.enums});o[s]=a,f(a.semantic)&&(r[a.semantic]=a)}this._properties=o,this._propertiesBySemantic=r,this._id=n,this._name=i.name,this._description=i.description,this._extras=i.extras,this._extensions=i.extensions}Object.defineProperties(z8.prototype,{properties:{get:function(){return this._properties}},propertiesBySemantic:{get:function(){return this._propertiesBySemantic}},id:{get:function(){return this._id}},name:{get:function(){return this._name}},description:{get:function(){return this._description}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}});z8.BATCH_TABLE_CLASS_NAME="_batchTable";var Yd=z8;function vZ(t){this._value=t.value,this._name=t.name,this._description=t.description,this._extras=t.extras,this._extensions=t.extensions}Object.defineProperties(vZ.prototype,{value:{get:function(){return this._value}},name:{get:function(){return this._name}},description:{get:function(){return this._description}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}});var QO=vZ;function PZ(t){t=A(t,A.EMPTY_OBJECT);let n=t.id,i=t.enum,o={},r={},s=i.values.map(function(c){return o[c.value]=c.name,r[c.name]=c.value,new QO(c)}),a=A(In[i.valueType],In.UINT16);this._values=s,this._namesByValue=o,this._valuesByName=r,this._valueType=a,this._id=n,this._name=i.name,this._description=i.description,this._extras=i.extras,this._extensions=i.extensions}Object.defineProperties(PZ.prototype,{values:{get:function(){return this._values}},namesByValue:{get:function(){return this._namesByValue}},valuesByName:{get:function(){return this._valuesByName}},valueType:{get:function(){return this._valueType}},id:{get:function(){return this._id}},name:{get:function(){return this._name}},description:{get:function(){return this._description}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}});var $O=PZ;function IZ(t){let n={};if(f(t.enums))for(let o in t.enums)t.enums.hasOwnProperty(o)&&(n[o]=new $O({id:o,enum:t.enums[o]}));let i={};if(f(t.classes))for(let o in t.classes)t.classes.hasOwnProperty(o)&&(i[o]=new Yd({id:o,class:t.classes[o],enums:n}));this._classes=i,this._enums=n,this._id=t.id,this._name=t.name,this._description=t.description,this._version=t.version,this._extras=t.extras,this._extensions=t.extensions}Object.defineProperties(IZ.prototype,{classes:{get:function(){return this._classes}},enums:{get:function(){return this._enums}},id:{get:function(){return this._id}},name:{get:function(){return this._name}},description:{get:function(){return this._description}},version:{get:function(){return this._version}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}});var Xd=IZ;function O0(t){t=A(t,A.EMPTY_OBJECT);let n=t.schema,i=t.resource,o=t.cacheKey;this._schema=f(n)?new Xd(n):void 0,this._resource=i,this._cacheKey=o,this._state=kt.UNLOADED,this._promise=void 0}f(Object.create)&&(O0.prototype=Object.create(eo.prototype),O0.prototype.constructor=O0);Object.defineProperties(O0.prototype,{promise:{get:function(){return this._promise}},cacheKey:{get:function(){return this._cacheKey}},schema:{get:function(){return this._schema}}});O0.prototype.load=function(){return f(this._schema)?this._promise=Promise.resolve(this):this._promise=Cve(this),this._promise};function Cve(t){let n=t._resource;return t._state=kt.LOADING,n.fetchJson().then(function(i){if(!t.isDestroyed())return t._schema=new Xd(i),t._state=kt.READY,t}).catch(function(i){if(t.isDestroyed())return;t._state=kt.FAILED;let o=`Failed to load schema: ${n.url}`;return Promise.reject(t.getError(o,i))})}O0.prototype.unload=function(){this._schema=void 0};var tS=O0;var vf={};function nS(t){return Lp(t.url)}function eR(t){let n=t.byteOffset,i=t.byteLength;if(Li(t,"EXT_meshopt_compression")){let o=t.extensions.EXT_meshopt_compression;n=A(o.byteOffset,0),i=o.byteLength}return`${n}-${n+i}`}function xve(t,n){let i=n.byteOffset+t.byteOffset,o=t.componentType,r=t.type,s=t.count;return`${i}-${o}-${r}-${s}`}function BZ(t){return nS(t)}function OZ(t,n){return`${nS(t)}-buffer-id-${n}`}function iS(t,n,i,o){if(f(t.uri)){let r=o.getDerivedResource({url:t.uri});return BZ(r)}return OZ(i,n)}function H8(t,n,i,o){let r=n.bufferView,s=t.bufferViews[r],a=s.buffer,c=t.buffers[a],l=iS(c,a,i,o),u=eR(s);return`${l}-range-${u}`}function RZ(t,n,i,o){let r=t.images[n],s=r.bufferView,a=r.uri;if(f(a)){let _=o.getDerivedResource({url:a});return nS(_)}let c=t.bufferViews[s],l=c.buffer,u=t.buffers[l],d=iS(u,l,i,o),h=eR(c);return`${d}-range-${h}`}function Tve(t,n){let i=El.createSampler({gltf:t,textureInfo:n});return`${i.wrapS}-${i.wrapT}-${i.minificationFilter}-${i.magnificationFilter}`}vf.getSchemaCacheKey=function(t){let n=t.schema,i=t.resource;return f(n)?`embedded-schema:${JSON.stringify(n)}`:`external-schema:${nS(i)}`};vf.getExternalBufferCacheKey=function(t){t=A(t,A.EMPTY_OBJECT);let n=t.resource;return`external-buffer:${BZ(n)}`};vf.getEmbeddedBufferCacheKey=function(t){t=A(t,A.EMPTY_OBJECT);let n=t.parentResource,i=t.bufferId;return`embedded-buffer:${OZ(n,i)}`};vf.getGltfCacheKey=function(t){t=A(t,A.EMPTY_OBJECT);let n=t.gltfResource;return`gltf:${nS(n)}`};vf.getBufferViewCacheKey=function(t){t=A(t,A.EMPTY_OBJECT);let n=t.gltf,i=t.bufferViewId,o=t.gltfResource,r=t.baseResource,s=n.bufferViews[i],a=s.buffer,c=n.buffers[a];Li(s,"EXT_meshopt_compression")&&(a=s.extensions.EXT_meshopt_compression.buffer);let l=iS(c,a,o,r),u=eR(s);return`buffer-view:${l}-range-${u}`};vf.getDracoCacheKey=function(t){t=A(t,A.EMPTY_OBJECT);let n=t.gltf,i=t.draco,o=t.gltfResource,r=t.baseResource;return`draco:${H8(n,i,o,r)}`};vf.getVertexBufferCacheKey=function(t){t=A(t,A.EMPTY_OBJECT);let n=t.gltf,i=t.gltfResource,o=t.baseResource,r=t.frameState,s=t.bufferViewId,a=t.draco,c=t.attributeSemantic,l=A(t.dequantize,!1),u=A(t.loadBuffer,!1),d=A(t.loadTypedArray,!1),h="";if(l&&(h+="-dequantize"),u&&(h+="-buffer",h+=`-context-${r.context.id}`),d&&(h+="-typed-array"),f(a))return`vertex-buffer:${H8(n,a,i,o)}-draco-${c}${h}`;let _=n.bufferViews[s],y=_.buffer,p=n.buffers[y],C=iS(p,y,i,o),x=eR(_);return`vertex-buffer:${C}-range-${x}${h}`};vf.getIndexBufferCacheKey=function(t){t=A(t,A.EMPTY_OBJECT);let n=t.gltf,i=t.accessorId,o=t.gltfResource,r=t.baseResource,s=t.frameState,a=t.draco,c=A(t.loadBuffer,!1),l=A(t.loadTypedArray,!1),u="";if(c&&(u+="-buffer",u+=`-context-${s.context.id}`),l&&(u+="-typed-array"),f(a))return`index-buffer:${H8(n,a,o,r)}-draco${u}`;let d=n.accessors[i],h=d.bufferView,_=n.bufferViews[h],y=_.buffer,p=n.buffers[y],C=iS(p,y,o,r),x=xve(d,_);return`index-buffer:${C}-accessor-${x}${u}`};vf.getImageCacheKey=function(t){t=A(t,A.EMPTY_OBJECT);let n=t.gltf,i=t.imageId,o=t.gltfResource,r=t.baseResource;return`image:${RZ(n,i,o,r)}`};vf.getTextureCacheKey=function(t){t=A(t,A.EMPTY_OBJECT);let n=t.gltf,i=t.textureInfo,o=t.gltfResource,r=t.baseResource,s=t.supportedImageFormats,a=t.frameState,c=i.index,l=El.getImageIdFromTexture({gltf:n,textureId:c,supportedImageFormats:s}),u=RZ(n,l,o,r),d=Tve(n,i);return`texture:${u}-sampler-${d}-context-${a.context.id}`};var Sl=vf;function oS(){this.geometryByteLength=0,this.texturesByteLength=0,this._geometrySizes={},this._textureSizes={}}oS.prototype.clear=function(){this.geometryByteLength=0,this.texturesByteLength=0,this._geometrySizes={},this._textureSizes={}};oS.prototype.addGeometryLoader=function(t){let n=t.cacheKey;if(this._geometrySizes.hasOwnProperty(n))return;this._geometrySizes[n]=0;let i=this;return t.promise.then(function(o){if(!i._geometrySizes.hasOwnProperty(n))return;let r=o.buffer,s=o.typedArray,a=0;f(r)&&(a+=r.sizeInBytes),f(s)&&(a+=s.byteLength),i.geometryByteLength+=a,i._geometrySizes[n]=a}).catch(function(){delete i._geometrySizes[n]})};oS.prototype.addTextureLoader=function(t){let n=t.cacheKey;if(this._textureSizes.hasOwnProperty(n))return;this._textureSizes[n]=0;let i=this;return t.promise.then(function(o){if(!i._textureSizes.hasOwnProperty(n))return;let r=o.texture.sizeInBytes;i.texturesByteLength+=o.texture.sizeInBytes,i._textureSizes[n]=r}).catch(function(){delete i._textureSizes[n]})};oS.prototype.removeLoader=function(t){let n=t.cacheKey,i=this._geometrySizes[n];delete this._geometrySizes[n],f(i)&&(this.geometryByteLength-=i);let o=this._textureSizes[n];delete this._textureSizes[n],f(o)&&(this.texturesByteLength-=o)};var tR=oS;function _n(){}_n.cacheEntries={};_n.statistics=new tR;function Eve(t){this.referenceCount=1,this.resourceLoader=t,this._statisticsPromise=void 0}_n.get=function(t){let n=_n.cacheEntries[t];if(f(n))return++n.referenceCount,n.resourceLoader};_n.load=function(t){t=A(t,A.EMPTY_OBJECT);let n=t.resourceLoader,i=n.cacheKey;_n.cacheEntries[i]=new Eve(n),n.load()};_n.unload=function(t){let n=t.cacheKey,i=_n.cacheEntries[n];--i.referenceCount,i.referenceCount===0&&(_n.statistics.removeLoader(t),t.destroy(),delete _n.cacheEntries[n])};_n.loadSchema=function(t){t=A(t,A.EMPTY_OBJECT);let n=t.schema,i=t.resource,o=Sl.getSchemaCacheKey({schema:n,resource:i}),r=_n.get(o);return f(r)||(r=new tS({schema:n,resource:i,cacheKey:o}),_n.load({resourceLoader:r})),r};_n.loadEmbeddedBuffer=function(t){t=A(t,A.EMPTY_OBJECT);let n=t.parentResource,i=t.bufferId,o=t.typedArray,r=Sl.getEmbeddedBufferCacheKey({parentResource:n,bufferId:i}),s=_n.get(r);return f(s)||(s=new RC({typedArray:o,cacheKey:r}),_n.load({resourceLoader:s})),s};_n.loadExternalBuffer=function(t){t=A(t,A.EMPTY_OBJECT);let n=t.resource,i=Sl.getExternalBufferCacheKey({resource:n}),o=_n.get(i);return f(o)||(o=new RC({resource:n,cacheKey:i}),_n.load({resourceLoader:o})),o};_n.loadGltfJson=function(t){t=A(t,A.EMPTY_OBJECT);let n=t.gltfResource,i=t.baseResource,o=t.typedArray,r=t.gltfJson,s=Sl.getGltfCacheKey({gltfResource:n}),a=_n.get(s);return f(a)||(a=new Qb({resourceCache:_n,gltfResource:n,baseResource:i,typedArray:o,gltfJson:r,cacheKey:s}),_n.load({resourceLoader:a})),a};_n.loadBufferView=function(t){t=A(t,A.EMPTY_OBJECT);let n=t.gltf,i=t.bufferViewId,o=t.gltfResource,r=t.baseResource,s=Sl.getBufferViewCacheKey({gltf:n,bufferViewId:i,gltfResource:o,baseResource:r}),a=_n.get(s);return f(a)||(a=new Yb({resourceCache:_n,gltf:n,bufferViewId:i,gltfResource:o,baseResource:r,cacheKey:s}),_n.load({resourceLoader:a})),a};_n.loadDraco=function(t){t=A(t,A.EMPTY_OBJECT);let n=t.gltf,i=t.draco,o=t.gltfResource,r=t.baseResource,s=Sl.getDracoCacheKey({gltf:n,draco:i,gltfResource:o,baseResource:r}),a=_n.get(s);return f(a)||(a=new Xb({resourceCache:_n,gltf:n,draco:i,gltfResource:o,baseResource:r,cacheKey:s}),_n.load({resourceLoader:a})),a};_n.loadVertexBuffer=function(t){t=A(t,A.EMPTY_OBJECT);let n=t.gltf,i=t.gltfResource,o=t.baseResource,r=t.frameState,s=t.bufferViewId,a=t.draco,c=t.attributeSemantic,l=t.accessorId,u=A(t.asynchronous,!0),d=A(t.dequantize,!1),h=A(t.loadBuffer,!1),_=A(t.loadTypedArray,!1),y=Sl.getVertexBufferCacheKey({gltf:n,gltfResource:i,baseResource:o,frameState:r,bufferViewId:s,draco:a,attributeSemantic:c,dequantize:d,loadBuffer:h,loadTypedArray:_}),p=_n.get(y);if(f(p))return p;p=new eS({resourceCache:_n,gltf:n,gltfResource:i,baseResource:o,bufferViewId:s,draco:a,attributeSemantic:c,accessorId:l,cacheKey:y,asynchronous:u,dequantize:d,loadBuffer:h,loadTypedArray:_}),_n.load({resourceLoader:p});let C=_n.statistics.addGeometryLoader(p);return _n.cacheEntries[y]._statisticsPromise=C,p};_n.loadIndexBuffer=function(t){t=A(t,A.EMPTY_OBJECT);let n=t.gltf,i=t.accessorId,o=t.gltfResource,r=t.baseResource,s=t.frameState,a=t.draco,c=A(t.asynchronous,!0),l=A(t.loadBuffer,!1),u=A(t.loadTypedArray,!1),d=Sl.getIndexBufferCacheKey({gltf:n,accessorId:i,gltfResource:o,baseResource:r,frameState:s,draco:a,loadBuffer:l,loadTypedArray:u}),h=_n.get(d);if(f(h))return h;h=new Jb({resourceCache:_n,gltf:n,accessorId:i,gltfResource:o,baseResource:r,draco:a,cacheKey:d,asynchronous:c,loadBuffer:l,loadTypedArray:u}),_n.load({resourceLoader:h});let _=_n.statistics.addGeometryLoader(h);return _n.cacheEntries[d]._statisticsPromise=_,h};_n.loadImage=function(t){t=A(t,A.EMPTY_OBJECT);let n=t.gltf,i=t.imageId,o=t.gltfResource,r=t.baseResource,s=Sl.getImageCacheKey({gltf:n,imageId:i,gltfResource:o,baseResource:r}),a=_n.get(s);return f(a)||(a=new Kb({resourceCache:_n,gltf:n,imageId:i,gltfResource:o,baseResource:r,cacheKey:s}),_n.load({resourceLoader:a})),a};_n.loadTexture=function(t){t=A(t,A.EMPTY_OBJECT);let n=t.gltf,i=t.textureInfo,o=t.gltfResource,r=t.baseResource,s=t.supportedImageFormats,a=t.frameState,c=A(t.asynchronous,!0),l=Sl.getTextureCacheKey({gltf:n,textureInfo:i,gltfResource:o,baseResource:r,supportedImageFormats:s,frameState:a}),u=_n.get(l);if(f(u))return u;u=new $b({resourceCache:_n,gltf:n,textureInfo:i,gltfResource:o,baseResource:r,supportedImageFormats:s,cacheKey:l,asynchronous:c}),_n.load({resourceLoader:u});let d=_n.statistics.addTextureLoader(u);return _n.cacheEntries[l]._statisticsPromise=d,u};_n.clearForSpecs=function(){let t=[eS,Jb,Xb,$b,Kb,Yb,RC,tS,Qb],n,i=_n.cacheEntries,o=[];for(n in i)i.hasOwnProperty(n)&&o.push(i[n]);o.sort(function(s,a){let c=t.indexOf(s.resourceLoader.constructor),l=t.indexOf(a.resourceLoader.constructor);return c-l});let r=o.length;for(let s=0;s<r;++s){let a=o[s];n=a.resourceLoader.cacheKey,f(i[n])&&(a.resourceLoader.destroy(),delete i[n])}_n.statistics.clear()};var fo=_n;function n_(t){t=A(t,A.EMPTY_OBJECT);let n=t.gltf,i=t.extension,o=t.extensionLegacy,r=t.gltfResource,s=t.baseResource,a=t.supportedImageFormats,c=t.frameState,l=t.cacheKey,u=A(t.asynchronous,!0);this._gltfResource=r,this._baseResource=s,this._gltf=n,this._extension=i,this._extensionLegacy=o,this._supportedImageFormats=a,this._frameState=c,this._cacheKey=l,this._asynchronous=u,this._bufferViewLoaders=[],this._textureLoaders=[],this._schemaLoader=void 0,this._structuralMetadata=void 0,this._state=kt.UNLOADED,this._promise=void 0}f(Object.create)&&(n_.prototype=Object.create(eo.prototype),n_.prototype.constructor=n_);Object.defineProperties(n_.prototype,{promise:{get:function(){return this._promise}},cacheKey:{get:function(){return this._cacheKey}},structuralMetadata:{get:function(){return this._structuralMetadata}}});n_.prototype.load=function(){let t=vve(this),n=Rve(this),i=Mve(this);this._gltf=void 0,this._state=kt.LOADING;let o=this;this._promise=Promise.all([t,n,i]).then(function(r){if(o.isDestroyed())return;let s=r[0],a=r[1],c=r[2];return f(o._extension)?o._structuralMetadata=OO({extension:o._extension,schema:c,bufferViews:s,textures:a}):o._structuralMetadata=RO({extension:o._extensionLegacy,schema:c,bufferViews:s,textures:a}),o._state=kt.READY,o}).catch(function(r){if(o.isDestroyed())return;o.unload(),o._state=kt.FAILED;let s="Failed to load structural metadata";return Promise.reject(o.getError(s,r))})};function bve(t,n){for(let i in t)if(t.hasOwnProperty(i)){let o=t[i],r=o.values,s=o.arrayOffsets,a=o.stringOffsets;f(r)&&(n[r]=!0),f(s)&&(n[s]=!0),f(a)&&(n[a]=!0)}}function Sve(t,n){for(let i in t)if(t.hasOwnProperty(i)){let o=t[i],r=o.bufferView,s=o.arrayOffsetBufferView,a=o.stringOffsetBufferView;f(r)&&(n[r]=!0),f(s)&&(n[s]=!0),f(a)&&(n[a]=!0)}}function wve(t){let n=t.propertyTables,i={};if(f(n))for(let o=0;o<n.length;o++){let r=n[o];bve(r.properties,i)}return i}function Dve(t){let n=t.featureTables,i={};if(f(n)){for(let o in n)if(n.hasOwnProperty(o)){let s=n[o].properties;f(s)&&Sve(s,i)}}return i}function vve(t){let n;f(t._extension)?n=wve(t._extension):n=Dve(t._extensionLegacy);let i=[],o={};for(let r in n)if(n.hasOwnProperty(r)){let s=fo.loadBufferView({gltf:t._gltf,bufferViewId:parseInt(r),gltfResource:t._gltfResource,baseResource:t._baseResource});i.push(s.promise),t._bufferViewLoaders.push(s),o[r]=s}return Promise.all(i).then(function(){let r={};for(let s in o)if(o.hasOwnProperty(s)){let a=o[s],c=new Uint8Array(a.typedArray);r[s]=c}return MZ(t),r})}function Pve(t){let n={},i=t.propertyTextures;if(f(i))for(let o=0;o<i.length;o++){let s=i[o].properties;f(s)&&Ive(s,n)}return n}function Ive(t,n){for(let i in t)if(t.hasOwnProperty(i)){let o=t[i];n[o.index]=o}}function Bve(t){let n={},i=t.featureTextures;if(f(i)){for(let o in i)if(i.hasOwnProperty(o)){let s=i[o].properties;f(s)&&Ove(s,n)}}return n}function Ove(t,n){for(let i in t)if(t.hasOwnProperty(i)){let r=t[i].texture;n[r.index]=r}}function Rve(t){let n;f(t._extension)?n=Pve(t._extension):n=Bve(t._extensionLegacy);let i=t._gltf,o=t._gltfResource,r=t._baseResource,s=t._supportedImageFormats,a=t._frameState,c=t._asynchronous,l=[],u={};for(let d in n)if(n.hasOwnProperty(d)){let h=fo.loadTexture({gltf:i,textureInfo:n[d],gltfResource:o,baseResource:r,supportedImageFormats:s,frameState:a,asynchronous:c});l.push(h.promise),t._textureLoaders.push(h),u[d]=h}return Promise.all(l).then(function(){let d={};for(let h in u)if(u.hasOwnProperty(h)){let _=u[h];d[h]=_.texture}return d})}function Mve(t){let n=A(t._extension,t._extensionLegacy),i;if(f(n.schemaUri)){let o=t._baseResource.getDerivedResource({url:n.schemaUri});i=fo.loadSchema({resource:o})}else i=fo.loadSchema({schema:n.schema});return t._schemaLoader=i,i.promise.then(function(o){return o.schema})}n_.prototype.process=function(t){if(this._state!==kt.LOADING)return;let n=this._textureLoaders,i=n.length;for(let o=0;o<i;++o)n[o].process(t)};function MZ(t){let n=t._bufferViewLoaders,i=n.length;for(let o=0;o<i;++o)fo.unload(n[o]);t._bufferViewLoaders.length=0}function Lve(t){let n=t._textureLoaders,i=n.length;for(let o=0;o<i;++o)fo.unload(n[o]);t._textureLoaders.length=0}n_.prototype.unload=function(){MZ(this),Lve(this),f(this._schemaLoader)&&fo.unload(this._schemaLoader),this._schemaLoader=void 0,this._structuralMetadata=void 0};var nR=n_;var ym={X:0,Y:1,Z:2};ym.Y_UP_TO_Z_UP=N.fromRotationTranslation($.fromRotationX(B.PI_OVER_TWO));ym.Z_UP_TO_Y_UP=N.fromRotationTranslation($.fromRotationX(-B.PI_OVER_TWO));ym.X_UP_TO_Z_UP=N.fromRotationTranslation($.fromRotationY(-B.PI_OVER_TWO));ym.Z_UP_TO_X_UP=N.fromRotationTranslation($.fromRotationY(B.PI_OVER_TWO));ym.X_UP_TO_Y_UP=N.fromRotationTranslation($.fromRotationZ(B.PI_OVER_TWO));ym.Y_UP_TO_X_UP=N.fromRotationTranslation($.fromRotationZ(-B.PI_OVER_TWO));ym.fromName=function(t){return ym[t]};var vo=Object.freeze(ym);var Zn={POSITION:"POSITION",NORMAL:"NORMAL",TANGENT:"TANGENT",TEXCOORD:"TEXCOORD",COLOR:"COLOR",JOINTS:"JOINTS",WEIGHTS:"WEIGHTS",FEATURE_ID:"_FEATURE_ID"};function Fve(t){switch(t){case Zn.POSITION:return"positionMC";case Zn.NORMAL:return"normalMC";case Zn.TANGENT:return"tangentMC";case Zn.TEXCOORD:return"texCoord";case Zn.COLOR:return"color";case Zn.JOINTS:return"joints";case Zn.WEIGHTS:return"weights";case Zn.FEATURE_ID:return"featureId"}}Zn.hasSetIndex=function(t){switch(t){case Zn.POSITION:case Zn.NORMAL:case Zn.TANGENT:return!1;case Zn.TEXCOORD:case Zn.COLOR:case Zn.JOINTS:case Zn.WEIGHTS:case Zn.FEATURE_ID:return!0}};Zn.fromGltfSemantic=function(t){let n=t,o=/^(\w+)_\d+$/.exec(t);switch(o!==null&&(n=o[1]),n){case"POSITION":return Zn.POSITION;case"NORMAL":return Zn.NORMAL;case"TANGENT":return Zn.TANGENT;case"TEXCOORD":return Zn.TEXCOORD;case"COLOR":return Zn.COLOR;case"JOINTS":return Zn.JOINTS;case"WEIGHTS":return Zn.WEIGHTS;case"_FEATURE_ID":return Zn.FEATURE_ID}};Zn.fromPntsSemantic=function(t){switch(t){case"POSITION":case"POSITION_QUANTIZED":return Zn.POSITION;case"RGBA":case"RGB":case"RGB565":return Zn.COLOR;case"NORMAL":case"NORMAL_OCT16P":return Zn.NORMAL;case"BATCH_ID":return Zn.FEATURE_ID}};Zn.getGlslType=function(t){switch(t){case Zn.POSITION:case Zn.NORMAL:case Zn.TANGENT:return"vec3";case Zn.TEXCOORD:return"vec2";case Zn.COLOR:return"vec4";case Zn.JOINTS:return"ivec4";case Zn.WEIGHTS:return"vec4";case Zn.FEATURE_ID:return"int"}};Zn.getVariableName=function(t,n){let i=Fve(t);return f(n)&&(i+=`_${n}`),i};var Tt=Object.freeze(Zn);function wa(){}wa.getFailedLoadFunction=function(t,n,i){return function(o){let r=`Failed to load ${n}: ${i}`;f(o)&&(r+=`
${o.message}`);let s=new he(r);return f(o)&&(s.stack=`Original stack:
${o.stack}
Handler stack:
${s.stack}`),Promise.reject(s)}};wa.getNodeTransform=function(t){return f(t.matrix)?t.matrix:N.fromTranslationQuaternionRotationScale(f(t.translation)?t.translation:m.ZERO,f(t.rotation)?t.rotation:Me.IDENTITY,f(t.scale)?t.scale:m.ONE)};wa.getAttributeBySemantic=function(t,n,i){let o=t.attributes,r=o.length;for(let s=0;s<r;++s){let a=o[s],c=f(i)?a.setIndex===i:!0;if(a.semantic===n&&c)return a}};wa.getAttributeByName=function(t,n){let i=t.attributes,o=i.length;for(let r=0;r<o;++r){let s=i[r];if(s.name===n)return s}};wa.getFeatureIdsByLabel=function(t,n){for(let i=0;i<t.length;i++){let o=t[i];if(o.positionalLabel===n||o.label===n)return o}};wa.hasQuantizedAttributes=function(t){if(!f(t))return!1;for(let n=0;n<t.length;n++){let i=t[n];if(f(i.quantization))return!0}return!1};wa.getAttributeInfo=function(t){let n=t.semantic,i=t.setIndex,o,r=!1;f(n)?(o=Tt.getVariableName(n,i),r=!0):(o=t.name,o=o.replace(/^_/,""),o=o.toLowerCase());let s=/^color_\d+$/.test(o),a=t.type,c=nn.getGlslType(a);s&&(c="vec4");let l=f(t.quantization),u;return l&&(u=s?"vec4":nn.getGlslType(t.quantization.type)),{attribute:t,isQuantized:l,variableName:o,hasSemantic:r,glslType:c,quantizedGlslType:u}};var Nve=new m,Vve=new m;wa.getPositionMinMax=function(t,n,i){let o=wa.getAttributeBySemantic(t,"POSITION"),r=o.max,s=o.min;return f(i)&&f(n)&&(s=m.add(s,n,Vve),r=m.add(r,i,Nve)),{min:s,max:r}};wa.getAxisCorrectionMatrix=function(t,n,i){return i=N.clone(N.IDENTITY,i),t===vo.Y?i=N.clone(vo.Y_UP_TO_Z_UP,i):t===vo.X&&(i=N.clone(vo.X_UP_TO_Z_UP,i)),n===vo.Z&&(i=N.multiplyTransformation(i,vo.Z_UP_TO_X_UP,i)),i};var kve=new $;wa.getCullFace=function(t,n){if(!Re.isTriangles(n))return xi.BACK;let i=N.getMatrix3(t,kve);return $.determinant(i)<0?xi.FRONT:xi.BACK};wa.sanitizeGlslIdentifier=function(t){let n=t.replaceAll(/[^A-Za-z0-9]+/g,"_");return n=n.replace(/^gl_/,""),/^\d/.test(n)&&(n=`_${n}`),n};wa.supportedExtensions={AGI_articulations:!0,CESIUM_primitive_outline:!0,CESIUM_RTC:!0,EXT_feature_metadata:!0,EXT_instance_features:!0,EXT_mesh_features:!0,EXT_mesh_gpu_instancing:!0,EXT_meshopt_compression:!0,EXT_structural_metadata:!0,EXT_texture_webp:!0,KHR_blend:!0,KHR_draco_mesh_compression:!0,KHR_techniques_webgl:!0,KHR_materials_common:!0,KHR_materials_pbrSpecularGlossiness:!0,KHR_materials_unlit:!0,KHR_mesh_quantization:!0,KHR_texture_basisu:!0,KHR_texture_transform:!0,WEB3D_quantized_attributes:!0};wa.checkSupportedExtensions=function(t){let n=t.length;for(let i=0;i<n;i++){let o=t[i];if(!wa.supportedExtensions[o])throw new he(`Unsupported glTF Extension: ${o}`)}};var on=wa;var VC={TRANSLATION:"TRANSLATION",ROTATION:"ROTATION",SCALE:"SCALE",FEATURE_ID:"_FEATURE_ID"};VC.fromGltfSemantic=function(t){let n=t,o=/^(\w+)_\d+$/.exec(t);switch(o!==null&&(n=o[1]),n){case"TRANSLATION":return VC.TRANSLATION;case"ROTATION":return VC.ROTATION;case"SCALE":return VC.SCALE;case"_FEATURE_ID":return VC.FEATURE_ID}};var Gr=Object.freeze(VC);var Uve=65534,zve=255;function iR(t){t=A(t,A.EMPTY_OBJECT);let n=t.triangleIndices,i=t.outlineIndices,o=t.originalVertexCount;this._triangleIndices=n,this._originalVertexCount=o,this._edges=new NZ(i,o),this._outlineCoordinatesTypedArray=void 0,this._extraVertices=[],Hve(this)}Object.defineProperties(iR.prototype,{updatedTriangleIndices:{get:function(){return this._triangleIndices}},outlineCoordinates:{get:function(){return this._outlineCoordinatesTypedArray}}});function Hve(t){let n=t._triangleIndices,i=t._edges,o=[],r=t._extraVertices,s=t._originalVertexCount,a={};for(let c=0;c<n.length;c+=3){let l=n[c],u=n[c+1],d=n[c+2],h=!1,_=h||i.hasEdge(l,u),y=h||i.hasEdge(u,d),p=h||i.hasEdge(d,l),C=LZ(o,l,u,d,_,y,p);for(;f(C);){let x=a[C];if(!f(x)){x=s+r.length;let T=C;for(;T>=s;)T=r[T-s];r.push(T),a[C]=x}x>Uve&&(n instanceof Uint16Array||n instanceof Uint8Array)?n=new Uint32Array(n):x>zve&&n instanceof Uint8Array&&(n=new Uint16Array(n)),C===l?(l=x,n[c]=x):C===u?(u=x,n[c+1]=x):(d=x,n[c+2]=x),C=LZ(o,l,u,d,_,y,p)}}t._triangleIndices=n,t._outlineCoordinatesTypedArray=new Float32Array(o)}function LZ(t,n,i,o,r,s,a){let c=a?1:0,l=r?1:0,u=0,d=G8(t,n,c,l,u);if(d===0)return n;let h=0,_=r?1:0,y=s?1:0,p=G8(t,i,h,_,y);if(p===0)return i;let C=a?1:0,x=0,T=s?1:0,E=G8(t,o,C,x,T);if(E===0)return o;let S=d&p&E,w,D,I;if(S&1<<0)w=0,D=1,I=2;else if(S&1<<1)w=0,I=1,D=2;else if(S&1<<2)D=0,w=1,I=2;else if(S&1<<3)D=0,I=1,w=2;else if(S&1<<4)I=0,w=1,D=2;else if(S&1<<5)I=0,D=1,w=2;else{let F=W8(d),g=W8(p),b=W8(E);return F<g&&F<b?n:g<b?i:o}let O=n*3;t[O+w]=c,t[O+D]=l,t[O+I]=u;let M=i*3;t[M+w]=h,t[M+D]=_,t[M+I]=y;let L=o*3;t[L+w]=C,t[L+D]=x,t[L+I]=T}function G8(t,n,i,o,r){let s=n*3,a=t[s],c=t[s+1],l=t[s+2];return f(a)?(a===i&&c===o&&l===r)<<0|(a===i&&c===r&&l===o)<<1|(a===o&&c===i&&l===r)<<2|(a===o&&c===r&&l===i)<<3|(a===r&&c===i&&l===o)<<4|(a===r&&c===o&&l===i)<<5:63}function W8(t){return(t&1)+(t>>1&1)+(t>>2&1)+(t>>3&1)+(t>>4&1)+(t>>5&1)}iR.prototype.updateAttribute=function(t){let n=this._extraVertices,i=t.length,o=i/this._originalVertexCount,r=n.length,s=t.constructor,a=new s(t.length+r*o);a.set(t);for(let c=0;c<r;c++){let l=n[c]*o,u=i+c*o;for(let d=0;d<o;d++)a[u+d]=a[l+d]}return a};iR.createTexture=function(t){let n=t.cache.modelOutliningCache;if(f(n)||(n=t.cache.modelOutliningCache={}),f(n.outlineTexture))return n.outlineTexture;let i=Math.min(4096,Ut.maximumTextureSize),o=i,r=FZ(o),s=[];for(;o>1;)o>>=1,s.push(FZ(o));let a=new St({context:t,source:{arrayBufferView:r,mipLevels:s},width:i,height:1,pixelFormat:st.LUMINANCE,sampler:new pn({wrapS:Mn.CLAMP_TO_EDGE,wrapT:Mn.CLAMP_TO_EDGE,minificationFilter:fn.LINEAR_MIPMAP_LINEAR,magnificationFilter:Qi.LINEAR})});return n.outlineTexture=a,a};function FZ(t){let n=new Uint8Array(t);return n[t-1]=192,t===8?n[t-1]=96:t===4?n[t-1]=48:t===2?n[t-1]=24:t===1&&(n[t-1]=12),n}function NZ(t,n){this._originalVertexCount=n,this._edges=new Set;for(let i=0;i<t.length;i+=2){let o=t[i],r=t[i+1],s=Math.min(o,r),a=Math.max(o,r),c=s*this._originalVertexCount+a;this._edges.add(c)}}NZ.prototype.hasEdge=function(t,n){let i=Math.min(t,n),o=Math.max(t,n),r=i*this._originalVertexCount+o;return this._edges.has(r)};var kC=iR;function VZ(t){this.attribute=t,this.loadBuffer=!1,this.loadTypedArray=!1}function Gve(t){this.indices=t,this.loadBuffer=!1,this.loadTypedArray=!1}function oR(t){this.primitive=t,this.attributePlans=[],this.indicesPlan=void 0,this.needsOutlines=!1,this.outlineIndices=void 0}oR.prototype.postProcess=function(t){this.needsOutlines&&(Wve(this),qve(this,t))};function Wve(t){let n=t.primitive,i=n.indices,o=n.attributes[0].count,r=new kC({triangleIndices:i.typedArray,outlineIndices:t.outlineIndices,originalVertexCount:o});i.typedArray=r.updatedTriangleIndices,i.indexDatatype=Ne.fromTypedArray(i.typedArray);let s=jve(r.outlineCoordinates),a=new VZ(s);a.loadBuffer=!0,a.loadTypedArray=!1,t.attributePlans.push(a),n.outlineCoordinates=a.attribute;let c=t.attributePlans,l=t.attributePlans.length;for(let u=0;u<l;u++){let d=c[u].attribute;d.typedArray=r.updateAttribute(d.typedArray)}}function jve(t){let n=new It.Attribute;return n.name="_OUTLINE_COORDINATES",n.typedArray=t,n.componentDatatype=J.FLOAT,n.type=nn.VEC3,n.normalized=!1,n.count=t.length/3,n}function qve(t,n){Yve(t.attributePlans,n),f(t.indicesPlan)&&Xve(t.indicesPlan,n)}function Yve(t,n){let i=t.length;for(let o=0;o<i;o++){let r=t[o],s=r.attribute,a=s.typedArray;if(r.loadBuffer){let c=ut.createVertexBuffer({typedArray:a,context:n,usage:Fe.STATIC_DRAW});c.vertexArrayDestroyable=!1,s.buffer=c}r.loadTypedArray||(s.typedArray=void 0)}}function Xve(t,n){let i=t.indices;if(t.loadBuffer){let o=ut.createIndexBuffer({typedArray:i.typedArray,context:n,usage:Fe.STATIC_DRAW,indexDatatype:i.indexDatatype});i.buffer=o,o.vertexArrayDestroyable=!1}t.loadTypedArray||(i.typedArray=void 0)}oR.AttributeLoadPlan=VZ;oR.IndicesLoadPlan=Gve;var UC=oR;function Kve(t){t=A(t,A.EMPTY_OBJECT),this.webp=A(t.webp,!1),this.basis=A(t.basis,!1)}var rR=Kve;var Jve=It.Attribute,Zve=It.Indices,UZ=It.FeatureIdAttribute,zZ=It.FeatureIdTexture,HZ=It.FeatureIdImplicitRange,Qve=It.MorphTarget,$ve=It.Primitive,ePe=It.Instances,tPe=It.Skin,nPe=It.Node,iPe=It.AnimatedPropertyType,oPe=It.AnimationSampler,rPe=It.AnimationTarget,sPe=It.AnimationChannel,aPe=It.Animation,cPe=It.ArticulationStage,lPe=It.Articulation,uPe=It.Asset,fPe=It.Scene,dPe=It.Components,hPe=It.MetallicRoughness,mPe=It.SpecularGlossiness,pPe=It.Material,Jo={NOT_LOADED:0,LOADING:1,LOADED:2,PROCESSING:3,POST_PROCESSING:4,PROCESSED:5,READY:6,FAILED:7,UNLOADED:8};function Cm(t){t=A(t,A.EMPTY_OBJECT);let n=t.gltfResource,i=t.baseResource,o=t.typedArray,r=A(t.releaseGltfJson,!1),s=A(t.asynchronous,!0),a=A(t.incrementallyLoadTextures,!0),c=A(t.upAxis,vo.Y),l=A(t.forwardAxis,vo.Z),u=A(t.loadAttributesAsTypedArray,!1),d=A(t.loadAttributesFor2D,!1),h=A(t.loadIndicesForWireframe,!1),_=A(t.loadPrimitiveOutline,!0),y=A(t.loadForClassification,!1),p=A(t.renameBatchIdSemantic,!1);i=f(i)?i:n.clone(),this._gltfJson=t.gltfJson,this._gltfResource=n,this._baseResource=i,this._typedArray=o,this._releaseGltfJson=r,this._asynchronous=s,this._incrementallyLoadTextures=a,this._upAxis=c,this._forwardAxis=l,this._loadAttributesAsTypedArray=u,this._loadAttributesFor2D=d,this._loadIndicesForWireframe=h,this._loadPrimitiveOutline=_,this._loadForClassification=y,this._renameBatchIdSemantic=p,this._hasKhrMeshQuantization=!1,this._sortedPropertyTableIds=void 0,this._sortedFeatureTextureIds=void 0,this._gltfJsonLoader=void 0,this._state=Jo.NOT_LOADED,this._textureState=Jo.NOT_LOADED,this._promise=void 0,this._texturesLoadedPromise=void 0,this._process=function(C,x){},this._processTextures=function(C,x){},this._primitiveLoadPlans=[],this._loaderPromises=[],this._textureLoaders=[],this._texturesPromises=[],this._bufferViewLoaders=[],this._geometryLoaders=[],this._structuralMetadataLoader=void 0,this._postProcessBuffers=[],this._components=void 0}f(Object.create)&&(Cm.prototype=Object.create(eo.prototype),Cm.prototype.constructor=Cm);Object.defineProperties(Cm.prototype,{promise:{get:function(){return this._promise}},cacheKey:{get:function(){}},components:{get:function(){return this._components}},texturesLoadedPromise:{get:function(){return this._texturesLoadedPromise}}});Cm.prototype.load=function(){let t=fo.loadGltfJson({gltfResource:this._gltfResource,baseResource:this._baseResource,typedArray:this._typedArray,gltfJson:this._gltfJson});this._gltfJsonLoader=t,this._state=Jo.LOADING,this._textureState=Jo.LOADING;let n=this,i,o=new Promise(function(r,s){i=new Promise(function(a,c){n._process=function(l,u){if(!Vt.supportsWebP.initialized){Vt.supportsWebP.initialize();return}if(l._state===Jo.LOADED){l._state=Jo.PROCESSING;let d=new rR({webp:Vt.supportsWebP(),basis:u.context.supportsBasis}),h;f(l._gltfJsonLoader)?h=l._gltfJsonLoader.gltf:h=l._gltfJson,f1e(l,h,d,u,s,c),f(l._gltfJsonLoader)&&l._releaseGltfJson&&(fo.unload(l._gltfJsonLoader),l._gltfJsonLoader=void 0)}l._state===Jo.PROCESSING&&_Pe(l,u),l._state===Jo.POST_PROCESSING&&(gPe(l,u.context),l._state=Jo.PROCESSED),l._state===Jo.PROCESSED&&(ZZ(l),l._typedArray=void 0,l._state=Jo.READY,r(l))},n._processTextures=function(l,u){if(l._textureState===Jo.LOADED&&(l._textureState=Jo.PROCESSING),l._textureState===Jo.PROCESSING){let d,h=l._textureLoaders,_=h.length;for(d=0;d<_;++d)h[d].process(u)}l._textureState===Jo.PROCESSED&&(l._textureState=Jo.READY,a(l))}})});return this._promise=t.promise.then(function(){if(!n.isDestroyed())return n._state=Jo.LOADED,n._textureState=Jo.LOADED,o}).catch(function(r){if(!n.isDestroyed())return n._state=Jo.FAILED,n._textureState=Jo.FAILED,kZ(n,r)}),this._texturesLoadedPromise=i.catch(function(r){if(!n.isDestroyed())return n._textureState=Jo.FAILED,kZ(n,r)}),this._promise};function kZ(t,n){t.unload();let i="Failed to load glTF";return n=t.getError(i,n),Promise.reject(n)}function _Pe(t,n){let i=t._bufferViewLoaders,o=i.length;for(let a=0;a<o;++a)i[a].process(n);let r=t._geometryLoaders,s=r.length;for(let a=0;a<s;++a)r[a].process(n);f(t._structuralMetadataLoader)&&t._structuralMetadataLoader.process(n)}function gPe(t,n){let i=t._primitiveLoadPlans,o=i.length;for(let r=0;r<o;r++){let s=i[r];s.postProcess(n),s.needsOutlines&&yPe(t,s)}}function yPe(t,n){let i=t._postProcessBuffers,o=n.primitive,r=o.outlineCoordinates;f(r)&&i.push(r.buffer);let s=o.attributes,a=s.length;for(let l=0;l<a;l++){let u=s[l];f(u.buffer)&&i.push(u.buffer)}let c=o.indices;f(c)&&f(c.buffer)&&i.push(c.buffer)}Cm.prototype.process=function(t){this._process(this,t),this._processTextures(this,t)};function APe(t,n,i,o,r,s,a,c){let u=n.accessors[i].bufferView,d=fo.loadVertexBuffer({gltf:n,gltfResource:t._gltfResource,baseResource:t._baseResource,frameState:c,bufferViewId:u,draco:r,attributeSemantic:o,accessorId:i,asynchronous:t._asynchronous,loadBuffer:s,loadTypedArray:a});return t._geometryLoaders.push(d),d}function CPe(t,n,i,o,r,s,a){let c=fo.loadIndexBuffer({gltf:n,accessorId:i,gltfResource:t._gltfResource,baseResource:t._baseResource,frameState:a,draco:o,asynchronous:t._asynchronous,loadBuffer:r,loadTypedArray:s});return t._geometryLoaders.push(c),c}function xPe(t,n,i){let o=fo.loadBufferView({gltf:n,bufferViewId:i,gltfResource:t._gltfResource,baseResource:t._baseResource});return t._bufferViewLoaders.push(o),o}function GZ(t,n,i){let o=n.byteOffset,r=Tl(t,n),s=n.count,a=du(n.type),c=n.componentType,l=J.getSizeInBytes(c),u=l*a,d=s*a;if(r===u)return i=new Uint8Array(i),J.createArrayBufferView(c,i.buffer,i.byteOffset+o,d);let h=J.createTypedArray(c,d),_=new DataView(i.buffer),y=new Array(a),p=Wp(n.componentType);o=i.byteOffset+o;for(let C=0;C<s;++C){p(_,o,a,l,y);for(let x=0;x<a;++x)h[C*a+x]=y[x];o+=r}return h}function TPe(t,n){let i=t.type;if(i===nn.SCALAR)return n.fill(0);let o=nn.getMathType(i);return n.fill(o.clone(o.ZERO))}function EPe(t,n,i,o){let r=t.type,s=t.count;if(r===nn.SCALAR)for(let a=0;a<s;a++)i[a]=n[a];else if(r===nn.VEC4&&o)for(let a=0;a<s;a++)i[a]=Me.unpack(n,a*4);else{let a=nn.getMathType(r),c=nn.getNumberOfComponents(r);for(let l=0;l<s;l++)i[l]=a.unpack(n,l*c)}return i}function sR(t,n,i,o){let r=n.accessors[i],s=r.count,a=new Array(s),c=r.bufferView;if(f(c)){let u=xPe(t,n,c).promise.then(function(d){if(t.isDestroyed())return;let h=d.typedArray,_=GZ(n,r,h);o=A(o,!1),EPe(r,_,a,o)});return t._loaderPromises.push(u),a}return TPe(r,a)}function hu(t,n){if(!!f(n))return t===Number?n[0]:t.unpack(n)}function bPe(t){return t===Number?0:new t}function SPe(t){switch(t){case J.BYTE:return 127;case J.UNSIGNED_BYTE:return 255;case J.SHORT:return 32767;case J.UNSIGNED_SHORT:return 65535;default:return 1}}var wPe={VEC2:new W(-1,-1),VEC3:new m(-1,-1,-1),VEC4:new se(-1,-1,-1,-1)};function DPe(t,n){let i=SPe(t.componentDatatype),o=wPe[t.type],r=t.min;f(r)&&(r=n.divideByScalar(r,i,r),r=n.maximumByComponent(r,o,r));let s=t.max;f(s)&&(s=n.divideByScalar(s,i,s),s=n.maximumByComponent(s,o,s)),t.min=r,t.max=s}function vPe(t,n,i){let o=t.decodeMatrix,r=hu(i,t.decodedMin),s=hu(i,t.decodedMax);f(r)&&f(s)&&(n.min=r,n.max=s);let a=new It.Quantization;a.componentDatatype=n.componentDatatype,a.type=n.type,o.length===4?(a.quantizedVolumeOffset=o[2],a.quantizedVolumeStepSize=o[0]):o.length===9?(a.quantizedVolumeOffset=new W(o[6],o[7]),a.quantizedVolumeStepSize=new W(o[0],o[4])):o.length===16?(a.quantizedVolumeOffset=new m(o[12],o[13],o[14]),a.quantizedVolumeStepSize=new m(o[0],o[5],o[10])):o.length===25&&(a.quantizedVolumeOffset=new se(o[20],o[21],o[22],o[23]),a.quantizedVolumeStepSize=new se(o[0],o[6],o[12],o[18])),n.quantization=a}function PPe(t,n,i,o,r,s){let a=t.accessors[n],c=nn.getMathType(a.type),l=A(a.normalized,!1),u=new Jve;u.name=i,u.semantic=o,u.setIndex=r,u.constant=bPe(c),u.componentDatatype=a.componentType,u.normalized=l,u.count=a.count,u.type=a.type,u.min=hu(c,a.min),u.max=hu(c,a.max),u.byteOffset=a.byteOffset,u.byteStride=Tl(t,a),Li(a,"WEB3D_quantized_attributes")&&vPe(a.extensions.WEB3D_quantized_attributes,u,c);let d=u.semantic===Tt.POSITION||u.semantic===Tt.NORMAL||u.semantic===Tt.TANGENT||u.semantic===Tt.TEXCOORD;return s&&l&&d&&DPe(u,c),u}function WZ(t){let i=/^\w+_(\d+)$/.exec(t);if(i!==null)return parseInt(i[1])}var IPe={gltfSemantic:void 0,renamedSemantic:void 0,modelSemantic:void 0};function j8(t,n,i){let o=i;t._renameBatchIdSemantic&&(i==="_BATCHID"||i==="BATCHID")&&(o="_FEATURE_ID_0");let r=n.fromGltfSemantic(o),s=IPe;return s.gltfSemantic=i,s.renamedSemantic=o,s.modelSemantic=r,s}function BPe(t){let n=t===Tt.POSITION,i=t===Tt.FEATURE_ID,o=t===Tt.TEXCOORD;return n||i||o}function OPe(t,n,i,o){if(t.byteOffset=0,t.byteStride=void 0,t.quantization=n.quantization,i&&(t.buffer=n.buffer),o){let r=f(n.quantization)?n.quantization.componentDatatype:t.componentDatatype;t.typedArray=J.createArrayBufferView(r,n.typedArray.buffer)}}function RPe(t,n,i,o,r,s){if(r&&(i.buffer=o.buffer),s){let a=o.typedArray;i.typedArray=GZ(t,n,a),r||(i.byteOffset=0,i.byteStride=void 0)}}function jZ(t,n,i,o,r,s,a,c){let l=n.accessors[i],u=l.bufferView,d=o.gltfSemantic,h=o.renamedSemantic,_=o.modelSemantic,y=f(_)?WZ(h):void 0,C=PPe(n,i,d,_,y,t._hasKhrMeshQuantization);if(!f(r)&&!f(u))return C;let T=APe(t,n,i,d,r,s,a,c).promise.then(function(E){t.isDestroyed()||(f(r)&&f(r.attributes)&&f(r.attributes[d])?OPe(C,E,s,a):RPe(n,l,C,E,s,a))});return t._loaderPromises.push(T),C}function qZ(t,n,i,o,r,s,a,c){let l=o.modelSemantic,u=l===Tt.POSITION,d=l===Tt.FEATURE_ID,h=u&&!s&&t._loadAttributesFor2D&&!c.scene3DOnly,_=t._loadForClassification&&d,y=t._loadAttributesAsTypedArray,p=!y,C=y||h||_,E=jZ(t,n,i,o,r,a?!1:p,a?!0:C,c),S=new UC.AttributeLoadPlan(E);return S.loadBuffer=p,S.loadTypedArray=C,S}function MPe(t,n,i,o,r,s){let a=f(o.ROTATION),c=f(o.TRANSLATION)&&f(n.accessors[o.TRANSLATION].min)&&f(n.accessors[o.TRANSLATION].max),l=j8(t,Gr,r),u=l.modelSemantic,d=u===Gr.TRANSLATION||u===Gr.ROTATION||u===Gr.SCALE,h=u===Gr.TRANSLATION,_=t._loadAttributesAsTypedArray||a&&d||!s.context.instancedArrays,y=!_,p=t._loadAttributesFor2D&&!s.scene3DOnly;return jZ(t,n,i,l,void 0,y,_||h&&(!c||p),s)}function LPe(t,n,i,o,r,s,a){let c=n.accessors[i],l=c.bufferView;if(!f(o)&&!f(l))return;let u=new Zve;u.count=c.count;let d=t._loadAttributesAsTypedArray,h=t._loadIndicesForWireframe&&!a.context.webgl2,_=t._loadForClassification&&r,p=!d,C=d||h||_,S=CPe(t,n,i,o,s?!1:p,s?!0:C,a).promise.then(function(D){t.isDestroyed()||(u.indexDatatype=D.indexDatatype,u.buffer=D.buffer,u.typedArray=D.typedArray)});t._loaderPromises.push(S);let w=new UC.IndicesLoadPlan(u);return w.loadBuffer=p,w.loadTypedArray=C,w}function Am(t,n,i,o,r,s){let a=El.getImageIdFromTexture({gltf:n,textureId:i.index,supportedImageFormats:o});if(!f(a))return;let c=fo.loadTexture({gltf:n,textureInfo:i,gltfResource:t._gltfResource,baseResource:t._baseResource,supportedImageFormats:o,frameState:r,asynchronous:t._asynchronous});t._textureLoaders.push(c);let l=El.createModelTextureReader({textureInfo:i}),u=c.promise.then(function(d){t.isUnloaded()||t.isDestroyed()||(l.texture=d.texture,f(s)&&(l.texture.sampler=s))});return t._texturesPromises.push(u),l}function FPe(t,n,i,o,r){let s=new pPe,a=A(i.extensions,A.EMPTY_OBJECT),c=a.KHR_materials_pbrSpecularGlossiness,l=i.pbrMetallicRoughness;if(s.unlit=f(a.KHR_materials_unlit),f(c)){let u=new mPe;s.specularGlossiness=u,f(c.diffuseTexture)&&(u.diffuseTexture=Am(t,n,c.diffuseTexture,o,r)),f(c.specularGlossinessTexture)&&f(c.specularGlossinessTexture)&&(u.specularGlossinessTexture=Am(t,n,c.specularGlossinessTexture,o,r)),u.diffuseFactor=hu(se,c.diffuseFactor),u.specularFactor=hu(m,c.specularFactor),u.glossinessFactor=c.glossinessFactor,s.pbrSpecularGlossiness=c}else if(f(l)){let u=new hPe;f(l.baseColorTexture)&&(u.baseColorTexture=Am(t,n,l.baseColorTexture,o,r)),f(l.metallicRoughnessTexture)&&(u.metallicRoughnessTexture=Am(t,n,l.metallicRoughnessTexture,o,r)),u.baseColorFactor=hu(se,l.baseColorFactor),u.metallicFactor=l.metallicFactor,u.roughnessFactor=l.roughnessFactor,s.metallicRoughness=u}return f(i.emissiveTexture)&&(s.emissiveTexture=Am(t,n,i.emissiveTexture,o,r)),f(i.normalTexture)&&!t._loadForClassification&&(s.normalTexture=Am(t,n,i.normalTexture,o,r)),f(i.occlusionTexture)&&(s.occlusionTexture=Am(t,n,i.occlusionTexture,o,r)),s.emissiveFactor=hu(m,i.emissiveFactor),s.alphaMode=i.alphaMode,s.alphaCutoff=i.alphaCutoff,s.doubleSided=i.doubleSided,s}function YZ(t,n){let i=new UZ;return i.featureCount=t.featureCount,i.nullFeatureId=t.nullFeatureId,i.propertyTableId=t.propertyTable,i.setIndex=t.attribute,i.label=t.label,i.positionalLabel=n,i}function XZ(t,n,i,o){let r=new UZ,s=t.featureIds;return r.featureCount=i,r.propertyTableId=n,r.setIndex=WZ(s.attribute),r.positionalLabel=o,r}function KZ(t,n){let i=new HZ;return i.propertyTableId=t.propertyTable,i.featureCount=t.featureCount,i.nullFeatureId=t.nullFeatureId,i.label=t.label,i.positionalLabel=n,i.offset=0,i.repeat=1,i}function JZ(t,n,i,o){let r=new HZ,s=t.featureIds;r.propertyTableId=n,r.featureCount=i,r.offset=A(s.constant,0);let a=A(s.divisor,0);return r.repeat=a===0?void 0:a,r.positionalLabel=o,r}function NPe(t,n,i,o,r,s){let a=new zZ;a.featureCount=i.featureCount,a.nullFeatureId=i.nullFeatureId,a.propertyTableId=i.propertyTable,a.label=i.label,a.positionalLabel=s;let c=i.texture;a.textureReader=Am(t,n,c,o,r,pn.NEAREST);let u=(f(c.channels)?c.channels:[0]).map(function(d){return"rgba".charAt(d)}).join("");return a.textureReader.channels=u,a}function VPe(t,n,i,o,r,s,a,c){let l=new zZ,u=i.featureIds,d=u.texture;return l.featureCount=a,l.propertyTableId=o,l.textureReader=Am(t,n,d,r,s,pn.NEAREST),l.textureReader.channels=u.channels,l.positionalLabel=c,l}function kPe(t,n,i,o,r,s){let a=new Qve,c=void 0,l=!1;for(let u in i)if(i.hasOwnProperty(u)){let d=i[u],h=j8(t,Tt,u),_=qZ(t,n,d,h,c,l,o,s);a.attributes.push(_.attribute),r.attributePlans.push(_)}return a}function UPe(t,n,i,o,r,s){let a=new $ve,c=new UC(a);t._primitiveLoadPlans.push(c);let l=i.material;f(l)&&(a.material=FPe(t,n,n.materials[l],r,s));let u=A(i.extensions,A.EMPTY_OBJECT),d=!1,h=u.CESIUM_primitive_outline;t._loadPrimitiveOutline&&f(h)&&(d=!0,c.needsOutlines=!0,c.outlineIndices=zPe(t,n,h,c));let _=t._loadForClassification,y=u.KHR_draco_mesh_compression,p=!1,C=i.attributes;if(f(C)){for(let O in C)if(C.hasOwnProperty(O)){let M=C[O],L=j8(t,Tt,O),F=L.modelSemantic;if(_&&!BPe(F))continue;F===Tt.FEATURE_ID&&(p=!0);let g=qZ(t,n,M,L,y,o,d,s);c.attributePlans.push(g),a.attributes.push(g.attribute)}}let x=i.targets;if(f(x)&&!_){let O=x.length;for(let M=0;M<O;++M)a.morphTargets.push(kPe(t,n,x[M],d,c,s))}let T=i.indices;if(f(T)){let O=LPe(t,n,T,y,p,d,s);f(O)&&(c.indicesPlan=O,a.indices=O.indices)}let E=u.EXT_structural_metadata,S=u.EXT_mesh_features,w=u.EXT_feature_metadata,D=f(w);f(S)?HPe(t,n,a,S,r,s):D&&GPe(t,n,a,w,r,s),f(E)?WPe(a,E):D&&jPe(t,a,w);let I=i.mode;if(_&&I!==Re.TRIANGLES)throw new he("Only triangle meshes can be used for classification.");return a.primitiveType=I,a}function zPe(t,n,i){let o=i.indices;return sR(t,n,o,!1)}function HPe(t,n,i,o,r,s){let a;f(o)&&f(o.featureIds)?a=o.featureIds:a=[];for(let c=0;c<a.length;c++){let l=a[c],u=`featureId_${c}`,d;f(l.texture)?d=NPe(t,n,l,r,s,u):f(l.attribute)?d=YZ(l,u):d=KZ(l,u),i.featureIds.push(d)}}function GPe(t,n,i,o,r,s){let a=n.extensions.EXT_feature_metadata.featureTables,c=0,l=o.featureIdAttributes;if(f(l)){let d=l.length;for(let h=0;h<d;++h){let _=l[h],y=_.featureTable,p=t._sortedPropertyTableIds.indexOf(y),C=a[y].count,x=`featureId_${c}`;c++;let T;f(_.featureIds.attribute)?T=XZ(_,p,C,x):T=JZ(_,p,C,x),i.featureIds.push(T)}}let u=o.featureIdTextures;if(f(u)){let d=u.length;for(let h=0;h<d;++h){let _=u[h],y=_.featureTable,p=t._sortedPropertyTableIds.indexOf(y),C=a[y].count,x=`featureId_${c}`;c++;let T=VPe(t,n,_,p,r,s,C,x);i.featureIds.push(T)}}}function WPe(t,n){!f(n)||(f(n.propertyTextures)&&(t.propertyTextureIds=n.propertyTextures),f(n.propertyAttributes)&&(t.propertyAttributeIds=n.propertyAttributes))}function jPe(t,n,i){f(i.featureTextures)&&(n.propertyTextureIds=i.featureTextures.map(function(o){return t._sortedFeatureTextureIds.indexOf(o)}))}function qPe(t,n,i,o){let r=i.EXT_mesh_gpu_instancing,s=new ePe,a=r.attributes;if(f(a)){for(let d in a)if(a.hasOwnProperty(d)){let h=a[d];s.attributes.push(MPe(t,n,h,a,d,o))}}let c=A(r.extensions,A.EMPTY_OBJECT),l=i.EXT_instance_features,u=c.EXT_feature_metadata;return f(l)?YPe(s,l):f(u)&&XPe(n,s,u,t._sortedPropertyTableIds),s}function YPe(t,n){let i=n.featureIds;for(let o=0;o<i.length;o++){let r=i[o],s=`instanceFeatureId_${o}`,a;f(r.attribute)?a=YZ(r,s):a=KZ(r,s),t.featureIds.push(a)}}function XPe(t,n,i,o){let r=t.extensions.EXT_feature_metadata.featureTables,s=i.featureIdAttributes;if(f(s)){let a=s.length;for(let c=0;c<a;++c){let l=s[c],u=l.featureTable,d=o.indexOf(u),h=r[u].count,_=`instanceFeatureId_${c}`,y;f(l.featureIds.attribute)?y=XZ(l,d,h,_):y=JZ(l,d,h,_),n.featureIds.push(y)}}}function KPe(t,n,i,o,r){let s=new nPe;s.name=i.name,s.matrix=hu(N,i.matrix),s.translation=hu(m,i.translation),s.rotation=hu(Me,i.rotation),s.scale=hu(m,i.scale);let a=A(i.extensions,A.EMPTY_OBJECT),c=a.EXT_mesh_gpu_instancing,l=a.AGI_articulations;if(f(c)){if(t._loadForClassification)throw new he("Models with the EXT_mesh_gpu_instancing extension cannot be used for classification.");s.instances=qPe(t,n,a,r)}f(l)&&(s.articulationName=l.articulationName);let u=i.mesh;if(f(u)){let d=n.meshes[u],h=d.primitives,_=h.length;for(let x=0;x<_;++x)s.primitives.push(UPe(t,n,h[x],f(s.instances),o,r));let y=A(i.weights,d.weights),C=s.primitives[0].morphTargets.length;s.morphWeights=f(y)?y.slice():new Array(C).fill(0)}return s}function JPe(t,n,i,o){if(!f(n.nodes))return[];let r,s,a=n.nodes.length,c=new Array(a);for(r=0;r<a;++r){let l=KPe(t,n,n.nodes[r],i,o);l.index=r,c[r]=l}for(r=0;r<a;++r){let l=n.nodes[r].children;if(f(l)){let u=l.length;for(s=0;s<u;++s)c[r].children.push(c[l[s]])}}return c}function ZPe(t,n,i,o){let r=new tPe,s=i.joints,a=s.length,c=new Array(a);for(let u=0;u<a;++u)c[u]=o[s[u]];r.joints=c;let l=i.inverseBindMatrices;return f(l)?r.inverseBindMatrices=sR(t,n,l):r.inverseBindMatrices=new Array(a).fill(N.IDENTITY),r}function QPe(t,n,i){let o=n.skins;if(t._loadForClassification||!f(o))return[];let r=n.skins.length,s=new Array(r);for(let c=0;c<r;++c){let l=ZPe(t,n,n.skins[c],i);l.index=c,s[c]=l}let a=i.length;for(let c=0;c<a;++c){let l=n.nodes[c].skin;f(l)&&(i[c].skin=s[l])}return s}function $Pe(t,n,i,o,r,s){let a=new nR({gltf:n,extension:i,extensionLegacy:o,gltfResource:t._gltfResource,baseResource:t._baseResource,supportedImageFormats:r,frameState:s,asynchronous:t._asynchronous});return a.load(),t._structuralMetadataLoader=a,a}function e1e(t,n,i){let o=new oPe,r=i.input;o.input=sR(t,n,r);let s=i.interpolation;o.interpolation=A(Gd[s],Gd.LINEAR);let a=i.output;return o.output=sR(t,n,a,!0),o}function t1e(t,n){let i=new rPe,o=t.node;if(!f(o))return;i.node=n[o];let r=t.path.toUpperCase();return i.path=iPe[r],i}function n1e(t,n,i){let o=new sPe,r=t.sampler;return o.sampler=n[r],o.target=t1e(t.target,i),o}function i1e(t,n,i,o){let r,s=new aPe;s.name=i.name;let a=i.samplers,c=a.length,l=new Array(c);for(r=0;r<c;r++){let _=e1e(t,n,a[r]);_.index=r,l[r]=_}let u=i.channels,d=u.length,h=new Array(d);for(r=0;r<d;r++)h[r]=n1e(u[r],l,o);return s.samplers=l,s.channels=h,s}function o1e(t,n,i){let o=n.animations;if(t._loadForClassification||!f(o))return[];let r=n.animations.length,s=new Array(r);for(let a=0;a<r;++a){let c=i1e(t,n,n.animations[a],i);c.index=a,s[a]=c}return s}function r1e(t){let n=new cPe;n.name=t.name;let i=t.type.toUpperCase();return n.type=rc[i],n.minimumValue=t.minimumValue,n.maximumValue=t.maximumValue,n.initialValue=t.initialValue,n}function s1e(t){let n=new lPe;n.name=t.name;let i=t.stages,o=i.length,r=new Array(o);for(let s=0;s<o;s++){let a=r1e(i[s]);r[s]=a}return n.stages=r,n}function a1e(t){let i=A(t.extensions,A.EMPTY_OBJECT).AGI_articulations;if(!f(i))return[];let o=i.articulations;if(!f(o))return[];let r=o.length,s=new Array(r);for(let a=0;a<r;a++){let c=s1e(o[a]);s[a]=c}return s}function c1e(t){let n;return f(t.scenes)&&f(t.scene)&&(n=t.scenes[t.scene].nodes),n=A(n,t.nodes),n=f(n)?n:[],n}function l1e(t,n){let i=new fPe,o=c1e(t);return i.nodes=o.map(function(r){return n[r]}),i}var u1e=new m;function f1e(t,n,i,o,r,s){let a=n.asset.version;if(a!=="1.0"&&a!=="2.0"){let D=t._gltfResource.url;throw new he(`Failed to load ${D}: 
Unsupported glTF version: ${a}`)}let c=n.extensionsRequired;f(c)&&(on.checkSupportedExtensions(c),t._hasKhrMeshQuantization=c.includes("KHR_mesh_quantization"));let l=A(n.extensions,A.EMPTY_OBJECT),u=l.EXT_structural_metadata,d=l.EXT_feature_metadata,h=l.CESIUM_RTC;if(f(d)){let D=d.featureTables,I=d.featureTextures,O=f(D)?D:[],M=f(I)?I:[];t._sortedPropertyTableIds=Object.keys(O).sort(),t._sortedFeatureTextureIds=Object.keys(M).sort()}let _=JPe(t,n,i,o),y=QPe(t,n,_),p=o1e(t,n,_),C=a1e(n),x=l1e(n,_),T=new dPe,E=new uPe,S=n.asset.copyright;if(f(S)){let D=S.split(";").map(function(I){return new Jt(I.trim())});E.credits=D}if(T.asset=E,T.scene=x,T.nodes=_,T.skins=y,T.animations=p,T.articulations=C,T.upAxis=t._upAxis,T.forwardAxis=t._forwardAxis,f(h)){let D=m.fromArray(h.center,0,u1e);T.transform=N.fromTranslation(D,T.transform)}if(t._components=T,f(u)||f(d)){let I=$Pe(t,n,u,d,i,o).promise.then(function(O){t.isDestroyed()||(T.structuralMetadata=O.structuralMetadata)});t._loaderPromises.push(I)}let w=[];w.push.apply(w,t._loaderPromises),t._incrementallyLoadTextures||w.push.apply(w,t._texturesPromises),Promise.all(w).then(function(){t.isDestroyed()||(t._state=Jo.POST_PROCESSING)}).catch(r),Promise.all(t._texturesPromises).then(function(){t.isDestroyed()||(t._textureState=Jo.PROCESSED)}).catch(s)}function d1e(t){let n=t._textureLoaders,i=n.length;for(let o=0;o<i;++o)fo.unload(n[o]);t._textureLoaders.length=0}function ZZ(t){let n=t._bufferViewLoaders,i=n.length;for(let o=0;o<i;++o)fo.unload(n[o]);t._bufferViewLoaders.length=0}function h1e(t){let n=t._geometryLoaders,i=n.length;for(let o=0;o<i;++o)fo.unload(n[o]);t._geometryLoaders.length=0}function m1e(t){let n=t._postProcessBuffers,i=n.length;for(let o=0;o<i;o++){let r=n[o];r.isDestroyed()||r.destroy()}n.length=0}function p1e(t){f(t._structuralMetadataLoader)&&(t._structuralMetadataLoader.destroy(),t._structuralMetadataLoader=void 0)}Cm.prototype.isUnloaded=function(){return this._state===Jo.UNLOADED};Cm.prototype.unload=function(){f(this._gltfJsonLoader)&&fo.unload(this._gltfJsonLoader),this._gltfJsonLoader=void 0,d1e(this),ZZ(this),h1e(this),m1e(this),p1e(this),this._components=void 0,this._typedArray=void 0,this._state=Jo.UNLOADED};var i_=Cm;function QZ(t){t=A(t,A.EMPTY_OBJECT),this.vertexArray=t.vertexArray,this.fragmentShaderSource=t.fragmentShaderSource,this.shaderProgram=t.shaderProgram,this.uniformMap=t.uniformMap,this.outputTexture=t.outputTexture,this.preExecute=t.preExecute,this.postExecute=t.postExecute,this.canceled=t.canceled,this.persists=A(t.persists,!1),this.pass=Te.COMPUTE,this.owner=t.owner}QZ.prototype.execute=function(t){t.execute(this)};var Pf=QZ;var aR=`varying vec2 v_textureCoordinates;
uniform float originalSize;
uniform sampler2D texture0;
uniform sampler2D texture1;
uniform sampler2D texture2;
uniform sampler2D texture3;
uniform sampler2D texture4;
uniform sampler2D texture5;
const float yMipLevel1 = 1.0 - (1.0 / pow(2.0, 1.0));
const float yMipLevel2 = 1.0 - (1.0 / pow(2.0, 2.0));
const float yMipLevel3 = 1.0 - (1.0 / pow(2.0, 3.0));
const float yMipLevel4 = 1.0 - (1.0 / pow(2.0, 4.0));
void main()
{
vec2 uv = v_textureCoordinates;
vec2 textureSize = vec2(originalSize * 1.5 + 2.0, originalSize);
vec2 pixel = 1.0 / textureSize;
float mipLevel = 0.0;
if (uv.x - pixel.x > (textureSize.y / textureSize.x))
{
mipLevel = 1.0;
if (uv.y - pixel.y > yMipLevel1)
{
mipLevel = 2.0;
if (uv.y - pixel.y * 3.0 > yMipLevel2)
{
mipLevel = 3.0;
if (uv.y - pixel.y * 5.0 > yMipLevel3)
{
mipLevel = 4.0;
if (uv.y - pixel.y * 7.0 > yMipLevel4)
{
mipLevel = 5.0;
}
}
}
}
}
if (mipLevel > 0.0)
{
float scale = pow(2.0, mipLevel);
uv.y -= (pixel.y * (mipLevel - 1.0) * 2.0);
uv.x *= ((textureSize.x - 2.0) / textureSize.y);
uv.x -= 1.0 + pixel.x;
uv.y -= (1.0 - (1.0 / pow(2.0, mipLevel - 1.0)));
uv *= scale;
}
else
{
uv.x *= (textureSize.x / textureSize.y);
}
if(mipLevel == 0.0)
{
gl_FragColor = texture2D(texture0, uv);
}
else if(mipLevel == 1.0)
{
gl_FragColor = texture2D(texture1, uv);
}
else if(mipLevel == 2.0)
{
gl_FragColor = texture2D(texture2, uv);
}
else if(mipLevel == 3.0)
{
gl_FragColor = texture2D(texture3, uv);
}
else if(mipLevel == 4.0)
{
gl_FragColor = texture2D(texture4, uv);
}
else if(mipLevel == 5.0)
{
gl_FragColor = texture2D(texture5, uv);
}
else
{
gl_FragColor = vec4(0.0);
}
}
`;var cR=`varying vec3 v_cubeMapCoordinates;
uniform samplerCube cubeMap;
void main()
{
vec4 rgba = textureCube(cubeMap, v_cubeMapCoordinates);
#ifdef RGBA_NORMALIZED
gl_FragColor = vec4(rgba.rgb, 1.0);
#else
float m = rgba.a * 16.0;
vec3 r = rgba.rgb * m;
gl_FragColor = vec4(r * r, 1.0);
#endif
}
`;var lR=`attribute vec4 position;
attribute vec3 cubeMapCoordinates;
varying vec3 v_cubeMapCoordinates;
void main()
{
gl_Position = position;
v_cubeMapCoordinates = cubeMapCoordinates;
}
`;function R0(t){this._url=t,this._cubeMapBuffers=void 0,this._cubeMaps=void 0,this._texture=void 0,this._mipTextures=void 0,this._va=void 0,this._sp=void 0,this._maximumMipmapLevel=void 0,this._loading=!1,this._ready=!1;let n=this;this._readyPromise=new Promise((i,o)=>{n._completeLoadFromCache=r=>{q8(this),this._texture=r,this._maximumMipmapLevel=this._texture.maximumMipmapLevel,this._ready=!0,i()},n._failLoad=r=>{o(r)},n._completeLoad=()=>{this._ready=!0,i()}})}Object.defineProperties(R0.prototype,{url:{get:function(){return this._url}},texture:{get:function(){return this._texture}},maximumMipmapLevel:{get:function(){return this._maximumMipmapLevel}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise}}});R0.isSupported=function(t){return t.colorBufferHalfFloat&&t.halfFloatingPointTexture||t.floatingPointTexture&&t.colorBufferFloat};var _1e=new m(1,0,0),g1e=new m(0,0,1),y1e=new m(-1,0,0),A1e=new m(0,0,-1),uR=new m(0,1,0),C1e=new m(0,-1,0),tQ=[uR,y1e,g1e,C1e,_1e,uR,A1e,uR,uR],nQ=tQ.length,iQ=new Float32Array(nQ*3),$Z=0;for(let t=0;t<nQ;++t,$Z+=3)m.pack(tQ[t],iQ,$Z);var x1e=new Float32Array([-1,1,-1,0,0,1,0,0,1,0,1,1,0,-1,-1,-1,1,-1]),T1e=new Uint16Array([0,1,2,2,3,1,7,6,1,3,6,1,2,5,4,3,4,2,4,8,6,3,4,6]);function E1e(t){let n=ut.createVertexBuffer({context:t,typedArray:x1e,usage:Fe.STATIC_DRAW}),i=ut.createVertexBuffer({context:t,typedArray:iQ,usage:Fe.STATIC_DRAW}),o=ut.createIndexBuffer({context:t,typedArray:T1e,usage:Fe.STATIC_DRAW,indexDatatype:Ne.UNSIGNED_SHORT}),r=[{index:0,vertexBuffer:n,componentsPerAttribute:2,componentDatatype:J.FLOAT},{index:1,vertexBuffer:i,componentsPerAttribute:3,componentDatatype:J.FLOAT}];return new $n({context:t,attributes:r,indexBuffer:o})}function eQ(t){return function(){return t}}function q8(t){t._va=t._va&&t._va.destroy(),t._sp=t._sp&&t._sp.destroy();let n,i,o=t._cubeMaps;if(f(o))for(i=o.length,n=0;n<i;++n)o[n].destroy();let r=t._mipTextures;if(f(r))for(i=r.length,n=0;n<i;++n)r[n].destroy();t._va=void 0,t._sp=void 0,t._cubeMaps=void 0,t._cubeMapBuffers=void 0,t._mipTextures=void 0}R0.prototype.update=function(t){let n=t.context;if(!R0.isSupported(n)||(f(this._texture)&&f(this._va)&&q8(this),f(this._texture)))return;if(!f(this._texture)&&!this._loading){let y=t.context.textureCache.getTexture(this._url);f(y)&&this._completeLoadFromCache(y)}let i=this._cubeMapBuffers;if(!f(i)&&!this._loading){let y=this;xl(this._url).then(function(p){y._cubeMapBuffers=p,y._loading=!1}).catch(function(p){y._failLoad(p)}),this._loading=!0}if(!f(this._cubeMapBuffers))return;let o=[],r=i[0].positiveX.pixelDatatype;f(r)?o.push("RGBA_NORMALIZED"):r=n.halfFloatingPointTexture?je.HALF_FLOAT:je.FLOAT;let s=st.RGBA,a=new ze({defines:o,sources:[cR]});this._va=E1e(n),this._sp=qt.fromCache({context:n,vertexShaderSource:lR,fragmentShaderSource:a,attributeLocations:{position:0,cubeMapCoordinates:1}});let c=Math.min(i.length,6);this._maximumMipmapLevel=c-1;let l=this._cubeMaps=new Array(c),u=this._mipTextures=new Array(c),d=i[0].positiveX.width*2,h={originalSize:function(){return d}};for(let y=0;y<c;++y){let p=i[y].positiveY;i[y].positiveY=i[y].negativeY,i[y].negativeY=p;let C=l[y]=new tc({context:n,source:i[y],pixelDatatype:r}),x=l[y].width*2,T=u[y]=new St({context:n,width:x,height:x,pixelDatatype:r,pixelFormat:s}),E=new Pf({vertexArray:this._va,shaderProgram:this._sp,uniformMap:{cubeMap:eQ(C)},outputTexture:T,persists:!0,owner:this});t.commandList.push(E),h[`texture${y}`]=eQ(T)}this._texture=new St({context:n,width:d*1.5+2,height:d,pixelDatatype:r,pixelFormat:s}),this._texture.maximumMipmapLevel=this._maximumMipmapLevel,n.textureCache.addTexture(this._url,this._texture);let _=new Pf({fragmentShaderSource:aR,uniformMap:h,outputTexture:this._texture,persists:!1,owner:this});t.commandList.push(_),this._completeLoad()};R0.prototype.isDestroyed=function(){return!1};R0.prototype.destroy=function(){return q8(this),this._texture=this._texture&&this._texture.destroy(),ue(this)};var Kd=R0;function rS(t){t=A(t,A.EMPTY_OBJECT);let n=f(t.imageBasedLightingFactor)?W.clone(t.imageBasedLightingFactor):new W(1,1);this._imageBasedLightingFactor=n;let i=A(t.luminanceAtZenith,.2);this._luminanceAtZenith=i;let o=t.sphericalHarmonicCoefficients;this._sphericalHarmonicCoefficients=o,this._specularEnvironmentMaps=t.specularEnvironmentMaps,this._specularEnvironmentMapAtlas=void 0,this._specularEnvironmentMapAtlasDirty=!0,this._specularEnvironmentMapLoaded=!1,this._previousSpecularEnvironmentMapLoaded=!1,this._useDefaultSpecularMaps=!1,this._useDefaultSphericalHarmonics=!1,this._shouldRegenerateShaders=!1,this._previousFrameNumber=void 0,this._previousImageBasedLightingFactor=W.clone(n),this._previousLuminanceAtZenith=i,this._previousSphericalHarmonicCoefficients=o}Object.defineProperties(rS.prototype,{imageBasedLightingFactor:{get:function(){return this._imageBasedLightingFactor},set:function(t){this._previousImageBasedLightingFactor=W.clone(this._imageBasedLightingFactor,this._previousImageBasedLightingFactor),this._imageBasedLightingFactor=W.clone(t,this._imageBasedLightingFactor)}},luminanceAtZenith:{get:function(){return this._luminanceAtZenith},set:function(t){this._previousLuminanceAtZenith=this._luminanceAtZenith,this._luminanceAtZenith=t}},sphericalHarmonicCoefficients:{get:function(){return this._sphericalHarmonicCoefficients},set:function(t){this._previousSphericalHarmonicCoefficients=this._sphericalHarmonicCoefficients,this._sphericalHarmonicCoefficients=t}},specularEnvironmentMaps:{get:function(){return this._specularEnvironmentMaps},set:function(t){t!==this._specularEnvironmentMaps&&(this._specularEnvironmentMapAtlasDirty=this._specularEnvironmentMapAtlasDirty||t!==this._specularEnvironmentMaps,this._specularEnvironmentMapLoaded=!1),this._specularEnvironmentMaps=t}},enabled:{get:function(){return this._imageBasedLightingFactor.x>0||this._imageBasedLightingFactor.y>0}},shouldRegenerateShaders:{get:function(){return this._shouldRegenerateShaders}},useDefaultSphericalHarmonics:{get:function(){return this._useDefaultSphericalHarmonics}},useSphericalHarmonicCoefficients:{get:function(){return f(this._sphericalHarmonicCoefficients)||this._useDefaultSphericalHarmonics}},specularEnvironmentMapAtlas:{get:function(){return this._specularEnvironmentMapAtlas}},useDefaultSpecularMaps:{get:function(){return this._useDefaultSpecularMaps}},useSpecularEnvironmentMaps:{get:function(){return f(this._specularEnvironmentMapAtlas)&&this._specularEnvironmentMapAtlas.ready||this._useDefaultSpecularMaps}}});function b1e(t,n){if(!!Kd.isSupported(n)){if(t._specularEnvironmentMapAtlas=t._specularEnvironmentMapAtlas&&t._specularEnvironmentMapAtlas.destroy(),f(t._specularEnvironmentMaps)){let i=new Kd(t._specularEnvironmentMaps);t._specularEnvironmentMapAtlas=i,i.readyPromise.then(function(){t._specularEnvironmentMapLoaded=!0}).catch(function(o){console.error(`Error loading specularEnvironmentMaps: ${o}`)})}t._shouldRegenerateShaders=!0}}rS.prototype.update=function(t){if(t.frameNumber===this._previousFrameNumber)return;this._previousFrameNumber=t.frameNumber;let n=t.context;t.brdfLutGenerator.update(t),this._shouldRegenerateShaders=!1;let i=this._imageBasedLightingFactor,o=this._previousImageBasedLightingFactor;W.equals(i,o)||(this._shouldRegenerateShaders=i.x>0&&o.x===0||i.x===0&&o.x>0,this._shouldRegenerateShaders=this._shouldRegenerateShaders||i.y>0&&o.y===0||i.y===0&&o.y>0,this._previousImageBasedLightingFactor=W.clone(this._imageBasedLightingFactor,this._previousImageBasedLightingFactor)),this._luminanceAtZenith!==this._previousLuminanceAtZenith&&(this._shouldRegenerateShaders=this._shouldRegenerateShaders||f(this._luminanceAtZenith)!==f(this._previousLuminanceAtZenith),this._previousLuminanceAtZenith=this._luminanceAtZenith),this._previousSphericalHarmonicCoefficients!==this._sphericalHarmonicCoefficients&&(this._shouldRegenerateShaders=this._shouldRegenerateShaders||f(this._previousSphericalHarmonicCoefficients)!==f(this._sphericalHarmonicCoefficients),this._previousSphericalHarmonicCoefficients=this._sphericalHarmonicCoefficients),this._shouldRegenerateShaders=this._shouldRegenerateShaders||this._previousSpecularEnvironmentMapLoaded!==this._specularEnvironmentMapLoaded,this._previousSpecularEnvironmentMapLoaded=this._specularEnvironmentMapLoaded,this._specularEnvironmentMapAtlasDirty&&(b1e(this,n),this._specularEnvironmentMapAtlasDirty=!1),f(this._specularEnvironmentMapAtlas)&&this._specularEnvironmentMapAtlas.update(t);let r=!f(this._specularEnvironmentMapAtlas)&&f(t.specularEnvironmentMaps)&&!this._useDefaultSpecularMaps,s=!f(t.specularEnvironmentMaps)&&this._useDefaultSpecularMaps,a=!f(this._sphericalHarmonicCoefficients)&&f(t.sphericalHarmonicCoefficients)&&!this._useDefaultSphericalHarmonics,c=!f(t.sphericalHarmonicCoefficients)&&this._useDefaultSphericalHarmonics;this._shouldRegenerateShaders=this._shouldRegenerateShaders||r||s||a||c,this._useDefaultSpecularMaps=!f(this._specularEnvironmentMapAtlas)&&f(t.specularEnvironmentMaps),this._useDefaultSphericalHarmonics=!f(this._sphericalHarmonicCoefficients)&&f(t.sphericalHarmonicCoefficients)};rS.prototype.isDestroyed=function(){return!1};rS.prototype.destroy=function(){return this._specularEnvironmentMapAtlas=this._specularEnvironmentMapAtlas&&this._specularEnvironmentMapAtlas.destroy(),ue(this)};var zC=rS;function fR(t){t=A(t,A.EMPTY_OBJECT),this.color=t.color,this.depth=t.depth,this.stencil=t.stencil,this.renderState=t.renderState,this.framebuffer=t.framebuffer,this.owner=t.owner,this.pass=t.pass}fR.ALL=Object.freeze(new fR({color:new z(0,0,0,0),depth:1,stencil:0}));fR.prototype.execute=function(t,n){t.clear(this,n)};var Qn=fR;function HC(t){t=A(t,A.EMPTY_OBJECT);let n=t.context,i=t.width,o=t.height;this._width=i,this._height=o;let r=t.colorRenderbuffers,s=t.colorTextures;if(f(r)!==f(s))throw new Ce("Both color renderbuffer and texture attachments must be provided.");let a=t.depthStencilRenderbuffer,c=t.depthStencilTexture;if(f(a)!==f(c))throw new Ce("Both depth-stencil renderbuffer and texture attachments must be provided.");this._renderFramebuffer=new Xo({context:n,colorRenderbuffers:r,depthStencilRenderbuffer:a,destroyAttachments:t.destroyAttachments}),this._colorFramebuffer=new Xo({context:n,colorTextures:s,depthStencilTexture:c,destroyAttachments:t.destroyAttachments})}HC.prototype.getRenderFramebuffer=function(){return this._renderFramebuffer};HC.prototype.getColorFramebuffer=function(){return this._colorFramebuffer};HC.prototype.blitFramebuffers=function(t,n){this._renderFramebuffer.bindRead(),this._colorFramebuffer.bindDraw();let i=t._gl,o=0;this._colorFramebuffer._colorTextures.length>0&&(o|=i.COLOR_BUFFER_BIT),f(this._colorFramebuffer.depthStencilTexture)&&(o|=i.DEPTH_BUFFER_BIT|(n?i.STENCIL_BUFFER_BIT:0)),i.blitFramebuffer(0,0,this._width,this._height,0,0,this._width,this._height,o,i.NEAREST),i.bindFramebuffer(i.READ_FRAMEBUFFER,null),i.bindFramebuffer(i.DRAW_FRAMEBUFFER,null)};HC.prototype.isDestroyed=function(){return!1};HC.prototype.destroy=function(){return this._renderFramebuffer.destroy(),this._colorFramebuffer.destroy(),ue(this)};var dR=HC;var zc={RGBA4:ee.RGBA4,RGBA8:ee.RGBA8,RGBA16F:ee.RGBA16F,RGBA32F:ee.RGBA32F,RGB5_A1:ee.RGB5_A1,RGB565:ee.RGB565,DEPTH_COMPONENT16:ee.DEPTH_COMPONENT16,STENCIL_INDEX8:ee.STENCIL_INDEX8,DEPTH_STENCIL:ee.DEPTH_STENCIL,DEPTH24_STENCIL8:ee.DEPTH24_STENCIL8,validate:function(t){return t===zc.RGBA4||t===zc.RGBA8||t===zc.RGBA16F||t===zc.RGBA32F||t===zc.RGB5_A1||t===zc.RGB565||t===zc.DEPTH_COMPONENT16||t===zc.STENCIL_INDEX8||t===zc.DEPTH_STENCIL||t===zc.DEPTH24_STENCIL8},getColorFormat:function(t){return t===ee.FLOAT?zc.RGBA32F:t===ee.HALF_FLOAT_OES?zc.RGBA16F:zc.RGBA8}},Hc=Object.freeze(zc);function sS(t){t=A(t,A.EMPTY_OBJECT);let i=t.context._gl,o=Ut.maximumRenderbufferSize,r=A(t.format,Hc.RGBA4),s=f(t.width)?t.width:i.drawingBufferWidth,a=f(t.height)?t.height:i.drawingBufferHeight,c=A(t.numSamples,1);this._gl=i,this._format=r,this._width=s,this._height=a,this._renderbuffer=this._gl.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,this._renderbuffer),c>1?i.renderbufferStorageMultisample(i.RENDERBUFFER,c,r,s,a):i.renderbufferStorage(i.RENDERBUFFER,r,s,a),i.bindRenderbuffer(i.RENDERBUFFER,null)}Object.defineProperties(sS.prototype,{format:{get:function(){return this._format}},width:{get:function(){return this._width}},height:{get:function(){return this._height}}});sS.prototype._getRenderbuffer=function(){return this._renderbuffer};sS.prototype.isDestroyed=function(){return!1};sS.prototype.destroy=function(){return this._gl.deleteRenderbuffer(this._renderbuffer),ue(this)};var mu=sS;function es(t){t=A(t,A.EMPTY_OBJECT),this._numSamples=A(t.numSamples,1),this._colorAttachmentsLength=A(t.colorAttachmentsLength,1),this._color=A(t.color,!0),this._depth=A(t.depth,!1),this._depthStencil=A(t.depthStencil,!1),this._supportsDepthTexture=A(t.supportsDepthTexture,!1),this._createColorAttachments=A(t.createColorAttachments,!0),this._createDepthAttachments=A(t.createDepthAttachments,!0),this._pixelDatatype=t.pixelDatatype,this._pixelFormat=t.pixelFormat,this._width=void 0,this._height=void 0,this._framebuffer=void 0,this._multisampleFramebuffer=void 0,this._colorTextures=void 0,this._color&&(this._colorTextures=new Array(this._colorAttachmentsLength),this._colorRenderbuffers=new Array(this._colorAttachmentsLength)),this._colorRenderbuffer=void 0,this._depthStencilRenderbuffer=void 0,this._depthStencilTexture=void 0,this._depthRenderbuffer=void 0,this._depthTexture=void 0,this._attachmentsDirty=!1}Object.defineProperties(es.prototype,{framebuffer:{get:function(){return this._numSamples>1?this._multisampleFramebuffer.getRenderFramebuffer():this._framebuffer}},numSamples:{get:function(){return this._numSamples}},status:{get:function(){return this.framebuffer.status}}});es.prototype.isDirty=function(t,n,i,o,r){i=A(i,1);let s=this._width!==t||this._height!==n,a=this._numSamples!==i,c=f(o)&&this._pixelDatatype!==o||f(r)&&this._pixelFormat!==r,l=i===1?f(this._framebuffer):f(this._multisampleFramebuffer);return this._attachmentsDirty||s||a||c||!l||this._color&&!f(this._colorTextures[0])};es.prototype.update=function(t,n,i,o,r,s){if(o=t.msaa?A(o,1):1,r=A(r,this._color?A(this._pixelDatatype,je.UNSIGNED_BYTE):void 0),s=A(s,this._color?A(this._pixelFormat,st.RGBA):void 0),this.isDirty(n,i,o,r,s)){if(this.destroy(),this._width=n,this._height=i,this._numSamples=o,this._pixelDatatype=r,this._pixelFormat=s,this._attachmentsDirty=!1,this._color&&this._createColorAttachments){for(let a=0;a<this._colorAttachmentsLength;++a)if(this._colorTextures[a]=new St({context:t,width:n,height:i,pixelFormat:s,pixelDatatype:r,sampler:pn.NEAREST}),this._numSamples>1){let c=Hc.getColorFormat(r);this._colorRenderbuffers[a]=new mu({context:t,width:n,height:i,format:c,numSamples:this._numSamples})}}this._depthStencil&&this._createDepthAttachments&&(this._supportsDepthTexture&&t.depthTexture?(this._depthStencilTexture=new St({context:t,width:n,height:i,pixelFormat:st.DEPTH_STENCIL,pixelDatatype:je.UNSIGNED_INT_24_8,sampler:pn.NEAREST}),this._numSamples>1&&(this._depthStencilRenderbuffer=new mu({context:t,width:n,height:i,format:Hc.DEPTH24_STENCIL8,numSamples:this._numSamples}))):this._depthStencilRenderbuffer=new mu({context:t,width:n,height:i,format:Hc.DEPTH_STENCIL})),this._depth&&this._createDepthAttachments&&(this._supportsDepthTexture&&t.depthTexture?this._depthTexture=new St({context:t,width:n,height:i,pixelFormat:st.DEPTH_COMPONENT,pixelDatatype:je.UNSIGNED_INT,sampler:pn.NEAREST}):this._depthRenderbuffer=new mu({context:t,width:n,height:i,format:Hc.DEPTH_COMPONENT16})),this._numSamples>1?this._multisampleFramebuffer=new dR({context:t,width:this._width,height:this._height,colorTextures:this._colorTextures,colorRenderbuffers:this._colorRenderbuffers,depthStencilTexture:this._depthStencilTexture,depthStencilRenderbuffer:this._depthStencilRenderbuffer,destroyAttachments:!1}):this._framebuffer=new Xo({context:t,colorTextures:this._colorTextures,depthTexture:this._depthTexture,depthRenderbuffer:this._depthRenderbuffer,depthStencilTexture:this._depthStencilTexture,depthStencilRenderbuffer:this._depthStencilRenderbuffer,destroyAttachments:!1})}};es.prototype.getColorTexture=function(t){return t=A(t,0),this._colorTextures[t]};es.prototype.setColorTexture=function(t,n){n=A(n,0),this._attachmentsDirty=t!==this._colorTextures[n],this._colorTextures[n]=t};es.prototype.getColorRenderbuffer=function(t){return t=A(t,0),this._colorRenderbuffers[t]};es.prototype.setColorRenderbuffer=function(t,n){n=A(n,0),this._attachmentsDirty=t!==this._colorRenderbuffers[n],this._colorRenderbuffers[n]=t};es.prototype.getDepthRenderbuffer=function(){return this._depthRenderbuffer};es.prototype.setDepthRenderbuffer=function(t){this._attachmentsDirty=t!==this._depthRenderbuffer,this._depthRenderbuffer=t};es.prototype.getDepthTexture=function(){return this._depthTexture};es.prototype.setDepthTexture=function(t){this._attachmentsDirty=t!==this._depthTexture,this._depthTexture=t};es.prototype.getDepthStencilRenderbuffer=function(){return this._depthStencilRenderbuffer};es.prototype.setDepthStencilRenderbuffer=function(t){this._attachmentsDirty=t!==this._depthStencilRenderbuffer,this._depthStencilRenderbuffer=t};es.prototype.getDepthStencilTexture=function(){return this._depthStencilTexture};es.prototype.setDepthStencilTexture=function(t){this._attachmentsDirty=t!==this._depthStencilTexture,this._depthStencilTexture=t};es.prototype.prepareTextures=function(t,n){this._numSamples>1&&this._multisampleFramebuffer.blitFramebuffers(t,n)};es.prototype.clear=function(t,n,i){let o=n.framebuffer;n.framebuffer=this.framebuffer,n.execute(t,i),n.framebuffer=o};es.prototype.destroyFramebuffer=function(){this._framebuffer=this._framebuffer&&this._framebuffer.destroy(),this._multisampleFramebuffer=this._multisampleFramebuffer&&this._multisampleFramebuffer.destroy()};es.prototype.destroy=function(){if(this._color){let t,n=this._colorTextures.length;for(t=0;t<n;++t){let i=this._colorTextures[t];this._createColorAttachments&&f(i)&&!i.isDestroyed()&&(this._colorTextures[t].destroy(),this._colorTextures[t]=void 0),f(i)&&i.isDestroyed()&&(this._colorTextures[t]=void 0);let o=this._colorRenderbuffers[t];this._createColorAttachments&&f(o)&&!o.isDestroyed()&&(this._colorRenderbuffers[t].destroy(),this._colorRenderbuffers[t]=void 0),f(o)&&o.isDestroyed()&&(this._colorRenderbuffers[t]=void 0)}}this._depthStencil&&(this._createDepthAttachments&&(this._depthStencilTexture=this._depthStencilTexture&&this._depthStencilTexture.destroy(),this._depthStencilRenderbuffer=this._depthStencilRenderbuffer&&this._depthStencilRenderbuffer.destroy()),f(this._depthStencilTexture)&&this._depthStencilTexture.isDestroyed()&&(this._depthStencilTexture=void 0),f(this._depthStencilRenderbuffer)&&this._depthStencilRenderbuffer.isDestroyed()&&(this._depthStencilRenderbuffer=void 0)),this._depth&&(this._createDepthAttachments&&(this._depthTexture=this._depthTexture&&this._depthTexture.destroy(),this._depthRenderbuffer=this._depthRenderbuffer&&this._depthRenderbuffer.destroy()),f(this._depthTexture)&&this._depthTexture.isDestroyed()&&(this._depthTexture=void 0),f(this._depthRenderbuffer)&&this._depthRenderbuffer.isDestroyed()&&(this._depthRenderbuffer=void 0)),this.destroyFramebuffer()};var ci=es;var S1e={NEVER:ee.NEVER,LESS:ee.LESS,EQUAL:ee.EQUAL,LESS_OR_EQUAL:ee.LEQUAL,GREATER:ee.GREATER,NOT_EQUAL:ee.NOTEQUAL,GREATER_OR_EQUAL:ee.GEQUAL,ALWAYS:ee.ALWAYS},kn=Object.freeze(S1e);var w1e={ZERO:ee.ZERO,KEEP:ee.KEEP,REPLACE:ee.REPLACE,INCREMENT:ee.INCR,DECREMENT:ee.DECR,INVERT:ee.INVERT,INCREMENT_WRAP:ee.INCR_WRAP,DECREMENT_WRAP:ee.DECR_WRAP},ft=Object.freeze(w1e);var hR={CESIUM_3D_TILE_MASK:128,SKIP_LOD_MASK:112,SKIP_LOD_BIT_SHIFT:4,CLASSIFICATION_MASK:15};hR.setCesium3DTileBit=function(){return{enabled:!0,frontFunction:kn.ALWAYS,frontOperation:{fail:ft.KEEP,zFail:ft.KEEP,zPass:ft.REPLACE},backFunction:kn.ALWAYS,backOperation:{fail:ft.KEEP,zFail:ft.KEEP,zPass:ft.REPLACE},reference:hR.CESIUM_3D_TILE_MASK,mask:hR.CESIUM_3D_TILE_MASK}};var Ot=Object.freeze(hR);var mR=`#extension GL_EXT_frag_depth : enable
uniform sampler2D u_pointCloud_colorGBuffer;
uniform sampler2D u_pointCloud_depthGBuffer;
uniform vec2 u_distanceAndEdlStrength;
varying vec2 v_textureCoordinates;
vec2 neighborContribution(float log2Depth, vec2 offset)
{
float dist = u_distanceAndEdlStrength.x;
vec2 texCoordOrig = v_textureCoordinates + offset * dist;
vec2 texCoord0 = v_textureCoordinates + offset * floor(dist);
vec2 texCoord1 = v_textureCoordinates + offset * ceil(dist);
float depthOrLogDepth0 = czm_unpackDepth(texture2D(u_pointCloud_depthGBuffer, texCoord0));
float depthOrLogDepth1 = czm_unpackDepth(texture2D(u_pointCloud_depthGBuffer, texCoord1));
if (depthOrLogDepth0 == 0.0 || depthOrLogDepth1 == 0.0) {
return vec2(0.0);
}
float depthMix = mix(depthOrLogDepth0, depthOrLogDepth1, fract(dist));
vec4 eyeCoordinate = czm_windowToEyeCoordinates(texCoordOrig, depthMix);
return vec2(max(0.0, log2Depth - log2(-eyeCoordinate.z / eyeCoordinate.w)), 1.0);
}
void main()
{
float depthOrLogDepth = czm_unpackDepth(texture2D(u_pointCloud_depthGBuffer, v_textureCoordinates));
vec4 eyeCoordinate = czm_windowToEyeCoordinates(gl_FragCoord.xy, depthOrLogDepth);
eyeCoordinate /= eyeCoordinate.w;
float log2Depth = log2(-eyeCoordinate.z);
if (depthOrLogDepth == 0.0)
{
discard;
}
vec4 color = texture2D(u_pointCloud_colorGBuffer, v_textureCoordinates);
vec2 texelSize = 1.0 / czm_viewport.zw;
vec2 responseAndCount = vec2(0.0);
responseAndCount += neighborContribution(log2Depth, vec2(-texelSize.x, 0.0));
responseAndCount += neighborContribution(log2Depth, vec2(+texelSize.x, 0.0));
responseAndCount += neighborContribution(log2Depth, vec2(0.0, -texelSize.y));
responseAndCount += neighborContribution(log2Depth, vec2(0.0, +texelSize.y));
float response = responseAndCount.x / responseAndCount.y;
float strength = u_distanceAndEdlStrength.y;
float shade = exp(-response * 300.0 * strength);
color.rgb *= shade;
gl_FragColor = vec4(color);
gl_FragDepthEXT = depthOrLogDepth;
}
`;function GC(){this._framebuffer=new ci({colorAttachmentsLength:2,depth:!0,supportsDepthTexture:!0}),this._drawCommand=void 0,this._clearCommand=void 0,this._strength=1,this._radius=1}Object.defineProperties(GC.prototype,{framebuffer:{get:function(){return this._framebuffer.framebuffer}},colorGBuffer:{get:function(){return this._framebuffer.getColorTexture(0)}},depthGBuffer:{get:function(){return this._framebuffer.getColorTexture(1)}}});function D1e(t){t._framebuffer.destroy(),t._drawCommand=void 0,t._clearCommand=void 0}var Y8=new W;function v1e(t,n){let i=new ze({defines:["LOG_DEPTH_WRITE"],sources:[mR]}),o={u_pointCloud_colorGBuffer:function(){return t.colorGBuffer},u_pointCloud_depthGBuffer:function(){return t.depthGBuffer},u_distanceAndEdlStrength:function(){return Y8.x=t._radius,Y8.y=t._strength,Y8}},r=Ve.fromCache({blending:ln.ALPHA_BLEND,depthMask:!0,depthTest:{enabled:!0},stencilTest:Ot.setCesium3DTileBit(),stencilMask:Ot.CESIUM_3D_TILE_MASK});t._drawCommand=n.createViewportQuadCommand(i,{uniformMap:o,renderState:r,pass:Te.CESIUM_3D_TILE,owner:t}),t._clearCommand=new Qn({framebuffer:t.framebuffer,color:new z(0,0,0,0),depth:1,renderState:Ve.fromCache(),pass:Te.CESIUM_3D_TILE,owner:t})}function P1e(t,n){let i=n.drawingBufferWidth,o=n.drawingBufferHeight;t._framebuffer.update(n,i,o),v1e(t,n)}function oQ(t){return t.drawBuffers&&t.fragmentDepth}GC.isSupported=oQ;function I1e(t,n){let i=t.shaderCache.getDerivedShaderProgram(n,"EC");if(!f(i)){let o=n._attributeLocations,r=n.fragmentShaderSource.clone();r.sources=r.sources.map(function(s){return s=ze.replaceMain(s,"czm_point_cloud_post_process_main"),s=s.replace(/gl_FragColor/g,"gl_FragData[0]"),s}),r.sources.unshift(`#extension GL_EXT_draw_buffers : enable 
`),r.sources.push(`void main() 
{ 
    czm_point_cloud_post_process_main(); 
#ifdef LOG_DEPTH
    czm_writeLogDepth();
    gl_FragData[1] = czm_packDepth(gl_FragDepthEXT); 
#else
    gl_FragData[1] = czm_packDepth(gl_FragCoord.z);
#endif
}`),i=t.shaderCache.createDerivedShaderProgram(n,"EC",{vertexShaderSource:n.vertexShaderSource,fragmentShaderSource:r,attributeLocations:o})}return i}GC.prototype.update=function(t,n,i,o){if(!oQ(t.context))return;this._strength=i.eyeDomeLightingStrength,this._radius=i.eyeDomeLightingRadius*t.pixelRatio,P1e(this,t.context);let r,s=t.commandList,a=s.length;for(r=n;r<a;++r){let u=s[r];if(u.primitiveType!==Re.POINTS||u.pass===Te.TRANSLUCENT)continue;let d,h,_=u.derivedCommands.pointCloudProcessor;f(_)&&(d=_.command,h=_.originalShaderProgram),(!f(d)||u.dirty||h!==u.shaderProgram||d.framebuffer!==this.framebuffer)&&(d=et.shallowClone(u,d),d.framebuffer=this.framebuffer,d.shaderProgram=I1e(t.context,u.shaderProgram),d.castShadows=!1,d.receiveShadows=!1,f(_)||(_={command:d,originalShaderProgram:u.shaderProgram},u.derivedCommands.pointCloudProcessor=_),_.originalShaderProgram=u.shaderProgram),s[r]=d}let c=this._clearCommand,l=this._drawCommand;l.boundingVolume=o,s.push(l),s.push(c)};GC.prototype.isDestroyed=function(){return!1};GC.prototype.destroy=function(){return D1e(this),ue(this)};var o_=GC;function rQ(t){let n=A(t,{});this.attenuation=A(n.attenuation,!1),this.geometricErrorScale=A(n.geometricErrorScale,1),this.maximumAttenuation=n.maximumAttenuation,this.baseResolution=n.baseResolution,this.eyeDomeLighting=A(n.eyeDomeLighting,!0),this.eyeDomeLightingStrength=A(n.eyeDomeLightingStrength,1),this.eyeDomeLightingRadius=A(n.eyeDomeLightingRadius,1),this.backFaceCulling=A(n.backFaceCulling,!1),this.normalShading=A(n.normalShading,!0)}rQ.isSupported=function(t){return o_.isSupported(t.context)};var xm=rQ;function pu(t){this.planes=A(t,[])}var aS=[new m,new m,new m];m.clone(m.UNIT_X,aS[0]);m.clone(m.UNIT_Y,aS[1]);m.clone(m.UNIT_Z,aS[2]);var r_=new m,B1e=new m,sQ=new rn(new m(1,0,0),0);pu.fromBoundingSphere=function(t,n){f(n)||(n=new pu);let i=aS.length,o=n.planes;o.length=2*i;let r=t.center,s=t.radius,a=0;for(let c=0;c<i;++c){let l=aS[c],u=o[a],d=o[a+1];f(u)||(u=o[a]=new se),f(d)||(d=o[a+1]=new se),m.multiplyByScalar(l,-s,r_),m.add(r,r_,r_),u.x=l.x,u.y=l.y,u.z=l.z,u.w=-m.dot(l,r_),m.multiplyByScalar(l,s,r_),m.add(r,r_,r_),d.x=-l.x,d.y=-l.y,d.z=-l.z,d.w=-m.dot(m.negate(l,B1e),r_),a+=2}return n};pu.prototype.computeVisibility=function(t){let n=this.planes,i=!1;for(let o=0,r=n.length;o<r;++o){let s=t.intersectPlane(rn.fromCartesian4(n[o],sQ));if(s===jt.OUTSIDE)return jt.OUTSIDE;s===jt.INTERSECTING&&(i=!0)}return i?jt.INTERSECTING:jt.INSIDE};pu.prototype.computeVisibilityWithPlaneMask=function(t,n,i){if(n===pu.MASK_OUTSIDE||n===pu.MASK_INSIDE)return n;let o=pu.MASK_INSIDE,r=this.planes,s=r[3];i&&this.topPlaneToCull&&(r[3]=this.topPlaneToCull);for(let a=0,c=r.length;a<c;++a){let l=a<31?1<<a:0;if(a<31&&(n&l)===0)continue;let u=t.intersectPlane(rn.fromCartesian4(r[a],sQ));if(r[3]=s,u===jt.OUTSIDE)return pu.MASK_OUTSIDE;u===jt.INTERSECTING&&(o|=l)}return r[3]=s,o};pu.MASK_OUTSIDE=4294967295;pu.MASK_INSIDE=0;pu.MASK_INDETERMINATE=2147483647;var $s=pu;function Jd(t){t=A(t,A.EMPTY_OBJECT),this.left=t.left,this._left=void 0,this.right=t.right,this._right=void 0,this.top=t.top,this._top=void 0,this.bottom=t.bottom,this._bottom=void 0,this.near=A(t.near,1),this._near=this.near,this.far=A(t.far,5e8),this._far=this.far,this._cullingVolume=new $s,this._orthographicMatrix=new N}function aQ(t){(t.top!==t._top||t.bottom!==t._bottom||t.left!==t._left||t.right!==t._right||t.near!==t._near||t.far!==t._far)&&(t._left=t.left,t._right=t.right,t._top=t.top,t._bottom=t.bottom,t._near=t.near,t._far=t.far,t._orthographicMatrix=N.computeOrthographicOffCenter(t.left,t.right,t.bottom,t.top,t.near,t.far,t._orthographicMatrix))}Object.defineProperties(Jd.prototype,{projectionMatrix:{get:function(){return aQ(this),this._orthographicMatrix}}});var O1e=new m,R1e=new m,M1e=new m,X8=new m;Jd.prototype.computeCullingVolume=function(t,n,i){let o=this._cullingVolume.planes,r=this.top,s=this.bottom,a=this.right,c=this.left,l=this.near,u=this.far,d=m.cross(n,i,O1e);m.normalize(d,d);let h=R1e;m.multiplyByScalar(n,l,h),m.add(t,h,h);let _=M1e;m.multiplyByScalar(d,c,_),m.add(h,_,_);let y=o[0];return f(y)||(y=o[0]=new se),y.x=d.x,y.y=d.y,y.z=d.z,y.w=-m.dot(d,_),m.multiplyByScalar(d,a,_),m.add(h,_,_),y=o[1],f(y)||(y=o[1]=new se),y.x=-d.x,y.y=-d.y,y.z=-d.z,y.w=-m.dot(m.negate(d,X8),_),m.multiplyByScalar(i,s,_),m.add(h,_,_),y=o[2],f(y)||(y=o[2]=new se),y.x=i.x,y.y=i.y,y.z=i.z,y.w=-m.dot(i,_),m.multiplyByScalar(i,r,_),m.add(h,_,_),y=o[3],f(y)||(y=o[3]=new se),y.x=-i.x,y.y=-i.y,y.z=-i.z,y.w=-m.dot(m.negate(i,X8),_),y=o[4],f(y)||(y=o[4]=new se),y.x=n.x,y.y=n.y,y.z=n.z,y.w=-m.dot(n,h),m.multiplyByScalar(n,u,_),m.add(t,_,_),y=o[5],f(y)||(y=o[5]=new se),y.x=-n.x,y.y=-n.y,y.z=-n.z,y.w=-m.dot(m.negate(n,X8),_),this._cullingVolume};Jd.prototype.getPixelDimensions=function(t,n,i,o,r){aQ(this);let s=this.right-this.left,a=this.top-this.bottom,c=o*s/t,l=o*a/n;return r.x=c,r.y=l,r};Jd.prototype.clone=function(t){return f(t)||(t=new Jd),t.left=this.left,t.right=this.right,t.top=this.top,t.bottom=this.bottom,t.near=this.near,t.far=this.far,t._left=void 0,t._right=void 0,t._top=void 0,t._bottom=void 0,t._near=void 0,t._far=void 0,t};Jd.prototype.equals=function(t){return f(t)&&t instanceof Jd&&this.right===t.right&&this.left===t.left&&this.top===t.top&&this.bottom===t.bottom&&this.near===t.near&&this.far===t.far};Jd.prototype.equalsEpsilon=function(t,n,i){return t===this||f(t)&&t instanceof Jd&&B.equalsEpsilon(this.right,t.right,n,i)&&B.equalsEpsilon(this.left,t.left,n,i)&&B.equalsEpsilon(this.top,t.top,n,i)&&B.equalsEpsilon(this.bottom,t.bottom,n,i)&&B.equalsEpsilon(this.near,t.near,n,i)&&B.equalsEpsilon(this.far,t.far,n,i)};var Br=Jd;function Gc(t){t=A(t,A.EMPTY_OBJECT),this._offCenterFrustum=new Br,this.width=t.width,this._width=void 0,this.aspectRatio=t.aspectRatio,this._aspectRatio=void 0,this.near=A(t.near,1),this._near=this.near,this.far=A(t.far,5e8),this._far=this.far}Gc.packedLength=4;Gc.pack=function(t,n,i){return i=A(i,0),n[i++]=t.width,n[i++]=t.aspectRatio,n[i++]=t.near,n[i]=t.far,n};Gc.unpack=function(t,n,i){return n=A(n,0),f(i)||(i=new Gc),i.width=t[n++],i.aspectRatio=t[n++],i.near=t[n++],i.far=t[n],i};function M0(t){let n=t._offCenterFrustum;if(t.width!==t._width||t.aspectRatio!==t._aspectRatio||t.near!==t._near||t.far!==t._far){t._aspectRatio=t.aspectRatio,t._width=t.width,t._near=t.near,t._far=t.far;let i=1/t.aspectRatio;n.right=t.width*.5,n.left=-n.right,n.top=i*n.right,n.bottom=-n.top,n.near=t.near,n.far=t.far}}Object.defineProperties(Gc.prototype,{projectionMatrix:{get:function(){return M0(this),this._offCenterFrustum.projectionMatrix}}});Gc.prototype.computeCullingVolume=function(t,n,i){return M0(this),this._offCenterFrustum.computeCullingVolume(t,n,i)};Gc.prototype.getPixelDimensions=function(t,n,i,o,r){return M0(this),this._offCenterFrustum.getPixelDimensions(t,n,i,o,r)};Gc.prototype.clone=function(t){return f(t)||(t=new Gc),t.aspectRatio=this.aspectRatio,t.width=this.width,t.near=this.near,t.far=this.far,t._aspectRatio=void 0,t._width=void 0,t._near=void 0,t._far=void 0,this._offCenterFrustum.clone(t._offCenterFrustum),t};Gc.prototype.equals=function(t){return!f(t)||!(t instanceof Gc)?!1:(M0(this),M0(t),this.width===t.width&&this.aspectRatio===t.aspectRatio&&this._offCenterFrustum.equals(t._offCenterFrustum))};Gc.prototype.equalsEpsilon=function(t,n,i){return!f(t)||!(t instanceof Gc)?!1:(M0(this),M0(t),B.equalsEpsilon(this.width,t.width,n,i)&&B.equalsEpsilon(this.aspectRatio,t.aspectRatio,n,i)&&this._offCenterFrustum.equalsEpsilon(t._offCenterFrustum,n,i))};var $t=Gc;var ea={},L1e=new se(0,0,0,1),Da=new se,F1e=new He,K8=new W,J8=new W;ea.wgs84ToWindowCoordinates=function(t,n,i){return ea.wgs84WithEyeOffsetToWindowCoordinates(t,n,m.ZERO,i)};var cQ=new se,lQ=new m;function cS(t,n,i,o){let r=i.viewMatrix,s=N.multiplyByVector(r,se.fromElements(t.x,t.y,t.z,1,cQ),cQ),a=m.multiplyComponents(n,m.normalize(s,lQ),lQ);return s.x+=n.x+a.x,s.y+=n.y+a.y,s.z+=a.z,N.multiplyByVector(i.frustum.projectionMatrix,s,o)}var N1e=new de(Math.PI,B.PI_OVER_TWO),V1e=new m,k1e=new m;ea.wgs84WithEyeOffsetToWindowCoordinates=function(t,n,i,o){let r=t.frameState,s=ea.computeActualWgs84Position(r,n,L1e);if(!f(s))return;let a=t.canvas,c=F1e;c.x=0,c.y=0,c.width=a.clientWidth,c.height=a.clientHeight;let l=t.camera,u=!1;if(r.mode===ne.SCENE2D){let d=t.mapProjection,h=N1e,_=d.project(h,V1e),y=m.clone(l.position,k1e),p=l.frustum.clone(),C=N.computeViewportTransformation(c,0,1,new N),x=l.frustum.projectionMatrix,T=l.positionWC.y,E=m.fromElements(B.sign(T)*_.x-T,0,-l.positionWC.x),S=vt.pointToGLWindowCoordinates(x,C,E);if(T===0||S.x<=0||S.x>=a.clientWidth)u=!0;else{if(S.x>a.clientWidth*.5){c.width=S.x,l.frustum.right=_.x-T,Da=cS(s,i,l,Da),ea.clipToGLWindowCoordinates(c,Da,K8),c.x+=S.x,l.position.x=-l.position.x;let w=l.frustum.right;l.frustum.right=-l.frustum.left,l.frustum.left=-w,Da=cS(s,i,l,Da),ea.clipToGLWindowCoordinates(c,Da,J8)}else{c.x+=S.x,c.width-=S.x,l.frustum.left=-_.x-T,Da=cS(s,i,l,Da),ea.clipToGLWindowCoordinates(c,Da,K8),c.x=c.x-c.width,l.position.x=-l.position.x;let w=l.frustum.left;l.frustum.left=-l.frustum.right,l.frustum.right=-w,Da=cS(s,i,l,Da),ea.clipToGLWindowCoordinates(c,Da,J8)}m.clone(y,l.position),l.frustum=p.clone(),o=W.clone(K8,o),(o.x<0||o.x>a.clientWidth)&&(o.x=J8.x)}}if(r.mode!==ne.SCENE2D||u){if(Da=cS(s,i,l,Da),Da.z<0&&!(l.frustum instanceof $t)&&!(l.frustum instanceof Br))return;o=ea.clipToGLWindowCoordinates(c,Da,o)}return o.y=a.clientHeight-o.y,o};ea.wgs84ToDrawingBufferCoordinates=function(t,n,i){if(i=ea.wgs84ToWindowCoordinates(t,n,i),!!f(i))return ea.transformWindowToDrawingBuffer(t,i,i)};var Tm=new m,U1e=new de;ea.computeActualWgs84Position=function(t,n,i){let o=t.mode;if(o===ne.SCENE3D)return m.clone(n,i);let r=t.mapProjection,s=r.ellipsoid.cartesianToCartographic(n,U1e);if(!f(s))return;if(r.project(s,Tm),o===ne.COLUMBUS_VIEW)return m.fromElements(Tm.z,Tm.x,Tm.y,i);if(o===ne.SCENE2D)return m.fromElements(0,Tm.x,Tm.y,i);let a=t.morphTime;return m.fromElements(B.lerp(Tm.z,n.x,a),B.lerp(Tm.x,n.y,a),B.lerp(Tm.y,n.z,a),i)};var uQ=new m,fQ=new m,dQ=new N;ea.clipToGLWindowCoordinates=function(t,n,i){return m.divideByScalar(n,n.w,uQ),N.computeViewportTransformation(t,0,1,dQ),N.multiplyByPoint(dQ,uQ,fQ),W.fromCartesian3(fQ,i)};ea.transformWindowToDrawingBuffer=function(t,n,i){let o=t.canvas,r=t.drawingBufferWidth/o.clientWidth,s=t.drawingBufferHeight/o.clientHeight;return W.fromElements(n.x*r,n.y*s,i)};var z1e=new se,hQ=new se;ea.drawingBufferToWgs84Coordinates=function(t,n,i,o){let s=t.context.uniformState,a=s.currentFrustum,c=a.x,l=a.y;if(t.frameState.useLogDepth){let y=i*s.log2FarDepthFromNearPlusOne,p=Math.pow(2,y)-1;i=l*(1-c/(p+c))/(l-c)}let u=t.view.passState.viewport,d=se.clone(se.UNIT_W,z1e);d.x=(n.x-u.x)/u.width*2-1,d.y=(n.y-u.y)/u.height*2-1,d.z=i*2-1,d.w=1;let h,_=t.camera.frustum;if(!f(_.fovy))f(_._offCenterFrustum)&&(_=_._offCenterFrustum),h=hQ,h.x=(d.x*(_.right-_.left)+_.left+_.right)*.5,h.y=(d.y*(_.top-_.bottom)+_.bottom+_.top)*.5,h.z=(d.z*(c-l)-c-l)*.5,h.w=1,h=N.multiplyByVector(s.inverseView,h,h);else{h=N.multiplyByVector(s.inverseViewProjection,d,hQ);let y=1/h.w;m.multiplyByScalar(h,y,h)}return m.fromCartesian4(h,o)};var Yi=ea;var wl={DISABLED:0,ENABLED:1,CAST_ONLY:2,RECEIVE_ONLY:3};wl.NUMBER_OF_SHADOW_MODES=4;wl.castShadows=function(t){return t===wl.ENABLED||t===wl.CAST_ONLY};wl.receiveShadows=function(t){return t===wl.ENABLED||t===wl.RECEIVE_ONLY};wl.fromCastReceive=function(t,n){return t&&n?wl.ENABLED:t?wl.CAST_ONLY:n?wl.RECEIVE_ONLY:wl.DISABLED};var gn=Object.freeze(wl);var H1e={LEFT:-1,NONE:0,RIGHT:1},Wc=Object.freeze(H1e);var WC={};WC._deprecationWarning=ws;var Em=Uint32Array.BYTES_PER_ELEMENT;WC.parse=function(t,n){let i=A(n,0);n=i;let o=new Uint8Array(t),r=new DataView(t);n+=Em;let s=r.getUint32(n,!0);if(s!==1)throw new he(`Only Batched 3D Model version 1 is supported.  Version ${s} is not.`);n+=Em;let a=r.getUint32(n,!0);n+=Em;let c=r.getUint32(n,!0);n+=Em;let l=r.getUint32(n,!0);n+=Em;let u=r.getUint32(n,!0);n+=Em;let d=r.getUint32(n,!0);n+=Em;let h;u>=570425344?(n-=Em*2,h=c,u=l,d=0,c=0,l=0,WC._deprecationWarning("b3dm-legacy-header","This b3dm header is using the legacy format [batchLength] [batchTableByteLength]. The new format is [featureTableJsonByteLength] [featureTableBinaryByteLength] [batchTableJsonByteLength] [batchTableBinaryByteLength] from https://github.com/CesiumGS/3d-tiles/tree/main/specification/TileFormats/Batched3DModel.")):d>=570425344&&(n-=Em,h=u,u=c,d=l,c=0,l=0,WC._deprecationWarning("b3dm-legacy-header","This b3dm header is using the legacy format [batchTableJsonByteLength] [batchTableBinaryByteLength] [batchLength]. The new format is [featureTableJsonByteLength] [featureTableBinaryByteLength] [batchTableJsonByteLength] [batchTableBinaryByteLength] from https://github.com/CesiumGS/3d-tiles/tree/main/specification/TileFormats/Batched3DModel."));let _;c===0?_={BATCH_LENGTH:A(h,0)}:(_=Ko(o,n,c),n+=c);let y=new Uint8Array(t,n,l);n+=l;let p,C;u>0&&(p=Ko(o,n,u),n+=u,d>0&&(C=new Uint8Array(t,n,d),C=new Uint8Array(C),n+=d));let x=i+a-n;if(x===0)throw new he("glTF byte length must be greater than 0.");let T;return n%4===0?T=new Uint8Array(t,n,x):(WC._deprecationWarning("b3dm-glb-unaligned","The embedded glb is not aligned to a 4-byte boundary."),T=new Uint8Array(o.subarray(n,n+x))),{batchLength:h,featureTableJson:_,featureTableBinary:y,batchTableJson:p,batchTableBinary:C,gltf:T}};var pR=WC;function lS(t,n){this.json=t,this.buffer=n,this._cachedTypedArrays={},this.featuresLength=0}function mQ(t,n,i,o,r,s){let a=t._cachedTypedArrays,c=a[n];return f(c)||(c=J.createArrayBufferView(i,t.buffer.buffer,t.buffer.byteOffset+s,r*o),a[n]=c),c}function G1e(t,n,i,o){let r=t._cachedTypedArrays,s=r[n];return f(s)||(s=J.createTypedArray(i,o),r[n]=s),s}lS.prototype.getGlobalProperty=function(t,n,i){let o=this.json[t];if(!!f(o))return f(o.byteOffset)?(n=A(n,J.UNSIGNED_INT),i=A(i,1),mQ(this,t,n,i,1,o.byteOffset)):o};lS.prototype.hasProperty=function(t){return f(this.json[t])};lS.prototype.getPropertyArray=function(t,n,i){let o=this.json[t];if(!!f(o))return f(o.byteOffset)?(f(o.componentType)&&(n=J.fromName(o.componentType)),mQ(this,t,n,i,this.featuresLength,o.byteOffset)):G1e(this,t,n,o)};lS.prototype.getProperty=function(t,n,i,o,r){let s=this.json[t];if(!f(s))return;let a=this.getPropertyArray(t,n,i);if(i===1)return a[o];for(let c=0;c<i;++c)r[c]=a[i*o+c];return r};var Zd=lS;var W1e={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},j1e={SCALAR:void 0,VEC2:W,VEC3:m,VEC4:se,MAT2:Ji,MAT3:$,MAT4:N};function q1e(t){let n=t.componentType,i;typeof n=="string"?i=J.fromName(n):i=n;let o=W1e[t.type],r=j1e[t.type];return{componentsPerAttribute:o,classType:r,createArrayBufferView:function(s,a,c){return J.createArrayBufferView(i,s,a,o*c)}}}var _u=q1e;function bm(t){this._classes=void 0,this._classIds=void 0,this._classIndexes=void 0,this._parentCounts=void 0,this._parentIndexes=void 0,this._parentIds=void 0,this._byteLength=0,Y1e(this,t.extension,t.binaryBody)}Object.defineProperties(bm.prototype,{byteLength:{get:function(){return this._byteLength}}});function Y1e(t,n,i){let o,r,s,a=n.instancesLength,c=n.classes,l=n.classIds,u=n.parentCounts,d=n.parentIds,h=a,_=0;f(l.byteOffset)&&(l.componentType=A(l.componentType,J.UNSIGNED_SHORT),l.type=nn.SCALAR,s=_u(l),l=s.createArrayBufferView(i.buffer,i.byteOffset+l.byteOffset,a),_+=l.byteLength);let y;if(f(u)){for(f(u.byteOffset)&&(u.componentType=A(u.componentType,J.UNSIGNED_SHORT),u.type=nn.SCALAR,s=_u(u),u=s.createArrayBufferView(i.buffer,i.byteOffset+u.byteOffset,a),_+=u.byteLength),y=new Uint16Array(a),h=0,o=0;o<a;++o)y[o]=h,h+=u[o];_+=y.byteLength}f(d)&&f(d.byteOffset)&&(d.componentType=A(d.componentType,J.UNSIGNED_SHORT),d.type=nn.SCALAR,s=_u(d),d=s.createArrayBufferView(i.buffer,i.byteOffset+d.byteOffset,h),_+=d.byteLength);let p=c.length;for(o=0;o<p;++o){let T=c[o].length,E=c[o].instances,S=X1e(T,E,i);_+=K1e(S),c[o].instances=At(S,E)}let C=new Array(p).fill(0),x=new Uint16Array(a);for(o=0;o<a;++o)r=l[o],x[o]=C[r],++C[r];_+=x.byteLength,t._classes=c,t._classIds=l,t._classIndexes=x,t._parentCounts=u,t._parentIndexes=y,t._parentIds=d,t._byteLength=_}function X1e(t,n,i){let o;for(let r in n)if(n.hasOwnProperty(r)){let s=n[r],a=s.byteOffset;if(f(a)){let c=s.componentType,l=s.type;if(!f(c))throw new he("componentType is required.");if(!f(l))throw new he("type is required.");if(!f(i))throw new he(`Property ${r} requires a batch table binary.`);let u=_u(s),d=u.componentsPerAttribute,h=u.classType,_=u.createArrayBufferView(i.buffer,i.byteOffset+a,t);f(o)||(o={}),o[r]={typedArray:_,componentCount:d,type:h}}}return o}function K1e(t){let n=0;for(let i in t)t.hasOwnProperty(i)&&(n+=t[i].typedArray.byteLength);return n}var J1e=[],Z1e=[],Q1e=0;function $1e(t,n,i){let o=t._classIds,r=t._parentCounts,s=t._parentIds,a=t._parentIndexes,c=o.length,l=J1e;l.length=Math.max(l.length,c);let u=++Q1e,d=Z1e;for(d.length=0,d.push(n);d.length>0;){if(n=d.pop(),l[n]===u)continue;l[n]=u;let h=i(t,n);if(f(h))return h;let _=r[n],y=a[n];for(let p=0;p<_;++p){let C=s[y+p];C!==n&&d.push(C)}}}function eIe(t,n,i){let o=!0;for(;o;){let r=i(t,n);if(f(r))return r;let s=t._parentIds[n];o=s!==n,n=s}}function uS(t,n,i){let o=t._parentCounts,r=t._parentIds;if(f(r)){if(f(o))return $1e(t,n,i)}else return i(t,n);return eIe(t,n,i)}bm.prototype.hasProperty=function(t,n){let i=uS(this,t,function(o,r){let s=o._classIds[r],a=o._classes[s].instances;if(f(a[n]))return!0});return f(i)};bm.prototype.propertyExists=function(t){let n=this._classes,i=n.length;for(let o=0;o<i;++o){let r=n[o].instances;if(f(r[t]))return!0}return!1};bm.prototype.getPropertyIds=function(t,n){return n=f(n)?n:[],n.length=0,uS(this,t,function(i,o){let r=i._classIds[o],s=i._classes[r].instances;for(let a in s)s.hasOwnProperty(a)&&n.indexOf(a)===-1&&n.push(a)}),n};bm.prototype.getProperty=function(t,n){return uS(this,t,function(i,o){let r=i._classIds[o],s=i._classes[r],a=i._classIndexes[o],c=s.instances[n];if(f(c))return f(c.typedArray)?tIe(c,a):tt(c[a],!0)})};function tIe(t,n){let i=t.typedArray,o=t.componentCount;return o===1?i[n]:t.type.unpack(i,n*o)}bm.prototype.setProperty=function(t,n,i){let o=uS(this,t,function(r,s){let a=r._classIds[s],c=r._classes[a],l=r._classIndexes[s],u=c.instances[n];if(f(u))return f(u.typedArray)?nIe(u,l,i):u[l]=tt(i,!0),!0});return f(o)};function nIe(t,n,i){let o=t.typedArray,r=t.componentCount;r===1?o[n]=i:t.type.pack(i,o,n*r)}bm.prototype.isClass=function(t,n){let i=uS(this,t,function(o,r){let s=o._classIds[r];if(o._classes[s].name===n)return!0});return f(i)};bm.prototype.getClassName=function(t){let n=this._classIds[t];return this._classes[n].name};var jC=bm;function Z8(t){let n=t.count,i=t.batchTable,o=t.binaryBody,r=A(t.parseAsPropertyAttributes,!1),s=t.customAttributeOutput,a=iIe(i),c;f(a.jsonProperties)&&(c=new jp({count:n,properties:a.jsonProperties}));let l;f(a.hierarchy)&&(l=new jC({extension:a.hierarchy,binaryBody:o}));let u=Yd.BATCH_TABLE_CLASS_NAME,d=a.binaryProperties,h,_,y;if(r){let x=rIe(n,u,d,o,s);y=x.transcodedSchema,_=[new OC({propertyAttribute:x.propertyAttributeJson,class:x.transcodedClass})]}else{let x=oIe(n,u,d,o);y=x.transcodedSchema;let T=x.featureTableJson;h=new wf({count:T.count,properties:T.properties,class:x.transcodedClass,bufferViews:x.bufferViewsTypedArrays}),_=[]}let p=[];if(f(h)||f(c)||f(l)){let x=new Uc({id:0,name:"Batch Table",count:n,metadataTable:h,jsonMetadataTable:c,batchTableHierarchy:l});p.push(x)}let C={schema:y,propertyTables:p,propertyAttributes:_,extensions:a.extensions,extras:a.extras};return new Ea(C)}function iIe(t){let n=t.HIERARCHY,i=t.extras,o=t.extensions,r;f(n)?(Z8._deprecationWarning("batchTableHierarchyExtension","The batch table HIERARCHY property has been moved to an extension. Use extensions.3DTILES_batch_table_hierarchy instead."),r=n):f(o)&&(r=o["3DTILES_batch_table_hierarchy"]);let s,a={};for(let c in t){if(!t.hasOwnProperty(c)||c==="HIERARCHY"||c==="extensions"||c==="extras")continue;let l=t[c];Array.isArray(l)?(s=f(s)?s:{},s[c]=l):a[c]=l}return{binaryProperties:a,jsonProperties:s,hierarchy:r,extras:i,extensions:o}}function oIe(t,n,i,o){let r={},s={},a={},c=0;for(let h in i){if(!i.hasOwnProperty(h))continue;if(!f(o))throw new he(`Property ${h} requires a batch table binary.`);let _=i[h],y=_u(_);s[h]={bufferView:c},r[h]=pQ(_),a[c]=y.createArrayBufferView(o.buffer,o.byteOffset+_.byteOffset,t),c++}let l={classes:{}};l.classes[n]={properties:r};let u=new Xd(l);return{featureTableJson:{class:n,count:t,properties:s},bufferViewsTypedArrays:a,transcodedSchema:u,transcodedClass:u.classes[n]}}function rIe(t,n,i,o,r){let s={},a={},c=0;for(let h in i){if(!i.hasOwnProperty(h))continue;let _=i[h];if(!f(o)&&!f(_.typedArray))throw new he(`Property ${h} requires a batch table binary.`);let y=on.sanitizeGlslIdentifier(h);(y===""||s.hasOwnProperty(y))&&(y=`property_${c}`,c++);let p=pQ(_);p.name=h,s[y]=p;let C=y.toUpperCase();C.startsWith("_")||(C=`_${C}`);let x=_.typedArray;f(x)||(x=_u(_).createArrayBufferView(o.buffer,o.byteOffset+_.byteOffset,t));let T=new It.Attribute;T.name=C,T.count=t,T.type=_.type,T.componentDatatype=J.fromTypedArray(x),T.typedArray=x,r.push(T),a[y]={attribute:C}}let l={classes:{}};l.classes[n]={properties:s};let u=new Xd(l);return{class:n,propertyAttributeJson:{properties:a},transcodedSchema:u,transcodedClass:u.classes[n]}}function pQ(t){let n=sIe(t.componentType);return{type:t.type,componentType:n}}function sIe(t){switch(t){case"BYTE":return"INT8";case"UNSIGNED_BYTE":return"UINT8";case"SHORT":return"INT16";case"UNSIGNED_SHORT":return"UINT16";case"INT":return"INT32";case"UNSIGNED_INT":return"UINT32";case"FLOAT":return"FLOAT32";case"DOUBLE":return"FLOAT64"}}Z8._deprecationWarning=ws;var s_=Z8;var L0={UNLOADED:0,LOADING:1,PROCESSING:2,READY:3,FAILED:4},aIe=It.FeatureIdAttribute;function a_(t){t=A(t,A.EMPTY_OBJECT);let n=t.b3dmResource,i=t.baseResource,o=t.arrayBuffer,r=A(t.byteOffset,0),s=A(t.releaseGltfJson,!1),a=A(t.asynchronous,!0),c=A(t.incrementallyLoadTextures,!0),l=A(t.upAxis,vo.Y),u=A(t.forwardAxis,vo.X),d=A(t.loadAttributesAsTypedArray,!1),h=A(t.loadAttributesFor2D,!1),_=A(t.loadIndicesForWireframe,!1),y=A(t.loadPrimitiveOutline,!0),p=A(t.loadForClassification,!1);i=f(i)?i:n.clone(),this._b3dmResource=n,this._baseResource=i,this._arrayBuffer=o,this._byteOffset=r,this._releaseGltfJson=s,this._asynchronous=a,this._incrementallyLoadTextures=c,this._upAxis=l,this._forwardAxis=u,this._loadAttributesAsTypedArray=d,this._loadAttributesFor2D=h,this._loadIndicesForWireframe=_,this._loadPrimitiveOutline=y,this._loadForClassification=p,this._state=L0.UNLOADED,this._promise=void 0,this._gltfLoader=void 0,this._batchLength=0,this._propertyTable=void 0,this._batchTable=void 0,this._components=void 0,this._transform=N.IDENTITY}f(Object.create)&&(a_.prototype=Object.create(eo.prototype),a_.prototype.constructor=a_);Object.defineProperties(a_.prototype,{promise:{get:function(){return this._promise}},texturesLoadedPromise:{get:function(){return this._gltfLoader.texturesLoadedPromise}},cacheKey:{get:function(){}},components:{get:function(){return this._components}}});a_.prototype.load=function(){let t=pR.parse(this._arrayBuffer,this._byteOffset),n=t.batchLength,i=t.featureTableJson,o=t.featureTableBinary,r=t.batchTableJson,s=t.batchTableBinary,a=new Zd(i,o);n=a.getGlobalProperty("BATCH_LENGTH"),this._batchLength=n;let c=a.getGlobalProperty("RTC_CENTER",J.FLOAT,3);f(c)&&(this._transform=N.fromTranslation(m.fromArray(c))),this._batchTable={json:r,binary:s};let l=new i_({typedArray:t.gltf,upAxis:this._upAxis,forwardAxis:this._forwardAxis,gltfResource:this._b3dmResource,baseResource:this._baseResource,releaseGltfJson:this._releaseGltfJson,incrementallyLoadTextures:this._incrementallyLoadTextures,loadAttributesAsTypedArray:this._loadAttributesAsTypedArray,loadAttributesFor2D:this._loadAttributesFor2D,loadIndicesForWireframe:this._loadIndicesForWireframe,loadPrimitiveOutline:this._loadPrimitiveOutline,loadForClassification:this._loadForClassification,renameBatchIdSemantic:!0});this._gltfLoader=l,this._state=L0.LOADING;let u=this;return l.load(),this._promise=l.promise.then(function(){if(u.isDestroyed())return;let d=l.components;return d.transform=N.multiplyTransformation(u._transform,d.transform,d.transform),lIe(u,d),u._components=d,u._arrayBuffer=void 0,u._state=L0.READY,u}).catch(function(d){if(!u.isDestroyed())return cIe(u,d)}),this._promise};function cIe(t,n){t.unload(),t._state=L0.FAILED;let i="Failed to load b3dm";return n=t.getError(i,n),Promise.reject(n)}a_.prototype.process=function(t){this._state===L0.LOADING&&(this._state=L0.PROCESSING),this._state===L0.PROCESSING&&this._gltfLoader.process(t)};function lIe(t,n){let i=t._batchTable,o=t._batchLength;if(o===0)return;let r;if(f(i.json))r=s_({count:o,batchTable:i.json,binaryBody:i.binary});else{let c=new Uc({name:Yd.BATCH_TABLE_CLASS_NAME,count:o});r=new Ea({schema:{},propertyTables:[c]})}let s=n.scene.nodes,a=s.length;for(let c=0;c<a;c++)_Q(s[c]);n.structuralMetadata=r}function _Q(t){let n=t.children.length;for(let o=0;o<n;o++)_Q(t.children[o]);let i=t.primitives.length;for(let o=0;o<i;o++){let r=t.primitives[o],s=on.getAttributeBySemantic(r,Tt.FEATURE_ID);if(f(s)){s.setIndex=0;let a=new aIe;a.propertyTableId=0,a.setIndex=0,a.positionalLabel="featureId_0",r.featureIds.push(a)}}}a_.prototype.unload=function(){f(this._gltfLoader)&&this._gltfLoader.unload(),this._components=void 0,this._arrayBuffer=void 0};var _R=a_;function c_(t){t=A(t,A.EMPTY_OBJECT),this._geoJson=t.geoJson,this._promise=void 0,this._process=function(n,i){},this._components=void 0}f(Object.create)&&(c_.prototype=Object.create(eo.prototype),c_.prototype.constructor=c_);Object.defineProperties(c_.prototype,{promise:{get:function(){return this._promise}},cacheKey:{get:function(){}},components:{get:function(){return this._components}}});c_.prototype.load=function(){let t=this,n=new Promise(function(i){t._process=function(o,r){f(o._components)||(o._components=TIe(o._geoJson,r),o._geoJson=void 0,i(o))}});return this._promise=n,n};c_.prototype.process=function(t){this._process(this,t)};function uIe(){this.lines=void 0,this.points=void 0,this.properties=void 0}function fIe(){this.features=[]}function Q8(t){let n=t[0],i=t[1],o=A(t[2],0);return new m(n,i,o)}function $8(t){let n=t.length,i=new Array(n);for(let r=0;r<n;r++)i[r]=Q8(t[r]);return[i]}function dIe(t){let n=t.length,i=new Array(n);for(let o=0;o<n;o++)i[o]=$8(t[o])[0];return i}function gQ(t){let n=t.length,i=new Array(n);for(let o=0;o<n;o++)i[o]=$8(t[o])[0];return i}function hIe(t){let n=t.length,i=[];for(let o=0;o<n;o++)Array.prototype.push.apply(i,gQ(t[o]));return i}function mIe(t){return[Q8(t)]}function pIe(t){let n=t.length,i=new Array(n);for(let o=0;o<n;o++)i[o]=Q8(t[o]);return i}var _Ie={LineString:$8,MultiLineString:dIe,MultiPolygon:hIe,Polygon:gQ,MultiPoint:pIe,Point:mIe},gIe={LineString:Re.LINES,MultiLineString:Re.LINES,MultiPolygon:Re.LINES,Polygon:Re.LINES,MultiPoint:Re.POINTS,Point:Re.POINTS};function yQ(t,n){if(!f(t.geometry))return;let i=t.geometry.type,o=_Ie[i],r=gIe[i],s=t.geometry.coordinates;if(!f(o)||!f(s))return;let a=new uIe;r===Re.LINES?a.lines=o(s):r===Re.POINTS&&(a.points=o(s)),a.properties=t.properties,n.features.push(a)}function yIe(t,n){let i=t.features,o=i.length;for(let r=0;r<o;r++)yQ(i[r],n)}var AIe={FeatureCollection:yIe,Feature:yQ},gR=new m;function CIe(t,n,i){let o=0,r=0,s=t.length;for(let L=0;L<s;L++){let F=t[L];if(f(F.lines)){let g=F.lines.length;for(let b=0;b<g;b++){let v=F.lines[b];o+=v.length,r+=(v.length-1)*2}}}let a=new Float32Array(o*3),c=new Float32Array(o),l=Ne.createTypedArray(o,r),u=Ne.fromTypedArray(l),d=new m(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),h=new m(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),_=0,y=0;for(let L=0;L<s;L++){let F=t[L];if(!f(F.lines))continue;let g=F.lines.length;for(let b=0;b<g;b++){let v=F.lines[b],P=v.length;for(let R=0;R<P;R++){let V=v[R],H=m.fromDegrees(V.x,V.y,V.z,oe.WGS84,gR),U=N.multiplyByPoint(n,H,gR);m.minimumByComponent(d,U,d),m.maximumByComponent(h,U,h),m.pack(U,a,_*3),c[_]=L,R<P-1&&(l[y*2]=_,l[y*2+1]=_+1,y++),_++}}}let p=ut.createVertexBuffer({typedArray:a,context:i.context,usage:Fe.STATIC_DRAW});p.vertexArrayDestroyable=!1;let C=ut.createVertexBuffer({typedArray:c,context:i.context,usage:Fe.STATIC_DRAW});C.vertexArrayDestroyable=!1;let x=ut.createIndexBuffer({typedArray:l,context:i.context,usage:Fe.STATIC_DRAW,indexDatatype:u});x.vertexArrayDestroyable=!1;let T=new It.Attribute;T.semantic=Tt.POSITION,T.componentDatatype=J.FLOAT,T.type=nn.VEC3,T.count=o,T.min=d,T.max=h,T.buffer=p;let E=new It.Attribute;E.semantic=Tt.FEATURE_ID,E.setIndex=0,E.componentDatatype=J.FLOAT,E.type=nn.SCALAR,E.count=o,E.buffer=C;let S=[T,E],w=new It.Material;w.unlit=!0;let D=new It.Indices;D.indexDatatype=u,D.count=l.length,D.buffer=x;let I=new It.FeatureIdAttribute;I.featureCount=s,I.propertyTableId=0,I.setIndex=0,I.positionalLabel="featureId_0";let O=[I],M=new It.Primitive;return M.attributes=S,M.indices=D,M.featureIds=O,M.primitiveType=Re.LINES,M.material=w,M}function xIe(t,n,i){let o=0,r=t.length;for(let S=0;S<r;S++){let w=t[S];f(w.points)&&(o+=w.points.length)}let s=new Float32Array(o*3),a=new Float32Array(o),c=new m(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),l=new m(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),u=0;for(let S=0;S<r;S++){let w=t[S];if(!f(w.points))continue;let D=w.points.length;for(let I=0;I<D;I++){let O=w.points[I],M=m.fromDegrees(O.x,O.y,O.z,oe.WGS84,gR),L=N.multiplyByPoint(n,M,gR);m.minimumByComponent(c,L,c),m.maximumByComponent(l,L,l),m.pack(L,s,u*3),a[u]=S,u++}}let d=ut.createVertexBuffer({typedArray:s,context:i.context,usage:Fe.STATIC_DRAW});d.vertexArrayDestroyable=!1;let h=ut.createVertexBuffer({typedArray:a,context:i.context,usage:Fe.STATIC_DRAW});h.vertexArrayDestroyable=!1;let _=new It.Attribute;_.semantic=Tt.POSITION,_.componentDatatype=J.FLOAT,_.type=nn.VEC3,_.count=o,_.min=c,_.max=l,_.buffer=d;let y=new It.Attribute;y.semantic=Tt.FEATURE_ID,y.setIndex=0,y.componentDatatype=J.FLOAT,y.type=nn.SCALAR,y.count=o,y.buffer=h;let p=[_,y],C=new It.Material;C.unlit=!0;let x=new It.FeatureIdAttribute;x.featureCount=r,x.propertyTableId=0,x.setIndex=0,x.positionalLabel="featureId_0";let T=[x],E=new It.Primitive;return E.attributes=p,E.featureIds=T,E.primitiveType=Re.POINTS,E.material=C,E}function TIe(t,n){let i=new fIe,o=AIe[t.type];f(o)&&o(t,i);let r=i.features,s=r.length;if(s===0)throw new he("GeoJSON must have at least one feature");let a={};for(let L=0;L<s;L++){let F=r[L],g=A(F.properties,A.EMPTY_OBJECT);for(let b in g)g.hasOwnProperty(b)&&(f(a[b])||(a[b]=new Array(s)))}for(let L=0;L<s;L++){let F=r[L];for(let g in a)if(a.hasOwnProperty(g)){let b=A(F.properties[g],"");a[g][L]=b}}let c=new jp({count:s,properties:a}),u=[new Uc({id:0,count:s,jsonMetadataTable:c})],d=new Xd({}),h=new Ea({schema:d,propertyTables:u}),_=new m(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),y=new m(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),p=!1,C=!1;for(let L=0;L<s;L++){let F=r[L];if(f(F.lines)){p=!0;let g=F.lines.length;for(let b=0;b<g;b++){let v=F.lines[b],P=v.length;for(let R=0;R<P;R++)m.minimumByComponent(_,v[R],_),m.maximumByComponent(y,v[R],y)}}if(f(F.points)){C=!0;let g=F.points.length;for(let b=0;b<g;b++){let v=F.points[b];m.minimumByComponent(_,v,_),m.maximumByComponent(y,v,y)}}}let x=m.midpoint(_,y,new m),T=m.fromDegrees(x.x,x.y,x.z,oe.WGS84,new m),E=vt.eastNorthUpToFixedFrame(T,oe.WGS84,new N),S=N.inverseTransformation(E,new N),w=[];p&&w.push(CIe(r,S,n)),C&&w.push(xIe(r,S,n));let D=new It.Node;D.index=0,D.primitives=w;let I=[D],O=new It.Scene;O.nodes=I;let M=new It.Components;return M.scene=O,M.nodes=I,M.transform=E,M.structuralMetadata=h,M}c_.prototype.unload=function(){this._components=void 0};var yR=c_;var AR={};AR._deprecationWarning=ws;var l_=Uint32Array.BYTES_PER_ELEMENT;AR.parse=function(t,n){let i=A(n,0);n=i;let o=new Uint8Array(t),r=new DataView(t);n+=l_;let s=r.getUint32(n,!0);if(s!==1)throw new he(`Only Instanced 3D Model version 1 is supported. Version ${s} is not.`);n+=l_;let a=r.getUint32(n,!0);n+=l_;let c=r.getUint32(n,!0);if(c===0)throw new he("featureTableJsonByteLength is zero, the feature table must be defined.");n+=l_;let l=r.getUint32(n,!0);n+=l_;let u=r.getUint32(n,!0);n+=l_;let d=r.getUint32(n,!0);n+=l_;let h=r.getUint32(n,!0);if(h!==1&&h!==0)throw new he(`Only glTF format 0 (uri) or 1 (embedded) are supported. Format ${h} is not.`);n+=l_;let _=Ko(o,n,c);n+=c;let y=new Uint8Array(t,n,l);n+=l;let p,C;u>0&&(p=Ko(o,n,u),n+=u,d>0&&(C=new Uint8Array(t,n,d),C=new Uint8Array(C),n+=d));let x=i+a-n;if(x===0)throw new he("glTF byte length must be greater than 0.");let T;return n%4===0?T=new Uint8Array(t,n,x):(AR._deprecationWarning("i3dm-glb-unaligned","The embedded glb is not aligned to a 4-byte boundary."),T=new Uint8Array(o.subarray(n,n+x))),{gltfFormat:h,featureTableJson:_,featureTableBinary:y,batchTableJson:p,batchTableBinary:C,gltf:T}};var CR=AR;var If={NOT_LOADED:0,LOADING:1,PROCESSING:2,POST_PROCESSING:3,READY:4,FAILED:5,UNLOADED:6},xR=It.Attribute,EIe=It.FeatureIdAttribute,CQ=It.Instances;function Sm(t){t=A(t,A.EMPTY_OBJECT);let n=t.i3dmResource,i=t.arrayBuffer,o=t.baseResource,r=A(t.byteOffset,0),s=A(t.releaseGltfJson,!1),a=A(t.asynchronous,!0),c=A(t.incrementallyLoadTextures,!0),l=A(t.upAxis,vo.Y),u=A(t.forwardAxis,vo.X),d=A(t.loadAttributesAsTypedArray,!1),h=A(t.loadIndicesForWireframe,!1),_=A(t.loadPrimitiveOutline,!0);o=f(o)?o:n.clone(),this._i3dmResource=n,this._baseResource=o,this._arrayBuffer=i,this._byteOffset=r,this._releaseGltfJson=s,this._asynchronous=a,this._incrementallyLoadTextures=c,this._upAxis=l,this._forwardAxis=u,this._loadAttributesAsTypedArray=d,this._loadIndicesForWireframe=h,this._loadPrimitiveOutline=_,this._state=If.NOT_LOADED,this._promise=void 0,this._gltfLoader=void 0,this._gltfLoaderPromise=void 0,this._process=function(y,p){},this._postProcess=function(y,p){},this._buffers=[],this._components=void 0,this._transform=N.IDENTITY,this._batchTable=void 0,this._featureTable=void 0,this._instancesLength=0}f(Object.create)&&(Sm.prototype=Object.create(eo.prototype),Sm.prototype.constructor=Sm);Object.defineProperties(Sm.prototype,{promise:{get:function(){return this._promise}},texturesLoadedPromise:{get:function(){return this._gltfLoader.texturesLoadedPromise}},cacheKey:{get:function(){}},components:{get:function(){return this._components}}});Sm.prototype.load=function(){let t=CR.parse(this._arrayBuffer,this._byteOffset),n=t.featureTableJson,i=t.featureTableBinary,o=t.batchTableJson,r=t.batchTableBinary,s=t.gltfFormat,a=new Zd(n,i);this._featureTable=a;let c=a.getGlobalProperty("INSTANCES_LENGTH");if(a.featuresLength=c,!f(c))throw new he("Feature table global property: INSTANCES_LENGTH must be defined");this._instancesLength=c;let l=a.getGlobalProperty("RTC_CENTER",J.FLOAT,3);f(l)&&(this._transform=N.fromTranslation(m.fromArray(l))),this._batchTable={json:o,binary:r};let u={upAxis:this._upAxis,forwardAxis:this._forwardAxis,releaseGltfJson:this._releaseGltfJson,incrementallyLoadTextures:this._incrementallyLoadTextures,loadAttributesAsTypedArray:this._loadAttributesAsTypedArray,loadIndicesForWireframe:this._loadIndicesForWireframe,loadPrimitiveOutline:this._loadPrimitiveOutline};if(s===0){let y=bl(t.gltf);y=y.replace(/[\s\0]+$/,"");let p=this._baseResource.getDerivedResource({url:y});u.gltfResource=p,u.baseResource=p}else u.gltfResource=this._i3dmResource,u.typedArray=t.gltf;let d=new i_(u);this._gltfLoader=d,this._state=If.LOADING,d.load();let h=this,_=new Promise(function(y){h._process=function(p,C){p._gltfLoader.process(C)},h._postProcess=function(p,C){let T=p._gltfLoader.components;T.transform=N.multiplyTransformation(p._transform,T.transform,T.transform),DIe(p,T,C),SIe(p,T),p._components=T,p._arrayBuffer=void 0,p._state=If.READY,y(p)}});return this._promise=d.promise.then(function(){if(!h.isDestroyed())return h._state=If.POST_PROCESSING,_}).catch(function(y){if(!h.isDestroyed())return bIe(h,y)}),this._promise};function bIe(t,n){t.unload(),t._state=If.FAILED;let i="Failed to load i3dm";return n=t.getError(i,n),Promise.reject(n)}Sm.prototype.process=function(t){this._state===If.LOADING&&(this._state=If.PROCESSING),this._state===If.PROCESSING&&this._process(this,t),this._state===If.POST_PROCESSING&&this._postProcess(this,t)};function SIe(t,n){let i=t._batchTable,o=t._instancesLength;if(o===0)return;let r;if(f(i.json))r=s_({count:o,batchTable:i.json,binaryBody:i.binary});else{let s=new Uc({name:Yd.BATCH_TABLE_CLASS_NAME,count:o});r=new Ea({schema:{},propertyTables:[s]})}n.structuralMetadata=r}var TR=new m,eG=new Array(4),wIe=new N;function DIe(t,n,i){let o,r=t._featureTable,s=t._instancesLength;if(s===0)return;let a=r.getGlobalProperty("RTC_CENTER",J.FLOAT,3),c=r.getGlobalProperty("EAST_NORTH_UP"),l=r.hasProperty("NORMAL_UP")||r.hasProperty("NORMAL_UP_OCT32P")||c,u=r.hasProperty("SCALE")||r.hasProperty("SCALE_NON_UNIFORM"),d=PIe(r,s),h;l&&(h=new Float32Array(4*s));let _;u&&(_=new Float32Array(3*s));let y=new Float32Array(s),p=m.unpackArray(d),C=new m,x=new m,T=new m,E=new m,S=new $,w=new Me,D=new Array(4),I=new m,O=new Array(3),M=new N;if(!f(a)){let U=ae.fromPoints(p);for(o=0;o<p.length;o++)m.subtract(p[o],U.center,TR),d[3*o+0]=TR.x,d[3*o+1]=TR.y,d[3*o+2]=TR.z;let G=N.fromTranslation(U.center,wIe);n.transform=N.multiplyTransformation(G,n.transform,n.transform)}for(o=0;o<s;o++){C=m.clone(p[o]),f(a)&&m.add(C,m.unpack(a),C),l&&(IIe(r,c,o,w,C,T,x,E,S,M),Me.pack(w,D,0),h[4*o+0]=D[0],h[4*o+1]=D[1],h[4*o+2]=D[2],h[4*o+3]=D[3]),u&&(BIe(r,o,I),m.pack(I,O,0),_[3*o+0]=O[0],_[3*o+1]=O[1],_[3*o+2]=O[2]);let U=r.getProperty("BATCH_ID",J.UNSIGNED_SHORT,1,o);f(U)||(U=o),y[o]=U}let L=new CQ;L.transformInWorldSpace=!0;let F=t._buffers,g=new xR;if(g.name="Instance Translation",g.semantic=Gr.TRANSLATION,g.componentDatatype=J.FLOAT,g.type=nn.VEC3,g.count=s,g.typedArray=d,!l){let U=ut.createVertexBuffer({context:i.context,typedArray:d,usage:Fe.STATIC_DRAW});U.vertexArrayDestroyable=!1,F.push(U),g.buffer=U}if(L.attributes.push(g),l){let U=new xR;U.name="Instance Rotation",U.semantic=Gr.ROTATION,U.componentDatatype=J.FLOAT,U.type=nn.VEC4,U.count=s,U.typedArray=h,L.attributes.push(U)}if(u){let U=new xR;if(U.name="Instance Scale",U.semantic=Gr.SCALE,U.componentDatatype=J.FLOAT,U.type=nn.VEC3,U.count=s,l)U.typedArray=_;else{let G=ut.createVertexBuffer({context:i.context,typedArray:_,usage:Fe.STATIC_DRAW});G.vertexArrayDestroyable=!1,F.push(G),U.buffer=G}L.attributes.push(U)}let b=new xR;b.name="Instance Feature ID",b.setIndex=0,b.semantic=Gr.FEATURE_ID,b.componentDatatype=J.FLOAT,b.type=nn.SCALAR,b.count=s;let v=ut.createVertexBuffer({context:i.context,typedArray:y,usage:Fe.STATIC_DRAW});v.vertexArrayDestroyable=!1,F.push(v),b.buffer=v,L.attributes.push(b);let P=new EIe;P.propertyTableId=0,P.setIndex=0,P.positionalLabel="instanceFeatureId_0",L.featureIds.push(P);let R=n.nodes,V=R.length,H=!1;for(o=0;o<V;o++){let U=R[o];U.primitives.length>0&&(U.instances=H?vIe(L):L,H=!0)}}function vIe(t){let n=new CQ;n.transformInWorldSpace=t.transformInWorldSpace;let i=t.attributes,o=i.length;for(let r=0;r<o;r++){let s=tt(i[r],!1);n.attributes.push(s)}return n.featureIds=t.featureIds,n}function PIe(t,n){if(t.hasProperty("POSITION"))return t.getPropertyArray("POSITION",J.FLOAT,3);if(t.hasProperty("POSITION_QUANTIZED")){let i=t.getPropertyArray("POSITION_QUANTIZED",J.UNSIGNED_SHORT,3),o=t.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",J.FLOAT,3);if(!f(o))throw new he("Global property: QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");let r=t.getGlobalProperty("QUANTIZED_VOLUME_SCALE",J.FLOAT,3);if(!f(r))throw new he("Global property: QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");let s=new Float32Array(i.length);for(let a=0;a<i.length/3;a++)for(let c=0;c<3;c++){let l=3*a+c;s[l]=i[l]/65535*r[c]+o[c]}return s}else throw new he("Either POSITION or POSITION_QUANTIZED must be defined for each instance.")}var AQ=new Array(4);function IIe(t,n,i,o,r,s,a,c,l,u){let d=t.getProperty("NORMAL_UP",J.FLOAT,3,i,eG),h=t.getProperty("NORMAL_RIGHT",J.FLOAT,3,i,AQ),_=!1;if(f(d)){if(!f(h))throw new he("To define a custom orientation, both NORMAL_UP and NORMAL_RIGHT must be defined.");m.unpack(d,0,s),m.unpack(h,0,a),_=!0}else{let y=t.getProperty("NORMAL_UP_OCT32P",J.UNSIGNED_SHORT,2,i,eG),p=t.getProperty("NORMAL_RIGHT_OCT32P",J.UNSIGNED_SHORT,2,i,AQ);if(f(y)){if(!f(p))throw new he("To define a custom orientation with oct-encoded vectors, both NORMAL_UP_OCT32P and NORMAL_RIGHT_OCT32P must be defined.");zn.octDecodeInRange(y[0],y[1],65535,s),zn.octDecodeInRange(p[0],p[1],65535,a),_=!0}else n?(vt.eastNorthUpToFixedFrame(r,oe.WGS84,u),N.getMatrix3(u,l)):$.clone($.IDENTITY,l)}_&&(m.cross(a,s,c),m.normalize(c,c),$.setColumn(l,0,a,l),$.setColumn(l,1,s,l),$.setColumn(l,2,c,l)),Me.fromRotationMatrix(l,o)}function BIe(t,n,i){i=m.fromElements(1,1,1,i);let o=t.getProperty("SCALE",J.FLOAT,1,n);f(o)&&m.multiplyByScalar(i,o,i);let r=t.getProperty("SCALE_NON_UNIFORM",J.FLOAT,3,n,eG);f(r)&&(i.x*=r[0],i.y*=r[1],i.z*=r[2])}function OIe(t){let n=t._buffers,i=n.length;for(let o=0;o<i;o++){let r=n[o];r.isDestroyed()||r.destroy()}n.length=0}Sm.prototype.isUnloaded=function(){return this._state===If.UNLOADED};Sm.prototype.unload=function(){f(this._gltfLoader)&&this._gltfLoader.unload(),OIe(this),this._components=void 0,this._arrayBuffer=void 0,this._state=If.UNLOADED};var ER=Sm;var RIe={NONE:0,REPEAT:1,MIRRORED_REPEAT:2},ac=Object.freeze(RIe);var MIe={STOPPED:0,ANIMATING:1},Qd=Object.freeze(MIe);function qC(){this.times=void 0,this.points=void 0,Ce.throwInstantiationError()}qC.getPointType=function(t){if(typeof t=="number")return Number;if(t instanceof m)return m;if(t instanceof Me)return Me};qC.prototype.evaluate=Ce.throwInstantiationError;qC.prototype.findTimeInterval=function(t,n){let i=this.times,o=i.length;if(n=A(n,0),t>=i[n]){if(n+1<o&&t<i[n+1])return n;if(n+2<o&&t<i[n+2])return n+1}else if(n-1>=0&&t>=i[n-1])return n-1;let r;if(t>i[n])for(r=n;r<o-1&&!(t>=i[r]&&t<i[r+1]);++r);else for(r=n-1;r>=0&&!(t>=i[r]&&t<i[r+1]);--r);return r===o-1&&(r=o-2),r};qC.prototype.wrapTime=function(t){let n=this.times,i=n[n.length-1],o=n[0],r=i-o,s;return t<o&&(s=Math.floor((o-t)/r)+1,t+=s*r),t>i&&(s=Math.floor((t-i)/r)+1,t-=s*r),t};qC.prototype.clampTime=function(t){let n=this.times;return B.clamp(t,n[0],n[n.length-1])};var to=qC;function YC(t){this._value=t,this._valueType=to.getPointType(t)}Object.defineProperties(YC.prototype,{value:{get:function(){return this._value}}});YC.prototype.findTimeInterval=function(t){};YC.prototype.wrapTime=function(t){return 0};YC.prototype.clampTime=function(t){return 0};YC.prototype.evaluate=function(t,n){let i=this._value,o=this._valueType;return o===Number?i:o.clone(i,n)};var bR=YC;function XC(t){t=A(t,A.EMPTY_OBJECT);let n=t.points,i=t.times;this._times=i,this._points=n,this._pointType=to.getPointType(n[0]),this._lastTimeIndex=0}Object.defineProperties(XC.prototype,{times:{get:function(){return this._times}},points:{get:function(){return this._points}}});XC.prototype.findTimeInterval=to.prototype.findTimeInterval;XC.prototype.wrapTime=to.prototype.wrapTime;XC.prototype.clampTime=to.prototype.clampTime;XC.prototype.evaluate=function(t,n){let i=this.points,o=this.times,r=this._lastTimeIndex=this.findTimeInterval(t,this._lastTimeIndex),s=(t-o[r])/(o[r+1]-o[r]);return this._pointType===Number?(1-s)*i[r]+s*i[r+1]:(f(n)||(n=new m),m.lerp(i[r],i[r+1],s,n))};var F0=XC;var xQ={};xQ.solve=function(t,n,i,o){let r=new Array(i.length),s=new Array(o.length),a=new Array(o.length),c;for(c=0;c<s.length;c++)s[c]=new m,a[c]=new m;r[0]=i[0]/n[0],s[0]=m.multiplyByScalar(o[0],1/n[0],s[0]);let l;for(c=1;c<r.length;++c)l=1/(n[c]-r[c-1]*t[c-1]),r[c]=i[c]*l,s[c]=m.subtract(o[c],m.multiplyByScalar(s[c-1],t[c-1],s[c]),s[c]),s[c]=m.multiplyByScalar(s[c],l,s[c]);for(l=1/(n[c]-r[c-1]*t[c-1]),s[c]=m.subtract(o[c],m.multiplyByScalar(s[c-1],t[c-1],s[c]),s[c]),s[c]=m.multiplyByScalar(s[c],l,s[c]),a[a.length-1]=s[s.length-1],c=a.length-2;c>=0;--c)a[c]=m.subtract(s[c],m.multiplyByScalar(a[c+1],r[c],a[c]),a[c]);return a};var fS=xQ;var TQ=[],EQ=[],bQ=[],SQ=[];function LIe(t,n,i){let o=TQ,r=bQ,s=EQ,a=SQ;o.length=r.length=t.length-1,s.length=a.length=t.length;let c;o[0]=s[0]=1,r[0]=0;let l=a[0];for(f(l)||(l=a[0]=new m),m.clone(n,l),c=1;c<o.length-1;++c)o[c]=r[c]=1,s[c]=4,l=a[c],f(l)||(l=a[c]=new m),m.subtract(t[c+1],t[c-1],l),m.multiplyByScalar(l,3,l);return o[c]=0,r[c]=1,s[c]=4,l=a[c],f(l)||(l=a[c]=new m),m.subtract(t[c+1],t[c-1],l),m.multiplyByScalar(l,3,l),s[c+1]=1,l=a[c+1],f(l)||(l=a[c+1]=new m),m.clone(i,l),fS.solve(o,s,r,a)}function FIe(t){let n=TQ,i=bQ,o=EQ,r=SQ;n.length=i.length=t.length-1,o.length=r.length=t.length;let s;n[0]=i[0]=1,o[0]=2;let a=r[0];for(f(a)||(a=r[0]=new m),m.subtract(t[1],t[0],a),m.multiplyByScalar(a,3,a),s=1;s<n.length;++s)n[s]=i[s]=1,o[s]=4,a=r[s],f(a)||(a=r[s]=new m),m.subtract(t[s+1],t[s-1],a),m.multiplyByScalar(a,3,a);return o[s]=2,a=r[s],f(a)||(a=r[s]=new m),m.subtract(t[s],t[s-1],a),m.multiplyByScalar(a,3,a),fS.solve(n,o,i,r)}function jc(t){t=A(t,A.EMPTY_OBJECT);let n=t.points,i=t.times,o=t.inTangents,r=t.outTangents;this._times=i,this._points=n,this._pointType=to.getPointType(n[0]),this._inTangents=o,this._outTangents=r,this._lastTimeIndex=0}Object.defineProperties(jc.prototype,{times:{get:function(){return this._times}},points:{get:function(){return this._points}},inTangents:{get:function(){return this._inTangents}},outTangents:{get:function(){return this._outTangents}}});jc.createC1=function(t){t=A(t,A.EMPTY_OBJECT);let n=t.times,i=t.points,o=t.tangents,r=o.slice(0,o.length-1),s=o.slice(1,o.length);return new jc({times:n,points:i,inTangents:s,outTangents:r})};jc.createNaturalCubic=function(t){t=A(t,A.EMPTY_OBJECT);let n=t.times,i=t.points;if(i.length<3)return new F0({points:i,times:n});let o=FIe(i),r=o.slice(0,o.length-1),s=o.slice(1,o.length);return new jc({times:n,points:i,inTangents:s,outTangents:r})};jc.createClampedCubic=function(t){t=A(t,A.EMPTY_OBJECT);let n=t.times,i=t.points,o=t.firstTangent,r=t.lastTangent,s=to.getPointType(i[0]);if(i.length<3)return new F0({points:i,times:n});let a=LIe(i,o,r),c=a.slice(0,a.length-1),l=a.slice(1,a.length);return new jc({times:n,points:i,inTangents:l,outTangents:c})};jc.hermiteCoefficientMatrix=new N(2,-3,0,1,-2,3,0,0,1,-2,1,0,1,-1,0,0);jc.prototype.findTimeInterval=to.prototype.findTimeInterval;var NIe=new se,KC=new m;jc.prototype.wrapTime=to.prototype.wrapTime;jc.prototype.clampTime=to.prototype.clampTime;jc.prototype.evaluate=function(t,n){let i=this.points,o=this.times,r=this.inTangents,s=this.outTangents;this._lastTimeIndex=this.findTimeInterval(t,this._lastTimeIndex);let a=this._lastTimeIndex,c=o[a+1]-o[a],l=(t-o[a])/c,u=NIe;u.z=l,u.y=l*l,u.x=u.y*l,u.w=1;let d=N.multiplyByVector(jc.hermiteCoefficientMatrix,u,u);d.z*=c,d.w*=c;let h=this._pointType;return h===Number?i[a]*d.x+i[a+1]*d.y+s[a]*d.z+r[a]*d.w:(f(n)||(n=new h),n=h.multiplyByScalar(i[a],d.x,n),h.multiplyByScalar(i[a+1],d.y,KC),h.add(n,KC,n),h.multiplyByScalar(s[a],d.z,KC),h.add(n,KC,n),h.multiplyByScalar(r[a],d.w,KC),h.add(n,KC,n))};var N0=jc;function JC(t){t=A(t,A.EMPTY_OBJECT);let n=t.points,i=t.times;this._times=i,this._points=n,this._pointType=to.getPointType(n[0]),this._lastTimeIndex=0}Object.defineProperties(JC.prototype,{times:{get:function(){return this._times}},points:{get:function(){return this._points}}});JC.prototype.findTimeInterval=to.prototype.findTimeInterval;JC.prototype.wrapTime=to.prototype.wrapTime;JC.prototype.clampTime=to.prototype.clampTime;JC.prototype.evaluate=function(t,n){let i=this.points;this._lastTimeIndex=this.findTimeInterval(t,this._lastTimeIndex);let o=this._lastTimeIndex,r=this._pointType;return r===Number?i[o]:(f(n)||(n=new r),r.clone(i[o],n))};var SR=JC;function VIe(t){let n=t.points,i=t.times;return function(o,r){f(r)||(r=new Me);let s=t._lastTimeIndex=t.findTimeInterval(o,t._lastTimeIndex),a=(o-i[s])/(i[s+1]-i[s]),c=n[s],l=n[s+1];return Me.fastSlerp(c,l,a,r)}}function ZC(t){t=A(t,A.EMPTY_OBJECT);let n=t.points,i=t.times;this._times=i,this._points=n,this._evaluateFunction=VIe(this),this._lastTimeIndex=0}Object.defineProperties(ZC.prototype,{times:{get:function(){return this._times}},points:{get:function(){return this._points}}});ZC.prototype.findTimeInterval=to.prototype.findTimeInterval;ZC.prototype.wrapTime=to.prototype.wrapTime;ZC.prototype.clampTime=to.prototype.clampTime;ZC.prototype.evaluate=function(t,n){return this._evaluateFunction(t,n)};var wR=ZC;var V0=It.AnimatedPropertyType;function nG(t){t=A(t,A.EMPTY_OBJECT);let n=t.channel,i=t.runtimeAnimation,o=t.runtimeNode;this._channel=n,this._runtimeAnimation=i,this._runtimeNode=o,this._splines=[],this._path=void 0,zIe(this)}Object.defineProperties(nG.prototype,{channel:{get:function(){return this._channel}},runtimeAnimation:{get:function(){return this._runtimeAnimation}},runtimeNode:{get:function(){return this._runtimeNode}},splines:{get:function(){return this._splines}}});function kIe(t,n){let i=[],o=[],r=[],s=n.length;for(let a=0;a<s;a+=3)o.push(n[a]),i.push(n[a+1]),r.push(n[a+2]);return o.splice(0,1),r.length=r.length-1,new N0({times:t,points:i,inTangents:o,outTangents:r})}function wQ(t,n,i,o){if(t.length===1&&n.length===1)return new bR(n[0]);switch(i){case Gd.STEP:return new SR({times:t,points:n});case Gd.CUBICSPLINE:return kIe(t,n);case Gd.LINEAR:return o===V0.ROTATION?new wR({times:t,points:n}):new F0({times:t,points:n})}}function UIe(t,n,i,o,r){let s=[];if(o===V0.WEIGHTS){let c=n.length/r,l,u;for(l=0;l<r;l++){let d=new Array(c),h=l;if(i===Gd.CUBICSPLINE)for(u=0;u<c;u+=3)d[u]=n[h],d[u+1]=n[h+r],d[u+2]=n[h+2*r],h+=r*3;else for(u=0;u<c;u++)d[u]=n[h],h+=r;s.push(wQ(t,d,i,o))}}else s.push(wQ(t,n,i,o));return s}var tG;function zIe(t){let n=t._channel,i=n.sampler,o=i.input,r=i.output,s=i.interpolation,c=n.target.path,l=t._runtimeNode,u=f(l.morphWeights)?l.morphWeights.length:1,d=UIe(o,r,s,c,u);switch(t._splines=d,t._path=c,c){case V0.TRANSLATION:case V0.SCALE:tG=new m;break;case V0.ROTATION:tG=new Me;break;case V0.WEIGHTS:break}}nG.prototype.animate=function(t){let n=this._splines,i=this._path,o=this._runtimeAnimation.model,r=this._runtimeNode;if(i===V0.WEIGHTS){let s=r.morphWeights,a=s.length;for(let c=0;c<a;c++){let l=n[c],u=o.clampAnimations?l.clampTime(t):l.wrapTime(t);s[c]=l.evaluate(u)}}else{if(r.userAnimated)return;{let s=n[0],a=o.clampAnimations?s.clampTime(t):s.wrapTime(t);r[i]=s.evaluate(a,tG)}}};var DR=nG;function iG(t,n,i){this._animation=n,this._name=n.name,this._runtimeChannels=void 0,this._startTime=te.clone(i.startTime),this._delay=A(i.delay,0),this._stopTime=te.clone(i.stopTime),this.removeOnStop=A(i.removeOnStop,!1),this._multiplier=A(i.multiplier,1),this._reverse=A(i.reverse,!1),this._loop=A(i.loop,ac.NONE),this._animationTime=i.animationTime,this._prevAnimationDelta=void 0,this.start=new Ae,this.update=new Ae,this.stop=new Ae,this._state=Qd.STOPPED,this._computedStartTime=void 0,this._duration=void 0;let o=this;this._raiseStartEvent=function(){o.start.raiseEvent(t,o)},this._updateEventTime=0,this._raiseUpdateEvent=function(){o.update.raiseEvent(t,o,o._updateEventTime)},this._raiseStopEvent=function(){o.stop.raiseEvent(t,o)},this._model=t,this._localStartTime=void 0,this._localStopTime=void 0,HIe(this)}Object.defineProperties(iG.prototype,{animation:{get:function(){return this._animation}},name:{get:function(){return this._name}},runtimeChannels:{get:function(){return this._runtimeChannels}},model:{get:function(){return this._model}},localStartTime:{get:function(){return this._localStartTime}},localStopTime:{get:function(){return this._localStopTime}},startTime:{get:function(){return this._startTime}},delay:{get:function(){return this._delay}},stopTime:{get:function(){return this._stopTime}},multiplier:{get:function(){return this._multiplier}},reverse:{get:function(){return this._reverse}},loop:{get:function(){return this._loop}},animationTime:{get:function(){return this._animationTime}}});function HIe(t){let n=Number.MAX_VALUE,i=-Number.MAX_VALUE,o=t._model.sceneGraph,s=t._animation.channels,a=s.length,c=[];for(let l=0;l<a;l++){let u=s[l],d=u.target;if(!f(d))continue;let h=d.node.index,_=o._runtimeNodes[h],y=new DR({channel:u,runtimeAnimation:t,runtimeNode:_}),p=u.sampler.input;n=Math.min(n,p[0]),i=Math.max(i,p[p.length-1]),c.push(y)}t._runtimeChannels=c,t._localStartTime=n,t._localStopTime=i}iG.prototype.animate=function(t){let n=this._runtimeChannels,i=n.length;for(let o=0;o<i;o++)n[o].animate(t)};var vR=iG;function wm(t){this.animationAdded=new Ae,this.animationRemoved=new Ae,this.animateWhilePaused=!1,this._model=t,this._runtimeAnimations=[],this._previousTime=void 0}Object.defineProperties(wm.prototype,{length:{get:function(){return this._runtimeAnimations.length}},model:{get:function(){return this._model}}});function oG(t,n,i){let o=t._model,r=new vR(o,n,i);return t._runtimeAnimations.push(r),t.animationAdded.raiseEvent(o,r),r}wm.prototype.add=function(t){t=A(t,A.EMPTY_OBJECT);let i=this._model.sceneGraph.components.animations,o=t.index;if(f(o))return oG(this,i[o],t);let r=i.length;for(let s=0;s<r;++s)if(i[s].name===t.name){o=s;break}return oG(this,i[o],t)};wm.prototype.addAll=function(t){t=A(t,A.EMPTY_OBJECT);let i=this._model.sceneGraph.components.animations,o=[],r=i.length;for(let s=0;s<r;++s){let a=oG(this,i[s],t);o.push(a)}return o};wm.prototype.remove=function(t){if(!f(t))return!1;let n=this._runtimeAnimations,i=n.indexOf(t);return i!==-1?(n.splice(i,1),this.animationRemoved.raiseEvent(this._model,t),!0):!1};wm.prototype.removeAll=function(){let t=this._model,n=this._runtimeAnimations,i=n.length;this._runtimeAnimations.length=0;for(let o=0;o<i;++o)this.animationRemoved.raiseEvent(t,n[o])};wm.prototype.contains=function(t){return f(t)?this._runtimeAnimations.indexOf(t)!==-1:!1};wm.prototype.get=function(t){return this._runtimeAnimations[t]};var PR=[];function GIe(t,n,i){return function(){t.animationRemoved.raiseEvent(n,i)}}wm.prototype.update=function(t){let n=this._runtimeAnimations,i=n.length;if(i===0)return this._previousTime=void 0,!1;if(!this.animateWhilePaused&&te.equals(t.time,this._previousTime))return!1;this._previousTime=te.clone(t.time,this._previousTime);let o=!1,r=t.time,s=this._model;for(let a=0;a<i;++a){let c=n[a];f(c._computedStartTime)||(c._computedStartTime=te.addSeconds(A(c.startTime,r),c.delay,new te)),f(c._duration)||(c._duration=c.localStopTime*(1/c.multiplier));let l=c._computedStartTime,u=c._duration,d=c.stopTime,h=te.lessThanOrEquals(l,r),_=f(d)&&te.greaterThan(r,d),y=0;if(u!==0){let x=te.secondsDifference(_?d:r,l);y=f(c._animationTime)?c._animationTime(u,x):x/u}let p=c.loop===ac.REPEAT||c.loop===ac.MIRRORED_REPEAT,C=(h||p&&!f(c.startTime))&&(y<=1||p)&&!_;if(y===c._prevAnimationDelta){let x=c._state===Qd.STOPPED;if(C!==x)continue}if(c._prevAnimationDelta=y,C||c._state===Qd.ANIMATING){if(C&&c._state===Qd.STOPPED&&(c._state=Qd.ANIMATING,c.start.numberOfListeners>0&&t.afterRender.push(c._raiseStartEvent)),c.loop===ac.REPEAT)y=y-Math.floor(y);else if(c.loop===ac.MIRRORED_REPEAT){let T=Math.floor(y),E=y-T;y=T%2===1?1-E:E}c.reverse&&(y=1-y);let x=y*u*c.multiplier;x=B.clamp(x,c.localStartTime,c.localStopTime),c.animate(x),c.update.numberOfListeners>0&&(c._updateEventTime=x,t.afterRender.push(c._raiseUpdateEvent)),o=!0,C||(c._state=Qd.STOPPED,c.stop.numberOfListeners>0&&t.afterRender.push(c._raiseStopEvent),c.removeOnStop&&PR.push(c))}}i=PR.length;for(let a=0;a<i;++a){let c=PR[a];n.splice(n.indexOf(c),1),t.afterRender.push(GIe(this,s,c))}return PR.length=0,o};var IR=wm;function va(t){this._id=Bn();let n=t.featuresLength;this._showAlphaProperties=void 0,this._batchValues=void 0,this._batchValuesDirty=!1,this._batchTexture=void 0,this._defaultTexture=void 0,this._pickTexture=void 0,this._pickIds=[];let i,o;if(n>0){let r=Math.min(n,Ut.maximumTextureSize),s=Math.ceil(n/Ut.maximumTextureSize),a=1/r,c=a*.5,l=1/s,u=l*.5;i=new W(r,s),o=new se(a,c,l,u)}this._translucentFeaturesLength=0,this._featuresLength=n,this._textureDimensions=i,this._textureStep=o,this._owner=t.owner,this._statistics=t.statistics,this._colorChangedCallback=t.colorChangedCallback}Object.defineProperties(va.prototype,{translucentFeaturesLength:{get:function(){return this._translucentFeaturesLength}},byteLength:{get:function(){let t=0;return f(this._pickTexture)&&(t+=this._pickTexture.sizeInBytes),f(this._batchTexture)&&(t+=this._batchTexture.sizeInBytes),t}},textureDimensions:{get:function(){return this._textureDimensions}},textureStep:{get:function(){return this._textureStep}},batchTexture:{get:function(){return this._batchTexture}},defaultTexture:{get:function(){return this._defaultTexture}},pickTexture:{get:function(){return this._pickTexture}}});va.DEFAULT_COLOR_VALUE=z.WHITE;va.DEFAULT_SHOW_VALUE=!0;function DQ(t){let n=t._textureDimensions;return n.x*n.y*4}function vQ(t){if(!f(t._batchValues)){let n=DQ(t),i=new Uint8Array(n).fill(255);t._batchValues=i}return t._batchValues}function PQ(t){if(!f(t._showAlphaProperties)){let n=2*t._featuresLength,i=new Uint8Array(n).fill(255);t._showAlphaProperties=i}return t._showAlphaProperties}va.prototype.setShow=function(t,n){if(n&&!f(this._showAlphaProperties))return;let i=PQ(this),o=t*2,r=n?255:0;if(i[o]!==r){i[o]=r;let s=vQ(this),a=t*4+3;s[a]=n?i[o+1]:0,this._batchValuesDirty=!0}};va.prototype.setAllShow=function(t){let n=this._featuresLength;for(let i=0;i<n;++i)this.setShow(i,t)};va.prototype.getShow=function(t){if(!f(this._showAlphaProperties))return!0;let n=t*2;return this._showAlphaProperties[n]===255};var WIe=new Array(4);va.prototype.setColor=function(t,n){if(z.equals(n,va.DEFAULT_COLOR_VALUE)&&!f(this._batchValues))return;let i=n.toBytes(WIe),o=i[3],r=vQ(this),s=t*4,a=PQ(this),c=t*2;if(r[s]!==i[0]||r[s+1]!==i[1]||r[s+2]!==i[2]||a[c+1]!==o){r[s]=i[0],r[s+1]=i[1],r[s+2]=i[2];let l=a[c+1]!==255,u=a[c]!==0;r[s+3]=u?o:0,a[c+1]=o;let d=o!==255;d&&!l?++this._translucentFeaturesLength:!d&&l&&--this._translucentFeaturesLength,this._batchValuesDirty=!0,f(this._colorChangedCallback)&&this._colorChangedCallback(t,n)}};va.prototype.setAllColor=function(t){let n=this._featuresLength;for(let i=0;i<n;++i)this.setColor(i,t)};va.prototype.getColor=function(t,n){if(!f(this._batchValues))return z.clone(va.DEFAULT_COLOR_VALUE,n);let i=this._batchValues,o=t*4,r=this._showAlphaProperties,s=t*2;return z.fromBytes(i[o],i[o+1],i[o+2],r[s+1],n)};va.prototype.getPickColor=function(t){return this._pickIds[t]};function IQ(t,n,i){let o=t._textureDimensions;return new St({context:n,pixelFormat:st.RGBA,pixelDatatype:je.UNSIGNED_BYTE,source:{width:o.x,height:o.y,arrayBufferView:i},flipY:!1,sampler:pn.NEAREST})}function jIe(t,n){let i=t._featuresLength;if(!f(t._pickTexture)&&i>0){let o=t._pickIds,r=DQ(t),s=new Uint8Array(r),a=t._owner,c=t._statistics;for(let l=0;l<i;++l){let u=n.createPickId(a.getFeature(l));o.push(u);let d=u.color,h=l*4;s[h]=z.floatToByte(d.red),s[h+1]=z.floatToByte(d.green),s[h+2]=z.floatToByte(d.blue),s[h+3]=z.floatToByte(d.alpha)}t._pickTexture=IQ(t,n,s),f(c)&&(c.batchTableByteLength+=t._pickTexture.sizeInBytes)}}function qIe(t){let n=t._textureDimensions;t._batchTexture.copyFrom({source:{width:n.x,height:n.y,arrayBufferView:t._batchValues}})}va.prototype.update=function(t,n){let i=n.context;this._defaultTexture=i.defaultTexture;let o=n.passes;(o.pick||o.postProcess)&&jIe(this,i),this._batchValuesDirty&&(this._batchValuesDirty=!1,f(this._batchTexture)||(this._batchTexture=IQ(this,i,this._batchValues),f(this._statistics)&&(this._statistics.batchTableByteLength+=this._batchTexture.sizeInBytes)),qIe(this))};va.prototype.isDestroyed=function(){return!1};va.prototype.destroy=function(){this._batchTexture=this._batchTexture&&this._batchTexture.destroy(),this._pickTexture=this._pickTexture&&this._pickTexture.destroy();let t=this._pickIds,n=t.length;for(let i=0;i<n;++i)t[i].destroy();return ue(this)};var qc=va;function gu(t,n){this._content=t,this._batchId=n,this._color=void 0}Object.defineProperties(gu.prototype,{show:{get:function(){return this._content.batchTable.getShow(this._batchId)},set:function(t){this._content.batchTable.setShow(this._batchId,t)}},color:{get:function(){return f(this._color)||(this._color=new z),this._content.batchTable.getColor(this._batchId,this._color)},set:function(t){this._content.batchTable.setColor(this._batchId,t)}},polylinePositions:{get:function(){if(!!f(this._content.getPolylinePositions))return this._content.getPolylinePositions(this._batchId)}},content:{get:function(){return this._content}},tileset:{get:function(){return this._content.tileset}},primitive:{get:function(){return this._content.tileset}},featureId:{get:function(){return this._batchId}},pickId:{get:function(){return this._content.batchTable.getPickColor(this._batchId)}}});gu.prototype.hasProperty=function(t){return this._content.batchTable.hasProperty(this._batchId,t)};gu.prototype.getPropertyIds=function(t){return this._content.batchTable.getPropertyIds(this._batchId,t)};gu.prototype.getProperty=function(t){return this._content.batchTable.getProperty(this._batchId,t)};gu.getPropertyInherited=function(t,n,i){let o=t.batchTable;if(f(o)){if(o.hasPropertyBySemantic(n,i))return o.getPropertyBySemantic(n,i);if(o.hasProperty(n,i))return o.getProperty(n,i)}let r=t.metadata;if(f(r)){if(r.hasPropertyBySemantic(i))return r.getPropertyBySemantic(i);if(r.hasProperty(i))return r.getProperty(i)}let s=t.tile,a=s.metadata;if(f(a)){if(a.hasPropertyBySemantic(i))return a.getPropertyBySemantic(i);if(a.hasProperty(i))return a.getProperty(i)}let c;if(f(s.implicitSubtree)&&(c=s.implicitSubtree.metadata),f(c)){if(c.hasPropertyBySemantic(i))return c.getPropertyBySemantic(i);if(c.hasProperty(i))return c.getProperty(i)}let l=f(t.group)?t.group.metadata:void 0;if(f(l)){if(l.hasPropertyBySemantic(i))return l.getPropertyBySemantic(i);if(l.hasProperty(i))return l.getProperty(i)}let u=t.tileset.metadata;if(f(u)){if(u.hasPropertyBySemantic(i))return u.getPropertyBySemantic(i);if(u.hasProperty(i))return u.getProperty(i)}};gu.prototype.getPropertyInherited=function(t){return gu.getPropertyInherited(this._content,this._batchId,t)};gu.prototype.setProperty=function(t,n){this._content.batchTable.setProperty(this._batchId,t,n),this._content.featurePropertiesDirty=!0};gu.prototype.isExactClass=function(t){return this._content.batchTable.isExactClass(this._batchId,t)};gu.prototype.isClass=function(t){return this._content.batchTable.isClass(this._batchId,t)};gu.prototype.getExactClassName=function(){return this._content.batchTable.getExactClassName(this._batchId)};var Ds=gu;function k0(t){this._model=t.model,this._featureTable=t.featureTable,this._featureId=t.featureId,this._color=void 0}Object.defineProperties(k0.prototype,{show:{get:function(){return this._featureTable.getShow(this._featureId)},set:function(t){this._featureTable.setShow(this._featureId,t)}},color:{get:function(){return f(this._color)||(this._color=new z),this._featureTable.getColor(this._featureId,this._color)},set:function(t){this._featureTable.setColor(this._featureId,t)}},primitive:{get:function(){return this._model}},featureTable:{get:function(){return this._featureTable}},featureId:{get:function(){return this._featureId}}});k0.prototype.hasProperty=function(t){return this._featureTable.hasProperty(this._featureId,t)};k0.prototype.getProperty=function(t){return this._featureTable.getProperty(this._featureId,t)};k0.prototype.getPropertyInherited=function(t){return this._featureTable.hasPropertyBySemantic(this._featureId,t)?this._featureTable.getPropertyBySemantic(this._featureId,t):this._featureTable.getProperty(this._featureId,t)};k0.prototype.getPropertyIds=function(t){return this._featureTable.getPropertyIds(t)};k0.prototype.setProperty=function(t,n){return this._featureTable.setProperty(this._featureId,t,n)};var BR=k0;var dS={ALL_OPAQUE:0,ALL_TRANSLUCENT:1,OPAQUE_AND_TRANSLUCENT:2};dS.getStyleCommandsNeeded=function(t,n){return n===0?dS.ALL_OPAQUE:n===t?dS.ALL_TRANSLUCENT:dS.OPAQUE_AND_TRANSLUCENT};var $d=Object.freeze(dS);var u_={GLTF:"GLTF",TILE_GLTF:"TILE_GLTF",TILE_B3DM:"B3DM",TILE_I3DM:"I3DM",TILE_PNTS:"PNTS",TILE_GEOJSON:"TILE_GEOJSON"};u_.is3DTiles=function(t){switch(t){case u_.TILE_GLTF:case u_.TILE_B3DM:case u_.TILE_I3DM:case u_.TILE_PNTS:case u_.TILE_GEOJSON:return!0;case u_.GLTF:return!1}};var sr=Object.freeze(u_);function Ar(t){let n=t.model,i=t.propertyTable;this._propertyTable=i,this._model=n,this._features=void 0,this._featuresLength=0,this._batchTexture=void 0,this._styleCommandsNeededDirty=!1,this._styleCommandsNeeded=$d.ALL_OPAQUE,YIe(this)}Object.defineProperties(Ar.prototype,{batchTexture:{get:function(){return this._batchTexture}},featuresLength:{get:function(){return this._featuresLength}},batchTextureByteLength:{get:function(){return f(this._batchTexture)?this._batchTexture.byteLength:0}},styleCommandsNeededDirty:{get:function(){return this._styleCommandsNeededDirty}}});function YIe(t){let n=t._model,i=sr.is3DTiles(n.type),o=t._propertyTable.count;if(o===0)return;let r,s=new Array(o);if(i){let a=n.content;for(r=0;r<o;r++)s[r]=new Ds(a,r)}else for(r=0;r<o;r++)s[r]=new BR({model:n,featureId:r,featureTable:t});t._features=s,t._featuresLength=o,t._batchTexture=new qc({featuresLength:o,owner:t,statistics:i?n.content.tileset.statistics:void 0})}Ar.prototype.update=function(t){this._styleCommandsNeededDirty=!1,this._batchTexture.update(void 0,t);let n=$d.getStyleCommandsNeeded(this._featuresLength,this._batchTexture.translucentFeaturesLength);this._styleCommandsNeeded!==n&&(this._styleCommandsNeededDirty=!0,this._styleCommandsNeeded=n)};Ar.prototype.setShow=function(t,n){this._batchTexture.setShow(t,n)};Ar.prototype.setAllShow=function(t){this._batchTexture.setAllShow(t)};Ar.prototype.getShow=function(t){return this._batchTexture.getShow(t)};Ar.prototype.setColor=function(t,n){this._batchTexture.setColor(t,n)};Ar.prototype.setAllColor=function(t){this._batchTexture.setAllColor(t)};Ar.prototype.getColor=function(t,n){return this._batchTexture.getColor(t,n)};Ar.prototype.getPickColor=function(t){return this._batchTexture.getPickColor(t)};Ar.prototype.getFeature=function(t){return this._features[t]};Ar.prototype.hasProperty=function(t,n){return this._propertyTable.hasProperty(t,n)};Ar.prototype.hasPropertyBySemantic=function(t,n){return this._propertyTable.hasPropertyBySemantic(t,n)};Ar.prototype.getProperty=function(t,n){return this._propertyTable.getProperty(t,n)};Ar.prototype.getPropertyBySemantic=function(t,n){return this._propertyTable.getPropertyBySemantic(t,n)};Ar.prototype.getPropertyIds=function(t){return this._propertyTable.getPropertyIds(t)};Ar.prototype.setProperty=function(t,n,i){return this._propertyTable.setProperty(t,n,i)};Ar.prototype.isClass=function(t,n){return this._propertyTable.isClass(t,n)};Ar.prototype.isExactClass=function(t,n){return this._propertyTable.isExactClass(t,n)};Ar.prototype.getExactClassName=function(t){return this._propertyTable.getExactClassName(t)};var XIe=new z;Ar.prototype.applyStyle=function(t){if(!f(t)){this.setAllColor(qc.DEFAULT_COLOR_VALUE),this.setAllShow(qc.DEFAULT_SHOW_VALUE);return}for(let n=0;n<this._featuresLength;n++){let i=this.getFeature(n),o=f(t.color)?A(t.color.evaluateColor(i,XIe),qc.DEFAULT_COLOR_VALUE):qc.DEFAULT_COLOR_VALUE,r=f(t.show)?A(t.show.evaluate(i),qc.DEFAULT_SHOW_VALUE):qc.DEFAULT_SHOW_VALUE;this.setColor(n,o),this.setShow(n,r)}};Ar.prototype.isDestroyed=function(){return!1};Ar.prototype.destroy=function(t){this._batchTexture=this._batchTexture&&this._batchTexture.destroy(),ue(this)};var OR=Ar;var RR=`#if defined(HAS_NORMALS) && !defined(HAS_TANGENTS) && !defined(LIGHTING_UNLIT)
#ifdef GL_OES_standard_derivatives
#extension GL_OES_standard_derivatives : enable
#endif
#endif
czm_modelMaterial defaultModelMaterial()
{
czm_modelMaterial material;
material.diffuse = vec3(0.0);
material.specular = vec3(1.0);
material.roughness = 1.0;
material.occlusion = 1.0;
material.normalEC = vec3(0.0, 0.0, 1.0);
material.emissive = vec3(0.0);
material.alpha = 1.0;
return material;
}
vec4 handleAlpha(vec3 color, float alpha)
{
#ifdef ALPHA_MODE_MASK
if (alpha < u_alphaCutoff) {
discard;
}
#endif
return vec4(color, alpha);
}
SelectedFeature selectedFeature;
void main()
{
#ifdef HAS_MODEL_SPLITTER
modelSplitterStage();
#endif
czm_modelMaterial material = defaultModelMaterial();
ProcessedAttributes attributes;
geometryStage(attributes);
FeatureIds featureIds;
featureIdStage(featureIds, attributes);
Metadata metadata;
MetadataClass metadataClass;
MetadataStatistics metadataStatistics;
metadataStage(metadata, metadataClass, metadataStatistics, attributes);
#ifdef HAS_SELECTED_FEATURE_ID
selectedFeatureIdStage(selectedFeature, featureIds);
#endif
#ifndef CUSTOM_SHADER_REPLACE_MATERIAL
materialStage(material, attributes, selectedFeature);
#endif
#ifdef HAS_CUSTOM_FRAGMENT_SHADER
customShaderStage(material, attributes, featureIds, metadata, metadataClass, metadataStatistics);
#endif
lightingStage(material, attributes);
#ifdef HAS_SELECTED_FEATURE_ID
cpuStylingStage(material, selectedFeature);
#endif
#ifdef HAS_MODEL_COLOR
modelColorStage(material);
#endif
#ifdef HAS_PRIMITIVE_OUTLINE
primitiveOutlineStage(material);
#endif
vec4 color = handleAlpha(material.diffuse, material.alpha);
#ifdef HAS_CLIPPING_PLANES
modelClippingPlanesStage(color);
#endif
#if defined(HAS_SILHOUETTE) && defined(HAS_NORMALS)
silhouetteStage(color);
#endif
gl_FragColor = color;
}
`;var MR=`precision highp float;
czm_modelVertexOutput defaultVertexOutput(vec3 positionMC) {
czm_modelVertexOutput vsOutput;
vsOutput.positionMC = positionMC;
vsOutput.pointSize = 1.0;
return vsOutput;
}
void main()
{
ProcessedAttributes attributes;
initializeAttributes(attributes);
#ifdef USE_DEQUANTIZATION
dequantizationStage(attributes);
#endif
#ifdef HAS_MORPH_TARGETS
morphTargetsStage(attributes);
#endif
#ifdef HAS_SKINNING
skinningStage(attributes);
#endif
#ifdef HAS_PRIMITIVE_OUTLINE
primitiveOutlineStage();
#endif
#ifdef HAS_BITANGENTS
attributes.bitangentMC = normalize(cross(attributes.normalMC, attributes.tangentMC) * attributes.tangentSignMC);
#endif
FeatureIds featureIds;
featureIdStage(featureIds, attributes);
#ifdef HAS_SELECTED_FEATURE_ID
SelectedFeature feature;
selectedFeatureIdStage(feature, featureIds);
cpuStylingStage(attributes.positionMC, feature);
#endif
#if defined(USE_2D_POSITIONS) || defined(USE_2D_INSTANCING)
mat4 modelView = czm_modelView3D;
mat3 normal = czm_normal3D;
#else
mat4 modelView = czm_modelView;
mat3 normal = czm_normal;
#endif
#ifdef HAS_INSTANCING
#ifdef USE_LEGACY_INSTANCING
mat4 instanceModelView;
mat3 instanceModelViewInverseTranspose;
legacyInstancingStage(attributes, instanceModelView, instanceModelViewInverseTranspose);
modelView = instanceModelView;
normal = instanceModelViewInverseTranspose;
#else
instancingStage(attributes);
#endif
#ifdef USE_PICKING
v_pickColor = a_pickColor;
#endif
#endif
Metadata metadata;
MetadataClass metadataClass;
MetadataStatistics metadataStatistics;
metadataStage(metadata, metadataClass, metadataStatistics, attributes);
#ifdef HAS_CUSTOM_VERTEX_SHADER
czm_modelVertexOutput vsOutput = defaultVertexOutput(attributes.positionMC);
customShaderStage(vsOutput, attributes, featureIds, metadata, metadataClass, metadataStatistics);
#endif
vec4 positionClip = geometryStage(attributes, modelView, normal);
#ifdef HAS_SILHOUETTE
silhouetteStage(attributes, positionClip);
#endif
#ifdef HAS_POINT_CLOUD_SHOW_STYLE
float show = pointCloudShowStylingStage(attributes, metadata);
#else
float show = 1.0;
#endif
#ifdef HAS_POINT_CLOUD_BACK_FACE_CULLING
show *= pointCloudBackFaceCullingStage();
#endif
#ifdef HAS_POINT_CLOUD_COLOR_STYLE
v_pointCloudColor = pointCloudColorStylingStage(attributes, metadata);
#endif
#ifdef PRIMITIVE_TYPE_POINTS
#ifdef HAS_CUSTOM_VERTEX_SHADER
gl_PointSize = vsOutput.pointSize;
#elif defined(HAS_POINT_CLOUD_POINT_SIZE_STYLE) || defined(HAS_POINT_CLOUD_ATTENUATION)
gl_PointSize = pointCloudPointSizeStylingStage(attributes, metadata);
#else
gl_PointSize = 1.0;
#endif
gl_PointSize *= show;
#endif
gl_Position = show * positionClip;
}
`;var BQ={TERRAIN:0,CESIUM_3D_TILE:1,BOTH:2};BQ.NUMBER_OF_CLASSIFICATION_TYPES=3;var Un=Object.freeze(BQ);var KIe={NEVER:ee.NEVER,LESS:ee.LESS,EQUAL:ee.EQUAL,LESS_OR_EQUAL:ee.LEQUAL,GREATER:ee.GREATER,NOT_EQUAL:ee.NOTEQUAL,GREATER_OR_EQUAL:ee.GEQUAL,ALWAYS:ee.ALWAYS},cc=Object.freeze(KIe);function sG(t){t=A(t,A.EMPTY_OBJECT);let n=t.command,i=t.primitiveRenderResources,o=i.model;this._command=n,this._model=o,this._runtimePrimitive=i.runtimePrimitive,this._modelMatrix=n.modelMatrix,this._boundingVolume=n.boundingVolume,this._cullFace=n.renderState.cull.face;let r=o.classificationType;this._classificationType=r,this._classifiesTerrain=r!==Un.CESIUM_3D_TILE,this._classifies3DTiles=r!==Un.TERRAIN,this._useDebugWireframe=o._enableDebugWireframe&&o.debugWireframe,this._pickId=i.pickId,this._commandListTerrain=[],this._commandList3DTiles=[],this._commandListIgnoreShow=[],this._commandListDebugWireframe=[],this._commandListTerrainPicking=[],this._commandList3DTilesPicking=[],$Ie(this)}function JIe(t){return{colorMask:{red:!1,green:!1,blue:!1,alpha:!1},stencilTest:{enabled:!0,frontFunction:t,frontOperation:{fail:ft.KEEP,zFail:ft.DECREMENT_WRAP,zPass:ft.KEEP},backFunction:t,backOperation:{fail:ft.KEEP,zFail:ft.INCREMENT_WRAP,zPass:ft.KEEP},reference:Ot.CESIUM_3D_TILE_MASK,mask:Ot.CESIUM_3D_TILE_MASK},stencilMask:Ot.CLASSIFICATION_MASK,depthTest:{enabled:!0,func:cc.LESS_OR_EQUAL},depthMask:!1}}var ZIe={stencilTest:{enabled:!0,frontFunction:kn.NOT_EQUAL,frontOperation:{fail:ft.ZERO,zFail:ft.ZERO,zPass:ft.ZERO},backFunction:kn.NOT_EQUAL,backOperation:{fail:ft.ZERO,zFail:ft.ZERO,zPass:ft.ZERO},reference:0,mask:Ot.CLASSIFICATION_MASK},stencilMask:Ot.CLASSIFICATION_MASK,depthTest:{enabled:!1},depthMask:!1,blending:ln.PRE_MULTIPLIED_ALPHA_BLEND},QIe={stencilTest:{enabled:!0,frontFunction:kn.NOT_EQUAL,frontOperation:{fail:ft.ZERO,zFail:ft.ZERO,zPass:ft.ZERO},backFunction:kn.NOT_EQUAL,backOperation:{fail:ft.ZERO,zFail:ft.ZERO,zPass:ft.ZERO},reference:0,mask:Ot.CLASSIFICATION_MASK},stencilMask:Ot.CLASSIFICATION_MASK,depthTest:{enabled:!1},depthMask:!1},MQ=[];function $Ie(t){let n=t._command,i=MQ;if(t._useDebugWireframe){n.pass=Te.OPAQUE,i.length=0,i.push(n),t._commandListDebugWireframe=hS(t,i,t._commandListDebugWireframe);let s=t._commandListDebugWireframe,a=s.length;for(let c=0;c<a;c++){let l=s[c];l.count*=2,l.offset*=2}return}let r=t.model.allowPicking;if(t._classifiesTerrain){let s=Te.TERRAIN_CLASSIFICATION,a=rG(n,s),c=OQ(n,s);i.length=0,i.push(a,c),t._commandListTerrain=hS(t,i,t._commandListTerrain),r&&(t._commandListTerrainPicking=RQ(t,i,t._commandListTerrainPicking))}if(t._classifies3DTiles){let s=Te.CESIUM_3D_TILE_CLASSIFICATION,a=rG(n,s),c=OQ(n,s);i.length=0,i.push(a,c),t._commandList3DTiles=hS(t,i,t._commandList3DTiles),r&&(t._commandList3DTilesPicking=RQ(t,i,t._commandList3DTilesPicking))}}function hS(t,n,i){let o=t._runtimePrimitive,r=o.batchLengths,s=o.batchOffsets,a=r.length,c=n.length;for(let l=0;l<a;l++){let u=r[l],d=s[l];for(let h=0;h<c;h++){let _=n[h],y=et.shallowClone(_);y.count=u,y.offset=d,i.push(y)}}return i}function rG(t,n){let i=et.shallowClone(t);i.cull=!1,i.pass=n;let o=n===Te.TERRAIN_CLASSIFICATION?kn.ALWAYS:kn.EQUAL,r=JIe(o);return i.renderState=Ve.fromCache(r),i}function OQ(t,n){let i=et.shallowClone(t);return i.cull=!1,i.pass=n,i.renderState=Ve.fromCache(ZIe),i}var eBe=[];function RQ(t,n,i){let o=Ve.fromCache(QIe),r=n[0],s=n[1],a=et.shallowClone(r);a.cull=!0,a.pickOnly=!0;let c=et.shallowClone(s);c.cull=!0,c.pickOnly=!0,c.renderState=o,c.pickId=t._pickId;let l=eBe;return l.length=0,l.push(a,c),hS(t,l,i)}Object.defineProperties(sG.prototype,{command:{get:function(){return this._command}},runtimePrimitive:{get:function(){return this._runtimePrimitive}},batchLengths:{get:function(){return this._runtimePrimitive.batchLengths}},batchOffsets:{get:function(){return this._runtimePrimitive.batchOffsets}},model:{get:function(){return this._model}},classificationType:{get:function(){return this._classificationType}},modelMatrix:{get:function(){return this._modelMatrix},set:function(t){this._modelMatrix=N.clone(t,this._modelMatrix);let n=this._runtimePrimitive.boundingSphere;this._boundingVolume=ae.transform(n,this._modelMatrix,this._boundingVolume)}},boundingVolume:{get:function(){return this._boundingVolume}},cullFace:{get:function(){return this._cullFace},set:function(t){this._cullFace=t}}});sG.prototype.pushCommands=function(t,n){let i=t.passes;if(i.render){if(this._useDebugWireframe){n.push.apply(n,this._commandListDebugWireframe);return}if(this._classifiesTerrain&&n.push.apply(n,this._commandListTerrain),this._classifies3DTiles&&n.push.apply(n,this._commandList3DTiles),t.invertClassification&&this._classifies3DTiles){if(this._commandListIgnoreShow.length===0){let r=Te.CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW,s=rG(this._command,r),a=MQ;a.length=0,a.push(s),this._commandListIgnoreShow=hS(this,a,this._commandListIgnoreShow)}n.push.apply(n,this._commandListIgnoreShow)}}return i.pick&&(this._classifiesTerrain&&n.push.apply(n,this._commandListTerrainPicking),this._classifies3DTiles&&n.push.apply(n,this._commandList3DTilesPicking)),n};var LR=sG;function FR(t){t=A(t,A.EMPTY_OBJECT);let n=t.command,i=t.primitiveRenderResources,o=i.model;this._model=o;let r=i.runtimePrimitive;this._runtimePrimitive=r;let s=n.pass===Te.TRANSLUCENT,c=!r.primitive.material.doubleSided&&!s,l=i.hasSilhouette,u=!s&&!l,d=i.hasSkipLevelOfDetail&&!s,h=l;this._command=n,this._modelMatrix=N.clone(n.modelMatrix),this._boundingVolume=ae.clone(n.boundingVolume),this._modelMatrix2D=new N,this._boundingVolume2D=new ae,this._modelMatrix2DDirty=!1,this._backFaceCulling=n.renderState.cull.enabled,this._cullFace=n.renderState.cull.face,this._shadows=o.shadows,this._debugShowBoundingVolume=n.debugShowBoundingVolume,this._usesBackFaceCulling=c,this._needsTranslucentCommand=u,this._needsSkipLevelOfDetailCommands=d,this._needsSilhouetteCommands=h,this._originalCommand=void 0,this._translucentCommand=void 0,this._skipLodBackfaceCommand=void 0,this._skipLodStencilCommand=void 0,this._silhouetteModelCommand=void 0,this._silhouetteColorCommand=void 0,this._derivedCommands=[],this._has2DCommands=!1,tBe(this)}function Dm(t){this.command=t.command,this.updateShadows=t.updateShadows,this.updateBackFaceCulling=t.updateBackFaceCulling,this.updateCullFace=t.updateCullFace,this.updateDebugShowBoundingVolume=t.updateDebugShowBoundingVolume,this.is2D=A(t.is2D,!1),this.derivedCommand2D=void 0}Dm.clone=function(t){return new Dm({command:t.command,updateShadows:t.updateShadows,updateBackFaceCulling:t.updateBackFaceCulling,updateCullFace:t.updateCullFace,updateDebugShowBoundingVolume:t.updateDebugShowBoundingVolume,is2D:t.is2D,derivedCommand2D:t.derivedCommand2D})};function tBe(t){let n=t._command;n.modelMatrix=t._modelMatrix,n.boundingVolume=t._boundingVolume;let i=t._model,o=t._usesBackFaceCulling,r=t._derivedCommands;t._originalCommand=new Dm({command:n,updateShadows:!0,updateBackFaceCulling:o,updateCullFace:o,updateDebugShowBoundingVolume:!0,is2D:!1}),r.push(t._originalCommand),t._needsTranslucentCommand&&(t._translucentCommand=new Dm({command:cBe(n),updateShadows:!0,updateBackFaceCulling:!1,updateCullFace:!1,updateDebugShowBoundingVolume:!0}),r.push(t._translucentCommand)),t._needsSkipLevelOfDetailCommands&&(t._skipLodBackfaceCommand=new Dm({command:mBe(n),updateShadows:!1,updateBackFaceCulling:!1,updateCullFace:o,updateDebugShowBoundingVolume:!1}),t._skipLodStencilCommand=new Dm({command:pBe(n,i),updateShadows:!0,updateBackFaceCulling:o,updateCullFace:o,updateDebugShowBoundingVolume:!0}),r.push(t._skipLodBackfaceCommand),r.push(t._skipLodStencilCommand)),t._needsSilhouetteCommands&&(t._silhouetteModelCommand=new Dm({command:lBe(n,i),updateShadows:!0,updateBackFaceCulling:o,updateCullFace:o,updateDebugShowBoundingVolume:!0}),t._silhouetteColorCommand=new Dm({command:uBe(n,i),updateShadows:!1,updateBackFaceCulling:!1,updateCullFace:!1,updateDebugShowBoundingVolume:!1}),r.push(t._silhouetteModelCommand),r.push(t._silhouetteColorCommand))}Object.defineProperties(FR.prototype,{command:{get:function(){return this._command}},runtimePrimitive:{get:function(){return this._runtimePrimitive}},model:{get:function(){return this._model}},primitiveType:{get:function(){return this._command.primitiveType}},modelMatrix:{get:function(){return this._modelMatrix},set:function(t){this._modelMatrix=N.clone(t,this._modelMatrix),this._modelMatrix2DDirty=!0,this._boundingVolume=ae.transform(this.runtimePrimitive.boundingSphere,this._modelMatrix,this._boundingVolume)}},boundingVolume:{get:function(){return this._boundingVolume}},shadows:{get:function(){return this._shadows},set:function(t){this._shadows=t,iBe(this)}},backFaceCulling:{get:function(){return this._backFaceCulling},set:function(t){this._backFaceCulling!==t&&(this._backFaceCulling=t,oBe(this))}},cullFace:{get:function(){return this._cullFace},set:function(t){this._cullFace!==t&&(this._cullFace=t,rBe(this))}},debugShowBoundingVolume:{get:function(){return this._debugShowBoundingVolume},set:function(t){this._debugShowBoundingVolume!==t&&(this._debugShowBoundingVolume=t,sBe(this))}}});function nBe(t,n){let i=t._modelMatrix;t._modelMatrix2D=N.clone(i,t._modelMatrix2D),t._modelMatrix2D[13]-=B.sign(i[13])*2*B.PI*n.mapProjection.ellipsoid.maximumRadius,t._boundingVolume2D=ae.transform(t.runtimePrimitive.boundingSphere,t._modelMatrix2D,t._boundingVolume2D)}function iBe(t){let n=t.shadows,i=gn.castShadows(n),o=gn.receiveShadows(n),r=t._derivedCommands,s=r.length;for(let a=0;a<s;++a){let c=r[a];if(c.updateShadows){let l=c.command;l.castShadows=i,l.receiveShadows=o}}}function oBe(t){let n=t.backFaceCulling,i=t._derivedCommands,o=i.length;for(let r=0;r<o;++r){let s=i[r];if(s.updateBackFaceCulling){let a=s.command,c=tt(a.renderState,!0);c.cull.enabled=n,a.renderState=Ve.fromCache(c)}}}function rBe(t){let n=t.cullFace,i=t._derivedCommands,o=i.length;for(let r=0;r<o;++r){let s=i[r];if(s.updateCullFace){let a=s.command,c=tt(a.renderState,!0);c.cull.face=n,a.renderState=Ve.fromCache(c)}}}function sBe(t){let n=t.debugShowBoundingVolume,i=t._derivedCommands,o=i.length;for(let r=0;r<o;++r){let s=i[r];if(s.updateDebugShowBoundingVolume){let a=s.command;a.debugShowBoundingVolume=n}}}FR.prototype.pushCommands=function(t,n){let i=LQ(this,t);i&&!this._has2DCommands&&(aBe(this),this._has2DCommands=!0,this._modelMatrix2DDirty=!0),this._modelMatrix2DDirty&&(nBe(this,t),this._modelMatrix2DDirty=!1);let o=this.model.styleCommandsNeeded;if(!(this._needsTranslucentCommand&&f(o)&&(o!==$d.ALL_OPAQUE&&$C(n,this._translucentCommand,i),o===$d.ALL_TRANSLUCENT))){if(this._needsSkipLevelOfDetailCommands){let r=this._model.content,s=r.tileset,a=r.tile,c=s._hasMixedContent,l=a._finalResolution;if(c){l||$C(s._backfaceCommands,this._skipLodBackfaceCommand,i),fBe(this,a,i),$C(n,this._skipLodStencilCommand,i);return}}if(this._needsSilhouetteCommands){$C(n,this._silhouetteModelCommand,i);return}return $C(n,this._originalCommand,i),n}};FR.prototype.pushSilhouetteCommands=function(t,n){let i=LQ(this,t);return $C(n,this._silhouetteColorCommand,i),n};function $C(t,n,i){t.push(n.command),i&&t.push(n.derivedCommand2D.command)}function LQ(t,n){if(n.mode!==ne.SCENE2D||t.model._projectTo2D)return!1;let o=t.model.sceneGraph._boundingSphere2D,r=o.center.y-o.radius,s=o.center.y+o.radius,a=n.mapProjection.ellipsoid.maximumRadius*B.PI;return r<a&&s>a||r<-a&&s>-a}function QC(t,n){if(!f(n))return;let i=Dm.clone(n),o=et.shallowClone(n.command);return o.modelMatrix=t._modelMatrix2D,o.boundingVolume=t._boundingVolume2D,i.command=o,i.updateShadows=!1,i.is2D=!0,n.derivedCommand2D=i,t._derivedCommands.push(i),i}function aBe(t){QC(t,t._originalCommand),QC(t,t._translucentCommand),QC(t,t._skipLodBackfaceCommand),QC(t,t._skipLodStencilCommand),QC(t,t._silhouetteModelCommand),QC(t,t._silhouetteColorCommand)}function cBe(t){let n=et.shallowClone(t);n.pass=Te.TRANSLUCENT;let i=tt(t.renderState,!0);return i.cull.enabled=!1,i.depthMask=!1,i.blending=ln.ALPHA_BLEND,n.renderState=Ve.fromCache(i),n}function lBe(t,n){let i=n._silhouetteId%255,o=et.shallowClone(t),r=tt(t.renderState,!0);return r.stencilTest={enabled:!0,frontFunction:ee.ALWAYS,backFunction:ee.ALWAYS,reference:i,mask:-1,frontOperation:{fail:ee.KEEP,zFail:ee.KEEP,zPass:ee.REPLACE},backOperation:{fail:ee.KEEP,zFail:ee.KEEP,zPass:ee.REPLACE}},n.isInvisible()&&(r.colorMask={red:!1,green:!1,blue:!1,alpha:!1}),o.renderState=Ve.fromCache(r),o}function uBe(t,n){let i=n._silhouetteId%255,o=et.shallowClone(t),r=tt(t.renderState,!0);r.cull.enabled=!1,(t.pass===Te.TRANSLUCENT||n.silhouetteColor.alpha<1)&&(o.pass=Te.TRANSLUCENT,r.depthMask=!1,r.blending=ln.ALPHA_BLEND),r.stencilTest={enabled:!0,frontFunction:ee.NOTEQUAL,backFunction:ee.NOTEQUAL,reference:i,mask:-1,frontOperation:{fail:ee.KEEP,zFail:ee.KEEP,zPass:ee.KEEP},backOperation:{fail:ee.KEEP,zFail:ee.KEEP,zPass:ee.KEEP}};let a=tt(t.uniformMap);return a.model_silhouettePass=function(){return!0},o.renderState=Ve.fromCache(r),o.uniformMap=a,o.castShadows=!1,o.receiveShadows=!1,o}function fBe(t,n,i){let o=t._skipLodStencilCommand,r=o.command,s=n._selectionDepth,a=dBe(r);if(s!==a){let c=hBe(s),l=tt(r.renderState,!0);l.stencilTest.reference=c,r.renderState=Ve.fromCache(l),i&&(o.derivedCommand2D.renderState=l)}}function dBe(t){return(t.renderState.stencilTest.reference&Ot.SKIP_LOD_MASK)>>>Ot.SKIP_LOD_BIT_SHIFT}function hBe(t){return Ot.CESIUM_3D_TILE_MASK|t<<Ot.SKIP_LOD_BIT_SHIFT}function mBe(t){let n=et.shallowClone(t),i=tt(t.renderState,!0);i.cull.enabled=!0,i.cull.face=xi.FRONT,i.colorMask={red:!1,green:!1,blue:!1,alpha:!1},i.polygonOffset={enabled:!0,factor:5,units:5};let o=tt(n.uniformMap),r=new W(5,5);return o.u_polygonOffset=function(){return r},n.renderState=Ve.fromCache(i),n.uniformMap=o,n.castShadows=!1,n.receiveShadows=!1,n}function pBe(t){let n=et.shallowClone(t),i=tt(t.renderState,!0);return i.stencilTest.enabled=!0,i.stencilTest.mask=Ot.SKIP_LOD_MASK,i.stencilTest.reference=Ot.CESIUM_3D_TILE_MASK,i.stencilTest.frontFunction=kn.GREATER_OR_EQUAL,i.stencilTest.frontOperation.zPass=ft.REPLACE,i.stencilTest.backFunction=kn.GREATER_OR_EQUAL,i.stencilTest.backOperation.zPass=ft.REPLACE,i.stencilMask=Ot.CESIUM_3D_TILE_MASK|Ot.SKIP_LOD_MASK,n.renderState=Ve.fromCache(i),n}var NR=FR;function _Be(t,n){let i=t.shaderBuilder;i.addVertexLines(MR),i.addFragmentLines(RR);let o=gBe(t),r=new $n({context:n.context,indexBuffer:o,attributes:t.attributes}),s=t.model;s._pipelineResources.push(r);let a=i.buildShaderProgram(n.context);s._pipelineResources.push(a);let c=t.alphaOptions.pass,l=s.sceneGraph,u=N.multiplyTransformation(l.computedModelMatrix,t.runtimeNode.computedTransform,new N),d;n.mode!==ne.SCENE3D&&!n.scene3DOnly&&s._projectTo2D?d=t.runtimePrimitive.boundingSphere2D:d=ae.transform(t.boundingSphere,u,t.boundingSphere);let h=tt(Ve.fromCache(t.renderStateOptions),!0);h.cull.face=on.getCullFace(u,t.primitiveType),h=Ve.fromCache(h);let _=f(s.classificationType),y=_?!1:gn.castShadows(s.shadows),p=_?!1:gn.receiveShadows(s.shadows),C=_?void 0:t.pickId,x=new et({boundingVolume:d,modelMatrix:u,uniformMap:t.uniformMap,renderState:h,vertexArray:r,shaderProgram:a,cull:s.cull,pass:c,count:t.count,owner:s,pickId:C,instanceCount:t.instanceCount,primitiveType:t.primitiveType,debugShowBoundingVolume:s.debugShowBoundingVolume,castShadows:y,receiveShadows:p});return _?new LR({primitiveRenderResources:t,command:x}):new NR({primitiveRenderResources:t,command:x})}function gBe(t){let n=t.wireframeIndexBuffer;if(f(n))return n;let i=t.indices;if(!!f(i))return i.buffer}var VR=_Be;var U0={VERTEX:0,FRAGMENT:1,BOTH:2};U0.includesVertexShader=function(t){return t===U0.VERTEX||t===U0.BOTH};U0.includesFragmentShader=function(t){return t===U0.FRAGMENT||t===U0.BOTH};var Ee=Object.freeze(U0);var FQ={name:"TilesetPipelineStage"};FQ.process=function(t,n,i){if(n.hasSkipLevelOfDetail(i)){t.shaderBuilder.addDefine("POLYGON_OFFSET",void 0,Ee.FRAGMENT);let s={u_polygonOffset:function(){return W.ZERO}};t.uniformMap=At(s,t.uniformMap),t.hasSkipLevelOfDetail=!0}let o=t.renderStateOptions;o.stencilTest=Ot.setCesium3DTileBit(),o.stencilMask=Ot.CESIUM_3D_TILE_MASK};var kR=FQ;var UR=`vec3 proceduralIBL(
vec3 positionEC,
vec3 normalEC,
vec3 lightDirectionEC,
vec3 lightColorHdr,
czm_pbrParameters pbrParameters
) {
vec3 v = -positionEC;
vec3 positionWC = vec3(czm_inverseView * vec4(positionEC, 1.0));
vec3 vWC = -normalize(positionWC);
vec3 l = normalize(lightDirectionEC);
vec3 n = normalEC;
vec3 r = normalize(czm_inverseViewRotation * normalize(reflect(v, n)));
float NdotL = clamp(dot(n, l), 0.001, 1.0);
float NdotV = abs(dot(n, v)) + 0.001;
float vertexRadius = length(positionWC);
float horizonDotNadir = 1.0 - min(1.0, czm_ellipsoidRadii.x / vertexRadius);
float reflectionDotNadir = dot(r, normalize(positionWC));
r.x = -r.x;
r = -normalize(czm_temeToPseudoFixed * r);
r.x = -r.x;
vec3 diffuseColor = pbrParameters.diffuseColor;
float roughness = pbrParameters.roughness;
vec3 specularColor = pbrParameters.f0;
float inverseRoughness = 1.04 - roughness;
inverseRoughness *= inverseRoughness;
vec3 sceneSkyBox = textureCube(czm_environmentMap, r).rgb * inverseRoughness;
float atmosphereHeight = 0.05;
float blendRegionSize = 0.1 * ((1.0 - inverseRoughness) * 8.0 + 1.1 - horizonDotNadir);
float blendRegionOffset = roughness * -1.0;
float farAboveHorizon = clamp(horizonDotNadir - blendRegionSize * 0.5 + blendRegionOffset, 1.0e-10 - blendRegionSize, 0.99999);
float aroundHorizon = clamp(horizonDotNadir + blendRegionSize * 0.5, 1.0e-10 - blendRegionSize, 0.99999);
float farBelowHorizon = clamp(horizonDotNadir + blendRegionSize * 1.5, 1.0e-10 - blendRegionSize, 0.99999);
float smoothstepHeight = smoothstep(0.0, atmosphereHeight, horizonDotNadir);
vec3 belowHorizonColor = mix(vec3(0.1, 0.15, 0.25), vec3(0.4, 0.7, 0.9), smoothstepHeight);
vec3 nadirColor = belowHorizonColor * 0.5;
vec3 aboveHorizonColor = mix(vec3(0.9, 1.0, 1.2), belowHorizonColor, roughness * 0.5);
vec3 blueSkyColor = mix(vec3(0.18, 0.26, 0.48), aboveHorizonColor, reflectionDotNadir * inverseRoughness * 0.5 + 0.75);
vec3 zenithColor = mix(blueSkyColor, sceneSkyBox, smoothstepHeight);
vec3 blueSkyDiffuseColor = vec3(0.7, 0.85, 0.9);
float diffuseIrradianceFromEarth = (1.0 - horizonDotNadir) * (reflectionDotNadir * 0.25 + 0.75) * smoothstepHeight;
float diffuseIrradianceFromSky = (1.0 - smoothstepHeight) * (1.0 - (reflectionDotNadir * 0.25 + 0.25));
vec3 diffuseIrradiance = blueSkyDiffuseColor * clamp(diffuseIrradianceFromEarth + diffuseIrradianceFromSky, 0.0, 1.0);
float notDistantRough = (1.0 - horizonDotNadir * roughness * 0.8);
vec3 specularIrradiance = mix(zenithColor, aboveHorizonColor, smoothstep(farAboveHorizon, aroundHorizon, reflectionDotNadir) * notDistantRough);
specularIrradiance = mix(specularIrradiance, belowHorizonColor, smoothstep(aroundHorizon, farBelowHorizon, reflectionDotNadir) * inverseRoughness);
specularIrradiance = mix(specularIrradiance, nadirColor, smoothstep(farBelowHorizon, 1.0, reflectionDotNadir) * inverseRoughness);
#ifdef USE_SUN_LUMINANCE
float LdotZenith = clamp(dot(normalize(czm_inverseViewRotation * l), vWC), 0.001, 1.0);
float S = acos(LdotZenith);
float NdotZenith = clamp(dot(normalize(czm_inverseViewRotation * n), vWC), 0.001, 1.0);
float gamma = acos(NdotL);
float numerator = ((0.91 + 10.0 * exp(-3.0 * gamma) + 0.45 * pow(NdotL, 2.0)) * (1.0 - exp(-0.32 / NdotZenith)));
float denominator = (0.91 + 10.0 * exp(-3.0 * S) + 0.45 * pow(LdotZenith,2.0)) * (1.0 - exp(-0.32));
float luminance = model_luminanceAtZenith * (numerator / denominator);
#endif
vec2 brdfLut = texture2D(czm_brdfLut, vec2(NdotV, roughness)).rg;
vec3 iblColor = (diffuseIrradiance * diffuseColor * model_iblFactor.x) + (specularIrradiance * czm_srgbToLinear(specularColor * brdfLut.x + brdfLut.y) * model_iblFactor.y);
float maximumComponent = max(max(lightColorHdr.x, lightColorHdr.y), lightColorHdr.z);
vec3 lightColor = lightColorHdr / max(maximumComponent, 1.0);
iblColor *= lightColor;
#ifdef USE_SUN_LUMINANCE
iblColor *= luminance;
#endif
return iblColor;
}
#if defined(DIFFUSE_IBL) || defined(SPECULAR_IBL)
vec3 textureIBL(
vec3 positionEC,
vec3 normalEC,
vec3 lightDirectionEC,
czm_pbrParameters pbrParameters
) {
vec3 diffuseColor = pbrParameters.diffuseColor;
float roughness = pbrParameters.roughness;
vec3 specularColor = pbrParameters.f0;
vec3 v = -positionEC;
vec3 n = normalEC;
vec3 l = normalize(lightDirectionEC);
vec3 h = normalize(v + l);
float NdotV = abs(dot(n, v)) + 0.001;
float VdotH = clamp(dot(v, h), 0.0, 1.0);
const mat3 yUpToZUp = mat3(
-1.0, 0.0, 0.0,
0.0, 0.0, -1.0,
0.0, 1.0, 0.0
);
vec3 cubeDir = normalize(yUpToZUp * model_iblReferenceFrameMatrix * normalize(reflect(-v, n)));
#ifdef DIFFUSE_IBL
#ifdef CUSTOM_SPHERICAL_HARMONICS
vec3 diffuseIrradiance = czm_sphericalHarmonics(cubeDir, model_sphericalHarmonicCoefficients);
#else
vec3 diffuseIrradiance = czm_sphericalHarmonics(cubeDir, czm_sphericalHarmonicCoefficients);
#endif
#else
vec3 diffuseIrradiance = vec3(0.0);
#endif
#ifdef SPECULAR_IBL
vec3 r0 = specularColor.rgb;
float reflectance = max(max(r0.r, r0.g), r0.b);
vec3 r90 = vec3(clamp(reflectance * 25.0, 0.0, 1.0));
vec3 F = fresnelSchlick2(r0, r90, VdotH);
vec2 brdfLut = texture2D(czm_brdfLut, vec2(NdotV, roughness)).rg;
#ifdef CUSTOM_SPECULAR_IBL
vec3 specularIBL = czm_sampleOctahedralProjection(model_specularEnvironmentMaps, model_specularEnvironmentMapsSize, cubeDir, roughness * model_specularEnvironmentMapsMaximumLOD, model_specularEnvironmentMapsMaximumLOD);
#else
vec3 specularIBL = czm_sampleOctahedralProjection(czm_specularEnvironmentMaps, czm_specularEnvironmentMapSize, cubeDir,  roughness * czm_specularEnvironmentMapsMaximumLOD, czm_specularEnvironmentMapsMaximumLOD);
#endif
specularIBL *= F * brdfLut.x + brdfLut.y;
#else
vec3 specularIBL = vec3(0.0);
#endif
return diffuseColor * diffuseIrradiance + specularColor * specularIBL;
}
#endif
vec3 imageBasedLightingStage(
vec3 positionEC,
vec3 normalEC,
vec3 lightDirectionEC,
vec3 lightColorHdr,
czm_pbrParameters pbrParameters
) {
#if defined(DIFFUSE_IBL) || defined(SPECULAR_IBL)
return textureIBL(
positionEC,
normalEC,
lightDirectionEC,
pbrParameters
);
#else
return proceduralIBL(
positionEC,
normalEC,
lightDirectionEC,
lightColorHdr,
pbrParameters
);
#endif
}
`;var NQ={name:"ImageBasedLightingPipelineStage"};NQ.process=function(t,n,i){let o=n.imageBasedLighting,r=t.shaderBuilder;r.addDefine("USE_IBL_LIGHTING",void 0,Ee.FRAGMENT),r.addUniform("vec2","model_iblFactor",Ee.FRAGMENT),Kd.isSupported(i.context)&&((o.useSphericalHarmonics||o.useSpecularEnvironmentMaps||o.enabled)&&r.addUniform("mat3","model_iblReferenceFrameMatrix",Ee.FRAGMENT),f(o.sphericalHarmonicCoefficients)?(r.addDefine("DIFFUSE_IBL",void 0,Ee.FRAGMENT),r.addDefine("CUSTOM_SPHERICAL_HARMONICS",void 0,Ee.FRAGMENT),r.addUniform("vec3","model_sphericalHarmonicCoefficients[9]",Ee.FRAGMENT)):o.useDefaultSphericalHarmonics&&r.addDefine("DIFFUSE_IBL",void 0,Ee.FRAGMENT),f(o.specularEnvironmentMapAtlas)&&o.specularEnvironmentMapAtlas.ready?(r.addDefine("SPECULAR_IBL",void 0,Ee.FRAGMENT),r.addDefine("CUSTOM_SPECULAR_IBL",void 0,Ee.FRAGMENT),r.addUniform("sampler2D","model_specularEnvironmentMaps",Ee.FRAGMENT),r.addUniform("vec2","model_specularEnvironmentMapsSize",Ee.FRAGMENT),r.addUniform("float","model_specularEnvironmentMapsMaximumLOD",Ee.FRAGMENT)):n.useDefaultSpecularMaps&&r.addDefine("SPECULAR_IBL",void 0,Ee.FRAGMENT)),f(o.luminanceAtZenith)&&(r.addDefine("USE_SUN_LUMINANCE",void 0,Ee.FRAGMENT),r.addUniform("float","model_luminanceAtZenith",Ee.FRAGMENT)),r.addFragmentLines(UR);let s={model_iblFactor:function(){return o.imageBasedLightingFactor},model_iblReferenceFrameMatrix:function(){return n._iblReferenceFrameMatrix},model_luminanceAtZenith:function(){return o.luminanceAtZenith},model_sphericalHarmonicCoefficients:function(){return o.sphericalHarmonicCoefficients},model_specularEnvironmentMaps:function(){return o.specularEnvironmentMapAtlas.texture},model_specularEnvironmentMapsSize:function(){return o.specularEnvironmentMapAtlas.texture.dimensions},model_specularEnvironmentMapsMaximumLOD:function(){return o.specularEnvironmentMapAtlas.maximumMipmapLevel}};t.uniformMap=At(s,t.uniformMap)};var zR=NQ;var yBe=B.EPSILON16;function cG(t){t=A(t,A.EMPTY_OBJECT);let n=t.stage,i=t.runtimeArticulation;this._stage=n,this._runtimeArticulation=i,this._name=n.name,this._type=n.type,this._minimumValue=n.minimumValue,this._maximumValue=n.maximumValue,this._currentValue=n.initialValue}Object.defineProperties(cG.prototype,{stage:{get:function(){return this._stage}},runtimeArticulation:{get:function(){return this._runtimeArticulation}},name:{get:function(){return this._name}},type:{get:function(){return this._type}},minimumValue:{get:function(){return this._minimumValue}},maximumValue:{get:function(){return this._maximumValue}},currentValue:{get:function(){return this._currentValue},set:function(t){t=B.clamp(t,this.minimumValue,this.maximumValue),B.equalsEpsilon(this._currentValue,t,yBe)||(this._currentValue=t,this.runtimeArticulation._dirty=!0)}}});var ABe=new m,aG=new $;cG.prototype.applyStageToMatrix=function(t){let n=this.type,i=this.currentValue,o=ABe,r;switch(n){case rc.XROTATE:r=$.fromRotationX(B.toRadians(i),aG),t=N.multiplyByMatrix3(t,r,t);break;case rc.YROTATE:r=$.fromRotationY(B.toRadians(i),aG),t=N.multiplyByMatrix3(t,r,t);break;case rc.ZROTATE:r=$.fromRotationZ(B.toRadians(i),aG),t=N.multiplyByMatrix3(t,r,t);break;case rc.XTRANSLATE:o.x=i,o.y=0,o.z=0,t=N.multiplyByTranslation(t,o,t);break;case rc.YTRANSLATE:o.x=0,o.y=i,o.z=0,t=N.multiplyByTranslation(t,o,t);break;case rc.ZTRANSLATE:o.x=0,o.y=0,o.z=i,t=N.multiplyByTranslation(t,o,t);break;case rc.XSCALE:o.x=i,o.y=1,o.z=1,t=N.multiplyByScale(t,o,t);break;case rc.YSCALE:o.x=1,o.y=i,o.z=1,t=N.multiplyByScale(t,o,t);break;case rc.ZSCALE:o.x=1,o.y=1,o.z=i,t=N.multiplyByScale(t,o,t);break;case rc.UNIFORMSCALE:t=N.multiplyByUniformScale(t,i,t);break;default:break}return t};var HR=cG;function GR(t){t=A(t,A.EMPTY_OBJECT);let n=t.articulation,i=t.sceneGraph;this._articulation=n,this._sceneGraph=i,this._name=n.name,this._runtimeStages=[],this._runtimeStagesByName={},this._runtimeNodes=[],this._dirty=!0,CBe(this)}Object.defineProperties(GR.prototype,{articulation:{get:function(){return this._articulation}},sceneGraph:{get:function(){return this._sceneGraph}},name:{get:function(){return this._name}},runtimeStages:{get:function(){return this._runtimeStages}},runtimeNodes:{get:function(){return this._runtimeNodes}}});function CBe(t){let i=t.articulation.stages,o=i.length,r=t._runtimeStages,s=t._runtimeStagesByName;for(let a=0;a<o;a++){let c=i[a],l=new HR({stage:c,runtimeArticulation:t});r.push(l);let u=c.name;s[u]=l}}GR.prototype.setArticulationStage=function(t,n){let i=this._runtimeStagesByName[t];f(i)&&(i.currentValue=n)};var xBe=new N,TBe=new N;GR.prototype.apply=function(){if(!this._dirty)return;this._dirty=!1;let t=N.clone(N.IDENTITY,xBe),n,i=this._runtimeStages,o=i.length;for(n=0;n<o;n++)t=i[n].applyStageToMatrix(t);let r=this._runtimeNodes,s=r.length;for(n=0;n<s;n++){let a=r[n],c=N.multiplyTransformation(a.originalTransform,t,TBe);a.transform=c}};var WR=GR;var jR=`void modelColorStage(inout czm_modelMaterial material)
{
material.diffuse = mix(material.diffuse, model_color.rgb, model_colorBlend);
float highlight = ceil(model_colorBlend);
material.diffuse *= mix(model_color.rgb, vec3(1.0), highlight);
material.alpha *= model_color.a;
}
`;var ex={name:"ModelColorPipelineStage",COLOR_UNIFORM_NAME:"model_color",COLOR_BLEND_UNIFORM_NAME:"model_colorBlend"};ex.process=function(t,n,i){let o=t.shaderBuilder;o.addDefine("HAS_MODEL_COLOR",void 0,Ee.FRAGMENT),o.addFragmentLines(jR);let r={},s=n.color;s.alpha===0&&!n.hasSilhouette(i)&&(t.renderStateOptions.colorMask={red:!1,green:!1,blue:!1,alpha:!1}),s.alpha<1&&(t.alphaOptions.pass=Te.TRANSLUCENT),o.addUniform("vec4",ex.COLOR_UNIFORM_NAME,Ee.FRAGMENT),r[ex.COLOR_UNIFORM_NAME]=function(){return n.color},o.addUniform("float",ex.COLOR_BLEND_UNIFORM_NAME,Ee.FRAGMENT),r[ex.COLOR_BLEND_UNIFORM_NAME]=function(){return oc.getColorBlend(n.colorBlendMode,n.colorBlendAmount)},t.uniformMap=At(r,t.uniformMap)};var z0=ex;var qR=`#ifdef USE_CLIPPING_PLANES_FLOAT_TEXTURE
vec4 getClippingPlane(
highp sampler2D packedClippingPlanes,
int clippingPlaneNumber,
mat4 transform
) {
int pixY = clippingPlaneNumber / CLIPPING_PLANES_TEXTURE_WIDTH;
int pixX = clippingPlaneNumber - (pixY * CLIPPING_PLANES_TEXTURE_WIDTH);
float pixelWidth = 1.0 / float(CLIPPING_PLANES_TEXTURE_WIDTH);
float pixelHeight = 1.0 / float(CLIPPING_PLANES_TEXTURE_HEIGHT);
float u = (float(pixX) + 0.5) * pixelWidth;
float v = (float(pixY) + 0.5) * pixelHeight;
vec4 plane = texture2D(packedClippingPlanes, vec2(u, v));
return czm_transformPlane(plane, transform);
}
#else
vec4 getClippingPlane(
highp sampler2D packedClippingPlanes,
int clippingPlaneNumber,
mat4 transform
) {
int clippingPlaneStartIndex = clippingPlaneNumber * 2;
int pixY = clippingPlaneStartIndex / CLIPPING_PLANES_TEXTURE_WIDTH;
int pixX = clippingPlaneStartIndex - (pixY * CLIPPING_PLANES_TEXTURE_WIDTH);
float pixelWidth = 1.0 / float(CLIPPING_PLANES_TEXTURE_WIDTH);
float pixelHeight = 1.0 / float(CLIPPING_PLANES_TEXTURE_HEIGHT);
float u = (float(pixX) + 0.5) * pixelWidth;
float v = (float(pixY) + 0.5) * pixelHeight;
vec4 oct32 = texture2D(packedClippingPlanes, vec2(u, v)) * 255.0;
vec2 oct = vec2(oct32.x * 256.0 + oct32.y, oct32.z * 256.0 + oct32.w);
vec4 plane;
plane.xyz = czm_octDecode(oct, 65535.0);
plane.w = czm_unpackFloat(texture2D(packedClippingPlanes, vec2(u + pixelWidth, v)));
return czm_transformPlane(plane, transform);
}
#endif
float clip(vec4 fragCoord, sampler2D clippingPlanes, mat4 clippingPlanesMatrix) {
vec4 position = czm_windowToEyeCoordinates(fragCoord);
vec3 clipNormal = vec3(0.0);
vec3 clipPosition = vec3(0.0);
float pixelWidth = czm_metersPerPixel(position);
#ifdef UNION_CLIPPING_REGIONS
float clipAmount;
#else
float clipAmount = 0.0;
bool clipped = true;
#endif
for (int i = 0; i < CLIPPING_PLANES_LENGTH; ++i) {
vec4 clippingPlane = getClippingPlane(clippingPlanes, i, clippingPlanesMatrix);
clipNormal = clippingPlane.xyz;
clipPosition = -clippingPlane.w * clipNormal;
float amount = dot(clipNormal, (position.xyz - clipPosition)) / pixelWidth;
#ifdef UNION_CLIPPING_REGIONS
clipAmount = czm_branchFreeTernary(i == 0, amount, min(amount, clipAmount));
if (amount <= 0.0) {
discard;
}
#else
clipAmount = max(amount, clipAmount);
clipped = clipped && (amount <= 0.0);
#endif
}
#ifndef UNION_CLIPPING_REGIONS
if (clipped) {
discard;
}
#endif
return clipAmount;
}
void modelClippingPlanesStage(inout vec4 color)
{
float clipDistance = clip(gl_FragCoord, model_clippingPlanes, model_clippingPlanesMatrix);
vec4 clippingPlanesEdgeColor = vec4(1.0);
clippingPlanesEdgeColor.rgb = model_clippingPlanesEdgeStyle.rgb;
float clippingPlanesEdgeWidth = model_clippingPlanesEdgeStyle.a;
if (clipDistance > 0.0 && clipDistance < clippingPlanesEdgeWidth) {
color = clippingPlanesEdgeColor;
}
}
`;var VQ={name:"ModelClippingPlanesPipelineStage"},EBe=new W;VQ.process=function(t,n,i){let o=n.clippingPlanes,r=i.context,s=t.shaderBuilder;s.addDefine("HAS_CLIPPING_PLANES",void 0,Ee.FRAGMENT),s.addDefine("CLIPPING_PLANES_LENGTH",o.length,Ee.FRAGMENT),o.unionClippingRegions&&s.addDefine("UNION_CLIPPING_REGIONS",void 0,Ee.FRAGMENT),Qs.useFloatTexture(r)&&s.addDefine("USE_CLIPPING_PLANES_FLOAT_TEXTURE",void 0,Ee.FRAGMENT);let a=Qs.getTextureResolution(o,r,EBe);s.addDefine("CLIPPING_PLANES_TEXTURE_WIDTH",a.x,Ee.FRAGMENT),s.addDefine("CLIPPING_PLANES_TEXTURE_HEIGHT",a.y,Ee.FRAGMENT),s.addUniform("sampler2D","model_clippingPlanes",Ee.FRAGMENT),s.addUniform("vec4","model_clippingPlanesEdgeStyle",Ee.FRAGMENT),s.addUniform("mat4","model_clippingPlanesMatrix",Ee.FRAGMENT),s.addFragmentLines(qR);let c={model_clippingPlanes:function(){return o.texture},model_clippingPlanesEdgeStyle:function(){let l=z.clone(o.edgeColor);return l.alpha=o.edgeWidth,l},model_clippingPlanesMatrix:function(){return n._clippingPlanesMatrix}};t.uniformMap=At(c,t.uniformMap)};var YR=VQ;function kQ(t,n){this._model=t,this._runtimeNode=n}Object.defineProperties(kQ.prototype,{name:{get:function(){return this._runtimeNode._name}},id:{get:function(){return this._runtimeNode._id}},show:{get:function(){return this._runtimeNode.show},set:function(t){this._runtimeNode.show=t}},matrix:{get:function(){return this._runtimeNode.transform},set:function(t){f(t)?(this._runtimeNode.transform=t,this._runtimeNode.userAnimated=!0,this._model._userAnimationDirty=!0):(this._runtimeNode.transform=this.originalMatrix,this._runtimeNode.userAnimated=!1)}},originalMatrix:{get:function(){return this._runtimeNode.originalTransform}}});var XR=kQ;var bBe=new m(1,1,1),SBe=m.ZERO,wBe=Me.IDENTITY;function UQ(t,n,i){this.translation=m.clone(A(t,SBe)),this.rotation=Me.clone(A(n,wBe)),this.scale=m.clone(A(i,bBe))}UQ.prototype.equals=function(t){return this===t||f(t)&&m.equals(this.translation,t.translation)&&Me.equals(this.rotation,t.rotation)&&m.equals(this.scale,t.scale)};var H0=UQ;var KR=`mat4 getInstancingTransform()
{
mat4 instancingTransform;
#ifdef HAS_INSTANCE_MATRICES
instancingTransform = mat4(
a_instancingTransformRow0.x, a_instancingTransformRow1.x, a_instancingTransformRow2.x, 0.0,
a_instancingTransformRow0.y, a_instancingTransformRow1.y, a_instancingTransformRow2.y, 0.0,
a_instancingTransformRow0.z, a_instancingTransformRow1.z, a_instancingTransformRow2.z, 0.0,
a_instancingTransformRow0.w, a_instancingTransformRow1.w, a_instancingTransformRow2.w, 1.0
);
#else
vec3 translation = vec3(0.0, 0.0, 0.0);
vec3 scale = vec3(1.0, 1.0, 1.0);
#ifdef HAS_INSTANCE_TRANSLATION
translation = a_instanceTranslation;
#endif
#ifdef HAS_INSTANCE_SCALE
scale = a_instanceScale;
#endif
instancingTransform = mat4(
scale.x, 0.0, 0.0, 0.0,
0.0, scale.y, 0.0, 0.0,
0.0, 0.0, scale.z, 0.0,
translation.x, translation.y, translation.z, 1.0
);
#endif
return instancingTransform;
}
#ifdef USE_2D_INSTANCING
mat4 getInstancingTransform2D()
{
mat4 instancingTransform2D;
#ifdef HAS_INSTANCE_MATRICES
instancingTransform2D = mat4(
a_instancingTransform2DRow0.x, a_instancingTransform2DRow1.x, a_instancingTransform2DRow2.x, 0.0,
a_instancingTransform2DRow0.y, a_instancingTransform2DRow1.y, a_instancingTransform2DRow2.y, 0.0,
a_instancingTransform2DRow0.z, a_instancingTransform2DRow1.z, a_instancingTransform2DRow2.z, 0.0,
a_instancingTransform2DRow0.w, a_instancingTransform2DRow1.w, a_instancingTransform2DRow2.w, 1.0
);
#else
vec3 translation2D = vec3(0.0, 0.0, 0.0);
vec3 scale = vec3(1.0, 1.0, 1.0);
#ifdef HAS_INSTANCE_TRANSLATION
translation2D = a_instanceTranslation2D;
#endif
#ifdef HAS_INSTANCE_SCALE
scale = a_instanceScale;
#endif
instancingTransform2D = mat4(
scale.x, 0.0, 0.0, 0.0,
0.0, scale.y, 0.0, 0.0,
0.0, 0.0, scale.z, 0.0,
translation2D.x, translation2D.y, translation2D.z, 1.0
);
#endif
return instancingTransform2D;
}
#endif
`;var JR=`void instancingStage(inout ProcessedAttributes attributes)
{
vec3 positionMC = attributes.positionMC;
mat4 instancingTransform = getInstancingTransform();
attributes.positionMC = (instancingTransform * vec4(positionMC, 1.0)).xyz;
#ifdef HAS_NORMALS
vec3 normalMC = attributes.normalMC;
attributes.normalMC = (instancingTransform * vec4(normalMC, 0.0)).xyz;
#endif
#ifdef USE_2D_INSTANCING
mat4 instancingTransform2D = getInstancingTransform2D();
attributes.position2D = (instancingTransform2D * vec4(positionMC, 1.0)).xyz;
#endif
}
`;var ZR=`void legacyInstancingStage(
inout ProcessedAttributes attributes,
out mat4 instanceModelView,
out mat3 instanceModelViewInverseTranspose)
{
vec3 positionMC = attributes.positionMC;
mat4 instancingTransform = getInstancingTransform();
mat4 instanceModel = instancingTransform * u_instance_nodeTransform;
instanceModelView = u_instance_modifiedModelView;
instanceModelViewInverseTranspose = mat3(u_instance_modifiedModelView * instanceModel);
attributes.positionMC = (instanceModel * vec4(positionMC, 1.0)).xyz;
#ifdef USE_2D_INSTANCING
mat4 instancingTransform2D = getInstancingTransform2D();
attributes.position2D = (instancingTransform2D * vec4(positionMC, 1.0)).xyz;
#endif
}
`;var QR=new N,DBe=new N,vBe=new N,HQ={name:"InstancingPipelineStage",_getInstanceTransformsAsMatrices:YQ,_transformsToTypedArray:uG};HQ.process=function(t,n,i){let o=n.instances,r=o.attributes[0].count,s=t.shaderBuilder;s.addDefine("HAS_INSTANCING"),s.addVertexLines(KR);let a=t.model,c=a.sceneGraph,l=t.runtimeNode,u=i.mode!==ne.SCENE3D&&!i.scene3DOnly&&a._projectTo2D,d=[];GBe(t,i,o,d,u),qBe(t,i,o,d);let h={};if(o.transformInWorldSpace?(s.addDefine("USE_LEGACY_INSTANCING",void 0,Ee.VERTEX),s.addUniform("mat4","u_instance_modifiedModelView",Ee.VERTEX),s.addUniform("mat4","u_instance_nodeTransform",Ee.VERTEX),h.u_instance_modifiedModelView=function(){let _=N.multiplyTransformation(a.modelMatrix,c.components.transform,QR);return u?N.multiplyTransformation(i.context.uniformState.view3D,_,QR):(i.mode!==ne.SCENE3D&&(_=vt.basisTo2D(i.mapProjection,_,QR)),N.multiplyTransformation(i.context.uniformState.view,_,QR))},h.u_instance_nodeTransform=function(){return N.multiplyTransformation(c.axisCorrectionMatrix,l.computedTransform,DBe)},s.addVertexLines(ZR)):s.addVertexLines(JR),u){s.addDefine("USE_2D_INSTANCING",void 0,Ee.VERTEX),s.addUniform("mat4","u_modelView2D",Ee.VERTEX);let _=i.context,y=N.fromTranslation(l.instancingReferencePoint2D,new N);h.u_modelView2D=function(){return N.multiplyTransformation(_.uniformState.view,y,vBe)}}t.uniformMap=At(h,t.uniformMap),t.instanceCount=r,t.attributes.push.apply(t.attributes,d)};var mS=new N,PBe=new m;function IBe(t,n,i,o,r){let s=N.multiplyTransformation(n,t,mS);return s=N.multiplyTransformation(s,i,mS),r=vt.basisTo2D(o.mapProjection,s,r),r}function BBe(t,n,i,o,r){let s=N.fromTranslation(t,mS),a=N.multiplyTransformation(n,s,mS);a=N.multiplyTransformation(a,i,mS);let c=N.getTranslation(a,PBe);return r=Yi.computeActualWgs84Position(o,c,r),r}function GQ(t,n,i){let o=t.model,r=o.sceneGraph;t.runtimeNode.node.instances.transformInWorldSpace?(n=N.multiplyTransformation(o.modelMatrix,r.components.transform,n),i=N.multiplyTransformation(r.axisCorrectionMatrix,t.runtimeNode.computedTransform,i)):(n=N.clone(r.computedModelMatrix,n),n=N.multiplyTransformation(n,t.runtimeNode.computedTransform,n),i=N.clone(N.IDENTITY,i))}var WQ=new N,jQ=new N,OBe=new N,RBe=new m;function MBe(t,n,i,o){let r=WQ,s=jQ;GQ(n,r,s);let c=n.runtimeNode.instancingReferencePoint2D,l=t.length;for(let u=0;u<l;u++){let d=t[u],h=IBe(d,r,s,i,OBe),_=N.getTranslation(h,RBe),y=m.subtract(_,c,_);o[u]=N.setTranslation(h,y,o[u])}return o}function LBe(t,n,i,o){let r=WQ,s=jQ;GQ(n,r,s);let c=n.runtimeNode.instancingReferencePoint2D,l=t.length;for(let u=0;u<l;u++){let d=t[u],h=BBe(d,r,s,i,d);o[u]=m.subtract(h,c,o[u])}return o}var FBe=new m,NBe=new m;function qQ(t,n){let i=t.runtimeNode,o=t.model.sceneGraph.computedModelMatrix,r=N.multiplyByPoint(o,i.instancingTranslationMin,FBe),s=Yi.computeActualWgs84Position(n,r,r),a=N.multiplyByPoint(o,i.instancingTranslationMax,NBe),c=Yi.computeActualWgs84Position(n,a,a);i.instancingReferencePoint2D=m.lerp(s,c,.5,new m)}function uG(t){let i=t.length,o=new Float32Array(i*12);for(let r=0;r<i;r++){let s=t[r],a=12*r;o[a+0]=s[0],o[a+1]=s[4],o[a+2]=s[8],o[a+3]=s[12],o[a+4]=s[1],o[a+5]=s[5],o[a+6]=s[9],o[a+7]=s[13],o[a+8]=s[2],o[a+9]=s[6],o[a+10]=s[10],o[a+11]=s[14]}return o}function VBe(t){let i=t.length,o=new Float32Array(i*3);for(let r=0;r<i;r++){let s=t[r],a=3*r;o[a+0]=s[0],o[a+1]=s[4],o[a+2]=s[8]}return o}var kBe=new m,UBe=new Me,zBe=new m;function YQ(t,n,i){let o=new Array(n),r=on.getAttributeBySemantic(t,Gr.TRANSLATION),s=on.getAttributeBySemantic(t,Gr.ROTATION),a=on.getAttributeBySemantic(t,Gr.SCALE),c=new m(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),l=new m(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),u=f(r),d=f(s),h=f(a),_=u?r.typedArray:new Float32Array(n*3),y=d?s.typedArray:new Float32Array(n*4);d&&s.normalized&&(y=zn.dequantize(y,s.componentDatatype,s.type,n));let p;h?p=a.typedArray:(p=new Float32Array(n*3),p.fill(1));for(let x=0;x<n;x++){let T=new m(_[x*3],_[x*3+1],_[x*3+2],kBe);m.maximumByComponent(c,T,c),m.minimumByComponent(l,T,l);let E=new Me(y[x*4],y[x*4+1],y[x*4+2],d?y[x*4+3]:1,UBe),S=new m(p[x*3],p[x*3+1],p[x*3+2],zBe),w=N.fromTranslationQuaternionRotationScale(T,E,S,new N);o[x]=w}let C=i.runtimeNode;return C.instancingTranslationMin=l,C.instancingTranslationMax=c,u&&(r.typedArray=void 0),d&&(s.typedArray=void 0),h&&(a.typedArray=void 0),o}function HBe(t,n,i){let o=new Array(n),r=t.typedArray,s=new m(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),a=new m(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(let l=0;l<n;l++){let u=new m(r[l*3],r[l*3+1],r[l*3+2]);o[l]=u,m.minimumByComponent(s,u,s),m.maximumByComponent(a,u,a)}let c=i.runtimeNode;return c.instancingTranslationMin=s,c.instancingTranslationMax=a,t.typedArray=void 0,o}function fG(t,n){let i=ut.createVertexBuffer({context:n.context,typedArray:t,usage:Fe.STATIC_DRAW});return i.vertexArrayDestroyable=!1,i}function GBe(t,n,i,o,r){let s=on.getAttributeBySemantic(i,Gr.ROTATION);f(s)?WBe(t,i,o,n,r):jBe(t,i,o,n,r)}function WBe(t,n,i,o,r){let s=t.shaderBuilder,a=n.attributes[0].count,c=t.model,l=t.runtimeNode;s.addDefine("HAS_INSTANCE_MATRICES");let u="Transform",d,h=l.instancingTransformsBuffer;if(!f(h)){d=YQ(n,a,t);let C=uG(d);h=fG(C,o),c._modelResources.push(h),l.instancingTransformsBuffer=h}if(zQ(t,h,i,u),!r)return;let _=tt(o);_.mode=ne.COLUMBUS_VIEW,qQ(t,_);let y=l.instancingTransformsBuffer2D;if(!f(y)){let C=MBe(d,t,_,d),x=uG(C);y=fG(x,o),c._modelResources.push(y),l.instancingTransformsBuffer2D=y}zQ(t,y,i,"Transform2D")}function jBe(t,n,i,o,r){let s=t.shaderBuilder,a=t.runtimeNode,c=on.getAttributeBySemantic(n,Gr.TRANSLATION),l=on.getAttributeBySemantic(n,Gr.SCALE);if(f(l)){s.addDefine("HAS_INSTANCE_SCALE");let T="Scale";lG(t,l.buffer,l.byteOffset,l.byteStride,i,T)}if(!f(c))return;let u,d=c.typedArray;f(d)?u=HBe(c,c.count,t):f(a.instancingTranslationMin)||(a.instancingTranslationMin=c.min,a.instancingTranslationMax=c.max),s.addDefine("HAS_INSTANCE_TRANSLATION");let h="Translation";if(lG(t,c.buffer,c.byteOffset,c.byteStride,i,h),!r)return;let _=tt(o);_.mode=ne.COLUMBUS_VIEW,qQ(t,_);let y=a.instancingTranslationBuffer2D;if(!f(y)){let T=LBe(u,t,_,u),E=VBe(T);y=fG(E,o),t.model._modelResources.push(y),a.instancingTranslationBuffer2D=y}lG(t,y,0,void 0,i,"Translation2D")}function zQ(t,n,i,o){let s=J.getSizeInBytes(J.FLOAT),a=s*12,c=[{index:t.attributeIndex++,vertexBuffer:n,componentsPerAttribute:4,componentDatatype:J.FLOAT,normalize:!1,offsetInBytes:0,strideInBytes:a,instanceDivisor:1},{index:t.attributeIndex++,vertexBuffer:n,componentsPerAttribute:4,componentDatatype:J.FLOAT,normalize:!1,offsetInBytes:s*4,strideInBytes:a,instanceDivisor:1},{index:t.attributeIndex++,vertexBuffer:n,componentsPerAttribute:4,componentDatatype:J.FLOAT,normalize:!1,offsetInBytes:s*8,strideInBytes:a,instanceDivisor:1}],l=t.shaderBuilder;l.addAttribute("vec4",`a_instancing${o}Row0`),l.addAttribute("vec4",`a_instancing${o}Row1`),l.addAttribute("vec4",`a_instancing${o}Row2`),i.push.apply(i,c)}function lG(t,n,i,o,r,s){r.push({index:t.attributeIndex++,vertexBuffer:n,componentsPerAttribute:3,componentDatatype:J.FLOAT,normalize:!1,offsetInBytes:i,strideInBytes:o,instanceDivisor:1}),t.shaderBuilder.addAttribute("vec3",`a_instance${s}`)}function qBe(t,n,i,o){let r=i.attributes,s=t.shaderBuilder;for(let a=0;a<r.length;a++){let c=r[a];c.semantic===Gr.FEATURE_ID&&(c.setIndex>=t.featureIdVertexAttributeSetIndex&&(t.featureIdVertexAttributeSetIndex=c.setIndex+1),o.push({index:t.attributeIndex++,vertexBuffer:c.buffer,componentsPerAttribute:nn.getNumberOfComponents(c.type),componentDatatype:c.componentDatatype,normalize:!1,offsetInBytes:c.byteOffset,strideInBytes:c.byteStride,instanceDivisor:1}),s.addAttribute("float",`a_instanceFeatureId_${c.setIndex}`))}}var $R=HQ;var dG={};dG.name="ModelMatrixUpdateStage";dG.update=function(t,n,i){let o=i.mode!==ne.SCENE3D;if(!(o&&n._model._projectTo2D)&&t._transformDirty){let r=o?n._computedModelMatrix2D:n._computedModelMatrix;XQ(t,n,r,t.transformToRoot),t._transformDirty=!1}};function XQ(t,n,i,o){let r;o=N.multiplyTransformation(o,t.transform,new N),t.updateComputedTransform();let s=t.runtimePrimitives.length;for(r=0;r<s;r++){let l=t.runtimePrimitives[r].drawCommand;l.modelMatrix=N.multiplyTransformation(i,o,l.modelMatrix),l.cullFace=on.getCullFace(l.modelMatrix,l.primitiveType)}let a=t.children.length;for(r=0;r<a;r++){let c=n._runtimeNodes[t.children[r]];c._transformToRoot=N.clone(o,c._transformToRoot),XQ(c,n,i,o),c._transformDirty=!1}}var eM=dG;var KQ={name:"NodeStatisticsPipelineStage",_countInstancingAttributes:JQ,_countGeneratedBuffers:ZQ};KQ.process=function(t,n,i){let o=t.model.statistics,r=n.instances,s=t.runtimeNode;JQ(o,r),ZQ(o,s)};function JQ(t,n){if(!f(n))return;let i=n.attributes,o=i.length;for(let r=0;r<o;r++){let s=i[r];f(s.buffer)&&t.addBuffer(s.buffer,!1)}}function ZQ(t,n){f(n.instancingTransformsBuffer)&&t.addBuffer(n.instancingTransformsBuffer,!1),f(n.instancingTransformsBuffer2D)&&t.addBuffer(n.instancingTransformsBuffer2D,!1),f(n.instancingTranslationBuffer2D)&&t.addBuffer(n.instancingTranslationBuffer2D,!1)}var tM=KQ;function tx(t){t=A(t,A.EMPTY_OBJECT);let n=t.node,i=t.transform,o=t.transformToRoot,r=t.sceneGraph,s=t.children;this._node=n,this._name=n.name,this._id=n.index,this._sceneGraph=r,this._children=s,this._originalTransform=N.clone(i,this._originalTransform),this._transform=N.clone(i,this._transform),this._transformToRoot=N.clone(o,this._transformToRoot),this._computedTransform=new N,this._transformDirty=!1,this._transformParameters=void 0,this._morphWeights=[],this._runtimeSkin=void 0,this._computedJointMatrices=[],this.show=!0,this.userAnimated=!1,this.pipelineStages=[],this.runtimePrimitives=[],this.updateStages=[],this.instancingTranslationMin=void 0,this.instancingTranslationMax=void 0,this.instancingTransformsBuffer=void 0,this.instancingTransformsBuffer2D=void 0,this.instancingTranslationBuffer2D=void 0,this.instancingReferencePoint2D=void 0,YBe(this)}Object.defineProperties(tx.prototype,{node:{get:function(){return this._node}},sceneGraph:{get:function(){return this._sceneGraph}},children:{get:function(){return this._children}},transform:{get:function(){return this._transform},set:function(t){this._transformDirty=!0,this._transform=N.clone(t,this._transform)}},transformToRoot:{get:function(){return this._transformToRoot}},computedTransform:{get:function(){return this._computedTransform}},originalTransform:{get:function(){return this._originalTransform}},translation:{get:function(){return f(this._transformParameters)?this._transformParameters.translation:void 0},set:function(t){let n=this._transformParameters,i=n.translation;m.equals(i,t)||(n.translation=m.clone(t,n.translation),hG(this,n))}},rotation:{get:function(){return f(this._transformParameters)?this._transformParameters.rotation:void 0},set:function(t){let n=this._transformParameters,i=n.rotation;Me.equals(i,t)||(n.rotation=Me.clone(t,n.rotation),hG(this,n))}},scale:{get:function(){return f(this._transformParameters)?this._transformParameters.scale:void 0},set:function(t){let n=this._transformParameters,i=n.scale;m.equals(i,t)||(n.scale=m.clone(t,n.scale),hG(this,n))}},morphWeights:{get:function(){return this._morphWeights},set:function(t){let n=t.length;for(let i=0;i<n;i++)this._morphWeights[i]=t[i]}},runtimeSkin:{get:function(){return this._runtimeSkin}},computedJointMatrices:{get:function(){return this._computedJointMatrices}}});function YBe(t){let n=t.transform,i=t.transformToRoot,o=t._computedTransform;t._computedTransform=N.multiply(i,n,o);let r=t.node;f(r.matrix)||(t._transformParameters=new H0(r.translation,r.rotation,r.scale)),f(r.morphWeights)&&(t._morphWeights=r.morphWeights.slice());let s=r.articulationName;if(f(s)){let l=t.sceneGraph._runtimeArticulations[s];f(l)&&l.runtimeNodes.push(t)}}function hG(t,n){t._transformDirty=!0,t._transform=N.fromTranslationRotationScale(n,t._transform)}tx.prototype.getChild=function(t){return this.sceneGraph._runtimeNodes[this.children[t]]};tx.prototype.configurePipeline=function(){let t=this.node,n=this.pipelineStages;n.length=0;let i=this.updateStages;i.length=0,f(t.instances)&&n.push($R),n.push(tM),i.push(eM)};tx.prototype.updateComputedTransform=function(){this._computedTransform=N.multiply(this._transformToRoot,this._transform,this._computedTransform)};tx.prototype.updateJointMatrices=function(){let t=this._runtimeSkin;if(!f(t))return;t.updateJointMatrices();let n=this._computedJointMatrices,i=t.jointMatrices,o=i.length;for(let r=0;r<o;r++){f(n[r])||(n[r]=new N);let s=N.multiplyTransformation(this.transformToRoot,this.transform,n[r]),a=N.inverseTransformation(s,n[r]);n[r]=N.multiplyTransformation(a,i[r],n[r])}};var nM=tx;var QQ={name:"AlphaPipelineStage"};QQ.process=function(t,n,i){let o=t.alphaOptions,r=t.model;o.pass=A(o.pass,r.opaquePass);let s=t.renderStateOptions;o.pass===Te.TRANSLUCENT&&(s.cull.enabled=!1,s.depthMask=!1,s.blending=ln.ALPHA_BLEND);let a=t.shaderBuilder,c=t.uniformMap;f(o.alphaCutoff)&&(a.addDefine("ALPHA_MODE_MASK",void 0,Ee.FRAGMENT),a.addUniform("float","u_alphaCutoff",Ee.FRAGMENT),c.u_alphaCutoff=function(){return o.alphaCutoff})};var iM=QQ;var $Q={name:"BatchTexturePipelineStage"};$Q.process=function(t,n,i){let o=t.shaderBuilder,r={},s=t.model,a=s.featureTables[s.featureTableId],c=a.featuresLength;o.addUniform("int","model_featuresLength"),r.model_featuresLength=function(){return c};let l=a.batchTexture;o.addUniform("sampler2D","model_batchTexture"),r.model_batchTexture=function(){return A(l.batchTexture,l.defaultTexture)},o.addUniform("vec4","model_textureStep"),r.model_textureStep=function(){return l.textureStep},l.textureDimensions.y>1&&(o.addDefine("MULTILINE_BATCH_TEXTURE"),o.addUniform("vec2","model_textureDimensions"),r.model_textureDimensions=function(){return l.textureDimensions}),t.uniformMap=At(r,t.uniformMap)};var oM=$Q;var e$={name:"ClassificationPipelineStage"};e$.process=function(t,n,i){t.shaderBuilder.addDefine("HAS_CLASSIFICATION",void 0,Ee.BOTH);let r=t.runtimePrimitive;f(r.batchLengths)||XBe(n,r)};function XBe(t,n){let i=on.getAttributeBySemantic(t,Tt.POSITION);if(!f(i))throw new he("Primitives must have a position attribute to be used for classification.");let o,r=t.indices,s=f(r);s&&(o=r.typedArray,r.typedArray=void 0);let a=s?r.count:i.count,c=on.getAttributeBySemantic(t,Tt.FEATURE_ID,0);if(!f(c)){n.batchLengths=[a],n.batchOffsets=[0];return}let l=c.typedArray;c.typedArray=void 0;let u=[],d=[0],h=s?o[0]:0,_=l[h],y=0;for(let C=1;C<a;C++){let x=s?o[C]:C,T=l[x];if(T!==_){let E=C-y,S=C;u.push(E),d.push(S),y=S,_=T}}let p=a-y;u.push(p),n.batchLengths=u,n.batchOffsets=d}var rM=e$;var sM=`void filterByPassType(inout vec3 positionMC, vec4 featureColor)
{
bool styleTranslucent = (featureColor.a != 1.0);
if (czm_pass == czm_passTranslucent && !styleTranslucent && !model_commandTranslucent)
{
#ifdef HAS_SILHOUETTE
positionMC *= float(model_silhouettePass);
#else
positionMC *= 0.0;
#endif
}
else if (czm_pass != czm_passTranslucent && styleTranslucent)
{
positionMC *= 0.0;
}
}
void cpuStylingStage(inout vec3 positionMC, inout SelectedFeature feature)
{
float show = ceil(feature.color.a);
positionMC *= show;
#if defined(HAS_SELECTED_FEATURE_ID_ATTRIBUTE) && !defined(HAS_CLASSIFICATION)
filterByPassType(positionMC, feature.color);
#endif
}
`;var aM=`void filterByPassType(vec4 featureColor)
{
bool styleTranslucent = (featureColor.a != 1.0);
if (czm_pass == czm_passTranslucent && !styleTranslucent && !model_commandTranslucent)
{
#ifdef HAS_SILHOUETTE
if(!model_silhouettePass) {
discard;
}
#else
discard;
#endif
}
else if (czm_pass != czm_passTranslucent && styleTranslucent)
{
discard;
}
}
void cpuStylingStage(inout czm_modelMaterial material, SelectedFeature feature)
{
vec4 featureColor = feature.color;
if (featureColor.a == 0.0)
{
discard;
}
#if defined(HAS_SELECTED_FEATURE_ID_TEXTURE) && !defined(HAS_CLASSIFICATION)
filterByPassType(featureColor);
#endif
featureColor = czm_gammaCorrect(featureColor);
#ifdef HAS_CLASSIFICATION
material.diffuse = featureColor.rgb * featureColor.a;
#else
float highlight = ceil(model_colorBlend);
material.diffuse *= mix(featureColor.rgb, vec3(1.0), highlight);
#endif
material.alpha *= featureColor.a;
}
`;var t$={name:"CPUStylingPipelineStage"};t$.process=function(t,n,i){let o=t.model,r=t.shaderBuilder;r.addVertexLines(sM),r.addFragmentLines(aM),r.addDefine("USE_CPU_STYLING",void 0,Ee.BOTH),f(o.color)||(r.addUniform("float",z0.COLOR_BLEND_UNIFORM_NAME,Ee.FRAGMENT),t.uniformMap[z0.COLOR_BLEND_UNIFORM_NAME]=function(){return oc.getColorBlend(o.colorBlendMode,o.colorBlendAmount)}),r.addUniform("bool","model_commandTranslucent",Ee.BOTH),t.uniformMap.model_commandTranslucent=function(){return t.alphaOptions.pass===Te.TRANSLUCENT}};var cM=t$;var n$={MODIFY_MATERIAL:"MODIFY_MATERIAL",REPLACE_MATERIAL:"REPLACE_MATERIAL"};n$.getDefineName=function(t){return`CUSTOM_SHADER_${t}`};var f_=Object.freeze(n$);var lM=`void customShaderStage(
inout czm_modelVertexOutput vsOutput,
inout ProcessedAttributes attributes,
FeatureIds featureIds,
Metadata metadata,
MetadataClass metadataClass,
MetadataStatistics metadataStatistics
) {
VertexInput vsInput;
initializeInputStruct(vsInput, attributes);
vsInput.featureIds = featureIds;
vsInput.metadata = metadata;
vsInput.metadataClass = metadataClass;
vsInput.metadataStatistics = metadataStatistics;
vertexMain(vsInput, vsOutput);
attributes.positionMC = vsOutput.positionMC;
}
`;var uM=`void customShaderStage(
inout czm_modelMaterial material,
ProcessedAttributes attributes,
FeatureIds featureIds,
Metadata metadata,
MetadataClass metadataClass,
MetadataStatistics metadataStatistics
) {
FragmentInput fsInput;
initializeInputStruct(fsInput, attributes);
fsInput.featureIds = featureIds;
fsInput.metadata = metadata;
fsInput.metadataClass = metadataClass;
fsInput.metadataStatistics = metadataStatistics;
fragmentMain(fsInput, material);
}
`;var fM=`void featureIdStage(out FeatureIds featureIds, ProcessedAttributes attributes) {
initializeFeatureIds(featureIds, attributes);
initializeFeatureIdAliases(featureIds);
}
`;var dM=`void featureIdStage(out FeatureIds featureIds, ProcessedAttributes attributes)
{
initializeFeatureIds(featureIds, attributes);
initializeFeatureIdAliases(featureIds);
setFeatureIdVaryings();
}
`;var Ei={name:"FeatureIdPipelineStage",STRUCT_ID_FEATURE_IDS_VS:"FeatureIdsVS",STRUCT_ID_FEATURE_IDS_FS:"FeatureIdsFS",STRUCT_NAME_FEATURE_IDS:"FeatureIds",FUNCTION_ID_INITIALIZE_FEATURE_IDS_VS:"initializeFeatureIdsVS",FUNCTION_ID_INITIALIZE_FEATURE_IDS_FS:"initializeFeatureIdsFS",FUNCTION_ID_INITIALIZE_FEATURE_ID_ALIASES_VS:"initializeFeatureIdAliasesVS",FUNCTION_ID_INITIALIZE_FEATURE_ID_ALIASES_FS:"initializeFeatureIdAliasesFS",FUNCTION_SIGNATURE_INITIALIZE_FEATURE_IDS:"void initializeFeatureIds(out FeatureIds featureIds, ProcessedAttributes attributes)",FUNCTION_SIGNATURE_INITIALIZE_FEATURE_ID_ALIASES:"void initializeFeatureIdAliases(inout FeatureIds featureIds)",FUNCTION_ID_SET_FEATURE_ID_VARYINGS:"setFeatureIdVaryings",FUNCTION_SIGNATURE_SET_FEATURE_ID_VARYINGS:"void setFeatureIdVaryings()"};Ei.process=function(t,n,i){let o=t.shaderBuilder;KBe(o);let r=t.runtimeNode.node.instances;f(r)&&JBe(t,r,i),ZBe(t,n,i),o.addVertexLines(dM),o.addFragmentLines(fM)};function KBe(t){t.addStruct(Ei.STRUCT_ID_FEATURE_IDS_VS,Ei.STRUCT_NAME_FEATURE_IDS,Ee.VERTEX),t.addStruct(Ei.STRUCT_ID_FEATURE_IDS_FS,Ei.STRUCT_NAME_FEATURE_IDS,Ee.FRAGMENT),t.addFunction(Ei.FUNCTION_ID_INITIALIZE_FEATURE_IDS_VS,Ei.FUNCTION_SIGNATURE_INITIALIZE_FEATURE_IDS,Ee.VERTEX),t.addFunction(Ei.FUNCTION_ID_INITIALIZE_FEATURE_IDS_FS,Ei.FUNCTION_SIGNATURE_INITIALIZE_FEATURE_IDS,Ee.FRAGMENT),t.addFunction(Ei.FUNCTION_ID_INITIALIZE_FEATURE_ID_ALIASES_VS,Ei.FUNCTION_SIGNATURE_INITIALIZE_FEATURE_ID_ALIASES,Ee.VERTEX),t.addFunction(Ei.FUNCTION_ID_INITIALIZE_FEATURE_ID_ALIASES_FS,Ei.FUNCTION_SIGNATURE_INITIALIZE_FEATURE_ID_ALIASES,Ee.FRAGMENT),t.addFunction(Ei.FUNCTION_ID_SET_FEATURE_ID_VARYINGS,Ei.FUNCTION_SIGNATURE_SET_FEATURE_ID_VARYINGS,Ee.VERTEX)}function JBe(t,n,i){let o=n.featureIds,r=n.attributes[0].count;for(let s=0;s<o.length;s++){let a=o[s],c=a.positionalLabel;a instanceof It.FeatureIdAttribute?QBe(t,a,c):i$(t,a,c,r,1,i);let l=a.label;f(l)&&o$(t,c,l,Ee.BOTH)}}function ZBe(t,n,i){let o=n.featureIds,s=on.getAttributeBySemantic(n,Tt.POSITION).count;for(let a=0;a<o.length;a++){let c=o[a],l=c.positionalLabel,u=Ee.BOTH;c instanceof It.FeatureIdAttribute?$Be(t,c,l):c instanceof It.FeatureIdImplicitRange?i$(t,c,l,s,void 0,i):(eOe(t,c,l,a,i),u=Ee.FRAGMENT);let d=c.label;f(d)&&o$(t,l,d,u)}}function QBe(t,n,i){let o=t.shaderBuilder;o.addStructField(Ei.STRUCT_ID_FEATURE_IDS_VS,"int",i),o.addStructField(Ei.STRUCT_ID_FEATURE_IDS_FS,"int",i);let r=n.setIndex,s=i.replace(/_\d+$/,"_"),a=`a_${s}${r}`,c=`v_${s}${r}`,l=`featureIds.${i} = int(czm_round(${a}));`,u=`featureIds.${i} = int(czm_round(${c}));`;o.addFunctionLines(Ei.FUNCTION_ID_INITIALIZE_FEATURE_IDS_VS,[l]),o.addFunctionLines(Ei.FUNCTION_ID_INITIALIZE_FEATURE_IDS_FS,[u]),o.addVarying("float",c),o.addFunctionLines(Ei.FUNCTION_ID_SET_FEATURE_ID_VARYINGS,[`${c} = ${a};`])}function $Be(t,n,i){let o=t.shaderBuilder;o.addStructField(Ei.STRUCT_ID_FEATURE_IDS_VS,"int",i),o.addStructField(Ei.STRUCT_ID_FEATURE_IDS_FS,"int",i);let r=n.setIndex,s=i.replace(/_\d+$/,"_"),a=[`featureIds.${i} = int(czm_round(attributes.${s}${r}));`];o.addFunctionLines(Ei.FUNCTION_ID_INITIALIZE_FEATURE_IDS_VS,a),o.addFunctionLines(Ei.FUNCTION_ID_INITIALIZE_FEATURE_IDS_FS,a)}function i$(t,n,i,o,r,s){tOe(t,n,o,r,s);let a=t.shaderBuilder,c=`a_implicit_${i}`;a.addAttribute("float",c);let l=`v_implicit_${i}`;a.addVarying("float",l),a.addStructField(Ei.STRUCT_ID_FEATURE_IDS_VS,"int",i),a.addStructField(Ei.STRUCT_ID_FEATURE_IDS_FS,"int",i),a.addFunctionLines(Ei.FUNCTION_ID_SET_FEATURE_ID_VARYINGS,[`${l} = ${c};`]),a.addFunctionLines(Ei.FUNCTION_ID_INITIALIZE_FEATURE_IDS_VS,[`featureIds.${i} = int(czm_round(${c}));`]),a.addFunctionLines(Ei.FUNCTION_ID_INITIALIZE_FEATURE_IDS_FS,[`featureIds.${i} = int(czm_round(${l}));`])}function eOe(t,n,i,o,r){let s=`u_featureIdTexture_${o}`,a=t.uniformMap,c=n.textureReader;a[s]=function(){return A(c.texture,r.context.defaultTexture)};let l=c.channels,u=t.shaderBuilder;u.addStructField(Ei.STRUCT_ID_FEATURE_IDS_FS,"int",i),u.addUniform("sampler2D",s,Ee.FRAGMENT);let d=`v_texCoord_${c.texCoord}`,h=`texture2D(${s}, ${d}).${l}`,_=`featureIds.${i} = czm_unpackUint(${h});`;u.addFunctionLines(Ei.FUNCTION_ID_INITIALIZE_FEATURE_IDS_FS,[_])}function o$(t,n,i,o){let r=t.shaderBuilder,s=Ee.includesVertexShader(o);s&&r.addStructField(Ei.STRUCT_ID_FEATURE_IDS_VS,"int",i),r.addStructField(Ei.STRUCT_ID_FEATURE_IDS_FS,"int",i);let a=[`featureIds.${i} = featureIds.${n};`];s&&r.addFunctionLines(Ei.FUNCTION_ID_INITIALIZE_FEATURE_ID_ALIASES_VS,a),r.addFunctionLines(Ei.FUNCTION_ID_INITIALIZE_FEATURE_ID_ALIASES_FS,a)}function tOe(t,n,i,o,r){let s=t.model,a,c;if(f(n.repeat)){let u=nOe(n,i);a=ut.createVertexBuffer({context:r.context,typedArray:u,usage:Fe.STATIC_DRAW}),a.vertexArrayDestroyable=!1,s._pipelineResources.push(a);let d=!1;s.statistics.addBuffer(a,d)}else c=[n.offset];let l={index:t.attributeIndex++,instanceDivisor:o,value:c,vertexBuffer:a,normalize:!1,componentsPerAttribute:1,componentDatatype:J.FLOAT,strideInBytes:J.getSizeInBytes(J.FLOAT),offsetInBytes:0};t.attributes.push(l)}function nOe(t,n){let i=t.offset,o=t.repeat,r=new Float32Array(n);for(let s=0;s<n;s++)r[s]=i+Math.floor(s/o);return r}var G0=Ei;var hM=`void metadataStage(
out Metadata metadata,
out MetadataClass metadataClass,
out MetadataStatistics metadataStatistics,
ProcessedAttributes attributes
)
{
initializeMetadata(metadata, metadataClass, metadataStatistics, attributes);
}
`;var mM=`void metadataStage(
out Metadata metadata,
out MetadataClass metadataClass,
out MetadataStatistics metadataStatistics,
ProcessedAttributes attributes
)
{
initializeMetadata(metadata, metadataClass, metadataStatistics, attributes);
setMetadataVaryings();
}
`;var di={name:"MetadataPipelineStage",STRUCT_ID_METADATA_VS:"MetadataVS",STRUCT_ID_METADATA_FS:"MetadataFS",STRUCT_NAME_METADATA:"Metadata",STRUCT_ID_METADATA_CLASS_VS:"MetadataClassVS",STRUCT_ID_METADATA_CLASS_FS:"MetadataClassFS",STRUCT_NAME_METADATA_CLASS:"MetadataClass",STRUCT_ID_METADATA_STATISTICS_VS:"MetadataStatisticsVS",STRUCT_ID_METADATA_STATISTICS_FS:"MetadataStatisticsFS",STRUCT_NAME_METADATA_STATISTICS:"MetadataStatistics",FUNCTION_ID_INITIALIZE_METADATA_VS:"initializeMetadataVS",FUNCTION_ID_INITIALIZE_METADATA_FS:"initializeMetadataFS",FUNCTION_SIGNATURE_INITIALIZE_METADATA:"void initializeMetadata(out Metadata metadata, out MetadataClass metadataClass, out MetadataStatistics metadataStatistics, ProcessedAttributes attributes)",FUNCTION_ID_SET_METADATA_VARYINGS:"setMetadataVaryings",FUNCTION_SIGNATURE_SET_METADATA_VARYINGS:"void setMetadataVaryings()",METADATA_CLASS_FIELDS:[{specName:"noData",shaderName:"noData"},{specName:"default",shaderName:"defaultValue"},{specName:"min",shaderName:"minValue"},{specName:"max",shaderName:"maxValue"}],METADATA_STATISTICS_FIELDS:[{specName:"min",shaderName:"minValue"},{specName:"max",shaderName:"maxValue"},{specName:"mean",shaderName:"mean",type:"float"},{specName:"median",shaderName:"median"},{specName:"standardDeviation",shaderName:"standardDeviation",type:"float"},{specName:"variance",shaderName:"variance",type:"float"},{specName:"sum",shaderName:"sum"}]};di.process=function(t,n,i){var h;let{shaderBuilder:o,model:r}=t,{structuralMetadata:s={},content:a}=r,c=(h=a==null?void 0:a.tileset.metadataExtension)==null?void 0:h.statistics,l=iOe(s.propertyAttributes,n,c),u=rOe(s.propertyTextures,c),d=l.concat(u);aOe(o,d),uOe(o),o.addVertexLines(mM),o.addFragmentLines(hM);for(let _=0;_<l.length;_++){let y=l[_];fOe(t,y)}for(let _=0;_<u.length;_++){let y=u[_];hOe(t,y)}};function iOe(t,n,i){return f(t)?t.flatMap(o=>oOe(o,n,i)):[]}function oOe(t,n,i){let{getAttributeByName:o,getAttributeInfo:r,sanitizeGlslIdentifier:s}=on,a=t.class.id,c=i==null?void 0:i.classes[a],l=Object.entries(t.properties),u=new Array(l.length);for(let d=0;d<l.length;d++){let[h,_]=l[d],y=o(n,_.attribute),{glslType:p,variableName:C}=r(y);u[d]={metadataVariable:s(h),property:_,type:_.classProperty.type,glslType:p,variableName:C,propertyStatistics:c==null?void 0:c.properties[h],shaderDestination:Ee.BOTH}}return u}function rOe(t,n){return f(t)?t.flatMap(i=>sOe(i,n)):[]}function sOe(t,n){let{sanitizeGlslIdentifier:i}=on,o=t.class.id,r=n==null?void 0:n.classes[o],s=Object.entries(t.properties).filter(([c,l])=>l.isGpuCompatible()),a=new Array(s.length);for(let c=0;c<s.length;c++){let[l,u]=s[c];a[c]={metadataVariable:i(l),property:u,type:u.classProperty.type,glslType:u.getGlslType(),propertyStatistics:r==null?void 0:r.properties[l],shaderDestination:Ee.FRAGMENT}}return a}function aOe(t,n){let i=new Set,o=new Set;for(let c=0;c<n.length;c++){let{type:l,glslType:u,propertyStatistics:d}=n[c];i.add(u),!!f(d)&&l!==Pn.ENUM&&o.add(u)}let r=di.METADATA_CLASS_FIELDS;for(let c of i){let l=`${c}MetadataClass`;a(l,c,r)}let s=di.METADATA_STATISTICS_FIELDS;for(let c of o){let l=`${c}MetadataStatistics`;a(l,c,s)}function a(c,l,u){t.addStruct(c,c,Ee.BOTH);for(let d=0;d<u.length;d++){let{shaderName:h}=u[d],_=u[d].type==="float"?lOe(l):l;t.addStructField(c,_,h)}}}var cOe={int:"float",ivec2:"vec2",ivec3:"vec3",ivec4:"vec4"};function lOe(t){let n=cOe[t];return f(n)?n:t}function uOe(t){t.addStruct(di.STRUCT_ID_METADATA_VS,di.STRUCT_NAME_METADATA,Ee.VERTEX),t.addStruct(di.STRUCT_ID_METADATA_FS,di.STRUCT_NAME_METADATA,Ee.FRAGMENT),t.addStruct(di.STRUCT_ID_METADATA_CLASS_VS,di.STRUCT_NAME_METADATA_CLASS,Ee.VERTEX),t.addStruct(di.STRUCT_ID_METADATA_CLASS_FS,di.STRUCT_NAME_METADATA_CLASS,Ee.FRAGMENT),t.addStruct(di.STRUCT_ID_METADATA_STATISTICS_VS,di.STRUCT_NAME_METADATA_STATISTICS,Ee.VERTEX),t.addStruct(di.STRUCT_ID_METADATA_STATISTICS_FS,di.STRUCT_NAME_METADATA_STATISTICS,Ee.FRAGMENT),t.addFunction(di.FUNCTION_ID_INITIALIZE_METADATA_VS,di.FUNCTION_SIGNATURE_INITIALIZE_METADATA,Ee.VERTEX),t.addFunction(di.FUNCTION_ID_INITIALIZE_METADATA_FS,di.FUNCTION_SIGNATURE_INITIALIZE_METADATA,Ee.FRAGMENT),t.addFunction(di.FUNCTION_ID_SET_METADATA_VARYINGS,di.FUNCTION_SIGNATURE_SET_METADATA_VARYINGS,Ee.VERTEX)}function fOe(t,n){dOe(t,n),r$(t.shaderBuilder,n),s$(t.shaderBuilder,n)}function dOe(t,n){let{shaderBuilder:i}=t,{metadataVariable:o,property:r,glslType:s}=n,a=c$({valueExpression:`attributes.${n.variableName}`,renderResources:t,glslType:s,metadataVariable:o,shaderDestination:Ee.BOTH,property:r});i.addStructField(di.STRUCT_ID_METADATA_VS,s,o),i.addStructField(di.STRUCT_ID_METADATA_FS,s,o);let c=`metadata.${o} = ${a};`;i.addFunctionLines(di.FUNCTION_ID_INITIALIZE_METADATA_VS,[c]),i.addFunctionLines(di.FUNCTION_ID_INITIALIZE_METADATA_FS,[c])}function hOe(t,n){mOe(t,n),r$(t.shaderBuilder,n),s$(t.shaderBuilder,n)}function mOe(t,n){let{shaderBuilder:i,uniformMap:o}=t,{metadataVariable:r,glslType:s,property:a}=n,{texCoord:c,channels:l,index:u,texture:d}=a.textureReader,h=`u_propertyTexture_${u}`;o.hasOwnProperty(h)||(i.addUniform("sampler2D",h,Ee.FRAGMENT),o[h]=()=>d),i.addStructField(di.STRUCT_ID_METADATA_FS,s,r);let _=`attributes.texCoord_${c}`,y=`texture2D(${h}, ${_}).${l}`,p=a.unpackInShader(y),C=c$({valueExpression:p,renderResources:t,glslType:s,metadataVariable:r,shaderDestination:Ee.FRAGMENT,property:a}),x=`metadata.${r} = ${C};`;i.addFunctionLines(di.FUNCTION_ID_INITIALIZE_METADATA_FS,[x])}function r$(t,n){let{classProperty:i}=n.property,{metadataVariable:o,glslType:r,shaderDestination:s}=n,a=a$(di.METADATA_CLASS_FIELDS,i,`metadataClass.${o}`,r),c=`${r}MetadataClass`;t.addStructField(di.STRUCT_ID_METADATA_CLASS_FS,c,o),t.addFunctionLines(di.FUNCTION_ID_INITIALIZE_METADATA_FS,a),Ee.includesVertexShader(s)&&(t.addStructField(di.STRUCT_ID_METADATA_CLASS_VS,c,o),t.addFunctionLines(di.FUNCTION_ID_INITIALIZE_METADATA_VS,a))}function s$(t,n){let{propertyStatistics:i}=n;if(!f(i))return;let{metadataVariable:o,type:r,glslType:s}=n;if(r===Pn.ENUM)return;let a=di.METADATA_STATISTICS_FIELDS,c=`metadataStatistics.${o}`,l=a$(a,i,c,s),u=`${s}MetadataStatistics`;t.addStructField(di.STRUCT_ID_METADATA_STATISTICS_FS,u,o),t.addFunctionLines(di.FUNCTION_ID_INITIALIZE_METADATA_FS,l),Ee.includesVertexShader(n.shaderDestination)&&(t.addStructField(di.STRUCT_ID_METADATA_STATISTICS_VS,u,o),t.addFunctionLines(di.FUNCTION_ID_INITIALIZE_METADATA_VS,l))}function a$(t,n,i,o){return f(n)?t.map(r).filter(f):[];function r(s){let a=n[s.specName];if(f(a))return`${i}.${s.shaderName} = ${o}(${a});`}}function c$(t){let{valueExpression:n,property:i}=t;if(!i.hasValueTransform)return n;let o=t.metadataVariable,r=`u_${o}_offset`,s=`u_${o}_scale`,{shaderBuilder:a,uniformMap:c}=t.renderResources,{glslType:l,shaderDestination:u}=t;a.addUniform(l,r,u),a.addUniform(l,s,u);let{offset:d,scale:h}=i;return c[r]=()=>d,c[s]=()=>h,`czm_valueTransform(${r}, ${s}, ${n})`}var Bf=di;var pOe={INHERIT:0,OPAQUE:1,TRANSLUCENT:2},W0=Object.freeze(pOe);var vs={name:"CustomShaderPipelineStage",STRUCT_ID_ATTRIBUTES_VS:"AttributesVS",STRUCT_ID_ATTRIBUTES_FS:"AttributesFS",STRUCT_NAME_ATTRIBUTES:"Attributes",STRUCT_ID_VERTEX_INPUT:"VertexInput",STRUCT_NAME_VERTEX_INPUT:"VertexInput",STRUCT_ID_FRAGMENT_INPUT:"FragmentInput",STRUCT_NAME_FRAGMENT_INPUT:"FragmentInput",FUNCTION_ID_INITIALIZE_INPUT_STRUCT_VS:"initializeInputStructVS",FUNCTION_SIGNATURE_INITIALIZE_INPUT_STRUCT_VS:"void initializeInputStruct(out VertexInput vsInput, ProcessedAttributes attributes)",FUNCTION_ID_INITIALIZE_INPUT_STRUCT_FS:"initializeInputStructFS",FUNCTION_SIGNATURE_INITIALIZE_INPUT_STRUCT_FS:"void initializeInputStruct(out FragmentInput fsInput, ProcessedAttributes attributes)",_oneTimeWarning:Bt};vs.process=function(t,n,i){let o=t.shaderBuilder,r=t.model.customShader;f(r.lightingModel)&&(t.lightingOptions.lightingModel=r.lightingModel);let s=t.alphaOptions;r.translucencyMode===W0.TRANSLUCENT?s.pass=Te.TRANSLUCENT:r.translucencyMode===W0.OPAQUE&&(s.pass=void 0);let a=EOe(r,n);if(!a.customShaderEnabled)return;if(DOe(o,r,a),a.shouldComputePositionWC&&o.addDefine("COMPUTE_POSITION_WC_CUSTOM_SHADER",void 0,Ee.BOTH),f(r.vertexShaderText)&&o.addDefine("HAS_CUSTOM_VERTEX_SHADER",void 0,Ee.VERTEX),f(r.fragmentShaderText)){o.addDefine("HAS_CUSTOM_FRAGMENT_SHADER",void 0,Ee.FRAGMENT);let u=f_.getDefineName(r.mode);o.addDefine(u,void 0,Ee.FRAGMENT)}let c=r.uniforms;for(let u in c)if(c.hasOwnProperty(u)){let d=c[u];o.addUniform(d.type,u)}let l=r.varyings;for(let u in l)if(l.hasOwnProperty(u)){let d=l[u];o.addVarying(d,u)}t.uniformMap=At(t.uniformMap,r.uniformMap)};function _Oe(t){let n={};for(let i=0;i<t.length;i++){let o=t[i],r=on.getAttributeInfo(o);n[r.variableName]=r}return n}var gOe={position:"vec3",normal:"vec3",tangent:"vec3",bitangent:"vec3",texCoord:"vec2",color:"vec4",joints:"ivec4",weights:"vec4"},yOe={position:"vec3(0.0)",normal:"vec3(0.0, 0.0, 1.0)",tangent:"vec3(1.0, 0.0, 0.0)",bitangent:"vec3(0.0, 1.0, 0.0)",texCoord:"vec2(0.0)",color:"vec4(1.0)",joints:"ivec4(0)",weights:"vec4(0.0)"};function l$(t){let n=t.replace(/_[0-9]+$/,"");n=n.replace(/(MC|EC)$/,"");let i=gOe[n],o=yOe[n];if(!!f(i))return{attributeField:[i,t],value:o}}function AOe(t,n,i){let o=u$(n,t.usedVariablesVertex.attributeSet,!1),r=o.addToShader,s=o.missingAttributes,a,c,l=[],u=[];for(a in r)if(r.hasOwnProperty(a)){let h=[r[a].glslType,a];l.push(h),c=`vsInput.attributes.${a} = attributes.${a};`,u.push(c)}for(let d=0;d<s.length;d++){a=s[d];let h=l$(a);if(!f(h)){vs._oneTimeWarning("CustomShaderPipelineStage.incompatiblePrimitiveVS",`Primitive is missing attribute ${a}, disabling custom vertex shader`);return}l.push(h.attributeField),c=`vsInput.attributes.${a} = ${h.value};`,u.push(c)}i.enabled=!0,i.attributeFields=l,i.initializationLines=u}function COe(t){let n=[],i=[],o=t.usedVariablesFragment.attributeSet;return o.hasOwnProperty("positionWC")&&(n.push(["vec3","positionWC"]),i.push("fsInput.attributes.positionWC = attributes.positionWC;")),o.hasOwnProperty("positionEC")&&(n.push(["vec3","positionEC"]),i.push("fsInput.attributes.positionEC = attributes.positionEC;")),{attributeFields:n,initializationLines:i}}function xOe(t,n,i){let o=u$(n,t.usedVariablesFragment.attributeSet,!0),r=o.addToShader,s=o.missingAttributes,a,c,l=[],u=[];for(a in r)if(r.hasOwnProperty(a)){let _=[r[a].glslType,a];l.push(_),c=`fsInput.attributes.${a} = attributes.${a};`,u.push(c)}for(let h=0;h<s.length;h++){a=s[h];let _=l$(a);if(!f(_)){vs._oneTimeWarning("CustomShaderPipelineStage.incompatiblePrimitiveFS",`Primitive is missing attribute ${a}, disabling custom fragment shader.`);return}l.push(_.attributeField),c=`fsInput.attributes.${a} = ${_.value};`,u.push(c)}let d=COe(t);i.enabled=!0,i.attributeFields=l.concat(d.attributeFields),i.initializationLines=d.initializationLines.concat(u)}var TOe={positionWC:!0,positionEC:!0};function u$(t,n,i){let o,r,s={};for(r in t)if(t.hasOwnProperty(r)){let c=t[r];o=r,i&&r==="normalMC"?o="normalEC":i&&r==="tangentMC"&&(o="tangentEC"),n.hasOwnProperty(o)&&(s[o]=c)}let a=[];for(r in n)if(n.hasOwnProperty(r)){if(TOe.hasOwnProperty(r))continue;o=r,i&&r==="normalEC"?o="normalMC":i&&r==="tangentEC"&&(o="tangentMC"),t.hasOwnProperty(o)||a.push(r)}return{addToShader:s,missingAttributes:a}}function EOe(t,n){let i={enabled:!1},o={enabled:!1},r=_Oe(n.attributes);f(t.vertexShaderText)&&AOe(t,r,i),f(t.fragmentShaderText)&&xOe(t,r,o);let a=t.usedVariablesFragment.attributeSet.hasOwnProperty("positionWC")&&o.enabled;return{vertexLines:i,fragmentLines:o,vertexLinesEnabled:i.enabled,fragmentLinesEnabled:o.enabled,customShaderEnabled:i.enabled||o.enabled,shouldComputePositionWC:a}}function bOe(t,n){let i,o=vs.STRUCT_ID_ATTRIBUTES_VS;t.addStruct(o,vs.STRUCT_NAME_ATTRIBUTES,Ee.VERTEX);let r=n.attributeFields;for(i=0;i<r.length;i++){let c=r[i],l=c[0],u=c[1];t.addStructField(o,l,u)}o=vs.STRUCT_ID_VERTEX_INPUT,t.addStruct(o,vs.STRUCT_NAME_VERTEX_INPUT,Ee.VERTEX),t.addStructField(o,vs.STRUCT_NAME_ATTRIBUTES,"attributes"),t.addStructField(o,G0.STRUCT_NAME_FEATURE_IDS,"featureIds"),t.addStructField(o,Bf.STRUCT_NAME_METADATA,"metadata"),t.addStructField(o,Bf.STRUCT_NAME_METADATA_CLASS,"metadataClass"),t.addStructField(o,Bf.STRUCT_NAME_METADATA_STATISTICS,"metadataStatistics");let s=vs.FUNCTION_ID_INITIALIZE_INPUT_STRUCT_VS;t.addFunction(s,vs.FUNCTION_SIGNATURE_INITIALIZE_INPUT_STRUCT_VS,Ee.VERTEX);let a=n.initializationLines;t.addFunctionLines(s,a)}function SOe(t,n){let i,o=vs.STRUCT_ID_ATTRIBUTES_FS;t.addStruct(o,vs.STRUCT_NAME_ATTRIBUTES,Ee.FRAGMENT);let r,s,a,c=n.attributeFields;for(i=0;i<c.length;i++)r=c[i],s=r[0],a=r[1],t.addStructField(o,s,a);o=vs.STRUCT_ID_FRAGMENT_INPUT,t.addStruct(o,vs.STRUCT_NAME_FRAGMENT_INPUT,Ee.FRAGMENT),t.addStructField(o,vs.STRUCT_NAME_ATTRIBUTES,"attributes"),t.addStructField(o,G0.STRUCT_NAME_FEATURE_IDS,"featureIds"),t.addStructField(o,Bf.STRUCT_NAME_METADATA,"metadata"),t.addStructField(o,Bf.STRUCT_NAME_METADATA_CLASS,"metadataClass"),t.addStructField(o,Bf.STRUCT_NAME_METADATA_STATISTICS,"metadataStatistics");let l=vs.FUNCTION_ID_INITIALIZE_INPUT_STRUCT_FS;t.addFunction(l,vs.FUNCTION_SIGNATURE_INITIALIZE_INPUT_STRUCT_FS,Ee.FRAGMENT);let u=n.initializationLines;t.addFunctionLines(l,u)}var wOe=[];function DOe(t,n,i){let o=i.vertexLines,r=wOe;o.enabled&&(bOe(t,o),r.length=0,r.push("#line 0",n.vertexShaderText,lM),t.addVertexLines(r));let s=i.fragmentLines;s.enabled&&(SOe(t,s),r.length=0,r.push("#line 0",n.fragmentShaderText,uM),t.addFragmentLines(r))}var pM=vs;var pS={name:"DequantizationPipelineStage",FUNCTION_ID_DEQUANTIZATION_STAGE_VS:"dequantizationStage",FUNCTION_SIGNATURE_DEQUANTIZATION_STAGE_VS:"void dequantizationStage(inout ProcessedAttributes attributes)"};pS.process=function(t,n,i){let o=t.shaderBuilder,r=t.model,s=f(r.classificationType);o.addDefine("USE_DEQUANTIZATION",void 0,Ee.VERTEX),o.addFunction(pS.FUNCTION_ID_DEQUANTIZATION_STAGE_VS,pS.FUNCTION_SIGNATURE_DEQUANTIZATION_STAGE_VS,Ee.VERTEX);let a=n.attributes;for(let c=0;c<a.length;c++){let l=a[c],u=l.quantization;if(!f(u))continue;let d=l.semantic===Tt.POSITION,h=l.semantic===Tt.TEXCOORD;if(s&&!d&&!h)continue;let _=on.getAttributeInfo(l);POe(o,_),vOe(t,_)}};function vOe(t,n){let i=t.shaderBuilder,o=t.uniformMap,r=n.variableName,s=n.attribute.quantization;if(s.octEncoded){let a=`model_normalizationRange_${r}`;i.addUniform("float",a,Ee.VERTEX),o[a]=function(){return s.normalizationRange}}else{let a=`model_quantizedVolumeOffset_${r}`,c=`model_quantizedVolumeStepSize_${r}`,l=n.glslType;i.addUniform(l,a,Ee.VERTEX),i.addUniform(l,c,Ee.VERTEX);let u=s.quantizedVolumeOffset,d=s.quantizedVolumeStepSize;/^color_\d+$/.test(r)&&(u=f$(u,0),d=f$(d,1)),o[a]=function(){return u},o[c]=function(){return d}}}function f$(t,n){return t instanceof se?t:new se(t.x,t.y,t.z,n)}function POe(t,n){let i=n.variableName,o=n.attribute.quantization,r;o.octEncoded?r=IOe(i,o):r=BOe(i),t.addFunctionLines(pS.FUNCTION_ID_DEQUANTIZATION_STAGE_VS,[r])}function IOe(t,n){let i=`attributes.${t}`,o=`a_quantized_${t}`,r=`model_normalizationRange_${t}`,s=n.octEncodedZXY?".zxy":".xyz";return`${i} = czm_octDecode(${o}, ${r})${s};`}function BOe(t){let n=`attributes.${t}`,i=`a_quantized_${t}`,o=`model_quantizedVolumeOffset_${t}`,r=`model_quantizedVolumeStepSize_${t}`;return`${n} = ${o} + ${i} * ${r};`}var _M=pS;var gM=`void geometryStage(out ProcessedAttributes attributes)
{
attributes.positionMC = v_positionMC;
attributes.positionEC = v_positionEC;
#ifdef COMPUTE_POSITION_WC_CUSTOM_SHADER
attributes.positionWC = v_positionWC;
#endif
#ifdef HAS_NORMALS
attributes.normalEC = normalize(v_normalEC);
#endif
#ifdef HAS_TANGENTS
attributes.tangentEC = normalize(v_tangentEC);
#endif
#ifdef HAS_BITANGENTS
attributes.bitangentEC = normalize(v_bitangentEC);
#endif
setDynamicVaryings(attributes);
}
`;var yM=`vec4 geometryStage(inout ProcessedAttributes attributes, mat4 modelView, mat3 normal)
{
vec4 computedPosition;
vec3 positionMC = attributes.positionMC;
v_positionMC = positionMC;
v_positionEC = (modelView * vec4(positionMC, 1.0)).xyz;
#if defined(USE_2D_POSITIONS) || defined(USE_2D_INSTANCING)
vec3 position2D = attributes.position2D;
vec3 positionEC = (u_modelView2D * vec4(position2D, 1.0)).xyz;
computedPosition = czm_projection * vec4(positionEC, 1.0);
#else
computedPosition = czm_projection * vec4(v_positionEC, 1.0);
#endif
#if defined(COMPUTE_POSITION_WC_CUSTOM_SHADER) || defined(COMPUTE_POSITION_WC_STYLE)
v_positionWC = (czm_model * vec4(positionMC, 1.0)).xyz;
#endif
#ifdef HAS_NORMALS
v_normalEC = normalize(normal * attributes.normalMC);
#endif
#ifdef HAS_TANGENTS
v_tangentEC = normalize(normal * attributes.tangentMC);
#endif
#ifdef HAS_BITANGENTS
v_bitangentEC = normalize(normal * attributes.bitangentMC);
#endif
setDynamicVaryings(attributes);
return computedPosition;
}
`;var _S=`vec2 computeSt(float featureId)
{
float stepX = model_textureStep.x;
float centerX = model_textureStep.y;
#ifdef MULTILINE_BATCH_TEXTURE
float stepY = model_textureStep.z;
float centerY = model_textureStep.w;
float xId = mod(featureId, model_textureDimensions.x);
float yId = floor(featureId / model_textureDimensions.x);
return vec2(centerX + (xId * stepX), centerY + (yId * stepY));
#else
return vec2(centerX + (featureId * stepX), 0.5);
#endif
}
void selectedFeatureIdStage(out SelectedFeature feature, FeatureIds featureIds)
{
int featureId = featureIds.SELECTED_FEATURE_ID;
if (featureId < model_featuresLength)
{
vec2 featureSt = computeSt(float(featureId));
feature.id = featureId;
feature.st = featureSt;
feature.color = texture2D(model_batchTexture, featureSt);
}
else
{
feature.id = model_featuresLength + 1;
feature.st = vec2(0.0);
feature.color = vec4(1.0);
}
#ifdef HAS_NULL_FEATURE_ID
if (featureId == model_nullFeatureId) {
feature.id = featureId;
feature.st = vec2(0.0);
feature.color = vec4(1.0);
}
#endif
}
`;var gS={name:"SelectedFeatureIdPipelineStage",STRUCT_ID_SELECTED_FEATURE:"SelectedFeature",STRUCT_NAME_SELECTED_FEATURE:"SelectedFeature",FUNCTION_ID_FEATURE_VARYINGS_VS:"updateFeatureStructVS",FUNCTION_ID_FEATURE_VARYINGS_FS:"updateFeatureStructFS",FUNCTION_SIGNATURE_UPDATE_FEATURE:"void updateFeatureStruct(inout SelectedFeature feature)"};gS.process=function(t,n,i){let o=t.shaderBuilder;t.hasPropertyTable=!0;let r=t.model,s=t.runtimeNode.node,a=OOe(r,s,n),c=a.shaderDestination;o.addDefine("HAS_SELECTED_FEATURE_ID",void 0,c),o.addDefine("SELECTED_FEATURE_ID",a.variableName,c),o.addDefine(a.featureIdDefine,void 0,c),ROe(o);let l=a.featureIds.nullFeatureId,u=t.uniformMap;f(l)&&(o.addDefine("HAS_NULL_FEATURE_ID",void 0,c),o.addUniform("int","model_nullFeatureId",c),u.model_nullFeatureId=function(){return l}),a.shaderDestination===Ee.BOTH&&o.addVertexLines(_S),o.addFragmentLines(_S)};function d$(t){return t instanceof It.FeatureIdTexture?"HAS_SELECTED_FEATURE_ID_TEXTURE":"HAS_SELECTED_FEATURE_ID_ATTRIBUTE"}function h$(t){return t instanceof It.FeatureIdTexture?Ee.FRAGMENT:Ee.BOTH}function OOe(t,n,i){let o,r;return f(n.instances)&&(r=on.getFeatureIdsByLabel(n.instances.featureIds,t.instanceFeatureIdLabel),f(r))?(o=A(r.label,r.positionalLabel),{featureIds:r,variableName:o,shaderDestination:h$(r),featureIdDefine:d$(r)}):(r=on.getFeatureIdsByLabel(i.featureIds,t.featureIdLabel),o=A(r.label,r.positionalLabel),{featureIds:r,variableName:o,shaderDestination:h$(r),featureIdDefine:d$(r)})}function ROe(t){t.addStructField(gS.STRUCT_ID_SELECTED_FEATURE,"int","id"),t.addStructField(gS.STRUCT_ID_SELECTED_FEATURE,"vec2","st"),t.addStructField(gS.STRUCT_ID_SELECTED_FEATURE,"vec4","color")}var j0=gS;var ds={name:"GeometryPipelineStage",STRUCT_ID_PROCESSED_ATTRIBUTES_VS:"ProcessedAttributesVS",STRUCT_ID_PROCESSED_ATTRIBUTES_FS:"ProcessedAttributesFS",STRUCT_NAME_PROCESSED_ATTRIBUTES:"ProcessedAttributes",FUNCTION_ID_INITIALIZE_ATTRIBUTES:"initializeAttributes",FUNCTION_SIGNATURE_INITIALIZE_ATTRIBUTES:"void initializeAttributes(out ProcessedAttributes attributes)",FUNCTION_ID_SET_DYNAMIC_VARYINGS_VS:"setDynamicVaryingsVS",FUNCTION_ID_SET_DYNAMIC_VARYINGS_FS:"setDynamicVaryingsFS",FUNCTION_SIGNATURE_SET_DYNAMIC_VARYINGS:"void setDynamicVaryings(inout ProcessedAttributes attributes)"};ds.process=function(t,n,i){let o=t.shaderBuilder,r=t.model;o.addStruct(ds.STRUCT_ID_PROCESSED_ATTRIBUTES_VS,"ProcessedAttributes",Ee.VERTEX),o.addStruct(ds.STRUCT_ID_PROCESSED_ATTRIBUTES_FS,"ProcessedAttributes",Ee.FRAGMENT),o.addStruct(j0.STRUCT_ID_SELECTED_FEATURE,j0.STRUCT_NAME_SELECTED_FEATURE,Ee.BOTH),o.addFunction(ds.FUNCTION_ID_INITIALIZE_ATTRIBUTES,ds.FUNCTION_SIGNATURE_INITIALIZE_ATTRIBUTES,Ee.VERTEX),o.addVarying("vec3","v_positionWC"),o.addVarying("vec3","v_positionEC"),o.addStructField(ds.STRUCT_ID_PROCESSED_ATTRIBUTES_FS,"vec3","positionWC"),o.addStructField(ds.STRUCT_ID_PROCESSED_ATTRIBUTES_FS,"vec3","positionEC"),o.addFunction(ds.FUNCTION_ID_SET_DYNAMIC_VARYINGS_VS,ds.FUNCTION_SIGNATURE_SET_DYNAMIC_VARYINGS,Ee.VERTEX),o.addFunction(ds.FUNCTION_ID_SET_DYNAMIC_VARYINGS_FS,ds.FUNCTION_SIGNATURE_SET_DYNAMIC_VARYINGS,Ee.FRAGMENT),r.type===sr.TILE_PNTS&&o.addDefine("HAS_SRGB_COLOR",void 0,Ee.FRAGMENT);let a=i.mode!==ne.SCENE3D&&!i.scene3DOnly&&r._projectTo2D,c=f(t.runtimeNode.node.instances),l=a&&!c,u=n.attributes.length;for(let d=0;d<u;d++){let h=n.attributes[d],_=nn.getAttributeLocationCount(h.type),y=h.semantic===Tt.POSITION,p;_>1?(p=t.attributeIndex,t.attributeIndex+=_):y&&!l?p=0:p=t.attributeIndex++,MOe(t,h,p,_,a,c)}GOe(o,n.attributes),n.primitiveType===Re.POINTS&&o.addDefine("PRIMITIVE_TYPE_POINTS"),o.addVertexLines(yM),o.addFragmentLines(gM)};function MOe(t,n,i,o,r,s){let a=t.shaderBuilder,c=on.getAttributeInfo(n),l=r&&!s;o>1?NOe(t,n,i,o):FOe(t,n,i,l),kOe(a,c,l),VOe(a,c),f(n.semantic)&&LOe(a,n),UOe(a,c,r),zOe(a,c,l),HOe(a,c)}function LOe(t,n){let i=n.semantic,o=n.setIndex;switch(i){case Tt.NORMAL:t.addDefine("HAS_NORMALS");break;case Tt.TANGENT:t.addDefine("HAS_TANGENTS");break;case Tt.FEATURE_ID:t.addDefine(`HAS${i}_${o}`);break;case Tt.TEXCOORD:case Tt.COLOR:t.addDefine(`HAS_${i}_${o}`)}}function FOe(t,n,i,o){let r=n.quantization,s,a;f(r)?(s=r.type,a=r.componentDatatype):(s=n.type,a=n.componentDatatype);let c=n.semantic,l=n.setIndex;c===Tt.FEATURE_ID&&l>=t.featureIdVertexAttributeSetIndex&&(t.featureIdVertexAttributeSetIndex=l+1);let u=c===Tt.POSITION,d=u?0:i,h=nn.getNumberOfComponents(s),_={index:d,value:f(n.buffer)?void 0:n.constant,vertexBuffer:n.buffer,count:n.count,componentsPerAttribute:h,componentDatatype:a,offsetInBytes:n.byteOffset,strideInBytes:n.byteStride,normalize:n.normalized};if(t.attributes.push(_),!u||!o)return;let y=t.runtimePrimitive.positionBuffer2D,p={index:i,vertexBuffer:y,count:n.count,componentsPerAttribute:h,componentDatatype:J.FLOAT,offsetInBytes:0,strideInBytes:void 0,normalize:n.normalized};t.attributes.push(p)}function NOe(t,n,i,o){let r=n.quantization,s,a;f(r)?(s=r.type,a=r.componentDatatype):(s=n.type,a=n.componentDatatype);let c=n.normalized,u=nn.getNumberOfComponents(s)/o,d=J.getSizeInBytes(a),h=u*d,_=n.byteStride;for(let y=0;y<o;y++){let p=n.byteOffset+y*h,C={index:i+y,vertexBuffer:n.buffer,componentsPerAttribute:u,componentDatatype:a,offsetInBytes:p,strideInBytes:_,normalize:c};t.attributes.push(C)}}function VOe(t,n){let i=n.variableName,o=`v_${i}`,r;i==="normalMC"?(o="v_normalEC",r=n.glslType):i==="tangentMC"?(r="vec3",o="v_tangentEC"):r=n.glslType,t.addVarying(r,o)}function kOe(t,n,i){let o=n.attribute.semantic,r=n.variableName,s,a;n.isQuantized?(s=`a_quantized_${r}`,a=n.quantizedGlslType):(s=`a_${r}`,a=n.glslType);let c=o===Tt.POSITION;c?t.setPositionAttribute(a,s):t.addAttribute(a,s),c&&i&&t.addAttribute("vec3","a_position2D")}function UOe(t,n,i){let o=ds.STRUCT_ID_PROCESSED_ATTRIBUTES_VS,r=ds.STRUCT_ID_PROCESSED_ATTRIBUTES_FS,s=n.variableName;s==="tangentMC"?(t.addStructField(o,"vec3","tangentMC"),t.addStructField(o,"float","tangentSignMC"),t.addStructField(r,"vec3","tangentEC")):s==="normalMC"?(t.addStructField(o,"vec3","normalMC"),t.addStructField(r,"vec3","normalEC")):(t.addStructField(o,n.glslType,s),t.addStructField(r,n.glslType,s)),s==="positionMC"&&i&&t.addStructField(o,"vec3","position2D")}function zOe(t,n,i){let o=ds.FUNCTION_ID_INITIALIZE_ATTRIBUTES,r=n.variableName;if(r==="positionMC"&&i){let c="attributes.position2D = a_position2D;";t.addFunctionLines(o,[c])}if(n.isQuantized)return;let a=[];r==="tangentMC"?(a.push("attributes.tangentMC = a_tangentMC.xyz;"),a.push("attributes.tangentSignMC = a_tangentMC.w;")):a.push(`attributes.${r} = a_${r};`),t.addFunctionLines(o,a)}function HOe(t,n){let i=n.attribute.semantic,o=n.attribute.setIndex;if(f(i)&&!f(o))return;let r=ds.FUNCTION_ID_SET_DYNAMIC_VARYINGS_VS,s=n.variableName,a=`v_${s} = attributes.${s};`;t.addFunctionLines(r,[a]),r=ds.FUNCTION_ID_SET_DYNAMIC_VARYINGS_FS,a=`attributes.${s} = v_${s};`,t.addFunctionLines(r,[a])}function GOe(t,n){let i=!1,o=!1;for(let r=0;r<n.length;r++){let s=n[r];s.semantic===Tt.NORMAL?i=!0:s.semantic===Tt.TANGENT&&(o=!0)}!i||!o||(t.addDefine("HAS_BITANGENTS"),t.addVarying("vec3","v_bitangentEC"),t.addStructField(ds.STRUCT_ID_PROCESSED_ATTRIBUTES_VS,"vec3","bitangentMC"),t.addStructField(ds.STRUCT_ID_PROCESSED_ATTRIBUTES_FS,"vec3","bitangentEC"))}var AM=ds;var CM=`#ifdef LIGHTING_PBR
vec3 computePbrLighting(czm_modelMaterial inputMaterial, ProcessedAttributes attributes)
{
czm_pbrParameters pbrParameters;
pbrParameters.diffuseColor = inputMaterial.diffuse;
pbrParameters.f0 = inputMaterial.specular;
pbrParameters.roughness = inputMaterial.roughness;
#ifdef USE_CUSTOM_LIGHT_COLOR
vec3 lightColorHdr = model_lightColorHdr;
#else
vec3 lightColorHdr = czm_lightColorHdr;
#endif
vec3 color = inputMaterial.diffuse;
#ifdef HAS_NORMALS
color = czm_pbrLighting(
attributes.positionEC,
inputMaterial.normalEC,
czm_lightDirectionEC,
lightColorHdr,
pbrParameters
);
#ifdef USE_IBL_LIGHTING
color += imageBasedLightingStage(
attributes.positionEC,
inputMaterial.normalEC,
czm_lightDirectionEC,
lightColorHdr,
pbrParameters
);
#endif
#endif
color *= inputMaterial.occlusion;
color += inputMaterial.emissive;
#ifndef HDR
color = czm_acesTonemapping(color);
#endif
return color;
}
#endif
void lightingStage(inout czm_modelMaterial material, ProcessedAttributes attributes)
{
vec3 color = vec3(0.0);
#ifdef LIGHTING_PBR
color = computePbrLighting(material, attributes);
#else // unlit
color = material.diffuse;
#endif
#ifdef HAS_POINT_CLOUD_COLOR_STYLE
color = czm_gammaCorrect(color);
#elif !defined(HDR)
color = czm_linearToSrgb(color);
#endif
material.diffuse = color;
}
`;var WOe={UNLIT:0,PBR:1},vm=Object.freeze(WOe);var m$={name:"LightingPipelineStage"};m$.process=function(t,n){let i=t.model,o=t.lightingOptions,r=t.shaderBuilder;if(f(i.lightColor)){r.addDefine("USE_CUSTOM_LIGHT_COLOR",void 0,Ee.FRAGMENT),r.addUniform("vec3","model_lightColorHdr",Ee.FRAGMENT);let a=t.uniformMap;a.model_lightColorHdr=function(){return i.lightColor}}o.lightingModel===vm.PBR?r.addDefine("LIGHTING_PBR",void 0,Ee.FRAGMENT):r.addDefine("LIGHTING_UNLIT",void 0,Ee.FRAGMENT),r.addFragmentLines(CM)};var xM=m$;var TM=`bool isDefaultStyleColor(vec3 color)
{
return all(greaterThan(color, vec3(1.0 - czm_epsilon3)));
}
vec3 blend(vec3 sourceColor, vec3 styleColor, float styleColorBlend)
{
vec3 blendColor = mix(sourceColor, styleColor, styleColorBlend);
vec3 color = isDefaultStyleColor(styleColor.rgb) ? sourceColor : blendColor;
return color;
}
vec2 computeTextureTransform(vec2 texCoord, mat3 textureTransform)
{
return vec2(textureTransform * vec3(texCoord, 1.0));
}
#ifdef HAS_NORMALS
vec3 computeNormal(ProcessedAttributes attributes)
{
vec3 ng = attributes.normalEC;
vec3 normal = ng;
#if defined(HAS_NORMAL_TEXTURE) && !defined(HAS_WIREFRAME)
vec2 normalTexCoords = TEXCOORD_NORMAL;
#ifdef HAS_NORMAL_TEXTURE_TRANSFORM
normalTexCoords = computeTextureTransform(normalTexCoords, u_normalTextureTransform);
#endif
#ifdef HAS_BITANGENTS
vec3 t = attributes.tangentEC;
vec3 b = attributes.bitangentEC;
mat3 tbn = mat3(t, b, ng);
vec3 n = texture2D(u_normalTexture, normalTexCoords).rgb;
normal = normalize(tbn * (2.0 * n - 1.0));
#elif defined(GL_OES_standard_derivatives)
vec3 positionEC = attributes.positionEC;
vec3 pos_dx = dFdx(positionEC);
vec3 pos_dy = dFdy(positionEC);
vec3 tex_dx = dFdx(vec3(normalTexCoords,0.0));
vec3 tex_dy = dFdy(vec3(normalTexCoords,0.0));
vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);
t = normalize(t - ng * dot(ng, t));
vec3 b = normalize(cross(ng, t));
mat3 tbn = mat3(t, b, ng);
vec3 n = texture2D(u_normalTexture, normalTexCoords).rgb;
normal = normalize(tbn * (2.0 * n - 1.0));
#endif
#endif
#ifdef HAS_DOUBLE_SIDED_MATERIAL
if (czm_backFacing()) {
normal = -normal;
}
#endif
return normal;
}
#endif
void materialStage(inout czm_modelMaterial material, ProcessedAttributes attributes, SelectedFeature feature)
{
#ifdef HAS_NORMALS
material.normalEC = computeNormal(attributes);
#endif
vec4 baseColorWithAlpha = vec4(1.0);
#ifdef HAS_BASE_COLOR_TEXTURE
vec2 baseColorTexCoords = TEXCOORD_BASE_COLOR;
#ifdef HAS_BASE_COLOR_TEXTURE_TRANSFORM
baseColorTexCoords = computeTextureTransform(baseColorTexCoords, u_baseColorTextureTransform);
#endif
baseColorWithAlpha = czm_srgbToLinear(texture2D(u_baseColorTexture, baseColorTexCoords));
#ifdef HAS_BASE_COLOR_FACTOR
baseColorWithAlpha *= u_baseColorFactor;
#endif
#elif defined(HAS_BASE_COLOR_FACTOR)
baseColorWithAlpha = u_baseColorFactor;
#endif
#ifdef HAS_POINT_CLOUD_COLOR_STYLE
baseColorWithAlpha = v_pointCloudColor;
#elif defined(HAS_COLOR_0)
vec4 color = attributes.color_0;
#ifdef HAS_SRGB_COLOR
color = czm_srgbToLinear(color);
#endif
baseColorWithAlpha *= color;
#endif
material.diffuse = baseColorWithAlpha.rgb;
material.alpha = baseColorWithAlpha.a;
#ifdef USE_CPU_STYLING
material.diffuse = blend(material.diffuse, feature.color.rgb, model_colorBlend);
#endif
#ifdef HAS_OCCLUSION_TEXTURE
vec2 occlusionTexCoords = TEXCOORD_OCCLUSION;
#ifdef HAS_OCCLUSION_TEXTURE_TRANSFORM
occlusionTexCoords = computeTextureTransform(occlusionTexCoords, u_occlusionTextureTransform);
#endif
material.occlusion = texture2D(u_occlusionTexture, occlusionTexCoords).r;
#endif
#ifdef HAS_EMISSIVE_TEXTURE
vec2 emissiveTexCoords = TEXCOORD_EMISSIVE;
#ifdef HAS_EMISSIVE_TEXTURE_TRANSFORM
emissiveTexCoords = computeTextureTransform(emissiveTexCoords, u_emissiveTextureTransform);
#endif
vec3 emissive = czm_srgbToLinear(texture2D(u_emissiveTexture, emissiveTexCoords).rgb);
#ifdef HAS_EMISSIVE_FACTOR
emissive *= u_emissiveFactor;
#endif
material.emissive = emissive;
#elif defined(HAS_EMISSIVE_FACTOR)
material.emissive = u_emissiveFactor;
#endif
#if defined(LIGHTING_PBR) && defined(USE_SPECULAR_GLOSSINESS)
#ifdef HAS_SPECULAR_GLOSSINESS_TEXTURE
vec2 specularGlossinessTexCoords = TEXCOORD_SPECULAR_GLOSSINESS;
#ifdef HAS_SPECULAR_GLOSSINESS_TEXTURE_TRANSFORM
specularGlossinessTexCoords = computeTextureTransform(specularGlossinessTexCoords, u_specularGlossinessTextureTransform);
#endif
vec4 specularGlossiness = czm_srgbToLinear(texture2D(u_specularGlossinessTexture, specularGlossinessTexCoords));
vec3 specular = specularGlossiness.rgb;
float glossiness = specularGlossiness.a;
#ifdef HAS_SPECULAR_FACTOR
specular *= u_specularFactor;
#endif
#ifdef HAS_GLOSSINESS_FACTOR
glossiness *= u_glossinessFactor;
#endif
#else
#ifdef HAS_SPECULAR_FACTOR
vec3 specular = clamp(u_specularFactor, vec3(0.0), vec3(1.0));
#else
vec3 specular = vec3(1.0);
#endif
#ifdef HAS_GLOSSINESS_FACTOR
float glossiness = clamp(u_glossinessFactor, 0.0, 1.0);
#else
float glossiness = 1.0;
#endif
#endif
#ifdef HAS_DIFFUSE_TEXTURE
vec2 diffuseTexCoords = TEXCOORD_DIFFUSE;
#ifdef HAS_DIFFUSE_TEXTURE_TRANSFORM
diffuseTexCoords = computeTextureTransform(diffuseTexCoords, u_diffuseTextureTransform);
#endif
vec4 diffuse = czm_srgbToLinear(texture2D(u_diffuseTexture, diffuseTexCoords));
#ifdef HAS_DIFFUSE_FACTOR
diffuse *= u_diffuseFactor;
#endif
#elif defined(HAS_DIFFUSE_FACTOR)
vec4 diffuse = clamp(u_diffuseFactor, vec4(0.0), vec4(1.0));
#else
vec4 diffuse = vec4(1.0);
#endif
czm_pbrParameters parameters = czm_pbrSpecularGlossinessMaterial(
diffuse.rgb,
specular,
glossiness
);
material.diffuse = parameters.diffuseColor;
material.alpha = diffuse.a;
material.specular = parameters.f0;
material.roughness = parameters.roughness;
#elif defined(LIGHTING_PBR)
#ifdef HAS_METALLIC_ROUGHNESS_TEXTURE
vec2 metallicRoughnessTexCoords = TEXCOORD_METALLIC_ROUGHNESS;
#ifdef HAS_METALLIC_ROUGHNESS_TEXTURE_TRANSFORM
metallicRoughnessTexCoords = computeTextureTransform(metallicRoughnessTexCoords, u_metallicRoughnessTextureTransform);
#endif
vec3 metallicRoughness = texture2D(u_metallicRoughnessTexture, metallicRoughnessTexCoords).rgb;
float metalness = clamp(metallicRoughness.b, 0.0, 1.0);
float roughness = clamp(metallicRoughness.g, 0.04, 1.0);
#ifdef HAS_METALLIC_FACTOR
metalness *= u_metallicFactor;
#endif
#ifdef HAS_ROUGHNESS_FACTOR
roughness *= u_roughnessFactor;
#endif
#else
#ifdef HAS_METALLIC_FACTOR
float metalness = clamp(u_metallicFactor, 0.0, 1.0);
#else
float metalness = 1.0;
#endif
#ifdef HAS_ROUGHNESS_FACTOR
float roughness = clamp(u_roughnessFactor, 0.04, 1.0);
#else
float roughness = 1.0;
#endif
#endif
czm_pbrParameters parameters = czm_pbrMetallicRoughnessMaterial(
material.diffuse,
metalness,
roughness
);
material.diffuse = parameters.diffuseColor;
material.specular = parameters.f0;
material.roughness = parameters.roughness;
#endif
}
`;var jOe=It.Material,mG=It.MetallicRoughness,pG=It.SpecularGlossiness,p$={name:"MaterialPipelineStage",_processTexture:d_,_processTextureTransform:_$};p$.process=function(t,n,i){let o=n.material,r=t.model,s=f(r.classificationType),a=s,c=t.uniformMap,l=t.shaderBuilder,u=i.context.defaultTexture,d=i.context.defaultNormalTexture,h=i.context.defaultEmissiveTexture;qOe(o,c,l,u,d,h,a),f(o.specularGlossiness)?YOe(o,c,l,u,a):XOe(o,c,l,u,a);let _=on.getAttributeBySemantic(n,Tt.NORMAL),y=t.lightingOptions;o.unlit||!_||s?y.lightingModel=vm.UNLIT:y.lightingModel=vm.PBR;let p=r.backFaceCulling&&!o.doubleSided;t.renderStateOptions.cull.enabled=p;let C=t.alphaOptions;o.alphaMode===pm.BLEND?C.pass=Te.TRANSLUCENT:o.alphaMode===pm.MASK&&(C.alphaCutoff=o.alphaCutoff),l.addFragmentLines(TM),o.doubleSided&&l.addDefine("HAS_DOUBLE_SIDED_MATERIAL",void 0,Ee.BOTH)};function _$(t,n,i,o,r){let s=`HAS_${r}_TEXTURE_TRANSFORM`;t.addDefine(s,void 0,Ee.FRAGMENT);let a=`${o}Transform`;t.addUniform("mat3",a,Ee.FRAGMENT),n[a]=function(){return i.transform}}function d_(t,n,i,o,r,s){t.addUniform("sampler2D",o,Ee.FRAGMENT),n[o]=function(){return A(i.texture,s)};let a=`HAS_${r}_TEXTURE`;t.addDefine(a,void 0,Ee.FRAGMENT);let l=`v_texCoord_${i.texCoord}`,u=`TEXCOORD_${r}`;t.addDefine(u,l,Ee.FRAGMENT);let d=i.transform;f(d)&&!$.equals(d,$.IDENTITY)&&_$(t,n,i,o,r)}function qOe(t,n,i,o,r,s,a){let c=t.emissiveTexture;f(c)&&!a&&d_(i,n,c,"u_emissiveTexture","EMISSIVE",s);let l=t.emissiveFactor;f(l)&&!m.equals(l,jOe.DEFAULT_EMISSIVE_FACTOR)&&(i.addUniform("vec3","u_emissiveFactor",Ee.FRAGMENT),n.u_emissiveFactor=function(){return t.emissiveFactor},i.addDefine("HAS_EMISSIVE_FACTOR",void 0,Ee.FRAGMENT));let u=t.normalTexture;f(u)&&!a&&d_(i,n,u,"u_normalTexture","NORMAL",r);let d=t.occlusionTexture;f(d)&&!a&&d_(i,n,d,"u_occlusionTexture","OCCLUSION",o)}function YOe(t,n,i,o,r){let s=t.specularGlossiness;i.addDefine("USE_SPECULAR_GLOSSINESS",void 0,Ee.FRAGMENT);let a=s.diffuseTexture;f(a)&&!r&&d_(i,n,a,"u_diffuseTexture","DIFFUSE",o);let c=s.diffuseFactor;f(c)&&!se.equals(c,pG.DEFAULT_DIFFUSE_FACTOR)&&(i.addUniform("vec4","u_diffuseFactor",Ee.FRAGMENT),n.u_diffuseFactor=function(){return s.diffuseFactor},i.addDefine("HAS_DIFFUSE_FACTOR",void 0,Ee.FRAGMENT));let l=s.specularGlossinessTexture;f(l)&&!r&&d_(i,n,l,"u_specularGlossinessTexture","SPECULAR_GLOSSINESS",o);let u=s.specularFactor;f(u)&&!m.equals(u,pG.DEFAULT_SPECULAR_FACTOR)&&(i.addUniform("vec3","u_specularFactor",Ee.FRAGMENT),n.u_specularFactor=function(){return s.specularFactor},i.addDefine("HAS_SPECULAR_FACTOR",void 0,Ee.FRAGMENT));let d=s.glossinessFactor;f(d)&&d!==pG.DEFAULT_GLOSSINESS_FACTOR&&(i.addUniform("float","u_glossinessFactor",Ee.FRAGMENT),n.u_glossinessFactor=function(){return s.glossinessFactor},i.addDefine("HAS_GLOSSINESS_FACTOR",void 0,Ee.FRAGMENT))}function XOe(t,n,i,o,r){let s=t.metallicRoughness;i.addDefine("USE_METALLIC_ROUGHNESS",void 0,Ee.FRAGMENT);let a=s.baseColorTexture;f(a)&&!r&&d_(i,n,a,"u_baseColorTexture","BASE_COLOR",o);let c=s.baseColorFactor;f(c)&&!se.equals(c,mG.DEFAULT_BASE_COLOR_FACTOR)&&(i.addUniform("vec4","u_baseColorFactor",Ee.FRAGMENT),n.u_baseColorFactor=function(){return s.baseColorFactor},i.addDefine("HAS_BASE_COLOR_FACTOR",void 0,Ee.FRAGMENT));let l=s.metallicRoughnessTexture;f(l)&&!r&&d_(i,n,l,"u_metallicRoughnessTexture","METALLIC_ROUGHNESS",o);let u=s.metallicFactor;f(u)&&u!==mG.DEFAULT_METALLIC_FACTOR&&(i.addUniform("float","u_metallicFactor",Ee.FRAGMENT),n.u_metallicFactor=function(){return s.metallicFactor},i.addDefine("HAS_METALLIC_FACTOR",void 0,Ee.FRAGMENT));let d=s.roughnessFactor;f(d)&&d!==mG.DEFAULT_ROUGHNESS_FACTOR&&(i.addUniform("float","u_roughnessFactor",Ee.FRAGMENT),n.u_roughnessFactor=function(){return s.roughnessFactor},i.addDefine("HAS_ROUGHNESS_FACTOR",void 0,Ee.FRAGMENT))}var EM=p$;var bM=`void morphTargetsStage(inout ProcessedAttributes attributes)
{
vec3 positionMC = attributes.positionMC;
attributes.positionMC = getMorphedPosition(positionMC);
#ifdef HAS_NORMALS
vec3 normalMC = attributes.normalMC;
attributes.normalMC = getMorphedNormal(normalMC);
#endif
#ifdef HAS_TANGENTS
vec3 tangentMC = attributes.tangentMC;
attributes.tangentMC = getMorphedTangent(tangentMC);
#endif
}
`;var ta={name:"MorphTargetsPipelineStage",FUNCTION_ID_GET_MORPHED_POSITION:"getMorphedPosition",FUNCTION_SIGNATURE_GET_MORPHED_POSITION:"vec3 getMorphedPosition(in vec3 position)",FUNCTION_ID_GET_MORPHED_NORMAL:"getMorphedNormal",FUNCTION_SIGNATURE_GET_MORPHED_NORMAL:"vec3 getMorphedNormal(in vec3 normal)",FUNCTION_ID_GET_MORPHED_TANGENT:"getMorphedTangent",FUNCTION_SIGNATURE_GET_MORPHED_TANGENT:"vec3 getMorphedTangent(in vec3 tangent)"};ta.process=function(t,n){let i=t.shaderBuilder;i.addDefine("HAS_MORPH_TARGETS",void 0,Ee.VERTEX),eRe(i);let o=n.morphTargets.length;for(let c=0;c<o;c++){let l=n.morphTargets[c].attributes,u=l.length;for(let d=0;d<u;d++){let h=l[d],_=h.semantic;_!==Tt.POSITION&&_!==Tt.NORMAL&&_!==Tt.TANGENT||(JOe(t,h,t.attributeIndex,c),t.attributeIndex++)}}tRe(i);let s=t.runtimeNode.morphWeights.length;i.addUniform("float",`u_morphWeights[${s}]`,Ee.VERTEX),i.addVertexLines(bM);let a={u_morphWeights:function(){return t.runtimeNode.morphWeights}};t.uniformMap=At(a,t.uniformMap)};var KOe={attributeString:void 0,functionId:void 0};function JOe(t,n,i,o){let r=t.shaderBuilder;ZOe(t,n,i);let s=QOe(n,KOe);$Oe(r,s,o)}function ZOe(t,n,i){let o={index:i,value:f(n.buffer)?void 0:n.constant,vertexBuffer:n.buffer,componentsPerAttribute:nn.getNumberOfComponents(n.type),componentDatatype:n.componentDatatype,offsetInBytes:n.byteOffset,strideInBytes:n.byteStride,normalize:n.normalized};t.attributes.push(o)}function QOe(t,n){switch(t.semantic){case Tt.POSITION:n.attributeString="Position",n.functionId=ta.FUNCTION_ID_GET_MORPHED_POSITION;break;case Tt.NORMAL:n.attributeString="Normal",n.functionId=ta.FUNCTION_ID_GET_MORPHED_NORMAL;break;case Tt.TANGENT:n.attributeString="Tangent",n.functionId=ta.FUNCTION_ID_GET_MORPHED_TANGENT;break;default:break}return n}function $Oe(t,n,i){let o=n.attributeString,r=`a_target${o}_${i}`,s=`morphed${o} += u_morphWeights[${i}] * a_target${o}_${i};`;t.addAttribute("vec3",r),t.addFunctionLines(n.functionId,[s])}function eRe(t){t.addFunction(ta.FUNCTION_ID_GET_MORPHED_POSITION,ta.FUNCTION_SIGNATURE_GET_MORPHED_POSITION,Ee.VERTEX);let n="vec3 morphedPosition = position;";t.addFunctionLines(ta.FUNCTION_ID_GET_MORPHED_POSITION,[n]),t.addFunction(ta.FUNCTION_ID_GET_MORPHED_NORMAL,ta.FUNCTION_SIGNATURE_GET_MORPHED_NORMAL,Ee.VERTEX);let i="vec3 morphedNormal = normal;";t.addFunctionLines(ta.FUNCTION_ID_GET_MORPHED_NORMAL,[i]),t.addFunction(ta.FUNCTION_ID_GET_MORPHED_TANGENT,ta.FUNCTION_SIGNATURE_GET_MORPHED_TANGENT,Ee.VERTEX);let o="vec3 morphedTangent = tangent;";t.addFunctionLines(ta.FUNCTION_ID_GET_MORPHED_TANGENT,[o])}function tRe(t){let n="return morphedPosition;";t.addFunctionLines(ta.FUNCTION_ID_GET_MORPHED_POSITION,[n]);let i="return morphedNormal;";t.addFunctionLines(ta.FUNCTION_ID_GET_MORPHED_NORMAL,[i]);let o="return morphedTangent;";t.addFunctionLines(ta.FUNCTION_ID_GET_MORPHED_TANGENT,[o])}var SM=ta;var g$={name:"PickingPipelineStage"};g$.process=function(t,n,i){let o=i.context,r=t.runtimeNode,s=t.shaderBuilder,a=t.model,c=r.node.instances;if(t.hasPropertyTable)nRe(t,n,c,o);else if(f(c))iRe(t,o);else{let l=y$(t),u=o.createPickId(l);a._pipelineResources.push(u),a._pickIds.push(u),s.addUniform("vec4","czm_pickColor",Ee.FRAGMENT);let d=t.uniformMap;d.czm_pickColor=function(){return u.color},t.pickId="czm_pickColor"}};function y$(t,n){let i=t.model;if(f(i.pickObject))return i.pickObject;let o={model:i,node:t.runtimeNode,primitive:t.runtimePrimitive},r;if(sr.is3DTiles(i.type)){let s=i.content;r={content:s,primitive:s.tileset,detail:o}}else r={primitive:i,detail:o};return r.id=i.id,f(n)&&(r.instanceId=n),r}function nRe(t,n,i){let o=t.model,r,s,a=o.featureIdLabel,c=o.instanceFeatureIdLabel;f(o.featureTableId)?r=o.featureTableId:f(i)?(s=on.getFeatureIdsByLabel(i.featureIds,c),r=s.propertyTableId):(s=on.getFeatureIdsByLabel(n.featureIds,a),r=s.propertyTableId);let l=o.featureTables[r];t.shaderBuilder.addUniform("sampler2D","model_pickTexture",Ee.FRAGMENT);let d=l.batchTexture;t.uniformMap.model_pickTexture=function(){return A(d.pickTexture,d.defaultTexture)},t.pickId="((selectedFeature.id < int(model_featuresLength)) ? texture2D(model_pickTexture, selectedFeature.st) : vec4(0.0))"}function iRe(t,n){let i=t.instanceCount,o=new Array(i),r=new Uint8Array(i*4),s=t.model,a=s._pipelineResources;for(let h=0;h<i;h++){let _=y$(t,h),y=n.createPickId(_);a.push(y),o[h]=y;let p=y.color;r[h*4+0]=z.floatToByte(p.red),r[h*4+1]=z.floatToByte(p.green),r[h*4+2]=z.floatToByte(p.blue),r[h*4+3]=z.floatToByte(p.alpha)}s._pickIds=o;let c=ut.createVertexBuffer({context:n,typedArray:r,usage:Fe.STATIC_DRAW});c.vertexArrayDestroyable=!1;let l=!1;s.statistics.addBuffer(c,l),a.push(c);let u={index:t.attributeIndex++,vertexBuffer:c,componentsPerAttribute:4,componentDatatype:J.UNSIGNED_BYTE,normalize:!0,offsetInBytes:0,strideInBytes:0,instanceDivisor:1};t.attributes.push(u);let d=t.shaderBuilder;d.addDefine("USE_PICKING",void 0,Ee.BOTH),d.addAttribute("vec4","a_pickColor"),d.addVarying("vec4","v_pickColor"),t.pickId="v_pickColor"}var wM=g$;var oRe={ADD:0,REPLACE:1},Or=Object.freeze(oRe);var DM=`float getPointSizeFromAttenuation(vec3 positionEC) {
float pointSize = model_pointCloudParameters.x;
float geometricError = model_pointCloudParameters.y;
float depthMultiplier = model_pointCloudParameters.z;
float depth = -positionEC.z;
return min((geometricError / depth) * depthMultiplier, pointSize);
}
#ifdef HAS_POINT_CLOUD_SHOW_STYLE
float pointCloudShowStylingStage(in ProcessedAttributes attributes, in Metadata metadata) {
float tiles3d_tileset_time = model_pointCloudParameters.w;
return float(getShowFromStyle(attributes, metadata, tiles3d_tileset_time));
}
#endif
#ifdef HAS_POINT_CLOUD_COLOR_STYLE
vec4 pointCloudColorStylingStage(in ProcessedAttributes attributes, in Metadata metadata) {
float tiles3d_tileset_time = model_pointCloudParameters.w;
return getColorFromStyle(attributes, metadata, tiles3d_tileset_time);
}
#endif
#ifdef HAS_POINT_CLOUD_POINT_SIZE_STYLE
float pointCloudPointSizeStylingStage(in ProcessedAttributes attributes, in Metadata metadata) {
float tiles3d_tileset_time = model_pointCloudParameters.w;
return float(getPointSizeFromStyle(attributes, metadata, tiles3d_tileset_time));
}
#elif defined(HAS_POINT_CLOUD_ATTENUATION)
float pointCloudPointSizeStylingStage(in ProcessedAttributes attributes, in Metadata metadata) {
return getPointSizeFromAttenuation(v_positionEC);
}
#endif
#ifdef HAS_POINT_CLOUD_BACK_FACE_CULLING
float pointCloudBackFaceCullingStage() {
#if defined(HAS_NORMALS) && !defined(HAS_DOUBLE_SIDED_MATERIAL)
return step(-v_normalEC.z, 0.0);
#else
return 1.0;
#endif
}
#endif
`;var rRe=new se,C$={name:"PointCloudStylingPipelineStage"};C$.process=function(t,n,i){let o=t.shaderBuilder,r=t.model,s=r.style,a=r.structuralMetadata,c=f(a)?a.propertyAttributes:void 0,l=f(r.featureTableId)&&r.featureTables[r.featureTableId].featuresLength>0,u=!f(c)&&l;if(f(s)&&!u){let C=lRe(c),x=uRe(s,C);fRe(o,x);let E=dRe(x).indexOf("normalMC")>=0,S=on.getAttributeBySemantic(n,Tt.NORMAL);if(E&&!S)throw new he("Style references the NORMAL semantic but the point cloud does not have normals");o.addDefine("COMPUTE_POSITION_WC_STYLE",void 0,Ee.VERTEX),x.styleTranslucent&&(t.alphaOptions.pass=Te.TRANSLUCENT)}let d=r.pointCloudShading;d.attenuation&&o.addDefine("HAS_POINT_CLOUD_ATTENUATION",void 0,Ee.VERTEX),d.backFaceCulling&&o.addDefine("HAS_POINT_CLOUD_BACK_FACE_CULLING",void 0,Ee.VERTEX);let h,_,y;sr.is3DTiles(r.type)&&(_=!0,h=r.content,y=h.tile.refine===Or.ADD),o.addUniform("vec4","model_pointCloudParameters",Ee.VERTEX),o.addVertexLines(DM);let p=t.uniformMap;p.model_pointCloudParameters=function(){let C=rRe,x=1;_&&(x=y?5:h.tileset.maximumScreenSpaceError),C.x=A(d.maximumAttenuation,x),C.x*=i.pixelRatio;let T=sRe(t,n,d,h);C.y=T*d.geometricErrorScale;let E=i.context,S=i.camera.frustum,w;return i.mode===ne.SCENE2D||S instanceof $t?w=Number.POSITIVE_INFINITY:w=E.drawingBufferHeight/i.camera.frustum.sseDenominator,C.z=w,_&&(C.w=h.tileset.timeSinceLoad),C}};var A$=new m;function sRe(t,n,i,o){if(f(o)){let d=o.tile.geometricError;if(d>0)return d}if(f(i.baseResolution))return i.baseResolution;let r=on.getAttributeBySemantic(n,Tt.POSITION),s=r.count,a=t.runtimeNode.transform,c=m.subtract(r.max,r.min,A$);c=N.multiplyByPointAsVector(a,c,A$);let l=c.x*c.y*c.z;return B.cbrt(l/s)}var aRe={colorStyleFunction:void 0,showStyleFunction:void 0,pointSizeStyleFunction:void 0,styleTranslucent:!1},cRe={POSITION:"attributes.positionMC",POSITION_ABSOLUTE:"v_positionWC",COLOR:"attributes.color_0",NORMAL:"attributes.normalMC"};function lRe(t){let n=tt(cRe);if(!f(t))return n;for(let i=0;i<t.length;i++){let r=t[i].properties;for(let s in r)r.hasOwnProperty(s)&&(n[s]=`metadata.${s}`)}return n}var _G="ProcessedAttributes attributes, Metadata metadata, float tiles3d_tileset_time";function uRe(t,n){let i=aRe,o={translucent:!1};return i.colorStyleFunction=t.getColorShaderFunction(`getColorFromStyle(${_G})`,n,o),i.showStyleFunction=t.getShowShaderFunction(`getShowFromStyle(${_G})`,n,o),i.pointSizeStyleFunction=t.getPointSizeShaderFunction(`getPointSizeFromStyle(${_G})`,n,o),i.styleTranslucent=f(i.colorStyleFunction)&&o.translucent,i}function fRe(t,n){let i=n.colorStyleFunction;f(i)&&(t.addDefine("HAS_POINT_CLOUD_COLOR_STYLE",void 0,Ee.BOTH),t.addVertexLines(i),t.addVarying("vec4","v_pointCloudColor"));let o=n.showStyleFunction;f(o)&&(t.addDefine("HAS_POINT_CLOUD_SHOW_STYLE",void 0,Ee.VERTEX),t.addVertexLines(o));let r=n.pointSizeStyleFunction;f(r)&&(t.addDefine("HAS_POINT_CLOUD_POINT_SIZE_STYLE",void 0,Ee.VERTEX),t.addVertexLines(r))}function gG(t,n){let i=/attributes\.(\w+)/g,o=i.exec(t);for(;o!==null;){let r=o[1];n.indexOf(r)===-1&&n.push(r),o=i.exec(t)}}function dRe(t){let n=t.colorStyleFunction,i=t.showStyleFunction,o=t.pointSizeStyleFunction,r=[];return f(n)&&gG(n,r),f(i)&&gG(i,r),f(o)&&gG(o,r),r}var vM=C$;var PM=`void primitiveOutlineStage() {
v_outlineCoordinates = a_outlineCoordinates;
}
`;var IM=`void primitiveOutlineStage(inout czm_modelMaterial material) {
if (!model_showOutline) {
return;
}
float outlineX =
texture2D(model_outlineTexture, vec2(v_outlineCoordinates.x, 0.5)).r;
float outlineY =
texture2D(model_outlineTexture, vec2(v_outlineCoordinates.y, 0.5)).r;
float outlineZ =
texture2D(model_outlineTexture, vec2(v_outlineCoordinates.z, 0.5)).r;
float outlineness = max(outlineX, max(outlineY, outlineZ));
material.diffuse = mix(material.diffuse, model_outlineColor.rgb, model_outlineColor.a * outlineness);
}
`;var x$={name:"PrimitiveOutlinePipelineStage"};x$.process=function(t,n,i){let o=t.shaderBuilder,r=t.uniformMap;o.addDefine("HAS_PRIMITIVE_OUTLINE",void 0,Ee.BOTH),o.addAttribute("vec3","a_outlineCoordinates"),o.addVarying("vec3","v_outlineCoordinates");let s=n.outlineCoordinates,a={index:t.attributeIndex++,vertexBuffer:s.buffer,componentsPerAttribute:nn.getNumberOfComponents(s.type),componentDatatype:s.componentDatatype,offsetInBytes:s.byteOffset,strideInBytes:s.byteStride,normalize:s.normalized};t.attributes.push(a),o.addUniform("sampler2D","model_outlineTexture",Ee.FRAGMENT);let c=kC.createTexture(i.context);r.model_outlineTexture=function(){return c};let l=t.model;o.addUniform("vec4","model_outlineColor",Ee.FRAGMENT),r.model_outlineColor=function(){return l.outlineColor},o.addUniform("bool","model_showOutline",Ee.FRAGMENT),r.model_showOutline=function(){return l.showOutline},o.addVertexLines(PM),o.addFragmentLines(IM)};var BM=x$;var T$={name:"PrimitiveStatisticsPipelineStage",_countGeometry:E$,_count2DPositions:b$,_countMorphTargetAttributes:S$,_countMaterialTextures:w$,_countFeatureIdTextures:D$,_countBinaryMetadata:v$};T$.process=function(t,n,i){let o=t.model,r=o.statistics;E$(r,n),b$(r,t.runtimePrimitive),S$(r,n),w$(r,n.material),D$(r,n.featureIds),v$(r,o)};function E$(t,n){let i=f(n.indices)?n.indices.count:on.getAttributeBySemantic(n,"POSITION").count,o=n.primitiveType;o===Re.POINTS?t.pointsLength+=i:Re.isTriangles(o)&&(t.trianglesLength+=hRe(o,i));let r=n.attributes,s=r.length;for(let l=0;l<s;l++){let u=r[l];if(f(u.buffer)){let d=f(u.typedArray);t.addBuffer(u.buffer,d)}}let a=n.outlineCoordinates;f(a)&&f(a.buffer)&&t.addBuffer(a.buffer,!1);let c=n.indices;if(f(c)&&f(c.buffer)){let l=f(c.typedArray);t.addBuffer(c.buffer,l)}}function hRe(t,n){switch(t){case Re.TRIANGLES:return n/3;case Re.TRIANGLE_STRIP:case Re.TRIANGLE_FAN:return Math.max(n-2,0);default:return 0}}function b$(t,n){let i=n.positionBuffer2D;f(i)&&t.addBuffer(i,!0)}function S$(t,n){let i=n.morphTargets;if(!f(i))return;let o=!1,r=i.length;for(let s=0;s<r;s++){let a=i[s].attributes,c=a.length;for(let l=0;l<c;l++){let u=a[l];f(u.buffer)&&t.addBuffer(u.buffer,o)}}}function w$(t,n){let i=mRe(n),o=i.length;for(let r=0;r<o;r++){let s=i[r];f(s)&&f(s.texture)&&t.addTexture(s.texture)}}function mRe(t){let n=t.metallicRoughness,i=[t.emissiveTexture,t.normalTexture,t.occlusionTexture,n.baseColorTexture,n.metallicRoughnessTexture],o=t.specularGlossiness;return f(o)&&(i.push(o.diffuseTexture),i.push(o.specularGlossinessTexture)),i}function D$(t,n){let i=n.length;for(let o=0;o<i;o++){let r=n[o];if(r instanceof It.FeatureIdTexture){let s=r.textureReader;f(s.texture)&&t.addTexture(s.texture)}}}function v$(t,n){let i=n.structuralMetadata;f(i)&&(pRe(t,i),t.propertyTablesByteLength+=i.propertyTablesByteLength);let o=n.featureTables;if(!f(o))return;let r=o.length;for(let s=0;s<r;s++){let a=o[s];t.addBatchTexture(a.batchTexture)}}function pRe(t,n){let i=n.propertyTextures;if(!f(i))return;let o=i.length;for(let r=0;r<o;r++){let a=i[r].properties;for(let c in a)if(a.hasOwnProperty(c)){let u=a[c].textureReader;f(u.texture)&&t.addTexture(u.texture)}}}var OM=T$;var _Re=new N,gRe=new N,P$={name:"SceneMode2DPipelineStage"};P$.process=function(t,n,i){let o=on.getAttributeBySemantic(n,Tt.POSITION),r=t.shaderBuilder,s=t.model,a=s.sceneGraph.computedModelMatrix,c=t.runtimeNode.computedTransform,l=N.multiplyTransformation(a,c,_Re),u=CRe(t,l,i),d=t.runtimePrimitive;d.boundingSphere2D=u;let h=t.runtimeNode.node.instances;if(f(h))return;if(f(o.typedArray)){let C=ERe(o,l,u,i);d.positionBuffer2D=C,s._modelResources.push(C),o.typedArray=void 0}r.addDefine("USE_2D_POSITIONS",void 0,Ee.VERTEX),r.addUniform("mat4","u_modelView2D",Ee.VERTEX);let _=N.fromTranslation(u.center,new N),y=i.context,p={u_modelView2D:function(){return N.multiplyTransformation(y.uniformState.view,_,gRe)}};t.uniformMap=At(p,t.uniformMap)};var yRe=new m,ARe=new m;function CRe(t,n,i){let o=N.multiplyByPoint(n,t.positionMin,yRe),r=Yi.computeActualWgs84Position(i,o,o),s=N.multiplyByPoint(n,t.positionMax,ARe),a=Yi.computeActualWgs84Position(i,s,s);return ae.fromCornerPoints(r,a,new ae)}var I$=new m;function xRe(t,n){let i=t.length,o=new Float32Array(i),r=n.quantizedVolumeOffset,s=n.quantizedVolumeStepSize;for(let a=0;a<i;a+=3){let c=m.fromArray(t,a,I$),l=m.multiplyComponents(c,s,c),u=m.add(l,r,l);o[a]=u.x,o[a+1]=u.y,o[a+2]=u.z}return o}function TRe(t,n,i,o){let r;f(t.quantization)?r=xRe(t.typedArray,t.quantization):r=t.typedArray.slice();let s=t.byteOffset/Float32Array.BYTES_PER_ELEMENT,a=r.length,c=f(t.byteStride)?t.byteStride/Float32Array.BYTES_PER_ELEMENT:3;for(let l=s;l<a;l+=c){let u=m.fromArray(r,l,I$);if(isNaN(u.x)||isNaN(u.y)||isNaN(u.z))continue;let d=N.multiplyByPoint(n,u,u),h=Yi.computeActualWgs84Position(o,d,d),_=m.subtract(h,i,h);r[l]=_.x,r[l+1]=_.y,r[l+2]=_.z}return r}function ERe(t,n,i,o){let r=tt(o);r.mode=ne.COLUMBUS_VIEW;let s=i.center,a=TRe(t,n,s,r),c=ut.createVertexBuffer({context:o.context,typedArray:a,usage:Fe.STATIC_DRAW});return c.vertexArrayDestroyable=!1,c}var RM=P$;var MM=`void skinningStage(inout ProcessedAttributes attributes)
{
mat4 skinningMatrix = getSkinningMatrix();
mat3 skinningMatrixMat3 = mat3(skinningMatrix);
vec4 positionMC = vec4(attributes.positionMC, 1.0);
attributes.positionMC = vec3(skinningMatrix * positionMC);
#ifdef HAS_NORMALS
vec3 normalMC = attributes.normalMC;
attributes.normalMC = skinningMatrixMat3 * normalMC;
#endif
#ifdef HAS_TANGENTS
vec3 tangentMC = attributes.tangentMC;
attributes.tangentMC = skinningMatrixMat3 * tangentMC;
#endif
}
`;var q0={name:"SkinningPipelineStage",FUNCTION_ID_GET_SKINNING_MATRIX:"getSkinningMatrix",FUNCTION_SIGNATURE_GET_SKINNING_MATRIX:"mat4 getSkinningMatrix()"};q0.process=function(t,n){let i=t.shaderBuilder;i.addDefine("HAS_SKINNING",void 0,Ee.VERTEX),SRe(i,n);let o=t.runtimeNode,r=o.computedJointMatrices;i.addUniform("mat4",`u_jointMatrices[${r.length}]`,Ee.VERTEX),i.addVertexLines(MM);let s={u_jointMatrices:function(){return o.computedJointMatrices}};t.uniformMap=At(s,t.uniformMap)};function bRe(t){let n=-1,i=t.attributes,o=i.length;for(let r=0;r<o;r++){let s=i[r];(s.semantic===Tt.JOINTS||s.semantic===Tt.WEIGHTS)&&(n=Math.max(n,s.setIndex))}return n}function SRe(t,n){t.addFunction(q0.FUNCTION_ID_GET_SKINNING_MATRIX,q0.FUNCTION_SIGNATURE_GET_SKINNING_MATRIX,Ee.VERTEX);let i="mat4 skinnedMatrix = mat4(0);";t.addFunctionLines(q0.FUNCTION_ID_GET_SKINNING_MATRIX,[i]);let o,r,s=["x","y","z","w"],a=bRe(n);for(o=0;o<=a;o++)for(r=0;r<=3;r++){let l=s[r],u=`skinnedMatrix += a_weights_${o}.${l} * u_jointMatrices[int(a_joints_${o}.${l})];`;t.addFunctionLines(q0.FUNCTION_ID_GET_SKINNING_MATRIX,[u])}let c="return skinnedMatrix;";t.addFunctionLines(q0.FUNCTION_ID_GET_SKINNING_MATRIX,[c])}var LM=q0;var yG={};function wRe(t){let n=Ne.createTypedArray(t,t*2),i=t,o=0;for(let r=0;r<i;r+=3)n[o++]=r,n[o++]=r+1,n[o++]=r+1,n[o++]=r+2,n[o++]=r+2,n[o++]=r;return n}function DRe(t,n){let i=n.length,o=Ne.createTypedArray(t,i*2),r=0;for(let s=0;s<i;s+=3){let a=n[s],c=n[s+1],l=n[s+2];o[r++]=a,o[r++]=c,o[r++]=c,o[r++]=l,o[r++]=l,o[r++]=a}return o}function vRe(t){let n=t-2,i=2+n*4,o=Ne.createTypedArray(t,i),r=0;o[r++]=0,o[r++]=1;for(let s=0;s<n;s++)o[r++]=s+1,o[r++]=s+2,o[r++]=s+2,o[r++]=s;return o}function PRe(t,n){let o=n.length-2,r=2+o*4,s=Ne.createTypedArray(t,r),a=0;s[a++]=n[0],s[a++]=n[1];for(let c=0;c<o;c++){let l=n[c],u=n[c+1],d=n[c+2];s[a++]=u,s[a++]=d,s[a++]=d,s[a++]=l}return s}function IRe(t){let n=t-2,i=2+n*4,o=Ne.createTypedArray(t,i),r=0;o[r++]=0,o[r++]=1;for(let s=0;s<n;s++)o[r++]=s+1,o[r++]=s+2,o[r++]=s+2,o[r++]=0;return o}function BRe(t,n){let o=n.length-2,r=2+o*4,s=Ne.createTypedArray(t,r),a=0,c=n[0];s[a++]=c,s[a++]=n[1];for(let l=0;l<o;l++){let u=n[l+1],d=n[l+2];s[a++]=u,s[a++]=d,s[a++]=d,s[a++]=c}return s}yG.createWireframeIndices=function(t,n,i){let o=f(i);if(t===Re.TRIANGLES)return o?DRe(n,i):wRe(n);if(t===Re.TRIANGLE_STRIP)return o?PRe(n,i):vRe(n);if(t===Re.TRIANGLE_FAN)return o?BRe(n,i):IRe(n)};yG.getWireframeIndicesCount=function(t,n){return t===Re.TRIANGLES?n*2:t===Re.TRIANGLE_STRIP||t===Re.TRIANGLE_FAN?2+(n-2)*4:n};var yS=yG;var B$={name:"WireframePipelineStage"};B$.process=function(t,n,i){t.shaderBuilder.addDefine("HAS_WIREFRAME",void 0,Ee.FRAGMENT);let r=t.model,s=ORe(n,t.indices,i);r._pipelineResources.push(s),t.wireframeIndexBuffer=s;let a=!1;r.statistics.addBuffer(s,a);let c=t.primitiveType,l=t.count;t.primitiveType=Re.LINES,t.count=yS.getWireframeIndicesCount(c,l)};function ORe(t,n,i){let r=on.getAttributeBySemantic(t,Tt.POSITION).count,s=i.context.webgl2,a;if(f(n)){let d=n.buffer,h=n.count;f(d)&&s?(a=d.sizeInBytes===h?new Uint8Array(h):Ne.createTypedArray(r,h),d.getBufferData(a)):a=n.typedArray}let c=t.primitiveType,l=yS.createWireframeIndices(c,r,a),u=Ne.fromSizeInBytes(l.BYTES_PER_ELEMENT);return ut.createIndexBuffer({context:i.context,typedArray:l,usage:Fe.STATIC_DRAW,indexDatatype:u})}var FM=B$;function O$(t){t=A(t,A.EMPTY_OBJECT);let n=t.primitive,i=t.node,o=t.model;this.primitive=n,this.node=i,this.model=o,this.pipelineStages=[],this.drawCommand=void 0,this.boundingSphere=void 0,this.boundingSphere2D=void 0,this.positionBuffer2D=void 0,this.batchLengths=void 0,this.batchOffsets=void 0,this.updateStages=[]}O$.prototype.configurePipeline=function(t){let n=this.pipelineStages;n.length=0;let i=this.primitive,o=this.node,r=this.model,s=r.customShader,a=r.style,c=t.context.webgl2,u=t.mode!==ne.SCENE3D&&!t.scene3DOnly&&r._projectTo2D,d=f(i.morphTargets)&&i.morphTargets.length>0,h=f(o.skin),_=f(s),p=!(_&&f(s.fragmentShaderText))||s.mode!==f_.REPLACE_MATERIAL,C=on.hasQuantizedAttributes(i.attributes),x=r.debugWireframe&&Re.isTriangles(i.primitiveType)&&(r._enableDebugWireframe||c),T=r.pointCloudShading,E=f(T)&&T.attenuation,S=f(T)&&T.backFaceCulling,w=i.primitiveType===Re.POINTS&&(f(a)||E||S),D=r._enableShowOutline&&f(i.outlineCoordinates),I=RRe(r,o,i),O=f(r.classificationType);u&&n.push(RM),n.push(AM),x&&n.push(FM),O&&n.push(rM),d&&n.push(SM),h&&n.push(LM),w&&n.push(vM),C&&n.push(_M),p&&n.push(EM),n.push(G0),n.push(Bf),I.hasPropertyTable&&(n.push(j0),n.push(oM),n.push(cM)),_&&n.push(pM),n.push(xM),r.allowPicking&&n.push(wM),D&&n.push(BM),n.push(iM),n.push(OM)};function RRe(t,n,i){let o;return f(n.instances)&&(o=on.getFeatureIdsByLabel(n.instances.featureIds,t.instanceFeatureIdLabel),f(o))?{hasFeatureIds:!0,hasPropertyTable:f(o.propertyTableId)}:(o=on.getFeatureIdsByLabel(i.featureIds,t.featureIdLabel),f(o)?{hasFeatureIds:!0,hasPropertyTable:f(o.propertyTableId)}:{hasFeatureIds:!1,hasPropertyTable:!1})}var NM=O$;function AG(t){t=A(t,A.EMPTY_OBJECT),this._sceneGraph=t.sceneGraph;let n=t.skin;this._skin=n,this._inverseBindMatrices=void 0,this._joints=[],this._jointMatrices=[],MRe(this)}Object.defineProperties(AG.prototype,{skin:{get:function(){return this._skin}},sceneGraph:{get:function(){return this._sceneGraph}},inverseBindMatrices:{get:function(){return this._inverseBindMatrices}},joints:{get:function(){return this._joints}},jointMatrices:{get:function(){return this._jointMatrices}}});function MRe(t){let n=t.skin,i=n.inverseBindMatrices;t._inverseBindMatrices=i;let o=n.joints,r=o.length,s=t.sceneGraph._runtimeNodes,a=t.joints,c=t._jointMatrices;for(let l=0;l<r;l++){let u=o[l].index,d=s[u];a.push(d);let h=i[l],_=R$(d,h,new N);c.push(_)}}function R$(t,n,i){let o=N.multiplyTransformation(t.transformToRoot,t.transform,i);return i=N.multiplyTransformation(o,n,i),i}AG.prototype.updateJointMatrices=function(){let t=this._jointMatrices,n=t.length;for(let i=0;i<n;i++){let o=this.joints[i],r=this.inverseBindMatrices[i];t[i]=R$(o,r,t[i])}};var VM=AG;function LRe(){this.pass=void 0,this.alphaCutoff=void 0}var kM=LRe;function CG(t){this.name=t,this.fields=[]}CG.prototype.addField=function(t,n){let i=`    ${t} ${n};`;this.fields.push(i)};CG.prototype.generateGlslLines=function(){let t=this.fields;return t.length===0&&(t=["    float _empty;"]),[].concat(`struct ${this.name}`,"{",t,"};")};var UM=CG;function xG(t){this.signature=t,this.body=[]}xG.prototype.addLines=function(t){let n=this.body;if(Array.isArray(t)){let i=t.length;for(let o=0;o<i;o++)n.push(`    ${t[o]}`)}else n.push(`    ${t}`)};xG.prototype.generateGlslLines=function(){return[].concat(this.signature,"{",this.body,"}")};var zM=xG;function lc(){this._positionAttributeLine=void 0,this._nextAttributeLocation=1,this._attributeLocations={},this._attributeLines=[],this._structs={},this._functions={},this._vertexShaderParts={defineLines:[],uniformLines:[],shaderLines:[],varyingLines:[],structIds:[],functionIds:[]},this._fragmentShaderParts={defineLines:[],uniformLines:[],shaderLines:[],varyingLines:[],structIds:[],functionIds:[]}}Object.defineProperties(lc.prototype,{attributeLocations:{get:function(){return this._attributeLocations}}});lc.prototype.addDefine=function(t,n,i){i=A(i,Ee.BOTH);let o=t;f(n)&&(o+=` ${n.toString()}`),Ee.includesVertexShader(i)&&this._vertexShaderParts.defineLines.push(o),Ee.includesFragmentShader(i)&&this._fragmentShaderParts.defineLines.push(o)};lc.prototype.addStruct=function(t,n,i){this._structs[t]=new UM(n),Ee.includesVertexShader(i)&&this._vertexShaderParts.structIds.push(t),Ee.includesFragmentShader(i)&&this._fragmentShaderParts.structIds.push(t)};lc.prototype.addStructField=function(t,n,i){this._structs[t].addField(n,i)};lc.prototype.addFunction=function(t,n,i){this._functions[t]=new zM(n),Ee.includesVertexShader(i)&&this._vertexShaderParts.functionIds.push(t),Ee.includesFragmentShader(i)&&this._fragmentShaderParts.functionIds.push(t)};lc.prototype.addFunctionLines=function(t,n){this._functions[t].addLines(n)};lc.prototype.addUniform=function(t,n,i){i=A(i,Ee.BOTH);let o=`uniform ${t} ${n};`;if(t.startsWith("vec3_array")){let r=t.split("_")[2];o=`uniform vec3 ${n}[${r}];`}else if(t.startsWith("vec4_array")){let r=t.split("_")[2];o=`uniform vec4 ${n}[${r}];`}else if(t.startsWith("float_array")){let r=t.split("_")[2];o=`uniform float ${n}[${r}];`}Ee.includesVertexShader(i)&&this._vertexShaderParts.uniformLines.push(o),Ee.includesFragmentShader(i)&&this._fragmentShaderParts.uniformLines.push(o)};lc.prototype.setPositionAttribute=function(t,n){return this._positionAttributeLine=`attribute ${t} ${n};`,this._attributeLocations[n]=0,0};lc.prototype.addAttribute=function(t,n){let i=`attribute ${t} ${n};`;this._attributeLines.push(i);let o=this._nextAttributeLocation;return this._attributeLocations[n]=o,this._nextAttributeLocation+=NRe(t),o};lc.prototype.addVarying=function(t,n){let i=`varying ${t} ${n};`;this._vertexShaderParts.varyingLines.push(i),this._fragmentShaderParts.varyingLines.push(i)};lc.prototype.addVertexLines=function(t){let n=this._vertexShaderParts.shaderLines;Array.isArray(t)?n.push.apply(n,t):n.push(t)};lc.prototype.addFragmentLines=function(t){let n=this._fragmentShaderParts.shaderLines;Array.isArray(t)?n.push.apply(n,t):n.push(t)};lc.prototype.buildShaderProgram=function(t){let n=f(this._positionAttributeLine)?[this._positionAttributeLine]:[],i=FRe(this),o=VRe(this),r=n.concat(this._attributeLines,this._vertexShaderParts.uniformLines,this._vertexShaderParts.varyingLines,i.vertexLines,o.vertexLines,this._vertexShaderParts.shaderLines).join(`
`),s=new ze({defines:this._vertexShaderParts.defineLines,sources:[r]}),a=this._fragmentShaderParts.uniformLines.concat(this._fragmentShaderParts.varyingLines,i.fragmentLines,o.fragmentLines,this._fragmentShaderParts.shaderLines).join(`
`),c=new ze({defines:this._fragmentShaderParts.defineLines,sources:[a]});return qt.fromCache({context:t,vertexShaderSource:s,fragmentShaderSource:c,attributeLocations:this._attributeLocations})};lc.prototype.clone=function(){return tt(this,!0)};function FRe(t){let n=[],i=[],o,r=t._vertexShaderParts.structIds,s,a,c;for(o=0;o<r.length;o++)s=r[o],a=t._structs[s],c=a.generateGlslLines(),n.push.apply(n,c);for(r=t._fragmentShaderParts.structIds,o=0;o<r.length;o++)s=r[o],a=t._structs[s],c=a.generateGlslLines(),i.push.apply(i,c);return{vertexLines:n,fragmentLines:i}}function NRe(t){switch(t){case"mat2":return 2;case"mat3":return 3;case"mat4":return 4;default:return 1}}function VRe(t){let n=[],i=[],o,r=t._vertexShaderParts.functionIds,s,a,c;for(o=0;o<r.length;o++)s=r[o],a=t._functions[s],c=a.generateGlslLines(),n.push.apply(n,c);for(r=t._fragmentShaderParts.functionIds,o=0;o<r.length;o++)s=r[o],a=t._functions[s],c=a.generateGlslLines(),i.push.apply(i,c);return{vertexLines:n,fragmentLines:i}}var HM=lc;function kRe(t){this.shaderBuilder=new HM,this.model=t,this.uniformMap={},this.alphaOptions=new kM,this.renderStateOptions=Ve.getState(Ve.fromCache({depthTest:{enabled:!0,func:cc.LESS_OR_EQUAL}})),this.hasSilhouette=!1,this.hasSkipLevelOfDetail=!1}var GM=kRe;var WM=`void silhouetteStage(inout vec4 color) {
if(model_silhouettePass) {
color = czm_gammaCorrect(model_silhouetteColor);
}
}
`;var jM=`void silhouetteStage(in ProcessedAttributes attributes, inout vec4 positionClip) {
#ifdef HAS_NORMALS
if(model_silhouettePass) {
vec3 normal = normalize(czm_normal3D * attributes.normalMC);
normal.x *= czm_projection[0][0];
normal.y *= czm_projection[1][1];
positionClip.xy += normal.xy * positionClip.w * model_silhouetteSize * czm_pixelRatio / czm_viewport.z;
}
#endif
}
`;var qM={name:"ModelSilhouettePipelineStage"};qM.silhouettesLength=0;qM.process=function(t,n,i){f(n._silhouetteId)||(n._silhouetteId=++qM.silhouettesLength);let o=t.shaderBuilder;o.addDefine("HAS_SILHOUETTE",void 0,Ee.BOTH),o.addVertexLines(jM),o.addFragmentLines(WM),o.addUniform("vec4","model_silhouetteColor",Ee.FRAGMENT),o.addUniform("float","model_silhouetteSize",Ee.VERTEX),o.addUniform("bool","model_silhouettePass",Ee.BOTH);let r={model_silhouetteColor:function(){return n.silhouetteColor},model_silhouetteSize:function(){return n.silhouetteSize},model_silhouettePass:function(){return!1}};t.uniformMap=At(r,t.uniformMap),t.hasSilhouette=!0};var YM=qM;var XM=`void modelSplitterStage()
{
#ifndef SHADOW_MAP
if (model_splitDirection < 0.0 && gl_FragCoord.x > czm_splitPosition) discard;
if (model_splitDirection > 0.0 && gl_FragCoord.x < czm_splitPosition) discard;
#endif
}
`;var KM={name:"ModelSplitterPipelineStage",SPLIT_DIRECTION_UNIFORM_NAME:"model_splitDirection"};KM.process=function(t,n,i){let o=t.shaderBuilder;o.addDefine("HAS_MODEL_SPLITTER",void 0,Ee.FRAGMENT),o.addFragmentLines(XM);let r={};o.addUniform("float",KM.SPLIT_DIRECTION_UNIFORM_NAME,Ee.FRAGMENT),r[KM.SPLIT_DIRECTION_UNIFORM_NAME]=function(){return n.splitDirection},t.uniformMap=At(r,t.uniformMap)};var JM=KM;function URe(t,n){this.model=t.model,this.shaderBuilder=t.shaderBuilder.clone(),this.uniformMap=tt(t.uniformMap),this.alphaOptions=tt(t.alphaOptions),this.renderStateOptions=tt(t.renderStateOptions,!0),this.hasSilhouette=t.hasSilhouette,this.hasSkipLevelOfDetail=t.hasSkipLevelOfDetail,this.runtimeNode=n,this.attributes=[],this.attributeIndex=1,this.featureIdVertexAttributeSetIndex=0,this.instanceCount=0}var ZM=URe;function zRe(t){t=A(t,A.EMPTY_OBJECT),this.lightingModel=A(t.lightingModel,vm.UNLIT)}var QM=zRe;function HRe(t,n){this.model=t.model,this.runtimeNode=t.runtimeNode,this.attributes=t.attributes.slice(),this.attributeIndex=t.attributeIndex,this.featureIdVertexAttributeSetIndex=t.featureIdVertexAttributeSetIndex,this.uniformMap=tt(t.uniformMap),this.alphaOptions=tt(t.alphaOptions),this.renderStateOptions=tt(t.renderStateOptions,!0),this.hasSilhouette=t.hasSilhouette,this.hasSkipLevelOfDetail=t.hasSkipLevelOfDetail,this.shaderBuilder=t.shaderBuilder.clone(),this.instanceCount=t.instanceCount,this.runtimePrimitive=n;let i=n.primitive;this.count=f(i.indices)?i.indices.count:on.getAttributeBySemantic(i,"POSITION").count,this.hasPropertyTable=!1,this.indices=i.indices,this.wireframeIndexBuffer=void 0,this.primitiveType=i.primitiveType;let o=on.getPositionMinMax(i,this.runtimeNode.instancingTranslationMin,this.runtimeNode.instancingTranslationMax);this.positionMin=m.clone(o.min,new m),this.positionMax=m.clone(o.max,new m),this.boundingSphere=ae.fromCornerPoints(this.positionMin,this.positionMax,new ae),this.lightingOptions=new QM,this.pickId=void 0}var $M=HRe;function Dl(t){t=A(t,A.EMPTY_OBJECT);let n=t.modelComponents;this._model=t.model,this._components=n,this._pipelineStages=[],this._updateStages=[],this._runtimeNodes=[],this._rootNodes=[],this._skinnedNodes=[],this._runtimeSkins=[],this.modelPipelineStages=[],this._boundingSphere=void 0,this._boundingSphere2D=void 0,this._computedModelMatrix=N.clone(N.IDENTITY),this._computedModelMatrix2D=N.clone(N.IDENTITY),this._axisCorrectionMatrix=on.getAxisCorrectionMatrix(n.upAxis,n.forwardAxis,new N),this._runtimeArticulations={},GRe(this)}Object.defineProperties(Dl.prototype,{components:{get:function(){return this._components}},computedModelMatrix:{get:function(){return this._computedModelMatrix}},axisCorrectionMatrix:{get:function(){return this._axisCorrectionMatrix}},boundingSphere:{get:function(){return this._boundingSphere}}});function GRe(t){let n=t._components,i=n.scene,r=t._model.modelMatrix;M$(t,r);let s=n.articulations,a=s.length,c=t._runtimeArticulations;for(let E=0;E<a;E++){let S=s[E],w=new WR({articulation:S,sceneGraph:t}),D=w.name;c[D]=w}let l=n.nodes,u=l.length;t._runtimeNodes=new Array(u);let h=i.nodes.length,_=N.IDENTITY;for(let E=0;E<h;E++){let S=i.nodes[E],w=L$(t,S,_);t._rootNodes.push(w)}let y=n.skins,p=t._runtimeSkins,C=y.length;for(let E=0;E<C;E++){let S=y[E];p.push(new VM({skin:S,sceneGraph:t}))}let x=t._skinnedNodes,T=x.length;for(let E=0;E<T;E++){let S=x[E],w=t._runtimeNodes[S],I=l[S].skin.index;w._runtimeSkin=p[I],w.updateJointMatrices()}t.applyArticulations()}function M$(t,n){let i=t._components,o=t._model;t._computedModelMatrix=N.multiplyTransformation(n,i.transform,t._computedModelMatrix),t._computedModelMatrix=N.multiplyTransformation(t._computedModelMatrix,t._axisCorrectionMatrix,t._computedModelMatrix),t._computedModelMatrix=N.multiplyByUniformScale(t._computedModelMatrix,o.computedScale,t._computedModelMatrix)}var WRe=new m;function jRe(t,n){let i=t._computedModelMatrix,o=N.getTranslation(i,WRe);if(!m.equals(o,m.ZERO))t._computedModelMatrix2D=vt.basisTo2D(n.mapProjection,i,t._computedModelMatrix2D);else{let r=t.boundingSphere.center,s=vt.wgs84To2DModelMatrix(n.mapProjection,r,t._computedModelMatrix2D);t._computedModelMatrix2D=N.multiply(s,i,t._computedModelMatrix2D)}t._boundingSphere2D=ae.transform(t._boundingSphere,t._computedModelMatrix2D,t._boundingSphere2D)}function L$(t,n,i){let o=[],r=on.getNodeTransform(n),s=n.children.length;for(let d=0;d<s;d++){let h=n.children[d],_=N.multiplyTransformation(i,r,new N),y=L$(t,h,_);o.push(y)}let a=new nM({node:n,transform:r,transformToRoot:i,children:o,sceneGraph:t}),c=n.primitives.length;for(let d=0;d<c;d++)a.runtimePrimitives.push(new NM({primitive:n.primitives[d],node:n,model:t._model}));let l=n.index;t._runtimeNodes[l]=a,f(n.skin)&&t._skinnedNodes.push(l);let u=n.name;if(f(u)){let d=t._model,h=new XR(d,a);d._nodesByName[u]=h}return l}var qRe=new m,YRe=new m,XRe=new m,KRe=new m;Dl.prototype.buildDrawCommands=function(t){let n=this._model,i=new GM(n);n.statistics.clear(),this.configurePipeline(t);let o=this.modelPipelineStages,r,s,a;for(r=0;r<o.length;r++)o[r].process(i,n,t);let c=m.fromElements(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,qRe),l=m.fromElements(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE,YRe);for(r=0;r<this._runtimeNodes.length;r++){let u=this._runtimeNodes[r];if(!f(u))continue;u.configurePipeline();let d=u.pipelineStages,h=new ZM(i,u);for(s=0;s<d.length;s++)d[s].process(h,u.node,t);let _=u.computedTransform;for(s=0;s<u.runtimePrimitives.length;s++){let y=u.runtimePrimitives[s];y.configurePipeline(t);let p=y.pipelineStages,C=new $M(h,y);for(a=0;a<p.length;a++)p[a].process(C,y.primitive,t);y.boundingSphere=ae.clone(C.boundingSphere,new ae);let x=N.multiplyByPoint(_,C.positionMin,XRe),T=N.multiplyByPoint(_,C.positionMax,KRe);m.minimumByComponent(c,x,c),m.maximumByComponent(l,T,l);let E=VR(C,t);y.drawCommand=E}}this._boundingSphere=ae.fromCornerPoints(c,l,new ae),this._boundingSphere=ae.transformWithoutScale(this._boundingSphere,this._axisCorrectionMatrix,this._boundingSphere),this._boundingSphere=ae.transform(this._boundingSphere,this._components.transform,this._boundingSphere),n._boundingSphere=ae.transform(this._boundingSphere,n.modelMatrix,n._boundingSphere),n._initialRadius=n._boundingSphere.radius,n._boundingSphere.radius*=n._clampedScale};Dl.prototype.configurePipeline=function(t){let n=this.modelPipelineStages;n.length=0;let i=this._model;f(i.color)&&n.push(z0),!f(i.classificationType)&&(i.imageBasedLighting.enabled&&n.push(zR),i.isClippingEnabled()&&n.push(YR),i.hasSilhouette(t)&&n.push(YM),f(i.splitDirection)&&i.splitDirection!==Wc.NONE&&n.push(JM),sr.is3DTiles(i.type)&&n.push(kR))};Dl.prototype.update=function(t,n){let i,o,r;for(i=0;i<this._runtimeNodes.length;i++){let s=this._runtimeNodes[i];if(!f(s))continue;for(o=0;o<s.updateStages.length;o++)s.updateStages[o].update(s,this,t);let a=t.mode!==ne.SCENE3D&&this._model._projectTo2D;for(n&&!a&&this.updateJointMatrices(),o=0;o<s.runtimePrimitives.length;o++){let c=s.runtimePrimitives[o];for(r=0;r<c.updateStages.length;r++)c.updateStages[r].update(c,this)}}};Dl.prototype.updateModelMatrix=function(t,n){M$(this,t),n.mode!==ne.SCENE3D&&jRe(this,n);let i=this._rootNodes;for(let o=0;o<i.length;o++){let r=this._runtimeNodes[i[o]];r._transformDirty=!0}};Dl.prototype.updateJointMatrices=function(){let t=this._skinnedNodes,n=t.length;for(let i=0;i<n;i++){let o=t[i];this._runtimeNodes[o].updateJointMatrices()}};function F$(t,n,i,o,r){if(i&&!n.show)return;let s=n.children.length;for(let l=0;l<s;l++){let u=n.getChild(l);F$(t,u,i,o,r)}let a=n.runtimePrimitives,c=a.length;for(let l=0;l<c;l++){let u=a[l];o(u,r)}}function eL(t,n,i,o){let r=t._rootNodes,s=r.length;for(let a=0;a<s;a++){let c=r[a],l=t._runtimeNodes[c];F$(t,l,n,i,o)}}var JRe={backFaceCulling:void 0};Dl.prototype.updateBackFaceCulling=function(t){let n=JRe;n.backFaceCulling=t,eL(this,!1,ZRe,n)};function ZRe(t,n){let i=t.drawCommand;i.backFaceCulling=n.backFaceCulling}var QRe={shadowMode:void 0};Dl.prototype.updateShadows=function(t){let n=QRe;n.shadowMode=t,eL(this,!1,$Re,n)};function $Re(t,n){let i=t.drawCommand;i.shadows=n.shadowMode}var eMe={debugShowBoundingVolume:void 0};Dl.prototype.updateShowBoundingVolume=function(t){let n=eMe;n.debugShowBoundingVolume=t,eL(this,!1,tMe,n)};function tMe(t,n){let i=t.drawCommand;i.debugShowBoundingVolume=n.debugShowBoundingVolume}var N$=[],nMe={frameState:void 0,hasSilhouette:void 0};Dl.prototype.pushDrawCommands=function(t){let n=N$;n.length=0;let i=nMe;i.hasSilhouette=this._model.hasSilhouette(t),i.frameState=t,eL(this,!0,iMe,i),t.commandList.push.apply(t.commandList,n)};function iMe(t,n){let i=n.frameState,o=n.hasSilhouette,r=i.passes,s=N$,a=t.drawCommand;a.pushCommands(i,i.commandList),o&&!r.pick&&a.pushSilhouetteCommands(i,s)}Dl.prototype.setArticulationStage=function(t,n){let i=t.split(" ");if(i.length!==2)return;let o=i[0],r=i[1],s=this._runtimeArticulations[o];f(s)&&s.setArticulationStage(r,n)};Dl.prototype.applyArticulations=function(){let t=this._runtimeArticulations;for(let n in t)t.hasOwnProperty(n)&&t[n].apply()};var tL=Dl;function nx(){this.pointsLength=0,this.trianglesLength=0,this.geometryByteLength=0,this.texturesByteLength=0,this.propertyTablesByteLength=0,this._bufferIdSet={},this._textureIdSet={},this._batchTextureIdMap=new yt}Object.defineProperties(nx.prototype,{batchTexturesByteLength:{get:function(){let t=this._batchTextureIdMap.length,n=this._batchTextureIdMap.values,i=0;for(let o=0;o<t;o++)i+=n[o].byteLength;return i}}});nx.prototype.clear=function(){this.pointsLength=0,this.trianglesLength=0,this.geometryByteLength=0,this.texturesByteLength=0,this.propertyTablesByteLength=0,this._bufferIdSet={},this._textureIdSet={},this._batchTextureIdMap.removeAll()};nx.prototype.addBuffer=function(t,n){if(!this._bufferIdSet.hasOwnProperty(t._id)){let i=n?2:1;this.geometryByteLength+=t.sizeInBytes*i}this._bufferIdSet[t._id]=!0};nx.prototype.addTexture=function(t){this._textureIdSet.hasOwnProperty(t._id)||(this.texturesByteLength+=t.sizeInBytes),this._textureIdSet[t._id]=!0};nx.prototype.addBatchTexture=function(t){this._batchTextureIdMap.contains(t._id)||this._batchTextureIdMap.set(t._id,t)};var nL=nx;var z$=yo(pP(),1);var V$={},Y0=Uint32Array.BYTES_PER_ELEMENT;V$.parse=function(t,n){n=A(n,0);let i=new Uint8Array(t),o=new DataView(t);n+=Y0;let r=o.getUint32(n,!0);if(r!==1)throw new he(`Only Point Cloud tile version 1 is supported.  Version ${r} is not.`);n+=Y0,n+=Y0;let s=o.getUint32(n,!0);if(s===0)throw new he("Feature table must have a byte length greater than zero");n+=Y0;let a=o.getUint32(n,!0);n+=Y0;let c=o.getUint32(n,!0);n+=Y0;let l=o.getUint32(n,!0);n+=Y0;let u=Ko(i,n,s);n+=s;let d=new Uint8Array(t,n,a);n+=a;let h,_;c>0&&(h=Ko(i,n,c),n+=c,l>0&&(_=new Uint8Array(t,n,l),n+=l));let y=new Zd(u,d),p=y.getGlobalProperty("POINTS_LENGTH");if(y.featuresLength=p,!f(p))throw new he("Feature table global property: POINTS_LENGTH must be defined");let C=y.getGlobalProperty("RTC_CENTER",J.FLOAT,3);f(C)&&(C=m.unpack(C));let x=oMe(y,h);if(x.rtcCenter=C,x.pointsLength=p,!x.hasPositions){let T=rMe(y);x.positions=T,x.hasPositions=x.hasPositions||f(T)}if(!x.hasPositions)throw new he("Either POSITION or POSITION_QUANTIZED must be defined.");if(!x.hasNormals){let T=aMe(y);x.normals=T,x.hasNormals=x.hasNormals||f(T)}if(!x.hasColors){let T=sMe(y);x.colors=T,x.hasColors=x.hasColors||f(T),x.hasConstantColor=f(x.constantColor),x.isTranslucent=f(T)&&T.isTranslucent}if(!x.hasBatchIds){let T=cMe(y);x.batchIds=T,x.hasBatchIds=x.hasBatchIds||f(T)}if(x.hasBatchIds){let T=y.getGlobalProperty("BATCH_LENGTH");if(!f(T))throw new he("Global property: BATCH_LENGTH must be defined when BATCH_ID is defined.");x.batchLength=T}return f(_)&&(_=new Uint8Array(_),x.batchTableJson=h,x.batchTableBinary=_),x};function oMe(t,n){let i=t.json,o,r,s,a=f(i.extensions)?i.extensions["3DTILES_draco_point_compression"]:void 0,c=f(n)&&f(n.extensions)?n.extensions["3DTILES_draco_point_compression"]:void 0;f(c)&&(s=c.properties);let l,u,d,h,_;if(f(a)){r=a.properties;let p=a.byteOffset,C=a.byteLength;if(!f(r)||!f(p)||!f(C))throw new he("Draco properties, byteOffset, and byteLength must be defined");o=t.buffer.slice(p,p+C),l=f(r.POSITION),u=f(r.RGB)||f(r.RGBA),d=f(r.NORMAL),h=f(r.BATCH_ID),_=f(r.RGBA)}let y;return f(o)&&(y={buffer:o,featureTableProperties:r,batchTableProperties:s,properties:At(r,s),dequantizeInShader:!0}),{draco:y,hasPositions:l,hasColors:u,isTranslucent:_,hasNormals:d,hasBatchIds:h}}function rMe(t){let n=t.json,i;if(f(n.POSITION))return i=t.getPropertyArray("POSITION",J.FLOAT,3),{name:Tt.POSITION,semantic:Tt.POSITION,typedArray:i,isQuantized:!1,componentDatatype:J.FLOAT,type:nn.VEC3};if(f(n.POSITION_QUANTIZED)){i=t.getPropertyArray("POSITION_QUANTIZED",J.UNSIGNED_SHORT,3);let o=t.getGlobalProperty("QUANTIZED_VOLUME_SCALE",J.FLOAT,3);if(!f(o))throw new he("Global property: QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");let r=(1<<16)-1,s=t.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",J.FLOAT,3);if(!f(s))throw new he("Global property: QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");return{name:Tt.POSITION,semantic:Tt.POSITION,typedArray:i,isQuantized:!0,componentDatatype:J.FLOAT,type:nn.VEC3,quantizedRange:r,quantizedVolumeOffset:m.unpack(s),quantizedVolumeScale:m.unpack(o),quantizedComponentDatatype:J.UNSIGNED_SHORT,quantizedType:nn.VEC3}}}function sMe(t){let n=t.json,i;if(f(n.RGBA))return i=t.getPropertyArray("RGBA",J.UNSIGNED_BYTE,4),{name:Tt.COLOR,semantic:Tt.COLOR,setIndex:0,typedArray:i,componentDatatype:J.UNSIGNED_BYTE,type:nn.VEC4,normalized:!0,isRGB565:!1,isTranslucent:!0};if(f(n.RGB))return i=t.getPropertyArray("RGB",J.UNSIGNED_BYTE,3),{name:"COLOR",semantic:Tt.COLOR,setIndex:0,typedArray:i,componentDatatype:J.UNSIGNED_BYTE,type:nn.VEC3,normalized:!0,isRGB565:!1,isTranslucent:!1};if(f(n.RGB565))return i=t.getPropertyArray("RGB565",J.UNSIGNED_SHORT,1),{name:"COLOR",semantic:Tt.COLOR,setIndex:0,typedArray:i,componentDatatype:J.FLOAT,type:nn.VEC3,normalized:!1,isRGB565:!0,isTranslucent:!1};if(f(n.CONSTANT_RGBA)){let o=t.getGlobalProperty("CONSTANT_RGBA",J.UNSIGNED_BYTE,4),r=o[3],s=z.fromBytes(o[0],o[1],o[2],r),a=r<255;return{name:Tt.COLOR,semantic:Tt.COLOR,setIndex:0,constantColor:s,componentDatatype:J.FLOAT,type:nn.VEC4,isQuantized:!1,isTranslucent:a}}}function aMe(t){let n=t.json,i;if(f(n.NORMAL))return i=t.getPropertyArray("NORMAL",J.FLOAT,3),{name:Tt.NORMAL,semantic:Tt.NORMAL,typedArray:i,octEncoded:!1,octEncodedZXY:!1,componentDatatype:J.FLOAT,type:nn.VEC3};if(f(n.NORMAL_OCT16P)){i=t.getPropertyArray("NORMAL_OCT16P",J.UNSIGNED_BYTE,2);let o=8;return{name:Tt.NORMAL,semantic:Tt.NORMAL,typedArray:i,octEncoded:!0,octEncodedZXY:!1,quantizedRange:(1<<o)-1,quantizedType:nn.VEC2,quantizedComponentDatatype:J.UNSIGNED_BYTE,componentDatatype:J.FLOAT,type:nn.VEC3}}}function cMe(t){let n=t.json;if(f(n.BATCH_ID)){let i=t.getPropertyArray("BATCH_ID",J.UNSIGNED_SHORT,1);return{name:Tt.FEATURE_ID,semantic:Tt.FEATURE_ID,setIndex:0,typedArray:i,componentDatatype:J.fromTypedArray(i),type:nn.SCALAR}}}var ix=V$;var lMe=It.Components,uMe=It.Scene,fMe=It.Node,dMe=It.Primitive,hMe=It.Attribute,k$=It.Quantization,mMe=It.FeatureIdAttribute,pMe=It.Material,_Me=It.MetallicRoughness;function h_(t){t=A(t,A.EMPTY_OBJECT);let n=t.arrayBuffer,i=A(t.byteOffset,0);this._arrayBuffer=n,this._byteOffset=i,this._loadAttributesFor2D=A(t.loadAttributesFor2D,!1),this._parsedContent=void 0,this._decodePromise=void 0,this._decodedAttributes=void 0,this._promise=void 0,this._process=function(o){},this._state=kt.UNLOADED,this._buffers=[],this._components=void 0,this._transform=N.IDENTITY}f(Object.create)&&(h_.prototype=Object.create(eo.prototype),h_.prototype.constructor=h_);Object.defineProperties(h_.prototype,{promise:{get:function(){return this._promise}},cacheKey:{get:function(){}},components:{get:function(){return this._components}},transform:{get:function(){return this._transform}}});h_.prototype.load=function(){this._parsedContent=ix.parse(this._arrayBuffer,this._byteOffset),this._state=kt.PROCESSING;let t=this;this._promise=new Promise(function(n,i){t._process=function(o){if(t._state===kt.PROCESSING){if(f(t._decodePromise))return;let r=gMe(t,o.context);f(r)&&r.then(n).catch(i)}}})};h_.prototype.process=function(t){this._process(t)};function gMe(t,n){let o=t._parsedContent.draco,r;if(f(o)?r=Jp.decodePointCloud(o,n):r=Promise.resolve(),!!f(r))return t._decodePromise=r,r.then(function(s){if(!t.isDestroyed())return f(s)&&yMe(t,o,s),PMe(t,n),t._state=kt.READY,t}).catch(function(s){t.unload(),t._state=kt.FAILED;let a="Failed to load Draco pnts";return Promise.reject(t.getError(a,s))})}function yMe(t,n,i){t._state=kt.READY;let o=t._parsedContent,r;if(f(i.POSITION)){if(r={name:"POSITION",semantic:Tt.POSITION,typedArray:i.POSITION.array,componentDatatype:J.FLOAT,type:nn.VEC3,isQuantized:!1},f(i.POSITION.data.quantization)){let c=i.POSITION.data.quantization,l=c.range,u=m.fromElements(l,l,l),d=m.unpack(c.minValues),h=(1<<c.quantizationBits)-1;r.isQuantized=!0,r.quantizedRange=h,r.quantizedVolumeOffset=d,r.quantizedVolumeScale=u,r.quantizedComponentDatatype=h<=255?J.UNSIGNED_BYTE:J.UNSIGNED_SHORT,r.quantizedType=nn.VEC3}o.positions=r}if(f(i.NORMAL)){if(r={name:"NORMAL",semantic:Tt.NORMAL,typedArray:i.NORMAL.array,componentDatatype:J.FLOAT,type:nn.VEC3,isQuantized:!1,octEncoded:!1,octEncodedZXY:!1},f(i.NORMAL.data.quantization)){let c=(1<<i.NORMAL.data.quantization.quantizationBits)-1;r.quantizedRange=c,r.octEncoded=!0,r.octEncodedZXY=!0,r.quantizedComponentDatatype=J.UNSIGNED_BYTE,r.quantizedType=nn.VEC2}o.normals=r}if(f(i.RGBA)?o.colors={name:"COLOR",semantic:Tt.COLOR,setIndex:0,typedArray:i.RGBA.array,componentDatatype:J.UNSIGNED_BYTE,type:nn.VEC4,normalized:!0,isTranslucent:!0}:f(i.RGB)&&(o.colors={name:"COLOR",semantic:Tt.COLOR,setIndex:0,typedArray:i.RGB.array,componentDatatype:J.UNSIGNED_BYTE,type:nn.VEC3,normalized:!0,isTranslucent:!1}),f(i.BATCH_ID)){let c=i.BATCH_ID.array;o.batchIds={name:"_FEATURE_ID",semantic:Tt.FEATURE_ID,setIndex:0,typedArray:c,componentDatatype:J.fromTypedArray(c),type:nn.SCALAR}}let s=o.batchTableJson,a=n.batchTableProperties;for(let c in a)if(a.hasOwnProperty(c)){let l=i[c];f(s)||(s={}),o.hasDracoBatchTable=!0;let u=l.data;s[c]={byteOffset:u.byteOffset,type:AMe(u.componentsPerAttribute),componentType:CMe(u.componentDatatype),typedArray:l.array}}o.batchTableJson=s}function AMe(t){switch(t){case 1:return"SCALAR";case 2:return"VEC2";case 3:return"VEC3";case 4:return"VEC4"}}function CMe(t){switch(t){case ee.BYTE:return"BYTE";case ee.UNSIGNED_BYTE:return"UNSIGNED_BYTE";case ee.SHORT:return"SHORT";case ee.UNSIGNED_SHORT:return"UNSIGNED_SHORT";case ee.INT:return"INT";case ee.UNSIGNED_INT:return"UNSIGNED_INT";case ee.DOUBLE:return"DOUBLE";case ee.FLOAT:return"FLOAT"}}function AS(t,n,i){let o=n.typedArray,r;if(n.octEncoded&&(r=new k$,r.octEncoded=n.octEncoded,r.octEncodedZXY=n.octEncodedZXY,r.normalizationRange=n.quantizedRange,r.type=n.quantizedType,r.componentDatatype=n.quantizedComponentDatatype),n.isQuantized){r=new k$;let c=n.quantizedRange;r.normalizationRange=c,r.quantizedVolumeOffset=m.ZERO;let l=n.quantizedVolumeScale;r.quantizedVolumeDimensions=l,r.quantizedVolumeStepSize=m.divideByScalar(l,c,new m),r.componentDatatype=n.quantizedComponentDatatype,r.type=n.quantizedType}let s=new hMe;if(s.name=n.name,s.semantic=n.semantic,s.setIndex=n.setIndex,s.componentDatatype=n.componentDatatype,s.type=n.type,s.normalized=A(n.normalized,!1),s.min=n.min,s.max=n.max,s.quantization=r,n.isRGB565&&(o=zn.decodeRGB565(o)),f(n.constantColor)){let c=new Array(4);s.constant=z.pack(n.constantColor,c)}else{let c=ut.createVertexBuffer({typedArray:o,context:i,usage:Fe.STATIC_DRAW});c.vertexArrayDestroyable=!1,t._buffers.push(c),s.buffer=c}let a=t._loadAttributesFor2D;return s.semantic===Tt.POSITION&&a&&(s.typedArray=o),s}var U$,iL;function xMe(t){if(!f(iL)){U$=new z$.default(0),iL=new Array(t);for(let n=0;n<t;++n)iL[n]=U$.random()}return iL}var TMe=new m,EMe=new m,bMe=new m;function SMe(t){let n=t.typedArray,i=20,o=n.length/3,r=Math.min(o,i),s=xMe(i),a=Number.MAX_VALUE,c=-Number.MAX_VALUE,l=m.fromElements(a,a,a,TMe),u=m.fromElements(c,c,c,EMe),d,h,_;if(t.isQuantized)l=m.ZERO,u=t.quantizedVolumeScale;else for(d=0;d<r;++d)h=Math.floor(s[d]*o),_=m.unpack(n,h*3,bMe),m.minimumByComponent(l,_,l),m.maximumByComponent(u,_,u);t.min=m.clone(l),t.max=m.clone(u)}var wMe={name:Tt.COLOR,semantic:Tt.COLOR,setIndex:0,constantColor:z.DARKGRAY,componentDatatype:J.FLOAT,type:nn.VEC4,isQuantized:!1,isTranslucent:!1};function DMe(t,n,i){let o=[],r,s=n.positions;return f(s)&&(SMe(s),r=AS(t,s,i),r.count=n.pointsLength,o.push(r)),f(n.normals)&&(r=AS(t,n.normals,i),o.push(r)),f(n.colors)?(r=AS(t,n.colors,i),o.push(r)):(r=AS(t,wMe,i),o.push(r)),f(n.batchIds)&&(r=AS(t,n.batchIds,i),o.push(r)),o}function vMe(t,n){let i=t.batchLength,o=t.pointsLength,r=t.batchTableBinary,s=!f(t.batchIds);if(f(r)||t.hasDracoBatchTable){let a=A(i,o);return s_({count:a,batchTable:t.batchTableJson,binaryBody:r,parseAsPropertyAttributes:s,customAttributeOutput:n})}return new Ea({schema:{},propertyTables:[]})}function PMe(t,n){let i=t._parsedContent,o=new _Me;o.metallicFactor=0,o.roughnessFactor=.9;let r=new pMe;r.metallicRoughness=o;let s=i.colors;f(s)&&s.isTranslucent&&(r.alphaMode=pm.BLEND);let a=!f(i.normals);r.unlit=a;let c=new dMe;if(c.attributes=DMe(t,i,n),c.primitiveType=Re.POINTS,c.material=r,f(i.batchIds)){let y=new mMe;y.propertyTableId=0,y.setIndex=0,y.positionalLabel="featureId_0",c.featureIds.push(y)}let l=new fMe;l.index=0,l.primitives=[c];let u=new uMe;u.nodes=[l],u.upAxis=vo.Z,u.forwardAxis=vo.X;let d=new lMe;d.scene=u,d.nodes=[l];let h=[];d.structuralMetadata=vMe(i,h),h.length>0&&IMe(t,c,h,n),f(i.rtcCenter)&&(d.transform=N.multiplyByTranslation(d.transform,i.rtcCenter,d.transform));let _=i.positions;f(_)&&_.isQuantized&&(d.transform=N.multiplyByTranslation(d.transform,_.quantizedVolumeOffset,d.transform)),t._components=d,t._parsedContent=void 0,t._arrayBuffer=void 0}function IMe(t,n,i,o){let r=n.attributes,s=i.length;for(let a=0;a<s;a++){let c=i[a],l=ut.createVertexBuffer({typedArray:c.typedArray,context:o,usage:Fe.STATIC_DRAW});l.vertexArrayDestroyable=!1,t._buffers.push(l),c.buffer=l,c.typedArray=void 0,r.push(c)}n.propertyAttributeIds=[0]}h_.prototype.unload=function(){let t=this._buffers;for(let n=0;n<t.length;n++)t[n].destroy();t.length=0,this._components=void 0,this._parsedContent=void 0,this._arrayBuffer=void 0};var oL=h_;function Ao(t){t=A(t,A.EMPTY_OBJECT),this._loader=t.loader,this._resource=t.resource,this.type=A(t.type,sr.GLTF),this.modelMatrix=N.clone(A(t.modelMatrix,N.IDENTITY)),this._modelMatrix=N.clone(this.modelMatrix),this._scale=A(t.scale,1),this._minimumPixelSize=A(t.minimumPixelSize,0),this._maximumScale=t.maximumScale,this._clampedScale=f(this._maximumScale)?Math.min(this._scale,this._maximumScale):this._scale,this._computedScale=this._clampedScale,this._updateModelMatrix=!1,this.referenceMatrix=void 0,this._iblReferenceFrameMatrix=$.clone($.IDENTITY),this._resourcesLoaded=!1,this._drawCommandsBuilt=!1,this._ready=!1,this._customShader=t.customShader,this._content=t.content,this._texturesLoaded=!1,this._defaultTexture=void 0,this._activeAnimations=new IR(this),this._clampAnimations=A(t.clampAnimations,!0),this._userAnimationDirty=!1,this._id=t.id,this._idDirty=!1,this._color=z.clone(t.color),this._colorBlendMode=A(t.colorBlendMode,oc.HIGHLIGHT),this._colorBlendAmount=A(t.colorBlendAmount,.5);let n=A(t.silhouetteColor,z.RED);this._silhouetteColor=z.clone(n),this._silhouetteSize=A(t.silhouetteSize,0),this._silhouetteDirty=!1,this._silhouetteId=void 0,this._cull=A(t.cull,!0),this._opaquePass=A(t.opaquePass,Te.OPAQUE),this._allowPicking=A(t.allowPicking,!0),this._show=A(t.show,!0),this._style=void 0,this._styleDirty=!1,this._styleCommandsNeeded=void 0;let i=A(t.featureIdLabel,"featureId_0");typeof i=="number"&&(i=`featureId_${i}`),this._featureIdLabel=i;let o=A(t.instanceFeatureIdLabel,"instanceFeatureId_0");typeof o=="number"&&(o=`instanceFeatureId_${o}`),this._instanceFeatureIdLabel=o,this._featureTables=[],this._featureTableId=void 0,this._featureTableIdDirty=!0,this._pipelineResources=[],this._modelResources=[],this._pickIds=[],this._boundingSphere=new ae,this._initialRadius=void 0,this._heightReference=A(t.heightReference,Ge.NONE),this._heightDirty=this._heightReference!==Ge.NONE,this._removeUpdateHeightCallback=void 0,this._clampedModelMatrix=void 0;let r=t.scene;f(r)&&f(r.terrainProviderChanged)&&(this._terrainProviderChangedCallback=r.terrainProviderChanged.addEventListener(function(){this._heightDirty=!0},this)),this._scene=r,this._distanceDisplayCondition=t.distanceDisplayCondition;let s=new xm(t.pointCloudShading);this._pointCloudShading=s,this._attenuation=s.attenuation,this._pointCloudBackFaceCulling=s.backFaceCulling;let a=t.clippingPlanes;f(a)&&a.owner===void 0?Qs.setOwner(a,this,"_clippingPlanes"):this._clippingPlanes=a,this._clippingPlanesState=0,this._clippingPlanesMatrix=N.clone(N.IDENTITY),this._lightColor=m.clone(t.lightColor),this._imageBasedLighting=f(t.imageBasedLighting)?t.imageBasedLighting:new zC,this._shouldDestroyImageBasedLighting=!f(t.imageBasedLighting),this._backFaceCulling=A(t.backFaceCulling,!0),this._backFaceCullingDirty=!1,this._shadows=A(t.shadows,gn.ENABLED),this._shadowsDirty=!1,this._debugShowBoundingVolumeDirty=!1,this._debugShowBoundingVolume=A(t.debugShowBoundingVolume,!1),this._enableDebugWireframe=A(t.enableDebugWireframe,!1),this._enableShowOutline=A(t.enableShowOutline,!0),this._debugWireframe=A(t.debugWireframe,!1),this._debugWireframe===!0&&this._enableDebugWireframe===!1&&this.type===sr.GLTF&&Bt("model-debug-wireframe-ignored","enableDebugWireframe must be set to true in Model.fromGltf, otherwise debugWireframe will be ignored.");let c=t.credit;typeof c=="string"&&(c=new Jt(c)),this._credit=c,this._resourceCredits=[],this._gltfCredits=[],this._showCreditsOnScreen=A(t.showCreditsOnScreen,!1),this._showCreditsOnScreenDirty=!0,this._splitDirection=A(t.splitDirection,Wc.NONE),this._enableShowOutline=A(t.enableShowOutline,!0),this.showOutline=A(t.showOutline,!0),this.outlineColor=A(t.outlineColor,z.BLACK),this._classificationType=t.classificationType,this._statistics=new nL,this._sceneMode=void 0,this._projectTo2D=A(t.projectTo2D,!1),this._skipLevelOfDetail=!1,this._ignoreCommands=A(t.ignoreCommands,!1),this._completeLoad=function(l,u){},this._texturesLoadedPromise=void 0,this._readyPromise=RMe(this),this._sceneGraph=void 0,this._nodesByName={},this.pickObject=t.pickObject}function BMe(t,n){let i=t._featureTables,o=n.propertyTables,r=o.length;for(let s=0;s<r;s++){let a=o[s],c=new OR({model:t,propertyTable:a});i.push(c)}return i}function OMe(t,n){let i=n._featureIdLabel,o=n._instanceFeatureIdLabel,r,s,a,c;for(r=0;r<t.nodes.length;r++)if(c=t.nodes[r],f(c.instances)&&(a=on.getFeatureIdsByLabel(c.instances.featureIds,o),f(a)&&f(a.propertyTableId)))return a.propertyTableId;for(r=0;r<t.nodes.length;r++)for(c=t.nodes[r],s=0;s<c.primitives.length;s++){let l=c.primitives[s],u=on.getFeatureIdsByLabel(l.featureIds,i);if(f(u))return u.propertyTableId}if(n._featureTables.length===1)return 0}function EG(t,n){if(!f(t)&&!f(n))return!1;if(f(t)!==f(n))return!0;let i=t.alpha,o=n.alpha;return Math.floor(i)!==Math.floor(o)||Math.ceil(i)!==Math.ceil(o)}function RMe(t){let n=t._loader,i=t._resource;n.load();let o=n.promise.then(function(a){if(!f(a))return;let c=a.components;if(!f(c)){if(a.isUnloaded())return;throw new he("Failed to load model.")}let l=c.structuralMetadata;f(l)&&l.propertyTableCount>0&&BMe(t,l);let u=new tL({model:t,modelComponents:c});t._sceneGraph=u,t._gltfCredits=u.components.asset.credits;let d=t._resource.credits;if(f(d)){let h=d.length;for(let _=0;_<h;_++)t._resourceCredits.push(d[_])}t._resourcesLoaded=!0}),r=A(n.texturesLoadedPromise,Promise.resolve());t._texturesLoadedPromise=r.then(function(){!f(t)||t.isDestroyed()||(t._texturesLoaded=!0,n._incrementallyLoadTextures&&t.resetDrawCommands())}).catch(on.getFailedLoadFunction(t,"model",i));let s=new Promise(function(a,c){t._completeLoad=function(l,u){u.afterRender.push(function(){return l._ready=!0,a(l),!0})}});return o.then(function(){return s}).catch(on.getFailedLoadFunction(t,"model",i))}Object.defineProperties(Ao.prototype,{ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise}},texturesLoadedPromise:{get:function(){return this._texturesLoadedPromise}},loader:{get:function(){return this._loader}},statistics:{get:function(){return this._statistics}},activeAnimations:{get:function(){return this._activeAnimations}},clampAnimations:{get:function(){return this._clampAnimations},set:function(t){this._clampAnimations=t}},cull:{get:function(){return this._cull}},opaquePass:{get:function(){return this._opaquePass}},pointCloudShading:{get:function(){return this._pointCloudShading},set:function(t){t!==this._pointCloudShading&&this.resetDrawCommands(),this._pointCloudShading=t}},customShader:{get:function(){return this._customShader},set:function(t){t!==this._customShader&&this.resetDrawCommands(),this._customShader=t}},sceneGraph:{get:function(){return this._sceneGraph}},content:{get:function(){return this._content}},heightReference:{get:function(){return this._heightReference},set:function(t){t!==this._heightReference&&(this._heightDirty=!0),this._heightReference=t}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(t){this._distanceDisplayCondition=wt.clone(t,this._distanceDisplayCondition)}},structuralMetadata:{get:function(){return this._sceneGraph.components.structuralMetadata}},featureTableId:{get:function(){return this._featureTableId},set:function(t){this._featureTableId=t}},featureTables:{get:function(){return this._featureTables},set:function(t){this._featureTables=t}},id:{get:function(){return this._id},set:function(t){t!==this._id&&(this._idDirty=!0),this._id=t}},allowPicking:{get:function(){return this._allowPicking}},style:{get:function(){return this._style},set:function(t){this._style=t,this._styleDirty=!0}},color:{get:function(){return this._color},set:function(t){EG(t,this._color)&&this.resetDrawCommands(),this._color=z.clone(t,this._color)}},colorBlendMode:{get:function(){return this._colorBlendMode},set:function(t){this._colorBlendMode=t}},colorBlendAmount:{get:function(){return this._colorBlendAmount},set:function(t){this._colorBlendAmount=t}},silhouetteColor:{get:function(){return this._silhouetteColor},set:function(t){if(!z.equals(t,this._silhouetteColor)){let n=EG(t,this._silhouetteColor);this._silhouetteDirty=this._silhouetteDirty||n}this._silhouetteColor=z.clone(t,this._silhouetteColor)}},silhouetteSize:{get:function(){return this._silhouetteSize},set:function(t){if(t!==this._silhouetteSize){let n=this._silhouetteSize,i=t>0&&n===0||t===0&&n>0;this._silhouetteDirty=this._silhouetteDirty||i,this._backFaceCullingDirty=this._backFaceCullingDirty||i}this._silhouetteSize=t}},boundingSphere:{get:function(){let t=f(this._clampedModelMatrix)?this._clampedModelMatrix:this.modelMatrix;return W$(this,t),this._boundingSphere}},debugShowBoundingVolume:{get:function(){return this._debugShowBoundingVolume},set:function(t){this._debugShowBoundingVolume!==t&&(this._debugShowBoundingVolumeDirty=!0),this._debugShowBoundingVolume=t}},debugWireframe:{get:function(){return this._debugWireframe},set:function(t){this._debugWireframe!==t&&this.resetDrawCommands(),this._debugWireframe=t,this._debugWireframe===!0&&this._enableDebugWireframe===!1&&this.type===sr.GLTF&&Bt("model-debug-wireframe-ignored","enableDebugWireframe must be set to true in Model.fromGltf, otherwise debugWireframe will be ignored.")}},show:{get:function(){return this._show},set:function(t){this._show=t}},featureIdLabel:{get:function(){return this._featureIdLabel},set:function(t){typeof t=="number"&&(t=`featureId_${t}`),t!==this._featureIdLabel&&(this._featureTableIdDirty=!0),this._featureIdLabel=t}},instanceFeatureIdLabel:{get:function(){return this._instanceFeatureIdLabel},set:function(t){typeof t=="number"&&(t=`instanceFeatureId_${t}`),t!==this._instanceFeatureIdLabel&&(this._featureTableIdDirty=!0),this._instanceFeatureIdLabel=t}},clippingPlanes:{get:function(){return this._clippingPlanes},set:function(t){t!==this._clippingPlanes&&(Qs.setOwner(t,this,"_clippingPlanes"),this.resetDrawCommands())}},lightColor:{get:function(){return this._lightColor},set:function(t){f(t)!==f(this._lightColor)&&this.resetDrawCommands(),this._lightColor=m.clone(t,this._lightColor)}},imageBasedLighting:{get:function(){return this._imageBasedLighting},set:function(t){t!==this._imageBasedLighting&&(this._shouldDestroyImageBasedLighting&&!this._imageBasedLighting.isDestroyed()&&this._imageBasedLighting.destroy(),this._imageBasedLighting=t,this._shouldDestroyImageBasedLighting=!1,this.resetDrawCommands())}},backFaceCulling:{get:function(){return this._backFaceCulling},set:function(t){t!==this._backFaceCulling&&(this._backFaceCullingDirty=!0),this._backFaceCulling=t}},scale:{get:function(){return this._scale},set:function(t){t!==this._scale&&(this._updateModelMatrix=!0),this._scale=t}},computedScale:{get:function(){return this._computedScale}},minimumPixelSize:{get:function(){return this._minimumPixelSize},set:function(t){t!==this._minimumPixelSize&&(this._updateModelMatrix=!0),this._minimumPixelSize=t}},maximumScale:{get:function(){return this._maximumScale},set:function(t){t!==this._maximumScale&&(this._updateModelMatrix=!0),this._maximumScale=t}},shadows:{get:function(){return this._shadows},set:function(t){t!==this._shadows&&(this._shadowsDirty=!0),this._shadows=t}},credit:{get:function(){return this._credit}},showCreditsOnScreen:{get:function(){return this._showCreditsOnScreen},set:function(t){this._showCreditsOnScreen!==t&&(this._showCreditsOnScreenDirty=!0),this._showCreditsOnScreen=t}},splitDirection:{get:function(){return this._splitDirection},set:function(t){this._splitDirection!==t&&this.resetDrawCommands(),this._splitDirection=t}},classificationType:{get:function(){return this._classificationType}},pickIds:{get:function(){return this._pickIds}},styleCommandsNeeded:{get:function(){return this._styleCommandsNeeded}}});Ao.prototype.getNode=function(t){return this._nodesByName[t]};Ao.prototype.setArticulationStage=function(t,n){this._sceneGraph.setArticulationStage(t,n)};Ao.prototype.applyArticulations=function(){this._sceneGraph.applyArticulations()};Ao.prototype.makeStyleDirty=function(){this._styleDirty=!0};Ao.prototype.resetDrawCommands=function(){this._drawCommandsBuilt=!1};var MMe=new N,LMe=new $,FMe=new N;Ao.prototype.update=function(t){if(NMe(this,t),VMe(this,t),kMe(this,t),!this._resourcesLoaded||t.mode===ne.MORPHING)return;UMe(this),zMe(this),HMe(this,t),GMe(this),WMe(this,t),jMe(this,t),qMe(this,t),YMe(this,t),this._defaultTexture=t.context.defaultTexture,XMe(this,t),KMe(this,t),JMe(this),ZMe(this,t),eLe(this,t);let n=this;if(!n._ready){n._completeLoad(n,t);return}$Me(this),tLe(this,t),nLe(this),iLe(this,t)};function NMe(t,n){(!t._resourcesLoaded||!t._texturesLoaded)&&t._loader.process(n)}function VMe(t,n){f(t._customShader)&&t._customShader.update(n)}function kMe(t,n){t._imageBasedLighting.update(n),t._imageBasedLighting.shouldRegenerateShaders&&t.resetDrawCommands()}function UMe(t){if(!t._featureTableIdDirty)return;t._featureTableIdDirty=!1;let n=t._sceneGraph.components,i=n.structuralMetadata;f(i)&&i.propertyTableCount>0&&(t.featureTableId=OMe(n,t),t._styleDirty=!0,t.resetDrawCommands())}function zMe(t){t._styleDirty&&(t.applyStyle(t._style),t._styleDirty=!1)}function HMe(t,n){let i=t._featureTables,o=i.length,r=!1;for(let s=0;s<o;s++)i[s].update(n),i[s].styleCommandsNeededDirty&&(r=!0);r&&G$(t)}function G$(t){let n=t.featureTables[t.featureTableId];t._styleCommandsNeeded=$d.getStyleCommandsNeeded(n.featuresLength,n.batchTexture.translucentFeaturesLength)}function GMe(t){let n=t.pointCloudShading;n.attenuation!==t._attenuation&&(t.resetDrawCommands(),t._attenuation=n.attenuation),n.backFaceCulling!==t._pointCloudBackFaceCulling&&(t.resetDrawCommands(),t._pointCloudBackFaceCulling=n.backFaceCulling)}function WMe(t,n){t._silhouetteDirty&&(j$(n)&&t.resetDrawCommands(),t._silhouetteDirty=!1)}function jMe(t,n){let i=t.hasSkipLevelOfDetail(n);i!==t._skipLevelOfDetail&&(t.resetDrawCommands(),t._skipLevelOfDetail=i)}function qMe(t,n){let i=0;t.isClippingEnabled()&&(t._clippingPlanes.owner===t&&t._clippingPlanes.update(n),i=t._clippingPlanes.clippingPlanesState),i!==t._clippingPlanesState&&(t.resetDrawCommands(),t._clippingPlanesState=i)}function YMe(t,n){n.mode!==t._sceneMode&&(t._projectTo2D?t.resetDrawCommands():t._updateModelMatrix=!0,t._sceneMode=n.mode)}function XMe(t,n){t._drawCommandsBuilt||(t.destroyPipelineResources(),t._sceneGraph.buildDrawCommands(n),t._drawCommandsBuilt=!0)}function KMe(t,n){N.equals(t.modelMatrix,t._modelMatrix)||(t._updateModelMatrix=!0,t._modelMatrix=N.clone(t.modelMatrix,t._modelMatrix))}var yu=new m,rL=new de;function JMe(t){if(!t._updateModelMatrix&&!t._heightDirty&&t._minimumPixelSize===0)return;f(t._removeUpdateHeightCallback)&&(t._removeUpdateHeightCallback(),t._removeUpdateHeightCallback=void 0);let n=t._scene;if(!f(n)||!f(n.globe)||t.heightReference===Ge.NONE){t._clampedModelMatrix=void 0;return}let i=n.globe,o=i.ellipsoid,r=t.modelMatrix;yu.x=r[12],yu.y=r[13],yu.z=r[14];let s=o.cartesianToCartographic(yu);f(t._clampedModelMatrix)||(t._clampedModelMatrix=N.clone(r,new N));let a=i._surface;t._removeUpdateHeightCallback=a.updateHeight(s,H$(t,o,s));let c=i.getHeight(s);if(f(c)){let l=H$(t,o,s);de.clone(s,rL),rL.height=c,o.cartographicToCartesian(rL,yu),l(yu)}t._heightDirty=!1,t._updateModelMatrix=!0}function ZMe(t,n){if(!t._updateModelMatrix&&t._minimumPixelSize===0)return;let i=f(t._clampedModelMatrix)?t._clampedModelMatrix:t.modelMatrix;W$(t,i),QMe(t,i,n)}function W$(t,n){t._clampedScale=f(t._maximumScale)?Math.min(t._scale,t._maximumScale):t._scale,t._boundingSphere.center=m.multiplyByScalar(t._sceneGraph.boundingSphere.center,t._clampedScale,t._boundingSphere.center),t._boundingSphere.radius=t._initialRadius*t._clampedScale,t._boundingSphere=ae.transform(t._boundingSphere,n,t._boundingSphere)}function QMe(t,n,i){let o=t.scale;if(t.minimumPixelSize!==0&&!t._projectTo2D){let r=i.context,s=Math.max(r.drawingBufferWidth,r.drawingBufferHeight);yu.x=n[12],yu.y=n[13],yu.z=n[14],t._sceneMode!==ne.SCENE3D&&Yi.computeActualWgs84Position(i,yu,yu);let a=t._boundingSphere.radius,c=oLe(yu,a,i),l=1/c;Math.min(l*(2*a),s)<t.minimumPixelSize&&(o=t.minimumPixelSize*c/(2*t._initialRadius))}t._computedScale=f(t.maximumScale)?Math.min(t.maximumScale,o):o}function $Me(t){if(!t._idDirty)return;t._idDirty=!1;let n=t._id,i=t._pickIds,o=i.length;for(let r=0;r<o;++r)i[r].object.id=n}function eLe(t,n){let i=f(t._clampedModelMatrix)?t._clampedModelMatrix:t.modelMatrix,o=A(t.referenceMatrix,i),r=n.context,s=t._imageBasedLighting;if(s.useSphericalHarmonicCoefficients||s.useSpecularEnvironmentMaps){let a=LMe,c=MMe;c=N.multiply(r.uniformState.view3D,o,c),a=N.getMatrix3(c,a),a=$.getRotation(a,a),t._iblReferenceFrameMatrix=$.transpose(a,t._iblReferenceFrameMatrix)}if(t.isClippingEnabled()){let a=FMe;a=N.multiply(r.uniformState.view3D,o,a),a=N.multiply(a,t._clippingPlanes.modelMatrix,a),t._clippingPlanesMatrix=N.inverseTranspose(a,t._clippingPlanesMatrix)}}function tLe(t,n){let i=t._sceneGraph;if(t._updateModelMatrix||t._minimumPixelSize!==0){let r=f(t._clampedModelMatrix)?t._clampedModelMatrix:t.modelMatrix;i.updateModelMatrix(r,n),t._updateModelMatrix=!1}t._backFaceCullingDirty&&(i.updateBackFaceCulling(t._backFaceCulling),t._backFaceCullingDirty=!1),t._shadowsDirty&&(i.updateShadows(t._shadows),t._shadowsDirty=!1),t._debugShowBoundingVolumeDirty&&(i.updateShowBoundingVolume(t._debugShowBoundingVolume),t._debugShowBoundingVolumeDirty=!1);let o=!1;f(t.classificationType)||(o=t._userAnimationDirty||t._activeAnimations.update(n)),i.update(n,o),t._userAnimationDirty=!1}function nLe(t){if(!t._showCreditsOnScreenDirty)return;t._showCreditsOnScreenDirty=!1;let n=t._showCreditsOnScreen;f(t._credit)&&(t._credit.showOnScreen=n);let i=t._resourceCredits,o=i.length;for(let a=0;a<o;a++)i[a].showOnScreen=n;let r=t._gltfCredits,s=r.length;for(let a=0;a<s;a++)r[a].showOnScreen=n}function iLe(t,n){let i=sLe(t,n),o=t.isInvisible(),r=t.hasSilhouette(n),s=t._show&&t._computedScale!==0&&i&&(!o||r),a=n.passes,c=a.render||a.pick&&t.allowPicking;s&&!t._ignoreCommands&&c&&(aLe(t,n),t._sceneGraph.pushDrawCommands(n))}var TG=new ae;function oLe(t,n,i){return TG.center=t,TG.radius=n,i.camera.getPixelSize(TG,i.context.drawingBufferWidth,i.context.drawingBufferHeight)}function H$(t,n,i){return function(o){if(t.heightReference===Ge.RELATIVE_TO_GROUND){let s=n.cartesianToCartographic(o,rL);s.height+=i.height,n.cartographicToCartesian(s,o)}let r=t._clampedModelMatrix;N.clone(t.modelMatrix,r),r[12]=o.x,r[13]=o.y,r[14]=o.z,t._heightDirty=!0}}var rLe=new m;function sLe(t,n){let i=t.distanceDisplayCondition;if(!f(i))return!0;let o=i.near*i.near,r=i.far*i.far,s;if(n.mode===ne.SCENE2D){let c=(n.camera.frustum.right-n.camera.frustum.left)*.5;s=c*c}else{let a=N.getTranslation(t.modelMatrix,rLe);Yi.computeActualWgs84Position(n,a,a),s=m.distanceSquared(a,n.camera.positionWC)}return s>=o&&s<=r}function aLe(t,n){let i=n.creditDisplay,o=t._credit;f(o)&&i.addCredit(o);let r=t._resourceCredits,s=r.length;for(let l=0;l<s;l++)i.addCredit(r[l]);let a=t._gltfCredits,c=a.length;for(let l=0;l<c;l++)i.addCredit(a[l])}Ao.prototype.isTranslucent=function(){let t=this.color;return f(t)&&t.alpha>0&&t.alpha<1};Ao.prototype.isInvisible=function(){let t=this.color;return f(t)&&t.alpha===0};function j$(t){return t.context.stencilBuffer}Ao.prototype.hasSilhouette=function(t){return j$(t)&&this._silhouetteSize>0&&this._silhouetteColor.alpha>0&&!f(this._classificationType)};function cLe(t){return t.context.stencilBuffer}Ao.prototype.hasSkipLevelOfDetail=function(t){if(!sr.is3DTiles(this.type))return!1;let i=this._content.tileset;return cLe(t)&&i.skipLevelOfDetail};Ao.prototype.isClippingEnabled=function(){let t=this._clippingPlanes;return f(t)&&t.enabled&&t.length!==0};Ao.prototype.isDestroyed=function(){return!1};Ao.prototype.destroy=function(){let t=this._loader;f(t)&&t.destroy();let n=this._featureTables;if(f(n)){let o=n.length;for(let r=0;r<o;r++)n[r].destroy()}this.destroyPipelineResources(),this.destroyModelResources(),f(this._removeUpdateHeightCallback)&&(this._removeUpdateHeightCallback(),this._removeUpdateHeightCallback=void 0),f(this._terrainProviderChangedCallback)&&(this._terrainProviderChangedCallback(),this._terrainProviderChangedCallback=void 0);let i=this._clippingPlanes;f(i)&&!i.isDestroyed()&&i.owner===this&&i.destroy(),this._clippingPlanes=void 0,this._shouldDestroyImageBasedLighting&&!this._imageBasedLighting.isDestroyed()&&this._imageBasedLighting.destroy(),this._imageBasedLighting=void 0,ue(this)};Ao.prototype.destroyPipelineResources=function(){let t=this._pipelineResources;for(let n=0;n<t.length;n++)t[n].destroy();this._pipelineResources.length=0,this._pickIds.length=0};Ao.prototype.destroyModelResources=function(){let t=this._modelResources;for(let n=0;n<t.length;n++)t[n].destroy();this._modelResources.length=0};Ao.fromGltf=function(t){t=A(t,A.EMPTY_OBJECT);let n=A(t.url,t.gltf),i={releaseGltfJson:t.releaseGltfJson,asynchronous:t.asynchronous,incrementallyLoadTextures:t.incrementallyLoadTextures,upAxis:t.upAxis,forwardAxis:t.forwardAxis,loadAttributesFor2D:t.projectTo2D,loadIndicesForWireframe:t.enableDebugWireframe,loadPrimitiveOutline:t.enableShowOutline,loadForClassification:f(t.classificationType)},o=A(t.basePath,""),r=Ie.createIfNeeded(o);f(n.asset)?(i.gltfJson=n,i.baseResource=r,i.gltfResource=r):n instanceof Uint8Array?(i.typedArray=n,i.baseResource=r,i.gltfResource=r):i.gltfResource=Ie.createIfNeeded(n);let s=new i_(i),c=f(t.content)?sr.TILE_GLTF:sr.GLTF,l=CS(s,c,t);return l.resource=i.gltfResource,new Ao(l)};Ao.fromB3dm=function(t){let n={b3dmResource:t.resource,arrayBuffer:t.arrayBuffer,byteOffset:t.byteOffset,releaseGltfJson:t.releaseGltfJson,asynchronous:t.asynchronous,incrementallyLoadTextures:t.incrementallyLoadTextures,upAxis:t.upAxis,forwardAxis:t.forwardAxis,loadAttributesFor2D:t.projectTo2D,loadIndicesForWireframe:t.enableDebugWireframe,loadPrimitiveOutline:t.enableShowOutline,loadForClassification:f(t.classificationType)},i=new _R(n),o=CS(i,sr.TILE_B3DM,t);return new Ao(o)};Ao.fromPnts=function(t){let n={arrayBuffer:t.arrayBuffer,byteOffset:t.byteOffset,loadAttributesFor2D:t.projectTo2D},i=new oL(n),o=CS(i,sr.TILE_PNTS,t);return new Ao(o)};Ao.fromI3dm=function(t){let n={i3dmResource:t.resource,arrayBuffer:t.arrayBuffer,byteOffset:t.byteOffset,releaseGltfJson:t.releaseGltfJson,asynchronous:t.asynchronous,incrementallyLoadTextures:t.incrementallyLoadTextures,upAxis:t.upAxis,forwardAxis:t.forwardAxis,loadAttributesFor2D:t.projectTo2D,loadIndicesForWireframe:t.enableDebugWireframe,loadPrimitiveOutline:t.enableShowOutline},i=new ER(n),o=CS(i,sr.TILE_I3DM,t);return new Ao(o)};Ao.fromGeoJson=function(t){let n={geoJson:t.geoJson},i=new yR(n),o=CS(i,sr.TILE_GEOJSON,t);return new Ao(o)};Ao.prototype.applyColorAndShow=function(t){let n=this._color,i=f(t)&&f(t.color),o=f(t)&&f(t.show);this._color=i?t.color.evaluateColor(void 0,this._color):z.clone(z.WHITE,this._color),this._show=o?t.show.evaluate(void 0):!0,EG(n,this._color)&&this.resetDrawCommands()};Ao.prototype.applyStyle=function(t){let n=this.type===sr.TILE_PNTS,i=f(this.featureTableId)&&this.featureTables[this.featureTableId].featuresLength>0,o=f(this.structuralMetadata)?this.structuralMetadata.propertyAttributes:void 0,r=f(o)&&f(o[0]);if(n&&(!i||r)){this.resetDrawCommands();return}i?(this.featureTables[this.featureTableId].applyStyle(t),G$(this,t)):(this.applyColorAndShow(t),this._styleCommandsNeeded=void 0)};function CS(t,n,i){return{loader:t,type:n,resource:i.resource,show:i.show,modelMatrix:i.modelMatrix,scale:i.scale,minimumPixelSize:i.minimumPixelSize,maximumScale:i.maximumScale,id:i.id,allowPicking:i.allowPicking,clampAnimations:i.clampAnimations,shadows:i.shadows,debugShowBoundingVolume:i.debugShowBoundingVolume,enableDebugWireframe:i.enableDebugWireframe,debugWireframe:i.debugWireframe,cull:i.cull,opaquePass:i.opaquePass,customShader:i.customShader,content:i.content,heightReference:i.heightReference,scene:i.scene,distanceDisplayCondition:i.distanceDisplayCondition,color:i.color,colorBlendAmount:i.colorBlendAmount,colorBlendMode:i.colorBlendMode,silhouetteColor:i.silhouetteColor,silhouetteSize:i.silhouetteSize,enableShowOutline:i.enableShowOutline,showOutline:i.showOutline,outlineColor:i.outlineColor,clippingPlanes:i.clippingPlanes,lightColor:i.lightColor,imageBasedLighting:i.imageBasedLighting,backFaceCulling:i.backFaceCulling,credit:i.credit,showCreditsOnScreen:i.showCreditsOnScreen,splitDirection:i.splitDirection,projectTo2D:i.projectTo2D,featureIdLabel:i.featureIdLabel,instanceFeatureIdLabel:i.instanceFeatureIdLabel,pointCloudShading:i.pointCloudShading,classificationType:i.classificationType,pickObject:i.pickObject}}var Au=Ao;var ar={CULL:1,OCCLUDE:2,EXECUTE_IN_CLOSEST_FRUSTUM:4,DEBUG_SHOW_BOUNDING_VOLUME:8,CAST_SHADOWS:16,RECEIVE_SHADOWS:32,PICK_ONLY:64,DEPTH_FOR_TRANSLUCENT_CLASSIFICATION:128};function xS(t){t=A(t,A.EMPTY_OBJECT),this._boundingVolume=t.boundingVolume,this._orientedBoundingBox=t.orientedBoundingBox,this._modelMatrix=t.modelMatrix,this._primitiveType=A(t.primitiveType,Re.TRIANGLES),this._vertexArray=t.vertexArray,this._count=t.count,this._offset=A(t.offset,0),this._instanceCount=A(t.instanceCount,0),this._shaderProgram=t.shaderProgram,this._uniformMap=t.uniformMap,this._renderState=t.renderState,this._framebuffer=t.framebuffer,this._pass=t.pass,this._owner=t.owner,this._debugOverlappingFrustums=0,this._pickId=t.pickId,this._flags=0,this.cull=A(t.cull,!0),this.occlude=A(t.occlude,!0),this.executeInClosestFrustum=A(t.executeInClosestFrustum,!1),this.debugShowBoundingVolume=A(t.debugShowBoundingVolume,!1),this.castShadows=A(t.castShadows,!1),this.receiveShadows=A(t.receiveShadows,!1),this.pickOnly=A(t.pickOnly,!1),this.depthForTranslucentClassification=A(t.depthForTranslucentClassification,!1),this.dirty=!0,this.lastDirtyTime=0,this.derivedCommands={}}function Pa(t,n){return(t._flags&n)===n}function m_(t,n,i){i?t._flags|=n:t._flags&=~n}Object.defineProperties(xS.prototype,{boundingVolume:{get:function(){return this._boundingVolume},set:function(t){this._boundingVolume!==t&&(this._boundingVolume=t,this.dirty=!0)}},orientedBoundingBox:{get:function(){return this._orientedBoundingBox},set:function(t){this._orientedBoundingBox!==t&&(this._orientedBoundingBox=t,this.dirty=!0)}},cull:{get:function(){return Pa(this,ar.CULL)},set:function(t){Pa(this,ar.CULL)!==t&&(m_(this,ar.CULL,t),this.dirty=!0)}},occlude:{get:function(){return Pa(this,ar.OCCLUDE)},set:function(t){Pa(this,ar.OCCLUDE)!==t&&(m_(this,ar.OCCLUDE,t),this.dirty=!0)}},modelMatrix:{get:function(){return this._modelMatrix},set:function(t){this._modelMatrix!==t&&(this._modelMatrix=t,this.dirty=!0)}},primitiveType:{get:function(){return this._primitiveType},set:function(t){this._primitiveType!==t&&(this._primitiveType=t,this.dirty=!0)}},vertexArray:{get:function(){return this._vertexArray},set:function(t){this._vertexArray!==t&&(this._vertexArray=t,this.dirty=!0)}},count:{get:function(){return this._count},set:function(t){this._count!==t&&(this._count=t,this.dirty=!0)}},offset:{get:function(){return this._offset},set:function(t){this._offset!==t&&(this._offset=t,this.dirty=!0)}},instanceCount:{get:function(){return this._instanceCount},set:function(t){this._instanceCount!==t&&(this._instanceCount=t,this.dirty=!0)}},shaderProgram:{get:function(){return this._shaderProgram},set:function(t){this._shaderProgram!==t&&(this._shaderProgram=t,this.dirty=!0)}},castShadows:{get:function(){return Pa(this,ar.CAST_SHADOWS)},set:function(t){Pa(this,ar.CAST_SHADOWS)!==t&&(m_(this,ar.CAST_SHADOWS,t),this.dirty=!0)}},receiveShadows:{get:function(){return Pa(this,ar.RECEIVE_SHADOWS)},set:function(t){Pa(this,ar.RECEIVE_SHADOWS)!==t&&(m_(this,ar.RECEIVE_SHADOWS,t),this.dirty=!0)}},uniformMap:{get:function(){return this._uniformMap},set:function(t){this._uniformMap!==t&&(this._uniformMap=t,this.dirty=!0)}},renderState:{get:function(){return this._renderState},set:function(t){this._renderState!==t&&(this._renderState=t,this.dirty=!0)}},framebuffer:{get:function(){return this._framebuffer},set:function(t){this._framebuffer!==t&&(this._framebuffer=t,this.dirty=!0)}},pass:{get:function(){return this._pass},set:function(t){this._pass!==t&&(this._pass=t,this.dirty=!0)}},executeInClosestFrustum:{get:function(){return Pa(this,ar.EXECUTE_IN_CLOSEST_FRUSTUM)},set:function(t){Pa(this,ar.EXECUTE_IN_CLOSEST_FRUSTUM)!==t&&(m_(this,ar.EXECUTE_IN_CLOSEST_FRUSTUM,t),this.dirty=!0)}},owner:{get:function(){return this._owner},set:function(t){this._owner!==t&&(this._owner=t,this.dirty=!0)}},debugShowBoundingVolume:{get:function(){return Pa(this,ar.DEBUG_SHOW_BOUNDING_VOLUME)},set:function(t){Pa(this,ar.DEBUG_SHOW_BOUNDING_VOLUME)!==t&&(m_(this,ar.DEBUG_SHOW_BOUNDING_VOLUME,t),this.dirty=!0)}},debugOverlappingFrustums:{get:function(){return this._debugOverlappingFrustums},set:function(t){this._debugOverlappingFrustums!==t&&(this._debugOverlappingFrustums=t,this.dirty=!0)}},pickId:{get:function(){return this._pickId},set:function(t){this._pickId!==t&&(this._pickId=t,this.dirty=!0)}},pickOnly:{get:function(){return Pa(this,ar.PICK_ONLY)},set:function(t){Pa(this,ar.PICK_ONLY)!==t&&(m_(this,ar.PICK_ONLY,t),this.dirty=!0)}},depthForTranslucentClassification:{get:function(){return Pa(this,ar.DEPTH_FOR_TRANSLUCENT_CLASSIFICATION)},set:function(t){Pa(this,ar.DEPTH_FOR_TRANSLUCENT_CLASSIFICATION)!==t&&(m_(this,ar.DEPTH_FOR_TRANSLUCENT_CLASSIFICATION,t),this.dirty=!0)}}});xS.shallowClone=function(t,n){if(!!f(t))return f(n)||(n=new xS),n._boundingVolume=t._boundingVolume,n._orientedBoundingBox=t._orientedBoundingBox,n._modelMatrix=t._modelMatrix,n._primitiveType=t._primitiveType,n._vertexArray=t._vertexArray,n._count=t._count,n._offset=t._offset,n._instanceCount=t._instanceCount,n._shaderProgram=t._shaderProgram,n._uniformMap=t._uniformMap,n._renderState=t._renderState,n._framebuffer=t._framebuffer,n._pass=t._pass,n._owner=t._owner,n._debugOverlappingFrustums=t._debugOverlappingFrustums,n._pickId=t._pickId,n._flags=t._flags,n.dirty=!0,n.lastDirtyTime=0,n};xS.prototype.execute=function(t,n){if(n&&n.MirrorEnable){let o=!1;if(this.owner&&this.owner instanceof vC&&this.owner.mirrorEnable&&(o=!0),this.pass&&this.pass==4&&(o=!0),this.owner&&this.owner.primitive&&this.owner.primitive instanceof Au&&(o=!0),!o)return}let i=!1;if(t&&t.uniformState&&t.uniformState.frameState&&t.uniformState.frameState.passes&&(i=t.uniformState.frameState.passes.pick),(this.bloomInside||this._owner&&this._owner.bloomInside)&&!i&&!n.MirrorEnable){if(xt.resetBloomSize&&(xt.bloomInside.primitiveBloomFBO&&xt.bloomInside.primitiveBloomFBO.destroy(),xt.bloomInside.primitiveBloomFBO=void 0,xt.oldWidth=t.drawingBufferWidth,xt.oldHeight=t.drawingBufferHeight),!xt.bloomInside.primitiveBloomFBO){let o=new St({context:t,width:t.drawingBufferWidth,height:t.drawingBufferHeight,pixelFormat:st.RGBA,pixelDatatype:je.FLOAT,flipY:!1});xt.bloomInside.primitiveBloomFBO=new Xo({context:t,colorTextures:[o],depthStencilTexture:n.framebuffer.depthStencilTexture,destroyAttachments:!1})}this.framebuffer=xt.bloomInside.primitiveBloomFBO}if((this.bloomInside||this._owner&&this._owner.insideArea)&&!i&&!n.MirrorEnable){if(!xt.bloomInside.primitiveBloomFBOInside){let o=new St({context:t,width:t.drawingBufferWidth,height:t.drawingBufferHeight,pixelFormat:st.RGBA,pixelDatatype:je.FLOAT,flipY:!1});xt.bloomInside.primitiveBloomFBOInside=new Xo({context:t,colorTextures:[o],depthStencilTexture:n.framebuffer.depthStencilTexture,destroyAttachments:!1})}this.framebuffer=xt.bloomInside.primitiveBloomFBOInside}t.draw(this,n),this.framebuffer=void 0};var et=xS;var sL=`attribute vec3 position3DHigh;
attribute vec3 position3DLow;
attribute float batchId;
#ifdef EXTRUDED_GEOMETRY
attribute vec3 extrudeDirection;
uniform float u_globeMinimumAltitude;
#endif // EXTRUDED_GEOMETRY
#ifdef PER_INSTANCE_COLOR
varying vec4 v_color;
#endif // PER_INSTANCE_COLOR
#ifdef TEXTURE_COORDINATES
#ifdef SPHERICAL
varying vec4 v_sphericalExtents;
#else // SPHERICAL
varying vec2 v_inversePlaneExtents;
varying vec4 v_westPlane;
varying vec4 v_southPlane;
#endif // SPHERICAL
varying vec3 v_uvMinAndSphericalLongitudeRotation;
varying vec3 v_uMaxAndInverseDistance;
varying vec3 v_vMaxAndInverseDistance;
#endif // TEXTURE_COORDINATES
void main()
{
vec4 position = czm_computePosition();
#ifdef EXTRUDED_GEOMETRY
float delta = min(u_globeMinimumAltitude, czm_geometricToleranceOverMeter * length(position.xyz));
delta *= czm_sceneMode == czm_sceneMode3D ? 1.0 : 0.0;
position = position + vec4(extrudeDirection * delta, 0.0);
#endif
#ifdef TEXTURE_COORDINATES
#ifdef SPHERICAL
v_sphericalExtents = czm_batchTable_sphericalExtents(batchId);
v_uvMinAndSphericalLongitudeRotation.z = czm_batchTable_longitudeRotation(batchId);
#else // SPHERICAL
#ifdef COLUMBUS_VIEW_2D
vec4 planes2D_high = czm_batchTable_planes2D_HIGH(batchId);
vec4 planes2D_low = czm_batchTable_planes2D_LOW(batchId);
vec2 idlSplitNewPlaneHiLow = vec2(EAST_MOST_X_HIGH - (WEST_MOST_X_HIGH - planes2D_high.w), EAST_MOST_X_LOW - (WEST_MOST_X_LOW - planes2D_low.w));
bool idlSplit = planes2D_high.x > planes2D_high.w && position3DLow.y > 0.0;
planes2D_high.w = czm_branchFreeTernary(idlSplit, idlSplitNewPlaneHiLow.x, planes2D_high.w);
planes2D_low.w = czm_branchFreeTernary(idlSplit, idlSplitNewPlaneHiLow.y, planes2D_low.w);
idlSplit = planes2D_high.x > planes2D_high.w && position3DLow.y < 0.0;
idlSplitNewPlaneHiLow = vec2(WEST_MOST_X_HIGH - (EAST_MOST_X_HIGH - planes2D_high.x), WEST_MOST_X_LOW - (EAST_MOST_X_LOW - planes2D_low.x));
planes2D_high.x = czm_branchFreeTernary(idlSplit, idlSplitNewPlaneHiLow.x, planes2D_high.x);
planes2D_low.x = czm_branchFreeTernary(idlSplit, idlSplitNewPlaneHiLow.y, planes2D_low.x);
vec3 southWestCorner = (czm_modelViewRelativeToEye * czm_translateRelativeToEye(vec3(0.0, planes2D_high.xy), vec3(0.0, planes2D_low.xy))).xyz;
vec3 northWestCorner = (czm_modelViewRelativeToEye * czm_translateRelativeToEye(vec3(0.0, planes2D_high.x, planes2D_high.z), vec3(0.0, planes2D_low.x, planes2D_low.z))).xyz;
vec3 southEastCorner = (czm_modelViewRelativeToEye * czm_translateRelativeToEye(vec3(0.0, planes2D_high.w, planes2D_high.y), vec3(0.0, planes2D_low.w, planes2D_low.y))).xyz;
#else // COLUMBUS_VIEW_2D
vec3 southWestCorner = (czm_modelViewRelativeToEye * czm_translateRelativeToEye(czm_batchTable_southWest_HIGH(batchId), czm_batchTable_southWest_LOW(batchId))).xyz;
vec3 northWestCorner = czm_normal * czm_batchTable_northward(batchId) + southWestCorner;
vec3 southEastCorner = czm_normal * czm_batchTable_eastward(batchId) + southWestCorner;
#endif // COLUMBUS_VIEW_2D
vec3 eastWard = southEastCorner - southWestCorner;
float eastExtent = length(eastWard);
eastWard /= eastExtent;
vec3 northWard = northWestCorner - southWestCorner;
float northExtent = length(northWard);
northWard /= northExtent;
v_westPlane = vec4(eastWard, -dot(eastWard, southWestCorner));
v_southPlane = vec4(northWard, -dot(northWard, southWestCorner));
v_inversePlaneExtents = vec2(1.0 / eastExtent, 1.0 / northExtent);
#endif // SPHERICAL
vec4 uvMinAndExtents = czm_batchTable_uvMinAndExtents(batchId);
vec4 uMaxVmax = czm_batchTable_uMaxVmax(batchId);
v_uMaxAndInverseDistance = vec3(uMaxVmax.xy, uvMinAndExtents.z);
v_vMaxAndInverseDistance = vec3(uMaxVmax.zw, uvMinAndExtents.w);
v_uvMinAndSphericalLongitudeRotation.xy = uvMinAndExtents.xy;
#endif // TEXTURE_COORDINATES
#ifdef PER_INSTANCE_COLOR
v_color = czm_batchTable_color(batchId);
#endif
gl_Position = czm_depthClamp(czm_modelViewProjectionRelativeToEye * position);
}
`;var X0=`#ifdef GL_EXT_frag_depth
#extension GL_EXT_frag_depth : enable
#endif
#ifdef VECTOR_TILE
uniform vec4 u_highlightColor;
#endif
void main(void)
{
#ifdef VECTOR_TILE
gl_FragColor = czm_gammaCorrect(u_highlightColor);
#else
gl_FragColor = vec4(1.0);
#endif
czm_writeDepthClamp();
}
`;function lLe(t,n){let i=[],o=t.length,r=0;for(;r<o;){let s=Math.ceil((o-r)/n--);i.push(t.slice(r,r+s)),r+=s}return i}var aL=lLe;function Pm(t,n,i){if(this._attributes=n,this._numberOfInstances=i,n.length===0)return;let o=uLe(n),r=t.floatingPointTexture,s=o===je.FLOAT&&!r,a=fLe(n,s),c=dLe(a,n,s),l=Math.floor(Ut.maximumTextureSize/c),u=Math.min(i,l),d=c*u,h=Math.ceil(i/u),_=1/d,y=_*.5,p=1/h,C=p*.5;this._textureDimensions=new W(d,h),this._textureStep=new se(_,y,p,C),this._pixelDatatype=s?je.UNSIGNED_BYTE:o,this._packFloats=s,this._offsets=a,this._stride=c,this._texture=void 0;let x=4*d*h;this._batchValues=o===je.FLOAT&&!s?new Float32Array(x):new Uint8Array(x),this._batchValuesDirty=!1}Object.defineProperties(Pm.prototype,{attributes:{get:function(){return this._attributes}},numberOfInstances:{get:function(){return this._numberOfInstances}}});function uLe(t){let n=!1,i=t.length;for(let o=0;o<i;++o)if(t[o].componentDatatype!==J.UNSIGNED_BYTE){n=!0;break}return n?je.FLOAT:je.UNSIGNED_BYTE}function Y$(t,n){let i=t[n].componentsPerAttribute;return i===2?W:i===3?m:i===4?se:Number}function fLe(t,n){let i=new Array(t.length),o=0,r=t.length;for(let s=0;s<r;++s){let c=t[s].componentDatatype;i[s]=o,c!==J.UNSIGNED_BYTE&&n?o+=4:++o}return i}function dLe(t,n,i){let o=t.length,r=t[o-1];return n[o-1].componentDatatype!==J.UNSIGNED_BYTE&&i?r+4:r+1}var TS=new se;function hLe(t,n,i){let o=se.unpack(t,n,TS),r=se.unpackFloat(o);o=se.unpack(t,n+4,TS);let s=se.unpackFloat(o);o=se.unpack(t,n+8,TS);let a=se.unpackFloat(o);o=se.unpack(t,n+12,TS);let c=se.unpackFloat(o);return se.fromElements(r,s,a,c,i)}function mLe(t,n,i){let o=se.packFloat(t.x,TS);se.pack(o,n,i),o=se.packFloat(t.y,o),se.pack(o,n,i+4),o=se.packFloat(t.z,o),se.pack(o,n,i+8),o=se.packFloat(t.w,o),se.pack(o,n,i+12)}var q$=new se;Pm.prototype.getBatchedAttribute=function(t,n,i){let o=this._attributes,r=this._offsets[n],a=4*this._stride*t+4*r,c;this._packFloats&&o[n].componentDatatype!==je.UNSIGNED_BYTE?c=hLe(this._batchValues,a,q$):c=se.unpack(this._batchValues,a,q$);let l=Y$(o,n);return f(l.fromCartesian4)?l.fromCartesian4(c,i):f(l.clone)?l.clone(c,i):c.x};var pLe=[void 0,void 0,new W,new m,new se],_Le=new se;Pm.prototype.setBatchedAttribute=function(t,n,i){let o=this._attributes,r=pLe[o[n].componentsPerAttribute],s=this.getBatchedAttribute(t,n,r),a=Y$(this._attributes,n);if(f(a.equals)?a.equals(s,i):s===i)return;let l=_Le;l.x=f(i.x)?i.x:i,l.y=f(i.y)?i.y:0,l.z=f(i.z)?i.z:0,l.w=f(i.w)?i.w:0;let u=this._offsets[n],h=4*this._stride*t+4*u;this._packFloats&&o[n].componentDatatype!==je.UNSIGNED_BYTE?mLe(l,this._batchValues,h):se.pack(l,this._batchValues,h),this._batchValuesDirty=!0};function gLe(t,n){let i=t._textureDimensions;t._texture=new St({context:n,pixelFormat:st.RGBA,pixelDatatype:t._pixelDatatype,width:i.x,height:i.y,sampler:pn.NEAREST,flipY:!1})}function yLe(t){let n=t._textureDimensions;t._texture.copyFrom({source:{width:n.x,height:n.y,arrayBufferView:t._batchValues}})}Pm.prototype.update=function(t){f(this._texture)&&!this._batchValuesDirty||this._attributes.length===0||(this._batchValuesDirty=!1,f(this._texture)||gLe(this,t.context),yLe(this))};Pm.prototype.getUniformMapCallback=function(){let t=this;return function(n){return t._attributes.length===0?n:At(n,{batchTexture:function(){return t._texture},batchTextureDimensions:function(){return t._textureDimensions},batchTextureStep:function(){return t._textureStep}})}};function ALe(t){let n=t._stride;return t._textureDimensions.y===1?`uniform vec4 batchTextureStep; 
vec2 computeSt(float batchId) 
{ 
    float stepX = batchTextureStep.x; 
    float centerX = batchTextureStep.y; 
    float numberOfAttributes = float(${n}); 
    return vec2(centerX + (batchId * numberOfAttributes * stepX), 0.5); 
} 
`:`uniform vec4 batchTextureStep; 
uniform vec2 batchTextureDimensions; 
vec2 computeSt(float batchId) 
{ 
    float stepX = batchTextureStep.x; 
    float centerX = batchTextureStep.y; 
    float stepY = batchTextureStep.z; 
    float centerY = batchTextureStep.w; 
    float numberOfAttributes = float(${n}); 
    float xId = mod(batchId * numberOfAttributes, batchTextureDimensions.x); 
    float yId = floor(batchId * numberOfAttributes / batchTextureDimensions.x); 
    return vec2(centerX + (xId * stepX), centerY + (yId * stepY)); 
} 
`}function CLe(t){return t===1?"float":`vec${t}`}function xLe(t){return t===1?".x":t===2?".xy":t===3?".xyz":""}function TLe(t,n){let o=t._attributes[n],r=o.componentsPerAttribute,s=o.functionName,a=CLe(r),c=xLe(r),l=t._offsets[n],u=`${a} ${s}(float batchId) 
{ 
    vec2 st = computeSt(batchId); 
    st.x += batchTextureStep.x * float(${l}); 
`;return t._packFloats&&o.componentDatatype!==je.UNSIGNED_BYTE?u+=`vec4 textureValue; 
textureValue.x = czm_unpackFloat(texture2D(batchTexture, st)); 
textureValue.y = czm_unpackFloat(texture2D(batchTexture, st + vec2(batchTextureStep.x, 0.0))); 
textureValue.z = czm_unpackFloat(texture2D(batchTexture, st + vec2(batchTextureStep.x * 2.0, 0.0))); 
textureValue.w = czm_unpackFloat(texture2D(batchTexture, st + vec2(batchTextureStep.x * 3.0, 0.0))); 
`:u+=`    vec4 textureValue = texture2D(batchTexture, st); 
`,u+=`    ${a} value = textureValue${c}; 
`,t._pixelDatatype===je.UNSIGNED_BYTE&&o.componentDatatype===J.UNSIGNED_BYTE&&!o.normalize?u+=`value *= 255.0; 
`:t._pixelDatatype===je.FLOAT&&o.componentDatatype===J.UNSIGNED_BYTE&&o.normalize&&(u+=`value /= 255.0; 
`),u+=`    return value; 
} 
`,u}Pm.prototype.getVertexShaderCallback=function(){let t=this._attributes;if(t.length===0)return function(o){return o};let n=`uniform highp sampler2D batchTexture; 
`;n+=`${ALe(this)}
`;let i=t.length;for(let o=0;o<i;++o)n+=TLe(this,o);return function(o){let r=o.indexOf("void main"),s=o.substring(0,r),a=o.substring(r);return`${s}
${n}
${a}`}};Pm.prototype.isDestroyed=function(){return!1};Pm.prototype.destroy=function(){return this._texture=this._texture&&this._texture.destroy(),ue(this)};var ox=Pm;function Yc(t){this._ellipsoid=A(t,oe.WGS84),this._semimajorAxis=this._ellipsoid.maximumRadius,this._oneOverSemimajorAxis=1/this._semimajorAxis}Object.defineProperties(Yc.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}});Yc.mercatorAngleToGeodeticLatitude=function(t){return B.PI_OVER_TWO-2*Math.atan(Math.exp(-t))};Yc.geodeticLatitudeToMercatorAngle=function(t){t>Yc.MaximumLatitude?t=Yc.MaximumLatitude:t<-Yc.MaximumLatitude&&(t=-Yc.MaximumLatitude);let n=Math.sin(t);return .5*Math.log((1+n)/(1-n))};Yc.MaximumLatitude=Yc.mercatorAngleToGeodeticLatitude(Math.PI);Yc.prototype.project=function(t,n){let i=this._semimajorAxis,o=t.longitude*i,r=Yc.geodeticLatitudeToMercatorAngle(t.latitude)*i,s=t.height;return f(n)?(n.x=o,n.y=r,n.z=s,n):new m(o,r,s)};Yc.prototype.unproject=function(t,n){let i=this._oneOverSemimajorAxis,o=t.x*i,r=Yc.mercatorAngleToGeodeticLatitude(t.y*i),s=t.z;return f(n)?(n.longitude=o,n.latitude=r,n.height=s,n):new de(o,r,s)};var bi=Yc;function ELe(t,n,i){let o=!i,r=t.length,s;if(!o&&r>1){let a=t[0].modelMatrix;for(s=1;s<r;++s)if(!N.equals(a,t[s].modelMatrix)){o=!0;break}}if(o)for(s=0;s<r;++s)f(t[s].geometry)&&Fn.transformToWorldCoordinates(t[s]);else N.multiplyTransformation(n,t[0].modelMatrix,n)}function bG(t,n){let i=t.attributes,o=i.position,r=o.values.length/o.componentsPerAttribute;i.batchId=new we({componentDatatype:J.FLOAT,componentsPerAttribute:1,values:new Float32Array(r)});let s=i.batchId.values;for(let a=0;a<r;++a)s[a]=n}function bLe(t){let n=t.length;for(let i=0;i<n;++i){let o=t[i];f(o.geometry)?bG(o.geometry,i):f(o.westHemisphereGeometry)&&f(o.eastHemisphereGeometry)&&(bG(o.westHemisphereGeometry,i),bG(o.eastHemisphereGeometry,i))}}function SLe(t){let n=t.instances,i=t.projection,o=t.elementIndexUintSupported,r=t.scene3DOnly,s=t.vertexCacheOptimize,a=t.compressVertices,c=t.modelMatrix,l,u,d,h=n.length;for(l=0;l<h;++l)if(f(n[l].geometry)){d=n[l].geometry.primitiveType;break}if(ELe(n,c,r),!r)for(l=0;l<h;++l)f(n[l].geometry)&&Fn.splitLongitude(n[l]);if(bLe(n),s)for(l=0;l<h;++l){let y=n[l];f(y.geometry)?(Fn.reorderForPostVertexCache(y.geometry),Fn.reorderForPreVertexCache(y.geometry)):f(y.westHemisphereGeometry)&&f(y.eastHemisphereGeometry)&&(Fn.reorderForPostVertexCache(y.westHemisphereGeometry),Fn.reorderForPreVertexCache(y.westHemisphereGeometry),Fn.reorderForPostVertexCache(y.eastHemisphereGeometry),Fn.reorderForPreVertexCache(y.eastHemisphereGeometry))}let _=Fn.combineInstances(n);for(h=_.length,l=0;l<h;++l){u=_[l];let y=u.attributes;if(r)for(let p in y)y.hasOwnProperty(p)&&y[p].componentDatatype===J.DOUBLE&&Fn.encodeAttribute(u,p,`${p}3DHigh`,`${p}3DLow`);else for(let p in y)if(y.hasOwnProperty(p)&&y[p].componentDatatype===J.DOUBLE){let C=`${p}3D`,x=`${p}2D`;Fn.projectTo2D(u,p,C,x,i),f(u.boundingSphere)&&p==="position"&&(u.boundingSphereCV=ae.fromVertices(u.attributes.position2D.values)),Fn.encodeAttribute(u,C,`${C}High`,`${C}Low`),Fn.encodeAttribute(u,x,`${x}High`,`${x}Low`)}a&&Fn.compressVertices(u)}if(!o){let y=[];for(h=_.length,l=0;l<h;++l)u=_[l],y=y.concat(Fn.fitToUnsignedShortIndices(u));_=y}return _}function SG(t,n,i,o){let r,s,a,c=o.length-1;if(c>=0){let u=o[c];r=u.offset+u.count,a=u.index,s=i[a].indices.length}else r=0,a=0,s=i[a].indices.length;let l=t.length;for(let u=0;u<l;++u){let h=t[u][n];if(!f(h))continue;let _=h.indices.length;r+_>s&&(r=0,s=i[++a].indices.length),o.push({index:a,offset:r,count:_}),r+=_}}function wLe(t,n){let i=[];return SG(t,"geometry",n,i),SG(t,"westHemisphereGeometry",n,i),SG(t,"eastHemisphereGeometry",n,i),i}var Im={};Im.combineGeometry=function(t){let n,i,o=t.instances,r=o.length,s,a,c=!1;r>0&&(n=SLe(t),n.length>0&&(i=Fn.createAttributeLocations(n[0]),t.createPickOffsets&&(s=wLe(o,n))),f(o[0].attributes)&&f(o[0].attributes.offset)&&(a=new Array(r),c=!0));let l=new Array(r),u=new Array(r);for(let d=0;d<r;++d){let h=o[d],_=h.geometry;f(_)&&(l[d]=_.boundingSphere,u[d]=_.boundingSphereCV,c&&(a[d]=h.geometry.offsetAttribute));let y=h.eastHemisphereGeometry,p=h.westHemisphereGeometry;f(y)&&f(p)&&(f(y.boundingSphere)&&f(p.boundingSphere)&&(l[d]=ae.union(y.boundingSphere,p.boundingSphere)),f(y.boundingSphereCV)&&f(p.boundingSphereCV)&&(u[d]=ae.union(y.boundingSphereCV,p.boundingSphereCV)))}return{geometries:n,modelMatrix:t.modelMatrix,attributeLocations:i,pickOffsets:s,offsetInstanceExtend:a,boundingSpheres:l,boundingSpheresCV:u}};function DLe(t,n){let i=t.attributes;for(let o in i)if(i.hasOwnProperty(o)){let r=i[o];f(r)&&f(r.values)&&n.push(r.values.buffer)}f(t.indices)&&n.push(t.indices.buffer)}function vLe(t,n){let i=t.length;for(let o=0;o<i;++o)DLe(t[o],n)}function PLe(t){let n=1,i=t.length;for(let o=0;o<i;o++){let r=t[o];if(++n,!f(r))continue;let s=r.attributes;n+=7+2*ae.packedLength+(f(r.indices)?r.indices.length:0);for(let a in s)if(s.hasOwnProperty(a)&&f(s[a])){let c=s[a];n+=5+c.values.length}}return n}Im.packCreateGeometryResults=function(t,n){let i=new Float64Array(PLe(t)),o=[],r={},s=t.length,a=0;i[a++]=s;for(let c=0;c<s;c++){let l=t[c],u=f(l);if(i[a++]=u?1:0,!u)continue;i[a++]=l.primitiveType,i[a++]=l.geometryType,i[a++]=A(l.offsetAttribute,-1);let d=f(l.boundingSphere)?1:0;i[a++]=d,d&&ae.pack(l.boundingSphere,i,a),a+=ae.packedLength;let h=f(l.boundingSphereCV)?1:0;i[a++]=h,h&&ae.pack(l.boundingSphereCV,i,a),a+=ae.packedLength;let _=l.attributes,y=[];for(let C in _)_.hasOwnProperty(C)&&f(_[C])&&(y.push(C),f(r[C])||(r[C]=o.length,o.push(C)));i[a++]=y.length;for(let C=0;C<y.length;C++){let x=y[C],T=_[x];i[a++]=r[x],i[a++]=T.componentDatatype,i[a++]=T.componentsPerAttribute,i[a++]=T.normalize?1:0,i[a++]=T.values.length,i.set(T.values,a),a+=T.values.length}let p=f(l.indices)?l.indices.length:0;i[a++]=p,p>0&&(i.set(l.indices,a),a+=p)}return n.push(i.buffer),{stringTable:o,packedData:i}};Im.unpackCreateGeometryResults=function(t){let n=t.stringTable,i=t.packedData,o,r=new Array(i[0]),s=0,a=1;for(;a<i.length;){if(!(i[a++]===1)){r[s++]=void 0;continue}let l=i[a++],u=i[a++],d=i[a++];d===-1&&(d=void 0);let h,_;i[a++]===1&&(h=ae.unpack(i,a)),a+=ae.packedLength,i[a++]===1&&(_=ae.unpack(i,a)),a+=ae.packedLength;let C,x,T,E=new cn,S=i[a++];for(o=0;o<S;o++){let D=n[i[a++]],I=i[a++];T=i[a++];let O=i[a++]!==0;C=i[a++],x=J.createTypedArray(I,C);for(let M=0;M<C;M++)x[M]=i[a++];E[D]=new we({componentDatatype:I,componentsPerAttribute:T,normalize:O,values:x})}let w;if(C=i[a++],C>0){let D=x.length/T;for(w=Ne.createTypedArray(D,C),o=0;o<C;o++)w[o]=i[a++]}r[s++]=new at({primitiveType:l,geometryType:u,boundingSphere:h,boundingSphereCV:_,indices:w,attributes:E,offsetAttribute:d})}return r};function ILe(t,n){let i=t.length,o=new Float64Array(1+i*19),r=0;o[r++]=i;for(let s=0;s<i;s++){let a=t[s];if(N.pack(a.modelMatrix,o,r),r+=N.packedLength,f(a.attributes)&&f(a.attributes.offset)){let c=a.attributes.offset.value;o[r]=c[0],o[r+1]=c[1],o[r+2]=c[2]}r+=3}return n.push(o.buffer),o}function BLe(t){let n=t,i=new Array(n[0]),o=0,r=1;for(;r<n.length;){let s=N.unpack(n,r),a;r+=N.packedLength,f(n[r])&&(a={offset:new Gi(n[r],n[r+1],n[r+2])}),r+=3,i[o++]={modelMatrix:s,attributes:a}}return i}Im.packCombineGeometryParameters=function(t,n){let i=t.createGeometryResults,o=i.length;for(let r=0;r<o;r++)n.push(i[r].packedData.buffer);return{createGeometryResults:t.createGeometryResults,packedInstances:ILe(t.instances,n),ellipsoid:t.ellipsoid,isGeographic:t.projection instanceof Ci,elementIndexUintSupported:t.elementIndexUintSupported,scene3DOnly:t.scene3DOnly,vertexCacheOptimize:t.vertexCacheOptimize,compressVertices:t.compressVertices,modelMatrix:t.modelMatrix,createPickOffsets:t.createPickOffsets}};Im.unpackCombineGeometryParameters=function(t){let n=BLe(t.packedInstances),i=t.createGeometryResults,o=i.length,r=0;for(let c=0;c<o;c++){let l=Im.unpackCreateGeometryResults(i[c]),u=l.length;for(let d=0;d<u;d++){let h=l[d],_=n[r];_.geometry=h,++r}}let s=oe.clone(t.ellipsoid),a=t.isGeographic?new Ci(s):new bi(s);return{instances:n,ellipsoid:s,projection:a,elementIndexUintSupported:t.elementIndexUintSupported,scene3DOnly:t.scene3DOnly,vertexCacheOptimize:t.vertexCacheOptimize,compressVertices:t.compressVertices,modelMatrix:N.clone(t.modelMatrix),createPickOffsets:t.createPickOffsets}};function X$(t){let n=t.length,i=1+(ae.packedLength+1)*n,o=new Float32Array(i),r=0;o[r++]=n;for(let s=0;s<n;++s){let a=t[s];f(a)?(o[r++]=1,ae.pack(t[s],o,r)):o[r++]=0,r+=ae.packedLength}return o}function K$(t){let n=new Array(t[0]),i=0,o=1;for(;o<t.length;)t[o++]===1&&(n[i]=ae.unpack(t,o)),++i,o+=ae.packedLength;return n}Im.packCombineGeometryResults=function(t,n){f(t.geometries)&&vLe(t.geometries,n);let i=X$(t.boundingSpheres),o=X$(t.boundingSpheresCV);return n.push(i.buffer,o.buffer),{geometries:t.geometries,attributeLocations:t.attributeLocations,modelMatrix:t.modelMatrix,pickOffsets:t.pickOffsets,offsetInstanceExtend:t.offsetInstanceExtend,boundingSpheres:i,boundingSpheresCV:o}};Im.unpackCombineGeometryResults=function(t){return{geometries:t.geometries,attributeLocations:t.attributeLocations,modelMatrix:t.modelMatrix,pickOffsets:t.pickOffsets,offsetInstanceExtend:t.offsetInstanceExtend,boundingSpheres:K$(t.boundingSpheres),boundingSpheresCV:K$(t.boundingSpheresCV)}};var rx=Im;var OLe={READY:0,CREATING:1,CREATED:2,COMBINING:3,COMBINED:4,COMPLETE:5,FAILED:6},Cr=Object.freeze(OLe);function cr(t){t=A(t,A.EMPTY_OBJECT),this.geometryInstances=t.geometryInstances,this.appearance=t.appearance,this._appearance=void 0,this._material=void 0,this.depthFailAppearance=t.depthFailAppearance,this._depthFailAppearance=void 0,this._depthFailMaterial=void 0,this.modelMatrix=N.clone(A(t.modelMatrix,N.IDENTITY)),this._modelMatrix=new N,this.show=A(t.show,!0),this._vertexCacheOptimize=A(t.vertexCacheOptimize,!1),this._interleave=A(t.interleave,!1),this._releaseGeometryInstances=A(t.releaseGeometryInstances,!0),this._allowPicking=A(t.allowPicking,!0),this._asynchronous=A(t.asynchronous,!0),this._compressVertices=A(t.compressVertices,!0),this.cull=A(t.cull,!0),this.debugShowBoundingVolume=A(t.debugShowBoundingVolume,!1),this.rtcCenter=t.rtcCenter,this.shadows=A(t.shadows,gn.DISABLED),this._translucent=void 0,this._state=Cr.READY,this._geometries=[],this._error=void 0,this._numberOfInstances=0,this._boundingSpheres=[],this._boundingSphereWC=[],this._boundingSphereCV=[],this._boundingSphere2D=[],this._boundingSphereMorph=[],this._perInstanceAttributeCache=[],this._instanceIds=[],this._lastPerInstanceAttributeIndex=0,this._va=[],this._attributeLocations=void 0,this._primitiveType=void 0,this._frontFaceRS=void 0,this._backFaceRS=void 0,this._sp=void 0,this._depthFailAppearance=void 0,this._spDepthFail=void 0,this._frontFaceDepthFailRS=void 0,this._backFaceDepthFailRS=void 0,this._pickIds=[],this._colorCommands=[],this._pickCommands=[],this._createBoundingVolumeFunction=t._createBoundingVolumeFunction,this._createRenderStatesFunction=t._createRenderStatesFunction,this._createShaderProgramFunction=t._createShaderProgramFunction,this._createCommandsFunction=t._createCommandsFunction,this._updateAndQueueCommandsFunction=t._updateAndQueueCommandsFunction,this._createPickOffsets=t._createPickOffsets,this._pickOffsets=void 0,this._createGeometryResults=void 0,this._ready=!1;let n=this;this._readyPromise=new Promise((i,o)=>{n._completeLoad=(r,s,a)=>{this._error=a,this._state=s,r.afterRender.push(function(){if(n._ready=n._state===Cr.COMPLETE||n._state===Cr.FAILED,!f(a))return i(n),!0;o(a)})}}),this._batchTable=void 0,this._batchTableAttributeIndices=void 0,this._offsetInstanceExtend=void 0,this._batchTableOffsetAttribute2DIndex=void 0,this._batchTableOffsetsUpdated=!1,this._instanceBoundingSpheres=void 0,this._instanceBoundingSpheresCV=void 0,this._tempBoundingSpheres=void 0,this._recomputeBoundingSpheres=!1,this._batchTableBoundingSpheresUpdated=!1,this._batchTableBoundingSphereAttributeIndices=void 0}Object.defineProperties(cr.prototype,{vertexCacheOptimize:{get:function(){return this._vertexCacheOptimize}},interleave:{get:function(){return this._interleave}},releaseGeometryInstances:{get:function(){return this._releaseGeometryInstances}},allowPicking:{get:function(){return this._allowPicking}},asynchronous:{get:function(){return this._asynchronous}},compressVertices:{get:function(){return this._compressVertices}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise}}});function RLe(t){let n=t.length,i=[],o=t[0].attributes,r;for(r in o)if(o.hasOwnProperty(r)&&f(o[r])){let s=o[r],a=!0;for(let c=1;c<n;++c){let l=t[c].attributes[r];if(!f(l)||s.componentDatatype!==l.componentDatatype||s.componentsPerAttribute!==l.componentsPerAttribute||s.normalize!==l.normalize){a=!1;break}}a&&i.push(r)}return i}var MLe=new W,LLe=new m,oee=new se;function ree(t){let n=t.length;if(n===1)return t[0];if(n===2)return W.unpack(t,0,MLe);if(n===3)return m.unpack(t,0,LLe);if(n===4)return se.unpack(t,0,oee)}function FLe(t,n){let i=t.geometryInstances,o=Array.isArray(i)?i:[i],r=o.length;if(r===0)return;let s=RLe(o),a=s.length,c=[],l={},u={},d,_=o[0].attributes,y,p,C;for(y=0;y<a;++y)p=s[y],C=_[p],l[p]=y,c.push({functionName:`czm_batchTable_${p}`,componentDatatype:C.componentDatatype,componentsPerAttribute:C.componentsPerAttribute,normalize:C.normalize});s.indexOf("distanceDisplayCondition")!==-1&&(c.push({functionName:"czm_batchTable_boundingSphereCenter3DHigh",componentDatatype:J.FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereCenter3DLow",componentDatatype:J.FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereCenter2DHigh",componentDatatype:J.FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereCenter2DLow",componentDatatype:J.FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereRadius",componentDatatype:J.FLOAT,componentsPerAttribute:1}),u.center3DHigh=c.length-5,u.center3DLow=c.length-4,u.center2DHigh=c.length-3,u.center2DLow=c.length-2,u.radius=c.length-1),s.indexOf("offset")!==-1&&(c.push({functionName:"czm_batchTable_offset2D",componentDatatype:J.FLOAT,componentsPerAttribute:3}),d=c.length-1),c.push({functionName:"czm_batchTable_pickColor",componentDatatype:J.UNSIGNED_BYTE,componentsPerAttribute:4,normalize:!0});let x=c.length,T=new ox(n,c,r);for(y=0;y<r;++y){let E=o[y];_=E.attributes;for(let O=0;O<a;++O){p=s[O],C=_[p];let M=ree(C.value),L=l[p];T.setBatchedAttribute(y,L,M)}let S={primitive:A(E.pickPrimitive,t)};f(E.id)&&(S.id=E.id);let w=n.createPickId(S);t._pickIds.push(w);let D=w.color,I=oee;I.x=z.floatToByte(D.red),I.y=z.floatToByte(D.green),I.z=z.floatToByte(D.blue),I.w=z.floatToByte(D.alpha),T.setBatchedAttribute(y,x-1,I)}t._batchTable=T,t._batchTableAttributeIndices=l,t._batchTableBoundingSphereAttributeIndices=u,t._batchTableOffsetAttribute2DIndex=d}function NLe(t){let n;return Array.isArray(t.values)?n=t.values.slice(0):n=new t.values.constructor(t.values),new we({componentDatatype:t.componentDatatype,componentsPerAttribute:t.componentsPerAttribute,normalize:t.normalize,values:n})}function VLe(t){let n=t.attributes,i=new cn;for(let r in n)n.hasOwnProperty(r)&&f(n[r])&&(i[r]=NLe(n[r]));let o;if(f(t.indices)){let r=t.indices;Array.isArray(r)?o=r.slice(0):o=new r.constructor(r)}return new at({attributes:i,indices:o,primitiveType:t.primitiveType,boundingSphere:ae.clone(t.boundingSphere)})}function kLe(t,n){return{geometry:n,attributes:t.attributes,modelMatrix:N.clone(t.modelMatrix),pickPrimitive:t.pickPrimitive,id:t.id}}var ULe=/attribute\s+vec(?:3|4)\s+(.*)3DHigh;/g;cr._modifyShaderPosition=function(t,n,i){let o,r="",s="",a="";for(;(o=ULe.exec(n))!==null;){let c=o[1],l=`vec4 czm_compute${c[0].toUpperCase()}${c.substr(1)}()`;l!=="vec4 czm_computePosition()"&&(r+=`${l};
`),f(t.rtcCenter)?(n=n.replace(/attribute\s+vec(?:3|4)\s+position3DHigh;/g,""),n=n.replace(/attribute\s+vec(?:3|4)\s+position3DLow;/g,""),r+=`uniform mat4 u_modifiedModelView;
`,s+=`attribute vec4 position;
`,a+=`${l}
{
    return u_modifiedModelView * position;
}

`,n=n.replace(/czm_modelViewRelativeToEye\s+\*\s+/g,""),n=n.replace(/czm_modelViewProjectionRelativeToEye/g,"czm_projection")):i?a+=`${l}
{
    return czm_translateRelativeToEye(${c}3DHigh, ${c}3DLow);
}

`:(s+=`attribute vec3 ${c}2DHigh;
attribute vec3 ${c}2DLow;
`,a+=`${l}
{
    vec4 p;
    if (czm_morphTime == 1.0)
    {
        p = czm_translateRelativeToEye(${c}3DHigh, ${c}3DLow);
    }
    else if (czm_morphTime == 0.0)
    {
        p = czm_translateRelativeToEye(${c}2DHigh.zxy, ${c}2DLow.zxy);
    }
    else
    {
        p = czm_columbusViewMorph(
                czm_translateRelativeToEye(${c}2DHigh.zxy, ${c}2DLow.zxy),
                czm_translateRelativeToEye(${c}3DHigh, ${c}3DLow),
                czm_morphTime);
    }
    return p;
}

`)}return[r,s,n,a].join(`
`)};cr._appendShowToShader=function(t,n){return f(t._batchTableAttributeIndices.show)?`${ze.replaceMain(n,"czm_non_show_main")}
void main() 
{ 
    czm_non_show_main(); 
    gl_Position *= czm_batchTable_show(batchId); 
}`:n};cr._updateColorAttribute=function(t,n,i){if(!f(t._batchTableAttributeIndices.color)&&!f(t._batchTableAttributeIndices.depthFailColor)||n.search(/attribute\s+vec4\s+color;/g)===-1)return n;let o=n;return o=o.replace(/attribute\s+vec4\s+color;/g,""),i?o=o.replace(/(\b)color(\b)/g,"$1czm_batchTable_depthFailColor(batchId)$2"):o=o.replace(/(\b)color(\b)/g,"$1czm_batchTable_color(batchId)$2"),o};function J$(t){return`${ze.replaceMain(t,"czm_non_pick_main")}
varying vec4 v_pickColor; 
void main() 
{ 
    czm_non_pick_main(); 
    v_pickColor = czm_batchTable_pickColor(batchId); 
}`}function Z$(t){return`varying vec4 v_pickColor;
${t}`}cr._updatePickColorAttribute=function(t){let n=t.replace(/attribute\s+vec4\s+pickColor;/g,"");return n=n.replace(/(\b)pickColor(\b)/g,"$1czm_batchTable_pickColor(batchId)$2"),n};cr._appendOffsetToShader=function(t,n){if(!f(t._batchTableAttributeIndices.offset))return n;let i=`attribute float batchId;
`;i+="attribute float applyOffset;";let o=n.replace(/attribute\s+float\s+batchId;/g,i),r=`vec4 $1 = czm_computePosition();
`;return r+=`    if (czm_sceneMode == czm_sceneMode3D)
`,r+=`    {
`,r+="        $1 = $1 + vec4(czm_batchTable_offset(batchId) * applyOffset, 0.0);",r+=`    }
`,r+=`    else
`,r+=`    {
`,r+="        $1 = $1 + vec4(czm_batchTable_offset2D(batchId) * applyOffset, 0.0);",r+=`    }
`,o=o.replace(/vec4\s+([A-Za-z0-9_]+)\s+=\s+czm_computePosition\(\);/g,r),o};cr._appendDistanceDisplayConditionToShader=function(t,n,i){if(!f(t._batchTableAttributeIndices.distanceDisplayCondition))return n;let o=ze.replaceMain(n,"czm_non_distanceDisplayCondition_main"),r=`void main() 
{ 
    czm_non_distanceDisplayCondition_main(); 
    vec2 distanceDisplayCondition = czm_batchTable_distanceDisplayCondition(batchId);
    vec3 boundingSphereCenter3DHigh = czm_batchTable_boundingSphereCenter3DHigh(batchId);
    vec3 boundingSphereCenter3DLow = czm_batchTable_boundingSphereCenter3DLow(batchId);
    float boundingSphereRadius = czm_batchTable_boundingSphereRadius(batchId);
`;return i?r+=`    vec4 centerRTE = czm_translateRelativeToEye(boundingSphereCenter3DHigh, boundingSphereCenter3DLow);
`:r+=`    vec3 boundingSphereCenter2DHigh = czm_batchTable_boundingSphereCenter2DHigh(batchId);
    vec3 boundingSphereCenter2DLow = czm_batchTable_boundingSphereCenter2DLow(batchId);
    vec4 centerRTE;
    if (czm_morphTime == 1.0)
    {
        centerRTE = czm_translateRelativeToEye(boundingSphereCenter3DHigh, boundingSphereCenter3DLow);
    }
    else if (czm_morphTime == 0.0)
    {
        centerRTE = czm_translateRelativeToEye(boundingSphereCenter2DHigh.zxy, boundingSphereCenter2DLow.zxy);
    }
    else
    {
        centerRTE = czm_columbusViewMorph(
                czm_translateRelativeToEye(boundingSphereCenter2DHigh.zxy, boundingSphereCenter2DLow.zxy),
                czm_translateRelativeToEye(boundingSphereCenter3DHigh, boundingSphereCenter3DLow),
                czm_morphTime);
    }
`,r+=`    float radiusSq = boundingSphereRadius * boundingSphereRadius; 
    float distanceSq; 
    if (czm_sceneMode == czm_sceneMode2D) 
    { 
        distanceSq = czm_eyeHeight2D.y - radiusSq; 
    } 
    else 
    { 
        distanceSq = dot(centerRTE.xyz, centerRTE.xyz) - radiusSq; 
    } 
    distanceSq = max(distanceSq, 0.0); 
    float nearSq = distanceDisplayCondition.x * distanceDisplayCondition.x; 
    float farSq = distanceDisplayCondition.y * distanceDisplayCondition.y; 
    float show = (distanceSq >= nearSq && distanceSq <= farSq) ? 1.0 : 0.0; 
    gl_Position *= show; 
}`,`${o}
${r}`};function Q$(t,n){if(!t.compressVertices)return n;let i=n.search(/attribute\s+vec3\s+normal;/g)!==-1,o=n.search(/attribute\s+vec2\s+st;/g)!==-1;if(!i&&!o)return n;let r=n.search(/attribute\s+vec3\s+tangent;/g)!==-1,s=n.search(/attribute\s+vec3\s+bitangent;/g)!==-1,a=o&&i?2:1;a+=r||s?1:0;let c=a>1?`vec${a}`:"float",l="compressedAttributes",u=`attribute ${c} ${l};`,d="",h="";if(o){d+=`vec2 st;
`;let p=a>1?`${l}.x`:l;h+=`    st = czm_decompressTextureCoordinates(${p});
`}i&&r&&s?(d+=`vec3 normal;
vec3 tangent;
vec3 bitangent;
`,h+=`    czm_octDecode(${l}.${o?"yz":"xy"}, normal, tangent, bitangent);
`):(i&&(d+=`vec3 normal;
`,h+=`    normal = czm_octDecode(${l}${a>1?`.${o?"y":"x"}`:""});
`),r&&(d+=`vec3 tangent;
`,h+=`    tangent = czm_octDecode(${l}.${o&&i?"z":"y"});
`),s&&(d+=`vec3 bitangent;
`,h+=`    bitangent = czm_octDecode(${l}.${o&&i?"z":"y"});
`));let _=n;_=_.replace(/attribute\s+vec3\s+normal;/g,""),_=_.replace(/attribute\s+vec2\s+st;/g,""),_=_.replace(/attribute\s+vec3\s+tangent;/g,""),_=_.replace(/attribute\s+vec3\s+bitangent;/g,""),_=ze.replaceMain(_,"czm_non_compressed_main");let y=`void main() 
{ 
${h}    czm_non_compressed_main(); 
}`;return[u,d,_,y].join(`
`)}function zLe(t){let n=ze.replaceMain(t,"czm_non_depth_clamp_main");return n+=`void main() {
    czm_non_depth_clamp_main();
    gl_Position = czm_depthClamp(gl_Position);}
`,n}function HLe(t){let n=ze.replaceMain(t,"czm_non_depth_clamp_main");return n+=`void main() {
    czm_non_depth_clamp_main();
#if defined(GL_EXT_frag_depth)
    #if defined(LOG_DEPTH)
        czm_writeLogDepth();
    #else
        czm_writeDepthClamp();
    #endif
#endif
}
`,n=`#ifdef GL_EXT_frag_depth
#extension GL_EXT_frag_depth : enable
#endif
${n}`,n}function $$(t,n){let i=t.vertexAttributes}function GLe(t,n){return function(){return t[n]}}var wG=Math.max(Vt.hardwareConcurrency-1,1),cL,WLe=new fi("combineGeometry");function jLe(t,n){let i,o,r,s,a=t._instanceIds;if(t._state===Cr.READY){i=Array.isArray(t.geometryInstances)?t.geometryInstances:[t.geometryInstances];let c=t._numberOfInstances=i.length,l=[],u=[];for(r=0;r<c;++r)o=i[r].geometry,a.push(i[r].id),u.push({moduleName:o._workerName,geometry:o});if(!f(cL))for(cL=new Array(wG),r=0;r<wG;r++)cL[r]=new fi("createGeometry");let d;for(u=aL(u,wG),r=0;r<u.length;r++){let h=0,_=u[r],y=_.length;for(s=0;s<y;++s)d=_[s],o=d.geometry,f(o.constructor.pack)&&(d.offset=h,h+=A(o.constructor.packedLength,o.packedLength));let p;if(h>0){let C=new Float64Array(h);for(p=[C.buffer],s=0;s<y;++s)d=_[s],o=d.geometry,f(o.constructor.pack)&&(o.constructor.pack(o,C,d.offset),d.geometry=C)}l.push(cL[r].scheduleTask({subTasks:u[r]},p))}t._state=Cr.CREATING,Promise.all(l).then(function(h){t._createGeometryResults=h,t._state=Cr.CREATED}).catch(function(h){bS(t,n,Cr.FAILED,h)})}else if(t._state===Cr.CREATED){let c=[];i=Array.isArray(t.geometryInstances)?t.geometryInstances:[t.geometryInstances];let l=n.scene3DOnly,u=n.mapProjection,d=WLe.scheduleTask(rx.packCombineGeometryParameters({createGeometryResults:t._createGeometryResults,instances:i,ellipsoid:u.ellipsoid,projection:u,elementIndexUintSupported:n.context.elementIndexUint,scene3DOnly:l,vertexCacheOptimize:t.vertexCacheOptimize,compressVertices:t.compressVertices,modelMatrix:t.modelMatrix,createPickOffsets:t._createPickOffsets},c),c);t._createGeometryResults=void 0,t._state=Cr.COMBINING,Promise.resolve(d).then(function(h){let _=rx.unpackCombineGeometryResults(h);t._geometries=_.geometries,t._attributeLocations=_.attributeLocations,t.modelMatrix=N.clone(_.modelMatrix,t.modelMatrix),t._pickOffsets=_.pickOffsets,t._offsetInstanceExtend=_.offsetInstanceExtend,t._instanceBoundingSpheres=_.boundingSpheres,t._instanceBoundingSpheresCV=_.boundingSpheresCV,f(t._geometries)&&t._geometries.length>0?(t._recomputeBoundingSpheres=!0,t._state=Cr.COMBINED):bS(t,n,Cr.FAILED,void 0)}).catch(function(h){bS(t,n,Cr.FAILED,h)})}}function qLe(t,n){let i=Array.isArray(t.geometryInstances)?t.geometryInstances:[t.geometryInstances],o=t._numberOfInstances=i.length,r=new Array(o),s=t._instanceIds,a,c,l=0;for(c=0;c<o;c++){a=i[c];let _=a.geometry,y;f(_.attributes)&&f(_.primitiveType)?y=VLe(_):y=_.constructor.createGeometry(_),r[l++]=kLe(a,y),s.push(a.id)}r.length=l;let u=n.scene3DOnly,d=n.mapProjection,h=rx.combineGeometry({instances:r,ellipsoid:d.ellipsoid,projection:d,elementIndexUintSupported:n.context.elementIndexUint,scene3DOnly:u,vertexCacheOptimize:t.vertexCacheOptimize,compressVertices:t.compressVertices,modelMatrix:t.modelMatrix,createPickOffsets:t._createPickOffsets});t._geometries=h.geometries,t._attributeLocations=h.attributeLocations,t.modelMatrix=N.clone(h.modelMatrix,t.modelMatrix),t._pickOffsets=h.pickOffsets,t._offsetInstanceExtend=h.offsetInstanceExtend,t._instanceBoundingSpheres=h.boundingSpheres,t._instanceBoundingSpheresCV=h.boundingSpheresCV,f(t._geometries)&&t._geometries.length>0?(t._recomputeBoundingSpheres=!0,t._state=Cr.COMBINED):bS(t,n,Cr.FAILED,void 0)}function YLe(t,n){let i=t._batchTableAttributeIndices.offset;if(!t._recomputeBoundingSpheres||!f(i)){t._recomputeBoundingSpheres=!1;return}let o,r=t._offsetInstanceExtend,s=t._instanceBoundingSpheres,a=s.length,c=t._tempBoundingSpheres;if(!f(c)){for(c=new Array(a),o=0;o<a;o++)c[o]=new ae;t._tempBoundingSpheres=c}for(o=0;o<a;++o){let C=c[o],x=t._batchTable.getBatchedAttribute(o,i,new m);C=s[o].clone(C),lee(C,x,r[o])}let l=[],u=[],d=[];for(o=0;o<a;++o){let C=c[o];C.center.x-C.radius>0||ae.intersectPlane(C,rn.ORIGIN_ZX_PLANE)!==jt.INTERSECTING?l.push(C):(u.push(C),d.push(C))}let h=l[0],_=d[0],y=u[0];for(o=1;o<l.length;o++)h=ae.union(h,l[o]);for(o=1;o<d.length;o++)_=ae.union(_,d[o]);for(o=1;o<u.length;o++)y=ae.union(y,u[o]);let p=[];for(f(h)&&p.push(h),f(_)&&p.push(_),f(y)&&p.push(y),o=0;o<p.length;o++){let C=p[o].clone(t._boundingSpheres[o]);t._boundingSpheres[o]=C,t._boundingSphereCV[o]=ae.projectTo2D(C,n.mapProjection,t._boundingSphereCV[o])}cr._updateBoundingVolumes(t,n,t.modelMatrix,!0),t._recomputeBoundingSpheres=!1}var eee=new Hn,see=new de,aee=new m,cee=new ae;function XLe(t,n){if(!f(t._batchTableAttributeIndices.distanceDisplayCondition)||t._batchTableBoundingSpheresUpdated)return;let o=t._batchTableBoundingSphereAttributeIndices,r=o.center3DHigh,s=o.center3DLow,a=o.center2DHigh,c=o.center2DLow,l=o.radius,u=n.mapProjection,d=u.ellipsoid,h=t._batchTable,_=t._instanceBoundingSpheres,y=_.length;for(let p=0;p<y;++p){let C=_[p];if(!f(C))continue;let x=t.modelMatrix;f(x)&&(C=ae.transform(C,x,cee));let T=C.center,E=C.radius,S=Hn.fromCartesian(T,eee);if(h.setBatchedAttribute(p,r,S.high),h.setBatchedAttribute(p,s,S.low),!n.scene3DOnly){let w=d.cartesianToCartographic(T,see),D=u.project(w,aee);S=Hn.fromCartesian(D,eee),h.setBatchedAttribute(p,a,S.high),h.setBatchedAttribute(p,c,S.low)}h.setBatchedAttribute(p,l,E)}t._batchTableBoundingSpheresUpdated=!0}var DG=new m,KLe=new m;function tee(t,n){if(!f(t._batchTableAttributeIndices.offset)||t._batchTableOffsetsUpdated||n.scene3DOnly)return;let o=t._batchTableOffsetAttribute2DIndex,r=n.mapProjection,s=r.ellipsoid,a=t._batchTable,c=t._instanceBoundingSpheres,l=c.length;for(let u=0;u<l;++u){let d=c[u];if(!f(d))continue;let h=a.getBatchedAttribute(u,t._batchTableAttributeIndices.offset);if(m.equals(h,m.ZERO)){a.setBatchedAttribute(u,o,m.ZERO);continue}let _=t.modelMatrix;f(_)&&(d=ae.transform(d,_,cee));let y=d.center;y=s.scaleToGeodeticSurface(y,KLe);let p=s.cartesianToCartographic(y,see),C=r.project(p,aee),x=m.add(h,y,DG);p=s.cartesianToCartographic(x,p);let T=r.project(p,DG),E=m.subtract(T,C,DG),S=E.x;E.x=E.z,E.z=E.y,E.y=S,a.setBatchedAttribute(u,o,E)}t._batchTableOffsetsUpdated=!0}function JLe(t,n){let i=t._attributeLocations,o=t._geometries,r=n.scene3DOnly,s=n.context,a=[],c=o.length;for(let l=0;l<c;++l){let u=o[l];if(a.push($n.fromGeometry({context:s,geometry:u,attributeLocations:i,bufferUsage:Fe.STATIC_DRAW,interleave:t._interleave})),f(t._createBoundingVolumeFunction))t._createBoundingVolumeFunction(n,u);else if(t._boundingSpheres.push(ae.clone(u.boundingSphere)),t._boundingSphereWC.push(new ae),!r){let d=u.boundingSphereCV.center,h=d.x,_=d.y,y=d.z;d.x=y,d.y=h,d.z=_,t._boundingSphereCV.push(ae.clone(u.boundingSphereCV)),t._boundingSphere2D.push(new ae),t._boundingSphereMorph.push(new ae)}}t._va=a,t._primitiveType=o[0].primitiveType,t.releaseGeometryInstances&&(t.geometryInstances=void 0),t._geometries=void 0,bS(t,n,Cr.COMPLETE,void 0)}function ZLe(t,n,i,o){let r=i.getRenderState(),s;o?(s=tt(r,!1),s.cull={enabled:!0,face:xi.BACK},t._frontFaceRS=Ve.fromCache(s),s.cull.face=xi.FRONT,t._backFaceRS=Ve.fromCache(s)):(t._frontFaceRS=Ve.fromCache(r),t._backFaceRS=t._frontFaceRS),s=tt(r,!1),f(t._depthFailAppearance)&&(s.depthTest.enabled=!1),f(t._depthFailAppearance)&&(r=t._depthFailAppearance.getRenderState(),s=tt(r,!1),s.depthTest.func=cc.GREATER,o?(s.cull={enabled:!0,face:xi.BACK},t._frontFaceDepthFailRS=Ve.fromCache(s),s.cull.face=xi.FRONT,t._backFaceDepthFailRS=Ve.fromCache(s)):(t._frontFaceDepthFailRS=Ve.fromCache(s),t._backFaceDepthFailRS=t._frontFaceRS))}function QLe(t,n,i){let o=n.context,r=t._attributeLocations,s=t._batchTable.getVertexShaderCallback()(i.vertexShaderSource);s=cr._appendOffsetToShader(t,s),s=cr._appendShowToShader(t,s),s=cr._appendDistanceDisplayConditionToShader(t,s,n.scene3DOnly),s=J$(s),s=cr._updateColorAttribute(t,s,!1),s=Q$(t,s),s=cr._modifyShaderPosition(t,s,n.scene3DOnly);let a=i.getFragmentShaderSource();a=Z$(a),t._sp=qt.replaceCache({context:o,shaderProgram:t._sp,vertexShaderSource:s,fragmentShaderSource:a,attributeLocations:r}),$$(t._sp,r),f(t._depthFailAppearance)&&(s=t._batchTable.getVertexShaderCallback()(t._depthFailAppearance.vertexShaderSource),s=cr._appendShowToShader(t,s),s=cr._appendDistanceDisplayConditionToShader(t,s,n.scene3DOnly),s=J$(s),s=cr._updateColorAttribute(t,s,!0),s=Q$(t,s),s=cr._modifyShaderPosition(t,s,n.scene3DOnly),s=zLe(s),a=t._depthFailAppearance.getFragmentShaderSource(),a=Z$(a),a=HLe(a),t._spDepthFail=qt.replaceCache({context:o,shaderProgram:t._spDepthFail,vertexShaderSource:s,fragmentShaderSource:a,attributeLocations:r}),$$(t._spDepthFail,r))}var ES=new N,nee=new m;function iee(t,n,i,o){let r=f(i)?i._uniforms:void 0,s={},a=n.uniforms;if(f(a))for(let l in a)a.hasOwnProperty(l)&&(s[l]=GLe(a,l));let c=At(s,r);return c=t._batchTable.getUniformMapCallback()(c),f(t.rtcCenter)&&(c.u_modifiedModelView=function(){let l=o.context.uniformState.view;return N.multiply(l,t._modelMatrix,ES),N.multiplyByPoint(ES,t.rtcCenter,nee),N.setTranslation(ES,nee,ES),ES}),c}function $Le(t,n,i,o,r,s,a,c){let l=iee(t,n,i,c),u;f(t._depthFailAppearance)&&(u=iee(t,t._depthFailAppearance,t._depthFailAppearance.material,c));let d=o?Te.TRANSLUCENT:Te.OPAQUE,h=r?2:1;h*=f(t._depthFailAppearance)?2:1,s.length=t._va.length*h;let _=s.length,y=0;for(let p=0;p<_;++p){let C;r&&(C=s[p],f(C)||(C=s[p]=new et({owner:t,primitiveType:t._primitiveType})),C.vertexArray=t._va[y],C.renderState=t._backFaceRS,C.shaderProgram=t._sp,C.uniformMap=l,C.pass=d,++p),C=s[p],f(C)||(C=s[p]=new et({owner:t,primitiveType:t._primitiveType})),C.vertexArray=t._va[y],C.renderState=t._frontFaceRS,C.shaderProgram=t._sp,C.uniformMap=l,C.pass=d,f(t._depthFailAppearance)&&(r&&(++p,C=s[p],f(C)||(C=s[p]=new et({owner:t,primitiveType:t._primitiveType})),C.vertexArray=t._va[y],C.renderState=t._backFaceDepthFailRS,C.shaderProgram=t._spDepthFail,C.uniformMap=u,C.pass=d),++p,C=s[p],f(C)||(C=s[p]=new et({owner:t,primitiveType:t._primitiveType})),C.vertexArray=t._va[y],C.renderState=t._frontFaceDepthFailRS,C.shaderProgram=t._spDepthFail,C.uniformMap=u,C.pass=d),++y}}cr._updateBoundingVolumes=function(t,n,i,o){let r,s,a;if(o||!N.equals(i,t._modelMatrix))for(N.clone(i,t._modelMatrix),s=t._boundingSpheres.length,r=0;r<s;++r)a=t._boundingSpheres[r],f(a)&&(t._boundingSphereWC[r]=ae.transform(a,i,t._boundingSphereWC[r]),n.scene3DOnly||(t._boundingSphere2D[r]=ae.clone(t._boundingSphereCV[r],t._boundingSphere2D[r]),t._boundingSphere2D[r].center.x=0,t._boundingSphereMorph[r]=ae.union(t._boundingSphereWC[r],t._boundingSphereCV[r])));let c=t.appearance.pixelSize;if(f(c))for(s=t._boundingSpheres.length,r=0;r<s;++r){a=t._boundingSpheres[r];let l=t._boundingSphereWC[r],d=n.camera.getPixelSize(a,n.context.drawingBufferWidth,n.context.drawingBufferHeight)*c;l.radius=a.radius+d}};function eFe(t,n,i,o,r,s,a,c){cr._updateBoundingVolumes(t,n,r);let l;n.mode===ne.SCENE3D?l=t._boundingSphereWC:n.mode===ne.COLUMBUS_VIEW?l=t._boundingSphereCV:n.mode===ne.SCENE2D&&f(t._boundingSphere2D)?l=t._boundingSphere2D:f(t._boundingSphereMorph)&&(l=t._boundingSphereMorph);let u=n.commandList,d=n.passes;if(d.render||d.pick){let h=t.allowPicking,_=gn.castShadows(t.shadows),y=gn.receiveShadows(t.shadows),p=i.length,C=c?2:1;C*=f(t._depthFailAppearance)?2:1;for(let x=0;x<p;++x){let T=Math.floor(x/C),E=i[x];E.modelMatrix=r,E.boundingVolume=l[T],E.cull=s,E.debugShowBoundingVolume=a,E.castShadows=_,E.receiveShadows=y,h?E.pickId="v_pickColor":E.pickId=void 0,u.push(E)}}}cr.prototype.update=function(t){if(!f(this.geometryInstances)&&this._va.length===0||f(this.geometryInstances)&&Array.isArray(this.geometryInstances)&&this.geometryInstances.length===0||!f(this.appearance)||t.mode!==ne.SCENE3D&&t.scene3DOnly||!t.passes.render&&!t.passes.pick)return;if(f(this._error))throw this._error;if(this._state===Cr.FAILED)return;let n=t.context;if(f(this._batchTable)||FLe(this,n),this._batchTable.attributes.length>0){if(Ut.maximumVertexTextureImageUnits===0)throw new he("Vertex texture fetch support is required to render primitives with per-instance attributes. The maximum number of vertex texture image units must be greater than zero.");this._batchTable.update(t)}if(this._state!==Cr.COMPLETE&&this._state!==Cr.COMBINED&&(this.asynchronous?jLe(this,t):qLe(this,t)),this._state===Cr.COMBINED&&(XLe(this,t),tee(this,t),JLe(this,t)),!this.show||this._state!==Cr.COMPLETE)return;this._batchTableOffsetsUpdated||tee(this,t),this._recomputeBoundingSpheres&&YLe(this,t);let i=this.appearance,o=i.material,r=!1,s=!1;this._appearance!==i?(this._appearance=i,this._material=o,r=!0,s=!0):this._material!==o&&(this._material=o,s=!0);let a=this.depthFailAppearance,c=f(a)?a.material:void 0;this._depthFailAppearance!==a?(this._depthFailAppearance=a,this._depthFailMaterial=c,r=!0,s=!0):this._depthFailMaterial!==c&&(this._depthFailMaterial=c,s=!0);let l=this._appearance.isTranslucent();this._translucent!==l&&(this._translucent=l,r=!0),f(this._material)&&this._material.update(n);let u=i.closed&&l;r&&A(this._createRenderStatesFunction,ZLe)(this,n,i,u),s&&A(this._createShaderProgramFunction,QLe)(this,t,i),(r||s)&&A(this._createCommandsFunction,$Le)(this,i,o,l,u,this._colorCommands,this._pickCommands,t),A(this._updateAndQueueCommandsFunction,eFe)(this,t,this._colorCommands,this._pickCommands,this.modelMatrix,this.cull,this.debugShowBoundingVolume,u)};var tFe=new ae,nFe=new ae;function lee(t,n,i){if(i===en.TOP){let o=ae.clone(t,tFe),r=ae.clone(t,nFe);r.center=m.add(r.center,n,r.center),t=ae.union(o,r,t)}else i===en.ALL&&(t.center=m.add(t.center,n,t.center));return t}function iFe(t,n,i){return function(){let o=t.getBatchedAttribute(n,i),r=t.attributes[i],s=r.componentsPerAttribute,a=J.createTypedArray(r.componentDatatype,s);return f(o.constructor.pack)?o.constructor.pack(o,a,0):a[0]=o,a}}function oFe(t,n,i,o,r){return function(s){let a=ree(s);t.setBatchedAttribute(n,i,a),r==="offset"&&(o._recomputeBoundingSpheres=!0,o._batchTableOffsetsUpdated=!1)}}var rFe=new m;function sFe(t,n,i){n.boundingSphere={get:function(){let o=t._instanceBoundingSpheres[i];if(f(o)){o=o.clone();let r=t.modelMatrix,s=n.offset;f(s)&&lee(o,m.fromArray(s.get(),0,rFe),t._offsetInstanceExtend[i]),f(r)&&(o=ae.transform(o,r))}return o}},n.boundingSphereCV={get:function(){return t._instanceBoundingSpheresCV[i]}}}function aFe(t,n,i){n.pickId={get:function(){return t._pickIds[i]}}}cr.prototype.getGeometryInstanceAttributes=function(t){let n=-1,i=this._lastPerInstanceAttributeIndex,o=this._instanceIds,r=o.length;for(let u=0;u<r;++u){let d=(i+u)%r;if(t===o[d]){n=d;break}}if(n===-1)return;let s=this._perInstanceAttributeCache[n];if(f(s))return s;let a=this._batchTable,c=this._batchTableAttributeIndices;s={};let l={};for(let u in c)if(c.hasOwnProperty(u)){let d=c[u];l[u]={get:iFe(a,n,d),set:oFe(a,n,d,this,u)}}return sFe(this,l,n),aFe(this,l,n),Object.defineProperties(s,l),this._lastPerInstanceAttributeIndex=n,this._perInstanceAttributeCache[n]=s,s};cr.prototype.isDestroyed=function(){return!1};cr.prototype.destroy=function(){let t,n;this._sp=this._sp&&this._sp.destroy(),this._spDepthFail=this._spDepthFail&&this._spDepthFail.destroy();let i=this._va;for(t=i.length,n=0;n<t;++n)i[n].destroy();this._va=void 0;let o=this._pickIds;for(t=o.length,n=0;n<t;++n)o[n].destroy();return this._pickIds=void 0,this._batchTable=this._batchTable&&this._batchTable.destroy(),this._instanceIds=void 0,this._perInstanceAttributeCache=void 0,this._attributeLocations=void 0,ue(this)};function bS(t,n,i,o){t._completeLoad(n,i,o)}var Sn=cr;function cFe(t){t=A(t,A.EMPTY_OBJECT),this.componentDatatype=t.componentDatatype,this.componentsPerAttribute=t.componentsPerAttribute,this.normalize=A(t.normalize,!1),this.value=t.value}var uc=cFe;var SS=`#ifdef GL_EXT_frag_depth
#extension GL_EXT_frag_depth : enable
#endif
#ifdef TEXTURE_COORDINATES
#ifdef SPHERICAL
varying vec4 v_sphericalExtents;
#else // SPHERICAL
varying vec2 v_inversePlaneExtents;
varying vec4 v_westPlane;
varying vec4 v_southPlane;
#endif // SPHERICAL
varying vec3 v_uvMinAndSphericalLongitudeRotation;
varying vec3 v_uMaxAndInverseDistance;
varying vec3 v_vMaxAndInverseDistance;
#endif // TEXTURE_COORDINATES
#ifdef PER_INSTANCE_COLOR
varying vec4 v_color;
#endif
#ifdef NORMAL_EC
vec3 getEyeCoordinate3FromWindowCoordinate(vec2 fragCoord, float logDepthOrDepth) {
vec4 eyeCoordinate = czm_windowToEyeCoordinates(fragCoord, logDepthOrDepth);
return eyeCoordinate.xyz / eyeCoordinate.w;
}
vec3 vectorFromOffset(vec4 eyeCoordinate, vec2 positiveOffset) {
vec2 glFragCoordXY = gl_FragCoord.xy;
float upOrRightLogDepth = czm_unpackDepth(texture2D(czm_globeDepthTexture, (glFragCoordXY + positiveOffset) / czm_viewport.zw));
float downOrLeftLogDepth = czm_unpackDepth(texture2D(czm_globeDepthTexture, (glFragCoordXY - positiveOffset) / czm_viewport.zw));
bvec2 upOrRightInBounds = lessThan(glFragCoordXY + positiveOffset, czm_viewport.zw);
float useUpOrRight = float(upOrRightLogDepth > 0.0 && upOrRightInBounds.x && upOrRightInBounds.y);
float useDownOrLeft = float(useUpOrRight == 0.0);
vec3 upOrRightEC = getEyeCoordinate3FromWindowCoordinate(glFragCoordXY + positiveOffset, upOrRightLogDepth);
vec3 downOrLeftEC = getEyeCoordinate3FromWindowCoordinate(glFragCoordXY - positiveOffset, downOrLeftLogDepth);
return (upOrRightEC - (eyeCoordinate.xyz / eyeCoordinate.w)) * useUpOrRight + ((eyeCoordinate.xyz / eyeCoordinate.w) - downOrLeftEC) * useDownOrLeft;
}
#endif // NORMAL_EC
void main(void)
{
#ifdef REQUIRES_EC
float logDepthOrDepth = czm_unpackDepth(texture2D(czm_globeDepthTexture, gl_FragCoord.xy / czm_viewport.zw));
vec4 eyeCoordinate = czm_windowToEyeCoordinates(gl_FragCoord.xy, logDepthOrDepth);
#endif
#ifdef REQUIRES_WC
vec4 worldCoordinate4 = czm_inverseView * eyeCoordinate;
vec3 worldCoordinate = worldCoordinate4.xyz / worldCoordinate4.w;
#endif
#ifdef TEXTURE_COORDINATES
vec2 uv;
#ifdef SPHERICAL
vec2 sphericalLatLong = czm_approximateSphericalCoordinates(worldCoordinate);
sphericalLatLong.y += v_uvMinAndSphericalLongitudeRotation.z;
sphericalLatLong.y = czm_branchFreeTernary(sphericalLatLong.y < czm_pi, sphericalLatLong.y, sphericalLatLong.y - czm_twoPi);
uv.x = (sphericalLatLong.y - v_sphericalExtents.y) * v_sphericalExtents.w;
uv.y = (sphericalLatLong.x - v_sphericalExtents.x) * v_sphericalExtents.z;
#else // SPHERICAL
uv.x = czm_planeDistance(v_westPlane, eyeCoordinate.xyz / eyeCoordinate.w) * v_inversePlaneExtents.x;
uv.y = czm_planeDistance(v_southPlane, eyeCoordinate.xyz / eyeCoordinate.w) * v_inversePlaneExtents.y;
#endif // SPHERICAL
#endif // TEXTURE_COORDINATES
#ifdef PICK
#ifdef CULL_FRAGMENTS
if (0.0 <= uv.x && uv.x <= 1.0 && 0.0 <= uv.y && uv.y <= 1.0 || logDepthOrDepth != 0.0) {
gl_FragColor.a = 1.0;
czm_writeDepthClamp();
}
#else // CULL_FRAGMENTS
gl_FragColor.a = 1.0;
#endif // CULL_FRAGMENTS
#else // PICK
#ifdef CULL_FRAGMENTS
if (uv.x <= 0.0 || 1.0 <= uv.x || uv.y <= 0.0 || 1.0 <= uv.y || logDepthOrDepth == 0.0) {
discard;
}
#endif
#ifdef NORMAL_EC
vec3 downUp = vectorFromOffset(eyeCoordinate, vec2(0.0, 1.0));
vec3 leftRight = vectorFromOffset(eyeCoordinate, vec2(1.0, 0.0));
vec3 normalEC = normalize(cross(leftRight, downUp));
#endif
#ifdef PER_INSTANCE_COLOR
vec4 color = czm_gammaCorrect(v_color);
#ifdef FLAT
gl_FragColor = color;
#else // FLAT
czm_materialInput materialInput;
materialInput.normalEC = normalEC;
materialInput.positionToEyeEC = -eyeCoordinate.xyz;
czm_material material = czm_getDefaultMaterial(materialInput);
material.diffuse = color.rgb;
material.alpha = color.a;
gl_FragColor = czm_phong(normalize(-eyeCoordinate.xyz), material, czm_lightDirectionEC);
#endif // FLAT
gl_FragColor.rgb *= gl_FragColor.a;
#else // PER_INSTANCE_COLOR
czm_materialInput materialInput;
#ifdef USES_NORMAL_EC
materialInput.normalEC = normalEC;
#endif
#ifdef USES_POSITION_TO_EYE_EC
materialInput.positionToEyeEC = -eyeCoordinate.xyz;
#endif
#ifdef USES_TANGENT_TO_EYE
materialInput.tangentToEyeMatrix = czm_eastNorthUpToEyeCoordinates(worldCoordinate, normalEC);
#endif
#ifdef USES_ST
materialInput.st.x = czm_lineDistance(v_uvMinAndSphericalLongitudeRotation.xy, v_uMaxAndInverseDistance.xy, uv) * v_uMaxAndInverseDistance.z;
materialInput.st.y = czm_lineDistance(v_uvMinAndSphericalLongitudeRotation.xy, v_vMaxAndInverseDistance.xy, uv) * v_vMaxAndInverseDistance.z;
#endif
czm_material material = czm_getMaterial(materialInput);
#ifdef FLAT
gl_FragColor = vec4(material.diffuse + material.emission, material.alpha);
#else // FLAT
gl_FragColor = czm_phong(normalize(-eyeCoordinate.xyz), material, czm_lightDirectionEC);
#endif // FLAT
gl_FragColor.rgb *= gl_FragColor.a;
#endif // PER_INSTANCE_COLOR
czm_writeDepthClamp();
#endif // PICK
}
`;function Cu(t,n,i){this._projectionExtentDefines={eastMostYhighDefine:"",eastMostYlowDefine:"",westMostYhighDefine:"",westMostYlowDefine:""};let o=new vG;o.requiresTextureCoordinates=t,o.requiresEC=!i.flat;let r=new vG;if(r.requiresTextureCoordinates=t,i instanceof tn)o.requiresNormalEC=!i.flat;else{let s=`${i.material.shaderSource}
${i.fragmentShaderSource}`;o.normalEC=s.indexOf("materialInput.normalEC")!==-1||s.indexOf("czm_getDefaultMaterial")!==-1,o.positionToEyeEC=s.indexOf("materialInput.positionToEyeEC")!==-1,o.tangentToEyeMatrix=s.indexOf("materialInput.tangentToEyeMatrix")!==-1,o.st=s.indexOf("materialInput.st")!==-1}this._colorShaderDependencies=o,this._pickShaderDependencies=r,this._appearance=i,this._extentsCulling=t,this._planarExtents=n}Cu.prototype.createFragmentShader=function(t){let n=this._appearance,i=this._colorShaderDependencies,o=[];!t&&!this._planarExtents&&o.push("SPHERICAL"),i.requiresEC&&o.push("REQUIRES_EC"),i.requiresWC&&o.push("REQUIRES_WC"),i.requiresTextureCoordinates&&o.push("TEXTURE_COORDINATES"),this._extentsCulling&&o.push("CULL_FRAGMENTS"),i.requiresNormalEC&&o.push("NORMAL_EC"),n instanceof tn&&o.push("PER_INSTANCE_COLOR"),i.normalEC&&o.push("USES_NORMAL_EC"),i.positionToEyeEC&&o.push("USES_POSITION_TO_EYE_EC"),i.tangentToEyeMatrix&&o.push("USES_TANGENT_TO_EYE"),i.st&&o.push("USES_ST"),n.flat&&o.push("FLAT");let r="";return n instanceof tn||(r=n.material.shaderSource),new ze({defines:o,sources:[r,SS]})};Cu.prototype.createPickFragmentShader=function(t){let n=this._pickShaderDependencies,i=["PICK"];return!t&&!this._planarExtents&&i.push("SPHERICAL"),n.requiresEC&&i.push("REQUIRES_EC"),n.requiresWC&&i.push("REQUIRES_WC"),n.requiresTextureCoordinates&&i.push("TEXTURE_COORDINATES"),this._extentsCulling&&i.push("CULL_FRAGMENTS"),new ze({defines:i,sources:[SS],pickColorQualifier:"varying"})};Cu.prototype.createVertexShader=function(t,n,i,o){return gee(this._colorShaderDependencies,this._planarExtents,i,t,n,this._appearance,o,this._projectionExtentDefines)};Cu.prototype.createPickVertexShader=function(t,n,i,o){return gee(this._pickShaderDependencies,this._planarExtents,i,t,n,void 0,o,this._projectionExtentDefines)};var uee=new m,fee=new de,dee={high:0,low:0};function gee(t,n,i,o,r,s,a,c){let l=o.slice();if(c.eastMostYhighDefine===""){let u=fee;u.longitude=B.PI,u.latitude=0,u.height=0;let d=a.project(u,uee),h=Hn.encode(d.x,dee);c.eastMostYhighDefine=`EAST_MOST_X_HIGH ${h.high.toFixed(`${h.high}`.length+1)}`,c.eastMostYlowDefine=`EAST_MOST_X_LOW ${h.low.toFixed(`${h.low}`.length+1)}`;let _=fee;_.longitude=-B.PI,_.latitude=0,_.height=0;let y=a.project(_,uee);h=Hn.encode(y.x,dee),c.westMostYhighDefine=`WEST_MOST_X_HIGH ${h.high.toFixed(`${h.high}`.length+1)}`,c.westMostYlowDefine=`WEST_MOST_X_LOW ${h.low.toFixed(`${h.low}`.length+1)}`}return i&&(l.push(c.eastMostYhighDefine),l.push(c.eastMostYlowDefine),l.push(c.westMostYhighDefine),l.push(c.westMostYlowDefine)),f(s)&&s instanceof tn&&l.push("PER_INSTANCE_COLOR"),t.requiresTextureCoordinates&&(l.push("TEXTURE_COORDINATES"),n||i||l.push("SPHERICAL"),i&&l.push("COLUMBUS_VIEW_2D")),new ze({defines:l,sources:[r]})}function vG(){this._requiresEC=!1,this._requiresWC=!1,this._requiresNormalEC=!1,this._requiresTextureCoordinates=!1,this._usesNormalEC=!1,this._usesPositionToEyeEC=!1,this._usesTangentToEyeMat=!1,this._usesSt=!1}Object.defineProperties(vG.prototype,{requiresEC:{get:function(){return this._requiresEC},set:function(t){this._requiresEC=t||this._requiresEC}},requiresWC:{get:function(){return this._requiresWC},set:function(t){this._requiresWC=t||this._requiresWC,this.requiresEC=this._requiresWC}},requiresNormalEC:{get:function(){return this._requiresNormalEC},set:function(t){this._requiresNormalEC=t||this._requiresNormalEC,this.requiresEC=this._requiresNormalEC}},requiresTextureCoordinates:{get:function(){return this._requiresTextureCoordinates},set:function(t){this._requiresTextureCoordinates=t||this._requiresTextureCoordinates,this.requiresWC=this._requiresTextureCoordinates}},normalEC:{set:function(t){this.requiresNormalEC=t,this._usesNormalEC=t},get:function(){return this._usesNormalEC}},tangentToEyeMatrix:{set:function(t){this.requiresWC=t,this.requiresNormalEC=t,this._usesTangentToEyeMat=t},get:function(){return this._usesTangentToEyeMat}},positionToEyeEC:{set:function(t){this.requiresEC=t,this._usesPositionToEyeEC=t},get:function(){return this._usesPositionToEyeEC}},st:{set:function(t){this.requiresTextureCoordinates=t,this._usesSt=t},get:function(){return this._usesSt}}});function hee(t,n,i){return Math.abs((n.y-t.y)*i.x-(n.x-t.x)*i.y+n.x*t.y-n.y*t.x)/W.distance(n,t)}var lFe=[new W,new W,new W,new W];function yee(t,n){let i=lFe,o=W.unpack(n,0,i[0]),r=W.unpack(n,2,i[1]),s=W.unpack(n,4,i[2]);t.uMaxVmax=new uc({componentDatatype:J.FLOAT,componentsPerAttribute:4,normalize:!1,value:[r.x,r.y,s.x,s.y]});let a=1/hee(o,r,s),c=1/hee(o,s,r);t.uvMinAndExtents=new uc({componentDatatype:J.FLOAT,componentsPerAttribute:4,normalize:!1,value:[o.x,o.y,a,c]})}var Aee=new de,Cee=new m,uFe=new m,fFe=new m,lL={high:0,low:0};function xee(t,n,i){let o=Aee;o.height=0,o.longitude=t.west,o.latitude=t.south;let r=n.project(o,Cee);o.latitude=t.north;let s=n.project(o,uFe);o.longitude=t.east,o.latitude=t.south;let a=n.project(o,fFe),c=[0,0,0,0],l=[0,0,0,0],u=Hn.encode(r.x,lL);c[0]=u.high,l[0]=u.low,u=Hn.encode(r.y,lL),c[1]=u.high,l[1]=u.low,u=Hn.encode(s.y,lL),c[2]=u.high,l[2]=u.low,u=Hn.encode(a.x,lL),c[3]=u.high,l[3]=u.low,i.planes2D_HIGH=new uc({componentDatatype:J.FLOAT,componentsPerAttribute:4,normalize:!1,value:c}),i.planes2D_LOW=new uc({componentDatatype:J.FLOAT,componentsPerAttribute:4,normalize:!1,value:l})}var dFe=new N,hFe=new N,mee=new m,mFe=new de,pFe=[new de,new de,new de,new de,new de,new de,new de,new de];function _Fe(t,n,i,o,r,s){let a=le.center(t,mFe);a.height=i;let c=de.toCartesian(a,n,mee),l=vt.eastNorthUpToFixedFrame(c,n,dFe),u=N.inverse(l,hFe),d=t.west,h=t.east,_=t.north,y=t.south,p=pFe;p[0].latitude=y,p[0].longitude=d,p[1].latitude=_,p[1].longitude=d,p[2].latitude=_,p[2].longitude=h,p[3].latitude=y,p[3].longitude=h;let C=(d+h)*.5,x=(_+y)*.5;p[4].latitude=y,p[4].longitude=C,p[5].latitude=_,p[5].longitude=C,p[6].latitude=x,p[6].longitude=d,p[7].latitude=x,p[7].longitude=h;let T=Number.POSITIVE_INFINITY,E=Number.NEGATIVE_INFINITY,S=Number.POSITIVE_INFINITY,w=Number.NEGATIVE_INFINITY;for(let M=0;M<8;M++){p[M].height=i;let L=de.toCartesian(p[M],n,mee);N.multiplyByPoint(u,L,L),L.z=0,T=Math.min(T,L.x),E=Math.max(E,L.x),S=Math.min(S,L.y),w=Math.max(w,L.y)}let D=o;D.x=T,D.y=S,D.z=0,N.multiplyByPoint(l,D,D);let I=r;I.x=E,I.y=S,I.z=0,N.multiplyByPoint(l,I,I),m.subtract(I,D,r);let O=s;O.x=T,O.y=w,O.z=0,N.multiplyByPoint(l,O,O),m.subtract(O,D,s)}var gFe=new m,yFe=new m,AFe=new Hn;Cu.getPlanarTextureCoordinateAttributes=function(t,n,i,o,r){let s=Cee,a=gFe,c=yFe;_Fe(t,i,A(r,0),s,a,c);let l={};yee(l,n);let u=Hn.fromCartesian(s,AFe);return l.southWest_HIGH=new uc({componentDatatype:J.FLOAT,componentsPerAttribute:3,normalize:!1,value:m.pack(u.high,[0,0,0])}),l.southWest_LOW=new uc({componentDatatype:J.FLOAT,componentsPerAttribute:3,normalize:!1,value:m.pack(u.low,[0,0,0])}),l.eastward=new uc({componentDatatype:J.FLOAT,componentsPerAttribute:3,normalize:!1,value:m.pack(a,[0,0,0])}),l.northward=new uc({componentDatatype:J.FLOAT,componentsPerAttribute:3,normalize:!1,value:m.pack(c,[0,0,0])}),xee(t,o,l),l};var CFe=new m;function pee(t,n,i,o){let r=Aee;r.latitude=t,r.longitude=n,r.height=0;let s=de.toCartesian(r,i,CFe),a=Math.sqrt(s.x*s.x+s.y*s.y),c=B.fastApproximateAtan2(a,s.z),l=B.fastApproximateAtan2(s.x,s.y);return o.x=c,o.y=l,o}var _ee=new W;Cu.getSphericalExtentGeometryInstanceAttributes=function(t,n,i,o){let r=pee(t.south,t.west,i,_ee),s=r.x,a=r.y,c=pee(t.north,t.east,i,_ee),l=c.x,u=c.y,d=0;a>u&&(d=B.PI-a,a=-B.PI,u+=d),s-=B.EPSILON5,a-=B.EPSILON5,l+=B.EPSILON5,u+=B.EPSILON5;let h=1/(u-a),_=1/(l-s),y={sphericalExtents:new uc({componentDatatype:J.FLOAT,componentsPerAttribute:4,normalize:!1,value:[s,a,_,h]}),longitudeRotation:new uc({componentDatatype:J.FLOAT,componentsPerAttribute:1,normalize:!1,value:[d]})};return yee(y,n),xee(t,o,y),y};Cu.hasAttributesForTextureCoordinatePlanes=function(t){return f(t.southWest_HIGH)&&f(t.southWest_LOW)&&f(t.northward)&&f(t.eastward)&&f(t.planes2D_HIGH)&&f(t.planes2D_LOW)&&f(t.uMaxVmax)&&f(t.uvMinAndExtents)};Cu.hasAttributesForSphericalExtents=function(t){return f(t.sphericalExtents)&&f(t.longitudeRotation)&&f(t.planes2D_HIGH)&&f(t.planes2D_LOW)&&f(t.uMaxVmax)&&f(t.uvMinAndExtents)};function xFe(t){return Math.max(t.width,t.height)>Cu.MAX_WIDTH_FOR_PLANAR_EXTENTS}Cu.shouldUseSphericalCoordinates=function(t){return xFe(t)};Cu.MAX_WIDTH_FOR_PLANAR_EXTENTS=B.toRadians(1);var xu=Cu;function K0(t){t=A(t,A.EMPTY_OBJECT);let n=t.geometryInstances;this.geometryInstances=n,this.show=A(t.show,!0),this.classificationType=A(t.classificationType,Un.BOTH),this.debugShowBoundingVolume=A(t.debugShowBoundingVolume,!1),this.debugShowShadowVolume=A(t.debugShowShadowVolume,!1),this._debugShowShadowVolume=!1,this._extruded=A(t._extruded,!1),this._uniformMap=t._uniformMap,this._sp=void 0,this._spStencil=void 0,this._spPick=void 0,this._spColor=void 0,this._spPick2D=void 0,this._spColor2D=void 0,this._rsStencilDepthPass=void 0,this._rsStencilDepthPass3DTiles=void 0,this._rsColorPass=void 0,this._rsPickPass=void 0,this._commandsIgnoreShow=[],this._ready=!1;let i=this;this._readyPromise=new Promise((o,r)=>{i._completeLoad=()=>{if(this._ready)return;this._ready=!0,this.releaseGeometryInstances&&(this.geometryInstances=void 0);let s=this._error;f(s)?r(s):o(this)}}),this._primitive=void 0,this._pickPrimitive=t._pickPrimitive,this._hasSphericalExtentsAttribute=!1,this._hasPlanarExtentsAttributes=!1,this._hasPerColorAttribute=!1,this.appearance=t.appearance,this._createBoundingVolumeFunction=t._createBoundingVolumeFunction,this._updateAndQueueCommandsFunction=t._updateAndQueueCommandsFunction,this._usePickOffsets=!1,this._primitiveOptions={geometryInstances:void 0,appearance:void 0,vertexCacheOptimize:A(t.vertexCacheOptimize,!1),interleave:A(t.interleave,!1),releaseGeometryInstances:A(t.releaseGeometryInstances,!0),allowPicking:A(t.allowPicking,!0),asynchronous:A(t.asynchronous,!0),compressVertices:A(t.compressVertices,!0),_createBoundingVolumeFunction:void 0,_createRenderStatesFunction:void 0,_createShaderProgramFunction:void 0,_createCommandsFunction:void 0,_updateAndQueueCommandsFunction:void 0,_createPickOffsets:!0}}Object.defineProperties(K0.prototype,{vertexCacheOptimize:{get:function(){return this._primitiveOptions.vertexCacheOptimize}},interleave:{get:function(){return this._primitiveOptions.interleave}},releaseGeometryInstances:{get:function(){return this._primitiveOptions.releaseGeometryInstances}},allowPicking:{get:function(){return this._primitiveOptions.allowPicking}},asynchronous:{get:function(){return this._primitiveOptions.asynchronous}},compressVertices:{get:function(){return this._primitiveOptions.compressVertices}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise}},_needs2DShader:{get:function(){return this._hasPlanarExtentsAttributes||this._hasSphericalExtentsAttribute}}});K0.isSupported=function(t){return t.context.stencilBuffer};function sx(t,n){let i=n?kn.EQUAL:kn.ALWAYS;return{colorMask:{red:!1,green:!1,blue:!1,alpha:!1},stencilTest:{enabled:t,frontFunction:i,frontOperation:{fail:ft.KEEP,zFail:ft.DECREMENT_WRAP,zPass:ft.KEEP},backFunction:i,backOperation:{fail:ft.KEEP,zFail:ft.INCREMENT_WRAP,zPass:ft.KEEP},reference:Ot.CESIUM_3D_TILE_MASK,mask:Ot.CESIUM_3D_TILE_MASK},stencilMask:Ot.CLASSIFICATION_MASK,depthTest:{enabled:!0,func:cc.LESS_OR_EQUAL},depthMask:!1}}function IG(t){return{stencilTest:{enabled:t,frontFunction:kn.NOT_EQUAL,frontOperation:{fail:ft.ZERO,zFail:ft.ZERO,zPass:ft.ZERO},backFunction:kn.NOT_EQUAL,backOperation:{fail:ft.ZERO,zFail:ft.ZERO,zPass:ft.ZERO},reference:0,mask:Ot.CLASSIFICATION_MASK},stencilMask:Ot.CLASSIFICATION_MASK,depthTest:{enabled:!1},depthMask:!1,blending:ln.PRE_MULTIPLIED_ALPHA_BLEND}}var TFe={stencilTest:{enabled:!0,frontFunction:kn.NOT_EQUAL,frontOperation:{fail:ft.ZERO,zFail:ft.ZERO,zPass:ft.ZERO},backFunction:kn.NOT_EQUAL,backOperation:{fail:ft.ZERO,zFail:ft.ZERO,zPass:ft.ZERO},reference:0,mask:Ot.CLASSIFICATION_MASK},stencilMask:Ot.CLASSIFICATION_MASK,depthTest:{enabled:!1},depthMask:!1};function EFe(t,n,i,o){if(f(t._rsStencilDepthPass))return;let r=!t.debugShowShadowVolume;t._rsStencilDepthPass=Ve.fromCache(sx(r,!1)),t._rsStencilDepthPass3DTiles=Ve.fromCache(sx(r,!0)),t._rsColorPass=Ve.fromCache(IG(r,!1)),t._rsPickPass=Ve.fromCache(TFe)}function bFe(t,n){if(!t.compressVertices)return n;if(n.search(/attribute\s+vec3\s+extrudeDirection;/g)!==-1){let i="compressedAttributes",o=`attribute vec2 ${i};`,r=`vec3 extrudeDirection;
`,s=`    extrudeDirection = czm_octDecode(${i}, 65535.0);
`,a=n;a=a.replace(/attribute\s+vec3\s+extrudeDirection;/g,""),a=ze.replaceMain(a,"czm_non_compressed_main");let c=`void main() 
{ 
${s}    czm_non_compressed_main(); 
}`;return[o,r,a,c].join(`
`)}}function SFe(t,n){let i=n.context,o=t._primitive,r=sL;r=t._primitive._batchTable.getVertexShaderCallback()(r),r=Sn._appendDistanceDisplayConditionToShader(o,r),r=Sn._modifyShaderPosition(t,r,n.scene3DOnly),r=Sn._updateColorAttribute(o,r);let s=t._hasPlanarExtentsAttributes,a=s||t._hasSphericalExtentsAttribute;t._extruded&&(r=bFe(o,r));let c=t._extruded?"EXTRUDED_GEOMETRY":"",l=new ze({defines:[c],sources:[r]}),u=new ze({sources:[X0]}),d=t._primitive._attributeLocations,h=new xu(a,s,t.appearance);if(t._spStencil=qt.replaceCache({context:i,shaderProgram:t._spStencil,vertexShaderSource:l,fragmentShaderSource:u,attributeLocations:d}),t._primitive.allowPicking){let p=ze.createPickVertexShaderSource(r);p=Sn._appendShowToShader(o,p),p=Sn._updatePickColorAttribute(p);let C=h.createPickFragmentShader(!1),x=h.createPickVertexShader([c],p,!1,n.mapProjection);if(t._spPick=qt.replaceCache({context:i,shaderProgram:t._spPick,vertexShaderSource:x,fragmentShaderSource:C,attributeLocations:d}),a){let T=i.shaderCache.getDerivedShaderProgram(t._spPick,"2dPick");if(!f(T)){let E=h.createPickFragmentShader(!0),S=h.createPickVertexShader([c],p,!0,n.mapProjection);T=i.shaderCache.createDerivedShaderProgram(t._spPick,"2dPick",{vertexShaderSource:S,fragmentShaderSource:E,attributeLocations:d})}t._spPick2D=T}}else t._spPick=qt.fromCache({context:i,vertexShaderSource:l,fragmentShaderSource:u,attributeLocations:d});r=Sn._appendShowToShader(o,r),l=new ze({defines:[c],sources:[r]}),t._sp=qt.replaceCache({context:i,shaderProgram:t._sp,vertexShaderSource:l,fragmentShaderSource:u,attributeLocations:d});let _=h.createFragmentShader(!1),y=h.createVertexShader([c],r,!1,n.mapProjection);if(t._spColor=qt.replaceCache({context:i,shaderProgram:t._spColor,vertexShaderSource:y,fragmentShaderSource:_,attributeLocations:d}),a){let p=i.shaderCache.getDerivedShaderProgram(t._spColor,"2dColor");if(!f(p)){let C=h.createFragmentShader(!0),x=h.createVertexShader([c],r,!0,n.mapProjection);p=i.shaderCache.createDerivedShaderProgram(t._spColor,"2dColor",{vertexShaderSource:x,fragmentShaderSource:C,attributeLocations:d})}t._spColor2D=p}}function wFe(t,n){let i=t._primitive,o=i._va.length*2;n.length=o;let r,s,a,c=0,l=i._batchTable.getUniformMapCallback()(t._uniformMap),u=t._needs2DShader;for(r=0;r<o;r+=2){let y=i._va[c++];s=n[r],f(s)||(s=n[r]=new et({owner:t,primitiveType:i._primitiveType})),s.vertexArray=y,s.renderState=t._rsStencilDepthPass,s.shaderProgram=t._sp,s.uniformMap=l,s.pass=Te.TERRAIN_CLASSIFICATION,a=et.shallowClone(s,s.derivedCommands.tileset),a.renderState=t._rsStencilDepthPass3DTiles,a.pass=Te.CESIUM_3D_TILE_CLASSIFICATION,s.derivedCommands.tileset=a,s=n[r+1],f(s)||(s=n[r+1]=new et({owner:t,primitiveType:i._primitiveType})),s.vertexArray=y,s.renderState=t._rsColorPass,s.shaderProgram=t._spColor,s.pass=Te.TERRAIN_CLASSIFICATION;let C=t.appearance.material;if(f(C)&&(l=At(l,C._uniforms)),s.uniformMap=l,a=et.shallowClone(s,s.derivedCommands.tileset),a.pass=Te.CESIUM_3D_TILE_CLASSIFICATION,s.derivedCommands.tileset=a,u){let x=et.shallowClone(s,s.derivedCommands.appearance2D);x.shaderProgram=t._spColor2D,s.derivedCommands.appearance2D=x,x=et.shallowClone(a,a.derivedCommands.appearance2D),x.shaderProgram=t._spColor2D,a.derivedCommands.appearance2D=x}}let d=t._commandsIgnoreShow,h=t._spStencil,_=0;o=d.length=o/2;for(let y=0;y<o;++y){let p=d[y]=et.shallowClone(n[_],d[y]);p.shaderProgram=h,p.pass=Te.CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW,_+=2}}function DFe(t,n){let i=t._usePickOffsets,o=t._primitive,r=o._va.length*2,s,a=0,c;i&&(s=o._pickOffsets,r=s.length*2),n.length=r;let l,u,d,h=0,_=o._batchTable.getUniformMapCallback()(t._uniformMap),y=t._needs2DShader;for(l=0;l<r;l+=2){let p=o._va[h++];if(i&&(c=s[a++],p=o._va[c.index]),u=n[l],f(u)||(u=n[l]=new et({owner:t,primitiveType:o._primitiveType,pickOnly:!0})),u.vertexArray=p,u.renderState=t._rsStencilDepthPass,u.shaderProgram=t._sp,u.uniformMap=_,u.pass=Te.TERRAIN_CLASSIFICATION,i&&(u.offset=c.offset,u.count=c.count),d=et.shallowClone(u,u.derivedCommands.tileset),d.renderState=t._rsStencilDepthPass3DTiles,d.pass=Te.CESIUM_3D_TILE_CLASSIFICATION,u.derivedCommands.tileset=d,u=n[l+1],f(u)||(u=n[l+1]=new et({owner:t,primitiveType:o._primitiveType,pickOnly:!0})),u.vertexArray=p,u.renderState=t._rsPickPass,u.shaderProgram=t._spPick,u.uniformMap=_,u.pass=Te.TERRAIN_CLASSIFICATION,i&&(u.offset=c.offset,u.count=c.count),d=et.shallowClone(u,u.derivedCommands.tileset),d.pass=Te.CESIUM_3D_TILE_CLASSIFICATION,u.derivedCommands.tileset=d,y){let C=et.shallowClone(u,u.derivedCommands.pick2D);C.shaderProgram=t._spPick2D,u.derivedCommands.pick2D=C,C=et.shallowClone(d,d.derivedCommands.pick2D),C.shaderProgram=t._spPick2D,d.derivedCommands.pick2D=C}}}function vFe(t,n,i,o,r,s,a){wFe(t,s),DFe(t,a)}function Tee(t,n){return Math.floor(t%n/2)}function PG(t,n,i,o,r,s){t.modelMatrix=i,t.boundingVolume=r,t.cull=o,t.debugShowBoundingVolume=s,n.commandList.push(t)}function Eee(t,n,i,o,r){t.modelMatrix=i,t.boundingVolume=r,t.cull=o,n.commandList.push(t)}function PFe(t,n,i,o,r,s,a,c){let l=t._primitive;Sn._updateBoundingVolumes(l,n,r);let u;n.mode===ne.SCENE3D?u=l._boundingSphereWC:n.mode===ne.COLUMBUS_VIEW?u=l._boundingSphereCV:n.mode===ne.SCENE2D&&f(l._boundingSphere2D)?u=l._boundingSphere2D:f(l._boundingSphereMorph)&&(u=l._boundingSphereMorph);let d=t.classificationType,h=d!==Un.CESIUM_3D_TILE,_=d!==Un.TERRAIN,y=n.passes,p,C,x;if(y.render){let T=i.length;for(p=0;p<T;++p)C=u[Tee(p,T)],h&&(x=i[p],PG(x,n,r,s,C,a)),_&&(x=i[p].derivedCommands.tileset,PG(x,n,r,s,C,a));if(n.invertClassification){let E=t._commandsIgnoreShow,S=E.length;for(p=0;p<S;++p)C=u[p],x=E[p],PG(x,n,r,s,C,a)}}if(y.pick){let T=o.length,E=l._pickOffsets;for(p=0;p<T;++p){let S=E[Tee(p,T)];C=u[S.index],h&&(x=o[p],Eee(x,n,r,s,C)),_&&(x=o[p].derivedCommands.tileset,Eee(x,n,r,s,C))}}}K0.prototype.update=function(t){if(!f(this._primitive)&&!f(this.geometryInstances))return;let n=this.appearance;f(n)&&f(n.material)&&n.material.update(t.context);let i=this,o=this._primitiveOptions;if(!f(this._primitive)){let r=Array.isArray(this.geometryInstances)?this.geometryInstances:[this.geometryInstances],s=r.length,a,c,l,u=!1,d=!0,h,_=!1,y=!1;for(s>0&&(l=r[0].attributes,_=xu.hasAttributesForSphericalExtents(l),y=xu.hasAttributesForTextureCoordinatePlanes(l),h=l.color),a=0;a<s;a++){c=r[a];let C=c.attributes.color;f(C)&&(u=!0),d=d&&f(C)&&Lt.equals(h,C)}if(!d&&!_&&!y)throw new Ce("All GeometryInstances must have the same color attribute except via GroundPrimitives");u&&!f(n)&&(n=new tn({flat:!0}),this.appearance=n),this._usePickOffsets=!_&&!y,this._hasSphericalExtentsAttribute=_,this._hasPlanarExtentsAttributes=y,this._hasPerColorAttribute=u;let p=new Array(s);for(a=0;a<s;++a)c=r[a],p[a]=new Ct({geometry:c.geometry,attributes:c.attributes,modelMatrix:c.modelMatrix,id:c.id,pickPrimitive:A(this._pickPrimitive,i)});o.appearance=n,o.geometryInstances=p,f(this._createBoundingVolumeFunction)&&(o._createBoundingVolumeFunction=function(C,x){i._createBoundingVolumeFunction(C,x)}),o._createRenderStatesFunction=function(C,x,T,E){EFe(i,x)},o._createShaderProgramFunction=function(C,x,T){SFe(i,x)},o._createCommandsFunction=function(C,x,T,E,S,w,D){vFe(i,void 0,void 0,!0,!1,w,D)},f(this._updateAndQueueCommandsFunction)?o._updateAndQueueCommandsFunction=function(C,x,T,E,S,w,D,I){i._updateAndQueueCommandsFunction(C,x,T,E,S,w,D,I)}:o._updateAndQueueCommandsFunction=function(C,x,T,E,S,w,D,I){PFe(i,x,T,E,S,w,D,I)},this._primitive=new Sn(o)}this.debugShowShadowVolume&&!this._debugShowShadowVolume&&this._ready?(this._debugShowShadowVolume=!0,this._rsStencilDepthPass=Ve.fromCache(sx(!1,!1)),this._rsStencilDepthPass3DTiles=Ve.fromCache(sx(!1,!0)),this._rsColorPass=Ve.fromCache(IG(!1))):!this.debugShowShadowVolume&&this._debugShowShadowVolume&&(this._debugShowShadowVolume=!1,this._rsStencilDepthPass=Ve.fromCache(sx(!0,!1)),this._rsStencilDepthPass3DTiles=Ve.fromCache(sx(!0,!0)),this._rsColorPass=Ve.fromCache(IG(!0))),this._primitive.appearance!==n&&(this._primitive.appearance=n),this._primitive.show=this.show,this._primitive.debugShowBoundingVolume=this.debugShowBoundingVolume,this._primitive.update(t),t.afterRender.push(()=>{f(this._primitive)&&this._primitive.ready&&this._completeLoad()})};K0.prototype.getGeometryInstanceAttributes=function(t){return this._primitive.getGeometryInstanceAttributes(t)};K0.prototype.isDestroyed=function(){return!1};K0.prototype.destroy=function(){return this._primitive=this._primitive&&this._primitive.destroy(),this._sp=this._sp&&this._sp.destroy(),this._spPick=this._spPick&&this._spPick.destroy(),this._spColor=this._spColor&&this._spColor.destroy(),this._spPick2D=void 0,this._spColor2D=void 0,ue(this)};var wS=K0;var IFe={u_globeMinimumAltitude:function(){return 55e3}};function Xc(t){t=A(t,A.EMPTY_OBJECT);let n=t.appearance,i=t.geometryInstances;if(!f(n)&&f(i)){let s=Array.isArray(i)?i:[i],a=s.length;for(let c=0;c<a;c++){let l=s[c].attributes;if(f(l)&&f(l.color)){n=new tn({flat:!0});break}}}this.appearance=n,this.geometryInstances=t.geometryInstances,this.show=A(t.show,!0),this.classificationType=A(t.classificationType,Un.BOTH),this.debugShowBoundingVolume=A(t.debugShowBoundingVolume,!1),this.debugShowShadowVolume=A(t.debugShowShadowVolume,!1),this._boundingVolumes=[],this._boundingVolumes2D=[],this._ready=!1;let o=this;this._readyPromise=new Promise((s,a)=>{o._completeLoad=()=>{if(this._ready)return;this._ready=!0,this.releaseGeometryInstances&&(this.geometryInstances=void 0);let c=this._error;f(c)?a(c):s(this)}}),this._primitive=void 0,this._maxHeight=void 0,this._minHeight=void 0,this._maxTerrainHeight=ri._defaultMaxTerrainHeight,this._minTerrainHeight=ri._defaultMinTerrainHeight,this._boundingSpheresKeys=[],this._boundingSpheres=[],this._useFragmentCulling=!1,this._zIndex=void 0;let r=this;this._classificationPrimitiveOptions={geometryInstances:void 0,appearance:void 0,vertexCacheOptimize:A(t.vertexCacheOptimize,!1),interleave:A(t.interleave,!1),releaseGeometryInstances:A(t.releaseGeometryInstances,!0),allowPicking:A(t.allowPicking,!0),asynchronous:A(t.asynchronous,!0),compressVertices:A(t.compressVertices,!0),_createBoundingVolumeFunction:void 0,_updateAndQueueCommandsFunction:void 0,_pickPrimitive:r,_extruded:!0,_uniformMap:IFe}}Object.defineProperties(Xc.prototype,{vertexCacheOptimize:{get:function(){return this._classificationPrimitiveOptions.vertexCacheOptimize}},interleave:{get:function(){return this._classificationPrimitiveOptions.interleave}},releaseGeometryInstances:{get:function(){return this._classificationPrimitiveOptions.releaseGeometryInstances}},allowPicking:{get:function(){return this._classificationPrimitiveOptions.allowPicking}},asynchronous:{get:function(){return this._classificationPrimitiveOptions.asynchronous}},compressVertices:{get:function(){return this._classificationPrimitiveOptions.compressVertices}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise}}});Xc.isSupported=wS.isSupported;function bee(t){return function(n,i){let o=i.maximumRadius,r=o/Math.cos(n*.5)-o;return t._maxHeight+r}}function See(t){return function(n,i){return t._minHeight}}var BFe=new m,OFe=new m,RFe=new m,MFe=new de,LFe=new le;function uL(t,n){let i=t.mapProjection.ellipsoid;if(!f(n.attributes)||!f(n.attributes.position3DHigh))return f(n.rectangle)?n.rectangle:void 0;let o=n.attributes.position3DHigh.values,r=n.attributes.position3DLow.values,s=o.length,a=Number.POSITIVE_INFINITY,c=Number.POSITIVE_INFINITY,l=Number.NEGATIVE_INFINITY,u=Number.NEGATIVE_INFINITY;for(let h=0;h<s;h+=3){let _=m.unpack(o,h,BFe),y=m.unpack(r,h,OFe),p=m.add(_,y,RFe),C=i.cartesianToCartographic(p,MFe),x=C.latitude,T=C.longitude;a=Math.min(a,x),c=Math.min(c,T),l=Math.max(l,x),u=Math.max(u,T)}let d=LFe;return d.north=l,d.south=a,d.east=u,d.west=c,d}function FFe(t,n,i){let o=ri.getMinimumMaximumHeights(n,i);t._minTerrainHeight=o.minimumTerrainHeight,t._maxTerrainHeight=o.maximumTerrainHeight}function NFe(t,n,i){let o=n.mapProjection.ellipsoid,r=uL(n,i),s=_i.fromRectangle(r,t._minHeight,t._maxHeight,o);if(t._boundingVolumes.push(s),!n.scene3DOnly){let a=n.mapProjection,c=ae.fromRectangleWithHeights2D(r,a,t._maxHeight,t._minHeight);m.fromElements(c.center.z,c.center.x,c.center.y,c.center),t._boundingVolumes2D.push(c)}}function BG(t,n){return Math.floor(t%n/2)}function OG(t,n,i,o,r,s,a){let c=t._primitive;i.mode!==ne.SCENE3D&&n.shaderProgram===c._spColor&&c._needs2DShader&&(n=n.derivedCommands.appearance2D),n.owner=t,n.modelMatrix=o,n.boundingVolume=s,n.cull=r,n.debugShowBoundingVolume=a,i.commandList.push(n)}function wee(t,n,i,o,r,s){let a=t._primitive;i.mode!==ne.SCENE3D&&n.shaderProgram===a._spPick&&a._needs2DShader&&(n=n.derivedCommands.pick2D),n.owner=t,n.modelMatrix=o,n.boundingVolume=s,n.cull=r,i.commandList.push(n)}function VFe(t,n,i,o,r,s,a,c){let l;n.mode===ne.SCENE3D?l=t._boundingVolumes:l=t._boundingVolumes2D;let u=t.classificationType,d=u!==Un.CESIUM_3D_TILE,h=u!==Un.TERRAIN,_=n.passes,y=t._primitive,p,C,x;if(_.render){let T=i.length;for(p=0;p<T;++p)C=l[BG(p,T)],d&&(x=i[p],OG(t,x,n,r,s,C,a)),h&&(x=i[p].derivedCommands.tileset,OG(t,x,n,r,s,C,a));if(n.invertClassification){let E=y._commandsIgnoreShow,S=E.length;for(p=0;p<S;++p)C=l[p],x=E[p],OG(t,x,n,r,s,C,a)}}if(_.pick){let T=o.length,E;for(t._useFragmentCulling||(E=y._primitive._pickOffsets),p=0;p<T;++p){if(C=l[BG(p,T)],!t._useFragmentCulling){let S=E[BG(p,T)];C=l[S.index]}d&&(x=o[p],wee(t,x,n,r,s,C)),h&&(x=o[p].derivedCommands.tileset,wee(t,x,n,r,s,C))}}}Xc.initializeTerrainHeights=function(){return ri.initialize()};Xc.prototype.update=function(t){if(!f(this._primitive)&&!f(this.geometryInstances))return;if(!ri.initialized){Xc.initializeTerrainHeights();return}let n=this,i=this._classificationPrimitiveOptions;if(!f(this._primitive)){let o=t.mapProjection.ellipsoid,r,s,a,c=Array.isArray(this.geometryInstances)?this.geometryInstances:[this.geometryInstances],l=c.length,u=new Array(l),d,h;for(d=0;d<l;++d){r=c[d],s=r.geometry;let C=uL(t,s);f(h)?f(C)&&le.union(h,C,h):h=le.clone(C);let x=r.id;if(f(x)&&f(C)){let T=ri.getBoundingSphere(C,o);this._boundingSpheresKeys.push(x),this._boundingSpheres.push(T)}a=s.constructor,!f(a)||f(a.createShadowVolume)}FFe(this,h,o);let _=t.terrainExaggeration,y=t.terrainExaggerationRelativeHeight;this._minHeight=kc.getHeight(this._minTerrainHeight,_,y),this._maxHeight=kc.getHeight(this._maxTerrainHeight,_,y);let p=Xc._supportsMaterials(t.context);if(this._useFragmentCulling=p,p){let C,x=!0;for(d=0;d<l;++d)if(r=c[d],s=r.geometry,h=uL(t,s),xu.shouldUseSphericalCoordinates(h)){x=!1;break}for(d=0;d<l;++d){r=c[d],s=r.geometry,a=s.constructor;let T=uL(t,s),E=s.textureCoordinateRotationPoints;x?C=xu.getPlanarTextureCoordinateAttributes(T,E,o,t.mapProjection,this._maxHeight):C=xu.getSphericalExtentGeometryInstanceAttributes(T,E,o,t.mapProjection);let S=r.attributes;for(let w in S)S.hasOwnProperty(w)&&(C[w]=S[w]);u[d]=new Ct({geometry:a.createShadowVolume(s,See(this),bee(this)),attributes:C,id:r.id})}}else for(d=0;d<l;++d)r=c[d],s=r.geometry,a=s.constructor,u[d]=new Ct({geometry:a.createShadowVolume(s,See(this),bee(this)),attributes:r.attributes,id:r.id});i.geometryInstances=u,i.appearance=this.appearance,i._createBoundingVolumeFunction=function(C,x){NFe(n,C,x)},i._updateAndQueueCommandsFunction=function(C,x,T,E,S,w,D,I){VFe(n,x,T,E,S,w,D,I)},this._primitive=new wS(i)}this._primitive.appearance=this.appearance,this._primitive.show=this.show,this._primitive.debugShowShadowVolume=this.debugShowShadowVolume,this._primitive.debugShowBoundingVolume=this.debugShowBoundingVolume,this._primitive.update(t),t.afterRender.push(()=>{f(this._primitive)&&this._primitive.ready&&this._completeLoad()})};Xc.prototype.getBoundingSphere=function(t){let n=this._boundingSpheresKeys.indexOf(t);if(n!==-1)return this._boundingSpheres[n]};Xc.prototype.getGeometryInstanceAttributes=function(t){return this._primitive.getGeometryInstanceAttributes(t)};Xc.prototype.isDestroyed=function(){return!1};Xc.prototype.destroy=function(){return this._primitive=this._primitive&&this._primitive.destroy(),ue(this)};Xc._supportsMaterials=function(t){return t.depthTexture};Xc.supportsMaterials=function(t){return Xc._supportsMaterials(t.frameState.context)};var Kc=Xc;function ax(){Ce.throwInstantiationError()}Object.defineProperties(ax.prototype,{isConstant:{get:Ce.throwInstantiationError},definitionChanged:{get:Ce.throwInstantiationError}});ax.prototype.getType=Ce.throwInstantiationError;ax.prototype.getValue=Ce.throwInstantiationError;ax.prototype.equals=Ce.throwInstantiationError;ax.getValue=function(t,n,i){let o;return f(n)&&(o=n.getType(t),f(o))?((!f(i)||i.type!==o)&&(i=$i.fromType(o)),n.getValue(t,i.uniforms),i):((!f(i)||i.type!==$i.ColorType)&&(i=$i.fromType($i.ColorType)),z.clone(z.WHITE,i.uniforms.color),i)};var Zo=ax;function J0(t,n,i){this._primitives=n,this._orderedGroundPrimitives=i,this._primitive=void 0,this._outlinePrimitive=void 0,this._geometryUpdater=t,this._options=t._options,this._entity=t._entity,this._material=void 0}J0.prototype._isHidden=function(t,n,i){return!t.isShowing||!t.isAvailable(i)||!q.getValueOrDefault(n.show,i,!0)};J0.prototype._setOptions=Ce.throwInstantiationError;J0.prototype.update=function(t){let n=this._geometryUpdater,i=n._onTerrain,o=this._entity,r=o[this._geometryUpdater._geometryPropertyName];if((this._geometryUpdater._geometryPropertyName==="polygon"||this._geometryUpdater._geometryPropertyName==="rectangle"||this._geometryUpdater._geometryPropertyName==="ellipse"||this._geometryUpdater._geometryPropertyName==="wall")&&r.isDynamic===!1)return;let s=this._primitives,a=this._orderedGroundPrimitives;if(i?a.remove(this._primitive):(s.removeAndDestroy(this._primitive),s.removeAndDestroy(this._outlinePrimitive),this._outlinePrimitive=void 0),this._primitive=void 0,this._setOptions(o,r,t),this._isHidden(o,r,t))return;let c=this._geometryUpdater.shadowsProperty.getValue(t),l=this._options;if(!f(r.fill)||r.fill.getValue(t)){let u=n.fillMaterialProperty,d=u instanceof Rt,h,_=n._getIsClosed(l);if(d)h=new tn({closed:_,flat:i&&!n._supportsMaterialsforEntitiesOnTerrain});else{let y=Zo.getValue(t,u,this._material);this._material=y,h=new ro({material:y,translucent:y.isTranslucent(),closed:_})}if(i)l.vertexFormat=tn.VERTEX_FORMAT,this._primitive=a.add(new Kc({geometryInstances:this._geometryUpdater.createFillGeometryInstance(t),appearance:h,asynchronous:!1,shadows:c,classificationType:this._geometryUpdater.classificationTypeProperty.getValue(t)}),q.getValueOrUndefined(this._geometryUpdater.zIndex,t));else{l.vertexFormat=h.vertexFormat;let y=this._geometryUpdater.createFillGeometryInstance(t);d&&(h.translucent=y.attributes.color.value[3]!==255),this._primitive=s.add(new Sn({geometryInstances:y,appearance:h,asynchronous:!1,shadows:c}))}}if(!i&&f(r.outline)&&r.outline.getValue(t)){let u=this._geometryUpdater.createOutlineGeometryInstance(t),d=q.getValueOrDefault(r.outlineWidth,t,1);this._outlinePrimitive=s.add(new Sn({geometryInstances:u,appearance:new tn({flat:!0,translucent:u.attributes.color.value[3]!==255,renderState:{lineWidth:n._scene.clampLineWidth(d)}}),asynchronous:!1,shadows:c}))}};J0.prototype.getBoundingSphere=function(t){let n=this._entity,i=this._primitive,o=this._outlinePrimitive,r;return f(i)&&i.show&&i.ready&&(r=i.getGeometryInstanceAttributes(n),f(r)&&f(r.boundingSphere))?(ae.clone(r.boundingSphere,t),rt.DONE):f(o)&&o.show&&o.ready&&(r=o.getGeometryInstanceAttributes(n),f(r)&&f(r.boundingSphere))?(ae.clone(r.boundingSphere,t),rt.DONE):f(i)&&!i.ready||f(o)&&!o.ready?rt.PENDING:rt.FAILED};J0.prototype.isDestroyed=function(){return!1};J0.prototype.destroy=function(){let t=this._primitives,n=this._orderedGroundPrimitives;this._geometryUpdater._onTerrain?n.remove(this._primitive):t.removeAndDestroy(this._primitive),t.removeAndDestroy(this._outlinePrimitive),ue(this)};var ei=J0;var kFe={NONE:0,GEODESIC:1,RHUMB:2},Zt=Object.freeze(kFe);var Dee=B.EPSILON10;function UFe(t,n,i,o){if(!f(t))return;i=A(i,!1);let r=f(o),s=t.length;if(s<2)return t;let a,c=t[0],l,u,d=0,h=-1;for(a=1;a<s;++a)l=t[a],n(c,l,Dee)?(f(u)||(u=t.slice(0,a),d=a-1,h=0),r&&o.push(a)):(f(u)&&(u.push(l),d=a,r&&(h=o.length)),c=l);return i&&n(t[0],t[s-1],Dee)&&(r&&(f(u)?o.splice(h,0,d):o.push(s-1)),f(u)?u.length-=1:u=t.slice(0,-1)),f(u)?u:t}var Co=UFe;function zFe(t){let n=t._uSquared,i=t._ellipsoid.maximumRadius,o=t._ellipsoid.minimumRadius,r=(i-o)/i,s=Math.cos(t._startHeading),a=Math.sin(t._startHeading),c=(1-r)*Math.tan(t._start.latitude),l=1/Math.sqrt(1+c*c),u=l*c,d=Math.atan2(c,s),h=l*a,_=h*h,y=1-_,p=Math.sqrt(y),C=n/4,x=C*C,T=x*C,E=x*x,S=1+C-3*x/4+5*T/4-175*E/64,w=1-C+15*x/8-35*T/8,D=1-3*C+35*x/4,I=1-5*C,O=S*d-w*Math.sin(2*d)*C/2-D*Math.sin(4*d)*x/16-I*Math.sin(6*d)*T/48-Math.sin(8*d)*5*E/512,M=t._constants;M.a=i,M.b=o,M.f=r,M.cosineHeading=s,M.sineHeading=a,M.tanU=c,M.cosineU=l,M.sineU=u,M.sigma=d,M.sineAlpha=h,M.sineSquaredAlpha=_,M.cosineSquaredAlpha=y,M.cosineAlpha=p,M.u2Over4=C,M.u4Over16=x,M.u6Over64=T,M.u8Over256=E,M.a0=S,M.a1=w,M.a2=D,M.a3=I,M.distanceRatio=O}function HFe(t,n){return t*n*(4+t*(4-3*n))/16}function vee(t,n,i,o,r,s,a){let c=HFe(t,i);return(1-c)*t*n*(o+c*r*(a+c*s*(2*a*a-1)))}function GFe(t,n,i,o,r,s,a){let c=(n-i)/n,l=s-o,u=Math.atan((1-c)*Math.tan(r)),d=Math.atan((1-c)*Math.tan(a)),h=Math.cos(u),_=Math.sin(u),y=Math.cos(d),p=Math.sin(d),C=h*y,x=h*p,T=_*p,E=_*y,S=l,w=B.TWO_PI,D=Math.cos(S),I=Math.sin(S),O,M,L,F,g;do{D=Math.cos(S),I=Math.sin(S);let k=x-E*D;L=Math.sqrt(y*y*I*I+k*k),M=T+C*D,O=Math.atan2(L,M);let X;L===0?(X=0,F=1):(X=C*I/L,F=1-X*X),w=S,g=M-2*T/F,isFinite(g)||(g=0),S=l+vee(c,X,F,O,L,M,g)}while(Math.abs(S-w)>B.EPSILON12);let b=F*(n*n-i*i)/(i*i),v=1+b*(4096+b*(b*(320-175*b)-768))/16384,P=b*(256+b*(b*(74-47*b)-128))/1024,R=g*g,V=P*L*(g+P*(M*(2*R-1)-P*g*(4*L*L-3)*(4*R-3)/6)/4),H=i*v*(O-V),U=Math.atan2(y*I,x-E*D),G=Math.atan2(h*I,x*D-E);t._distance=H,t._startHeading=U,t._endHeading=G,t._uSquared=b}var WFe=new m,RG=new m;function Pee(t,n,i,o){let r=m.normalize(o.cartographicToCartesian(n,RG),WFe),s=m.normalize(o.cartographicToCartesian(i,RG),RG);GFe(t,o.maximumRadius,o.minimumRadius,n.longitude,n.latitude,i.longitude,i.latitude),t._start=de.clone(n,t._start),t._end=de.clone(i,t._end),t._start.height=0,t._end.height=0,zFe(t)}function DS(t,n,i){let o=A(i,oe.WGS84);this._ellipsoid=o,this._start=new de,this._end=new de,this._constants={},this._startHeading=void 0,this._endHeading=void 0,this._distance=void 0,this._uSquared=void 0,f(t)&&f(n)&&Pee(this,t,n,o)}Object.defineProperties(DS.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},surfaceDistance:{get:function(){return this._distance}},start:{get:function(){return this._start}},end:{get:function(){return this._end}},startHeading:{get:function(){return this._startHeading}},endHeading:{get:function(){return this._endHeading}}});DS.prototype.setEndPoints=function(t,n){Pee(this,t,n,this._ellipsoid)};DS.prototype.interpolateUsingFraction=function(t,n){return this.interpolateUsingSurfaceDistance(this._distance*t,n)};DS.prototype.interpolateUsingSurfaceDistance=function(t,n){let i=this._constants,o=i.distanceRatio+t/i.b,r=Math.cos(2*o),s=Math.cos(4*o),a=Math.cos(6*o),c=Math.sin(2*o),l=Math.sin(4*o),u=Math.sin(6*o),d=Math.sin(8*o),h=o*o,_=o*h,y=i.u8Over256,p=i.u2Over4,C=i.u6Over64,x=i.u4Over16,T=2*_*y*r/3+o*(1-p+7*x/4-15*C/4+579*y/64-(x-15*C/4+187*y/16)*r-(5*C/4-115*y/16)*s-29*y*a/16)+(p/2-x+71*C/32-85*y/16)*c+(5*x/16-5*C/4+383*y/96)*l-h*((C-11*y/2)*c+5*y*l/2)+(29*C/96-29*y/16)*u+539*y*d/1536,E=Math.asin(Math.sin(T)*i.cosineAlpha),S=Math.atan(i.a/i.b*Math.tan(E));T=T-i.sigma;let w=Math.cos(2*i.sigma+T),D=Math.sin(T),I=Math.cos(T),O=i.cosineU*I,M=i.sineU*D,F=Math.atan2(D*i.sineHeading,O-M*i.cosineHeading)-vee(i.f,i.sineAlpha,i.cosineSquaredAlpha,T,D,I,w);return f(n)?(n.longitude=this._start.longitude+F,n.latitude=S,n.height=0,n):new de(this._start.longitude+F,S,0)};var Of=DS;function LG(t,n,i){if(t===0)return n*i;let o=t*t,r=o*o,s=r*o,a=s*o,c=a*o,l=c*o,u=i,d=Math.sin(2*u),h=Math.sin(4*u),_=Math.sin(6*u),y=Math.sin(8*u),p=Math.sin(10*u),C=Math.sin(12*u);return n*((1-o/4-3*r/64-5*s/256-175*a/16384-441*c/65536-4851*l/1048576)*u-(3*o/8+3*r/32+45*s/1024+105*a/4096+2205*c/131072+6237*l/524288)*d+(15*r/256+45*s/1024+525*a/16384+1575*c/65536+155925*l/8388608)*h-(35*s/3072+175*a/12288+3675*c/262144+13475*l/1048576)*_+(315*a/131072+2205*c/524288+43659*l/8388608)*y-(693*c/1310720+6237*l/5242880)*p+1001*l/8388608*C)}function jFe(t,n,i){let o=t/i;if(n===0)return o;let r=o*o,s=r*o,a=s*o,c=n,l=c*c,u=l*l,d=u*l,h=d*l,_=h*l,y=_*l,p=Math.sin(2*o),C=Math.cos(2*o),x=Math.sin(4*o),T=Math.cos(4*o),E=Math.sin(6*o),S=Math.cos(6*o),w=Math.sin(8*o),D=Math.cos(8*o),I=Math.sin(10*o),O=Math.cos(10*o),M=Math.sin(12*o);return o+o*l/4+7*o*u/64+15*o*d/256+579*o*h/16384+1515*o*_/65536+16837*o*y/1048576+(3*o*u/16+45*o*d/256-o*(32*r-561)*h/4096-o*(232*r-1677)*_/16384+o*(399985-90560*r+512*a)*y/5242880)*C+(21*o*d/256+483*o*h/4096-o*(224*r-1969)*_/16384-o*(33152*r-112599)*y/1048576)*T+(151*o*h/4096+4681*o*_/65536+1479*o*y/16384-453*s*y/32768)*S+(1097*o*_/65536+42783*o*y/1048576)*D+8011*o*y/1048576*O+(3*l/8+3*u/16+213*d/2048-3*r*d/64+255*h/4096-33*r*h/512+20861*_/524288-33*r*_/512+a*_/1024+28273*y/1048576-471*r*y/8192+9*a*y/4096)*p+(21*u/256+21*d/256+533*h/8192-21*r*h/512+197*_/4096-315*r*_/4096+584039*y/16777216-12517*r*y/131072+7*a*y/2048)*x+(151*d/6144+151*h/4096+5019*_/131072-453*r*_/16384+26965*y/786432-8607*r*y/131072)*E+(1097*h/131072+1097*_/65536+225797*y/10485760-1097*r*y/65536)*w+(8011*_/2621440+8011*y/1048576)*I+293393*y/251658240*M}function cx(t,n){if(t===0)return Math.log(Math.tan(.5*(B.PI_OVER_TWO+n)));let i=t*Math.sin(n);return Math.log(Math.tan(.5*(B.PI_OVER_TWO+n)))-t/2*Math.log((1+i)/(1-i))}function qFe(t,n,i,o,r){let s=cx(t._ellipticity,i),a=cx(t._ellipticity,r);return Math.atan2(B.negativePiToPi(o-n),a-s)}function YFe(t,n,i,o,r,s,a){let c=t._heading,l=s-o,u=0;if(B.equalsEpsilon(Math.abs(c),B.PI_OVER_TWO,B.EPSILON8))if(n===i)u=n*Math.cos(r)*B.negativePiToPi(l);else{let d=Math.sin(r);u=n*Math.cos(r)*B.negativePiToPi(l)/Math.sqrt(1-t._ellipticitySquared*d*d)}else{let d=LG(t._ellipticity,n,r);u=(LG(t._ellipticity,n,a)-d)/Math.cos(c)}return Math.abs(u)}var XFe=new m,MG=new m;function Iee(t,n,i,o){let r=m.normalize(o.cartographicToCartesian(n,MG),XFe),s=m.normalize(o.cartographicToCartesian(i,MG),MG),a=o.maximumRadius,c=o.minimumRadius,l=a*a,u=c*c;t._ellipticitySquared=(l-u)/l,t._ellipticity=Math.sqrt(t._ellipticitySquared),t._start=de.clone(n,t._start),t._start.height=0,t._end=de.clone(i,t._end),t._end.height=0,t._heading=qFe(t,n.longitude,n.latitude,i.longitude,i.latitude),t._distance=YFe(t,o.maximumRadius,o.minimumRadius,n.longitude,n.latitude,i.longitude,i.latitude)}function Bee(t,n,i,o,r,s){if(i===0)return de.clone(t,s);let a=r*r,c,l,u;if(Math.abs(B.PI_OVER_TWO-Math.abs(n))>B.EPSILON8){let d=LG(r,o,t.latitude),h=i*Math.cos(n),_=d+h;l=jFe(_,r,o);let y=cx(r,t.latitude),p=cx(r,l);u=Math.tan(n)*(p-y),c=B.negativePiToPi(t.longitude+u)}else{l=t.latitude;let d;if(r===0)d=o*Math.cos(t.latitude);else{let h=Math.sin(t.latitude);d=o*Math.cos(t.latitude)/Math.sqrt(1-a*h*h)}u=i/d,n>0?c=B.negativePiToPi(t.longitude+u):c=B.negativePiToPi(t.longitude-u)}return f(s)?(s.longitude=c,s.latitude=l,s.height=0,s):new de(c,l,0)}function Bm(t,n,i){let o=A(i,oe.WGS84);this._ellipsoid=o,this._start=new de,this._end=new de,this._heading=void 0,this._distance=void 0,this._ellipticity=void 0,this._ellipticitySquared=void 0,f(t)&&f(n)&&Iee(this,t,n,o)}Object.defineProperties(Bm.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},surfaceDistance:{get:function(){return this._distance}},start:{get:function(){return this._start}},end:{get:function(){return this._end}},heading:{get:function(){return this._heading}}});Bm.fromStartHeadingDistance=function(t,n,i,o,r){let s=A(o,oe.WGS84),a=s.maximumRadius,c=s.minimumRadius,l=a*a,u=c*c,d=Math.sqrt((l-u)/l);n=B.negativePiToPi(n);let h=Bee(t,n,i,s.maximumRadius,d);return!f(r)||f(o)&&!o.equals(r.ellipsoid)?new Bm(t,h,s):(r.setEndPoints(t,h),r)};Bm.prototype.setEndPoints=function(t,n){Iee(this,t,n,this._ellipsoid)};Bm.prototype.interpolateUsingFraction=function(t,n){return this.interpolateUsingSurfaceDistance(t*this._distance,n)};Bm.prototype.interpolateUsingSurfaceDistance=function(t,n){return Bee(this._start,this._heading,t,this._ellipsoid.maximumRadius,this._ellipticity,n)};Bm.prototype.findIntersectionWithLongitude=function(t,n){let i=this._ellipticity,o=this._heading,r=Math.abs(o),s=this._start;if(t=B.negativePiToPi(t),B.equalsEpsilon(Math.abs(t),Math.PI,B.EPSILON14)&&(t=B.sign(s.longitude)*Math.PI),f(n)||(n=new de),Math.abs(B.PI_OVER_TWO-r)<=B.EPSILON8)return n.longitude=t,n.latitude=s.latitude,n.height=0,n;if(B.equalsEpsilon(Math.abs(B.PI_OVER_TWO-r),B.PI_OVER_TWO,B.EPSILON8))return B.equalsEpsilon(t,s.longitude,B.EPSILON12)?void 0:(n.longitude=t,n.latitude=B.PI_OVER_TWO*B.sign(B.PI_OVER_TWO-o),n.height=0,n);let a=s.latitude,c=i*Math.sin(a),l=Math.tan(.5*(B.PI_OVER_TWO+a))*Math.exp((t-s.longitude)/Math.tan(o)),u=(1+c)/(1-c),d=s.latitude,h;do{h=d;let _=i*Math.sin(h),y=(1+_)/(1-_);d=2*Math.atan(l*Math.pow(y/u,i/2))-B.PI_OVER_TWO}while(!B.equalsEpsilon(d,h,B.EPSILON12));return n.longitude=t,n.latitude=d,n.height=0,n};Bm.prototype.findIntersectionWithLatitude=function(t,n){let i=this._ellipticity,o=this._heading,r=this._start;if(B.equalsEpsilon(Math.abs(o),B.PI_OVER_TWO,B.EPSILON8))return;let s=cx(i,r.latitude),a=cx(i,t),c=Math.tan(o)*(a-s),l=B.negativePiToPi(r.longitude+c);return f(n)?(n.longitude=l,n.latitude=t,n.height=0,n):new de(l,t,0)};var Ia=Bm;var GG=[Ci,bi],KFe=GG.length,Zee=Math.cos(B.toRadians(30)),Oee=Math.cos(B.toRadians(150)),Qee=0,$ee=1e3;function __(t){t=A(t,A.EMPTY_OBJECT);let n=t.positions;this.width=A(t.width,1),this._positions=n,this.granularity=A(t.granularity,9999),this.loop=A(t.loop,!1),this.arcType=A(t.arcType,Zt.GEODESIC),this._ellipsoid=oe.WGS84,this._projectionIndex=0,this._workerName="createGroundPolylineGeometry",this._scene3DOnly=!1}Object.defineProperties(__.prototype,{packedLength:{get:function(){return 1+this._positions.length*3+1+1+1+oe.packedLength+1+1}}});__.setProjectionAndEllipsoid=function(t,n){let i=0;for(let o=0;o<KFe;o++)if(n instanceof GG[o]){i=o;break}t._projectionIndex=i,t._ellipsoid=n.ellipsoid};var JFe=new m,Ree=new m,Mee=new m;function HG(t,n,i,o,r){let s=fc(o,t,0,JFe),a=fc(o,t,i,Ree),c=fc(o,n,0,Mee),l=Om(a,s,Ree),u=Om(c,s,Mee);return m.cross(u,l,r),m.normalize(r,r)}var ZFe=new de,QFe=new m,$Fe=new m,eNe=new m;function FG(t,n,i,o,r,s,a,c,l,u,d){if(r===0)return;let h;s===Zt.GEODESIC?h=new Of(t,n,a):s===Zt.RHUMB&&(h=new Ia(t,n,a));let _=h.surfaceDistance;if(_<r)return;let y=HG(t,n,o,a,eNe),p=Math.ceil(_/r),C=_/p,x=C,T=p-1,E=c.length;for(let S=0;S<T;S++){let w=h.interpolateUsingSurfaceDistance(x,ZFe),D=fc(a,w,i,QFe),I=fc(a,w,o,$Fe);m.pack(y,c,E),m.pack(D,l,E),m.pack(I,u,E),d.push(w.latitude),d.push(w.longitude),E+=3,x+=C}}var NG=new de;function fc(t,n,i,o){return de.clone(n,NG),NG.height=i,de.toCartesian(NG,t,o)}__.pack=function(t,n,i){let o=A(i,0),r=t._positions,s=r.length;n[o++]=s;for(let a=0;a<s;++a){let c=r[a];m.pack(c,n,o),o+=3}return n[o++]=t.granularity,n[o++]=t.loop?1:0,n[o++]=t.arcType,oe.pack(t._ellipsoid,n,o),o+=oe.packedLength,n[o++]=t._projectionIndex,n[o++]=t._scene3DOnly?1:0,n};__.unpack=function(t,n,i){let o=A(n,0),r=t[o++],s=new Array(r);for(let _=0;_<r;_++)s[_]=m.unpack(t,o),o+=3;let a=t[o++],c=t[o++]===1,l=t[o++],u=oe.unpack(t,o);o+=oe.packedLength;let d=t[o++],h=t[o++]===1;return f(i)||(i=new __({positions:s})),i._positions=s,i.granularity=a,i.loop=c,i.arcType=l,i._ellipsoid=u,i._projectionIndex=d,i._scene3DOnly=h,i};function Om(t,n,i){return m.subtract(t,n,i),m.normalize(i,i),i}function Lee(t,n,i,o){return o=Om(t,n,o),o=m.cross(o,i,o),o=m.normalize(o,o),o=m.cross(i,o,o),o}var tNe=new m,nNe=new m,iNe=new m,ete=new m,oNe=0,rNe=-1;function VG(t,n,i,o,r){let s=Om(i,n,ete),a=Lee(t,n,s,tNe),c=Lee(o,n,s,nNe);if(B.equalsEpsilon(m.dot(a,c),rNe,B.EPSILON5))return r=m.cross(s,a,r),r=m.normalize(r,r),r;r=m.add(c,a,r),r=m.normalize(r,r);let l=m.cross(s,r,iNe);return m.dot(c,l)<oNe&&(r=m.negate(r,r)),r}var mL=rn.fromPointNormal(m.ZERO,m.UNIT_Y),sNe=new m,aNe=new m,cNe=new m,lNe=new m,uNe=new m,fL=new m,dL=new de,Fee=new de,Nee=new de;__.createGeometry=function(t){let n=!t._scene3DOnly,i=t.loop,o=t._ellipsoid,r=t.granularity,s=t.arcType,a=new GG[t._projectionIndex](o),c=Qee,l=$ee,u,d,h=t._positions,_=h.length;_===2&&(i=!1);let y,p,C,x,T=new Ia(void 0,void 0,o),E,S,w,D=[h[0]];for(d=0;d<_-1;d++)y=h[d],p=h[d+1],E=ji.lineSegmentPlane(y,p,mL,fL),f(E)&&!m.equalsEpsilon(E,y,B.EPSILON7)&&!m.equalsEpsilon(E,p,B.EPSILON7)&&(t.arcType===Zt.GEODESIC?D.push(m.clone(E)):t.arcType===Zt.RHUMB&&(w=o.cartesianToCartographic(E,dL).longitude,C=o.cartesianToCartographic(y,dL),x=o.cartesianToCartographic(p,Fee),T.setEndPoints(C,x),S=T.findIntersectionWithLongitude(w,Nee),E=o.cartographicToCartesian(S,fL),f(E)&&!m.equalsEpsilon(E,y,B.EPSILON7)&&!m.equalsEpsilon(E,p,B.EPSILON7)&&D.push(m.clone(E)))),D.push(p);i&&(y=h[_-1],p=h[0],E=ji.lineSegmentPlane(y,p,mL,fL),f(E)&&!m.equalsEpsilon(E,y,B.EPSILON7)&&!m.equalsEpsilon(E,p,B.EPSILON7)&&(t.arcType===Zt.GEODESIC?D.push(m.clone(E)):t.arcType===Zt.RHUMB&&(w=o.cartesianToCartographic(E,dL).longitude,C=o.cartesianToCartographic(y,dL),x=o.cartesianToCartographic(p,Fee),T.setEndPoints(C,x),S=T.findIntersectionWithLongitude(w,Nee),E=o.cartographicToCartesian(S,fL),f(E)&&!m.equalsEpsilon(E,y,B.EPSILON7)&&!m.equalsEpsilon(E,p,B.EPSILON7)&&D.push(m.clone(E)))));let I=D.length,O=new Array(I);for(d=0;d<I;d++){let Y=de.fromCartesian(D[d],o);Y.height=0,O[d]=Y}if(O=Co(O,de.equalsEpsilon),I=O.length,I<2)return;let M=[],L=[],F=[],g=[],b=sNe,v=aNe,P=cNe,R=lNe,V=uNe,H=O[0],U=O[1],G=O[I-1];for(b=fc(o,G,c,b),R=fc(o,U,c,R),v=fc(o,H,c,v),P=fc(o,H,l,P),i?V=VG(b,v,P,R,V):V=HG(H,U,l,o,V),m.pack(V,L,0),m.pack(v,F,0),m.pack(P,g,0),M.push(H.latitude),M.push(H.longitude),FG(H,U,c,l,r,s,o,L,F,g,M),d=1;d<I-1;++d){b=m.clone(v,b),v=m.clone(R,v);let Y=O[d];fc(o,Y,l,P),fc(o,O[d+1],c,R),VG(b,v,P,R,V),u=L.length,m.pack(V,L,u),m.pack(v,F,u),m.pack(P,g,u),M.push(Y.latitude),M.push(Y.longitude),FG(O[d],O[d+1],c,l,r,s,o,L,F,g,M)}let k=O[I-1],X=O[I-2];if(v=fc(o,k,c,v),P=fc(o,k,l,P),i){let Y=O[0];b=fc(o,X,c,b),R=fc(o,Y,c,R),V=VG(b,v,P,R,V)}else V=HG(X,k,l,o,V);if(u=L.length,m.pack(V,L,u),m.pack(v,F,u),m.pack(P,g,u),M.push(k.latitude),M.push(k.longitude),i){for(FG(k,H,c,l,r,s,o,L,F,g,M),u=L.length,d=0;d<3;++d)L[u+d]=L[d],F[u+d]=F[d],g[u+d]=g[d];M.push(H.latitude),M.push(H.longitude)}return FNe(i,a,F,g,L,M,n)};var fNe=new m,dNe=new $,hNe=new Me;function Vee(t,n,i,o){let r=Om(i,n,fNe),s=m.dot(r,t);if(s>Zee||s<Oee){let a=Om(o,i,ete),c=s<Oee?B.PI_OVER_TWO:-B.PI_OVER_TWO,l=Me.fromAxisAngle(a,c,hNe),u=$.fromQuaternion(l,dNe);return $.multiplyByVector(u,t,t),!0}return!1}var kee=new de,mNe=new m,Uee=new m;function vS(t,n,i,o,r){let s=de.toCartesian(n,t._ellipsoid,mNe),a=m.add(s,i,Uee),c=!1,l=t._ellipsoid,u=l.cartesianToCartographic(a,kee);Math.abs(n.longitude-u.longitude)>B.PI_OVER_TWO&&(c=!0,a=m.subtract(s,i,Uee),u=l.cartesianToCartographic(a,kee)),u.height=0;let d=t.project(u,r);return r=m.subtract(d,o,r),r.z=0,r=m.normalize(r,r),c&&m.negate(r,r),r}var pNe=new m,zee=new m;function Hee(t,n,i,o,r,s){let a=m.subtract(n,t,pNe);m.normalize(a,a);let c=i-Qee,l=m.multiplyByScalar(a,c,zee);m.add(t,l,r);let u=o-$ee;l=m.multiplyByScalar(a,u,zee),m.add(n,l,s)}var _Ne=new m;function hL(t,n){let i=rn.getPointDistance(mL,t),o=rn.getPointDistance(mL,n),r=_Ne;B.equalsEpsilon(i,0,B.EPSILON2)?(r=Om(n,t,r),m.multiplyByScalar(r,B.EPSILON2,r),m.add(t,r,t)):B.equalsEpsilon(o,0,B.EPSILON2)&&(r=Om(t,n,r),m.multiplyByScalar(r,B.EPSILON2,r),m.add(n,r,n))}function gNe(t,n){let i=Math.abs(t.longitude),o=Math.abs(n.longitude);if(B.equalsEpsilon(i,B.PI,B.EPSILON11)){let r=B.sign(n.longitude);return t.longitude=r*(i-B.EPSILON11),1}else if(B.equalsEpsilon(o,B.PI,B.EPSILON11)){let r=B.sign(t.longitude);return n.longitude=r*(o-B.EPSILON11),2}return 0}var tte=new de,nte=new de,Gee=new m,kG=new m,Wee=new m,jee=new m,yNe=new m,qee=new m,ANe=[tte,nte],CNe=new le,xNe=new m,TNe=new m,ENe=new m,bNe=new m,SNe=new m,wNe=new m,UG=new m,zG=new m,DNe=new m,vNe=new m,PNe=new m,Yee=new m,INe=new m,BNe=new m,ONe=new Hn,RNe=new Hn,Xee=new m,MNe=new m,Kee=new m,LNe=[new ae,new ae],ite=[0,2,1,0,3,2,0,7,3,0,4,7,0,5,4,0,1,5,5,7,4,5,6,7,5,2,6,5,1,2,3,6,2,3,7,6],Jee=ite.length;function FNe(t,n,i,o,r,s,a){let c,l,u=n._ellipsoid,d=i.length/3-1,h=d*8,_=h*4,y=d*36,p=h>65535?new Uint32Array(y):new Uint16Array(y),C=new Float64Array(h*3),x=new Float32Array(_),T=new Float32Array(_),E=new Float32Array(_),S=new Float32Array(_),w=new Float32Array(_),D,I,O,M;a&&(D=new Float32Array(_),I=new Float32Array(_),O=new Float32Array(_),M=new Float32Array(h*2));let L=s.length/2,F=0,g=tte;g.height=0;let b=nte;b.height=0;let v=Gee,P=kG;if(a)for(l=0,c=1;c<L;c++)g.latitude=s[l],g.longitude=s[l+1],b.latitude=s[l+2],b.longitude=s[l+3],v=n.project(g,v),P=n.project(b,P),F+=m.distance(v,P),l+=2;let R=o.length/3;P=m.unpack(o,0,P);let V=0;for(l=3,c=1;c<R;c++)v=m.clone(P,v),P=m.unpack(o,l,P),V+=m.distance(v,P),l+=3;let H;l=3;let U=0,G=0,k=0,X=0,Y=!1,K=m.unpack(i,0,jee),j=m.unpack(o,0,kG),Z=m.unpack(r,0,qee);if(t){let Be=m.unpack(i,i.length-6,Wee);Vee(Z,Be,K,j)&&(Z=m.negate(Z,Z))}let Q=0,me=0,_e=0;for(c=0;c<d;c++){let Be=m.clone(K,Wee),ke=m.clone(j,Gee),qe=m.clone(Z,yNe);Y&&(qe=m.negate(qe,qe)),K=m.unpack(i,l,jee),j=m.unpack(o,l,kG),Z=m.unpack(r,l,qee),Y=Vee(Z,Be,K,j),g.latitude=s[U],g.longitude=s[U+1],b.latitude=s[U+2],b.longitude=s[U+3];let Nt,Wt,un,_t;if(a){let Ri=gNe(g,b);Nt=n.project(g,SNe),Wt=n.project(b,wNe);let hr=Om(Wt,Nt,Xee);hr.y=Math.abs(hr.y),un=UG,_t=zG,Ri===0||m.dot(hr,m.UNIT_Y)>Zee?(un=vS(n,g,qe,Nt,UG),_t=vS(n,b,Z,Wt,zG)):Ri===1?(_t=vS(n,b,Z,Wt,zG),un.x=0,un.y=B.sign(g.longitude-Math.abs(b.longitude)),un.z=0):(un=vS(n,g,qe,Nt,UG),_t.x=0,_t.y=B.sign(g.longitude-b.longitude),_t.z=0)}let Rn=m.distance(ke,j),oi=Hn.fromCartesian(Be,ONe),lt=m.subtract(K,Be,DNe),Yt=m.normalize(lt,Yee),si=m.subtract(ke,Be,vNe);si=m.normalize(si,si);let ye=m.cross(Yt,si,Yee);ye=m.normalize(ye,ye);let Oe=m.cross(si,qe,INe);Oe=m.normalize(Oe,Oe);let Ye=m.subtract(j,K,PNe);Ye=m.normalize(Ye,Ye);let Xt=m.cross(Z,Ye,BNe);Xt=m.normalize(Xt,Xt);let En=Rn/V,Vi=Q/V,ki=0,Xi,li,Le,nt=0,Qe=0;if(a){ki=m.distance(Nt,Wt),Xi=Hn.fromCartesian(Nt,RNe),li=m.subtract(Wt,Nt,Xee),Le=m.normalize(li,MNe);let Ri=Le.x;Le.x=Le.y,Le.y=-Ri,nt=ki/F,Qe=me/F}for(H=0;H<8;H++){let Ri=X+H*4,hr=G+H*2,Dr=Ri+3,ru=H<4?1:-1,Ui=H===2||H===3||H===6||H===7?1:-1;m.pack(oi.high,x,Ri),x[Dr]=lt.x,m.pack(oi.low,T,Ri),T[Dr]=lt.y,m.pack(Oe,E,Ri),E[Dr]=lt.z,m.pack(Xt,S,Ri),S[Dr]=En*ru,m.pack(ye,w,Ri);let Ur=Vi*Ui;Ur===0&&Ui<0&&(Ur=9),w[Dr]=Ur,a&&(D[Ri]=Xi.high.x,D[Ri+1]=Xi.high.y,D[Ri+2]=Xi.low.x,D[Ri+3]=Xi.low.y,O[Ri]=-un.y,O[Ri+1]=un.x,O[Ri+2]=_t.y,O[Ri+3]=-_t.x,I[Ri]=li.x,I[Ri+1]=li.y,I[Ri+2]=Le.x,I[Ri+3]=Le.y,M[hr]=nt*ru,Ur=Qe*Ui,Ur===0&&Ui<0&&(Ur=9),M[hr+1]=Ur)}let Xe=ENe,dt=bNe,Mt=xNe,bn=TNe,To=le.fromCartographicArray(ANe,CNe),Go=ri.getMinimumMaximumHeights(To,u),Kr=Go.minimumTerrainHeight,As=Go.maximumTerrainHeight;_e+=Kr,_e+=As,Hee(Be,ke,Kr,As,Xe,Mt),Hee(K,j,Kr,As,dt,bn);let io=m.multiplyByScalar(ye,B.EPSILON5,Kee);m.add(Xe,io,Xe),m.add(dt,io,dt),m.add(Mt,io,Mt),m.add(bn,io,bn),hL(Xe,dt),hL(Mt,bn),m.pack(Xe,C,k),m.pack(dt,C,k+3),m.pack(bn,C,k+6),m.pack(Mt,C,k+9),io=m.multiplyByScalar(ye,-2*B.EPSILON5,Kee),m.add(Xe,io,Xe),m.add(dt,io,dt),m.add(Mt,io,Mt),m.add(bn,io,bn),hL(Xe,dt),hL(Mt,bn),m.pack(Xe,C,k+12),m.pack(dt,C,k+15),m.pack(bn,C,k+18),m.pack(Mt,C,k+21),U+=2,l+=3,G+=16,k+=24,X+=32,Q+=Rn,me+=ki}l=0;let re=0;for(c=0;c<d;c++){for(H=0;H<Jee;H++)p[l+H]=ite[H]+re;re+=8,l+=Jee}let fe=LNe;ae.fromVertices(i,m.ZERO,3,fe[0]),ae.fromVertices(o,m.ZERO,3,fe[1]);let ge=ae.fromBoundingSpheres(fe);ge.radius+=_e/(d*2);let be={position:new we({componentDatatype:J.DOUBLE,componentsPerAttribute:3,normalize:!1,values:C}),startHiAndForwardOffsetX:p_(x),startLoAndForwardOffsetY:p_(T),startNormalAndForwardOffsetZ:p_(E),endNormalAndTextureCoordinateNormalizationX:p_(S),rightNormalAndTextureCoordinateNormalizationY:p_(w)};return a&&(be.startHiLo2D=p_(D),be.offsetAndRight2D=p_(I),be.startEndNormals2D=p_(O),be.texcoordNormalization2D=new we({componentDatatype:J.FLOAT,componentsPerAttribute:2,normalize:!1,values:M})),new at({attributes:be,indices:p,boundingSphere:ge})}function p_(t){return new we({componentDatatype:J.FLOAT,componentsPerAttribute:4,normalize:!1,values:t})}__._projectNormal=vS;var lx=__;var pL=`#ifdef GL_EXT_frag_depth
#extension GL_EXT_frag_depth : enable
#endif
varying vec4 v_startPlaneNormalEcAndHalfWidth;
varying vec4 v_endPlaneNormalEcAndBatchId;
varying vec4 v_rightPlaneEC;
varying vec4 v_endEcAndStartEcX;
varying vec4 v_texcoordNormalizationAndStartEcYZ;
#ifdef PER_INSTANCE_COLOR
varying vec4 v_color;
#endif
void main(void)
{
float logDepthOrDepth = czm_branchFreeTernary(czm_sceneMode == czm_sceneMode2D, gl_FragCoord.z, czm_unpackDepth(texture2D(czm_globeDepthTexture, gl_FragCoord.xy / czm_viewport.zw)));
vec3 ecStart = vec3(v_endEcAndStartEcX.w, v_texcoordNormalizationAndStartEcYZ.zw);
if (logDepthOrDepth == 0.0) {
#ifdef DEBUG_SHOW_VOLUME
gl_FragColor = vec4(1.0, 0.0, 0.0, 0.5);
return;
#else // DEBUG_SHOW_VOLUME
discard;
#endif // DEBUG_SHOW_VOLUME
}
vec4 eyeCoordinate = czm_windowToEyeCoordinates(gl_FragCoord.xy, logDepthOrDepth);
eyeCoordinate /= eyeCoordinate.w;
float halfMaxWidth = v_startPlaneNormalEcAndHalfWidth.w * czm_metersPerPixel(eyeCoordinate);
float widthwiseDistance = czm_planeDistance(v_rightPlaneEC, eyeCoordinate.xyz);
float distanceFromStart = czm_planeDistance(v_startPlaneNormalEcAndHalfWidth.xyz, -dot(ecStart, v_startPlaneNormalEcAndHalfWidth.xyz), eyeCoordinate.xyz);
float distanceFromEnd = czm_planeDistance(v_endPlaneNormalEcAndBatchId.xyz, -dot(v_endEcAndStartEcX.xyz, v_endPlaneNormalEcAndBatchId.xyz), eyeCoordinate.xyz);
if (abs(widthwiseDistance) > halfMaxWidth || distanceFromStart < 0.0 || distanceFromEnd < 0.0) {
#ifdef DEBUG_SHOW_VOLUME
gl_FragColor = vec4(1.0, 0.0, 0.0, 0.5);
return;
#else // DEBUG_SHOW_VOLUME
discard;
#endif // DEBUG_SHOW_VOLUME
}
vec3 alignedPlaneNormal;
alignedPlaneNormal = cross(v_rightPlaneEC.xyz, v_startPlaneNormalEcAndHalfWidth.xyz);
alignedPlaneNormal = normalize(cross(alignedPlaneNormal, v_rightPlaneEC.xyz));
distanceFromStart = czm_planeDistance(alignedPlaneNormal, -dot(alignedPlaneNormal, ecStart), eyeCoordinate.xyz);
alignedPlaneNormal = cross(v_rightPlaneEC.xyz, v_endPlaneNormalEcAndBatchId.xyz);
alignedPlaneNormal = normalize(cross(alignedPlaneNormal, v_rightPlaneEC.xyz));
distanceFromEnd = czm_planeDistance(alignedPlaneNormal, -dot(alignedPlaneNormal, v_endEcAndStartEcX.xyz), eyeCoordinate.xyz);
#ifdef PER_INSTANCE_COLOR
gl_FragColor = czm_gammaCorrect(v_color);
#else // PER_INSTANCE_COLOR
float s = clamp(distanceFromStart / (distanceFromStart + distanceFromEnd), 0.0, 1.0);
s = (s * v_texcoordNormalizationAndStartEcYZ.x) + v_texcoordNormalizationAndStartEcYZ.y;
float t = (widthwiseDistance + halfMaxWidth) / (2.0 * halfMaxWidth);
czm_materialInput materialInput;
materialInput.s = s;
materialInput.st = vec2(s, t);
materialInput.str = vec3(s, t, 0.0);
czm_material material = czm_getMaterial(materialInput);
gl_FragColor = vec4(material.diffuse + material.emission, material.alpha);
#endif // PER_INSTANCE_COLOR
gl_FragColor.rgb *= gl_FragColor.a;
czm_writeDepthClamp();
}
`;var _L=`varying vec3 v_forwardDirectionEC;
varying vec3 v_texcoordNormalizationAndHalfWidth;
varying float v_batchId;
#ifdef PER_INSTANCE_COLOR
varying vec4 v_color;
#else
varying vec2 v_alignedPlaneDistances;
varying float v_texcoordT;
#endif
float rayPlaneDistanceUnsafe(vec3 origin, vec3 direction, vec3 planeNormal, float planeDistance) {
return (-planeDistance - dot(planeNormal, origin)) / dot(planeNormal, direction);
}
void main(void)
{
vec4 eyeCoordinate = gl_FragCoord;
eyeCoordinate /= eyeCoordinate.w;
#ifdef PER_INSTANCE_COLOR
gl_FragColor = czm_gammaCorrect(v_color);
#else // PER_INSTANCE_COLOR
float distanceFromStart = rayPlaneDistanceUnsafe(eyeCoordinate.xyz, -v_forwardDirectionEC, v_forwardDirectionEC.xyz, v_alignedPlaneDistances.x);
float distanceFromEnd = rayPlaneDistanceUnsafe(eyeCoordinate.xyz, v_forwardDirectionEC, -v_forwardDirectionEC.xyz, v_alignedPlaneDistances.y);
distanceFromStart = max(0.0, distanceFromStart);
distanceFromEnd = max(0.0, distanceFromEnd);
float s = distanceFromStart / (distanceFromStart + distanceFromEnd);
s = (s * v_texcoordNormalizationAndHalfWidth.x) + v_texcoordNormalizationAndHalfWidth.y;
czm_materialInput materialInput;
materialInput.s = s;
materialInput.st = vec2(s, v_texcoordT);
materialInput.str = vec3(s, v_texcoordT, 0.0);
czm_material material = czm_getMaterial(materialInput);
gl_FragColor = vec4(material.diffuse + material.emission, material.alpha);
#endif // PER_INSTANCE_COLOR
}
`;var gL=`attribute vec3 position3DHigh;
attribute vec3 position3DLow;
attribute vec4 startHiAndForwardOffsetX;
attribute vec4 startLoAndForwardOffsetY;
attribute vec4 startNormalAndForwardOffsetZ;
attribute vec4 endNormalAndTextureCoordinateNormalizationX;
attribute vec4 rightNormalAndTextureCoordinateNormalizationY;
attribute vec4 startHiLo2D;
attribute vec4 offsetAndRight2D;
attribute vec4 startEndNormals2D;
attribute vec2 texcoordNormalization2D;
attribute float batchId;
varying vec3 v_forwardDirectionEC;
varying vec3 v_texcoordNormalizationAndHalfWidth;
varying float v_batchId;
#ifdef WIDTH_VARYING
varying float v_width;
#endif
#ifdef ANGLE_VARYING
varying float v_polylineAngle;
#endif
#ifdef PER_INSTANCE_COLOR
varying vec4 v_color;
#else
varying vec2 v_alignedPlaneDistances;
varying float v_texcoordT;
#endif
void main()
{
v_batchId = batchId;
vec4 posRelativeToEye2D = czm_translateRelativeToEye(vec3(0.0, startHiLo2D.xy), vec3(0.0, startHiLo2D.zw));
vec4 posRelativeToEye3D = czm_translateRelativeToEye(startHiAndForwardOffsetX.xyz, startLoAndForwardOffsetY.xyz);
vec4 posRelativeToEye = czm_columbusViewMorph(posRelativeToEye2D, posRelativeToEye3D, czm_morphTime);
vec3 posEc2D = (czm_modelViewRelativeToEye * posRelativeToEye2D).xyz;
vec3 posEc3D = (czm_modelViewRelativeToEye * posRelativeToEye3D).xyz;
vec3 startEC = (czm_modelViewRelativeToEye * posRelativeToEye).xyz;
vec4 startPlane2D;
vec4 startPlane3D;
startPlane2D.xyz = czm_normal * vec3(0.0, startEndNormals2D.xy);
startPlane3D.xyz = czm_normal * startNormalAndForwardOffsetZ.xyz;
startPlane2D.w = -dot(startPlane2D.xyz, posEc2D);
startPlane3D.w = -dot(startPlane3D.xyz, posEc3D);
vec4 rightPlane2D;
vec4 rightPlane3D;
rightPlane2D.xyz = czm_normal * vec3(0.0, offsetAndRight2D.zw);
rightPlane3D.xyz = czm_normal * rightNormalAndTextureCoordinateNormalizationY.xyz;
rightPlane2D.w = -dot(rightPlane2D.xyz, posEc2D);
rightPlane3D.w = -dot(rightPlane3D.xyz, posEc3D);
posRelativeToEye2D = posRelativeToEye2D + vec4(0.0, offsetAndRight2D.xy, 0.0);
posRelativeToEye3D = posRelativeToEye3D + vec4(startHiAndForwardOffsetX.w, startLoAndForwardOffsetY.w, startNormalAndForwardOffsetZ.w, 0.0);
posRelativeToEye = czm_columbusViewMorph(posRelativeToEye2D, posRelativeToEye3D, czm_morphTime);
posEc2D = (czm_modelViewRelativeToEye * posRelativeToEye2D).xyz;
posEc3D = (czm_modelViewRelativeToEye * posRelativeToEye3D).xyz;
vec3 endEC = (czm_modelViewRelativeToEye * posRelativeToEye).xyz;
vec3 forwardEc3D = czm_normal * normalize(vec3(startHiAndForwardOffsetX.w, startLoAndForwardOffsetY.w, startNormalAndForwardOffsetZ.w));
vec3 forwardEc2D = czm_normal * normalize(vec3(0.0, offsetAndRight2D.xy));
vec4 endPlane2D;
vec4 endPlane3D;
endPlane2D.xyz = czm_normal * vec3(0.0, startEndNormals2D.zw);
endPlane3D.xyz = czm_normal * endNormalAndTextureCoordinateNormalizationX.xyz;
endPlane2D.w = -dot(endPlane2D.xyz, posEc2D);
endPlane3D.w = -dot(endPlane3D.xyz, posEc3D);
v_forwardDirectionEC = normalize(endEC - startEC);
vec2 cleanTexcoordNormalization2D;
cleanTexcoordNormalization2D.x = abs(texcoordNormalization2D.x);
cleanTexcoordNormalization2D.y = czm_branchFreeTernary(texcoordNormalization2D.y > 1.0, 0.0, abs(texcoordNormalization2D.y));
vec2 cleanTexcoordNormalization3D;
cleanTexcoordNormalization3D.x = abs(endNormalAndTextureCoordinateNormalizationX.w);
cleanTexcoordNormalization3D.y = rightNormalAndTextureCoordinateNormalizationY.w;
cleanTexcoordNormalization3D.y = czm_branchFreeTernary(cleanTexcoordNormalization3D.y > 1.0, 0.0, abs(cleanTexcoordNormalization3D.y));
v_texcoordNormalizationAndHalfWidth.xy = mix(cleanTexcoordNormalization2D, cleanTexcoordNormalization3D, czm_morphTime);
#ifdef PER_INSTANCE_COLOR
v_color = czm_batchTable_color(batchId);
#else // PER_INSTANCE_COLOR
v_alignedPlaneDistances.x = -dot(v_forwardDirectionEC, startEC);
v_alignedPlaneDistances.y = -dot(-v_forwardDirectionEC, endEC);
#endif // PER_INSTANCE_COLOR
#ifdef WIDTH_VARYING
float width = czm_batchTable_width(batchId);
float halfWidth = width * 0.5;
v_width = width;
v_texcoordNormalizationAndHalfWidth.z = halfWidth;
#else
float halfWidth = 0.5 * czm_batchTable_width(batchId);
v_texcoordNormalizationAndHalfWidth.z = halfWidth;
#endif
vec4 positionEc3D = czm_modelViewRelativeToEye * czm_translateRelativeToEye(position3DHigh, position3DLow);
float absStartPlaneDistance = abs(czm_planeDistance(startPlane3D, positionEc3D.xyz));
float absEndPlaneDistance = abs(czm_planeDistance(endPlane3D, positionEc3D.xyz));
vec3 planeDirection = czm_branchFreeTernary(absStartPlaneDistance < absEndPlaneDistance, startPlane3D.xyz, endPlane3D.xyz);
vec3 upOrDown = normalize(cross(rightPlane3D.xyz, planeDirection));
vec3 normalEC = normalize(cross(planeDirection, upOrDown));
vec3 geodeticSurfaceNormal = normalize(cross(normalEC, forwardEc3D));
geodeticSurfaceNormal *= float(0.0 <= rightNormalAndTextureCoordinateNormalizationY.w && rightNormalAndTextureCoordinateNormalizationY.w <= 1.0);
geodeticSurfaceNormal *= MAX_TERRAIN_HEIGHT;
positionEc3D.xyz += geodeticSurfaceNormal;
normalEC *= sign(endNormalAndTextureCoordinateNormalizationX.w);
positionEc3D.xyz += halfWidth * max(0.0, czm_metersPerPixel(positionEc3D)) * normalEC;
vec4 positionEc2D = czm_modelViewRelativeToEye * czm_translateRelativeToEye(position2DHigh.zxy, position2DLow.zxy);
absStartPlaneDistance = abs(czm_planeDistance(startPlane2D, positionEc2D.xyz));
absEndPlaneDistance = abs(czm_planeDistance(endPlane2D, positionEc2D.xyz));
planeDirection = czm_branchFreeTernary(absStartPlaneDistance < absEndPlaneDistance, startPlane2D.xyz, endPlane2D.xyz);
upOrDown = normalize(cross(rightPlane2D.xyz, planeDirection));
normalEC = normalize(cross(planeDirection, upOrDown));
geodeticSurfaceNormal = normalize(cross(normalEC, forwardEc2D));
geodeticSurfaceNormal *= float(0.0 <= texcoordNormalization2D.y && texcoordNormalization2D.y <= 1.0);
geodeticSurfaceNormal *= MAX_TERRAIN_HEIGHT;
positionEc2D.xyz += geodeticSurfaceNormal;
normalEC *= sign(texcoordNormalization2D.x);
#ifndef PER_INSTANCE_COLOR
v_texcoordT = clamp(sign(texcoordNormalization2D.x), 0.0, 1.0);
#endif
positionEc2D.xyz += halfWidth * max(0.0, czm_metersPerPixel(positionEc2D)) * normalEC;
gl_Position = czm_projection * mix(positionEc2D, positionEc3D, czm_morphTime);
#ifdef ANGLE_VARYING
vec2 approxLineDirection = normalize(vec2(v_forwardDirectionEC.x, -v_forwardDirectionEC.y));
approxLineDirection.y = czm_branchFreeTernary(approxLineDirection.x == 0.0 && approxLineDirection.y == 0.0, -1.0, approxLineDirection.y);
v_polylineAngle = czm_fastApproximateAtan(approxLineDirection.x, approxLineDirection.y);
#endif
}
`;var yL=`attribute vec3 position3DHigh;
attribute vec3 position3DLow;
#ifndef COLUMBUS_VIEW_2D
attribute vec4 startHiAndForwardOffsetX;
attribute vec4 startLoAndForwardOffsetY;
attribute vec4 startNormalAndForwardOffsetZ;
attribute vec4 endNormalAndTextureCoordinateNormalizationX;
attribute vec4 rightNormalAndTextureCoordinateNormalizationY;
#else
attribute vec4 startHiLo2D;
attribute vec4 offsetAndRight2D;
attribute vec4 startEndNormals2D;
attribute vec2 texcoordNormalization2D;
#endif
attribute float batchId;
varying vec4 v_startPlaneNormalEcAndHalfWidth;
varying vec4 v_endPlaneNormalEcAndBatchId;
varying vec4 v_rightPlaneEC;
varying vec4 v_endEcAndStartEcX;
varying vec4 v_texcoordNormalizationAndStartEcYZ;
#ifdef WIDTH_VARYING
varying float v_width;
#endif
#ifdef ANGLE_VARYING
varying float v_polylineAngle;
#endif
#ifdef PER_INSTANCE_COLOR
varying vec4 v_color;
#endif
void main()
{
#ifdef COLUMBUS_VIEW_2D
vec3 ecStart = (czm_modelViewRelativeToEye * czm_translateRelativeToEye(vec3(0.0, startHiLo2D.xy), vec3(0.0, startHiLo2D.zw))).xyz;
vec3 forwardDirectionEC = czm_normal * vec3(0.0, offsetAndRight2D.xy);
vec3 ecEnd = forwardDirectionEC + ecStart;
forwardDirectionEC = normalize(forwardDirectionEC);
v_rightPlaneEC.xyz = czm_normal * vec3(0.0, offsetAndRight2D.zw);
v_rightPlaneEC.w = -dot(v_rightPlaneEC.xyz, ecStart);
vec4 startPlaneEC;
startPlaneEC.xyz =  czm_normal * vec3(0.0, startEndNormals2D.xy);
startPlaneEC.w = -dot(startPlaneEC.xyz, ecStart);
vec4 endPlaneEC;
endPlaneEC.xyz =  czm_normal * vec3(0.0, startEndNormals2D.zw);
endPlaneEC.w = -dot(endPlaneEC.xyz, ecEnd);
v_texcoordNormalizationAndStartEcYZ.x = abs(texcoordNormalization2D.x);
v_texcoordNormalizationAndStartEcYZ.y = texcoordNormalization2D.y;
#else // COLUMBUS_VIEW_2D
vec3 ecStart = (czm_modelViewRelativeToEye * czm_translateRelativeToEye(startHiAndForwardOffsetX.xyz, startLoAndForwardOffsetY.xyz)).xyz;
vec3 offset = czm_normal * vec3(startHiAndForwardOffsetX.w, startLoAndForwardOffsetY.w, startNormalAndForwardOffsetZ.w);
vec3 ecEnd = ecStart + offset;
vec3 forwardDirectionEC = normalize(offset);
vec4 startPlaneEC;
startPlaneEC.xyz = czm_normal * startNormalAndForwardOffsetZ.xyz;
startPlaneEC.w = -dot(startPlaneEC.xyz, ecStart);
vec4 endPlaneEC;
endPlaneEC.xyz = czm_normal * endNormalAndTextureCoordinateNormalizationX.xyz;
endPlaneEC.w = -dot(endPlaneEC.xyz, ecEnd);
v_rightPlaneEC.xyz = czm_normal * rightNormalAndTextureCoordinateNormalizationY.xyz;
v_rightPlaneEC.w = -dot(v_rightPlaneEC.xyz, ecStart);
v_texcoordNormalizationAndStartEcYZ.x = abs(endNormalAndTextureCoordinateNormalizationX.w);
v_texcoordNormalizationAndStartEcYZ.y = rightNormalAndTextureCoordinateNormalizationY.w;
#endif // COLUMBUS_VIEW_2D
v_endEcAndStartEcX.xyz = ecEnd;
v_endEcAndStartEcX.w = ecStart.x;
v_texcoordNormalizationAndStartEcYZ.zw = ecStart.yz;
#ifdef PER_INSTANCE_COLOR
v_color = czm_batchTable_color(batchId);
#endif // PER_INSTANCE_COLOR
vec4 positionRelativeToEye = czm_computePosition();
vec4 positionEC = czm_modelViewRelativeToEye * positionRelativeToEye;
float absStartPlaneDistance = abs(czm_planeDistance(startPlaneEC, positionEC.xyz));
float absEndPlaneDistance = abs(czm_planeDistance(endPlaneEC, positionEC.xyz));
vec3 planeDirection = czm_branchFreeTernary(absStartPlaneDistance < absEndPlaneDistance, startPlaneEC.xyz, endPlaneEC.xyz);
vec3 upOrDown = normalize(cross(v_rightPlaneEC.xyz, planeDirection));
vec3 normalEC = normalize(cross(planeDirection, upOrDown));
upOrDown = cross(forwardDirectionEC, normalEC);
upOrDown = float(czm_sceneMode == czm_sceneMode3D) * upOrDown;
upOrDown = float(v_texcoordNormalizationAndStartEcYZ.y > 1.0 || v_texcoordNormalizationAndStartEcYZ.y < 0.0) * upOrDown;
upOrDown = min(GLOBE_MINIMUM_ALTITUDE, czm_geometricToleranceOverMeter * length(positionRelativeToEye.xyz)) * upOrDown;
positionEC.xyz += upOrDown;
v_texcoordNormalizationAndStartEcYZ.y = czm_branchFreeTernary(v_texcoordNormalizationAndStartEcYZ.y > 1.0, 0.0, abs(v_texcoordNormalizationAndStartEcYZ.y));
float width = czm_batchTable_width(batchId);
#ifdef WIDTH_VARYING
v_width = width;
#endif
v_startPlaneNormalEcAndHalfWidth.xyz = startPlaneEC.xyz;
v_startPlaneNormalEcAndHalfWidth.w = width * 0.5;
v_endPlaneNormalEcAndBatchId.xyz = endPlaneEC.xyz;
v_endPlaneNormalEcAndBatchId.w = batchId;
width = width * max(0.0, czm_metersPerPixel(positionEC));
width = width / dot(normalEC, v_rightPlaneEC.xyz);
#ifdef COLUMBUS_VIEW_2D
normalEC *= sign(texcoordNormalization2D.x);
#else
normalEC *= sign(endNormalAndTextureCoordinateNormalizationX.w);
#endif
positionEC.xyz += width * normalEC;
gl_Position = czm_depthClamp(czm_projection * positionEC);
#ifdef ANGLE_VARYING
vec2 approxLineDirection = normalize(vec2(forwardDirectionEC.x, -forwardDirectionEC.y));
approxLineDirection.y = czm_branchFreeTernary(approxLineDirection.x == 0.0 && approxLineDirection.y == 0.0, -1.0, approxLineDirection.y);
v_polylineAngle = czm_fastApproximateAtan(approxLineDirection.x, approxLineDirection.y);
#endif
}
`;var AL=`attribute vec3 position3DHigh;
attribute vec3 position3DLow;
attribute vec3 prevPosition3DHigh;
attribute vec3 prevPosition3DLow;
attribute vec3 nextPosition3DHigh;
attribute vec3 nextPosition3DLow;
attribute vec2 expandAndWidth;
attribute vec4 color;
attribute float batchId;
varying vec4 v_color;
void main()
{
float expandDir = expandAndWidth.x;
float width = abs(expandAndWidth.y) + 0.5;
bool usePrev = expandAndWidth.y < 0.0;
vec4 p = czm_computePosition();
vec4 prev = czm_computePrevPosition();
vec4 next = czm_computeNextPosition();
float angle;
vec4 positionWC = getPolylineWindowCoordinates(p, prev, next, expandDir, width, usePrev, angle);
gl_Position = czm_viewportOrthographic * positionWC;
v_color = color;
}
`;var Tu=`void clipLineSegmentToNearPlane(
vec3 p0,
vec3 p1,
out vec4 positionWC,
out bool clipped,
out bool culledByNearPlane,
out vec4 clippedPositionEC)
{
culledByNearPlane = false;
clipped = false;
vec3 p0ToP1 = p1 - p0;
float magnitude = length(p0ToP1);
vec3 direction = normalize(p0ToP1);
float endPoint0Distance =  czm_currentFrustum.x + p0.z;
float denominator = -direction.z;
if (endPoint0Distance > 0.0 && abs(denominator) < czm_epsilon7)
{
culledByNearPlane = true;
}
else if (endPoint0Distance > 0.0)
{
float t = endPoint0Distance / denominator;
if (t < 0.0 || t > magnitude)
{
culledByNearPlane = true;
}
else
{
p0 = p0 + t * direction;
p0.z = min(p0.z, -czm_currentFrustum.x);
clipped = true;
}
}
clippedPositionEC = vec4(p0, 1.0);
positionWC = czm_eyeToWindowCoordinates(clippedPositionEC);
}
vec4 getPolylineWindowCoordinatesEC(vec4 positionEC, vec4 prevEC, vec4 nextEC, float expandDirection, float width, bool usePrevious, out float angle)
{
#ifdef POLYLINE_DASH
vec4 positionWindow = czm_eyeToWindowCoordinates(positionEC);
vec4 previousWindow = czm_eyeToWindowCoordinates(prevEC);
vec4 nextWindow = czm_eyeToWindowCoordinates(nextEC);
vec2 lineDir;
if (usePrevious) {
lineDir = normalize(positionWindow.xy - previousWindow.xy);
}
else {
lineDir = normalize(nextWindow.xy - positionWindow.xy);
}
angle = atan(lineDir.x, lineDir.y) - 1.570796327;
angle = floor(angle / czm_piOverFour + 0.5) * czm_piOverFour;
#endif
vec4 clippedPrevWC, clippedPrevEC;
bool prevSegmentClipped, prevSegmentCulled;
clipLineSegmentToNearPlane(prevEC.xyz, positionEC.xyz, clippedPrevWC, prevSegmentClipped, prevSegmentCulled, clippedPrevEC);
vec4 clippedNextWC, clippedNextEC;
bool nextSegmentClipped, nextSegmentCulled;
clipLineSegmentToNearPlane(nextEC.xyz, positionEC.xyz, clippedNextWC, nextSegmentClipped, nextSegmentCulled, clippedNextEC);
bool segmentClipped, segmentCulled;
vec4 clippedPositionWC, clippedPositionEC;
clipLineSegmentToNearPlane(positionEC.xyz, usePrevious ? prevEC.xyz : nextEC.xyz, clippedPositionWC, segmentClipped, segmentCulled, clippedPositionEC);
if (segmentCulled)
{
return vec4(0.0, 0.0, 0.0, 1.0);
}
vec2 directionToPrevWC = normalize(clippedPrevWC.xy - clippedPositionWC.xy);
vec2 directionToNextWC = normalize(clippedNextWC.xy - clippedPositionWC.xy);
if (prevSegmentCulled)
{
directionToPrevWC = -directionToNextWC;
}
else if (nextSegmentCulled)
{
directionToNextWC = -directionToPrevWC;
}
vec2 thisSegmentForwardWC, otherSegmentForwardWC;
if (usePrevious)
{
thisSegmentForwardWC = -directionToPrevWC;
otherSegmentForwardWC = directionToNextWC;
}
else
{
thisSegmentForwardWC = directionToNextWC;
otherSegmentForwardWC =  -directionToPrevWC;
}
vec2 thisSegmentLeftWC = vec2(-thisSegmentForwardWC.y, thisSegmentForwardWC.x);
vec2 leftWC = thisSegmentLeftWC;
float expandWidth = width * 0.5;
if (!czm_equalsEpsilon(prevEC.xyz - positionEC.xyz, vec3(0.0), czm_epsilon1) && !czm_equalsEpsilon(nextEC.xyz - positionEC.xyz, vec3(0.0), czm_epsilon1))
{
vec2 otherSegmentLeftWC = vec2(-otherSegmentForwardWC.y, otherSegmentForwardWC.x);
vec2 leftSumWC = thisSegmentLeftWC + otherSegmentLeftWC;
float leftSumLength = length(leftSumWC);
leftWC = leftSumLength < czm_epsilon6 ? thisSegmentLeftWC : (leftSumWC / leftSumLength);
vec2 u = -thisSegmentForwardWC;
vec2 v = leftWC;
float sinAngle = abs(u.x * v.y - u.y * v.x);
expandWidth = clamp(expandWidth / sinAngle, 0.0, width * 2.0);
}
vec2 offset = leftWC * expandDirection * expandWidth * czm_pixelRatio;
return vec4(clippedPositionWC.xy + offset, -clippedPositionWC.z, 1.0) * (czm_projection * clippedPositionEC).w;
}
vec4 getPolylineWindowCoordinates(vec4 position, vec4 previous, vec4 next, float expandDirection, float width, bool usePrevious, out float angle)
{
vec4 positionEC = czm_modelViewRelativeToEye * position;
vec4 prevEC = czm_modelViewRelativeToEye * previous;
vec4 nextEC = czm_modelViewRelativeToEye * next;
return getPolylineWindowCoordinatesEC(positionEC, prevEC, nextEC, expandDirection, width, usePrevious, angle);
}
`;var WG=`${Tu}
${AL}`,NNe=AC;Vt.isInternetExplorer()||(WG=`#define CLIP_POLYLINE 
${WG}`);function Z0(t){t=A(t,A.EMPTY_OBJECT);let n=A(t.translucent,!0),i=!1,o=Z0.VERTEX_FORMAT;this.material=void 0,this.translucent=n,this._vertexShaderSource=A(t.vertexShaderSource,WG),this._fragmentShaderSource=A(t.fragmentShaderSource,NNe),this._renderState=Zi.getDefaultRenderState(n,i,t.renderState),this._closed=i,this._vertexFormat=o}Object.defineProperties(Z0.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},vertexFormat:{get:function(){return this._vertexFormat}}});Z0.VERTEX_FORMAT=De.POSITION_ONLY;Z0.prototype.getFragmentShaderSource=Zi.prototype.getFragmentShaderSource;Z0.prototype.isTranslucent=Zi.prototype.isTranslucent;Z0.prototype.getRenderState=Zi.prototype.getRenderState;var Wr=Z0;var CL=`attribute vec3 position3DHigh;
attribute vec3 position3DLow;
attribute vec3 prevPosition3DHigh;
attribute vec3 prevPosition3DLow;
attribute vec3 nextPosition3DHigh;
attribute vec3 nextPosition3DLow;
attribute vec2 expandAndWidth;
attribute vec2 st;
attribute float batchId;
varying float v_width;
varying vec2 v_st;
varying float v_polylineAngle;
void main()
{
float expandDir = expandAndWidth.x;
float width = abs(expandAndWidth.y) + 0.5;
bool usePrev = expandAndWidth.y < 0.0;
vec4 p = czm_computePosition();
vec4 prev = czm_computePrevPosition();
vec4 next = czm_computeNextPosition();
float angle;
vec4 positionWC = getPolylineWindowCoordinates(p, prev, next, expandDir, width, usePrev, angle);
gl_Position = czm_viewportOrthographic * positionWC;
v_width = width;
v_st.s = st.s;
v_st.t = czm_writeNonPerspective(st.t, gl_Position.w);
v_polylineAngle = angle;
}
`;var ux=`#ifdef VECTOR_TILE
uniform vec4 u_highlightColor;
#endif
varying vec2 v_st;
void main()
{
czm_materialInput materialInput;
vec2 st = v_st;
st.t = czm_readNonPerspective(st.t, gl_FragCoord.w);
materialInput.s = st.s;
materialInput.st = st;
materialInput.str = vec3(st, 0.0);
czm_material material = czm_getMaterial(materialInput);
gl_FragColor = vec4(material.diffuse + material.emission, material.alpha);
#ifdef VECTOR_TILE
gl_FragColor *= u_highlightColor;
#endif
czm_writeLogDepth();
}
`;var jG=`${Tu}
${CL}`,VNe=ux;Vt.isInternetExplorer()||(jG=`#define CLIP_POLYLINE 
${jG}`);function Q0(t){t=A(t,A.EMPTY_OBJECT);let n=A(t.translucent,!0),i=!1,o=Q0.VERTEX_FORMAT;this.material=f(t.material)?t.material:$i.fromType($i.ColorType),this.translucent=n,this._vertexShaderSource=A(t.vertexShaderSource,jG),this._fragmentShaderSource=A(t.fragmentShaderSource,VNe),this._renderState=Zi.getDefaultRenderState(n,i,t.renderState),this._closed=i,this._vertexFormat=o}Object.defineProperties(Q0.prototype,{vertexShaderSource:{get:function(){let t=this._vertexShaderSource;return this.material.shaderSource.search(/varying\s+float\s+v_polylineAngle;/g)!==-1&&(t=`#define POLYLINE_DASH
${t}`),t}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},vertexFormat:{get:function(){return this._vertexFormat}}});Q0.VERTEX_FORMAT=De.POSITION_AND_ST;Q0.prototype.getFragmentShaderSource=Zi.prototype.getFragmentShaderSource;Q0.prototype.isTranslucent=Zi.prototype.isTranslucent;Q0.prototype.getRenderState=Zi.prototype.getRenderState;var na=Q0;function Rm(t){t=A(t,A.EMPTY_OBJECT),this.geometryInstances=t.geometryInstances,this._hasPerInstanceColors=!0;let n=t.appearance;f(n)||(n=new na),this.appearance=n,this.show=A(t.show,!0),this.classificationType=A(t.classificationType,Un.BOTH),this.debugShowBoundingVolume=A(t.debugShowBoundingVolume,!1),this._debugShowShadowVolume=A(t.debugShowShadowVolume,!1),this._primitiveOptions={geometryInstances:void 0,appearance:void 0,vertexCacheOptimize:!1,interleave:A(t.interleave,!1),releaseGeometryInstances:A(t.releaseGeometryInstances,!0),allowPicking:A(t.allowPicking,!0),asynchronous:A(t.asynchronous,!0),compressVertices:!1,_createShaderProgramFunction:void 0,_createCommandsFunction:void 0,_updateAndQueueCommandsFunction:void 0},this._zIndex=void 0,this._ready=!1;let i=this;this._readyPromise=new Promise((o,r)=>{i._completeLoad=()=>{this._ready=!0,this.releaseGeometryInstances&&(this.geometryInstances=void 0);let s=this._error;f(s)?r(s):o(this)}}),this._primitive=void 0,this._sp=void 0,this._sp2D=void 0,this._spMorph=void 0,this._renderState=ote(!1),this._renderState3DTiles=ote(!0),this._renderStateMorph=Ve.fromCache({cull:{enabled:!0,face:xi.FRONT},depthTest:{enabled:!0},blending:ln.PRE_MULTIPLIED_ALPHA_BLEND,depthMask:!1})}Object.defineProperties(Rm.prototype,{interleave:{get:function(){return this._primitiveOptions.interleave}},releaseGeometryInstances:{get:function(){return this._primitiveOptions.releaseGeometryInstances}},allowPicking:{get:function(){return this._primitiveOptions.allowPicking}},asynchronous:{get:function(){return this._primitiveOptions.asynchronous}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise}},debugShowShadowVolume:{get:function(){return this._debugShowShadowVolume}}});Rm.initializeTerrainHeights=function(){return ri.initialize()};function kNe(t,n,i){let o=n.context,r=t._primitive,s=r._attributeLocations,a=r._batchTable.getVertexShaderCallback()(yL);a=Sn._appendShowToShader(r,a),a=Sn._appendDistanceDisplayConditionToShader(r,a),a=Sn._modifyShaderPosition(t,a,n.scene3DOnly);let c=r._batchTable.getVertexShaderCallback()(gL);c=Sn._appendShowToShader(r,c),c=Sn._appendDistanceDisplayConditionToShader(r,c),c=Sn._modifyShaderPosition(t,c,n.scene3DOnly);let l=r._batchTable.getVertexShaderCallback()(pL),u=[`GLOBE_MINIMUM_ALTITUDE ${n.mapProjection.ellipsoid.minimumRadius.toFixed(1)}`],d="",h="";f(i.material)?(h=f(i.material)?i.material.shaderSource:"",h.search(/varying\s+float\s+v_polylineAngle;/g)!==-1&&u.push("ANGLE_VARYING"),h.search(/varying\s+float\s+v_width;/g)!==-1&&u.push("WIDTH_VARYING")):d="PER_INSTANCE_COLOR",u.push(d);let _=t.debugShowShadowVolume?["DEBUG_SHOW_VOLUME",d]:[d],y=new ze({defines:u,sources:[a]}),p=new ze({defines:_,sources:[h,l]});t._sp=qt.replaceCache({context:o,shaderProgram:r._sp,vertexShaderSource:y,fragmentShaderSource:p,attributeLocations:s});let C=o.shaderCache.getDerivedShaderProgram(t._sp,"2dColor");if(!f(C)){let T=new ze({defines:u.concat(["COLUMBUS_VIEW_2D"]),sources:[a]});C=o.shaderCache.createDerivedShaderProgram(t._sp,"2dColor",{context:o,shaderProgram:t._sp2D,vertexShaderSource:T,fragmentShaderSource:p,attributeLocations:s})}t._sp2D=C;let x=o.shaderCache.getDerivedShaderProgram(t._sp,"MorphColor");if(!f(x)){let T=new ze({defines:u.concat([`MAX_TERRAIN_HEIGHT ${ri._defaultMaxTerrainHeight.toFixed(1)}`]),sources:[c]});l=r._batchTable.getVertexShaderCallback()(_L);let E=new ze({defines:_,sources:[h,l]});x=o.shaderCache.createDerivedShaderProgram(t._sp,"MorphColor",{context:o,shaderProgram:t._spMorph,vertexShaderSource:T,fragmentShaderSource:E,attributeLocations:s})}t._spMorph=x}function ote(t){return Ve.fromCache({cull:{enabled:!0},blending:ln.PRE_MULTIPLIED_ALPHA_BLEND,depthMask:!1,stencilTest:{enabled:t,frontFunction:kn.EQUAL,frontOperation:{fail:ft.KEEP,zFail:ft.KEEP,zPass:ft.KEEP},backFunction:kn.EQUAL,backOperation:{fail:ft.KEEP,zFail:ft.KEEP,zPass:ft.KEEP},reference:Ot.CESIUM_3D_TILE_MASK,mask:Ot.CESIUM_3D_TILE_MASK}})}function UNe(t,n,i,o,r,s){let a=t._primitive,c=a._va.length;r.length=c,s.length=c;let u=n instanceof Wr?{}:i._uniforms,d=a._batchTable.getUniformMapCallback()(u);for(let h=0;h<c;h++){let _=a._va[h],y=r[h];f(y)||(y=r[h]=new et({owner:t,primitiveType:a._primitiveType})),y.vertexArray=_,y.renderState=t._renderState,y.shaderProgram=t._sp,y.uniformMap=d,y.pass=Te.TERRAIN_CLASSIFICATION,y.pickId="czm_batchTable_pickColor(v_endPlaneNormalEcAndBatchId.w)";let p=et.shallowClone(y,y.derivedCommands.tileset);p.renderState=t._renderState3DTiles,p.pass=Te.CESIUM_3D_TILE_CLASSIFICATION,y.derivedCommands.tileset=p;let C=et.shallowClone(y,y.derivedCommands.color2D);C.shaderProgram=t._sp2D,y.derivedCommands.color2D=C;let x=et.shallowClone(p,p.derivedCommands.color2D);x.shaderProgram=t._sp2D,p.derivedCommands.color2D=x;let T=et.shallowClone(y,y.derivedCommands.colorMorph);T.renderState=t._renderStateMorph,T.shaderProgram=t._spMorph,T.pickId="czm_batchTable_pickColor(v_batchId)",y.derivedCommands.colorMorph=T}}function rte(t,n,i,o,r,s,a){i.mode===ne.MORPHING?n=n.derivedCommands.colorMorph:i.mode!==ne.SCENE3D&&(n=n.derivedCommands.color2D),n.modelMatrix=o,n.boundingVolume=s,n.cull=r,n.debugShowBoundingVolume=a,i.commandList.push(n)}function zNe(t,n,i,o,r,s,a){let c=t._primitive;Sn._updateBoundingVolumes(c,n,r);let l;n.mode===ne.SCENE3D?l=c._boundingSphereWC:n.mode===ne.COLUMBUS_VIEW?l=c._boundingSphereCV:n.mode===ne.SCENE2D&&f(c._boundingSphere2D)?l=c._boundingSphere2D:f(c._boundingSphereMorph)&&(l=c._boundingSphereMorph);let u=n.mode===ne.MORPHING,d=t.classificationType,h=d!==Un.CESIUM_3D_TILE,_=d!==Un.TERRAIN&&!u,y,p=n.passes;if(p.render||p.pick&&c.allowPicking){let C=i.length;for(let x=0;x<C;++x){let T=l[x];h&&(y=i[x],rte(t,y,n,r,s,T,a)),_&&(y=i[x].derivedCommands.tileset,rte(t,y,n,r,s,T,a))}}}Rm.prototype.update=function(t){if(!f(this._primitive)&&!f(this.geometryInstances))return;if(!ri.initialized){Rm.initializeTerrainHeights();return}let n,i=this,o=this._primitiveOptions;if(!f(this._primitive)){let r=Array.isArray(this.geometryInstances)?this.geometryInstances:[this.geometryInstances],s=r.length,a=new Array(s),c;for(n=0;n<s;++n)if(c=r[n].attributes,!f(c)||!f(c.color)){this._hasPerInstanceColors=!1;break}for(n=0;n<s;++n){let l=r[n];c={};let u=l.attributes;for(let d in u)u.hasOwnProperty(d)&&(c[d]=u[d]);f(c.width)||(c.width=new uc({componentDatatype:J.UNSIGNED_BYTE,componentsPerAttribute:1,value:[l.geometry.width]})),l.geometry._scene3DOnly=t.scene3DOnly,lx.setProjectionAndEllipsoid(l.geometry,t.mapProjection),a[n]=new Ct({geometry:l.geometry,attributes:c,id:l.id,pickPrimitive:i})}o.geometryInstances=a,o.appearance=this.appearance,o._createShaderProgramFunction=function(l,u,d){kNe(i,u,d)},o._createCommandsFunction=function(l,u,d,h,_,y,p){UNe(i,u,d,h,y,p)},o._updateAndQueueCommandsFunction=function(l,u,d,h,_,y,p,C){zNe(i,u,d,h,_,y,p)},this._primitive=new Sn(o),this._primitive.readyPromise.then(this._completeLoad)}if(this.appearance instanceof Wr&&!this._hasPerInstanceColors)throw new Ce("All GeometryInstances must have color attributes to use PolylineColorAppearance with GroundPolylinePrimitive.");this._primitive.appearance=this.appearance,this._primitive.show=this.show,this._primitive.debugShowBoundingVolume=this.debugShowBoundingVolume,this._primitive.update(t)};Rm.prototype.getGeometryInstanceAttributes=function(t){return this._primitive.getGeometryInstanceAttributes(t)};Rm.isSupported=function(t){return t.frameState.context.depthTexture};Rm.prototype.isDestroyed=function(){return!1};Rm.prototype.destroy=function(){return this._primitive=this._primitive&&this._primitive.destroy(),this._sp=this._sp&&this._sp.destroy(),this._sp2D=void 0,this._spMorph=void 0,ue(this)};var eh=Rm;var HNe=new W(1,1),GNe=!1,WNe=z.WHITE;function fx(t){t=A(t,A.EMPTY_OBJECT),this._definitionChanged=new Ae,this._image=void 0,this._imageSubscription=void 0,this._repeat=void 0,this._repeatSubscription=void 0,this._color=void 0,this._colorSubscription=void 0,this._transparent=void 0,this._transparentSubscription=void 0,this.image=t.image,this.repeat=t.repeat,this.color=t.color,this.transparent=t.transparent}Object.defineProperties(fx.prototype,{isConstant:{get:function(){return q.isConstant(this._image)&&q.isConstant(this._repeat)}},definitionChanged:{get:function(){return this._definitionChanged}},image:ce("image"),repeat:ce("repeat"),color:ce("color"),transparent:ce("transparent")});fx.prototype.getType=function(t){return"Image"};fx.prototype.getValue=function(t,n){return f(n)||(n={}),n.image=q.getValueOrUndefined(this._image,t),n.repeat=q.getValueOrClonedDefault(this._repeat,t,HNe,n.repeat),n.color=q.getValueOrClonedDefault(this._color,t,WNe,n.color),q.getValueOrDefault(this._transparent,t,GNe)&&(n.color.alpha=Math.min(.99,n.color.alpha)),n};fx.prototype.equals=function(t){return this===t||t instanceof fx&&q.equals(this._image,t._image)&&q.equals(this._repeat,t._repeat)&&q.equals(this._color,t._color)&&q.equals(this._transparent,t._transparent)};var $0=fx;function jNe(t){if(t instanceof z)return new Rt(t);if(typeof t=="string"||t instanceof Ie||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement){let n=new $0;return n.image=t,n}}function qNe(t,n){return ce(t,n,jNe)}var Po=qNe;function PS(t){this._definitionChanged=new Ae,this._show=void 0,this._showSubscription=void 0,this._dimensions=void 0,this._dimensionsSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this.merge(A(t,A.EMPTY_OBJECT))}Object.defineProperties(PS.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:ce("show"),dimensions:ce("dimensions"),heightReference:ce("heightReference"),fill:ce("fill"),material:Po("material"),outline:ce("outline"),outlineColor:ce("outlineColor"),outlineWidth:ce("outlineWidth"),shadows:ce("shadows"),distanceDisplayCondition:ce("distanceDisplayCondition")});PS.prototype.clone=function(t){return f(t)?(t.show=this.show,t.dimensions=this.dimensions,t.heightReference=this.heightReference,t.fill=this.fill,t.material=this.material,t.outline=this.outline,t.outlineColor=this.outlineColor,t.outlineWidth=this.outlineWidth,t.shadows=this.shadows,t.distanceDisplayCondition=this.distanceDisplayCondition,t):new PS(this)};PS.prototype.merge=function(t){this.show=A(this.show,t.show),this.dimensions=A(this.dimensions,t.dimensions),this.heightReference=A(this.heightReference,t.heightReference),this.fill=A(this.fill,t.fill),this.material=A(this.material,t.material),this.outline=A(this.outline,t.outline),this.outlineColor=A(this.outlineColor,t.outlineColor),this.outlineWidth=A(this.outlineWidth,t.outlineWidth),this.shadows=A(this.shadows,t.shadows),this.distanceDisplayCondition=A(this.distanceDisplayCondition,t.distanceDisplayCondition)};var dx=PS;var YNe={FIXED:0,INERTIAL:1},no=Object.freeze(YNe);function hx(){Ce.throwInstantiationError()}Object.defineProperties(hx.prototype,{isConstant:{get:Ce.throwInstantiationError},definitionChanged:{get:Ce.throwInstantiationError},referenceFrame:{get:Ce.throwInstantiationError}});hx.prototype.getValue=Ce.throwInstantiationError;hx.prototype.getValueInReferenceFrame=Ce.throwInstantiationError;hx.prototype.equals=Ce.throwInstantiationError;var qG=new $;hx.convertToReferenceFrame=function(t,n,i,o,r){if(!f(n))return n;if(f(r)||(r=new m),i===o)return m.clone(n,r);let s=vt.computeIcrfToFixedMatrix(t,qG);if(f(s)||(s=vt.computeTemeToPseudoFixedMatrix(t,qG)),i===no.INERTIAL)return $.multiplyByVector(s,n,r);if(i===no.FIXED)return $.multiplyByVector($.transpose(s,qG),n,r)};var g_=hx;function ey(t,n){this._definitionChanged=new Ae,this._value=m.clone(t),this._referenceFrame=A(n,no.FIXED)}Object.defineProperties(ey.prototype,{isConstant:{get:function(){return!f(this._value)||this._referenceFrame===no.FIXED}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){return this._referenceFrame}}});ey.prototype.getValue=function(t,n){return this.getValueInReferenceFrame(t,no.FIXED,n)};ey.prototype.setValue=function(t,n){let i=!1;m.equals(this._value,t)||(i=!0,this._value=m.clone(t)),f(n)&&this._referenceFrame!==n&&(i=!0,this._referenceFrame=n),i&&this._definitionChanged.raiseEvent(this)};ey.prototype.getValueInReferenceFrame=function(t,n,i){return g_.convertToReferenceFrame(t,this._value,this._referenceFrame,n,i)};ey.prototype.equals=function(t){return this===t||t instanceof ey&&m.equals(this._value,t._value)&&this._referenceFrame===t._referenceFrame};var Jc=ey;function IS(t){this._definitionChanged=new Ae,this._show=void 0,this._showSubscription=void 0,this._positions=void 0,this._positionsSubscription=void 0,this._width=void 0,this._widthSubscription=void 0,this._height=void 0,this._heightSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._extrudedHeight=void 0,this._extrudedHeightSubscription=void 0,this._extrudedHeightReference=void 0,this._extrudedHeightReferenceSubscription=void 0,this._cornerType=void 0,this._cornerTypeSubscription=void 0,this._granularity=void 0,this._granularitySubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._classificationType=void 0,this._classificationTypeSubscription=void 0,this._zIndex=void 0,this._zIndexSubscription=void 0,this.merge(A(t,A.EMPTY_OBJECT))}Object.defineProperties(IS.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:ce("show"),positions:ce("positions"),width:ce("width"),height:ce("height"),heightReference:ce("heightReference"),extrudedHeight:ce("extrudedHeight"),extrudedHeightReference:ce("extrudedHeightReference"),cornerType:ce("cornerType"),granularity:ce("granularity"),fill:ce("fill"),material:Po("material"),outline:ce("outline"),outlineColor:ce("outlineColor"),outlineWidth:ce("outlineWidth"),shadows:ce("shadows"),distanceDisplayCondition:ce("distanceDisplayCondition"),classificationType:ce("classificationType"),zIndex:ce("zIndex")});IS.prototype.clone=function(t){return f(t)?(t.show=this.show,t.positions=this.positions,t.width=this.width,t.height=this.height,t.heightReference=this.heightReference,t.extrudedHeight=this.extrudedHeight,t.extrudedHeightReference=this.extrudedHeightReference,t.cornerType=this.cornerType,t.granularity=this.granularity,t.fill=this.fill,t.material=this.material,t.outline=this.outline,t.outlineColor=this.outlineColor,t.outlineWidth=this.outlineWidth,t.shadows=this.shadows,t.distanceDisplayCondition=this.distanceDisplayCondition,t.classificationType=this.classificationType,t.zIndex=this.zIndex,t):new IS(this)};IS.prototype.merge=function(t){this.show=A(this.show,t.show),this.positions=A(this.positions,t.positions),this.width=A(this.width,t.width),this.height=A(this.height,t.height),this.heightReference=A(this.heightReference,t.heightReference),this.extrudedHeight=A(this.extrudedHeight,t.extrudedHeight),this.extrudedHeightReference=A(this.extrudedHeightReference,t.extrudedHeightReference),this.cornerType=A(this.cornerType,t.cornerType),this.granularity=A(this.granularity,t.granularity),this.fill=A(this.fill,t.fill),this.material=A(this.material,t.material),this.outline=A(this.outline,t.outline),this.outlineColor=A(this.outlineColor,t.outlineColor),this.outlineWidth=A(this.outlineWidth,t.outlineWidth),this.shadows=A(this.shadows,t.shadows),this.distanceDisplayCondition=A(this.distanceDisplayCondition,t.distanceDisplayCondition),this.classificationType=A(this.classificationType,t.classificationType),this.zIndex=A(this.zIndex,t.zIndex)};var mx=IS;function XNe(t){return t}function KNe(t,n){return ce(t,n,XNe)}var vl=KNe;function BS(t){this._definitionChanged=new Ae,this._show=void 0,this._showSubscription=void 0,this._length=void 0,this._lengthSubscription=void 0,this._topRadius=void 0,this._topRadiusSubscription=void 0,this._bottomRadius=void 0,this._bottomRadiusSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._numberOfVerticalLines=void 0,this._numberOfVerticalLinesSubscription=void 0,this._slices=void 0,this._slicesSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this.merge(A(t,A.EMPTY_OBJECT))}Object.defineProperties(BS.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:ce("show"),length:ce("length"),topRadius:ce("topRadius"),bottomRadius:ce("bottomRadius"),heightReference:ce("heightReference"),fill:ce("fill"),material:Po("material"),outline:ce("outline"),outlineColor:ce("outlineColor"),outlineWidth:ce("outlineWidth"),numberOfVerticalLines:ce("numberOfVerticalLines"),slices:ce("slices"),shadows:ce("shadows"),distanceDisplayCondition:ce("distanceDisplayCondition")});BS.prototype.clone=function(t){return f(t)?(t.show=this.show,t.length=this.length,t.topRadius=this.topRadius,t.bottomRadius=this.bottomRadius,t.heightReference=this.heightReference,t.fill=this.fill,t.material=this.material,t.outline=this.outline,t.outlineColor=this.outlineColor,t.outlineWidth=this.outlineWidth,t.numberOfVerticalLines=this.numberOfVerticalLines,t.slices=this.slices,t.shadows=this.shadows,t.distanceDisplayCondition=this.distanceDisplayCondition,t):new BS(this)};BS.prototype.merge=function(t){this.show=A(this.show,t.show),this.length=A(this.length,t.length),this.topRadius=A(this.topRadius,t.topRadius),this.bottomRadius=A(this.bottomRadius,t.bottomRadius),this.heightReference=A(this.heightReference,t.heightReference),this.fill=A(this.fill,t.fill),this.material=A(this.material,t.material),this.outline=A(this.outline,t.outline),this.outlineColor=A(this.outlineColor,t.outlineColor),this.outlineWidth=A(this.outlineWidth,t.outlineWidth),this.numberOfVerticalLines=A(this.numberOfVerticalLines,t.numberOfVerticalLines),this.slices=A(this.slices,t.slices),this.shadows=A(this.shadows,t.shadows),this.distanceDisplayCondition=A(this.distanceDisplayCondition,t.distanceDisplayCondition)};var px=BS;function ty(t){this._definitionChanged=new Ae,this._show=void 0,this._showSubscription=void 0,this._semiMajorAxis=void 0,this._semiMajorAxisSubscription=void 0,this._semiMinorAxis=void 0,this._semiMinorAxisSubscription=void 0,this._height=void 0,this._heightSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._extrudedHeight=void 0,this._extrudedHeightSubscription=void 0,this._extrudedHeightReference=void 0,this._extrudedHeightReferenceSubscription=void 0,this._rotation=void 0,this._rotationSubscription=void 0,this._stRotation=void 0,this._stRotationSubscription=void 0,this._granularity=void 0,this._granularitySubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._numberOfVerticalLines=void 0,this._numberOfVerticalLinesSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._classificationType=void 0,this._classificationTypeSubscription=void 0,this._zIndex=void 0,this._zIndexSubscription=void 0,this.merge(A(t,A.EMPTY_OBJECT))}Object.defineProperties(ty.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:ce("show"),semiMajorAxis:ce("semiMajorAxis"),semiMinorAxis:ce("semiMinorAxis"),height:ce("height"),heightReference:ce("heightReference"),extrudedHeight:ce("extrudedHeight"),extrudedHeightReference:ce("extrudedHeightReference"),rotation:ce("rotation"),stRotation:ce("stRotation"),granularity:ce("granularity"),fill:ce("fill"),material:Po("material"),outline:ce("outline"),outlineColor:ce("outlineColor"),outlineWidth:ce("outlineWidth"),numberOfVerticalLines:ce("numberOfVerticalLines"),shadows:ce("shadows"),distanceDisplayCondition:ce("distanceDisplayCondition"),classificationType:ce("classificationType"),zIndex:ce("zIndex")});ty.prototype.clone=function(t){return f(t)?(t.show=this.show,t.semiMajorAxis=this.semiMajorAxis,t.semiMinorAxis=this.semiMinorAxis,t.height=this.height,t.heightReference=this.heightReference,t.extrudedHeight=this.extrudedHeight,t.extrudedHeightReference=this.extrudedHeightReference,t.rotation=this.rotation,t.stRotation=this.stRotation,t.granularity=this.granularity,t.fill=this.fill,t.material=this.material,t.outline=this.outline,t.outlineColor=this.outlineColor,t.outlineWidth=this.outlineWidth,t.numberOfVerticalLines=this.numberOfVerticalLines,t.shadows=this.shadows,t.distanceDisplayCondition=this.distanceDisplayCondition,t.classificationType=this.classificationType,t.zIndex=this.zIndex,t):new ty(this)};ty.prototype.merge=function(t){this.show=A(this.show,t.show),this.semiMajorAxis=A(this.semiMajorAxis,t.semiMajorAxis),this.semiMinorAxis=A(this.semiMinorAxis,t.semiMinorAxis),this.height=A(this.height,t.height),this.heightReference=A(this.heightReference,t.heightReference),this.extrudedHeight=A(this.extrudedHeight,t.extrudedHeight),this.extrudedHeightReference=A(this.extrudedHeightReference,t.extrudedHeightReference),this.rotation=A(this.rotation,t.rotation),this.stRotation=A(this.stRotation,t.stRotation),this.granularity=A(this.granularity,t.granularity),this.fill=A(this.fill,t.fill),this.material=A(this.material,t.material),this.outline=A(this.outline,t.outline),this.outlineColor=A(this.outlineColor,t.outlineColor),this.outlineWidth=A(this.outlineWidth,t.outlineWidth),this.numberOfVerticalLines=A(this.numberOfVerticalLines,t.numberOfVerticalLines),this.shadows=A(this.shadows,t.shadows),this.distanceDisplayCondition=A(this.distanceDisplayCondition,t.distanceDisplayCondition),this.classificationType=A(this.classificationType,t.classificationType),this.zIndex=A(this.zIndex,t.zIndex)};ty.prototype.setStatic=function(){this.isDynamic=!1};ty.prototype.setDynamic=function(){this.isDynamic=!0};var _x=ty;function OS(t){this._definitionChanged=new Ae,this._show=void 0,this._showSubscription=void 0,this._radii=void 0,this._radiiSubscription=void 0,this._innerRadii=void 0,this._innerRadiiSubscription=void 0,this._minimumClock=void 0,this._minimumClockSubscription=void 0,this._maximumClock=void 0,this._maximumClockSubscription=void 0,this._minimumCone=void 0,this._minimumConeSubscription=void 0,this._maximumCone=void 0,this._maximumConeSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._stackPartitions=void 0,this._stackPartitionsSubscription=void 0,this._slicePartitions=void 0,this._slicePartitionsSubscription=void 0,this._subdivisions=void 0,this._subdivisionsSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this.merge(A(t,A.EMPTY_OBJECT))}Object.defineProperties(OS.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:ce("show"),radii:ce("radii"),innerRadii:ce("innerRadii"),minimumClock:ce("minimumClock"),maximumClock:ce("maximumClock"),minimumCone:ce("minimumCone"),maximumCone:ce("maximumCone"),heightReference:ce("heightReference"),fill:ce("fill"),material:Po("material"),outline:ce("outline"),outlineColor:ce("outlineColor"),outlineWidth:ce("outlineWidth"),stackPartitions:ce("stackPartitions"),slicePartitions:ce("slicePartitions"),subdivisions:ce("subdivisions"),shadows:ce("shadows"),distanceDisplayCondition:ce("distanceDisplayCondition")});OS.prototype.clone=function(t){return f(t)?(t.show=this.show,t.radii=this.radii,t.innerRadii=this.innerRadii,t.minimumClock=this.minimumClock,t.maximumClock=this.maximumClock,t.minimumCone=this.minimumCone,t.maximumCone=this.maximumCone,t.heightReference=this.heightReference,t.fill=this.fill,t.material=this.material,t.outline=this.outline,t.outlineColor=this.outlineColor,t.outlineWidth=this.outlineWidth,t.stackPartitions=this.stackPartitions,t.slicePartitions=this.slicePartitions,t.subdivisions=this.subdivisions,t.shadows=this.shadows,t.distanceDisplayCondition=this.distanceDisplayCondition,t):new OS(this)};OS.prototype.merge=function(t){this.show=A(this.show,t.show),this.radii=A(this.radii,t.radii),this.innerRadii=A(this.innerRadii,t.innerRadii),this.minimumClock=A(this.minimumClock,t.minimumClock),this.maximumClock=A(this.maximumClock,t.maximumClock),this.minimumCone=A(this.minimumCone,t.minimumCone),this.maximumCone=A(this.maximumCone,t.maximumCone),this.heightReference=A(this.heightReference,t.heightReference),this.fill=A(this.fill,t.fill),this.material=A(this.material,t.material),this.outline=A(this.outline,t.outline),this.outlineColor=A(this.outlineColor,t.outlineColor),this.outlineWidth=A(this.outlineWidth,t.outlineWidth),this.stackPartitions=A(this.stackPartitions,t.stackPartitions),this.slicePartitions=A(this.slicePartitions,t.slicePartitions),this.subdivisions=A(this.subdivisions,t.subdivisions),this.shadows=A(this.shadows,t.shadows),this.distanceDisplayCondition=A(this.distanceDisplayCondition,t.distanceDisplayCondition)};var gx=OS;function RS(t){this._definitionChanged=new Ae,this._show=void 0,this._showSubscription=void 0,this._text=void 0,this._textSubscription=void 0,this._font=void 0,this._fontSubscription=void 0,this._style=void 0,this._styleSubscription=void 0,this._scale=void 0,this._scaleSubscription=void 0,this._showBackground=void 0,this._showBackgroundSubscription=void 0,this._backgroundColor=void 0,this._backgroundColorSubscription=void 0,this._backgroundPadding=void 0,this._backgroundPaddingSubscription=void 0,this._pixelOffset=void 0,this._pixelOffsetSubscription=void 0,this._eyeOffset=void 0,this._eyeOffsetSubscription=void 0,this._horizontalOrigin=void 0,this._horizontalOriginSubscription=void 0,this._verticalOrigin=void 0,this._verticalOriginSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._fillColor=void 0,this._fillColorSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._translucencyByDistance=void 0,this._translucencyByDistanceSubscription=void 0,this._pixelOffsetScaleByDistance=void 0,this._pixelOffsetScaleByDistanceSubscription=void 0,this._scaleByDistance=void 0,this._scaleByDistanceSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._disableDepthTestDistance=void 0,this._disableDepthTestDistanceSubscription=void 0,this.merge(A(t,A.EMPTY_OBJECT))}Object.defineProperties(RS.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:ce("show"),text:ce("text"),font:ce("font"),style:ce("style"),scale:ce("scale"),showBackground:ce("showBackground"),backgroundColor:ce("backgroundColor"),backgroundPadding:ce("backgroundPadding"),pixelOffset:ce("pixelOffset"),eyeOffset:ce("eyeOffset"),horizontalOrigin:ce("horizontalOrigin"),verticalOrigin:ce("verticalOrigin"),heightReference:ce("heightReference"),fillColor:ce("fillColor"),outlineColor:ce("outlineColor"),outlineWidth:ce("outlineWidth"),translucencyByDistance:ce("translucencyByDistance"),pixelOffsetScaleByDistance:ce("pixelOffsetScaleByDistance"),scaleByDistance:ce("scaleByDistance"),distanceDisplayCondition:ce("distanceDisplayCondition"),disableDepthTestDistance:ce("disableDepthTestDistance")});RS.prototype.clone=function(t){return f(t)?(t.show=this.show,t.text=this.text,t.font=this.font,t.style=this.style,t.scale=this.scale,t.showBackground=this.showBackground,t.backgroundColor=this.backgroundColor,t.backgroundPadding=this.backgroundPadding,t.pixelOffset=this.pixelOffset,t.eyeOffset=this.eyeOffset,t.horizontalOrigin=this.horizontalOrigin,t.verticalOrigin=this.verticalOrigin,t.heightReference=this.heightReference,t.fillColor=this.fillColor,t.outlineColor=this.outlineColor,t.outlineWidth=this.outlineWidth,t.translucencyByDistance=this.translucencyByDistance,t.pixelOffsetScaleByDistance=this.pixelOffsetScaleByDistance,t.scaleByDistance=this.scaleByDistance,t.distanceDisplayCondition=this.distanceDisplayCondition,t.disableDepthTestDistance=this.disableDepthTestDistance,t):new RS(this)};RS.prototype.merge=function(t){this.show=A(this.show,t.show),this.text=A(this.text,t.text),this.font=A(this.font,t.font),this.style=A(this.style,t.style),this.scale=A(this.scale,t.scale),this.showBackground=A(this.showBackground,t.showBackground),this.backgroundColor=A(this.backgroundColor,t.backgroundColor),this.backgroundPadding=A(this.backgroundPadding,t.backgroundPadding),this.pixelOffset=A(this.pixelOffset,t.pixelOffset),this.eyeOffset=A(this.eyeOffset,t.eyeOffset),this.horizontalOrigin=A(this.horizontalOrigin,t.horizontalOrigin),this.verticalOrigin=A(this.verticalOrigin,t.verticalOrigin),this.heightReference=A(this.heightReference,t.heightReference),this.fillColor=A(this.fillColor,t.fillColor),this.outlineColor=A(this.outlineColor,t.outlineColor),this.outlineWidth=A(this.outlineWidth,t.outlineWidth),this.translucencyByDistance=A(this.translucencyByDistance,t.translucencyByDistance),this.pixelOffsetScaleByDistance=A(this.pixelOffsetScaleByDistance,t.pixelOffsetScaleByDistance),this.scaleByDistance=A(this.scaleByDistance,t.scaleByDistance),this.distanceDisplayCondition=A(this.distanceDisplayCondition,t.distanceDisplayCondition),this.disableDepthTestDistance=A(this.disableDepthTestDistance,t.disableDepthTestDistance)};var th=RS;var YG=new H0;function MS(t){t=A(t,A.EMPTY_OBJECT),this._definitionChanged=new Ae,this._translation=void 0,this._translationSubscription=void 0,this._rotation=void 0,this._rotationSubscription=void 0,this._scale=void 0,this._scaleSubscription=void 0,this.translation=t.translation,this.rotation=t.rotation,this.scale=t.scale}Object.defineProperties(MS.prototype,{isConstant:{get:function(){return q.isConstant(this._translation)&&q.isConstant(this._rotation)&&q.isConstant(this._scale)}},definitionChanged:{get:function(){return this._definitionChanged}},translation:ce("translation"),rotation:ce("rotation"),scale:ce("scale")});MS.prototype.getValue=function(t,n){return f(n)||(n=new H0),n.translation=q.getValueOrClonedDefault(this._translation,t,YG.translation,n.translation),n.rotation=q.getValueOrClonedDefault(this._rotation,t,YG.rotation,n.rotation),n.scale=q.getValueOrClonedDefault(this._scale,t,YG.scale,n.scale),n};MS.prototype.equals=function(t){return this===t||t instanceof MS&&q.equals(this._translation,t._translation)&&q.equals(this._rotation,t._rotation)&&q.equals(this._scale,t._scale)};var yx=MS;function Mm(t,n){this._propertyNames=[],this._definitionChanged=new Ae,f(t)&&this.merge(t,n)}Object.defineProperties(Mm.prototype,{propertyNames:{get:function(){return this._propertyNames}},isConstant:{get:function(){let t=this._propertyNames;for(let n=0,i=t.length;n<i;n++)if(!q.isConstant(this[t[n]]))return!1;return!0}},definitionChanged:{get:function(){return this._definitionChanged}}});Mm.prototype.hasProperty=function(t){return this._propertyNames.indexOf(t)!==-1};function JNe(t){return new Kn(t)}Mm.prototype.addProperty=function(t,n,i){this._propertyNames.push(t),Object.defineProperty(this,t,ce(t,!0,A(i,JNe))),f(n)&&(this[t]=n),this._definitionChanged.raiseEvent(this)};Mm.prototype.removeProperty=function(t){let i=this._propertyNames.indexOf(t);this._propertyNames.splice(i,1),delete this[t],this._definitionChanged.raiseEvent(this)};Mm.prototype.getValue=function(t,n){f(n)||(n={});let i=this._propertyNames;for(let o=0,r=i.length;o<r;o++){let s=i[o];n[s]=q.getValueOrUndefined(this[s],t,n[s])}return n};Mm.prototype.merge=function(t,n){let i=this._propertyNames,o=f(t._propertyNames)?t._propertyNames:Object.keys(t);for(let r=0,s=o.length;r<s;r++){let a=o[r],c=this[a],l=t[a];c===void 0&&i.indexOf(a)===-1&&this.addProperty(a,void 0,n),l!==void 0&&(c!==void 0?f(c)&&f(c.merge)&&c.merge(l):f(l)&&f(l.merge)&&f(l.clone)?this[a]=l.clone():this[a]=l)}};function ZNe(t,n){let i=t._propertyNames,o=n._propertyNames,r=i.length;if(r!==o.length)return!1;for(let s=0;s<r;++s){let a=i[s];if(o.indexOf(a)===-1||!q.equals(t[a],n[a]))return!1}return!0}Mm.prototype.equals=function(t){return this===t||t instanceof Mm&&ZNe(this,t)};var Pl=Mm;function ste(t){return new yx(t)}function QNe(t){return new Pl(t,ste)}function $Ne(t){return new Pl(t)}function LS(t){this._definitionChanged=new Ae,this._show=void 0,this._showSubscription=void 0,this._uri=void 0,this._uriSubscription=void 0,this._scale=void 0,this._scaleSubscription=void 0,this._minimumPixelSize=void 0,this._minimumPixelSizeSubscription=void 0,this._maximumScale=void 0,this._maximumScaleSubscription=void 0,this._incrementallyLoadTextures=void 0,this._incrementallyLoadTexturesSubscription=void 0,this._runAnimations=void 0,this._runAnimationsSubscription=void 0,this._clampAnimations=void 0,this._clampAnimationsSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._silhouetteColor=void 0,this._silhouetteColorSubscription=void 0,this._silhouetteSize=void 0,this._silhouetteSizeSubscription=void 0,this._color=void 0,this._colorSubscription=void 0,this._colorBlendMode=void 0,this._colorBlendModeSubscription=void 0,this._colorBlendAmount=void 0,this._colorBlendAmountSubscription=void 0,this._imageBasedLightingFactor=void 0,this._imageBasedLightingFactorSubscription=void 0,this._lightColor=void 0,this._lightColorSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._nodeTransformations=void 0,this._nodeTransformationsSubscription=void 0,this._articulations=void 0,this._articulationsSubscription=void 0,this._clippingPlanes=void 0,this._clippingPlanesSubscription=void 0,this._customShader=void 0,this._customShaderSubscription=void 0,this.merge(A(t,A.EMPTY_OBJECT))}Object.defineProperties(LS.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:ce("show"),uri:ce("uri"),scale:ce("scale"),minimumPixelSize:ce("minimumPixelSize"),maximumScale:ce("maximumScale"),incrementallyLoadTextures:ce("incrementallyLoadTextures"),runAnimations:ce("runAnimations"),clampAnimations:ce("clampAnimations"),shadows:ce("shadows"),heightReference:ce("heightReference"),silhouetteColor:ce("silhouetteColor"),silhouetteSize:ce("silhouetteSize"),color:ce("color"),colorBlendMode:ce("colorBlendMode"),colorBlendAmount:ce("colorBlendAmount"),imageBasedLightingFactor:ce("imageBasedLightingFactor"),lightColor:ce("lightColor"),distanceDisplayCondition:ce("distanceDisplayCondition"),nodeTransformations:ce("nodeTransformations",void 0,QNe),articulations:ce("articulations",void 0,$Ne),clippingPlanes:ce("clippingPlanes"),customShader:ce("customShader")});LS.prototype.clone=function(t){return f(t)?(t.show=this.show,t.uri=this.uri,t.scale=this.scale,t.minimumPixelSize=this.minimumPixelSize,t.maximumScale=this.maximumScale,t.incrementallyLoadTextures=this.incrementallyLoadTextures,t.runAnimations=this.runAnimations,t.clampAnimations=this.clampAnimations,t.heightReference=this._heightReference,t.silhouetteColor=this.silhouetteColor,t.silhouetteSize=this.silhouetteSize,t.color=this.color,t.colorBlendMode=this.colorBlendMode,t.colorBlendAmount=this.colorBlendAmount,t.imageBasedLightingFactor=this.imageBasedLightingFactor,t.lightColor=this.lightColor,t.distanceDisplayCondition=this.distanceDisplayCondition,t.nodeTransformations=this.nodeTransformations,t.articulations=this.articulations,t.clippingPlanes=this.clippingPlanes,t.customShader=this.customShader,t):new LS(this)};LS.prototype.merge=function(t){this.show=A(this.show,t.show),this.uri=A(this.uri,t.uri),this.scale=A(this.scale,t.scale),this.minimumPixelSize=A(this.minimumPixelSize,t.minimumPixelSize),this.maximumScale=A(this.maximumScale,t.maximumScale),this.incrementallyLoadTextures=A(this.incrementallyLoadTextures,t.incrementallyLoadTextures),this.runAnimations=A(this.runAnimations,t.runAnimations),this.clampAnimations=A(this.clampAnimations,t.clampAnimations),this.shadows=A(this.shadows,t.shadows),this.heightReference=A(this.heightReference,t.heightReference),this.silhouetteColor=A(this.silhouetteColor,t.silhouetteColor),this.silhouetteSize=A(this.silhouetteSize,t.silhouetteSize),this.color=A(this.color,t.color),this.colorBlendMode=A(this.colorBlendMode,t.colorBlendMode),this.colorBlendAmount=A(this.colorBlendAmount,t.colorBlendAmount),this.imageBasedLightingFactor=A(this.imageBasedLightingFactor,t.imageBasedLightingFactor),this.lightColor=A(this.lightColor,t.lightColor),this.distanceDisplayCondition=A(this.distanceDisplayCondition,t.distanceDisplayCondition),this.clippingPlanes=A(this.clippingPlanes,t.clippingPlanes),this.customShader=A(this.customShader,t.customShader);let n=t.nodeTransformations;if(f(n)){let o=this.nodeTransformations;f(o)?o.merge(n):this.nodeTransformations=new Pl(n,ste)}let i=t.articulations;if(f(i)){let o=this.articulations;f(o)?o.merge(i):this.articulations=new Pl(i)}};var y_=LS;function FS(t){this._definitionChanged=new Ae,this._show=void 0,this._showSubscription=void 0,this._uri=void 0,this._uriSubscription=void 0,this._maximumScreenSpaceError=void 0,this._maximumScreenSpaceErrorSubscription=void 0,this.merge(A(t,A.EMPTY_OBJECT))}Object.defineProperties(FS.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:ce("show"),uri:ce("uri"),maximumScreenSpaceError:ce("maximumScreenSpaceError")});FS.prototype.clone=function(t){return f(t)?(t.show=this.show,t.uri=this.uri,t.maximumScreenSpaceError=this.maximumScreenSpaceError,t):new FS(this)};FS.prototype.merge=function(t){this.show=A(this.show,t.show),this.uri=A(this.uri,t.uri),this.maximumScreenSpaceError=A(this.maximumScreenSpaceError,t.maximumScreenSpaceError)};var Ax=FS;function NS(t){this._definitionChanged=new Ae,this._show=void 0,this._showSubscription=void 0,this._leadTime=void 0,this._leadTimeSubscription=void 0,this._trailTime=void 0,this._trailTimeSubscription=void 0,this._width=void 0,this._widthSubscription=void 0,this._resolution=void 0,this._resolutionSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this.merge(A(t,A.EMPTY_OBJECT))}Object.defineProperties(NS.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:ce("show"),leadTime:ce("leadTime"),trailTime:ce("trailTime"),width:ce("width"),resolution:ce("resolution"),material:Po("material"),distanceDisplayCondition:ce("distanceDisplayCondition")});NS.prototype.clone=function(t){return f(t)?(t.show=this.show,t.leadTime=this.leadTime,t.trailTime=this.trailTime,t.width=this.width,t.resolution=this.resolution,t.material=this.material,t.distanceDisplayCondition=this.distanceDisplayCondition,t):new NS(this)};NS.prototype.merge=function(t){this.show=A(this.show,t.show),this.leadTime=A(this.leadTime,t.leadTime),this.trailTime=A(this.trailTime,t.trailTime),this.width=A(this.width,t.width),this.resolution=A(this.resolution,t.resolution),this.material=A(this.material,t.material),this.distanceDisplayCondition=A(this.distanceDisplayCondition,t.distanceDisplayCondition)};var A_=NS;function VS(t){this._definitionChanged=new Ae,this._show=void 0,this._showSubscription=void 0,this._plane=void 0,this._planeSubscription=void 0,this._dimensions=void 0,this._dimensionsSubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this.merge(A(t,A.EMPTY_OBJECT))}Object.defineProperties(VS.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:ce("show"),plane:ce("plane"),dimensions:ce("dimensions"),fill:ce("fill"),material:Po("material"),outline:ce("outline"),outlineColor:ce("outlineColor"),outlineWidth:ce("outlineWidth"),shadows:ce("shadows"),distanceDisplayCondition:ce("distanceDisplayCondition")});VS.prototype.clone=function(t){return f(t)?(t.show=this.show,t.plane=this.plane,t.dimensions=this.dimensions,t.fill=this.fill,t.material=this.material,t.outline=this.outline,t.outlineColor=this.outlineColor,t.outlineWidth=this.outlineWidth,t.shadows=this.shadows,t.distanceDisplayCondition=this.distanceDisplayCondition,t):new VS(this)};VS.prototype.merge=function(t){this.show=A(this.show,t.show),this.plane=A(this.plane,t.plane),this.dimensions=A(this.dimensions,t.dimensions),this.fill=A(this.fill,t.fill),this.material=A(this.material,t.material),this.outline=A(this.outline,t.outline),this.outlineColor=A(this.outlineColor,t.outlineColor),this.outlineWidth=A(this.outlineWidth,t.outlineWidth),this.shadows=A(this.shadows,t.shadows),this.distanceDisplayCondition=A(this.distanceDisplayCondition,t.distanceDisplayCondition)};var xL=VS;function kS(t){this._definitionChanged=new Ae,this._show=void 0,this._showSubscription=void 0,this._pixelSize=void 0,this._pixelSizeSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._color=void 0,this._colorSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._scaleByDistance=void 0,this._scaleByDistanceSubscription=void 0,this._translucencyByDistance=void 0,this._translucencyByDistanceSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._disableDepthTestDistance=void 0,this._disableDepthTestDistanceSubscription=void 0,this.merge(A(t,A.EMPTY_OBJECT))}Object.defineProperties(kS.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:ce("show"),pixelSize:ce("pixelSize"),heightReference:ce("heightReference"),color:ce("color"),outlineColor:ce("outlineColor"),outlineWidth:ce("outlineWidth"),scaleByDistance:ce("scaleByDistance"),translucencyByDistance:ce("translucencyByDistance"),distanceDisplayCondition:ce("distanceDisplayCondition"),disableDepthTestDistance:ce("disableDepthTestDistance")});kS.prototype.clone=function(t){return f(t)?(t.show=this.show,t.pixelSize=this.pixelSize,t.heightReference=this.heightReference,t.color=this.color,t.outlineColor=this.outlineColor,t.outlineWidth=this.outlineWidth,t.scaleByDistance=this.scaleByDistance,t.translucencyByDistance=this._translucencyByDistance,t.distanceDisplayCondition=this.distanceDisplayCondition,t.disableDepthTestDistance=this.disableDepthTestDistance,t):new kS(this)};kS.prototype.merge=function(t){this.show=A(this.show,t.show),this.pixelSize=A(this.pixelSize,t.pixelSize),this.heightReference=A(this.heightReference,t.heightReference),this.color=A(this.color,t.color),this.outlineColor=A(this.outlineColor,t.outlineColor),this.outlineWidth=A(this.outlineWidth,t.outlineWidth),this.scaleByDistance=A(this.scaleByDistance,t.scaleByDistance),this.translucencyByDistance=A(this._translucencyByDistance,t.translucencyByDistance),this.distanceDisplayCondition=A(this.distanceDisplayCondition,t.distanceDisplayCondition),this.disableDepthTestDistance=A(this.disableDepthTestDistance,t.disableDepthTestDistance)};var Cx=kS;function e2e(t,n){this.positions=f(t)?t:[],this.holes=f(n)?n:[]}var Zc=e2e;function t2e(t){return Array.isArray(t)&&(t=new Zc(t)),new Kn(t)}function ny(t){this._definitionChanged=new Ae,this._show=void 0,this._showSubscription=void 0,this._hierarchy=void 0,this._hierarchySubscription=void 0,this._height=void 0,this._heightSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._extrudedHeight=void 0,this._extrudedHeightSubscription=void 0,this._extrudedHeightReference=void 0,this._extrudedHeightReferenceSubscription=void 0,this._stRotation=void 0,this._stRotationSubscription=void 0,this._granularity=void 0,this._granularitySubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._perPositionHeight=void 0,this._perPositionHeightSubscription=void 0,this._closeTop=void 0,this._closeTopSubscription=void 0,this._closeBottom=void 0,this._closeBottomSubscription=void 0,this._arcType=void 0,this._arcTypeSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._classificationType=void 0,this._classificationTypeSubscription=void 0,this._zIndex=void 0,this._zIndexSubscription=void 0,this._textureCoordinates=void 0,this._textureCoordinatesSubscription=void 0,this.merge(A(t,A.EMPTY_OBJECT))}Object.defineProperties(ny.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:ce("show"),hierarchy:ce("hierarchy",void 0,t2e),height:ce("height"),heightReference:ce("heightReference"),extrudedHeight:ce("extrudedHeight"),extrudedHeightReference:ce("extrudedHeightReference"),stRotation:ce("stRotation"),granularity:ce("granularity"),fill:ce("fill"),material:Po("material"),outline:ce("outline"),outlineColor:ce("outlineColor"),outlineWidth:ce("outlineWidth"),perPositionHeight:ce("perPositionHeight"),closeTop:ce("closeTop"),closeBottom:ce("closeBottom"),arcType:ce("arcType"),shadows:ce("shadows"),distanceDisplayCondition:ce("distanceDisplayCondition"),classificationType:ce("classificationType"),zIndex:ce("zIndex"),textureCoordinates:ce("textureCoordinates")});ny.prototype.clone=function(t){return f(t)?(t.show=this.show,t.hierarchy=this.hierarchy,t.height=this.height,t.heightReference=this.heightReference,t.extrudedHeight=this.extrudedHeight,t.extrudedHeightReference=this.extrudedHeightReference,t.stRotation=this.stRotation,t.granularity=this.granularity,t.fill=this.fill,t.material=this.material,t.outline=this.outline,t.outlineColor=this.outlineColor,t.outlineWidth=this.outlineWidth,t.perPositionHeight=this.perPositionHeight,t.closeTop=this.closeTop,t.closeBottom=this.closeBottom,t.arcType=this.arcType,t.shadows=this.shadows,t.distanceDisplayCondition=this.distanceDisplayCondition,t.classificationType=this.classificationType,t.zIndex=this.zIndex,t.textureCoordinates=this.textureCoordinates,t):new ny(this)};ny.prototype.merge=function(t){this.show=A(this.show,t.show),this.hierarchy=A(this.hierarchy,t.hierarchy),this.height=A(this.height,t.height),this.heightReference=A(this.heightReference,t.heightReference),this.extrudedHeight=A(this.extrudedHeight,t.extrudedHeight),this.extrudedHeightReference=A(this.extrudedHeightReference,t.extrudedHeightReference),this.stRotation=A(this.stRotation,t.stRotation),this.granularity=A(this.granularity,t.granularity),this.fill=A(this.fill,t.fill),this.material=A(this.material,t.material),this.outline=A(this.outline,t.outline),this.outlineColor=A(this.outlineColor,t.outlineColor),this.outlineWidth=A(this.outlineWidth,t.outlineWidth),this.perPositionHeight=A(this.perPositionHeight,t.perPositionHeight),this.closeTop=A(this.closeTop,t.closeTop),this.closeBottom=A(this.closeBottom,t.closeBottom),this.arcType=A(this.arcType,t.arcType),this.shadows=A(this.shadows,t.shadows),this.distanceDisplayCondition=A(this.distanceDisplayCondition,t.distanceDisplayCondition),this.classificationType=A(this.classificationType,t.classificationType),this.zIndex=A(this.zIndex,t.zIndex),this.textureCoordinates=A(this.textureCoordinates,t.textureCoordinates)};ny.prototype.setStatic=function(){this.isDynamic=!1};ny.prototype.setDynamic=function(){this.isDynamic=!0};var nh=ny;function iy(t){this._definitionChanged=new Ae,this._show=void 0,this._showSubscription=void 0,this._positions=void 0,this._positionsSubscription=void 0,this._width=void 0,this._widthSubscription=void 0,this._granularity=void 0,this._granularitySubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._depthFailMaterial=void 0,this._depthFailMaterialSubscription=void 0,this._arcType=void 0,this._arcTypeSubscription=void 0,this._clampToGround=void 0,this._clampToGroundSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._classificationType=void 0,this._classificationTypeSubscription=void 0,this._zIndex=void 0,this._zIndexSubscription=void 0,this.merge(A(t,A.EMPTY_OBJECT))}Object.defineProperties(iy.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:ce("show"),positions:ce("positions"),width:ce("width"),granularity:ce("granularity"),material:Po("material"),depthFailMaterial:Po("depthFailMaterial"),arcType:ce("arcType"),clampToGround:ce("clampToGround"),shadows:ce("shadows"),distanceDisplayCondition:ce("distanceDisplayCondition"),classificationType:ce("classificationType"),zIndex:ce("zIndex")});iy.prototype.clone=function(t){return f(t)?(t.show=this.show,t.positions=this.positions,t.width=this.width,t.granularity=this.granularity,t.material=this.material,t.depthFailMaterial=this.depthFailMaterial,t.arcType=this.arcType,t.clampToGround=this.clampToGround,t.shadows=this.shadows,t.distanceDisplayCondition=this.distanceDisplayCondition,t.classificationType=this.classificationType,t.zIndex=this.zIndex,t):new iy(this)};iy.prototype.merge=function(t){this.show=A(this.show,t.show),this.positions=A(this.positions,t.positions),this.width=A(this.width,t.width),this.granularity=A(this.granularity,t.granularity),this.material=A(this.material,t.material),this.depthFailMaterial=A(this.depthFailMaterial,t.depthFailMaterial),this.arcType=A(this.arcType,t.arcType),this.clampToGround=A(this.clampToGround,t.clampToGround),this.shadows=A(this.shadows,t.shadows),this.distanceDisplayCondition=A(this.distanceDisplayCondition,t.distanceDisplayCondition),this.classificationType=A(this.classificationType,t.classificationType),this.zIndex=A(this.zIndex,t.zIndex)};iy.prototype.setStatic=function(){this.isDynamic=!1};iy.prototype.setDynamic=function(){this.isDynamic=!0};var dc=iy;function US(t){this._definitionChanged=new Ae,this._show=void 0,this._showSubscription=void 0,this._positions=void 0,this._positionsSubscription=void 0,this._shape=void 0,this._shapeSubscription=void 0,this._cornerType=void 0,this._cornerTypeSubscription=void 0,this._granularity=void 0,this._granularitySubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubsription=void 0,this.merge(A(t,A.EMPTY_OBJECT))}Object.defineProperties(US.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:ce("show"),positions:ce("positions"),shape:ce("shape"),cornerType:ce("cornerType"),granularity:ce("granularity"),fill:ce("fill"),material:Po("material"),outline:ce("outline"),outlineColor:ce("outlineColor"),outlineWidth:ce("outlineWidth"),shadows:ce("shadows"),distanceDisplayCondition:ce("distanceDisplayCondition")});US.prototype.clone=function(t){return f(t)?(t.show=this.show,t.positions=this.positions,t.shape=this.shape,t.cornerType=this.cornerType,t.granularity=this.granularity,t.fill=this.fill,t.material=this.material,t.outline=this.outline,t.outlineColor=this.outlineColor,t.outlineWidth=this.outlineWidth,t.shadows=this.shadows,t.distanceDisplayCondition=this.distanceDisplayCondition,t):new US(this)};US.prototype.merge=function(t){this.show=A(this.show,t.show),this.positions=A(this.positions,t.positions),this.shape=A(this.shape,t.shape),this.cornerType=A(this.cornerType,t.cornerType),this.granularity=A(this.granularity,t.granularity),this.fill=A(this.fill,t.fill),this.material=A(this.material,t.material),this.outline=A(this.outline,t.outline),this.outlineColor=A(this.outlineColor,t.outlineColor),this.outlineWidth=A(this.outlineWidth,t.outlineWidth),this.shadows=A(this.shadows,t.shadows),this.distanceDisplayCondition=A(this.distanceDisplayCondition,t.distanceDisplayCondition)};var xx=US;function oy(t){this._definitionChanged=new Ae,this._show=void 0,this._showSubscription=void 0,this._coordinates=void 0,this._coordinatesSubscription=void 0,this._height=void 0,this._heightSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._extrudedHeight=void 0,this._extrudedHeightSubscription=void 0,this._extrudedHeightReference=void 0,this._extrudedHeightReferenceSubscription=void 0,this._rotation=void 0,this._rotationSubscription=void 0,this._stRotation=void 0,this._stRotationSubscription=void 0,this._granularity=void 0,this._granularitySubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distancedisplayConditionSubscription=void 0,this._classificationType=void 0,this._classificationTypeSubscription=void 0,this._zIndex=void 0,this._zIndexSubscription=void 0,this.merge(A(t,A.EMPTY_OBJECT))}Object.defineProperties(oy.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:ce("show"),coordinates:ce("coordinates"),height:ce("height"),heightReference:ce("heightReference"),extrudedHeight:ce("extrudedHeight"),extrudedHeightReference:ce("extrudedHeightReference"),rotation:ce("rotation"),stRotation:ce("stRotation"),granularity:ce("granularity"),fill:ce("fill"),material:Po("material"),outline:ce("outline"),outlineColor:ce("outlineColor"),outlineWidth:ce("outlineWidth"),shadows:ce("shadows"),distanceDisplayCondition:ce("distanceDisplayCondition"),classificationType:ce("classificationType"),zIndex:ce("zIndex")});oy.prototype.clone=function(t){return f(t)?(t.show=this.show,t.coordinates=this.coordinates,t.height=this.height,t.heightReference=this.heightReference,t.extrudedHeight=this.extrudedHeight,t.extrudedHeightReference=this.extrudedHeightReference,t.rotation=this.rotation,t.stRotation=this.stRotation,t.granularity=this.granularity,t.fill=this.fill,t.material=this.material,t.outline=this.outline,t.outlineColor=this.outlineColor,t.outlineWidth=this.outlineWidth,t.shadows=this.shadows,t.distanceDisplayCondition=this.distanceDisplayCondition,t.classificationType=this.classificationType,t.zIndex=this.zIndex,t):new oy(this)};oy.prototype.merge=function(t){this.show=A(this.show,t.show),this.coordinates=A(this.coordinates,t.coordinates),this.height=A(this.height,t.height),this.heightReference=A(this.heightReference,t.heightReference),this.extrudedHeight=A(this.extrudedHeight,t.extrudedHeight),this.extrudedHeightReference=A(this.extrudedHeightReference,t.extrudedHeightReference),this.rotation=A(this.rotation,t.rotation),this.stRotation=A(this.stRotation,t.stRotation),this.granularity=A(this.granularity,t.granularity),this.fill=A(this.fill,t.fill),this.material=A(this.material,t.material),this.outline=A(this.outline,t.outline),this.outlineColor=A(this.outlineColor,t.outlineColor),this.outlineWidth=A(this.outlineWidth,t.outlineWidth),this.shadows=A(this.shadows,t.shadows),this.distanceDisplayCondition=A(this.distanceDisplayCondition,t.distanceDisplayCondition),this.classificationType=A(this.classificationType,t.classificationType),this.zIndex=A(this.zIndex,t.zIndex)};oy.prototype.setStatic=function(){this.isDynamic=!1};oy.prototype.setDynamic=function(){this.isDynamic=!0};var ih=oy;function ry(t){this._definitionChanged=new Ae,this._show=void 0,this._showSubscription=void 0,this._positions=void 0,this._positionsSubscription=void 0,this._minimumHeights=void 0,this._minimumHeightsSubscription=void 0,this._maximumHeights=void 0,this._maximumHeightsSubscription=void 0,this._granularity=void 0,this._granularitySubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this.merge(A(t,A.EMPTY_OBJECT))}Object.defineProperties(ry.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:ce("show"),positions:ce("positions"),minimumHeights:ce("minimumHeights"),maximumHeights:ce("maximumHeights"),granularity:ce("granularity"),fill:ce("fill"),material:Po("material"),outline:ce("outline"),outlineColor:ce("outlineColor"),outlineWidth:ce("outlineWidth"),shadows:ce("shadows"),distanceDisplayCondition:ce("distanceDisplayCondition")});ry.prototype.clone=function(t){return f(t)?(t.show=this.show,t.positions=this.positions,t.minimumHeights=this.minimumHeights,t.maximumHeights=this.maximumHeights,t.granularity=this.granularity,t.fill=this.fill,t.material=this.material,t.outline=this.outline,t.outlineColor=this.outlineColor,t.outlineWidth=this.outlineWidth,t.shadows=this.shadows,t.distanceDisplayCondition=this.distanceDisplayCondition,t):new ry(this)};ry.prototype.merge=function(t){this.show=A(this.show,t.show),this.positions=A(this.positions,t.positions),this.minimumHeights=A(this.minimumHeights,t.minimumHeights),this.maximumHeights=A(this.maximumHeights,t.maximumHeights),this.granularity=A(this.granularity,t.granularity),this.fill=A(this.fill,t.fill),this.material=A(this.material,t.material),this.outline=A(this.outline,t.outline),this.outlineColor=A(this.outlineColor,t.outlineColor),this.outlineWidth=A(this.outlineWidth,t.outlineWidth),this.shadows=A(this.shadows,t.shadows),this.distanceDisplayCondition=A(this.distanceDisplayCondition,t.distanceDisplayCondition)};ry.prototype.setStatic=function(){this.isDynamic=!1};ry.prototype.setDynamic=function(){this.isDynamic=!0};var C_=ry;var n2e=new de;function i2e(t){return new Jc(t)}function o2e(t){return ce(t,void 0,i2e)}function Ps(t,n){return ce(t,void 0,function(i){return i instanceof n?i:new n(i)})}function oh(t){t=A(t,A.EMPTY_OBJECT);let n=t.id;f(n)||(n=Bn()),this._availability=void 0,this._id=n,this._definitionChanged=new Ae,this._name=t.name,this._show=A(t.show,!0),this._parent=void 0,this._propertyNames=["billboard","box","corridor","cylinder","description","ellipse","ellipsoid","label","model","tileset","orientation","path","plane","point","polygon","polyline","polylineVolume","position","properties","rectangle","viewFrom","wall"],this._billboard=void 0,this._billboardSubscription=void 0,this._box=void 0,this._boxSubscription=void 0,this._corridor=void 0,this._corridorSubscription=void 0,this._cylinder=void 0,this._cylinderSubscription=void 0,this._description=void 0,this._descriptionSubscription=void 0,this._ellipse=void 0,this._ellipseSubscription=void 0,this._ellipsoid=void 0,this._ellipsoidSubscription=void 0,this._label=void 0,this._labelSubscription=void 0,this._model=void 0,this._modelSubscription=void 0,this._tileset=void 0,this._tilesetSubscription=void 0,this._orientation=void 0,this._orientationSubscription=void 0,this._path=void 0,this._pathSubscription=void 0,this._plane=void 0,this._planeSubscription=void 0,this._point=void 0,this._pointSubscription=void 0,this._polygon=void 0,this._polygonSubscription=void 0,this._polyline=void 0,this._polylineSubscription=void 0,this._polylineVolume=void 0,this._polylineVolumeSubscription=void 0,this._position=void 0,this._positionSubscription=void 0,this._properties=void 0,this._propertiesSubscription=void 0,this._rectangle=void 0,this._rectangleSubscription=void 0,this._viewFrom=void 0,this._viewFromSubscription=void 0,this._wall=void 0,this._wallSubscription=void 0,this._children=[],this.entityCollection=void 0,this.parent=t.parent,this.merge(t)}function XG(t,n,i){let o=n.length;for(let r=0;r<o;r++){let s=n[r],a=s._show;(!i&&a)!==(i&&a)&&XG(s,s._children,i)}t._definitionChanged.raiseEvent(t,"isShowing",i,!i)}Object.defineProperties(oh.prototype,{availability:vl("availability"),id:{get:function(){return this._id}},definitionChanged:{get:function(){return this._definitionChanged}},name:vl("name"),show:{get:function(){return this._show},set:function(t){if(t===this._show)return;let n=this.isShowing;this._show=t;let i=this.isShowing;n!==i&&XG(this,this._children,i),this._definitionChanged.raiseEvent(this,"show",t,!t)}},isShowing:{get:function(){return this._show&&(!f(this.entityCollection)||this.entityCollection.show)&&(!f(this._parent)||this._parent.isShowing)}},parent:{get:function(){return this._parent},set:function(t){let n=this._parent;if(n===t)return;let i=this.isShowing;if(f(n)){let r=n._children.indexOf(this);n._children.splice(r,1)}this._parent=t,f(t)&&t._children.push(this);let o=this.isShowing;i!==o&&XG(this,this._children,o),this._definitionChanged.raiseEvent(this,"parent",t,n)}},propertyNames:{get:function(){return this._propertyNames}},billboard:Ps("billboard",Qa),box:Ps("box",dx),corridor:Ps("corridor",mx),cylinder:Ps("cylinder",px),description:ce("description"),ellipse:Ps("ellipse",_x),ellipsoid:Ps("ellipsoid",gx),label:Ps("label",th),model:Ps("model",y_),tileset:Ps("tileset",Ax),orientation:ce("orientation"),path:Ps("path",A_),plane:Ps("plane",xL),point:Ps("point",Cx),polygon:Ps("polygon",nh),polyline:Ps("polyline",dc),polylineVolume:Ps("polylineVolume",xx),properties:Ps("properties",Pl),position:o2e("position"),rectangle:Ps("rectangle",ih),viewFrom:ce("viewFrom"),wall:Ps("wall",C_)});oh.prototype.isAvailable=function(t){let n=this._availability;return!f(n)||n.contains(t)};oh.prototype.addProperty=function(t){this._propertyNames.push(t),Object.defineProperty(this,t,vl(t,!0))};oh.prototype.removeProperty=function(t){let i=this._propertyNames.indexOf(t);this._propertyNames.splice(i,1),delete this[t]};oh.prototype.merge=function(t){this.name=A(this.name,t.name),this.availability=A(this.availability,t.availability);let n=this._propertyNames,i=f(t._propertyNames)?t._propertyNames:Object.keys(t),o=i.length;for(let r=0;r<o;r++){let s=i[r];if(s==="parent"||s==="name"||s==="availability")continue;let a=this[s],c=t[s];!f(a)&&n.indexOf(s)===-1&&this.addProperty(s),f(c)&&(f(a)?f(a.merge)&&a.merge(c):f(c.merge)&&f(c.clone)?this[s]=c.clone():this[s]=c)}};var ate=new $,cte=new m,lte=new Me;oh.prototype.computeModelMatrix=function(t,n){let i=q.getValueOrUndefined(this._position,t,cte);if(!f(i))return;let o=q.getValueOrUndefined(this._orientation,t,lte);return f(o)?n=N.fromRotationTranslation($.fromQuaternion(o,ate),i,n):n=vt.eastNorthUpToFixedFrame(i,void 0,n),n};oh.prototype.computeModelMatrixForHeightReference=function(t,n,i,o,r){let s=q.getValueOrDefault(n,t,Ge.NONE),a=q.getValueOrUndefined(this._position,t,cte);if(s===Ge.NONE||!f(a)||m.equalsEpsilon(a,m.ZERO,B.EPSILON8))return this.computeModelMatrix(t,r);let c=o.cartesianToCartographic(a,n2e);s===Ge.CLAMP_TO_GROUND?c.height=i:c.height+=i,a=o.cartographicToCartesian(c,a);let l=q.getValueOrUndefined(this._orientation,t,lte);return f(l)?r=N.fromRotationTranslation($.fromQuaternion(l,ate),a,r):r=vt.eastNorthUpToFixedFrame(a,void 0,r),r};oh.supportsMaterialsforEntitiesOnTerrain=function(t){return Kc.supportsMaterials(t)};oh.supportsPolylinesOnTerrain=function(t){return eh.isSupported(t)};var Qo=oh;var r2e=new Rt(z.WHITE),s2e=new Kn(!0),a2e=new Kn(!0),c2e=new Kn(!1),l2e=new Kn(z.BLACK),u2e=new Kn(gn.DISABLED),f2e=new Kn(new wt),d2e=new Kn(Un.BOTH);function hc(t){let n=t.entity,i=t.geometryPropertyName;this._entity=n,this._scene=t.scene,this._fillEnabled=!1,this._isClosed=!1,this._onTerrain=!1,this._dynamic=!1,this._outlineEnabled=!1,this._geometryChanged=new Ae,this._showProperty=void 0,this._materialProperty=void 0,this._showOutlineProperty=void 0,this._outlineColorProperty=void 0,this._outlineWidth=1,this._shadowsProperty=void 0,this._distanceDisplayConditionProperty=void 0,this._classificationTypeProperty=void 0,this._options=t.geometryOptions,this._geometryPropertyName=i,this._id=`${i}-${n.id}`,this._observedPropertyNames=t.observedPropertyNames,this._supportsMaterialsforEntitiesOnTerrain=Qo.supportsMaterialsforEntitiesOnTerrain(t.scene)}Object.defineProperties(hc.prototype,{id:{get:function(){return this._id}},entity:{get:function(){return this._entity}},fillEnabled:{get:function(){return this._fillEnabled}},hasConstantFill:{get:function(){return!this._fillEnabled||!f(this._entity.availability)&&q.isConstant(this._showProperty)&&q.isConstant(this._fillProperty)}},fillMaterialProperty:{get:function(){return this._materialProperty}},outlineEnabled:{get:function(){return this._outlineEnabled}},hasConstantOutline:{get:function(){return!this._outlineEnabled||!f(this._entity.availability)&&q.isConstant(this._showProperty)&&q.isConstant(this._showOutlineProperty)}},outlineColorProperty:{get:function(){return this._outlineColorProperty}},outlineWidth:{get:function(){return this._outlineWidth}},shadowsProperty:{get:function(){return this._shadowsProperty}},distanceDisplayConditionProperty:{get:function(){return this._distanceDisplayConditionProperty}},classificationTypeProperty:{get:function(){return this._classificationTypeProperty}},isDynamic:{get:function(){return this._dynamic}},isClosed:{get:function(){return this._isClosed}},onTerrain:{get:function(){return this._onTerrain}},geometryChanged:{get:function(){return this._geometryChanged}}});hc.prototype.isOutlineVisible=function(t){let n=this._entity,i=this._outlineEnabled&&n.isAvailable(t)&&this._showProperty.getValue(t)&&this._showOutlineProperty.getValue(t);return A(i,!1)};hc.prototype.isFilled=function(t){let n=this._entity,i=this._fillEnabled&&n.isAvailable(t)&&this._showProperty.getValue(t)&&this._fillProperty.getValue(t);return A(i,!1)};hc.prototype.createFillGeometryInstance=Ce.throwInstantiationError;hc.prototype.createOutlineGeometryInstance=Ce.throwInstantiationError;hc.prototype.isDestroyed=function(){return!1};hc.prototype.destroy=function(){ue(this)};hc.prototype._isHidden=function(t,n){let i=n.show;return f(i)&&i.isConstant&&!i.getValue(Ue.MINIMUM_VALUE)};hc.prototype._isOnTerrain=function(t,n){return!1};hc.prototype._getIsClosed=function(t){return!0};hc.prototype._isDynamic=Ce.throwInstantiationError;hc.prototype._setStaticOptions=Ce.throwInstantiationError;hc.prototype._onEntityPropertyChanged=function(t,n,i,o){if(this._observedPropertyNames.indexOf(n)===-1)return;let r=this._entity[this._geometryPropertyName];if(!f(r)){(this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this));return}let s=r.fill,a=f(s)&&s.isConstant?s.getValue(Ue.MINIMUM_VALUE):!0,c=r.outline,l=f(c);if(l&&c.isConstant&&(l=c.getValue(Ue.MINIMUM_VALUE)),!a&&!l){(this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this));return}let u=r.show;if(this._isHidden(t,r)){(this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this));return}this._materialProperty=A(r.material,r2e),this._fillProperty=A(s,a2e),this._showProperty=A(u,s2e),this._showOutlineProperty=A(r.outline,c2e),this._outlineColorProperty=l?A(r.outlineColor,l2e):void 0,this._shadowsProperty=A(r.shadows,u2e),this._distanceDisplayConditionProperty=A(r.distanceDisplayCondition,f2e),this._classificationTypeProperty=A(r.classificationType,d2e),this._fillEnabled=a;let d=this._isOnTerrain(t,r)&&(this._supportsMaterialsforEntitiesOnTerrain||this._materialProperty instanceof Rt);if(l&&d&&(Bt(Bt.geometryOutlines),l=!1),this._onTerrain=d,this._outlineEnabled=l,this._isDynamic(t,r))this._dynamic||(this._dynamic=!0,this._geometryChanged.raiseEvent(this));else{this._setStaticOptions(t,r),this._isClosed=this._getIsClosed(this._options);let h=r.outlineWidth;this._outlineWidth=f(h)?h.getValue(Ue.MINIMUM_VALUE):1,this._dynamic=!1,this._geometryChanged.raiseEvent(this)}};hc.prototype.createDynamicUpdater=function(t,n){return new this.constructor.DynamicGeometryUpdater(this,t,n)};var ti=hc;function Tx(t,n){this._callback=void 0,this._isConstant=void 0,this._definitionChanged=new Ae,this.setCallback(t,n)}Object.defineProperties(Tx.prototype,{isConstant:{get:function(){return this._isConstant}},definitionChanged:{get:function(){return this._definitionChanged}}});Tx.prototype.getValue=function(t,n){return this._callback(t,n)};Tx.prototype.setCallback=function(t,n){let i=this._callback!==t||this._isConstant!==n;this._callback=t,this._isConstant=n,i&&this._definitionChanged.raiseEvent(this)};Tx.prototype.equals=function(t){return this===t||t instanceof Tx&&this._callback===t._callback&&this._isConstant===t._isConstant};var rh=Tx;var ute=new m,h2e=new de;function Ex(t,n,i,o){this._scene=t,this._heightReference=i,this._extrudedHeightReference=o,this._positionProperty=n,this._position=new m,this._cartographicPosition=new de,this._normal=new m,this._definitionChanged=new Ae,this._terrainHeight=0,this._removeCallbackFunc=void 0,this._removeEventListener=void 0,this._removeModeListener=void 0;let r=this;if(f(t.globe)&&(this._removeEventListener=t.terrainProviderChanged.addEventListener(function(){r._updateClamping()}),this._removeModeListener=t.morphComplete.addEventListener(function(){r._updateClamping()})),n.isConstant){let s=n.getValue(Ue.MINIMUM_VALUE,ute);if(!f(s)||m.equals(s,m.ZERO)||!f(t.globe))return;this._position=m.clone(s,this._position),this._updateClamping(),this._normal=t.globe.ellipsoid.geodeticSurfaceNormal(s,this._normal)}}Object.defineProperties(Ex.prototype,{isConstant:{get:function(){return!1}},definitionChanged:{get:function(){return this._definitionChanged}}});Ex.prototype._updateClamping=function(){f(this._removeCallbackFunc)&&this._removeCallbackFunc();let t=this._scene,n=t.globe,i=this._position;if(!f(n)||m.equals(i,m.ZERO)){this._terrainHeight=0;return}let o=n.ellipsoid,r=n._surface,s=this,a=o.cartesianToCartographic(i,this._cartographicPosition),c=n.getHeight(a);f(c)?this._terrainHeight=c:this._terrainHeight=0;function l(u){if(t.mode===ne.SCENE3D){let d=o.cartesianToCartographic(u,h2e);s._terrainHeight=d.height}else s._terrainHeight=u.x;s.definitionChanged.raiseEvent()}this._removeCallbackFunc=r.updateHeight(a,l)};Ex.prototype.getValue=function(t,n){let i=q.getValueOrDefault(this._heightReference,t,Ge.NONE),o=q.getValueOrDefault(this._extrudedHeightReference,t,Ge.NONE);if(i===Ge.NONE&&o!==Ge.RELATIVE_TO_GROUND)return this._position=m.clone(m.ZERO,this._position),m.clone(m.ZERO,n);if(this._positionProperty.isConstant)return m.multiplyByScalar(this._normal,this._terrainHeight,n);let r=this._scene,s=this._positionProperty.getValue(t,ute);if(!f(s)||m.equals(s,m.ZERO)||!f(r.globe))return m.clone(m.ZERO,n);if(m.equalsEpsilon(this._position,s,B.EPSILON10))return m.multiplyByScalar(this._normal,this._terrainHeight,n);this._position=m.clone(s,this._position),this._updateClamping();let a=r.globe.ellipsoid.geodeticSurfaceNormal(s,this._normal);return m.multiplyByScalar(a,this._terrainHeight,n)};Ex.prototype.isDestroyed=function(){return!1};Ex.prototype.destroy=function(){return f(this._removeEventListener)&&this._removeEventListener(),f(this._removeModeListener)&&this._removeModeListener(),f(this._removeCallbackFunc)&&this._removeCallbackFunc(),ue(this)};var bx=Ex;function m2e(t,n,i,o){if(ti.prototype._onEntityPropertyChanged.call(this,t,n,i,o),this._observedPropertyNames.indexOf(n)===-1)return;let r=this._entity[this._geometryPropertyName];if(!f(r))return;f(this._terrainOffsetProperty)&&(this._terrainOffsetProperty.destroy(),this._terrainOffsetProperty=void 0);let s=r.heightReference;if(f(s)){let a=new rh(this._computeCenter.bind(this),!this._dynamic);this._terrainOffsetProperty=new bx(this._scene,a,s)}}var x_=m2e;var fte=m.ZERO,dte=new m,p2e=new m,hte=new z;function _2e(t){this.id=t,this.vertexFormat=void 0,this.dimensions=void 0,this.offsetAttribute=void 0}function Il(t,n){ti.call(this,{entity:t,scene:n,geometryOptions:new _2e(t),geometryPropertyName:"box",observedPropertyNames:["availability","position","orientation","box"]}),this._onEntityPropertyChanged(t,"box",t.box,void 0)}f(Object.create)&&(Il.prototype=Object.create(ti.prototype),Il.prototype.constructor=Il);Object.defineProperties(Il.prototype,{terrainOffsetProperty:{get:function(){return this._terrainOffsetProperty}}});Il.prototype.createFillGeometryInstance=function(t){let n=this._entity,i=n.isAvailable(t),o=new mn(i&&n.isShowing&&this._showProperty.getValue(t)&&this._fillProperty.getValue(t)),r=this._distanceDisplayConditionProperty.getValue(t),s=Vn.fromDistanceDisplayCondition(r),a={show:o,distanceDisplayCondition:s,color:void 0,offset:void 0};if(this._materialProperty instanceof Rt){let c;f(this._materialProperty.color)&&(this._materialProperty.color.isConstant||i)&&(c=this._materialProperty.color.getValue(t,hte)),f(c)||(c=z.WHITE),a.color=Lt.fromColor(c)}return f(this._options.offsetAttribute)&&(a.offset=Gi.fromCartesian3(q.getValueOrDefault(this._terrainOffsetProperty,t,fte,dte))),new Ct({id:n,geometry:Cl.fromDimensions(this._options),modelMatrix:n.computeModelMatrixForHeightReference(t,n.box.heightReference,this._options.dimensions.z*.5,this._scene.mapProjection.ellipsoid),attributes:a})};Il.prototype.createOutlineGeometryInstance=function(t){let n=this._entity,i=n.isAvailable(t),o=q.getValueOrDefault(this._outlineColorProperty,t,z.BLACK,hte),r=this._distanceDisplayConditionProperty.getValue(t),s={show:new mn(i&&n.isShowing&&this._showProperty.getValue(t)&&this._showOutlineProperty.getValue(t)),color:Lt.fromColor(o),distanceDisplayCondition:Vn.fromDistanceDisplayCondition(r),offset:void 0};return f(this._options.offsetAttribute)&&(s.offset=Gi.fromCartesian3(q.getValueOrDefault(this._terrainOffsetProperty,t,fte,dte))),new Ct({id:n,geometry:Ld.fromDimensions(this._options),modelMatrix:n.computeModelMatrixForHeightReference(t,n.box.heightReference,this._options.dimensions.z*.5,this._scene.mapProjection.ellipsoid),attributes:s})};Il.prototype._computeCenter=function(t,n){return q.getValueOrUndefined(this._entity.position,t,n)};Il.prototype._isHidden=function(t,n){return!f(n.dimensions)||!f(t.position)||ti.prototype._isHidden.call(this,t,n)};Il.prototype._isDynamic=function(t,n){return!t.position.isConstant||!q.isConstant(t.orientation)||!n.dimensions.isConstant||!q.isConstant(n.outlineWidth)};Il.prototype._setStaticOptions=function(t,n){let i=q.getValueOrDefault(n.heightReference,Ue.MINIMUM_VALUE,Ge.NONE),o=this._options;o.vertexFormat=this._materialProperty instanceof Rt?tn.VERTEX_FORMAT:ro.MaterialSupport.TEXTURED.vertexFormat,o.dimensions=n.dimensions.getValue(Ue.MINIMUM_VALUE,o.dimensions),o.offsetAttribute=i!==Ge.NONE?en.ALL:void 0};Il.prototype._onEntityPropertyChanged=x_;Il.DynamicGeometryUpdater=Sx;function Sx(t,n,i){ei.call(this,t,n,i)}f(Object.create)&&(Sx.prototype=Object.create(ei.prototype),Sx.prototype.constructor=Sx);Sx.prototype._isHidden=function(t,n,i){let o=q.getValueOrUndefined(t.position,i,p2e),r=this._options.dimensions;return!f(o)||!f(r)||ei.prototype._isHidden.call(this,t,n,i)};Sx.prototype._setOptions=function(t,n,i){let o=q.getValueOrDefault(n.heightReference,i,Ge.NONE),r=this._options;r.dimensions=q.getValueOrUndefined(n.dimensions,i,r.dimensions),r.offsetAttribute=o!==Ge.NONE?en.ALL:void 0};var TL=Il;function sh(t){t=A(t,0),this._array=new Array(t),this._length=t}Object.defineProperties(sh.prototype,{length:{get:function(){return this._length},set:function(t){let n=this._array,i=this._length;if(t<i)for(let o=t;o<i;++o)n[o]=void 0;else t>n.length&&(n.length=t);this._length=t}},values:{get:function(){return this._array}}});sh.prototype.get=function(t){return this._array[t]};sh.prototype.set=function(t,n){t>=this._length&&(this.length=t+1),this._array[t]=n};sh.prototype.peek=function(){return this._array[this._length-1]};sh.prototype.push=function(t){let n=this.length++;this._array[n]=t};sh.prototype.pop=function(){if(this._length===0)return;let t=this._array[this._length-1];return--this.length,t};sh.prototype.reserve=function(t){t>this._array.length&&(this._array.length=t)};sh.prototype.resize=function(t){this.length=t};sh.prototype.trim=function(t){t=A(t,this._length),this._array.length=t};var Eu=sh;function mte(t){t=A(t,A.EMPTY_OBJECT),this._metadata=t.metadata}Object.defineProperties(mte.prototype,{metadata:{get:function(){return this._metadata}}});var wx=mte;function Lm(t,n,i,o,r,s){this._tileset=t,this._tile=n,this._resource=i,this._contents=[],this._metadata=void 0,this._group=void 0,this._readyPromise=g2e(this,o,r,s)}Object.defineProperties(Lm.prototype,{featurePropertiesDirty:{get:function(){let t=this._contents,n=t.length;for(let i=0;i<n;++i)if(t[i].featurePropertiesDirty)return!0;return!1},set:function(t){let n=this._contents,i=n.length;for(let o=0;o<i;++o)n[o].featurePropertiesDirty=t}},featuresLength:{get:function(){return 0}},pointsLength:{get:function(){return 0}},trianglesLength:{get:function(){return 0}},geometryByteLength:{get:function(){return 0}},texturesByteLength:{get:function(){return 0}},batchTableByteLength:{get:function(){return 0}},innerContents:{get:function(){return this._contents}},readyPromise:{get:function(){return this._readyPromise}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._resource.getUrlComponent(!0)}},metadata:{get:function(){return this._metadata},set:function(t){this._metadata=t;let n=this._contents,i=n.length;for(let o=0;o<i;++o)n[o].metadata=t}},batchTable:{get:function(){}},group:{get:function(){return this._group},set:function(t){this._group=t;let n=this._contents,i=n.length;for(let o=0;o<i;++o)n[o].group=t}}});var zS=Uint32Array.BYTES_PER_ELEMENT;function g2e(t,n,i,o){i=A(i,0);let r=new Uint8Array(n),s=new DataView(n);i+=zS;let a=s.getUint32(i,!0);if(a!==1)throw new he(`Only Composite Tile version 1 is supported. Version ${a} is not.`);i+=zS,i+=zS;let c=s.getUint32(i,!0);i+=zS;let l=[],u=t._resource,d=u.queryParameters.compositeIndex;f(d)?d=`${d}_`:d="";for(let h=0;h<c;++h){let _=Wd(r,i),y=s.getUint32(i+zS*2,!0),p=o[_],C=`${d}${h}`,x=u.getDerivedResource({queryParameters:{compositeIndex:C}});if(f(p)){let T=p(t._tileset,t._tile,x,n,i);t._contents.push(T),l.push(T.readyPromise)}else throw new he(`Unknown tile content type, ${_}, inside Composite tile`);i+=y}return Promise.all(l).then(function(){return t})}Lm.prototype.hasProperty=function(t,n){return!1};Lm.prototype.getFeature=function(t){};Lm.prototype.applyDebugSettings=function(t,n){let i=this._contents,o=i.length;for(let r=0;r<o;++r)i[r].applyDebugSettings(t,n)};Lm.prototype.applyStyle=function(t){let n=this._contents,i=n.length;for(let o=0;o<i;++o)n[o].applyStyle(t)};Lm.prototype.update=function(t,n){let i=this._contents,o=i.length;for(let r=0;r<o;++r)i[r].update(t,n)};Lm.prototype.isDestroyed=function(){return!1};Lm.prototype.destroy=function(){let t=this._contents,n=t.length;for(let i=0;i<n;++i)t[i].destroy();return ue(this)};var EL=Lm;var y2e={HIGHLIGHT:0,REPLACE:1,MIX:2},Bl=Object.freeze(y2e);var KG=qc.DEFAULT_COLOR_VALUE,JG=qc.DEFAULT_SHOW_VALUE;function so(t,n,i,o,r){this.featuresLength=n;let s;f(i)&&(s=i.extensions),this._extensions=A(s,{});let a=A2e(i);this._properties=a,this._batchTableHierarchy=C2e(this,i,o);let c=_te(n,a,o);this._binaryPropertiesByteLength=x2e(c),this._batchTableBinaryProperties=c,this._content=t,this._batchTexture=new qc({featuresLength:n,colorChangedCallback:r,owner:t,statistics:t.tileset.statistics})}so._deprecationWarning=ws;Object.defineProperties(so.prototype,{batchTableByteLength:{get:function(){let t=this._binaryPropertiesByteLength;return f(this._batchTableHierarchy)&&(t+=this._batchTableHierarchy.byteLength),t+=this._batchTexture.byteLength,t}}});function A2e(t){let n={};if(!f(t))return n;for(let i in t)t.hasOwnProperty(i)&&i!=="HIERARCHY"&&i!=="extensions"&&i!=="extras"&&(n[i]=tt(t[i],!0));return n}function C2e(t,n,i){if(!f(n))return;let o=t._extensions["3DTILES_batch_table_hierarchy"],r=n.HIERARCHY;if(f(r)&&(so._deprecationWarning("batchTableHierarchyExtension","The batch table HIERARCHY property has been moved to an extension. Use extensions.3DTILES_batch_table_hierarchy instead."),t._extensions["3DTILES_batch_table_hierarchy"]=r,o=r),!!f(o))return new jC({extension:o,binaryBody:i})}function _te(t,n,i){let o;for(let r in n)if(n.hasOwnProperty(r)){let s=n[r],a=s.byteOffset;if(f(a)){let c=s.componentType,l=s.type;if(!f(c))throw new he("componentType is required.");if(!f(l))throw new he("type is required.");if(!f(i))throw new he(`Property ${r} requires a batch table binary.`);let u=_u(s),d=u.componentsPerAttribute,h=u.classType,_=u.createArrayBufferView(i.buffer,i.byteOffset+a,t);f(o)||(o={}),o[r]={typedArray:_,componentCount:d,type:h}}}return o}function x2e(t){if(!f(t))return 0;let n=0;for(let i in t)t.hasOwnProperty(i)&&(n+=t[i].typedArray.byteLength);return n}so.getBinaryProperties=function(t,n,i){return _te(t,n,i)};so.prototype.setShow=function(t,n){this._batchTexture.setShow(t,n)};so.prototype.setAllShow=function(t){this._batchTexture.setAllShow(t)};so.prototype.getShow=function(t){return this._batchTexture.getShow(t)};so.prototype.setColor=function(t,n){this._batchTexture.setColor(t,n)};so.prototype.setAllColor=function(t){this._batchTexture.setAllColor(t)};so.prototype.getColor=function(t,n){return this._batchTexture.getColor(t,n)};so.prototype.getPickColor=function(t){return this._batchTexture.getPickColor(t)};var T2e=new z;so.prototype.applyStyle=function(t){if(!f(t)){this.setAllColor(KG),this.setAllShow(JG);return}let n=this._content,i=this.featuresLength;for(let o=0;o<i;++o){let r=n.getFeature(o),s=f(t.color)?A(t.color.evaluateColor(r,T2e),KG):KG,a=f(t.show)?A(t.show.evaluate(r),JG):JG;this.setColor(o,s),this.setShow(o,a)}};function E2e(t,n){let i=t.typedArray,o=t.componentCount;return o===1?i[n]:t.type.unpack(i,n*o)}function b2e(t,n,i){let o=t.typedArray,r=t.componentCount;r===1?o[n]=i:t.type.pack(i,o,n*r)}so.prototype.isClass=function(t,n){let i=this._batchTableHierarchy;return f(i)?i.isClass(t,n):!1};so.prototype.isExactClass=function(t,n){return this.getExactClassName(t)===n};so.prototype.getExactClassName=function(t){let n=this._batchTableHierarchy;if(!!f(n))return n.getClassName(t)};so.prototype.hasProperty=function(t,n){return f(this._properties[n])||f(this._batchTableHierarchy)&&this._batchTableHierarchy.hasProperty(t,n)};so.prototype.hasPropertyBySemantic=function(){return!1};so.prototype.getPropertyIds=function(t,n){n=f(n)?n:[],n.length=0;let i=Object.keys(this._properties);return n.push.apply(n,i),f(this._batchTableHierarchy)&&n.push.apply(n,this._batchTableHierarchy.getPropertyIds(t,i)),n};so.prototype.getPropertyBySemantic=function(t,n){};so.prototype.getProperty=function(t,n){if(f(this._batchTableBinaryProperties)){let o=this._batchTableBinaryProperties[n];if(f(o))return E2e(o,t)}let i=this._properties[n];if(f(i))return tt(i[t],!0);if(f(this._batchTableHierarchy)){let o=this._batchTableHierarchy.getProperty(t,n);if(f(o))return o}};so.prototype.setProperty=function(t,n,i){let o=this.featuresLength;if(f(this._batchTableBinaryProperties)){let s=this._batchTableBinaryProperties[n];if(f(s)){b2e(s,t,i);return}}if(f(this._batchTableHierarchy)&&this._batchTableHierarchy.setProperty(t,n,i))return;let r=this._properties[n];f(r)||(this._properties[n]=new Array(o),r=this._properties[n]),r[t]=tt(i,!0)};function S2e(t){return t._batchTexture.textureDimensions.y===1?`uniform vec4 tile_textureStep; 
vec2 computeSt(float batchId) 
{ 
    float stepX = tile_textureStep.x; 
    float centerX = tile_textureStep.y; 
    return vec2(centerX + (batchId * stepX), 0.5); 
} 
`:`uniform vec4 tile_textureStep; 
uniform vec2 tile_textureDimensions; 
vec2 computeSt(float batchId) 
{ 
    float stepX = tile_textureStep.x; 
    float centerX = tile_textureStep.y; 
    float stepY = tile_textureStep.z; 
    float centerY = tile_textureStep.w; 
    float xId = mod(batchId, tile_textureDimensions.x); 
    float yId = floor(batchId / tile_textureDimensions.x); 
    return vec2(centerX + (xId * stepX), centerY + (yId * stepY)); 
} 
`}so.prototype.getVertexShaderCallback=function(t,n,i){if(this.featuresLength===0)return;let o=this;return function(r){let s=gte(r,i,!1),a;return Ut.maximumVertexTextureImageUnits>0?(a="",t&&(a+=`uniform bool tile_translucentCommand; 
`),a+=`uniform sampler2D tile_batchTexture; 
varying vec4 tile_featureColor; 
varying vec2 tile_featureSt; 
void main() 
{ 
    vec2 st = computeSt(${n}); 
    vec4 featureProperties = texture2D(tile_batchTexture, st); 
    tile_color(featureProperties); 
    float show = ceil(featureProperties.a); 
    gl_Position *= show; 
`,t&&(a+=`    bool isStyleTranslucent = (featureProperties.a != 1.0); 
    if (czm_pass == czm_passTranslucent) 
    { 
        if (!isStyleTranslucent && !tile_translucentCommand) 
        { 
            gl_Position *= 0.0; 
        } 
    } 
    else 
    { 
        if (isStyleTranslucent) 
        { 
            gl_Position *= 0.0; 
        } 
    } 
`),a+=`    tile_featureColor = featureProperties; 
    tile_featureSt = st; 
}`):a=`varying vec2 tile_featureSt; 
void main() 
{ 
    tile_color(vec4(1.0)); 
    tile_featureSt = computeSt(${n}); 
}`,`${s}
${S2e(o)}${a}`}};function pte(t,n){return t=ze.replaceMain(t,"tile_main"),n?`${t}uniform float tile_colorBlend; 
void tile_color(vec4 tile_featureColor) 
{ 
    tile_main(); 
    tile_featureColor = czm_gammaCorrect(tile_featureColor); 
    gl_FragColor.a *= tile_featureColor.a; 
    float highlight = ceil(tile_colorBlend); 
    gl_FragColor.rgb *= mix(tile_featureColor.rgb, vec3(1.0), highlight); 
} 
`:`${t}void tile_color(vec4 tile_featureColor) 
{ 
    tile_main(); 
} 
`}function w2e(t,n){let i=`texture2D(${n}`,o=0,r=t.indexOf(i,o),s;for(;r>-1;){let a=0;for(let u=r;u<t.length;++u){let d=t.charAt(u);if(d==="(")++a;else if(d===")"&&(--a,a===0)){s=u+1;break}}let l=`tile_diffuse_final(${t.slice(r,s)}, tile_diffuse)`;t=t.slice(0,r)+l+t.slice(s),o=r+l.length,r=t.indexOf(i,o)}return t}function gte(t,n,i){if(!f(n))return pte(t,i);let o=new RegExp(`(uniform|attribute|in)\\s+(vec[34]|sampler2D)\\s+${n};`),r=t.match(o);if(!f(r))return pte(t,i);let s=r[0],a=r[2];t=ze.replaceMain(t,"tile_main"),t=t.replace(s,"");let c=`bool isWhite(vec3 color) 
{ 
    return all(greaterThan(color, vec3(1.0 - czm_epsilon3))); 
} 
vec4 tile_diffuse_final(vec4 sourceDiffuse, vec4 tileDiffuse) 
{ 
    vec4 blendDiffuse = mix(sourceDiffuse, tileDiffuse, tile_colorBlend); 
    vec4 diffuse = isWhite(tileDiffuse.rgb) ? sourceDiffuse : blendDiffuse; 
    return vec4(diffuse.rgb, sourceDiffuse.a); 
} 
`,l=`    tile_featureColor = czm_gammaCorrect(tile_featureColor); 
    gl_FragColor.a *= tile_featureColor.a; 
    float highlight = ceil(tile_colorBlend); 
    gl_FragColor.rgb *= mix(tile_featureColor.rgb, vec3(1.0), highlight); 
`,u;if(a==="vec3"||a==="vec4"){let d=a==="vec3"?`vec4(${n}, 1.0)`:n,h=a==="vec3"?"tile_diffuse.xyz":"tile_diffuse";o=new RegExp(n,"g"),t=t.replace(o,h),u=`    vec4 source = ${d}; 
    tile_diffuse = tile_diffuse_final(source, tile_featureColor); 
    tile_main(); 
`}else a==="sampler2D"&&(t=w2e(t,n),u=`    tile_diffuse = tile_featureColor; 
    tile_main(); 
`);return t=`uniform float tile_colorBlend; 
vec4 tile_diffuse = vec4(1.0); 
${c}${s}
${t}
void tile_color(vec4 tile_featureColor) 
{ 
${u}`,i&&(t+=l),t+=`} 
`,t}so.prototype.getFragmentShaderCallback=function(t,n,i){if(this.featuresLength!==0)return function(o){return o=gte(o,n,!0),Ut.maximumVertexTextureImageUnits>0?(o+=`uniform sampler2D tile_pickTexture; 
varying vec2 tile_featureSt; 
varying vec4 tile_featureColor; 
void main() 
{ 
    tile_color(tile_featureColor); 
`,i&&(o+=`    gl_FragColor.rgb *= gl_FragColor.a; 
`),o+="}"):(t&&(o+=`uniform bool tile_translucentCommand; 
`),o+=`uniform sampler2D tile_pickTexture; 
uniform sampler2D tile_batchTexture; 
varying vec2 tile_featureSt; 
void main() 
{ 
    vec4 featureProperties = texture2D(tile_batchTexture, tile_featureSt); 
    if (featureProperties.a == 0.0) { 
        discard; 
    } 
`,t&&(o+=`    bool isStyleTranslucent = (featureProperties.a != 1.0); 
    if (czm_pass == czm_passTranslucent) 
    { 
        if (!isStyleTranslucent && !tile_translucentCommand) 
        { 
            discard; 
        } 
    } 
    else 
    { 
        if (isStyleTranslucent) 
        { 
            discard; 
        } 
    } 
`),o+=`    tile_color(featureProperties); 
`,i&&(o+=`    gl_FragColor.rgb *= gl_FragColor.a; 
`),o+=`} 
`),o}};so.prototype.getClassificationFragmentShaderCallback=function(){if(this.featuresLength!==0)return function(t){return t=ze.replaceMain(t,"tile_main"),Ut.maximumVertexTextureImageUnits>0?t+=`uniform sampler2D tile_pickTexture;
varying vec2 tile_featureSt; 
varying vec4 tile_featureColor; 
void main() 
{ 
    tile_main(); 
    gl_FragColor = tile_featureColor; 
    gl_FragColor.rgb *= gl_FragColor.a; 
}`:t+=`uniform sampler2D tile_batchTexture; 
uniform sampler2D tile_pickTexture;
varying vec2 tile_featureSt; 
void main() 
{ 
    tile_main(); 
    vec4 featureProperties = texture2D(tile_batchTexture, tile_featureSt); 
    if (featureProperties.a == 0.0) { 
        discard; 
    } 
    gl_FragColor = featureProperties; 
    gl_FragColor.rgb *= gl_FragColor.a; 
} 
`,t}};function D2e(t){let n=t._content.tileset,i=n.colorBlendMode,o=n.colorBlendAmount;if(i===Bl.HIGHLIGHT)return 0;if(i===Bl.REPLACE)return 1;if(i===Bl.MIX)return B.clamp(o,B.EPSILON4,1)}so.prototype.getUniformMapCallback=function(){if(this.featuresLength===0)return;let t=this;return function(n){return At(n,{tile_batchTexture:function(){return A(t._batchTexture.batchTexture,t._batchTexture.defaultTexture)},tile_textureDimensions:function(){return t._batchTexture.textureDimensions},tile_textureStep:function(){return t._batchTexture.textureStep},tile_colorBlend:function(){return D2e(t)},tile_pickTexture:function(){return t._batchTexture.pickTexture}})}};so.prototype.getPickId=function(){return"texture2D(tile_pickTexture, tile_featureSt)"};var T_={ALL_OPAQUE:0,ALL_TRANSLUCENT:1,OPAQUE_AND_TRANSLUCENT:2};so.prototype.addDerivedCommands=function(t,n){let i=t.commandList,o=i.length,r=this._content._tile,s=r._finalResolution,a=r.tileset,c=a._skipLevelOfDetail&&a._hasMixedContent&&t.context.stencilBuffer,l=v2e(this);for(let u=n;u<o;++u){let d=i[u];if(d.pass===Te.COMPUTE)continue;let h=d.derivedCommands.tileset;(!f(h)||d.dirty)&&(h={},d.derivedCommands.tileset=h,h.originalCommand=P2e(d),d.dirty=!1);let _=h.originalCommand;l!==T_.ALL_OPAQUE&&d.pass!==Te.TRANSLUCENT&&(f(h.translucent)||(h.translucent=I2e(_))),l!==T_.ALL_TRANSLUCENT&&d.pass!==Te.TRANSLUCENT&&(f(h.opaque)||(h.opaque=B2e(_)),c&&(s||(f(h.zback)||(h.zback=R2e(t.context,_)),a._backfaceCommands.push(h.zback)),(!f(h.stencil)||r._selectionDepth!==L2e(h.stencil))&&(d.renderState.depthMask?h.stencil=M2e(_,r._selectionDepth):h.stencil=h.opaque)));let y=c?h.stencil:h.opaque,p=h.translucent;d.pass!==Te.TRANSLUCENT?(l===T_.ALL_OPAQUE&&(i[u]=y),l===T_.ALL_TRANSLUCENT&&(i[u]=p),l===T_.OPAQUE_AND_TRANSLUCENT&&(i[u]=y,i.push(p))):i[u]=_}};function v2e(t){let n=t._batchTexture.translucentFeaturesLength;return n===0?T_.ALL_OPAQUE:n===t.featuresLength?T_.ALL_TRANSLUCENT:T_.OPAQUE_AND_TRANSLUCENT}function P2e(t){let n=et.shallowClone(t),i=n.pass===Te.TRANSLUCENT;return n.uniformMap=f(n.uniformMap)?n.uniformMap:{},n.uniformMap.tile_translucentCommand=function(){return i},n}function I2e(t){let n=et.shallowClone(t);return n.pass=Te.TRANSLUCENT,n.renderState=F2e(t.renderState),n}function B2e(t){let n=et.shallowClone(t);return n.renderState=N2e(t.renderState),n}function O2e(t,n){let i=t.shaderCache.getDerivedShaderProgram(n,"zBackfaceLogDepth");if(!f(i)){let o=n.fragmentShaderSource.clone();o.defines=f(o.defines)?o.defines.slice(0):[],o.defines.push("POLYGON_OFFSET"),o.sources.unshift(`#ifdef GL_OES_standard_derivatives
#extension GL_OES_standard_derivatives : enable
#endif
`),i=t.shaderCache.createDerivedShaderProgram(n,"zBackfaceLogDepth",{vertexShaderSource:n.vertexShaderSource,fragmentShaderSource:o,attributeLocations:n._attributeLocations})}return i}function R2e(t,n){let i=et.shallowClone(n),o=tt(i.renderState,!0);o.cull.enabled=!0,o.cull.face=xi.FRONT,o.colorMask={red:!1,green:!1,blue:!1,alpha:!1},o.polygonOffset={enabled:!0,factor:5,units:5},o.stencilTest=Ot.setCesium3DTileBit(),o.stencilMask=Ot.CESIUM_3D_TILE_MASK,i.renderState=Ve.fromCache(o),i.castShadows=!1,i.receiveShadows=!1,i.uniformMap=tt(n.uniformMap);let r=new W(5,5);return i.uniformMap.u_polygonOffset=function(){return r},i.shaderProgram=O2e(t,n.shaderProgram),i}function M2e(t,n){let i=et.shallowClone(t),o=tt(i.renderState,!0);return o.stencilTest.enabled=!0,o.stencilTest.mask=Ot.SKIP_LOD_MASK,o.stencilTest.reference=Ot.CESIUM_3D_TILE_MASK|n<<Ot.SKIP_LOD_BIT_SHIFT,o.stencilTest.frontFunction=kn.GREATER_OR_EQUAL,o.stencilTest.frontOperation.zPass=ft.REPLACE,o.stencilTest.backFunction=kn.GREATER_OR_EQUAL,o.stencilTest.backOperation.zPass=ft.REPLACE,o.stencilMask=Ot.CESIUM_3D_TILE_MASK|Ot.SKIP_LOD_MASK,i.renderState=Ve.fromCache(o),i}function L2e(t){return(t.renderState.stencilTest.reference&Ot.SKIP_LOD_MASK)>>>Ot.SKIP_LOD_BIT_SHIFT}function F2e(t){let n=tt(t,!0);return n.cull.enabled=!1,n.depthTest.enabled=!0,n.depthMask=!1,n.blending=ln.ALPHA_BLEND,n.stencilTest=Ot.setCesium3DTileBit(),n.stencilMask=Ot.CESIUM_3D_TILE_MASK,Ve.fromCache(n)}function N2e(t){let n=tt(t,!0);return n.stencilTest=Ot.setCesium3DTileBit(),n.stencilMask=Ot.CESIUM_3D_TILE_MASK,Ve.fromCache(n)}so.prototype.update=function(t,n){this._batchTexture.update(t,n)};so.prototype.isDestroyed=function(){return!1};so.prototype.destroy=function(){return this._batchTexture=this._batchTexture&&this._batchTexture.destroy(),ue(this)};var E_=so;function V2e(t){this.offset=t.offset,this.count=t.count,this.color=t.color,this.batchIds=t.batchIds}var Fm=V2e;var HS=`attribute vec3 position;
attribute float a_batchId;
uniform mat4 u_modifiedModelViewProjection;
void main()
{
gl_Position = czm_depthClamp(u_modifiedModelViewProjection * vec4(position, 1.0));
}
`;var DL=yo(yte(),1);var k2e={VARIABLE:0,UNARY:1,BINARY:2,TERNARY:3,CONDITIONAL:4,MEMBER:5,FUNCTION_CALL:6,ARRAY:7,REGEX:8,VARIABLE_IN_STRING:9,LITERAL_NULL:10,LITERAL_BOOLEAN:11,LITERAL_NUMBER:12,LITERAL_STRING:13,LITERAL_COLOR:14,LITERAL_VECTOR:15,LITERAL_REGEX:16,LITERAL_UNDEFINED:17,BUILTIN_VARIABLE:18},ht=Object.freeze(k2e);function Rf(t,n){this._expression=t,t=Q2e(t,n),t=e3e($2e(t)),DL.default.addBinaryOp("=~",0),DL.default.addBinaryOp("!~",0);let i;try{i=(0,DL.default)(t)}catch(o){throw new he(o)}this._runtimeAst=hi(this,i)}Object.defineProperties(Rf.prototype,{expression:{get:function(){return this._expression}}});var Dn={arrayIndex:0,arrayArray:[[]],cartesian2Index:0,cartesian3Index:0,cartesian4Index:0,cartesian2Array:[new W],cartesian3Array:[new m],cartesian4Array:[new se],reset:function(){this.arrayIndex=0,this.cartesian2Index=0,this.cartesian3Index=0,this.cartesian4Index=0},getArray:function(){this.arrayIndex>=this.arrayArray.length&&this.arrayArray.push([]);let t=this.arrayArray[this.arrayIndex++];return t.length=0,t},getCartesian2:function(){return this.cartesian2Index>=this.cartesian2Array.length&&this.cartesian2Array.push(new W),this.cartesian2Array[this.cartesian2Index++]},getCartesian3:function(){return this.cartesian3Index>=this.cartesian3Array.length&&this.cartesian3Array.push(new m),this.cartesian3Array[this.cartesian3Index++]},getCartesian4:function(){return this.cartesian4Index>=this.cartesian4Array.length&&this.cartesian4Array.push(new se),this.cartesian4Array[this.cartesian4Index++]}};Rf.prototype.evaluate=function(t,n){Dn.reset();let i=this._runtimeAst.evaluate(t);return n instanceof z&&i instanceof se?z.fromCartesian4(i,n):i instanceof W||i instanceof m||i instanceof se?i.clone(n):i};Rf.prototype.evaluateColor=function(t,n){Dn.reset();let i=this._runtimeAst.evaluate(t);return z.fromCartesian4(i,n)};Rf.prototype.getShaderFunction=function(t,n,i,o){let r=this.getShaderExpression(n,i);return r=`${o} ${t}
{
    return ${r};
}
`,r};Rf.prototype.getShaderExpression=function(t,n){return this._runtimeAst.getShaderExpression(t,n)};Rf.prototype.getVariables=function(){let t=[];return this._runtimeAst.getVariables(t),t=t.filter(function(n,i,o){return o.indexOf(n)===i}),t};var U2e=["!","-","+"],Ate=["+","-","*","/","%","===","!==",">",">=","<","<=","&&","||","!~","=~"],vL=/\${(.*?)}/g,z2e=/\\/g,H2e="@#%",G2e=/@#%/g,PL=new z,IL={abs:hs(Math.abs),sqrt:hs(Math.sqrt),cos:hs(Math.cos),sin:hs(Math.sin),tan:hs(Math.tan),acos:hs(Math.acos),asin:hs(Math.asin),atan:hs(Math.atan),radians:hs(B.toRadians),degrees:hs(B.toDegrees),sign:hs(B.sign),floor:hs(Math.floor),ceil:hs(Math.ceil),round:hs(Math.round),exp:hs(Math.exp),exp2:hs(j2e),log:hs(Math.log),log2:hs(q2e),fract:hs(W2e),length:Y2e,normalize:X2e},BL={atan2:SL(Math.atan2,!1),pow:SL(Math.pow,!1),min:SL(Math.min,!0),max:SL(Math.max,!0),distance:K2e,dot:J2e,cross:Z2e},$G={clamp:Cte(B.clamp,!0),mix:Cte(B.lerp,!0)};function W2e(t){return t-Math.floor(t)}function j2e(t){return Math.pow(2,t)}function q2e(t){return B.log2(t)}function hs(t){return function(n,i){if(typeof i=="number")return t(i);if(i instanceof W)return W.fromElements(t(i.x),t(i.y),Dn.getCartesian2());if(i instanceof m)return m.fromElements(t(i.x),t(i.y),t(i.z),Dn.getCartesian3());if(i instanceof se)return se.fromElements(t(i.x),t(i.y),t(i.z),t(i.w),Dn.getCartesian4());throw new he(`Function "${n}" requires a vector or number argument. Argument is ${i}.`)}}function SL(t,n){return function(i,o,r){if(n&&typeof r=="number"){if(typeof o=="number")return t(o,r);if(o instanceof W)return W.fromElements(t(o.x,r),t(o.y,r),Dn.getCartesian2());if(o instanceof m)return m.fromElements(t(o.x,r),t(o.y,r),t(o.z,r),Dn.getCartesian3());if(o instanceof se)return se.fromElements(t(o.x,r),t(o.y,r),t(o.z,r),t(o.w,r),Dn.getCartesian4())}if(typeof o=="number"&&typeof r=="number")return t(o,r);if(o instanceof W&&r instanceof W)return W.fromElements(t(o.x,r.x),t(o.y,r.y),Dn.getCartesian2());if(o instanceof m&&r instanceof m)return m.fromElements(t(o.x,r.x),t(o.y,r.y),t(o.z,r.z),Dn.getCartesian3());if(o instanceof se&&r instanceof se)return se.fromElements(t(o.x,r.x),t(o.y,r.y),t(o.z,r.z),t(o.w,r.w),Dn.getCartesian4());throw new he(`Function "${i}" requires vector or number arguments of matching types. Arguments are ${o} and ${r}.`)}}function Cte(t,n){return function(i,o,r,s){if(n&&typeof s=="number"){if(typeof o=="number"&&typeof r=="number")return t(o,r,s);if(o instanceof W&&r instanceof W)return W.fromElements(t(o.x,r.x,s),t(o.y,r.y,s),Dn.getCartesian2());if(o instanceof m&&r instanceof m)return m.fromElements(t(o.x,r.x,s),t(o.y,r.y,s),t(o.z,r.z,s),Dn.getCartesian3());if(o instanceof se&&r instanceof se)return se.fromElements(t(o.x,r.x,s),t(o.y,r.y,s),t(o.z,r.z,s),t(o.w,r.w,s),Dn.getCartesian4())}if(typeof o=="number"&&typeof r=="number"&&typeof s=="number")return t(o,r,s);if(o instanceof W&&r instanceof W&&s instanceof W)return W.fromElements(t(o.x,r.x,s.x),t(o.y,r.y,s.y),Dn.getCartesian2());if(o instanceof m&&r instanceof m&&s instanceof m)return m.fromElements(t(o.x,r.x,s.x),t(o.y,r.y,s.y),t(o.z,r.z,s.z),Dn.getCartesian3());if(o instanceof se&&r instanceof se&&s instanceof se)return se.fromElements(t(o.x,r.x,s.x),t(o.y,r.y,s.y),t(o.z,r.z,s.z),t(o.w,r.w,s.w),Dn.getCartesian4());throw new he(`Function "${i}" requires vector or number arguments of matching types. Arguments are ${o}, ${r}, and ${s}.`)}}function Y2e(t,n){if(typeof n=="number")return Math.abs(n);if(n instanceof W)return W.magnitude(n);if(n instanceof m)return m.magnitude(n);if(n instanceof se)return se.magnitude(n);throw new he(`Function "${t}" requires a vector or number argument. Argument is ${n}.`)}function X2e(t,n){if(typeof n=="number")return 1;if(n instanceof W)return W.normalize(n,Dn.getCartesian2());if(n instanceof m)return m.normalize(n,Dn.getCartesian3());if(n instanceof se)return se.normalize(n,Dn.getCartesian4());throw new he(`Function "${t}" requires a vector or number argument. Argument is ${n}.`)}function K2e(t,n,i){if(typeof n=="number"&&typeof i=="number")return Math.abs(n-i);if(n instanceof W&&i instanceof W)return W.distance(n,i);if(n instanceof m&&i instanceof m)return m.distance(n,i);if(n instanceof se&&i instanceof se)return se.distance(n,i);throw new he(`Function "${t}" requires vector or number arguments of matching types. Arguments are ${n} and ${i}.`)}function J2e(t,n,i){if(typeof n=="number"&&typeof i=="number")return n*i;if(n instanceof W&&i instanceof W)return W.dot(n,i);if(n instanceof m&&i instanceof m)return m.dot(n,i);if(n instanceof se&&i instanceof se)return se.dot(n,i);throw new he(`Function "${t}" requires vector or number arguments of matching types. Arguments are ${n} and ${i}.`)}function Z2e(t,n,i){if(n instanceof m&&i instanceof m)return m.cross(n,i,Dn.getCartesian3());throw new he(`Function "${t}" requires vec3 arguments. Arguments are ${n} and ${i}.`)}function pt(t,n,i,o,r){this._type=t,this._value=n,this._left=i,this._right=o,this._test=r,this.evaluate=void 0,u3e(this)}function Q2e(t,n){if(!f(n))return t;for(let i in n)if(n.hasOwnProperty(i)){let o=new RegExp(`\\$\\{${i}\\}`,"g"),r=`(${n[i]})`;f(r)&&(t=t.replace(o,r))}return t}function $2e(t){return t.replace(z2e,H2e)}function QG(t){return t.replace(G2e,"\\")}function e3e(t){let n=t,i="",o=n.indexOf("${");for(;o>=0;){let r=n.indexOf("'"),s=n.indexOf('"'),a;if(r>=0&&r<o)a=n.indexOf("'",r+1),i+=n.substr(0,a+1),n=n.substr(a+1),o=n.indexOf("${");else if(s>=0&&s<o)a=n.indexOf('"',s+1),i+=n.substr(0,a+1),n=n.substr(a+1),o=n.indexOf("${");else{i+=n.substr(0,o);let c=n.indexOf("}");if(c<0)throw new he("Unmatched {.");i+=`czm_${n.substr(o+2,c-(o+2))}`,n=n.substr(c+1),o=n.indexOf("${")}}return i+=n,i}function t3e(t){let n=typeof t.value;if(t.value===null)return new pt(ht.LITERAL_NULL,null);if(n==="boolean")return new pt(ht.LITERAL_BOOLEAN,t.value);if(n==="number")return new pt(ht.LITERAL_NUMBER,t.value);if(n==="string")return t.value.indexOf("${")>=0?new pt(ht.VARIABLE_IN_STRING,t.value):new pt(ht.LITERAL_STRING,QG(t.value))}function n3e(t,n){let i=n.arguments,o=i.length,r,s,a,c;if(n.callee.type==="MemberExpression"){r=n.callee.property.name;let l=n.callee.object;if(r==="test"||r==="exec"){if(l.callee.name!=="regExp")throw new he(`${r} is not a function.`);return o===0?r==="test"?new pt(ht.LITERAL_BOOLEAN,!1):new pt(ht.LITERAL_NULL,null):(a=hi(t,l),c=hi(t,i[0]),new pt(ht.FUNCTION_CALL,r,a,c))}else if(r==="toString")return s=hi(t,l),new pt(ht.FUNCTION_CALL,r,s);throw new he(`Unexpected function call "${r}".`)}if(r=n.callee.name,r==="color"){if(o===0)return new pt(ht.LITERAL_COLOR,r);if(s=hi(t,i[0]),f(i[1])){let l=hi(t,i[1]);return new pt(ht.LITERAL_COLOR,r,[s,l])}return new pt(ht.LITERAL_COLOR,r,[s])}else if(r==="rgb"||r==="hsl"){if(o<3)throw new he(`${r} requires three arguments.`);return s=[hi(t,i[0]),hi(t,i[1]),hi(t,i[2])],new pt(ht.LITERAL_COLOR,r,s)}else if(r==="rgba"||r==="hsla"){if(o<4)throw new he(`${r} requires four arguments.`);return s=[hi(t,i[0]),hi(t,i[1]),hi(t,i[2]),hi(t,i[3])],new pt(ht.LITERAL_COLOR,r,s)}else if(r==="vec2"||r==="vec3"||r==="vec4"){s=new Array(o);for(let l=0;l<o;++l)s[l]=hi(t,i[l]);return new pt(ht.LITERAL_VECTOR,r,s)}else{if(r==="isNaN"||r==="isFinite")return o===0?r==="isNaN"?new pt(ht.LITERAL_BOOLEAN,!0):new pt(ht.LITERAL_BOOLEAN,!1):(s=hi(t,i[0]),new pt(ht.UNARY,r,s));if(r==="isExactClass"||r==="isClass"){if(o<1||o>1)throw new he(`${r} requires exactly one argument.`);return s=hi(t,i[0]),new pt(ht.UNARY,r,s)}else if(r==="getExactClassName"){if(o>0)throw new he(`${r} does not take any argument.`);return new pt(ht.UNARY,r)}else if(f(IL[r])){if(o!==1)throw new he(`${r} requires exactly one argument.`);return s=hi(t,i[0]),new pt(ht.UNARY,r,s)}else if(f(BL[r])){if(o!==2)throw new he(`${r} requires exactly two arguments.`);return a=hi(t,i[0]),c=hi(t,i[1]),new pt(ht.BINARY,r,a,c)}else if(f($G[r])){if(o!==3)throw new he(`${r} requires exactly three arguments.`);a=hi(t,i[0]),c=hi(t,i[1]);let l=hi(t,i[2]);return new pt(ht.TERNARY,r,a,c,l)}else{if(r==="Boolean")return o===0?new pt(ht.LITERAL_BOOLEAN,!1):(s=hi(t,i[0]),new pt(ht.UNARY,r,s));if(r==="Number")return o===0?new pt(ht.LITERAL_NUMBER,0):(s=hi(t,i[0]),new pt(ht.UNARY,r,s));if(r==="String")return o===0?new pt(ht.LITERAL_STRING,""):(s=hi(t,i[0]),new pt(ht.UNARY,r,s));if(r==="regExp")return i3e(t,n)}}throw new he(`Unexpected function call "${r}".`)}function i3e(t,n){let i=n.arguments;if(i.length===0)return new pt(ht.LITERAL_REGEX,new RegExp);let o=hi(t,i[0]),r;if(i.length>1){let s=hi(t,i[1]);if(ZG(o)&&ZG(s)){try{r=new RegExp(QG(String(o._value)),s._value)}catch(a){throw new he(a)}return new pt(ht.LITERAL_REGEX,r)}return new pt(ht.REGEX,o,s)}if(ZG(o)){try{r=new RegExp(QG(String(o._value)))}catch(s){throw new he(s)}return new pt(ht.LITERAL_REGEX,r)}return new pt(ht.REGEX,o)}function o3e(t){if(c3e(t.name)){let n=l3e(t.name);return n.substr(0,8)==="tiles3d_"?new pt(ht.BUILTIN_VARIABLE,n):new pt(ht.VARIABLE,n)}else{if(t.name==="NaN")return new pt(ht.LITERAL_NUMBER,NaN);if(t.name==="Infinity")return new pt(ht.LITERAL_NUMBER,1/0);if(t.name==="undefined")return new pt(ht.LITERAL_UNDEFINED,void 0)}throw new he(`${t.name} is not defined.`)}function r3e(t){let n=t.property.name;if(n==="PI")return new pt(ht.LITERAL_NUMBER,Math.PI);if(n==="E")return new pt(ht.LITERAL_NUMBER,Math.E)}function s3e(t){if(t.property.name==="POSITIVE_INFINITY")return new pt(ht.LITERAL_NUMBER,Number.POSITIVE_INFINITY)}function a3e(t,n){if(n.object.name==="Math")return r3e(n);if(n.object.name==="Number")return s3e(n);let i,o=hi(t,n.object);return n.computed?(i=hi(t,n.property),new pt(ht.MEMBER,"brackets",o,i)):(i=new pt(ht.LITERAL_STRING,n.property.name),new pt(ht.MEMBER,"dot",o,i))}function ZG(t){return t._type>=ht.LITERAL_NULL}function c3e(t){return t.substr(0,4)==="czm_"}function l3e(t){return t.substr(4)}function hi(t,n){let i,o,r,s;if(n.type==="Literal")i=t3e(n);else if(n.type==="CallExpression")i=n3e(t,n);else if(n.type==="Identifier")i=o3e(n);else if(n.type==="UnaryExpression"){o=n.operator;let a=hi(t,n.argument);if(U2e.indexOf(o)>-1)i=new pt(ht.UNARY,o,a);else throw new he(`Unexpected operator "${o}".`)}else if(n.type==="BinaryExpression")if(o=n.operator,r=hi(t,n.left),s=hi(t,n.right),Ate.indexOf(o)>-1)i=new pt(ht.BINARY,o,r,s);else throw new he(`Unexpected operator "${o}".`);else if(n.type==="LogicalExpression")o=n.operator,r=hi(t,n.left),s=hi(t,n.right),Ate.indexOf(o)>-1&&(i=new pt(ht.BINARY,o,r,s));else if(n.type==="ConditionalExpression"){let a=hi(t,n.test);r=hi(t,n.consequent),s=hi(t,n.alternate),i=new pt(ht.CONDITIONAL,"?",r,s,a)}else if(n.type==="MemberExpression")i=a3e(t,n);else if(n.type==="ArrayExpression"){let a=[];for(let c=0;c<n.elements.length;c++)a[c]=hi(t,n.elements[c]);i=new pt(ht.ARRAY,a)}else throw n.type==="Compound"?new he("Provide exactly one expression."):new he("Cannot parse expression.");return i}function u3e(t){t._type===ht.CONDITIONAL?t.evaluate=t._evaluateConditional:t._type===ht.FUNCTION_CALL?t._value==="test"?t.evaluate=t._evaluateRegExpTest:t._value==="exec"?t.evaluate=t._evaluateRegExpExec:t._value==="toString"&&(t.evaluate=t._evaluateToString):t._type===ht.UNARY?t._value==="!"?t.evaluate=t._evaluateNot:t._value==="-"?t.evaluate=t._evaluateNegative:t._value==="+"?t.evaluate=t._evaluatePositive:t._value==="isNaN"?t.evaluate=t._evaluateNaN:t._value==="isFinite"?t.evaluate=t._evaluateIsFinite:t._value==="isExactClass"?t.evaluate=t._evaluateIsExactClass:t._value==="isClass"?t.evaluate=t._evaluateIsClass:t._value==="getExactClassName"?t.evaluate=t._evaluateGetExactClassName:t._value==="Boolean"?t.evaluate=t._evaluateBooleanConversion:t._value==="Number"?t.evaluate=t._evaluateNumberConversion:t._value==="String"?t.evaluate=t._evaluateStringConversion:f(IL[t._value])&&(t.evaluate=d3e(t._value)):t._type===ht.BINARY?t._value==="+"?t.evaluate=t._evaluatePlus:t._value==="-"?t.evaluate=t._evaluateMinus:t._value==="*"?t.evaluate=t._evaluateTimes:t._value==="/"?t.evaluate=t._evaluateDivide:t._value==="%"?t.evaluate=t._evaluateMod:t._value==="==="?t.evaluate=t._evaluateEqualsStrict:t._value==="!=="?t.evaluate=t._evaluateNotEqualsStrict:t._value==="<"?t.evaluate=t._evaluateLessThan:t._value==="<="?t.evaluate=t._evaluateLessThanOrEquals:t._value===">"?t.evaluate=t._evaluateGreaterThan:t._value===">="?t.evaluate=t._evaluateGreaterThanOrEquals:t._value==="&&"?t.evaluate=t._evaluateAnd:t._value==="||"?t.evaluate=t._evaluateOr:t._value==="=~"?t.evaluate=t._evaluateRegExpMatch:t._value==="!~"?t.evaluate=t._evaluateRegExpNotMatch:f(BL[t._value])&&(t.evaluate=h3e(t._value)):t._type===ht.TERNARY?t.evaluate=m3e(t._value):t._type===ht.MEMBER?t._value==="brackets"?t.evaluate=t._evaluateMemberBrackets:t.evaluate=t._evaluateMemberDot:t._type===ht.ARRAY?t.evaluate=t._evaluateArray:t._type===ht.VARIABLE?t.evaluate=t._evaluateVariable:t._type===ht.VARIABLE_IN_STRING?t.evaluate=t._evaluateVariableString:t._type===ht.LITERAL_COLOR?t.evaluate=t._evaluateLiteralColor:t._type===ht.LITERAL_VECTOR?t.evaluate=t._evaluateLiteralVector:t._type===ht.LITERAL_STRING?t.evaluate=t._evaluateLiteralString:t._type===ht.REGEX?t.evaluate=t._evaluateRegExp:t._type===ht.BUILTIN_VARIABLE?t._value==="tiles3d_tileset_time"&&(t.evaluate=f3e):t.evaluate=t._evaluateLiteral}function f3e(t){return f(t)?t.content.tileset.timeSinceLoad:0}function d3e(t){let n=IL[t];return function(i){let o=this._left.evaluate(i);return n(t,o)}}function h3e(t){let n=BL[t];return function(i){let o=this._left.evaluate(i),r=this._right.evaluate(i);return n(t,o,r)}}function m3e(t){let n=$G[t];return function(i){let o=this._left.evaluate(i),r=this._right.evaluate(i),s=this._test.evaluate(i);return n(t,o,r,s)}}function OL(t,n){if(f(t))return t.getPropertyInherited(n)}pt.prototype._evaluateLiteral=function(){return this._value};pt.prototype._evaluateLiteralColor=function(t){let n=PL,i=this._left;if(this._value==="color")f(i)?i.length>1?(z.fromCssColorString(i[0].evaluate(t),n),n.alpha=i[1].evaluate(t)):z.fromCssColorString(i[0].evaluate(t),n):z.fromBytes(255,255,255,255,n);else if(this._value==="rgb")z.fromBytes(i[0].evaluate(t),i[1].evaluate(t),i[2].evaluate(t),255,n);else if(this._value==="rgba"){let o=i[3].evaluate(t)*255;z.fromBytes(i[0].evaluate(t),i[1].evaluate(t),i[2].evaluate(t),o,n)}else this._value==="hsl"?z.fromHsl(i[0].evaluate(t),i[1].evaluate(t),i[2].evaluate(t),1,n):this._value==="hsla"&&z.fromHsl(i[0].evaluate(t),i[1].evaluate(t),i[2].evaluate(t),i[3].evaluate(t),n);return se.fromColor(n,Dn.getCartesian4())};pt.prototype._evaluateLiteralVector=function(t){let n=Dn.getArray(),i=this._value,o=this._left,r=o.length;for(let c=0;c<r;++c){let l=o[c].evaluate(t);if(typeof l=="number")n.push(l);else if(l instanceof W)n.push(l.x,l.y);else if(l instanceof m)n.push(l.x,l.y,l.z);else if(l instanceof se)n.push(l.x,l.y,l.z,l.w);else throw new he(`${i} argument must be a vector or number. Argument is ${l}.`)}let s=n.length,a=parseInt(i.charAt(3));if(s===0)throw new he(`Invalid ${i} constructor. No valid arguments.`);if(s<a&&s>1)throw new he(`Invalid ${i} constructor. Not enough arguments.`);if(s>a&&r>1)throw new he(`Invalid ${i} constructor. Too many arguments.`);if(s===1){let c=n[0];n.push(c,c,c)}if(i==="vec2")return W.fromArray(n,0,Dn.getCartesian2());if(i==="vec3")return m.fromArray(n,0,Dn.getCartesian3());if(i==="vec4")return se.fromArray(n,0,Dn.getCartesian4())};pt.prototype._evaluateLiteralString=function(){return this._value};pt.prototype._evaluateVariableString=function(t){let n=this._value,i=vL.exec(n);for(;i!==null;){let o=i[0],r=i[1],s=OL(t,r);f(s)||(s=""),n=n.replace(o,s),i=vL.exec(n)}return n};pt.prototype._evaluateVariable=function(t){return OL(t,this._value)};function sy(t){return t._value==="feature"}pt.prototype._evaluateMemberDot=function(t){if(sy(this._left))return OL(t,this._right.evaluate(t));let n=this._left.evaluate(t);if(!f(n))return;let i=this._right.evaluate(t);if(n instanceof W||n instanceof m||n instanceof se){if(i==="r")return n.x;if(i==="g")return n.y;if(i==="b")return n.z;if(i==="a")return n.w}return n[i]};pt.prototype._evaluateMemberBrackets=function(t){if(sy(this._left))return OL(t,this._right.evaluate(t));let n=this._left.evaluate(t);if(!f(n))return;let i=this._right.evaluate(t);if(n instanceof W||n instanceof m||n instanceof se){if(i===0||i==="r")return n.x;if(i===1||i==="g")return n.y;if(i===2||i==="b")return n.z;if(i===3||i==="a")return n.w}return n[i]};pt.prototype._evaluateArray=function(t){let n=[];for(let i=0;i<this._value.length;i++)n[i]=this._value[i].evaluate(t);return n};pt.prototype._evaluateNot=function(t){let n=this._left.evaluate(t);if(typeof n!="boolean")throw new he(`Operator "!" requires a boolean argument. Argument is ${n}.`);return!n};pt.prototype._evaluateNegative=function(t){let n=this._left.evaluate(t);if(n instanceof W)return W.negate(n,Dn.getCartesian2());if(n instanceof m)return m.negate(n,Dn.getCartesian3());if(n instanceof se)return se.negate(n,Dn.getCartesian4());if(typeof n=="number")return-n;throw new he(`Operator "-" requires a vector or number argument. Argument is ${n}.`)};pt.prototype._evaluatePositive=function(t){let n=this._left.evaluate(t);if(!(n instanceof W||n instanceof m||n instanceof se||typeof n=="number"))throw new he(`Operator "+" requires a vector or number argument. Argument is ${n}.`);return n};pt.prototype._evaluateLessThan=function(t){let n=this._left.evaluate(t),i=this._right.evaluate(t);if(typeof n!="number"||typeof i!="number")throw new he(`Operator "<" requires number arguments. Arguments are ${n} and ${i}.`);return n<i};pt.prototype._evaluateLessThanOrEquals=function(t){let n=this._left.evaluate(t),i=this._right.evaluate(t);if(typeof n!="number"||typeof i!="number")throw new he(`Operator "<=" requires number arguments. Arguments are ${n} and ${i}.`);return n<=i};pt.prototype._evaluateGreaterThan=function(t){let n=this._left.evaluate(t),i=this._right.evaluate(t);if(typeof n!="number"||typeof i!="number")throw new he(`Operator ">" requires number arguments. Arguments are ${n} and ${i}.`);return n>i};pt.prototype._evaluateGreaterThanOrEquals=function(t){let n=this._left.evaluate(t),i=this._right.evaluate(t);if(typeof n!="number"||typeof i!="number")throw new he(`Operator ">=" requires number arguments. Arguments are ${n} and ${i}.`);return n>=i};pt.prototype._evaluateOr=function(t){let n=this._left.evaluate(t);if(typeof n!="boolean")throw new he(`Operator "||" requires boolean arguments. First argument is ${n}.`);if(n)return!0;let i=this._right.evaluate(t);if(typeof i!="boolean")throw new he(`Operator "||" requires boolean arguments. Second argument is ${i}.`);return n||i};pt.prototype._evaluateAnd=function(t){let n=this._left.evaluate(t);if(typeof n!="boolean")throw new he(`Operator "&&" requires boolean arguments. First argument is ${n}.`);if(!n)return!1;let i=this._right.evaluate(t);if(typeof i!="boolean")throw new he(`Operator "&&" requires boolean arguments. Second argument is ${i}.`);return n&&i};pt.prototype._evaluatePlus=function(t){let n=this._left.evaluate(t),i=this._right.evaluate(t);if(i instanceof W&&n instanceof W)return W.add(n,i,Dn.getCartesian2());if(i instanceof m&&n instanceof m)return m.add(n,i,Dn.getCartesian3());if(i instanceof se&&n instanceof se)return se.add(n,i,Dn.getCartesian4());if(typeof n=="string"||typeof i=="string")return n+i;if(typeof n=="number"&&typeof i=="number")return n+i;throw new he(`Operator "+" requires vector or number arguments of matching types, or at least one string argument. Arguments are ${n} and ${i}.`)};pt.prototype._evaluateMinus=function(t){let n=this._left.evaluate(t),i=this._right.evaluate(t);if(i instanceof W&&n instanceof W)return W.subtract(n,i,Dn.getCartesian2());if(i instanceof m&&n instanceof m)return m.subtract(n,i,Dn.getCartesian3());if(i instanceof se&&n instanceof se)return se.subtract(n,i,Dn.getCartesian4());if(typeof n=="number"&&typeof i=="number")return n-i;throw new he(`Operator "-" requires vector or number arguments of matching types. Arguments are ${n} and ${i}.`)};pt.prototype._evaluateTimes=function(t){let n=this._left.evaluate(t),i=this._right.evaluate(t);if(i instanceof W&&n instanceof W)return W.multiplyComponents(n,i,Dn.getCartesian2());if(i instanceof W&&typeof n=="number")return W.multiplyByScalar(i,n,Dn.getCartesian2());if(n instanceof W&&typeof i=="number")return W.multiplyByScalar(n,i,Dn.getCartesian2());if(i instanceof m&&n instanceof m)return m.multiplyComponents(n,i,Dn.getCartesian3());if(i instanceof m&&typeof n=="number")return m.multiplyByScalar(i,n,Dn.getCartesian3());if(n instanceof m&&typeof i=="number")return m.multiplyByScalar(n,i,Dn.getCartesian3());if(i instanceof se&&n instanceof se)return se.multiplyComponents(n,i,Dn.getCartesian4());if(i instanceof se&&typeof n=="number")return se.multiplyByScalar(i,n,Dn.getCartesian4());if(n instanceof se&&typeof i=="number")return se.multiplyByScalar(n,i,Dn.getCartesian4());if(typeof n=="number"&&typeof i=="number")return n*i;throw new he(`Operator "*" requires vector or number arguments. If both arguments are vectors they must be matching types. Arguments are ${n} and ${i}.`)};pt.prototype._evaluateDivide=function(t){let n=this._left.evaluate(t),i=this._right.evaluate(t);if(i instanceof W&&n instanceof W)return W.divideComponents(n,i,Dn.getCartesian2());if(n instanceof W&&typeof i=="number")return W.divideByScalar(n,i,Dn.getCartesian2());if(i instanceof m&&n instanceof m)return m.divideComponents(n,i,Dn.getCartesian3());if(n instanceof m&&typeof i=="number")return m.divideByScalar(n,i,Dn.getCartesian3());if(i instanceof se&&n instanceof se)return se.divideComponents(n,i,Dn.getCartesian4());if(n instanceof se&&typeof i=="number")return se.divideByScalar(n,i,Dn.getCartesian4());if(typeof n=="number"&&typeof i=="number")return n/i;throw new he(`Operator "/" requires vector or number arguments of matching types, or a number as the second argument. Arguments are ${n} and ${i}.`)};pt.prototype._evaluateMod=function(t){let n=this._left.evaluate(t),i=this._right.evaluate(t);if(i instanceof W&&n instanceof W)return W.fromElements(n.x%i.x,n.y%i.y,Dn.getCartesian2());if(i instanceof m&&n instanceof m)return m.fromElements(n.x%i.x,n.y%i.y,n.z%i.z,Dn.getCartesian3());if(i instanceof se&&n instanceof se)return se.fromElements(n.x%i.x,n.y%i.y,n.z%i.z,n.w%i.w,Dn.getCartesian4());if(typeof n=="number"&&typeof i=="number")return n%i;throw new he(`Operator "%" requires vector or number arguments of matching types. Arguments are ${n} and ${i}.`)};pt.prototype._evaluateEqualsStrict=function(t){let n=this._left.evaluate(t),i=this._right.evaluate(t);return i instanceof W&&n instanceof W||i instanceof m&&n instanceof m||i instanceof se&&n instanceof se?n.equals(i):n===i};pt.prototype._evaluateNotEqualsStrict=function(t){let n=this._left.evaluate(t),i=this._right.evaluate(t);return i instanceof W&&n instanceof W||i instanceof m&&n instanceof m||i instanceof se&&n instanceof se?!n.equals(i):n!==i};pt.prototype._evaluateConditional=function(t){let n=this._test.evaluate(t);if(typeof n!="boolean")throw new he(`Conditional argument of conditional expression must be a boolean. Argument is ${n}.`);return n?this._left.evaluate(t):this._right.evaluate(t)};pt.prototype._evaluateNaN=function(t){return isNaN(this._left.evaluate(t))};pt.prototype._evaluateIsFinite=function(t){return isFinite(this._left.evaluate(t))};pt.prototype._evaluateIsExactClass=function(t){return f(t)?t.isExactClass(this._left.evaluate(t)):!1};pt.prototype._evaluateIsClass=function(t){return f(t)?t.isClass(this._left.evaluate(t)):!1};pt.prototype._evaluateGetExactClassName=function(t){if(f(t))return t.getExactClassName()};pt.prototype._evaluateBooleanConversion=function(t){return Boolean(this._left.evaluate(t))};pt.prototype._evaluateNumberConversion=function(t){return Number(this._left.evaluate(t))};pt.prototype._evaluateStringConversion=function(t){return String(this._left.evaluate(t))};pt.prototype._evaluateRegExp=function(t){let n=this._value.evaluate(t),i="";f(this._left)&&(i=this._left.evaluate(t));let o;try{o=new RegExp(n,i)}catch(r){throw new he(r)}return o};pt.prototype._evaluateRegExpTest=function(t){let n=this._left.evaluate(t),i=this._right.evaluate(t);if(!(n instanceof RegExp&&typeof i=="string"))throw new he(`RegExp.test requires the first argument to be a RegExp and the second argument to be a string. Arguments are ${n} and ${i}.`);return n.test(i)};pt.prototype._evaluateRegExpMatch=function(t){let n=this._left.evaluate(t),i=this._right.evaluate(t);if(n instanceof RegExp&&typeof i=="string")return n.test(i);if(i instanceof RegExp&&typeof n=="string")return i.test(n);throw new he(`Operator "=~" requires one RegExp argument and one string argument. Arguments are ${n} and ${i}.`)};pt.prototype._evaluateRegExpNotMatch=function(t){let n=this._left.evaluate(t),i=this._right.evaluate(t);if(n instanceof RegExp&&typeof i=="string")return!n.test(i);if(i instanceof RegExp&&typeof n=="string")return!i.test(n);throw new he(`Operator "!~" requires one RegExp argument and one string argument. Arguments are ${n} and ${i}.`)};pt.prototype._evaluateRegExpExec=function(t){let n=this._left.evaluate(t),i=this._right.evaluate(t);if(!(n instanceof RegExp&&typeof i=="string"))throw new he(`RegExp.exec requires the first argument to be a RegExp and the second argument to be a string. Arguments are ${n} and ${i}.`);let o=n.exec(i);return f(o)?o[1]:null};pt.prototype._evaluateToString=function(t){let n=this._left.evaluate(t);if(n instanceof RegExp||n instanceof W||n instanceof m||n instanceof se)return String(n);throw new he(`Unexpected function call "${this._value}".`)};function xte(t){let n=t._left,i=n.length;for(let c=0;c<i;++c)if(n[c]._type!==ht.LITERAL_NUMBER)return;let o=n[0]._value,r=n[1]._value,s=n[2]._value,a=i===4?n[3]._value:1;return z.fromHsl(o,r,s,a,PL)}function Tte(t){let n=t._left,i=n.length;for(let r=0;r<i;++r)if(n[r]._type!==ht.LITERAL_NUMBER)return;let o=PL;return o.red=n[0]._value/255,o.green=n[1]._value/255,o.blue=n[2]._value/255,o.alpha=i===4?n[3]._value:1,o}function b_(t){return t%1===0?t.toFixed(1):t.toString()}function p3e(t){let n=b_(t.red),i=b_(t.green),o=b_(t.blue);return`vec3(${n}, ${i}, ${o})`}function wL(t){let n=b_(t.red),i=b_(t.green),o=b_(t.blue),r=b_(t.alpha);return`vec4(${n}, ${i}, ${o}, ${r})`}function Ete(t,n,i,o){let r=t.length,s=new Array(r);for(let a=0;a<r;++a)s[a]=t[a].getShaderExpression(n,i,o);return s}function bte(t,n){return f(n[t])?n[t]:Rf.NULL_SENTINEL}Rf.NULL_SENTINEL="czm_infinity";pt.prototype.getShaderExpression=function(t,n,i){let o,r,s,a,c=this._type,l=this._value;f(this._left)&&(Array.isArray(this._left)?r=Ete(this._left,t,n,this):r=this._left.getShaderExpression(t,n,this)),f(this._right)&&(s=this._right.getShaderExpression(t,n,this)),f(this._test)&&(a=this._test.getShaderExpression(t,n,this)),Array.isArray(this._value)&&(l=Ete(this._value,t,n,this));let u,d,h;switch(c){case ht.VARIABLE:return sy(this)?void 0:bte(l,t);case ht.UNARY:if(l==="Boolean")return`bool(${r})`;if(l==="Number")return`float(${r})`;if(l==="round")return`floor(${r} + 0.5)`;if(f(IL[l]))return`${l}(${r})`;if(l==="isNaN")return`(${r} != ${r})`;if(l==="isFinite")return`(abs(${r}) < czm_infinity)`;if(l==="String"||l==="isExactClass"||l==="isClass"||l==="getExactClassName")throw new he(`Error generating style shader: "${l}" is not supported.`);return l+r;case ht.BINARY:return l==="%"?`mod(${r}, ${s})`:l==="==="?`(${r} == ${s})`:l==="!=="?`(${r} != ${s})`:l==="atan2"?`atan(${r}, ${s})`:f(BL[l])?`${l}(${r}, ${s})`:`(${r} ${l} ${s})`;case ht.TERNARY:if(f($G[l]))return`${l}(${r}, ${s}, ${a})`;break;case ht.CONDITIONAL:return`(${a} ? ${r} : ${s})`;case ht.MEMBER:return sy(this._left)?bte(s,t):s==="r"||s==="x"||s==="0.0"?`${r}[0]`:s==="g"||s==="y"||s==="1.0"?`${r}[1]`:s==="b"||s==="z"||s==="2.0"?`${r}[2]`:s==="a"||s==="w"||s==="3.0"?`${r}[3]`:`${r}[int(${s})]`;case ht.FUNCTION_CALL:throw new he(`Error generating style shader: "${l}" is not supported.`);case ht.ARRAY:if(l.length===4)return`vec4(${l[0]}, ${l[1]}, ${l[2]}, ${l[3]})`;if(l.length===3)return`vec3(${l[0]}, ${l[1]}, ${l[2]})`;if(l.length===2)return`vec2(${l[0]}, ${l[1]})`;throw new he("Error generating style shader: Invalid array length. Array length should be 2, 3, or 4.");case ht.REGEX:throw new he("Error generating style shader: Regular expressions are not supported.");case ht.VARIABLE_IN_STRING:throw new he("Error generating style shader: Converting a variable to a string is not supported.");case ht.LITERAL_NULL:return Rf.NULL_SENTINEL;case ht.LITERAL_BOOLEAN:return l?"true":"false";case ht.LITERAL_NUMBER:return b_(l);case ht.LITERAL_STRING:if(f(i)&&i._type===ht.MEMBER&&(l==="r"||l==="g"||l==="b"||l==="a"||l==="x"||l==="y"||l==="z"||l==="w"||sy(i._left)))return l;if(o=z.fromCssColorString(l,PL),f(o))return p3e(o);throw new he("Error generating style shader: String literals are not supported.");case ht.LITERAL_COLOR:if(u=r,l==="color"){if(f(u)){if(u.length>1){let _=u[0],y=u[1];return y!=="1.0"&&(n.translucent=!0),`vec4(${_}, ${y})`}}else return"vec4(1.0)";return`vec4(${u[0]}, 1.0)`}else{if(l==="rgb")return o=Tte(this),f(o)?wL(o):`vec4(${u[0]} / 255.0, ${u[1]} / 255.0, ${u[2]} / 255.0, 1.0)`;if(l==="rgba")return u[3]!=="1.0"&&(n.translucent=!0),o=Tte(this),f(o)?wL(o):`vec4(${u[0]} / 255.0, ${u[1]} / 255.0, ${u[2]} / 255.0, ${u[3]})`;if(l==="hsl")return o=xte(this),f(o)?wL(o):`vec4(czm_HSLToRGB(vec3(${u[0]}, ${u[1]}, ${u[2]})), 1.0)`;if(l==="hsla")return o=xte(this),f(o)?(o.alpha!==1&&(n.translucent=!0),wL(o)):(u[3]!=="1.0"&&(n.translucent=!0),`vec4(czm_HSLToRGB(vec3(${u[0]}, ${u[1]}, ${u[2]})), ${u[3]})`)}break;case ht.LITERAL_VECTOR:d=r.length,h=`${l}(`;for(let _=0;_<d;++_)h+=r[_],_<d-1&&(h+=", ");return h+=")",h;case ht.LITERAL_REGEX:throw new he("Error generating style shader: Regular expressions are not supported.");case ht.LITERAL_UNDEFINED:return Rf.NULL_SENTINEL;case ht.BUILTIN_VARIABLE:if(l==="tiles3d_tileset_time")return l}};pt.prototype.getVariables=function(t,n){let i,o,r,s=this._type,a=this._value;if(f(this._left))if(Array.isArray(this._left))for(i=this._left,o=i.length,r=0;r<o;++r)i[r].getVariables(t,this);else this._left.getVariables(t,this);if(f(this._right)&&this._right.getVariables(t,this),f(this._test)&&this._test.getVariables(t,this),Array.isArray(this._value))for(i=this._value,o=i.length,r=0;r<o;++r)i[r].getVariables(t,this);let c;switch(s){case ht.VARIABLE:sy(this)||t.push(a);break;case ht.VARIABLE_IN_STRING:for(c=vL.exec(a);c!==null;)t.push(c[1]),c=vL.exec(a);break;case ht.LITERAL_STRING:f(n)&&n._type===ht.MEMBER&&sy(n._left)&&t.push(a);break}};var Mf=Rf;function Nm(t){t=A(t,A.EMPTY_OBJECT),this._batchTable=t.batchTable,this._batchIds=t.batchIds,this._positions=t.positions,this._vertexBatchIds=t.vertexBatchIds,this._indices=t.indices,this._indexCounts=t.indexCounts,this._indexOffsets=t.indexOffsets,this._batchedIndices=t.batchedIndices,this._boundingVolume=t.boundingVolume,this._boundingVolumes=t.boundingVolumes,this._center=A(t.center,m.ZERO),this._va=void 0,this._sp=void 0,this._spStencil=void 0,this._spPick=void 0,this._uniformMap=void 0,this._vaSwap=void 0,this._rsStencilDepthPass=void 0,this._rsStencilDepthPass3DTiles=void 0,this._rsColorPass=void 0,this._rsPickPass=void 0,this._rsWireframe=void 0,this._commands=[],this._commandsIgnoreShow=[],this._pickCommands=[],this._constantColor=z.clone(z.WHITE),this._highlightColor=this._constantColor,this._batchDirty=!0,this._pickCommandsDirty=!0,this._framesSinceLastRebatch=0,this._updatingAllCommands=!1,this._trianglesLength=this._indices.length/3,this._geometryByteLength=this._indices.byteLength+this._positions.byteLength+this._vertexBatchIds.byteLength,this.debugWireframe=!1,this._debugWireframe=this.debugWireframe,this._wireframeDirty=!1,this.forceRebatch=!1,this.classificationType=A(t.classificationType,Un.BOTH),this._vertexShaderSource=t._vertexShaderSource,this._fragmentShaderSource=t._fragmentShaderSource,this._attributeLocations=t._attributeLocations,this._uniformMap=t._uniformMap,this._pickId=t._pickId,this._modelMatrix=t._modelMatrix,this._boundingSphere=t._boundingSphere,this._batchIdLookUp={};let n=this._batchIds.length;for(let i=0;i<n;++i){let o=this._batchIds[i];this._batchIdLookUp[o]=i}}Object.defineProperties(Nm.prototype,{trianglesLength:{get:function(){return this._trianglesLength}},geometryByteLength:{get:function(){return this._geometryByteLength}}});var _3e={position:0,a_batchId:1};function g3e(t,n){if(f(t._va))return;let i=ut.createVertexBuffer({context:n,typedArray:t._positions,usage:Fe.STATIC_DRAW}),o=ut.createVertexBuffer({context:n,typedArray:t._vertexBatchIds,usage:Fe.STATIC_DRAW}),r=ut.createIndexBuffer({context:n,typedArray:t._indices,usage:Fe.DYNAMIC_DRAW,indexDatatype:t._indices.BYTES_PER_ELEMENT===2?Ne.UNSIGNED_SHORT:Ne.UNSIGNED_INT}),s=[{index:0,vertexBuffer:i,componentDatatype:J.fromTypedArray(t._positions),componentsPerAttribute:3},{index:1,vertexBuffer:o,componentDatatype:J.fromTypedArray(t._vertexBatchIds),componentsPerAttribute:1}];t._va=new $n({context:n,attributes:s,indexBuffer:r}),n.webgl2&&(t._vaSwap=new $n({context:n,attributes:s,indexBuffer:ut.createIndexBuffer({context:n,sizeInBytes:r.sizeInBytes,usage:Fe.DYNAMIC_DRAW,indexDatatype:r.indexDatatype})})),t._batchedPositions=void 0,t._transferrableBatchIds=void 0,t._vertexBatchIds=void 0,t._verticesPromise=void 0}function y3e(t,n){if(f(t._sp))return;let i=t._batchTable,o=A(t._attributeLocations,_3e),r=t._pickId,s=t._vertexShaderSource,a=t._fragmentShaderSource;if(f(s)){t._sp=qt.fromCache({context:n,vertexShaderSource:s,fragmentShaderSource:a,attributeLocations:o}),t._spStencil=t._sp,a=ze.replaceMain(a,"czm_non_pick_main"),a=`${a}void main() 
{ 
    czm_non_pick_main(); 
    gl_FragColor = ${r}; 
} 
`,t._spPick=qt.fromCache({context:n,vertexShaderSource:s,fragmentShaderSource:a,attributeLocations:o});return}let c=i.getVertexShaderCallback(!1,"a_batchId",void 0)(HS),l=i.getFragmentShaderCallback(!1,void 0,!0)(X0);r=i.getPickId();let u=new ze({sources:[c]}),d=new ze({defines:["VECTOR_TILE"],sources:[l]});t._sp=qt.fromCache({context:n,vertexShaderSource:u,fragmentShaderSource:d,attributeLocations:o}),u=new ze({sources:[HS]}),d=new ze({defines:["VECTOR_TILE"],sources:[X0]}),t._spStencil=qt.fromCache({context:n,vertexShaderSource:u,fragmentShaderSource:d,attributeLocations:o}),l=ze.replaceMain(l,"czm_non_pick_main"),l=`${l}
void main() 
{ 
    czm_non_pick_main(); 
    gl_FragColor = ${r}; 
} 
`;let h=new ze({sources:[c]}),_=new ze({defines:["VECTOR_TILE"],sources:[l]});t._spPick=qt.fromCache({context:n,vertexShaderSource:h,fragmentShaderSource:_,attributeLocations:o})}function Ste(t){let n=t?kn.EQUAL:kn.ALWAYS;return{colorMask:{red:!1,green:!1,blue:!1,alpha:!1},stencilTest:{enabled:!0,frontFunction:n,frontOperation:{fail:ft.KEEP,zFail:ft.DECREMENT_WRAP,zPass:ft.KEEP},backFunction:n,backOperation:{fail:ft.KEEP,zFail:ft.INCREMENT_WRAP,zPass:ft.KEEP},reference:Ot.CESIUM_3D_TILE_MASK,mask:Ot.CESIUM_3D_TILE_MASK},stencilMask:Ot.CLASSIFICATION_MASK,depthTest:{enabled:!0,func:cc.LESS_OR_EQUAL},depthMask:!1}}var A3e={stencilTest:{enabled:!0,frontFunction:kn.NOT_EQUAL,frontOperation:{fail:ft.ZERO,zFail:ft.ZERO,zPass:ft.ZERO},backFunction:kn.NOT_EQUAL,backOperation:{fail:ft.ZERO,zFail:ft.ZERO,zPass:ft.ZERO},reference:0,mask:Ot.CLASSIFICATION_MASK},stencilMask:Ot.CLASSIFICATION_MASK,depthTest:{enabled:!1},depthMask:!1,blending:ln.PRE_MULTIPLIED_ALPHA_BLEND},C3e={stencilTest:{enabled:!0,frontFunction:kn.NOT_EQUAL,frontOperation:{fail:ft.ZERO,zFail:ft.ZERO,zPass:ft.ZERO},backFunction:kn.NOT_EQUAL,backOperation:{fail:ft.ZERO,zFail:ft.ZERO,zPass:ft.ZERO},reference:0,mask:Ot.CLASSIFICATION_MASK},stencilMask:Ot.CLASSIFICATION_MASK,depthTest:{enabled:!1},depthMask:!1};function x3e(t){f(t._rsStencilDepthPass)||(t._rsStencilDepthPass=Ve.fromCache(Ste(!1)),t._rsStencilDepthPass3DTiles=Ve.fromCache(Ste(!0)),t._rsColorPass=Ve.fromCache(A3e),t._rsPickPass=Ve.fromCache(C3e))}var ay=new N,wte=new m;function T3e(t,n){if(f(t._uniformMap))return;let i={u_modifiedModelViewProjection:function(){let o=n.uniformState.view,r=n.uniformState.projection;return N.clone(o,ay),N.multiplyByPoint(ay,t._center,wte),N.setTranslation(ay,wte,ay),N.multiply(r,ay,ay),ay},u_highlightColor:function(){return t._highlightColor}};t._uniformMap=t._batchTable.getUniformMapCallback()(i)}function e5(t,n,i,o,r,s,a){let c=t.constructor.BYTES_PER_ELEMENT,l=s.length;for(let u=0;u<l;++u){let d=s[u],h=a[d],_=o[h],y=r[h],p=new t.constructor(t.buffer,c*_,y);n.set(p,i),o[h]=i,i+=y}return i}function E3e(t,n){let i=t._indices,o=t._indexOffsets,r=t._indexCounts,s=t._batchIdLookUp,a=new i.constructor(i.length),c=n.pop(),l=[c],u=e5(i,a,0,o,r,c.batchIds,s);for(c.offset=0,c.count=u;n.length>0;){let d=n.pop();if(z.equals(d.color,c.color))u=e5(i,a,u,o,r,d.batchIds,s),c.batchIds=c.batchIds.concat(d.batchIds),c.count=u-c.offset;else{let h=u;u=e5(i,a,u,o,r,d.batchIds,s),d.offset=h,d.count=u-h,l.push(d),c=d}}t._va.indexBuffer.copyFromArrayView(a),t._indices=a,t._batchedIndices=l}function t5(t,n,i,o,r,s,a){let c=t.bytesPerIndex,l=s.length;for(let u=0;u<l;++u){let d=s[u],h=a[d],_=o[h],y=r[h];n.copyFromBuffer(t,_*c,i*c,y*c),o[h]=i,i+=y}return i}function b3e(t,n){let i=t._indexOffsets,o=t._indexCounts,r=t._batchIdLookUp,s=n.pop(),a=[s],c=t._va.indexBuffer,l=t._vaSwap.indexBuffer,u=t5(c,l,0,i,o,s.batchIds,r);for(s.offset=0,s.count=u;n.length>0;){let h=n.pop();if(z.equals(h.color,s.color))u=t5(c,l,u,i,o,h.batchIds,r),s.batchIds=s.batchIds.concat(h.batchIds),s.count=u-s.offset;else{let _=u;u=t5(c,l,u,i,o,h.batchIds,r),h.offset=_,h.count=u-_,a.push(h),s=h}}let d=t._va;t._va=t._vaSwap,t._vaSwap=d,t._batchedIndices=a}function S3e(t,n){return n.color.toRgba()-t.color.toRgba()}function w3e(t,n){if(!t._batchDirty)return!1;let i=t._batchedIndices,o=i.length,r=!1,s={};for(let a=0;a<o;++a){let l=i[a].color.toRgba();if(f(s[l])){r=!0;break}else s[l]=!0}if(!r)return t._batchDirty=!1,!1;if(r&&!t.forceRebatch&&t._framesSinceLastRebatch<120){++t._framesSinceLastRebatch;return}return i.sort(S3e),n.webgl2?b3e(t,i):E3e(t,i),t._framesSinceLastRebatch=0,t._batchDirty=!1,t._pickCommandsDirty=!0,t._wireframeDirty=!0,!0}function D3e(t,n){let i=w3e(t,n),o=t._commands,r=t._batchedIndices,s=r.length,a=s*2;if(f(o)&&!i&&o.length===a)return;o.length=a;let c=t._va,l=t._sp,u=A(t._modelMatrix,N.IDENTITY),d=t._uniformMap,h=t._boundingVolume;for(let _=0;_<s;++_){let y=r[_].offset,p=r[_].count,C=o[_*2];f(C)||(C=o[_*2]=new et({owner:t})),C.vertexArray=c,C.modelMatrix=u,C.offset=y,C.count=p,C.renderState=t._rsStencilDepthPass,C.shaderProgram=l,C.uniformMap=d,C.boundingVolume=h,C.cull=!1,C.pass=Te.TERRAIN_CLASSIFICATION;let x=et.shallowClone(C,C.derivedCommands.tileset);x.renderState=t._rsStencilDepthPass3DTiles,x.pass=Te.CESIUM_3D_TILE_CLASSIFICATION,C.derivedCommands.tileset=x;let T=o[_*2+1];f(T)||(T=o[_*2+1]=new et({owner:t})),T.vertexArray=c,T.modelMatrix=u,T.offset=y,T.count=p,T.renderState=t._rsColorPass,T.shaderProgram=l,T.uniformMap=d,T.boundingVolume=h,T.cull=!1,T.pass=Te.TERRAIN_CLASSIFICATION;let E=et.shallowClone(T,T.derivedCommands.tileset);E.pass=Te.CESIUM_3D_TILE_CLASSIFICATION,T.derivedCommands.tileset=E}t._commandsDirty=!0}function v3e(t,n){if(t.classificationType===Un.TERRAIN||!n.invertClassification||f(t._commandsIgnoreShow)&&!t._commandsDirty)return;let i=t._commands,o=t._commandsIgnoreShow,r=t._spStencil,s=i.length,a=o.length=s/2,c=0;for(let l=0;l<a;++l){let u=o[l]=et.shallowClone(i[c],o[l]);u.shaderProgram=r,u.pass=Te.CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW,c+=2}t._commandsDirty=!1}function P3e(t){if(!t._pickCommandsDirty)return;let n=t._indexOffsets.length,i=t._pickCommands;i.length=n*2;let o=t._va,r=t._spStencil,s=t._spPick,a=A(t._modelMatrix,N.IDENTITY),c=t._uniformMap;for(let l=0;l<n;++l){let u=t._indexOffsets[l],d=t._indexCounts[l],h=f(t._boundingVolumes)?t._boundingVolumes[l]:t.boundingVolume,_=i[l*2];f(_)||(_=i[l*2]=new et({owner:t,pickOnly:!0})),_.vertexArray=o,_.modelMatrix=a,_.offset=u,_.count=d,_.renderState=t._rsStencilDepthPass,_.shaderProgram=r,_.uniformMap=c,_.boundingVolume=h,_.pass=Te.TERRAIN_CLASSIFICATION;let y=et.shallowClone(_,_.derivedCommands.tileset);y.renderState=t._rsStencilDepthPass3DTiles,y.pass=Te.CESIUM_3D_TILE_CLASSIFICATION,_.derivedCommands.tileset=y;let p=i[l*2+1];f(p)||(p=i[l*2+1]=new et({owner:t,pickOnly:!0})),p.vertexArray=o,p.modelMatrix=a,p.offset=u,p.count=d,p.renderState=t._rsPickPass,p.shaderProgram=s,p.uniformMap=c,p.boundingVolume=h,p.pass=Te.TERRAIN_CLASSIFICATION;let C=et.shallowClone(p,p.derivedCommands.tileset);C.pass=Te.CESIUM_3D_TILE_CLASSIFICATION,p.derivedCommands.tileset=C}t._pickCommandsDirty=!1}Nm.prototype.createFeatures=function(t,n){let i=this._batchIds,o=i.length;for(let r=0;r<o;++r){let s=i[r];n[s]=new Ds(t,s)}};Nm.prototype.applyDebugSettings=function(t,n){this._highlightColor=t?n:this._constantColor};function I3e(t,n){t._updatingAllCommands=!0;let i=t._batchIds,o=i.length,r;for(r=0;r<o;++r){let a=i[r],c=n[a];c.show=!0,c.color=z.WHITE}let s=t._batchedIndices;for(o=s.length,r=0;r<o;++r)s[r].color=z.clone(z.WHITE);t._updatingAllCommands=!1,t._batchDirty=!0}var B3e=new z,O3e=z.WHITE,R3e=!0,M3e=/\$/;Nm.prototype.applyStyle=function(t,n){if(!f(t)){I3e(this,n);return}let i=t.color,o=i instanceof Mf&&!M3e.test(i.expression);this._updatingAllCommands=o;let r=this._batchIds,s=r.length,a;for(a=0;a<s;++a){let c=r[a],l=n[c];l.color=f(t.color)?t.color.evaluateColor(l,B3e):O3e,l.show=f(t.show)?t.show.evaluate(l):R3e}if(o){let c=this._batchedIndices;for(s=c.length,a=0;a<s;++a)c[a].color=z.clone(z.WHITE);this._updatingAllCommands=!1,this._batchDirty=!0}};Nm.prototype.updateCommands=function(t,n){if(this._updatingAllCommands)return;let i=this._batchIdLookUp,o=i[t];if(!f(o))return;let r=this._indexOffsets,s=this._indexCounts,a=r[o],c=s[o],l=this._batchedIndices,u=l.length,d;for(d=0;d<u;++d){let C=l[d].offset,x=l[d].count;if(a>=C&&a<C+x)break}l.push(new Fm({color:z.clone(n),offset:a,count:c,batchIds:[t]}));let h=[],_=[],y=l[d].batchIds,p=y.length;for(let C=0;C<p;++C){let x=y[C];if(x===t)continue;let T=i[x];r[T]<a?h.push(x):_.push(x)}_.length!==0&&l.push(new Fm({color:z.clone(l[d].color),offset:a+c,count:l[d].offset+l[d].count-(a+c),batchIds:_})),h.length!==0?(l[d].count=a-l[d].offset,l[d].batchIds=h):l.splice(d,1),this._batchDirty=!0};function Dte(t,n,i,o){let r=t.classificationType,s=r!==Un.CESIUM_3D_TILE,a=r!==Un.TERRAIN,c=n.commandList,l=i.length,u,d;for(d=0;d<l;++d)s&&(u=i[d],u.pass=Te.TERRAIN_CLASSIFICATION,c.push(u)),a&&(u=i[d].derivedCommands.tileset,u.pass=Te.CESIUM_3D_TILE_CLASSIFICATION,c.push(u));if(!(!n.invertClassification||!f(o)))for(l=o.length,d=0;d<l;++d)c.push(o[d])}function L3e(t,n){let i=t.commandList,o=n.length;for(let r=0;r<o;r+=2){let s=n[r+1];s.pass=Te.OPAQUE,i.push(s)}}function F3e(t){let n=t.debugWireframe===t._debugWireframe;if(n=n&&!(t.debugWireframe&&t._wireframeDirty),n)return;f(t._rsWireframe)||(t._rsWireframe=Ve.fromCache({}));let i,o;t.debugWireframe?(i=t._rsWireframe,o=Re.LINES):(i=t._rsColorPass,o=Re.TRIANGLES);let r=t._commands,s=r.length;for(let a=0;a<s;a+=2){let c=r[a+1];c.renderState=i,c.primitiveType=o}t._debugWireframe=t.debugWireframe,t._wireframeDirty=!1}Nm.prototype.update=function(t){let n=t.context;g3e(this,n),y3e(this,n),x3e(this),T3e(this,n);let i=t.passes;i.render&&(D3e(this,n),v3e(this,t),F3e(this),this._debugWireframe?L3e(t,this._commands):Dte(this,t,this._commands,this._commandsIgnoreShow)),i.pick&&(P3e(this),Dte(this,t,this._pickCommands))};Nm.prototype.isDestroyed=function(){return!1};Nm.prototype.destroy=function(){return this._va=this._va&&this._va.destroy(),this._sp=this._sp&&this._sp.destroy(),this._spPick=this._spPick&&this._spPick.destroy(),this._vaSwap=this._vaSwap&&this._vaSwap.destroy(),ue(this)};var Dx=Nm;function Ol(t){this._boxes=t.boxes,this._boxBatchIds=t.boxBatchIds,this._cylinders=t.cylinders,this._cylinderBatchIds=t.cylinderBatchIds,this._ellipsoids=t.ellipsoids,this._ellipsoidBatchIds=t.ellipsoidBatchIds,this._spheres=t.spheres,this._sphereBatchIds=t.sphereBatchIds,this._modelMatrix=t.modelMatrix,this._batchTable=t.batchTable,this._boundingVolume=t.boundingVolume,this._center=t.center,f(this._center)||(f(this._boundingVolume)?this._center=m.clone(this._boundingVolume.center):this._center=m.clone(m.ZERO)),this._boundingVolumes=void 0,this._batchedIndices=void 0,this._indices=void 0,this._indexOffsets=void 0,this._indexCounts=void 0,this._positions=void 0,this._vertexBatchIds=void 0,this._batchIds=void 0,this._batchTableColors=void 0,this._packedBuffer=void 0,this._ready=!1,this._update=function(n,i){},this._readyPromise=G3e(this),this._verticesPromise=void 0,this._primitive=void 0,this.debugWireframe=!1,this.forceRebatch=!1,this.classificationType=Un.BOTH}Object.defineProperties(Ol.prototype,{trianglesLength:{get:function(){return f(this._primitive)?this._primitive.trianglesLength:0}},geometryByteLength:{get:function(){return f(this._primitive)?this._primitive.geometryByteLength:0}},readyPromise:{get:function(){return this._readyPromise}}});Ol.packedBoxLength=N.packedLength+m.packedLength;Ol.packedCylinderLength=N.packedLength+2;Ol.packedEllipsoidLength=N.packedLength+m.packedLength;Ol.packedSphereLength=m.packedLength+1;function N3e(t){let n=new Float64Array(N.packedLength+m.packedLength),i=0;return m.pack(t._center,n,i),i+=m.packedLength,N.pack(t._modelMatrix,n,i),n}function V3e(t,n){let i=0,o=n[i++],r=n[i++],s=t._boundingVolumes=new Array(r);for(let l=0;l<r;++l)s[l]=ae.unpack(n,i),i+=ae.packedLength;let a=n[i++],c=t._batchedIndices=new Array(a);for(let l=0;l<a;++l){let u=z.unpack(n,i);i+=z.packedLength;let d=n[i++],h=n[i++],_=n[i++],y=new Array(_);for(let p=0;p<_;++p)y[p]=n[i++];c[l]=new Fm({color:u,offset:d,count:h,batchIds:y})}return o}var k3e=new fi("createVectorTileGeometries",5),U3e=new z;function z3e(t){if(!f(t._primitive)&&!f(t._verticesPromise)){let n=t._boxes,i=t._boxBatchIds,o=t._cylinders,r=t._cylinderBatchIds,s=t._ellipsoids,a=t._ellipsoidBatchIds,c=t._spheres,l=t._sphereBatchIds,u=t._batchTableColors,d=t._packedBuffer;if(!f(u)){let p=0;f(t._boxes)&&(n=t._boxes=n.slice(),i=t._boxBatchIds=i.slice(),p+=i.length),f(t._cylinders)&&(o=t._cylinders=o.slice(),r=t._cylinderBatchIds=r.slice(),p+=r.length),f(t._ellipsoids)&&(s=t._ellipsoids=s.slice(),a=t._ellipsoidBatchIds=a.slice(),p+=a.length),f(t._spheres)&&(c=t._sphere=c.slice(),l=t._sphereBatchIds=l.slice(),p+=l.length),u=t._batchTableColors=new Uint32Array(p);let C=t._batchTable;for(let x=0;x<p;++x){let T=C.getColor(x,U3e);u[x]=T.toRgba()}d=t._packedBuffer=N3e(t)}let h=[];f(n)&&h.push(n.buffer,i.buffer),f(o)&&h.push(o.buffer,r.buffer),f(s)&&h.push(s.buffer,a.buffer),f(c)&&h.push(c.buffer,l.buffer),h.push(u.buffer,d.buffer);let _={boxes:f(n)?n.buffer:void 0,boxBatchIds:f(n)?i.buffer:void 0,cylinders:f(o)?o.buffer:void 0,cylinderBatchIds:f(o)?r.buffer:void 0,ellipsoids:f(s)?s.buffer:void 0,ellipsoidBatchIds:f(s)?a.buffer:void 0,spheres:f(c)?c.buffer:void 0,sphereBatchIds:f(c)?l.buffer:void 0,batchTableColors:u.buffer,packedBuffer:d.buffer},y=t._verticesPromise=k3e.scheduleTask(_,h);return f(y)?y.then(function(p){let C=new Float64Array(p.packedBuffer);V3e(t,C)===2?t._indices=new Uint16Array(p.indices):t._indices=new Uint32Array(p.indices),t._indexOffsets=new Uint32Array(p.indexOffsets),t._indexCounts=new Uint32Array(p.indexCounts),t._positions=new Float32Array(p.positions),t._vertexBatchIds=new Uint16Array(p.vertexBatchIds),t._batchIds=new Uint16Array(p.batchIds),t._ready=!0}):void 0}}function H3e(t){t._ready&&!f(t._primitive)&&(t._primitive=new Dx({batchTable:t._batchTable,positions:t._positions,batchIds:t._batchIds,vertexBatchIds:t._vertexBatchIds,indices:t._indices,indexOffsets:t._indexOffsets,indexCounts:t._indexCounts,batchedIndices:t._batchedIndices,boundingVolume:t._boundingVolume,boundingVolumes:t._boundingVolumes,center:t._center,pickObject:A(t._pickObject,t)}),t._boxes=void 0,t._boxBatchIds=void 0,t._cylinders=void 0,t._cylinderBatchIds=void 0,t._ellipsoids=void 0,t._ellipsoidBatchIds=void 0,t._spheres=void 0,t._sphereBatchIds=void 0,t._center=void 0,t._modelMatrix=void 0,t._batchTable=void 0,t._boundingVolume=void 0,t._boundingVolumes=void 0,t._batchedIndices=void 0,t._indices=void 0,t._indexOffsets=void 0,t._indexCounts=void 0,t._positions=void 0,t._vertexBatchIds=void 0,t._batchIds=void 0,t._batchTableColors=void 0,t._packedBuffer=void 0,t._verticesPromise=void 0)}Ol.prototype.createFeatures=function(t,n){this._primitive.createFeatures(t,n)};Ol.prototype.applyDebugSettings=function(t,n){this._primitive.applyDebugSettings(t,n)};Ol.prototype.applyStyle=function(t,n){this._primitive.applyStyle(t,n)};Ol.prototype.updateCommands=function(t,n){this._primitive.updateCommands(t,n)};function G3e(t){return new Promise(function(n,i){t._update=function(o,r){let s=z3e(o);o._ready&&(o._primitive.debugWireframe=o.debugWireframe,o._primitive.forceRebatch=o.forceRebatch,o._primitive.classificationType=o.classificationType,o._primitive.update(r)),f(s)&&s.then(function(){H3e(o),n(o)}).catch(function(a){i(a)})}})}Ol.prototype.update=function(t){this._update(this,t)};Ol.prototype.isDestroyed=function(){return!1};Ol.prototype.destroy=function(){return this._primitive=this._primitive&&this._primitive.destroy(),ue(this)};var S_=Ol;function Vm(t,n,i,o,r){this._tileset=t,this._tile=n,this._resource=i,this._geometries=void 0,this._metadata=void 0,this._batchTable=void 0,this._features=void 0,this.featurePropertiesDirty=!1,this._group=void 0,this._readyPromise=q3e(this,o,r)}Object.defineProperties(Vm.prototype,{featuresLength:{get:function(){return f(this._batchTable)?this._batchTable.featuresLength:0}},pointsLength:{get:function(){return 0}},trianglesLength:{get:function(){return f(this._geometries)?this._geometries.trianglesLength:0}},geometryByteLength:{get:function(){return f(this._geometries)?this._geometries.geometryByteLength:0}},texturesByteLength:{get:function(){return 0}},batchTableByteLength:{get:function(){return f(this._batchTable)?this._batchTable.batchTableByteLength:0}},innerContents:{get:function(){}},readyPromise:{get:function(){return this._readyPromise}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._resource.getUrlComponent(!0)}},metadata:{get:function(){return this._metadata},set:function(t){this._metadata=t}},batchTable:{get:function(){return this._batchTable}},group:{get:function(){return this._group},set:function(t){this._group=t}}});function W3e(t){return function(n,i){f(t._geometries)&&t._geometries.updateCommands(n,i)}}function j3e(t,n){let i,o,r,s,a,c=A(t.BOXES_LENGTH,0),l=A(t.CYLINDERS_LENGTH,0),u=A(t.ELLIPSOIDS_LENGTH,0),d=A(t.SPHERES_LENGTH,0);if(c>0&&f(t.BOX_BATCH_IDS)){let p=n.byteOffset+t.BOX_BATCH_IDS.byteOffset;i=new Uint16Array(n.buffer,p,c)}if(l>0&&f(t.CYLINDER_BATCH_IDS)){let p=n.byteOffset+t.CYLINDER_BATCH_IDS.byteOffset;o=new Uint16Array(n.buffer,p,l)}if(u>0&&f(t.ELLIPSOID_BATCH_IDS)){let p=n.byteOffset+t.ELLIPSOID_BATCH_IDS.byteOffset;r=new Uint16Array(n.buffer,p,u)}if(d>0&&f(t.SPHERE_BATCH_IDS)){let p=n.byteOffset+t.SPHERE_BATCH_IDS.byteOffset;s=new Uint16Array(n.buffer,p,d)}let h=f(i)||f(o)||f(r)||f(s),_=c>0&&!f(i)||l>0&&!f(o)||u>0&&!f(r)||d>0&&!f(s);if(h&&_)throw new he("If one group of batch ids is defined, then all batch ids must be defined.");if(!f(i)&&!f(o)&&!f(r)&&!f(s)){let p=0;if(!f(i)&&c>0)for(i=new Uint16Array(c),a=0;a<c;++a)i[a]=p++;if(!f(o)&&l>0)for(o=new Uint16Array(l),a=0;a<l;++a)o[a]=p++;if(!f(r)&&u>0)for(r=new Uint16Array(u),a=0;a<u;++a)r[a]=p++;if(!f(s)&&d>0)for(s=new Uint16Array(d),a=0;a<d;++a)s[a]=p++}return{boxes:i,cylinders:o,ellipsoids:r,spheres:s}}var cy=Uint32Array.BYTES_PER_ELEMENT;function q3e(t,n,i){i=A(i,0);let o=new Uint8Array(n),r=new DataView(n);i+=cy;let s=r.getUint32(i,!0);if(s!==1)throw new he(`Only Geometry tile version 1 is supported.  Version ${s} is not.`);i+=cy;let a=r.getUint32(i,!0);if(i+=cy,a===0){t._readyPromise.resolve(t);return}let c=r.getUint32(i,!0);if(i+=cy,c===0)throw new he("Feature table must have a byte length greater than zero");let l=r.getUint32(i,!0);i+=cy;let u=r.getUint32(i,!0);i+=cy;let d=r.getUint32(i,!0);i+=cy;let h=Ko(o,i,c);i+=c;let _=new Uint8Array(n,i,l);i+=l;let y,p;u>0&&(y=Ko(o,i,u),i+=u,d>0&&(p=new Uint8Array(n,i,d),p=new Uint8Array(p)));let C=A(h.BOXES_LENGTH,0),x=A(h.CYLINDERS_LENGTH,0),T=A(h.ELLIPSOIDS_LENGTH,0),E=A(h.SPHERES_LENGTH,0),S=C+x+T+E,w=new E_(t,S,y,p,W3e(t));if(t._batchTable=w,S===0)return;let D=t.tile.computedTransform,I;f(h.RTC_CENTER)&&(I=m.unpack(h.RTC_CENTER),N.multiplyByPoint(D,I,I));let O=j3e(h,_);if(C>0||x>0||T>0||E>0){let M,L,F,g;if(C>0){let b=_.byteOffset+h.BOXES.byteOffset;M=new Float32Array(_.buffer,b,S_.packedBoxLength*C)}if(x>0){let b=_.byteOffset+h.CYLINDERS.byteOffset;L=new Float32Array(_.buffer,b,S_.packedCylinderLength*x)}if(T>0){let b=_.byteOffset+h.ELLIPSOIDS.byteOffset;F=new Float32Array(_.buffer,b,S_.packedEllipsoidLength*T)}if(E>0){let b=_.byteOffset+h.SPHERES.byteOffset;g=new Float32Array(_.buffer,b,S_.packedSphereLength*E)}return t._geometries=new S_({boxes:M,boxBatchIds:O.boxes,cylinders:L,cylinderBatchIds:O.cylinders,ellipsoids:F,ellipsoidBatchIds:O.ellipsoids,spheres:g,sphereBatchIds:O.spheres,center:I,modelMatrix:D,batchTable:w,boundingVolume:t.tile.boundingVolume.boundingVolume}),t._geometries.readyPromise.then(function(){return t})}return Promise.resolve(t)}function vte(t){let n=t.featuresLength;if(!f(t._features)&&n>0){let i=new Array(n);f(t._geometries)&&t._geometries.createFeatures(t,i),t._features=i}}Vm.prototype.hasProperty=function(t,n){return this._batchTable.hasProperty(t,n)};Vm.prototype.getFeature=function(t){return vte(this),this._features[t]};Vm.prototype.applyDebugSettings=function(t,n){f(this._geometries)&&this._geometries.applyDebugSettings(t,n)};Vm.prototype.applyStyle=function(t){vte(this),f(this._geometries)&&this._geometries.applyStyle(t,this._features)};Vm.prototype.update=function(t,n){f(this._geometries)&&(this._geometries.classificationType=this._tileset.classificationType,this._geometries.debugWireframe=this._tileset.debugWireframe,this._geometries.update(n)),f(this._batchTable)&&this._geometries._ready&&this._batchTable.update(t,n)};Vm.prototype.isDestroyed=function(){return!1};Vm.prototype.destroy=function(){return this._geometries=this._geometries&&this._geometries.destroy(),this._batchTable=this._batchTable&&this._batchTable.destroy(),ue(this)};var RL=Vm;var n5={};n5.encode2D=function(t,n,i){let o=Math.pow(2,t),r={x:n,y:i},s,a,c,l=BigInt(0);for(c=o/2;c>0;c/=2)s=(r.x&c)>0?1:0,a=(r.y&c)>0?1:0,l+=BigInt((3*s^a)*c*c),Pte(o,r,s,a);return l};n5.decode2D=function(t,n){let i=Math.pow(2,t),o={x:0,y:0},r,s,a,c;for(a=1,c=n;a<i;a*=2)r=1&Number(c/BigInt(2)),s=1&Number(c^BigInt(r)),Pte(a,o,r,s),o.x+=a*r,o.y+=a*s,c/=BigInt(4);return[o.x,o.y]};function Pte(t,n,i,o){if(o!==0)return;i===1&&(n.x=t-1-n.x,n.y=t-1-n.y);let r=n.x;n.x=n.y,n.y=r}var WS=n5;var ly=30,Y3e=1<<ly,X3e=1<<ly+1>>>0,i5=2*ly+1,w_=4,Ote=[],Rte=[],K3e=[[0,1,3,2],[0,2,3,1],[3,2,0,1],[3,1,0,2]],D_=1,vx=2,ML=[D_,0,0,D_|vx];function Rr(t){if(!Vt.supportsBigInt())throw new he("S2 required BigInt support");this._cellId=t,this._level=Rr.getLevel(t)}Rr.fromToken=function(t){return new Rr(Rr.getIdFromToken(t))};Rr.isValidId=function(t){return!(t<=0||t>>BigInt(i5)>5||!(t&~t+BigInt(1)&BigInt("0x1555555555555555")))};Rr.isValidToken=function(t){return/^[0-9a-fA-F]{1,16}$/.test(t)?Rr.isValidId(Rr.getIdFromToken(t)):!1};Rr.getIdFromToken=function(t){return BigInt("0x"+t+"0".repeat(16-t.length))};Rr.getTokenFromId=function(t){let n=Math.floor(rVe(t)/4),i=t.toString(16).replace(/0*$/,"");return Array(17-n-i.length).join("0")+i};Rr.getLevel=function(t){let n=0;for(;t!==BigInt(0)&&!(t&BigInt(1));)n++,t=t>>BigInt(1);return ly-(n>>1)};Rr.prototype.getChild=function(t){let n=Fte(this._cellId)>>BigInt(2),i=this._cellId+BigInt(2*t+1-4)*n;return new Rr(i)};Rr.prototype.getParent=function(){let t=Fte(this._cellId)<<BigInt(2);return new Rr(this._cellId&~t+BigInt(1)|t)};Rr.prototype.getParentAtLevel=function(t){let n=iVe(t);return new Rr(this._cellId&-n|n)};Rr.prototype.getCenter=function(t){t=A(t,oe.WGS84);let n=J3e(this._cellId,this._level);n=m.normalize(n,n);let i=new de.fromCartesian(n,oe.UNIT_SPHERE);return de.toCartesian(i,t,new m)};Rr.prototype.getVertex=function(t,n){n=A(n,oe.WGS84);let i=Z3e(this._cellId,this._level,t);i=m.normalize(i,i);let o=new de.fromCartesian(i,oe.UNIT_SPHERE);return de.toCartesian(o,n,new m)};Rr.fromFacePositionLevel=function(t,n,i){let o=(t<4?"0":"")+(t<2?"0":"")+t.toString(2),r=n.toString(2),s=Array(2*i-r.length+1).join("0"),a=Array(i5-2*i).join("0"),c=BigInt(`0b${o}${s}${r}1${a}`);return new Rr(c)};function J3e(t,n){let i=Q3e(t,n);return $3e(i[0],i[1],i[2])}function Z3e(t,n,i){let o=Mte(t,n),r=eVe([o[1],o[2]],n),s=i>>1&1;return Lte(o[0],r[0][s^i&1],r[1][s])}function Q3e(t,n){let i=Mte(t),o=i[0],r=i[1],s=i[2],a=n===30,c=!a&&(BigInt(r)^t>>BigInt(2))&BigInt(1),l=a?1:c?2:0,u=(r<<1)+l,d=(s<<1)+l;return[o,u,d]}function Mte(t){Ote.length===0&&nVe();let n=Number(t>>BigInt(i5)),i=n&D_,o=(1<<w_)-1,r=0,s=0;for(let a=7;a>=0;a--){let l=(1<<2*(a===7?ly-7*w_:w_))-1;i+=Number(t>>BigInt(a*2*w_+1)&BigInt(l))<<2,i=Rte[i];let u=a*w_;r+=i>>w_+2<<u,s+=(i>>2&o)<<u,i&=D_|vx}return[n,r,s]}function $3e(t,n,i){let o=Ite(n),r=Ite(i),s=LL(o),a=LL(r);return Lte(t,s,a)}function Lte(t,n,i){switch(t){case 0:return new m(1,n,i);case 1:return new m(-n,1,i);case 2:return new m(-n,-i,1);case 3:return new m(-1,-i,-n);case 4:return new m(i,-1,-n);default:return new m(i,n,-1)}}function LL(t){return t>=.5?1/3*(4*t*t-1):1/3*(1-4*(1-t)*(1-t))}function Ite(t){return 1/X3e*t}function eVe(t,n){let i=[[],[]],o=tVe(n);for(let r=0;r<2;++r){let s=t[r]&-o,a=s+o;i[r][0]=LL(Bte(s)),i[r][1]=LL(Bte(a))}return i}function tVe(t){return 1<<ly-t>>>0}function Bte(t){return 1/Y3e*t}function v_(t,n,i,o,r,s){if(t===w_){let a=(n<<w_)+i;Ote[(a<<2)+o]=(r<<2)+s,Rte[(r<<2)+o]=(a<<2)+s}else{t++,n<<=1,i<<=1,r<<=2;let a=K3e[s];v_(t,n+(a[0]>>1),i+(a[0]&1),o,r,s^ML[0]),v_(t,n+(a[1]>>1),i+(a[1]&1),o,r+1,s^ML[1]),v_(t,n+(a[2]>>1),i+(a[2]&1),o,r+2,s^ML[2]),v_(t,n+(a[3]>>1),i+(a[3]&1),o,r+3,s^ML[3])}}function nVe(){v_(0,0,0,0,0,0),v_(0,0,0,D_,0,D_),v_(0,0,0,vx,0,vx),v_(0,0,0,D_|vx,0,D_|vx)}function Fte(t){return t&~t+BigInt(1)}function iVe(t){return BigInt(1)<<BigInt(2*(ly-t))}var oVe=[64,0,1,39,2,15,40,23,3,12,16,59,41,19,24,54,4,64,13,10,17,62,60,28,42,30,20,51,25,44,55,47,5,32,65,38,14,22,11,58,18,53,63,9,61,27,29,50,43,46,31,37,21,57,52,8,26,49,45,36,56,7,48,35,6,34,33,0];function rVe(t){return oVe[(-t&t)%BigInt(67)]}var P_=Rr;function o5(t){let n=t.lengthBits,i=t.availableCount,o=t.constant,r=t.bitstream;if(f(o))i=n;else{let s=Math.ceil(n/8);if(r.length!==s)throw new he(`Availability bitstream must be exactly ${s} bytes long to store ${n} bits. Actual bitstream was ${r.length} bytes long.`);let a=A(t.computeAvailableCountEnabled,!1);!f(i)&&a&&(i=sVe(r,n))}this._lengthBits=n,this._availableCount=i,this._constant=o,this._bitstream=r}function sVe(t,n){let i=0;for(let o=0;o<n;o++){let r=o>>3,s=o%8;i+=t[r]>>s&1}return i}Object.defineProperties(o5.prototype,{lengthBits:{get:function(){return this._lengthBits}},availableCount:{get:function(){return this._availableCount}}});o5.prototype.getBit=function(t){if(f(this._constant))return this._constant;let n=t>>3,i=t%8;return(this._bitstream[n]>>i&1)===1};var jS=o5;function km(t){t=A(t,A.EMPTY_OBJECT);let n=t.metadataTable,i=t.class,o=t.entityId,r=t.propertyTableJson;this._class=i,this._metadataTable=n,this._entityId=o,this._extensions=r.extensions,this._extras=r.extras}Object.defineProperties(km.prototype,{class:{get:function(){return this._class}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}});km.prototype.hasProperty=function(t){return this._metadataTable.hasProperty(t)};km.prototype.hasPropertyBySemantic=function(t){return this._metadataTable.hasPropertyBySemantic(t)};km.prototype.getPropertyIds=function(t){return this._metadataTable.getPropertyIds(t)};km.prototype.getProperty=function(t){return this._metadataTable.getProperty(this._entityId,t)};km.prototype.setProperty=function(t,n){return this._metadataTable.setProperty(this._entityId,t,n)};km.prototype.getPropertyBySemantic=function(t){return this._metadataTable.getPropertyBySemantic(this._entityId,t)};km.prototype.setPropertyBySemantic=function(t,n){return this._metadataTable.setPropertyBySemantic(this._entityId,t,n)};var qS=km;var FL={QUADTREE:"QUADTREE",OCTREE:"OCTREE"};FL.getBranchingFactor=function(t){switch(t){case FL.OCTREE:return 8;case FL.QUADTREE:return 4}};var jr=Object.freeze(FL);function Um(t){t=A(t,A.EMPTY_OBJECT);let n=t.subtreeMetadata,i=t.class,o=f(n.properties)?n.properties:{};this._class=i,this._properties=o,this._extras=n.extras,this._extensions=n.extensions}Object.defineProperties(Um.prototype,{class:{get:function(){return this._class}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}});Um.prototype.hasProperty=function(t){return Nn.hasProperty(t,this._properties,this._class)};Um.prototype.hasPropertyBySemantic=function(t){return Nn.hasPropertyBySemantic(t,this._properties,this._class)};Um.prototype.getPropertyIds=function(t){return Nn.getPropertyIds(this._properties,this._class,t)};Um.prototype.getProperty=function(t){return Nn.getProperty(t,this._properties,this._class)};Um.prototype.setProperty=function(t,n){return Nn.setProperty(t,n,this._properties,this._class)};Um.prototype.getPropertyBySemantic=function(t){return Nn.getPropertyBySemantic(t,this._properties,this._class)};Um.prototype.setPropertyBySemantic=function(t,n){return Nn.setPropertyBySemantic(t,n,this._properties,this._class)};var NL=Um;function Ba(t,n,i,o,r){this._resource=t,this._subtreeJson=void 0,this._bufferLoader=void 0,this._tileAvailability=void 0,this._contentAvailabilityBitstreams=[],this._childSubtreeAvailability=void 0,this._implicitCoordinates=r,this._subtreeLevels=o.subtreeLevels,this._subdivisionScheme=o.subdivisionScheme,this._branchingFactor=o.branchingFactor,this._metadata=void 0,this._tileMetadataTable=void 0,this._tilePropertyTableJson=void 0,this._contentMetadataTables=[],this._contentPropertyTableJsons=[],this._tileJumpBuffer=void 0,this._contentJumpBuffers=[],this._readyPromise=aVe(this,n,i,o)}Object.defineProperties(Ba.prototype,{readyPromise:{get:function(){return this._readyPromise}},metadata:{get:function(){return this._metadata}},tileMetadataTable:{get:function(){return this._tileMetadataTable}},tilePropertyTableJson:{get:function(){return this._tilePropertyTableJson}},contentMetadataTables:{get:function(){return this._contentMetadataTables}},contentPropertyTableJsons:{get:function(){return this._contentPropertyTableJsons}},implicitCoordinates:{get:function(){return this._implicitCoordinates}}});Ba.prototype.tileIsAvailableAtIndex=function(t){return this._tileAvailability.getBit(t)};Ba.prototype.tileIsAvailableAtCoordinates=function(t){let n=this.getTileIndex(t);return this.tileIsAvailableAtIndex(n)};Ba.prototype.contentIsAvailableAtIndex=function(t,n){return n=A(n,0),this._contentAvailabilityBitstreams[n].getBit(t)};Ba.prototype.contentIsAvailableAtCoordinates=function(t,n){let i=this.getTileIndex(t);return this.contentIsAvailableAtIndex(i,n)};Ba.prototype.childSubtreeIsAvailableAtIndex=function(t){return this._childSubtreeAvailability.getBit(t)};Ba.prototype.childSubtreeIsAvailableAtCoordinates=function(t){let n=this.getChildSubtreeIndex(t);return this.childSubtreeIsAvailableAtIndex(n)};Ba.prototype.getLevelOffset=function(t){let n=this._branchingFactor;return(Math.pow(n,t)-1)/(n-1)};Ba.prototype.getParentMortonIndex=function(t){let n=2;return this._subdivisionScheme===jr.OCTREE&&(n=3),t>>n};function aVe(t,n,i,o){let r;f(n)?r={json:n,binary:void 0}:r=cVe(i);let s=r.json;t._subtreeJson=s;let a;if(Li(s,"3DTILES_metadata"))a=s.extensions["3DTILES_metadata"];else if(f(s.tileMetadata)){let p=s.tileMetadata;a=s.propertyTables[p]}let c=[];if(f(s.contentMetadata)){let p=s.contentMetadata.length;for(let C=0;C<p;C++){let x=s.contentMetadata[C];c.push(s.propertyTables[x])}}let l,u=o.metadataSchema,d=s.subtreeMetadata;if(f(d)){let p=d.class,C=u.classes[p];l=new NL({subtreeMetadata:d,class:C})}t._metadata=l,t._tilePropertyTableJson=a,t._contentPropertyTableJsons=c;let h={constant:0};s.contentAvailabilityHeaders=[],Li(s,"3DTILES_multiple_contents")?s.contentAvailabilityHeaders=s.extensions["3DTILES_multiple_contents"].contentAvailability:Array.isArray(s.contentAvailability)?s.contentAvailabilityHeaders=s.contentAvailability:s.contentAvailabilityHeaders.push(A(s.contentAvailability,h));let _=lVe(s.buffers),y=uVe(s.bufferViews,_);fVe(s,y),f(a)&&Nte(a,y);for(let p=0;p<c.length;p++){let C=c[p];Nte(C,y)}return dVe(t,_,r.binary).then(function(p){let C=mVe(y,p);return pVe(t,s,o,C),f(a)&&(_Ve(t,o,C),yVe(t)),gVe(t,o,C),AVe(t),t})}function cVe(t){let i=new DataView(t.buffer,t.byteOffset),o=8,r=i.getUint32(o,!0);o+=8;let s=i.getUint32(o,!0);o+=8;let a=Ko(t,o,r);o+=r;let c=t.subarray(o,o+s);return{json:a,binary:c}}function lVe(t){t=f(t)?t:[];for(let n=0;n<t.length;n++){let i=t[n];i.isExternal=f(i.uri),i.isActive=!1}return t}function uVe(t,n){t=f(t)?t:[];for(let i=0;i<t.length;i++){let o=t[i],r=n[o.buffer];o.bufferHeader=r,o.isActive=!1}return t}function fVe(t,n){let i,o=t.tileAvailability;f(o.bitstream)?i=n[o.bitstream]:f(o.bufferView)&&(i=n[o.bufferView]),f(i)&&(i.isActive=!0,i.bufferHeader.isActive=!0);let r=t.contentAvailabilityHeaders;for(let a=0;a<r.length;a++)i=void 0,f(r[a].bitstream)?i=n[r[a].bitstream]:f(r[a].bufferView)&&(i=n[r[a].bufferView]),f(i)&&(i.isActive=!0,i.bufferHeader.isActive=!0);i=void 0;let s=t.childSubtreeAvailability;f(s.bitstream)?i=n[s.bitstream]:f(s.bufferView)&&(i=n[s.bufferView]),f(i)&&(i.isActive=!0,i.bufferHeader.isActive=!0)}function Nte(t,n){let i=t.properties,o;for(let r in i)if(i.hasOwnProperty(r)){let s=i[r],a=A(s.values,s.bufferView);o=n[a],o.isActive=!0,o.bufferHeader.isActive=!0;let c=A(s.stringOffsets,s.stringOffsetBufferView);f(c)&&(o=n[c],o.isActive=!0,o.bufferHeader.isActive=!0);let l=A(s.arrayOffsets,s.arrayOffsetBufferView);f(l)&&(o=n[l],o.isActive=!0,o.bufferHeader.isActive=!0)}}function dVe(t,n,i){let o=[];for(let r=0;r<n.length;r++){let s=n[r];if(!s.isActive)o.push(Promise.resolve(void 0));else if(s.isExternal){let a=hVe(t,s);o.push(a)}else o.push(Promise.resolve(i))}return Promise.all(o).then(function(r){let s={};for(let a=0;a<r.length;a++){let c=r[a];f(c)&&(s[a]=c)}return s})}function hVe(t,n){let o=t._resource.getDerivedResource({url:n.uri}),r=fo.loadExternalBuffer({resource:o});return t._bufferLoader=r,r.promise.then(function(s){return s.typedArray})}function mVe(t,n){let i={};for(let o=0;o<t.length;o++){let r=t[o];if(!r.isActive)continue;let s=r.byteOffset,a=s+r.byteLength,l=n[r.buffer].subarray(s,a);i[o]=l}return i}function pVe(t,n,i,o){let r=i.branchingFactor,s=i.subtreeLevels,a=(Math.pow(r,s)-1)/(r-1),c=Math.pow(r,s),l=Li(n,"3DTILES_metadata"),u=f(t._tilePropertyTableJson),d=l||u;t._tileAvailability=r5(n.tileAvailability,o,a,d);let h=t._contentPropertyTableJsons.length>0;d=d||h;for(let _=0;_<n.contentAvailabilityHeaders.length;_++){let y=r5(n.contentAvailabilityHeaders[_],o,a,d);t._contentAvailabilityBitstreams.push(y)}t._childSubtreeAvailability=r5(n.childSubtreeAvailability,o,c)}function r5(t,n,i,o){if(f(t.constant))return new jS({constant:Boolean(t.constant),lengthBits:i,availableCount:t.availableCount});let r;return f(t.bitstream)?r=n[t.bitstream]:f(t.bufferView)&&(r=n[t.bufferView]),new jS({bitstream:r,lengthBits:i,availableCount:t.availableCount,computeAvailableCountEnabled:o})}function _Ve(t,n,i){let o=t._tilePropertyTableJson,r=t._tileAvailability.availableCount,s=n.metadataSchema,a=o.class,c=s.classes[a];t._tileMetadataTable=new wf({class:c,count:r,properties:o.properties,bufferViews:i})}function gVe(t,n,i){let o=t._contentPropertyTableJsons,r=t._contentAvailabilityBitstreams,s=n.metadataSchema,a=t._contentMetadataTables;for(let c=0;c<o.length;c++){let l=o[c],d=r[c].availableCount,h=l.class,_=s.classes[h],y=new wf({class:_,count:d,properties:l.properties,bufferViews:i});a.push(y)}}function Vte(t){let n=0,i=t.lengthBits,o=t.availableCount,r;o<256?r=new Uint8Array(i):o<65536?r=new Uint16Array(i):r=new Uint32Array(i);for(let s=0;s<t.lengthBits;s++)t.getBit(s)&&(r[s]=n,n++);return r}function yVe(t){let n=Vte(t._tileAvailability);t._tileJumpBuffer=n}function AVe(t){let n=t._contentJumpBuffers,i=t._contentAvailabilityBitstreams;for(let o=0;o<i.length;o++){let r=i[o],s=Vte(r);n.push(s)}}Ba.prototype.getTileIndex=function(t){let n=t.level-this._implicitCoordinates.level;if(n<0||this._subtreeLevels<=n)throw new he("level is out of bounds for this subtree");return t.getSubtreeCoordinates().getOffsetCoordinates(t).tileIndex};Ba.prototype.getChildSubtreeIndex=function(t){if(t.level-this._implicitCoordinates.level!==this._implicitCoordinates.subtreeLevels)throw new he("level is out of bounds for this subtree");return t.getParentSubtreeCoordinates().getOffsetCoordinates(t).mortonIndex};function CVe(t,n){if(!f(t._tileMetadataTable))return;let i=t.getTileIndex(n);if(t._tileAvailability.getBit(i))return t._tileJumpBuffer[i]}function xVe(t,n,i){let o=t._contentMetadataTables;if(!f(o))return;let r=o[i];if(!f(r))return;let s=t._contentAvailabilityBitstreams[i],a=t.getTileIndex(n);if(s.getBit(a))return t._contentJumpBuffers[i][a]}Ba.prototype.getTileMetadataView=function(t){let n=CVe(this,t);if(!f(n))return;let i=this._tileMetadataTable;return new qS({class:i.class,metadataTable:i,entityId:n,propertyTableJson:this._tilePropertyTableJson})};Ba.prototype.getContentMetadataView=function(t,n){let i=xVe(this,t,n);if(!f(i))return;let o=this._contentMetadataTables[n],r=this._contentPropertyTableJsons[n];return new qS({class:o.class,metadataTable:o,entityId:i,contentIndex:n,propertyTableJson:r})};Ba.prototype.isDestroyed=function(){return!1};Ba.prototype.destroy=function(){return f(this._bufferLoader)&&fo.unload(this._bufferLoader),ue(this)};var VL=Ba;var TVe={ID:"ID",NAME:"NAME",DESCRIPTION:"DESCRIPTION",TILE_BOUNDING_BOX:"TILE_BOUNDING_BOX",TILE_BOUNDING_REGION:"TILE_BOUNDING_REGION",TILE_BOUNDING_SPHERE:"TILE_BOUNDING_SPHERE",TILE_MINIMUM_HEIGHT:"TILE_MINIMUM_HEIGHT",TILE_MAXIMUM_HEIGHT:"TILE_MAXIMUM_HEIGHT",TILE_HORIZON_OCCLUSION_POINT:"TILE_HORIZON_OCCLUSION_POINT",TILE_GEOMETRIC_ERROR:"TILE_GEOMETRIC_ERROR",CONTENT_BOUNDING_BOX:"CONTENT_BOUNDING_BOX",CONTENT_BOUNDING_REGION:"CONTENT_BOUNDING_REGION",CONTENT_BOUNDING_SPHERE:"CONTENT_BOUNDING_SPHERE",CONTENT_MINIMUM_HEIGHT:"CONTENT_MINIMUM_HEIGHT",CONTENT_MAXIMUM_HEIGHT:"CONTENT_MAXIMUM_HEIGHT",CONTENT_HORIZON_OCCLUSION_POINT:"CONTENT_HORIZON_OCCLUSION_POINT"},kL=Object.freeze(TVe);function EVe(t){return{tile:{boundingVolume:kte("TILE",t),minimumHeight:Ute("TILE",t),maximumHeight:zte("TILE",t)},content:{boundingVolume:kte("CONTENT",t),minimumHeight:Ute("CONTENT",t),maximumHeight:zte("CONTENT",t)}}}function kte(t,n){let i=`${t}_BOUNDING_BOX`,o=n.getPropertyBySemantic(i);if(f(o))return{box:o};let r=`${t}_BOUNDING_REGION`,s=n.getPropertyBySemantic(r);if(f(s))return{region:s};let a=`${t}_BOUNDING_SPHERE`,c=n.getPropertyBySemantic(a);if(f(c))return{sphere:c}}function Ute(t,n){let i=`${t}_MINIMUM_HEIGHT`;return n.getPropertyBySemantic(i)}function zte(t,n){let i=`${t}_MAXIMUM_HEIGHT`;return n.getPropertyBySemantic(i)}var UL=EVe;function bu(t,n,i,o,r,s){let a=n.implicitTileset,c=n.implicitCoordinates;this._implicitTileset=a,this._implicitCoordinates=c,this._implicitSubtree=void 0,this._tileset=t,this._tile=n,this._resource=i,this._metadata=void 0,this.featurePropertiesDirty=!1,this._group=void 0;let l=c.getTemplateValues(),u=a.subtreeUriTemplate.getDerivedResource({templateValues:l});this._url=u.getUrlComponent(!0),this._readyPromise=bVe(this,o,r,s)}Object.defineProperties(bu.prototype,{featuresLength:{get:function(){return 0}},pointsLength:{get:function(){return 0}},trianglesLength:{get:function(){return 0}},geometryByteLength:{get:function(){return 0}},texturesByteLength:{get:function(){return 0}},batchTableByteLength:{get:function(){return 0}},innerContents:{get:function(){}},readyPromise:{get:function(){return this._readyPromise}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._url}},metadata:{get:function(){},set:function(){}},batchTable:{get:function(){}},group:{get:function(){return this._group},set:function(t){this._group=t}}});function bVe(t,n,i,o){o=A(o,0);let r;f(i)&&(r=new Uint8Array(i,o));let s=new VL(t._resource,n,r,t._implicitTileset,t._implicitCoordinates);return t._implicitSubtree=s,s.readyPromise.then(function(){return SVe(t,s),t})}function SVe(t,n){let i=t._tile,o=t._implicitCoordinates.childIndex,r=DVe(t,n,i,o),s=t._tileset.statistics;i.children.push(r.rootTile),s.numberOfTilesTotal++;let a=wVe(t,n,r.bottomRow);for(let c=0;c<a.length;c++){let l=a[c],u=l.tile,d=FVe(t,u,l.childIndex);u.children.push(d),s.numberOfTilesTotal++}}function wVe(t,n,i){let o=[],r=t._implicitTileset.branchingFactor;for(let s=0;s<i.length;s++){let a=i[s];if(!!f(a))for(let c=0;c<r;c++){let l=s*r+c;n.childSubtreeIsAvailableAtIndex(l)&&o.push({tile:a,childIndex:c})}}return o}function DVe(t,n,i,o){let a=Hte(t,n,i,o,0,!0),c=t._tileset.statistics,l=[a],u=[],d=t._implicitTileset;for(let h=1;h<d.subtreeLevels;h++){let _=n.getLevelOffset(h),y=d.branchingFactor*l.length;for(let p=0;p<y;p++){let C=_+p;if(!n.tileIsAvailableAtIndex(C)){u.push(void 0);continue}let x=n.getParentMortonIndex(p),T=l[x],E=p%d.branchingFactor,S=Hte(t,n,T,E,C);T.children.push(S),c.numberOfTilesTotal++,u.push(S)}l=u,u=[]}return{rootTile:a,bottomRow:l}}function Gte(t,n,i){let o=kL.TILE_GEOMETRIC_ERROR;return f(t)&&t.hasPropertyBySemantic(o)?t.getPropertyBySemantic(o):n.geometricError/Math.pow(2,i.level)}function Hte(t,n,i,o,r,s){let a=t._implicitTileset,c;A(s,!1)?c=i.implicitCoordinates:c=i.implicitCoordinates.getChildCoordinates(o);let l,u,d;if(f(n.tilePropertyTableJson)){l=n.getTileMetadataView(c);let I=UL(l);u=I.tile,d=I.content}let _=n.contentPropertyTableJsons.length,y=!1;for(let I=0;I<_;I++)if(n.contentIsAvailableAtCoordinates(c,I)){y=!0;break}let p=IVe(a,c,o,s,i,u),C=[];for(let I=0;I<a.contentCount;I++){if(!n.contentIsAvailableAtIndex(r,I))continue;let L={uri:a.contentUriTemplates[I].getDerivedResource({templateValues:c.getTemplateValues()}).url},F=BVe(p,d);f(F)&&(L.boundingVolume=F),C.push(At(L,a.contentHeaders[I]))}let x=Gte(l,a,c),T={boundingVolume:p,geometricError:x,refine:a.refine,contents:C},E=!0,S=tt(a.tileHeader,E);delete S.boundingVolume,delete S.transform;let w=At(T,S,E),D=Xte(t,a.baseResource,w,i);return D.implicitCoordinates=c,D.implicitSubtree=n,D.metadata=l,D.hasImplicitContentMetadata=y,D}function zL(t,n){return f(t)&&f(n)&&(f(n.minimumHeight)||f(n.maximumHeight))&&(Li(t,"3DTILES_bounding_volume_S2")||f(t.region))}function a5(t,n){!f(n)||(Li(t,"3DTILES_bounding_volume_S2")?PVe(t.extensions["3DTILES_bounding_volume_S2"],n.minimumHeight,n.maximumHeight):f(t.region)&&vVe(t.region,n.minimumHeight,n.maximumHeight))}function vVe(t,n,i){f(n)&&(t[4]=n),f(i)&&(t[5]=i)}function PVe(t,n,i){f(n)&&(t.minimumHeight=n),f(i)&&(t.maximumHeight=i)}function IVe(t,n,i,o,r,s){let a;return!f(s)||!f(s.boundingVolume)||!zL(s.boundingVolume,s)&&zL(t.boundingVolume,s)?a=Wte(t,n,i,A(o,!1),r):a=s.boundingVolume,a5(a,s),a}function BVe(t,n){let i;return f(n)&&(i=n.boundingVolume),zL(i,n)?a5(i,n):zL(t,n)&&(i=tt(t,!0),a5(i,n)),i}function Wte(t,n,i,o,r){let s=t.boundingVolume;return Li(s,"3DTILES_bounding_volume_S2")?jte(o,r,i,n.level,n.x,n.y,n.z):f(s.region)?{region:Yte(s.region,n.level,n.x,n.y,n.z)}:{box:qte(s.box,n.level,n.x,n.y,n.z)}}function jte(t,n,i,o,r,s,a){let c=n._boundingVolume;if(t)return{extensions:{"3DTILES_bounding_volume_S2":{token:P_.getTokenFromId(c.s2Cell._cellId),minimumHeight:c.minimumHeight,maximumHeight:c.maximumHeight}}};let l=Number(n._boundingVolume.s2Cell._cellId>>BigInt(61)),u=l%2===0?WS.encode2D(o,r,s):WS.encode2D(o,s,r),d=P_.fromFacePositionLevel(l,BigInt(u),o),h,_;if(f(a)){let y=(c.maximumHeight+c.minimumHeight)/2;h=i<4?c.minimumHeight:y,_=i<4?y:c.maximumHeight}else h=c.minimumHeight,_=c.maximumHeight;return{extensions:{"3DTILES_bounding_volume_S2":{token:P_.getTokenFromId(d._cellId),minimumHeight:h,maximumHeight:_}}}}var OVe=new m,RVe=new m,s5=new m,MVe=new $;function qte(t,n,i,o,r){if(n===0)return t;let s=m.unpack(t,0,RVe),a=$.unpack(t,3,MVe),c=Math.pow(2,-n),l=-1+(2*i+1)*c,u=-1+(2*o+1)*c,d=0,h=m.fromElements(c,c,1,OVe);f(r)&&(d=-1+(2*r+1)*c,h.z=c);let _=m.fromElements(l,u,d,s5);_=$.multiplyByVector(a,_,s5),_=m.add(_,s,s5);let y=$.clone(a);y=$.multiplyByScale(y,h,y);let p=new Array(12);return m.pack(_,p),$.pack(y,p,3),p}var LVe=new le;function Yte(t,n,i,o,r){if(n===0)return t.slice();let s=le.unpack(t,0,LVe),a=t[4],c=t[5],l=Math.pow(2,-n),u=l*s.width,d=B.negativePiToPi(s.west+i*u),h=B.negativePiToPi(d+u),_=l*s.height,y=B.negativePiToPi(s.south+o*_),p=B.negativePiToPi(y+_),C=a,x=c;if(f(r)){let T=l*(c-a);C+=r*T,x=C+T}return[d,y,h,p,C,x]}function FVe(t,n,i){let o=t._implicitTileset,r=n.implicitCoordinates.getChildCoordinates(i),s=Wte(o,r,i,!1,n),a=Gte(void 0,o,r),c=o.subtreeUriTemplate.getDerivedResource({templateValues:r.getTemplateValues()}).url,l={boundingVolume:s,geometricError:a,refine:o.refine,contents:[{uri:c}]},u=Xte(t,o.baseResource,l,n);return u.implicitTileset=o,u.implicitCoordinates=r,u}function Xte(t,n,i,o){let r=t._tile.constructor;return new r(t._tileset,n,i,o)}bu.prototype.hasProperty=function(t,n){return!1};bu.prototype.getFeature=function(t){};bu.prototype.applyDebugSettings=function(t,n){};bu.prototype.applyStyle=function(t){};bu.prototype.update=function(t,n){};bu.prototype.isDestroyed=function(){return!1};bu.prototype.destroy=function(){return this._implicitSubtree=this._implicitSubtree&&this._implicitSubtree.destroy(),ue(this)};bu._deriveBoundingBox=qte;bu._deriveBoundingRegion=Yte;bu._deriveBoundingVolumeS2=jte;var YS=bu;function ms(t,n,i){this._tileset=t,this._tile=n,this._resource=i,this._model=void 0,this._readyPromise=void 0,this._metadata=void 0,this._group=void 0}Object.defineProperties(ms.prototype,{featuresLength:{get:function(){let t=this._model,n=t.featureTables,i=t.featureTableId;return f(n)&&f(n[i])?n[i].featuresLength:0}},pointsLength:{get:function(){return this._model.statistics.pointsLength}},trianglesLength:{get:function(){return this._model.statistics.trianglesLength}},geometryByteLength:{get:function(){return this._model.statistics.geometryByteLength}},texturesByteLength:{get:function(){return this._model.statistics.texturesByteLength}},batchTableByteLength:{get:function(){let t=this._model.statistics;return t.propertyTablesByteLength+t.batchTexturesByteLength}},innerContents:{get:function(){}},readyPromise:{get:function(){return this._readyPromise}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._resource.getUrlComponent(!0)}},batchTable:{get:function(){let t=this._model,n=t.featureTables,i=t.featureTableId;if(f(n)&&f(n[i]))return n[i]}},metadata:{get:function(){return this._metadata},set:function(t){this._metadata=t}},group:{get:function(){return this._group},set:function(t){this._group=t}}});ms.prototype.getFeature=function(t){let n=this._model,i=n.featureTableId;return n.featureTables[i].getFeature(t)};ms.prototype.hasProperty=function(t,n){let i=this._model,o=i.featureTableId;return f(o)?i.featureTables[o].hasProperty(t,n):!1};ms.prototype.applyDebugSettings=function(t,n){n=t?n:z.WHITE,this.featuresLength===0?this._model.color=n:f(this.batchTable)&&this.batchTable.setAllColor(n)};ms.prototype.applyStyle=function(t){this._model.style=t};ms.prototype.update=function(t,n){let i=this._model,o=this._tile;i.colorBlendAmount=t.colorBlendAmount,i.colorBlendMode=t.colorBlendMode,i.modelMatrix=o.computedTransform,i.customShader=t.customShader,i.featureIdLabel=t.featureIdLabel,i.instanceFeatureIdLabel=t.instanceFeatureIdLabel,i.lightColor=t.lightColor,i.imageBasedLighting=t.imageBasedLighting,i.backFaceCulling=t.backFaceCulling,i.shadows=t.shadows,i.showCreditsOnScreen=t.showCreditsOnScreen,i.splitDirection=t.splitDirection,i.debugWireframe=t.debugWireframe,i.showOutline=t.showOutline,i.outlineColor=t.outlineColor,i.pointCloudShading=t.pointCloudShading;let r=t.clippingPlanes;i.referenceMatrix=t.clippingPlanesOriginMatrix,f(r)&&o.clippingPlanesDirty&&(i._clippingPlanes=r.enabled&&o._isClipped?r:void 0),f(r)&&f(i._clippingPlanes)&&i._clippingPlanes!==r&&(i._clippingPlanes=r,i._clippingPlanesState=0),i.update(n)};ms.prototype.isDestroyed=function(){return!1};ms.prototype.destroy=function(){return this._model=this._model&&this._model.destroy(),ue(this)};ms.fromGltf=function(t,n,i,o){let r=new ms(t,n,i),a=XS(t,n,r,{gltf:o,basePath:i}),c=t.vectorClassificationOnly?void 0:t.classificationType;a.classificationType=c;let l=Au.fromGltf(a);return r._model=l,r._readyPromise=l.readyPromise.then(function(u){return u.activeAnimations.addAll({loop:ac.REPEAT}),u}),r};ms.fromB3dm=function(t,n,i,o,r){let s=new ms(t,n,i),c=XS(t,n,s,{arrayBuffer:o,byteOffset:r,resource:i}),l=t.vectorClassificationOnly?void 0:t.classificationType;c.classificationType=l;let u=Au.fromB3dm(c);return s._model=u,s._readyPromise=u.readyPromise.then(function(d){return d.activeAnimations.addAll({loop:ac.REPEAT}),d}),s};ms.fromI3dm=function(t,n,i,o,r){let s=new ms(t,n,i),c=XS(t,n,s,{arrayBuffer:o,byteOffset:r,resource:i}),l=Au.fromI3dm(c);return s._model=l,s._readyPromise=l.readyPromise.then(function(u){return u.activeAnimations.addAll({loop:ac.REPEAT}),u}),s};ms.fromPnts=function(t,n,i,o,r){let s=new ms(t,n,i),c=XS(t,n,s,{arrayBuffer:o,byteOffset:r,resource:i}),l=Au.fromPnts(c);return s._model=l,s._readyPromise=l.readyPromise,s};ms.fromGeoJson=function(t,n,i,o){let r=new ms(t,n,i),a=XS(t,n,r,{geoJson:o,resource:i}),c=Au.fromGeoJson(a);return r._model=c,r._readyPromise=c.readyPromise,r};function XS(t,n,i,o){let r={cull:!1,releaseGltfJson:!0,opaquePass:Te.CESIUM_3D_TILE,modelMatrix:n.computedTransform,upAxis:t._modelUpAxis,forwardAxis:t._modelForwardAxis,incrementallyLoadTextures:!1,customShader:t.customShader,content:i,colorBlendMode:t.colorBlendMode,colorBlendAmount:t.colorBlendAmount,lightColor:t.lightColor,imageBasedLighting:t.imageBasedLighting,featureIdLabel:t.featureIdLabel,instanceFeatureIdLabel:t.instanceFeatureIdLabel,pointCloudShading:t.pointCloudShading,clippingPlanes:t.clippingPlanes,backFaceCulling:t.backFaceCulling,shadows:t.shadows,showCreditsOnScreen:t.showCreditsOnScreen,splitDirection:t.splitDirection,enableDebugWireframe:t._enableDebugWireframe,debugWireframe:t.debugWireframe,projectTo2D:t._projectTo2D,enableShowOutline:t._enableShowOutline,showOutline:t.showOutline,outlineColor:t.outlineColor};return At(o,r)}var zm=ms;function Hm(t,n,i,o){this._tileset=t,this._tile=n,this._resource=i,this.featurePropertiesDirty=!1,this._metadata=void 0,this._group=void 0,this._readyPromise=NVe(this,o)}Object.defineProperties(Hm.prototype,{featuresLength:{get:function(){return 0}},pointsLength:{get:function(){return 0}},trianglesLength:{get:function(){return 0}},geometryByteLength:{get:function(){return 0}},texturesByteLength:{get:function(){return 0}},batchTableByteLength:{get:function(){return 0}},innerContents:{get:function(){}},readyPromise:{get:function(){return this._readyPromise}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._resource.getUrlComponent(!0)}},batchTable:{get:function(){}},metadata:{get:function(){return this._metadata},set:function(t){this._metadata=t}},group:{get:function(){return this._group},set:function(t){this._group=t}}});function NVe(t,n){return t._tileset.loadTileset(t._resource,n,t._tile),Promise.resolve(t)}Hm.prototype.hasProperty=function(t,n){return!1};Hm.prototype.getFeature=function(t){};Hm.prototype.applyDebugSettings=function(t,n){};Hm.prototype.applyStyle=function(t){};Hm.prototype.update=function(t,n){};Hm.prototype.isDestroyed=function(){return!1};Hm.prototype.destroy=function(){return ue(this)};var HL=Hm;function ps(t,n,i,o){let r=ps._verifyAttributes(n);i=A(i,0);let s=[],a={},c,l,u=r.length;for(let h=0;h<u;++h){let _=r[h];if(_.vertexBuffer){s.push(_);continue}l=_.usage,c=a[l],f(c)||(c=a[l]=[]),c.push(_)}function d(h,_){return J.getSizeInBytes(_.componentDatatype)-J.getSizeInBytes(h.componentDatatype)}this._allBuffers=[];for(l in a)if(a.hasOwnProperty(l)){c=a[l],c.sort(d);let h=ps._vertexSizeInBytes(c),_=c[0].usage,y={vertexSizeInBytes:h,vertexBuffer:void 0,usage:_,needsCommit:!1,arrayBuffer:void 0,arrayViews:ps._createArrayViews(c,h)};this._allBuffers.push(y)}this._size=0,this._instanced=A(o,!1),this._precreated=s,this._context=t,this.writers=void 0,this.va=void 0,this.resize(i)}ps._verifyAttributes=function(t){let n=[];for(let o=0;o<t.length;++o){let r=t[o],s={index:A(r.index,o),enabled:A(r.enabled,!0),componentsPerAttribute:r.componentsPerAttribute,componentDatatype:A(r.componentDatatype,J.FLOAT),normalize:A(r.normalize,!1),vertexBuffer:r.vertexBuffer,usage:A(r.usage,Fe.STATIC_DRAW)};n.push(s)}let i=new Array(n.length);for(let o=0;o<n.length;++o){let s=n[o].index;i[s]=!0}return n};ps._vertexSizeInBytes=function(t){let n=0,i=t.length;for(let a=0;a<i;++a){let c=t[a];n+=c.componentsPerAttribute*J.getSizeInBytes(c.componentDatatype)}let o=i>0?J.getSizeInBytes(t[0].componentDatatype):0,r=o>0?n%o:0,s=r===0?0:o-r;return n+=s,n};ps._createArrayViews=function(t,n){let i=[],o=0,r=t.length;for(let s=0;s<r;++s){let a=t[s],c=a.componentDatatype;i.push({index:a.index,enabled:a.enabled,componentsPerAttribute:a.componentsPerAttribute,componentDatatype:c,normalize:a.normalize,offsetInBytes:o,vertexSizeInComponentType:n/J.getSizeInBytes(c),view:void 0}),o+=a.componentsPerAttribute*J.getSizeInBytes(c)}return i};ps.prototype.resize=function(t){this._size=t;let n=this._allBuffers;this.writers=[];for(let i=0,o=n.length;i<o;++i){let r=n[i];ps._resize(r,this._size),ps._appendWriters(this.writers,r)}c5(this)};ps._resize=function(t,n){if(t.vertexSizeInBytes>0){let i=new ArrayBuffer(n*t.vertexSizeInBytes);if(f(t.arrayBuffer)){let s=new Uint8Array(i),a=new Uint8Array(t.arrayBuffer),c=a.length;for(let l=0;l<c;++l)s[l]=a[l]}let o=t.arrayViews,r=o.length;for(let s=0;s<r;++s){let a=o[s];a.view=J.createArrayBufferView(a.componentDatatype,i,a.offsetInBytes)}t.arrayBuffer=i}};var VVe=[function(t,n,i){return function(o,r){n[o*i]=r,t.needsCommit=!0}},function(t,n,i){return function(o,r,s){let a=o*i;n[a]=r,n[a+1]=s,t.needsCommit=!0}},function(t,n,i){return function(o,r,s,a){let c=o*i;n[c]=r,n[c+1]=s,n[c+2]=a,t.needsCommit=!0}},function(t,n,i){return function(o,r,s,a,c){let l=o*i;n[l]=r,n[l+1]=s,n[l+2]=a,n[l+3]=c,t.needsCommit=!0}}];ps._appendWriters=function(t,n){let i=n.arrayViews,o=i.length;for(let r=0;r<o;++r){let s=i[r];t[s.index]=VVe[s.componentsPerAttribute-1](n,s.view,s.vertexSizeInComponentType)}};ps.prototype.commit=function(t){let n=!1,i=this._allBuffers,o,r,s;for(r=0,s=i.length;r<s;++r)o=i[r],n=kVe(this,o)||n;if(n||!f(this.va)){c5(this);let a=this.va=[],c=B.SIXTY_FOUR_KILOBYTES-4,l=f(t)&&!this._instanced?Math.ceil(this._size/c):1;for(let u=0;u<l;++u){let d=[];for(r=0,s=i.length;r<s;++r){o=i[r];let h=u*(o.vertexSizeInBytes*c);ps._appendAttributes(d,o,h,this._instanced)}d=d.concat(this._precreated),a.push({va:new $n({context:this._context,attributes:d,indexBuffer:t}),indicesCount:1.5*(u!==l-1?c:this._size%c)})}}};function kVe(t,n){if(n.needsCommit&&n.vertexSizeInBytes>0){n.needsCommit=!1;let i=n.vertexBuffer,o=t._size*n.vertexSizeInBytes,r=f(i);if(!r||i.sizeInBytes<o)return r&&i.destroy(),n.vertexBuffer=ut.createVertexBuffer({context:t._context,typedArray:n.arrayBuffer,usage:n.usage}),n.vertexBuffer.vertexArrayDestroyable=!1,!0;n.vertexBuffer.copyFromArrayView(n.arrayBuffer)}return!1}ps._appendAttributes=function(t,n,i,o){let r=n.arrayViews,s=r.length;for(let a=0;a<s;++a){let c=r[a];t.push({index:c.index,enabled:c.enabled,componentsPerAttribute:c.componentsPerAttribute,componentDatatype:c.componentDatatype,normalize:c.normalize,vertexBuffer:n.vertexBuffer,offsetInBytes:i+c.offsetInBytes,strideInBytes:n.vertexSizeInBytes,instanceDivisor:o?1:0})}};ps.prototype.subCommit=function(t,n){let i=this._allBuffers;for(let o=0,r=i.length;o<r;++o)UVe(i[o],t,n)};function UVe(t,n,i){if(t.needsCommit&&t.vertexSizeInBytes>0){let o=t.vertexSizeInBytes*n,r=t.vertexSizeInBytes*i;t.vertexBuffer.copyFromArrayView(new Uint8Array(t.arrayBuffer,o,r),o)}}ps.prototype.endSubCommits=function(){let t=this._allBuffers;for(let n=0,i=t.length;n<i;++n)t[n].needsCommit=!1};function c5(t){let n=t.va;if(!f(n))return;let i=n.length;for(let o=0;o<i;++o)n[o].va.destroy();t.va=void 0}ps.prototype.isDestroyed=function(){return!1};ps.prototype.destroy=function(){let t=this._allBuffers;for(let n=0,i=t.length;n<i;++n){let o=t[n];o.vertexBuffer=o.vertexBuffer&&o.vertexBuffer.destroy()}return c5(this),ue(this)};var I_=ps;var GL=`#ifdef GL_OES_standard_derivatives
#extension GL_OES_standard_derivatives : enable
#endif
uniform sampler2D u_atlas;
#ifdef VECTOR_TILE
uniform vec4 u_highlightColor;
#endif
varying vec2 v_textureCoordinates;
varying vec4 v_pickColor;
varying vec4 v_color;
#ifdef SDF
varying vec4 v_outlineColor;
varying float v_outlineWidth;
#endif
#ifdef FRAGMENT_DEPTH_CHECK
varying vec4 v_textureCoordinateBounds;
varying vec4 v_originTextureCoordinateAndTranslate;
varying vec4 v_compressed;
varying mat2 v_rotationMatrix;
const float SHIFT_LEFT12 = 4096.0;
const float SHIFT_LEFT1 = 2.0;
const float SHIFT_RIGHT12 = 1.0 / 4096.0;
const float SHIFT_RIGHT1 = 1.0 / 2.0;
float getGlobeDepth(vec2 adjustedST, vec2 depthLookupST, bool applyTranslate, vec2 dimensions, vec2 imageSize)
{
vec2 lookupVector = imageSize * (depthLookupST - adjustedST);
lookupVector = v_rotationMatrix * lookupVector;
vec2 labelOffset = (dimensions - imageSize) * (depthLookupST - vec2(0.0, v_originTextureCoordinateAndTranslate.y));
vec2 translation = v_originTextureCoordinateAndTranslate.zw;
if (applyTranslate)
{
translation += (dimensions * v_originTextureCoordinateAndTranslate.xy * vec2(1.0, 0.0));
}
vec2 st = ((lookupVector - translation + labelOffset) + gl_FragCoord.xy) / czm_viewport.zw;
float logDepthOrDepth = czm_unpackDepth(texture2D(czm_globeDepthTexture, st));
if (logDepthOrDepth == 0.0)
{
return 0.0;
}
vec4 eyeCoordinate = czm_windowToEyeCoordinates(gl_FragCoord.xy, logDepthOrDepth);
return eyeCoordinate.z / eyeCoordinate.w;
}
#endif
#ifdef SDF
float getDistance(vec2 position)
{
return texture2D(u_atlas, position).r;
}
vec4 getSDFColor(vec2 position, float outlineWidth, vec4 outlineColor, float smoothing)
{
float distance = getDistance(position);
if (outlineWidth > 0.0)
{
float outlineEdge = clamp(SDF_EDGE - outlineWidth, 0.0, SDF_EDGE);
float outlineFactor = smoothstep(SDF_EDGE - smoothing, SDF_EDGE + smoothing, distance);
vec4 sdfColor = mix(outlineColor, v_color, outlineFactor);
float alpha = smoothstep(outlineEdge - smoothing, outlineEdge + smoothing, distance);
return vec4(sdfColor.rgb, sdfColor.a * alpha);
}
else
{
float alpha = smoothstep(SDF_EDGE - smoothing, SDF_EDGE + smoothing, distance);
return vec4(v_color.rgb, v_color.a * alpha);
}
}
#endif
void main()
{
vec4 color = texture2D(u_atlas, v_textureCoordinates);
#ifdef SDF
float outlineWidth = v_outlineWidth;
vec4 outlineColor = v_outlineColor;
float distance = getDistance(v_textureCoordinates);
#ifdef GL_OES_standard_derivatives
float smoothing = fwidth(distance);
vec2 sampleOffset = 0.354 * vec2(dFdx(v_textureCoordinates) + dFdy(v_textureCoordinates));
vec4 center = getSDFColor(v_textureCoordinates, outlineWidth, outlineColor, smoothing);
vec4 color1 = getSDFColor(v_textureCoordinates + vec2(sampleOffset.x, sampleOffset.y), outlineWidth, outlineColor, smoothing);
vec4 color2 = getSDFColor(v_textureCoordinates + vec2(-sampleOffset.x, sampleOffset.y), outlineWidth, outlineColor, smoothing);
vec4 color3 = getSDFColor(v_textureCoordinates + vec2(-sampleOffset.x, -sampleOffset.y), outlineWidth, outlineColor, smoothing);
vec4 color4 = getSDFColor(v_textureCoordinates + vec2(sampleOffset.x, -sampleOffset.y), outlineWidth, outlineColor, smoothing);
color = (center + color1 + color2 + color3 + color4)/5.0;
#else
float smoothing = 1.0/32.0;
color = getSDFColor(v_textureCoordinates, outlineWidth, outlineColor, smoothing);
#endif
color = czm_gammaCorrect(color);
#else
color = czm_gammaCorrect(color);
color *= czm_gammaCorrect(v_color);
#endif
#if !defined(OPAQUE) && !defined(TRANSLUCENT)
if (color.a < 0.005)
{
discard;
}
#else
#ifdef OPAQUE
if (color.a < 0.995)
{
discard;
}
#else
if (color.a >= 0.995)
{
discard;
}
#endif
#endif
#ifdef VECTOR_TILE
color *= u_highlightColor;
#endif
gl_FragColor = color;
#ifdef LOG_DEPTH
czm_writeLogDepth();
#endif
#ifdef FRAGMENT_DEPTH_CHECK
float temp = v_compressed.y;
temp = temp * SHIFT_RIGHT1;
float temp2 = (temp - floor(temp)) * SHIFT_LEFT1;
bool enableDepthTest = temp2 != 0.0;
bool applyTranslate = floor(temp) != 0.0;
if (enableDepthTest) {
temp = v_compressed.z;
temp = temp * SHIFT_RIGHT12;
vec2 dimensions;
dimensions.y = (temp - floor(temp)) * SHIFT_LEFT12;
dimensions.x = floor(temp);
temp = v_compressed.w;
temp = temp * SHIFT_RIGHT12;
vec2 imageSize;
imageSize.y = (temp - floor(temp)) * SHIFT_LEFT12;
imageSize.x = floor(temp);
vec2 adjustedST = v_textureCoordinates - v_textureCoordinateBounds.xy;
adjustedST = adjustedST / vec2(v_textureCoordinateBounds.z - v_textureCoordinateBounds.x, v_textureCoordinateBounds.w - v_textureCoordinateBounds.y);
float epsilonEyeDepth = v_compressed.x + czm_epsilon1;
float globeDepth1 = getGlobeDepth(adjustedST, v_originTextureCoordinateAndTranslate.xy, applyTranslate, dimensions, imageSize);
if (globeDepth1 != 0.0 && globeDepth1 > epsilonEyeDepth)
{
float globeDepth2 = getGlobeDepth(adjustedST, vec2(0.0, 1.0), applyTranslate, dimensions, imageSize);
if (globeDepth2 != 0.0 && globeDepth2 > epsilonEyeDepth)
{
float globeDepth3 = getGlobeDepth(adjustedST, vec2(1.0, 1.0), applyTranslate, dimensions, imageSize);
if (globeDepth3 != 0.0 && globeDepth3 > epsilonEyeDepth)
{
discard;
}
}
}
}
#endif
}
`;var WL=`#ifdef INSTANCED
attribute vec2 direction;
#endif
attribute vec4 positionHighAndScale;
attribute vec4 positionLowAndRotation;
attribute vec4 compressedAttribute0;
attribute vec4 compressedAttribute1;
attribute vec4 compressedAttribute2;
attribute vec4 eyeOffset;
attribute vec4 scaleByDistance;
attribute vec4 pixelOffsetScaleByDistance;
attribute vec4 compressedAttribute3;
attribute vec2 sdf;
#if defined(VERTEX_DEPTH_CHECK) || defined(FRAGMENT_DEPTH_CHECK)
attribute vec4 textureCoordinateBoundsOrLabelTranslate;
#endif
#ifdef VECTOR_TILE
attribute float a_batchId;
#endif
varying vec2 v_textureCoordinates;
#ifdef FRAGMENT_DEPTH_CHECK
varying vec4 v_textureCoordinateBounds;
varying vec4 v_originTextureCoordinateAndTranslate;
varying vec4 v_compressed;
varying mat2 v_rotationMatrix;
#endif
varying vec4 v_pickColor;
varying vec4 v_color;
#ifdef SDF
varying vec4 v_outlineColor;
varying float v_outlineWidth;
#endif
const float UPPER_BOUND = 32768.0;
const float SHIFT_LEFT16 = 65536.0;
const float SHIFT_LEFT12 = 4096.0;
const float SHIFT_LEFT8 = 256.0;
const float SHIFT_LEFT7 = 128.0;
const float SHIFT_LEFT5 = 32.0;
const float SHIFT_LEFT3 = 8.0;
const float SHIFT_LEFT2 = 4.0;
const float SHIFT_LEFT1 = 2.0;
const float SHIFT_RIGHT12 = 1.0 / 4096.0;
const float SHIFT_RIGHT8 = 1.0 / 256.0;
const float SHIFT_RIGHT7 = 1.0 / 128.0;
const float SHIFT_RIGHT5 = 1.0 / 32.0;
const float SHIFT_RIGHT3 = 1.0 / 8.0;
const float SHIFT_RIGHT2 = 1.0 / 4.0;
const float SHIFT_RIGHT1 = 1.0 / 2.0;
vec4 addScreenSpaceOffset(vec4 positionEC, vec2 imageSize, float scale, vec2 direction, vec2 origin, vec2 translate, vec2 pixelOffset, vec3 alignedAxis, bool validAlignedAxis, float rotation, bool sizeInMeters, out mat2 rotationMatrix, out float mpp)
{
vec2 halfSize = imageSize * scale * 0.5;
halfSize *= ((direction * 2.0) - 1.0);
vec2 originTranslate = origin * abs(halfSize);
#if defined(ROTATION) || defined(ALIGNED_AXIS)
if (validAlignedAxis || rotation != 0.0)
{
float angle = rotation;
if (validAlignedAxis)
{
vec4 projectedAlignedAxis = czm_modelViewProjection * vec4(alignedAxis, 0.0);
angle += sign(-projectedAlignedAxis.x) * acos(sign(projectedAlignedAxis.y) * (projectedAlignedAxis.y * projectedAlignedAxis.y) /
(projectedAlignedAxis.x * projectedAlignedAxis.x + projectedAlignedAxis.y * projectedAlignedAxis.y));
}
float cosTheta = cos(angle);
float sinTheta = sin(angle);
rotationMatrix = mat2(cosTheta, sinTheta, -sinTheta, cosTheta);
halfSize = rotationMatrix * halfSize;
}
else
{
rotationMatrix = mat2(1.0, 0.0, 0.0, 1.0);
}
#endif
mpp = czm_metersPerPixel(positionEC);
positionEC.xy += (originTranslate + halfSize) * czm_branchFreeTernary(sizeInMeters, 1.0, mpp);
positionEC.xy += (translate + pixelOffset) * mpp;
return positionEC;
}
#ifdef VERTEX_DEPTH_CHECK
float getGlobeDepth(vec4 positionEC)
{
vec4 posWC = czm_eyeToWindowCoordinates(positionEC);
float globeDepth = czm_unpackDepth(texture2D(czm_globeDepthTexture, posWC.xy / czm_viewport.zw));
if (globeDepth == 0.0)
{
return 0.0;
}
vec4 eyeCoordinate = czm_windowToEyeCoordinates(posWC.xy, globeDepth);
return eyeCoordinate.z / eyeCoordinate.w;
}
#endif
void main()
{
vec3 positionHigh = positionHighAndScale.xyz;
vec3 positionLow = positionLowAndRotation.xyz;
float scale = positionHighAndScale.w;
#if defined(ROTATION) || defined(ALIGNED_AXIS)
float rotation = positionLowAndRotation.w;
#else
float rotation = 0.0;
#endif
float compressed = compressedAttribute0.x;
vec2 pixelOffset;
pixelOffset.x = floor(compressed * SHIFT_RIGHT7);
compressed -= pixelOffset.x * SHIFT_LEFT7;
pixelOffset.x -= UPPER_BOUND;
vec2 origin;
origin.x = floor(compressed * SHIFT_RIGHT5);
compressed -= origin.x * SHIFT_LEFT5;
origin.y = floor(compressed * SHIFT_RIGHT3);
compressed -= origin.y * SHIFT_LEFT3;
#ifdef FRAGMENT_DEPTH_CHECK
vec2 depthOrigin = origin.xy;
#endif
origin -= vec2(1.0);
float show = floor(compressed * SHIFT_RIGHT2);
compressed -= show * SHIFT_LEFT2;
#ifdef INSTANCED
vec2 textureCoordinatesBottomLeft = czm_decompressTextureCoordinates(compressedAttribute0.w);
vec2 textureCoordinatesRange = czm_decompressTextureCoordinates(eyeOffset.w);
vec2 textureCoordinates = textureCoordinatesBottomLeft + direction * textureCoordinatesRange;
#else
vec2 direction;
direction.x = floor(compressed * SHIFT_RIGHT1);
direction.y = compressed - direction.x * SHIFT_LEFT1;
vec2 textureCoordinates = czm_decompressTextureCoordinates(compressedAttribute0.w);
#endif
float temp = compressedAttribute0.y  * SHIFT_RIGHT8;
pixelOffset.y = -(floor(temp) - UPPER_BOUND);
vec2 translate;
translate.y = (temp - floor(temp)) * SHIFT_LEFT16;
temp = compressedAttribute0.z * SHIFT_RIGHT8;
translate.x = floor(temp) - UPPER_BOUND;
translate.y += (temp - floor(temp)) * SHIFT_LEFT8;
translate.y -= UPPER_BOUND;
temp = compressedAttribute1.x * SHIFT_RIGHT8;
float temp2 = floor(compressedAttribute2.w * SHIFT_RIGHT2);
vec2 imageSize = vec2(floor(temp), temp2);
#ifdef FRAGMENT_DEPTH_CHECK
float labelHorizontalOrigin = floor(compressedAttribute2.w - (temp2 * SHIFT_LEFT2));
float applyTranslate = 0.0;
if (labelHorizontalOrigin != 0.0)
{
applyTranslate = 1.0;
labelHorizontalOrigin -= 2.0;
depthOrigin.x = labelHorizontalOrigin + 1.0;
}
depthOrigin = vec2(1.0) - (depthOrigin * 0.5);
#endif
#ifdef EYE_DISTANCE_TRANSLUCENCY
vec4 translucencyByDistance;
translucencyByDistance.x = compressedAttribute1.z;
translucencyByDistance.z = compressedAttribute1.w;
translucencyByDistance.y = ((temp - floor(temp)) * SHIFT_LEFT8) / 255.0;
temp = compressedAttribute1.y * SHIFT_RIGHT8;
translucencyByDistance.w = ((temp - floor(temp)) * SHIFT_LEFT8) / 255.0;
#endif
#if defined(VERTEX_DEPTH_CHECK) || defined(FRAGMENT_DEPTH_CHECK)
temp = compressedAttribute3.w;
temp = temp * SHIFT_RIGHT12;
vec2 dimensions;
dimensions.y = (temp - floor(temp)) * SHIFT_LEFT12;
dimensions.x = floor(temp);
#endif
#ifdef ALIGNED_AXIS
vec3 alignedAxis = czm_octDecode(floor(compressedAttribute1.y * SHIFT_RIGHT8));
temp = compressedAttribute2.z * SHIFT_RIGHT5;
bool validAlignedAxis = (temp - floor(temp)) * SHIFT_LEFT1 > 0.0;
#else
vec3 alignedAxis = vec3(0.0);
bool validAlignedAxis = false;
#endif
vec4 pickColor;
vec4 color;
temp = compressedAttribute2.y;
temp = temp * SHIFT_RIGHT8;
pickColor.b = (temp - floor(temp)) * SHIFT_LEFT8;
temp = floor(temp) * SHIFT_RIGHT8;
pickColor.g = (temp - floor(temp)) * SHIFT_LEFT8;
pickColor.r = floor(temp);
temp = compressedAttribute2.x;
temp = temp * SHIFT_RIGHT8;
color.b = (temp - floor(temp)) * SHIFT_LEFT8;
temp = floor(temp) * SHIFT_RIGHT8;
color.g = (temp - floor(temp)) * SHIFT_LEFT8;
color.r = floor(temp);
temp = compressedAttribute2.z * SHIFT_RIGHT8;
bool sizeInMeters = floor((temp - floor(temp)) * SHIFT_LEFT7) > 0.0;
temp = floor(temp) * SHIFT_RIGHT8;
pickColor.a = (temp - floor(temp)) * SHIFT_LEFT8;
pickColor /= 255.0;
color.a = floor(temp);
color /= 255.0;
vec4 p = czm_translateRelativeToEye(positionHigh, positionLow);
vec4 positionEC = czm_modelViewRelativeToEye * p;
#if defined(FRAGMENT_DEPTH_CHECK) || defined(VERTEX_DEPTH_CHECK)
float eyeDepth = positionEC.z;
#endif
positionEC = czm_eyeOffset(positionEC, eyeOffset.xyz);
positionEC.xyz *= show;
#if defined(EYE_DISTANCE_SCALING) || defined(EYE_DISTANCE_TRANSLUCENCY) || defined(EYE_DISTANCE_PIXEL_OFFSET) || defined(DISTANCE_DISPLAY_CONDITION) || defined(DISABLE_DEPTH_DISTANCE)
float lengthSq;
if (czm_sceneMode == czm_sceneMode2D)
{
lengthSq = czm_eyeHeight2D.y;
}
else
{
lengthSq = dot(positionEC.xyz, positionEC.xyz);
}
#endif
#ifdef EYE_DISTANCE_SCALING
float distanceScale = czm_nearFarScalar(scaleByDistance, lengthSq);
scale *= distanceScale;
translate *= distanceScale;
if (scale == 0.0)
{
positionEC.xyz = vec3(0.0);
}
#endif
float translucency = 1.0;
#ifdef EYE_DISTANCE_TRANSLUCENCY
translucency = czm_nearFarScalar(translucencyByDistance, lengthSq);
if (translucency == 0.0)
{
positionEC.xyz = vec3(0.0);
}
#endif
#ifdef EYE_DISTANCE_PIXEL_OFFSET
float pixelOffsetScale = czm_nearFarScalar(pixelOffsetScaleByDistance, lengthSq);
pixelOffset *= pixelOffsetScale;
#endif
#ifdef DISTANCE_DISPLAY_CONDITION
float nearSq = compressedAttribute3.x;
float farSq = compressedAttribute3.y;
if (lengthSq < nearSq || lengthSq > farSq)
{
positionEC.xyz = vec3(0.0);
}
#endif
mat2 rotationMatrix;
float mpp;
#ifdef DISABLE_DEPTH_DISTANCE
float disableDepthTestDistance = compressedAttribute3.z;
#endif
#ifdef VERTEX_DEPTH_CHECK
if (lengthSq < disableDepthTestDistance) {
float depthsilon = 10.0;
vec2 labelTranslate = textureCoordinateBoundsOrLabelTranslate.xy;
vec4 pEC1 = addScreenSpaceOffset(positionEC, dimensions, scale, vec2(0.0), origin, labelTranslate, pixelOffset, alignedAxis, validAlignedAxis, rotation, sizeInMeters, rotationMatrix, mpp);
float globeDepth1 = getGlobeDepth(pEC1);
if (globeDepth1 != 0.0 && pEC1.z + depthsilon < globeDepth1)
{
vec4 pEC2 = addScreenSpaceOffset(positionEC, dimensions, scale, vec2(0.0, 1.0), origin, labelTranslate, pixelOffset, alignedAxis, validAlignedAxis, rotation, sizeInMeters, rotationMatrix, mpp);
float globeDepth2 = getGlobeDepth(pEC2);
if (globeDepth2 != 0.0 && pEC2.z + depthsilon < globeDepth2)
{
vec4 pEC3 = addScreenSpaceOffset(positionEC, dimensions, scale, vec2(1.0), origin, labelTranslate, pixelOffset, alignedAxis, validAlignedAxis, rotation, sizeInMeters, rotationMatrix, mpp);
float globeDepth3 = getGlobeDepth(pEC3);
if (globeDepth3 != 0.0 && pEC3.z + depthsilon < globeDepth3)
{
positionEC.xyz = vec3(0.0);
}
}
}
}
#endif
positionEC = addScreenSpaceOffset(positionEC, imageSize, scale, direction, origin, translate, pixelOffset, alignedAxis, validAlignedAxis, rotation, sizeInMeters, rotationMatrix, mpp);
gl_Position = czm_projection * positionEC;
v_textureCoordinates = textureCoordinates;
#ifdef LOG_DEPTH
czm_vertexLogDepth();
#endif
#ifdef DISABLE_DEPTH_DISTANCE
if (disableDepthTestDistance == 0.0 && czm_minimumDisableDepthTestDistance != 0.0)
{
disableDepthTestDistance = czm_minimumDisableDepthTestDistance;
}
if (disableDepthTestDistance != 0.0)
{
float zclip = gl_Position.z / gl_Position.w;
bool clipped = (zclip < -1.0 || zclip > 1.0);
if (!clipped && (disableDepthTestDistance < 0.0 || (lengthSq > 0.0 && lengthSq < disableDepthTestDistance)))
{
gl_Position.z = -gl_Position.w;
#ifdef LOG_DEPTH
v_depthFromNearPlusOne = 1.0;
#endif
}
}
#endif
#ifdef FRAGMENT_DEPTH_CHECK
if (sizeInMeters) {
translate /= mpp;
dimensions /= mpp;
imageSize /= mpp;
}
#if defined(ROTATION) || defined(ALIGNED_AXIS)
v_rotationMatrix = rotationMatrix;
#else
v_rotationMatrix = mat2(1.0, 0.0, 0.0, 1.0);
#endif
float enableDepthCheck = 0.0;
if (lengthSq < disableDepthTestDistance)
{
enableDepthCheck = 1.0;
}
float dw = floor(clamp(dimensions.x, 0.0, SHIFT_LEFT12));
float dh = floor(clamp(dimensions.y, 0.0, SHIFT_LEFT12));
float iw = floor(clamp(imageSize.x, 0.0, SHIFT_LEFT12));
float ih = floor(clamp(imageSize.y, 0.0, SHIFT_LEFT12));
v_compressed.x = eyeDepth;
v_compressed.y = applyTranslate * SHIFT_LEFT1 + enableDepthCheck;
v_compressed.z = dw * SHIFT_LEFT12 + dh;
v_compressed.w = iw * SHIFT_LEFT12 + ih;
v_originTextureCoordinateAndTranslate.xy = depthOrigin;
v_originTextureCoordinateAndTranslate.zw = translate;
v_textureCoordinateBounds = textureCoordinateBoundsOrLabelTranslate;
#endif
#ifdef SDF
vec4 outlineColor;
float outlineWidth;
temp = sdf.x;
temp = temp * SHIFT_RIGHT8;
outlineColor.b = (temp - floor(temp)) * SHIFT_LEFT8;
temp = floor(temp) * SHIFT_RIGHT8;
outlineColor.g = (temp - floor(temp)) * SHIFT_LEFT8;
outlineColor.r = floor(temp);
temp = sdf.y;
temp = temp * SHIFT_RIGHT8;
float temp3 = (temp - floor(temp)) * SHIFT_LEFT8;
temp = floor(temp) * SHIFT_RIGHT8;
outlineWidth = (temp - floor(temp)) * SHIFT_LEFT8;
outlineColor.a = floor(temp);
outlineColor /= 255.0;
v_outlineWidth = outlineWidth / 255.0;
v_outlineColor = outlineColor;
v_outlineColor.a *= translucency;
#endif
v_pickColor = pickColor;
v_color = color;
v_color.a *= translucency;
}
`;function mi(t,n){t=A(t,A.EMPTY_OBJECT);let i=t.translucencyByDistance,o=t.pixelOffsetScaleByDistance,r=t.scaleByDistance,s=t.distanceDisplayCondition;f(i)&&(i=Pt.clone(i)),f(o)&&(o=Pt.clone(o)),f(r)&&(r=Pt.clone(r)),f(s)&&(s=wt.clone(s)),this._show=A(t.show,!0),this._position=m.clone(A(t.position,m.ZERO)),this._actualPosition=m.clone(this._position),this._pixelOffset=W.clone(A(t.pixelOffset,W.ZERO)),this._translate=new W(0,0),this._eyeOffset=m.clone(A(t.eyeOffset,m.ZERO)),this._heightReference=A(t.heightReference,Ge.NONE),this._verticalOrigin=A(t.verticalOrigin,vn.CENTER),this._horizontalOrigin=A(t.horizontalOrigin,ui.CENTER),this._scale=A(t.scale,1),this._color=z.clone(A(t.color,z.WHITE)),this._rotation=A(t.rotation,0),this._alignedAxis=m.clone(A(t.alignedAxis,m.ZERO)),this._width=t.width,this._height=t.height,this._scaleByDistance=r,this._translucencyByDistance=i,this._pixelOffsetScaleByDistance=o,this._sizeInMeters=A(t.sizeInMeters,!1),this._distanceDisplayCondition=s,this._disableDepthTestDistance=t.disableDepthTestDistance,this._id=t.id,this._collection=A(t.collection,n),this._pickId=void 0,this._pickPrimitive=A(t._pickPrimitive,this),this._billboardCollection=n,this._dirty=!1,this._index=-1,this._batchIndex=void 0,this._imageIndex=-1,this._imageIndexPromise=void 0,this._imageId=void 0,this._image=void 0,this._imageSubRegion=void 0,this._imageWidth=void 0,this._imageHeight=void 0,this._labelDimensions=void 0,this._labelHorizontalOrigin=void 0,this._labelTranslate=void 0;let a=t.image,c=t.imageId;f(a)&&(f(c)||(typeof a=="string"?c=a:f(a.src)?c=a.src:c=Bn()),this._imageId=c,this._image=a),f(t.imageSubRegion)&&(this._imageId=c,this._imageSubRegion=t.imageSubRegion),f(this._billboardCollection._textureAtlas)&&this._loadImage(),this._actualClampedPosition=void 0,this._removeCallbackFunc=void 0,this._mode=ne.SCENE3D,this._clusterShow=!0,this._outlineColor=z.clone(A(t.outlineColor,z.BLACK)),this._outlineWidth=A(t.outlineWidth,0),this._updateClamping()}var Kte=mi.SHOW_INDEX=0,qL=mi.POSITION_INDEX=1,ene=mi.PIXEL_OFFSET_INDEX=2,zVe=mi.EYE_OFFSET_INDEX=3,HVe=mi.HORIZONTAL_ORIGIN_INDEX=4,GVe=mi.VERTICAL_ORIGIN_INDEX=5,WVe=mi.SCALE_INDEX=6,YL=mi.IMAGE_INDEX_INDEX=7,Jte=mi.COLOR_INDEX=8,jVe=mi.ROTATION_INDEX=9,qVe=mi.ALIGNED_AXIS_INDEX=10,YVe=mi.SCALE_BY_DISTANCE_INDEX=11,XVe=mi.TRANSLUCENCY_BY_DISTANCE_INDEX=12,KVe=mi.PIXEL_OFFSET_SCALE_BY_DISTANCE_INDEX=13,JVe=mi.DISTANCE_DISPLAY_CONDITION=14,ZVe=mi.DISABLE_DEPTH_DISTANCE=15;mi.TEXTURE_COORDINATE_BOUNDS=16;var Zte=mi.SDF_INDEX=17;mi.NUMBER_OF_PROPERTIES=18;function Io(t,n){let i=t._billboardCollection;f(i)&&(i._updateBillboard(t,n),t._dirty=!0)}Object.defineProperties(mi.prototype,{show:{get:function(){return this._show},set:function(t){this._show!==t&&(this._show=t,Io(this,Kte))}},position:{get:function(){return this._position},set:function(t){let n=this._position;m.equals(n,t)||(m.clone(t,n),m.clone(t,this._actualPosition),this._updateClamping(),Io(this,qL))}},heightReference:{get:function(){return this._heightReference},set:function(t){let n=this._heightReference;t!==n&&(this._heightReference=t,this._updateClamping(),Io(this,qL))}},pixelOffset:{get:function(){return this._pixelOffset},set:function(t){let n=this._pixelOffset;W.equals(n,t)||(W.clone(t,n),Io(this,ene))}},scaleByDistance:{get:function(){return this._scaleByDistance},set:function(t){let n=this._scaleByDistance;Pt.equals(n,t)||(this._scaleByDistance=Pt.clone(t,n),Io(this,YVe))}},translucencyByDistance:{get:function(){return this._translucencyByDistance},set:function(t){let n=this._translucencyByDistance;Pt.equals(n,t)||(this._translucencyByDistance=Pt.clone(t,n),Io(this,XVe))}},pixelOffsetScaleByDistance:{get:function(){return this._pixelOffsetScaleByDistance},set:function(t){let n=this._pixelOffsetScaleByDistance;Pt.equals(n,t)||(this._pixelOffsetScaleByDistance=Pt.clone(t,n),Io(this,KVe))}},eyeOffset:{get:function(){return this._eyeOffset},set:function(t){let n=this._eyeOffset;m.equals(n,t)||(m.clone(t,n),Io(this,zVe))}},horizontalOrigin:{get:function(){return this._horizontalOrigin},set:function(t){this._horizontalOrigin!==t&&(this._horizontalOrigin=t,Io(this,HVe))}},verticalOrigin:{get:function(){return this._verticalOrigin},set:function(t){this._verticalOrigin!==t&&(this._verticalOrigin=t,Io(this,GVe))}},scale:{get:function(){return this._scale},set:function(t){this._scale!==t&&(this._scale=t,Io(this,WVe))}},color:{get:function(){return this._color},set:function(t){let n=this._color;z.equals(n,t)||(z.clone(t,n),Io(this,Jte))}},rotation:{get:function(){return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,Io(this,jVe))}},alignedAxis:{get:function(){return this._alignedAxis},set:function(t){let n=this._alignedAxis;m.equals(n,t)||(m.clone(t,n),Io(this,qVe))}},width:{get:function(){return A(this._width,this._imageWidth)},set:function(t){this._width!==t&&(this._width=t,Io(this,YL))}},height:{get:function(){return A(this._height,this._imageHeight)},set:function(t){this._height!==t&&(this._height=t,Io(this,YL))}},sizeInMeters:{get:function(){return this._sizeInMeters},set:function(t){this._sizeInMeters!==t&&(this._sizeInMeters=t,Io(this,Jte))}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(t){wt.equals(t,this._distanceDisplayCondition)||(this._distanceDisplayCondition=wt.clone(t,this._distanceDisplayCondition),Io(this,JVe))}},disableDepthTestDistance:{get:function(){return this._disableDepthTestDistance},set:function(t){this._disableDepthTestDistance!==t&&(this._disableDepthTestDistance=t,Io(this,ZVe))}},id:{get:function(){return this._id},set:function(t){this._id=t,f(this._pickId)&&(this._pickId.object.id=t)}},pickPrimitive:{get:function(){return this._pickPrimitive},set:function(t){this._pickPrimitive=t,f(this._pickId)&&(this._pickId.object.primitive=t)}},pickId:{get:function(){return this._pickId}},image:{get:function(){return this._imageId},set:function(t){f(t)?typeof t=="string"?this.setImage(t,t):t instanceof Ie?this.setImage(t.url,t):f(t.src)?this.setImage(t.src,t):this.setImage(Bn(),t):(this._imageIndex=-1,this._imageSubRegion=void 0,this._imageId=void 0,this._image=void 0,this._imageIndexPromise=void 0,Io(this,YL))}},ready:{get:function(){return this._imageIndex!==-1}},_clampedPosition:{get:function(){return this._actualClampedPosition},set:function(t){this._actualClampedPosition=m.clone(t,this._actualClampedPosition),Io(this,qL)}},clusterShow:{get:function(){return this._clusterShow},set:function(t){this._clusterShow!==t&&(this._clusterShow=t,Io(this,Kte))}},outlineColor:{get:function(){return this._outlineColor},set:function(t){let n=this._outlineColor;z.equals(n,t)||(z.clone(t,n),Io(this,Zte))}},outlineWidth:{get:function(){return this._outlineWidth},set:function(t){this._outlineWidth!==t&&(this._outlineWidth=t,Io(this,Zte))}}});mi.prototype.getPickId=function(t){return f(this._pickId)||(this._pickId=t.createPickId({primitive:this._pickPrimitive,collection:this._collection,id:this._id})),this._pickId};mi.prototype._updateClamping=function(){mi._updateClamping(this._billboardCollection,this)};var KS=new de,Qte=new m;mi._updateClamping=function(t,n){let i=t._scene;if(!f(i)||!f(i.globe))return;let o=i.globe,r=o.ellipsoid,s=o._surface,a=i.frameState.mode,c=a!==n._mode;if(n._mode=a,(n._heightReference===Ge.NONE||c)&&f(n._removeCallbackFunc)&&(n._removeCallbackFunc(),n._removeCallbackFunc=void 0,n._clampedPosition=void 0),n._heightReference===Ge.NONE||!f(n._position))return;let l=r.cartesianToCartographic(n._position);if(!f(l)){n._actualClampedPosition=void 0;return}f(n._removeCallbackFunc)&&n._removeCallbackFunc();function u(h){if(n._heightReference===Ge.RELATIVE_TO_GROUND)if(n._mode===ne.SCENE3D){let _=r.cartesianToCartographic(h,KS);_.height+=l.height,r.cartographicToCartesian(_,h)}else h.x+=l.height;n._clampedPosition=m.clone(h,n._clampedPosition)}n._removeCallbackFunc=s.updateHeight(l,u),de.clone(l,KS);let d=o.getHeight(l);f(d)&&(KS.height=d),r.cartographicToCartesian(KS,Qte),u(Qte)};mi.prototype._loadImage=function(){let t=this._billboardCollection._textureAtlas,n=this._imageId,i=this._image,o=this._imageSubRegion,r,s=this;function a(c){if(s._imageId!==n||s._image!==i||!He.equals(s._imageSubRegion,o))return;let l=t.textureCoordinates[c];s._imageWidth=t.texture.width*l.width,s._imageHeight=t.texture.height*l.height,s._imageIndex=c,s._ready=!0,s._image=void 0,s._imageIndexPromise=void 0,Io(s,YL)}if(f(i)){let c=t.getImageIndex(n);if(f(c)){a(c);return}r=t.addImage(n,i)}f(o)&&(r=t.addSubRegion(n,o)),this._imageIndexPromise=r,f(r)&&r.then(a).catch(function(c){console.error(`Error loading image for billboard: ${c}`),s._imageIndexPromise=void 0})};mi.prototype.setImage=function(t,n){this._imageId!==t&&(this._imageIndex=-1,this._imageSubRegion=void 0,this._imageId=t,this._image=n,f(this._billboardCollection._textureAtlas)&&this._loadImage())};mi.prototype.setImageSubRegion=function(t,n){this._imageId===t&&He.equals(this._imageSubRegion,n)||(this._imageIndex=-1,this._imageId=t,this._imageSubRegion=He.clone(n),f(this._billboardCollection._textureAtlas)&&this._loadImage())};mi.prototype._setTranslate=function(t){let n=this._translate;W.equals(n,t)||(W.clone(t,n),Io(this,ene))};mi.prototype._getActualPosition=function(){return f(this._clampedPosition)?this._clampedPosition:this._actualPosition};mi.prototype._setActualPosition=function(t){f(this._clampedPosition)||m.clone(t,this._actualPosition),Io(this,qL)};var $te=new se;mi._computeActualPosition=function(t,n,i,o){return f(t._clampedPosition)?(i.mode!==t._mode&&t._updateClamping(),t._clampedPosition):i.mode===ne.SCENE3D?n:(N.multiplyByPoint(o,n,$te),Yi.computeActualWgs84Position(i,$te))};var tne=new m;mi._computeScreenSpacePosition=function(t,n,i,o,r,s){let a=N.multiplyByPoint(t,n,tne),c=Yi.wgs84WithEyeOffsetToWindowCoordinates(r,a,i,s);if(!!f(c))return W.add(c,o,c),c};var jL=new W(0,0);mi.prototype.computeScreenSpacePosition=function(t,n){let i=this._billboardCollection;f(n)||(n=new W),W.clone(this._pixelOffset,jL),W.add(jL,this._translate,jL);let o=i.modelMatrix,r=this._position;if(f(this._clampedPosition)&&(r=this._clampedPosition,t.mode!==ne.SCENE3D)){let a=t.mapProjection,c=a.ellipsoid,l=a.unproject(r,KS);r=c.cartographicToCartesian(l,tne),o=N.IDENTITY}return mi._computeScreenSpacePosition(o,r,this._eyeOffset,jL,t,n)};mi.getScreenSpaceBoundingBox=function(t,n,i){let o=t.width,r=t.height,s=t.scale;o*=s,r*=s;let a=n.x;t.horizontalOrigin===ui.RIGHT?a-=o:t.horizontalOrigin===ui.CENTER&&(a-=o*.5);let c=n.y;return t.verticalOrigin===vn.BOTTOM||t.verticalOrigin===vn.BASELINE?c-=r:t.verticalOrigin===vn.CENTER&&(c-=r*.5),f(i)||(i=new He),i.x=a,i.y=c,i.width=o,i.height=r,i};mi.prototype.equals=function(t){return this===t||f(t)&&this._id===t._id&&m.equals(this._position,t._position)&&this._imageId===t._imageId&&this._show===t._show&&this._scale===t._scale&&this._verticalOrigin===t._verticalOrigin&&this._horizontalOrigin===t._horizontalOrigin&&this._heightReference===t._heightReference&&He.equals(this._imageSubRegion,t._imageSubRegion)&&z.equals(this._color,t._color)&&W.equals(this._pixelOffset,t._pixelOffset)&&W.equals(this._translate,t._translate)&&m.equals(this._eyeOffset,t._eyeOffset)&&Pt.equals(this._scaleByDistance,t._scaleByDistance)&&Pt.equals(this._translucencyByDistance,t._translucencyByDistance)&&Pt.equals(this._pixelOffsetScaleByDistance,t._pixelOffsetScaleByDistance)&&wt.equals(this._distanceDisplayCondition,t._distanceDisplayCondition)&&this._disableDepthTestDistance===t._disableDepthTestDistance};mi.prototype._destroy=function(){f(this._customData)&&(this._billboardCollection._scene.globe._surface.removeTileCustomData(this._customData),this._customData=void 0),f(this._removeCallbackFunc)&&(this._removeCallbackFunc(),this._removeCallbackFunc=void 0),this.image=void 0,this._pickId=this._pickId&&this._pickId.destroy(),this._billboardCollection=void 0};var ho=mi;var QVe={OPAQUE:0,TRANSLUCENT:1,OPAQUE_AND_TRANSLUCENT:2},bo=Object.freeze(QVe);var $Ve={FONT_SIZE:48,PADDING:10,RADIUS:8,CUTOFF:.25},Is=Object.freeze($Ve);function Gm(t,n,i,o,r){this.bottomLeft=A(t,W.ZERO),this.topRight=A(n,W.ZERO),this.childNode1=i,this.childNode2=o,this.imageIndex=r}var eke=new W(16,16);function B_(t){t=A(t,A.EMPTY_OBJECT);let n=A(t.borderWidthInPixels,1),i=A(t.initialSize,eke);this._context=t.context,this._pixelFormat=A(t.pixelFormat,st.RGBA),this._borderWidthInPixels=n,this._textureCoordinates=[],this._guid=Bn(),this._idHash={},this._indexHash={},this._initialSize=i,this._root=void 0}Object.defineProperties(B_.prototype,{borderWidthInPixels:{get:function(){return this._borderWidthInPixels}},textureCoordinates:{get:function(){return this._textureCoordinates}},texture:{get:function(){return f(this._texture)||(this._texture=new St({context:this._context,width:this._initialSize.x,height:this._initialSize.y,pixelFormat:this._pixelFormat})),this._texture}},numberOfImages:{get:function(){return this._textureCoordinates.length}},guid:{get:function(){return this._guid}}});function tke(t,n){let i=t._context,o=t.numberOfImages,r=2,s=t._borderWidthInPixels;if(o>0){let a=t._texture.width,c=t._texture.height,l=r*(a+n.width+s),u=r*(c+n.height+s),d=a/l,h=c/u,_=new Gm(new W(a+s,s),new W(l,c)),y=new Gm(new W,new W(l,c),t._root,_),p=new Gm(new W(s,c+s),new W(l,u)),C=new Gm(new W,new W(l,u),y,p);for(let E=0;E<t._textureCoordinates.length;E++){let S=t._textureCoordinates[E];f(S)&&(S.x*=d,S.y*=h,S.width*=d,S.height*=h)}let x=new St({context:t._context,width:l,height:u,pixelFormat:t._pixelFormat}),T=new Xo({context:i,colorTextures:[t._texture],destroyAttachments:!1});T._bind(),x.copyFromFramebuffer(0,0,0,0,l,u),T._unBind(),T.destroy(),t._texture=t._texture&&t._texture.destroy(),t._texture=x,t._root=C}else{let a=r*(n.width+2*s),c=r*(n.height+2*s);a<t._initialSize.x&&(a=t._initialSize.x),c<t._initialSize.y&&(c=t._initialSize.y),t._texture=t._texture&&t._texture.destroy(),t._texture=new St({context:t._context,width:a,height:c,pixelFormat:t._pixelFormat}),t._root=new Gm(new W(s,s),new W(a,c))}}function XL(t,n,i){if(!!f(n)){if(!f(n.childNode1)&&!f(n.childNode2)){if(f(n.imageIndex))return;let o=n.topRight.x-n.bottomLeft.x,r=n.topRight.y-n.bottomLeft.y,s=o-i.width,a=r-i.height;if(s<0||a<0)return;if(s===0&&a===0)return n;if(s>a){n.childNode1=new Gm(new W(n.bottomLeft.x,n.bottomLeft.y),new W(n.bottomLeft.x+i.width,n.topRight.y));let c=n.bottomLeft.x+i.width+t._borderWidthInPixels;c<n.topRight.x&&(n.childNode2=new Gm(new W(c,n.bottomLeft.y),new W(n.topRight.x,n.topRight.y)))}else{n.childNode1=new Gm(new W(n.bottomLeft.x,n.bottomLeft.y),new W(n.topRight.x,n.bottomLeft.y+i.height));let c=n.bottomLeft.y+i.height+t._borderWidthInPixels;c<n.topRight.y&&(n.childNode2=new Gm(new W(n.bottomLeft.x,c),new W(n.topRight.x,n.topRight.y)))}return XL(t,n.childNode1,i)}return XL(t,n.childNode1,i)||XL(t,n.childNode2,i)}}function nne(t,n,i){let o=XL(t,t._root,n);if(f(o)){o.imageIndex=i;let r=t._texture.width,s=t._texture.height,a=o.topRight.x-o.bottomLeft.x,c=o.topRight.y-o.bottomLeft.y,l=o.bottomLeft.x/r,u=o.bottomLeft.y/s,d=a/r,h=c/s;t._textureCoordinates[i]=new He(l,u,d,h),t._texture.copyFrom({source:n,xOffset:o.bottomLeft.x,yOffset:o.bottomLeft.y})}else tke(t,n),nne(t,n,i);t._guid=Bn()}function ine(t,n){if(!f(t)||t.isDestroyed())return-1;let i=t.numberOfImages;return nne(t,n,i),i}B_.prototype.getImageIndex=function(t){return this._indexHash[t]};B_.prototype.addImageSync=function(t,n){let i=this._indexHash[t];return f(i)||(i=ine(this,n),this._idHash[t]=Promise.resolve(i),this._indexHash[t]=i),i};B_.prototype.addImage=function(t,n){let i=this._idHash[t];if(f(i))return i;typeof n=="function"?n=n(t):(typeof n=="string"||n instanceof Ie)&&(n=Ie.createIfNeeded(n).fetchImage());let o=this;return i=Promise.resolve(n).then(function(r){let s=ine(o,r);return o._indexHash[t]=s,s}),this._idHash[t]=i,i};B_.prototype.addSubRegion=function(t,n){let i=this._idHash[t];if(!f(i))throw new he(`image with id "${t}" not found in the atlas.`);let o=this;return Promise.resolve(i).then(function(r){if(r===-1)return-1;let s=o._texture.width,a=o._texture.height,c=o.numberOfImages,l=o._textureCoordinates[r],u=l.x+n.x/s,d=l.y+n.y/a,h=n.width/s,_=n.height/a;return o._textureCoordinates.push(new He(u,d,h,_)),o._guid=Bn(),c})};B_.prototype.isDestroyed=function(){return!1};B_.prototype.destroy=function(){return this._texture=this._texture&&this._texture.destroy(),ue(this)};var uy=B_;var nke=ho.SHOW_INDEX,ZS=ho.POSITION_INDEX,one=ho.PIXEL_OFFSET_INDEX,rne=ho.EYE_OFFSET_INDEX,ike=ho.HORIZONTAL_ORIGIN_INDEX,oke=ho.VERTICAL_ORIGIN_INDEX,rke=ho.SCALE_INDEX,JS=ho.IMAGE_INDEX_INDEX,sne=ho.COLOR_INDEX,ske=ho.ROTATION_INDEX,ake=ho.ALIGNED_AXIS_INDEX,ane=ho.SCALE_BY_DISTANCE_INDEX,cne=ho.TRANSLUCENCY_BY_DISTANCE_INDEX,lne=ho.PIXEL_OFFSET_SCALE_BY_DISTANCE_INDEX,une=ho.DISTANCE_DISPLAY_CONDITION,cke=ho.DISABLE_DEPTH_DISTANCE,lke=ho.TEXTURE_COORDINATE_BOUNDS,fne=ho.SDF_INDEX,p5=ho.NUMBER_OF_PROPERTIES,mo,uke={positionHighAndScale:0,positionLowAndRotation:1,compressedAttribute0:2,compressedAttribute1:3,compressedAttribute2:4,eyeOffset:5,scaleByDistance:6,pixelOffsetScaleByDistance:7,compressedAttribute3:8,textureCoordinateBoundsOrLabelTranslate:9,a_batchId:10,sdf:11},fke={direction:0,positionHighAndScale:1,positionLowAndRotation:2,compressedAttribute0:3,compressedAttribute1:4,compressedAttribute2:5,eyeOffset:6,scaleByDistance:7,pixelOffsetScaleByDistance:8,compressedAttribute3:9,textureCoordinateBoundsOrLabelTranslate:10,a_batchId:11,sdf:12};function Du(t){t=A(t,A.EMPTY_OBJECT),this._scene=t.scene,this._batchTable=t.batchTable,this._textureAtlas=void 0,this._textureAtlasGUID=void 0,this._destroyTextureAtlas=!0,this._sp=void 0,this._spTranslucent=void 0,this._rsOpaque=void 0,this._rsTranslucent=void 0,this._vaf=void 0,this._billboards=[],this._billboardsToUpdate=[],this._billboardsToUpdateIndex=0,this._billboardsRemoved=!1,this._createVertexArray=!1,this._shaderRotation=!1,this._compiledShaderRotation=!1,this._shaderAlignedAxis=!1,this._compiledShaderAlignedAxis=!1,this._shaderScaleByDistance=!1,this._compiledShaderScaleByDistance=!1,this._shaderTranslucencyByDistance=!1,this._compiledShaderTranslucencyByDistance=!1,this._shaderPixelOffsetScaleByDistance=!1,this._compiledShaderPixelOffsetScaleByDistance=!1,this._shaderDistanceDisplayCondition=!1,this._compiledShaderDistanceDisplayCondition=!1,this._shaderDisableDepthDistance=!1,this._compiledShaderDisableDepthDistance=!1,this._shaderClampToGround=!1,this._compiledShaderClampToGround=!1,this._propertiesChanged=new Uint32Array(p5),this._maxSize=0,this._maxEyeOffset=0,this._maxScale=1,this._maxPixelOffset=0,this._allHorizontalCenter=!0,this._allVerticalCenter=!0,this._allSizedInMeters=!0,this._baseVolume=new ae,this._baseVolumeWC=new ae,this._baseVolume2D=new ae,this._boundingVolume=new ae,this._boundingVolumeDirty=!1,this._colorCommands=[],this.show=A(t.show,!0),this.modelMatrix=N.clone(A(t.modelMatrix,N.IDENTITY)),this._modelMatrix=N.clone(N.IDENTITY),this.debugShowBoundingVolume=A(t.debugShowBoundingVolume,!1),this.debugShowTextureAtlas=A(t.debugShowTextureAtlas,!1),this.blendOption=A(t.blendOption,bo.OPAQUE_AND_TRANSLUCENT),this._blendOption=void 0,this._mode=ne.SCENE3D,this._buffersUsage=[Fe.STATIC_DRAW,Fe.STATIC_DRAW,Fe.STATIC_DRAW,Fe.STATIC_DRAW,Fe.STATIC_DRAW,Fe.STATIC_DRAW,Fe.STATIC_DRAW,Fe.STATIC_DRAW,Fe.STATIC_DRAW,Fe.STATIC_DRAW,Fe.STATIC_DRAW,Fe.STATIC_DRAW,Fe.STATIC_DRAW,Fe.STATIC_DRAW,Fe.STATIC_DRAW,Fe.STATIC_DRAW],this._highlightColor=z.clone(z.WHITE);let n=this;this._uniforms={u_atlas:function(){return n._textureAtlas.texture},u_highlightColor:function(){return n._highlightColor}};let i=this._scene;f(i)&&f(i.terrainProviderChanged)&&(this._removeCallbackFunc=i.terrainProviderChanged.addEventListener(function(){let o=this._billboards,r=o.length;for(let s=0;s<r;++s)f(o[s])&&o[s]._updateClamping()},this))}Object.defineProperties(Du.prototype,{length:{get:function(){return _5(this),this._billboards.length}},textureAtlas:{get:function(){return this._textureAtlas},set:function(t){this._textureAtlas!==t&&(this._textureAtlas=this._destroyTextureAtlas&&this._textureAtlas&&this._textureAtlas.destroy(),this._textureAtlas=t,this._createVertexArray=!0)}},destroyTextureAtlas:{get:function(){return this._destroyTextureAtlas},set:function(t){this._destroyTextureAtlas=t}}});function dne(t){let n=t.length;for(let i=0;i<n;++i)t[i]&&t[i]._destroy()}Du.prototype.add=function(t){let n=new ho(t,this);return n._index=this._billboards.length,this._billboards.push(n),this._createVertexArray=!0,n};Du.prototype.remove=function(t){return this.contains(t)?(this._billboards[t._index]=void 0,this._billboardsRemoved=!0,this._createVertexArray=!0,t._destroy(),!0):!1};Du.prototype.removeAll=function(){dne(this._billboards),this._billboards=[],this._billboardsToUpdate=[],this._billboardsToUpdateIndex=0,this._billboardsRemoved=!1,this._createVertexArray=!0};function _5(t){if(t._billboardsRemoved){t._billboardsRemoved=!1;let n=[],i=t._billboards,o=i.length;for(let r=0,s=0;r<o;++r){let a=i[r];f(a)&&(a._index=s++,n.push(a))}t._billboards=n}}Du.prototype._updateBillboard=function(t,n){t._dirty||(this._billboardsToUpdate[this._billboardsToUpdateIndex++]=t),++this._propertiesChanged[n]};Du.prototype.contains=function(t){return f(t)&&t._billboardCollection===this};Du.prototype.get=function(t){return _5(this),this._billboards[t]};var l5;function dke(t){let i=t.cache.billboardCollection_indexBufferBatched;if(f(i))return i;let o=16384*6-6,r=new Uint16Array(o);for(let s=0,a=0;s<o;s+=6,a+=4)r[s]=a,r[s+1]=a+1,r[s+2]=a+2,r[s+3]=a+0,r[s+4]=a+2,r[s+5]=a+3;return i=ut.createIndexBuffer({context:t,typedArray:r,usage:Fe.STATIC_DRAW,indexDatatype:Ne.UNSIGNED_SHORT}),i.vertexArrayDestroyable=!1,t.cache.billboardCollection_indexBufferBatched=i,i}function hke(t){let n=t.cache.billboardCollection_indexBufferInstanced;return f(n)||(n=ut.createIndexBuffer({context:t,typedArray:new Uint16Array([0,1,2,0,2,3]),usage:Fe.STATIC_DRAW,indexDatatype:Ne.UNSIGNED_SHORT}),n.vertexArrayDestroyable=!1,t.cache.billboardCollection_indexBufferInstanced=n),n}function mke(t){let n=t.cache.billboardCollection_vertexBufferInstanced;return f(n)||(n=ut.createVertexBuffer({context:t,typedArray:new Float32Array([0,0,1,0,1,1,0,1]),usage:Fe.STATIC_DRAW}),n.vertexArrayDestroyable=!1,t.cache.billboardCollection_vertexBufferInstanced=n),n}Du.prototype.computeNewBuffersUsage=function(){let t=this._buffersUsage,n=!1,i=this._propertiesChanged;for(let o=0;o<p5;++o){let r=i[o]===0?Fe.STATIC_DRAW:Fe.STREAM_DRAW;n=n||t[o]!==r,t[o]=r}return n};function pke(t,n,i,o,r,s){let a=[{index:mo.positionHighAndScale,componentsPerAttribute:4,componentDatatype:J.FLOAT,usage:i[ZS]},{index:mo.positionLowAndRotation,componentsPerAttribute:4,componentDatatype:J.FLOAT,usage:i[ZS]},{index:mo.compressedAttribute0,componentsPerAttribute:4,componentDatatype:J.FLOAT,usage:i[one]},{index:mo.compressedAttribute1,componentsPerAttribute:4,componentDatatype:J.FLOAT,usage:i[cne]},{index:mo.compressedAttribute2,componentsPerAttribute:4,componentDatatype:J.FLOAT,usage:i[sne]},{index:mo.eyeOffset,componentsPerAttribute:4,componentDatatype:J.FLOAT,usage:i[rne]},{index:mo.scaleByDistance,componentsPerAttribute:4,componentDatatype:J.FLOAT,usage:i[ane]},{index:mo.pixelOffsetScaleByDistance,componentsPerAttribute:4,componentDatatype:J.FLOAT,usage:i[lne]},{index:mo.compressedAttribute3,componentsPerAttribute:4,componentDatatype:J.FLOAT,usage:i[une]},{index:mo.textureCoordinateBoundsOrLabelTranslate,componentsPerAttribute:4,componentDatatype:J.FLOAT,usage:i[lke]}];o&&a.push({index:mo.direction,componentsPerAttribute:2,componentDatatype:J.FLOAT,vertexBuffer:mke(t)}),f(r)&&a.push({index:mo.a_batchId,componentsPerAttribute:1,componentDatatype:J.FLOAT,bufferUsage:Fe.STATIC_DRAW}),s&&a.push({index:mo.sdf,componentsPerAttribute:2,componentDatatype:J.FLOAT,usage:i[fne]});let c=o?n:4*n;return new I_(t,a,c,o)}var u5=new Hn;function hne(t,n,i,o,r){let s,a=o[mo.positionHighAndScale],c=o[mo.positionLowAndRotation],l=r._getActualPosition();t._mode===ne.SCENE3D&&(ae.expand(t._baseVolume,l,t._baseVolume),t._boundingVolumeDirty=!0),Hn.fromCartesian(l,u5);let u=r.scale,d=r.rotation;d!==0&&(t._shaderRotation=!0),t._maxScale=Math.max(t._maxScale,u);let h=u5.high,_=u5.low;t._instanced?(s=r._index,a(s,h.x,h.y,h.z,u),c(s,_.x,_.y,_.z,d)):(s=r._index*4,a(s+0,h.x,h.y,h.z,u),a(s+1,h.x,h.y,h.z,u),a(s+2,h.x,h.y,h.z,u),a(s+3,h.x,h.y,h.z,u),c(s+0,_.x,_.y,_.z,d),c(s+1,_.x,_.y,_.z,d),c(s+2,_.x,_.y,_.z,d),c(s+3,_.x,_.y,_.z,d))}var wu=new W,Su=32768,Px=65536,f5=4096,ah=256,_ke=128,gke=32,yke=8,mne=4,Ake=1/256,pne=0,_ne=2,gne=3,yne=1;function Ane(t,n,i,o,r){let s,a=o[mo.compressedAttribute0],c=r.pixelOffset,l=c.x,u=c.y,d=r._translate,h=d.x,_=d.y;t._maxPixelOffset=Math.max(t._maxPixelOffset,Math.abs(l+h),Math.abs(-u+_));let y=r.horizontalOrigin,p=r._verticalOrigin,C=r.show&&r.clusterShow;r.color.alpha===0&&(C=!1),p===vn.BASELINE&&(p=vn.BOTTOM),t._allHorizontalCenter=t._allHorizontalCenter&&y===ui.CENTER,t._allVerticalCenter=t._allVerticalCenter&&p===vn.CENTER;let x=0,T=0,E=0,S=0,w=r._imageIndex;if(w!==-1){let H=i[w];x=H.x,T=H.y,E=H.width,S=H.height}let D=x+E,I=T+S,O=Math.floor(B.clamp(l,-Su,Su)+Su)*_ke;O+=(y+1)*gke,O+=(p+1)*yke,O+=(C?1:0)*mne;let M=Math.floor(B.clamp(u,-Su,Su)+Su)*ah,L=Math.floor(B.clamp(h,-Su,Su)+Su)*ah,F=(B.clamp(_,-Su,Su)+Su)*Ake,g=Math.floor(F),b=Math.floor((F-g)*ah);M+=g,L+=b,wu.x=x,wu.y=T;let v=zn.compressTextureCoordinates(wu);wu.x=D;let P=zn.compressTextureCoordinates(wu);wu.y=I;let R=zn.compressTextureCoordinates(wu);wu.x=x;let V=zn.compressTextureCoordinates(wu);t._instanced?(s=r._index,a(s,O,M,L,v)):(s=r._index*4,a(s+0,O+pne,M,L,v),a(s+1,O+_ne,M,L,P),a(s+2,O+gne,M,L,R),a(s+3,O+yne,M,L,V))}function Cne(t,n,i,o,r){let s,a=o[mo.compressedAttribute1],c=r.alignedAxis;m.equals(c,m.ZERO)||(t._shaderAlignedAxis=!0);let l=0,u=1,d=1,h=1,_=r.translucencyByDistance;f(_)&&(l=_.near,u=_.nearValue,d=_.far,h=_.farValue,(u!==1||h!==1)&&(t._shaderTranslucencyByDistance=!0));let y=0,p=r._imageIndex;p!==-1&&(y=i[p].width);let C=t._textureAtlas.texture.width,x=Math.round(A(r.width,C*y));t._maxSize=Math.max(t._maxSize,x);let T=B.clamp(x,0,Px),E=0;Math.abs(m.magnitudeSquared(c)-1)<B.EPSILON6&&(E=zn.octEncodeFloat(c)),u=B.clamp(u,0,1),u=u===1?255:u*255|0,T=T*ah+u,h=B.clamp(h,0,1),h=h===1?255:h*255|0,E=E*ah+h,t._instanced?(s=r._index,a(s,T,E,l,d)):(s=r._index*4,a(s+0,T,E,l,d),a(s+1,T,E,l,d),a(s+2,T,E,l,d),a(s+3,T,E,l,d))}function h5(t,n,i,o,r){let s,a=o[mo.compressedAttribute2],c=r.color,l=f(t._batchTable)?z.WHITE:r.getPickId(n.context).color,u=r.sizeInMeters?1:0,d=Math.abs(m.magnitudeSquared(r.alignedAxis)-1)<B.EPSILON6?1:0;t._allSizedInMeters=t._allSizedInMeters&&u===1;let h=0,_=r._imageIndex;_!==-1&&(h=i[_].height);let y=t._textureAtlas.texture.dimensions,p=Math.round(A(r.height,y.y*h));t._maxSize=Math.max(t._maxSize,p);let C=A(r._labelHorizontalOrigin,-2);C+=2;let x=p*mne+C,T=z.floatToByte(c.red),E=z.floatToByte(c.green),S=z.floatToByte(c.blue),w=T*Px+E*ah+S;T=z.floatToByte(l.red),E=z.floatToByte(l.green),S=z.floatToByte(l.blue);let D=T*Px+E*ah+S,I=z.floatToByte(c.alpha)*Px+z.floatToByte(l.alpha)*ah;I+=u*2+d,t._instanced?(s=r._index,a(s,w,D,I,x)):(s=r._index*4,a(s+0,w,D,I,x),a(s+1,w,D,I,x),a(s+2,w,D,I,x),a(s+3,w,D,I,x))}function m5(t,n,i,o,r){let s,a=o[mo.eyeOffset],c=r.eyeOffset,l=c.z;if(r._heightReference!==Ge.NONE&&(l*=1.005),t._maxEyeOffset=Math.max(t._maxEyeOffset,Math.abs(c.x),Math.abs(c.y),Math.abs(l)),t._instanced){let u=0,d=0,h=r._imageIndex;if(h!==-1){let y=i[h];u=y.width,d=y.height}wu.x=u,wu.y=d;let _=zn.compressTextureCoordinates(wu);s=r._index,a(s,c.x,c.y,l,_)}else s=r._index*4,a(s+0,c.x,c.y,l,0),a(s+1,c.x,c.y,l,0),a(s+2,c.x,c.y,l,0),a(s+3,c.x,c.y,l,0)}function xne(t,n,i,o,r){let s,a=o[mo.scaleByDistance],c=0,l=1,u=1,d=1,h=r.scaleByDistance;f(h)&&(c=h.near,l=h.nearValue,u=h.far,d=h.farValue,(l!==1||d!==1)&&(t._shaderScaleByDistance=!0)),t._instanced?(s=r._index,a(s,c,l,u,d)):(s=r._index*4,a(s+0,c,l,u,d),a(s+1,c,l,u,d),a(s+2,c,l,u,d),a(s+3,c,l,u,d))}function Tne(t,n,i,o,r){let s,a=o[mo.pixelOffsetScaleByDistance],c=0,l=1,u=1,d=1,h=r.pixelOffsetScaleByDistance;f(h)&&(c=h.near,l=h.nearValue,u=h.far,d=h.farValue,(l!==1||d!==1)&&(t._shaderPixelOffsetScaleByDistance=!0)),t._instanced?(s=r._index,a(s,c,l,u,d)):(s=r._index*4,a(s+0,c,l,u,d),a(s+1,c,l,u,d),a(s+2,c,l,u,d),a(s+3,c,l,u,d))}function Ene(t,n,i,o,r){let s,a=o[mo.compressedAttribute3],c=0,l=Number.MAX_VALUE,u=r.distanceDisplayCondition;f(u)&&(c=u.near,l=u.far,c*=c,l*=l,t._shaderDistanceDisplayCondition=!0);let d=r.disableDepthTestDistance,h=r.heightReference===Ge.CLAMP_TO_GROUND&&n.context.depthTexture;f(d)||(d=h?5e3:0),d*=d,(h||d>0)&&(t._shaderDisableDepthDistance=!0,d===Number.POSITIVE_INFINITY&&(d=-1));let _,y;if(f(r._labelDimensions))y=r._labelDimensions.x,_=r._labelDimensions.y;else{let T=0,E=0,S=r._imageIndex;if(S!==-1){let D=i[S];T=D.height,E=D.width}_=Math.round(A(r.height,t._textureAtlas.texture.dimensions.y*T));let w=t._textureAtlas.texture.width;y=Math.round(A(r.width,w*E))}let p=Math.floor(B.clamp(y,0,f5)),C=Math.floor(B.clamp(_,0,f5)),x=p*f5+C;t._instanced?(s=r._index,a(s,c,l,d,x)):(s=r._index*4,a(s+0,c,l,d,x),a(s+1,c,l,d,x),a(s+2,c,l,d,x),a(s+3,c,l,d,x))}function bne(t,n,i,o,r){if(r.heightReference===Ge.CLAMP_TO_GROUND){let p=t._scene,C=n.context,x=n.globeTranslucencyState.translucent,T=f(p.globe)&&p.globe.depthTestAgainstTerrain;t._shaderClampToGround=C.depthTexture&&!x&&T}let s,a=o[mo.textureCoordinateBoundsOrLabelTranslate];if(Ut.maximumVertexTextureImageUnits>0){let p=0,C=0;f(r._labelTranslate)&&(p=r._labelTranslate.x,C=r._labelTranslate.y),t._instanced?(s=r._index,a(s,p,C,0,0)):(s=r._index*4,a(s+0,p,C,0,0),a(s+1,p,C,0,0),a(s+2,p,C,0,0),a(s+3,p,C,0,0));return}let c=0,l=0,u=0,d=0,h=r._imageIndex;if(h!==-1){let p=i[h];c=p.x,l=p.y,u=p.width,d=p.height}let _=c+u,y=l+d;t._instanced?(s=r._index,a(s,c,l,_,y)):(s=r._index*4,a(s+0,c,l,_,y),a(s+1,c,l,_,y),a(s+2,c,l,_,y),a(s+3,c,l,_,y))}function Cke(t,n,i,o,r){if(!f(t._batchTable))return;let s=o[mo.a_batchId],a=r._batchIndex,c;t._instanced?(c=r._index,s(c,a)):(c=r._index*4,s(c+0,a),s(c+1,a),s(c+2,a),s(c+3,a))}function Sne(t,n,i,o,r){if(!t._sdf)return;let s,a=o[mo.sdf],c=r.outlineColor,l=r.outlineWidth,u=z.floatToByte(c.red),d=z.floatToByte(c.green),h=z.floatToByte(c.blue),_=u*Px+d*ah+h,y=l/Is.RADIUS,p=z.floatToByte(c.alpha)*Px+z.floatToByte(y)*ah;t._instanced?(s=r._index,a(s,_,p)):(s=r._index*4,a(s+0,_+pne,p),a(s+1,_+_ne,p),a(s+2,_+gne,p),a(s+3,_+yne,p))}function xke(t,n,i,o,r){hne(t,n,i,o,r),Ane(t,n,i,o,r),Cne(t,n,i,o,r),h5(t,n,i,o,r),m5(t,n,i,o,r),xne(t,n,i,o,r),Tne(t,n,i,o,r),Ene(t,n,i,o,r),bne(t,n,i,o,r),Cke(t,n,i,o,r),Sne(t,n,i,o,r)}function d5(t,n,i,o,r,s){let a;o.mode===ne.SCENE3D?(a=t._baseVolume,t._boundingVolumeDirty=!0):a=t._baseVolume2D;let c=[];for(let l=0;l<i;++l){let u=n[l],d=u.position,h=ho._computeActualPosition(u,d,o,r);f(h)&&(u._setActualPosition(h),s?c.push(h):ae.expand(a,h,a))}s&&ae.fromPoints(c,a)}function Tke(t,n){let i=n.mode,o=t._billboards,r=t._billboardsToUpdate,s=t._modelMatrix;t._createVertexArray||t._mode!==i||i!==ne.SCENE3D&&!N.equals(s,t.modelMatrix)?(t._mode=i,N.clone(t.modelMatrix,s),t._createVertexArray=!0,(i===ne.SCENE3D||i===ne.SCENE2D||i===ne.COLUMBUS_VIEW)&&d5(t,o,o.length,n,s,!0)):i===ne.MORPHING?d5(t,o,o.length,n,s,!0):(i===ne.SCENE2D||i===ne.COLUMBUS_VIEW)&&d5(t,r,t._billboardsToUpdateIndex,n,s,!1)}function Eke(t,n,i){let o=1;(!t._allSizedInMeters||t._maxPixelOffset!==0)&&(o=n.camera.getPixelSize(i,n.context.drawingBufferWidth,n.context.drawingBufferHeight));let r=o*t._maxScale*t._maxSize*2;t._allHorizontalCenter&&t._allVerticalCenter&&(r*=.5);let s=o*t._maxPixelOffset+t._maxEyeOffset;i.radius+=r+s}function bke(t,n){let i=`uniform sampler2D billboard_texture; 
varying vec2 v_textureCoordinates; 
void main() 
{ 
    gl_FragColor = texture2D(billboard_texture, v_textureCoordinates); 
} 
`,o=n.createViewportQuadCommand(i,{uniformMap:{billboard_texture:function(){return t._textureAtlas.texture}}});return o.pass=Te.OVERLAY,o}var Ske=[];Du.prototype.update=function(t){if(_5(this),!this.show)return;let n=this._billboards,i=n.length,o=t.context;this._instanced=o.instancedArrays,mo=this._instanced?fke:uke,l5=this._instanced?hke:dke;let r=this._textureAtlas;if(!f(r)){r=this._textureAtlas=new uy({context:o});for(let M=0;M<i;++M)n[M]._loadImage()}let s=r.textureCoordinates;if(s.length===0)return;Tke(this,t),n=this._billboards,i=n.length;let a=this._billboardsToUpdate,c=this._billboardsToUpdateIndex,l=this._propertiesChanged,u=r.guid,d=this._createVertexArray||this._textureAtlasGUID!==u;this._textureAtlasGUID=u;let h,_=t.passes,y=_.pick;if(d||!y&&this.computeNewBuffersUsage()){this._createVertexArray=!1;for(let M=0;M<p5;++M)l[M]=0;if(this._vaf=this._vaf&&this._vaf.destroy(),i>0){this._vaf=pke(o,i,this._buffersUsage,this._instanced,this._batchTable,this._sdf),h=this._vaf.writers;for(let M=0;M<i;++M){let L=this._billboards[M];L._dirty=!1,xke(this,t,s,h,L)}this._vaf.commit(l5(o))}this._billboardsToUpdateIndex=0}else if(c>0){let M=Ske;M.length=0,(l[ZS]||l[ske]||l[rke])&&M.push(hne),(l[JS]||l[one]||l[ike]||l[oke]||l[nke])&&(M.push(Ane),this._instanced&&M.push(m5)),(l[JS]||l[ake]||l[cne])&&(M.push(Cne),M.push(h5)),(l[JS]||l[sne])&&M.push(h5),l[rne]&&M.push(m5),l[ane]&&M.push(xne),l[lne]&&M.push(Tne),(l[une]||l[cke]||l[JS]||l[ZS])&&M.push(Ene),(l[JS]||l[ZS])&&M.push(bne),l[fne]&&M.push(Sne);let L=M.length;if(h=this._vaf.writers,c/i>.1){for(let F=0;F<c;++F){let g=a[F];g._dirty=!1;for(let b=0;b<L;++b)M[b](this,t,s,h,g)}this._vaf.commit(l5(o))}else{for(let F=0;F<c;++F){let g=a[F];g._dirty=!1;for(let b=0;b<L;++b)M[b](this,t,s,h,g);this._instanced?this._vaf.subCommit(g._index,1):this._vaf.subCommit(g._index*4,4)}this._vaf.endSubCommits()}this._billboardsToUpdateIndex=0}if(c>i*1.5&&(a.length=i),!f(this._vaf)||!f(this._vaf.va))return;this._boundingVolumeDirty&&(this._boundingVolumeDirty=!1,ae.transform(this._baseVolume,this.modelMatrix,this._baseVolumeWC));let p,C=N.IDENTITY;t.mode===ne.SCENE3D?(C=this.modelMatrix,p=ae.clone(this._baseVolumeWC,this._boundingVolume)):p=ae.clone(this._baseVolume2D,this._boundingVolume),Eke(this,t,p);let x=this._blendOption!==this.blendOption;if(this._blendOption=this.blendOption,x){this._blendOption===bo.OPAQUE||this._blendOption===bo.OPAQUE_AND_TRANSLUCENT?this._rsOpaque=Ve.fromCache({depthTest:{enabled:!0,func:ee.LESS},depthMask:!0}):this._rsOpaque=void 0;let M=this._blendOption===bo.TRANSLUCENT;this._blendOption===bo.TRANSLUCENT||this._blendOption===bo.OPAQUE_AND_TRANSLUCENT?this._rsTranslucent=Ve.fromCache({depthTest:{enabled:!0,func:M?ee.LEQUAL:ee.LESS},depthMask:M,blending:ln.ALPHA_BLEND}):this._rsTranslucent=void 0}this._shaderDisableDepthDistance=this._shaderDisableDepthDistance||t.minimumDisableDepthTestDistance!==0;let T,E,S,w,D,I=Ut.maximumVertexTextureImageUnits>0;if(x||this._shaderRotation!==this._compiledShaderRotation||this._shaderAlignedAxis!==this._compiledShaderAlignedAxis||this._shaderScaleByDistance!==this._compiledShaderScaleByDistance||this._shaderTranslucencyByDistance!==this._compiledShaderTranslucencyByDistance||this._shaderPixelOffsetScaleByDistance!==this._compiledShaderPixelOffsetScaleByDistance||this._shaderDistanceDisplayCondition!==this._compiledShaderDistanceDisplayCondition||this._shaderDisableDepthDistance!==this._compiledShaderDisableDepthDistance||this._shaderClampToGround!==this._compiledShaderClampToGround||this._sdf!==this._compiledSDF){T=WL,E=GL,D=[],f(this._batchTable)&&(D.push("VECTOR_TILE"),T=this._batchTable.getVertexShaderCallback(!1,"a_batchId",void 0)(T),E=this._batchTable.getFragmentShaderCallback(!1,void 0)(E)),S=new ze({defines:D,sources:[T]}),this._instanced&&S.defines.push("INSTANCED"),this._shaderRotation&&S.defines.push("ROTATION"),this._shaderAlignedAxis&&S.defines.push("ALIGNED_AXIS"),this._shaderScaleByDistance&&S.defines.push("EYE_DISTANCE_SCALING"),this._shaderTranslucencyByDistance&&S.defines.push("EYE_DISTANCE_TRANSLUCENCY"),this._shaderPixelOffsetScaleByDistance&&S.defines.push("EYE_DISTANCE_PIXEL_OFFSET"),this._shaderDistanceDisplayCondition&&S.defines.push("DISTANCE_DISPLAY_CONDITION"),this._shaderDisableDepthDistance&&S.defines.push("DISABLE_DEPTH_DISTANCE"),this._shaderClampToGround&&(I?S.defines.push("VERTEX_DEPTH_CHECK"):S.defines.push("FRAGMENT_DEPTH_CHECK"));let M=1-Is.CUTOFF;this._sdf&&S.defines.push("SDF");let L=f(this._batchTable)?"VECTOR_TILE":"";this._blendOption===bo.OPAQUE_AND_TRANSLUCENT&&(w=new ze({defines:["OPAQUE",L],sources:[E]}),this._shaderClampToGround&&(I?w.defines.push("VERTEX_DEPTH_CHECK"):w.defines.push("FRAGMENT_DEPTH_CHECK")),this._sdf&&(w.defines.push("SDF"),w.defines.push(`SDF_EDGE ${M}`)),this._sp=qt.replaceCache({context:o,shaderProgram:this._sp,vertexShaderSource:S,fragmentShaderSource:w,attributeLocations:mo}),w=new ze({defines:["TRANSLUCENT",L],sources:[E]}),this._shaderClampToGround&&(I?w.defines.push("VERTEX_DEPTH_CHECK"):w.defines.push("FRAGMENT_DEPTH_CHECK")),this._sdf&&(w.defines.push("SDF"),w.defines.push(`SDF_EDGE ${M}`)),this._spTranslucent=qt.replaceCache({context:o,shaderProgram:this._spTranslucent,vertexShaderSource:S,fragmentShaderSource:w,attributeLocations:mo})),this._blendOption===bo.OPAQUE&&(w=new ze({defines:[L],sources:[E]}),this._shaderClampToGround&&(I?w.defines.push("VERTEX_DEPTH_CHECK"):w.defines.push("FRAGMENT_DEPTH_CHECK")),this._sdf&&(w.defines.push("SDF"),w.defines.push(`SDF_EDGE ${M}`)),this._sp=qt.replaceCache({context:o,shaderProgram:this._sp,vertexShaderSource:S,fragmentShaderSource:w,attributeLocations:mo})),this._blendOption===bo.TRANSLUCENT&&(w=new ze({defines:[L],sources:[E]}),this._shaderClampToGround&&(I?w.defines.push("VERTEX_DEPTH_CHECK"):w.defines.push("FRAGMENT_DEPTH_CHECK")),this._sdf&&(w.defines.push("SDF"),w.defines.push(`SDF_EDGE ${M}`)),this._spTranslucent=qt.replaceCache({context:o,shaderProgram:this._spTranslucent,vertexShaderSource:S,fragmentShaderSource:w,attributeLocations:mo})),this._compiledShaderRotation=this._shaderRotation,this._compiledShaderAlignedAxis=this._shaderAlignedAxis,this._compiledShaderScaleByDistance=this._shaderScaleByDistance,this._compiledShaderTranslucencyByDistance=this._shaderTranslucencyByDistance,this._compiledShaderPixelOffsetScaleByDistance=this._shaderPixelOffsetScaleByDistance,this._compiledShaderDistanceDisplayCondition=this._shaderDistanceDisplayCondition,this._compiledShaderDisableDepthDistance=this._shaderDisableDepthDistance,this._compiledShaderClampToGround=this._shaderClampToGround,this._compiledSDF=this._sdf}let O=t.commandList;if(_.render||_.pick){let M=this._colorCommands,L=this._blendOption===bo.OPAQUE,F=this._blendOption===bo.OPAQUE_AND_TRANSLUCENT,g=this._vaf.va,b=g.length,v=this._uniforms,P;f(this._batchTable)?(v=this._batchTable.getUniformMapCallback()(v),P=this._batchTable.getPickId()):P="v_pickColor",M.length=b;let R=F?b*2:b;for(let V=0;V<R;++V){let H=M[V];f(H)||(H=M[V]=new et);let U=L||F&&V%2===0;H.pass=U||!F?Te.OPAQUE:Te.TRANSLUCENT,H.owner=this;let G=F?Math.floor(V/2):V;H.boundingVolume=p,H.modelMatrix=C,H.count=g[G].indicesCount,H.shaderProgram=U?this._sp:this._spTranslucent,H.uniformMap=v,H.vertexArray=g[G].va,H.renderState=U?this._rsOpaque:this._rsTranslucent,H.debugShowBoundingVolume=this.debugShowBoundingVolume,H.pickId=P,this._instanced&&(H.count=6,H.instanceCount=i),O.push(H)}this.debugShowTextureAtlas&&(f(this.debugCommand)||(this.debugCommand=bke(this,t.context)),O.push(this.debugCommand))}};Du.prototype.isDestroyed=function(){return!1};Du.prototype.destroy=function(){return f(this._removeCallbackFunc)&&(this._removeCallbackFunc(),this._removeCallbackFunc=void 0),this._textureAtlas=this._destroyTextureAtlas&&this._textureAtlas&&this._textureAtlas.destroy(),this._sp=this._sp&&this._sp.destroy(),this._spTranslucent=this._spTranslucent&&this._spTranslucent.destroy(),this._vaf=this._vaf&&this._vaf.destroy(),dne(this._billboards),ue(this)};var vu=Du;function wke(t,n,i,o,r){return function(){let s=document.createElement("canvas"),a=r+2*o;s.height=s.width=a;let c=s.getContext("2d");return c.clearRect(0,0,a,a),o!==0&&(c.beginPath(),c.arc(a/2,a/2,a/2,0,2*Math.PI,!0),c.closePath(),c.fillStyle=i,c.fill(),t<1&&(c.save(),c.globalCompositeOperation="destination-out",c.beginPath(),c.arc(a/2,a/2,r/2,0,2*Math.PI,!0),c.closePath(),c.fillStyle="black",c.fill(),c.restore())),c.beginPath(),c.arc(a/2,a/2,r/2,0,2*Math.PI,!0),c.closePath(),c.fillStyle=n,c.fill(),s}}var Ix=wke;function Bs(t,n,i,o,r){this._content=t,this._billboard=i,this._label=o,this._polyline=r,this._batchId=n,this._billboardImage=void 0,this._billboardColor=void 0,this._billboardOutlineColor=void 0,this._billboardOutlineWidth=void 0,this._billboardSize=void 0,this._pointSize=void 0,this._color=void 0,this._pointSize=void 0,this._pointOutlineColor=void 0,this._pointOutlineWidth=void 0,this._heightOffset=void 0,this._pickIds=new Array(3),Bx(this)}var Dke=new de;Object.defineProperties(Bs.prototype,{show:{get:function(){return this._label.show},set:function(t){this._label.show=t,this._billboard.show=t,this._polyline.show=t}},color:{get:function(){return this._color},set:function(t){this._color=z.clone(t,this._color),Bx(this)}},pointSize:{get:function(){return this._pointSize},set:function(t){this._pointSize=t,Bx(this)}},pointOutlineColor:{get:function(){return this._pointOutlineColor},set:function(t){this._pointOutlineColor=z.clone(t,this._pointOutlineColor),Bx(this)}},pointOutlineWidth:{get:function(){return this._pointOutlineWidth},set:function(t){this._pointOutlineWidth=t,Bx(this)}},labelColor:{get:function(){return this._label.fillColor},set:function(t){this._label.fillColor=t,this._polyline.show=this._label.show&&t.alpha>0}},labelOutlineColor:{get:function(){return this._label.outlineColor},set:function(t){this._label.outlineColor=t}},labelOutlineWidth:{get:function(){return this._label.outlineWidth},set:function(t){this._label.outlineWidth=t}},font:{get:function(){return this._label.font},set:function(t){this._label.font=t}},labelStyle:{get:function(){return this._label.style},set:function(t){this._label.style=t}},labelText:{get:function(){return this._label.text},set:function(t){f(t)||(t=""),this._label.text=t}},backgroundColor:{get:function(){return this._label.backgroundColor},set:function(t){this._label.backgroundColor=t}},backgroundPadding:{get:function(){return this._label.backgroundPadding},set:function(t){this._label.backgroundPadding=t}},backgroundEnabled:{get:function(){return this._label.showBackground},set:function(t){this._label.showBackground=t}},scaleByDistance:{get:function(){return this._label.scaleByDistance},set:function(t){this._label.scaleByDistance=t,this._billboard.scaleByDistance=t}},translucencyByDistance:{get:function(){return this._label.translucencyByDistance},set:function(t){this._label.translucencyByDistance=t,this._billboard.translucencyByDistance=t}},distanceDisplayCondition:{get:function(){return this._label.distanceDisplayCondition},set:function(t){this._label.distanceDisplayCondition=t,this._polyline.distanceDisplayCondition=t,this._billboard.distanceDisplayCondition=t}},heightOffset:{get:function(){return this._heightOffset},set:function(t){let n=A(this._heightOffset,0),i=this._content.tileset.ellipsoid,o=i.cartesianToCartographic(this._billboard.position,Dke);o.height=o.height-n+t;let r=i.cartographicToCartesian(o);this._billboard.position=r,this._label.position=this._billboard.position,this._polyline.positions=[this._polyline.positions[0],r],this._heightOffset=t}},anchorLineEnabled:{get:function(){return this._polyline.show},set:function(t){this._polyline.show=t}},anchorLineColor:{get:function(){return this._polyline.material.uniforms.color},set:function(t){this._polyline.material.uniforms.color=z.clone(t,this._polyline.material.uniforms.color)}},image:{get:function(){return this._billboardImage},set:function(t){let n=this._billboardImage!==t;this._billboardImage=t,n&&Bx(this)}},disableDepthTestDistance:{get:function(){return this._label.disableDepthTestDistance},set:function(t){this._label.disableDepthTestDistance=t,this._billboard.disableDepthTestDistance=t}},horizontalOrigin:{get:function(){return this._billboard.horizontalOrigin},set:function(t){this._billboard.horizontalOrigin=t}},verticalOrigin:{get:function(){return this._billboard.verticalOrigin},set:function(t){this._billboard.verticalOrigin=t}},labelHorizontalOrigin:{get:function(){return this._label.horizontalOrigin},set:function(t){this._label.horizontalOrigin=t}},labelVerticalOrigin:{get:function(){return this._label.verticalOrigin},set:function(t){this._label.verticalOrigin=t}},content:{get:function(){return this._content}},tileset:{get:function(){return this._content.tileset}},primitive:{get:function(){return this._content.tileset}},pickIds:{get:function(){let t=this._pickIds;return t[0]=this._billboard.pickId,t[1]=this._label.pickId,t[2]=this._polyline.pickId,t}}});Bs.defaultColor=z.WHITE;Bs.defaultPointOutlineColor=z.BLACK;Bs.defaultPointOutlineWidth=0;Bs.defaultPointSize=8;function Bx(t){let n=t._billboard;if(f(t._billboardImage)&&t._billboardImage!==n.image){n.image=t._billboardImage;return}if(f(t._billboardImage))return;let i=A(t._color,Bs.defaultColor),o=A(t._pointOutlineColor,Bs.defaultPointOutlineColor),r=A(t._pointOutlineWidth,Bs.defaultPointOutlineWidth),s=A(t._pointSize,Bs.defaultPointSize),a=t._billboardColor,c=t._billboardOutlineColor,l=t._billboardOutlineWidth,u=t._billboardSize;if(z.equals(i,a)&&z.equals(o,c)&&r===l&&s===u)return;t._billboardColor=z.clone(i,t._billboardColor),t._billboardOutlineColor=z.clone(o,t._billboardOutlineColor),t._billboardOutlineWidth=r,t._billboardSize=s;let d=i.alpha,h=i.toCssColorString(),_=o.toCssColorString(),y=JSON.stringify([h,s,_,r]);n.setImage(y,Ix(d,h,_,r,s))}Bs.prototype.hasProperty=function(t){return this._content.batchTable.hasProperty(this._batchId,t)};Bs.prototype.getPropertyIds=function(t){return this._content.batchTable.getPropertyIds(this._batchId,t)};Bs.prototype.getProperty=function(t){return this._content.batchTable.getProperty(this._batchId,t)};Bs.prototype.getPropertyInherited=function(t){return Ds.getPropertyInherited(this._content,this._batchId,t)};Bs.prototype.setProperty=function(t,n){this._content.batchTable.setProperty(this._batchId,t,n),this._content.featurePropertiesDirty=!0};Bs.prototype.isExactClass=function(t){return this._content.batchTable.isExactClass(this._batchId,t)};Bs.prototype.isClass=function(t){return this._content.batchTable.isClass(this._batchId,t)};Bs.prototype.getExactClassName=function(){return this._content.batchTable.getExactClassName(this._batchId)};var O_=Bs;function vke(t,n,i,o,r){let s=t.measureText(n);if(!!/\S/.test(n)){let c=document.defaultView.getComputedStyle(t.canvas).getPropertyValue("font-size").replace("px",""),l=document.createElement("canvas"),u=100,d=s.width+u|0,h=3*c,_=h/2;l.width=d,l.height=h;let y=l.getContext("2d");y.font=i,y.fillStyle="white",y.fillRect(0,0,l.width+1,l.height+1),o&&(y.strokeStyle="black",y.lineWidth=t.lineWidth,y.strokeText(n,u/2,_)),r&&(y.fillStyle="black",y.fillText(n,u/2,_));let p=y.getImageData(0,0,d,h).data,C=p.length,x=d*4,T,E,S,w;for(T=0;T<C;++T)if(p[T]!==255){S=T/x|0;break}for(T=C-1;T>=0;--T)if(p[T]!==255){w=T/x|0;break}let D=-1;for(T=0;T<d&&D===-1;++T)for(E=0;E<h;++E){let I=T*4+E*x;if(p[I]!==255||p[I+1]!==255||p[I+2]!==255||p[I+3]!==255){D=T;break}}return{width:s.width,height:w-S,ascent:_-S,descent:w-_,minx:D-u/2}}return{width:s.width,height:0,ascent:0,descent:0,minx:0}}var fy;function Pke(t,n){if(t==="")return;n=A(n,A.EMPTY_OBJECT);let i=A(n.font,"10px sans-serif"),o=A(n.stroke,!1),r=A(n.fill,!0),s=A(n.strokeWidth,1),a=A(n.backgroundColor,z.TRANSPARENT),c=A(n.padding,0),l=c*2,u=document.createElement("canvas");u.width=1,u.height=1,u.style.font=i;let d=u.getContext("2d");f(fy)||(f(d.imageSmoothingEnabled)?fy="imageSmoothingEnabled":f(d.mozImageSmoothingEnabled)?fy="mozImageSmoothingEnabled":f(d.webkitImageSmoothingEnabled)?fy="webkitImageSmoothingEnabled":f(d.msImageSmoothingEnabled)&&(fy="msImageSmoothingEnabled")),d.font=i,d.lineJoin="round",d.lineWidth=s,d[fy]=!1,u.style.visibility="hidden",document.body.appendChild(u);let h=vke(d,t,i,o,r);u.dimensions=h,document.body.removeChild(u),u.style.visibility="";let _=-h.minx,y=Math.ceil(h.width)+_+l,p=h.height+l,C=p-h.ascent+c,x=p-C+l;if(u.width=y,u.height=p,d.font=i,d.lineJoin="round",d.lineWidth=s,d[fy]=!1,a!==z.TRANSPARENT&&(d.fillStyle=a.toCssColorString(),d.fillRect(0,0,u.width,u.height)),o){let T=A(n.strokeColor,z.BLACK);d.strokeStyle=T.toCssColorString(),d.strokeText(t,_+c,x)}if(r){let T=A(n.fillColor,z.WHITE);d.fillStyle=T.toCssColorString(),d.fillText(t,_+c,x)}return u}var Ox=Pke;var Fne=yo(Pne(),1);var Bke={FILL:0,OUTLINE:1,FILL_AND_OUTLINE:2},Lo=Object.freeze(Bke);var Ine={},Bne=0,Oke=256,Rke=new z(.165,.165,.165,.8),Mke=new W(7,5),qr=Object.freeze({LTR:0,RTL:1,WEAK:2,BRACKETS:3});function dy(t){!t._rebindAllGlyphs&&!t._repositionAllGlyphs&&t._labelCollection._labelsToUpdate.push(t),t._rebindAllGlyphs=!0}function $S(t){!t._rebindAllGlyphs&&!t._repositionAllGlyphs&&t._labelCollection._labelsToUpdate.push(t),t._repositionAllGlyphs=!0}function ew(t,n){return document.defaultView.getComputedStyle(t,null).getPropertyValue(n)}function Rne(t){let n=Ine[t._font];if(!f(n)){let i=document.createElement("div");i.style.position="absolute",i.style.opacity=0,i.style.font=t._font,document.body.appendChild(i);let o=parseFloat(ew(i,"line-height"));isNaN(o)&&(o=void 0),n={family:ew(i,"font-family"),size:ew(i,"font-size").replace("px",""),style:ew(i,"font-style"),weight:ew(i,"font-weight"),lineHeight:o},document.body.removeChild(i),Bne<Oke&&(Ine[t._font]=n,Bne++)}t._fontFamily=n.family,t._fontSize=n.size,t._fontStyle=n.style,t._fontWeight=n.weight,t._lineHeight=n.lineHeight}function Wm(t,n){t=A(t,A.EMPTY_OBJECT);let i=t.translucencyByDistance,o=t.pixelOffsetScaleByDistance,r=t.scaleByDistance,s=t.distanceDisplayCondition;f(i)&&(i=Pt.clone(i)),f(o)&&(o=Pt.clone(o)),f(r)&&(r=Pt.clone(r)),f(s)&&(s=wt.clone(s)),this._renderedText=void 0,this._text=void 0,this._show=A(t.show,!0),this._font=A(t.font,"30px sans-serif"),this._fillColor=z.clone(A(t.fillColor,z.WHITE)),this._outlineColor=z.clone(A(t.outlineColor,z.BLACK)),this._outlineWidth=A(t.outlineWidth,1),this._showBackground=A(t.showBackground,!1),this._backgroundColor=z.clone(A(t.backgroundColor,Rke)),this._backgroundPadding=W.clone(A(t.backgroundPadding,Mke)),this._style=A(t.style,Lo.FILL),this._verticalOrigin=A(t.verticalOrigin,vn.BASELINE),this._horizontalOrigin=A(t.horizontalOrigin,ui.LEFT),this._pixelOffset=W.clone(A(t.pixelOffset,W.ZERO)),this._eyeOffset=m.clone(A(t.eyeOffset,m.ZERO)),this._position=m.clone(A(t.position,m.ZERO)),this._scale=A(t.scale,1),this._id=t.id,this._translucencyByDistance=i,this._pixelOffsetScaleByDistance=o,this._scaleByDistance=r,this._heightReference=A(t.heightReference,Ge.NONE),this._distanceDisplayCondition=s,this._disableDepthTestDistance=t.disableDepthTestDistance,this._labelCollection=n,this._glyphs=[],this._backgroundBillboard=void 0,this._batchIndex=void 0,this._rebindAllGlyphs=!0,this._repositionAllGlyphs=!0,this._actualClampedPosition=void 0,this._removeCallbackFunc=void 0,this._mode=void 0,this._clusterShow=!0,this.text=A(t.text,""),this._relativeSize=1,Rne(this),this._updateClamping()}Object.defineProperties(Wm.prototype,{show:{get:function(){return this._show},set:function(t){if(this._show!==t){this._show=t;let n=this._glyphs;for(let o=0,r=n.length;o<r;o++){let s=n[o].billboard;f(s)&&(s.show=t)}let i=this._backgroundBillboard;f(i)&&(i.show=t)}}},position:{get:function(){return this._position},set:function(t){let n=this._position;if(!m.equals(n,t)){m.clone(t,n);let i=this._glyphs;for(let r=0,s=i.length;r<s;r++){let a=i[r].billboard;f(a)&&(a.position=t)}let o=this._backgroundBillboard;f(o)&&(o.position=t),this._updateClamping()}}},heightReference:{get:function(){return this._heightReference},set:function(t){if(t!==this._heightReference){this._heightReference=t;let n=this._glyphs;for(let o=0,r=n.length;o<r;o++){let s=n[o].billboard;f(s)&&(s.heightReference=t)}let i=this._backgroundBillboard;f(i)&&(i.heightReference=t),$S(this),this._updateClamping()}}},text:{get:function(){return this._text},set:function(t){if(this._text!==t){this._text=t;let n=t.replace(/\u00ad/g,"");this._renderedText=Wm.enableRightToLeftDetection?Uke(n):n,dy(this)}}},font:{get:function(){return this._font},set:function(t){this._font!==t&&(this._font=t,dy(this),Rne(this))}},fillColor:{get:function(){return this._fillColor},set:function(t){let n=this._fillColor;z.equals(n,t)||(z.clone(t,n),dy(this))}},outlineColor:{get:function(){return this._outlineColor},set:function(t){let n=this._outlineColor;z.equals(n,t)||(z.clone(t,n),dy(this))}},outlineWidth:{get:function(){return this._outlineWidth},set:function(t){this._outlineWidth!==t&&(this._outlineWidth=t,dy(this))}},showBackground:{get:function(){return this._showBackground},set:function(t){this._showBackground!==t&&(this._showBackground=t,dy(this))}},backgroundColor:{get:function(){return this._backgroundColor},set:function(t){let n=this._backgroundColor;if(!z.equals(n,t)){z.clone(t,n);let i=this._backgroundBillboard;f(i)&&(i.color=n)}}},backgroundPadding:{get:function(){return this._backgroundPadding},set:function(t){let n=this._backgroundPadding;W.equals(n,t)||(W.clone(t,n),$S(this))}},style:{get:function(){return this._style},set:function(t){this._style!==t&&(this._style=t,dy(this))}},pixelOffset:{get:function(){return this._pixelOffset},set:function(t){let n=this._pixelOffset;if(!W.equals(n,t)){W.clone(t,n);let i=this._glyphs;for(let r=0,s=i.length;r<s;r++){let a=i[r];f(a.billboard)&&(a.billboard.pixelOffset=t)}let o=this._backgroundBillboard;f(o)&&(o.pixelOffset=t)}}},translucencyByDistance:{get:function(){return this._translucencyByDistance},set:function(t){let n=this._translucencyByDistance;if(!Pt.equals(n,t)){this._translucencyByDistance=Pt.clone(t,n);let i=this._glyphs;for(let r=0,s=i.length;r<s;r++){let a=i[r];f(a.billboard)&&(a.billboard.translucencyByDistance=t)}let o=this._backgroundBillboard;f(o)&&(o.translucencyByDistance=t)}}},pixelOffsetScaleByDistance:{get:function(){return this._pixelOffsetScaleByDistance},set:function(t){let n=this._pixelOffsetScaleByDistance;if(!Pt.equals(n,t)){this._pixelOffsetScaleByDistance=Pt.clone(t,n);let i=this._glyphs;for(let r=0,s=i.length;r<s;r++){let a=i[r];f(a.billboard)&&(a.billboard.pixelOffsetScaleByDistance=t)}let o=this._backgroundBillboard;f(o)&&(o.pixelOffsetScaleByDistance=t)}}},scaleByDistance:{get:function(){return this._scaleByDistance},set:function(t){let n=this._scaleByDistance;if(!Pt.equals(n,t)){this._scaleByDistance=Pt.clone(t,n);let i=this._glyphs;for(let r=0,s=i.length;r<s;r++){let a=i[r];f(a.billboard)&&(a.billboard.scaleByDistance=t)}let o=this._backgroundBillboard;f(o)&&(o.scaleByDistance=t)}}},eyeOffset:{get:function(){return this._eyeOffset},set:function(t){let n=this._eyeOffset;if(!m.equals(n,t)){m.clone(t,n);let i=this._glyphs;for(let r=0,s=i.length;r<s;r++){let a=i[r];f(a.billboard)&&(a.billboard.eyeOffset=t)}let o=this._backgroundBillboard;f(o)&&(o.eyeOffset=t)}}},horizontalOrigin:{get:function(){return this._horizontalOrigin},set:function(t){this._horizontalOrigin!==t&&(this._horizontalOrigin=t,$S(this))}},verticalOrigin:{get:function(){return this._verticalOrigin},set:function(t){if(this._verticalOrigin!==t){this._verticalOrigin=t;let n=this._glyphs;for(let o=0,r=n.length;o<r;o++){let s=n[o];f(s.billboard)&&(s.billboard.verticalOrigin=t)}let i=this._backgroundBillboard;f(i)&&(i.verticalOrigin=t),$S(this)}}},scale:{get:function(){return this._scale},set:function(t){if(this._scale!==t){this._scale=t;let n=this._glyphs;for(let o=0,r=n.length;o<r;o++){let s=n[o];f(s.billboard)&&(s.billboard.scale=t*this._relativeSize)}let i=this._backgroundBillboard;f(i)&&(i.scale=t*this._relativeSize),$S(this)}}},totalScale:{get:function(){return this._scale*this._relativeSize}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(t){if(!wt.equals(t,this._distanceDisplayCondition)){this._distanceDisplayCondition=wt.clone(t,this._distanceDisplayCondition);let n=this._glyphs;for(let o=0,r=n.length;o<r;o++){let s=n[o];f(s.billboard)&&(s.billboard.distanceDisplayCondition=t)}let i=this._backgroundBillboard;f(i)&&(i.distanceDisplayCondition=t)}}},disableDepthTestDistance:{get:function(){return this._disableDepthTestDistance},set:function(t){if(this._disableDepthTestDistance!==t){this._disableDepthTestDistance=t;let n=this._glyphs;for(let o=0,r=n.length;o<r;o++){let s=n[o];f(s.billboard)&&(s.billboard.disableDepthTestDistance=t)}let i=this._backgroundBillboard;f(i)&&(i.disableDepthTestDistance=t)}}},id:{get:function(){return this._id},set:function(t){if(this._id!==t){this._id=t;let n=this._glyphs;for(let o=0,r=n.length;o<r;o++){let s=n[o];f(s.billboard)&&(s.billboard.id=t)}let i=this._backgroundBillboard;f(i)&&(i.id=t)}}},pickId:{get:function(){if(!(this._glyphs.length===0||!f(this._glyphs[0].billboard)))return this._glyphs[0].billboard.pickId}},_clampedPosition:{get:function(){return this._actualClampedPosition},set:function(t){this._actualClampedPosition=m.clone(t,this._actualClampedPosition);let n=this._glyphs;for(let o=0,r=n.length;o<r;o++){let s=n[o];f(s.billboard)&&(s.billboard._clampedPosition=t)}let i=this._backgroundBillboard;f(i)&&(i._clampedPosition=t)}},clusterShow:{get:function(){return this._clusterShow},set:function(t){if(this._clusterShow!==t){this._clusterShow=t;let n=this._glyphs;for(let o=0,r=n.length;o<r;o++){let s=n[o];f(s.billboard)&&(s.billboard.clusterShow=t)}let i=this._backgroundBillboard;f(i)&&(i.clusterShow=t)}}}});Wm.prototype._updateClamping=function(){ho._updateClamping(this._labelCollection,this)};Wm.prototype.computeScreenSpacePosition=function(t,n){f(n)||(n=new W);let o=this._labelCollection.modelMatrix,r=f(this._actualClampedPosition)?this._actualClampedPosition:this._position;return ho._computeScreenSpacePosition(o,r,this._eyeOffset,this._pixelOffset,t,n)};Wm.getScreenSpaceBoundingBox=function(t,n,i){let o=0,r=0,s=0,a=0,c=t.totalScale,l=t._backgroundBillboard;if(f(l))o=n.x+l._translate.x,r=n.y-l._translate.y,s=l.width*c,a=l.height*c,t.verticalOrigin===vn.BOTTOM||t.verticalOrigin===vn.BASELINE?r-=a:t.verticalOrigin===vn.CENTER&&(r-=a*.5);else{o=Number.POSITIVE_INFINITY,r=Number.POSITIVE_INFINITY;let u=0,d=0,h=t._glyphs,_=h.length;for(let y=0;y<_;++y){let p=h[y],C=p.billboard;if(!f(C))continue;let x=n.x+C._translate.x,T=n.y-C._translate.y,E=p.dimensions.width*c,S=p.dimensions.height*c;t.verticalOrigin===vn.BOTTOM||t.verticalOrigin===vn.BASELINE?T-=S:t.verticalOrigin===vn.CENTER&&(T-=S*.5),t._verticalOrigin===vn.TOP?T+=Is.PADDING*c:(t._verticalOrigin===vn.BOTTOM||t._verticalOrigin===vn.BASELINE)&&(T-=Is.PADDING*c),o=Math.min(o,x),r=Math.min(r,T),u=Math.max(u,x+E),d=Math.max(d,T+S)}s=u-o,a=d-r}return f(i)||(i=new He),i.x=o,i.y=r,i.width=s,i.height=a,i};Wm.prototype.equals=function(t){return this===t||f(t)&&this._show===t._show&&this._scale===t._scale&&this._outlineWidth===t._outlineWidth&&this._showBackground===t._showBackground&&this._style===t._style&&this._verticalOrigin===t._verticalOrigin&&this._horizontalOrigin===t._horizontalOrigin&&this._heightReference===t._heightReference&&this._renderedText===t._renderedText&&this._font===t._font&&m.equals(this._position,t._position)&&z.equals(this._fillColor,t._fillColor)&&z.equals(this._outlineColor,t._outlineColor)&&z.equals(this._backgroundColor,t._backgroundColor)&&W.equals(this._backgroundPadding,t._backgroundPadding)&&W.equals(this._pixelOffset,t._pixelOffset)&&m.equals(this._eyeOffset,t._eyeOffset)&&Pt.equals(this._translucencyByDistance,t._translucencyByDistance)&&Pt.equals(this._pixelOffsetScaleByDistance,t._pixelOffsetScaleByDistance)&&Pt.equals(this._scaleByDistance,t._scaleByDistance)&&wt.equals(this._distanceDisplayCondition,t._distanceDisplayCondition)&&this._disableDepthTestDistance===t._disableDepthTestDistance&&this._id===t._id};Wm.prototype.isDestroyed=function(){return!1};Wm.enableRightToLeftDetection=!1;function Lke(t,n){let i=/[a-zA-Z0-9]/,o=/[()[\]{}<>]/,r=[],s="",a=qr.LTR,c="",l=t.length;for(let u=0;u<l;++u){let d=t.charAt(u);n.test(d)?c=qr.RTL:i.test(d)?c=qr.LTR:o.test(d)?c=qr.BRACKETS:c=qr.WEAK,u===0&&(a=c),a===c&&c!==qr.BRACKETS?s+=d:(s!==""&&r.push({Type:a,Word:s}),a=c,s=d)}return r.push({Type:c,Word:s}),r}function Fke(t){return t.split("").reverse().join("")}function tw(t,n,i){return t.slice(0,n)+i+t.slice(n)}function Nke(t){switch(t){case"(":return")";case")":return"(";case"[":return"]";case"]":return"[";case"{":return"}";case"}":return"{";case"<":return">";case">":return"<"}}var Vke="\u05D0-\u05EA",kke="\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF",One=new RegExp(`[${Vke}${kke}]`);function Uke(t){let n=t.split(`
`),i="";for(let o=0;o<n.length;o++){let r=n[o],s=One.test(r.charAt(0)),a=Lke(r,One),c=0,l="";for(let u=0;u<a.length;++u){let d=a[u],h=d.Type===qr.BRACKETS?Nke(d.Word):Fke(d.Word);s?d.Type===qr.RTL?(l=h+l,c=0):d.Type===qr.LTR?(l=tw(l,c,d.Word),c+=d.Word.length):(d.Type===qr.WEAK||d.Type===qr.BRACKETS)&&(d.Type===qr.WEAK&&a[u-1].Type===qr.BRACKETS?l=h+l:a[u-1].Type===qr.RTL?(l=h+l,c=0):a.length>u+1?a[u+1].Type===qr.RTL?(l=h+l,c=0):(l=tw(l,c,d.Word),c+=d.Word.length):l=tw(l,0,h)):d.Type===qr.RTL?l=tw(l,c,h):d.Type===qr.LTR?(l+=d.Word,c=l.length):(d.Type===qr.WEAK||d.Type===qr.BRACKETS)&&(u>0&&a[u-1].Type===qr.RTL?a.length>u+1?a[u+1].Type===qr.RTL?l=tw(l,c,h):(l+=d.Word,c=l.length):l+=d.Word:(l+=d.Word,c=l.length))}i+=l,o<n.length-1&&(i+=`
`)}return i}var hy=Wm;var Nne=yo(Mne(),1);function Hke(){this.textureInfo=void 0,this.dimensions=void 0,this.billboard=void 0}function Gke(t,n,i){this.labelCollection=t,this.index=n,this.dimensions=i}var Wke=1.2,Vne="ID_WHITE_PIXEL",g5=new W(4,4),jke=new He(1,1,1,1);function qke(t){let n=document.createElement("canvas");n.width=g5.x,n.height=g5.y;let i=n.getContext("2d");i.fillStyle="#fff",i.fillRect(0,0,n.width,n.height),t.addImage(Vne,n)}var Pu={};function Yke(t,n,i,o,r,s,a){return Pu.font=n,Pu.fillColor=i,Pu.strokeColor=o,Pu.strokeWidth=r,Pu.padding=Is.PADDING,a===vn.CENTER?Pu.textBaseline="middle":a===vn.TOP?Pu.textBaseline="top":Pu.textBaseline="bottom",Pu.fill=s===Lo.FILL||s===Lo.FILL_AND_OUTLINE,Pu.stroke=s===Lo.OUTLINE||s===Lo.FILL_AND_OUTLINE,Pu.backgroundColor=z.BLACK,Ox(t,Pu)}function y5(t,n){n.textureInfo=void 0,n.dimensions=void 0;let i=n.billboard;f(i)&&(i.show=!1,i.image=void 0,f(i._removeCallbackFunc)&&(i._removeCallbackFunc(),i._removeCallbackFunc=void 0),t._spareBillboards.push(i),n.billboard=void 0)}function Xke(t,n,i,o){o.index=t.addImageSync(n,i)}var Kke=new Nne.default;function Jke(t,n){let i=n._renderedText,o=Kke.splitGraphemes(i),r=o.length,s=n._glyphs,a=s.length,c,l,u;if(n._relativeSize=n._fontSize/Is.FONT_SIZE,r<a)for(l=r;l<a;++l)y5(t,s[l]);s.length=r;let d=n._showBackground&&i.split(`
`).join("").length>0,h=n._backgroundBillboard,_=t._backgroundBillboardCollection;d?(f(h)||(h=_.add({collection:t,image:Vne,imageSubRegion:jke}),n._backgroundBillboard=h),h.color=n._backgroundColor,h.show=n._show,h.position=n._position,h.eyeOffset=n._eyeOffset,h.pixelOffset=n._pixelOffset,h.horizontalOrigin=ui.LEFT,h.verticalOrigin=n._verticalOrigin,h.heightReference=n._heightReference,h.scale=n.totalScale,h.pickPrimitive=n,h.id=n._id,h.translucencyByDistance=n._translucencyByDistance,h.pixelOffsetScaleByDistance=n._pixelOffsetScaleByDistance,h.scaleByDistance=n._scaleByDistance,h.distanceDisplayCondition=n._distanceDisplayCondition,h.disableDepthTestDistance=n._disableDepthTestDistance):f(h)&&(_.remove(h),n._backgroundBillboard=h=void 0);let y=t._glyphTextureCache;for(u=0;u<r;++u){let p=o[u],C=n._verticalOrigin,x=JSON.stringify([p,n._fontFamily,n._fontStyle,n._fontWeight,+C]),T=y[x];if(!f(T)){let E=`${n._fontStyle} ${n._fontWeight} ${Is.FONT_SIZE}px ${n._fontFamily}`,S=Yke(p,E,z.WHITE,z.WHITE,0,Lo.FILL,C);if(T=new Gke(t,-1,S.dimensions),y[x]=T,S.width>0&&S.height>0){let w=(0,Fne.default)(S,{cutoff:Is.CUTOFF,radius:Is.RADIUS}),D=S.getContext("2d"),I=S.width,O=S.height,M=D.getImageData(0,0,I,O);for(let L=0;L<I;L++)for(let F=0;F<O;F++){let g=F*I+L,b=w[g]*255,v=g*4;M.data[v+0]=b,M.data[v+1]=b,M.data[v+2]=b,M.data[v+3]=b}D.putImageData(M,0,0),p!==" "&&Xke(t._textureAtlas,x,S,T)}}if(c=s[u],f(c)?T.index===-1?y5(t,c):f(c.textureInfo)&&(c.textureInfo=void 0):(c=new Hke,s[u]=c),c.textureInfo=T,c.dimensions=T.dimensions,T.index!==-1){let E=c.billboard,S=t._spareBillboards;f(E)||(S.length>0?E=S.pop():(E=t._billboardCollection.add({collection:t}),E._labelDimensions=new W,E._labelTranslate=new W),c.billboard=E),E.show=n._show,E.position=n._position,E.eyeOffset=n._eyeOffset,E.pixelOffset=n._pixelOffset,E.horizontalOrigin=ui.LEFT,E.verticalOrigin=n._verticalOrigin,E.heightReference=n._heightReference,E.scale=n.totalScale,E.pickPrimitive=n,E.id=n._id,E.image=x,E.translucencyByDistance=n._translucencyByDistance,E.pixelOffsetScaleByDistance=n._pixelOffsetScaleByDistance,E.scaleByDistance=n._scaleByDistance,E.distanceDisplayCondition=n._distanceDisplayCondition,E.disableDepthTestDistance=n._disableDepthTestDistance,E._batchIndex=n._batchIndex,E.outlineColor=n.outlineColor,n.style===Lo.FILL_AND_OUTLINE?(E.color=n._fillColor,E.outlineWidth=n.outlineWidth):n.style===Lo.FILL?(E.color=n._fillColor,E.outlineWidth=0):n.style===Lo.OUTLINE&&(E.color=z.TRANSPARENT,E.outlineWidth=n.outlineWidth)}}n._repositionAllGlyphs=!0}function Lne(t,n,i){return n===ui.CENTER?-t/2:n===ui.RIGHT?-(t+i.x):i.x}var $o=new W,Zke=new W;function Qke(t){let n=t._glyphs,i=t._renderedText,o,r,s=0,a=0,c=[],l=Number.NEGATIVE_INFINITY,u=0,d=1,h,_=n.length,y=t._backgroundBillboard,p=W.clone(f(y)?t._backgroundPadding:W.ZERO,Zke);for(p.x/=t._relativeSize,p.y/=t._relativeSize,h=0;h<_;++h)i.charAt(h)===`
`?(c.push(s),++d,s=0):(o=n[h],r=o.dimensions,u=Math.max(u,r.height-r.descent),l=Math.max(l,r.descent),s+=r.width-r.minx,h<_-1&&(s+=n[h+1].dimensions.minx),a=Math.max(a,s));c.push(s);let C=u+l,x=t.totalScale,T=t._horizontalOrigin,E=t._verticalOrigin,S=0,w=c[S],D=Lne(w,T,p),I=(f(t._lineHeight)?t._lineHeight:Wke*t._fontSize)/t._relativeSize,O=I*(d-1),M=a,L=C+O;f(y)&&(M+=p.x*2,L+=p.y*2,y._labelHorizontalOrigin=T),$o.x=D*x,$o.y=0;let F=!0,g=0;for(h=0;h<_;++h)if(i.charAt(h)===`
`)++S,g+=I,w=c[S],D=Lne(w,T,p),$o.x=D*x,F=!0;else if(o=n[h],r=o.dimensions,E===vn.TOP?($o.y=r.height-u-p.y,$o.y+=Is.PADDING):E===vn.CENTER?$o.y=(O+r.height-u)/2:E===vn.BASELINE?($o.y=O,$o.y-=Is.PADDING):($o.y=O+l+p.y,$o.y-=Is.PADDING),$o.y=($o.y-r.descent-g)*x,F&&($o.x-=Is.PADDING*x,F=!1),f(o.billboard)&&(o.billboard._setTranslate($o),o.billboard._labelDimensions.x=M,o.billboard._labelDimensions.y=L,o.billboard._labelHorizontalOrigin=T),h<_-1){let b=n[h+1];$o.x+=(r.width-r.minx+b.dimensions.minx)*x}if(f(y)&&i.split(`
`).join("").length>0&&(T===ui.CENTER?D=-a/2-p.x:T===ui.RIGHT?D=-(a+p.x*2):D=0,$o.x=D*x,E===vn.TOP?$o.y=C-u-l:E===vn.CENTER?$o.y=(C-u)/2-l:E===vn.BASELINE?$o.y=-p.y-l:$o.y=0,$o.y=$o.y*x,y.width=M,y.height=L,y._setTranslate($o),y._labelTranslate=W.clone($o,y._labelTranslate)),t.heightReference===Ge.CLAMP_TO_GROUND)for(h=0;h<_;++h){o=n[h];let b=o.billboard;f(b)&&(b._labelTranslate=W.clone($o,b._labelTranslate))}}function kne(t,n){let i=n._glyphs;for(let o=0,r=i.length;o<r;++o)y5(t,i[o]);f(n._backgroundBillboard)&&(t._backgroundBillboardCollection.remove(n._backgroundBillboard),n._backgroundBillboard=void 0),n._labelCollection=void 0,f(n._removeCallbackFunc)&&n._removeCallbackFunc(),ue(n)}function ch(t){t=A(t,A.EMPTY_OBJECT),this._scene=t.scene,this._batchTable=t.batchTable,this._textureAtlas=void 0,this._backgroundTextureAtlas=void 0,this._backgroundBillboardCollection=new vu({scene:this._scene}),this._backgroundBillboardCollection.destroyTextureAtlas=!1,this._billboardCollection=new vu({scene:this._scene,batchTable:this._batchTable}),this._billboardCollection.destroyTextureAtlas=!1,this._billboardCollection._sdf=!0,this._spareBillboards=[],this._glyphTextureCache={},this._labels=[],this._labelsToUpdate=[],this._totalGlyphCount=0,this._highlightColor=z.clone(z.WHITE),this.show=A(t.show,!0),this.modelMatrix=N.clone(A(t.modelMatrix,N.IDENTITY)),this.debugShowBoundingVolume=A(t.debugShowBoundingVolume,!1),this.blendOption=A(t.blendOption,bo.OPAQUE_AND_TRANSLUCENT)}Object.defineProperties(ch.prototype,{length:{get:function(){return this._labels.length}}});ch.prototype.add=function(t){let n=new hy(t,this);return this._labels.push(n),this._labelsToUpdate.push(n),n};ch.prototype.remove=function(t){if(f(t)&&t._labelCollection===this){let n=this._labels.indexOf(t);if(n!==-1)return this._labels.splice(n,1),kne(this,t),!0}return!1};ch.prototype.removeAll=function(){let t=this._labels;for(let n=0,i=t.length;n<i;++n)kne(this,t[n]);t.length=0};ch.prototype.contains=function(t){return f(t)&&t._labelCollection===this};ch.prototype.get=function(t){return this._labels[t]};ch.prototype.update=function(t){if(!this.show)return;let n=this._billboardCollection,i=this._backgroundBillboardCollection;n.modelMatrix=this.modelMatrix,n.debugShowBoundingVolume=this.debugShowBoundingVolume,i.modelMatrix=this.modelMatrix,i.debugShowBoundingVolume=this.debugShowBoundingVolume;let o=t.context;f(this._textureAtlas)||(this._textureAtlas=new uy({context:o}),n.textureAtlas=this._textureAtlas),f(this._backgroundTextureAtlas)||(this._backgroundTextureAtlas=new uy({context:o,initialSize:g5}),i.textureAtlas=this._backgroundTextureAtlas,qke(this._backgroundTextureAtlas));let r=this._labelsToUpdate.length;for(let a=0;a<r;++a){let c=this._labelsToUpdate[a];if(c.isDestroyed())continue;let l=c._glyphs.length;c._rebindAllGlyphs&&(Jke(this,c),c._rebindAllGlyphs=!1),c._repositionAllGlyphs&&(Qke(c),c._repositionAllGlyphs=!1);let u=c._glyphs.length-l;this._totalGlyphCount+=u}let s=i.length>0?bo.TRANSLUCENT:this.blendOption;n.blendOption=s,i.blendOption=s,n._highlightColor=this._highlightColor,i._highlightColor=this._highlightColor,this._labelsToUpdate.length=0,i.update(t),n.update(t)};ch.prototype.isDestroyed=function(){return!1};ch.prototype.destroy=function(){return this.removeAll(),this._billboardCollection=this._billboardCollection.destroy(),this._textureAtlas=this._textureAtlas&&this._textureAtlas.destroy(),this._backgroundBillboardCollection=this._backgroundBillboardCollection.destroy(),this._backgroundTextureAtlas=this._backgroundTextureAtlas&&this._backgroundTextureAtlas.destroy(),ue(this)};var jm=ch;var JL=`attribute vec3 position3DHigh;
attribute vec3 position3DLow;
attribute vec3 position2DHigh;
attribute vec3 position2DLow;
attribute vec3 prevPosition3DHigh;
attribute vec3 prevPosition3DLow;
attribute vec3 prevPosition2DHigh;
attribute vec3 prevPosition2DLow;
attribute vec3 nextPosition3DHigh;
attribute vec3 nextPosition3DLow;
attribute vec3 nextPosition2DHigh;
attribute vec3 nextPosition2DLow;
attribute vec4 texCoordExpandAndBatchIndex;
varying vec2  v_st;
varying float v_width;
varying vec4 v_pickColor;
varying float v_polylineAngle;
void main()
{
float texCoord = texCoordExpandAndBatchIndex.x;
float expandDir = texCoordExpandAndBatchIndex.y;
bool usePrev = texCoordExpandAndBatchIndex.z < 0.0;
float batchTableIndex = texCoordExpandAndBatchIndex.w;
vec2 widthAndShow = batchTable_getWidthAndShow(batchTableIndex);
float width = widthAndShow.x + 0.5;
float show = widthAndShow.y;
if (width < 1.0)
{
show = 0.0;
}
vec4 pickColor = batchTable_getPickColor(batchTableIndex);
vec4 p, prev, next;
if (czm_morphTime == 1.0)
{
p = czm_translateRelativeToEye(position3DHigh.xyz, position3DLow.xyz);
prev = czm_translateRelativeToEye(prevPosition3DHigh.xyz, prevPosition3DLow.xyz);
next = czm_translateRelativeToEye(nextPosition3DHigh.xyz, nextPosition3DLow.xyz);
}
else if (czm_morphTime == 0.0)
{
p = czm_translateRelativeToEye(position2DHigh.zxy, position2DLow.zxy);
prev = czm_translateRelativeToEye(prevPosition2DHigh.zxy, prevPosition2DLow.zxy);
next = czm_translateRelativeToEye(nextPosition2DHigh.zxy, nextPosition2DLow.zxy);
}
else
{
p = czm_columbusViewMorph(
czm_translateRelativeToEye(position2DHigh.zxy, position2DLow.zxy),
czm_translateRelativeToEye(position3DHigh.xyz, position3DLow.xyz),
czm_morphTime);
prev = czm_columbusViewMorph(
czm_translateRelativeToEye(prevPosition2DHigh.zxy, prevPosition2DLow.zxy),
czm_translateRelativeToEye(prevPosition3DHigh.xyz, prevPosition3DLow.xyz),
czm_morphTime);
next = czm_columbusViewMorph(
czm_translateRelativeToEye(nextPosition2DHigh.zxy, nextPosition2DLow.zxy),
czm_translateRelativeToEye(nextPosition3DHigh.xyz, nextPosition3DLow.xyz),
czm_morphTime);
}
#ifdef DISTANCE_DISPLAY_CONDITION
vec3 centerHigh = batchTable_getCenterHigh(batchTableIndex);
vec4 centerLowAndRadius = batchTable_getCenterLowAndRadius(batchTableIndex);
vec3 centerLow = centerLowAndRadius.xyz;
float radius = centerLowAndRadius.w;
vec2 distanceDisplayCondition = batchTable_getDistanceDisplayCondition(batchTableIndex);
float lengthSq;
if (czm_sceneMode == czm_sceneMode2D)
{
lengthSq = czm_eyeHeight2D.y;
}
else
{
vec4 center = czm_translateRelativeToEye(centerHigh.xyz, centerLow.xyz);
lengthSq = max(0.0, dot(center.xyz, center.xyz) - radius * radius);
}
float nearSq = distanceDisplayCondition.x * distanceDisplayCondition.x;
float farSq = distanceDisplayCondition.y * distanceDisplayCondition.y;
if (lengthSq < nearSq || lengthSq > farSq)
{
show = 0.0;
}
#endif
float polylineAngle;
vec4 positionWC = getPolylineWindowCoordinates(p, prev, next, expandDir, width, usePrev, polylineAngle);
gl_Position = czm_viewportOrthographic * positionWC * show;
v_st.s = texCoord;
v_st.t = czm_writeNonPerspective(clamp(expandDir, 0.0, 1.0), gl_Position.w);
v_width = width;
v_pickColor = pickColor;
v_polylineAngle = polylineAngle;
}
`;var mc={};mc.numberOfPoints=function(t,n,i){let o=m.distance(t,n);return Math.ceil(o/i)};mc.numberOfPointsRhumbLine=function(t,n,i){let o=Math.pow(t.longitude-n.longitude,2)+Math.pow(t.latitude-n.latitude,2);return Math.max(1,Math.ceil(Math.sqrt(o/(i*i))))};var $ke=new de;mc.extractHeights=function(t,n){let i=t.length,o=new Array(i);for(let r=0;r<i;r++){let s=t[r];o[r]=n.cartesianToCartographic(s,$ke).height}return o};var eUe=new N,tUe=new m,Une=new m,nUe=new rn(m.UNIT_X,0),zne=new m,iUe=new rn(m.UNIT_X,0),oUe=new m,rUe=new m,C5=[];function Gne(t,n,i){let o=C5;o.length=t;let r;if(n===i){for(r=0;r<t;r++)o[r]=n;return o}let a=(i-n)/t;for(r=0;r<t;r++){let c=n+r*a;o[r]=c}return o}var QL=new de,ZL=new de,R_=new m,x5=new m,sUe=new m,A5=new Of,nw=new Ia;function aUe(t,n,i,o,r,s,a,c){let l=o.scaleToGeodeticSurface(t,x5),u=o.scaleToGeodeticSurface(n,sUe),d=mc.numberOfPoints(t,n,i),h=o.cartesianToCartographic(l,QL),_=o.cartesianToCartographic(u,ZL),y=Gne(d,r,s);A5.setEndPoints(h,_);let p=A5.surfaceDistance/d,C=c;h.height=r;let x=o.cartographicToCartesian(h,R_);m.pack(x,a,C),C+=3;for(let T=1;T<d;T++){let E=A5.interpolateUsingSurfaceDistance(T*p,ZL);E.height=y[T],x=o.cartographicToCartesian(E,R_),m.pack(x,a,C),C+=3}return C}function cUe(t,n,i,o,r,s,a,c){let l=o.cartesianToCartographic(t,QL),u=o.cartesianToCartographic(n,ZL),d=mc.numberOfPointsRhumbLine(l,u,i);l.height=0,u.height=0;let h=Gne(d,r,s);nw.ellipsoid.equals(o)||(nw=new Ia(void 0,void 0,o)),nw.setEndPoints(l,u);let _=nw.surfaceDistance/d,y=c;l.height=r;let p=o.cartographicToCartesian(l,R_);m.pack(p,a,y),y+=3;for(let C=1;C<d;C++){let x=nw.interpolateUsingSurfaceDistance(C*_,ZL);x.height=h[C],p=o.cartographicToCartesian(x,R_),m.pack(p,a,y),y+=3}return y}mc.wrapLongitude=function(t,n){let i=[],o=[];if(f(t)&&t.length>0){n=A(n,N.IDENTITY);let r=N.inverseTransformation(n,eUe),s=N.multiplyByPoint(r,m.ZERO,tUe),a=m.normalize(N.multiplyByPointAsVector(r,m.UNIT_Y,Une),Une),c=rn.fromPointNormal(s,a,nUe),l=m.normalize(N.multiplyByPointAsVector(r,m.UNIT_X,zne),zne),u=rn.fromPointNormal(s,l,iUe),d=1;i.push(m.clone(t[0]));let h=i[0],_=t.length;for(let y=1;y<_;++y){let p=t[y];if(rn.getPointDistance(u,h)<0||rn.getPointDistance(u,p)<0){let C=ji.lineSegmentPlane(h,p,c,oUe);if(f(C)){let x=m.multiplyByScalar(a,5e-9,rUe);rn.getPointDistance(c,h)<0&&m.negate(x,x),i.push(m.add(C,x,new m)),o.push(d+1),m.negate(x,x),i.push(m.add(C,x,new m)),d=1}}i.push(m.clone(t[y])),d++,h=p}o.push(d)}return{positions:i,lengths:o}};mc.generateArc=function(t){f(t)||(t={});let n=t.positions,i=n.length,o=A(t.ellipsoid,oe.WGS84),r=A(t.height,0),s=Array.isArray(r);if(i<1)return[];if(i===1){let C=o.scaleToGeodeticSurface(n[0],x5);if(r=s?r[0]:r,r!==0){let x=o.geodeticSurfaceNormal(C,R_);m.multiplyByScalar(x,r,x),m.add(C,x,C)}return[C.x,C.y,C.z]}let a=t.minDistance;if(!f(a)){let C=A(t.granularity,B.RADIANS_PER_DEGREE);a=B.chordLength(C,o.maximumRadius)}let c=0,l;for(l=0;l<i-1;l++)c+=mc.numberOfPoints(n[l],n[l+1],a);let u=(c+1)*3,d=new Array(u),h=0;for(l=0;l<i-1;l++){let C=n[l],x=n[l+1],T=s?r[l]:r,E=s?r[l+1]:r;h=aUe(C,x,a,o,T,E,d,h)}C5.length=0;let _=n[i-1],y=o.cartesianToCartographic(_,QL);y.height=s?r[i-1]:r;let p=o.cartographicToCartesian(y,R_);return m.pack(p,d,u-3),d};var Hne=new de,lUe=new de;mc.generateRhumbArc=function(t){f(t)||(t={});let n=t.positions,i=n.length,o=A(t.ellipsoid,oe.WGS84),r=A(t.height,0),s=Array.isArray(r);if(i<1)return[];if(i===1){let T=o.scaleToGeodeticSurface(n[0],x5);if(r=s?r[0]:r,r!==0){let E=o.geodeticSurfaceNormal(T,R_);m.multiplyByScalar(E,r,E),m.add(T,E,T)}return[T.x,T.y,T.z]}let a=A(t.granularity,B.RADIANS_PER_DEGREE),c=0,l,u=o.cartesianToCartographic(n[0],Hne),d;for(l=0;l<i-1;l++)d=o.cartesianToCartographic(n[l+1],lUe),c+=mc.numberOfPointsRhumbLine(u,d,a),u=de.clone(d,Hne);let h=(c+1)*3,_=new Array(h),y=0;for(l=0;l<i-1;l++){let T=n[l],E=n[l+1],S=s?r[l]:r,w=s?r[l+1]:r;y=cUe(T,E,a,o,S,w,_,y)}C5.length=0;let p=n[i-1],C=o.cartesianToCartographic(p,QL);C.height=s?r[i-1]:r;let x=o.cartographicToCartesian(C,R_);return m.pack(x,_,h-3),_};mc.generateCartesianArc=function(t){let n=mc.generateArc(t),i=n.length/3,o=new Array(i);for(let r=0;r<i;r++)o[r]=m.unpack(n,r*3);return o};mc.generateCartesianRhumbArc=function(t){let n=mc.generateRhumbArc(t),i=n.length/3,o=new Array(i);for(let r=0;r<i;r++)o[r]=m.unpack(n,r*3);return o};var Si=mc;function Rl(t,n){t=A(t,A.EMPTY_OBJECT),this._show=A(t.show,!0),this._width=A(t.width,1),this._loop=A(t.loop,!1),this._distanceDisplayCondition=t.distanceDisplayCondition,this._material=t.material,f(this._material)||(this._material=$i.fromType($i.ColorType,{color:new z(1,1,1,1)}));let i=t.positions;f(i)||(i=[]),this._positions=i,this._actualPositions=Co(i,m.equalsEpsilon),this._loop&&this._actualPositions.length>2&&(this._actualPositions===this._positions&&(this._actualPositions=i.slice()),this._actualPositions.push(m.clone(this._actualPositions[0]))),this._length=this._actualPositions.length,this._id=t.id;let o;f(n)&&(o=N.clone(n.modelMatrix)),this._modelMatrix=o,this._segments=Si.wrapLongitude(this._actualPositions,o),this._actualLength=void 0,this._propertiesChanged=new Uint32Array(jne),this._polylineCollection=n,this._dirty=!1,this._pickId=void 0,this._boundingVolume=ae.fromPoints(this._actualPositions),this._boundingVolumeWC=ae.transform(this._boundingVolume,this._modelMatrix),this._boundingVolume2D=new ae}var Wne=Rl.POSITION_INDEX=0,uUe=Rl.SHOW_INDEX=1,fUe=Rl.WIDTH_INDEX=2,dUe=Rl.MATERIAL_INDEX=3,iw=Rl.POSITION_SIZE_INDEX=4,hUe=Rl.DISTANCE_DISPLAY_CONDITION=5,jne=Rl.NUMBER_OF_PROPERTIES=6;function qm(t,n){++t._propertiesChanged[n];let i=t._polylineCollection;f(i)&&(i._updatePolyline(t,n),t._dirty=!0)}Object.defineProperties(Rl.prototype,{show:{get:function(){return this._show},set:function(t){t!==this._show&&(this._show=t,qm(this,uUe))}},positions:{get:function(){return this._positions},set:function(t){let n=Co(t,m.equalsEpsilon);this._loop&&n.length>2&&(n===t&&(n=t.slice()),n.push(m.clone(n[0]))),(this._actualPositions.length!==n.length||this._actualPositions.length!==this._length)&&qm(this,iw),this._positions=t,this._actualPositions=n,this._length=n.length,this._boundingVolume=ae.fromPoints(this._actualPositions,this._boundingVolume),this._boundingVolumeWC=ae.transform(this._boundingVolume,this._modelMatrix,this._boundingVolumeWC),qm(this,Wne),this.update()}},material:{get:function(){return this._material},set:function(t){this._material!==t&&(this._material=t,qm(this,dUe))}},width:{get:function(){return this._width},set:function(t){let n=this._width;t!==n&&(this._width=t,qm(this,fUe))}},loop:{get:function(){return this._loop},set:function(t){if(t!==this._loop){let n=this._actualPositions;t?n.length>2&&!m.equals(n[0],n[n.length-1])&&(n.length===this._positions.length&&(this._actualPositions=n=this._positions.slice()),n.push(m.clone(n[0]))):n.length>2&&m.equals(n[0],n[n.length-1])&&(n.length-1===this._positions.length?this._actualPositions=this._positions:n.pop()),this._loop=t,qm(this,iw)}}},id:{get:function(){return this._id},set:function(t){this._id=t,f(this._pickId)&&(this._pickId.object.id=t)}},pickId:{get:function(){return this._pickId}},isDestroyed:{get:function(){return!f(this._polylineCollection)}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(t){wt.equals(t,this._distanceDisplayCondition)||(this._distanceDisplayCondition=wt.clone(t,this._distanceDisplayCondition),qm(this,hUe))}}});Rl.prototype.update=function(){let t=N.IDENTITY;f(this._polylineCollection)&&(t=this._polylineCollection.modelMatrix);let n=this._segments.positions.length,i=this._segments.lengths,o=this._propertiesChanged[Wne]>0||this._propertiesChanged[iw]>0;if((!N.equals(t,this._modelMatrix)||o)&&(this._segments=Si.wrapLongitude(this._actualPositions,t),this._boundingVolumeWC=ae.transform(this._boundingVolume,t,this._boundingVolumeWC)),this._modelMatrix=N.clone(t,this._modelMatrix),this._segments.positions.length!==n)qm(this,iw);else{let r=i.length;for(let s=0;s<r;++s)if(i[s]!==this._segments.lengths[s]){qm(this,iw);break}}};Rl.prototype.getPickId=function(t){return f(this._pickId)||(this._pickId=t.createPickId({primitive:this,collection:this._polylineCollection,id:this._id})),this._pickId};Rl.prototype._clean=function(){this._dirty=!1;let t=this._propertiesChanged;for(let n=0;n<jne-1;++n)t[n]=0};Rl.prototype._destroy=function(){this._pickId=this._pickId&&this._pickId.destroy(),this._material=this._material&&this._material.destroy(),this._polylineCollection=void 0};var Lf=Rl;var mUe=Lf.SHOW_INDEX,pUe=Lf.WIDTH_INDEX,E5=Lf.POSITION_INDEX,_Ue=Lf.MATERIAL_INDEX,qne=Lf.POSITION_SIZE_INDEX,gUe=Lf.DISTANCE_DISPLAY_CONDITION,$ne=Lf.NUMBER_OF_PROPERTIES,Qc={texCoordExpandAndBatchIndex:0,position3DHigh:1,position3DLow:2,position2DHigh:3,position2DLow:4,prevPosition3DHigh:5,prevPosition3DLow:6,prevPosition2DHigh:7,prevPosition2DLow:8,nextPosition3DHigh:9,nextPosition3DLow:10,nextPosition2DHigh:11,nextPosition2DLow:12};function Ff(t){t=A(t,A.EMPTY_OBJECT),this.show=A(t.show,!0),this.modelMatrix=N.clone(A(t.modelMatrix,N.IDENTITY)),this._modelMatrix=N.clone(N.IDENTITY),this.debugShowBoundingVolume=A(t.debugShowBoundingVolume,!1),this._opaqueRS=void 0,this._translucentRS=void 0,this._colorCommands=[],this._polylinesUpdated=!1,this._polylinesRemoved=!1,this._createVertexArray=!1,this._propertiesChanged=new Uint32Array($ne),this._polylines=[],this._polylineBuckets={},this._positionBufferUsage={bufferUsage:Fe.STATIC_DRAW,frameCount:0},this._mode=void 0,this._polylinesToUpdate=[],this._vertexArrays=[],this._positionBuffer=void 0,this._texCoordExpandAndBatchIndexBuffer=void 0,this._batchTable=void 0,this._createBatchTable=!1,this._useHighlightColor=!1,this._highlightColor=z.clone(z.WHITE);let n=this;this._uniformMap={u_highlightColor:function(){return n._highlightColor}}}Object.defineProperties(Ff.prototype,{length:{get:function(){return b5(this),this._polylines.length}}});Ff.prototype.add=function(t){let n=new Lf(t,this);return n._index=this._polylines.length,this._polylines.push(n),this._createVertexArray=!0,this._createBatchTable=!0,n};Ff.prototype.remove=function(t){if(this.contains(t)){if(this._polylinesRemoved=!0,this._createVertexArray=!0,this._createBatchTable=!0,f(t._bucket)){let n=t._bucket;n.shaderProgram=n.shaderProgram&&n.shaderProgram.destroy()}return t._destroy(),!0}return!1};Ff.prototype.removeAll=function(){S5(this),oie(this),this._polylineBuckets={},this._polylinesRemoved=!1,this._polylines.length=0,this._polylinesToUpdate.length=0,this._createVertexArray=!0};Ff.prototype.contains=function(t){return f(t)&&t._polylineCollection===this};Ff.prototype.get=function(t){return b5(this),this._polylines[t]};function yUe(t,n){f(t._batchTable)&&t._batchTable.destroy();let i=[{functionName:"batchTable_getWidthAndShow",componentDatatype:J.UNSIGNED_BYTE,componentsPerAttribute:2},{functionName:"batchTable_getPickColor",componentDatatype:J.UNSIGNED_BYTE,componentsPerAttribute:4,normalize:!0},{functionName:"batchTable_getCenterHigh",componentDatatype:J.FLOAT,componentsPerAttribute:3},{functionName:"batchTable_getCenterLowAndRadius",componentDatatype:J.FLOAT,componentsPerAttribute:4},{functionName:"batchTable_getDistanceDisplayCondition",componentDatatype:J.FLOAT,componentsPerAttribute:2}];t._batchTable=new ox(n,i,t._polylines.length)}var eie=new Hn,tie=new se,nie=new W;Ff.prototype.update=function(t){if(b5(this),this._polylines.length===0||!this.show)return;bUe(this,t);let n=t.context,i=t.mapProjection,o,r=this._propertiesChanged;if(this._createBatchTable){if(Ut.maximumVertexTextureImageUnits===0)throw new he("Vertex texture fetch support is required to render polylines. The maximum number of vertex texture image units must be greater than zero.");yUe(this,n),this._createBatchTable=!1}if(this._createVertexArray||CUe(this))Kne(this,n,i);else if(this._polylinesUpdated){let l=this._polylinesToUpdate;if(this._mode!==ne.SCENE3D){let u=l.length;for(let d=0;d<u;++d)o=l[d],o.update()}if(r[qne]||r[_Ue])Kne(this,n,i);else{let u=l.length,d=this._polylineBuckets;for(let h=0;h<u;++h){o=l[h],r=o._propertiesChanged;let _=o._bucket,y=0;for(let p in d)if(d.hasOwnProperty(p)){if(d[p]===_){r[E5]&&_.writeUpdate(y,o,this._positionBuffer,i);break}y+=d[p].lengthOfPositions}if((r[mUe]||r[pUe])&&this._batchTable.setBatchedAttribute(o._index,0,new W(o._width,o._show)),this._batchTable.attributes.length>2){if(r[E5]||r[qne]){let p=t.mode===ne.SCENE2D?o._boundingVolume2D:o._boundingVolumeWC,C=Hn.fromCartesian(p.center,eie),x=se.fromElements(C.low.x,C.low.y,C.low.z,p.radius,tie);this._batchTable.setBatchedAttribute(o._index,2,C.high),this._batchTable.setBatchedAttribute(o._index,3,x)}if(r[gUe]){let p=nie;p.x=0,p.y=Number.MAX_VALUE;let C=o.distanceDisplayCondition;f(C)&&(p.x=C.near,p.y=C.far),this._batchTable.setBatchedAttribute(o._index,4,p)}}o._clean()}}l.length=0,this._polylinesUpdated=!1}r=this._propertiesChanged;for(let l=0;l<$ne;++l)r[l]=0;let s=N.IDENTITY;t.mode===ne.SCENE3D&&(s=this.modelMatrix);let a=t.passes,c=t.morphTime!==0;if((!f(this._opaqueRS)||this._opaqueRS.depthTest.enabled!==c)&&(this._opaqueRS=Ve.fromCache({depthMask:c,depthTest:{enabled:c}})),(!f(this._translucentRS)||this._translucentRS.depthTest.enabled!==c)&&(this._translucentRS=Ve.fromCache({blending:ln.ALPHA_BLEND,depthMask:!c,depthTest:{enabled:c}})),this._batchTable.update(t),a.render||a.pick){let l=this._colorCommands;AUe(this,t,l,s)}};var ow=new ae,Yne=new ae;function AUe(t,n,i,o){let r=n.context,s=n.commandList,a=i.length,c=0,l=!0,u=t._vertexArrays,d=t.debugShowBoundingVolume,_=t._batchTable.getUniformMapCallback(),y=u.length;for(let p=0;p<y;++p){let C=u[p],x=C.buckets,T=x.length;for(let E=0;E<T;++E){let S=x[E],w=S.offset,D=S.bucket.shaderProgram,I=S.bucket.polylines,O=I.length,M,L,F=0,g,b;for(let v=0;v<O;++v){let P=I[v],R=TUe(P._material);if(R!==M){if(f(M)&&F>0){let G=L.isTranslucent();c>=a?(g=new et({owner:t}),i.push(g)):g=i[c],++c,b=At(_(L._uniforms),t._uniformMap),g.boundingVolume=ae.clone(ow,g.boundingVolume),g.modelMatrix=o,g.shaderProgram=D,g.vertexArray=C.va,g.renderState=G?t._translucentRS:t._opaqueRS,g.pass=G?Te.TRANSLUCENT:Te.OPAQUE,g.debugShowBoundingVolume=d,g.pickId="v_pickColor",g.uniformMap=b,g.count=F,g.offset=w,w+=F,F=0,l=!0,s.push(g)}L=P._material,L.update(r),M=R}let V=P._locatorBuckets,H=V.length;for(let G=0;G<H;++G){let k=V[G];k.locator===S&&(F+=k.count)}let U;n.mode===ne.SCENE3D?U=P._boundingVolumeWC:n.mode===ne.COLUMBUS_VIEW?U=P._boundingVolume2D:n.mode===ne.SCENE2D?f(P._boundingVolume2D)&&(U=ae.clone(P._boundingVolume2D,Yne),U.center.x=0):f(P._boundingVolumeWC)&&f(P._boundingVolume2D)&&(U=ae.union(P._boundingVolumeWC,P._boundingVolume2D,Yne)),l?(l=!1,ae.clone(U,ow)):ae.union(U,ow,ow)}f(M)&&F>0&&(c>=a?(g=new et({owner:t}),i.push(g)):g=i[c],++c,b=At(_(L._uniforms),t._uniformMap),g.boundingVolume=ae.clone(ow,g.boundingVolume),g.modelMatrix=o,g.shaderProgram=D,g.vertexArray=C.va,g.renderState=L.isTranslucent()?t._translucentRS:t._opaqueRS,g.pass=L.isTranslucent()?Te.TRANSLUCENT:Te.OPAQUE,g.debugShowBoundingVolume=d,g.pickId="v_pickColor",g.uniformMap=b,g.count=F,g.offset=w,l=!0,s.push(g)),M=void 0}}i.length=c}Ff.prototype.isDestroyed=function(){return!1};Ff.prototype.destroy=function(){return iie(this),S5(this),oie(this),this._batchTable=this._batchTable&&this._batchTable.destroy(),ue(this)};function CUe(t){let n=!1,i=t._propertiesChanged,o=t._positionBufferUsage;return i[E5]?(o.bufferUsage!==Fe.STREAM_DRAW&&(n=!0,o.bufferUsage=Fe.STREAM_DRAW),o.frameCount=100):o.bufferUsage!==Fe.STATIC_DRAW&&(o.frameCount===0?(n=!0,o.bufferUsage=Fe.STATIC_DRAW):o.frameCount--),n}var Xne=[0,0,0];function Kne(t,n,i){t._createVertexArray=!1,S5(t),iie(t),EUe(t);let o=[[]],r=o[0],s=t._batchTable,a=t._useHighlightColor,c=[0],l=0,u=[[]],d=0,h=t._polylineBuckets,_,y;for(_ in h)h.hasOwnProperty(_)&&(y=h[_],y.updateShader(n,s,a),d+=y.lengthOfPositions);if(d>0){let p=t._mode,C=new Float32Array(6*d*3),x=new Float32Array(d*4),T,E=0,S=0,w=0;for(_ in h)if(h.hasOwnProperty(_)){y=h[_],y.write(C,x,E,S,w,s,n,i),p===ne.MORPHING&&(f(T)||(T=new Float32Array(6*d*3)),y.writeForMorph(T,E));let b=y.lengthOfPositions;E+=6*b*3,S+=b*4,w+=b*4,l=y.updateIndices(o,c,u,l)}let D=t._positionBufferUsage.bufferUsage,I=Fe.STATIC_DRAW;t._positionBuffer=ut.createVertexBuffer({context:n,typedArray:C,usage:D});let O;f(T)&&(O=ut.createVertexBuffer({context:n,typedArray:T,usage:D})),t._texCoordExpandAndBatchIndexBuffer=ut.createVertexBuffer({context:n,typedArray:x,usage:I});let M=3*Float32Array.BYTES_PER_ELEMENT,L=4*Float32Array.BYTES_PER_ELEMENT,F=0,g=o.length;for(let b=0;b<g;++b)if(r=o[b],r.length>0){let v=new Uint16Array(r),P=ut.createIndexBuffer({context:n,typedArray:v,usage:Fe.STATIC_DRAW,indexDatatype:Ne.UNSIGNED_SHORT});F+=c[b];let R=6*(b*(M*B.SIXTY_FOUR_KILOBYTES)-F*M),V=M+R,H=M+V,U=M+H,G=M+U,k=M+G,X=b*(L*B.SIXTY_FOUR_KILOBYTES)-F*L,Y=[{index:Qc.position3DHigh,componentsPerAttribute:3,componentDatatype:J.FLOAT,offsetInBytes:R,strideInBytes:6*M},{index:Qc.position3DLow,componentsPerAttribute:3,componentDatatype:J.FLOAT,offsetInBytes:V,strideInBytes:6*M},{index:Qc.position2DHigh,componentsPerAttribute:3,componentDatatype:J.FLOAT,offsetInBytes:R,strideInBytes:6*M},{index:Qc.position2DLow,componentsPerAttribute:3,componentDatatype:J.FLOAT,offsetInBytes:V,strideInBytes:6*M},{index:Qc.prevPosition3DHigh,componentsPerAttribute:3,componentDatatype:J.FLOAT,offsetInBytes:H,strideInBytes:6*M},{index:Qc.prevPosition3DLow,componentsPerAttribute:3,componentDatatype:J.FLOAT,offsetInBytes:U,strideInBytes:6*M},{index:Qc.prevPosition2DHigh,componentsPerAttribute:3,componentDatatype:J.FLOAT,offsetInBytes:H,strideInBytes:6*M},{index:Qc.prevPosition2DLow,componentsPerAttribute:3,componentDatatype:J.FLOAT,offsetInBytes:U,strideInBytes:6*M},{index:Qc.nextPosition3DHigh,componentsPerAttribute:3,componentDatatype:J.FLOAT,offsetInBytes:G,strideInBytes:6*M},{index:Qc.nextPosition3DLow,componentsPerAttribute:3,componentDatatype:J.FLOAT,offsetInBytes:k,strideInBytes:6*M},{index:Qc.nextPosition2DHigh,componentsPerAttribute:3,componentDatatype:J.FLOAT,offsetInBytes:G,strideInBytes:6*M},{index:Qc.nextPosition2DLow,componentsPerAttribute:3,componentDatatype:J.FLOAT,offsetInBytes:k,strideInBytes:6*M},{index:Qc.texCoordExpandAndBatchIndex,componentsPerAttribute:4,componentDatatype:J.FLOAT,vertexBuffer:t._texCoordExpandAndBatchIndexBuffer,offsetInBytes:X}],K,j,Z,Q;p===ne.SCENE3D?(j=t._positionBuffer,K="vertexBuffer",Z=Xne,Q="value"):p===ne.SCENE2D||p===ne.COLUMBUS_VIEW?(j=Xne,K="value",Z=t._positionBuffer,Q="vertexBuffer"):(j=O,K="vertexBuffer",Z=t._positionBuffer,Q="vertexBuffer"),Y[0][K]=j,Y[1][K]=j,Y[2][Q]=Z,Y[3][Q]=Z,Y[4][K]=j,Y[5][K]=j,Y[6][Q]=Z,Y[7][Q]=Z,Y[8][K]=j,Y[9][K]=j,Y[10][Q]=Z,Y[11][Q]=Z;let me=new $n({context:n,attributes:Y,indexBuffer:P});t._vertexArrays.push({va:me,buckets:u[b]})}}}function xUe(t,n){return n instanceof St?n.id:n}var $L=[];function TUe(t){let n=$i._uniformList[t.type],i=n.length;$L.length=2*i;let o=0;for(let r=0;r<i;++r){let s=n[r];$L[o]=s,$L[o+1]=t._uniforms[s](),o+=2}return`${t.type}:${JSON.stringify($L,xUe)}`}function EUe(t){let n=t._mode,i=t._modelMatrix,o=t._polylineBuckets={},r=t._polylines,s=r.length;for(let a=0;a<s;++a){let c=r[a];if(c._actualPositions.length>1){c.update();let l=c.material,u=o[l.type];f(u)||(u=o[l.type]=new lh(l,n,i)),u.addPolyline(c)}}}function bUe(t,n){let i=n.mode;(t._mode!==i||!N.equals(t._modelMatrix,t.modelMatrix))&&(t._mode=i,t._modelMatrix=N.clone(t.modelMatrix),t._createVertexArray=!0)}function b5(t){if(t._polylinesRemoved){t._polylinesRemoved=!1;let n=[],i=[],o=0,r,s=t._polylines.length;for(let a=0;a<s;++a)r=t._polylines[a],r.isDestroyed||(r._index=o++,i.push(r),n.push(r));t._polylines=n,t._polylinesToUpdate=i}}function S5(t){let n=t._polylines,i=n.length;for(let o=0;o<i;++o)if(!n[o].isDestroyed){let r=n[o]._bucket;f(r)&&(r.shaderProgram=r.shaderProgram&&r.shaderProgram.destroy())}}function iie(t){let n=t._vertexArrays.length;for(let i=0;i<n;++i)t._vertexArrays[i].va.destroy();t._vertexArrays.length=0}Ff.prototype._updatePolyline=function(t,n){this._polylinesUpdated=!0,t._dirty||this._polylinesToUpdate.push(t),++this._propertiesChanged[n]};function oie(t){let n=t._polylines,i=n.length;for(let o=0;o<i;++o)n[o].isDestroyed||n[o]._destroy()}function T5(t,n,i){this.count=t,this.offset=n,this.bucket=i}function lh(t,n,i){this.polylines=[],this.lengthOfPositions=0,this.material=t,this.shaderProgram=void 0,this.mode=n,this.modelMatrix=i}lh.prototype.addPolyline=function(t){this.polylines.push(t),t._actualLength=this.getPolylinePositionsLength(t),this.lengthOfPositions+=t._actualLength,t._bucket=this};lh.prototype.updateShader=function(t,n,i){if(f(this.shaderProgram))return;let o=["DISTANCE_DISPLAY_CONDITION"];i&&o.push("VECTOR_TILE"),this.material.shaderSource.search(/varying\s+float\s+v_polylineAngle;/g)!==-1&&o.push("POLYLINE_DASH"),Vt.isInternetExplorer()||o.push("CLIP_POLYLINE");let r=new ze({defines:o,sources:[`varying vec4 v_pickColor;
`,this.material.shaderSource,ux]}),s=n.getVertexShaderCallback()(JL),a=new ze({defines:o,sources:[Tu,s]});this.shaderProgram=qt.fromCache({context:t,vertexShaderSource:a,fragmentShaderSource:r,attributeLocations:Qc})};function rie(t){return m.dot(m.UNIT_X,t._boundingVolume.center)<0||t._boundingVolume.intersectPlane(rn.ORIGIN_ZX_PLANE)===jt.INTERSECTING}lh.prototype.getPolylinePositionsLength=function(t){let n;if(this.mode===ne.SCENE3D||!rie(t))return n=t._actualPositions.length,n*4-4;let i=0,o=t._segments.lengths;n=o.length;for(let r=0;r<n;++r)i+=o[r]*4-4;return i};var ts=new m,Iu=new m,Bu=new m,eF=new m,SUe=new se,wUe=new W;lh.prototype.write=function(t,n,i,o,r,s,a,c){let l=this.mode,u=c.ellipsoid.maximumRadius*B.PI,d=this.polylines,h=d.length;for(let _=0;_<h;++_){let y=d[_],p=y.width,C=y.show&&p>0,x=y._index,T=this.getSegments(y,c),E=T.positions,S=T.lengths,w=E.length,D=y.getPickId(a).color,I=0,O=0,M;for(let H=0;H<w;++H){H===0?y._loop?M=E[w-2]:(M=eF,m.subtract(E[0],E[1],M),m.add(E[0],M,M)):M=E[H-1],m.clone(M,Iu),m.clone(E[H],ts),H===w-1?y._loop?M=E[1]:(M=eF,m.subtract(E[w-1],E[w-2],M),m.add(E[w-1],M,M)):M=E[H+1],m.clone(M,Bu);let U=S[I];H===O+U&&(O+=U,++I);let G=H-O===0,k=H===O+S[I]-1;l===ne.SCENE2D&&(Iu.z=0,ts.z=0,Bu.z=0),(l===ne.SCENE2D||l===ne.MORPHING)&&(G||k)&&u-Math.abs(ts.x)<1&&((ts.x<0&&Iu.x>0||ts.x>0&&Iu.x<0)&&m.clone(ts,Iu),(ts.x<0&&Bu.x>0||ts.x>0&&Bu.x<0)&&m.clone(ts,Bu));let X=G?2:0,Y=k?2:4;for(let K=X;K<Y;++K){Hn.writeElements(ts,t,i),Hn.writeElements(Iu,t,i+6),Hn.writeElements(Bu,t,i+12);let j=K-2<0?-1:1;n[r]=H/(w-1),n[r+1]=2*(K%2)-1,n[r+2]=j,n[r+3]=x,i+=6*3,r+=4}}let L=SUe;L.x=z.floatToByte(D.red),L.y=z.floatToByte(D.green),L.z=z.floatToByte(D.blue),L.w=z.floatToByte(D.alpha);let F=wUe;F.x=p,F.y=C?1:0;let g=l===ne.SCENE2D?y._boundingVolume2D:y._boundingVolumeWC,b=Hn.fromCartesian(g.center,eie),v=b.high,P=se.fromElements(b.low.x,b.low.y,b.low.z,g.radius,tie),R=nie;R.x=0,R.y=Number.MAX_VALUE;let V=y.distanceDisplayCondition;f(V)&&(R.x=V.near,R.y=V.far),s.setBatchedAttribute(x,0,F),s.setBatchedAttribute(x,1,L),s.attributes.length>2&&(s.setBatchedAttribute(x,2,v),s.setBatchedAttribute(x,3,P),s.setBatchedAttribute(x,4,R))}};var DUe=new m,vUe=new m,PUe=new m,Jne=new m;lh.prototype.writeForMorph=function(t,n){let i=this.modelMatrix,o=this.polylines,r=o.length;for(let s=0;s<r;++s){let a=o[s],c=a._segments.positions,l=a._segments.lengths,u=c.length,d=0,h=0;for(let _=0;_<u;++_){let y;_===0?a._loop?y=c[u-2]:(y=Jne,m.subtract(c[0],c[1],y),m.add(c[0],y,y)):y=c[_-1],y=N.multiplyByPoint(i,y,vUe);let p=N.multiplyByPoint(i,c[_],DUe),C;_===u-1?a._loop?C=c[1]:(C=Jne,m.subtract(c[u-1],c[u-2],C),m.add(c[u-1],C,C)):C=c[_+1],C=N.multiplyByPoint(i,C,PUe);let x=l[d];_===h+x&&(h+=x,++d);let T=_-h===0,E=_===h+l[d]-1,S=T?2:0,w=E?2:4;for(let D=S;D<w;++D)Hn.writeElements(p,t,n),Hn.writeElements(y,t,n+6),Hn.writeElements(C,t,n+12),n+=6*3}}};var IUe=new Array(1);lh.prototype.updateIndices=function(t,n,i,o){let r=i.length-1,s=new T5(0,o,this);i[r].push(s);let a=0,c=t[t.length-1],l=0;c.length>0&&(l=c[c.length-1]+1);let u=this.polylines,d=u.length;for(let h=0;h<d;++h){let _=u[h];_._locatorBuckets=[];let y;if(this.mode===ne.SCENE3D){y=IUe;let C=_._actualPositions.length;if(C>0)y[0]=C;else continue}else y=_._segments.lengths;let p=y.length;if(p>0){let C=0;for(let x=0;x<p;++x){let T=y[x]-1;for(let E=0;E<T;++E)l+4>B.SIXTY_FOUR_KILOBYTES&&(_._locatorBuckets.push({locator:s,count:C}),C=0,n.push(4),c=[],t.push(c),l=0,s.count=a,a=0,o=0,s=new T5(0,0,this),i[++r]=[s]),c.push(l,l+2,l+1),c.push(l+1,l+2,l+3),C+=6,a+=6,o+=6,l+=4}_._locatorBuckets.push({locator:s,count:C}),l+4>B.SIXTY_FOUR_KILOBYTES&&(n.push(0),c=[],t.push(c),l=0,s.count=a,o=0,a=0,s=new T5(0,0,this),i[++r]=[s])}_._clean()}return s.count=a,o};lh.prototype.getPolylineStartIndex=function(t){let n=this.polylines,i=0,o=n.length;for(let r=0;r<o;++r){let s=n[r];if(s===t)break;i+=s._actualLength}return i};var Rx={positions:void 0,lengths:void 0},Zne=new Array(1),BUe=new m,OUe=new de;lh.prototype.getSegments=function(t,n){let i=t._actualPositions;if(this.mode===ne.SCENE3D)return Zne[0]=i.length,Rx.positions=i,Rx.lengths=Zne,Rx;rie(t)&&(i=t._segments.positions);let o=n.ellipsoid,r=[],s=this.modelMatrix,a=i.length,c,l=BUe;for(let u=0;u<a;++u)c=i[u],l=N.multiplyByPoint(s,c,l),r.push(n.project(o.cartesianToCartographic(l,OUe)));if(r.length>0){t._boundingVolume2D=ae.fromPoints(r,t._boundingVolume2D);let u=t._boundingVolume2D.center;t._boundingVolume2D.center=new m(u.z,u.x,u.y)}return Rx.positions=r,Rx.lengths=t._segments.lengths,Rx};var Qne;lh.prototype.writeUpdate=function(t,n,i,o){let r=this.mode,s=o.ellipsoid.maximumRadius*B.PI,a=n._actualLength;if(a){t+=this.getPolylineStartIndex(n);let c=Qne,l=6*a*3;!f(c)||c.length<l?c=Qne=new Float32Array(l):c.length>l&&(c=new Float32Array(c.buffer,0,l));let u=this.getSegments(n,o),d=u.positions,h=u.lengths,_=0,y=0,p=0,C;a=d.length;for(let x=0;x<a;++x){x===0?n._loop?C=d[a-2]:(C=eF,m.subtract(d[0],d[1],C),m.add(d[0],C,C)):C=d[x-1],m.clone(C,Iu),m.clone(d[x],ts),x===a-1?n._loop?C=d[1]:(C=eF,m.subtract(d[a-1],d[a-2],C),m.add(d[a-1],C,C)):C=d[x+1],m.clone(C,Bu);let T=h[y];x===p+T&&(p+=T,++y);let E=x-p===0,S=x===p+h[y]-1;r===ne.SCENE2D&&(Iu.z=0,ts.z=0,Bu.z=0),(r===ne.SCENE2D||r===ne.MORPHING)&&(E||S)&&s-Math.abs(ts.x)<1&&((ts.x<0&&Iu.x>0||ts.x>0&&Iu.x<0)&&m.clone(ts,Iu),(ts.x<0&&Bu.x>0||ts.x>0&&Bu.x<0)&&m.clone(ts,Bu));let w=E?2:0,D=S?2:4;for(let I=w;I<D;++I)Hn.writeElements(ts,c,_),Hn.writeElements(Iu,c,_+6),Hn.writeElements(Bu,c,_+12),_+=6*3}i.copyFromArrayView(c,6*3*Float32Array.BYTES_PER_ELEMENT*t)}};var M_=Ff;function L_(t){this._positions=t.positions,this._batchTable=t.batchTable,this._batchIds=t.batchIds,this._rectangle=t.rectangle,this._minHeight=t.minimumHeight,this._maxHeight=t.maximumHeight,this._billboardCollection=new vu({batchTable:t.batchTable}),this._labelCollection=new jm({batchTable:t.batchTable}),this._polylineCollection=new M_,this._polylineCollection._useHighlightColor=!0,this._verticesPromise=void 0,this._packedBuffer=void 0,this._ready=!1,this._update=function(n,i){},this._readyPromise=WUe(this)}Object.defineProperties(L_.prototype,{pointsLength:{get:function(){return this._billboardCollection.length}},texturesByteLength:{get:function(){let t=this._billboardCollection.textureAtlas.texture.sizeInBytes,n=this._labelCollection._textureAtlas.texture.sizeInBytes;return t+n}},readyPromise:{get:function(){return this._readyPromise}}});function RUe(t,n){let i=t._rectangle,o=t._minHeight,r=t._maxHeight,s=2+le.packedLength+oe.packedLength,a=new Float64Array(s),c=0;return a[c++]=o,a[c++]=r,le.pack(i,a,c),c+=le.packedLength,oe.pack(n,a,c),a}var MUe=new fi("createVectorTilePoints",5),LUe=new m;function FUe(t,n){let i;if(!f(t._verticesPromise)){i=t._positions;let o=t._packedBuffer;f(o)||(i=t._positions=i.slice(),t._batchIds=t._batchIds.slice(),o=t._packedBuffer=RUe(t,n));let r=[i.buffer,o.buffer],s={positions:i.buffer,packedBuffer:o.buffer},a=t._verticesPromise=MUe.scheduleTask(s,r);return f(a)?a.then(function(c){t._positions=new Float64Array(c.positions);let l=t._billboardCollection,u=t._labelCollection,d=t._polylineCollection;i=t._positions;let h=t._batchIds,_=i.length/3;for(let y=0;y<_;++y){let p=h[y],C=m.unpack(i,y*3,LUe),x=l.add();x.position=C,x._batchIndex=p;let T=u.add();T.text=" ",T.position=C,T._batchIndex=p;let E=d.add();E.positions=[m.clone(C),m.clone(C)]}t._positions=void 0,t._packedBuffer=void 0,t._ready=!0}):void 0}}L_.prototype.createFeatures=function(t,n){let i=this._billboardCollection,o=this._labelCollection,r=this._polylineCollection,s=this._batchIds,a=s.length;for(let c=0;c<a;++c){let l=s[c],u=i.get(c),d=o.get(c),h=r.get(c);n[l]=new O_(t,l,u,d,h)}};L_.prototype.applyDebugSettings=function(t,n){t?(z.clone(n,this._billboardCollection._highlightColor),z.clone(n,this._labelCollection._highlightColor),z.clone(n,this._polylineCollection._highlightColor)):(z.clone(z.WHITE,this._billboardCollection._highlightColor),z.clone(z.WHITE,this._labelCollection._highlightColor),z.clone(z.WHITE,this._polylineCollection._highlightColor))};function NUe(t,n){let i=t._batchIds,o=i.length;for(let r=0;r<o;++r){let s=i[r],a=n[s];a.show=!0,a.pointSize=O_.defaultPointSize,a.color=O_.defaultColor,a.pointOutlineColor=O_.defaultPointOutlineColor,a.pointOutlineWidth=O_.defaultPointOutlineWidth,a.labelColor=z.WHITE,a.labelOutlineColor=z.WHITE,a.labelOutlineWidth=1,a.font="30px sans-serif",a.labelStyle=Lo.FILL,a.labelText=void 0,a.backgroundColor=new z(.165,.165,.165,.8),a.backgroundPadding=new W(7,5),a.backgroundEnabled=!1,a.scaleByDistance=void 0,a.translucencyByDistance=void 0,a.distanceDisplayCondition=void 0,a.heightOffset=0,a.anchorLineEnabled=!1,a.anchorLineColor=z.WHITE,a.image=void 0,a.disableDepthTestDistance=0,a.horizontalOrigin=ui.CENTER,a.verticalOrigin=vn.CENTER,a.labelHorizontalOrigin=ui.RIGHT,a.labelVerticalOrigin=vn.BASELINE}}var VUe=new z,kUe=new z,UUe=new z,zUe=new z,HUe=new z,GUe=new z,rw=new Pt,sw=new Pt,w5=new wt;L_.prototype.applyStyle=function(t,n){if(!f(t)){NUe(this,n);return}let i=this._batchIds,o=i.length;for(let r=0;r<o;++r){let s=i[r],a=n[s];if(f(t.show)&&(a.show=t.show.evaluate(a)),f(t.pointSize)&&(a.pointSize=t.pointSize.evaluate(a)),f(t.color)&&(a.color=t.color.evaluateColor(a,VUe)),f(t.pointOutlineColor)&&(a.pointOutlineColor=t.pointOutlineColor.evaluateColor(a,kUe)),f(t.pointOutlineWidth)&&(a.pointOutlineWidth=t.pointOutlineWidth.evaluate(a)),f(t.labelColor)&&(a.labelColor=t.labelColor.evaluateColor(a,UUe)),f(t.labelOutlineColor)&&(a.labelOutlineColor=t.labelOutlineColor.evaluateColor(a,zUe)),f(t.labelOutlineWidth)&&(a.labelOutlineWidth=t.labelOutlineWidth.evaluate(a)),f(t.font)&&(a.font=t.font.evaluate(a)),f(t.labelStyle)&&(a.labelStyle=t.labelStyle.evaluate(a)),f(t.labelText)?a.labelText=t.labelText.evaluate(a):a.labelText=void 0,f(t.backgroundColor)&&(a.backgroundColor=t.backgroundColor.evaluateColor(a,HUe)),f(t.backgroundPadding)&&(a.backgroundPadding=t.backgroundPadding.evaluate(a)),f(t.backgroundEnabled)&&(a.backgroundEnabled=t.backgroundEnabled.evaluate(a)),f(t.scaleByDistance)){let c=t.scaleByDistance.evaluate(a);rw.near=c.x,rw.nearValue=c.y,rw.far=c.z,rw.farValue=c.w,a.scaleByDistance=rw}else a.scaleByDistance=void 0;if(f(t.translucencyByDistance)){let c=t.translucencyByDistance.evaluate(a);sw.near=c.x,sw.nearValue=c.y,sw.far=c.z,sw.farValue=c.w,a.translucencyByDistance=sw}else a.translucencyByDistance=void 0;if(f(t.distanceDisplayCondition)){let c=t.distanceDisplayCondition.evaluate(a);w5.near=c.x,w5.far=c.y,a.distanceDisplayCondition=w5}else a.distanceDisplayCondition=void 0;f(t.heightOffset)&&(a.heightOffset=t.heightOffset.evaluate(a)),f(t.anchorLineEnabled)&&(a.anchorLineEnabled=t.anchorLineEnabled.evaluate(a)),f(t.anchorLineColor)&&(a.anchorLineColor=t.anchorLineColor.evaluateColor(a,GUe)),f(t.image)?a.image=t.image.evaluate(a):a.image=void 0,f(t.disableDepthTestDistance)&&(a.disableDepthTestDistance=t.disableDepthTestDistance.evaluate(a)),f(t.horizontalOrigin)&&(a.horizontalOrigin=t.horizontalOrigin.evaluate(a)),f(t.verticalOrigin)&&(a.verticalOrigin=t.verticalOrigin.evaluate(a)),f(t.labelHorizontalOrigin)&&(a.labelHorizontalOrigin=t.labelHorizontalOrigin.evaluate(a)),f(t.labelVerticalOrigin)&&(a.labelVerticalOrigin=t.labelVerticalOrigin.evaluate(a))}};function WUe(t){return new Promise(function(n,i){t._update=function(o,r){let s=FUe(o,r.mapProjection.ellipsoid);o._ready&&(o._polylineCollection.update(r),o._billboardCollection.update(r),o._labelCollection.update(r)),f(s)&&s.then(function(){n()}).catch(function(a){i(a)})}})}L_.prototype.update=function(t){this._update(this,t)};L_.prototype.isDestroyed=function(){return!1};L_.prototype.destroy=function(){return this._billboardCollection=this._billboardCollection&&this._billboardCollection.destroy(),this._labelCollection=this._labelCollection&&this._labelCollection.destroy(),this._polylineCollection=this._polylineCollection&&this._polylineCollection.destroy(),ue(this)};var tF=L_;function Ym(t){this._batchTable=t.batchTable,this._batchIds=t.batchIds,this._positions=t.positions,this._counts=t.counts,this._indices=t.indices,this._indexCounts=t.indexCounts,this._indexOffsets=void 0,this._batchTableColors=void 0,this._packedBuffer=void 0,this._batchedPositions=void 0,this._transferrableBatchIds=void 0,this._vertexBatchIds=void 0,this._ellipsoid=A(t.ellipsoid,oe.WGS84),this._minimumHeight=t.minimumHeight,this._maximumHeight=t.maximumHeight,this._polygonMinimumHeights=t.polygonMinimumHeights,this._polygonMaximumHeights=t.polygonMaximumHeights,this._center=A(t.center,m.ZERO),this._rectangle=t.rectangle,this._center=void 0,this._boundingVolume=t.boundingVolume,this._boundingVolumes=void 0,this._batchedIndices=void 0,this._ready=!1,this._update=function(n,i){},this._readyPromise=ZUe(this),this._verticesPromise=void 0,this._primitive=void 0,this.debugWireframe=!1,this.forceRebatch=!1,this.classificationType=Un.BOTH}Object.defineProperties(Ym.prototype,{trianglesLength:{get:function(){return f(this._primitive)?this._primitive.trianglesLength:0}},geometryByteLength:{get:function(){return f(this._primitive)?this._primitive.geometryByteLength:0}},readyPromise:{get:function(){return this._readyPromise}}});function jUe(t){let n=new Float64Array(3+m.packedLength+oe.packedLength+le.packedLength),i=0;return n[i++]=t._indices.BYTES_PER_ELEMENT,n[i++]=t._minimumHeight,n[i++]=t._maximumHeight,m.pack(t._center,n,i),i+=m.packedLength,oe.pack(t._ellipsoid,n,i),i+=oe.packedLength,le.pack(t._rectangle,n,i),n}function qUe(t,n){let i=1,o=n[i++],r=t._boundingVolumes=new Array(o);for(let c=0;c<o;++c)r[c]=_i.unpack(n,i),i+=_i.packedLength;let s=n[i++],a=t._batchedIndices=new Array(s);for(let c=0;c<s;++c){let l=z.unpack(n,i);i+=z.packedLength;let u=n[i++],d=n[i++],h=n[i++],_=new Array(h);for(let y=0;y<h;++y)_[y]=n[i++];a[c]=new Fm({color:l,offset:u,count:d,batchIds:_})}}var YUe=new fi("createVectorTilePolygons",5),XUe=new z;function KUe(t){if(!f(t._primitive)&&!f(t._verticesPromise)){let n=t._positions,i=t._counts,o=t._indexCounts,r=t._indices,s=t._transferrableBatchIds,a=t._batchTableColors,c=t._packedBuffer;if(!f(a)){n=t._positions=t._positions.slice(),i=t._counts=t._counts.slice(),o=t._indexCounts=t._indexCounts.slice(),r=t._indices=t._indices.slice(),t._center=t._ellipsoid.cartographicToCartesian(le.center(t._rectangle)),s=t._transferrableBatchIds=new Uint32Array(t._batchIds),a=t._batchTableColors=new Uint32Array(s.length);let y=t._batchTable,p=a.length;for(let C=0;C<p;++C){let x=y.getColor(C,XUe);a[C]=x.toRgba()}c=t._packedBuffer=jUe(t)}let l=[n.buffer,i.buffer,o.buffer,r.buffer,s.buffer,a.buffer,c.buffer],u={packedBuffer:c.buffer,positions:n.buffer,counts:i.buffer,indexCounts:o.buffer,indices:r.buffer,batchIds:s.buffer,batchTableColors:a.buffer},d=t._polygonMinimumHeights,h=t._polygonMaximumHeights;f(d)&&f(h)&&(d=d.slice(),h=h.slice(),l.push(d.buffer,h.buffer),u.minimumHeights=d,u.maximumHeights=h);let _=t._verticesPromise=YUe.scheduleTask(u,l);return f(_)?_.then(function(y){t._positions=void 0,t._counts=void 0,t._polygonMinimumHeights=void 0,t._polygonMaximumHeights=void 0;let p=new Float64Array(y.packedBuffer),C=p[0];qUe(t,p),t._indices=Ne.getSizeInBytes(C)===2?new Uint16Array(y.indices):new Uint32Array(y.indices),t._indexOffsets=new Uint32Array(y.indexOffsets),t._indexCounts=new Uint32Array(y.indexCounts),t._batchedPositions=new Float32Array(y.positions),t._vertexBatchIds=new Uint16Array(y.batchIds),t._ready=!0}):void 0}}function JUe(t){t._ready&&!f(t._primitive)&&(t._primitive=new Dx({batchTable:t._batchTable,positions:t._batchedPositions,batchIds:t._batchIds,vertexBatchIds:t._vertexBatchIds,indices:t._indices,indexOffsets:t._indexOffsets,indexCounts:t._indexCounts,batchedIndices:t._batchedIndices,boundingVolume:t._boundingVolume,boundingVolumes:t._boundingVolumes,center:t._center}),t._batchTable=void 0,t._batchIds=void 0,t._positions=void 0,t._counts=void 0,t._indices=void 0,t._indexCounts=void 0,t._indexOffsets=void 0,t._batchTableColors=void 0,t._packedBuffer=void 0,t._batchedPositions=void 0,t._transferrableBatchIds=void 0,t._vertexBatchIds=void 0,t._ellipsoid=void 0,t._minimumHeight=void 0,t._maximumHeight=void 0,t._polygonMinimumHeights=void 0,t._polygonMaximumHeights=void 0,t._center=void 0,t._rectangle=void 0,t._boundingVolume=void 0,t._boundingVolumes=void 0,t._batchedIndices=void 0,t._verticesPromise=void 0)}Ym.prototype.createFeatures=function(t,n){this._primitive.createFeatures(t,n)};Ym.prototype.applyDebugSettings=function(t,n){this._primitive.applyDebugSettings(t,n)};Ym.prototype.applyStyle=function(t,n){this._primitive.applyStyle(t,n)};Ym.prototype.updateCommands=function(t,n){this._primitive.updateCommands(t,n)};function ZUe(t){return new Promise(function(n,i){t._update=function(o,r){let s=KUe(o);o._ready&&(o._primitive.debugWireframe=o.debugWireframe,o._primitive.forceRebatch=o.forceRebatch,o._primitive.classificationType=o.classificationType,o._primitive.update(r)),f(s)&&s.then(function(){JUe(o),n(o)}).catch(function(a){i(a)})}})}Ym.prototype.update=function(t){this._update(this,t)};Ym.prototype.isDestroyed=function(){return!1};Ym.prototype.destroy=function(){return this._primitive=this._primitive&&this._primitive.destroy(),ue(this)};var nF=Ym;var iF=`attribute vec4 currentPosition;
attribute vec4 previousPosition;
attribute vec4 nextPosition;
attribute vec2 expandAndWidth;
attribute float a_batchId;
uniform mat4 u_modifiedModelView;
void main()
{
float expandDir = expandAndWidth.x;
float width = abs(expandAndWidth.y) + 0.5;
bool usePrev = expandAndWidth.y < 0.0;
vec4 p = u_modifiedModelView * currentPosition;
vec4 prev = u_modifiedModelView * previousPosition;
vec4 next = u_modifiedModelView * nextPosition;
float angle;
vec4 positionWC = getPolylineWindowCoordinatesEC(p, prev, next, expandDir, width, usePrev, angle);
gl_Position = czm_viewportOrthographic * positionWC;
}
`;function Nf(t){this._positions=t.positions,this._widths=t.widths,this._counts=t.counts,this._batchIds=t.batchIds,this._ellipsoid=A(t.ellipsoid,oe.WGS84),this._minimumHeight=t.minimumHeight,this._maximumHeight=t.maximumHeight,this._center=t.center,this._rectangle=t.rectangle,this._boundingVolume=t.boundingVolume,this._batchTable=t.batchTable,this._va=void 0,this._sp=void 0,this._rs=void 0,this._uniformMap=void 0,this._command=void 0,this._transferrableBatchIds=void 0,this._packedBuffer=void 0,this._keepDecodedPositions=t.keepDecodedPositions,this._decodedPositions=void 0,this._decodedPositionOffsets=void 0,this._currentPositions=void 0,this._previousPositions=void 0,this._nextPositions=void 0,this._expandAndWidth=void 0,this._vertexBatchIds=void 0,this._indices=void 0,this._constantColor=z.clone(z.WHITE),this._highlightColor=this._constantColor,this._trianglesLength=0,this._geometryByteLength=0,this._ready=!1,this._update=function(n,i){},this._readyPromise=f4e(this),this._verticesPromise=void 0}Object.defineProperties(Nf.prototype,{trianglesLength:{get:function(){return this._trianglesLength}},geometryByteLength:{get:function(){return this._geometryByteLength}},readyPromise:{get:function(){return this._readyPromise}}});function QUe(t){let n=t._rectangle,i=t._minimumHeight,o=t._maximumHeight,r=t._ellipsoid,s=t._center,a=2+le.packedLength+oe.packedLength+m.packedLength,c=new Float64Array(a),l=0;return c[l++]=i,c[l++]=o,le.pack(n,c,l),l+=le.packedLength,oe.pack(r,c,l),l+=oe.packedLength,m.pack(s,c,l),c}var $Ue=new fi("createVectorTilePolylines",5),Mx={previousPosition:0,currentPosition:1,nextPosition:2,expandAndWidth:3,a_batchId:4};function e4e(t,n){if(!f(t._va)&&!f(t._verticesPromise)){let i=t._positions,o=t._widths,r=t._counts,s=t._transferrableBatchIds,a=t._packedBuffer;f(a)||(i=t._positions=i.slice(),o=t._widths=o.slice(),r=t._counts=r.slice(),s=t._transferrableBatchIds=t._batchIds.slice(),a=t._packedBuffer=QUe(t));let c=[i.buffer,o.buffer,r.buffer,s.buffer,a.buffer],l={positions:i.buffer,widths:o.buffer,counts:r.buffer,batchIds:s.buffer,packedBuffer:a.buffer,keepDecodedPositions:t._keepDecodedPositions},u=t._verticesPromise=$Ue.scheduleTask(l,c);return f(u)?u.then(function(d){t._keepDecodedPositions&&(t._decodedPositions=new Float64Array(d.decodedPositions),t._decodedPositionOffsets=new Uint32Array(d.decodedPositionOffsets)),t._currentPositions=new Float32Array(d.currentPositions),t._previousPositions=new Float32Array(d.previousPositions),t._nextPositions=new Float32Array(d.nextPositions),t._expandAndWidth=new Float32Array(d.expandAndWidth),t._vertexBatchIds=new Uint16Array(d.batchIds);let h=d.indexDatatype;t._indices=h===Ne.UNSIGNED_SHORT?new Uint16Array(d.indices):new Uint32Array(d.indices),t._ready=!0}):void 0}}function t4e(t,n){if(t._ready&&!f(t._va)){let i=t._currentPositions,o=t._previousPositions,r=t._nextPositions,s=t._expandAndWidth,a=t._vertexBatchIds,c=t._indices,l=o.byteLength+i.byteLength+r.byteLength;l+=s.byteLength+a.byteLength+c.byteLength,t._trianglesLength=c.length/3,t._geometryByteLength=l;let u=ut.createVertexBuffer({context:n,typedArray:o,usage:Fe.STATIC_DRAW}),d=ut.createVertexBuffer({context:n,typedArray:i,usage:Fe.STATIC_DRAW}),h=ut.createVertexBuffer({context:n,typedArray:r,usage:Fe.STATIC_DRAW}),_=ut.createVertexBuffer({context:n,typedArray:s,usage:Fe.STATIC_DRAW}),y=ut.createVertexBuffer({context:n,typedArray:a,usage:Fe.STATIC_DRAW}),p=ut.createIndexBuffer({context:n,typedArray:c,usage:Fe.STATIC_DRAW,indexDatatype:c.BYTES_PER_ELEMENT===2?Ne.UNSIGNED_SHORT:Ne.UNSIGNED_INT}),C=[{index:Mx.previousPosition,vertexBuffer:u,componentDatatype:J.FLOAT,componentsPerAttribute:3},{index:Mx.currentPosition,vertexBuffer:d,componentDatatype:J.FLOAT,componentsPerAttribute:3},{index:Mx.nextPosition,vertexBuffer:h,componentDatatype:J.FLOAT,componentsPerAttribute:3},{index:Mx.expandAndWidth,vertexBuffer:_,componentDatatype:J.FLOAT,componentsPerAttribute:2},{index:Mx.a_batchId,vertexBuffer:y,componentDatatype:J.UNSIGNED_SHORT,componentsPerAttribute:1}];t._va=new $n({context:n,attributes:C,indexBuffer:p}),t._positions=void 0,t._widths=void 0,t._counts=void 0,t._ellipsoid=void 0,t._minimumHeight=void 0,t._maximumHeight=void 0,t._rectangle=void 0,t._transferrableBatchIds=void 0,t._packedBuffer=void 0,t._currentPositions=void 0,t._previousPositions=void 0,t._nextPositions=void 0,t._expandAndWidth=void 0,t._vertexBatchIds=void 0,t._indices=void 0}}var aw=new N,sie=new m;function n4e(t,n){f(t._uniformMap)||(t._uniformMap={u_modifiedModelView:function(){let i=n.uniformState.view;return N.clone(i,aw),N.multiplyByPoint(aw,t._center,sie),N.setTranslation(aw,sie,aw),aw},u_highlightColor:function(){return t._highlightColor}})}function i4e(t){if(f(t._rs))return;let n={enabled:!0,factor:-5,units:-5};t._rs=Ve.fromCache({blending:ln.ALPHA_BLEND,depthMask:!1,depthTest:{enabled:!0},polygonOffset:n})}var o4e=`uniform vec4 u_highlightColor; 
void main()
{
    gl_FragColor = u_highlightColor;
}
`;function r4e(t,n){if(f(t._sp))return;let i=t._batchTable,o=i.getVertexShaderCallback(!1,"a_batchId",void 0)(iF),r=i.getFragmentShaderCallback(!1,void 0,!1)(o4e),s=new ze({defines:["VECTOR_TILE",Vt.isInternetExplorer()?"":"CLIP_POLYLINE"],sources:[Tu,o]}),a=new ze({defines:["VECTOR_TILE"],sources:[r]});t._sp=qt.fromCache({context:n,vertexShaderSource:s,fragmentShaderSource:a,attributeLocations:Mx})}function s4e(t,n){if(!f(t._command)){let i=t._batchTable.getUniformMapCallback()(t._uniformMap);t._command=new et({owner:t,vertexArray:t._va,renderState:t._rs,shaderProgram:t._sp,uniformMap:i,boundingVolume:t._boundingVolume,pass:Te.TRANSLUCENT,pickId:t._batchTable.getPickId()})}n.commandList.push(t._command)}Nf.getPolylinePositions=function(t,n){let i=t._batchIds,o=t._decodedPositions,r=t._decodedPositionOffsets;if(!f(i)||!f(o))return;let s,a,c=i.length,l=0,u=0;for(s=0;s<c;++s)i[s]===n&&(l+=r[s+1]-r[s]);if(l===0)return;let d=new Float64Array(l*3);for(s=0;s<c;++s)if(i[s]===n){let h=r[s],_=r[s+1]-h;for(a=0;a<_;++a){let y=(h+a)*3;d[u++]=o[y],d[u++]=o[y+1],d[u++]=o[y+2]}}return d};Nf.prototype.getPositions=function(t){return Nf.getPolylinePositions(this,t)};Nf.prototype.createFeatures=function(t,n){let i=this._batchIds,o=i.length;for(let r=0;r<o;++r){let s=i[r];n[s]=new Ds(t,s)}};Nf.prototype.applyDebugSettings=function(t,n){this._highlightColor=t?n:this._constantColor};function a4e(t,n){let i=t._batchIds,o=i.length;for(let r=0;r<o;++r){let s=i[r],a=n[s];a.show=!0,a.color=z.WHITE}}var c4e=new z,l4e=z.WHITE,u4e=!0;Nf.prototype.applyStyle=function(t,n){if(!f(t)){a4e(this,n);return}let i=this._batchIds,o=i.length;for(let r=0;r<o;++r){let s=i[r],a=n[s];a.color=f(t.color)?t.color.evaluateColor(a,c4e):l4e,a.show=f(t.show)?t.show.evaluate(a):u4e}};function f4e(t){return new Promise(function(n,i){t._update=function(o,r){let s=r.context,a=e4e(o,s);if(n4e(o,s),r4e(o,s),i4e(o),o._ready){let c=r.passes;(c.render||c.pick)&&s4e(o,r)}!f(a)||a.then(function(){t4e(o,s),n()}).catch(function(c){i(c)})}})}Nf.prototype.update=function(t){this._update(this,t)};Nf.prototype.isDestroyed=function(){return!1};Nf.prototype.destroy=function(){return this._va=this._va&&this._va.destroy(),this._sp=this._sp&&this._sp.destroy(),ue(this)};var Lx=Nf;var oF=`attribute vec3 startEllipsoidNormal;
attribute vec3 endEllipsoidNormal;
attribute vec4 startPositionAndHeight;
attribute vec4 endPositionAndHeight;
attribute vec4 startFaceNormalAndVertexCorner;
attribute vec4 endFaceNormalAndHalfWidth;
attribute float a_batchId;
uniform mat4 u_modifiedModelView;
uniform vec2 u_minimumMaximumVectorHeights;
varying vec4 v_startPlaneEC;
varying vec4 v_endPlaneEC;
varying vec4 v_rightPlaneEC;
varying float v_halfWidth;
varying vec3 v_volumeUpEC;
void main()
{
float isEnd = floor(startFaceNormalAndVertexCorner.w * 0.251);
float isTop = floor(startFaceNormalAndVertexCorner.w * mix(0.51, 0.19, isEnd));
vec3 forward = endPositionAndHeight.xyz - startPositionAndHeight.xyz;
vec3 right = normalize(cross(forward, startEllipsoidNormal));
vec4 position = vec4(startPositionAndHeight.xyz, 1.0);
position.xyz += forward * isEnd;
v_volumeUpEC = czm_normal * normalize(cross(right, forward));
float offset;
vec3 ellipsoidNormal = mix(startEllipsoidNormal, endEllipsoidNormal, isEnd);
offset = mix(startPositionAndHeight.w, endPositionAndHeight.w, isEnd);
offset = mix(u_minimumMaximumVectorHeights.y, u_minimumMaximumVectorHeights.x, isTop) - offset;
position.xyz += offset * ellipsoidNormal;
position = u_modifiedModelView * position;
right = czm_normal * right;
vec3 scratchNormal = mix(-startFaceNormalAndVertexCorner.xyz, endFaceNormalAndHalfWidth.xyz, isEnd);
scratchNormal = cross(scratchNormal, mix(startEllipsoidNormal, endEllipsoidNormal, isEnd));
vec3 miterPushNormal = czm_normal * normalize(scratchNormal);
offset = 2.0 * endFaceNormalAndHalfWidth.w * max(0.0, czm_metersPerPixel(position));
offset = offset / dot(miterPushNormal, right);
position.xyz += miterPushNormal * (offset * sign(0.5 - mod(startFaceNormalAndVertexCorner.w, 2.0)));
gl_Position = czm_depthClamp(czm_projection * position);
position = u_modifiedModelView * vec4(startPositionAndHeight.xyz, 1.0);
vec3 startNormalEC = czm_normal * startFaceNormalAndVertexCorner.xyz;
v_startPlaneEC = vec4(startNormalEC, -dot(startNormalEC, position.xyz));
v_rightPlaneEC = vec4(right, -dot(right, position.xyz));
position = u_modifiedModelView * vec4(endPositionAndHeight.xyz, 1.0);
vec3 endNormalEC = czm_normal * endFaceNormalAndHalfWidth.xyz;
v_endPlaneEC = vec4(endNormalEC, -dot(endNormalEC, position.xyz));
v_halfWidth = endFaceNormalAndHalfWidth.w;
}
`;var rF=`#ifdef GL_EXT_frag_depth
#extension GL_EXT_frag_depth : enable
#endif
varying vec4 v_startPlaneEC;
varying vec4 v_endPlaneEC;
varying vec4 v_rightPlaneEC;
varying float v_halfWidth;
varying vec3 v_volumeUpEC;
uniform vec4 u_highlightColor;
void main()
{
float logDepthOrDepth = czm_branchFreeTernary(czm_sceneMode == czm_sceneMode2D, gl_FragCoord.z, czm_unpackDepth(texture2D(czm_globeDepthTexture, gl_FragCoord.xy / czm_viewport.zw)));
if (logDepthOrDepth == 0.0) {
#ifdef DEBUG_SHOW_VOLUME
gl_FragColor = vec4(0.0, 0.0, 1.0, 0.5);
return;
#else // DEBUG_SHOW_VOLUME
discard;
#endif // DEBUG_SHOW_VOLUME
}
vec4 eyeCoordinate = czm_windowToEyeCoordinates(gl_FragCoord.xy, logDepthOrDepth);
eyeCoordinate /= eyeCoordinate.w;
float halfMaxWidth = v_halfWidth * czm_metersPerPixel(eyeCoordinate);
halfMaxWidth += halfMaxWidth * (1.0 - dot(-normalize(eyeCoordinate.xyz), v_volumeUpEC));
float widthwiseDistance = czm_planeDistance(v_rightPlaneEC, eyeCoordinate.xyz);
float distanceFromStart = czm_planeDistance(v_startPlaneEC, eyeCoordinate.xyz);
float distanceFromEnd = czm_planeDistance(v_endPlaneEC, eyeCoordinate.xyz);
if (abs(widthwiseDistance) > halfMaxWidth || distanceFromStart < 0.0 || distanceFromEnd < 0.0) {
#ifdef DEBUG_SHOW_VOLUME
gl_FragColor = vec4(logDepthOrDepth, 0.0, 0.0, 0.5);
return;
#else // DEBUG_SHOW_VOLUME
discard;
#endif // DEBUG_SHOW_VOLUME
}
gl_FragColor = u_highlightColor;
czm_writeDepthClamp();
}
`;function Xm(t){this._positions=t.positions,this._widths=t.widths,this._counts=t.counts,this._batchIds=t.batchIds,this._ellipsoid=A(t.ellipsoid,oe.WGS84),this._minimumHeight=t.minimumHeight,this._maximumHeight=t.maximumHeight,this._center=t.center,this._rectangle=t.rectangle,this._batchTable=t.batchTable,this._va=void 0,this._sp=void 0,this._rs=void 0,this._uniformMap=void 0,this._command=void 0,this._transferrableBatchIds=void 0,this._packedBuffer=void 0,this._minimumMaximumVectorHeights=new W(ri._defaultMinTerrainHeight,ri._defaultMaxTerrainHeight),this._boundingVolume=_i.fromRectangle(t.rectangle,ri._defaultMinTerrainHeight,ri._defaultMaxTerrainHeight,this._ellipsoid),this._classificationType=t.classificationType,this._keepDecodedPositions=t.keepDecodedPositions,this._decodedPositions=void 0,this._decodedPositionOffsets=void 0,this._startEllipsoidNormals=void 0,this._endEllipsoidNormals=void 0,this._startPositionAndHeights=void 0,this._startFaceNormalAndVertexCornerIds=void 0,this._endPositionAndHeights=void 0,this._endFaceNormalAndHalfWidths=void 0,this._vertexBatchIds=void 0,this._indices=void 0,this._constantColor=z.clone(z.WHITE),this._highlightColor=this._constantColor,this._trianglesLength=0,this._geometryByteLength=0,this._ready=!1,this._update=function(n,i){},this._readyPromise=S4e(this),this._verticesPromise=void 0}Object.defineProperties(Xm.prototype,{trianglesLength:{get:function(){return this._trianglesLength}},geometryByteLength:{get:function(){return this._geometryByteLength}},readyPromise:{get:function(){return this._readyPromise}}});function d4e(t,n,i){let o=ri.getMinimumMaximumHeights(n,i),r=o.minimumTerrainHeight,s=o.maximumTerrainHeight,a=t._minimumMaximumVectorHeights;a.x=r,a.y=s;let c=t._boundingVolume,l=t._rectangle;_i.fromRectangle(l,r,s,i,c)}function h4e(t){let n=t._rectangle,i=t._minimumHeight,o=t._maximumHeight,r=t._ellipsoid,s=t._center,a=2+le.packedLength+oe.packedLength+m.packedLength,c=new Float64Array(a),l=0;return c[l++]=i,c[l++]=o,le.pack(n,c,l),l+=le.packedLength,oe.pack(r,c,l),l+=oe.packedLength,m.pack(s,c,l),c}var m4e=new fi("createVectorTileClampedPolylines"),F_={startEllipsoidNormal:0,endEllipsoidNormal:1,startPositionAndHeight:2,endPositionAndHeight:3,startFaceNormalAndVertexCorner:4,endFaceNormalAndHalfWidth:5,a_batchId:6};function p4e(t,n){if(!f(t._va)&&!f(t._verticesPromise)){let i=t._positions,o=t._widths,r=t._counts,s=t._transferrableBatchIds,a=t._packedBuffer;f(a)||(i=t._positions=i.slice(),o=t._widths=o.slice(),r=t._counts=r.slice(),s=t._transferrableBatchIds=t._batchIds.slice(),a=t._packedBuffer=h4e(t));let c=[i.buffer,o.buffer,r.buffer,s.buffer,a.buffer],l={positions:i.buffer,widths:o.buffer,counts:r.buffer,batchIds:s.buffer,packedBuffer:a.buffer,keepDecodedPositions:t._keepDecodedPositions},u=t._verticesPromise=m4e.scheduleTask(l,c);return f(u)?u.then(function(d){t._keepDecodedPositions&&(t._decodedPositions=new Float64Array(d.decodedPositions),t._decodedPositionOffsets=new Uint32Array(d.decodedPositionOffsets)),t._startEllipsoidNormals=new Float32Array(d.startEllipsoidNormals),t._endEllipsoidNormals=new Float32Array(d.endEllipsoidNormals),t._startPositionAndHeights=new Float32Array(d.startPositionAndHeights),t._startFaceNormalAndVertexCornerIds=new Float32Array(d.startFaceNormalAndVertexCornerIds),t._endPositionAndHeights=new Float32Array(d.endPositionAndHeights),t._endFaceNormalAndHalfWidths=new Float32Array(d.endFaceNormalAndHalfWidths),t._vertexBatchIds=new Uint16Array(d.vertexBatchIds);let h=d.indexDatatype;t._indices=h===Ne.UNSIGNED_SHORT?new Uint16Array(d.indices):new Uint32Array(d.indices),t._ready=!0}):void 0}}function _4e(t,n){if(t._ready&&!f(t._va)){let i=t._startEllipsoidNormals,o=t._endEllipsoidNormals,r=t._startPositionAndHeights,s=t._endPositionAndHeights,a=t._startFaceNormalAndVertexCornerIds,c=t._endFaceNormalAndHalfWidths,l=t._vertexBatchIds,u=t._indices,d=i.byteLength+o.byteLength;d+=r.byteLength+s.byteLength,d+=a.byteLength+c.byteLength,d+=l.byteLength+u.byteLength,t._trianglesLength=u.length/3,t._geometryByteLength=d;let h=ut.createVertexBuffer({context:n,typedArray:i,usage:Fe.STATIC_DRAW}),_=ut.createVertexBuffer({context:n,typedArray:o,usage:Fe.STATIC_DRAW}),y=ut.createVertexBuffer({context:n,typedArray:r,usage:Fe.STATIC_DRAW}),p=ut.createVertexBuffer({context:n,typedArray:s,usage:Fe.STATIC_DRAW}),C=ut.createVertexBuffer({context:n,typedArray:a,usage:Fe.STATIC_DRAW}),x=ut.createVertexBuffer({context:n,typedArray:c,usage:Fe.STATIC_DRAW}),T=ut.createVertexBuffer({context:n,typedArray:l,usage:Fe.STATIC_DRAW}),E=ut.createIndexBuffer({context:n,typedArray:u,usage:Fe.STATIC_DRAW,indexDatatype:u.BYTES_PER_ELEMENT===2?Ne.UNSIGNED_SHORT:Ne.UNSIGNED_INT}),S=[{index:F_.startEllipsoidNormal,vertexBuffer:h,componentDatatype:J.FLOAT,componentsPerAttribute:3},{index:F_.endEllipsoidNormal,vertexBuffer:_,componentDatatype:J.FLOAT,componentsPerAttribute:3},{index:F_.startPositionAndHeight,vertexBuffer:y,componentDatatype:J.FLOAT,componentsPerAttribute:4},{index:F_.endPositionAndHeight,vertexBuffer:p,componentDatatype:J.FLOAT,componentsPerAttribute:4},{index:F_.startFaceNormalAndVertexCorner,vertexBuffer:C,componentDatatype:J.FLOAT,componentsPerAttribute:4},{index:F_.endFaceNormalAndHalfWidth,vertexBuffer:x,componentDatatype:J.FLOAT,componentsPerAttribute:4},{index:F_.a_batchId,vertexBuffer:T,componentDatatype:J.UNSIGNED_SHORT,componentsPerAttribute:1}];t._va=new $n({context:n,attributes:S,indexBuffer:E}),t._positions=void 0,t._widths=void 0,t._counts=void 0,t._ellipsoid=void 0,t._minimumHeight=void 0,t._maximumHeight=void 0,t._rectangle=void 0,t._transferrableBatchIds=void 0,t._packedBuffer=void 0,t._startEllipsoidNormals=void 0,t._endEllipsoidNormals=void 0,t._startPositionAndHeights=void 0,t._startFaceNormalAndVertexCornerIds=void 0,t._endPositionAndHeights=void 0,t._endFaceNormalAndHalfWidths=void 0,t._vertexBatchIds=void 0,t._indices=void 0}}var cw=new N,aie=new m;function g4e(t,n){f(t._uniformMap)||(t._uniformMap={u_modifiedModelView:function(){let i=n.uniformState.view;return N.clone(i,cw),N.multiplyByPoint(cw,t._center,aie),N.setTranslation(cw,aie,cw),cw},u_highlightColor:function(){return t._highlightColor},u_minimumMaximumVectorHeights:function(){return t._minimumMaximumVectorHeights}})}function cie(t){return Ve.fromCache({cull:{enabled:!0,face:xi.FRONT},blending:ln.PRE_MULTIPLIED_ALPHA_BLEND,depthMask:!1,stencilTest:{enabled:t,frontFunction:kn.EQUAL,frontOperation:{fail:ft.KEEP,zFail:ft.KEEP,zPass:ft.KEEP},backFunction:kn.EQUAL,backOperation:{fail:ft.KEEP,zFail:ft.KEEP,zPass:ft.KEEP},reference:Ot.CESIUM_3D_TILE_MASK,mask:Ot.CESIUM_3D_TILE_MASK}})}function y4e(t){f(t._rs)||(t._rs=cie(!1),t._rs3DTiles=cie(!0))}function A4e(t,n){if(f(t._sp))return;let i=t._batchTable,o=i.getVertexShaderCallback(!1,"a_batchId",void 0)(oF),r=i.getFragmentShaderCallback(!1,void 0,!0)(rF),s=new ze({defines:["VECTOR_TILE",Vt.isInternetExplorer()?"":"CLIP_POLYLINE"],sources:[Tu,o]}),a=new ze({defines:["VECTOR_TILE"],sources:[r]});t._sp=qt.fromCache({context:n,vertexShaderSource:s,fragmentShaderSource:a,attributeLocations:F_})}function C4e(t,n){let i=t._command;if(!f(t._command)){let r=t._batchTable.getUniformMapCallback()(t._uniformMap);i=t._command=new et({owner:t,vertexArray:t._va,renderState:t._rs,shaderProgram:t._sp,uniformMap:r,boundingVolume:t._boundingVolume,pass:Te.TERRAIN_CLASSIFICATION,pickId:t._batchTable.getPickId()});let s=et.shallowClone(i,i.derivedCommands.tileset);s.renderState=t._rs3DTiles,s.pass=Te.CESIUM_3D_TILE_CLASSIFICATION,i.derivedCommands.tileset=s}let o=t._classificationType;(o===Un.TERRAIN||o===Un.BOTH)&&n.commandList.push(i),(o===Un.CESIUM_3D_TILE||o===Un.BOTH)&&n.commandList.push(i.derivedCommands.tileset)}Xm.prototype.getPositions=function(t){return Lx.getPolylinePositions(this,t)};Xm.prototype.createFeatures=function(t,n){let i=this._batchIds,o=i.length;for(let r=0;r<o;++r){let s=i[r];n[s]=new Ds(t,s)}};Xm.prototype.applyDebugSettings=function(t,n){this._highlightColor=t?n:this._constantColor};function x4e(t,n){let i=t._batchIds,o=i.length;for(let r=0;r<o;++r){let s=i[r],a=n[s];a.show=!0,a.color=z.WHITE}}var T4e=new z,E4e=z.WHITE,b4e=!0;Xm.prototype.applyStyle=function(t,n){if(!f(t)){x4e(this,n);return}let i=this._batchIds,o=i.length;for(let r=0;r<o;++r){let s=i[r],a=n[s];a.color=f(t.color)?t.color.evaluateColor(a,T4e):E4e,a.show=f(t.show)?t.show.evaluate(a):b4e}};function S4e(t){return ri.initialize().then(function(){return d4e(t,t._rectangle,t._ellipsoid),new Promise(function(n,i){t._update=function(o,r){let s=r.context,a=p4e(o,s);if(g4e(o,s),A4e(o,s),y4e(o),o._ready){let c=r.passes;(c.render||c.pick)&&C4e(o,r)}!f(a)||a.then(function(){_4e(o,s),n(o)}).catch(function(c){i(c)})}})})}Xm.prototype.update=function(t){this._update(this,t)};Xm.prototype.isDestroyed=function(){return!1};Xm.prototype.destroy=function(){return this._va=this._va&&this._va.destroy(),this._sp=this._sp&&this._sp.destroy(),ue(this)};var sF=Xm;var D5=32767,w4e=new de,D4e=new m;function v4e(t,n,i,o,r){let s=t.length/3,a=t.subarray(0,s),c=t.subarray(s,2*s),l=t.subarray(2*s,3*s);zn.zigZagDeltaDecode(a,c,l);let u=new Float64Array(t.length);for(let d=0;d<s;++d){let h=a[d],_=c[d],y=l[d],p=B.lerp(n.west,n.east,h/D5),C=B.lerp(n.south,n.north,_/D5),x=B.lerp(i,o,y/D5),T=de.fromRadians(p,C,x,w4e),E=r.cartographicToCartesian(T,D4e);m.pack(E,u,d*3)}return u}var aF=v4e;function uh(t,n,i,o,r){this._tileset=t,this._tile=n,this._resource=i,this._polygons=void 0,this._polylines=void 0,this._points=void 0,this._metadata=void 0,this._batchTable=void 0,this._features=void 0,this.featurePropertiesDirty=!1,this._group=void 0,R4e(this,o,r)}Object.defineProperties(uh.prototype,{featuresLength:{get:function(){return f(this._batchTable)?this._batchTable.featuresLength:0}},pointsLength:{get:function(){return f(this._points)?this._points.pointsLength:0}},trianglesLength:{get:function(){let t=0;return f(this._polygons)&&(t+=this._polygons.trianglesLength),f(this._polylines)&&(t+=this._polylines.trianglesLength),t}},geometryByteLength:{get:function(){let t=0;return f(this._polygons)&&(t+=this._polygons.geometryByteLength),f(this._polylines)&&(t+=this._polylines.geometryByteLength),t}},texturesByteLength:{get:function(){return f(this._points)?this._points.texturesByteLength:0}},batchTableByteLength:{get:function(){return f(this._batchTable)?this._batchTable.batchTableByteLength:0}},innerContents:{get:function(){}},readyPromise:{get:function(){let t=f(this._points)?this._points.readyPromise:void 0,n=f(this._polygons)?this._polygons.readyPromise:void 0,i=f(this._polylines)?this._polylines.readyPromise:void 0,o=this;return Promise.all([t,n,i]).then(function(){return o})}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._resource.getUrlComponent(!0)}},metadata:{get:function(){return this._metadata},set:function(t){this._metadata=t}},batchTable:{get:function(){return this._batchTable}},group:{get:function(){return this._group},set:function(t){this._group=t}}});function P4e(t){return function(n,i){f(t._polygons)&&t._polygons.updateCommands(n,i)}}function I4e(t,n){let i,o,r,s,a=A(t.POLYGONS_LENGTH,0),c=A(t.POLYLINES_LENGTH,0),l=A(t.POINTS_LENGTH,0);if(a>0&&f(t.POLYGON_BATCH_IDS)){let _=n.byteOffset+t.POLYGON_BATCH_IDS.byteOffset;i=new Uint16Array(n.buffer,_,a)}if(c>0&&f(t.POLYLINE_BATCH_IDS)){let _=n.byteOffset+t.POLYLINE_BATCH_IDS.byteOffset;o=new Uint16Array(n.buffer,_,c)}if(l>0&&f(t.POINT_BATCH_IDS)){let _=n.byteOffset+t.POINT_BATCH_IDS.byteOffset;r=new Uint16Array(n.buffer,_,l)}let u=f(i)||f(o)||f(r),d=a>0&&!f(i)||c>0&&!f(o)||l>0&&!f(r);if(u&&d)throw new he("If one group of batch ids is defined, then all batch ids must be defined.");if(!f(i)&&!f(o)&&!f(r)){let _=0;if(!f(i)&&a>0)for(i=new Uint16Array(a),s=0;s<a;++s)i[s]=_++;if(!f(o)&&c>0)for(o=new Uint16Array(c),s=0;s<c;++s)o[s]=_++;if(!f(r)&&l>0)for(r=new Uint16Array(l),s=0;s<l;++s)r[s]=_++}return{polygons:i,polylines:o,points:r}}var Vf=Uint32Array.BYTES_PER_ELEMENT;function B4e(t){return new Lx(t)}function O4e(t){return new sF(t)}function R4e(t,n,i){i=A(i,0);let o=new Uint8Array(n),r=new DataView(n);i+=Vf;let s=r.getUint32(i,!0);if(s!==1)throw new he(`Only Vector tile version 1 is supported.  Version ${s} is not.`);i+=Vf;let a=r.getUint32(i,!0);if(i+=Vf,a===0)return Promise.resolve(t);let c=r.getUint32(i,!0);if(i+=Vf,c===0)throw new he("Feature table must have a byte length greater than zero");let l=r.getUint32(i,!0);i+=Vf;let u=r.getUint32(i,!0);i+=Vf;let d=r.getUint32(i,!0);i+=Vf;let h=r.getUint32(i,!0);i+=Vf;let _=r.getUint32(i,!0);i+=Vf;let y=r.getUint32(i,!0);i+=Vf;let p=r.getUint32(i,!0);i+=Vf;let C=Ko(o,i,c);i+=c;let x=new Uint8Array(n,i,l);i+=l;let T,E;u>0&&(T=Ko(o,i,u),i+=u,d>0&&(E=new Uint8Array(n,i,d),E=new Uint8Array(E),i+=d));let S=A(C.POLYGONS_LENGTH,0),w=A(C.POLYLINES_LENGTH,0),D=A(C.POINTS_LENGTH,0),I=S+w+D,O=new E_(t,I,T,E,P4e(t));if(t._batchTable=O,I===0)return;let M=new Zd(C,x),L=M.getGlobalProperty("REGION");if(!f(L))throw new he("Feature table global property: REGION must be defined");let F=le.unpack(L),g=L[4],b=L[5],v=t._tile.computedTransform,P=M.getGlobalProperty("RTC_CENTER",J.FLOAT,3);f(P)?(P=m.unpack(P),N.multiplyByPoint(v,P,P)):(P=le.center(F),P.height=B.lerp(g,b,.5),P=oe.WGS84.cartographicToCartesian(P));let R=I4e(C,x);if(i+=(4-i%4)%4,S>0){M.featuresLength=S;let V=A(M.getPropertyArray("POLYGON_COUNTS",J.UNSIGNED_INT,1),M.getPropertyArray("POLYGON_COUNT",J.UNSIGNED_INT,1));if(!f(V))throw new he("Feature table property: POLYGON_COUNTS must be defined when POLYGONS_LENGTH is greater than 0");let H=A(M.getPropertyArray("POLYGON_INDEX_COUNTS",J.UNSIGNED_INT,1),M.getPropertyArray("POLYGON_INDEX_COUNT",J.UNSIGNED_INT,1));if(!f(H))throw new he("Feature table property: POLYGON_INDEX_COUNTS must be defined when POLYGONS_LENGTH is greater than 0");let U=V.reduce(function(j,Z){return j+Z*2},0),G=H.reduce(function(j,Z){return j+Z},0),k=new Uint32Array(n,i,G);i+=h;let X=new Uint16Array(n,i,U);i+=_;let Y,K;f(C.POLYGON_MINIMUM_HEIGHTS)&&f(C.POLYGON_MAXIMUM_HEIGHTS)&&(Y=M.getPropertyArray("POLYGON_MINIMUM_HEIGHTS",J.FLOAT,1),K=M.getPropertyArray("POLYGON_MAXIMUM_HEIGHTS",J.FLOAT,1)),t._polygons=new nF({positions:X,counts:V,indexCounts:H,indices:k,minimumHeight:g,maximumHeight:b,polygonMinimumHeights:Y,polygonMaximumHeights:K,center:P,rectangle:F,boundingVolume:t.tile.boundingVolume.boundingVolume,batchTable:O,batchIds:R.polygons,modelMatrix:v})}if(w>0){M.featuresLength=w;let V=A(M.getPropertyArray("POLYLINE_COUNTS",J.UNSIGNED_INT,1),M.getPropertyArray("POLYLINE_COUNT",J.UNSIGNED_INT,1));if(!f(V))throw new he("Feature table property: POLYLINE_COUNTS must be defined when POLYLINES_LENGTH is greater than 0");let H=M.getPropertyArray("POLYLINE_WIDTHS",J.UNSIGNED_SHORT,1);if(!f(H)){H=new Uint16Array(w);for(let K=0;K<w;++K)H[K]=2}let U=V.reduce(function(K,j){return K+j*3},0),G=new Uint16Array(n,i,U);i+=y;let k=t._tileset,X=k.examineVectorLinesFunction;if(f(X)){let K=aF(new Uint16Array(G),F,g,b,oe.WGS84);M4e(K,V,R.polylines,O,t.url,X)}let Y=B4e;f(k.classificationType)&&(Y=O4e),t._polylines=Y({positions:G,widths:H,counts:V,batchIds:R.polylines,minimumHeight:g,maximumHeight:b,center:P,rectangle:F,boundingVolume:t.tile.boundingVolume.boundingVolume,batchTable:O,classificationType:k.classificationType,keepDecodedPositions:k.vectorKeepDecodedPositions})}if(D>0){let V=new Uint16Array(n,i,D*3);i+=p,t._points=new tF({positions:V,batchIds:R.points,minimumHeight:g,maximumHeight:b,rectangle:F,batchTable:O})}return Promise.resolve(t)}function v5(t){let n=t.featuresLength;if(!f(t._features)&&n>0){let i=new Array(n);f(t._polygons)&&t._polygons.createFeatures(t,i),f(t._polylines)&&t._polylines.createFeatures(t,i),f(t._points)&&t._points.createFeatures(t,i),t._features=i}}uh.prototype.hasProperty=function(t,n){return this._batchTable.hasProperty(t,n)};uh.prototype.getFeature=function(t){return f(this._features)||v5(this),this._features[t]};uh.prototype.applyDebugSettings=function(t,n){f(this._polygons)&&this._polygons.applyDebugSettings(t,n),f(this._polylines)&&this._polylines.applyDebugSettings(t,n),f(this._points)&&this._points.applyDebugSettings(t,n)};uh.prototype.applyStyle=function(t){f(this._features)||v5(this),f(this._polygons)&&this._polygons.applyStyle(t,this._features),f(this._polylines)&&this._polylines.applyStyle(t,this._features),f(this._points)&&this._points.applyStyle(t,this._features)};uh.prototype.update=function(t,n){let i=!0;f(this._polygons)&&(this._polygons.classificationType=this._tileset.classificationType,this._polygons.debugWireframe=this._tileset.debugWireframe,this._polygons.update(n),i=i&&this._polygons._ready),f(this._polylines)&&(this._polylines.update(n),i=i&&this._polylines._ready),f(this._points)&&(this._points.update(n),i=i&&this._points._ready),f(this._batchTable)&&i&&(f(this._features)||v5(this),this._batchTable.update(t,n))};uh.prototype.getPolylinePositions=function(t){let n=this._polylines;if(!!f(n))return n.getPositions(t)};uh.prototype.isDestroyed=function(){return!1};uh.prototype.destroy=function(){return this._polygons=this._polygons&&this._polygons.destroy(),this._polylines=this._polylines&&this._polylines.destroy(),this._points=this._points&&this._points.destroy(),this._batchTable=this._batchTable&&this._batchTable.destroy(),ue(this)};function M4e(t,n,i,o,r,s){let a=n.length,c=0;for(let l=0;l<a;l++){let u=n[l]*3,d=t.slice(c,c+u);c+=u,s(d,i[l],r,o)}}var cF=uh;var lie={b3dm:function(t,n,i,o,r){return zm.fromB3dm(t,n,i,o,r)},pnts:function(t,n,i,o,r){return zm.fromPnts(t,n,i,o,r)},i3dm:function(t,n,i,o,r){return zm.fromI3dm(t,n,i,o,r)},cmpt:function(t,n,i,o,r){return new EL(t,n,i,o,r,lie)},externalTileset:function(t,n,i,o){return new HL(t,n,i,o)},geom:function(t,n,i,o,r){return new RL(t,n,i,o,r)},vctr:function(t,n,i,o,r){return new cF(t,n,i,o,r)},subt:function(t,n,i,o,r){return new YS(t,n,i,void 0,o,r)},subtreeJson:function(t,n,i,o){return new YS(t,n,i,o)},glb:function(t,n,i,o,r){if(o.byteLength<12)throw new he("Invalid glb content");let c=new DataView(o,r).getUint32(8,!0),l=new Uint8Array(o,r,c);return zm.fromGltf(t,n,i,l)},gltf:function(t,n,i,o){return zm.fromGltf(t,n,i,o)},geoJson:function(t,n,i,o){return zm.fromGeoJson(t,n,i,o)}},Fx=lie;var L4e={UNLOADED:0,LOADING:1,PROCESSING:2,READY:3,EXPIRED:4,FAILED:5},So=Object.freeze(L4e);var fh={BATCHED_3D_MODEL:"b3dm",INSTANCED_3D_MODEL:"i3dm",COMPOSITE:"cmpt",POINT_CLOUD:"pnts",VECTOR:"vctr",GEOMETRY:"geom",GLTF:"gltf",GLTF_BINARY:"glb",IMPLICIT_SUBTREE:"subt",IMPLICIT_SUBTREE_JSON:"subtreeJson",EXTERNAL_TILESET:"externalTileset",MULTIPLE_CONTENT:"multipleContent",GEOJSON:"geoJson"};fh.isBinaryFormat=function(t){switch(t){case fh.BATCHED_3D_MODEL:case fh.INSTANCED_3D_MODEL:case fh.COMPOSITE:case fh.POINT_CLOUD:case fh.VECTOR:case fh.GEOMETRY:case fh.IMPLICIT_SUBTREE:case fh.GLTF_BINARY:return!0;default:return!1}};var Os=Object.freeze(fh);var F4e={NOT_COMPUTED:-1,USE_OPTIMIZATION:1,SKIP_OPTIMIZATION:0},kf=Object.freeze(F4e);function uie(){}var lw={stack:new Eu,stackMaximumLength:0};uie.selectTiles=function(t,n){t._selectedTiles.length=0,t._requestedTiles.length=0,t._hasMixedContent=!1;let i=!0,o=t.root;if(o.updateVisibility(n),!fie(o))return i;let r=lw.stack;for(r.push(t.root);r.length>0;){lw.stackMaximumLength=Math.max(lw.stackMaximumLength,r.length);let s=r.pop(),a=s.refine===Or.ADD,c=s.refine===Or.REPLACE,l=V4e(t,s);l&&k4e(t,s,r,n),(a||c&&!l)&&(U4e(t,s),z4e(t,s,n),G4e(t,s,n),!die(s)&&!s.contentAvailable&&(i=!1)),H4e(t)}return lw.stack.trim(lw.stackMaximumLength),i};function fie(t){return t._visible&&t._inRequestVolume}function die(t){return t.hasEmptyContent||t.hasTilesetContent||t.hasImplicitContent}function N4e(t){return!die(t)&&t.contentUnloaded}function V4e(t,n){return n.children.length===0?!1:n.hasTilesetContent||n.hasImplicitContent?!n.contentExpired:(n.hasEmptyContent,!0)}function k4e(t,n,i,o){let r=n.children,s=r.length;for(let a=0;a<s;++a){let c=r[a];c.updateVisibility(o),fie(c)&&i.push(c)}}function U4e(t,n){(N4e(n)||n.contentExpired)&&(n._priority=0,t._requestedTiles.push(n))}function z4e(t,n,i){n._touchedFrame!==i.frameNumber&&(t._cache.touch(n),n._touchedFrame=i.frameNumber)}function H4e(t){++t.statistics.visited}function G4e(t,n,i){n.contentAvailable&&n.contentVisibility(i)!==jt.OUTSIDE&&t._selectedTiles.push(n)}var uw=uie;function hie(){}function py(t){return t._visible&&t._inRequestVolume}var fw={stack:new Eu,stackMaximumLength:0},dw={stack:new Eu,stackMaximumLength:0},hw={stack:new Eu,stackMaximumLength:0},dh={stack:new Eu,stackMaximumLength:0,ancestorStack:new Eu,ancestorStackMaximumLength:0},W4e=2;hie.selectTiles=function(t,n){if(t._requestedTiles.length=0,t.debugFreezeFrame)return;t._selectedTiles.length=0,t._selectedTilesToStyle.length=0,t._emptyTiles.length=0,t._hasMixedContent=!1;let i=t.root;if(fF(t,i,n),!py(i)||i.getScreenSpaceError(n,!0)<=t._maximumScreenSpaceError)return;pw(t)?t.immediatelyLoadDesiredLevelOfDetail?q4e(t,i,n):Y4e(t,i,n):j4e(t,i,n),fw.stack.trim(fw.stackMaximumLength),dw.stack.trim(dw.stackMaximumLength),hw.stack.trim(hw.stackMaximumLength),dh.stack.trim(dh.stackMaximumLength),dh.ancestorStack.trim(dh.ancestorStackMaximumLength);let o=t._requestedTiles,r=o.length;for(let s=0;s<r;++s)o[s].updatePriority()};function j4e(t,n,i){let o=t._maximumScreenSpaceError,r=t._maximumScreenSpaceError;I5(t,n,o,r,i)}function q4e(t,n,i){let o=Number.MAX_VALUE,r=t._maximumScreenSpaceError;I5(t,n,o,r,i),gie(t,n,i)}function Y4e(t,n,i){let o=Math.max(t.baseScreenSpaceError,t.maximumScreenSpaceError),r=t.maximumScreenSpaceError;I5(t,n,o,r,i),gie(t,n,i)}function pw(t){return t._skipLevelOfDetail}function X4e(t,n){t._emptyTiles.push(n)}function mw(t,n,i){if(n.contentVisibility(i)!==jt.OUTSIDE){let o=n.content;o.featurePropertiesDirty?(o.featurePropertiesDirty=!1,n.lastStyleTime=0,t._selectedTilesToStyle.push(n)):n._selectedFrame<i.frameNumber-1&&t._selectedTilesToStyle.push(n),n._selectedFrame=i.frameNumber,t._selectedTiles.push(n)}}function K4e(t,n,i){let o=hw.stack;for(o.push(n);o.length>0;){hw.stackMaximumLength=Math.max(hw.stackMaximumLength,o.length);let s=o.pop().children,a=s.length;for(let c=0;c<a;++c){let l=s[c];py(l)&&(l.contentAvailable?(fF(t,l,i),uF(t,l,i),mw(t,l,i)):l._depth-n._depth<W4e&&o.push(l))}}}function lF(t,n,i){if(!pw(t)){n.contentAvailable&&mw(t,n,i);return}let o=n.contentAvailable?n:n._ancestorWithContentAvailable;f(o)?o._shouldSelect=!0:K4e(t,n,i)}function J4e(t,n,i){++t._statistics.visited,n._visitedFrame=i.frameNumber}function uF(t,n,i){n._touchedFrame!==i.frameNumber&&(t._cache.touch(n),n._touchedFrame=i.frameNumber)}function Z4e(t,n){t._maximumPriority.distance=Math.max(n._priorityHolder._distanceToCamera,t._maximumPriority.distance),t._minimumPriority.distance=Math.min(n._priorityHolder._distanceToCamera,t._minimumPriority.distance),t._maximumPriority.depth=Math.max(n._depth,t._maximumPriority.depth),t._minimumPriority.depth=Math.min(n._depth,t._minimumPriority.depth),t._maximumPriority.foveatedFactor=Math.max(n._priorityHolder._foveatedFactor,t._maximumPriority.foveatedFactor),t._minimumPriority.foveatedFactor=Math.min(n._priorityHolder._foveatedFactor,t._minimumPriority.foveatedFactor),t._maximumPriority.reverseScreenSpaceError=Math.max(n._priorityReverseScreenSpaceError,t._maximumPriority.reverseScreenSpaceError),t._minimumPriority.reverseScreenSpaceError=Math.min(n._priorityReverseScreenSpaceError,t._minimumPriority.reverseScreenSpaceError)}function Q4e(t,n,i){if(!t._cullRequestsWhileMoving)return!0;let o=n.boundingSphere,r=Math.max(o.radius*2,1),s=i.camera,a=s.positionWCDeltaMagnitude!==0?s.positionWCDeltaMagnitude:s.positionWCDeltaMagnitudeLastFrame;return t.cullRequestsWhileMovingMultiplier*a/r<1}function my(t,n,i){if(n._requestedFrame===i.frameNumber||!_ie(n)&&!n.contentExpired||!Q4e(t,n,i))return;let o=i.camera.timeSinceMoved<t.foveatedTimeDelay;n.priorityDeferred&&o||(n._requestedFrame=i.frameNumber,t._requestedTiles.push(n))}function mie(t,n,i){n._updatedVisibilityFrame!==t._updatedVisibilityFrame&&(n.updateVisibility(i),n._updatedVisibilityFrame=t._updatedVisibilityFrame)}function $4e(t,n,i){let o=!1,r=n.children,s=r.length;for(let a=0;a<s;++a){let c=r[a];mie(t,c,i),o=o||py(c)}return o}function eze(t,n,i){let o=n.parent;return!f(o)||o.hasTilesetContent||o.hasImplicitContent||o.refine!==Or.ADD?!1:n.getScreenSpaceError(i,!0)<=t._maximumScreenSpaceError}function pie(t,n,i){if(mie(t,n,i),!py(n))return;let o=n.children.length>0;if((n.hasTilesetContent||n.hasImplicitContent)&&o){let a=n.children[0];pie(t,a,i),n._visible=a._visible;return}if(eze(t,n,i)){n._visible=!1;return}let r=n.refine===Or.REPLACE,s=n._optimChildrenWithinParent===kf.USE_OPTIMIZATION;if(r&&s&&o&&!$4e(t,n,i)){++t._statistics.numberOfTilesCulledWithChildrenUnion,n._visible=!1;return}}function fF(t,n,i){pie(t,n,i),n.updateExpiration(),n._wasMinPriorityChild=!1,n._priorityHolder=n,Z4e(t,n),n._shouldSelect=!1,n._finalResolution=!0}function tze(t,n){t._ancestorWithContent=void 0,t._ancestorWithContentAvailable=void 0;let i=t.parent;if(f(i)){let o=!_ie(i)||i._requestedFrame===n.frameNumber;t._ancestorWithContent=o?i:i._ancestorWithContent,t._ancestorWithContentAvailable=i.contentAvailable?i:i._ancestorWithContentAvailable}}function _w(t){return t.hasEmptyContent||t.hasTilesetContent||t.hasImplicitContent}function _ie(t){return!_w(t)&&t.contentUnloaded}function nze(t,n){let i=n._ancestorWithContent;return!t.immediatelyLoadDesiredLevelOfDetail&&(n._priorityProgressiveResolutionScreenSpaceErrorLeaf||f(i)&&n._screenSpaceError<i._screenSpaceError/t.skipScreenSpaceErrorFactor&&n._depth>i._depth+t.skipLevels)}function ize(t,n){return n._distanceToCamera===0&&t._distanceToCamera===0?n._centerZDepth-t._centerZDepth:n._distanceToCamera-t._distanceToCamera}function oze(t,n,i,o){let r,s=n.refine===Or.REPLACE,a=n.children,c=a.length;for(r=0;r<c;++r)fF(t,a[r],o);a.sort(ize);let l=!pw(t)&&s&&!_w(n),u=!0,d=!1,h=-1,_=Number.MAX_VALUE,y;for(r=0;r<c;++r)if(y=a[r],py(y)?(i.push(y),y._foveatedFactor<_&&(h=r,_=y._foveatedFactor),d=!0):(l||t.loadSiblings)&&(y._foveatedFactor<_&&(h=r,_=y._foveatedFactor),my(t,y,o),uF(t,y,o)),l){let p;y._inRequestVolume?_w(y)?p=sze(t,y,o):p=y.contentAvailable:p=!1,u=u&&p}if(d||(u=!1),h!==-1&&!pw(t)&&s){let p=a[h];p._wasMinPriorityChild=!0;let C=(n._wasMinPriorityChild||n===t.root)&&_<=n._priorityHolder._foveatedFactor?n._priorityHolder:n;for(C._foveatedFactor=Math.min(p._foveatedFactor,C._foveatedFactor),C._distanceToCamera=Math.min(p._distanceToCamera,C._distanceToCamera),r=0;r<c;++r)y=a[r],y._priorityHolder=C}return u}function rze(t,n,i){return pw(t)?t.immediatelyLoadDesiredLevelOfDetail?!1:f(n._ancestorWithContent)?n._screenSpaceError===0?n.parent._screenSpaceError>i:n._screenSpaceError>i:!0:!0}function P5(t,n){return n.children.length===0?!1:n.hasTilesetContent||n.hasImplicitContent?!n.contentExpired:n._screenSpaceError>t._maximumScreenSpaceError}function I5(t,n,i,o,r){let s=fw.stack;for(s.push(n);s.length>0;){fw.stackMaximumLength=Math.max(fw.stackMaximumLength,s.length);let a=s.pop();tze(a,r);let c=rze(t,a,i),l=a.refine===Or.ADD,u=a.refine===Or.REPLACE,d=a.parent,h=!f(d)||d._refines,_=!1;P5(t,a)&&(_=oze(t,a,s,r)&&h);let y=!_&&h;_w(a)?(X4e(t,a,r),my(t,a,r),y&&lF(t,a,r)):l?(lF(t,a,r),my(t,a,r)):u&&(c?(my(t,a,r),y&&lF(t,a,r)):y?(lF(t,a,r),my(t,a,r)):nze(t,a)&&my(t,a,r)),J4e(t,a,r),uF(t,a,r),a._refines=_}}function sze(t,n,i){let o=!0,r=dw.stack;for(r.push(n);r.length>0;){dw.stackMaximumLength=Math.max(dw.stackMaximumLength,r.length);let s=r.pop(),a=s.children,c=a.length,l=_w(s),u=l&&P5(t,s),d=l&&s.children.length===0;if(!u&&!s.contentAvailable&&!d&&(o=!1),fF(t,s,i),py(s)||(my(t,s,i),uF(t,s,i)),u)for(let h=0;h<c;++h){let _=a[h];r.push(_)}}return o}function gie(t,n,i){let o=dh.stack,r=dh.ancestorStack,s;for(o.push(n);o.length>0||r.length>0;){if(dh.stackMaximumLength=Math.max(dh.stackMaximumLength,o.length),dh.ancestorStackMaximumLength=Math.max(dh.ancestorStackMaximumLength,r.length),r.length>0){let _=r.peek();if(_._stackLength===o.length){r.pop(),_!==s&&(_._finalResolution=!1),mw(t,_,i);continue}}let a=o.pop();if(!f(a))continue;let c=a.refine===Or.ADD,l=a._shouldSelect,u=a.children,d=u.length,h=P5(t,a);if(l)if(c)mw(t,a,i);else{if(a._selectionDepth=r.length,a._selectionDepth>0&&(t._hasMixedContent=!0),s=a,!h){mw(t,a,i);continue}r.push(a),a._stackLength=o.length}if(h)for(let _=0;_<d;++_){let y=u[_];py(y)&&o.push(y)}}}var Km=hie;var Uf={RENDER:0,PICK:1,SHADOW:2,PRELOAD:3,PRELOAD_FLIGHT:4,REQUEST_RENDER_MODE_DEFER_CHECK:5,MOST_DETAILED_PRELOAD:6,MOST_DETAILED_PICK:7,NUMBER_OF_PASSES:8},Jm=new Array(Uf.NUMBER_OF_PASSES);Jm[Uf.RENDER]=Object.freeze({traversal:Km,isRender:!0,requestTiles:!0,ignoreCommands:!1});Jm[Uf.PICK]=Object.freeze({traversal:Km,isRender:!1,requestTiles:!1,ignoreCommands:!1});Jm[Uf.SHADOW]=Object.freeze({traversal:Km,isRender:!1,requestTiles:!0,ignoreCommands:!1});Jm[Uf.PRELOAD]=Object.freeze({traversal:Km,isRender:!1,requestTiles:!0,ignoreCommands:!0});Jm[Uf.PRELOAD_FLIGHT]=Object.freeze({traversal:Km,isRender:!1,requestTiles:!0,ignoreCommands:!0});Jm[Uf.REQUEST_RENDER_MODE_DEFER_CHECK]=Object.freeze({traversal:Km,isRender:!1,requestTiles:!0,ignoreCommands:!0});Jm[Uf.MOST_DETAILED_PRELOAD]=Object.freeze({traversal:uw,isRender:!1,requestTiles:!0,ignoreCommands:!0});Jm[Uf.MOST_DETAILED_PICK]=Object.freeze({traversal:uw,isRender:!1,requestTiles:!1,ignoreCommands:!1});Uf.getPassOptions=function(t){return Jm[t]};var er=Object.freeze(Uf);function Zm(t,n){this._tileset=t,this._tile=n,this.featurePropertiesDirty=!1}Object.defineProperties(Zm.prototype,{featuresLength:{get:function(){return 0}},pointsLength:{get:function(){return 0}},trianglesLength:{get:function(){return 0}},geometryByteLength:{get:function(){return 0}},texturesByteLength:{get:function(){return 0}},batchTableByteLength:{get:function(){return 0}},innerContents:{get:function(){}},readyPromise:{get:function(){}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){}},metadata:{get:function(){},set:function(t){}},batchTable:{get:function(){}},group:{get:function(){},set:function(t){}}});Zm.prototype.hasProperty=function(t,n){return!1};Zm.prototype.getFeature=function(t){};Zm.prototype.applyDebugSettings=function(t,n){};Zm.prototype.applyStyle=function(t){};Zm.prototype.update=function(t,n){};Zm.prototype.isDestroyed=function(){return!1};Zm.prototype.destroy=function(){return ue(this)};var gw=Zm;function Qm(t){t=A(t,A.EMPTY_OBJECT);let n=t.content,i=t.class;this._class=i,this._properties=n.properties,this._extensions=n.extensions,this._extras=n.extras}Object.defineProperties(Qm.prototype,{class:{get:function(){return this._class}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}});Qm.prototype.hasProperty=function(t){return Nn.hasProperty(t,this._properties,this._class)};Qm.prototype.hasPropertyBySemantic=function(t){return Nn.hasPropertyBySemantic(t,this._properties,this._class)};Qm.prototype.getPropertyIds=function(t){return Nn.getPropertyIds(this._properties,this._class,t)};Qm.prototype.getProperty=function(t){return Nn.getProperty(t,this._properties,this._class)};Qm.prototype.setProperty=function(t,n){return Nn.setProperty(t,n,this._properties,this._class)};Qm.prototype.getPropertyBySemantic=function(t){return Nn.getPropertyBySemantic(t,this._properties,this._class)};Qm.prototype.setPropertyBySemantic=function(t,n){return Nn.setPropertyBySemantic(t,n,this._properties,this._class)};var dF=Qm;function B5(t,n){let i=Li(n,"3DTILES_metadata")?n.extensions["3DTILES_metadata"]:n.metadata;if(!f(i))return;if(!f(t.schema)){B5._oneTimeWarning("findContentMetadata-missing-root-schema","Could not find a metadata schema for content metadata. For tilesets that contain external tilesets, make sure the schema is added to the root tileset.json.");return}let o=A(t.schema.classes,A.EMPTY_OBJECT);if(f(i.class)){let r=o[i.class];return new dF({content:i,class:r})}}B5._oneTimeWarning=Bt;var Nx=B5;function aze(t,n){let i=t.metadataExtension;if(!f(i))return;let o=i.groups,r=Li(n,"3DTILES_metadata")?n.extensions["3DTILES_metadata"].group:n.group;if(typeof r=="number")return o[r];let s=i.groupIds.findIndex(function(a){return a===r});return s>=0?o[s]:void 0}var Vx=aze;function $m(t){t=A(t,A.EMPTY_OBJECT);let n=t.tile,i=t.class;this._class=i,this._properties=n.properties,this._extensions=n.extensions,this._extras=n.extras}Object.defineProperties($m.prototype,{class:{get:function(){return this._class}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}});$m.prototype.hasProperty=function(t){return Nn.hasProperty(t,this._properties,this._class)};$m.prototype.hasPropertyBySemantic=function(t){return Nn.hasPropertyBySemantic(t,this._properties,this._class)};$m.prototype.getPropertyIds=function(t){return Nn.getPropertyIds(this._properties,this._class,t)};$m.prototype.getProperty=function(t){return Nn.getProperty(t,this._properties,this._class)};$m.prototype.setProperty=function(t,n){return Nn.setProperty(t,n,this._properties,this._class)};$m.prototype.getPropertyBySemantic=function(t){return Nn.getPropertyBySemantic(t,this._properties,this._class)};$m.prototype.setPropertyBySemantic=function(t,n){return Nn.setPropertyBySemantic(t,n,this._properties,this._class)};var hF=$m;function O5(t,n){let i=Li(n,"3DTILES_metadata")?n.extensions["3DTILES_metadata"]:n.metadata;if(!f(i))return;if(!f(t.schema)){O5._oneTimeWarning("findTileMetadata-missing-root-schema","Could not find a metadata schema for tile metadata. For tilesets that contain external tilesets, make sure the schema is added to the root tileset.json.");return}let o=A(t.schema.classes,A.EMPTY_OBJECT);if(f(i.class)){let r=o[i.class];return new hF({tile:i,class:r})}}O5._oneTimeWarning=Bt;var mF=O5;function cze(t){let n=new Uint8Array(t),i=Wd(n);if(i==="glTF"&&(i="glb"),Os.isBinaryFormat(i))return{contentType:i,binaryPayload:n};let o=lze(n);if(f(o.root))return{contentType:Os.EXTERNAL_TILESET,jsonPayload:o};if(f(o.asset))return{contentType:Os.GLTF,jsonPayload:o};if(f(o.tileAvailability))return{contentType:Os.IMPLICIT_SUBTREE_JSON,jsonPayload:o};if(f(o.type))return{contentType:Os.GEOJSON,jsonPayload:o};throw new he("Invalid tile content.")}function lze(t){let n;try{n=Ko(t)}catch(i){throw new he("Invalid tile content.")}return n}var kx=cze;function zf(t,n,i,o){this._tileset=t,this._tile=n,this._tilesetResource=i,this._contents=[],this._contentsCreated=!1;let r=f(o.contents)?o.contents:o.content;this._innerContentHeaders=r,this._requestsInFlight=0,this._cancelCount=0;let s=this._innerContentHeaders.length;this._arrayFetchPromises=new Array(s),this._requests=new Array(s),this._innerContentResources=new Array(s),this._serverKeys=new Array(s);for(let a=0;a<s;a++){let c=i.getDerivedResource({url:r[a].uri}),l=ec.getServerKey(c.getUrlComponent());this._innerContentResources[a]=c,this._serverKeys[a]=l}this._contentsFetchedPromise=void 0}Object.defineProperties(zf.prototype,{featurePropertiesDirty:{get:function(){let t=this._contents,n=t.length;for(let i=0;i<n;++i)if(t[i].featurePropertiesDirty)return!0;return!1},set:function(t){let n=this._contents,i=n.length;for(let o=0;o<i;++o)n[o].featurePropertiesDirty=t}},featuresLength:{get:function(){return 0}},pointsLength:{get:function(){return 0}},trianglesLength:{get:function(){return 0}},geometryByteLength:{get:function(){return 0}},texturesByteLength:{get:function(){return 0}},batchTableByteLength:{get:function(){return 0}},innerContents:{get:function(){return this._contents}},readyPromise:{get:function(){if(!this._contentsCreated)return;let t=this._contents.map(function(i){return i.readyPromise}),n=this;return Promise.all(t).then(function(){return n})}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){}},metadata:{get:function(){},set:function(){}},batchTable:{get:function(){}},group:{get:function(){},set:function(){}},innerContentUrls:{get:function(){return this._innerContentHeaders.map(function(t){return t.uri})}},contentsFetchedPromise:{get:function(){return this._contentsFetchedPromise}}});function R5(t,n){t._requestsInFlight+=n,t.tileset.statistics.numberOfPendingRequests+=n}function uze(t,n){t._cancelCount++,t._tile._contentState=n;let i=t.tileset.statistics;i.numberOfPendingRequests-=t._requestsInFlight,i.numberOfAttemptedRequests+=t._requestsInFlight,t._requestsInFlight=0;let o=t._innerContentHeaders.length;t._arrayFetchPromises=new Array(o)}zf.prototype.requestInnerContents=function(){if(!fze(this._serverKeys))return this._serverKeys.length;let t=this._innerContentHeaders;R5(this,t.length);for(let n=0;n<t.length;n++)this._arrayFetchPromises[n]=dze(this,n,this._cancelCount,this._tile._contentState);return this._contentsFetchedPromise=hze(this),0};function fze(t){let n={};for(let i=0;i<t.length;i++){let o=t[i];f(n[o])?n[o]++:n[o]=1}for(let i in n)if(n.hasOwnProperty(i)&&!ec.serverHasOpenSlots(i,n[i]))return!1;return ec.heapHasOpenSlots(t.length)}function dze(t,n,i,o){let r=t._innerContentResources[n].clone(),s=t.tile,a=function(){return s._priority},c=t._serverKeys[n],l=new qo({throttle:!0,throttleByServer:!0,type:Qr.TILES3D,priorityFunction:a,serverKey:c});r.request=l,t._requests[n]=l;let u=r.fetchArrayBuffer();return f(u)?u.then(function(d){if(!(i<t._cancelCount))return R5(t,-1),d}).catch(function(d){if(!(i<t._cancelCount)){if(r.request.state===ai.CANCELLED){uze(t,o);return}R5(t,-1),yie(t,n,d)}}):Promise.resolve(void 0)}function hze(t){let n=t._cancelCount;return Promise.all(t._arrayFetchPromises).then(function(i){if(n<t._cancelCount)return;let o=i.map(function(r,s){if(!!f(r))return mze(t,r,s)});t._contentsCreated=!0,t._contents=o.filter(f)})}function mze(t,n,i){let o=kx(n);if(o.contentType===Os.EXTERNAL_TILESET){let h=new he("External tilesets are disallowed inside multiple contents");return yie(t,i,h)}t._disableSkipLevelOfDetail=t._disableSkipLevelOfDetail||o.contentType===Os.GEOMETRY||o.contentType===Os.VECTOR;let r=t._tileset,s=t._innerContentResources[i],a=t._tile,c,l=Fx[o.contentType];f(o.binaryPayload)?c=l(r,a,s,o.binaryPayload.buffer,0):c=l(r,a,s,o.jsonPayload);let u=t._innerContentHeaders[i];if(a.hasImplicitContentMetadata){let h=a.implicitSubtree,_=a.implicitCoordinates;c.metadata=h.getContentMetadataView(_,i)}else a.hasImplicitContent||(c.metadata=Nx(r,u));let d=Vx(r,u);return f(d)&&(c.group=new wx({metadata:d})),c}function yie(t,n,i){let o=t._tileset,r=t._innerContentResources[n].url,s=f(i.message)?i.message:i.toString();o.tileFailed.numberOfListeners>0?o.tileFailed.raiseEvent({url:r,message:s}):(console.log(`A content failed to load: ${r}`),console.log(`Error: ${s}`))}zf.prototype.cancelRequests=function(){for(let t=0;t<this._requests.length;t++){let n=this._requests[t];f(n)&&n.cancel()}};zf.prototype.hasProperty=function(t,n){return!1};zf.prototype.getFeature=function(t){};zf.prototype.applyDebugSettings=function(t,n){let i=this._contents,o=i.length;for(let r=0;r<o;++r)i[r].applyDebugSettings(t,n)};zf.prototype.applyStyle=function(t){let n=this._contents,i=n.length;for(let o=0;o<i;++o)n[o].applyStyle(t)};zf.prototype.update=function(t,n){let i=this._contents,o=i.length;for(let r=0;r<o;++r)i[r].update(t,n)};zf.prototype.isDestroyed=function(){return!1};zf.prototype.destroy=function(){let t=this._contents,n=t.length;for(let i=0;i<n;++i)t[i].destroy();return ue(this)};var pF=zf;var Die=yo(Eie(),1);var Ize=new m,Bze=new m,N_={};N_.computeArea2D=function(t){let n=t.length,i=0;for(let o=n-1,r=0;r<n;o=r++){let s=t[o],a=t[r];i+=s.x*a.y-a.x*s.y}return i*.5};N_.computeWindingOrder2D=function(t){return N_.computeArea2D(t)>0?$r.COUNTER_CLOCKWISE:$r.CLOCKWISE};N_.triangulate=function(t,n){let i=W.packArray(t);return(0,Die.default)(i,n,2)};var vie=new m,Pie=new m,Iie=new m,bie=new m,Sie=new m,wie=new m,ep=new m,Bie=new W,Oie=new W,Rie=new W,zx=new W;N_.computeSubdivision=function(t,n,i,o,r){r=A(r,B.RADIANS_PER_DEGREE);let s=f(o),a=i.slice(0),c,l=n.length,u=new Array(l*3),d=new Array(l*2),h=0,_=0;for(c=0;c<l;c++){let S=n[c];if(u[h++]=S.x,u[h++]=S.y,u[h++]=S.z,s){let w=o[c];d[_++]=w.x,d[_++]=w.y}}let y=[],p={},C=t.maximumRadius,x=B.chordLength(r,C),T=x*x;for(;a.length>0;){let S=a.pop(),w=a.pop(),D=a.pop(),I=m.fromArray(u,D*3,vie),O=m.fromArray(u,w*3,Pie),M=m.fromArray(u,S*3,Iie),L,F,g;s&&(L=W.fromArray(d,D*2,Bie),F=W.fromArray(d,w*2,Oie),g=W.fromArray(d,S*2,Rie));let b=m.multiplyByScalar(m.normalize(I,bie),C,bie),v=m.multiplyByScalar(m.normalize(O,Sie),C,Sie),P=m.multiplyByScalar(m.normalize(M,wie),C,wie),R=m.magnitudeSquared(m.subtract(b,v,ep)),V=m.magnitudeSquared(m.subtract(v,P,ep)),H=m.magnitudeSquared(m.subtract(P,b,ep)),U=Math.max(R,V,H),G,k,X;U>T?R===U?(G=`${Math.min(D,w)} ${Math.max(D,w)}`,c=p[G],f(c)||(k=m.add(I,O,ep),m.multiplyByScalar(k,.5,k),u.push(k.x,k.y,k.z),c=u.length/3-1,p[G]=c,s&&(X=W.add(L,F,zx),W.multiplyByScalar(X,.5,X),d.push(X.x,X.y))),a.push(D,c,S),a.push(c,w,S)):V===U?(G=`${Math.min(w,S)} ${Math.max(w,S)}`,c=p[G],f(c)||(k=m.add(O,M,ep),m.multiplyByScalar(k,.5,k),u.push(k.x,k.y,k.z),c=u.length/3-1,p[G]=c,s&&(X=W.add(F,g,zx),W.multiplyByScalar(X,.5,X),d.push(X.x,X.y))),a.push(w,c,D),a.push(c,S,D)):H===U&&(G=`${Math.min(S,D)} ${Math.max(S,D)}`,c=p[G],f(c)||(k=m.add(M,I,ep),m.multiplyByScalar(k,.5,k),u.push(k.x,k.y,k.z),c=u.length/3-1,p[G]=c,s&&(X=W.add(g,L,zx),W.multiplyByScalar(X,.5,X),d.push(X.x,X.y))),a.push(S,c,w),a.push(c,D,w)):(y.push(D),y.push(w),y.push(S))}let E={attributes:{position:new we({componentDatatype:J.DOUBLE,componentsPerAttribute:3,values:u})},indices:y,primitiveType:Re.TRIANGLES};return s&&(E.attributes.st=new we({componentDatatype:J.FLOAT,componentsPerAttribute:2,values:d})),new at(E)};var Oze=new de,Rze=new de,Mze=new de,V5=new de;N_.computeRhumbLineSubdivision=function(t,n,i,o,r){r=A(r,B.RADIANS_PER_DEGREE);let s=f(o),a=i.slice(0),c,l=n.length,u=new Array(l*3),d=new Array(l*2),h=0,_=0;for(c=0;c<l;c++){let D=n[c];if(u[h++]=D.x,u[h++]=D.y,u[h++]=D.z,s){let I=o[c];d[_++]=I.x,d[_++]=I.y}}let y=[],p={},C=t.maximumRadius,x=B.chordLength(r,C),T=new Ia(void 0,void 0,t),E=new Ia(void 0,void 0,t),S=new Ia(void 0,void 0,t);for(;a.length>0;){let D=a.pop(),I=a.pop(),O=a.pop(),M=m.fromArray(u,O*3,vie),L=m.fromArray(u,I*3,Pie),F=m.fromArray(u,D*3,Iie),g,b,v;s&&(g=W.fromArray(d,O*2,Bie),b=W.fromArray(d,I*2,Oie),v=W.fromArray(d,D*2,Rie));let P=t.cartesianToCartographic(M,Oze),R=t.cartesianToCartographic(L,Rze),V=t.cartesianToCartographic(F,Mze);T.setEndPoints(P,R);let H=T.surfaceDistance;E.setEndPoints(R,V);let U=E.surfaceDistance;S.setEndPoints(V,P);let G=S.surfaceDistance,k=Math.max(H,U,G),X,Y,K,j,Z;k>x?H===k?(X=`${Math.min(O,I)} ${Math.max(O,I)}`,c=p[X],f(c)||(Y=T.interpolateUsingFraction(.5,V5),K=(P.height+R.height)*.5,j=m.fromRadians(Y.longitude,Y.latitude,K,t,ep),u.push(j.x,j.y,j.z),c=u.length/3-1,p[X]=c,s&&(Z=W.add(g,b,zx),W.multiplyByScalar(Z,.5,Z),d.push(Z.x,Z.y))),a.push(O,c,D),a.push(c,I,D)):U===k?(X=`${Math.min(I,D)} ${Math.max(I,D)}`,c=p[X],f(c)||(Y=E.interpolateUsingFraction(.5,V5),K=(R.height+V.height)*.5,j=m.fromRadians(Y.longitude,Y.latitude,K,t,ep),u.push(j.x,j.y,j.z),c=u.length/3-1,p[X]=c,s&&(Z=W.add(b,v,zx),W.multiplyByScalar(Z,.5,Z),d.push(Z.x,Z.y))),a.push(I,c,O),a.push(c,D,O)):G===k&&(X=`${Math.min(D,O)} ${Math.max(D,O)}`,c=p[X],f(c)||(Y=S.interpolateUsingFraction(.5,V5),K=(V.height+P.height)*.5,j=m.fromRadians(Y.longitude,Y.latitude,K,t,ep),u.push(j.x,j.y,j.z),c=u.length/3-1,p[X]=c,s&&(Z=W.add(v,g,zx),W.multiplyByScalar(Z,.5,Z),d.push(Z.x,Z.y))),a.push(D,c,I),a.push(c,O,I)):(y.push(O),y.push(I),y.push(D))}let w={attributes:{position:new we({componentDatatype:J.DOUBLE,componentsPerAttribute:3,values:u})},indices:y,primitiveType:Re.TRIANGLES};return s&&(w.attributes.st=new we({componentDatatype:J.FLOAT,componentsPerAttribute:2,values:d})),new at(w)};N_.scaleToGeodeticHeight=function(t,n,i,o){i=A(i,oe.WGS84);let r=Ize,s=Bze;if(n=A(n,0),o=A(o,!0),f(t)){let a=t.length;for(let c=0;c<a;c+=3)m.fromArray(t,c,s),o&&(s=i.scaleToGeodeticSurface(s,s)),n!==0&&(r=i.geodeticSurfaceNormal(s,r),m.multiplyByScalar(r,n,r),m.add(s,r,s)),t[c]=s.x,t[c+1]=s.y,t[c+2]=s.z}return t};var ni=N_;var Mie=Math.cos,Lie=Math.sin,Lze=Math.sqrt,U5={};U5.computePosition=function(t,n,i,o,r,s,a){let c=n.radiiSquared,l=t.nwCorner,u=t.boundingRectangle,d=l.latitude-t.granYCos*o+r*t.granXSin,h=Mie(d),_=Lie(d),y=c.z*_,p=l.longitude+o*t.granYSin+r*t.granXCos,C=h*Mie(p),x=h*Lie(p),T=c.x*C,E=c.y*x,S=Lze(T*C+E*x+y*_);if(s.x=T/S,s.y=E/S,s.z=y/S,i){let w=t.stNwCorner;f(w)?(d=w.latitude-t.stGranYCos*o+r*t.stGranXSin,p=w.longitude+o*t.stGranYSin+r*t.stGranXCos,a.x=(p-t.stWest)*t.lonScalar,a.y=(d-t.stSouth)*t.latScalar):(a.x=(p-u.west)*t.lonScalar,a.y=(d-u.south)*t.latScalar)}};var Fze=new Ji,Ou=new m,Nze=new de,CF=new m,k5=new Ci;function Fie(t,n,i,o,r,s,a){let c=Math.cos(n),l=o*c,u=i*c,d=Math.sin(n),h=o*d,_=i*d;Ou=k5.project(t,Ou),Ou=m.subtract(Ou,CF,Ou);let y=Ji.fromRotation(n,Fze);Ou=Ji.multiplyByVector(y,Ou,Ou),Ou=m.add(Ou,CF,Ou),t=k5.unproject(Ou,t),s-=1,a-=1;let p=t.latitude,C=p+s*_,x=p-l*a,T=p-l*a+s*_,E=Math.max(p,C,x,T),S=Math.min(p,C,x,T),w=t.longitude,D=w+s*u,I=w+a*h,O=w+a*h+s*u,M=Math.max(w,D,I,O),L=Math.min(w,D,I,O);return{north:E,south:S,east:M,west:L,granYCos:l,granYSin:h,granXCos:u,granXSin:_,nwCorner:t}}U5.computeOptions=function(t,n,i,o,r,s,a){let c=t.east,l=t.west,u=t.north,d=t.south,h=!1,_=!1;u===B.PI_OVER_TWO&&(h=!0),d===-B.PI_OVER_TWO&&(_=!0);let y,p=u-d;l>c?y=B.TWO_PI-l+c:y=c-l;let C=Math.ceil(y/n)+1,x=Math.ceil(p/n)+1,T=y/(C-1),E=p/(x-1),S=le.northwest(t,s),w=le.center(t,Nze);(i!==0||o!==0)&&(w.longitude<S.longitude&&(w.longitude+=B.TWO_PI),CF=k5.project(w,CF));let D=E,I=T,O=0,M=0,L=le.clone(t,r),F={granYCos:D,granYSin:O,granXCos:I,granXSin:M,nwCorner:S,boundingRectangle:L,width:C,height:x,northCap:h,southCap:_};if(i!==0){let g=Fie(S,i,T,E,w,C,x);u=g.north,d=g.south,c=g.east,l=g.west,F.granYCos=g.granYCos,F.granYSin=g.granYSin,F.granXCos=g.granXCos,F.granXSin=g.granXSin,L.north=u,L.south=d,L.east=c,L.west=l}if(o!==0){i=i-o;let g=le.northwest(L,a),b=Fie(g,i,T,E,w,C,x);F.stGranYCos=b.granYCos,F.stGranXCos=b.granXCos,F.stGranYSin=b.granYSin,F.stGranXSin=b.granXSin,F.stNwCorner=g,F.stWest=b.west,F.stSouth=b.south}return F};var _s=U5;var Vze=new ae,kze=new ae,Uze=new m,zze=new le;function Nie(t,n){let i=t._ellipsoid,o=n.height,r=n.width,s=n.northCap,a=n.southCap,c=o,l=2,u=0,d=4;s&&(l-=1,c-=1,u+=1,d-=2),a&&(l-=1,c-=1,u+=1,d-=2),u+=l*r+2*c-d;let h=new Float64Array(u*3),_=0,y=0,p,C=Uze;if(s)_s.computePosition(n,i,!1,y,0,C),h[_++]=C.x,h[_++]=C.y,h[_++]=C.z;else for(p=0;p<r;p++)_s.computePosition(n,i,!1,y,p,C),h[_++]=C.x,h[_++]=C.y,h[_++]=C.z;for(p=r-1,y=1;y<o;y++)_s.computePosition(n,i,!1,y,p,C),h[_++]=C.x,h[_++]=C.y,h[_++]=C.z;if(y=o-1,!a)for(p=r-2;p>=0;p--)_s.computePosition(n,i,!1,y,p,C),h[_++]=C.x,h[_++]=C.y,h[_++]=C.z;for(p=0,y=o-2;y>0;y--)_s.computePosition(n,i,!1,y,p,C),h[_++]=C.x,h[_++]=C.y,h[_++]=C.z;let x=h.length/3*2,T=Ne.createTypedArray(h.length/3,x),E=0;for(let w=0;w<h.length/3-1;w++)T[E++]=w,T[E++]=w+1;T[E++]=h.length/3-1,T[E++]=0;let S=new at({attributes:new cn,primitiveType:Re.LINES});return S.attributes.position=new we({componentDatatype:J.DOUBLE,componentsPerAttribute:3,values:h}),S.indices=T,S}function Hze(t,n){let i=t._surfaceHeight,o=t._extrudedHeight,r=t._ellipsoid,s=o,a=i,c=Nie(t,n),l=n.height,u=n.width,d=ni.scaleToGeodeticHeight(c.attributes.position.values,a,r,!1),h=d.length,_=new Float64Array(h*2);_.set(d);let y=ni.scaleToGeodeticHeight(c.attributes.position.values,s,r);_.set(y,h),c.attributes.position.values=_;let p=n.northCap,C=n.southCap,x=4;p&&(x-=1),C&&(x-=1);let T=(_.length/3+x)*2,E=Ne.createTypedArray(_.length/3,T);h=_.length/6;let S=0;for(let D=0;D<h-1;D++)E[S++]=D,E[S++]=D+1,E[S++]=D+h,E[S++]=D+h+1;E[S++]=h-1,E[S++]=0,E[S++]=h+h-1,E[S++]=h,E[S++]=0,E[S++]=h;let w;if(p)w=l-1;else{let D=u-1;E[S++]=D,E[S++]=D+h,w=u+l-2}if(E[S++]=w,E[S++]=w+h,!C){let D=u+w-1;E[S++]=D,E[S]=D+h}return c.indices=E,c}function Gx(t){t=A(t,A.EMPTY_OBJECT);let n=t.rectangle,i=A(t.granularity,B.RADIANS_PER_DEGREE),o=A(t.ellipsoid,oe.WGS84),r=A(t.rotation,0),s=A(t.height,0),a=A(t.extrudedHeight,s);this._rectangle=le.clone(n),this._granularity=i,this._ellipsoid=o,this._surfaceHeight=Math.max(s,a),this._rotation=r,this._extrudedHeight=Math.min(s,a),this._offsetAttribute=t.offsetAttribute,this._workerName="createRectangleOutlineGeometry"}Gx.packedLength=le.packedLength+oe.packedLength+5;Gx.pack=function(t,n,i){return i=A(i,0),le.pack(t._rectangle,n,i),i+=le.packedLength,oe.pack(t._ellipsoid,n,i),i+=oe.packedLength,n[i++]=t._granularity,n[i++]=t._surfaceHeight,n[i++]=t._rotation,n[i++]=t._extrudedHeight,n[i]=A(t._offsetAttribute,-1),n};var Vie=new le,kie=oe.clone(oe.UNIT_SPHERE),Hx={rectangle:Vie,ellipsoid:kie,granularity:void 0,height:void 0,rotation:void 0,extrudedHeight:void 0,offsetAttribute:void 0};Gx.unpack=function(t,n,i){n=A(n,0);let o=le.unpack(t,n,Vie);n+=le.packedLength;let r=oe.unpack(t,n,kie);n+=oe.packedLength;let s=t[n++],a=t[n++],c=t[n++],l=t[n++],u=t[n];return f(i)?(i._rectangle=le.clone(o,i._rectangle),i._ellipsoid=oe.clone(r,i._ellipsoid),i._surfaceHeight=a,i._rotation=c,i._extrudedHeight=l,i._offsetAttribute=u===-1?void 0:u,i):(Hx.granularity=s,Hx.height=a,Hx.rotation=c,Hx.extrudedHeight=l,Hx.offsetAttribute=u===-1?void 0:u,new Gx(Hx))};var Gze=new de;Gx.createGeometry=function(t){let n=t._rectangle,i=t._ellipsoid,o=_s.computeOptions(n,t._granularity,t._rotation,0,zze,Gze),r,s;if(B.equalsEpsilon(n.north,n.south,B.EPSILON10)||B.equalsEpsilon(n.east,n.west,B.EPSILON10))return;let a=t._surfaceHeight,c=t._extrudedHeight,l=!B.equalsEpsilon(a,c,0,B.EPSILON2),u;if(l){if(r=Hze(t,o),f(t._offsetAttribute)){let _=r.attributes.position.values.length/3,y=new Uint8Array(_);t._offsetAttribute===en.TOP?y=y.fill(1,0,_/2):(u=t._offsetAttribute===en.NONE?0:1,y=y.fill(u)),r.attributes.applyOffset=new we({componentDatatype:J.UNSIGNED_BYTE,componentsPerAttribute:1,values:y})}let d=ae.fromRectangle3D(n,i,a,kze),h=ae.fromRectangle3D(n,i,c,Vze);s=ae.union(d,h)}else{if(r=Nie(t,o),r.attributes.position.values=ni.scaleToGeodeticHeight(r.attributes.position.values,a,i,!1),f(t._offsetAttribute)){let d=r.attributes.position.values.length;u=t._offsetAttribute===en.NONE?0:1;let h=new Uint8Array(d/3).fill(u);r.attributes.applyOffset=new we({componentDatatype:J.UNSIGNED_BYTE,componentsPerAttribute:1,values:h})}s=ae.fromRectangle3D(n,i,a)}return new at({attributes:r.attributes,indices:r.indices,primitiveType:Re.LINES,boundingSphere:s,offsetAttribute:t._offsetAttribute})};var Wx=Gx;function qx(t){this.rectangle=le.clone(t.rectangle),this.minimumHeight=A(t.minimumHeight,0),this.maximumHeight=A(t.maximumHeight,0),this.southwestCornerCartesian=new m,this.northeastCornerCartesian=new m,this.westNormal=new m,this.southNormal=new m,this.eastNormal=new m,this.northNormal=new m;let n=A(t.ellipsoid,oe.WGS84);Xze(this,t.rectangle,n),this._orientedBoundingBox=void 0,this._boundingSphere=void 0,A(t.computeBoundingVolumes,!0)&&this.computeBoundingVolumes(n)}Object.defineProperties(qx.prototype,{boundingVolume:{get:function(){return this._orientedBoundingBox}},boundingSphere:{get:function(){return this._boundingSphere}}});qx.prototype.computeBoundingVolumes=function(t){this._orientedBoundingBox=_i.fromRectangle(this.rectangle,this.minimumHeight,this.maximumHeight,t),this._boundingSphere=ae.fromOrientedBoundingBox(this._orientedBoundingBox)};var Uie=new m,xF=new m,zie=new m,Wze=new m,jze=new m,qze=new m,Yze=new m,Ru=new de,Hie=new rn(m.UNIT_X,0),jx=new dn;function Xze(t,n,i){i.cartographicToCartesian(le.southwest(n),t.southwestCornerCartesian),i.cartographicToCartesian(le.northeast(n),t.northeastCornerCartesian),Ru.longitude=n.west,Ru.latitude=(n.south+n.north)*.5,Ru.height=0;let o=i.cartographicToCartesian(Ru,qze),r=m.cross(o,m.UNIT_Z,Wze);m.normalize(r,t.westNormal),Ru.longitude=n.east;let s=i.cartographicToCartesian(Ru,Yze),a=m.cross(m.UNIT_Z,s,Uie);m.normalize(a,t.eastNormal);let c=m.subtract(o,s,Uie);m.magnitude(c)===0&&(c=m.clone(r,c));let l=m.normalize(c,jze),u=n.south,d;if(u>0){Ru.longitude=(n.west+n.east)*.5,Ru.latitude=u;let C=i.cartographicToCartesian(Ru,jx.origin);m.clone(l,jx.direction);let x=rn.fromPointNormal(t.southwestCornerCartesian,t.westNormal,Hie);ji.rayPlane(jx,x,t.southwestCornerCartesian),d=i.geodeticSurfaceNormal(C,xF)}else d=i.geodeticSurfaceNormalCartographic(le.southeast(n),xF);let h=m.cross(d,c,zie);m.normalize(h,t.southNormal);let _=n.north,y;if(_<0){Ru.longitude=(n.west+n.east)*.5,Ru.latitude=_;let C=i.cartographicToCartesian(Ru,jx.origin);m.negate(l,jx.direction);let x=rn.fromPointNormal(t.northeastCornerCartesian,t.eastNormal,Hie);ji.rayPlane(jx,x,t.northeastCornerCartesian),y=i.geodeticSurfaceNormal(C,xF)}else y=i.geodeticSurfaceNormalCartographic(le.northwest(n),xF);let p=m.cross(c,y,zie);m.normalize(p,t.northNormal)}var Kze=new m,Jze=new m,Zze=new m(0,-1,0),Qze=new m(0,0,-1),Gie=new m;function $ze(t,n){let i=n.camera,o=i.positionWC,r=i.positionCartographic,s=0;if(!le.contains(t.rectangle,r)){let u=t.southwestCornerCartesian,d=t.northeastCornerCartesian,h=t.westNormal,_=t.southNormal,y=t.eastNormal,p=t.northNormal;n.mode!==ne.SCENE3D&&(u=n.mapProjection.project(le.southwest(t.rectangle),Kze),u.z=u.y,u.y=u.x,u.x=0,d=n.mapProjection.project(le.northeast(t.rectangle),Jze),d.z=d.y,d.y=d.x,d.x=0,h=Zze,y=m.UNIT_Y,_=Qze,p=m.UNIT_Z);let C=m.subtract(o,u,Gie),x=m.dot(C,h),T=m.dot(C,_),E=m.subtract(o,d,Gie),S=m.dot(E,y),w=m.dot(E,p);x>0?s+=x*x:S>0&&(s+=S*S),T>0?s+=T*T:w>0&&(s+=w*w)}let a,c,l;if(n.mode===ne.SCENE3D?(a=r.height,c=t.minimumHeight,l=t.maximumHeight):(a=o.x,c=0,l=0),a>l){let u=a-l;s+=u*u}else if(a<c){let u=c-a;s+=u*u}return Math.sqrt(s)}qx.prototype.distanceToCamera=function(t){let n=$ze(this,t);if(t.mode===ne.SCENE3D&&f(this._orientedBoundingBox)){let i=Math.sqrt(this._orientedBoundingBox.distanceSquaredTo(t.camera.positionWC));return Math.max(n,i)}return n};qx.prototype.intersectPlane=function(t){return this._orientedBoundingBox.intersectPlane(t)};qx.prototype.createDebugVolume=function(t){let n=new N.clone(N.IDENTITY),i=new Wx({rectangle:this.rectangle,height:this.minimumHeight,extrudedHeight:this.maximumHeight}),o=new Ct({geometry:i,id:"outline",modelMatrix:n,attributes:{color:Lt.fromColor(t)}});return new Sn({geometryInstances:o,appearance:new tn({translucent:!1,flat:!0}),asynchronous:!1})};var Hf=qx;var xw={},eHe=new m,Wie=new m,jie=new m,qie=new m,Yie=new _i;xw.validOutline=function(t){let i=_i.fromPoints(t,Yie).halfAxes,o=$.getColumn(i,0,Wie),r=$.getColumn(i,1,jie),s=$.getColumn(i,2,qie),a=m.magnitude(o),c=m.magnitude(r),l=m.magnitude(s);return!(a===0&&(c===0||l===0)||c===0&&l===0)};xw.computeProjectTo2DArguments=function(t,n,i,o){let r=_i.fromPoints(t,Yie),s=r.halfAxes,a=$.getColumn(s,0,Wie),c=$.getColumn(s,1,jie),l=$.getColumn(s,2,qie),u=m.magnitude(a),d=m.magnitude(c),h=m.magnitude(l),_=Math.min(u,d,h);if(u===0&&(d===0||h===0)||d===0&&h===0)return!1;let y,p;return(_===d||_===h)&&(y=a),_===u?y=c:_===h&&(p=c),(_===u||_===d)&&(p=l),m.normalize(y,i),m.normalize(p,o),m.clone(r.center,n),!0};function Xie(t,n,i,o,r){let s=m.subtract(t,n,eHe),a=m.dot(i,s),c=m.dot(o,s);return W.fromElements(a,c,r)}xw.createProjectPointsTo2DFunction=function(t,n,i){return function(o){let r=new Array(o.length);for(let s=0;s<o.length;s++)r[s]=Xie(o[s],t,n,i);return r}};xw.createProjectPointTo2DFunction=function(t,n,i){return function(o,r){return Xie(o,t,n,i,r)}};var V_=xw;function k_(){this._array=[],this._offset=0,this._length=0}Object.defineProperties(k_.prototype,{length:{get:function(){return this._length}}});k_.prototype.enqueue=function(t){this._array.push(t),this._length++};k_.prototype.dequeue=function(){if(this._length===0)return;let t=this._array,n=this._offset,i=t[n];return t[n]=void 0,n++,n>10&&n*2>t.length&&(this._array=t.slice(n),n=0),this._offset=n,this._length--,i};k_.prototype.peek=function(){if(this._length!==0)return this._array[this._offset]};k_.prototype.contains=function(t){return this._array.indexOf(t)!==-1};k_.prototype.clear=function(){this._array.length=this._offset=this._length=0};k_.prototype.sort=function(t){this._offset>0&&(this._array=this._array.slice(this._offset),this._offset=0),this._array.sort(t)};var gy=k_;var tr={};tr.computeHierarchyPackedLength=function(t,n){let i=0,o=[t];for(;o.length>0;){let r=o.pop();if(!f(r))continue;i+=2;let s=r.positions,a=r.holes;if(f(s)&&s.length>0&&(i+=s.length*n.packedLength),f(a)){let c=a.length;for(let l=0;l<c;++l)o.push(a[l])}}return i};tr.packPolygonHierarchy=function(t,n,i,o){let r=[t];for(;r.length>0;){let s=r.pop();if(!f(s))continue;let a=s.positions,c=s.holes;if(n[i++]=f(a)?a.length:0,n[i++]=f(c)?c.length:0,f(a)){let l=a.length;for(let u=0;u<l;++u,i+=o.packedLength)o.pack(a[u],n,i)}if(f(c)){let l=c.length;for(let u=0;u<l;++u)r.push(c[u])}}return i};tr.unpackPolygonHierarchy=function(t,n,i){let o=t[n++],r=t[n++],s=new Array(o),a=r>0?new Array(r):void 0;for(let c=0;c<o;++c,n+=i.packedLength)s[c]=i.unpack(t,n);for(let c=0;c<r;++c)a[c]=tr.unpackPolygonHierarchy(t,n,i),n=a[c].startingIndex,delete a[c].startingIndex;return{positions:s,holes:a,startingIndex:n}};var yy=new W;function Qie(t,n,i,o){return W.subtract(n,t,yy),W.multiplyByScalar(yy,i/o,yy),W.add(t,yy,yy),[yy.x,yy.y]}var U_=new m;function tHe(t,n,i,o){return m.subtract(n,t,U_),m.multiplyByScalar(U_,i/o,U_),m.add(t,U_,U_),[U_.x,U_.y,U_.z]}tr.subdivideLineCount=function(t,n,i){let r=m.distance(t,n)/i,s=Math.max(0,Math.ceil(B.log2(r)));return Math.pow(2,s)};var z5=new de,H5=new de,nHe=new de,iHe=new m,Kie=new Ia;tr.subdivideRhumbLineCount=function(t,n,i,o){let r=t.cartesianToCartographic(n,z5),s=t.cartesianToCartographic(i,H5),c=new Ia(r,s,t).surfaceDistance/o,l=Math.max(0,Math.ceil(B.log2(c)));return Math.pow(2,l)};tr.subdivideTexcoordLine=function(t,n,i,o,r,s){let a=tr.subdivideLineCount(i,o,r),c=W.distance(t,n),l=c/a,u=s;u.length=a*2;let d=0;for(let h=0;h<a;h++){let _=Qie(t,n,h*l,c);u[d++]=_[0],u[d++]=_[1]}return u};tr.subdivideLine=function(t,n,i,o){let r=tr.subdivideLineCount(t,n,i),s=m.distance(t,n),a=s/r;f(o)||(o=[]);let c=o;c.length=r*3;let l=0;for(let u=0;u<r;u++){let d=tHe(t,n,u*a,s);c[l++]=d[0],c[l++]=d[1],c[l++]=d[2]}return c};tr.subdivideTexcoordRhumbLine=function(t,n,i,o,r,s,a){let c=i.cartesianToCartographic(o,z5),l=i.cartesianToCartographic(r,H5);Kie.setEndPoints(c,l);let u=Kie.surfaceDistance/s,d=Math.max(0,Math.ceil(B.log2(u))),h=Math.pow(2,d),_=W.distance(t,n),y=_/h,p=a;p.length=h*2;let C=0;for(let x=0;x<h;x++){let T=Qie(t,n,x*y,_);p[C++]=T[0],p[C++]=T[1]}return p};tr.subdivideRhumbLine=function(t,n,i,o,r){let s=t.cartesianToCartographic(n,z5),a=t.cartesianToCartographic(i,H5),c=new Ia(s,a,t),l=c.surfaceDistance/o,u=Math.max(0,Math.ceil(B.log2(l))),d=Math.pow(2,u),h=c.surfaceDistance/d;f(r)||(r=[]);let _=r;_.length=d*3;let y=0;for(let p=0;p<d;p++){let C=c.interpolateUsingSurfaceDistance(p*h,nHe),x=t.cartographicToCartesian(C,iHe);_[y++]=x.x,_[y++]=x.y,_[y++]=x.z}return _};var oHe=new m,rHe=new m,sHe=new m,aHe=new m;tr.scaleToGeodeticHeightExtruded=function(t,n,i,o,r){o=A(o,oe.WGS84);let s=oHe,a=rHe,c=sHe,l=aHe;if(f(t)&&f(t.attributes)&&f(t.attributes.position)){let u=t.attributes.position.values,d=u.length/2;for(let h=0;h<d;h+=3)m.fromArray(u,h,c),o.geodeticSurfaceNormal(c,s),l=o.scaleToGeodeticSurface(c,l),a=m.multiplyByScalar(s,i,a),a=m.add(l,a,a),u[h+d]=a.x,u[h+1+d]=a.y,u[h+2+d]=a.z,r&&(l=m.clone(c,l)),a=m.multiplyByScalar(s,n,a),a=m.add(l,a,a),u[h]=a.x,u[h+1]=a.y,u[h+2]=a.z}return t};tr.polygonOutlinesFromHierarchy=function(t,n,i){let o=[],r=new gy;r.enqueue(t);let s,a,c;for(;r.length!==0;){let l=r.dequeue(),u=l.positions;if(n)for(c=u.length,s=0;s<c;s++)i.scaleToGeodeticSurface(u[s],u[s]);if(u=Co(u,m.equalsEpsilon,!0),u.length<3)continue;let d=l.holes?l.holes.length:0;for(s=0;s<d;s++){let h=l.holes[s],_=h.positions;if(n)for(c=_.length,a=0;a<c;++a)i.scaleToGeodeticSurface(_[a],_[a]);if(_=Co(_,m.equalsEpsilon,!0),_.length<3)continue;o.push(_);let y=0;for(f(h.holes)&&(y=h.holes.length),a=0;a<y;a++)r.enqueue(h.holes[a])}o.push(u)}return o};tr.polygonsFromHierarchy=function(t,n,i,o,r){let s=[],a=[],c=new gy;for(c.enqueue(t);c.length!==0;){let l=c.dequeue(),u=l.positions,d=l.holes,h,_;if(o)for(_=u.length,h=0;h<_;h++)r.scaleToGeodeticSurface(u[h],u[h]);if(n||(u=Co(u,m.equalsEpsilon,!0)),u.length<3)continue;let y=i(u);if(!f(y))continue;let p=[],C=ni.computeWindingOrder2D(y);C===$r.CLOCKWISE&&(y.reverse(),u=u.slice().reverse());let x=u.slice(),T=f(d)?d.length:0,E=[],S;for(h=0;h<T;h++){let w=d[h],D=w.positions;if(o)for(_=D.length,S=0;S<_;++S)r.scaleToGeodeticSurface(D[S],D[S]);if(n||(D=Co(D,m.equalsEpsilon,!0)),D.length<3)continue;let I=i(D);if(!f(I))continue;C=ni.computeWindingOrder2D(I),C===$r.CLOCKWISE&&(I.reverse(),D=D.slice().reverse()),E.push(D),p.push(x.length),x=x.concat(D),y=y.concat(I);let O=0;for(f(w.holes)&&(O=w.holes.length),S=0;S<O;S++)c.enqueue(w.holes[S])}s.push({outerRing:u,holes:E}),a.push({positions:x,positions2D:y,holes:p})}return{hierarchy:s,polygons:a}};var cHe=new W,lHe=new m,uHe=new Me,fHe=new $;tr.computeBoundingRectangle=function(t,n,i,o,r){let s=Me.fromAxisAngle(t,o,uHe),a=$.fromQuaternion(s,fHe),c=Number.POSITIVE_INFINITY,l=Number.NEGATIVE_INFINITY,u=Number.POSITIVE_INFINITY,d=Number.NEGATIVE_INFINITY,h=i.length;for(let _=0;_<h;++_){let y=m.clone(i[_],lHe);$.multiplyByVector(a,y,y);let p=n(y,cHe);f(p)&&(c=Math.min(c,p.x),l=Math.max(l,p.x),u=Math.min(u,p.y),d=Math.max(d,p.y))}return r.x=c,r.y=u,r.width=l-c,r.height=d-u,r};tr.createGeometryFromPositions=function(t,n,i,o,r,s,a){let c=ni.triangulate(n.positions2D,n.holes);c.length<3&&(c=[0,1,2]);let l=n.positions,u=f(i),d=u?i.positions:void 0;if(r){let h=l.length,_=new Array(h*3),y=0;for(let x=0;x<h;x++){let T=l[x];_[y++]=T.x,_[y++]=T.y,_[y++]=T.z}let p={attributes:{position:new we({componentDatatype:J.DOUBLE,componentsPerAttribute:3,values:_})},indices:c,primitiveType:Re.TRIANGLES};u&&(p.attributes.st=new we({componentDatatype:J.FLOAT,componentsPerAttribute:2,values:W.packArray(d)}));let C=new at(p);return s.normal?Fn.computeNormal(C):C}if(a===Zt.GEODESIC)return ni.computeSubdivision(t,l,c,d,o);if(a===Zt.RHUMB)return ni.computeRhumbLineSubdivision(t,l,c,d,o)};var Jie=[],Zie=[],dHe=new m,hHe=new m;tr.computeWallGeometry=function(t,n,i,o,r,s){let a,c,l,u,d,h,_,y,p,C=t.length,x=0,T=0,E=f(n),S=E?n.positions:void 0;if(r)for(c=C*3*2,a=new Array(c*2),E&&(p=C*2*2,y=new Array(p*2)),l=0;l<C;l++)u=t[l],d=t[(l+1)%C],a[x]=a[x+c]=u.x,++x,a[x]=a[x+c]=u.y,++x,a[x]=a[x+c]=u.z,++x,a[x]=a[x+c]=d.x,++x,a[x]=a[x+c]=d.y,++x,a[x]=a[x+c]=d.z,++x,E&&(h=S[l],_=S[(l+1)%C],y[T]=y[T+p]=h.x,++T,y[T]=y[T+p]=h.y,++T,y[T]=y[T+p]=_.x,++T,y[T]=y[T+p]=_.y,++T);else{let M=B.chordLength(o,i.maximumRadius),L=0;if(s===Zt.GEODESIC)for(l=0;l<C;l++)L+=tr.subdivideLineCount(t[l],t[(l+1)%C],M);else if(s===Zt.RHUMB)for(l=0;l<C;l++)L+=tr.subdivideRhumbLineCount(i,t[l],t[(l+1)%C],M);for(c=(L+C)*3,a=new Array(c*2),E&&(p=(L+C)*2,y=new Array(p*2)),l=0;l<C;l++){u=t[l],d=t[(l+1)%C];let F,g;E&&(h=S[l],_=S[(l+1)%C]),s===Zt.GEODESIC?(F=tr.subdivideLine(u,d,M,Zie),E&&(g=tr.subdivideTexcoordLine(h,_,u,d,M,Jie))):s===Zt.RHUMB&&(F=tr.subdivideRhumbLine(i,u,d,M,Zie),E&&(g=tr.subdivideTexcoordRhumbLine(h,_,i,u,d,M,Jie)));let b=F.length;for(let v=0;v<b;++v,++x)a[x]=F[v],a[x+c]=F[v];if(a[x]=d.x,a[x+c]=d.x,++x,a[x]=d.y,a[x+c]=d.y,++x,a[x]=d.z,a[x+c]=d.z,++x,E){let v=g.length;for(let P=0;P<v;++P,++T)y[T]=g[P],y[T+p]=g[P];y[T]=_.x,y[T+p]=_.x,++T,y[T]=_.y,y[T+p]=_.y,++T}}}C=a.length;let w=Ne.createTypedArray(C/3,C-t.length*6),D=0;for(C/=6,l=0;l<C;l++){let M=l,L=M+1,F=M+C,g=F+1;u=m.fromArray(a,M*3,dHe),d=m.fromArray(a,L*3,hHe),!m.equalsEpsilon(u,d,B.EPSILON10,B.EPSILON10)&&(w[D++]=M,w[D++]=F,w[D++]=L,w[D++]=L,w[D++]=F,w[D++]=g)}let I={attributes:new cn({position:new we({componentDatatype:J.DOUBLE,componentsPerAttribute:3,values:a})}),indices:w,primitiveType:Re.TRIANGLES};return E&&(I.attributes.st=new we({componentDatatype:J.FLOAT,componentsPerAttribute:2,values:y})),new at(I)};var Gn=tr;function mHe(t){let n=t.length,i=new Float64Array(n*3),o=Ne.createTypedArray(n,n*2),r=0,s=0;for(let c=0;c<n;c++){let l=t[c];i[r++]=l.x,i[r++]=l.y,i[r++]=l.z,o[s++]=c,o[s++]=(c+1)%n}let a=new cn({position:new we({componentDatatype:J.DOUBLE,componentsPerAttribute:3,values:i})});return new at({attributes:a,indices:o,primitiveType:Re.LINES})}function Ay(t){t=A(t,A.EMPTY_OBJECT);let n=t.polygonHierarchy;this._polygonHierarchy=n,this._workerName="createCoplanarPolygonOutlineGeometry",this.packedLength=Gn.computeHierarchyPackedLength(n,m)+1}Ay.fromPositions=function(t){t=A(t,A.EMPTY_OBJECT);let n={polygonHierarchy:{positions:t.positions}};return new Ay(n)};Ay.pack=function(t,n,i){return i=A(i,0),i=Gn.packPolygonHierarchy(t._polygonHierarchy,n,i,m),n[i]=t.packedLength,n};var pHe={polygonHierarchy:{}};Ay.unpack=function(t,n,i){n=A(n,0);let o=Gn.unpackPolygonHierarchy(t,n,m);n=o.startingIndex,delete o.startingIndex;let r=t[n];return f(i)||(i=new Ay(pHe)),i._polygonHierarchy=o,i.packedLength=r,i};Ay.createGeometry=function(t){let n=t._polygonHierarchy,i=n.positions;if(i=Co(i,m.equalsEpsilon,!0),i.length<3||!V_.validOutline(i))return;let r=Gn.polygonOutlinesFromHierarchy(n,!1);if(r.length===0)return;let s=[];for(let l=0;l<r.length;l++){let u=new Ct({geometry:mHe(r[l])});s.push(u)}let a=Fn.combineInstances(s)[0],c=ae.fromPoints(n.positions);return new at({attributes:a.attributes,indices:a.indices,primitiveType:a.primitiveType,boundingSphere:c})};var Gf=Ay;var TF=new de;function Tw(t){let n=P_.fromToken(t.token),i=A(t.minimumHeight,0),o=A(t.maximumHeight,0),r=A(t.ellipsoid,oe.WGS84);this.s2Cell=n,this.minimumHeight=i,this.maximumHeight=o,this.ellipsoid=r;let s=bHe(n,i,o,r);this._boundingPlanes=s;let a=vHe(s);this._vertices=a,this._edgeNormals=new Array(6),this._edgeNormals[0]=J5(s[0],a.slice(0,4));let c;for(c=0;c<4;c++)this._edgeNormals[0][c]=m.negate(this._edgeNormals[0][c],this._edgeNormals[0][c]);for(this._edgeNormals[1]=J5(s[1],a.slice(4,8)),c=0;c<4;c++)this._edgeNormals[2+c]=J5(s[2+c],[a[c%4],a[(c+1)%4],a[4+(c+1)%4],a[4+c]]);for(this._planeVertices=[this._vertices.slice(0,4),this._vertices.slice(4,8)],c=0;c<4;c++)this._planeVertices.push([this._vertices[c%4],this._vertices[(c+1)%4],this._vertices[4+(c+1)%4],this._vertices[4+c]]);let l=n.getCenter();TF=r.cartesianToCartographic(l,TF),TF.height=(o+i)/2,this.center=r.cartographicToCartesian(TF,l),this._boundingSphere=ae.fromPoints(a)}var _He=new m,gHe=new de,yHe=new m,AHe=new de,CHe=new m,xHe=new m,THe=new m,EHe=new m;function bHe(t,n,i,o){let r=new Array(6),s=t.getCenter(),a=o.geodeticSurfaceNormal(s,_He),c=o.cartesianToCartographic(s,gHe);c.height=i;let l=o.cartographicToCartesian(c,yHe),u=rn.fromPointNormal(l,a);r[0]=u;let d=0,h,_=[],y,p;for(h=0;h<4;h++){y=t.getVertex(h),_[h]=y,p=o.cartesianToCartographic(y,AHe),p.height=n;let x=rn.getPointDistance(u,o.cartographicToCartesian(p,CHe));x<d&&(d=x)}let C=rn.clone(u);for(C.normal=m.negate(C.normal,C.normal),C.distance=C.distance*-1+d,r[1]=C,h=0;h<4;h++){y=_[h];let x=_[(h+1)%4],T=o.geodeticSurfaceNormal(y,xHe),E=m.subtract(x,y,EHe),S=m.cross(E,T,THe);S=m.normalize(S,S),r[2+h]=rn.fromPointNormal(y,S)}return r}var Cy=new m,xy=new m,Ty=new m,G5=new m,W5=new m,j5=new m,SHe=new m,wHe=new m,DHe=new m,q5=new m,Y5=new m,X5=new m,z_=new m,hh=new $;function $ie(t,n,i){Cy=t.normal,xy=n.normal,Ty=i.normal,G5=m.multiplyByScalar(t.normal,-t.distance,G5),W5=m.multiplyByScalar(n.normal,-n.distance,W5),j5=m.multiplyByScalar(i.normal,-i.distance,j5),q5=m.multiplyByScalar(m.cross(xy,Ty,SHe),m.dot(G5,Cy),q5),Y5=m.multiplyByScalar(m.cross(Ty,Cy,wHe),m.dot(W5,xy),Y5),X5=m.multiplyByScalar(m.cross(Cy,xy,DHe),m.dot(j5,Ty),X5),hh[0]=Cy.x,hh[1]=xy.x,hh[2]=Ty.x,hh[3]=Cy.y,hh[4]=xy.y,hh[5]=Ty.y,hh[6]=Cy.z,hh[7]=xy.z,hh[8]=Ty.z;let o=$.determinant(hh);return z_=m.add(q5,Y5,z_),z_=m.add(z_,X5,z_),new m(z_.x/o,z_.y/o,z_.z/o)}function vHe(t){let n=new Array(8);for(let i=0;i<4;i++)n[i]=$ie(t[0],t[2+(i+3)%4],t[2+i%4]),n[i+4]=$ie(t[1],t[2+(i+3)%4],t[2+i%4]);return n}var K5=new m,Yx=new m;function J5(t,n){let i=[];for(let o=0;o<4;o++)K5=m.subtract(n[(o+1)%4],n[o],K5),Yx=m.cross(t.normal,K5,Yx),Yx=m.normalize(Yx,Yx),i[o]=m.clone(Yx);return i}Object.defineProperties(Tw.prototype,{boundingVolume:{get:function(){return this}},boundingSphere:{get:function(){return this._boundingSphere}}});var Z5=new m;Tw.prototype.distanceToCamera=function(t){let n=t.camera.positionWC,i=[],o=[],r;rn.getPointDistance(this._boundingPlanes[0],n)>0?(i.push(0),o.push(this._planeVertices[0]),r=this._edgeNormals[0]):rn.getPointDistance(this._boundingPlanes[1],n)>0&&(i.push(1),o.push(this._planeVertices[1]),r=this._edgeNormals[1]);let s,a;for(s=0;s<4;s++)a=2+s,rn.getPointDistance(this._boundingPlanes[a],n)>0&&(i.push(a),o.push(this._planeVertices[a]),r=this._edgeNormals[a]);if(i.length===0)return 0;let c,l;if(i.length===1)return l=this._boundingPlanes[i[0]],c=Q5(rn.projectPointOntoPlane(l,n,Z5),o[0],l,r),m.distance(c,n);if(i.length===2){if(i[0]===0){let _=[this._vertices[4*i[0]+(i[1]-2)],this._vertices[4*i[0]+(i[1]-2+1)%4]];return c=eoe(n,_[0],_[1]),m.distance(c,n)}let d=Number.MAX_VALUE,h;for(s=0;s<2;s++)l=this._boundingPlanes[i[s]],c=Q5(rn.projectPointOntoPlane(l,n,Z5),o[s],l,this._edgeNormals[i[s]]),h=m.distanceSquared(c,n),h<d&&(d=h);return Math.sqrt(d)}else if(i.length>3)return c=Q5(rn.projectPointOntoPlane(this._boundingPlanes[1],n,Z5),this._planeVertices[1],this._boundingPlanes[1],this._edgeNormals[1]),m.distance(c,n);let u=i[1]===2&&i[2]===5?0:1;return i[0]===0?m.distance(n,this._vertices[(i[1]-2+u)%4]):m.distance(n,this._vertices[4+(i[1]-2+u)%4])};var PHe=new m,IHe=new m;function eoe(t,n,i){let o=m.subtract(i,n,PHe),r=m.subtract(t,n,IHe),s=m.dot(o,r);if(s<=0)return n;let a=m.dot(o,o);return s>=a?i:(s=s/a,new m((1-s)*n.x+s*i.x,(1-s)*n.y+s*i.y,(1-s)*n.z+s*i.z))}var BHe=new rn(m.UNIT_X,0);function Q5(t,n,i,o){let r=Number.MAX_VALUE,s,a,c;for(let l=0;l<n.length;l++){let u=rn.fromPointNormal(n[l],o[l],BHe);rn.getPointDistance(u,t)<0||(c=eoe(t,n[l],n[(l+1)%4]),s=m.distance(t,c),s<r&&(r=s,a=c))}return f(a)?a:t}Tw.prototype.intersectPlane=function(t){let n=0,i=0;for(let o=0;o<this._vertices.length;o++)m.dot(t.normal,this._vertices[o])+t.distance<0?i++:n++;return n===this._vertices.length?jt.INSIDE:i===this._vertices.length?jt.OUTSIDE:jt.INTERSECTING};Tw.prototype.createDebugVolume=function(t){let n=new N.clone(N.IDENTITY),i=new Gf({polygonHierarchy:{positions:this._planeVertices[0]}}),o=Gf.createGeometry(i),r=new Ct({geometry:o,id:"outline",modelMatrix:n,attributes:{color:Lt.fromColor(t)}}),s=new Gf({polygonHierarchy:{positions:this._planeVertices[1]}}),a=Gf.createGeometry(s),c=new Ct({geometry:a,id:"outline",modelMatrix:n,attributes:{color:Lt.fromColor(t)}}),l=[];for(let u=0;u<4;u++){let d=new Gf({polygonHierarchy:{positions:this._planeVertices[2+u]}}),h=Gf.createGeometry(d);l[u]=new Ct({geometry:h,id:"outline",modelMatrix:n,attributes:{color:Lt.fromColor(t)}})}return new Sn({geometryInstances:[l[0],l[1],l[2],l[3],c,r],appearance:new tn({translucent:!1,flat:!0}),asynchronous:!1})};var EF=Tw;var OHe=new m(1,1,1),bF=Math.cos,SF=Math.sin;function Xx(t){t=A(t,A.EMPTY_OBJECT);let n=A(t.radii,OHe),i=A(t.innerRadii,n),o=A(t.minimumClock,0),r=A(t.maximumClock,B.TWO_PI),s=A(t.minimumCone,0),a=A(t.maximumCone,B.PI),c=Math.round(A(t.stackPartitions,10)),l=Math.round(A(t.slicePartitions,8)),u=Math.round(A(t.subdivisions,128));this._radii=m.clone(n),this._innerRadii=m.clone(i),this._minimumClock=o,this._maximumClock=r,this._minimumCone=s,this._maximumCone=a,this._stackPartitions=c,this._slicePartitions=l,this._subdivisions=u,this._offsetAttribute=t.offsetAttribute,this._workerName="createEllipsoidOutlineGeometry"}Xx.packedLength=2*m.packedLength+8;Xx.pack=function(t,n,i){return i=A(i,0),m.pack(t._radii,n,i),i+=m.packedLength,m.pack(t._innerRadii,n,i),i+=m.packedLength,n[i++]=t._minimumClock,n[i++]=t._maximumClock,n[i++]=t._minimumCone,n[i++]=t._maximumCone,n[i++]=t._stackPartitions,n[i++]=t._slicePartitions,n[i++]=t._subdivisions,n[i]=A(t._offsetAttribute,-1),n};var toe=new m,noe=new m,tp={radii:toe,innerRadii:noe,minimumClock:void 0,maximumClock:void 0,minimumCone:void 0,maximumCone:void 0,stackPartitions:void 0,slicePartitions:void 0,subdivisions:void 0,offsetAttribute:void 0};Xx.unpack=function(t,n,i){n=A(n,0);let o=m.unpack(t,n,toe);n+=m.packedLength;let r=m.unpack(t,n,noe);n+=m.packedLength;let s=t[n++],a=t[n++],c=t[n++],l=t[n++],u=t[n++],d=t[n++],h=t[n++],_=t[n];return f(i)?(i._radii=m.clone(o,i._radii),i._innerRadii=m.clone(r,i._innerRadii),i._minimumClock=s,i._maximumClock=a,i._minimumCone=c,i._maximumCone=l,i._stackPartitions=u,i._slicePartitions=d,i._subdivisions=h,i._offsetAttribute=_===-1?void 0:_,i):(tp.minimumClock=s,tp.maximumClock=a,tp.minimumCone=c,tp.maximumCone=l,tp.stackPartitions=u,tp.slicePartitions=d,tp.subdivisions=h,tp.offsetAttribute=_===-1?void 0:_,new Xx(tp))};Xx.createGeometry=function(t){let n=t._radii;if(n.x<=0||n.y<=0||n.z<=0)return;let i=t._innerRadii;if(i.x<=0||i.y<=0||i.z<=0)return;let o=t._minimumClock,r=t._maximumClock,s=t._minimumCone,a=t._maximumCone,c=t._subdivisions,l=oe.fromCartesian3(n),u=t._slicePartitions+1,d=t._stackPartitions+1;u=Math.round(u*Math.abs(r-o)/B.TWO_PI),d=Math.round(d*Math.abs(a-s)/B.PI),u<2&&(u=2),d<2&&(d=2);let h=0,_=1,y=i.x!==n.x||i.y!==n.y||i.z!==n.z,p=!1,C=!1;y&&(_=2,s>0&&(p=!0,h+=u),a<Math.PI&&(C=!0,h+=u));let x=c*_*(d+u),T=new Float64Array(x*3),E=2*(x+h-(u+d)*_),S=Ne.createTypedArray(x,E),w,D,I,O,M=0,L=new Array(d),F=new Array(d);for(w=0;w<d;w++)O=s+w*(a-s)/(d-1),L[w]=SF(O),F[w]=bF(O);let g=new Array(c),b=new Array(c);for(w=0;w<c;w++)I=o+w*(r-o)/(c-1),g[w]=SF(I),b[w]=bF(I);for(w=0;w<d;w++)for(D=0;D<c;D++)T[M++]=n.x*L[w]*b[D],T[M++]=n.y*L[w]*g[D],T[M++]=n.z*F[w];if(y)for(w=0;w<d;w++)for(D=0;D<c;D++)T[M++]=i.x*L[w]*b[D],T[M++]=i.y*L[w]*g[D],T[M++]=i.z*F[w];for(L.length=c,F.length=c,w=0;w<c;w++)O=s+w*(a-s)/(c-1),L[w]=SF(O),F[w]=bF(O);for(g.length=u,b.length=u,w=0;w<u;w++)I=o+w*(r-o)/(u-1),g[w]=SF(I),b[w]=bF(I);for(w=0;w<c;w++)for(D=0;D<u;D++)T[M++]=n.x*L[w]*b[D],T[M++]=n.y*L[w]*g[D],T[M++]=n.z*F[w];if(y)for(w=0;w<c;w++)for(D=0;D<u;D++)T[M++]=i.x*L[w]*b[D],T[M++]=i.y*L[w]*g[D],T[M++]=i.z*F[w];for(M=0,w=0;w<d*_;w++){let R=w*c;for(D=0;D<c-1;D++)S[M++]=R+D,S[M++]=R+D+1}let v=d*c*_;for(w=0;w<u;w++)for(D=0;D<c-1;D++)S[M++]=v+w+D*u,S[M++]=v+w+(D+1)*u;if(y)for(v=d*c*_+u*c,w=0;w<u;w++)for(D=0;D<c-1;D++)S[M++]=v+w+D*u,S[M++]=v+w+(D+1)*u;if(y){let R=d*c*_,V=R+c*u;if(p)for(w=0;w<u;w++)S[M++]=R+w,S[M++]=V+w;if(C)for(R+=c*u-u,V+=c*u-u,w=0;w<u;w++)S[M++]=R+w,S[M++]=V+w}let P=new cn({position:new we({componentDatatype:J.DOUBLE,componentsPerAttribute:3,values:T})});if(f(t._offsetAttribute)){let R=T.length,V=t._offsetAttribute===en.NONE?0:1,H=new Uint8Array(R/3).fill(V);P.applyOffset=new we({componentDatatype:J.UNSIGNED_BYTE,componentsPerAttribute:1,values:H})}return new at({attributes:P,indices:S,primitiveType:Re.LINES,boundingSphere:ae.fromEllipsoid(l),offsetAttribute:t._offsetAttribute})};var Mu=Xx;function Kx(t){let n=A(t.radius,1),o={radii:new m(n,n,n),stackPartitions:t.stackPartitions,slicePartitions:t.slicePartitions,subdivisions:t.subdivisions};this._ellipsoidGeometry=new Mu(o),this._workerName="createSphereOutlineGeometry"}Kx.packedLength=Mu.packedLength;Kx.pack=function(t,n,i){return Mu.pack(t._ellipsoidGeometry,n,i)};var RHe=new Mu,Ey={radius:void 0,radii:new m,stackPartitions:void 0,slicePartitions:void 0,subdivisions:void 0};Kx.unpack=function(t,n,i){let o=Mu.unpack(t,n,RHe);return Ey.stackPartitions=o._stackPartitions,Ey.slicePartitions=o._slicePartitions,Ey.subdivisions=o._subdivisions,f(i)?(m.clone(o._radii,Ey.radii),i._ellipsoidGeometry=new Mu(Ey),i):(Ey.radius=o._radii.x,new Kx(Ey))};Kx.createGeometry=function(t){return Mu.createGeometry(t._ellipsoidGeometry)};var H_=Kx;function Jx(t,n){n===0&&(n=B.EPSILON7),this._boundingSphere=new ae(t,n)}Object.defineProperties(Jx.prototype,{center:{get:function(){return this._boundingSphere.center}},radius:{get:function(){return this._boundingSphere.radius}},boundingVolume:{get:function(){return this._boundingSphere}},boundingSphere:{get:function(){return this._boundingSphere}}});Jx.prototype.distanceToCamera=function(t){let n=this._boundingSphere;return Math.max(0,m.distance(n.center,t.camera.positionWC)-n.radius)};Jx.prototype.intersectPlane=function(t){return ae.intersectPlane(this._boundingSphere,t)};Jx.prototype.update=function(t,n){m.clone(t,this._boundingSphere.center),this._boundingSphere.radius=n};Jx.prototype.createDebugVolume=function(t){let n=new H_({radius:this.radius}),i=N.fromTranslation(this.center,new N.clone(N.IDENTITY)),o=new Ct({geometry:n,id:"outline",modelMatrix:i,attributes:{color:Lt.fromColor(t)}});return new Sn({geometryInstances:o,appearance:new tn({translucent:!1,flat:!0}),asynchronous:!1})};var G_=Jx;var MHe=new m,LHe=new m,FHe=new m,NHe=new m;function by(t,n,i){i=m.cross(t,n,i);let o=m.magnitude(i);return m.multiplyByScalar(i,B.EPSILON7/o,i)}function $5(t,n){let i=m.normalize(t,NHe),o=m.equalsEpsilon(i,m.UNIT_X,B.EPSILON6)?m.UNIT_Y:m.UNIT_X;return by(t,o,n)}function ioe(t){let n=$.getColumn(t,0,MHe),i=$.getColumn(t,1,LHe),o=$.getColumn(t,2,FHe),r=m.equals(n,m.ZERO),s=m.equals(i,m.ZERO),a=m.equals(o,m.ZERO);return!r&&!s&&!a?t:r&&s&&a?(t[0]=B.EPSILON7,t[4]=B.EPSILON7,t[8]=B.EPSILON7,t):(r&&!s&&!a?n=by(i,o,n):!r&&s&&!a?i=by(n,o,i):!r&&!s&&a?o=by(i,n,o):r?s?a||(n=$5(o,n),i=by(o,n,i)):(n=$5(i,n),o=by(i,n,o)):(i=$5(n,i),o=by(i,n,o)),$.setColumn(t,0,n,t),$.setColumn(t,1,i,t),$.setColumn(t,2,o,t),t)}function Zx(t,n){n=ioe(n),this._orientedBoundingBox=new _i(t,n),this._boundingSphere=ae.fromOrientedBoundingBox(this._orientedBoundingBox)}Object.defineProperties(Zx.prototype,{boundingVolume:{get:function(){return this._orientedBoundingBox}},boundingSphere:{get:function(){return this._boundingSphere}}});Zx.prototype.distanceToCamera=function(t){return Math.sqrt(this._orientedBoundingBox.distanceSquaredTo(t.camera.positionWC))};Zx.prototype.intersectPlane=function(t){return this._orientedBoundingBox.intersectPlane(t)};Zx.prototype.update=function(t,n){m.clone(t,this._orientedBoundingBox.center),n=ioe(n),$.clone(n,this._orientedBoundingBox.halfAxes),ae.fromOrientedBoundingBox(this._orientedBoundingBox,this._boundingSphere)};Zx.prototype.createDebugVolume=function(t){let n=new Ld({minimum:new m(-1,-1,-1),maximum:new m(1,1,1)}),i=N.fromRotationTranslation(this.boundingVolume.halfAxes,this.boundingVolume.center),o=new Ct({geometry:n,id:"outline",modelMatrix:i,attributes:{color:Lt.fromColor(t)}});return new Sn({geometryInstances:o,appearance:new tn({translucent:!1,flat:!0}),asynchronous:!1})};var Wf=Zx;function Fo(t,n,i,o){this._tileset=t,this._header=i;let r=f(i.contents),s=r&&i.contents.length>1||Li(i,"3DTILES_multiple_contents"),a=r&&!s?i.contents[0]:i.content;this._contentHeader=a,this.transform=f(i.transform)?N.unpack(i.transform):N.clone(N.IDENTITY);let c=f(o)?o.computedTransform:t.modelMatrix,l=N.multiply(c,this.transform,new N),u=f(o)?o._initialTransform:N.IDENTITY;this._initialTransform=N.multiply(u,this.transform,new N),this.computedTransform=l,this._boundingVolume=this.createBoundingVolume(i.boundingVolume,l),this._boundingVolume2D=void 0;let d;f(a)&&f(a.boundingVolume)&&(d=this.createBoundingVolume(a.boundingVolume,l)),this._contentBoundingVolume=d,this._contentBoundingVolume2D=void 0;let h;f(i.viewerRequestVolume)&&(h=this.createBoundingVolume(i.viewerRequestVolume,l)),this._viewerRequestVolume=h,this.geometricError=i.geometricError,this._geometricError=i.geometricError,f(this._geometricError)||(this._geometricError=f(o)?o.geometricError:t._geometricError,Fo._deprecationWarning("geometricErrorUndefined","Required property geometricError is undefined for this tile. Using parent's geometric error instead.")),this.updateGeometricErrorScale();let _;f(i.refine)?((i.refine==="replace"||i.refine==="add")&&Fo._deprecationWarning("lowercase-refine",`This tile uses a lowercase refine "${i.refine}". Instead use "${i.refine.toUpperCase()}".`),_=i.refine.toUpperCase()==="REPLACE"?Or.REPLACE:Or.ADD):f(o)?_=o.refine:_=Or.REPLACE,this.refine=_,this.children=[],this.parent=o;let y,p=!1,C,x,T;if(n=Ie.createIfNeeded(n),s)C=So.UNLOADED,x=n.clone();else if(f(a)){let D=a.uri;f(a.url)&&(Fo._deprecationWarning("contentUrl",'This tileset JSON uses the "content.url" property which has been deprecated. Use "content.uri" instead.'),D=a.url),D===""?(Fo._deprecationWarning("contentUriEmpty","content.uri property is an empty string, which creates a circular dependency, making this tileset invalid. Omit the content property instead"),y=new gw(t,this),p=!0,C=So.READY):(C=So.UNLOADED,x=t._urlDomains.length>0?n.getDerivedResource({url:D,urlDomains:t._urlDomains}):n.getDerivedResource({url:D}),T=ec.getServerKey(x.getUrlComponent()))}else y=new gw(t,this),p=!0,C=So.READY;this._content=y,this._contentResource=x,this._contentState=C,this._contentReadyToProcessPromise=void 0,this._contentReadyPromise=void 0,this._expiredContent=void 0,this._serverKey=T,this.hasEmptyContent=p,this.hasTilesetContent=!1,this.hasImplicitContent=!1,this.hasImplicitContentMetadata=!1,this.hasMultipleContents=s,this.metadata=mF(t,i),this.cacheNode=void 0;let E=i.expire,S,w;f(E)&&(S=E.duration,f(E.date)&&(w=te.fromIso8601(E.date))),this.expireDuration=S,this.expireDate=w,this.lastStyleTime=0,this._optimChildrenWithinParent=kf.NOT_COMPUTED,this.clippingPlanesDirty=!1,this.priorityDeferred=!1,this.implicitTileset=void 0,this.implicitCoordinates=void 0,this.implicitSubtree=void 0,this._distanceToCamera=0,this._centerZDepth=0,this._screenSpaceError=0,this._screenSpaceErrorProgressiveResolution=0,this._visibilityPlaneMask=0,this._visible=!1,this._inRequestVolume=!1,this._finalResolution=!0,this._depth=0,this._stackLength=0,this._selectionDepth=0,this._updatedVisibilityFrame=0,this._touchedFrame=0,this._visitedFrame=0,this._selectedFrame=0,this._requestedFrame=0,this._ancestorWithContent=void 0,this._ancestorWithContentAvailable=void 0,this._refines=!1,this._shouldSelect=!1,this._isClipped=!0,this._clippingPlanesState=0,this._debugBoundingVolume=void 0,this._debugContentBoundingVolume=void 0,this._debugViewerRequestVolume=void 0,this._debugColor=z.fromRandom({alpha:1}),this._debugColorizeTiles=!1,this._priority=0,this._priorityHolder=this,this._priorityProgressiveResolution=!1,this._priorityProgressiveResolutionScreenSpaceErrorLeaf=!1,this._priorityReverseScreenSpaceError=0,this._foveatedFactor=0,this._wasMinPriorityChild=!1,this._loadTimestamp=new te,this._commandsLength=0,this._color=void 0,this._colorDirty=!1,this._request=void 0}Fo._deprecationWarning=ws;Object.defineProperties(Fo.prototype,{tileset:{get:function(){return this._tileset}},content:{get:function(){return this._content}},boundingVolume:{get:function(){return this._boundingVolume}},contentBoundingVolume:{get:function(){return A(this._contentBoundingVolume,this._boundingVolume)}},boundingSphere:{get:function(){return this._boundingVolume.boundingSphere}},extras:{get:function(){return this._header.extras}},color:{get:function(){return f(this._color)||(this._color=new z),z.clone(this._color)},set:function(t){this._color=z.clone(t,this._color),this._colorDirty=!0}},contentAvailable:{get:function(){return this.contentReady&&!this.hasEmptyContent&&!this.hasTilesetContent&&!this.hasImplicitContent||f(this._expiredContent)&&!this.contentFailed}},contentReady:{get:function(){return this._contentState===So.READY}},contentUnloaded:{get:function(){return this._contentState===So.UNLOADED}},contentExpired:{get:function(){return this._contentState===So.EXPIRED}},contentFailed:{get:function(){return this._contentState===So.FAILED}},contentReadyToProcessPromise:{get:function(){return this._contentReadyToProcessPromise}},contentReadyPromise:{get:function(){return this._contentReadyPromise}},commandsLength:{get:function(){return this._commandsLength}}});var W_=new m;function VHe(t,n){let i=t._tileset,o=n.camera,r=t.boundingSphere,s=r.radius,a=m.multiplyByScalar(o.directionWC,t._centerZDepth,W_),c=m.add(o.positionWC,a,W_),l=m.subtract(c,r.center,W_);if(m.magnitude(l)>s){let S=m.normalize(l,W_),w=m.multiplyByScalar(S,s,W_),D=m.add(r.center,w,W_),I=m.subtract(D,o.positionWC,W_),O=m.normalize(I,W_);t._foveatedFactor=1-Math.abs(m.dot(o.directionWC,O))}else t._foveatedFactor=0;let h=t.refine===Or.REPLACE,_=i._skipLevelOfDetail;if(h&&!_||!i.foveatedScreenSpaceError||i.foveatedConeSize===1||t._priorityProgressiveResolution&&h&&_||i._pass===er.PRELOAD_FLIGHT||i._pass===er.PRELOAD)return!1;let y=1-Math.cos(o.frustum.fov*.5),p=i.foveatedConeSize*y;if(t._foveatedFactor<=p)return!1;let C=y-p,x=B.clamp((t._foveatedFactor-p)/C,0,1),T=i.foveatedInterpolationCallback(i.foveatedMinimumScreenSpaceErrorRelaxation,i.maximumScreenSpaceError,x),E=t._screenSpaceError===0&&f(t.parent)?t.parent._screenSpaceError*.5:t._screenSpaceError;return i.maximumScreenSpaceError-T<=E}var soe=new te;Fo.prototype.getScreenSpaceError=function(t,n,i){let o=this._tileset,r=A(i,1),s=f(this.parent)?this.parent.geometricError:o._geometricError,a=n?s:this.geometricError;if(a===0)return 0;let c=t.camera,l=c.frustum,u=t.context,d=u.drawingBufferWidth,h=u.drawingBufferHeight*r,_;if(t.mode===ne.SCENE2D||l instanceof $t){f(l._offCenterFrustum)&&(l=l._offCenterFrustum);let y=Math.max(l.top-l.bottom,l.right-l.left)/Math.max(d,h);_=a/y}else{let y=Math.max(this._distanceToCamera,B.EPSILON7),p=c.frustum.sseDenominator;if(_=a*h/(y*p),o.dynamicScreenSpaceError){let C=o._dynamicScreenSpaceErrorComputedDensity,x=o.dynamicScreenSpaceErrorFactor,T=B.fog(y,C)*x;_-=T}}return _/=t.pixelRatio,_};function kHe(t,n){if(t.progressiveResolutionHeightFraction<=0||t.progressiveResolutionHeightFraction>.5)return!1;let i=n._screenSpaceErrorProgressiveResolution>t._maximumScreenSpaceError;n._priorityProgressiveResolutionScreenSpaceErrorLeaf=!1;let o=n.parent,r=t._maximumScreenSpaceError,s=n._screenSpaceErrorProgressiveResolution<=r,a=f(o)&&o._screenSpaceErrorProgressiveResolution>r;return s&&a&&(n._priorityProgressiveResolutionScreenSpaceErrorLeaf=!0,i=!0),i}function UHe(t,n){let i=n.parent,r=f(i)&&(!t._skipLevelOfDetail||n._screenSpaceError===0||i.hasTilesetContent||i.hasImplicitContent)?i._screenSpaceError:n._screenSpaceError;return t.root._screenSpaceError-r}Fo.prototype.updateVisibility=function(t){let n=this.parent,i=this._tileset,o=f(n)?n.computedTransform:i.modelMatrix,r=f(n)?n._visibilityPlaneMask:$s.MASK_INDETERMINATE;this.updateTransform(o),this._distanceToCamera=this.distanceToTile(t),this._centerZDepth=this.distanceToTileCenter(t),this._screenSpaceError=this.getScreenSpaceError(t,!1),this._screenSpaceErrorProgressiveResolution=this.getScreenSpaceError(t,!1,i.progressiveResolutionHeightFraction),this._visibilityPlaneMask=this.visibility(t,r),this._visible=this._visibilityPlaneMask!==$s.MASK_OUTSIDE,this._inRequestVolume=this.insideViewerRequestVolume(t),this._priorityReverseScreenSpaceError=UHe(i,this),this._priorityProgressiveResolution=kHe(i,this),this.priorityDeferred=VHe(this,t)};Fo.prototype.updateExpiration=function(){if(f(this.expireDate)&&this.contentReady&&!this.hasEmptyContent&&!this.hasMultipleContents){let t=te.now(soe);te.lessThan(this.expireDate,t)&&(this._contentState=So.EXPIRED,this._expiredContent=this._content)}};function zHe(t){if(f(t.expireDuration)){let n=te.now(soe);te.addSeconds(n,t.expireDuration,n),f(t.expireDate)?te.lessThan(t.expireDate,n)&&te.clone(n,t.expireDate):t.expireDate=te.clone(n)}}function HHe(t){return function(){return t._priority}}Fo.prototype.requestContent=function(){return this.hasEmptyContent?0:this.hasMultipleContents?GHe(this):WHe(this)};function GHe(t){let n=t._content,i=t._tileset;if(!f(n)){let s=Li(t._header,"3DTILES_multiple_contents")?t._header.extensions["3DTILES_multiple_contents"]:t._header;n=new pF(i,t,t._contentResource.clone(),s),t._content=n}let o=n.requestInnerContents();if(o>0)return o;t._contentState=So.LOADING;let r=n.contentsFetchedPromise.then(function(){if(!(t._contentState!==So.LOADING||!f(n.readyPromise))){if(t.isDestroyed()){e6(t,i,"Tile was unloaded while content was loading");return}return t._contentState=So.PROCESSING,n}});return t._contentReadyToProcessPromise=r,t._contentReadyPromise=r.then(function(s){if(!!f(s))return n.readyPromise}).then(function(s){if(!!f(s)){if(t.isDestroyed()){e6(t,i,"Tile was unloaded while content was processing");return}return t._selectedFrame=0,t.lastStyleTime=0,te.now(t._loadTimestamp),t._contentState=So.READY,s}}).catch(function(s){e6(t,i,s)}),0}function e6(t,n,i){t._contentState===So.PROCESSING&&--n.statistics.numberOfTilesProcessing,t._contentState=So.FAILED}function WHe(t){let n=t._contentResource.clone(),i=t.contentExpired;i&&n.setQueryParameters({expired:t.expireDate.toString()});let o=new qo({throttle:!0,throttleByServer:!0,type:Qr.TILES3D,priorityFunction:HHe(t),serverKey:t._serverKey});t._request=o,n.request=o;let r=n.fetchArrayBuffer();if(!f(r))return 1;let s=t._contentState,a=t._tileset;t._contentState=So.LOADING,++a.statistics.numberOfPendingRequests;let c=r.then(function(l){if(t.isDestroyed()){t6(t,a);return}let u=jHe(t,l);return i&&(t.expireDate=void 0),t._content=u,t._contentState=So.PROCESSING,u});return t._contentReadyToProcessPromise=c,t._contentReadyPromise=c.then(function(l){if(!!f(l))return--a.statistics.numberOfPendingRequests,l.readyPromise}).then(function(l){if(!!f(l)){if(t.isDestroyed()){t6(t,a);return}return zHe(t),t._selectedFrame=0,t.lastStyleTime=0,te.now(t._loadTimestamp),t._contentState=So.READY,l}}).catch(function(l){return o.state===ai.CANCELLED?(t._contentState=s,--a.statistics.numberOfPendingRequests,++a.statistics.numberOfAttemptedRequests,Promise.reject("Cancelled")):(t6(t,a),Promise.reject(l))}),0}function t6(t,n){t._contentState===So.PROCESSING?--n.statistics.numberOfTilesProcessing:--n.statistics.numberOfPendingRequests,t._contentState=So.FAILED}function jHe(t,n){let i=kx(n),o=t._tileset;o._disableSkipLevelOfDetail=o._disableSkipLevelOfDetail||i.contentType===Os.GEOMETRY||i.contentType===Os.VECTOR,(i.contentType===Os.IMPLICIT_SUBTREE||i.contentType===Os.IMPLICIT_SUBTREE_JSON)&&(t.hasImplicitContent=!0),i.contentType===Os.EXTERNAL_TILESET&&(t.hasTilesetContent=!0);let r,s=Fx[i.contentType];f(i.binaryPayload)?r=s(o,t,t._contentResource,i.binaryPayload.buffer,0):r=s(o,t,t._contentResource,i.jsonPayload);let a=t._contentHeader;if(t.hasImplicitContentMetadata){let l=t.implicitSubtree,u=t.implicitCoordinates;r.metadata=l.getContentMetadataView(u,0)}else t.hasImplicitContent||(r.metadata=Nx(o,a));let c=Vx(o,a);return f(c)&&(r.group=new wx({metadata:c})),r}Fo.prototype.cancelRequests=function(){this.hasMultipleContents?this._content.cancelRequests():this._request.cancel()};Fo.prototype.unloadContent=function(){this.hasEmptyContent||this.hasTilesetContent||this.hasImplicitContent||(this._content=this._content&&this._content.destroy(),this._contentState=So.UNLOADED,this._contentReadyToProcessPromise=void 0,this._contentReadyPromise=void 0,this.lastStyleTime=0,this.clippingPlanesDirty=this._clippingPlanesState===0,this._clippingPlanesState=0,this._debugColorizeTiles=!1,this._debugBoundingVolume=this._debugBoundingVolume&&this._debugBoundingVolume.destroy(),this._debugContentBoundingVolume=this._debugContentBoundingVolume&&this._debugContentBoundingVolume.destroy(),this._debugViewerRequestVolume=this._debugViewerRequestVolume&&this._debugViewerRequestVolume.destroy())};var aoe=new ae;function i6(t,n){if(n.mode!==ne.SCENE3D&&!f(t._boundingVolume2D)){let i=t._boundingVolume.boundingSphere,o=ae.projectTo2D(i,n.mapProjection,aoe);t._boundingVolume2D=new G_(o.center,o.radius)}return n.mode!==ne.SCENE3D?t._boundingVolume2D:t._boundingVolume}function qHe(t,n){if(n.mode!==ne.SCENE3D&&!f(t._contentBoundingVolume2D)){let i=t._contentBoundingVolume.boundingSphere,o=ae.projectTo2D(i,n.mapProjection,aoe);t._contentBoundingVolume2D=new G_(o.center,o.radius)}return n.mode!==ne.SCENE3D?t._contentBoundingVolume2D:t._contentBoundingVolume}Fo.prototype.visibility=function(t,n){let i=t.cullingVolume,o=i6(this,t),r=this._tileset,s=r.clippingPlanes;if(f(s)&&s.enabled){let a=s.computeIntersectionWithBoundingVolume(o,r.clippingPlanesOriginMatrix);if(this._isClipped=a!==jt.INSIDE,a===jt.OUTSIDE)return $s.MASK_OUTSIDE}return i.computeVisibilityWithPlaneMask(o,n,!0)};Fo.prototype.contentVisibility=function(t){if(!f(this._contentBoundingVolume))return jt.INSIDE;if(this._visibilityPlaneMask===$s.MASK_INSIDE)return jt.INSIDE;let n=t.cullingVolume,i=qHe(this,t),o=this._tileset,r=o.clippingPlanes;if(f(r)&&r.enabled){let s=r.computeIntersectionWithBoundingVolume(i,o.clippingPlanesOriginMatrix);if(this._isClipped=s!==jt.INSIDE,s===jt.OUTSIDE)return jt.OUTSIDE}return n.computeVisibility(i)};Fo.prototype.distanceToTile=function(t){return i6(this,t).distanceToCamera(t)};var YHe=new m;Fo.prototype.distanceToTileCenter=function(t){let i=i6(this,t).boundingVolume,o=m.subtract(i.center,t.camera.positionWC,YHe);return m.dot(t.camera.directionWC,o)};Fo.prototype.insideViewerRequestVolume=function(t){let n=this._viewerRequestVolume;return!f(n)||n.distanceToCamera(t)===0};var coe=new $,loe=new m,XHe=new $,uoe=new m,foe=new le,KHe=new _i,n6=new N;function JHe(t,n,i){let o=m.fromElements(t[0],t[1],t[2],uoe),r=$.fromArray(t,3,XHe);o=N.multiplyByPoint(n,o,o);let s=N.getMatrix3(n,coe);return r=$.multiply(s,r,r),f(i)?(i.update(o,r),i):new Wf(o,r)}function ZHe(t,n,i,o){let r=le.unpack(t,0,foe),s=t[4],a=t[5],c=_i.fromRectangle(r,s,a,oe.WGS84,KHe),l=c.center,u=c.halfAxes;n=N.multiplyTransformation(n,N.inverseTransformation(i,n6),n6),l=N.multiplyByPoint(n,l,l);let d=N.getMatrix3(n,coe);return u=$.multiply(d,u,u),f(o)&&o instanceof Wf?(o.update(l,u),o):new Wf(l,u)}function QHe(t,n,i,o){if(!N.equalsEpsilon(n,i,B.EPSILON8))return ZHe(t,n,i,o);if(f(o))return o;let r=le.unpack(t,0,foe);return new Hf({rectangle:r,minimumHeight:t[4],maximumHeight:t[5]})}function $He(t,n,i){let o=m.fromElements(t[0],t[1],t[2],uoe),r=t[3];o=N.multiplyByPoint(n,o,o);let s=N.getScale(n,loe),a=m.maximumComponent(s);return r*=a,f(i)?(i.update(o,r),i):new G_(o,r)}Fo.prototype.createBoundingVolume=function(t,n,i){if(!f(t))throw new he("boundingVolume must be defined");if(Li(t,"3DTILES_bounding_volume_S2"))return new EF(t.extensions["3DTILES_bounding_volume_S2"]);if(f(t.box))return JHe(t.box,n,i);if(f(t.region))return QHe(t.region,n,this._initialTransform,i);if(f(t.sphere))return $He(t.sphere,n,i);throw new he("boundingVolume must contain a sphere, region, or box")};Fo.prototype.updateTransform=function(t){t=A(t,N.IDENTITY);let n=N.multiply(t,this.transform,n6);if(!!N.equals(n,this.computedTransform))return;N.clone(n,this.computedTransform);let o=this._header,r=this._contentHeader;this._boundingVolume=this.createBoundingVolume(o.boundingVolume,this.computedTransform,this._boundingVolume),f(this._contentBoundingVolume)&&(this._contentBoundingVolume=this.createBoundingVolume(r.boundingVolume,this.computedTransform,this._contentBoundingVolume)),f(this._viewerRequestVolume)&&(this._viewerRequestVolume=this.createBoundingVolume(o.viewerRequestVolume,this.computedTransform,this._viewerRequestVolume)),this.updateGeometricErrorScale(),this._debugBoundingVolume=this._debugBoundingVolume&&this._debugBoundingVolume.destroy(),this._debugContentBoundingVolume=this._debugContentBoundingVolume&&this._debugContentBoundingVolume.destroy(),this._debugViewerRequestVolume=this._debugViewerRequestVolume&&this._debugViewerRequestVolume.destroy()};Fo.prototype.updateGeometricErrorScale=function(){let t=N.getScale(this.computedTransform,loe),n=m.maximumComponent(t);this.geometricError=this._geometricError*n};function e8e(t,n,i,o){if(!o.isRender)return;let r=f(t._contentHeader)&&f(t._contentHeader.boundingVolume),s=t.hasEmptyContent||t.hasTilesetContent||t.hasImplicitContent,a=n.debugShowBoundingVolume||n.debugShowContentBoundingVolume&&!r;if(a){let u;t._finalResolution?s?u=z.DARKGRAY:u=z.WHITE:u=z.YELLOW,f(t._debugBoundingVolume)||(t._debugBoundingVolume=t._boundingVolume.createDebugVolume(u)),t._debugBoundingVolume.update(i);let d=t._debugBoundingVolume.getGeometryInstanceAttributes("outline");d.color=Lt.toValue(u,d.color)}else!a&&f(t._debugBoundingVolume)&&(t._debugBoundingVolume=t._debugBoundingVolume.destroy());n.debugShowContentBoundingVolume&&r?(f(t._debugContentBoundingVolume)||(t._debugContentBoundingVolume=t._contentBoundingVolume.createDebugVolume(z.BLUE)),t._debugContentBoundingVolume.update(i)):!n.debugShowContentBoundingVolume&&f(t._debugContentBoundingVolume)&&(t._debugContentBoundingVolume=t._debugContentBoundingVolume.destroy()),n.debugShowViewerRequestVolume&&f(t._viewerRequestVolume)?(f(t._debugViewerRequestVolume)||(t._debugViewerRequestVolume=t._viewerRequestVolume.createDebugVolume(z.YELLOW)),t._debugViewerRequestVolume.update(i)):!n.debugShowViewerRequestVolume&&f(t._debugViewerRequestVolume)&&(t._debugViewerRequestVolume=t._debugViewerRequestVolume.destroy());let c=n.debugColorizeTiles&&!t._debugColorizeTiles||f(n._heatmap.tilePropertyName),l=!n.debugColorizeTiles&&t._debugColorizeTiles;c?(n._heatmap.colorize(t,i),t._debugColorizeTiles=!0,t.color=t._debugColor):l&&(t._debugColorizeTiles=!1,t.color=z.WHITE),t._colorDirty&&(t._colorDirty=!1,t._content.applyDebugSettings(!0,t._color)),l&&n.makeStyleDirty()}function t8e(t,n,i){let o=t._content,r=t._expiredContent;if(!t.hasMultipleContents&&f(r)){if(!t.contentReady){r.update(n,i);return}t._expiredContent.destroy(),t._expiredContent=void 0}o.update(n,i)}function n8e(t,n){let i=n.clippingPlanes,o=0;f(i)&&t._isClipped&&i.enabled&&(o=i.clippingPlanesState),o!==t._clippingPlanesState&&(t._clippingPlanesState=o,t.clippingPlanesDirty=!0)}Fo.prototype.update=function(t,n,i){let o=n.commandList.length;n8e(this,t),e8e(this,t,n,i),t8e(this,t,n);let s=n.commandList.length-o;this._commandsLength=s;for(let a=0;a<s;++a){let c=n.commandList[o+a],l=c.pass===Te.TRANSLUCENT;c.depthForTranslucentClassification=l}this.clippingPlanesDirty=!1};var ooe=[];Fo.prototype.process=function(t,n){let i=n.commandList;n.commandList=ooe,this._content.update(t,n),ooe.length=0,n.commandList=i};function roe(t,n,i){let o=t*Math.pow(10,n);return parseInt(o)*Math.pow(10,i)}function wF(t,n,i){return Math.max(B.normalize(t,n,i)-B.EPSILON7,0)}Fo.prototype.updatePriority=function(){let t=this.tileset,n=t.preferLeaves,i=t._minimumPriority,o=t._maximumPriority,r=4,s=1,a=0,c=r,l=a+c,u=r,d=l+u,h=s,_=Math.pow(10,d),y=d+h,p=s,C=Math.pow(10,y),x=y+p,T=Math.pow(10,x),E=wF(this._depth,i.depth,o.depth);E=n?1-E:E;let w=!t._skipLevelOfDetail&&this.refine===Or.REPLACE?wF(this._priorityHolder._distanceToCamera,i.distance,o.distance):wF(this._priorityReverseScreenSpaceError,i.reverseScreenSpaceError,o.reverseScreenSpaceError),D=roe(w,c,a),I=this._priorityProgressiveResolution?0:_,O=wF(this._priorityHolder._foveatedFactor,i.foveatedFactor,o.foveatedFactor),M=roe(O,u,l),L=this.priorityDeferred?C:0,F=t._pass===er.PRELOAD_FLIGHT?0:T;this._priority=E+D+I+M+L+F};Fo.prototype.isDestroyed=function(){return!1};Fo.prototype.destroy=function(){return this._content=this._content&&this._content.destroy(),this._expiredContent=this._expiredContent&&!this._expiredContent.isDestroyed()&&this._expiredContent.destroy(),this._debugBoundingVolume=this._debugBoundingVolume&&this._debugBoundingVolume.destroy(),this._debugContentBoundingVolume=this._debugContentBoundingVolume&&this._debugContentBoundingVolume.destroy(),this._debugViewerRequestVolume=this._debugViewerRequestVolume&&this._debugViewerRequestVolume.destroy(),ue(this)};var Lu=Fo;function np(t){t=A(t,A.EMPTY_OBJECT);let n=t.id,i=t.group,o=t.class,r=f(i.properties)?i.properties:{};this._class=o,this._properties=r,this._id=n,this._extras=i.extras,this._extensions=i.extensions}Object.defineProperties(np.prototype,{class:{get:function(){return this._class}},id:{get:function(){return this._id}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}});np.prototype.hasProperty=function(t){return Nn.hasProperty(t,this._properties,this._class)};np.prototype.hasPropertyBySemantic=function(t){return Nn.hasPropertyBySemantic(t,this._properties,this._class)};np.prototype.getPropertyIds=function(t){return Nn.getPropertyIds(this._properties,this._class,t)};np.prototype.getProperty=function(t){return Nn.getProperty(t,this._properties,this._class)};np.prototype.setProperty=function(t,n){return Nn.setProperty(t,n,this._properties,this._class)};np.prototype.getPropertyBySemantic=function(t){return Nn.getPropertyBySemantic(t,this._properties,this._class)};np.prototype.setPropertyBySemantic=function(t,n){return Nn.setPropertyBySemantic(t,n,this._properties,this._class)};var Ew=np;function ip(t){t=A(t,A.EMPTY_OBJECT);let n=t.tileset,i=t.class,o=f(n.properties)?n.properties:{};this._class=i,this._properties=o,this._extras=n.extras,this._extensions=n.extensions}Object.defineProperties(ip.prototype,{class:{get:function(){return this._class}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}});ip.prototype.hasProperty=function(t){return Nn.hasProperty(t,this._properties,this._class)};ip.prototype.hasPropertyBySemantic=function(t){return Nn.hasPropertyBySemantic(t,this._properties,this._class)};ip.prototype.getPropertyIds=function(t){return Nn.getPropertyIds(this._properties,this._class,t)};ip.prototype.getProperty=function(t){return Nn.getProperty(t,this._properties,this._class)};ip.prototype.setProperty=function(t,n){return Nn.setProperty(t,n,this._properties,this._class)};ip.prototype.getPropertyBySemantic=function(t){return Nn.getPropertyBySemantic(t,this._properties,this._class)};ip.prototype.setPropertyBySemantic=function(t,n){return Nn.setPropertyBySemantic(t,n,this._properties,this._class)};var DF=ip;function doe(t){t=A(t,A.EMPTY_OBJECT);let n=t.metadataJson,i=t.schema,o=A(n.metadata,n.tileset),r;f(o)&&(r=new DF({tileset:o,class:i.classes[o.class]}));let s=[],a=[],c=n.groups;if(Array.isArray(c)){let l=c.length;for(let u=0;u<l;u++){let d=c[u];a.push(new Ew({group:d,class:i.classes[d.class]}))}}else if(f(c)){s=Object.keys(c).sort();let l=s.length;for(let u=0;u<l;u++){let d=s[u];if(c.hasOwnProperty(d)){let h=c[d];a.push(new Ew({id:d,group:c[d],class:i.classes[h.class]}))}}}this._schema=i,this._groups=a,this._groupIds=s,this._tileset=r,this._statistics=n.statistics,this._extras=n.extras,this._extensions=n.extensions}Object.defineProperties(doe.prototype,{schema:{get:function(){return this._schema}},groups:{get:function(){return this._groups}},groupIds:{get:function(){return this._groupIds}},tileset:{get:function(){return this._tileset}},statistics:{get:function(){return this._statistics}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}});var vF=doe;var hoe={},i8e=new m;hoe.checkChildrenWithinParent=function(t){let n=t.children,i=n.length,o=t.boundingVolume;if(o instanceof Wf||o instanceof Hf){let r=o._orientedBoundingBox;t._optimChildrenWithinParent=kf.USE_OPTIMIZATION;for(let s=0;s<i;++s){let c=n[s].boundingVolume;if(!(c instanceof Wf||c instanceof Hf)){t._optimChildrenWithinParent=kf.SKIP_OPTIMIZATION;break}let l=c._orientedBoundingBox,u=m.subtract(l.center,r.center,i8e),d=m.magnitude(u);m.divideByScalar(u,d,u);let h=Math.abs(r.halfAxes[0]*u.x)+Math.abs(r.halfAxes[1]*u.y)+Math.abs(r.halfAxes[2]*u.z)+Math.abs(r.halfAxes[3]*u.x)+Math.abs(r.halfAxes[4]*u.y)+Math.abs(r.halfAxes[5]*u.z)+Math.abs(r.halfAxes[6]*u.x)+Math.abs(r.halfAxes[7]*u.y)+Math.abs(r.halfAxes[8]*u.z),_=Math.abs(l.halfAxes[0]*u.x)+Math.abs(l.halfAxes[1]*u.y)+Math.abs(l.halfAxes[2]*u.z)+Math.abs(l.halfAxes[3]*u.x)+Math.abs(l.halfAxes[4]*u.y)+Math.abs(l.halfAxes[5]*u.z)+Math.abs(l.halfAxes[6]*u.x)+Math.abs(l.halfAxes[7]*u.y)+Math.abs(l.halfAxes[8]*u.z);if(h<=_+d){t._optimChildrenWithinParent=kf.SKIP_OPTIMIZATION;break}}}return t._optimChildrenWithinParent===kf.USE_OPTIMIZATION};var PF=hoe;function bw(){this.head=void 0,this.tail=void 0,this._length=0}Object.defineProperties(bw.prototype,{length:{get:function(){return this._length}}});function o8e(t,n,i){this.item=t,this.previous=n,this.next=i}bw.prototype.add=function(t){let n=new o8e(t,this.tail,void 0);return f(this.tail)?(this.tail.next=n,this.tail=n):(this.head=n,this.tail=n),++this._length,n};function moe(t,n){f(n.previous)&&f(n.next)?(n.previous.next=n.next,n.next.previous=n.previous):f(n.previous)?(n.previous.next=void 0,t.tail=n.previous):f(n.next)?(n.next.previous=void 0,t.head=n.next):(t.head=void 0,t.tail=void 0),n.next=void 0,n.previous=void 0}bw.prototype.remove=function(t){!f(t)||(moe(this,t),--this._length)};bw.prototype.splice=function(t,n){if(t===n)return;moe(this,n);let i=t.next;t.next=n,this.tail===t?this.tail=n:i.previous=n,n.next=i,n.previous=t};var IF=bw;function Sy(){this._list=new IF,this._sentinel=this._list.add(),this._trimTiles=!1}Sy.prototype.reset=function(){this._list.splice(this._list.tail,this._sentinel)};Sy.prototype.touch=function(t){let n=t.cacheNode;f(n)&&this._list.splice(this._sentinel,n)};Sy.prototype.add=function(t){f(t.cacheNode)||(t.cacheNode=this._list.add(t))};Sy.prototype.unloadTile=function(t,n,i){let o=n.cacheNode;!f(o)||(this._list.remove(o),n.cacheNode=void 0,i(t,n))};Sy.prototype.unloadTiles=function(t,n){let i=this._trimTiles;this._trimTiles=!1;let o=this._list,r=t.maximumMemoryUsage*1024*1024,s=this._sentinel,a=o.head;for(;a!==s&&(t.totalMemoryUsageInBytes>r||i);){let c=a.item;a=a.next,this.unloadTile(t,c,n)}};Sy.prototype.trim=function(){this._trimTiles=!0};var BF=Sy;function OF(t){this.tilePropertyName=t,this._minimum=Number.MAX_VALUE,this._maximum=-Number.MAX_VALUE,this._previousMinimum=Number.MAX_VALUE,this._previousMaximum=-Number.MAX_VALUE,this._referenceMinimum={},this._referenceMaximum={}}function r6(t,n){let i;return n==="_loadTimestamp"?i=te.toDate(t).getTime():i=t,i}OF.prototype.setReferenceMinimumMaximum=function(t,n,i){this._referenceMinimum[i]=r6(t,i),this._referenceMaximum[i]=r6(n,i)};function r8e(t,n){let i=t.tilePropertyName;if(f(i)){let o=r6(n[i],i);return f(o)?(t._maximum=Math.max(o,t._maximum),t._minimum=Math.min(o,t._minimum),o):(t.tilePropertyName=void 0,o)}}var o6=[new z(.1,.1,.1,1),new z(.153,.278,.878,1),new z(.827,.231,.49,1),new z(.827,.188,.22,1),new z(1,.592,.259,1),new z(1,.843,0,1)];OF.prototype.colorize=function(t,n){let i=this.tilePropertyName;if(!f(i)||!t.contentAvailable||t._selectedFrame!==n.frameNumber)return;let o=r8e(this,t),r=this._previousMinimum,s=this._previousMaximum;if(r===Number.MAX_VALUE||s===-Number.MAX_VALUE)return;let a=s-r+B.EPSILON7,l=B.clamp(o-r,0,a)/a,u=o6.length-1,d=l*u,h=Math.floor(d),_=Math.ceil(d),y=d-h,p=o6[h],C=o6[_],x=z.clone(z.WHITE);x.red=B.lerp(p.red,C.red,y),x.green=B.lerp(p.green,C.green,y),x.blue=B.lerp(p.blue,C.blue,y),t._debugColor=x};OF.prototype.resetMinimumMaximum=function(){let t=this.tilePropertyName;if(f(t)){let n=this._referenceMinimum[t],i=this._referenceMaximum[t],o=f(n)&&f(i);this._previousMinimum=o?n:this._minimum,this._previousMaximum=o?i:this._maximum,this._minimum=Number.MAX_VALUE,this._maximum=-Number.MAX_VALUE}};var RF=OF;function Qx(){this.selected=0,this.visited=0,this.numberOfCommands=0,this.numberOfAttemptedRequests=0,this.numberOfPendingRequests=0,this.numberOfTilesProcessing=0,this.numberOfTilesWithContentReady=0,this.numberOfTilesTotal=0,this.numberOfLoadedTilesTotal=0,this.numberOfFeaturesSelected=0,this.numberOfFeaturesLoaded=0,this.numberOfPointsSelected=0,this.numberOfPointsLoaded=0,this.numberOfTrianglesSelected=0,this.numberOfTilesStyled=0,this.numberOfFeaturesStyled=0,this.numberOfTilesCulledWithChildrenUnion=0,this.geometryByteLength=0,this.texturesByteLength=0,this.batchTableByteLength=0}Qx.prototype.clear=function(){this.selected=0,this.visited=0,this.numberOfCommands=0,this.numberOfAttemptedRequests=0,this.numberOfFeaturesSelected=0,this.numberOfPointsSelected=0,this.numberOfTrianglesSelected=0,this.numberOfTilesStyled=0,this.numberOfFeaturesStyled=0,this.numberOfTilesCulledWithChildrenUnion=0};function MF(t,n,i,o){let r=n.innerContents,s=n.pointsLength,a=n.trianglesLength,c=n.featuresLength,l=n.geometryByteLength,u=n.texturesByteLength,d=n.batchTableByteLength;if(o?(t.numberOfFeaturesLoaded+=i?-c:c,t.numberOfPointsLoaded+=i?-s:s,t.geometryByteLength+=i?-l:l,t.texturesByteLength+=i?-u:u,t.batchTableByteLength+=i?-d:d):(t.numberOfFeaturesSelected+=i?-c:c,t.numberOfPointsSelected+=i?-s:s,t.numberOfTrianglesSelected+=i?-a:a),f(r)){let h=r.length;for(let _=0;_<h;++_)MF(t,r[_],i,o)}}Qx.prototype.incrementSelectionCounts=function(t){MF(this,t,!1,!1)};Qx.prototype.incrementLoadCounts=function(t){MF(this,t,!1,!0)};Qx.prototype.decrementLoadCounts=function(t){MF(this,t,!0,!0)};Qx.clone=function(t,n){n.selected=t.selected,n.visited=t.visited,n.numberOfCommands=t.numberOfCommands,n.selected=t.selected,n.numberOfAttemptedRequests=t.numberOfAttemptedRequests,n.numberOfPendingRequests=t.numberOfPendingRequests,n.numberOfTilesProcessing=t.numberOfTilesProcessing,n.numberOfTilesWithContentReady=t.numberOfTilesWithContentReady,n.numberOfTilesTotal=t.numberOfTilesTotal,n.numberOfFeaturesSelected=t.numberOfFeaturesSelected,n.numberOfFeaturesLoaded=t.numberOfFeaturesLoaded,n.numberOfPointsSelected=t.numberOfPointsSelected,n.numberOfPointsLoaded=t.numberOfPointsLoaded,n.numberOfTrianglesSelected=t.numberOfTrianglesSelected,n.numberOfTilesStyled=t.numberOfTilesStyled,n.numberOfFeaturesStyled=t.numberOfFeaturesStyled,n.numberOfTilesCulledWithChildrenUnion=t.numberOfTilesCulledWithChildrenUnion,n.geometryByteLength=t.geometryByteLength,n.texturesByteLength=t.texturesByteLength,n.batchTableByteLength=t.batchTableByteLength};var j_=Qx;function Sw(){this._style=void 0,this._styleDirty=!1,this._lastStyleTime=0}Object.defineProperties(Sw.prototype,{style:{get:function(){return this._style},set:function(t){t!==this._style&&(this._style=t,this._styleDirty=!0)}}});Sw.prototype.makeDirty=function(){this._styleDirty=!0};Sw.prototype.resetDirty=function(){this._styleDirty=!1};Sw.prototype.applyStyle=function(t){if(!t.ready||f(this._style)&&!this._style._ready)return;let n=this._styleDirty;n&&++this._lastStyleTime;let i=this._lastStyleTime,o=t._statistics,r=n?t._selectedTiles:t._selectedTilesToStyle,s=r.length;for(let a=0;a<s;++a){let c=r[a];if(c.lastStyleTime!==i){let l=c.content;c.lastStyleTime=i,l.applyStyle(this._style),o.numberOfFeaturesStyled+=l.featuresLength,++o.numberOfTilesStyled}}};var LF=Sw;function s8e(t,n,i){let o=Li(n,"3DTILES_implicit_tiling")?n.extensions["3DTILES_implicit_tiling"]:n.implicitTiling;this.baseResource=t,this.geometricError=n.geometricError,this.metadataSchema=i;let r=n.boundingVolume;if(!f(r.box)&&!f(r.region)&&!Li(r,"3DTILES_bounding_volume_S2"))throw new he("Only box, region and 3DTILES_bounding_volume_S2 are supported for implicit tiling");this.boundingVolume=r,this.refine=n.refine,this.subtreeUriTemplate=new Ie({url:o.subtrees.uri}),this.contentUriTemplates=[],this.contentHeaders=[];let s=a8e(n);for(let a=0;a<s.length;a++){let c=s[a];this.contentHeaders.push(tt(c,!0));let l=new Ie({url:c.uri});this.contentUriTemplates.push(l)}this.contentCount=this.contentHeaders.length,this.tileHeader=c8e(n),this.subdivisionScheme=jr[o.subdivisionScheme],this.branchingFactor=jr.getBranchingFactor(this.subdivisionScheme),this.subtreeLevels=o.subtreeLevels,f(o.availableLevels)?this.availableLevels=o.availableLevels:this.availableLevels=o.maximumLevel+1}function a8e(t){if(Li(t,"3DTILES_multiple_contents")){let n=t.extensions["3DTILES_multiple_contents"];return f(n.contents)?n.contents:n.content}return f(t.contents)?t.contents:f(t.content)?[t.content]:[]}function c8e(t){let n=tt(t,!0);return f(n.extensions)&&(delete n.extensions["3DTILES_implicit_tiling"],delete n.extensions["3DTILES_multiple_contents"],Object.keys(n.extensions).length===0&&delete n.extensions),delete n.implicitTiling,delete n.contents,delete n.content,n}var FF=s8e;var ww={};function poe(t){return t=(t^t<<8)&16711935,t=(t^t<<4)&252645135,t=(t^t<<2)&858993459,t=(t^t<<1)&1431655765,t}function s6(t){return t=(t^t<<16)&50331903,t=(t^t<<8)&50393103,t=(t^t<<4)&51130563,t=(t^t<<2)&153391689,t}function _oe(t){return t&=1431655765,t=(t^t>>1)&858993459,t=(t^t>>2)&252645135,t=(t^t>>4)&16711935,t=(t^t>>8)&65535,t}function a6(t){return t&=153391689,t=(t^t>>2)&51130563,t=(t^t>>4)&50393103,t=(t^t>>8)&4278190335,t=(t^t>>16)&1023,t}ww.encode2D=function(t,n){return(poe(t)|poe(n)<<1)>>>0};ww.decode2D=function(t,n){return f(n)||(n=new Array(2)),n[0]=_oe(t),n[1]=_oe(t>>1),n};ww.encode3D=function(t,n,i){return s6(t)|s6(n)<<1|s6(i)<<2};ww.decode3D=function(t,n){return f(n)||(n=new Array(3)),n[0]=a6(t),n[1]=a6(t>>1),n[2]=a6(t>>2),n};var wy=ww;function Bo(t){this.subdivisionScheme=t.subdivisionScheme,this.subtreeLevels=t.subtreeLevels,this.level=t.level,this.x=t.x,this.y=t.y,this.z=void 0,t.subdivisionScheme===jr.OCTREE&&(this.z=t.z)}Object.defineProperties(Bo.prototype,{childIndex:{get:function(){let t=0;return t|=this.x&1,t|=(this.y&1)<<1,this.subdivisionScheme===jr.OCTREE&&(t|=(this.z&1)<<2),t}},mortonIndex:{get:function(){return this.subdivisionScheme===jr.OCTREE?wy.encode3D(this.x,this.y,this.z):wy.encode2D(this.x,this.y)}},tileIndex:{get:function(){let t=this.subdivisionScheme===jr.OCTREE?((1<<3*this.level)-1)/7:((1<<2*this.level)-1)/3,n=this.mortonIndex;return t+n}}});Bo.prototype.getDescendantCoordinates=function(t){let n=this.level+t.level,i=(this.x<<t.level)+t.x,o=(this.y<<t.level)+t.y;if(this.subdivisionScheme===jr.OCTREE){let r=(this.z<<t.level)+t.z;return new Bo({subdivisionScheme:this.subdivisionScheme,subtreeLevels:this.subtreeLevels,level:n,x:i,y:o,z:r})}return new Bo({subdivisionScheme:this.subdivisionScheme,subtreeLevels:this.subtreeLevels,level:n,x:i,y:o})};Bo.prototype.getAncestorCoordinates=function(t){let n=1<<t,i=this.level-t,o=Math.floor(this.x/n),r=Math.floor(this.y/n);if(this.subdivisionScheme===jr.OCTREE){let s=Math.floor(this.z/n);return new Bo({subdivisionScheme:this.subdivisionScheme,subtreeLevels:this.subtreeLevels,level:i,x:o,y:r,z:s})}return new Bo({subdivisionScheme:this.subdivisionScheme,subtreeLevels:this.subtreeLevels,level:i,x:o,y:r})};Bo.prototype.getOffsetCoordinates=function(t){let n=t.level-this.level,i=1<<n,o=t.x%i,r=t.y%i;if(this.subdivisionScheme===jr.OCTREE){let s=t.z%i;return new Bo({subdivisionScheme:this.subdivisionScheme,subtreeLevels:this.subtreeLevels,level:n,x:o,y:r,z:s})}return new Bo({subdivisionScheme:this.subdivisionScheme,subtreeLevels:this.subtreeLevels,level:n,x:o,y:r})};Bo.prototype.getChildCoordinates=function(t){let n=this.level+1,i=2*this.x+t%2,o=2*this.y+Math.floor(t/2)%2;if(this.subdivisionScheme===jr.OCTREE){let r=2*this.z+Math.floor(t/4)%2;return new Bo({subdivisionScheme:this.subdivisionScheme,subtreeLevels:this.subtreeLevels,level:n,x:i,y:o,z:r})}return new Bo({subdivisionScheme:this.subdivisionScheme,subtreeLevels:this.subtreeLevels,level:n,x:i,y:o})};Bo.prototype.getSubtreeCoordinates=function(){return this.getAncestorCoordinates(this.level%this.subtreeLevels)};Bo.prototype.getParentSubtreeCoordinates=function(){return this.getAncestorCoordinates(this.level%this.subtreeLevels+this.subtreeLevels)};Bo.prototype.isAncestor=function(t){let n=t.level-this.level;if(n<=0)return!1;let i=t.x>>n,o=t.y>>n,r=this.x===i,s=this.y===o;if(this.subdivisionScheme===jr.OCTREE){let a=t.z>>n,c=this.z===a;return r&&s&&c}return r&&s};Bo.prototype.isEqual=function(t){return this.subdivisionScheme===t.subdivisionScheme&&this.subtreeLevels===t.subtreeLevels&&this.level===t.level&&this.x===t.x&&this.y===t.y&&(this.subdivisionScheme===jr.OCTREE?this.z===t.z:!0)};Bo.prototype.isImplicitTilesetRoot=function(){return this.level===0};Bo.prototype.isSubtreeRoot=function(){return this.level%this.subtreeLevels===0};Bo.prototype.isBottomOfSubtree=function(){return this.level%this.subtreeLevels===this.subtreeLevels-1};Bo.prototype.getTemplateValues=function(){let t={level:this.level,x:this.x,y:this.y};return this.subdivisionScheme===jr.OCTREE&&(t.z=this.z),t};var goe=[0,0,0];Bo.fromMortonIndex=function(t,n,i,o){let r;return t===jr.OCTREE?(r=wy.decode3D(o,goe),new Bo({subdivisionScheme:t,subtreeLevels:n,level:i,x:r[0],y:r[1],z:r[2]})):(r=wy.decode2D(o,goe),new Bo({subdivisionScheme:t,subtreeLevels:n,level:i,x:r[0],y:r[1]}))};Bo.fromTileIndex=function(t,n,i){let o,r,s;return t===jr.OCTREE?(o=Math.floor(B.log2(7*i+1)/3),r=((1<<3*o)-1)/7,s=i-r):(o=Math.floor(B.log2(3*i+1)/2),r=((1<<2*o)-1)/3,s=i-r),Bo.fromMortonIndex(t,n,o,s)};var NF=Bo;function Rs(t){t=A(t,A.EMPTY_OBJECT),this._url=void 0,this._urlDomains=t.urlDomains||[],this._basePath=void 0,this._root=void 0,this._resource=void 0,this._asset=void 0,this._properties=void 0,this._geometricError=void 0,this._extensionsUsed=void 0,this._extensions=void 0,this._modelUpAxis=void 0,this._modelForwardAxis=void 0,this._cache=new BF,this._processingQueue=[],this._selectedTiles=[],this._emptyTiles=[],this._requestedTiles=[],this._selectedTilesToStyle=[],this._loadTimestamp=void 0,this._timeSinceLoad=0,this._updatedVisibilityFrame=0,this._updatedModelMatrixFrame=0,this._modelMatrixChanged=!1,this._previousModelMatrix=void 0,this._extras=void 0,this._credits=void 0,this._showCreditsOnScreen=A(t.showCreditsOnScreen,!1),this._cullWithChildrenBounds=A(t.cullWithChildrenBounds,!0),this._allTilesAdditive=!0,this._hasMixedContent=!1,this._stencilClearCommand=void 0,this._backfaceCommands=new Eu,this._maximumScreenSpaceError=A(t.maximumScreenSpaceError,16),this._maximumMemoryUsage=A(t.maximumMemoryUsage,512),this._styleEngine=new LF,this._styleApplied=!1,this._modelMatrix=f(t.modelMatrix)?N.clone(t.modelMatrix):N.clone(N.IDENTITY),this._statistics=new j_,this._statisticsLast=new j_,this._statisticsPerPass=new Array(er.NUMBER_OF_PASSES);for(let a=0;a<er.NUMBER_OF_PASSES;++a)this._statisticsPerPass[a]=new j_;this._requestedTilesInFlight=[],this._maximumPriority={foveatedFactor:-Number.MAX_VALUE,depth:-Number.MAX_VALUE,distance:-Number.MAX_VALUE,reverseScreenSpaceError:-Number.MAX_VALUE},this._minimumPriority={foveatedFactor:Number.MAX_VALUE,depth:Number.MAX_VALUE,distance:Number.MAX_VALUE,reverseScreenSpaceError:Number.MAX_VALUE},this._heatmap=new RF(t.debugHeatmapTilePropertyName),this.cullRequestsWhileMoving=A(t.cullRequestsWhileMoving,!0),this._cullRequestsWhileMoving=!1,this.cullRequestsWhileMovingMultiplier=A(t.cullRequestsWhileMovingMultiplier,60),this.progressiveResolutionHeightFraction=B.clamp(A(t.progressiveResolutionHeightFraction,.3),0,.5),this.preferLeaves=A(t.preferLeaves,!1),this._tilesLoaded=!1,this._initialTilesLoaded=!1,this._tileDebugLabels=void 0,this._classificationType=t.classificationType,this._ellipsoid=A(t.ellipsoid,oe.WGS84),this._initialClippingPlanesOriginMatrix=N.IDENTITY,this._clippingPlanesOriginMatrix=void 0,this._clippingPlanesOriginMatrixDirty=!0,this._vectorClassificationOnly=A(t.vectorClassificationOnly,!1),this._vectorKeepDecodedPositions=A(t.vectorKeepDecodedPositions,!1),this.preloadWhenHidden=A(t.preloadWhenHidden,!1),this.preloadFlightDestinations=A(t.preloadFlightDestinations,!0),this._pass=void 0,this.dynamicScreenSpaceError=A(t.dynamicScreenSpaceError,!1),this.foveatedScreenSpaceError=A(t.foveatedScreenSpaceError,!0),this._foveatedConeSize=A(t.foveatedConeSize,.1),this._foveatedMinimumScreenSpaceErrorRelaxation=A(t.foveatedMinimumScreenSpaceErrorRelaxation,0),this.foveatedInterpolationCallback=A(t.foveatedInterpolationCallback,B.lerp),this.foveatedTimeDelay=A(t.foveatedTimeDelay,.2),this.dynamicScreenSpaceErrorDensity=.00278,this.dynamicScreenSpaceErrorFactor=4,this.dynamicScreenSpaceErrorHeightFalloff=.25,this._dynamicScreenSpaceErrorComputedDensity=0,this.shadows=A(t.shadows,gn.ENABLED),this.show=A(t.show,!0),this.colorBlendMode=Bl.HIGHLIGHT,this.colorBlendAmount=.5,this._pointCloudShading=new xm(t.pointCloudShading),this._pointCloudEyeDomeLighting=new o_,this.loadProgress=new Ae,this.allTilesLoaded=new Ae,this.initialTilesLoaded=new Ae,this.tileLoad=new Ae,this.tileUnload=new Ae,this.tileFailed=new Ae,this.tileVisible=new Ae,this.skipLevelOfDetail=A(t.skipLevelOfDetail,!1),this._skipLevelOfDetail=this.skipLevelOfDetail,this._disableSkipLevelOfDetail=!1,this.baseScreenSpaceError=A(t.baseScreenSpaceError,1024),this.skipScreenSpaceErrorFactor=A(t.skipScreenSpaceErrorFactor,16),this.skipLevels=A(t.skipLevels,1),this.immediatelyLoadDesiredLevelOfDetail=A(t.immediatelyLoadDesiredLevelOfDetail,!1),this.loadSiblings=A(t.loadSiblings,!1),this._clippingPlanes=void 0,this.clippingPlanes=t.clippingPlanes,f(t.imageBasedLighting)?(this._imageBasedLighting=t.imageBasedLighting,this._shouldDestroyImageBasedLighting=!1):(this._imageBasedLighting=new zC,this._shouldDestroyImageBasedLighting=!0),this.lightColor=t.lightColor,this.backFaceCulling=A(t.backFaceCulling,!0),this._enableShowOutline=A(t.enableShowOutline,!0),this.showOutline=A(t.showOutline,!0),this.outlineColor=A(t.outlineColor,z.BLACK),this.splitDirection=A(t.splitDirection,Wc.NONE),this._projectTo2D=A(t.projectTo2D,!1),this.debugFreezeFrame=A(t.debugFreezeFrame,!1),this.debugColorizeTiles=A(t.debugColorizeTiles,!1),this._enableDebugWireframe=A(t.enableDebugWireframe,!1),this.debugWireframe=A(t.debugWireframe,!1),this.debugWireframe===!0&&this._enableDebugWireframe===!1&&Bt("tileset-debug-wireframe-ignored","enableDebugWireframe must be set to true in the Cesium3DTileset constructor, otherwise debugWireframe will be ignored."),this.debugShowBoundingVolume=A(t.debugShowBoundingVolume,!1),this.debugShowContentBoundingVolume=A(t.debugShowContentBoundingVolume,!1),this.debugShowViewerRequestVolume=A(t.debugShowViewerRequestVolume,!1),this._tileDebugLabels=void 0,this.debugPickedTileLabelOnly=!1,this.debugPickedTile=void 0,this.debugPickPosition=void 0,this.debugShowGeometricError=A(t.debugShowGeometricError,!1),this.debugShowRenderingStatistics=A(t.debugShowRenderingStatistics,!1),this.debugShowMemoryUsage=A(t.debugShowMemoryUsage,!1),this.debugShowUrl=A(t.debugShowUrl,!1),this.examineVectorLinesFunction=void 0,this._metadataExtension=void 0,this._customShader=t.customShader;let n=A(t.featureIdLabel,"featureId_0");typeof n=="number"&&(n=`featureId_${n}`),this._featureIdLabel=n;let i=A(t.instanceFeatureIdLabel,"instanceFeatureId_0");typeof i=="number"&&(i=`instanceFeatureId_${i}`),this._instanceFeatureIdLabel=i,this._schemaLoader=void 0;let o=this,r,s=t.url;t.url instanceof Ie?(s=t.url.url,s.indexOf("{DOMAIN}")>-1&&(s=s.replace("{DOMAIN}",t.urlDomains[0]),t.url.url=s)):s.indexOf("{DOMAIN}")>-1&&(t.url=s.replace("{DOMAIN}",t.urlDomains[0])),this._readyPromise=Promise.resolve(t.url).then(function(a){let c;return r=Ie.createIfNeeded(a),o._resource=r,o._credits=r.credits,r.extension==="json"?c=r.getBaseUri(!0):r.isDataUri&&(c=""),o._url=r.url,o._basePath=c,Rs.loadJson(r)}).then(function(a){if(!o.isDestroyed())return l8e(o,a)}).then(function(a){if(o.isDestroyed())return;o._root=o.loadTileset(r,a);let c=f(a.asset.gltfUpAxis)?vo.fromName(a.asset.gltfUpAxis):vo.Y,l=A(t.modelUpAxis,c),u=A(t.modelForwardAxis,vo.X),d=a.asset;o._asset=d,o._properties=a.properties,o._geometricError=a.geometricError,o._extensionsUsed=a.extensionsUsed,o._extensions=a.extensions,o._modelUpAxis=l,o._modelForwardAxis=u,o._extras=a.extras;let h=d.extras;if(f(h)&&f(h.cesium)&&f(h.cesium.credits)){let C=h.cesium.credits,x=o._credits;f(x)||(x=[],o._credits=x);for(let T=0;T<C.length;++T){let E=C[T];x.push(new Jt(E.html,o._showCreditsOnScreen))}}let y=o._root.createBoundingVolume(a.root.boundingVolume,N.IDENTITY).boundingSphere.center,p=o._ellipsoid.cartesianToCartographic(y);return f(p)&&p.height>ri._defaultMinTerrainHeight&&(o._initialClippingPlanesOriginMatrix=vt.eastNorthUpToFixedFrame(y)),o._clippingPlanesOriginMatrix=N.clone(o._initialClippingPlanesOriginMatrix),o})}Object.defineProperties(Rs.prototype,{isCesium3DTileset:{get:function(){return!0}},asset:{get:function(){return this._asset}},extensions:{get:function(){return this._extensions}},clippingPlanes:{get:function(){return this._clippingPlanes},set:function(t){Qs.setOwner(t,this,"_clippingPlanes")}},properties:{get:function(){return this._properties}},ready:{get:function(){return f(this._root)}},readyPromise:{get:function(){return this._readyPromise}},tilesLoaded:{get:function(){return this._tilesLoaded}},resource:{get:function(){return this._resource}},basePath:{get:function(){return ws("Cesium3DTileset.basePath","Cesium3DTileset.basePath has been deprecated. All tiles are relative to the url of the tileset JSON file that contains them. Use the url property instead."),this._basePath}},style:{get:function(){return this._styleEngine.style},set:function(t){this._styleEngine.style=t}},customShader:{get:function(){return this._customShader},set:function(t){this._customShader=t}},metadataExtension:{get:function(){return this._metadataExtension}},metadata:{get:function(){if(f(this._metadataExtension))return this._metadataExtension.tileset}},schema:{get:function(){if(f(this._metadataExtension))return this._metadataExtension.schema}},maximumScreenSpaceError:{get:function(){return this._maximumScreenSpaceError},set:function(t){this._maximumScreenSpaceError=t}},maximumMemoryUsage:{get:function(){return this._maximumMemoryUsage},set:function(t){this._maximumMemoryUsage=t}},pointCloudShading:{get:function(){return this._pointCloudShading},set:function(t){this._pointCloudShading=t}},root:{get:function(){return this._root}},boundingSphere:{get:function(){return this._root.updateTransform(this._modelMatrix),this._root.boundingSphere}},modelMatrix:{get:function(){return this._modelMatrix},set:function(t){this._modelMatrix=N.clone(t,this._modelMatrix)}},timeSinceLoad:{get:function(){return this._timeSinceLoad}},totalMemoryUsageInBytes:{get:function(){let t=this._statistics;return t.texturesByteLength+t.geometryByteLength+t.batchTableByteLength}},clippingPlanesOriginMatrix:{get:function(){return f(this._clippingPlanesOriginMatrix)?(this._clippingPlanesOriginMatrixDirty&&(N.multiply(this.root.computedTransform,this._initialClippingPlanesOriginMatrix,this._clippingPlanesOriginMatrix),this._clippingPlanesOriginMatrixDirty=!1),this._clippingPlanesOriginMatrix):N.IDENTITY}},styleEngine:{get:function(){return this._styleEngine}},statistics:{get:function(){return this._statistics}},classificationType:{get:function(){return this._classificationType}},ellipsoid:{get:function(){return this._ellipsoid}},foveatedConeSize:{get:function(){return this._foveatedConeSize},set:function(t){this._foveatedConeSize=t}},foveatedMinimumScreenSpaceErrorRelaxation:{get:function(){return this._foveatedMinimumScreenSpaceErrorRelaxation},set:function(t){this._foveatedMinimumScreenSpaceErrorRelaxation=t}},extras:{get:function(){return this._extras}},imageBasedLighting:{get:function(){return this._imageBasedLighting},set:function(t){t!==this._imageBasedLighting&&(this._shouldDestroyImageBasedLighting&&!this._imageBasedLighting.isDestroyed()&&this._imageBasedLighting.destroy(),this._imageBasedLighting=t,this._shouldDestroyImageBasedLighting=!1)}},vectorClassificationOnly:{get:function(){return this._vectorClassificationOnly}},vectorKeepDecodedPositions:{get:function(){return this._vectorKeepDecodedPositions}},showCreditsOnScreen:{get:function(){return this._showCreditsOnScreen},set:function(t){this._showCreditsOnScreen=t}},featureIdLabel:{get:function(){return this._featureIdLabel},set:function(t){typeof t=="number"&&(t=`featureId_${t}`),this._featureIdLabel=t}},instanceFeatureIdLabel:{get:function(){return this._instanceFeatureIdLabel},set:function(t){typeof t=="number"&&(t=`instanceFeatureId_${t}`),this._instanceFeatureIdLabel=t}}});Rs.loadJson=function(t){return Ie.createIfNeeded(t).fetchJson()};Rs.prototype.makeStyleDirty=function(){this._styleEngine.makeDirty()};Rs.prototype.loadTileset=function(t,n,i){let o=n.asset;if(!f(o))throw new he("Tileset must have an asset property.");if(o.version!=="0.0"&&o.version!=="1.0"&&o.version!=="1.1")throw new he("The tileset must be 3D Tiles version 0.0, 1.0, or 1.1");f(n.extensionsRequired)&&Rs.checkSupportedExtensions(n.extensionsRequired);let r=this._statistics,s=o.tilesetVersion;f(s)&&(this._basePath+=`?v=${s}`,t=t.clone(),t.setQueryParameters({v:s}));let a=yoe(this,t,n.root,i);f(i)&&(i.children.push(a),a._depth=i._depth+1);let c=[];for(c.push(a);c.length>0;){let l=c.pop();++r.numberOfTilesTotal,this._allTilesAdditive=this._allTilesAdditive&&l.refine===Or.ADD;let u=l._header.children;if(f(u)){let d=u.length;for(let h=0;h<d;++h){let _=u[h],y=yoe(this,t,_,l);l.children.push(y),y._depth=l._depth+1,c.push(y)}}this._cullWithChildrenBounds&&PF.checkChildrenWithinParent(l)}return a};function yoe(t,n,i,o){if(f(i.implicitTiling)||Li(i,"3DTILES_implicit_tiling")){let s=t.schema,a=new FF(n,i,s),c=new NF({subdivisionScheme:a.subdivisionScheme,subtreeLevels:a.subtreeLevels,level:0,x:0,y:0,z:0}),l=a.subtreeUriTemplate.getDerivedResource({templateValues:c.getTemplateValues()}).url,d=tt(i,!0);d.contents=[{uri:l}],delete d.content,delete d.extensions;let h=new Lu(t,n,d,o);return h.implicitTileset=a,h.implicitCoordinates=c,h}return new Lu(t,n,i,o)}function l8e(t,n){let i=Li(n,"3DTILES_metadata")?n.extensions["3DTILES_metadata"]:n,o;if(f(i.schemaUri)){let r=t._resource.getDerivedResource({url:i.schemaUri});o=fo.loadSchema({resource:r})}else if(f(i.schema))o=fo.loadSchema({schema:i.schema});else return Promise.resolve(n);return t._schemaLoader=o,o.promise.then(function(r){return t._metadataExtension=new vF({schema:r.schema,metadataJson:i}),n})}var Aoe=new m,u8e=new de,f8e=new N,d8e=new m,h8e=new m,m8e=new m;function p8e(t,n){let i,o,r,s,a,c=n.camera,l=t._root,u=l.contentBoundingVolume;if(u instanceof Hf)i=m.normalize(c.positionWC,Aoe),o=c.directionWC,r=c.positionCartographic.height,s=u.minimumHeight,a=u.maximumHeight;else{let T=N.inverseTransformation(l.computedTransform,f8e),E=n.mapProjection.ellipsoid,S=u.boundingVolume,w=N.multiplyByPoint(T,S.center,d8e);if(m.magnitude(w)>E.minimumRadius){let D=de.fromCartesian(w,E,u8e);i=m.normalize(c.positionWC,Aoe),o=c.directionWC,r=c.positionCartographic.height,s=0,a=D.height*2}else{let D=N.multiplyByPoint(T,c.positionWC,h8e);if(i=m.UNIT_Z,o=N.multiplyByPointAsVector(T,c.directionWC,m8e),o=m.normalize(o,o),r=D.z,u instanceof Wf){let I=l._header.boundingVolume.box[11];s=w.z-I,a=w.z+I}else if(u instanceof G_){let I=S.radius;s=w.z-I,a=w.z+I}}}let d=t.dynamicScreenSpaceErrorHeightFalloff,h=s+(a-s)*d,_=a,y=B.clamp((r-h)/(_-h),0,1),C=1-Math.abs(m.dot(o,i));C=C*(1-y);let x=t.dynamicScreenSpaceErrorDensity;x*=C,t._dynamicScreenSpaceErrorComputedDensity=x}function _8e(t,n){if(n.hasEmptyContent)return;let i=t._statistics,o=n.contentExpired,r=n.requestContent();if(r>0){i.numberOfAttemptedRequests+=r;return}o&&(n.hasTilesetContent||n.hasImplicitContent?v8e(t,n):(i.decrementLoadCounts(n.content),--i.numberOfTilesWithContentReady)),t._requestedTilesInFlight.push(n),n.contentReadyToProcessPromise.then(C8e(t,n)).catch(function(s){}),n.contentReadyPromise.then(T8e(t,n)).catch(x8e(t,n))}function g8e(t,n){return t._priority-n._priority}Rs.prototype.postPassesUpdate=function(t){!this.ready||(y8e(this,t),I8e(this,t),this._cache.unloadTiles(this,Toe),this._styleApplied&&this._styleEngine.resetDirty(),this._styleApplied=!1)};Rs.prototype.prePassesUpdate=function(t){if(!this.ready)return;b8e(this,t);let n=this._clippingPlanes;this._clippingPlanesOriginMatrixDirty=!0,f(n)&&n.enabled&&n.update(t),f(this._loadTimestamp)||(this._loadTimestamp=te.clone(t.time)),this._timeSinceLoad=Math.max(te.secondsDifference(t.time,this._loadTimestamp)*1e3,0),this._skipLevelOfDetail=this.skipLevelOfDetail&&!f(this._classificationType)&&!this._disableSkipLevelOfDetail&&!this._allTilesAdditive,this.dynamicScreenSpaceError&&p8e(this,t),t.newFrame&&this._cache.reset()};function y8e(t,n){let i=t._requestedTilesInFlight,o=0,r=i.length;for(let s=0;s<r;++s){let a=i[s],c=n.frameNumber-a._touchedFrame>=1;if(a._contentState!==So.LOADING){++o;continue}else if(c){a.cancelRequests(),++o;continue}o>0&&(i[s-o]=a)}i.length-=o}function A8e(t,n){let i=t._requestedTiles,o=i.length;i.sort(g8e);for(let r=0;r<o;++r)_8e(t,i[r])}function C8e(t,n){return function(){t._processingQueue.push(n),++t._statistics.numberOfTilesProcessing}}function x8e(t,n){return function(i){if(n._contentState!==So.FAILED)return;let o=n._contentResource.url,r=f(i.message)?i.message:i.toString();t.tileFailed.numberOfListeners>0?t.tileFailed.raiseEvent({url:o,message:r}):(console.log(`A 3D tile failed to load: ${o}`),console.log(`Error: ${r}`))}}function T8e(t,n){return function(i){--t._statistics.numberOfTilesProcessing,f(i)&&(!n.hasTilesetContent&&!n.hasImplicitContent&&(t._statistics.incrementLoadCounts(n.content),++t._statistics.numberOfTilesWithContentReady,++t._statistics.numberOfLoadedTilesTotal,t._cache.add(n)),t.tileLoad.raiseEvent(n))}}function E8e(t){let n=t._processingQueue,i=n.length,o=0;for(let r=0;r<i;++r){let s=n[r];if(s._contentState!==So.PROCESSING){++o;continue}o>0&&(n[r-o]=s)}n.length-=o}function b8e(t,n){E8e(t);let i=t._processingQueue,o=i.length;for(let r=0;r<o;++r)i[r].process(t,n)}var VF=new m,S8e={maximumFractionDigits:3};function Coe(t){let n=t/1048576;return n<1?n.toLocaleString(void 0,S8e):Math.round(n).toLocaleString()}function c6(t){let n=t.boundingVolume.boundingVolume,i=n.halfAxes,o=n.radius,r=m.clone(n.center,VF);if(f(i))r.x+=.75*(i[0]+i[3]+i[6]),r.y+=.75*(i[1]+i[4]+i[7]),r.z+=.75*(i[2]+i[5]+i[8]);else if(f(o)){let s=m.normalize(n.center,VF);s=m.multiplyByScalar(s,.75*o,VF),r=m.add(s,n.center,VF)}return r}function l6(t,n,i){let o="",r=0;if(n.debugShowGeometricError&&(o+=`
Geometric error: ${t.geometricError}`,r++),n.debugShowRenderingStatistics&&(o+=`
Commands: ${t.commandsLength}`,r++,t.content.pointsLength>0&&(o+=`
Points: ${t.content.pointsLength}`,r++),t.content.trianglesLength>0&&(o+=`
Triangles: ${t.content.trianglesLength}`,r++),o+=`
Features: ${t.content.featuresLength}`,r++),n.debugShowMemoryUsage&&(o+=`
Texture Memory: ${Coe(t.content.texturesByteLength)}`,o+=`
Geometry Memory: ${Coe(t.content.geometryByteLength)}`,r+=2),n.debugShowUrl)if(t.hasMultipleContents){o+=`
Urls:`;let a=t.content.innerContentUrls;for(let c=0;c<a.length;c++)o+=`
- ${a[c]}`;r+=a.length}else o+=`
Url: ${t._contentHeader.uri}`,r++;let s={text:o.substring(1),position:i,font:`${19-r}px sans-serif`,showBackground:!0,disableDepthTestDistance:Number.POSITIVE_INFINITY};return n._tileDebugLabels.add(s)}function w8e(t,n){let i,o,r=t._selectedTiles,s=r.length,a=t._emptyTiles,c=a.length;if(t._tileDebugLabels.removeAll(),t.debugPickedTileLabelOnly){if(f(t.debugPickedTile)){let l=f(t.debugPickPosition)?t.debugPickPosition:c6(t.debugPickedTile),u=l6(t.debugPickedTile,t,l);u.pixelOffset=new W(15,-15)}}else{for(i=0;i<s;++i)o=r[i],l6(o,t,c6(o));for(i=0;i<c;++i)o=a[i],(o.hasTilesetContent||o.hasImplicitContent)&&l6(o,t,c6(o))}t._tileDebugLabels.update(n)}function D8e(t,n,i){t._styleEngine.applyStyle(t),t._styleApplied=!0;let o=i.isRender,r=t._statistics,s=n.commandList,a=s.length,c=t._selectedTiles,l=c.length,u=t._emptyTiles,d=u.length,h=t.tileVisible,_,y,p=t._skipLevelOfDetail&&t._hasMixedContent&&n.context.stencilBuffer&&l>0;t._backfaceCommands.length=0,p&&(f(t._stencilClearCommand)||(t._stencilClearCommand=new Qn({stencil:0,pass:Te.CESIUM_3D_TILE,renderState:Ve.fromCache({stencilMask:Ot.SKIP_LOD_MASK})})),s.push(t._stencilClearCommand));let C=s.length;for(_=0;_<l;++_)y=c[_],o&&h.raiseEvent(y),y.update(t,n,i),r.incrementSelectionCounts(y.content),++r.selected;for(_=0;_<d;++_)y=u[_],y.update(t,n,i);let x=s.length-C;if(t._backfaceCommands.trim(),p){let T=t._backfaceCommands.values,E=T.length;for(s.length+=E,_=x-1;_>=0;--_)s[C+E+_]=s[C+_];for(_=0;_<E;++_)s[C+_]=T[_]}x=s.length-a,r.numberOfCommands=x,o&&t.pointCloudShading.attenuation&&t.pointCloudShading.eyeDomeLighting&&x>0&&t._pointCloudEyeDomeLighting.update(n,a,t.pointCloudShading,t.boundingSphere),o&&(t.debugShowGeometricError||t.debugShowRenderingStatistics||t.debugShowMemoryUsage||t.debugShowUrl?(f(t._tileDebugLabels)||(t._tileDebugLabels=new jm),w8e(t,n)):t._tileDebugLabels=t._tileDebugLabels&&t._tileDebugLabels.destroy())}var xoe=[];function v8e(t,n){let i=n,o=xoe;for(o.push(n);o.length>0;){n=o.pop();let r=n.children,s=r.length;for(let a=0;a<s;++a)o.push(r[a]);n!==i&&(P8e(t,n),--t._statistics.numberOfTilesTotal)}i.children=[]}function Toe(t,n){t.tileUnload.raiseEvent(n),t._statistics.decrementLoadCounts(n.content),--t._statistics.numberOfTilesWithContentReady,n.unloadContent()}function P8e(t,n){t._cache.unloadTile(t,n,Toe),n.destroy()}Rs.prototype.trimLoadedTiles=function(){this._cache.trim()};function I8e(t,n){let i=t._statistics,o=t._statisticsLast,r=i.numberOfPendingRequests,s=i.numberOfTilesProcessing,a=o.numberOfPendingRequests,c=o.numberOfTilesProcessing;j_.clone(i,o);let l=r!==a||s!==c;l&&n.afterRender.push(function(){return t.loadProgress.raiseEvent(r,s),!0}),t._tilesLoaded=i.numberOfPendingRequests===0&&i.numberOfTilesProcessing===0&&i.numberOfAttemptedRequests===0,l&&t._tilesLoaded&&(n.afterRender.push(function(){return t.allTilesLoaded.raiseEvent(),!0}),t._initialTilesLoaded||(t._initialTilesLoaded=!0,n.afterRender.push(function(){return t.initialTilesLoaded.raiseEvent(),!0})))}function B8e(t){t._heatmap.resetMinimumMaximum(),t._minimumPriority.depth=Number.MAX_VALUE,t._maximumPriority.depth=-Number.MAX_VALUE,t._minimumPriority.foveatedFactor=Number.MAX_VALUE,t._maximumPriority.foveatedFactor=-Number.MAX_VALUE,t._minimumPriority.distance=Number.MAX_VALUE,t._maximumPriority.distance=-Number.MAX_VALUE,t._minimumPriority.reverseScreenSpaceError=Number.MAX_VALUE,t._maximumPriority.reverseScreenSpaceError=-Number.MAX_VALUE}function O8e(t,n){(n.frameNumber!==t._updatedModelMatrixFrame||!f(t._previousModelMatrix))&&(t._updatedModelMatrixFrame=n.frameNumber,t._modelMatrixChanged=!N.equals(t.modelMatrix,t._previousModelMatrix),t._modelMatrixChanged&&(t._previousModelMatrix=N.clone(t.modelMatrix,t._previousModelMatrix)))}function R8e(t,n,i,o){if(n.mode===ne.MORPHING||!t.ready)return!1;let r=t._statistics;r.clear();let s=o.isRender;++t._updatedVisibilityFrame,B8e(t),O8e(t,n),t._cullRequestsWhileMoving=t.cullRequestsWhileMoving&&!t._modelMatrixChanged;let a=o.traversal.selectTiles(t,n);if(o.requestTiles&&A8e(t),D8e(t,n,o),j_.clone(r,i),s){let c=t._credits;if(f(c)&&r.selected!==0){let l=c.length;for(let u=0;u<l;++u){let d=c[u];d.showOnScreen=t._showCreditsOnScreen,n.creditDisplay.addCredit(d)}}}return a}Rs.prototype.update=function(t){this.updateForPass(t,t.tilesetPassState)};Rs.prototype.updateForPass=function(t,n){let i=n.pass;if(i===er.PRELOAD&&(!this.preloadWhenHidden||this.show)||i===er.PRELOAD_FLIGHT&&(!this.preloadFlightDestinations||!this.show&&!this.preloadWhenHidden)||i===er.REQUEST_RENDER_MODE_DEFER_CHECK&&(!this._cullRequestsWhileMoving&&this.foveatedTimeDelay<=0||!this.show))return;let o=t.commandList,r=t.camera,s=t.cullingVolume;n.ready=!1;let a=er.getPassOptions(i),c=a.ignoreCommands,l=A(n.commandList,o),u=l.length;t.commandList=l,t.camera=A(n.camera,r),t.cullingVolume=A(n.cullingVolume,s);let d=this._statisticsPerPass[i];(this.show||c)&&(this._pass=i,n.ready=R8e(this,t,d,a)),c&&(l.length=u),t.commandList=o,t.camera=r,t.cullingVolume=s};Rs.prototype.hasExtension=function(t){return f(this._extensionsUsed)?this._extensionsUsed.indexOf(t)>-1:!1};Rs.prototype.isDestroyed=function(){return!1};Rs.prototype.destroy=function(){if(this._tileDebugLabels=this._tileDebugLabels&&this._tileDebugLabels.destroy(),this._clippingPlanes=this._clippingPlanes&&this._clippingPlanes.destroy(),f(this._schemaLoader)&&fo.unload(this._schemaLoader),f(this._root)){let t=xoe;for(t.push(this._root);t.length>0;){let n=t.pop();n.destroy();let i=n.children,o=i.length;for(let r=0;r<o;++r)t.push(i[r])}}return this._root=void 0,this._shouldDestroyImageBasedLighting&&!this._imageBasedLighting.isDestroyed()&&this._imageBasedLighting.destroy(),this._imageBasedLighting=void 0,ue(this)};Rs.supportedExtensions={"3DTILES_metadata":!0,"3DTILES_implicit_tiling":!0,"3DTILES_content_gltf":!0,"3DTILES_multiple_contents":!0,"3DTILES_bounding_volume_S2":!0,"3DTILES_batch_table_hierarchy":!0,"3DTILES_draco_point_compression":!0,MAXAR_content_geojson:!0};Rs.checkSupportedExtensions=function(t){for(let n=0;n<t.length;n++)if(!Rs.supportedExtensions[t[n]])throw new he(`Unsupported 3D Tiles Extension: ${t[n]}`)};var $c=Rs;var M8e=new N;function q_(t,n){n.collectionChanged.addEventListener(q_.prototype._onCollectionChanged,this),this._scene=t,this._primitives=t.primitives,this._entityCollection=n,this._tilesetHash={},this._entitiesToVisualize=new yt,this._onCollectionChanged(n,n.values,[],[])}q_.prototype.update=function(t){let n=this._entitiesToVisualize.values,i=this._tilesetHash,o=this._primitives;for(let r=0,s=n.length;r<s;r++){let a=n[r],c=a._tileset,l,u=i[a.id],d=a.isShowing&&a.isAvailable(t)&&q.getValueOrDefault(c._show,t,!0),h;if(d&&(h=a.computeModelMatrix(t,M8e),l=Ie.createIfNeeded(q.getValueOrUndefined(c._uri,t))),!d){f(u)&&(u.tilesetPrimitive.show=!1);continue}let _=f(u)?u.tilesetPrimitive:void 0;(!f(_)||l.url!==u.url)&&(f(_)&&(o.removeAndDestroy(_),delete i[a.id]),_=new $c({url:l}),_.id=a,o.add(_),u={tilesetPrimitive:_,url:l.url,loadFail:!1},i[a.id]=u,L8e(_,a,i)),_.show=!0,f(h)&&(_.modelMatrix=h),_.maximumScreenSpaceError=q.getValueOrDefault(c.maximumScreenSpaceError,t,_.maximumScreenSpaceError)}return!0};q_.prototype.isDestroyed=function(){return!1};q_.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(q_.prototype._onCollectionChanged,this);let t=this._entitiesToVisualize.values,n=this._tilesetHash,i=this._primitives;for(let o=t.length-1;o>-1;o--)u6(this,t[o],n,i);return ue(this)};q_.prototype.getBoundingSphere=function(t,n){let i=this._tilesetHash[t.id];if(!f(i)||i.loadFail)return rt.FAILED;let o=i.tilesetPrimitive;return!f(o)||!o.show?rt.FAILED:o.ready?(ae.clone(o.boundingSphere,n),rt.DONE):rt.PENDING};q_.prototype._onCollectionChanged=function(t,n,i,o){let r,s,a=this._entitiesToVisualize,c=this._tilesetHash,l=this._primitives;for(r=n.length-1;r>-1;r--)s=n[r],f(s._tileset)&&a.set(s.id,s);for(r=o.length-1;r>-1;r--)s=o[r],f(s._tileset)?a.set(s.id,s):(u6(this,s,c,l),a.remove(s.id));for(r=i.length-1;r>-1;r--)s=i[r],u6(this,s,c,l),a.remove(s.id)};function u6(t,n,i,o){let r=i[n.id];f(r)&&(o.removeAndDestroy(r.tilesetPrimitive),delete i[n.id])}function L8e(t,n,i){t.readyPromise.catch(function(o){console.error(o),i[n.id].loadFail=!0})}var kF=q_;var F8e=z.WHITE,N8e=z.BLACK,V8e=new W(2,2);function $x(t){t=A(t,A.EMPTY_OBJECT),this._definitionChanged=new Ae,this._evenColor=void 0,this._evenColorSubscription=void 0,this._oddColor=void 0,this._oddColorSubscription=void 0,this._repeat=void 0,this._repeatSubscription=void 0,this.evenColor=t.evenColor,this.oddColor=t.oddColor,this.repeat=t.repeat}Object.defineProperties($x.prototype,{isConstant:{get:function(){return q.isConstant(this._evenColor)&&q.isConstant(this._oddColor)&&q.isConstant(this._repeat)}},definitionChanged:{get:function(){return this._definitionChanged}},evenColor:ce("evenColor"),oddColor:ce("oddColor"),repeat:ce("repeat")});$x.prototype.getType=function(t){return"Checkerboard"};$x.prototype.getValue=function(t,n){return f(n)||(n={}),n.lightColor=q.getValueOrClonedDefault(this._evenColor,t,F8e,n.lightColor),n.darkColor=q.getValueOrClonedDefault(this._oddColor,t,N8e,n.darkColor),n.repeat=q.getValueOrDefault(this._repeat,t,V8e),n};$x.prototype.equals=function(t){return this===t||t instanceof $x&&q.equals(this._evenColor,t._evenColor)&&q.equals(this._oddColor,t._oddColor)&&q.equals(this._repeat,t._repeat)};var Dw=$x;var Eoe={id:void 0};function vw(t){if(t._firing){t._refire=!0;return}if(t._suspendCount===0){let n=t._addedEntities,i=t._removedEntities,o=t._changedEntities;if(o.length!==0||n.length!==0||i.length!==0){t._firing=!0;do{t._refire=!1;let r=n.values.slice(0),s=i.values.slice(0),a=o.values.slice(0);n.removeAll(),i.removeAll(),o.removeAll(),t._collectionChanged.raiseEvent(t,r,s,a)}while(t._refire);t._firing=!1}}}function Oa(t){this._owner=t,this._entities=new yt,this._addedEntities=new yt,this._removedEntities=new yt,this._changedEntities=new yt,this._suspendCount=0,this._collectionChanged=new Ae,this._id=Bn(),this._show=!0,this._firing=!1,this._refire=!1}Oa.prototype.suspendEvents=function(){this._suspendCount++};Oa.prototype.resumeEvents=function(){this._suspendCount--,vw(this)};Object.defineProperties(Oa.prototype,{collectionChanged:{get:function(){return this._collectionChanged}},id:{get:function(){return this._id}},values:{get:function(){return this._entities.values}},show:{get:function(){return this._show},set:function(t){if(t===this._show)return;this.suspendEvents();let n,i=[],o=this._entities.values,r=o.length;for(n=0;n<r;n++)i.push(o[n].isShowing);for(this._show=t,n=0;n<r;n++){let s=i[n],a=o[n];s!==a.isShowing&&a.definitionChanged.raiseEvent(a,"isShowing",a.isShowing,s)}this.resumeEvents()}},owner:{get:function(){return this._owner}}});Oa.prototype.computeAvailability=function(){let t=Ue.MAXIMUM_VALUE,n=Ue.MINIMUM_VALUE,i=this._entities.values;for(let o=0,r=i.length;o<r;o++){let a=i[o].availability;if(f(a)){let c=a.start,l=a.stop;te.lessThan(c,t)&&!c.equals(Ue.MINIMUM_VALUE)&&(t=c),te.greaterThan(l,n)&&!l.equals(Ue.MAXIMUM_VALUE)&&(n=l)}}return Ue.MAXIMUM_VALUE.equals(t)&&(t=Ue.MINIMUM_VALUE),Ue.MINIMUM_VALUE.equals(n)&&(n=Ue.MAXIMUM_VALUE),new xn({start:t,stop:n})};Oa.prototype.add=function(t){t instanceof Qo||(t=new Qo(t));let n=t.id,i=this._entities;if(i.contains(n))throw new he(`An entity with id ${n} already exists in this collection.`);return t.entityCollection=this,i.set(n,t),this._removedEntities.remove(n)||this._addedEntities.set(n,t),t.definitionChanged.addEventListener(Oa.prototype._onEntityDefinitionChanged,this),vw(this),t};Oa.prototype.remove=function(t){return f(t)?this.removeById(t.id):!1};Oa.prototype.contains=function(t){return this._entities.get(t.id)===t};Oa.prototype.removeById=function(t){if(!f(t))return!1;let i=this._entities.get(t);return this._entities.remove(t)?(this._addedEntities.remove(t)||(this._removedEntities.set(t,i),this._changedEntities.remove(t)),this._entities.remove(t),i.definitionChanged.removeEventListener(Oa.prototype._onEntityDefinitionChanged,this),vw(this),!0):!1};Oa.prototype.removeAll=function(){let t=this._entities,n=t.length,i=t.values,o=this._addedEntities,r=this._removedEntities;for(let s=0;s<n;s++){let a=i[s],c=a.id,l=o.get(c);f(l)||(a.definitionChanged.removeEventListener(Oa.prototype._onEntityDefinitionChanged,this),r.set(c,a))}t.removeAll(),o.removeAll(),this._changedEntities.removeAll(),vw(this)};Oa.prototype.getById=function(t){return this._entities.get(t)};Oa.prototype.getOrCreateEntity=function(t){let n=this._entities.get(t);return f(n)||(Eoe.id=t,n=new Qo(Eoe),this.add(n)),n};Oa.prototype._onEntityDefinitionChanged=function(t){let n=t.id;this._addedEntities.contains(n)||this._changedEntities.set(n,t),vw(this)};var Ms=Oa;var UF={id:void 0},eT=new Array(2);function f6(t){let n=t.propertyNames,i=n.length;for(let o=0;o<i;o++)t[n[o]]=void 0;t._name=void 0,t._availability=void 0}function boe(t,n,i,o){eT[0]=i,eT[1]=o.id,n[JSON.stringify(eT)]=o.definitionChanged.addEventListener(Tr.prototype._onDefinitionChanged,t)}function Soe(t,n,i,o){eT[0]=i,eT[1]=o.id;let r=JSON.stringify(eT);n[r](),n[r]=void 0}function Y_(t){if(t._shouldRecomposite=!0,t._suspendCount!==0)return;let n=t._collections,i=n.length,o=t._collectionsCopy,r=o.length,s,a,c,l,u,d=t._composite,h=new Ms(t),_=t._eventHash,y;for(s=0;s<r;s++)for(u=o[s],u.collectionChanged.removeEventListener(Tr.prototype._onCollectionChanged,t),c=u.values,y=u.id,l=c.length-1;l>-1;l--)a=c[l],Soe(t,_,y,a);for(s=i-1;s>=0;s--)for(u=n[s],u.collectionChanged.addEventListener(Tr.prototype._onCollectionChanged,t),c=u.values,y=u.id,l=c.length-1;l>-1;l--){a=c[l],boe(t,_,y,a);let C=h.getById(a.id);f(C)||(C=d.getById(a.id),f(C)?f6(C):(UF.id=a.id,C=new Qo(UF)),h.add(C)),C.merge(a)}t._collectionsCopy=n.slice(0),d.suspendEvents(),d.removeAll();let p=h.values;for(s=0;s<p.length;s++)d.add(p[s]);d.resumeEvents()}function Tr(t,n){this._owner=n,this._composite=new Ms(this),this._suspendCount=0,this._collections=f(t)?t.slice():[],this._collectionsCopy=[],this._id=Bn(),this._eventHash={},Y_(this),this._shouldRecomposite=!1}Object.defineProperties(Tr.prototype,{collectionChanged:{get:function(){return this._composite._collectionChanged}},id:{get:function(){return this._id}},values:{get:function(){return this._composite.values}},owner:{get:function(){return this._owner}}});Tr.prototype.addCollection=function(t,n){f(n)?this._collections.splice(n,0,t):(n=this._collections.length,this._collections.push(t)),Y_(this)};Tr.prototype.removeCollection=function(t){let n=this._collections.indexOf(t);return n!==-1?(this._collections.splice(n,1),Y_(this),!0):!1};Tr.prototype.removeAllCollections=function(){this._collections.length=0,Y_(this)};Tr.prototype.containsCollection=function(t){return this._collections.indexOf(t)!==-1};Tr.prototype.contains=function(t){return this._composite.contains(t)};Tr.prototype.indexOfCollection=function(t){return this._collections.indexOf(t)};Tr.prototype.getCollection=function(t){return this._collections[t]};Tr.prototype.getCollectionsLength=function(){return this._collections.length};function zF(t,n){return t.indexOf(n)}function woe(t,n,i){let o=t._collections;if(n=B.clamp(n,0,o.length-1),i=B.clamp(i,0,o.length-1),n===i)return;let r=o[n];o[n]=o[i],o[i]=r,Y_(t)}Tr.prototype.raiseCollection=function(t){let n=zF(this._collections,t);woe(this,n,n+1)};Tr.prototype.lowerCollection=function(t){let n=zF(this._collections,t);woe(this,n,n-1)};Tr.prototype.raiseCollectionToTop=function(t){let n=zF(this._collections,t);n!==this._collections.length-1&&(this._collections.splice(n,1),this._collections.push(t),Y_(this))};Tr.prototype.lowerCollectionToBottom=function(t){let n=zF(this._collections,t);n!==0&&(this._collections.splice(n,1),this._collections.splice(0,0,t),Y_(this))};Tr.prototype.suspendEvents=function(){this._suspendCount++,this._composite.suspendEvents()};Tr.prototype.resumeEvents=function(){this._suspendCount--,this._shouldRecomposite&&this._suspendCount===0&&(Y_(this),this._shouldRecomposite=!1),this._composite.resumeEvents()};Tr.prototype.computeAvailability=function(){return this._composite.computeAvailability()};Tr.prototype.getById=function(t){return this._composite.getById(t)};Tr.prototype._onCollectionChanged=function(t,n,i){let o=this._collectionsCopy,r=o.length,s=this._composite;s.suspendEvents();let a,c,l,u,d=i.length,h=this._eventHash,_=t.id;for(a=0;a<d;a++){let p=i[a];Soe(this,h,_,p);let C=p.id;for(c=r-1;c>=0;c--)l=o[c].getById(C),f(l)&&(f(u)||(u=s.getById(C),f6(u)),u.merge(l));f(u)||s.removeById(C),u=void 0}let y=n.length;for(a=0;a<y;a++){let p=n[a];boe(this,h,_,p);let C=p.id;for(c=r-1;c>=0;c--)l=o[c].getById(C),f(l)&&(f(u)||(u=s.getById(C),f(u)?f6(u):(UF.id=C,u=new Qo(UF),s.add(u))),u.merge(l));u=void 0}s.resumeEvents()};Tr.prototype._onDefinitionChanged=function(t,n,i,o){let r=this._collections,s=this._composite,a=r.length,c=t.id,l=s.getById(c),u=l[n],d=!f(u),h=!0;for(let _=a-1;_>=0;_--){let y=r[_].getById(t.id);if(f(y)){let p=y[n];if(f(p)){if(h)if(h=!1,f(p.merge)&&f(p.clone))u=p.clone(u);else{u=p;break}u.merge(p)}}}d&&l.propertyNames.indexOf(n)===-1&&l.addProperty(n),l[n]=u};var Doe=Tr;function d6(){this._removalFunctions=[]}d6.prototype.add=function(t,n,i){let o=t.addEventListener(n,i);this._removalFunctions.push(o);let r=this;return function(){o();let s=r._removalFunctions;s.splice(s.indexOf(o),1)}};d6.prototype.removeAll=function(){let t=this._removalFunctions;for(let n=0,i=t.length;n<i;++n)t[n]();t.length=0};var Mr=d6;function p6(t,n){return te.compare(t.start,n.start)}function Er(t){if(this._intervals=[],this._changedEvent=new Ae,f(t)){let n=t.length;for(let i=0;i<n;i++)this.addInterval(t[i])}}Object.defineProperties(Er.prototype,{changedEvent:{get:function(){return this._changedEvent}},start:{get:function(){let t=this._intervals;return t.length===0?void 0:t[0].start}},isStartIncluded:{get:function(){let t=this._intervals;return t.length===0?!1:t[0].isStartIncluded}},stop:{get:function(){let t=this._intervals,n=t.length;return n===0?void 0:t[n-1].stop}},isStopIncluded:{get:function(){let t=this._intervals,n=t.length;return n===0?!1:t[n-1].isStopIncluded}},length:{get:function(){return this._intervals.length}},isEmpty:{get:function(){return this._intervals.length===0}}});Er.prototype.equals=function(t,n){if(this===t)return!0;if(!(t instanceof Er))return!1;let i=this._intervals,o=t._intervals,r=i.length;if(r!==o.length)return!1;for(let s=0;s<r;s++)if(!xn.equals(i[s],o[s],n))return!1;return!0};Er.prototype.get=function(t){return this._intervals[t]};Er.prototype.removeAll=function(){this._intervals.length>0&&(this._intervals.length=0,this._changedEvent.raiseEvent(this))};Er.prototype.findIntervalContainingDate=function(t){let n=this.indexOf(t);return n>=0?this._intervals[n]:void 0};Er.prototype.findDataForIntervalContainingDate=function(t){let n=this.indexOf(t);return n>=0?this._intervals[n].data:void 0};Er.prototype.contains=function(t){return this.indexOf(t)>=0};var h6=new xn;Er.prototype.indexOf=function(t){let n=this._intervals;h6.start=t,h6.stop=t;let i=jo(n,h6,p6);return i>=0?n[i].isStartIncluded?i:i>0&&n[i-1].stop.equals(t)&&n[i-1].isStopIncluded?i-1:~i:(i=~i,i>0&&i-1<n.length&&xn.contains(n[i-1],t)?i-1:~i)};Er.prototype.findInterval=function(t){t=A(t,A.EMPTY_OBJECT);let n=t.start,i=t.stop,o=t.isStartIncluded,r=t.isStopIncluded,s=this._intervals;for(let a=0,c=s.length;a<c;a++){let l=s[a];if((!f(n)||l.start.equals(n))&&(!f(i)||l.stop.equals(i))&&(!f(o)||l.isStartIncluded===o)&&(!f(r)||l.isStopIncluded===r))return s[a]}};Er.prototype.addInterval=function(t,n){if(t.isEmpty)return;let i=this._intervals;if(i.length===0||te.greaterThan(t.start,i[i.length-1].stop)){i.push(t),this._changedEvent.raiseEvent(this);return}let o=jo(i,t,p6);o<0?o=~o:o>0&&t.isStartIncluded&&i[o-1].isStartIncluded&&i[o-1].start.equals(t.start)?--o:o<i.length&&!t.isStartIncluded&&i[o].isStartIncluded&&i[o].start.equals(t.start)&&++o;let r;for(o>0&&(r=te.compare(i[o-1].stop,t.start),(r>0||r===0&&(i[o-1].isStopIncluded||t.isStartIncluded))&&((f(n)?n(i[o-1].data,t.data):i[o-1].data===t.data)?(te.greaterThan(t.stop,i[o-1].stop)?t=new xn({start:i[o-1].start,stop:t.stop,isStartIncluded:i[o-1].isStartIncluded,isStopIncluded:t.isStopIncluded,data:t.data}):t=new xn({start:i[o-1].start,stop:i[o-1].stop,isStartIncluded:i[o-1].isStartIncluded,isStopIncluded:i[o-1].isStopIncluded||t.stop.equals(i[o-1].stop)&&t.isStopIncluded,data:t.data}),i.splice(o-1,1),--o):(r=te.compare(i[o-1].stop,t.stop),(r>0||r===0&&i[o-1].isStopIncluded&&!t.isStopIncluded)&&i.splice(o,0,new xn({start:t.stop,stop:i[o-1].stop,isStartIncluded:!t.isStopIncluded,isStopIncluded:i[o-1].isStopIncluded,data:i[o-1].data})),i[o-1]=new xn({start:i[o-1].start,stop:t.start,isStartIncluded:i[o-1].isStartIncluded,isStopIncluded:!t.isStartIncluded,data:i[o-1].data}))));o<i.length&&(r=te.compare(t.stop,i[o].start),r>0||r===0&&(t.isStopIncluded||i[o].isStartIncluded));)if(f(n)?n(i[o].data,t.data):i[o].data===t.data)t=new xn({start:t.start,stop:te.greaterThan(i[o].stop,t.stop)?i[o].stop:t.stop,isStartIncluded:t.isStartIncluded,isStopIncluded:te.greaterThan(i[o].stop,t.stop)?i[o].isStopIncluded:t.isStopIncluded,data:t.data}),i.splice(o,1);else if(i[o]=new xn({start:t.stop,stop:i[o].stop,isStartIncluded:!t.isStopIncluded,isStopIncluded:i[o].isStopIncluded,data:i[o].data}),i[o].isEmpty)i.splice(o,1);else break;i.splice(o,0,t),this._changedEvent.raiseEvent(this)};Er.prototype.removeInterval=function(t){if(t.isEmpty)return!1;let n=this._intervals,i=jo(n,t,p6);i<0&&(i=~i);let o=!1;for(i>0&&(te.greaterThan(n[i-1].stop,t.start)||n[i-1].stop.equals(t.start)&&n[i-1].isStopIncluded&&t.isStartIncluded)&&(o=!0,(te.greaterThan(n[i-1].stop,t.stop)||n[i-1].isStopIncluded&&!t.isStopIncluded&&n[i-1].stop.equals(t.stop))&&n.splice(i,0,new xn({start:t.stop,stop:n[i-1].stop,isStartIncluded:!t.isStopIncluded,isStopIncluded:n[i-1].isStopIncluded,data:n[i-1].data})),n[i-1]=new xn({start:n[i-1].start,stop:t.start,isStartIncluded:n[i-1].isStartIncluded,isStopIncluded:!t.isStartIncluded,data:n[i-1].data})),i<n.length&&!t.isStartIncluded&&n[i].isStartIncluded&&t.start.equals(n[i].start)&&(o=!0,n.splice(i,0,new xn({start:n[i].start,stop:n[i].start,isStartIncluded:!0,isStopIncluded:!0,data:n[i].data})),++i);i<n.length&&te.greaterThan(t.stop,n[i].stop);)o=!0,n.splice(i,1);return i<n.length&&t.stop.equals(n[i].stop)&&(o=!0,!t.isStopIncluded&&n[i].isStopIncluded?i+1<n.length&&n[i+1].start.equals(t.stop)&&n[i].data===n[i+1].data?(n.splice(i,1),n[i]=new xn({start:n[i].start,stop:n[i].stop,isStartIncluded:!0,isStopIncluded:n[i].isStopIncluded,data:n[i].data})):n[i]=new xn({start:t.stop,stop:t.stop,isStartIncluded:!0,isStopIncluded:!0,data:n[i].data}):n.splice(i,1)),i<n.length&&(te.greaterThan(t.stop,n[i].start)||t.stop.equals(n[i].start)&&t.isStopIncluded&&n[i].isStartIncluded)&&(o=!0,n[i]=new xn({start:t.stop,stop:n[i].stop,isStartIncluded:!t.isStopIncluded,isStopIncluded:n[i].isStopIncluded,data:n[i].data})),o&&this._changedEvent.raiseEvent(this),o};Er.prototype.intersect=function(t,n,i){let o=new Er,r=0,s=0,a=this._intervals,c=t._intervals;for(;r<a.length&&s<c.length;){let l=a[r],u=c[s];if(te.lessThan(l.stop,u.start))++r;else if(te.lessThan(u.stop,l.start))++s;else{if(f(i)||f(n)&&n(l.data,u.data)||!f(n)&&u.data===l.data){let d=xn.intersect(l,u,new xn,i);d.isEmpty||o.addInterval(d,n)}te.lessThan(l.stop,u.stop)||l.stop.equals(u.stop)&&!l.isStopIncluded&&u.isStopIncluded?++r:++s}}return o};Er.fromJulianDateArray=function(t,n){f(n)||(n=new Er);let i=t.julianDates,o=i.length,r=t.dataCallback,s=A(t.isStartIncluded,!0),a=A(t.isStopIncluded,!0),c=A(t.leadingInterval,!1),l=A(t.trailingInterval,!1),u,d=0;c&&(++d,u=new xn({start:Ue.MINIMUM_VALUE,stop:i[0],isStartIncluded:!0,isStopIncluded:!s}),u.data=f(r)?r(u,n.length):n.length,n.addInterval(u));for(let h=0;h<o-1;++h){let _=i[h],y=i[h+1];u=new xn({start:_,stop:y,isStartIncluded:n.length===d?s:!0,isStopIncluded:h===o-2?a:!1}),u.data=f(r)?r(u,n.length):n.length,n.addInterval(u),_=y}return l&&(u=new xn({start:i[o-1],stop:Ue.MAXIMUM_VALUE,isStartIncluded:!a,isStopIncluded:!0}),u.data=f(r)?r(u,n.length):n.length,n.addInterval(u)),n};var Ra=new Op,Pw=[0,31,28,31,30,31,30,31,31,30,31,30,31];function m6(t,n,i){f(i)||(i=new te),te.toGregorianDate(t,Ra);let o=Ra.millisecond+n.millisecond,r=Ra.second+n.second,s=Ra.minute+n.minute,a=Ra.hour+n.hour,c=Ra.day+n.day,l=Ra.month+n.month,u=Ra.year+n.year;for(o>=1e3&&(r+=Math.floor(o/1e3),o=o%1e3),r>=60&&(s+=Math.floor(r/60),r=r%60),s>=60&&(a+=Math.floor(s/60),s=s%60),a>=24&&(c+=Math.floor(a/24),a=a%24),Pw[2]=Rp(u)?29:28;c>Pw[l]||l>=13;)c>Pw[l]&&(c-=Pw[l],++l),l>=13&&(--l,u+=Math.floor(l/12),l=l%12,++l),Pw[2]=Rp(u)?29:28;return Ra.millisecond=o,Ra.second=r,Ra.minute=s,Ra.hour=a,Ra.day=c,Ra.month=l,Ra.year=u,te.fromGregorianDate(Ra,i)}var k8e=new te,U8e=/P(?:([\d.,]+)Y)?(?:([\d.,]+)M)?(?:([\d.,]+)W)?(?:([\d.,]+)D)?(?:T(?:([\d.,]+)H)?(?:([\d.,]+)M)?(?:([\d.,]+)S)?)?/;function voe(t,n){if(!f(t)||t.length===0)return!1;if(n.year=0,n.month=0,n.day=0,n.hour=0,n.minute=0,n.second=0,n.millisecond=0,t[0]==="P"){let i=t.match(U8e);if(!f(i))return!1;if(f(i[1])&&(n.year=Number(i[1].replace(",","."))),f(i[2])&&(n.month=Number(i[2].replace(",","."))),f(i[3])&&(n.day=Number(i[3].replace(",","."))*7),f(i[4])&&(n.day+=Number(i[4].replace(",","."))),f(i[5])&&(n.hour=Number(i[5].replace(",","."))),f(i[6])&&(n.minute=Number(i[6].replace(",","."))),f(i[7])){let o=Number(i[7].replace(",","."));n.second=Math.floor(o),n.millisecond=o%1*1e3}}else t[t.length-1]!=="Z"&&(t+="Z"),te.toGregorianDate(te.fromIso8601(t,k8e),n);return n.year||n.month||n.day||n.hour||n.minute||n.second||n.millisecond}var Iw=new Op;Er.fromIso8601=function(t,n){let i=t.iso8601.split("/"),o=te.fromIso8601(i[0]),r=te.fromIso8601(i[1]),s=[];if(!voe(i[2],Iw))s.push(o,r);else{let a=te.clone(o);for(s.push(a);te.compare(a,r)<0;)a=m6(a,Iw),te.compare(r,a)<=0&&te.clone(r,a),s.push(a)}return Er.fromJulianDateArray({julianDates:s,isStartIncluded:t.isStartIncluded,isStopIncluded:t.isStopIncluded,leadingInterval:t.leadingInterval,trailingInterval:t.trailingInterval,dataCallback:t.dataCallback},n)};Er.fromIso8601DateArray=function(t,n){return Er.fromJulianDateArray({julianDates:t.iso8601Dates.map(function(i){return te.fromIso8601(i)}),isStartIncluded:t.isStartIncluded,isStopIncluded:t.isStopIncluded,leadingInterval:t.leadingInterval,trailingInterval:t.trailingInterval,dataCallback:t.dataCallback},n)};Er.fromIso8601DurationArray=function(t,n){let i=t.epoch,o=t.iso8601Durations,r=A(t.relativeToPrevious,!1),s=[],a,c,l=o.length;for(let u=0;u<l;++u)(voe(o[u],Iw)||u===0)&&(r&&f(c)?a=m6(c,Iw):a=m6(i,Iw),s.push(a),c=a);return Er.fromJulianDateArray({julianDates:s,isStartIncluded:t.isStartIncluded,isStopIncluded:t.isStopIncluded,leadingInterval:t.leadingInterval,trailingInterval:t.trailingInterval,dataCallback:t.dataCallback},n)};var Lr=Er;function z8e(t,n,i,o){function r(){i.raiseEvent(t)}let s=[];n.removeAll();let a=o.length;for(let c=0;c<a;c++){let l=o.get(c);f(l.data)&&s.indexOf(l.data)===-1&&n.add(l.data.definitionChanged,r)}}function Dy(){this._eventHelper=new Mr,this._definitionChanged=new Ae,this._intervals=new Lr,this._intervals.changedEvent.addEventListener(Dy.prototype._intervalsChanged,this)}Object.defineProperties(Dy.prototype,{isConstant:{get:function(){return this._intervals.isEmpty}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._intervals}}});Dy.prototype.getValue=function(t,n){let i=this._intervals.findDataForIntervalContainingDate(t);if(f(i))return i.getValue(t,n)};Dy.prototype.equals=function(t){return this===t||t instanceof Dy&&this._intervals.equals(t._intervals,q.equals)};Dy.prototype._intervalsChanged=function(){z8e(this,this._eventHelper,this._definitionChanged,this._intervals),this._definitionChanged.raiseEvent(this)};var pc=Dy;function X_(){this._definitionChanged=new Ae,this._composite=new pc,this._composite.definitionChanged.addEventListener(X_.prototype._raiseDefinitionChanged,this)}Object.defineProperties(X_.prototype,{isConstant:{get:function(){return this._composite.isConstant}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._composite._intervals}}});X_.prototype.getType=function(t){let n=this._composite._intervals.findDataForIntervalContainingDate(t);if(f(n))return n.getType(t)};X_.prototype.getValue=function(t,n){let i=this._composite._intervals.findDataForIntervalContainingDate(t);if(f(i))return i.getValue(t,n)};X_.prototype.equals=function(t){return this===t||t instanceof X_&&this._composite.equals(t._composite,q.equals)};X_.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)};var Bw=X_;function K_(t){this._referenceFrame=A(t,no.FIXED),this._definitionChanged=new Ae,this._composite=new pc,this._composite.definitionChanged.addEventListener(K_.prototype._raiseDefinitionChanged,this)}Object.defineProperties(K_.prototype,{isConstant:{get:function(){return this._composite.isConstant}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._composite.intervals}},referenceFrame:{get:function(){return this._referenceFrame},set:function(t){this._referenceFrame=t}}});K_.prototype.getValue=function(t,n){return this.getValueInReferenceFrame(t,no.FIXED,n)};K_.prototype.getValueInReferenceFrame=function(t,n,i){let o=this._composite._intervals.findDataForIntervalContainingDate(t);if(f(o))return o.getValueInReferenceFrame(t,n,i)};K_.prototype.equals=function(t){return this===t||t instanceof K_&&this._referenceFrame===t._referenceFrame&&this._composite.equals(t._composite,q.equals)};K_.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)};var ia=K_;var H8e={ROUNDED:0,MITERED:1,BEVELED:2},wi=Object.freeze(H8e);var Ls=[new m,new m],G8e=new m,W8e=new m,j8e=new m,q8e=new m,Y8e=new m,X8e=new m,K8e=new m,J8e=new m,Z8e=new m,tT=new m,HF=new m,Ow={},_6=new de;function Q8e(t,n){let i=new Array(t.length);for(let o=0;o<t.length;o++){let r=t[o];_6=n.cartesianToCartographic(r,_6),i[o]=_6.height,t[o]=n.scaleToGeodeticSurface(r,r)}return i}function g6(t,n,i,o){let r=t[0],s=t[1],a=m.angleBetween(r,s),c=Math.ceil(a/o),l=new Array(c),u;if(n===i){for(u=0;u<c;u++)l[u]=n;return l.push(i),l}let h=(i-n)/c;for(u=1;u<c;u++){let _=n+u*h;l[u]=_}return l[0]=n,l.push(i),l}var GF=new m,WF=new m;function $8e(t,n,i,o){let r=new Ca(i,o),s=r.projectPointOntoPlane(m.add(i,t,GF),GF),a=r.projectPointOntoPlane(m.add(i,n,WF),WF),c=W.angleBetween(s,a);return a.x*s.y-a.y*s.x>=0?-c:c}var eGe=new m(-1,0,0),vy=new N,tGe=new N,y6=new $,nGe=$.IDENTITY.clone(),iGe=new m,oGe=new se,Poe=new m;function op(t,n,i,o,r,s,a,c){let l=iGe,u=oGe;vy=vt.eastNorthUpToFixedFrame(t,r,vy),l=N.multiplyByPointAsVector(vy,eGe,l),l=m.normalize(l,l);let d=$8e(l,n,t,r);y6=$.fromRotationZ(d,y6),Poe.z=s,vy=N.multiplyTransformation(vy,N.fromRotationTranslation(y6,Poe,tGe),vy);let h=nGe;h[0]=a;for(let _=0;_<c;_++)for(let y=0;y<i.length;y+=3)u=m.fromArray(i,y,u),u=$.multiplyByVector(h,u,u),u=N.multiplyByPoint(vy,u,u),o.push(u.x,u.y,u.z);return o}var rGe=new m;function A6(t,n,i,o,r,s,a){for(let c=0;c<t.length;c+=3){let l=m.fromArray(t,c,rGe);o=op(l,n,i,o,r,s[c/3],a,1)}return o}function sGe(t,n){let i=t.length,o=new Array(i*6),r=0,s=n.x+n.width/2,a=n.y+n.height/2,c=t[0];o[r++]=c.x-s,o[r++]=0,o[r++]=c.y-a;for(let l=1;l<i;l++){c=t[l];let u=c.x-s,d=c.y-a;o[r++]=u,o[r++]=0,o[r++]=d,o[r++]=u,o[r++]=0,o[r++]=d}return c=t[0],o[r++]=c.x-s,o[r++]=0,o[r++]=c.y-a,o}function Ioe(t,n){let i=t.length,o=new Array(i*3),r=0,s=n.x+n.width/2,a=n.y+n.height/2;for(let c=0;c<i;c++)o[r++]=t[c].x-s,o[r++]=0,o[r++]=t[c].y-a;return o}var Boe=new Me,Ooe=new m,Roe=new $;function Moe(t,n,i,o,r,s,a,c,l,u){let d=m.angleBetween(m.subtract(n,t,tT),m.subtract(i,t,HF)),h=o===wi.BEVELED?0:Math.ceil(d/B.toRadians(5)),_;r?_=$.fromQuaternion(Me.fromAxisAngle(m.negate(t,tT),d/(h+1),Boe),Roe):_=$.fromQuaternion(Me.fromAxisAngle(t,d/(h+1),Boe),Roe);let y,p;if(n=m.clone(n,Ooe),h>0){let C=u?2:1;for(let x=0;x<h;x++)n=$.multiplyByVector(_,n,n),y=m.subtract(n,t,tT),y=m.normalize(y,y),r||(y=m.negate(y,y)),p=s.scaleToGeodeticSurface(n,HF),a=op(p,y,c,a,s,l,1,C)}else y=m.subtract(n,t,tT),y=m.normalize(y,y),r||(y=m.negate(y,y)),p=s.scaleToGeodeticSurface(n,HF),a=op(p,y,c,a,s,l,1,1),i=m.clone(i,Ooe),y=m.subtract(i,t,tT),y=m.normalize(y,y),r||(y=m.negate(y,y)),p=s.scaleToGeodeticSurface(i,HF),a=op(p,y,c,a,s,l,1,1);return a}Ow.removeDuplicatesFromShape=function(t){let n=t.length,i=[];for(let o=n-1,r=0;r<n;o=r++){let s=t[o],a=t[r];W.equals(s,a)||i.push(a)}return i};Ow.angleIsGreaterThanPi=function(t,n,i,o){let r=new Ca(i,o),s=r.projectPointOntoPlane(m.add(i,t,GF),GF),a=r.projectPointOntoPlane(m.add(i,n,WF),WF);return a.x*s.y-a.y*s.x>=0};var aGe=new m,cGe=new m;Ow.computePositions=function(t,n,i,o,r){let s=o._ellipsoid,a=Q8e(t,s),c=o._granularity,l=o._cornerType,u=r?sGe(n,i):Ioe(n,i),d=r?Ioe(n,i):void 0,h=i.height/2,_=i.width/2,y=t.length,p=[],C=r?[]:void 0,x=G8e,T=W8e,E=j8e,S=q8e,w=Y8e,D=X8e,I=K8e,O=J8e,M=Z8e,L=t[0],F=t[1];S=s.geodeticSurfaceNormal(L,S),x=m.subtract(F,L,x),x=m.normalize(x,x),O=m.cross(S,x,O),O=m.normalize(O,O);let g=a[0],b=a[1];r&&(C=op(L,O,d,C,s,g+h,1,1)),M=m.clone(L,M),L=F,T=m.negate(x,T);let v,P;for(let H=1;H<y-1;H++){let U=r?2:1;if(F=t[H+1],L.equals(F)){Bt("Positions are too close and are considered equivalent with rounding error.");continue}x=m.subtract(F,L,x),x=m.normalize(x,x),E=m.add(x,T,E),E=m.normalize(E,E),S=s.geodeticSurfaceNormal(L,S);let G=m.multiplyByScalar(S,m.dot(x,S),aGe);m.subtract(x,G,G),m.normalize(G,G);let k=m.multiplyByScalar(S,m.dot(T,S),cGe);if(m.subtract(T,k,k),m.normalize(k,k),!B.equalsEpsilon(Math.abs(m.dot(G,k)),1,B.EPSILON7)){E=m.cross(E,S,E),E=m.cross(S,E,E),E=m.normalize(E,E);let Y=1/Math.max(.25,m.magnitude(m.cross(E,T,tT))),K=Ow.angleIsGreaterThanPi(x,T,L,s);K?(w=m.add(L,m.multiplyByScalar(E,Y*_,E),w),D=m.add(w,m.multiplyByScalar(O,_,D),D),Ls[0]=m.clone(M,Ls[0]),Ls[1]=m.clone(D,Ls[1]),v=g6(Ls,g+h,b+h,c),P=Si.generateArc({positions:Ls,granularity:c,ellipsoid:s}),p=A6(P,O,u,p,s,v,1),O=m.cross(S,x,O),O=m.normalize(O,O),I=m.add(w,m.multiplyByScalar(O,_,I),I),l===wi.ROUNDED||l===wi.BEVELED?Moe(w,D,I,l,K,s,p,u,b+h,r):(E=m.negate(E,E),p=op(L,E,u,p,s,b+h,Y,U)),M=m.clone(I,M)):(w=m.add(L,m.multiplyByScalar(E,Y*_,E),w),D=m.add(w,m.multiplyByScalar(O,-_,D),D),Ls[0]=m.clone(M,Ls[0]),Ls[1]=m.clone(D,Ls[1]),v=g6(Ls,g+h,b+h,c),P=Si.generateArc({positions:Ls,granularity:c,ellipsoid:s}),p=A6(P,O,u,p,s,v,1),O=m.cross(S,x,O),O=m.normalize(O,O),I=m.add(w,m.multiplyByScalar(O,-_,I),I),l===wi.ROUNDED||l===wi.BEVELED?Moe(w,D,I,l,K,s,p,u,b+h,r):p=op(L,E,u,p,s,b+h,Y,U),M=m.clone(I,M)),T=m.negate(x,T)}else p=op(M,O,u,p,s,g+h,1,1),M=L;g=b,b=a[H+1],L=F}Ls[0]=m.clone(M,Ls[0]),Ls[1]=m.clone(L,Ls[1]),v=g6(Ls,g+h,b+h,c),P=Si.generateArc({positions:Ls,granularity:c,ellipsoid:s}),p=A6(P,O,u,p,s,v,1),r&&(C=op(L,O,d,C,s,b+h,1,1)),y=p.length;let R=r?y+C.length:y,V=new Float64Array(R);return V.set(p),r&&V.set(C,y),V};var mh=Ow;var x6={},nT=new m,koe=new m,lGe=new m,Loe=new m,_c=[new m,new m],Uoe=new m,zoe=new m,Hoe=new m,uGe=new m,fGe=new m,dGe=new m,hGe=new m,mGe=new m,pGe=new m,_Ge=new m,Foe=new Me,Noe=new $;function jF(t,n,i,o,r){let s=m.angleBetween(m.subtract(n,t,nT),m.subtract(i,t,koe)),a=o===wi.BEVELED?1:Math.ceil(s/B.toRadians(5))+1,c=a*3,l=new Array(c);l[c-3]=i.x,l[c-2]=i.y,l[c-1]=i.z;let u;r?u=$.fromQuaternion(Me.fromAxisAngle(m.negate(t,nT),s/a,Foe),Noe):u=$.fromQuaternion(Me.fromAxisAngle(t,s/a,Foe),Noe);let d=0;n=m.clone(n,nT);for(let h=0;h<a;h++)n=$.multiplyByVector(u,n,n),l[d++]=n.x,l[d++]=n.y,l[d++]=n.z;return l}function gGe(t){let n=Uoe,i=zoe,o=Hoe,r=t[1];i=m.fromArray(t[1],r.length-3,i),o=m.fromArray(t[0],0,o),n=m.midpoint(i,o,n);let s=jF(n,i,o,wi.ROUNDED,!1),a=t.length-1,c=t[a-1];r=t[a],i=m.fromArray(c,c.length-3,i),o=m.fromArray(r,0,o),n=m.midpoint(i,o,n);let l=jF(n,i,o,wi.ROUNDED,!1);return[s,l]}function Voe(t,n,i,o){let r=nT;return o?r=m.add(t,n,r):(n=m.negate(n,n),r=m.add(t,n,r)),[r.x,r.y,r.z,i.x,i.y,i.z]}function C6(t,n,i,o){let r=new Array(t.length),s=new Array(t.length),a=m.multiplyByScalar(n,i,nT),c=m.negate(a,koe),l=0,u=t.length-1;for(let d=0;d<t.length;d+=3){let h=m.fromArray(t,d,lGe),_=m.add(h,c,Loe);r[l++]=_.x,r[l++]=_.y,r[l++]=_.z;let y=m.add(h,a,Loe);s[u--]=y.z,s[u--]=y.y,s[u--]=y.x}return o.push(r,s),o}x6.addAttribute=function(t,n,i,o){let r=n.x,s=n.y,a=n.z;f(i)&&(t[i]=r,t[i+1]=s,t[i+2]=a),f(o)&&(t[o]=a,t[o-1]=s,t[o-2]=r)};var yGe=new m,AGe=new m;x6.computePositions=function(t){let n=t.granularity,i=t.positions,o=t.ellipsoid,r=t.width/2,s=t.cornerType,a=t.saveAttributes,c=Uoe,l=zoe,u=Hoe,d=uGe,h=fGe,_=dGe,y=hGe,p=mGe,C=pGe,x=_Ge,T=[],E=a?[]:void 0,S=a?[]:void 0,w=i[0],D=i[1];l=m.normalize(m.subtract(D,w,l),l),c=o.geodeticSurfaceNormal(w,c),d=m.normalize(m.cross(c,l,d),d),a&&(E.push(d.x,d.y,d.z),S.push(c.x,c.y,c.z)),y=m.clone(w,y),w=D,u=m.negate(l,u);let I,O=[],M,L=i.length;for(M=1;M<L-1;M++){c=o.geodeticSurfaceNormal(w,c),D=i[M+1],l=m.normalize(m.subtract(D,w,l),l),h=m.normalize(m.add(l,u,h),h);let g=m.multiplyByScalar(c,m.dot(l,c),yGe);m.subtract(l,g,g),m.normalize(g,g);let b=m.multiplyByScalar(c,m.dot(u,c),AGe);if(m.subtract(u,b,b),m.normalize(b,b),!B.equalsEpsilon(Math.abs(m.dot(g,b)),1,B.EPSILON7)){h=m.cross(h,c,h),h=m.cross(c,h,h),h=m.normalize(h,h);let P=r/Math.max(.25,m.magnitude(m.cross(h,u,nT))),R=mh.angleIsGreaterThanPi(l,u,w,o);h=m.multiplyByScalar(h,P,h),R?(p=m.add(w,h,p),x=m.add(p,m.multiplyByScalar(d,r,x),x),C=m.add(p,m.multiplyByScalar(d,r*2,C),C),_c[0]=m.clone(y,_c[0]),_c[1]=m.clone(x,_c[1]),I=Si.generateArc({positions:_c,granularity:n,ellipsoid:o}),T=C6(I,d,r,T),a&&(E.push(d.x,d.y,d.z),S.push(c.x,c.y,c.z)),_=m.clone(C,_),d=m.normalize(m.cross(c,l,d),d),C=m.add(p,m.multiplyByScalar(d,r*2,C),C),y=m.add(p,m.multiplyByScalar(d,r,y),y),s===wi.ROUNDED||s===wi.BEVELED?O.push({leftPositions:jF(p,_,C,s,R)}):O.push({leftPositions:Voe(w,m.negate(h,h),C,R)})):(C=m.add(w,h,C),x=m.add(C,m.negate(m.multiplyByScalar(d,r,x),x),x),p=m.add(C,m.negate(m.multiplyByScalar(d,r*2,p),p),p),_c[0]=m.clone(y,_c[0]),_c[1]=m.clone(x,_c[1]),I=Si.generateArc({positions:_c,granularity:n,ellipsoid:o}),T=C6(I,d,r,T),a&&(E.push(d.x,d.y,d.z),S.push(c.x,c.y,c.z)),_=m.clone(p,_),d=m.normalize(m.cross(c,l,d),d),p=m.add(C,m.negate(m.multiplyByScalar(d,r*2,p),p),p),y=m.add(C,m.negate(m.multiplyByScalar(d,r,y),y),y),s===wi.ROUNDED||s===wi.BEVELED?O.push({rightPositions:jF(C,_,p,s,R)}):O.push({rightPositions:Voe(w,h,p,R)})),u=m.negate(l,u)}w=D}c=o.geodeticSurfaceNormal(w,c),_c[0]=m.clone(y,_c[0]),_c[1]=m.clone(w,_c[1]),I=Si.generateArc({positions:_c,granularity:n,ellipsoid:o}),T=C6(I,d,r,T),a&&(E.push(d.x,d.y,d.z),S.push(c.x,c.y,c.z));let F;return s===wi.ROUNDED&&(F=gGe(T)),{positions:T,corners:O,lefts:E,normals:S,endPositions:F}};var Bi=x6;var joe=new m,qoe=new m,qF=new m,YF=new m,CGe=new m,Yoe=new m,J_=new m,iT=new m;function Xoe(t,n){for(let i=0;i<t.length;i++)t[i]=n.scaleToGeodeticSurface(t[i],t[i]);return t}function jf(t,n,i,o,r,s){let a=t.normals,c=t.tangents,l=t.bitangents,u=m.normalize(m.cross(i,n,J_),J_);s.normal&&Bi.addAttribute(a,n,o,r),s.tangent&&Bi.addAttribute(c,u,o,r),s.bitangent&&Bi.addAttribute(l,i,o,r)}function Koe(t,n,i){let o=t.positions,r=t.corners,s=t.endPositions,a=t.lefts,c=t.normals,l=new cn,u,d=0,h=0,_,y=0,p;for(_=0;_<o.length;_+=2)p=o[_].length-3,d+=p,y+=p*2,h+=o[_+1].length-3;for(d+=3,h+=3,_=0;_<r.length;_++){u=r[_];let Q=r[_].leftPositions;f(Q)?(p=Q.length,d+=p,y+=p):(p=r[_].rightPositions.length,h+=p,y+=p)}let C=f(s),x;C&&(x=s[0].length-3,d+=x,h+=x,x/=3,y+=x*6);let T=d+h,E=new Float64Array(T),S=n.normal?new Float32Array(T):void 0,w=n.tangent?new Float32Array(T):void 0,D=n.bitangent?new Float32Array(T):void 0,I={normals:S,tangents:w,bitangents:D},O=0,M=T-1,L,F,g,b,v=joe,P=qoe,R,V,H=x/2,U=Ne.createTypedArray(T/3,y),G=0;if(C){V=qF,R=YF;let Q=s[0];for(v=m.fromArray(c,0,v),P=m.fromArray(a,0,P),_=0;_<H;_++)V=m.fromArray(Q,(H-1-_)*3,V),R=m.fromArray(Q,(H+_)*3,R),Bi.addAttribute(E,R,O),Bi.addAttribute(E,V,void 0,M),jf(I,v,P,O,M,n),F=O/3,b=F+1,L=(M-2)/3,g=L-1,U[G++]=L,U[G++]=F,U[G++]=g,U[G++]=g,U[G++]=F,U[G++]=b,O+=3,M-=3}let k=0,X=0,Y=o[k++],K=o[k++];E.set(Y,O),E.set(K,M-K.length+1),P=m.fromArray(a,X,P);let j,Z;for(p=K.length-3,_=0;_<p;_+=3)j=i.geodeticSurfaceNormal(m.fromArray(Y,_,J_),J_),Z=i.geodeticSurfaceNormal(m.fromArray(K,p-_,iT),iT),v=m.normalize(m.add(j,Z,v),v),jf(I,v,P,O,M,n),F=O/3,b=F+1,L=(M-2)/3,g=L-1,U[G++]=L,U[G++]=F,U[G++]=g,U[G++]=g,U[G++]=F,U[G++]=b,O+=3,M-=3;for(j=i.geodeticSurfaceNormal(m.fromArray(Y,p,J_),J_),Z=i.geodeticSurfaceNormal(m.fromArray(K,p,iT),iT),v=m.normalize(m.add(j,Z,v),v),X+=3,_=0;_<r.length;_++){let Q;u=r[_];let me=u.leftPositions,_e=u.rightPositions,re,fe,ge=Yoe,be=qF,Be=YF;if(v=m.fromArray(c,X,v),f(me)){for(jf(I,v,P,void 0,M,n),M-=3,re=b,fe=g,Q=0;Q<me.length/3;Q++)ge=m.fromArray(me,Q*3,ge),U[G++]=re,U[G++]=fe-Q-1,U[G++]=fe-Q,Bi.addAttribute(E,ge,void 0,M),be=m.fromArray(E,(fe-Q-1)*3,be),Be=m.fromArray(E,re*3,Be),P=m.normalize(m.subtract(be,Be,P),P),jf(I,v,P,void 0,M,n),M-=3;ge=m.fromArray(E,re*3,ge),be=m.subtract(m.fromArray(E,fe*3,be),ge,be),Be=m.subtract(m.fromArray(E,(fe-Q)*3,Be),ge,Be),P=m.normalize(m.add(be,Be,P),P),jf(I,v,P,O,void 0,n),O+=3}else{for(jf(I,v,P,O,void 0,n),O+=3,re=g,fe=b,Q=0;Q<_e.length/3;Q++)ge=m.fromArray(_e,Q*3,ge),U[G++]=re,U[G++]=fe+Q,U[G++]=fe+Q+1,Bi.addAttribute(E,ge,O),be=m.fromArray(E,re*3,be),Be=m.fromArray(E,(fe+Q)*3,Be),P=m.normalize(m.subtract(be,Be,P),P),jf(I,v,P,O,void 0,n),O+=3;ge=m.fromArray(E,re*3,ge),be=m.subtract(m.fromArray(E,(fe+Q)*3,be),ge,be),Be=m.subtract(m.fromArray(E,fe*3,Be),ge,Be),P=m.normalize(m.negate(m.add(Be,be,P),P),P),jf(I,v,P,void 0,M,n),M-=3}for(Y=o[k++],K=o[k++],Y.splice(0,3),K.splice(K.length-3,3),E.set(Y,O),E.set(K,M-K.length+1),p=K.length-3,X+=3,P=m.fromArray(a,X,P),Q=0;Q<K.length;Q+=3)j=i.geodeticSurfaceNormal(m.fromArray(Y,Q,J_),J_),Z=i.geodeticSurfaceNormal(m.fromArray(K,p-Q,iT),iT),v=m.normalize(m.add(j,Z,v),v),jf(I,v,P,O,M,n),b=O/3,F=b-1,g=(M-2)/3,L=g+1,U[G++]=L,U[G++]=F,U[G++]=g,U[G++]=g,U[G++]=F,U[G++]=b,O+=3,M-=3;O-=3,M+=3}if(v=m.fromArray(c,c.length-3,v),jf(I,v,P,O,M,n),C){O+=3,M-=3,V=qF,R=YF;let Q=s[1];for(_=0;_<H;_++)V=m.fromArray(Q,(x-_-1)*3,V),R=m.fromArray(Q,_*3,R),Bi.addAttribute(E,V,void 0,M),Bi.addAttribute(E,R,O),jf(I,v,P,O,M,n),b=O/3,F=b-1,g=(M-2)/3,L=g+1,U[G++]=L,U[G++]=F,U[G++]=g,U[G++]=g,U[G++]=F,U[G++]=b,O+=3,M-=3}if(l.position=new we({componentDatatype:J.DOUBLE,componentsPerAttribute:3,values:E}),n.st){let Q=new Float32Array(T/3*2),me,_e,re=0;if(C){d/=3,h/=3;let fe=Math.PI/(x+1);_e=1/(d-x+1),me=1/(h-x+1);let ge,be=x/2;for(_=be+1;_<x+1;_++)ge=B.PI_OVER_TWO+fe*_,Q[re++]=me*(1+Math.cos(ge)),Q[re++]=.5*(1+Math.sin(ge));for(_=1;_<h-x+1;_++)Q[re++]=_*me,Q[re++]=0;for(_=x;_>be;_--)ge=B.PI_OVER_TWO-_*fe,Q[re++]=1-me*(1+Math.cos(ge)),Q[re++]=.5*(1+Math.sin(ge));for(_=be;_>0;_--)ge=B.PI_OVER_TWO-fe*_,Q[re++]=1-_e*(1+Math.cos(ge)),Q[re++]=.5*(1+Math.sin(ge));for(_=d-x;_>0;_--)Q[re++]=_*_e,Q[re++]=1;for(_=1;_<be+1;_++)ge=B.PI_OVER_TWO+fe*_,Q[re++]=_e*(1+Math.cos(ge)),Q[re++]=.5*(1+Math.sin(ge))}else{for(d/=3,h/=3,_e=1/(d-1),me=1/(h-1),_=0;_<h;_++)Q[re++]=_*me,Q[re++]=0;for(_=d;_>0;_--)Q[re++]=(_-1)*_e,Q[re++]=1}l.st=new we({componentDatatype:J.FLOAT,componentsPerAttribute:2,values:Q})}return n.normal&&(l.normal=new we({componentDatatype:J.FLOAT,componentsPerAttribute:3,values:I.normals})),n.tangent&&(l.tangent=new we({componentDatatype:J.FLOAT,componentsPerAttribute:3,values:I.tangents})),n.bitangent&&(l.bitangent=new we({componentDatatype:J.FLOAT,componentsPerAttribute:3,values:I.bitangents})),{attributes:l,indices:U}}function xGe(t,n){if(!n.normal&&!n.tangent&&!n.bitangent&&!n.st)return t;let i=t.position.values,o,r;(n.normal||n.bitangent)&&(o=t.normal.values,r=t.bitangent.values);let s=t.position.values.length/18,a=s*3,c=s*2,l=a*2,u;if(n.normal||n.bitangent||n.tangent){let d=n.normal?new Float32Array(a*6):void 0,h=n.tangent?new Float32Array(a*6):void 0,_=n.bitangent?new Float32Array(a*6):void 0,y=joe,p=qoe,C=qF,x=YF,T=CGe,E=Yoe,S=l;for(u=0;u<a;u+=3){let w=S+l;y=m.fromArray(i,u,y),p=m.fromArray(i,u+a,p),C=m.fromArray(i,(u+3)%a,C),p=m.subtract(p,y,p),C=m.subtract(C,y,C),x=m.normalize(m.cross(p,C,x),x),n.normal&&(Bi.addAttribute(d,x,w),Bi.addAttribute(d,x,w+3),Bi.addAttribute(d,x,S),Bi.addAttribute(d,x,S+3)),(n.tangent||n.bitangent)&&(E=m.fromArray(o,u,E),n.bitangent&&(Bi.addAttribute(_,E,w),Bi.addAttribute(_,E,w+3),Bi.addAttribute(_,E,S),Bi.addAttribute(_,E,S+3)),n.tangent&&(T=m.normalize(m.cross(E,x,T),T),Bi.addAttribute(h,T,w),Bi.addAttribute(h,T,w+3),Bi.addAttribute(h,T,S),Bi.addAttribute(h,T,S+3))),S+=6}if(n.normal){for(d.set(o),u=0;u<a;u+=3)d[u+a]=-o[u],d[u+a+1]=-o[u+1],d[u+a+2]=-o[u+2];t.normal.values=d}else t.normal=void 0;if(n.bitangent?(_.set(r),_.set(r,a),t.bitangent.values=_):t.bitangent=void 0,n.tangent){let w=t.tangent.values;h.set(w),h.set(w,a),t.tangent.values=h}}if(n.st){let d=t.st.values,h=new Float32Array(c*6);h.set(d),h.set(d,c);let _=c*2;for(let y=0;y<2;y++){for(h[_++]=d[0],h[_++]=d[1],u=2;u<c;u+=2){let p=d[u],C=d[u+1];h[_++]=p,h[_++]=C,h[_++]=p,h[_++]=C}h[_++]=d[0],h[_++]=d[1]}t.st.values=h}return t}function T6(t,n,i){i[n++]=t[0],i[n++]=t[1],i[n++]=t[2];for(let o=3;o<t.length;o+=3){let r=t[o],s=t[o+1],a=t[o+2];i[n++]=r,i[n++]=s,i[n++]=a,i[n++]=r,i[n++]=s,i[n++]=a}return i[n++]=t[0],i[n++]=t[1],i[n++]=t[2],i}function TGe(t,n){let i=new De({position:n.position,normal:n.normal||n.bitangent||t.shadowVolume,tangent:n.tangent,bitangent:n.normal||n.bitangent,st:n.st}),o=t.ellipsoid,r=Bi.computePositions(t),s=Koe(r,i,o),a=t.height,c=t.extrudedHeight,l=s.attributes,u=s.indices,d=l.position.values,h=d.length,_=new Float64Array(h*6),y=new Float64Array(h);y.set(d);let p=new Float64Array(h*4);d=ni.scaleToGeodeticHeight(d,a,o),p=T6(d,0,p),y=ni.scaleToGeodeticHeight(y,c,o),p=T6(y,h*2,p),_.set(d),_.set(y,h),_.set(p,h*2),l.position.values=_,l=xGe(l,n);let C,x=h/3;if(t.shadowVolume){let L=l.normal.values;h=L.length;let F=new Float32Array(h*6);for(C=0;C<h;C++)L[C]=-L[C];F.set(L,h),F=T6(L,h*4,F),l.extrudeDirection=new we({componentDatatype:J.FLOAT,componentsPerAttribute:3,values:F}),n.normal||(l.normal=void 0)}if(f(t.offsetAttribute)){let L=new Uint8Array(x*6);if(t.offsetAttribute===en.TOP)L=L.fill(1,0,x).fill(1,x*2,x*4);else{let F=t.offsetAttribute===en.NONE?0:1;L=L.fill(F)}l.applyOffset=new we({componentDatatype:J.UNSIGNED_BYTE,componentsPerAttribute:1,values:L})}let T=u.length,E=x+x,S=Ne.createTypedArray(_.length/3,T*2+E*3);S.set(u);let w=T;for(C=0;C<T;C+=3){let L=u[C],F=u[C+1],g=u[C+2];S[w++]=g+x,S[w++]=F+x,S[w++]=L+x}let D,I,O,M;for(C=0;C<E;C+=2)D=C+E,I=D+E,O=D+1,M=I+1,S[w++]=D,S[w++]=I,S[w++]=O,S[w++]=O,S[w++]=I,S[w++]=M;return{attributes:l,indices:S}}var Goe=new m,Rw=new m,Nu=new de;function Woe(t,n,i,o,r,s){let a=m.subtract(n,t,Goe);m.normalize(a,a);let c=i.geodeticSurfaceNormal(t,Rw),l=m.cross(a,c,Goe);m.multiplyByScalar(l,o,l);let u=r.latitude,d=r.longitude,h=s.latitude,_=s.longitude;m.add(t,l,Rw),i.cartesianToCartographic(Rw,Nu);let y=Nu.latitude,p=Nu.longitude;u=Math.min(u,y),d=Math.min(d,p),h=Math.max(h,y),_=Math.max(_,p),m.subtract(t,l,Rw),i.cartesianToCartographic(Rw,Nu),y=Nu.latitude,p=Nu.longitude,u=Math.min(u,y),d=Math.min(d,p),h=Math.max(h,y),_=Math.max(_,p),r.latitude=u,r.longitude=d,s.latitude=h,s.longitude=_}var Fu=new m,Mw=new m,el=new de,tl=new de;function Joe(t,n,i,o,r){t=Xoe(t,n);let s=Co(t,m.equalsEpsilon),a=s.length;if(a<2||i<=0)return new le;let c=i*.5;el.latitude=Number.POSITIVE_INFINITY,el.longitude=Number.POSITIVE_INFINITY,tl.latitude=Number.NEGATIVE_INFINITY,tl.longitude=Number.NEGATIVE_INFINITY;let l,u;if(o===wi.ROUNDED){let _=s[0];m.subtract(_,s[1],Fu),m.normalize(Fu,Fu),m.multiplyByScalar(Fu,c,Fu),m.add(_,Fu,Mw),n.cartesianToCartographic(Mw,Nu),l=Nu.latitude,u=Nu.longitude,el.latitude=Math.min(el.latitude,l),el.longitude=Math.min(el.longitude,u),tl.latitude=Math.max(tl.latitude,l),tl.longitude=Math.max(tl.longitude,u)}for(let _=0;_<a-1;++_)Woe(s[_],s[_+1],n,c,el,tl);let d=s[a-1];m.subtract(d,s[a-2],Fu),m.normalize(Fu,Fu),m.multiplyByScalar(Fu,c,Fu),m.add(d,Fu,Mw),Woe(d,Mw,n,c,el,tl),o===wi.ROUNDED&&(n.cartesianToCartographic(Mw,Nu),l=Nu.latitude,u=Nu.longitude,el.latitude=Math.min(el.latitude,l),el.longitude=Math.min(el.longitude,u),tl.latitude=Math.max(tl.latitude,l),tl.longitude=Math.max(tl.longitude,u));let h=f(r)?r:new le;return h.north=tl.latitude,h.south=el.latitude,h.east=tl.longitude,h.west=el.longitude,h}function sp(t){t=A(t,A.EMPTY_OBJECT);let n=t.positions,i=t.width,o=A(t.height,0),r=A(t.extrudedHeight,o);this._positions=n,this._ellipsoid=oe.clone(A(t.ellipsoid,oe.WGS84)),this._vertexFormat=De.clone(A(t.vertexFormat,De.DEFAULT)),this._width=i,this._height=Math.max(o,r),this._extrudedHeight=Math.min(o,r),this._cornerType=A(t.cornerType,wi.ROUNDED),this._granularity=A(t.granularity,B.RADIANS_PER_DEGREE),this._shadowVolume=A(t.shadowVolume,!1),this._workerName="createCorridorGeometry",this._offsetAttribute=t.offsetAttribute,this._rectangle=void 0,this.packedLength=1+n.length*m.packedLength+oe.packedLength+De.packedLength+7}sp.pack=function(t,n,i){i=A(i,0);let o=t._positions,r=o.length;n[i++]=r;for(let s=0;s<r;++s,i+=m.packedLength)m.pack(o[s],n,i);return oe.pack(t._ellipsoid,n,i),i+=oe.packedLength,De.pack(t._vertexFormat,n,i),i+=De.packedLength,n[i++]=t._width,n[i++]=t._height,n[i++]=t._extrudedHeight,n[i++]=t._cornerType,n[i++]=t._granularity,n[i++]=t._shadowVolume?1:0,n[i]=A(t._offsetAttribute,-1),n};var Zoe=oe.clone(oe.UNIT_SPHERE),Qoe=new De,rp={positions:void 0,ellipsoid:Zoe,vertexFormat:Qoe,width:void 0,height:void 0,extrudedHeight:void 0,cornerType:void 0,granularity:void 0,shadowVolume:void 0,offsetAttribute:void 0};sp.unpack=function(t,n,i){n=A(n,0);let o=t[n++],r=new Array(o);for(let p=0;p<o;++p,n+=m.packedLength)r[p]=m.unpack(t,n);let s=oe.unpack(t,n,Zoe);n+=oe.packedLength;let a=De.unpack(t,n,Qoe);n+=De.packedLength;let c=t[n++],l=t[n++],u=t[n++],d=t[n++],h=t[n++],_=t[n++]===1,y=t[n];return f(i)?(i._positions=r,i._ellipsoid=oe.clone(s,i._ellipsoid),i._vertexFormat=De.clone(a,i._vertexFormat),i._width=c,i._height=l,i._extrudedHeight=u,i._cornerType=d,i._granularity=h,i._shadowVolume=_,i._offsetAttribute=y===-1?void 0:y,i):(rp.positions=r,rp.width=c,rp.height=l,rp.extrudedHeight=u,rp.cornerType=d,rp.granularity=h,rp.shadowVolume=_,rp.offsetAttribute=y===-1?void 0:y,new sp(rp))};sp.computeRectangle=function(t,n){t=A(t,A.EMPTY_OBJECT);let i=t.positions,o=t.width,r=A(t.ellipsoid,oe.WGS84),s=A(t.cornerType,wi.ROUNDED);return Joe(i,r,o,s,n)};sp.createGeometry=function(t){let n=t._positions,i=t._width,o=t._ellipsoid;n=Xoe(n,o);let r=Co(n,m.equalsEpsilon);if(r.length<2||i<=0)return;let s=t._height,a=t._extrudedHeight,c=!B.equalsEpsilon(s,a,0,B.EPSILON2),l=t._vertexFormat,u={ellipsoid:o,positions:r,width:i,cornerType:t._cornerType,granularity:t._granularity,saveAttributes:!0},d;if(c)u.height=s,u.extrudedHeight=a,u.shadowVolume=t._shadowVolume,u.offsetAttribute=t._offsetAttribute,d=TGe(u,l);else{let y=Bi.computePositions(u);if(d=Koe(y,l,o),d.attributes.position.values=ni.scaleToGeodeticHeight(d.attributes.position.values,s,o),f(t._offsetAttribute)){let p=t._offsetAttribute===en.NONE?0:1,C=d.attributes.position.values.length,x=new Uint8Array(C/3).fill(p);d.attributes.applyOffset=new we({componentDatatype:J.UNSIGNED_BYTE,componentsPerAttribute:1,values:x})}}let h=d.attributes,_=ae.fromVertices(h.position.values,void 0,3);return l.position||(d.attributes.position.values=void 0),new at({attributes:h,indices:d.indices,primitiveType:Re.TRIANGLES,boundingSphere:_,offsetAttribute:t._offsetAttribute})};sp.createShadowVolume=function(t,n,i){let o=t._granularity,r=t._ellipsoid,s=n(o,r),a=i(o,r);return new sp({positions:t._positions,width:t._width,cornerType:t._cornerType,ellipsoid:r,granularity:o,extrudedHeight:s,height:a,vertexFormat:De.POSITION_ONLY,shadowVolume:!0})};Object.defineProperties(sp.prototype,{rectangle:{get:function(){return f(this._rectangle)||(this._rectangle=Joe(this._positions,this._ellipsoid,this._width,this._cornerType)),this._rectangle}},textureCoordinateRotationPoints:{get:function(){return[0,0,0,1,1,0]}}});var oT=sp;var $oe=new m,ere=new m,EGe=new m;function bGe(t,n){for(let i=0;i<t.length;i++)t[i]=n.scaleToGeodeticSurface(t[i],t[i]);return t}function tre(t,n){let i=[],o=t.positions,r=t.corners,s=t.endPositions,a=new cn,c,l=0,u=0,d,h=0,_;for(d=0;d<o.length;d+=2)_=o[d].length-3,l+=_,h+=_/3*4,u+=o[d+1].length-3;for(l+=3,u+=3,d=0;d<r.length;d++){c=r[d];let R=r[d].leftPositions;f(R)?(_=R.length,l+=_,h+=_/3*2):(_=r[d].rightPositions.length,u+=_,h+=_/3*2)}let y=f(s),p;y&&(p=s[0].length-3,l+=p,u+=p,p/=3,h+=p*4);let C=l+u,x=new Float64Array(C),T=0,E=C-1,S,w,D,I,O,M,L=p/2,F=Ne.createTypedArray(C/3,h+4),g=0;if(F[g++]=T/3,F[g++]=(E-2)/3,y){i.push(T/3),M=$oe,O=ere;let R=s[0];for(d=0;d<L;d++)M=m.fromArray(R,(L-1-d)*3,M),O=m.fromArray(R,(L+d)*3,O),Bi.addAttribute(x,O,T),Bi.addAttribute(x,M,void 0,E),w=T/3,I=w+1,S=(E-2)/3,D=S-1,F[g++]=S,F[g++]=D,F[g++]=w,F[g++]=I,T+=3,E-=3}let b=0,v=o[b++],P=o[b++];for(x.set(v,T),x.set(P,E-P.length+1),_=P.length-3,i.push(T/3,(E-2)/3),d=0;d<_;d+=3)w=T/3,I=w+1,S=(E-2)/3,D=S-1,F[g++]=S,F[g++]=D,F[g++]=w,F[g++]=I,T+=3,E-=3;for(d=0;d<r.length;d++){let R;c=r[d];let V=c.leftPositions,H=c.rightPositions,U,G=EGe;if(f(V)){for(E-=3,U=D,i.push(I),R=0;R<V.length/3;R++)G=m.fromArray(V,R*3,G),F[g++]=U-R-1,F[g++]=U-R,Bi.addAttribute(x,G,void 0,E),E-=3;i.push(U-Math.floor(V.length/6)),n===wi.BEVELED&&i.push((E-2)/3+1),T+=3}else{for(T+=3,U=I,i.push(D),R=0;R<H.length/3;R++)G=m.fromArray(H,R*3,G),F[g++]=U+R,F[g++]=U+R+1,Bi.addAttribute(x,G,T),T+=3;i.push(U+Math.floor(H.length/6)),n===wi.BEVELED&&i.push(T/3-1),E-=3}for(v=o[b++],P=o[b++],v.splice(0,3),P.splice(P.length-3,3),x.set(v,T),x.set(P,E-P.length+1),_=P.length-3,R=0;R<P.length;R+=3)I=T/3,w=I-1,D=(E-2)/3,S=D+1,F[g++]=S,F[g++]=D,F[g++]=w,F[g++]=I,T+=3,E-=3;T-=3,E+=3,i.push(T/3,(E-2)/3)}if(y){T+=3,E-=3,M=$oe,O=ere;let R=s[1];for(d=0;d<L;d++)M=m.fromArray(R,(p-d-1)*3,M),O=m.fromArray(R,d*3,O),Bi.addAttribute(x,M,void 0,E),Bi.addAttribute(x,O,T),I=T/3,w=I-1,D=(E-2)/3,S=D+1,F[g++]=S,F[g++]=D,F[g++]=w,F[g++]=I,T+=3,E-=3;i.push(T/3)}else i.push(T/3,(E-2)/3);return F[g++]=T/3,F[g++]=(E-2)/3,a.position=new we({componentDatatype:J.DOUBLE,componentsPerAttribute:3,values:x}),{attributes:a,indices:F,wallIndices:i}}function SGe(t){let n=t.ellipsoid,i=Bi.computePositions(t),o=tre(i,t.cornerType),r=o.wallIndices,s=t.height,a=t.extrudedHeight,c=o.attributes,l=o.indices,u=c.position.values,d=u.length,h=new Float64Array(d);h.set(u);let _=new Float64Array(d*2);if(u=ni.scaleToGeodeticHeight(u,s,n),h=ni.scaleToGeodeticHeight(h,a,n),_.set(u),_.set(h,d),c.position.values=_,d/=3,f(t.offsetAttribute)){let S=new Uint8Array(d*2);if(t.offsetAttribute===en.TOP)S=S.fill(1,0,d);else{let w=t.offsetAttribute===en.NONE?0:1;S=S.fill(w)}c.applyOffset=new we({componentDatatype:J.UNSIGNED_BYTE,componentsPerAttribute:1,values:S})}let y,p=l.length,C=Ne.createTypedArray(_.length/3,(p+r.length)*2);C.set(l);let x=p;for(y=0;y<p;y+=2){let S=l[y],w=l[y+1];C[x++]=S+d,C[x++]=w+d}let T,E;for(y=0;y<r.length;y++)T=r[y],E=T+d,C[x++]=T,C[x++]=E;return{attributes:c,indices:C}}function Lw(t){t=A(t,A.EMPTY_OBJECT);let n=t.positions,i=t.width,o=A(t.height,0),r=A(t.extrudedHeight,o);this._positions=n,this._ellipsoid=oe.clone(A(t.ellipsoid,oe.WGS84)),this._width=i,this._height=Math.max(o,r),this._extrudedHeight=Math.min(o,r),this._cornerType=A(t.cornerType,wi.ROUNDED),this._granularity=A(t.granularity,B.RADIANS_PER_DEGREE),this._offsetAttribute=t.offsetAttribute,this._workerName="createCorridorOutlineGeometry",this.packedLength=1+n.length*m.packedLength+oe.packedLength+6}Lw.pack=function(t,n,i){i=A(i,0);let o=t._positions,r=o.length;n[i++]=r;for(let s=0;s<r;++s,i+=m.packedLength)m.pack(o[s],n,i);return oe.pack(t._ellipsoid,n,i),i+=oe.packedLength,n[i++]=t._width,n[i++]=t._height,n[i++]=t._extrudedHeight,n[i++]=t._cornerType,n[i++]=t._granularity,n[i]=A(t._offsetAttribute,-1),n};var nre=oe.clone(oe.UNIT_SPHERE),Z_={positions:void 0,ellipsoid:nre,width:void 0,height:void 0,extrudedHeight:void 0,cornerType:void 0,granularity:void 0,offsetAttribute:void 0};Lw.unpack=function(t,n,i){n=A(n,0);let o=t[n++],r=new Array(o);for(let _=0;_<o;++_,n+=m.packedLength)r[_]=m.unpack(t,n);let s=oe.unpack(t,n,nre);n+=oe.packedLength;let a=t[n++],c=t[n++],l=t[n++],u=t[n++],d=t[n++],h=t[n];return f(i)?(i._positions=r,i._ellipsoid=oe.clone(s,i._ellipsoid),i._width=a,i._height=c,i._extrudedHeight=l,i._cornerType=u,i._granularity=d,i._offsetAttribute=h===-1?void 0:h,i):(Z_.positions=r,Z_.width=a,Z_.height=c,Z_.extrudedHeight=l,Z_.cornerType=u,Z_.granularity=d,Z_.offsetAttribute=h===-1?void 0:h,new Lw(Z_))};Lw.createGeometry=function(t){let n=t._positions,i=t._width,o=t._ellipsoid;n=bGe(n,o);let r=Co(n,m.equalsEpsilon);if(r.length<2||i<=0)return;let s=t._height,a=t._extrudedHeight,c=!B.equalsEpsilon(s,a,0,B.EPSILON2),l={ellipsoid:o,positions:r,width:i,cornerType:t._cornerType,granularity:t._granularity,saveAttributes:!1},u;if(c)l.height=s,l.extrudedHeight=a,l.offsetAttribute=t._offsetAttribute,u=SGe(l);else{let _=Bi.computePositions(l);if(u=tre(_,l.cornerType),u.attributes.position.values=ni.scaleToGeodeticHeight(u.attributes.position.values,s,o),f(t._offsetAttribute)){let y=u.attributes.position.values.length,p=t._offsetAttribute===en.NONE?0:1,C=new Uint8Array(y/3).fill(p);u.attributes.applyOffset=new we({componentDatatype:J.UNSIGNED_BYTE,componentsPerAttribute:1,values:C})}}let d=u.attributes,h=ae.fromVertices(d.position.values,void 0,3);return new at({attributes:d,indices:u.indices,primitiveType:Re.LINES,boundingSphere:h,offsetAttribute:t._offsetAttribute})};var XF=Lw;var wGe=new Kn(0);function gc(t){ti.call(this,t),this._zIndex=0,this._terrainOffsetProperty=void 0}f(Object.create)&&(gc.prototype=Object.create(ti.prototype),gc.prototype.constructor=gc);Object.defineProperties(gc.prototype,{zIndex:{get:function(){return this._zIndex}},terrainOffsetProperty:{get:function(){return this._terrainOffsetProperty}}});gc.prototype._isOnTerrain=function(t,n){return this._fillEnabled&&!f(n.height)&&!f(n.extrudedHeight)&&Kc.isSupported(this._scene)};gc.prototype._getIsClosed=function(t){let n=t.height,i=t.extrudedHeight;return n===0||f(i)&&i!==n};gc.prototype._computeCenter=Ce.throwInstantiationError;gc.prototype._onEntityPropertyChanged=function(t,n,i,o){if(ti.prototype._onEntityPropertyChanged.call(this,t,n,i,o),this._observedPropertyNames.indexOf(n)===-1)return;let r=this._entity[this._geometryPropertyName];if(!f(r))return;f(r.zIndex)&&(f(r.height)||f(r.extrudedHeight))&&Bt(Bt.geometryZIndex),this._zIndex=A(r.zIndex,wGe),f(this._terrainOffsetProperty)&&(this._terrainOffsetProperty.destroy(),this._terrainOffsetProperty=void 0);let s=r.heightReference,a=r.extrudedHeightReference;if(f(s)||f(a)){let c=new rh(this._computeCenter.bind(this),!this._dynamic);this._terrainOffsetProperty=new bx(this._scene,c,s,a)}};gc.prototype.destroy=function(){f(this._terrainOffsetProperty)&&(this._terrainOffsetProperty.destroy(),this._terrainOffsetProperty=void 0),ti.prototype.destroy.call(this)};gc.getGeometryHeight=function(t,n){if(!f(t)){n!==Ge.NONE&&Bt(Bt.geometryHeightReference);return}return n!==Ge.CLAMP_TO_GROUND?t:0};gc.getGeometryExtrudedHeight=function(t,n){if(!f(t)){n!==Ge.NONE&&Bt(Bt.geometryExtrudedHeightReference);return}return n!==Ge.CLAMP_TO_GROUND?t:gc.CLAMP_TO_GROUND};gc.CLAMP_TO_GROUND="clamp";gc.computeGeometryOffsetAttribute=function(t,n,i,o){(!f(t)||!f(n))&&(n=Ge.NONE),(!f(i)||!f(o))&&(o=Ge.NONE);let r=0;if(n!==Ge.NONE&&r++,o===Ge.RELATIVE_TO_GROUND&&r++,r===2)return en.ALL;if(r===1)return en.TOP};var Wn=gc;var ire=new z,ore=m.ZERO,rre=new m,sre=new le;function DGe(t){this.id=t,this.vertexFormat=void 0,this.positions=void 0,this.width=void 0,this.cornerType=void 0,this.height=void 0,this.extrudedHeight=void 0,this.granularity=void 0,this.offsetAttribute=void 0}function qf(t,n){Wn.call(this,{entity:t,scene:n,geometryOptions:new DGe(t),geometryPropertyName:"corridor",observedPropertyNames:["availability","corridor"]}),this._onEntityPropertyChanged(t,"corridor",t.corridor,void 0)}f(Object.create)&&(qf.prototype=Object.create(Wn.prototype),qf.prototype.constructor=qf);qf.prototype.createFillGeometryInstance=function(t){let n=this._entity,i=n.isAvailable(t),o={show:new mn(i&&n.isShowing&&this._showProperty.getValue(t)&&this._fillProperty.getValue(t)),distanceDisplayCondition:Vn.fromDistanceDisplayCondition(this._distanceDisplayConditionProperty.getValue(t)),offset:void 0,color:void 0};if(this._materialProperty instanceof Rt){let r;f(this._materialProperty.color)&&(this._materialProperty.color.isConstant||i)&&(r=this._materialProperty.color.getValue(t,ire)),f(r)||(r=z.WHITE),o.color=Lt.fromColor(r)}return f(this._options.offsetAttribute)&&(o.offset=Gi.fromCartesian3(q.getValueOrDefault(this._terrainOffsetProperty,t,ore,rre))),new Ct({id:n,geometry:new oT(this._options),attributes:o})};qf.prototype.createOutlineGeometryInstance=function(t){let n=this._entity,i=n.isAvailable(t),o=q.getValueOrDefault(this._outlineColorProperty,t,z.BLACK,ire),r={show:new mn(i&&n.isShowing&&this._showProperty.getValue(t)&&this._showOutlineProperty.getValue(t)),color:Lt.fromColor(o),distanceDisplayCondition:Vn.fromDistanceDisplayCondition(this._distanceDisplayConditionProperty.getValue(t)),offset:void 0};return f(this._options.offsetAttribute)&&(r.offset=Gi.fromCartesian3(q.getValueOrDefault(this._terrainOffsetProperty,t,ore,rre))),new Ct({id:n,geometry:new XF(this._options),attributes:r})};qf.prototype._computeCenter=function(t,n){let i=q.getValueOrUndefined(this._entity.corridor.positions,t);if(!(!f(i)||i.length===0))return m.clone(i[Math.floor(i.length/2)],n)};qf.prototype._isHidden=function(t,n){return!f(n.positions)||!f(n.width)||ti.prototype._isHidden.call(this,t,n)};qf.prototype._isDynamic=function(t,n){return!n.positions.isConstant||!q.isConstant(n.height)||!q.isConstant(n.extrudedHeight)||!q.isConstant(n.granularity)||!q.isConstant(n.width)||!q.isConstant(n.outlineWidth)||!q.isConstant(n.cornerType)||!q.isConstant(n.zIndex)||this._onTerrain&&!q.isConstant(this._materialProperty)&&!(this._materialProperty instanceof Rt)};qf.prototype._setStaticOptions=function(t,n){let i=q.getValueOrUndefined(n.height,Ue.MINIMUM_VALUE),o=q.getValueOrDefault(n.heightReference,Ue.MINIMUM_VALUE,Ge.NONE),r=q.getValueOrUndefined(n.extrudedHeight,Ue.MINIMUM_VALUE),s=q.getValueOrDefault(n.extrudedHeightReference,Ue.MINIMUM_VALUE,Ge.NONE);f(r)&&!f(i)&&(i=0);let a=this._options;a.vertexFormat=this._materialProperty instanceof Rt?tn.VERTEX_FORMAT:ro.MaterialSupport.TEXTURED.vertexFormat,a.positions=n.positions.getValue(Ue.MINIMUM_VALUE,a.positions),a.width=n.width.getValue(Ue.MINIMUM_VALUE),a.granularity=q.getValueOrUndefined(n.granularity,Ue.MINIMUM_VALUE),a.cornerType=q.getValueOrUndefined(n.cornerType,Ue.MINIMUM_VALUE),a.offsetAttribute=Wn.computeGeometryOffsetAttribute(i,o,r,s),a.height=Wn.getGeometryHeight(i,o),r=Wn.getGeometryExtrudedHeight(r,s),r===Wn.CLAMP_TO_GROUND&&(r=ri.getMinimumMaximumHeights(oT.computeRectangle(a,sre)).minimumTerrainHeight),a.extrudedHeight=r};qf.DynamicGeometryUpdater=rT;function rT(t,n,i){ei.call(this,t,n,i)}f(Object.create)&&(rT.prototype=Object.create(ei.prototype),rT.prototype.constructor=rT);rT.prototype._isHidden=function(t,n,i){let o=this._options;return!f(o.positions)||!f(o.width)||ei.prototype._isHidden.call(this,t,n,i)};rT.prototype._setOptions=function(t,n,i){let o=this._options,r=q.getValueOrUndefined(n.height,i),s=q.getValueOrDefault(n.heightReference,i,Ge.NONE),a=q.getValueOrUndefined(n.extrudedHeight,i),c=q.getValueOrDefault(n.extrudedHeightReference,i,Ge.NONE);f(a)&&!f(r)&&(r=0),o.positions=q.getValueOrUndefined(n.positions,i),o.width=q.getValueOrUndefined(n.width,i),o.granularity=q.getValueOrUndefined(n.granularity,i),o.cornerType=q.getValueOrUndefined(n.cornerType,i),o.offsetAttribute=Wn.computeGeometryOffsetAttribute(r,s,a,c),o.height=Wn.getGeometryHeight(r,s),a=Wn.getGeometryExtrudedHeight(a,c),a===Wn.CLAMP_TO_GROUND&&(a=ri.getMinimumMaximumHeights(oT.computeRectangle(o,sre)).minimumTerrainHeight),o.extrudedHeight=a};var KF=qf;function JF(){Ce.throwInstantiationError()}Object.defineProperties(JF.prototype,{name:{get:Ce.throwInstantiationError},clock:{get:Ce.throwInstantiationError},entities:{get:Ce.throwInstantiationError},isLoading:{get:Ce.throwInstantiationError},changedEvent:{get:Ce.throwInstantiationError},errorEvent:{get:Ce.throwInstantiationError},loadingEvent:{get:Ce.throwInstantiationError},show:{get:Ce.throwInstantiationError},clustering:{get:Ce.throwInstantiationError}});JF.prototype.update=function(t){Ce.throwInstantiationError()};JF.setLoading=function(t,n){t._isLoading!==n&&(n?t._entityCollection.suspendEvents():t._entityCollection.resumeEvents(),t._isLoading=n,t._loading.raiseEvent(t,n))};var Fr=JF;function ph(t,n){this._ellipsoid=t,this._cameraPosition=new m,this._cameraPositionInScaledSpace=new m,this._distanceToLimbInScaledSpaceSquared=0,f(n)&&(this.cameraPosition=n)}Object.defineProperties(ph.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},cameraPosition:{get:function(){return this._cameraPosition},set:function(t){let i=this._ellipsoid.transformPositionToScaledSpace(t,this._cameraPositionInScaledSpace),o=m.magnitudeSquared(i)-1;m.clone(t,this._cameraPosition),this._cameraPositionInScaledSpace=i,this._distanceToLimbInScaledSpaceSquared=o}}});var are=new m;ph.prototype.isPointVisible=function(t){let i=this._ellipsoid.transformPositionToScaledSpace(t,are);return b6(i,this._cameraPositionInScaledSpace,this._distanceToLimbInScaledSpaceSquared)};ph.prototype.isScaledSpacePointVisible=function(t){return b6(t,this._cameraPositionInScaledSpace,this._distanceToLimbInScaledSpaceSquared)};var vGe=new m;ph.prototype.isScaledSpacePointVisiblePossiblyUnderEllipsoid=function(t,n){let i=this._ellipsoid,o,r;return f(n)&&n<0&&i.minimumRadius>-n?(r=vGe,r.x=this._cameraPosition.x/(i.radii.x+n),r.y=this._cameraPosition.y/(i.radii.y+n),r.z=this._cameraPosition.z/(i.radii.z+n),o=r.x*r.x+r.y*r.y+r.z*r.z-1):(r=this._cameraPositionInScaledSpace,o=this._distanceToLimbInScaledSpaceSquared),b6(t,r,o)};ph.prototype.computeHorizonCullingPoint=function(t,n,i){return ure(this._ellipsoid,t,n,i)};var cre=oe.clone(oe.UNIT_SPHERE);ph.prototype.computeHorizonCullingPointPossiblyUnderEllipsoid=function(t,n,i,o){let r=lre(this._ellipsoid,i,cre);return ure(r,t,n,o)};ph.prototype.computeHorizonCullingPointFromVertices=function(t,n,i,o,r){return fre(this._ellipsoid,t,n,i,o,r)};ph.prototype.computeHorizonCullingPointFromVerticesPossiblyUnderEllipsoid=function(t,n,i,o,r,s){let a=lre(this._ellipsoid,r,cre);return fre(a,t,n,i,o,s)};var PGe=[];ph.prototype.computeHorizonCullingPointFromRectangle=function(t,n,i){let o=le.subsample(t,n,0,PGe),r=ae.fromPoints(o);if(!(m.magnitude(r.center)<.1*n.minimumRadius))return this.computeHorizonCullingPoint(r.center,o,i)};var IGe=new m;function lre(t,n,i){if(f(n)&&n<0&&t.minimumRadius>-n){let o=m.fromElements(t.radii.x+n,t.radii.y+n,t.radii.z+n,IGe);t=oe.fromCartesian3(o,i)}return t}function ure(t,n,i,o){f(o)||(o=new m);let r=mre(t,n),s=0;for(let a=0,c=i.length;a<c;++a){let l=i[a],u=dre(t,l,r);if(u<0)return;s=Math.max(s,u)}return hre(r,s,o)}var ZF=new m;function fre(t,n,i,o,r,s){f(s)||(s=new m),o=A(o,3),r=A(r,m.ZERO);let a=mre(t,n),c=0;for(let l=0,u=i.length;l<u;l+=o){ZF.x=i[l]+r.x,ZF.y=i[l+1]+r.y,ZF.z=i[l+2]+r.z;let d=dre(t,ZF,a);if(d<0)return;c=Math.max(c,d)}return hre(a,c,s)}function b6(t,n,i){let o=n,r=i,s=m.subtract(t,o,are),a=-m.dot(s,o);return!(r<0?a>0:a>r&&a*a/m.magnitudeSquared(s)>r)}var BGe=new m,OGe=new m;function dre(t,n,i){let o=t.transformPositionToScaledSpace(n,BGe),r=m.magnitudeSquared(o),s=Math.sqrt(r),a=m.divideByScalar(o,s,OGe);r=Math.max(1,r),s=Math.max(1,s);let c=m.dot(a,i),l=m.magnitude(m.cross(a,i,a)),u=1/s,d=Math.sqrt(r-1)*u;return 1/(c*u-l*d)}function hre(t,n,i){if(!(n<=0||n===1/0||n!==n))return m.multiplyByScalar(t,n,i)}var E6=new m;function mre(t,n){return m.equals(n,m.ZERO)?n:(t.transformPositionToScaledSpace(n,E6),m.normalize(E6,E6))}var Q_=ph;function br(t,n){t=A(t,A.EMPTY_OBJECT);let i=t.translucencyByDistance,o=t.scaleByDistance,r=t.distanceDisplayCondition;f(i)&&(i=Pt.clone(i)),f(o)&&(o=Pt.clone(o)),f(r)&&(r=wt.clone(r)),this._show=A(t.show,!0),this._position=m.clone(A(t.position,m.ZERO)),this._actualPosition=m.clone(this._position),this._color=z.clone(A(t.color,z.WHITE)),this._outlineColor=z.clone(A(t.outlineColor,z.TRANSPARENT)),this._outlineWidth=A(t.outlineWidth,0),this._pixelSize=A(t.pixelSize,10),this._scaleByDistance=o,this._translucencyByDistance=i,this._distanceDisplayCondition=r,this._disableDepthTestDistance=A(t.disableDepthTestDistance,0),this._id=t.id,this._collection=A(t.collection,n),this._clusterShow=!0,this._pickId=void 0,this._pointPrimitiveCollection=n,this._dirty=!1,this._index=-1}var pre=br.SHOW_INDEX=0,yre=br.POSITION_INDEX=1,RGe=br.COLOR_INDEX=2,MGe=br.OUTLINE_COLOR_INDEX=3,LGe=br.OUTLINE_WIDTH_INDEX=4,FGe=br.PIXEL_SIZE_INDEX=5,NGe=br.SCALE_BY_DISTANCE_INDEX=6,VGe=br.TRANSLUCENCY_BY_DISTANCE_INDEX=7,kGe=br.DISTANCE_DISPLAY_CONDITION_INDEX=8,UGe=br.DISABLE_DEPTH_DISTANCE_INDEX=9;br.NUMBER_OF_PROPERTIES=10;function Vu(t,n){let i=t._pointPrimitiveCollection;f(i)&&(i._updatePointPrimitive(t,n),t._dirty=!0)}Object.defineProperties(br.prototype,{show:{get:function(){return this._show},set:function(t){this._show!==t&&(this._show=t,Vu(this,pre))}},position:{get:function(){return this._position},set:function(t){let n=this._position;m.equals(n,t)||(m.clone(t,n),m.clone(t,this._actualPosition),Vu(this,yre))}},scaleByDistance:{get:function(){return this._scaleByDistance},set:function(t){let n=this._scaleByDistance;Pt.equals(n,t)||(this._scaleByDistance=Pt.clone(t,n),Vu(this,NGe))}},translucencyByDistance:{get:function(){return this._translucencyByDistance},set:function(t){let n=this._translucencyByDistance;Pt.equals(n,t)||(this._translucencyByDistance=Pt.clone(t,n),Vu(this,VGe))}},pixelSize:{get:function(){return this._pixelSize},set:function(t){this._pixelSize!==t&&(this._pixelSize=t,Vu(this,FGe))}},color:{get:function(){return this._color},set:function(t){let n=this._color;z.equals(n,t)||(z.clone(t,n),Vu(this,RGe))}},outlineColor:{get:function(){return this._outlineColor},set:function(t){let n=this._outlineColor;z.equals(n,t)||(z.clone(t,n),Vu(this,MGe))}},outlineWidth:{get:function(){return this._outlineWidth},set:function(t){this._outlineWidth!==t&&(this._outlineWidth=t,Vu(this,LGe))}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(t){wt.equals(this._distanceDisplayCondition,t)||(this._distanceDisplayCondition=wt.clone(t,this._distanceDisplayCondition),Vu(this,kGe))}},disableDepthTestDistance:{get:function(){return this._disableDepthTestDistance},set:function(t){this._disableDepthTestDistance!==t&&(this._disableDepthTestDistance=t,Vu(this,UGe))}},id:{get:function(){return this._id},set:function(t){this._id=t,f(this._pickId)&&(this._pickId.object.id=t)}},pickId:{get:function(){return this._pickId}},clusterShow:{get:function(){return this._clusterShow},set:function(t){this._clusterShow!==t&&(this._clusterShow=t,Vu(this,pre))}}});br.prototype.getPickId=function(t){return f(this._pickId)||(this._pickId=t.createPickId({primitive:this,collection:this._collection,id:this._id})),this._pickId};br.prototype._getActualPosition=function(){return this._actualPosition};br.prototype._setActualPosition=function(t){m.clone(t,this._actualPosition),Vu(this,yre)};var _re=new se;br._computeActualPosition=function(t,n,i){return n.mode===ne.SCENE3D?t:(N.multiplyByPoint(i,t,_re),Yi.computeActualWgs84Position(n,_re))};var gre=new se;br._computeScreenSpacePosition=function(t,n,i,o){let r=N.multiplyByVector(t,se.fromElements(n.x,n.y,n.z,1,gre),gre);return Yi.wgs84ToWindowCoordinates(i,r,o)};br.prototype.computeScreenSpacePosition=function(t,n){let i=this._pointPrimitiveCollection;f(n)||(n=new W);let o=i.modelMatrix,r=br._computeScreenSpacePosition(o,this._actualPosition,t,n);if(!!f(r))return r.y=t.canvas.clientHeight-r.y,r};br.getScreenSpaceBoundingBox=function(t,n,i){let o=t.pixelSize,r=o*.5,s=n.x-r,a=n.y-r,c=o,l=o;return f(i)||(i=new He),i.x=s,i.y=a,i.width=c,i.height=l,i};br.prototype.equals=function(t){return this===t||f(t)&&this._id===t._id&&m.equals(this._position,t._position)&&z.equals(this._color,t._color)&&this._pixelSize===t._pixelSize&&this._outlineWidth===t._outlineWidth&&this._show===t._show&&z.equals(this._outlineColor,t._outlineColor)&&Pt.equals(this._scaleByDistance,t._scaleByDistance)&&Pt.equals(this._translucencyByDistance,t._translucencyByDistance)&&wt.equals(this._distanceDisplayCondition,t._distanceDisplayCondition)&&this._disableDepthTestDistance===t._disableDepthTestDistance};br.prototype._destroy=function(){this._pickId=this._pickId&&this._pickId.destroy(),this._pointPrimitiveCollection=void 0};var Fs=br;var Py=`varying vec4 v_color;
varying vec4 v_outlineColor;
varying float v_innerPercent;
varying float v_pixelDistance;
varying vec4 v_pickColor;
void main()
{
float distanceToCenter = length(gl_PointCoord - vec2(0.5));
float maxDistance = max(0.0, 0.5 - v_pixelDistance);
float wholeAlpha = 1.0 - smoothstep(maxDistance, 0.5, distanceToCenter);
float innerAlpha = 1.0 - smoothstep(maxDistance * v_innerPercent, 0.5 * v_innerPercent, distanceToCenter);
vec4 color = mix(v_outlineColor, v_color, innerAlpha);
color.a *= wholeAlpha;
#if !defined(OPAQUE) && !defined(TRANSLUCENT)
if (color.a < 0.005)
{
discard;
}
#else
#ifdef OPAQUE
if (color.a < 0.995)
{
discard;
}
#else
if (color.a >= 0.995)
{
discard;
}
#endif
#endif
gl_FragColor = czm_gammaCorrect(color);
czm_writeLogDepth();
}
`;var QF=`uniform float u_maxTotalPointSize;
attribute vec4 positionHighAndSize;
attribute vec4 positionLowAndOutline;
attribute vec4 compressedAttribute0;
attribute vec4 compressedAttribute1;
attribute vec4 scaleByDistance;
attribute vec3 distanceDisplayConditionAndDisableDepth;
varying vec4 v_color;
varying vec4 v_outlineColor;
varying float v_innerPercent;
varying float v_pixelDistance;
varying vec4 v_pickColor;
const float SHIFT_LEFT8 = 256.0;
const float SHIFT_RIGHT8 = 1.0 / 256.0;
void main()
{
vec3 positionHigh = positionHighAndSize.xyz;
vec3 positionLow = positionLowAndOutline.xyz;
float outlineWidthBothSides = 2.0 * positionLowAndOutline.w;
float totalSize = positionHighAndSize.w + outlineWidthBothSides;
float outlinePercent = outlineWidthBothSides / totalSize;
totalSize *= czm_pixelRatio;
totalSize += 3.0;
float temp = compressedAttribute1.x * SHIFT_RIGHT8;
float show = floor(temp);
#ifdef EYE_DISTANCE_TRANSLUCENCY
vec4 translucencyByDistance;
translucencyByDistance.x = compressedAttribute1.z;
translucencyByDistance.z = compressedAttribute1.w;
translucencyByDistance.y = ((temp - floor(temp)) * SHIFT_LEFT8) / 255.0;
temp = compressedAttribute1.y * SHIFT_RIGHT8;
translucencyByDistance.w = ((temp - floor(temp)) * SHIFT_LEFT8) / 255.0;
#endif
vec4 color;
vec4 outlineColor;
vec4 pickColor;
temp = compressedAttribute0.z * SHIFT_RIGHT8;
pickColor.b = (temp - floor(temp)) * SHIFT_LEFT8;
temp = floor(temp) * SHIFT_RIGHT8;
pickColor.g = (temp - floor(temp)) * SHIFT_LEFT8;
pickColor.r = floor(temp);
temp = compressedAttribute0.x * SHIFT_RIGHT8;
color.b = (temp - floor(temp)) * SHIFT_LEFT8;
temp = floor(temp) * SHIFT_RIGHT8;
color.g = (temp - floor(temp)) * SHIFT_LEFT8;
color.r = floor(temp);
temp = compressedAttribute0.y * SHIFT_RIGHT8;
outlineColor.b = (temp - floor(temp)) * SHIFT_LEFT8;
temp = floor(temp) * SHIFT_RIGHT8;
outlineColor.g = (temp - floor(temp)) * SHIFT_LEFT8;
outlineColor.r = floor(temp);
temp = compressedAttribute0.w * SHIFT_RIGHT8;
pickColor.a = (temp - floor(temp)) * SHIFT_LEFT8;
pickColor = pickColor / 255.0;
temp = floor(temp) * SHIFT_RIGHT8;
outlineColor.a = (temp - floor(temp)) * SHIFT_LEFT8;
outlineColor /= 255.0;
color.a = floor(temp);
color /= 255.0;
vec4 p = czm_translateRelativeToEye(positionHigh, positionLow);
vec4 positionEC = czm_modelViewRelativeToEye * p;
#if defined(EYE_DISTANCE_SCALING) || defined(EYE_DISTANCE_TRANSLUCENCY) || defined(DISTANCE_DISPLAY_CONDITION) || defined(DISABLE_DEPTH_DISTANCE)
float lengthSq;
if (czm_sceneMode == czm_sceneMode2D)
{
lengthSq = czm_eyeHeight2D.y;
}
else
{
lengthSq = dot(positionEC.xyz, positionEC.xyz);
}
#endif
#ifdef EYE_DISTANCE_SCALING
totalSize *= czm_nearFarScalar(scaleByDistance, lengthSq);
#endif
totalSize = min(totalSize, u_maxTotalPointSize);
if (totalSize < 1.0)
{
positionEC.xyz = vec3(0.0);
totalSize = 1.0;
}
float translucency = 1.0;
#ifdef EYE_DISTANCE_TRANSLUCENCY
translucency = czm_nearFarScalar(translucencyByDistance, lengthSq);
if (translucency < 0.004)
{
positionEC.xyz = vec3(0.0);
}
#endif
#ifdef DISTANCE_DISPLAY_CONDITION
float nearSq = distanceDisplayConditionAndDisableDepth.x;
float farSq = distanceDisplayConditionAndDisableDepth.y;
if (lengthSq < nearSq || lengthSq > farSq) {
positionEC.xyz = vec3(0.0, 0.0, 1.0);
}
#endif
gl_Position = czm_projection * positionEC;
czm_vertexLogDepth();
#ifdef DISABLE_DEPTH_DISTANCE
float disableDepthTestDistance = distanceDisplayConditionAndDisableDepth.z;
if (disableDepthTestDistance == 0.0 && czm_minimumDisableDepthTestDistance != 0.0)
{
disableDepthTestDistance = czm_minimumDisableDepthTestDistance;
}
if (disableDepthTestDistance != 0.0)
{
float zclip = gl_Position.z / gl_Position.w;
bool clipped = (zclip < -1.0 || zclip > 1.0);
if (!clipped && (disableDepthTestDistance < 0.0 || (lengthSq > 0.0 && lengthSq < disableDepthTestDistance)))
{
gl_Position.z = -gl_Position.w;
#ifdef LOG_DEPTH
czm_vertexLogDepth(vec4(czm_currentFrustum.x));
#endif
}
}
#endif
v_color = color;
v_color.a *= translucency * show;
v_outlineColor = outlineColor;
v_outlineColor.a *= translucency * show;
v_innerPercent = 1.0 - outlinePercent;
v_pixelDistance = 2.0 / totalSize;
gl_PointSize = totalSize * show;
gl_Position *= show;
v_pickColor = pickColor;
}
`;var zGe=Fs.SHOW_INDEX,D6=Fs.POSITION_INDEX,Are=Fs.COLOR_INDEX,HGe=Fs.OUTLINE_COLOR_INDEX,GGe=Fs.OUTLINE_WIDTH_INDEX,WGe=Fs.PIXEL_SIZE_INDEX,Cre=Fs.SCALE_BY_DISTANCE_INDEX,xre=Fs.TRANSLUCENCY_BY_DISTANCE_INDEX,Tre=Fs.DISTANCE_DISPLAY_CONDITION_INDEX,jGe=Fs.DISABLE_DEPTH_DISTANCE_INDEX,v6=Fs.NUMBER_OF_PROPERTIES,Ma={positionHighAndSize:0,positionLowAndOutline:1,compressedAttribute0:2,compressedAttribute1:3,scaleByDistance:4,distanceDisplayConditionAndDisableDepth:5};function ku(t){t=A(t,A.EMPTY_OBJECT),this._sp=void 0,this._spTranslucent=void 0,this._rsOpaque=void 0,this._rsTranslucent=void 0,this._vaf=void 0,this._pointPrimitives=[],this._pointPrimitivesToUpdate=[],this._pointPrimitivesToUpdateIndex=0,this._pointPrimitivesRemoved=!1,this._createVertexArray=!1,this._shaderScaleByDistance=!1,this._compiledShaderScaleByDistance=!1,this._shaderTranslucencyByDistance=!1,this._compiledShaderTranslucencyByDistance=!1,this._shaderDistanceDisplayCondition=!1,this._compiledShaderDistanceDisplayCondition=!1,this._shaderDisableDepthDistance=!1,this._compiledShaderDisableDepthDistance=!1,this._propertiesChanged=new Uint32Array(v6),this._maxPixelSize=1,this._baseVolume=new ae,this._baseVolumeWC=new ae,this._baseVolume2D=new ae,this._boundingVolume=new ae,this._boundingVolumeDirty=!1,this._colorCommands=[],this.show=A(t.show,!0),this.modelMatrix=N.clone(A(t.modelMatrix,N.IDENTITY)),this._modelMatrix=N.clone(N.IDENTITY),this.debugShowBoundingVolume=A(t.debugShowBoundingVolume,!1),this.blendOption=A(t.blendOption,bo.OPAQUE_AND_TRANSLUCENT),this._blendOption=void 0,this._mode=ne.SCENE3D,this._maxTotalPointSize=1,this._buffersUsage=[Fe.STATIC_DRAW,Fe.STATIC_DRAW,Fe.STATIC_DRAW,Fe.STATIC_DRAW,Fe.STATIC_DRAW,Fe.STATIC_DRAW,Fe.STATIC_DRAW,Fe.STATIC_DRAW,Fe.STATIC_DRAW];let n=this;this._uniforms={u_maxTotalPointSize:function(){return n._maxTotalPointSize}}}Object.defineProperties(ku.prototype,{length:{get:function(){return P6(this),this._pointPrimitives.length}}});function Ere(t){let n=t.length;for(let i=0;i<n;++i)t[i]&&t[i]._destroy()}ku.prototype.add=function(t){let n=new Fs(t,this);return n._index=this._pointPrimitives.length,this._pointPrimitives.push(n),this._createVertexArray=!0,n};ku.prototype.remove=function(t){return this.contains(t)?(this._pointPrimitives[t._index]=null,this._pointPrimitivesRemoved=!0,this._createVertexArray=!0,t._destroy(),!0):!1};ku.prototype.removeAll=function(){Ere(this._pointPrimitives),this._pointPrimitives=[],this._pointPrimitivesToUpdate=[],this._pointPrimitivesToUpdateIndex=0,this._pointPrimitivesRemoved=!1,this._createVertexArray=!0};function P6(t){if(t._pointPrimitivesRemoved){t._pointPrimitivesRemoved=!1;let n=[],i=t._pointPrimitives,o=i.length;for(let r=0,s=0;r<o;++r){let a=i[r];a&&(a._index=s++,n.push(a))}t._pointPrimitives=n}}ku.prototype._updatePointPrimitive=function(t,n){t._dirty||(this._pointPrimitivesToUpdate[this._pointPrimitivesToUpdateIndex++]=t),++this._propertiesChanged[n]};ku.prototype.contains=function(t){return f(t)&&t._pointPrimitiveCollection===this};ku.prototype.get=function(t){return P6(this),this._pointPrimitives[t]};ku.prototype.computeNewBuffersUsage=function(){let t=this._buffersUsage,n=!1,i=this._propertiesChanged;for(let o=0;o<v6;++o){let r=i[o]===0?Fe.STATIC_DRAW:Fe.STREAM_DRAW;n=n||t[o]!==r,t[o]=r}return n};function qGe(t,n,i){return new I_(t,[{index:Ma.positionHighAndSize,componentsPerAttribute:4,componentDatatype:J.FLOAT,usage:i[D6]},{index:Ma.positionLowAndShow,componentsPerAttribute:4,componentDatatype:J.FLOAT,usage:i[D6]},{index:Ma.compressedAttribute0,componentsPerAttribute:4,componentDatatype:J.FLOAT,usage:i[Are]},{index:Ma.compressedAttribute1,componentsPerAttribute:4,componentDatatype:J.FLOAT,usage:i[xre]},{index:Ma.scaleByDistance,componentsPerAttribute:4,componentDatatype:J.FLOAT,usage:i[Cre]},{index:Ma.distanceDisplayConditionAndDisableDepth,componentsPerAttribute:3,componentDatatype:J.FLOAT,usage:i[Tre]}],n)}var S6=new Hn;function bre(t,n,i,o){let r=o._index,s=o._getActualPosition();t._mode===ne.SCENE3D&&(ae.expand(t._baseVolume,s,t._baseVolume),t._boundingVolumeDirty=!0),Hn.fromCartesian(s,S6);let a=o.pixelSize,c=o.outlineWidth;t._maxPixelSize=Math.max(t._maxPixelSize,a+c);let l=i[Ma.positionHighAndSize],u=S6.high;l(r,u.x,u.y,u.z,a);let d=i[Ma.positionLowAndOutline],h=S6.low;d(r,h.x,h.y,h.z,c)}var $F=65536,Fw=256;function Sre(t,n,i,o){let r=o._index,s=o.color,a=o.getPickId(n).color,c=o.outlineColor,l=z.floatToByte(s.red),u=z.floatToByte(s.green),d=z.floatToByte(s.blue),h=l*$F+u*Fw+d;l=z.floatToByte(c.red),u=z.floatToByte(c.green),d=z.floatToByte(c.blue);let _=l*$F+u*Fw+d;l=z.floatToByte(a.red),u=z.floatToByte(a.green),d=z.floatToByte(a.blue);let y=l*$F+u*Fw+d,p=z.floatToByte(s.alpha)*$F+z.floatToByte(c.alpha)*Fw+z.floatToByte(a.alpha),C=i[Ma.compressedAttribute0];C(r,h,_,y,p)}function wre(t,n,i,o){let r=o._index,s=0,a=1,c=1,l=1,u=o.translucencyByDistance;f(u)&&(s=u.near,a=u.nearValue,c=u.far,l=u.farValue,(a!==1||l!==1)&&(t._shaderTranslucencyByDistance=!0));let d=o.show&&o.clusterShow;o.color.alpha===0&&o.outlineColor.alpha===0&&(d=!1),a=B.clamp(a,0,1),a=a===1?255:a*255|0;let h=(d?1:0)*Fw+a;l=B.clamp(l,0,1),l=l===1?255:l*255|0;let _=l,y=i[Ma.compressedAttribute1];y(r,h,_,s,c)}function Dre(t,n,i,o){let r=o._index,s=i[Ma.scaleByDistance],a=0,c=1,l=1,u=1,d=o.scaleByDistance;f(d)&&(a=d.near,c=d.nearValue,l=d.far,u=d.farValue,(c!==1||u!==1)&&(t._shaderScaleByDistance=!0)),s(r,a,c,l,u)}function vre(t,n,i,o){let r=o._index,s=i[Ma.distanceDisplayConditionAndDisableDepth],a=0,c=Number.MAX_VALUE,l=o.distanceDisplayCondition;f(l)&&(a=l.near,c=l.far,a*=a,c*=c,t._shaderDistanceDisplayCondition=!0);let u=o.disableDepthTestDistance;u*=u,u>0&&(t._shaderDisableDepthDistance=!0,u===Number.POSITIVE_INFINITY&&(u=-1)),s(r,a,c,u)}function YGe(t,n,i,o){bre(t,n,i,o),Sre(t,n,i,o),wre(t,n,i,o),Dre(t,n,i,o),vre(t,n,i,o)}function w6(t,n,i,o,r,s){let a;o.mode===ne.SCENE3D?(a=t._baseVolume,t._boundingVolumeDirty=!0):a=t._baseVolume2D;let c=[];for(let l=0;l<i;++l){let u=n[l],d=u.position,h=Fs._computeActualPosition(d,o,r);f(h)&&(u._setActualPosition(h),s?c.push(h):ae.expand(a,h,a))}s&&ae.fromPoints(c,a)}function XGe(t,n){let i=n.mode,o=t._pointPrimitives,r=t._pointPrimitivesToUpdate,s=t._modelMatrix;t._createVertexArray||t._mode!==i||i!==ne.SCENE3D&&!N.equals(s,t.modelMatrix)?(t._mode=i,N.clone(t.modelMatrix,s),t._createVertexArray=!0,(i===ne.SCENE3D||i===ne.SCENE2D||i===ne.COLUMBUS_VIEW)&&w6(t,o,o.length,n,s,!0)):i===ne.MORPHING?w6(t,o,o.length,n,s,!0):(i===ne.SCENE2D||i===ne.COLUMBUS_VIEW)&&w6(t,r,t._pointPrimitivesToUpdateIndex,n,s,!1)}function KGe(t,n,i){let r=n.camera.getPixelSize(i,n.context.drawingBufferWidth,n.context.drawingBufferHeight)*t._maxPixelSize;i.radius+=r}var JGe=[];ku.prototype.update=function(t){if(P6(this),!this.show)return;this._maxTotalPointSize=Ut.maximumAliasedPointSize,XGe(this,t);let i=this._pointPrimitives.length,o=this._pointPrimitivesToUpdate,r=this._pointPrimitivesToUpdateIndex,s=this._propertiesChanged,a=this._createVertexArray,c,l=t.context,u=t.passes,d=u.pick;if(a||!d&&this.computeNewBuffersUsage()){this._createVertexArray=!1;for(let D=0;D<v6;++D)s[D]=0;if(this._vaf=this._vaf&&this._vaf.destroy(),i>0){this._vaf=qGe(l,i,this._buffersUsage),c=this._vaf.writers;for(let D=0;D<i;++D){let I=this._pointPrimitives[D];I._dirty=!1,YGe(this,l,c,I)}this._vaf.commit()}this._pointPrimitivesToUpdateIndex=0}else if(r>0){let D=JGe;D.length=0,(s[D6]||s[GGe]||s[WGe])&&D.push(bre),(s[Are]||s[HGe])&&D.push(Sre),(s[zGe]||s[xre])&&D.push(wre),s[Cre]&&D.push(Dre),(s[Tre]||s[jGe])&&D.push(vre);let I=D.length;if(c=this._vaf.writers,r/i>.1){for(let O=0;O<r;++O){let M=o[O];M._dirty=!1;for(let L=0;L<I;++L)D[L](this,l,c,M)}this._vaf.commit()}else{for(let O=0;O<r;++O){let M=o[O];M._dirty=!1;for(let L=0;L<I;++L)D[L](this,l,c,M);this._vaf.subCommit(M._index,1)}this._vaf.endSubCommits()}this._pointPrimitivesToUpdateIndex=0}if(r>i*1.5&&(o.length=i),!f(this._vaf)||!f(this._vaf.va))return;this._boundingVolumeDirty&&(this._boundingVolumeDirty=!1,ae.transform(this._baseVolume,this.modelMatrix,this._baseVolumeWC));let h,_=N.IDENTITY;t.mode===ne.SCENE3D?(_=this.modelMatrix,h=ae.clone(this._baseVolumeWC,this._boundingVolume)):h=ae.clone(this._baseVolume2D,this._boundingVolume),KGe(this,t,h);let y=this._blendOption!==this.blendOption;this._blendOption=this.blendOption,y&&(this._blendOption===bo.OPAQUE||this._blendOption===bo.OPAQUE_AND_TRANSLUCENT?this._rsOpaque=Ve.fromCache({depthTest:{enabled:!0,func:ee.LEQUAL},depthMask:!0}):this._rsOpaque=void 0,this._blendOption===bo.TRANSLUCENT||this._blendOption===bo.OPAQUE_AND_TRANSLUCENT?this._rsTranslucent=Ve.fromCache({depthTest:{enabled:!0,func:ee.LEQUAL},depthMask:!1,blending:ln.ALPHA_BLEND}):this._rsTranslucent=void 0),this._shaderDisableDepthDistance=this._shaderDisableDepthDistance||t.minimumDisableDepthTestDistance!==0;let p,C;(y||this._shaderScaleByDistance&&!this._compiledShaderScaleByDistance||this._shaderTranslucencyByDistance&&!this._compiledShaderTranslucencyByDistance||this._shaderDistanceDisplayCondition&&!this._compiledShaderDistanceDisplayCondition||this._shaderDisableDepthDistance!==this._compiledShaderDisableDepthDistance)&&(p=new ze({sources:[QF]}),this._shaderScaleByDistance&&p.defines.push("EYE_DISTANCE_SCALING"),this._shaderTranslucencyByDistance&&p.defines.push("EYE_DISTANCE_TRANSLUCENCY"),this._shaderDistanceDisplayCondition&&p.defines.push("DISTANCE_DISPLAY_CONDITION"),this._shaderDisableDepthDistance&&p.defines.push("DISABLE_DEPTH_DISTANCE"),this._blendOption===bo.OPAQUE_AND_TRANSLUCENT&&(C=new ze({defines:["OPAQUE"],sources:[Py]}),this._sp=qt.replaceCache({context:l,shaderProgram:this._sp,vertexShaderSource:p,fragmentShaderSource:C,attributeLocations:Ma}),C=new ze({defines:["TRANSLUCENT"],sources:[Py]}),this._spTranslucent=qt.replaceCache({context:l,shaderProgram:this._spTranslucent,vertexShaderSource:p,fragmentShaderSource:C,attributeLocations:Ma})),this._blendOption===bo.OPAQUE&&(C=new ze({sources:[Py]}),this._sp=qt.replaceCache({context:l,shaderProgram:this._sp,vertexShaderSource:p,fragmentShaderSource:C,attributeLocations:Ma})),this._blendOption===bo.TRANSLUCENT&&(C=new ze({sources:[Py]}),this._spTranslucent=qt.replaceCache({context:l,shaderProgram:this._spTranslucent,vertexShaderSource:p,fragmentShaderSource:C,attributeLocations:Ma})),this._compiledShaderScaleByDistance=this._shaderScaleByDistance,this._compiledShaderTranslucencyByDistance=this._shaderTranslucencyByDistance,this._compiledShaderDistanceDisplayCondition=this._shaderDistanceDisplayCondition,this._compiledShaderDisableDepthDistance=this._shaderDisableDepthDistance);let x,T,E,S,w=t.commandList;if(u.render||d){let D=this._colorCommands,I=this._blendOption===bo.OPAQUE,O=this._blendOption===bo.OPAQUE_AND_TRANSLUCENT;x=this._vaf.va,T=x.length,D.length=T;let M=O?T*2:T;for(S=0;S<M;++S){let L=I||O&&S%2===0;E=D[S],f(E)||(E=D[S]=new et),E.primitiveType=Re.POINTS,E.pass=L||!O?Te.OPAQUE:Te.TRANSLUCENT,E.owner=this;let F=O?Math.floor(S/2):S;E.boundingVolume=h,E.modelMatrix=_,E.shaderProgram=L?this._sp:this._spTranslucent,E.uniformMap=this._uniforms,E.vertexArray=x[F].va,E.renderState=L?this._rsOpaque:this._rsTranslucent,E.debugShowBoundingVolume=this.debugShowBoundingVolume,E.pickId="v_pickColor",w.push(E)}}};ku.prototype.isDestroyed=function(){return!1};ku.prototype.destroy=function(){return this._sp=this._sp&&this._sp.destroy(),this._spTranslucent=this._spTranslucent&&this._spTranslucent.destroy(),this._spPick=this._spPick&&this._spPick.destroy(),this._vaf=this._vaf&&this._vaf.destroy(),Ere(this._pointPrimitives),ue(this)};var Nw=ku;function kw(t,n,i,o,r,s){if(r-o<=i)return;let a=o+r>>1;Pre(t,n,a,o,r,s%2),kw(t,n,i,o,a-1,s+1),kw(t,n,i,a+1,r,s+1)}function Pre(t,n,i,o,r,s){for(;r>o;){if(r-o>600){let u=r-o+1,d=i-o+1,h=Math.log(u),_=.5*Math.exp(2*h/3),y=.5*Math.sqrt(h*_*(u-_)/u)*(d-u/2<0?-1:1),p=Math.max(o,Math.floor(i-d*_/u+y)),C=Math.min(r,Math.floor(i+(u-d)*_/u+y));Pre(t,n,i,p,C,s)}let a=n[2*i+s],c=o,l=r;for(Vw(t,n,o,i),n[2*r+s]>a&&Vw(t,n,o,r);c<l;){for(Vw(t,n,c,l),c++,l--;n[2*c+s]<a;)c++;for(;n[2*l+s]>a;)l--}n[2*o+s]===a?Vw(t,n,o,l):(l++,Vw(t,n,l,r)),l<=i&&(o=l+1),i<=l&&(r=l-1)}}function Vw(t,n,i,o){I6(t,i,o),I6(n,2*i,2*o),I6(n,2*i+1,2*o+1)}function I6(t,n,i){let o=t[n];t[n]=t[i],t[i]=o}function B6(t,n,i,o,r,s,a){let c=[0,t.length-1,0],l=[],u,d;for(;c.length;){let h=c.pop(),_=c.pop(),y=c.pop();if(_-y<=a){for(let x=y;x<=_;x++)u=n[2*x],d=n[2*x+1],u>=i&&u<=r&&d>=o&&d<=s&&l.push(t[x]);continue}let p=Math.floor((y+_)/2);u=n[2*p],d=n[2*p+1],u>=i&&u<=r&&d>=o&&d<=s&&l.push(t[p]);let C=(h+1)%2;(h===0?i<=u:o<=d)&&(c.push(y),c.push(p-1),c.push(C)),(h===0?r>=u:s>=d)&&(c.push(p+1),c.push(_),c.push(C))}return l}function O6(t,n,i,o,r,s){let a=[0,t.length-1,0],c=[],l=r*r;for(;a.length;){let u=a.pop(),d=a.pop(),h=a.pop();if(d-h<=s){for(let x=h;x<=d;x++)Ire(n[2*x],n[2*x+1],i,o)<=l&&c.push(t[x]);continue}let _=Math.floor((h+d)/2),y=n[2*_],p=n[2*_+1];Ire(y,p,i,o)<=l&&c.push(t[_]);let C=(u+1)%2;(u===0?i-r<=y:o-r<=p)&&(a.push(h),a.push(_-1),a.push(C)),(u===0?i+r>=y:o+r>=p)&&(a.push(_+1),a.push(d),a.push(C))}return c}function Ire(t,n,i,o){let r=t-i,s=n-o;return r*r+s*s}var ZGe=t=>t[0],QGe=t=>t[1],Uw=class{constructor(n,i=ZGe,o=QGe,r=64,s=Float64Array){this.nodeSize=r,this.points=n;let a=n.length<65536?Uint16Array:Uint32Array,c=this.ids=new a(n.length),l=this.coords=new s(n.length*2);for(let u=0;u<n.length;u++)c[u]=u,l[2*u]=i(n[u]),l[2*u+1]=o(n[u]);kw(c,l,r,0,c.length-1,0)}range(n,i,o,r){return B6(this.ids,this.coords,n,i,o,r,this.nodeSize)}within(n,i,o){return O6(this.ids,this.coords,n,i,o,this.nodeSize)}};function Yf(t){t=A(t,A.EMPTY_OBJECT),this._enabled=A(t.enabled,!1),this._pixelRange=A(t.pixelRange,80),this._minimumClusterSize=A(t.minimumClusterSize,2),this._clusterBillboards=A(t.clusterBillboards,!0),this._clusterLabels=A(t.clusterLabels,!0),this._clusterPoints=A(t.clusterPoints,!0),this._labelCollection=void 0,this._billboardCollection=void 0,this._pointCollection=void 0,this._clusterBillboardCollection=void 0,this._clusterLabelCollection=void 0,this._clusterPointCollection=void 0,this._collectionIndicesByEntity={},this._unusedLabelIndices=[],this._unusedBillboardIndices=[],this._unusedPointIndices=[],this._previousClusters=[],this._previousHeight=void 0,this._enabledDirty=!1,this._clusterDirty=!1,this._cluster=void 0,this._removeEventListener=void 0,this._clusterEvent=new Ae,this.show=A(t.show,!0)}function $Ge(t){return t.coord.x}function e5e(t){return t.coord.y}function Bre(t,n){t.x-=n,t.y-=n,t.width+=n*2,t.height+=n*2}var t5e=new He;function Ore(t,n,i,o,r){if(f(t._labelCollection)&&o._clusterLabels?r=hy.getScreenSpaceBoundingBox(t,n,r):f(t._billboardCollection)&&o._clusterBillboards?r=ho.getScreenSpaceBoundingBox(t,n,r):f(t._pointPrimitiveCollection)&&o._clusterPoints&&(r=Fs.getScreenSpaceBoundingBox(t,n,r)),Bre(r,i),o._clusterLabels&&!f(t._labelCollection)&&f(t.id)&&Mre(o,t.id.id)&&f(t.id._label)){let s=o._collectionIndicesByEntity[t.id.id].labelIndex,a=o._labelCollection.get(s),c=hy.getScreenSpaceBoundingBox(a,n,t5e);Bre(c,i),r=He.union(r,c,r)}return r}function n5e(t,n){if(t.clusterShow=!0,!f(t._labelCollection)&&f(t.id)&&Mre(n,t.id.id)&&f(t.id._label)){let i=n._collectionIndicesByEntity[t.id.id].labelIndex,o=n._labelCollection.get(i);o.clusterShow=!0}}function Rre(t,n,i,o){let r={billboard:o._clusterBillboardCollection.add(),label:o._clusterLabelCollection.add(),point:o._clusterPointCollection.add()};r.billboard.show=!1,r.point.show=!1,r.label.show=!0,r.label.text=n.toLocaleString(),r.label.id=i,r.billboard.position=r.label.position=r.point.position=t,o._clusterEvent.raiseEvent(i,r)}function Mre(t,n){return f(t)&&f(t._collectionIndicesByEntity[n])&&f(t._collectionIndicesByEntity[n].labelIndex)}function R6(t,n,i,o,r){if(!f(t))return;let s=t.length;for(let a=0;a<s;++a){let c=t.get(a);if(c.clusterShow=!1,!c.show||r._scene.mode===ne.SCENE3D&&!o.isPointVisible(c.position))continue;let l=r._clusterLabels&&f(c._labelCollection),u=r._clusterBillboards&&f(c.id._billboard),d=r._clusterPoints&&f(c.id._point);if(l&&(d||u))continue;let h=c.computeScreenSpacePosition(i);!f(h)||n.push({index:a,collection:t,clustered:!1,coord:h})}}var i5e=new He,o5e=new He,r5e=new He;function s5e(t){return function(n){if(f(n)&&n<.05||!t.enabled)return;let i=t._scene,o=t._labelCollection,r=t._billboardCollection,s=t._pointCollection;if(!f(o)&&!f(r)&&!f(s)||!t._clusterBillboards&&!t._clusterLabels&&!t._clusterPoints)return;let a=t._clusterLabelCollection,c=t._clusterBillboardCollection,l=t._clusterPointCollection;f(a)?a.removeAll():a=t._clusterLabelCollection=new jm({scene:i}),f(c)?c.removeAll():c=t._clusterBillboardCollection=new vu({scene:i}),f(l)?l.removeAll():l=t._clusterPointCollection=new Nw;let u=t._pixelRange,d=t._minimumClusterSize,h=t._previousClusters,_=[],y=t._previousHeight,p=i.camera.positionCartographic.height,C=i.mapProjection.ellipsoid,x=i.camera.positionWC,T=new Q_(C,x),E=[];t._clusterLabels&&R6(o,E,i,T,t),t._clusterBillboards&&R6(r,E,i,T,t),t._clusterPoints&&R6(s,E,i,T,t);let S,w,D,I,O,M,L,F,g,b,v,P,R=new Uw(E,$Ge,e5e,64,Int32Array);if(p<y)for(D=h.length,S=0;S<D;++S){let V=h[S];if(!T.isPointVisible(V.position))continue;let H=ho._computeScreenSpacePosition(N.IDENTITY,V.position,m.ZERO,W.ZERO,i);if(!f(H))continue;let U=1-p/y,G=V.width=V.width*U,k=V.height=V.height*U;G=Math.max(G,V.minimumWidth),k=Math.max(k,V.minimumHeight);let X=H.x-G*.5,Y=H.y-k*.5,K=H.x+G,j=H.y+k;for(O=R.range(X,Y,K,j),M=O.length,b=0,g=[],w=0;w<M;++w)L=O[w],F=E[L],F.clustered||(++b,v=F.collection,P=F.index,g.push(v.get(P).id));if(b>=d)for(Rre(V.position,b,g,t),_.push(V),w=0;w<M;++w)E[O[w]].clustered=!0}for(D=E.length,S=0;S<D;++S){let V=E[S];if(V.clustered)continue;V.clustered=!0,v=V.collection,P=V.index;let H=v.get(P);I=Ore(H,V.coord,u,t,i5e);let U=He.clone(I,o5e);O=R.range(I.x,I.y,I.x+I.width,I.y+I.height),M=O.length;let G=m.clone(H.position);for(b=1,g=[H.id],w=0;w<M;++w)if(L=O[w],F=E[L],!F.clustered){let k=F.collection.get(F.index),X=Ore(k,F.coord,u,t,r5e);m.add(k.position,G,G),He.union(U,X,U),++b,g.push(k.id)}if(b>=d){let k=m.multiplyByScalar(G,1/b,G);for(Rre(k,b,g,t),_.push({position:k,width:U.width,height:U.height,minimumWidth:I.width,minimumHeight:I.height}),w=0;w<M;++w)E[O[w]].clustered=!0}else n5e(H,t)}a.length===0&&(a.destroy(),t._clusterLabelCollection=void 0),c.length===0&&(c.destroy(),t._clusterBillboardCollection=void 0),l.length===0&&(l.destroy(),t._clusterPointCollection=void 0),t._previousClusters=_,t._previousHeight=p}}Yf.prototype._initialize=function(t){this._scene=t;let n=s5e(this);this._cluster=n,this._removeEventListener=t.camera.changed.addEventListener(n)};Object.defineProperties(Yf.prototype,{enabled:{get:function(){return this._enabled},set:function(t){this._enabledDirty=t!==this._enabled,this._enabled=t}},pixelRange:{get:function(){return this._pixelRange},set:function(t){this._clusterDirty=this._clusterDirty||t!==this._pixelRange,this._pixelRange=t}},minimumClusterSize:{get:function(){return this._minimumClusterSize},set:function(t){this._clusterDirty=this._clusterDirty||t!==this._minimumClusterSize,this._minimumClusterSize=t}},clusterEvent:{get:function(){return this._clusterEvent}},clusterBillboards:{get:function(){return this._clusterBillboards},set:function(t){this._clusterDirty=this._clusterDirty||t!==this._clusterBillboards,this._clusterBillboards=t}},clusterLabels:{get:function(){return this._clusterLabels},set:function(t){this._clusterDirty=this._clusterDirty||t!==this._clusterLabels,this._clusterLabels=t}},clusterPoints:{get:function(){return this._clusterPoints},set:function(t){this._clusterDirty=this._clusterDirty||t!==this._clusterPoints,this._clusterPoints=t}}});function L6(t,n,i,o){return function(r){let s=this[t];f(this._collectionIndicesByEntity)||(this._collectionIndicesByEntity={});let a=this._collectionIndicesByEntity[r.id];if(f(a)||(a=this._collectionIndicesByEntity[r.id]={billboardIndex:void 0,labelIndex:void 0,pointIndex:void 0}),f(s)&&f(a[o]))return s.get(a[o]);f(s)||(s=this[t]=new n({scene:this._scene}));let c,l,u=this[i];u.length>0?(c=u.pop(),l=s.get(c)):(l=s.add(),c=s.length-1),a[o]=c;let d=this;return Promise.resolve().then(function(){d._clusterDirty=!0}),l}}function F6(t,n){let i=t._collectionIndicesByEntity[n];!f(i.billboardIndex)&&!f(i.labelIndex)&&!f(i.pointIndex)&&delete t._collectionIndicesByEntity[n]}Yf.prototype.getLabel=L6("_labelCollection",jm,"_unusedLabelIndices","labelIndex");Yf.prototype.removeLabel=function(t){let n=this._collectionIndicesByEntity&&this._collectionIndicesByEntity[t.id];if(!f(this._labelCollection)||!f(n)||!f(n.labelIndex))return;let i=n.labelIndex;n.labelIndex=void 0,F6(this,t.id);let o=this._labelCollection.get(i);o.show=!1,o.text="",o.id=void 0,this._unusedLabelIndices.push(i),this._clusterDirty=!0};Yf.prototype.getBillboard=L6("_billboardCollection",vu,"_unusedBillboardIndices","billboardIndex");Yf.prototype.removeBillboard=function(t){let n=this._collectionIndicesByEntity&&this._collectionIndicesByEntity[t.id];if(!f(this._billboardCollection)||!f(n)||!f(n.billboardIndex))return;let i=n.billboardIndex;n.billboardIndex=void 0,F6(this,t.id);let o=this._billboardCollection.get(i);o.id=void 0,o.show=!1,o.image=void 0,this._unusedBillboardIndices.push(i),this._clusterDirty=!0};Yf.prototype.getPoint=L6("_pointCollection",Nw,"_unusedPointIndices","pointIndex");Yf.prototype.removePoint=function(t){let n=this._collectionIndicesByEntity&&this._collectionIndicesByEntity[t.id];if(!f(this._pointCollection)||!f(n)||!f(n.pointIndex))return;let i=n.pointIndex;n.pointIndex=void 0,F6(this,t.id);let o=this._pointCollection.get(i);o.show=!1,o.id=void 0,this._unusedPointIndices.push(i),this._clusterDirty=!0};function M6(t){if(!f(t))return;let n=t.length;for(let i=0;i<n;++i)t.get(i).clusterShow=!0}function a5e(t){t.enabled||(f(t._clusterLabelCollection)&&t._clusterLabelCollection.destroy(),f(t._clusterBillboardCollection)&&t._clusterBillboardCollection.destroy(),f(t._clusterPointCollection)&&t._clusterPointCollection.destroy(),t._clusterLabelCollection=void 0,t._clusterBillboardCollection=void 0,t._clusterPointCollection=void 0,M6(t._labelCollection),M6(t._billboardCollection),M6(t._pointCollection))}Yf.prototype.update=function(t){if(!this.show)return;let n;f(this._labelCollection)&&this._labelCollection.length>0&&this._labelCollection.get(0)._glyphs.length===0&&(n=t.commandList,t.commandList=[],this._labelCollection.update(t),t.commandList=n),f(this._billboardCollection)&&this._billboardCollection.length>0&&!f(this._billboardCollection.get(0).width)&&(n=t.commandList,t.commandList=[],this._billboardCollection.update(t),t.commandList=n),this._enabledDirty&&(this._enabledDirty=!1,a5e(this),this._clusterDirty=!0),this._clusterDirty&&(this._clusterDirty=!1,this._cluster()),f(this._clusterLabelCollection)&&this._clusterLabelCollection.update(t),f(this._clusterBillboardCollection)&&this._clusterBillboardCollection.update(t),f(this._clusterPointCollection)&&this._clusterPointCollection.update(t),f(this._labelCollection)&&this._labelCollection.update(t),f(this._billboardCollection)&&this._billboardCollection.update(t),f(this._pointCollection)&&this._pointCollection.update(t)};Yf.prototype.destroy=function(){this._labelCollection=this._labelCollection&&this._labelCollection.destroy(),this._billboardCollection=this._billboardCollection&&this._billboardCollection.destroy(),this._pointCollection=this._pointCollection&&this._pointCollection.destroy(),this._clusterLabelCollection=this._clusterLabelCollection&&this._clusterLabelCollection.destroy(),this._clusterBillboardCollection=this._clusterBillboardCollection&&this._clusterBillboardCollection.destroy(),this._clusterPointCollection=this._clusterPointCollection&&this._clusterPointCollection.destroy(),f(this._removeEventListener)&&(this._removeEventListener(),this._removeEventListener=void 0),this._labelCollection=void 0,this._billboardCollection=void 0,this._pointCollection=void 0,this._clusterBillboardCollection=void 0,this._clusterLabelCollection=void 0,this._clusterPointCollection=void 0,this._collectionIndicesByEntity=void 0,this._unusedLabelIndices=[],this._unusedBillboardIndices=[],this._unusedPointIndices=[],this._previousClusters=[],this._previousHeight=void 0,this._enabledDirty=!1,this._pixelRangeDirty=!1,this._minimumClusterSizeDirty=!1};var Uu=Yf;function N6(t){this._name=t,this._clock=void 0,this._changed=new Ae,this._error=new Ae,this._isLoading=!1,this._loading=new Ae,this._entityCollection=new Ms(this),this._entityCluster=new Uu}Object.defineProperties(N6.prototype,{name:{get:function(){return this._name},set:function(t){this._name!==t&&(this._name=t,this._changed.raiseEvent(this))}},clock:{get:function(){return this._clock},set:function(t){this._clock!==t&&(this._clock=t,this._changed.raiseEvent(this))}},entities:{get:function(){return this._entityCollection}},isLoading:{get:function(){return this._isLoading},set:function(t){Fr.setLoading(this,t)}},changedEvent:{get:function(){return this._changed}},errorEvent:{get:function(){return this._error}},loadingEvent:{get:function(){return this._loading}},show:{get:function(){return this._entityCollection.show},set:function(t){this._entityCollection.show=t}},clustering:{get:function(){return this._entityCluster},set:function(t){this._entityCluster=t}}});N6.prototype.update=function(t){return!0};var eN=N6;var Lre={};Lre.computePositions=function(t,n,i,o,r){let s=t*.5,a=-s,c=o+o,l=r?2*c:c,u=new Float64Array(l*3),d,h=0,_=0,y=r?c*3:0,p=r?(c+o)*3:o*3;for(d=0;d<o;d++){let C=d/o*B.TWO_PI,x=Math.cos(C),T=Math.sin(C),E=x*i,S=T*i,w=x*n,D=T*n;u[_+y]=E,u[_+y+1]=S,u[_+y+2]=a,u[_+p]=w,u[_+p+1]=D,u[_+p+2]=s,_+=3,r&&(u[h++]=E,u[h++]=S,u[h++]=a,u[h++]=w,u[h++]=D,u[h++]=s)}return u};var sT=Lre;var V6=new W,c5e=new m,l5e=new m,u5e=new m,f5e=new m;function ap(t){t=A(t,A.EMPTY_OBJECT);let n=t.length,i=t.topRadius,o=t.bottomRadius,r=A(t.vertexFormat,De.DEFAULT),s=A(t.slices,128);this._length=n,this._topRadius=i,this._bottomRadius=o,this._vertexFormat=De.clone(r),this._slices=s,this._offsetAttribute=t.offsetAttribute,this._workerName="createCylinderGeometry"}ap.packedLength=De.packedLength+5;ap.pack=function(t,n,i){return i=A(i,0),De.pack(t._vertexFormat,n,i),i+=De.packedLength,n[i++]=t._length,n[i++]=t._topRadius,n[i++]=t._bottomRadius,n[i++]=t._slices,n[i]=A(t._offsetAttribute,-1),n};var Fre=new De,aT={vertexFormat:Fre,length:void 0,topRadius:void 0,bottomRadius:void 0,slices:void 0,offsetAttribute:void 0};ap.unpack=function(t,n,i){n=A(n,0);let o=De.unpack(t,n,Fre);n+=De.packedLength;let r=t[n++],s=t[n++],a=t[n++],c=t[n++],l=t[n];return f(i)?(i._vertexFormat=De.clone(o,i._vertexFormat),i._length=r,i._topRadius=s,i._bottomRadius=a,i._slices=c,i._offsetAttribute=l===-1?void 0:l,i):(aT.length=r,aT.topRadius=s,aT.bottomRadius=a,aT.slices=c,aT.offsetAttribute=l===-1?void 0:l,new ap(aT))};ap.createGeometry=function(t){let n=t._length,i=t._topRadius,o=t._bottomRadius,r=t._vertexFormat,s=t._slices;if(n<=0||i<0||o<0||i===0&&o===0)return;let a=s+s,c=s+a,l=a+a,u=sT.computePositions(n,i,o,s,!0),d=r.st?new Float32Array(l*2):void 0,h=r.normal?new Float32Array(l*3):void 0,_=r.tangent?new Float32Array(l*3):void 0,y=r.bitangent?new Float32Array(l*3):void 0,p,C=r.normal||r.tangent||r.bitangent;if(C){let O=r.tangent||r.bitangent,M=0,L=0,F=0,g=Math.atan2(o-i,n),b=c5e;b.z=Math.sin(g);let v=Math.cos(g),P=u5e,R=l5e;for(p=0;p<s;p++){let V=p/s*B.TWO_PI,H=v*Math.cos(V),U=v*Math.sin(V);C&&(b.x=H,b.y=U,O&&(P=m.normalize(m.cross(m.UNIT_Z,b,P),P)),r.normal&&(h[M++]=b.x,h[M++]=b.y,h[M++]=b.z,h[M++]=b.x,h[M++]=b.y,h[M++]=b.z),r.tangent&&(_[L++]=P.x,_[L++]=P.y,_[L++]=P.z,_[L++]=P.x,_[L++]=P.y,_[L++]=P.z),r.bitangent&&(R=m.normalize(m.cross(b,P,R),R),y[F++]=R.x,y[F++]=R.y,y[F++]=R.z,y[F++]=R.x,y[F++]=R.y,y[F++]=R.z))}for(p=0;p<s;p++)r.normal&&(h[M++]=0,h[M++]=0,h[M++]=-1),r.tangent&&(_[L++]=1,_[L++]=0,_[L++]=0),r.bitangent&&(y[F++]=0,y[F++]=-1,y[F++]=0);for(p=0;p<s;p++)r.normal&&(h[M++]=0,h[M++]=0,h[M++]=1),r.tangent&&(_[L++]=1,_[L++]=0,_[L++]=0),r.bitangent&&(y[F++]=0,y[F++]=1,y[F++]=0)}let x=12*s-12,T=Ne.createTypedArray(l,x),E=0,S=0;for(p=0;p<s-1;p++)T[E++]=S,T[E++]=S+2,T[E++]=S+3,T[E++]=S,T[E++]=S+3,T[E++]=S+1,S+=2;for(T[E++]=a-2,T[E++]=0,T[E++]=1,T[E++]=a-2,T[E++]=1,T[E++]=a-1,p=1;p<s-1;p++)T[E++]=a+p+1,T[E++]=a+p,T[E++]=a;for(p=1;p<s-1;p++)T[E++]=c,T[E++]=c+p,T[E++]=c+p+1;let w=0;if(r.st){let O=Math.max(i,o);for(p=0;p<l;p++){let M=m.fromArray(u,p*3,f5e);d[w++]=(M.x+O)/(2*O),d[w++]=(M.y+O)/(2*O)}}let D=new cn;r.position&&(D.position=new we({componentDatatype:J.DOUBLE,componentsPerAttribute:3,values:u})),r.normal&&(D.normal=new we({componentDatatype:J.FLOAT,componentsPerAttribute:3,values:h})),r.tangent&&(D.tangent=new we({componentDatatype:J.FLOAT,componentsPerAttribute:3,values:_})),r.bitangent&&(D.bitangent=new we({componentDatatype:J.FLOAT,componentsPerAttribute:3,values:y})),r.st&&(D.st=new we({componentDatatype:J.FLOAT,componentsPerAttribute:2,values:d})),V6.x=n*.5,V6.y=Math.max(o,i);let I=new ae(m.ZERO,W.magnitude(V6));if(f(t._offsetAttribute)){n=u.length;let O=t._offsetAttribute===en.NONE?0:1,M=new Uint8Array(n/3).fill(O);D.applyOffset=new we({componentDatatype:J.UNSIGNED_BYTE,componentsPerAttribute:1,values:M})}return new at({attributes:D,indices:T,primitiveType:Re.TRIANGLES,boundingSphere:I,offsetAttribute:t._offsetAttribute})};var k6;ap.getUnitCylinder=function(){return f(k6)||(k6=ap.createGeometry(new ap({topRadius:1,bottomRadius:1,length:1,vertexFormat:De.POSITION_ONLY}))),k6};var tN=ap;var U6=new W;function cT(t){t=A(t,A.EMPTY_OBJECT);let n=t.length,i=t.topRadius,o=t.bottomRadius,r=A(t.slices,128),s=Math.max(A(t.numberOfVerticalLines,16),0);this._length=n,this._topRadius=i,this._bottomRadius=o,this._slices=r,this._numberOfVerticalLines=s,this._offsetAttribute=t.offsetAttribute,this._workerName="createCylinderOutlineGeometry"}cT.packedLength=6;cT.pack=function(t,n,i){return i=A(i,0),n[i++]=t._length,n[i++]=t._topRadius,n[i++]=t._bottomRadius,n[i++]=t._slices,n[i++]=t._numberOfVerticalLines,n[i]=A(t._offsetAttribute,-1),n};var Iy={length:void 0,topRadius:void 0,bottomRadius:void 0,slices:void 0,numberOfVerticalLines:void 0,offsetAttribute:void 0};cT.unpack=function(t,n,i){n=A(n,0);let o=t[n++],r=t[n++],s=t[n++],a=t[n++],c=t[n++],l=t[n];return f(i)?(i._length=o,i._topRadius=r,i._bottomRadius=s,i._slices=a,i._numberOfVerticalLines=c,i._offsetAttribute=l===-1?void 0:l,i):(Iy.length=o,Iy.topRadius=r,Iy.bottomRadius=s,Iy.slices=a,Iy.numberOfVerticalLines=c,Iy.offsetAttribute=l===-1?void 0:l,new cT(Iy))};cT.createGeometry=function(t){let n=t._length,i=t._topRadius,o=t._bottomRadius,r=t._slices,s=t._numberOfVerticalLines;if(n<=0||i<0||o<0||i===0&&o===0)return;let a=r*2,c=sT.computePositions(n,i,o,r,!1),l=r*2,u;if(s>0){let C=Math.min(s,r);u=Math.round(r/C),l+=C}let d=Ne.createTypedArray(a,l*2),h=0,_;for(_=0;_<r-1;_++)d[h++]=_,d[h++]=_+1,d[h++]=_+r,d[h++]=_+1+r;if(d[h++]=r-1,d[h++]=0,d[h++]=r+r-1,d[h++]=r,s>0)for(_=0;_<r;_+=u)d[h++]=_,d[h++]=_+r;let y=new cn;y.position=new we({componentDatatype:J.DOUBLE,componentsPerAttribute:3,values:c}),U6.x=n*.5,U6.y=Math.max(o,i);let p=new ae(m.ZERO,W.magnitude(U6));if(f(t._offsetAttribute)){n=c.length;let C=t._offsetAttribute===en.NONE?0:1,x=new Uint8Array(n/3).fill(C);y.applyOffset=new we({componentDatatype:J.UNSIGNED_BYTE,componentsPerAttribute:1,values:x})}return new at({attributes:y,indices:d,primitiveType:Re.LINES,boundingSphere:p,offsetAttribute:t._offsetAttribute})};var nN=cT;var Nre=m.ZERO,Vre=new m,d5e=new m,kre=new z;function h5e(t){this.id=t,this.vertexFormat=void 0,this.length=void 0,this.topRadius=void 0,this.bottomRadius=void 0,this.slices=void 0,this.numberOfVerticalLines=void 0,this.offsetAttribute=void 0}function Ml(t,n){ti.call(this,{entity:t,scene:n,geometryOptions:new h5e(t),geometryPropertyName:"cylinder",observedPropertyNames:["availability","position","orientation","cylinder"]}),this._onEntityPropertyChanged(t,"cylinder",t.cylinder,void 0)}f(Object.create)&&(Ml.prototype=Object.create(ti.prototype),Ml.prototype.constructor=Ml);Object.defineProperties(Ml.prototype,{terrainOffsetProperty:{get:function(){return this._terrainOffsetProperty}}});Ml.prototype.createFillGeometryInstance=function(t){let n=this._entity,i=n.isAvailable(t),o=new mn(i&&n.isShowing&&this._showProperty.getValue(t)&&this._fillProperty.getValue(t)),r=this._distanceDisplayConditionProperty.getValue(t),s=Vn.fromDistanceDisplayCondition(r),a={show:o,distanceDisplayCondition:s,color:void 0,offset:void 0};if(this._materialProperty instanceof Rt){let c;f(this._materialProperty.color)&&(this._materialProperty.color.isConstant||i)&&(c=this._materialProperty.color.getValue(t,kre)),f(c)||(c=z.WHITE),a.color=Lt.fromColor(c)}return f(this._options.offsetAttribute)&&(a.offset=Gi.fromCartesian3(q.getValueOrDefault(this._terrainOffsetProperty,t,Nre,Vre))),new Ct({id:n,geometry:new tN(this._options),modelMatrix:n.computeModelMatrixForHeightReference(t,n.cylinder.heightReference,this._options.length*.5,this._scene.mapProjection.ellipsoid),attributes:a})};Ml.prototype.createOutlineGeometryInstance=function(t){let n=this._entity,i=n.isAvailable(t),o=q.getValueOrDefault(this._outlineColorProperty,t,z.BLACK,kre),r=this._distanceDisplayConditionProperty.getValue(t),s={show:new mn(i&&n.isShowing&&this._showProperty.getValue(t)&&this._showOutlineProperty.getValue(t)),color:Lt.fromColor(o),distanceDisplayCondition:Vn.fromDistanceDisplayCondition(r),offset:void 0};return f(this._options.offsetAttribute)&&(s.offset=Gi.fromCartesian3(q.getValueOrDefault(this._terrainOffsetProperty,t,Nre,Vre))),new Ct({id:n,geometry:new nN(this._options),modelMatrix:n.computeModelMatrixForHeightReference(t,n.cylinder.heightReference,this._options.length*.5,this._scene.mapProjection.ellipsoid),attributes:s})};Ml.prototype._computeCenter=function(t,n){return q.getValueOrUndefined(this._entity.position,t,n)};Ml.prototype._isHidden=function(t,n){return!f(t.position)||!f(n.length)||!f(n.topRadius)||!f(n.bottomRadius)||ti.prototype._isHidden.call(this,t,n)};Ml.prototype._isDynamic=function(t,n){return!t.position.isConstant||!q.isConstant(t.orientation)||!n.length.isConstant||!n.topRadius.isConstant||!n.bottomRadius.isConstant||!q.isConstant(n.slices)||!q.isConstant(n.outlineWidth)||!q.isConstant(n.numberOfVerticalLines)};Ml.prototype._setStaticOptions=function(t,n){let i=q.getValueOrDefault(n.heightReference,Ue.MINIMUM_VALUE,Ge.NONE),o=this._options;o.vertexFormat=this._materialProperty instanceof Rt?tn.VERTEX_FORMAT:ro.MaterialSupport.TEXTURED.vertexFormat,o.length=n.length.getValue(Ue.MINIMUM_VALUE),o.topRadius=n.topRadius.getValue(Ue.MINIMUM_VALUE),o.bottomRadius=n.bottomRadius.getValue(Ue.MINIMUM_VALUE),o.slices=q.getValueOrUndefined(n.slices,Ue.MINIMUM_VALUE),o.numberOfVerticalLines=q.getValueOrUndefined(n.numberOfVerticalLines,Ue.MINIMUM_VALUE),o.offsetAttribute=i!==Ge.NONE?en.ALL:void 0};Ml.prototype._onEntityPropertyChanged=x_;Ml.DynamicGeometryUpdater=lT;function lT(t,n,i){ei.call(this,t,n,i)}f(Object.create)&&(lT.prototype=Object.create(ei.prototype),lT.prototype.constructor=lT);lT.prototype._isHidden=function(t,n,i){let o=this._options,r=q.getValueOrUndefined(t.position,i,d5e);return!f(r)||!f(o.length)||!f(o.topRadius)||!f(o.bottomRadius)||ei.prototype._isHidden.call(this,t,n,i)};lT.prototype._setOptions=function(t,n,i){let o=q.getValueOrDefault(n.heightReference,i,Ge.NONE),r=this._options;r.length=q.getValueOrUndefined(n.length,i),r.topRadius=q.getValueOrUndefined(n.topRadius,i),r.bottomRadius=q.getValueOrUndefined(n.bottomRadius,i),r.slices=q.getValueOrUndefined(n.slices,i),r.numberOfVerticalLines=q.getValueOrUndefined(n.numberOfVerticalLines,i),r.offsetAttribute=o!==Ge.NONE?en.ALL:void 0};var iN=Ml;var m5e={UNBOUNDED:0,CLAMPED:1,LOOP_STOP:2},Nr=Object.freeze(m5e);var p5e={TICK_DEPENDENT:0,SYSTEM_CLOCK_MULTIPLIER:1,SYSTEM_CLOCK:2},po=Object.freeze(p5e);var _5e={NONE:0,HOLD:1,EXTRAPOLATE:2},zu=Object.freeze(_5e);var Ure=yo(gl(),1);function g5e(t){let n=new Ure.default(t);n.normalize();let i=n.path(),o=i.lastIndexOf("/");return o!==-1&&(i=i.substr(o+1)),i}var $_=g5e;var y5e=B.factorial;function z6(t,n,i,o,r,s){let a=0,c,l,u;if(o>0){for(l=0;l<r;l++){for(c=!1,u=0;u<s.length&&!c;u++)l===s[u]&&(c=!0);c||(s.push(l),a+=z6(t,n,i,o-1,r,s),s.splice(s.length-1,1))}return a}for(a=1,l=0;l<r;l++){for(c=!1,u=0;u<s.length&&!c;u++)l===s[u]&&(c=!0);c||(a*=t-i[n[l]])}return a}var oN={type:"Hermite"};oN.getRequiredDataPoints=function(t,n){return n=A(n,0),Math.max(Math.floor((t+1)/(n+1)),2)};oN.interpolateOrderZero=function(t,n,i,o,r){f(r)||(r=new Array(o));let s,a,c,l,u,d,h=n.length,_=new Array(o);for(s=0;s<o;s++){r[s]=0;let x=new Array(h);for(_[s]=x,a=0;a<h;a++)x[a]=[]}let y=h,p=new Array(y);for(s=0;s<y;s++)p[s]=s;let C=h-1;for(l=0;l<o;l++){for(a=0;a<y;a++)d=p[a]*o+l,_[l][0].push(i[d]);for(s=1;s<y;s++){let x=!1;for(a=0;a<y-s;a++){let T=n[p[a]],E=n[p[a+s]],S;E-T<=0?(d=p[a]*o+o*s+l,S=i[d],_[l][s].push(S/y5e(s))):(S=_[l][s-1][a+1]-_[l][s-1][a],_[l][s].push(S/(E-T))),x=x||S!==0}x||(C=s-1)}}for(c=0,u=0;c<=u;c++)for(s=c;s<=C;s++){let x=z6(t,p,n,c,s,[]);for(l=0;l<o;l++){let T=_[l][s][0];r[l+c*o]+=T*x}}return r};var A5e=[];oN.interpolate=function(t,n,i,o,r,s,a){let c=o*(s+1);f(a)||(a=new Array(c));for(let T=0;T<c;T++)a[T]=0;let l=n.length,u=new Array(l*(r+1)),d;for(d=0;d<l;d++)for(let T=0;T<r+1;T++)u[d*(r+1)+T]=d;let h=u.length,_=A5e,y=C5e(_,u,n,i,o,r),p=[],C=h*(h+1)/2,x=Math.min(y,s);for(let T=0;T<=x;T++)for(d=T;d<=y;d++){p.length=0;let E=z6(t,u,n,T,d,p),S=Math.floor(d*(1-d)/2)+h*d;for(let w=0;w<o;w++){let D=Math.floor(w*C),I=_[D+S];a[w+T*o]+=I*E}}return a};function C5e(t,n,i,o,r,s){let a,c,l=-1,u=n.length,d=u*(u+1)/2;for(let h=0;h<r;h++){let _=Math.floor(h*d);for(a=0;a<u;a++)c=n[a]*r*(s+1)+h,t[_+a]=o[c];for(let y=1;y<u;y++){let p=0,C=Math.floor(y*(1-y)/2)+u*y,x=!1;for(a=0;a<u-y;a++){let T=i[n[a]],E=i[n[a+y]],S,w;if(E-T<=0)c=n[a]*r*(s+1)+r*y+h,S=o[c],w=S/B.factorial(y),t[_+C+p]=w,p++;else{let D=Math.floor((y-1)*(2-y)/2)+u*(y-1);S=t[_+D+a+1]-t[_+D+a],w=S/(E-T),t[_+C+p]=w,p++}x=x||S!==0}x&&(l=Math.max(l,y))}}return l}var rN=oN;var H6={type:"Lagrange"};H6.getRequiredDataPoints=function(t){return Math.max(t+1,2)};H6.interpolateOrderZero=function(t,n,i,o,r){f(r)||(r=new Array(o));let s,a,c=n.length;for(s=0;s<o;s++)r[s]=0;for(s=0;s<c;s++){let l=1;for(a=0;a<c;a++)if(a!==s){let u=n[s]-n[a];l*=(t-n[a])/u}for(a=0;a<o;a++)r[a]+=l*i[s*o+a]}return r};var sN=H6;var G6={type:"Linear"};G6.getRequiredDataPoints=function(t){return 2};G6.interpolateOrderZero=function(t,n,i,o,r){f(r)||(r=new Array(o));let s,a,c,l=n[0],u=n[1];for(s=0;s<o;s++)a=i[s],c=i[s+o],r[s]=((c-a)*t+u*a-l*c)/(u-l);return r};var uT=G6;function La(t,n,i){this.clock=A(t,0),this.cone=A(n,0),this.magnitude=A(i,1)}La.fromCartesian3=function(t,n){let i=t.x,o=t.y,r=t.z,s=i*i+o*o;return f(n)||(n=new La),n.clock=Math.atan2(o,i),n.cone=Math.atan2(Math.sqrt(s),r),n.magnitude=Math.sqrt(s+r*r),n};La.clone=function(t,n){if(!!f(t))return f(n)?(n.clock=t.clock,n.cone=t.cone,n.magnitude=t.magnitude,n):new La(t.clock,t.cone,t.magnitude)};La.normalize=function(t,n){return f(n)?(n.clock=t.clock,n.cone=t.cone,n.magnitude=1,n):new La(t.clock,t.cone,1)};La.equals=function(t,n){return t===n||f(t)&&f(n)&&t.clock===n.clock&&t.cone===n.cone&&t.magnitude===n.magnitude};La.equalsEpsilon=function(t,n,i){return i=A(i,0),t===n||f(t)&&f(n)&&Math.abs(t.clock-n.clock)<=i&&Math.abs(t.cone-n.cone)<=i&&Math.abs(t.magnitude-n.magnitude)<=i};La.prototype.equals=function(t){return La.equals(this,t)};La.prototype.clone=function(t){return La.clone(this,t)};La.prototype.equalsEpsilon=function(t,n){return La.equalsEpsilon(this,t,n)};La.prototype.toString=function(){return`(${this.clock}, ${this.cone}, ${this.magnitude})`};var aN=La;var Jw=yo(gl(),1);var W6;typeof performance!="undefined"&&typeof performance.now=="function"&&isFinite(performance.now())?W6=function(){return performance.now()}:W6=function(){return Date.now()};var Fi=W6;function j6(t){t=A(t,A.EMPTY_OBJECT);let n=t.currentTime,i=t.startTime,o=t.stopTime;f(n)?n=te.clone(n):f(i)?n=te.clone(i):f(o)?n=te.addDays(o,-1,new te):n=te.now(),f(i)?i=te.clone(i):i=te.clone(n),f(o)?o=te.clone(o):o=te.addDays(i,1,new te),this.startTime=i,this.stopTime=o,this.clockRange=A(t.clockRange,Nr.UNBOUNDED),this.canAnimate=A(t.canAnimate,!0),this.onTick=new Ae,this.onStop=new Ae,this._currentTime=void 0,this._multiplier=void 0,this._clockStep=void 0,this._shouldAnimate=void 0,this._lastSystemTime=Fi(),this.currentTime=n,this.multiplier=A(t.multiplier,1),this.shouldAnimate=A(t.shouldAnimate,!1),this.clockStep=A(t.clockStep,po.SYSTEM_CLOCK_MULTIPLIER)}Object.defineProperties(j6.prototype,{currentTime:{get:function(){return this._currentTime},set:function(t){te.equals(this._currentTime,t)||(this._clockStep===po.SYSTEM_CLOCK&&(this._clockStep=po.SYSTEM_CLOCK_MULTIPLIER),this._currentTime=t)}},multiplier:{get:function(){return this._multiplier},set:function(t){this._multiplier!==t&&(this._clockStep===po.SYSTEM_CLOCK&&(this._clockStep=po.SYSTEM_CLOCK_MULTIPLIER),this._multiplier=t)}},clockStep:{get:function(){return this._clockStep},set:function(t){t===po.SYSTEM_CLOCK&&(this._multiplier=1,this._shouldAnimate=!0,this._currentTime=te.now()),this._clockStep=t}},shouldAnimate:{get:function(){return this._shouldAnimate},set:function(t){this._shouldAnimate!==t&&(this._clockStep===po.SYSTEM_CLOCK&&(this._clockStep=po.SYSTEM_CLOCK_MULTIPLIER),this._shouldAnimate=t)}}});j6.prototype.tick=function(){let t=Fi(),n=te.clone(this._currentTime);if(this.canAnimate&&this._shouldAnimate){let i=this._clockStep;if(i===po.SYSTEM_CLOCK)n=te.now(n);else{let o=this._multiplier;if(i===po.TICK_DEPENDENT)n=te.addSeconds(n,o,n);else{let c=t-this._lastSystemTime;n=te.addSeconds(n,o*(c/1e3),n)}let r=this.clockRange,s=this.startTime,a=this.stopTime;if(r===Nr.CLAMPED)te.lessThan(n,s)?n=te.clone(s,n):te.greaterThan(n,a)&&(n=te.clone(a,n),this.onStop.raiseEvent(this));else if(r===Nr.LOOP_STOP)for(te.lessThan(n,s)&&(n=te.clone(s,n));te.greaterThan(n,a);)n=te.addSeconds(s,te.secondsDifference(n,a),n),this.onStop.raiseEvent(this)}}return this._currentTime=n,this._lastSystemTime=t,this.onTick.raiseEvent(this),n};var _h=j6;function By(){this._definitionChanged=new Ae,this._startTime=void 0,this._stopTime=void 0,this._currentTime=void 0,this._clockRange=void 0,this._clockStep=void 0,this._multiplier=void 0}Object.defineProperties(By.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},startTime:vl("startTime"),stopTime:vl("stopTime"),currentTime:vl("currentTime"),clockRange:vl("clockRange"),clockStep:vl("clockStep"),multiplier:vl("multiplier")});By.prototype.clone=function(t){return f(t)||(t=new By),t.startTime=this.startTime,t.stopTime=this.stopTime,t.currentTime=this.currentTime,t.clockRange=this.clockRange,t.clockStep=this.clockStep,t.multiplier=this.multiplier,t};By.prototype.equals=function(t){return this===t||f(t)&&te.equals(this.startTime,t.startTime)&&te.equals(this.stopTime,t.stopTime)&&te.equals(this.currentTime,t.currentTime)&&this.clockRange===t.clockRange&&this.clockStep===t.clockStep&&this.multiplier===t.multiplier};By.prototype.merge=function(t){this.startTime=A(this.startTime,t.startTime),this.stopTime=A(this.stopTime,t.stopTime),this.currentTime=A(this.currentTime,t.currentTime),this.clockRange=A(this.clockRange,t.clockRange),this.clockStep=A(this.clockStep,t.clockStep),this.multiplier=A(this.multiplier,t.multiplier)};By.prototype.getValue=function(t){return f(t)||(t=new _h),t.startTime=A(this.startTime,t.startTime),t.stopTime=A(this.stopTime,t.stopTime),t.currentTime=A(this.currentTime,t.currentTime),t.clockRange=A(this.clockRange,t.clockRange),t.multiplier=A(this.multiplier,t.multiplier),t.clockStep=A(this.clockStep,t.clockStep),t};var gh=By;var x5e=z.WHITE,T5e=.1,E5e=new W(8,8),b5e=new W(0,0),S5e=new W(1,1);function fT(t){t=A(t,A.EMPTY_OBJECT),this._definitionChanged=new Ae,this._color=void 0,this._colorSubscription=void 0,this._cellAlpha=void 0,this._cellAlphaSubscription=void 0,this._lineCount=void 0,this._lineCountSubscription=void 0,this._lineThickness=void 0,this._lineThicknessSubscription=void 0,this._lineOffset=void 0,this._lineOffsetSubscription=void 0,this.color=t.color,this.cellAlpha=t.cellAlpha,this.lineCount=t.lineCount,this.lineThickness=t.lineThickness,this.lineOffset=t.lineOffset}Object.defineProperties(fT.prototype,{isConstant:{get:function(){return q.isConstant(this._color)&&q.isConstant(this._cellAlpha)&&q.isConstant(this._lineCount)&&q.isConstant(this._lineThickness)&&q.isConstant(this._lineOffset)}},definitionChanged:{get:function(){return this._definitionChanged}},color:ce("color"),cellAlpha:ce("cellAlpha"),lineCount:ce("lineCount"),lineThickness:ce("lineThickness"),lineOffset:ce("lineOffset")});fT.prototype.getType=function(t){return"Grid"};fT.prototype.getValue=function(t,n){return f(n)||(n={}),n.color=q.getValueOrClonedDefault(this._color,t,x5e,n.color),n.cellAlpha=q.getValueOrDefault(this._cellAlpha,t,T5e),n.lineCount=q.getValueOrClonedDefault(this._lineCount,t,E5e,n.lineCount),n.lineThickness=q.getValueOrClonedDefault(this._lineThickness,t,S5e,n.lineThickness),n.lineOffset=q.getValueOrClonedDefault(this._lineOffset,t,b5e,n.lineOffset),n};fT.prototype.equals=function(t){return this===t||t instanceof fT&&q.equals(this._color,t._color)&&q.equals(this._cellAlpha,t._cellAlpha)&&q.equals(this._lineCount,t._lineCount)&&q.equals(this._lineThickness,t._lineThickness)&&q.equals(this._lineOffset,t._lineOffset)};var zw=fT;function dT(t){this._definitionChanged=new Ae,this._color=void 0,this._colorSubscription=void 0,this.color=t}Object.defineProperties(dT.prototype,{isConstant:{get:function(){return q.isConstant(this._color)}},definitionChanged:{get:function(){return this._definitionChanged}},color:ce("color")});dT.prototype.getType=function(t){return"PolylineArrow"};dT.prototype.getValue=function(t,n){return f(n)||(n={}),n.color=q.getValueOrClonedDefault(this._color,t,z.WHITE,n.color),n};dT.prototype.equals=function(t){return this===t||t instanceof dT&&q.equals(this._color,t._color)};var Hw=dT;var w5e=z.WHITE,D5e=z.TRANSPARENT,v5e=16,P5e=255;function hT(t){t=A(t,A.EMPTY_OBJECT),this._definitionChanged=new Ae,this._color=void 0,this._colorSubscription=void 0,this._gapColor=void 0,this._gapColorSubscription=void 0,this._dashLength=void 0,this._dashLengthSubscription=void 0,this._dashPattern=void 0,this._dashPatternSubscription=void 0,this.color=t.color,this.gapColor=t.gapColor,this.dashLength=t.dashLength,this.dashPattern=t.dashPattern}Object.defineProperties(hT.prototype,{isConstant:{get:function(){return q.isConstant(this._color)&&q.isConstant(this._gapColor)&&q.isConstant(this._dashLength)&&q.isConstant(this._dashPattern)}},definitionChanged:{get:function(){return this._definitionChanged}},color:ce("color"),gapColor:ce("gapColor"),dashLength:ce("dashLength"),dashPattern:ce("dashPattern")});hT.prototype.getType=function(t){return"PolylineDash"};hT.prototype.getValue=function(t,n){return f(n)||(n={}),n.color=q.getValueOrClonedDefault(this._color,t,w5e,n.color),n.gapColor=q.getValueOrClonedDefault(this._gapColor,t,D5e,n.gapColor),n.dashLength=q.getValueOrDefault(this._dashLength,t,v5e,n.dashLength),n.dashPattern=q.getValueOrDefault(this._dashPattern,t,P5e,n.dashPattern),n};hT.prototype.equals=function(t){return this===t||t instanceof hT&&q.equals(this._color,t._color)&&q.equals(this._gapColor,t._gapColor)&&q.equals(this._dashLength,t._dashLength)&&q.equals(this._dashPattern,t._dashPattern)};var Gw=hT;var I5e=z.WHITE,B5e=.25,O5e=1;function mT(t){t=A(t,A.EMPTY_OBJECT),this._definitionChanged=new Ae,this._color=void 0,this._colorSubscription=void 0,this._glowPower=void 0,this._glowPowerSubscription=void 0,this._taperPower=void 0,this._taperPowerSubscription=void 0,this.color=t.color,this.glowPower=t.glowPower,this.taperPower=t.taperPower}Object.defineProperties(mT.prototype,{isConstant:{get:function(){return q.isConstant(this._color)&&q.isConstant(this._glow)}},definitionChanged:{get:function(){return this._definitionChanged}},color:ce("color"),glowPower:ce("glowPower"),taperPower:ce("taperPower")});mT.prototype.getType=function(t){return"PolylineGlow"};mT.prototype.getValue=function(t,n){return f(n)||(n={}),n.color=q.getValueOrClonedDefault(this._color,t,I5e,n.color),n.glowPower=q.getValueOrDefault(this._glowPower,t,B5e,n.glowPower),n.taperPower=q.getValueOrDefault(this._taperPower,t,O5e,n.taperPower),n};mT.prototype.equals=function(t){return this===t||t instanceof mT&&q.equals(this._color,t._color)&&q.equals(this._glowPower,t._glowPower)&&q.equals(this._taperPower,t._taperPower)};var Ww=mT;var R5e=z.WHITE,M5e=z.BLACK,L5e=1;function pT(t){t=A(t,A.EMPTY_OBJECT),this._definitionChanged=new Ae,this._color=void 0,this._colorSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this.color=t.color,this.outlineColor=t.outlineColor,this.outlineWidth=t.outlineWidth}Object.defineProperties(pT.prototype,{isConstant:{get:function(){return q.isConstant(this._color)&&q.isConstant(this._outlineColor)&&q.isConstant(this._outlineWidth)}},definitionChanged:{get:function(){return this._definitionChanged}},color:ce("color"),outlineColor:ce("outlineColor"),outlineWidth:ce("outlineWidth")});pT.prototype.getType=function(t){return"PolylineOutline"};pT.prototype.getValue=function(t,n){return f(n)||(n={}),n.color=q.getValueOrClonedDefault(this._color,t,R5e,n.color),n.outlineColor=q.getValueOrClonedDefault(this._outlineColor,t,M5e,n.outlineColor),n.outlineWidth=q.getValueOrDefault(this._outlineWidth,t,L5e),n};pT.prototype.equals=function(t){return this===t||t instanceof pT&&q.equals(this._color,t._color)&&q.equals(this._outlineColor,t._outlineColor)&&q.equals(this._outlineWidth,t._outlineWidth)};var Oy=pT;function cp(t,n){this._value=void 0,this._definitionChanged=new Ae,this._eventHelper=new Mr,this._referenceFrame=A(n,no.FIXED),this.setValue(t)}Object.defineProperties(cp.prototype,{isConstant:{get:function(){let t=this._value;if(!f(t))return!0;let n=t.length;for(let i=0;i<n;i++)if(!q.isConstant(t[i]))return!1;return!0}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){return this._referenceFrame}}});cp.prototype.getValue=function(t,n){return this.getValueInReferenceFrame(t,no.FIXED,n)};cp.prototype.getValueInReferenceFrame=function(t,n,i){let o=this._value;if(!f(o))return;let r=o.length;f(i)||(i=new Array(r));let s=0,a=0;for(;s<r;){let l=o[s].getValueInReferenceFrame(t,n,i[s]);f(l)&&(i[a]=l,a++),s++}return i.length=a,i};cp.prototype.setValue=function(t){let n=this._eventHelper;if(n.removeAll(),f(t)){this._value=t.slice();let i=t.length;for(let o=0;o<i;o++){let r=t[o];f(r)&&n.add(r.definitionChanged,cp.prototype._raiseDefinitionChanged,this)}}else this._value=void 0;this._definitionChanged.raiseEvent(this)};cp.prototype.equals=function(t){return this===t||t instanceof cp&&this._referenceFrame===t._referenceFrame&&q.arrayEquals(this._value,t._value)};cp.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)};var eg=cp;function tg(t){this._value=void 0,this._definitionChanged=new Ae,this._eventHelper=new Mr,this.setValue(t)}Object.defineProperties(tg.prototype,{isConstant:{get:function(){let t=this._value;if(!f(t))return!0;let n=t.length;for(let i=0;i<n;i++)if(!q.isConstant(t[i]))return!1;return!0}},definitionChanged:{get:function(){return this._definitionChanged}}});tg.prototype.getValue=function(t,n){let i=this._value;if(!f(i))return;let o=i.length;f(n)||(n=new Array(o));let r=0,s=0;for(;r<o;){let c=this._value[r].getValue(t,n[r]);f(c)&&(n[s]=c,s++),r++}return n.length=s,n};tg.prototype.setValue=function(t){let n=this._eventHelper;if(n.removeAll(),f(t)){this._value=t.slice();let i=t.length;for(let o=0;o<i;o++){let r=t[o];f(r)&&n.add(r.definitionChanged,tg.prototype._raiseDefinitionChanged,this)}}else this._value=void 0;this._definitionChanged.raiseEvent(this)};tg.prototype.equals=function(t){return this===t||t instanceof tg&&q.arrayEquals(this._value,t._value)};tg.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)};var jw=tg;function Ry(t){let n=t._targetProperty;if(!f(n)){let i=t._targetEntity;if(!f(i)){if(i=t._targetCollection.getById(t._targetId),!f(i)){t._targetEntity=t._targetProperty=void 0;return}i.definitionChanged.addEventListener(Ll.prototype._onTargetEntityDefinitionChanged,t),t._targetEntity=i}let o=t._targetPropertyNames;n=t._targetEntity;for(let r=0,s=o.length;r<s&&f(n);++r)n=n[o[r]];t._targetProperty=n}return n}function Ll(t,n,i){this._targetCollection=t,this._targetId=n,this._targetPropertyNames=i,this._targetProperty=void 0,this._targetEntity=void 0,this._definitionChanged=new Ae,t.collectionChanged.addEventListener(Ll.prototype._onCollectionChanged,this)}Object.defineProperties(Ll.prototype,{isConstant:{get:function(){return q.isConstant(Ry(this))}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){let t=Ry(this);return f(t)?t.referenceFrame:void 0}},targetId:{get:function(){return this._targetId}},targetCollection:{get:function(){return this._targetCollection}},targetPropertyNames:{get:function(){return this._targetPropertyNames}},resolvedProperty:{get:function(){return Ry(this)}}});Ll.fromString=function(t,n){let i,o=[],r=!0,s=!1,a="";for(let c=0;c<n.length;++c){let l=n.charAt(c);s?(a+=l,s=!1):l==="\\"?s=!0:r&&l==="#"?(i=a,r=!1,a=""):!r&&l==="."?(o.push(a),a=""):a+=l}return o.push(a),new Ll(t,i,o)};Ll.prototype.getValue=function(t,n){let i=Ry(this);return f(i)?i.getValue(t,n):void 0};Ll.prototype.getValueInReferenceFrame=function(t,n,i){let o=Ry(this);return f(o)?o.getValueInReferenceFrame(t,n,i):void 0};Ll.prototype.getType=function(t){let n=Ry(this);return f(n)?n.getType(t):void 0};Ll.prototype.equals=function(t){if(this===t)return!0;let n=this._targetPropertyNames,i=t._targetPropertyNames;if(this._targetCollection!==t._targetCollection||this._targetId!==t._targetId||n.length!==i.length)return!1;let o=this._targetPropertyNames.length;for(let r=0;r<o;r++)if(n[r]!==i[r])return!1;return!0};Ll.prototype._onTargetEntityDefinitionChanged=function(t,n,i,o){f(this._targetProperty)&&this._targetPropertyNames[0]===n&&(this._targetProperty=void 0,this._definitionChanged.raiseEvent(this))};Ll.prototype._onCollectionChanged=function(t,n,i){let o=this._targetEntity;f(o)&&i.indexOf(o)!==-1?(o.definitionChanged.removeEventListener(Ll.prototype._onTargetEntityDefinitionChanged,this),this._targetEntity=this._targetProperty=void 0):f(o)||(o=Ry(this),f(o)&&this._definitionChanged.raiseEvent(this))};var ng=Ll;var F5e={packedLength:1,pack:function(t,n,i){return i=A(i,0),n[i]=t,n},unpack:function(t,n,i){return n=A(n,0),t[n]},convertPackedArrayForInterpolation:function(t,n,i,o){f(o)||(o=[]),n=A(n,0),i=A(i,t.length);let r;for(let s=0,a=i-n+1;s<a;s++){let c=t[n+s];s===0||Math.abs(r-c)<Math.PI?o[s]=c:o[s]=c-B.TWO_PI,r=c}},unpackInterpolationResult:function(t,n,i,o,r){return r=t[0],r<0?r+B.TWO_PI:r}},Xf=F5e;var zre={packedLength:1,pack:function(t,n,i){i=A(i,0),n[i]=t},unpack:function(t,n,i){return n=A(n,0),t[n]}};function Hre(t,n,i){let o,r=t.length,s=i.length,a=r+s;if(t.length=a,r!==n){let c=r-1;for(o=a-1;o>=n;o--)t[o]=t[c--]}for(o=0;o<s;o++)t[n++]=i[o]}function Gre(t,n){return t instanceof te?t:typeof t=="string"?te.fromIso8601(t):te.addSeconds(n,t,new te)}var q6=[],Y6=[];function cN(t,n,i,o,r){let s=0,a,c,l,u,d,h;for(;s<o.length;){d=Gre(o[s],t),l=jo(n,d,te.compare);let _=0,y=0;if(l<0){for(l=~l,u=l*r,c=void 0,h=n[l];s<o.length&&(d=Gre(o[s],t),!(f(c)&&te.compare(c,d)>=0||f(h)&&te.compare(d,h)>=0));){for(q6[_++]=d,s=s+1,a=0;a<r;a++)Y6[y++]=o[s],s=s+1;c=d}_>0&&(Y6.length=y,Hre(i,u,Y6),q6.length=_,Hre(n,l,q6))}else{for(a=0;a<r;a++)s++,i[l*r+a]=o[s];s++}}}function Kf(t,n){let i=t;i===Number&&(i=zre);let o=i.packedLength,r=A(i.packedInterpolationLength,o),s=0,a;if(f(n)){let c=n.length;a=new Array(c);for(let l=0;l<c;l++){let u=n[l];u===Number&&(u=zre);let d=u.packedLength;o+=d,r+=A(u.packedInterpolationLength,d),a[l]=u}s=c}this._type=t,this._innerType=i,this._interpolationDegree=1,this._interpolationAlgorithm=uT,this._numberOfPoints=0,this._times=[],this._values=[],this._xTable=[],this._yTable=[],this._packedLength=o,this._packedInterpolationLength=r,this._updateTableLength=!0,this._interpolationResult=new Array(r),this._definitionChanged=new Ae,this._derivativeTypes=n,this._innerDerivativeTypes=a,this._inputOrder=s,this._forwardExtrapolationType=zu.NONE,this._forwardExtrapolationDuration=0,this._backwardExtrapolationType=zu.NONE,this._backwardExtrapolationDuration=0}Object.defineProperties(Kf.prototype,{isConstant:{get:function(){return this._values.length===0}},definitionChanged:{get:function(){return this._definitionChanged}},type:{get:function(){return this._type}},derivativeTypes:{get:function(){return this._derivativeTypes}},interpolationDegree:{get:function(){return this._interpolationDegree}},interpolationAlgorithm:{get:function(){return this._interpolationAlgorithm}},forwardExtrapolationType:{get:function(){return this._forwardExtrapolationType},set:function(t){this._forwardExtrapolationType!==t&&(this._forwardExtrapolationType=t,this._definitionChanged.raiseEvent(this))}},forwardExtrapolationDuration:{get:function(){return this._forwardExtrapolationDuration},set:function(t){this._forwardExtrapolationDuration!==t&&(this._forwardExtrapolationDuration=t,this._definitionChanged.raiseEvent(this))}},backwardExtrapolationType:{get:function(){return this._backwardExtrapolationType},set:function(t){this._backwardExtrapolationType!==t&&(this._backwardExtrapolationType=t,this._definitionChanged.raiseEvent(this))}},backwardExtrapolationDuration:{get:function(){return this._backwardExtrapolationDuration},set:function(t){this._backwardExtrapolationDuration!==t&&(this._backwardExtrapolationDuration=t,this._definitionChanged.raiseEvent(this))}}});Kf.prototype.getValue=function(t,n){let i=this._times,o=i.length;if(o===0)return;let r,s=this._innerType,a=this._values,c=jo(i,t,te.compare);if(c<0){if(c=~c,c===0){let w=i[c];if(r=this._backwardExtrapolationDuration,this._backwardExtrapolationType===zu.NONE||r!==0&&te.secondsDifference(w,t)>r)return;if(this._backwardExtrapolationType===zu.HOLD)return s.unpack(a,0,n)}if(c>=o){c=o-1;let w=i[c];if(r=this._forwardExtrapolationDuration,this._forwardExtrapolationType===zu.NONE||r!==0&&te.secondsDifference(t,w)>r)return;if(this._forwardExtrapolationType===zu.HOLD)return c=o-1,s.unpack(a,c*s.packedLength,n)}let l=this._xTable,u=this._yTable,d=this._interpolationAlgorithm,h=this._packedInterpolationLength,_=this._inputOrder;if(this._updateTableLength){this._updateTableLength=!1;let w=Math.min(d.getRequiredDataPoints(this._interpolationDegree,_),o);w!==this._numberOfPoints&&(this._numberOfPoints=w,l.length=w,u.length=w*h)}let y=this._numberOfPoints-1;if(y<1)return;let p=0,C=o-1;if(C-p+1>=y+1){let w=c-(y/2|0)-1;w<p&&(w=p);let D=w+y;D>C&&(D=C,w=D-y,w<p&&(w=p)),p=w,C=D}let T=C-p+1;for(let w=0;w<T;++w)l[w]=te.secondsDifference(i[p+w],i[C]);if(f(s.convertPackedArrayForInterpolation))s.convertPackedArrayForInterpolation(a,p,C,u);else{let w=0,D=this._packedLength,I=p*D,O=(C+1)*D;for(;I<O;)u[w]=a[I],I++,w++}let E=te.secondsDifference(t,i[C]),S;if(_===0||!f(d.interpolate))S=d.interpolateOrderZero(E,l,u,h,this._interpolationResult);else{let w=Math.floor(h/(_+1));S=d.interpolate(E,l,u,w,_,_,this._interpolationResult)}return f(s.unpackInterpolationResult)?s.unpackInterpolationResult(S,a,p,C,n):s.unpack(S,0,n)}return s.unpack(a,c*this._packedLength,n)};Kf.prototype.setInterpolationOptions=function(t){if(!f(t))return;let n=!1,i=t.interpolationAlgorithm,o=t.interpolationDegree;f(i)&&this._interpolationAlgorithm!==i&&(this._interpolationAlgorithm=i,n=!0),f(o)&&this._interpolationDegree!==o&&(this._interpolationDegree=o,n=!0),n&&(this._updateTableLength=!0,this._definitionChanged.raiseEvent(this))};Kf.prototype.addSample=function(t,n,i){let o=this._innerDerivativeTypes,r=f(o),s=this._innerType,a=[];if(a.push(t),s.pack(n,a,a.length),r){let c=o.length;for(let l=0;l<c;l++)o[l].pack(i[l],a,a.length)}cN(void 0,this._times,this._values,a,this._packedLength),this._updateTableLength=!0,this._definitionChanged.raiseEvent(this)};Kf.prototype.addSamples=function(t,n,i){let o=this._innerDerivativeTypes,r=f(o),s=this._innerType,a=t.length,c=[];for(let l=0;l<a;l++)if(c.push(t[l]),s.pack(n[l],c,c.length),r){let u=i[l],d=o.length;for(let h=0;h<d;h++)o[h].pack(u[h],c,c.length)}cN(void 0,this._times,this._values,c,this._packedLength),this._updateTableLength=!0,this._definitionChanged.raiseEvent(this)};Kf.prototype.addSamplesPackedArray=function(t,n){cN(n,this._times,this._values,t,this._packedLength),this._updateTableLength=!0,this._definitionChanged.raiseEvent(this)};Kf.prototype.removeSample=function(t){let n=jo(this._times,t,te.compare);return n<0?!1:(Wre(this,n,1),!0)};function Wre(t,n,i){let o=t._packedLength;t._times.splice(n,i),t._values.splice(n*o,i*o),t._updateTableLength=!0,t._definitionChanged.raiseEvent(t)}Kf.prototype.removeSamples=function(t){let n=this._times,i=jo(n,t.start,te.compare);i<0?i=~i:t.isStartIncluded||++i;let o=jo(n,t.stop,te.compare);o<0?o=~o:t.isStopIncluded&&++o,Wre(this,i,o-i)};Kf.prototype.equals=function(t){if(this===t)return!0;if(!f(t)||this._type!==t._type||this._interpolationDegree!==t._interpolationDegree||this._interpolationAlgorithm!==t._interpolationAlgorithm)return!1;let n=this._derivativeTypes,i=f(n),o=t._derivativeTypes,r=f(o);if(i!==r)return!1;let s,a;if(i){if(a=n.length,a!==o.length)return!1;for(s=0;s<a;s++)if(n[s]!==o[s])return!1}let c=this._times,l=t._times;if(a=c.length,a!==l.length)return!1;for(s=0;s<a;s++)if(!te.equals(c[s],l[s]))return!1;let u=this._values,d=t._values;for(a=u.length,s=0;s<a;s++)if(u[s]!==d[s])return!1;return!0};Kf._mergeNewSamples=cN;var Hu=Kf;function Gu(t,n){n=A(n,0);let i;if(n>0){i=new Array(n);for(let o=0;o<n;o++)i[o]=m}this._numberOfDerivatives=n,this._property=new Hu(m,i),this._definitionChanged=new Ae,this._referenceFrame=A(t,no.FIXED),this._property._definitionChanged.addEventListener(function(){this._definitionChanged.raiseEvent(this)},this)}Object.defineProperties(Gu.prototype,{isConstant:{get:function(){return this._property.isConstant}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){return this._referenceFrame}},interpolationDegree:{get:function(){return this._property.interpolationDegree}},interpolationAlgorithm:{get:function(){return this._property.interpolationAlgorithm}},numberOfDerivatives:{get:function(){return this._numberOfDerivatives}},forwardExtrapolationType:{get:function(){return this._property.forwardExtrapolationType},set:function(t){this._property.forwardExtrapolationType=t}},forwardExtrapolationDuration:{get:function(){return this._property.forwardExtrapolationDuration},set:function(t){this._property.forwardExtrapolationDuration=t}},backwardExtrapolationType:{get:function(){return this._property.backwardExtrapolationType},set:function(t){this._property.backwardExtrapolationType=t}},backwardExtrapolationDuration:{get:function(){return this._property.backwardExtrapolationDuration},set:function(t){this._property.backwardExtrapolationDuration=t}}});Gu.prototype.getValue=function(t,n){return this.getValueInReferenceFrame(t,no.FIXED,n)};Gu.prototype.getValueInReferenceFrame=function(t,n,i){if(i=this._property.getValue(t,i),f(i))return g_.convertToReferenceFrame(t,i,this._referenceFrame,n,i)};Gu.prototype.setInterpolationOptions=function(t){this._property.setInterpolationOptions(t)};Gu.prototype.addSample=function(t,n,i){let o=this._numberOfDerivatives;this._property.addSample(t,n,i)};Gu.prototype.addSamples=function(t,n,i){this._property.addSamples(t,n,i)};Gu.prototype.addSamplesPackedArray=function(t,n){this._property.addSamplesPackedArray(t,n)};Gu.prototype.removeSample=function(t){return this._property.removeSample(t)};Gu.prototype.removeSamples=function(t){this._property.removeSamples(t)};Gu.prototype.equals=function(t){return this===t||t instanceof Gu&&q.equals(this._property,t._property)&&this._referenceFrame===t._referenceFrame};var oa=Gu;var N5e={HORIZONTAL:0,VERTICAL:1},yh=Object.freeze(N5e);var V5e=yh.HORIZONTAL,k5e=z.WHITE,U5e=z.BLACK,z5e=0,H5e=1;function _T(t){t=A(t,A.EMPTY_OBJECT),this._definitionChanged=new Ae,this._orientation=void 0,this._orientationSubscription=void 0,this._evenColor=void 0,this._evenColorSubscription=void 0,this._oddColor=void 0,this._oddColorSubscription=void 0,this._offset=void 0,this._offsetSubscription=void 0,this._repeat=void 0,this._repeatSubscription=void 0,this.orientation=t.orientation,this.evenColor=t.evenColor,this.oddColor=t.oddColor,this.offset=t.offset,this.repeat=t.repeat}Object.defineProperties(_T.prototype,{isConstant:{get:function(){return q.isConstant(this._orientation)&&q.isConstant(this._evenColor)&&q.isConstant(this._oddColor)&&q.isConstant(this._offset)&&q.isConstant(this._repeat)}},definitionChanged:{get:function(){return this._definitionChanged}},orientation:ce("orientation"),evenColor:ce("evenColor"),oddColor:ce("oddColor"),offset:ce("offset"),repeat:ce("repeat")});_T.prototype.getType=function(t){return"Stripe"};_T.prototype.getValue=function(t,n){return f(n)||(n={}),n.horizontal=q.getValueOrDefault(this._orientation,t,V5e)===yh.HORIZONTAL,n.evenColor=q.getValueOrClonedDefault(this._evenColor,t,k5e,n.evenColor),n.oddColor=q.getValueOrClonedDefault(this._oddColor,t,U5e,n.oddColor),n.offset=q.getValueOrDefault(this._offset,t,z5e),n.repeat=q.getValueOrDefault(this._repeat,t,H5e),n};_T.prototype.equals=function(t){return this===t||t instanceof _T&&q.equals(this._orientation,t._orientation)&&q.equals(this._evenColor,t._evenColor)&&q.equals(this._oddColor,t._oddColor)&&q.equals(this._offset,t._offset)&&q.equals(this._repeat,t._repeat)};var qw=_T;function ig(t){this._definitionChanged=new Ae,this._intervals=new Lr,this._intervals.changedEvent.addEventListener(ig.prototype._intervalsChanged,this),this._referenceFrame=A(t,no.FIXED)}Object.defineProperties(ig.prototype,{isConstant:{get:function(){return this._intervals.isEmpty}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._intervals}},referenceFrame:{get:function(){return this._referenceFrame}}});ig.prototype.getValue=function(t,n){return this.getValueInReferenceFrame(t,no.FIXED,n)};ig.prototype.getValueInReferenceFrame=function(t,n,i){let o=this._intervals.findDataForIntervalContainingDate(t);if(f(o))return g_.convertToReferenceFrame(t,o,this._referenceFrame,n,i)};ig.prototype.equals=function(t){return this===t||t instanceof ig&&this._intervals.equals(t._intervals,q.equals)&&this._referenceFrame===t._referenceFrame};ig.prototype._intervalsChanged=function(){this._definitionChanged.raiseEvent(this)};var og=ig;function My(){this._definitionChanged=new Ae,this._intervals=new Lr,this._intervals.changedEvent.addEventListener(My.prototype._intervalsChanged,this)}Object.defineProperties(My.prototype,{isConstant:{get:function(){return this._intervals.isEmpty}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._intervals}}});My.prototype.getValue=function(t,n){let i=this._intervals.findDataForIntervalContainingDate(t);return f(i)&&typeof i.clone=="function"?i.clone(n):i};My.prototype.equals=function(t){return this===t||t instanceof My&&this._intervals.equals(t._intervals,q.equals)};My.prototype._intervalsChanged=function(){this._definitionChanged.raiseEvent(this)};var rg=My;function gT(t,n){this._position=void 0,this._subscription=void 0,this._definitionChanged=new Ae,this._normalize=A(n,!0),this.position=t}Object.defineProperties(gT.prototype,{isConstant:{get:function(){return q.isConstant(this._position)}},definitionChanged:{get:function(){return this._definitionChanged}},position:{get:function(){return this._position},set:function(t){let n=this._position;n!==t&&(f(n)&&this._subscription(),this._position=t,f(t)&&(this._subscription=t._definitionChanged.addEventListener(function(){this._definitionChanged.raiseEvent(this)},this)),this._definitionChanged.raiseEvent(this))}},normalize:{get:function(){return this._normalize},set:function(t){this._normalize!==t&&(this._normalize=t,this._definitionChanged.raiseEvent(this))}}});var G5e=new m,jre=new m,qre=new te,X6=1/60;gT.prototype.getValue=function(t,n){return this._getValue(t,n)};gT.prototype._getValue=function(t,n,i){f(n)||(n=new m);let o=this._position;if(q.isConstant(o))return this._normalize?void 0:m.clone(m.ZERO,n);let r=o.getValue(t,G5e),s=o.getValue(te.addSeconds(t,X6,qre),jre);if(!f(r)||!f(s)&&(s=r,r=o.getValue(te.addSeconds(t,-X6,qre),jre),!f(r)))return;if(m.equals(r,s))return this._normalize?void 0:m.clone(m.ZERO,n);f(i)&&r.clone(i);let a=m.subtract(s,r,n);return this._normalize?m.normalize(a,n):m.divideByScalar(a,X6,n)};gT.prototype.equals=function(t){return this===t||t instanceof gT&&q.equals(this._position,t._position)};var yT=gT;function Yw(t,n){this._velocityVectorProperty=new yT(t,!0),this._subscription=void 0,this._ellipsoid=void 0,this._definitionChanged=new Ae,this.ellipsoid=A(n,oe.WGS84);let i=this;this._velocityVectorProperty.definitionChanged.addEventListener(function(){i._definitionChanged.raiseEvent(i)})}Object.defineProperties(Yw.prototype,{isConstant:{get:function(){return q.isConstant(this._velocityVectorProperty)}},definitionChanged:{get:function(){return this._definitionChanged}},position:{get:function(){return this._velocityVectorProperty.position},set:function(t){this._velocityVectorProperty.position=t}},ellipsoid:{get:function(){return this._ellipsoid},set:function(t){this._ellipsoid!==t&&(this._ellipsoid=t,this._definitionChanged.raiseEvent(this))}}});var Yre=new m,W5e=new m,Xre=new $;Yw.prototype.getValue=function(t,n){let i=this._velocityVectorProperty._getValue(t,W5e,Yre);if(!!f(i))return vt.rotationMatrixFromPositionVelocity(Yre,i,this._ellipsoid,Xre),Me.fromRotationMatrix(Xre,n)};Yw.prototype.equals=function(t){return this===t||t instanceof Yw&&q.equals(this._velocityVectorProperty,t._velocityVectorProperty)&&(this._ellipsoid===t._ellipsoid||this._ellipsoid.equals(t._ellipsoid))};var lN=Yw;function sg(){}sg.packedLength=m.packedLength;sg.unpack=m.unpack;sg.pack=m.pack;var K6;function Xw(t,n){return n[0]==="#"&&(n=K6+n),ng.fromString(t,n)}function Kre(t,n,i){if(f(i.reference))return Xw(n,i.reference);if(f(i.velocityReference)){let o=Xw(n,i.velocityReference);switch(t){case m:case sg:return new yT(o,t===sg);case Me:return new lN(o)}}throw new he(`${JSON.stringify(i)} is not valid CZML.`)}function j5e(t,n){return new rh(function(i,o){return n(t.getValue(i,o))},t.isConstant)}var Di=new m,yc=new aN,Fa=new de,Ly=new xn,uN=new Me;function q5e(t){let n=t.rgbaf;if(f(n))return n;let i=t.rgba;if(!f(i))return;let o=i.length;if(o===z.packedLength)return[z.byteToFloat(i[0]),z.byteToFloat(i[1]),z.byteToFloat(i[2]),z.byteToFloat(i[3])];n=new Array(o);for(let r=0;r<o;r+=5)n[r]=i[r],n[r+1]=z.byteToFloat(i[r+1]),n[r+2]=z.byteToFloat(i[r+2]),n[r+3]=z.byteToFloat(i[r+3]),n[r+4]=z.byteToFloat(i[r+4]);return n}function Jre(t,n){let i=A(t.uri,t);return f(n)?n.getDerivedResource({url:i}):Ie.createIfNeeded(i)}function Y5e(t){let n=t.wsen;if(f(n))return n;let i=t.wsenDegrees;if(!f(i))return;let o=i.length;if(o===le.packedLength)return[B.toRadians(i[0]),B.toRadians(i[1]),B.toRadians(i[2]),B.toRadians(i[3])];n=new Array(o);for(let r=0;r<o;r+=5)n[r]=i[r],n[r+1]=B.toRadians(i[r+1]),n[r+2]=B.toRadians(i[r+2]),n[r+3]=B.toRadians(i[r+3]),n[r+4]=B.toRadians(i[r+4]);return n}function X5e(t){let n=t.length;if(yc.magnitude=1,n===2)return yc.clock=t[0],yc.cone=t[1],m.fromSpherical(yc,Di),[Di.x,Di.y,Di.z];let i=new Array(n/3*4);for(let o=0,r=0;o<n;o+=3,r+=4)i[r]=t[o],yc.clock=t[o+1],yc.cone=t[o+2],m.fromSpherical(yc,Di),i[r+1]=Di.x,i[r+2]=Di.y,i[r+3]=Di.z;return i}function K5e(t){let n=t.length;if(n===3)return yc.clock=t[0],yc.cone=t[1],yc.magnitude=t[2],m.fromSpherical(yc,Di),[Di.x,Di.y,Di.z];let i=new Array(n);for(let o=0;o<n;o+=4)i[o]=t[o],yc.clock=t[o+1],yc.cone=t[o+2],yc.magnitude=t[o+3],m.fromSpherical(yc,Di),i[o+1]=Di.x,i[o+2]=Di.y,i[o+3]=Di.z;return i}function J5e(t){let n=t.length;if(n===3)return Fa.longitude=t[0],Fa.latitude=t[1],Fa.height=t[2],oe.WGS84.cartographicToCartesian(Fa,Di),[Di.x,Di.y,Di.z];let i=new Array(n);for(let o=0;o<n;o+=4)i[o]=t[o],Fa.longitude=t[o+1],Fa.latitude=t[o+2],Fa.height=t[o+3],oe.WGS84.cartographicToCartesian(Fa,Di),i[o+1]=Di.x,i[o+2]=Di.y,i[o+3]=Di.z;return i}function Z5e(t){let n=t.length;if(n===3)return Fa.longitude=B.toRadians(t[0]),Fa.latitude=B.toRadians(t[1]),Fa.height=t[2],oe.WGS84.cartographicToCartesian(Fa,Di),[Di.x,Di.y,Di.z];let i=new Array(n);for(let o=0;o<n;o+=4)i[o]=t[o],Fa.longitude=B.toRadians(t[o+1]),Fa.latitude=B.toRadians(t[o+2]),Fa.height=t[o+3],oe.WGS84.cartographicToCartesian(Fa,Di),i[o+1]=Di.x,i[o+2]=Di.y,i[o+3]=Di.z;return i}function J6(t){let n=t.cartesian;if(f(n))return n;let i=t.cartesianVelocity;if(f(i))return i;let o=t.unitCartesian;if(f(o))return o;let r=t.unitSpherical;if(f(r))return X5e(r);let s=t.spherical;if(f(s))return K5e(s);let a=t.cartographicRadians;if(f(a))return J5e(a);let c=t.cartographicDegrees;if(f(c))return Z5e(c);throw new he(`${JSON.stringify(t)} is not a valid CZML interval.`)}function Zre(t,n){m.unpack(t,n,Di),m.normalize(Di,Di),m.pack(Di,t,n)}function Q5e(t){let n=J6(t);if(n.length===3)return Zre(n,0),n;for(let i=1;i<n.length;i+=4)Zre(n,i);return n}function Qre(t,n){Me.unpack(t,n,uN),Me.normalize(uN,uN),Me.pack(uN,t,n)}function $5e(t){let n=t.unitQuaternion;if(f(n)){if(n.length===4)return Qre(n,0),n;for(let i=1;i<n.length;i+=5)Qre(n,i)}return n}function $re(t){return typeof t=="boolean"?Boolean:typeof t=="number"?Number:typeof t=="string"?String:t.hasOwnProperty("array")?Array:t.hasOwnProperty("boolean")?Boolean:t.hasOwnProperty("boundingRectangle")?He:t.hasOwnProperty("cartesian2")?W:t.hasOwnProperty("cartesian")||t.hasOwnProperty("spherical")||t.hasOwnProperty("cartographicRadians")||t.hasOwnProperty("cartographicDegrees")?m:t.hasOwnProperty("unitCartesian")||t.hasOwnProperty("unitSpherical")?sg:t.hasOwnProperty("rgba")||t.hasOwnProperty("rgbaf")?z:t.hasOwnProperty("arcType")?Zt:t.hasOwnProperty("classificationType")?Un:t.hasOwnProperty("colorBlendMode")?oc:t.hasOwnProperty("cornerType")?wi:t.hasOwnProperty("heightReference")?Ge:t.hasOwnProperty("horizontalOrigin")?ui:t.hasOwnProperty("date")?te:t.hasOwnProperty("labelStyle")?Lo:t.hasOwnProperty("number")?Number:t.hasOwnProperty("nearFarScalar")?Pt:t.hasOwnProperty("distanceDisplayCondition")?wt:t.hasOwnProperty("object")||t.hasOwnProperty("value")?Object:t.hasOwnProperty("unitQuaternion")?Me:t.hasOwnProperty("shadowMode")?gn:t.hasOwnProperty("string")?String:t.hasOwnProperty("stripeOrientation")?yh:t.hasOwnProperty("wsen")||t.hasOwnProperty("wsenDegrees")?le:t.hasOwnProperty("uri")?Jw.default:t.hasOwnProperty("verticalOrigin")?vn:Object}function e6e(t,n,i){switch(t){case Zt:return Zt[A(n.arcType,n)];case Array:return n.array;case Boolean:return A(n.boolean,n);case He:return n.boundingRectangle;case W:return n.cartesian2;case m:return J6(n);case sg:return Q5e(n);case z:return q5e(n);case Un:return Un[A(n.classificationType,n)];case oc:return oc[A(n.colorBlendMode,n)];case wi:return wi[A(n.cornerType,n)];case Ge:return Ge[A(n.heightReference,n)];case ui:return ui[A(n.horizontalOrigin,n)];case Image:return Jre(n,i);case te:return te.fromIso8601(A(n.date,n));case Lo:return Lo[A(n.labelStyle,n)];case Number:return A(n.number,n);case Pt:return n.nearFarScalar;case wt:return n.distanceDisplayCondition;case Object:return A(A(n.object,n.value),n);case Me:return $5e(n);case Xf:return A(n.number,n);case gn:return gn[A(A(n.shadowMode,n.shadows),n)];case String:return A(n.string,n);case yh:return yh[A(n.stripeOrientation,n)];case le:return Y5e(n);case Jw.default:return Jre(n,i);case vn:return vn[A(n.verticalOrigin,n)];default:throw new he(t)}}var t6e={HERMITE:rN,LAGRANGE:sN,LINEAR:uT};function fN(t,n){let i=t.interpolationAlgorithm,o=t.interpolationDegree;(f(i)||f(o))&&n.setInterpolationOptions({interpolationAlgorithm:t6e[i],interpolationDegree:o});let r=t.forwardExtrapolationType;f(r)&&(n.forwardExtrapolationType=zu[r]);let s=t.forwardExtrapolationDuration;f(s)&&(n.forwardExtrapolationDuration=s);let a=t.backwardExtrapolationType;f(a)&&(n.backwardExtrapolationType=zu[a]);let c=t.backwardExtrapolationDuration;f(c)&&(n.backwardExtrapolationDuration=c)}var ese={iso8601:void 0};function nr(t){if(!!f(t))return ese.iso8601=t,xn.fromIso8601(ese)}function Z6(t){let n=Ue.MAXIMUM_INTERVAL.clone();return n.data=t,n}function tse(t){let n=new pc;return n.intervals.addInterval(Z6(t)),n}function nse(t){let n=new ia(t.referenceFrame);return n.intervals.addInterval(Z6(t)),n}function dN(t,n,i,o,r,s,a){let c=nr(o.interval);f(r)&&(f(c)?c=xn.intersect(c,r,Ly):c=r);let l,u,d,h=!f(o.reference)&&!f(o.velocityReference),_=f(c)&&!c.equals(Ue.MAXIMUM_INTERVAL);if(o.delete===!0){if(!_){n[i]=void 0;return}return hse(n[i],c)}let y=!1;if(h){if(u=e6e(t,o,s),!f(u))return;l=A(t.packedLength,1),d=A(u.length,1),y=!f(o.array)&&typeof u!="string"&&d>l&&t!==Object}let p=typeof t.unpack=="function"&&t!==Xf;if(!y&&!_){h?n[i]=new Kn(p?t.unpack(u,0):u):n[i]=Kre(t,a,o);return}let C=n[i],x,T=o.epoch;if(f(T)&&(x=te.fromIso8601(T)),y&&!_){C instanceof Hu||(n[i]=C=new Hu(t)),C.addSamplesPackedArray(u,x),fN(o,C);return}let E;if(!y&&_){c=c.clone(),h?c.data=p?t.unpack(u,0):u:c.data=Kre(t,a,o),f(C)||(n[i]=C=h?new rg:new pc),h&&C instanceof rg?C.intervals.addInterval(c):C instanceof pc?(h&&(c.data=new Kn(c.data)),C.intervals.addInterval(c)):(n[i]=C=tse(C),h&&(c.data=new Kn(c.data)),C.intervals.addInterval(c));return}f(C)||(n[i]=C=new pc),C instanceof pc||(n[i]=C=tse(C));let S=C.intervals;E=S.findInterval(c),(!f(E)||!(E.data instanceof Hu))&&(E=c.clone(),E.data=new Hu(t),S.addInterval(E)),E.data.addSamplesPackedArray(u,x),fN(o,E.data)}function hse(t,n){if(t instanceof Hu){t.removeSamples(n);return}else if(t instanceof rg){t.intervals.removeInterval(n);return}else if(t instanceof pc){let i=t.intervals;for(let o=0;o<i.length;++o){let r=xn.intersect(i.get(o),n,Ly);r.isEmpty||hse(r.data,n)}i.removeInterval(n);return}}function pe(t,n,i,o,r,s,a){if(!!f(o))if(Array.isArray(o))for(let c=0,l=o.length;c<l;++c)dN(t,n,i,o[c],r,s,a);else dN(t,n,i,o,r,s,a)}function ise(t,n,i,o,r,s){let a=nr(i.interval);f(o)&&(f(a)?a=xn.intersect(a,o,Ly):a=o);let c=f(i.cartesianVelocity)?1:0,l=m.packedLength*(c+1),u,d,h=!f(i.reference),_=f(a)&&!a.equals(Ue.MAXIMUM_INTERVAL);if(i.delete===!0){if(!_){t[n]=void 0;return}return mse(t[n],a)}let y,p=!1;if(h&&(f(i.referenceFrame)&&(y=no[i.referenceFrame]),y=A(y,no.FIXED),u=J6(i),d=A(u.length,1),p=d>l),!p&&!_){h?t[n]=new Jc(m.unpack(u),y):t[n]=Xw(s,i.reference);return}let C=t[n],x,T=i.epoch;if(f(T)&&(x=te.fromIso8601(T)),p&&!_){(!(C instanceof oa)||f(y)&&C.referenceFrame!==y)&&(t[n]=C=new oa(y,c)),C.addSamplesPackedArray(u,x),fN(i,C);return}let E;if(!p&&_){a=a.clone(),h?a.data=m.unpack(u):a.data=Xw(s,i.reference),f(C)||(h?C=new og(y):C=new ia(y),t[n]=C),h&&C instanceof og&&f(y)&&C.referenceFrame===y?C.intervals.addInterval(a):C instanceof ia?(h&&(a.data=new Jc(a.data,y)),C.intervals.addInterval(a)):(t[n]=C=nse(C),h&&(a.data=new Jc(a.data,y)),C.intervals.addInterval(a));return}f(C)?C instanceof ia||(t[n]=C=nse(C)):t[n]=C=new ia(y);let S=C.intervals;E=S.findInterval(a),(!f(E)||!(E.data instanceof oa)||f(y)&&E.data.referenceFrame!==y)&&(E=a.clone(),E.data=new oa(y,c),S.addInterval(E)),E.data.addSamplesPackedArray(u,x),fN(i,E.data)}function mse(t,n){if(t instanceof oa){t.removeSamples(n);return}else if(t instanceof og){t.intervals.removeInterval(n);return}else if(t instanceof ia){let i=t.intervals;for(let o=0;o<i.length;++o){let r=xn.intersect(i.get(o),n,Ly);r.isEmpty||mse(r.data,n)}i.removeInterval(n);return}}function pse(t,n,i,o,r,s){if(!!f(i))if(Array.isArray(i))for(let a=0,c=i.length;a<c;++a)ise(t,n,i[a],o,r,s);else ise(t,n,i,o,r,s)}function ose(t,n,i,o){f(i.references)?hN(t,n,i.references,i.interval,o,jw,pc):(f(i.cartesian2)?i.array=W.unpackArray(i.cartesian2):f(i.cartesian)&&(i.array=W.unpackArray(i.cartesian)),f(i.array)&&pe(Array,t,n,i,void 0,void 0,o))}function rse(t,n,i,o,r,s){let a=nr(i.interval);f(o)&&(f(a)?a=xn.intersect(a,o,Ly):a=o);let c=t[n],l,u;if(f(a)){c instanceof Bw||(c=new Bw,t[n]=c);let h=c.intervals;u=h.findInterval({start:a.start,stop:a.stop}),f(u)?l=u.data:(u=a.clone(),h.addInterval(u))}else l=c;let d;f(i.solidColor)?(l instanceof Rt||(l=new Rt),d=i.solidColor,pe(z,l,"color",d.color,void 0,void 0,s)):f(i.grid)?(l instanceof zw||(l=new zw),d=i.grid,pe(z,l,"color",d.color,void 0,r,s),pe(Number,l,"cellAlpha",d.cellAlpha,void 0,r,s),pe(W,l,"lineCount",d.lineCount,void 0,r,s),pe(W,l,"lineThickness",d.lineThickness,void 0,r,s),pe(W,l,"lineOffset",d.lineOffset,void 0,r,s)):f(i.image)?(l instanceof $0||(l=new $0),d=i.image,pe(Image,l,"image",d.image,void 0,r,s),pe(W,l,"repeat",d.repeat,void 0,r,s),pe(z,l,"color",d.color,void 0,r,s),pe(Boolean,l,"transparent",d.transparent,void 0,r,s)):f(i.stripe)?(l instanceof qw||(l=new qw),d=i.stripe,pe(yh,l,"orientation",d.orientation,void 0,r,s),pe(z,l,"evenColor",d.evenColor,void 0,r,s),pe(z,l,"oddColor",d.oddColor,void 0,r,s),pe(Number,l,"offset",d.offset,void 0,r,s),pe(Number,l,"repeat",d.repeat,void 0,r,s)):f(i.polylineOutline)?(l instanceof Oy||(l=new Oy),d=i.polylineOutline,pe(z,l,"color",d.color,void 0,r,s),pe(z,l,"outlineColor",d.outlineColor,void 0,r,s),pe(Number,l,"outlineWidth",d.outlineWidth,void 0,r,s)):f(i.polylineGlow)?(l instanceof Ww||(l=new Ww),d=i.polylineGlow,pe(z,l,"color",d.color,void 0,r,s),pe(Number,l,"glowPower",d.glowPower,void 0,r,s),pe(Number,l,"taperPower",d.taperPower,void 0,r,s)):f(i.polylineArrow)?(l instanceof Hw||(l=new Hw),d=i.polylineArrow,pe(z,l,"color",d.color,void 0,void 0,s)):f(i.polylineDash)?(l instanceof Gw||(l=new Gw),d=i.polylineDash,pe(z,l,"color",d.color,void 0,void 0,s),pe(z,l,"gapColor",d.gapColor,void 0,void 0,s),pe(Number,l,"dashLength",d.dashLength,void 0,r,s),pe(Number,l,"dashPattern",d.dashPattern,void 0,r,s)):f(i.checkerboard)&&(l instanceof Dw||(l=new Dw),d=i.checkerboard,pe(z,l,"evenColor",d.evenColor,void 0,r,s),pe(z,l,"oddColor",d.oddColor,void 0,r,s),pe(W,l,"repeat",d.repeat,void 0,r,s)),f(u)?u.data=l:t[n]=l}function Fl(t,n,i,o,r,s){if(!!f(i))if(Array.isArray(i))for(let a=0,c=i.length;a<c;++a)rse(t,n,i[a],o,r,s);else rse(t,n,i,o,r,s)}function n6e(t,n,i,o){let r=n.name;f(r)&&(t.name=n.name)}function i6e(t,n,i,o){let r=n.description;f(r)&&pe(String,t,"description",r,void 0,o,i)}function o6e(t,n,i,o){let r=n.position;f(r)&&pse(t,"position",r,void 0,o,i)}function r6e(t,n,i,o){let r=n.viewFrom;f(r)&&pe(m,t,"viewFrom",r,void 0,o,i)}function s6e(t,n,i,o){let r=n.orientation;f(r)&&pe(Me,t,"orientation",r,void 0,o,i)}function a6e(t,n,i,o){let r=n.properties;if(f(r)){f(t.properties)||(t.properties=new Pl);for(let s in r)if(r.hasOwnProperty(s)){t.properties.hasProperty(s)||t.properties.addProperty(s);let a=r[s];if(Array.isArray(a))for(let c=0,l=a.length;c<l;++c)dN($re(a[c]),t.properties,s,a[c],void 0,o,i);else dN($re(a),t.properties,s,a,void 0,o,i)}}}function hN(t,n,i,o,r,s,a){let c=i.map(function(l){return Xw(r,l)});if(f(o)){o=nr(o);let l=t[n];if(!(l instanceof a)){let u=new a;u.intervals.addInterval(Z6(l)),t[n]=l=u}o.data=new s(c),l.intervals.addInterval(o)}else t[n]=new s(c)}function sse(t,n,i,o){let r=i.references;f(r)?hN(t,n,r,i.interval,o,jw,pc):pe(Array,t,n,i,void 0,void 0,o)}function ase(t,n,i,o){if(!!f(i))if(Array.isArray(i))for(let r=0,s=i.length;r<s;++r)sse(t,n,i[r],o);else sse(t,n,i,o)}function cse(t,n,i,o){let r=i.references;f(r)?hN(t,n,r,i.interval,o,eg,ia):(f(i.cartesian)?i.array=m.unpackArray(i.cartesian):f(i.cartographicRadians)?i.array=m.fromRadiansArrayHeights(i.cartographicRadians):f(i.cartographicDegrees)&&(i.array=m.fromDegreesArrayHeights(i.cartographicDegrees)),f(i.array)&&pe(Array,t,n,i,void 0,void 0,o))}function Zw(t,n,i,o){if(!!f(i))if(Array.isArray(i))for(let r=0,s=i.length;r<s;++r)cse(t,n,i[r],o);else cse(t,n,i,o)}function c6e(t){return m.unpackArray(t)}function l6e(t){return m.fromRadiansArrayHeights(t)}function u6e(t){return m.fromDegreesArrayHeights(t)}function lse(t,n,i,o){let r=i.references;if(f(r)){let s=r.map(function(a){let c={};return hN(c,"positions",a,i.interval,o,eg,ia),c.positions});t[n]=new eg(s)}else f(i.cartesian)?i.array=i.cartesian.map(c6e):f(i.cartographicRadians)?i.array=i.cartographicRadians.map(l6e):f(i.cartographicDegrees)&&(i.array=i.cartographicDegrees.map(u6e)),f(i.array)&&pe(Array,t,n,i,void 0,void 0,o)}function f6e(t,n,i,o){if(!!f(i))if(Array.isArray(i))for(let r=0,s=i.length;r<s;++r)lse(t,n,i[r],o);else lse(t,n,i,o)}function d6e(t,n,i,o){if(!!f(i))if(Array.isArray(i))for(let r=0,s=i.length;r<s;r++)ose(t,n,i[r],o);else ose(t,n,i,o)}function h6e(t,n,i,o){let r=n.availability;if(!f(r))return;let s;if(Array.isArray(r))for(let a=0,c=r.length;a<c;++a)f(s)||(s=new Lr),s.addInterval(nr(r[a]));else s=new Lr,s.addInterval(nr(r));t.availability=s}function m6e(t,n,i,o,r){!f(n)||pe(sg,t,"alignedAxis",n,i,o,r)}function p6e(t,n,i,o){let r=n.billboard;if(!f(r))return;let s=nr(r.interval),a=t.billboard;f(a)||(t.billboard=a=new Qa),pe(Boolean,a,"show",r.show,s,o,i),pe(Image,a,"image",r.image,s,o,i),pe(Number,a,"scale",r.scale,s,o,i),pe(W,a,"pixelOffset",r.pixelOffset,s,o,i),pe(m,a,"eyeOffset",r.eyeOffset,s,o,i),pe(ui,a,"horizontalOrigin",r.horizontalOrigin,s,o,i),pe(vn,a,"verticalOrigin",r.verticalOrigin,s,o,i),pe(Ge,a,"heightReference",r.heightReference,s,o,i),pe(z,a,"color",r.color,s,o,i),pe(Xf,a,"rotation",r.rotation,s,o,i),m6e(a,r.alignedAxis,s,o,i),pe(Boolean,a,"sizeInMeters",r.sizeInMeters,s,o,i),pe(Number,a,"width",r.width,s,o,i),pe(Number,a,"height",r.height,s,o,i),pe(Pt,a,"scaleByDistance",r.scaleByDistance,s,o,i),pe(Pt,a,"translucencyByDistance",r.translucencyByDistance,s,o,i),pe(Pt,a,"pixelOffsetScaleByDistance",r.pixelOffsetScaleByDistance,s,o,i),pe(He,a,"imageSubRegion",r.imageSubRegion,s,o,i),pe(wt,a,"distanceDisplayCondition",r.distanceDisplayCondition,s,o,i),pe(Number,a,"disableDepthTestDistance",r.disableDepthTestDistance,s,o,i)}function _6e(t,n,i,o){let r=n.box;if(!f(r))return;let s=nr(r.interval),a=t.box;f(a)||(t.box=a=new dx),pe(Boolean,a,"show",r.show,s,o,i),pe(m,a,"dimensions",r.dimensions,s,o,i),pe(Ge,a,"heightReference",r.heightReference,s,o,i),pe(Boolean,a,"fill",r.fill,s,o,i),Fl(a,"material",r.material,s,o,i),pe(Boolean,a,"outline",r.outline,s,o,i),pe(z,a,"outlineColor",r.outlineColor,s,o,i),pe(Number,a,"outlineWidth",r.outlineWidth,s,o,i),pe(gn,a,"shadows",r.shadows,s,o,i),pe(wt,a,"distanceDisplayCondition",r.distanceDisplayCondition,s,o,i)}function g6e(t,n,i,o){let r=n.corridor;if(!f(r))return;let s=nr(r.interval),a=t.corridor;f(a)||(t.corridor=a=new mx),pe(Boolean,a,"show",r.show,s,o,i),Zw(a,"positions",r.positions,i),pe(Number,a,"width",r.width,s,o,i),pe(Number,a,"height",r.height,s,o,i),pe(Ge,a,"heightReference",r.heightReference,s,o,i),pe(Number,a,"extrudedHeight",r.extrudedHeight,s,o,i),pe(Ge,a,"extrudedHeightReference",r.extrudedHeightReference,s,o,i),pe(wi,a,"cornerType",r.cornerType,s,o,i),pe(Number,a,"granularity",r.granularity,s,o,i),pe(Boolean,a,"fill",r.fill,s,o,i),Fl(a,"material",r.material,s,o,i),pe(Boolean,a,"outline",r.outline,s,o,i),pe(z,a,"outlineColor",r.outlineColor,s,o,i),pe(Number,a,"outlineWidth",r.outlineWidth,s,o,i),pe(gn,a,"shadows",r.shadows,s,o,i),pe(wt,a,"distanceDisplayCondition",r.distanceDisplayCondition,s,o,i),pe(Un,a,"classificationType",r.classificationType,s,o,i),pe(Number,a,"zIndex",r.zIndex,s,o,i)}function y6e(t,n,i,o){let r=n.cylinder;if(!f(r))return;let s=nr(r.interval),a=t.cylinder;f(a)||(t.cylinder=a=new px),pe(Boolean,a,"show",r.show,s,o,i),pe(Number,a,"length",r.length,s,o,i),pe(Number,a,"topRadius",r.topRadius,s,o,i),pe(Number,a,"bottomRadius",r.bottomRadius,s,o,i),pe(Ge,a,"heightReference",r.heightReference,s,o,i),pe(Boolean,a,"fill",r.fill,s,o,i),Fl(a,"material",r.material,s,o,i),pe(Boolean,a,"outline",r.outline,s,o,i),pe(z,a,"outlineColor",r.outlineColor,s,o,i),pe(Number,a,"outlineWidth",r.outlineWidth,s,o,i),pe(Number,a,"numberOfVerticalLines",r.numberOfVerticalLines,s,o,i),pe(Number,a,"slices",r.slices,s,o,i),pe(gn,a,"shadows",r.shadows,s,o,i),pe(wt,a,"distanceDisplayCondition",r.distanceDisplayCondition,s,o,i)}function A6e(t,n){let i=t.version;if(f(i)&&typeof i=="string"){let s=i.split(".");if(s.length===2){if(s[0]!=="1")throw new he("Cesium only supports CZML version 1.");n._version=i}}if(!f(n._version))throw new he("CZML version information invalid.  It is expected to be a property on the document object in the <Major>.<Minor> version format.");let o=n._documentPacket;f(t.name)&&(o.name=t.name);let r=t.clock;if(f(r)){let s=o.clock;f(s)?(s.interval=A(r.interval,s.interval),s.currentTime=A(r.currentTime,s.currentTime),s.range=A(r.range,s.range),s.step=A(r.step,s.step),s.multiplier=A(r.multiplier,s.multiplier)):o.clock={interval:r.interval,currentTime:r.currentTime,range:r.range,step:r.step,multiplier:r.multiplier}}}function C6e(t,n,i,o){let r=n.ellipse;if(!f(r))return;let s=nr(r.interval),a=t.ellipse;f(a)||(t.ellipse=a=new _x),pe(Boolean,a,"show",r.show,s,o,i),pe(Number,a,"semiMajorAxis",r.semiMajorAxis,s,o,i),pe(Number,a,"semiMinorAxis",r.semiMinorAxis,s,o,i),pe(Number,a,"height",r.height,s,o,i),pe(Ge,a,"heightReference",r.heightReference,s,o,i),pe(Number,a,"extrudedHeight",r.extrudedHeight,s,o,i),pe(Ge,a,"extrudedHeightReference",r.extrudedHeightReference,s,o,i),pe(Xf,a,"rotation",r.rotation,s,o,i),pe(Xf,a,"stRotation",r.stRotation,s,o,i),pe(Number,a,"granularity",r.granularity,s,o,i),pe(Boolean,a,"fill",r.fill,s,o,i),Fl(a,"material",r.material,s,o,i),pe(Boolean,a,"outline",r.outline,s,o,i),pe(z,a,"outlineColor",r.outlineColor,s,o,i),pe(Number,a,"outlineWidth",r.outlineWidth,s,o,i),pe(Number,a,"numberOfVerticalLines",r.numberOfVerticalLines,s,o,i),pe(gn,a,"shadows",r.shadows,s,o,i),pe(wt,a,"distanceDisplayCondition",r.distanceDisplayCondition,s,o,i),pe(Un,a,"classificationType",r.classificationType,s,o,i),pe(Number,a,"zIndex",r.zIndex,s,o,i)}function x6e(t,n,i,o){let r=n.ellipsoid;if(!f(r))return;let s=nr(r.interval),a=t.ellipsoid;f(a)||(t.ellipsoid=a=new gx),pe(Boolean,a,"show",r.show,s,o,i),pe(m,a,"radii",r.radii,s,o,i),pe(m,a,"innerRadii",r.innerRadii,s,o,i),pe(Number,a,"minimumClock",r.minimumClock,s,o,i),pe(Number,a,"maximumClock",r.maximumClock,s,o,i),pe(Number,a,"minimumCone",r.minimumCone,s,o,i),pe(Number,a,"maximumCone",r.maximumCone,s,o,i),pe(Ge,a,"heightReference",r.heightReference,s,o,i),pe(Boolean,a,"fill",r.fill,s,o,i),Fl(a,"material",r.material,s,o,i),pe(Boolean,a,"outline",r.outline,s,o,i),pe(z,a,"outlineColor",r.outlineColor,s,o,i),pe(Number,a,"outlineWidth",r.outlineWidth,s,o,i),pe(Number,a,"stackPartitions",r.stackPartitions,s,o,i),pe(Number,a,"slicePartitions",r.slicePartitions,s,o,i),pe(Number,a,"subdivisions",r.subdivisions,s,o,i),pe(gn,a,"shadows",r.shadows,s,o,i),pe(wt,a,"distanceDisplayCondition",r.distanceDisplayCondition,s,o,i)}function T6e(t,n,i,o){let r=n.label;if(!f(r))return;let s=nr(r.interval),a=t.label;f(a)||(t.label=a=new th),pe(Boolean,a,"show",r.show,s,o,i),pe(String,a,"text",r.text,s,o,i),pe(String,a,"font",r.font,s,o,i),pe(Lo,a,"style",r.style,s,o,i),pe(Number,a,"scale",r.scale,s,o,i),pe(Boolean,a,"showBackground",r.showBackground,s,o,i),pe(z,a,"backgroundColor",r.backgroundColor,s,o,i),pe(W,a,"backgroundPadding",r.backgroundPadding,s,o,i),pe(W,a,"pixelOffset",r.pixelOffset,s,o,i),pe(m,a,"eyeOffset",r.eyeOffset,s,o,i),pe(ui,a,"horizontalOrigin",r.horizontalOrigin,s,o,i),pe(vn,a,"verticalOrigin",r.verticalOrigin,s,o,i),pe(Ge,a,"heightReference",r.heightReference,s,o,i),pe(z,a,"fillColor",r.fillColor,s,o,i),pe(z,a,"outlineColor",r.outlineColor,s,o,i),pe(Number,a,"outlineWidth",r.outlineWidth,s,o,i),pe(Pt,a,"translucencyByDistance",r.translucencyByDistance,s,o,i),pe(Pt,a,"pixelOffsetScaleByDistance",r.pixelOffsetScaleByDistance,s,o,i),pe(Pt,a,"scaleByDistance",r.scaleByDistance,s,o,i),pe(wt,a,"distanceDisplayCondition",r.distanceDisplayCondition,s,o,i),pe(Number,a,"disableDepthTestDistance",r.disableDepthTestDistance,s,o,i)}function E6e(t,n,i,o){let r=n.model;if(!f(r))return;let s=nr(r.interval),a=t.model;f(a)||(t.model=a=new y_),pe(Boolean,a,"show",r.show,s,o,i),pe(Jw.default,a,"uri",r.gltf,s,o,i),pe(Number,a,"scale",r.scale,s,o,i),pe(Number,a,"minimumPixelSize",r.minimumPixelSize,s,o,i),pe(Number,a,"maximumScale",r.maximumScale,s,o,i),pe(Boolean,a,"incrementallyLoadTextures",r.incrementallyLoadTextures,s,o,i),pe(Boolean,a,"runAnimations",r.runAnimations,s,o,i),pe(Boolean,a,"clampAnimations",r.clampAnimations,s,o,i),pe(gn,a,"shadows",r.shadows,s,o,i),pe(Ge,a,"heightReference",r.heightReference,s,o,i),pe(z,a,"silhouetteColor",r.silhouetteColor,s,o,i),pe(Number,a,"silhouetteSize",r.silhouetteSize,s,o,i),pe(z,a,"color",r.color,s,o,i),pe(oc,a,"colorBlendMode",r.colorBlendMode,s,o,i),pe(Number,a,"colorBlendAmount",r.colorBlendAmount,s,o,i),pe(wt,a,"distanceDisplayCondition",r.distanceDisplayCondition,s,o,i);let c,l,u=r.nodeTransformations;if(f(u))if(Array.isArray(u))for(c=0,l=u.length;c<l;++c)use(a,u[c],s,o,i);else use(a,u,s,o,i);let d=r.articulations;if(f(d))if(Array.isArray(d))for(c=0,l=d.length;c<l;++c)fse(a,d[c],s,o,i);else fse(a,d,s,o,i)}function use(t,n,i,o,r){let s=nr(n.interval);f(i)&&(f(s)?s=xn.intersect(s,i,Ly):s=i);let a=t.nodeTransformations,c=Object.keys(n);for(let l=0,u=c.length;l<u;++l){let d=c[l];if(d==="interval")continue;let h=n[d];if(!f(h))continue;f(a)||(t.nodeTransformations=a=new Pl),a.hasProperty(d)||a.addProperty(d);let _=a[d];f(_)||(a[d]=_=new yx),pe(m,_,"translation",h.translation,s,o,r),pe(Me,_,"rotation",h.rotation,s,o,r),pe(m,_,"scale",h.scale,s,o,r)}}function fse(t,n,i,o,r){let s=nr(n.interval);f(i)&&(f(s)?s=xn.intersect(s,i,Ly):s=i);let a=t.articulations,c=Object.keys(n);for(let l=0,u=c.length;l<u;++l){let d=c[l];if(d==="interval")continue;let h=n[d];!f(h)||(f(a)||(t.articulations=a=new Pl),a.hasProperty(d)||a.addProperty(d),pe(Number,a,d,h,s,o,r))}}function b6e(t,n,i,o){let r=n.path;if(!f(r))return;let s=nr(r.interval),a=t.path;f(a)||(t.path=a=new A_),pe(Boolean,a,"show",r.show,s,o,i),pe(Number,a,"leadTime",r.leadTime,s,o,i),pe(Number,a,"trailTime",r.trailTime,s,o,i),pe(Number,a,"width",r.width,s,o,i),pe(Number,a,"resolution",r.resolution,s,o,i),Fl(a,"material",r.material,s,o,i),pe(wt,a,"distanceDisplayCondition",r.distanceDisplayCondition,s,o,i)}function S6e(t,n,i,o){let r=n.point;if(!f(r))return;let s=nr(r.interval),a=t.point;f(a)||(t.point=a=new Cx),pe(Boolean,a,"show",r.show,s,o,i),pe(Number,a,"pixelSize",r.pixelSize,s,o,i),pe(Ge,a,"heightReference",r.heightReference,s,o,i),pe(z,a,"color",r.color,s,o,i),pe(z,a,"outlineColor",r.outlineColor,s,o,i),pe(Number,a,"outlineWidth",r.outlineWidth,s,o,i),pe(Pt,a,"scaleByDistance",r.scaleByDistance,s,o,i),pe(Pt,a,"translucencyByDistance",r.translucencyByDistance,s,o,i),pe(wt,a,"distanceDisplayCondition",r.distanceDisplayCondition,s,o,i),pe(Number,a,"disableDepthTestDistance",r.disableDepthTestDistance,s,o,i)}function Kw(t){this.polygon=t,this._definitionChanged=new Ae}Object.defineProperties(Kw.prototype,{isConstant:{get:function(){let t=this.polygon._positions,n=this.polygon._holes;return(!f(t)||t.isConstant)&&(!f(n)||n.isConstant)}},definitionChanged:{get:function(){return this._definitionChanged}}});Kw.prototype.getValue=function(t,n){let i;f(this.polygon._positions)&&(i=this.polygon._positions.getValue(t));let o;return f(this.polygon._holes)&&(o=this.polygon._holes.getValue(t),f(o)&&(o=o.map(function(r){return new Zc(r)}))),f(n)?(n.positions=i,n.holes=o,n):new Zc(i,o)};Kw.prototype.equals=function(t){return this===t||t instanceof Kw&&q.equals(this.polygon._positions,t.polygon._positions)&&q.equals(this.polygon._holes,t.polygon._holes)};function w6e(t,n,i,o){let r=n.polygon;if(!f(r))return;let s=nr(r.interval),a=t.polygon;f(a)||(t.polygon=a=new nh),pe(Boolean,a,"show",r.show,s,o,i),Zw(a,"_positions",r.positions,i),f6e(a,"_holes",r.holes,i),(f(a._positions)||f(a._holes))&&(a.hierarchy=new Kw(a)),pe(Number,a,"height",r.height,s,o,i),pe(Ge,a,"heightReference",r.heightReference,s,o,i),pe(Number,a,"extrudedHeight",r.extrudedHeight,s,o,i),pe(Ge,a,"extrudedHeightReference",r.extrudedHeightReference,s,o,i),pe(Xf,a,"stRotation",r.stRotation,s,o,i),pe(Number,a,"granularity",r.granularity,s,o,i),pe(Boolean,a,"fill",r.fill,s,o,i),Fl(a,"material",r.material,s,o,i),pe(Boolean,a,"outline",r.outline,s,o,i),pe(z,a,"outlineColor",r.outlineColor,s,o,i),pe(Number,a,"outlineWidth",r.outlineWidth,s,o,i),pe(Boolean,a,"perPositionHeight",r.perPositionHeight,s,o,i),pe(Boolean,a,"closeTop",r.closeTop,s,o,i),pe(Boolean,a,"closeBottom",r.closeBottom,s,o,i),pe(Zt,a,"arcType",r.arcType,s,o,i),pe(gn,a,"shadows",r.shadows,s,o,i),pe(wt,a,"distanceDisplayCondition",r.distanceDisplayCondition,s,o,i),pe(Un,a,"classificationType",r.classificationType,s,o,i),pe(Number,a,"zIndex",r.zIndex,s,o,i)}function D6e(t){return t?Zt.GEODESIC:Zt.NONE}function v6e(t,n,i,o){let r=n.polyline;if(!f(r))return;let s=nr(r.interval),a=t.polyline;if(f(a)||(t.polyline=a=new dc),pe(Boolean,a,"show",r.show,s,o,i),Zw(a,"positions",r.positions,i),pe(Number,a,"width",r.width,s,o,i),pe(Number,a,"granularity",r.granularity,s,o,i),Fl(a,"material",r.material,s,o,i),Fl(a,"depthFailMaterial",r.depthFailMaterial,s,o,i),pe(Zt,a,"arcType",r.arcType,s,o,i),pe(Boolean,a,"clampToGround",r.clampToGround,s,o,i),pe(gn,a,"shadows",r.shadows,s,o,i),pe(wt,a,"distanceDisplayCondition",r.distanceDisplayCondition,s,o,i),pe(Un,a,"classificationType",r.classificationType,s,o,i),pe(Number,a,"zIndex",r.zIndex,s,o,i),f(r.followSurface)&&!f(r.arcType)){let c={};pe(Boolean,c,"followSurface",r.followSurface,s,o,i),a.arcType=j5e(c.followSurface,D6e)}}function P6e(t,n,i,o){let r=n.polylineVolume;if(!f(r))return;let s=nr(r.interval),a=t.polylineVolume;f(a)||(t.polylineVolume=a=new xx),Zw(a,"positions",r.positions,i),d6e(a,"shape",r.shape,i),pe(Boolean,a,"show",r.show,s,o,i),pe(wi,a,"cornerType",r.cornerType,s,o,i),pe(Boolean,a,"fill",r.fill,s,o,i),Fl(a,"material",r.material,s,o,i),pe(Boolean,a,"outline",r.outline,s,o,i),pe(z,a,"outlineColor",r.outlineColor,s,o,i),pe(Number,a,"outlineWidth",r.outlineWidth,s,o,i),pe(Number,a,"granularity",r.granularity,s,o,i),pe(gn,a,"shadows",r.shadows,s,o,i),pe(wt,a,"distanceDisplayCondition",r.distanceDisplayCondition,s,o,i)}function I6e(t,n,i,o){let r=n.rectangle;if(!f(r))return;let s=nr(r.interval),a=t.rectangle;f(a)||(t.rectangle=a=new ih),pe(Boolean,a,"show",r.show,s,o,i),pe(le,a,"coordinates",r.coordinates,s,o,i),pe(Number,a,"height",r.height,s,o,i),pe(Ge,a,"heightReference",r.heightReference,s,o,i),pe(Number,a,"extrudedHeight",r.extrudedHeight,s,o,i),pe(Ge,a,"extrudedHeightReference",r.extrudedHeightReference,s,o,i),pe(Xf,a,"rotation",r.rotation,s,o,i),pe(Xf,a,"stRotation",r.stRotation,s,o,i),pe(Number,a,"granularity",r.granularity,s,o,i),pe(Boolean,a,"fill",r.fill,s,o,i),Fl(a,"material",r.material,s,o,i),pe(Boolean,a,"outline",r.outline,s,o,i),pe(z,a,"outlineColor",r.outlineColor,s,o,i),pe(Number,a,"outlineWidth",r.outlineWidth,s,o,i),pe(gn,a,"shadows",r.shadows,s,o,i),pe(wt,a,"distanceDisplayCondition",r.distanceDisplayCondition,s,o,i),pe(Un,a,"classificationType",r.classificationType,s,o,i),pe(Number,a,"zIndex",r.zIndex,s,o,i)}function B6e(t,n,i,o){let r=n.tileset;if(!f(r))return;let s=nr(r.interval),a=t.tileset;f(a)||(t.tileset=a=new Ax),pe(Boolean,a,"show",r.show,s,o,i),pe(Jw.default,a,"uri",r.uri,s,o,i),pe(Number,a,"maximumScreenSpaceError",r.maximumScreenSpaceError,s,o,i)}function O6e(t,n,i,o){let r=n.wall;if(!f(r))return;let s=nr(r.interval),a=t.wall;f(a)||(t.wall=a=new C_),pe(Boolean,a,"show",r.show,s,o,i),Zw(a,"positions",r.positions,i),ase(a,"minimumHeights",r.minimumHeights,i),ase(a,"maximumHeights",r.maximumHeights,i),pe(Number,a,"granularity",r.granularity,s,o,i),pe(Boolean,a,"fill",r.fill,s,o,i),Fl(a,"material",r.material,s,o,i),pe(Boolean,a,"outline",r.outline,s,o,i),pe(z,a,"outlineColor",r.outlineColor,s,o,i),pe(Number,a,"outlineWidth",r.outlineWidth,s,o,i),pe(gn,a,"shadows",r.shadows,s,o,i),pe(wt,a,"distanceDisplayCondition",r.distanceDisplayCondition,s,o,i)}function dse(t,n,i,o,r){let s=t.id;if(f(s)||(s=Bn()),K6=s,!f(r._version)&&s!=="document")throw new he("The first CZML packet is required to be the document object.");if(t.delete===!0)n.removeById(s);else if(s==="document")A6e(t,r);else{let a=n.getOrCreateEntity(s),c=t.parent;f(c)&&(a.parent=n.getOrCreateEntity(c));for(let l=i.length-1;l>-1;l--)i[l](a,t,n,o)}K6=void 0}function R6e(t){let n,i=t._documentPacket.clock;if(!f(i)){if(!f(t._clock)){let r=t._entityCollection.computeAvailability();if(!r.start.equals(Ue.MINIMUM_VALUE)){let s=r.start,a=r.stop,c=te.secondsDifference(a,s),l=Math.round(c/120);return n=new gh,n.startTime=te.clone(s),n.stopTime=te.clone(a),n.clockRange=Nr.LOOP_STOP,n.multiplier=l,n.currentTime=te.clone(s),n.clockStep=po.SYSTEM_CLOCK_MULTIPLIER,t._clock=n,!0}}return!1}f(t._clock)?n=t._clock.clone():(n=new gh,n.startTime=Ue.MINIMUM_VALUE.clone(),n.stopTime=Ue.MAXIMUM_VALUE.clone(),n.currentTime=Ue.MINIMUM_VALUE.clone(),n.clockRange=Nr.LOOP_STOP,n.clockStep=po.SYSTEM_CLOCK_MULTIPLIER,n.multiplier=1);let o=nr(i.interval);return f(o)&&(n.startTime=o.start,n.stopTime=o.stop),f(i.currentTime)&&(n.currentTime=te.fromIso8601(i.currentTime)),f(i.range)&&(n.clockRange=A(Nr[i.range],Nr.LOOP_STOP)),f(i.step)&&(n.clockStep=A(po[i.step],po.SYSTEM_CLOCK_MULTIPLIER)),f(i.multiplier)&&(n.multiplier=i.multiplier),n.equals(t._clock)?!1:(t._clock=n.clone(t._clock),!0)}function _se(t,n,i,o){i=A(i,A.EMPTY_OBJECT);let r=n,s=i.sourceUri,a=i.credit;if(typeof a=="string"&&(a=new Jt(a)),t._credit=a,typeof n=="string"||n instanceof Ie){n=Ie.createIfNeeded(n),r=n.fetchJson(),s=A(s,n.clone());let c=t._resourceCredits,l=n.credits;if(f(l)){let u=l.length;for(let d=0;d<u;d++)c.push(l[d])}}return s=Ie.createIfNeeded(s),Fr.setLoading(t,!0),Promise.resolve(r).then(function(c){return M6e(t,c,s,o)}).catch(function(c){return Fr.setLoading(t,!1),t._error.raiseEvent(t,c),console.log(c),Promise.reject(c)})}function M6e(t,n,i,o){Fr.setLoading(t,!0);let r=t._entityCollection;o&&(t._version=void 0,t._documentPacket=new gse,r.removeAll()),nl._processCzml(n,r,i,void 0,t);let s=R6e(t),a=t._documentPacket;return f(a.name)&&t._name!==a.name?(t._name=a.name,s=!0):!f(t._name)&&f(i)&&(t._name=$_(i.getUrlComponent()),s=!0),Fr.setLoading(t,!1),s&&t._changed.raiseEvent(t),t}function gse(){this.name=void 0,this.clock=void 0}function nl(t){this._name=t,this._changed=new Ae,this._error=new Ae,this._isLoading=!1,this._loading=new Ae,this._clock=void 0,this._documentPacket=new gse,this._version=void 0,this._entityCollection=new Ms(this),this._entityCluster=new Uu,this._credit=void 0,this._resourceCredits=[]}nl.load=function(t,n){return new nl().load(t,n)};Object.defineProperties(nl.prototype,{name:{get:function(){return this._name}},clock:{get:function(){return this._clock}},entities:{get:function(){return this._entityCollection}},isLoading:{get:function(){return this._isLoading}},changedEvent:{get:function(){return this._changed}},errorEvent:{get:function(){return this._error}},loadingEvent:{get:function(){return this._loading}},show:{get:function(){return this._entityCollection.show},set:function(t){this._entityCollection.show=t}},clustering:{get:function(){return this._entityCluster},set:function(t){this._entityCluster=t}},credit:{get:function(){return this._credit}}});nl.updaters=[p6e,_6e,g6e,y6e,C6e,x6e,T6e,E6e,n6e,i6e,b6e,S6e,w6e,v6e,P6e,a6e,I6e,o6e,B6e,r6e,O6e,s6e,h6e];nl.prototype.process=function(t,n){return _se(this,t,n,!1)};nl.prototype.load=function(t,n){return _se(this,t,n,!0)};nl.prototype.update=function(t){return!0};nl.processPacketData=pe;nl.processPositionPacketData=pse;nl.processMaterialPacketData=Fl;nl._processCzml=function(t,n,i,o,r){if(o=A(o,nl.updaters),Array.isArray(t))for(let s=0,a=t.length;s<a;++s)dse(t[s],n,o,i,r);else dse(t,n,o,i,r)};var mN=nl;function Ac(){this._dataSources=[],this._dataSourceAdded=new Ae,this._dataSourceRemoved=new Ae,this._dataSourceMoved=new Ae}Object.defineProperties(Ac.prototype,{length:{get:function(){return this._dataSources.length}},dataSourceAdded:{get:function(){return this._dataSourceAdded}},dataSourceRemoved:{get:function(){return this._dataSourceRemoved}},dataSourceMoved:{get:function(){return this._dataSourceMoved}}});Ac.prototype.add=function(t){let n=this,i=this._dataSources;return Promise.resolve(t).then(function(o){return i===n._dataSources&&(n._dataSources.push(o),n._dataSourceAdded.raiseEvent(n,o)),o})};Ac.prototype.remove=function(t,n){n=A(n,!1);let i=this._dataSources.indexOf(t);return i!==-1?(this._dataSources.splice(i,1),this._dataSourceRemoved.raiseEvent(this,t),n&&typeof t.destroy=="function"&&t.destroy(),!0):!1};Ac.prototype.removeAll=function(t){t=A(t,!1);let n=this._dataSources;for(let i=0,o=n.length;i<o;++i){let r=n[i];this._dataSourceRemoved.raiseEvent(this,r),t&&typeof r.destroy=="function"&&r.destroy()}this._dataSources=[]};Ac.prototype.contains=function(t){return this.indexOf(t)!==-1};Ac.prototype.indexOf=function(t){return this._dataSources.indexOf(t)};Ac.prototype.get=function(t){return this._dataSources[t]};Ac.prototype.getByName=function(t){return this._dataSources.filter(function(n){return n.name===t})};function pN(t,n){return t.indexOf(n)}function yse(t,n,i){let o=t._dataSources,r=o.length-1;if(n=B.clamp(n,0,r),i=B.clamp(i,0,r),n===i)return;let s=o[n];o[n]=o[i],o[i]=s,t.dataSourceMoved.raiseEvent(s,i,n)}Ac.prototype.raise=function(t){let n=pN(this._dataSources,t);yse(this,n,n+1)};Ac.prototype.lower=function(t){let n=pN(this._dataSources,t);yse(this,n,n-1)};Ac.prototype.raiseToTop=function(t){let n=pN(this._dataSources,t);n!==this._dataSources.length-1&&(this._dataSources.splice(n,1),this._dataSources.push(t),this.dataSourceMoved.raiseEvent(t,this._dataSources.length-1,n))};Ac.prototype.lowerToBottom=function(t){let n=pN(this._dataSources,t);n!==0&&(this._dataSources.splice(n,1),this._dataSources.splice(0,0,t),this.dataSourceMoved.raiseEvent(t,0,n))};Ac.prototype.isDestroyed=function(){return!1};Ac.prototype.destroy=function(){return this.removeAll(!0),ue(this)};var _N=Ac;function Ns(t){t=A(t,A.EMPTY_OBJECT),this._primitives=[],this._guid=Bn(),this._zIndex=void 0,this.show=A(t.show,!0),this.destroyPrimitives=A(t.destroyPrimitives,!0)}Object.defineProperties(Ns.prototype,{length:{get:function(){return this._primitives.length}}});Ns.prototype.add=function(t,n){let i=f(n),o=t._external=t._external||{},r=o._composites=o._composites||{};return r[this._guid]={collection:this},i?this._primitives.splice(n,0,t):this._primitives.push(t),t};Ns.prototype.remove=function(t){if(this.contains(t)){let n=this._primitives.indexOf(t);if(n!==-1)return this._primitives.splice(n,1),delete t._external._composites[this._guid],this.destroyPrimitives&&t.destroy(),!0}return!1};Ns.prototype.removeAndDestroy=function(t){let n=this.remove(t);return n&&!this.destroyPrimitives&&t.destroy(),n};Ns.prototype.removeAll=function(){let t=this._primitives,n=t.length;for(let i=0;i<n;++i)delete t[i]._external._composites[this._guid],this.destroyPrimitives&&t[i].destroy();this._primitives=[]};Ns.prototype.contains=function(t){return!!(f(t)&&t._external&&t._external._composites&&t._external._composites[this._guid])};function gN(t,n){return t._primitives.indexOf(n)}Ns.prototype.raise=function(t){if(f(t)){let n=gN(this,t),i=this._primitives;if(n!==i.length-1){let o=i[n];i[n]=i[n+1],i[n+1]=o}}};Ns.prototype.raiseToTop=function(t){if(f(t)){let n=gN(this,t),i=this._primitives;n!==i.length-1&&(i.splice(n,1),i.push(t))}};Ns.prototype.lower=function(t){if(f(t)){let n=gN(this,t),i=this._primitives;if(n!==0){let o=i[n];i[n]=i[n-1],i[n-1]=o}}};Ns.prototype.lowerToBottom=function(t){if(f(t)){let n=gN(this,t),i=this._primitives;n!==0&&(i.splice(n,1),i.unshift(t))}};Ns.prototype.get=function(t){return this._primitives[t]};Ns.prototype.update=function(t){if(!this.show)return;let n=this._primitives;for(let i=0;i<n.length;++i)n[i].update(t)};Ns.prototype.prePassesUpdate=function(t){let n=this._primitives;for(let i=0;i<n.length;++i){let o=n[i];f(o.prePassesUpdate)&&o.prePassesUpdate(t)}};Ns.prototype.updateForPass=function(t,n){let i=this._primitives;for(let o=0;o<i.length;++o){let r=i[o];f(r.updateForPass)&&r.updateForPass(t,n)}};Ns.prototype.postPassesUpdate=function(t){let n=this._primitives;for(let i=0;i<n.length;++i){let o=n[i];f(o.postPassesUpdate)&&o.postPassesUpdate(t)}};Ns.prototype.isDestroyed=function(){return!1};Ns.prototype.destroy=function(){return this.removeAll(),ue(this)};var Nl=Ns;function Ah(){this._length=0,this._collections={},this._collectionsArray=[],this.show=!0}Object.defineProperties(Ah.prototype,{length:{get:function(){return this._length}}});Ah.prototype.add=function(t,n){n=A(n,0);let i=this._collections[n];if(!f(i)){i=new Nl({destroyPrimitives:!1}),i._zIndex=n,this._collections[n]=i;let o=this._collectionsArray,r=0;for(;r<o.length&&o[r]._zIndex<n;)r++;o.splice(r,0,i)}return i.add(t),this._length++,t._zIndex=n,t};Ah.prototype.set=function(t,n){return n===t._zIndex||(this.remove(t,!0),this.add(t,n)),t};Ah.prototype.remove=function(t,n){if(this.contains(t)){let i=t._zIndex,o=this._collections[i],r;return n?r=o.remove(t):r=o.removeAndDestroy(t),r&&this._length--,o.length===0&&(this._collectionsArray.splice(this._collectionsArray.indexOf(o),1),this._collections[i]=void 0,o.destroy()),r}return!1};Ah.prototype.removeAll=function(){let t=this._collectionsArray;for(let n=0;n<t.length;n++){let i=t[n];i.destroyPrimitives=!0,i.destroy()}this._collections={},this._collectionsArray=[],this._length=0};Ah.prototype.contains=function(t){if(!f(t))return!1;let n=this._collections[t._zIndex];return f(n)&&n.contains(t)};Ah.prototype.update=function(t){if(!this.show)return;let n=this._collectionsArray;for(let i=0;i<n.length;i++)n[i].update(t)};Ah.prototype.isDestroyed=function(){return!1};Ah.prototype.destroy=function(){return this.removeAll(),ue(this)};var yN=Ah;function AT(t,n){this._primitives=t,this._orderedGroundPrimitives=n,this._dynamicUpdaters=new yt}AT.prototype.add=function(t,n){this._dynamicUpdaters.set(n.id,n.createDynamicUpdater(this._primitives,this._orderedGroundPrimitives))};AT.prototype.remove=function(t){let n=t.id,i=this._dynamicUpdaters.get(n);f(i)&&(this._dynamicUpdaters.remove(n),i.destroy())};AT.prototype.update=function(t){let n=this._dynamicUpdaters.values;for(let i=0,o=n.length;i<o;i++)n[i].update(t);return!0};AT.prototype.removeAllPrimitives=function(){let t=this._dynamicUpdaters.values;for(let n=0,i=t.length;n<i;n++)t[n].destroy();this._dynamicUpdaters.removeAll()};AT.prototype.getBoundingSphere=function(t,n){return t=this._dynamicUpdaters.get(t.id),f(t)&&f(t.getBoundingSphere)?t.getBoundingSphere(n):rt.FAILED};var CT=AT;var $6={},AN=new m,Ase=new m,Cse=new Me,xse=new $;function xT(t,n,i,o,r,s,a,c,l,u){let d=t+n;m.multiplyByScalar(o,Math.cos(d),AN),m.multiplyByScalar(i,Math.sin(d),Ase),m.add(AN,Ase,AN);let h=Math.cos(t);h=h*h;let _=Math.sin(t);_=_*_;let p=s/Math.sqrt(a*h+r*_)/c;return Me.fromAxisAngle(AN,p,Cse),$.fromQuaternion(Cse,xse),$.multiplyByVector(xse,l,u),m.normalize(u,u),m.multiplyByScalar(u,c,u),u}var Tse=new m,Ese=new m,Q6=new m,L6e=new m;$6.raisePositionsToHeight=function(t,n,i){let o=n.ellipsoid,r=n.height,s=n.extrudedHeight,a=i?t.length/3*2:t.length/3,c=new Float64Array(a*3),l=t.length,u=i?l:0;for(let d=0;d<l;d+=3){let h=d+1,_=d+2,y=m.fromArray(t,d,Tse);o.scaleToGeodeticSurface(y,y);let p=m.clone(y,Ese),C=o.geodeticSurfaceNormal(y,L6e),x=m.multiplyByScalar(C,r,Q6);m.add(y,x,y),i&&(m.multiplyByScalar(C,s,x),m.add(p,x,p),c[d+u]=p.x,c[h+u]=p.y,c[_+u]=p.z),c[d]=y.x,c[h]=y.y,c[_]=y.z}return c};var F6e=new m,N6e=new m,V6e=new m;$6.computeEllipsePositions=function(t,n,i){let o=t.semiMinorAxis,r=t.semiMajorAxis,s=t.rotation,a=t.center,c=t.granularity*8,l=o*o,u=r*r,d=r*o,h=m.magnitude(a),_=m.normalize(a,F6e),y=m.cross(m.UNIT_Z,a,N6e);y=m.normalize(y,y);let p=m.cross(_,y,V6e),C=1+Math.ceil(B.PI_OVER_TWO/c),x=B.PI_OVER_TWO/(C-1),T=B.PI_OVER_TWO-C*x;T<0&&(C-=Math.ceil(Math.abs(T)/x));let E=2*(C*(C+2)),S=n?new Array(E*3):void 0,w=0,D=Tse,I=Ese,O=C*4*3,M=O-1,L=0,F=i?new Array(O):void 0,g,b,v,P,R;for(T=B.PI_OVER_TWO,D=xT(T,s,p,y,l,d,u,h,_,D),n&&(S[w++]=D.x,S[w++]=D.y,S[w++]=D.z),i&&(F[M--]=D.z,F[M--]=D.y,F[M--]=D.x),T=B.PI_OVER_TWO-x,g=1;g<C+1;++g){if(D=xT(T,s,p,y,l,d,u,h,_,D),I=xT(Math.PI-T,s,p,y,l,d,u,h,_,I),n){for(S[w++]=D.x,S[w++]=D.y,S[w++]=D.z,v=2*g+2,b=1;b<v-1;++b)P=b/(v-1),R=m.lerp(D,I,P,Q6),S[w++]=R.x,S[w++]=R.y,S[w++]=R.z;S[w++]=I.x,S[w++]=I.y,S[w++]=I.z}i&&(F[M--]=D.z,F[M--]=D.y,F[M--]=D.x,F[L++]=I.x,F[L++]=I.y,F[L++]=I.z),T=B.PI_OVER_TWO-(g+1)*x}for(g=C;g>1;--g){if(T=B.PI_OVER_TWO-(g-1)*x,D=xT(-T,s,p,y,l,d,u,h,_,D),I=xT(T+Math.PI,s,p,y,l,d,u,h,_,I),n){for(S[w++]=D.x,S[w++]=D.y,S[w++]=D.z,v=2*(g-1)+2,b=1;b<v-1;++b)P=b/(v-1),R=m.lerp(D,I,P,Q6),S[w++]=R.x,S[w++]=R.y,S[w++]=R.z;S[w++]=I.x,S[w++]=I.y,S[w++]=I.z}i&&(F[M--]=D.z,F[M--]=D.y,F[M--]=D.x,F[L++]=I.x,F[L++]=I.y,F[L++]=I.z)}T=B.PI_OVER_TWO,D=xT(-T,s,p,y,l,d,u,h,_,D);let V={};return n&&(S[w++]=D.x,S[w++]=D.y,S[w++]=D.z,V.positions=S,V.numPts=C),i&&(F[M--]=D.z,F[M--]=D.y,F[M--]=D.x,V.outerPositions=F),V};var Vl=$6;var TT=new m,e9=new m,t9=new m,bse=new m,ns=new W,Sse=new $,k6e=new $,n9=new Me,wse=new m,Dse=new m,vse=new m,TN=new de,Pse=new m,Ise=new W,Bse=new W;function Ose(t,n,i){let o=n.vertexFormat,r=n.center,s=n.semiMajorAxis,a=n.semiMinorAxis,c=n.ellipsoid,l=n.stRotation,u=i?t.length/3*2:t.length/3,d=n.shadowVolume,h=o.st?new Float32Array(u*2):void 0,_=o.normal?new Float32Array(u*3):void 0,y=o.tangent?new Float32Array(u*3):void 0,p=o.bitangent?new Float32Array(u*3):void 0,C=d?new Float32Array(u*3):void 0,x=0,T=wse,E=Dse,S=vse,w=new Ci(c),D=w.project(c.cartesianToCartographic(r,TN),Pse),I=c.scaleToGeodeticSurface(r,TT);c.geodeticSurfaceNormal(I,I);let O=Sse,M=k6e;if(l!==0){let R=Me.fromAxisAngle(I,l,n9);O=$.fromQuaternion(R,O),R=Me.fromAxisAngle(I,-l,n9),M=$.fromQuaternion(R,M)}else O=$.clone($.IDENTITY,O),M=$.clone($.IDENTITY,M);let L=W.fromElements(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Ise),F=W.fromElements(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Bse),g=t.length,b=i?g:0,v=b/3*2;for(let R=0;R<g;R+=3){let V=R+1,H=R+2,U=m.fromArray(t,R,TT);if(o.st){let G=$.multiplyByVector(O,U,e9),k=w.project(c.cartesianToCartographic(G,TN),t9);m.subtract(k,D,k),ns.x=(k.x+s)/(2*s),ns.y=(k.y+a)/(2*a),L.x=Math.min(ns.x,L.x),L.y=Math.min(ns.y,L.y),F.x=Math.max(ns.x,F.x),F.y=Math.max(ns.y,F.y),i&&(h[x+v]=ns.x,h[x+1+v]=ns.y),h[x++]=ns.x,h[x++]=ns.y}(o.normal||o.tangent||o.bitangent||d)&&(T=c.geodeticSurfaceNormal(U,T),d&&(C[R+b]=-T.x,C[V+b]=-T.y,C[H+b]=-T.z),(o.normal||o.tangent||o.bitangent)&&((o.tangent||o.bitangent)&&(E=m.normalize(m.cross(m.UNIT_Z,T,E),E),$.multiplyByVector(M,E,E)),o.normal&&(_[R]=T.x,_[V]=T.y,_[H]=T.z,i&&(_[R+b]=-T.x,_[V+b]=-T.y,_[H+b]=-T.z)),o.tangent&&(y[R]=E.x,y[V]=E.y,y[H]=E.z,i&&(y[R+b]=-E.x,y[V+b]=-E.y,y[H+b]=-E.z)),o.bitangent&&(S=m.normalize(m.cross(T,E,S),S),p[R]=S.x,p[V]=S.y,p[H]=S.z,i&&(p[R+b]=S.x,p[V+b]=S.y,p[H+b]=S.z))))}if(o.st){g=h.length;for(let R=0;R<g;R+=2)h[R]=(h[R]-L.x)/(F.x-L.x),h[R+1]=(h[R+1]-L.y)/(F.y-L.y)}let P=new cn;if(o.position){let R=Vl.raisePositionsToHeight(t,n,i);P.position=new we({componentDatatype:J.DOUBLE,componentsPerAttribute:3,values:R})}if(o.st&&(P.st=new we({componentDatatype:J.FLOAT,componentsPerAttribute:2,values:h})),o.normal&&(P.normal=new we({componentDatatype:J.FLOAT,componentsPerAttribute:3,values:_})),o.tangent&&(P.tangent=new we({componentDatatype:J.FLOAT,componentsPerAttribute:3,values:y})),o.bitangent&&(P.bitangent=new we({componentDatatype:J.FLOAT,componentsPerAttribute:3,values:p})),d&&(P.extrudeDirection=new we({componentDatatype:J.FLOAT,componentsPerAttribute:3,values:C})),i&&f(n.offsetAttribute)){let R=new Uint8Array(u);if(n.offsetAttribute===en.TOP)R=R.fill(1,0,u/2);else{let V=n.offsetAttribute===en.NONE?0:1;R=R.fill(V)}P.applyOffset=new we({componentDatatype:J.UNSIGNED_BYTE,componentsPerAttribute:1,values:R})}return P}function Rse(t){let n=new Array(12*(t*(t+1))-6),i=0,o,r,s,a,c;for(o=0,s=1,a=0;a<3;a++)n[i++]=s++,n[i++]=o,n[i++]=s;for(a=2;a<t+1;++a){for(s=a*(a+1)-1,o=(a-1)*a-1,n[i++]=s++,n[i++]=o,n[i++]=s,r=2*a,c=0;c<r-1;++c)n[i++]=s,n[i++]=o++,n[i++]=o,n[i++]=s++,n[i++]=o,n[i++]=s;n[i++]=s++,n[i++]=o,n[i++]=s}for(r=t*2,++s,++o,a=0;a<r-1;++a)n[i++]=s,n[i++]=o++,n[i++]=o,n[i++]=s++,n[i++]=o,n[i++]=s;for(n[i++]=s,n[i++]=o++,n[i++]=o,n[i++]=s++,n[i++]=o++,n[i++]=o,++o,a=t-1;a>1;--a){for(n[i++]=o++,n[i++]=o,n[i++]=s,r=2*a,c=0;c<r-1;++c)n[i++]=s,n[i++]=o++,n[i++]=o,n[i++]=s++,n[i++]=o,n[i++]=s;n[i++]=o++,n[i++]=o++,n[i++]=s++}for(a=0;a<3;a++)n[i++]=o++,n[i++]=o,n[i++]=s;return n}var Fy=new m;function U6e(t){let n=t.center;Fy=m.multiplyByScalar(t.ellipsoid.geodeticSurfaceNormal(n,Fy),t.height,Fy),Fy=m.add(n,Fy,Fy);let i=new ae(Fy,t.semiMajorAxis),o=Vl.computeEllipsePositions(t,!0,!1),r=o.positions,s=o.numPts,a=Ose(r,t,!1),c=Rse(s);return c=Ne.createTypedArray(r.length/3,c),{boundingSphere:i,attributes:a,indices:c}}function z6e(t,n){let i=n.vertexFormat,o=n.center,r=n.semiMajorAxis,s=n.semiMinorAxis,a=n.ellipsoid,c=n.height,l=n.extrudedHeight,u=n.stRotation,d=t.length/3*2,h=new Float64Array(d*3),_=i.st?new Float32Array(d*2):void 0,y=i.normal?new Float32Array(d*3):void 0,p=i.tangent?new Float32Array(d*3):void 0,C=i.bitangent?new Float32Array(d*3):void 0,x=n.shadowVolume,T=x?new Float32Array(d*3):void 0,E=0,S=wse,w=Dse,D=vse,I=new Ci(a),O=I.project(a.cartesianToCartographic(o,TN),Pse),M=a.scaleToGeodeticSurface(o,TT);a.geodeticSurfaceNormal(M,M);let L=Me.fromAxisAngle(M,u,n9),F=$.fromQuaternion(L,Sse),g=W.fromElements(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Ise),b=W.fromElements(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Bse),v=t.length,P=v/3*2;for(let V=0;V<v;V+=3){let H=V+1,U=V+2,G=m.fromArray(t,V,TT),k;if(i.st){let Y=$.multiplyByVector(F,G,e9),K=I.project(a.cartesianToCartographic(Y,TN),t9);m.subtract(K,O,K),ns.x=(K.x+r)/(2*r),ns.y=(K.y+s)/(2*s),g.x=Math.min(ns.x,g.x),g.y=Math.min(ns.y,g.y),b.x=Math.max(ns.x,b.x),b.y=Math.max(ns.y,b.y),_[E+P]=ns.x,_[E+1+P]=ns.y,_[E++]=ns.x,_[E++]=ns.y}G=a.scaleToGeodeticSurface(G,G),k=m.clone(G,e9),S=a.geodeticSurfaceNormal(G,S),x&&(T[V+v]=-S.x,T[H+v]=-S.y,T[U+v]=-S.z);let X=m.multiplyByScalar(S,c,bse);if(G=m.add(G,X,G),X=m.multiplyByScalar(S,l,X),k=m.add(k,X,k),i.position&&(h[V+v]=k.x,h[H+v]=k.y,h[U+v]=k.z,h[V]=G.x,h[H]=G.y,h[U]=G.z),i.normal||i.tangent||i.bitangent){D=m.clone(S,D);let Y=m.fromArray(t,(V+3)%v,bse);m.subtract(Y,G,Y);let K=m.subtract(k,G,t9);S=m.normalize(m.cross(K,Y,S),S),i.normal&&(y[V]=S.x,y[H]=S.y,y[U]=S.z,y[V+v]=S.x,y[H+v]=S.y,y[U+v]=S.z),i.tangent&&(w=m.normalize(m.cross(D,S,w),w),p[V]=w.x,p[H]=w.y,p[U]=w.z,p[V+v]=w.x,p[V+1+v]=w.y,p[V+2+v]=w.z),i.bitangent&&(C[V]=D.x,C[H]=D.y,C[U]=D.z,C[V+v]=D.x,C[H+v]=D.y,C[U+v]=D.z)}}if(i.st){v=_.length;for(let V=0;V<v;V+=2)_[V]=(_[V]-g.x)/(b.x-g.x),_[V+1]=(_[V+1]-g.y)/(b.y-g.y)}let R=new cn;if(i.position&&(R.position=new we({componentDatatype:J.DOUBLE,componentsPerAttribute:3,values:h})),i.st&&(R.st=new we({componentDatatype:J.FLOAT,componentsPerAttribute:2,values:_})),i.normal&&(R.normal=new we({componentDatatype:J.FLOAT,componentsPerAttribute:3,values:y})),i.tangent&&(R.tangent=new we({componentDatatype:J.FLOAT,componentsPerAttribute:3,values:p})),i.bitangent&&(R.bitangent=new we({componentDatatype:J.FLOAT,componentsPerAttribute:3,values:C})),x&&(R.extrudeDirection=new we({componentDatatype:J.FLOAT,componentsPerAttribute:3,values:T})),f(n.offsetAttribute)){let V=new Uint8Array(d);if(n.offsetAttribute===en.TOP)V=V.fill(1,0,d/2);else{let H=n.offsetAttribute===en.NONE?0:1;V=V.fill(H)}R.applyOffset=new we({componentDatatype:J.UNSIGNED_BYTE,componentsPerAttribute:1,values:V})}return R}function H6e(t){let n=t.length/3,i=Ne.createTypedArray(n,n*6),o=0;for(let r=0;r<n;r++){let s=r,a=r+n,c=(s+1)%n,l=c+n;i[o++]=s,i[o++]=a,i[o++]=c,i[o++]=c,i[o++]=a,i[o++]=l}return i}var CN=new ae,xN=new ae;function G6e(t){let n=t.center,i=t.ellipsoid,o=t.semiMajorAxis,r=m.multiplyByScalar(i.geodeticSurfaceNormal(n,TT),t.height,TT);CN.center=m.add(n,r,CN.center),CN.radius=o,r=m.multiplyByScalar(i.geodeticSurfaceNormal(n,r),t.extrudedHeight,r),xN.center=m.add(n,r,xN.center),xN.radius=o;let s=Vl.computeEllipsePositions(t,!0,!0),a=s.positions,c=s.numPts,l=s.outerPositions,u=ae.union(CN,xN),d=Ose(a,t,!0),h=Rse(c),_=h.length;h.length=_*2;let y=a.length/3;for(let w=0;w<_;w+=3)h[w+_]=h[w+2]+y,h[w+1+_]=h[w+1]+y,h[w+2+_]=h[w]+y;let p=Ne.createTypedArray(y*2/3,h),C=new at({attributes:d,indices:p,primitiveType:Re.TRIANGLES}),x=z6e(l,t);h=H6e(l);let T=Ne.createTypedArray(l.length*2/3,h),E=new at({attributes:x,indices:T,primitiveType:Re.TRIANGLES}),S=Fn.combineInstances([new Ct({geometry:C}),new Ct({geometry:E})]);return{boundingSphere:u,attributes:S[0].attributes,indices:S[0].indices}}function Mse(t,n,i,o,r,s,a){let l=Vl.computeEllipsePositions({center:t,semiMajorAxis:n,semiMinorAxis:i,rotation:o,granularity:r},!1,!0).outerPositions,u=l.length/3,d=new Array(u);for(let _=0;_<u;++_)d[_]=m.fromArray(l,_*3);let h=le.fromCartesianArray(d,s,a);return h.width>B.PI&&(h.north=h.north>0?B.PI_OVER_TWO-B.EPSILON7:h.north,h.south=h.south<0?B.EPSILON7-B.PI_OVER_TWO:h.south,h.east=B.PI,h.west=-B.PI),h}function xh(t){t=A(t,A.EMPTY_OBJECT);let n=t.center,i=A(t.ellipsoid,oe.WGS84),o=t.semiMajorAxis,r=t.semiMinorAxis,s=A(t.granularity,B.RADIANS_PER_DEGREE),a=A(t.vertexFormat,De.DEFAULT),c=A(t.height,0),l=A(t.extrudedHeight,c);this._center=m.clone(n),this._semiMajorAxis=o,this._semiMinorAxis=r,this._ellipsoid=oe.clone(i),this._rotation=A(t.rotation,0),this._stRotation=A(t.stRotation,0),this._height=Math.max(l,c),this._granularity=s,this._vertexFormat=De.clone(a),this._extrudedHeight=Math.min(l,c),this._shadowVolume=A(t.shadowVolume,!1),this._workerName="createEllipseGeometry",this._offsetAttribute=t.offsetAttribute,this._rectangle=void 0,this._textureCoordinateRotationPoints=void 0}xh.packedLength=m.packedLength+oe.packedLength+De.packedLength+9;xh.pack=function(t,n,i){return i=A(i,0),m.pack(t._center,n,i),i+=m.packedLength,oe.pack(t._ellipsoid,n,i),i+=oe.packedLength,De.pack(t._vertexFormat,n,i),i+=De.packedLength,n[i++]=t._semiMajorAxis,n[i++]=t._semiMinorAxis,n[i++]=t._rotation,n[i++]=t._stRotation,n[i++]=t._height,n[i++]=t._granularity,n[i++]=t._extrudedHeight,n[i++]=t._shadowVolume?1:0,n[i]=A(t._offsetAttribute,-1),n};var Lse=new m,Fse=new oe,Nse=new De,Ch={center:Lse,ellipsoid:Fse,vertexFormat:Nse,semiMajorAxis:void 0,semiMinorAxis:void 0,rotation:void 0,stRotation:void 0,height:void 0,granularity:void 0,extrudedHeight:void 0,shadowVolume:void 0,offsetAttribute:void 0};xh.unpack=function(t,n,i){n=A(n,0);let o=m.unpack(t,n,Lse);n+=m.packedLength;let r=oe.unpack(t,n,Fse);n+=oe.packedLength;let s=De.unpack(t,n,Nse);n+=De.packedLength;let a=t[n++],c=t[n++],l=t[n++],u=t[n++],d=t[n++],h=t[n++],_=t[n++],y=t[n++]===1,p=t[n];return f(i)?(i._center=m.clone(o,i._center),i._ellipsoid=oe.clone(r,i._ellipsoid),i._vertexFormat=De.clone(s,i._vertexFormat),i._semiMajorAxis=a,i._semiMinorAxis=c,i._rotation=l,i._stRotation=u,i._height=d,i._granularity=h,i._extrudedHeight=_,i._shadowVolume=y,i._offsetAttribute=p===-1?void 0:p,i):(Ch.height=d,Ch.extrudedHeight=_,Ch.granularity=h,Ch.stRotation=u,Ch.rotation=l,Ch.semiMajorAxis=a,Ch.semiMinorAxis=c,Ch.shadowVolume=y,Ch.offsetAttribute=p===-1?void 0:p,new xh(Ch))};xh.computeRectangle=function(t,n){t=A(t,A.EMPTY_OBJECT);let i=t.center,o=A(t.ellipsoid,oe.WGS84),r=t.semiMajorAxis,s=t.semiMinorAxis,a=A(t.granularity,B.RADIANS_PER_DEGREE),c=A(t.rotation,0);return Mse(i,r,s,c,a,o,n)};xh.createGeometry=function(t){if(t._semiMajorAxis<=0||t._semiMinorAxis<=0)return;let n=t._height,i=t._extrudedHeight,o=!B.equalsEpsilon(n,i,0,B.EPSILON2);t._center=t._ellipsoid.scaleToGeodeticSurface(t._center,t._center);let r={center:t._center,semiMajorAxis:t._semiMajorAxis,semiMinorAxis:t._semiMinorAxis,ellipsoid:t._ellipsoid,rotation:t._rotation,height:n,granularity:t._granularity,vertexFormat:t._vertexFormat,stRotation:t._stRotation},s;if(o)r.extrudedHeight=i,r.shadowVolume=t._shadowVolume,r.offsetAttribute=t._offsetAttribute,s=G6e(r);else if(s=U6e(r),f(t._offsetAttribute)){let a=s.attributes.position.values.length,c=t._offsetAttribute===en.NONE?0:1,l=new Uint8Array(a/3).fill(c);s.attributes.applyOffset=new we({componentDatatype:J.UNSIGNED_BYTE,componentsPerAttribute:1,values:l})}return new at({attributes:s.attributes,indices:s.indices,primitiveType:Re.TRIANGLES,boundingSphere:s.boundingSphere,offsetAttribute:t._offsetAttribute})};xh.createShadowVolume=function(t,n,i){let o=t._granularity,r=t._ellipsoid,s=n(o,r),a=i(o,r);return new xh({center:t._center,semiMajorAxis:t._semiMajorAxis,semiMinorAxis:t._semiMinorAxis,ellipsoid:r,rotation:t._rotation,stRotation:t._stRotation,granularity:o,extrudedHeight:s,height:a,vertexFormat:De.POSITION_ONLY,shadowVolume:!0})};function W6e(t){let n=-t._stRotation;if(n===0)return[0,0,0,1,1,0];let o=Vl.computeEllipsePositions({center:t._center,semiMajorAxis:t._semiMajorAxis,semiMinorAxis:t._semiMinorAxis,rotation:t._rotation,granularity:t._granularity},!1,!0).outerPositions,r=o.length/3,s=new Array(r);for(let l=0;l<r;++l)s[l]=m.fromArray(o,l*3);let a=t._ellipsoid,c=t.rectangle;return at._textureCoordinateRotationPoints(s,n,a,c)}Object.defineProperties(xh.prototype,{rectangle:{get:function(){return f(this._rectangle)||(this._rectangle=Mse(this._center,this._semiMajorAxis,this._semiMinorAxis,this._rotation,this._granularity,this._ellipsoid)),this._rectangle}},textureCoordinateRotationPoints:{get:function(){return f(this._textureCoordinateRotationPoints)||(this._textureCoordinateRotationPoints=W6e(this)),this._textureCoordinateRotationPoints}}});var il=xh;var Vse=new m,Ny=new m;function j6e(t){let n=t.center;Ny=m.multiplyByScalar(t.ellipsoid.geodeticSurfaceNormal(n,Ny),t.height,Ny),Ny=m.add(n,Ny,Ny);let i=new ae(Ny,t.semiMajorAxis),o=Vl.computeEllipsePositions(t,!1,!0).outerPositions,r=new cn({position:new we({componentDatatype:J.DOUBLE,componentsPerAttribute:3,values:Vl.raisePositionsToHeight(o,t,!1)})}),s=o.length/3,a=Ne.createTypedArray(s,s*2),c=0;for(let l=0;l<s;++l)a[c++]=l,a[c++]=(l+1)%s;return{boundingSphere:i,attributes:r,indices:a}}var EN=new ae,bN=new ae;function q6e(t){let n=t.center,i=t.ellipsoid,o=t.semiMajorAxis,r=m.multiplyByScalar(i.geodeticSurfaceNormal(n,Vse),t.height,Vse);EN.center=m.add(n,r,EN.center),EN.radius=o,r=m.multiplyByScalar(i.geodeticSurfaceNormal(n,r),t.extrudedHeight,r),bN.center=m.add(n,r,bN.center),bN.radius=o;let s=Vl.computeEllipsePositions(t,!1,!0).outerPositions,a=new cn({position:new we({componentDatatype:J.DOUBLE,componentsPerAttribute:3,values:Vl.raisePositionsToHeight(s,t,!0)})});s=a.position.values;let c=ae.union(EN,bN),l=s.length/3;if(f(t.offsetAttribute)){let p=new Uint8Array(l);if(t.offsetAttribute===en.TOP)p=p.fill(1,0,l/2);else{let C=t.offsetAttribute===en.NONE?0:1;p=p.fill(C)}a.applyOffset=new we({componentDatatype:J.UNSIGNED_BYTE,componentsPerAttribute:1,values:p})}let u=A(t.numberOfVerticalLines,16);u=B.clamp(u,0,l/2);let d=Ne.createTypedArray(l,l*2+u*2);l/=2;let h=0,_;for(_=0;_<l;++_)d[h++]=_,d[h++]=(_+1)%l,d[h++]=_+l,d[h++]=(_+1)%l+l;let y;if(u>0){let p=Math.min(u,l);y=Math.round(l/p);let C=Math.min(y*u,l);for(_=0;_<C;_+=y)d[h++]=_,d[h++]=_+l}return{boundingSphere:c,attributes:a,indices:d}}function ET(t){t=A(t,A.EMPTY_OBJECT);let n=t.center,i=A(t.ellipsoid,oe.WGS84),o=t.semiMajorAxis,r=t.semiMinorAxis,s=A(t.granularity,B.RADIANS_PER_DEGREE),a=A(t.height,0),c=A(t.extrudedHeight,a);this._center=m.clone(n),this._semiMajorAxis=o,this._semiMinorAxis=r,this._ellipsoid=oe.clone(i),this._rotation=A(t.rotation,0),this._height=Math.max(c,a),this._granularity=s,this._extrudedHeight=Math.min(c,a),this._numberOfVerticalLines=Math.max(A(t.numberOfVerticalLines,16),0),this._offsetAttribute=t.offsetAttribute,this._workerName="createEllipseOutlineGeometry"}ET.packedLength=m.packedLength+oe.packedLength+8;ET.pack=function(t,n,i){return i=A(i,0),m.pack(t._center,n,i),i+=m.packedLength,oe.pack(t._ellipsoid,n,i),i+=oe.packedLength,n[i++]=t._semiMajorAxis,n[i++]=t._semiMinorAxis,n[i++]=t._rotation,n[i++]=t._height,n[i++]=t._granularity,n[i++]=t._extrudedHeight,n[i++]=t._numberOfVerticalLines,n[i]=A(t._offsetAttribute,-1),n};var kse=new m,Use=new oe,lp={center:kse,ellipsoid:Use,semiMajorAxis:void 0,semiMinorAxis:void 0,rotation:void 0,height:void 0,granularity:void 0,extrudedHeight:void 0,numberOfVerticalLines:void 0,offsetAttribute:void 0};ET.unpack=function(t,n,i){n=A(n,0);let o=m.unpack(t,n,kse);n+=m.packedLength;let r=oe.unpack(t,n,Use);n+=oe.packedLength;let s=t[n++],a=t[n++],c=t[n++],l=t[n++],u=t[n++],d=t[n++],h=t[n++],_=t[n];return f(i)?(i._center=m.clone(o,i._center),i._ellipsoid=oe.clone(r,i._ellipsoid),i._semiMajorAxis=s,i._semiMinorAxis=a,i._rotation=c,i._height=l,i._granularity=u,i._extrudedHeight=d,i._numberOfVerticalLines=h,i._offsetAttribute=_===-1?void 0:_,i):(lp.height=l,lp.extrudedHeight=d,lp.granularity=u,lp.rotation=c,lp.semiMajorAxis=s,lp.semiMinorAxis=a,lp.numberOfVerticalLines=h,lp.offsetAttribute=_===-1?void 0:_,new ET(lp))};ET.createGeometry=function(t){if(t._semiMajorAxis<=0||t._semiMinorAxis<=0)return;let n=t._height,i=t._extrudedHeight,o=!B.equalsEpsilon(n,i,0,B.EPSILON2);t._center=t._ellipsoid.scaleToGeodeticSurface(t._center,t._center);let r={center:t._center,semiMajorAxis:t._semiMajorAxis,semiMinorAxis:t._semiMinorAxis,ellipsoid:t._ellipsoid,rotation:t._rotation,height:n,granularity:t._granularity,numberOfVerticalLines:t._numberOfVerticalLines},s;if(o)r.extrudedHeight=i,r.offsetAttribute=t._offsetAttribute,s=q6e(r);else if(s=j6e(r),f(t._offsetAttribute)){let a=s.attributes.position.values.length,c=t._offsetAttribute===en.NONE?0:1,l=new Uint8Array(a/3).fill(c);s.attributes.applyOffset=new we({componentDatatype:J.UNSIGNED_BYTE,componentsPerAttribute:1,values:l})}return new at({attributes:s.attributes,indices:s.indices,primitiveType:Re.LINES,boundingSphere:s.boundingSphere,offsetAttribute:t._offsetAttribute})};var Wu=ET;var zse=new z,Hse=m.ZERO,Gse=new m,Wse=new le;function Y6e(t){this.id=t,this.vertexFormat=void 0,this.center=void 0,this.semiMajorAxis=void 0,this.semiMinorAxis=void 0,this.rotation=void 0,this.height=void 0,this.extrudedHeight=void 0,this.granularity=void 0,this.stRotation=void 0,this.numberOfVerticalLines=void 0,this.offsetAttribute=void 0}function Jf(t,n){Wn.call(this,{entity:t,scene:n,geometryOptions:new Y6e(t),geometryPropertyName:"ellipse",observedPropertyNames:["availability","position","ellipse"]}),this._onEntityPropertyChanged(t,"ellipse",t.ellipse,void 0)}f(Object.create)&&(Jf.prototype=Object.create(Wn.prototype),Jf.prototype.constructor=Jf);Jf.prototype.createFillGeometryInstance=function(t){let n=this._entity,i=n.isAvailable(t),o={show:new mn(i&&n.isShowing&&this._showProperty.getValue(t)&&this._fillProperty.getValue(t)),distanceDisplayCondition:Vn.fromDistanceDisplayCondition(this._distanceDisplayConditionProperty.getValue(t)),offset:void 0,color:void 0};if(this._materialProperty instanceof Rt){let r;f(this._materialProperty.color)&&(this._materialProperty.color.isConstant||i)&&(r=this._materialProperty.color.getValue(t,zse)),f(r)||(r=z.WHITE),o.color=Lt.fromColor(r)}return f(this._options.offsetAttribute)&&(o.offset=Gi.fromCartesian3(q.getValueOrDefault(this._terrainOffsetProperty,t,Hse,Gse))),new Ct({id:n,geometry:new il(this._options),attributes:o})};Jf.prototype.createOutlineGeometryInstance=function(t){let n=this._entity,i=n.isAvailable(t),o=q.getValueOrDefault(this._outlineColorProperty,t,z.BLACK,zse),r=this._distanceDisplayConditionProperty.getValue(t),s={show:new mn(i&&n.isShowing&&this._showProperty.getValue(t)&&this._showOutlineProperty.getValue(t)),color:Lt.fromColor(o),distanceDisplayCondition:Vn.fromDistanceDisplayCondition(r),offset:void 0};return f(this._options.offsetAttribute)&&(s.offset=Gi.fromCartesian3(q.getValueOrDefault(this._terrainOffsetProperty,t,Hse,Gse))),new Ct({id:n,geometry:new Wu(this._options),attributes:s})};Jf.prototype._computeCenter=function(t,n){return q.getValueOrUndefined(this._entity.position,t,n)};Jf.prototype._isHidden=function(t,n){let i=t.position;return!f(i)||!f(n.semiMajorAxis)||!f(n.semiMinorAxis)||ti.prototype._isHidden.call(this,t,n)};Jf.prototype._isDynamic=function(t,n){return!t.position.isConstant||!n.semiMajorAxis.isConstant||!n.semiMinorAxis.isConstant||!q.isConstant(n.rotation)||!q.isConstant(n.height)||!q.isConstant(n.extrudedHeight)||!q.isConstant(n.granularity)||!q.isConstant(n.stRotation)||!q.isConstant(n.outlineWidth)||!q.isConstant(n.numberOfVerticalLines)||!q.isConstant(n.zIndex)||this._onTerrain&&!q.isConstant(this._materialProperty)&&!(this._materialProperty instanceof Rt)};Jf.prototype._setStaticOptions=function(t,n){let i=q.getValueOrUndefined(n.height,Ue.MINIMUM_VALUE),o=q.getValueOrDefault(n.heightReference,Ue.MINIMUM_VALUE,Ge.NONE),r=q.getValueOrUndefined(n.extrudedHeight,Ue.MINIMUM_VALUE),s=q.getValueOrDefault(n.extrudedHeightReference,Ue.MINIMUM_VALUE,Ge.NONE);f(r)&&!f(i)&&(i=0);let a=this._options;a.vertexFormat=this._materialProperty instanceof Rt?tn.VERTEX_FORMAT:ro.MaterialSupport.TEXTURED.vertexFormat,a.center=t.position.getValue(Ue.MINIMUM_VALUE,a.center),a.semiMajorAxis=n.semiMajorAxis.getValue(Ue.MINIMUM_VALUE,a.semiMajorAxis),a.semiMinorAxis=n.semiMinorAxis.getValue(Ue.MINIMUM_VALUE,a.semiMinorAxis),a.rotation=q.getValueOrUndefined(n.rotation,Ue.MINIMUM_VALUE),a.granularity=q.getValueOrUndefined(n.granularity,Ue.MINIMUM_VALUE),a.stRotation=q.getValueOrUndefined(n.stRotation,Ue.MINIMUM_VALUE),a.numberOfVerticalLines=q.getValueOrUndefined(n.numberOfVerticalLines,Ue.MINIMUM_VALUE),a.offsetAttribute=Wn.computeGeometryOffsetAttribute(i,o,r,s),a.height=Wn.getGeometryHeight(i,o),r=Wn.getGeometryExtrudedHeight(r,s),r===Wn.CLAMP_TO_GROUND&&(r=ri.getMinimumMaximumHeights(il.computeRectangle(a,Wse)).minimumTerrainHeight),a.extrudedHeight=r};Jf.DynamicGeometryUpdater=bT;function bT(t,n,i){ei.call(this,t,n,i)}f(Object.create)&&(bT.prototype=Object.create(ei.prototype),bT.prototype.constructor=bT);bT.prototype._isHidden=function(t,n,i){let o=this._options;return!f(o.center)||!f(o.semiMajorAxis)||!f(o.semiMinorAxis)||ei.prototype._isHidden.call(this,t,n,i)};bT.prototype._setOptions=function(t,n,i){let o=this._options,r=q.getValueOrUndefined(n.height,i),s=q.getValueOrDefault(n.heightReference,i,Ge.NONE),a=q.getValueOrUndefined(n.extrudedHeight,i),c=q.getValueOrDefault(n.extrudedHeightReference,i,Ge.NONE);f(a)&&!f(r)&&(r=0),o.center=q.getValueOrUndefined(t.position,i,o.center),o.semiMajorAxis=q.getValueOrUndefined(n.semiMajorAxis,i),o.semiMinorAxis=q.getValueOrUndefined(n.semiMinorAxis,i),o.rotation=q.getValueOrUndefined(n.rotation,i),o.granularity=q.getValueOrUndefined(n.granularity,i),o.stRotation=q.getValueOrUndefined(n.stRotation,i),o.numberOfVerticalLines=q.getValueOrUndefined(n.numberOfVerticalLines,i),o.offsetAttribute=Wn.computeGeometryOffsetAttribute(r,s,a,c),o.height=Wn.getGeometryHeight(r,s),a=Wn.getGeometryExtrudedHeight(a,c),a===Wn.CLAMP_TO_GROUND&&(a=ri.getMinimumMaximumHeights(il.computeRectangle(o,Wse)).minimumTerrainHeight),o.extrudedHeight=a};var SN=Jf;var X6e=new m,K6e=new m,J6e=new m,Z6e=new m,Q6e=new m,$6e=new m(1,1,1),jse=Math.cos,qse=Math.sin;function up(t){t=A(t,A.EMPTY_OBJECT);let n=A(t.radii,$6e),i=A(t.innerRadii,n),o=A(t.minimumClock,0),r=A(t.maximumClock,B.TWO_PI),s=A(t.minimumCone,0),a=A(t.maximumCone,B.PI),c=Math.round(A(t.stackPartitions,64)),l=Math.round(A(t.slicePartitions,64)),u=A(t.vertexFormat,De.DEFAULT);this._radii=m.clone(n),this._innerRadii=m.clone(i),this._minimumClock=o,this._maximumClock=r,this._minimumCone=s,this._maximumCone=a,this._stackPartitions=c,this._slicePartitions=l,this._vertexFormat=De.clone(u),this._offsetAttribute=t.offsetAttribute,this._workerName="createEllipsoidGeometry"}up.packedLength=2*m.packedLength+De.packedLength+7;up.pack=function(t,n,i){return i=A(i,0),m.pack(t._radii,n,i),i+=m.packedLength,m.pack(t._innerRadii,n,i),i+=m.packedLength,De.pack(t._vertexFormat,n,i),i+=De.packedLength,n[i++]=t._minimumClock,n[i++]=t._maximumClock,n[i++]=t._minimumCone,n[i++]=t._maximumCone,n[i++]=t._stackPartitions,n[i++]=t._slicePartitions,n[i]=A(t._offsetAttribute,-1),n};var Yse=new m,Xse=new m,Kse=new De,ag={radii:Yse,innerRadii:Xse,vertexFormat:Kse,minimumClock:void 0,maximumClock:void 0,minimumCone:void 0,maximumCone:void 0,stackPartitions:void 0,slicePartitions:void 0,offsetAttribute:void 0};up.unpack=function(t,n,i){n=A(n,0);let o=m.unpack(t,n,Yse);n+=m.packedLength;let r=m.unpack(t,n,Xse);n+=m.packedLength;let s=De.unpack(t,n,Kse);n+=De.packedLength;let a=t[n++],c=t[n++],l=t[n++],u=t[n++],d=t[n++],h=t[n++],_=t[n];return f(i)?(i._radii=m.clone(o,i._radii),i._innerRadii=m.clone(r,i._innerRadii),i._vertexFormat=De.clone(s,i._vertexFormat),i._minimumClock=a,i._maximumClock=c,i._minimumCone=l,i._maximumCone=u,i._stackPartitions=d,i._slicePartitions=h,i._offsetAttribute=_===-1?void 0:_,i):(ag.minimumClock=a,ag.maximumClock=c,ag.minimumCone=l,ag.maximumCone=u,ag.stackPartitions=d,ag.slicePartitions=h,ag.offsetAttribute=_===-1?void 0:_,new up(ag))};up.createGeometry=function(t){let n=t._radii;if(n.x<=0||n.y<=0||n.z<=0)return;let i=t._innerRadii;if(i.x<=0||i.y<=0||i.z<=0)return;let o=t._minimumClock,r=t._maximumClock,s=t._minimumCone,a=t._maximumCone,c=t._vertexFormat,l=t._slicePartitions+1,u=t._stackPartitions+1;l=Math.round(l*Math.abs(r-o)/B.TWO_PI),u=Math.round(u*Math.abs(a-s)/B.PI),l<2&&(l=2),u<2&&(u=2);let d,h,_=0,y=[s],p=[o];for(d=0;d<u;d++)y.push(s+d*(a-s)/(u-1));for(y.push(a),h=0;h<l;h++)p.push(o+h*(r-o)/(l-1));p.push(r);let C=y.length,x=p.length,T=0,E=1,S=i.x!==n.x||i.y!==n.y||i.z!==n.z,w=!1,D=!1,I=!1;S&&(E=2,s>0&&(w=!0,T+=l-1),a<Math.PI&&(D=!0,T+=l-1),(r-o)%B.TWO_PI?(I=!0,T+=(u-1)*2+1):T+=1);let O=x*C*E,M=new Float64Array(O*3),L=new Array(O).fill(!1),F=new Array(O).fill(!1),g=l*u*E,b=6*(g+T+1-(l+u)*E),v=Ne.createTypedArray(g,b),P=c.normal?new Float32Array(O*3):void 0,R=c.tangent?new Float32Array(O*3):void 0,V=c.bitangent?new Float32Array(O*3):void 0,H=c.st?new Float32Array(O*2):void 0,U=new Array(C),G=new Array(C);for(d=0;d<C;d++)U[d]=qse(y[d]),G[d]=jse(y[d]);let k=new Array(x),X=new Array(x);for(h=0;h<x;h++)X[h]=jse(p[h]),k[h]=qse(p[h]);for(d=0;d<C;d++)for(h=0;h<x;h++)M[_++]=n.x*U[d]*X[h],M[_++]=n.y*U[d]*k[h],M[_++]=n.z*G[d];let Y=O/2;if(S)for(d=0;d<C;d++)for(h=0;h<x;h++)M[_++]=i.x*U[d]*X[h],M[_++]=i.y*U[d]*k[h],M[_++]=i.z*G[d],L[Y]=!0,d>0&&d!==C-1&&h!==0&&h!==x-1&&(F[Y]=!0),Y++;_=0;let K,j;for(d=1;d<C-2;d++)for(K=d*x,j=(d+1)*x,h=1;h<x-2;h++)v[_++]=j+h,v[_++]=j+h+1,v[_++]=K+h+1,v[_++]=j+h,v[_++]=K+h+1,v[_++]=K+h;if(S){let Nt=C*x;for(d=1;d<C-2;d++)for(K=Nt+d*x,j=Nt+(d+1)*x,h=1;h<x-2;h++)v[_++]=j+h,v[_++]=K+h,v[_++]=K+h+1,v[_++]=j+h,v[_++]=K+h+1,v[_++]=j+h+1}let Z,Q;if(S){if(w)for(Q=C*x,d=1;d<x-2;d++)v[_++]=d,v[_++]=d+1,v[_++]=Q+d+1,v[_++]=d,v[_++]=Q+d+1,v[_++]=Q+d;if(D)for(Z=C*x-x,Q=C*x*E-x,d=1;d<x-2;d++)v[_++]=Z+d+1,v[_++]=Z+d,v[_++]=Q+d,v[_++]=Z+d+1,v[_++]=Q+d,v[_++]=Q+d+1}if(I){for(d=1;d<C-2;d++)Q=x*C+x*d,Z=x*d,v[_++]=Q,v[_++]=Z+x,v[_++]=Z,v[_++]=Q,v[_++]=Q+x,v[_++]=Z+x;for(d=1;d<C-2;d++)Q=x*C+x*(d+1)-1,Z=x*(d+1)-1,v[_++]=Z+x,v[_++]=Q,v[_++]=Z,v[_++]=Z+x,v[_++]=Q+x,v[_++]=Q}let me=new cn;c.position&&(me.position=new we({componentDatatype:J.DOUBLE,componentsPerAttribute:3,values:M}));let _e=0,re=0,fe=0,ge=0,be=O/2,Be,ke=oe.fromCartesian3(n),qe=oe.fromCartesian3(i);if(c.st||c.normal||c.tangent||c.bitangent){for(d=0;d<O;d++){Be=L[d]?qe:ke;let Nt=m.fromArray(M,d*3,X6e),Wt=Be.geodeticSurfaceNormal(Nt,K6e);if(F[d]&&m.negate(Wt,Wt),c.st){let un=W.negate(Wt,Q6e);H[_e++]=Math.atan2(un.y,un.x)/B.TWO_PI+.5,H[_e++]=Math.asin(Wt.z)/Math.PI+.5}if(c.normal&&(P[re++]=Wt.x,P[re++]=Wt.y,P[re++]=Wt.z),c.tangent||c.bitangent){let un=J6e,_t=0,Rn;if(L[d]&&(_t=be),!w&&d>=_t&&d<_t+x*2?Rn=m.UNIT_X:Rn=m.UNIT_Z,m.cross(Rn,Wt,un),m.normalize(un,un),c.tangent&&(R[fe++]=un.x,R[fe++]=un.y,R[fe++]=un.z),c.bitangent){let oi=m.cross(Wt,un,Z6e);m.normalize(oi,oi),V[ge++]=oi.x,V[ge++]=oi.y,V[ge++]=oi.z}}}c.st&&(me.st=new we({componentDatatype:J.FLOAT,componentsPerAttribute:2,values:H})),c.normal&&(me.normal=new we({componentDatatype:J.FLOAT,componentsPerAttribute:3,values:P})),c.tangent&&(me.tangent=new we({componentDatatype:J.FLOAT,componentsPerAttribute:3,values:R})),c.bitangent&&(me.bitangent=new we({componentDatatype:J.FLOAT,componentsPerAttribute:3,values:V}))}if(f(t._offsetAttribute)){let Nt=M.length,Wt=t._offsetAttribute===en.NONE?0:1,un=new Uint8Array(Nt/3).fill(Wt);me.applyOffset=new we({componentDatatype:J.UNSIGNED_BYTE,componentsPerAttribute:1,values:un})}return new at({attributes:me,indices:v,primitiveType:Re.TRIANGLES,boundingSphere:ae.fromEllipsoid(ke),offsetAttribute:t._offsetAttribute})};var i9;up.getUnitEllipsoid=function(){return f(i9)||(i9=up.createGeometry(new up({radii:new m(1,1,1),vertexFormat:De.POSITION_ONLY}))),i9};var Vs=up;var e9e=new Rt(z.WHITE),o9=m.ZERO,r9=new m,t9e=new m,n9e=new m,s9=new z,i9e=new m(1,1,1);function o9e(t){this.id=t,this.vertexFormat=void 0,this.radii=void 0,this.innerRadii=void 0,this.minimumClock=void 0,this.maximumClock=void 0,this.minimumCone=void 0,this.maximumCone=void 0,this.stackPartitions=void 0,this.slicePartitions=void 0,this.subdivisions=void 0,this.offsetAttribute=void 0}function kl(t,n){ti.call(this,{entity:t,scene:n,geometryOptions:new o9e(t),geometryPropertyName:"ellipsoid",observedPropertyNames:["availability","position","orientation","ellipsoid"]}),this._onEntityPropertyChanged(t,"ellipsoid",t.ellipsoid,void 0)}f(Object.create)&&(kl.prototype=Object.create(ti.prototype),kl.prototype.constructor=kl);Object.defineProperties(kl.prototype,{terrainOffsetProperty:{get:function(){return this._terrainOffsetProperty}}});kl.prototype.createFillGeometryInstance=function(t,n,i){let o=this._entity,r=o.isAvailable(t),s,a=new mn(r&&o.isShowing&&this._showProperty.getValue(t)&&this._fillProperty.getValue(t)),c=this._distanceDisplayConditionProperty.getValue(t),l=Vn.fromDistanceDisplayCondition(c),u={show:a,distanceDisplayCondition:l,color:void 0,offset:void 0};if(this._materialProperty instanceof Rt){let d;f(this._materialProperty.color)&&(this._materialProperty.color.isConstant||r)&&(d=this._materialProperty.color.getValue(t,s9)),f(d)||(d=z.WHITE),s=Lt.fromColor(d),u.color=s}return f(this._options.offsetAttribute)&&(u.offset=Gi.fromCartesian3(q.getValueOrDefault(this._terrainOffsetProperty,t,o9,r9))),new Ct({id:o,geometry:new Vs(this._options),modelMatrix:n?void 0:o.computeModelMatrixForHeightReference(t,o.ellipsoid.heightReference,this._options.radii.z*.5,this._scene.mapProjection.ellipsoid,i),attributes:u})};kl.prototype.createOutlineGeometryInstance=function(t,n,i){let o=this._entity,r=o.isAvailable(t),s=q.getValueOrDefault(this._outlineColorProperty,t,z.BLACK,s9),a=this._distanceDisplayConditionProperty.getValue(t),c={show:new mn(r&&o.isShowing&&this._showProperty.getValue(t)&&this._showOutlineProperty.getValue(t)),color:Lt.fromColor(s),distanceDisplayCondition:Vn.fromDistanceDisplayCondition(a),offset:void 0};return f(this._options.offsetAttribute)&&(c.offset=Gi.fromCartesian3(q.getValueOrDefault(this._terrainOffsetProperty,t,o9,r9))),new Ct({id:o,geometry:new Mu(this._options),modelMatrix:n?void 0:o.computeModelMatrixForHeightReference(t,o.ellipsoid.heightReference,this._options.radii.z*.5,this._scene.mapProjection.ellipsoid,i),attributes:c})};kl.prototype._computeCenter=function(t,n){return q.getValueOrUndefined(this._entity.position,t,n)};kl.prototype._isHidden=function(t,n){return!f(t.position)||!f(n.radii)||ti.prototype._isHidden.call(this,t,n)};kl.prototype._isDynamic=function(t,n){return!t.position.isConstant||!q.isConstant(t.orientation)||!n.radii.isConstant||!q.isConstant(n.innerRadii)||!q.isConstant(n.stackPartitions)||!q.isConstant(n.slicePartitions)||!q.isConstant(n.outlineWidth)||!q.isConstant(n.minimumClock)||!q.isConstant(n.maximumClock)||!q.isConstant(n.minimumCone)||!q.isConstant(n.maximumCone)||!q.isConstant(n.subdivisions)};kl.prototype._setStaticOptions=function(t,n){let i=q.getValueOrDefault(n.heightReference,Ue.MINIMUM_VALUE,Ge.NONE),o=this._options;o.vertexFormat=this._materialProperty instanceof Rt?tn.VERTEX_FORMAT:ro.MaterialSupport.TEXTURED.vertexFormat,o.radii=n.radii.getValue(Ue.MINIMUM_VALUE,o.radii),o.innerRadii=q.getValueOrUndefined(n.innerRadii,o.radii),o.minimumClock=q.getValueOrUndefined(n.minimumClock,Ue.MINIMUM_VALUE),o.maximumClock=q.getValueOrUndefined(n.maximumClock,Ue.MINIMUM_VALUE),o.minimumCone=q.getValueOrUndefined(n.minimumCone,Ue.MINIMUM_VALUE),o.maximumCone=q.getValueOrUndefined(n.maximumCone,Ue.MINIMUM_VALUE),o.stackPartitions=q.getValueOrUndefined(n.stackPartitions,Ue.MINIMUM_VALUE),o.slicePartitions=q.getValueOrUndefined(n.slicePartitions,Ue.MINIMUM_VALUE),o.subdivisions=q.getValueOrUndefined(n.subdivisions,Ue.MINIMUM_VALUE),o.offsetAttribute=i!==Ge.NONE?en.ALL:void 0};kl.prototype._onEntityPropertyChanged=x_;kl.DynamicGeometryUpdater=Qw;function Qw(t,n,i){ei.call(this,t,n,i),this._scene=t._scene,this._modelMatrix=new N,this._attributes=void 0,this._outlineAttributes=void 0,this._lastSceneMode=void 0,this._lastShow=void 0,this._lastOutlineShow=void 0,this._lastOutlineWidth=void 0,this._lastOutlineColor=void 0,this._lastOffset=new m,this._material={}}f(Object.create)&&(Qw.prototype=Object.create(ei.prototype),Qw.prototype.constructor=Qw);Qw.prototype.update=function(t){let n=this._entity,i=n.ellipsoid;if(!n.isShowing||!n.isAvailable(t)||!q.getValueOrDefault(i.show,t,!0)){f(this._primitive)&&(this._primitive.show=!1),f(this._outlinePrimitive)&&(this._outlinePrimitive.show=!1);return}let o=q.getValueOrUndefined(i.radii,t,t9e),r=f(o)?n.computeModelMatrixForHeightReference(t,i.heightReference,o.z*.5,this._scene.mapProjection.ellipsoid,this._modelMatrix):void 0;if(!f(r)||!f(o)){f(this._primitive)&&(this._primitive.show=!1),f(this._outlinePrimitive)&&(this._outlinePrimitive.show=!1);return}let s=q.getValueOrDefault(i.fill,t,!0),a=q.getValueOrDefault(i.outline,t,!1),c=q.getValueOrClonedDefault(i.outlineColor,t,z.BLACK,s9),l=Zo.getValue(t,A(i.material,e9e),this._material),u=q.getValueOrUndefined(i.innerRadii,t,n9e),d=q.getValueOrUndefined(i.minimumClock,t),h=q.getValueOrUndefined(i.maximumClock,t),_=q.getValueOrUndefined(i.minimumCone,t),y=q.getValueOrUndefined(i.maximumCone,t),p=q.getValueOrUndefined(i.stackPartitions,t),C=q.getValueOrUndefined(i.slicePartitions,t),x=q.getValueOrUndefined(i.subdivisions,t),T=q.getValueOrDefault(i.outlineWidth,t,1),E=q.getValueOrDefault(i.heightReference,t,Ge.NONE),S=E!==Ge.NONE?en.ALL:void 0,w=this._scene.mode,D=w===ne.SCENE3D&&E===Ge.NONE,I=this._options,O=this._geometryUpdater.shadowsProperty.getValue(t),L=this._geometryUpdater.distanceDisplayConditionProperty.getValue(t),F=q.getValueOrDefault(this._geometryUpdater.terrainOffsetProperty,t,o9,r9);if(!D||this._lastSceneMode!==w||!f(this._primitive)||I.stackPartitions!==p||I.slicePartitions!==C||f(u)&&!m.equals(I.innerRadii!==u)||I.minimumClock!==d||I.maximumClock!==h||I.minimumCone!==_||I.maximumCone!==y||I.subdivisions!==x||this._lastOutlineWidth!==T||I.offsetAttribute!==S){let b=this._primitives;if(b.removeAndDestroy(this._primitive),b.removeAndDestroy(this._outlinePrimitive),this._primitive=void 0,this._outlinePrimitive=void 0,this._lastSceneMode=w,this._lastOutlineWidth=T,I.stackPartitions=p,I.slicePartitions=C,I.subdivisions=x,I.offsetAttribute=S,I.radii=m.clone(D?i9e:o,I.radii),f(u))if(D){let V=m.magnitude(o);I.innerRadii=m.fromElements(u.x/V,u.y/V,u.z/V,I.innerRadii)}else I.innerRadii=m.clone(u,I.innerRadii);else I.innerRadii=void 0;I.minimumClock=d,I.maximumClock=h,I.minimumCone=_,I.maximumCone=y;let v=new ro({material:l,translucent:l.isTranslucent(),closed:!0});I.vertexFormat=v.vertexFormat;let P=this._geometryUpdater.createFillGeometryInstance(t,D,this._modelMatrix);this._primitive=b.add(new Sn({geometryInstances:P,appearance:v,asynchronous:!1,shadows:O}));let R=this._geometryUpdater.createOutlineGeometryInstance(t,D,this._modelMatrix);this._outlinePrimitive=b.add(new Sn({geometryInstances:R,appearance:new tn({flat:!0,translucent:R.attributes.color.value[3]!==255,renderState:{lineWidth:this._geometryUpdater._scene.clampLineWidth(T)}}),asynchronous:!1,shadows:O})),this._lastShow=s,this._lastOutlineShow=a,this._lastOutlineColor=z.clone(c,this._lastOutlineColor),this._lastDistanceDisplayCondition=L,this._lastOffset=m.clone(F,this._lastOffset)}else if(this._primitive.ready){let b=this._primitive,v=this._outlinePrimitive;b.show=!0,v.show=!0,b.appearance.material=l;let P=this._attributes;f(P)||(P=b.getGeometryInstanceAttributes(n),this._attributes=P),s!==this._lastShow&&(P.show=mn.toValue(s,P.show),this._lastShow=s);let R=this._outlineAttributes;f(R)||(R=v.getGeometryInstanceAttributes(n),this._outlineAttributes=R),a!==this._lastOutlineShow&&(R.show=mn.toValue(a,R.show),this._lastOutlineShow=a),z.equals(c,this._lastOutlineColor)||(R.color=Lt.toValue(c,R.color),z.clone(c,this._lastOutlineColor)),wt.equals(L,this._lastDistanceDisplayCondition)||(P.distanceDisplayCondition=Vn.toValue(L,P.distanceDisplayCondition),R.distanceDisplayCondition=Vn.toValue(L,R.distanceDisplayCondition),wt.clone(L,this._lastDistanceDisplayCondition)),m.equals(F,this._lastOffset)||(P.offset=Gi.toValue(F,P.offset),R.offset=Gi.toValue(F,P.offset),m.clone(F,this._lastOffset))}D&&(o.x=Math.max(o.x,.001),o.y=Math.max(o.y,.001),o.z=Math.max(o.z,.001),r=N.multiplyByScale(r,o,r),this._primitive.modelMatrix=r,this._outlinePrimitive.modelMatrix=r)};var wN=kl;function ST(t){t=A(t,A.EMPTY_OBJECT);let n=A(t.vertexFormat,De.DEFAULT);this._vertexFormat=n,this._workerName="createPlaneGeometry"}ST.packedLength=De.packedLength;ST.pack=function(t,n,i){return i=A(i,0),De.pack(t._vertexFormat,n,i),n};var Jse=new De,r9e={vertexFormat:Jse};ST.unpack=function(t,n,i){n=A(n,0);let o=De.unpack(t,n,Jse);return f(i)?(i._vertexFormat=De.clone(o,i._vertexFormat),i):new ST(r9e)};var DN=new m(-.5,-.5,0),vN=new m(.5,.5,0);ST.createGeometry=function(t){let n=t._vertexFormat,i=new cn,o,r;if(n.position){if(r=new Float64Array(4*3),r[0]=DN.x,r[1]=DN.y,r[2]=0,r[3]=vN.x,r[4]=DN.y,r[5]=0,r[6]=vN.x,r[7]=vN.y,r[8]=0,r[9]=DN.x,r[10]=vN.y,r[11]=0,i.position=new we({componentDatatype:J.DOUBLE,componentsPerAttribute:3,values:r}),n.normal){let s=new Float32Array(12);s[0]=0,s[1]=0,s[2]=1,s[3]=0,s[4]=0,s[5]=1,s[6]=0,s[7]=0,s[8]=1,s[9]=0,s[10]=0,s[11]=1,i.normal=new we({componentDatatype:J.FLOAT,componentsPerAttribute:3,values:s})}if(n.st){let s=new Float32Array(8);s[0]=0,s[1]=0,s[2]=1,s[3]=0,s[4]=1,s[5]=1,s[6]=0,s[7]=1,i.st=new we({componentDatatype:J.FLOAT,componentsPerAttribute:2,values:s})}if(n.tangent){let s=new Float32Array(12);s[0]=1,s[1]=0,s[2]=0,s[3]=1,s[4]=0,s[5]=0,s[6]=1,s[7]=0,s[8]=0,s[9]=1,s[10]=0,s[11]=0,i.tangent=new we({componentDatatype:J.FLOAT,componentsPerAttribute:3,values:s})}if(n.bitangent){let s=new Float32Array(12);s[0]=0,s[1]=1,s[2]=0,s[3]=0,s[4]=1,s[5]=0,s[6]=0,s[7]=1,s[8]=0,s[9]=0,s[10]=1,s[11]=0,i.bitangent=new we({componentDatatype:J.FLOAT,componentsPerAttribute:3,values:s})}o=new Uint16Array(2*3),o[0]=0,o[1]=1,o[2]=2,o[3]=0,o[4]=2,o[5]=3}return new at({attributes:i,indices:o,primitiveType:Re.TRIANGLES,boundingSphere:new ae(m.ZERO,Math.sqrt(2))})};var PN=ST;function wT(){this._workerName="createPlaneOutlineGeometry"}wT.packedLength=0;wT.pack=function(t,n){return n};wT.unpack=function(t,n,i){return f(i)?i:new wT};var cg=new m(-.5,-.5,0),IN=new m(.5,.5,0);wT.createGeometry=function(){let t=new cn,n=new Uint16Array(4*2),i=new Float64Array(4*3);return i[0]=cg.x,i[1]=cg.y,i[2]=cg.z,i[3]=IN.x,i[4]=cg.y,i[5]=cg.z,i[6]=IN.x,i[7]=IN.y,i[8]=cg.z,i[9]=cg.x,i[10]=IN.y,i[11]=cg.z,t.position=new we({componentDatatype:J.DOUBLE,componentsPerAttribute:3,values:i}),n[0]=0,n[1]=1,n[2]=1,n[3]=2,n[4]=2,n[5]=3,n[6]=3,n[7]=0,new at({attributes:t,indices:n,primitiveType:Re.LINES,boundingSphere:new ae(m.ZERO,Math.sqrt(2))})};var BN=wT;var s9e=new m,Zse=new z;function a9e(t){this.id=t,this.vertexFormat=void 0,this.plane=void 0,this.dimensions=void 0}function ju(t,n){ti.call(this,{entity:t,scene:n,geometryOptions:new a9e(t),geometryPropertyName:"plane",observedPropertyNames:["availability","position","orientation","plane"]}),this._onEntityPropertyChanged(t,"plane",t.plane,void 0)}f(Object.create)&&(ju.prototype=Object.create(ti.prototype),ju.prototype.constructor=ju);ju.prototype.createFillGeometryInstance=function(t){let n=this._entity,i=n.isAvailable(t),o,r,s=new mn(i&&n.isShowing&&this._showProperty.getValue(t)&&this._fillProperty.getValue(t)),a=this._distanceDisplayConditionProperty.getValue(t),c=Vn.fromDistanceDisplayCondition(a);if(this._materialProperty instanceof Rt){let y;f(this._materialProperty.color)&&(this._materialProperty.color.isConstant||i)&&(y=this._materialProperty.color.getValue(t,Zse)),f(y)||(y=z.WHITE),r=Lt.fromColor(y),o={show:s,distanceDisplayCondition:c,color:r}}else o={show:s,distanceDisplayCondition:c};let l=n.plane,u=this._options,d=n.computeModelMatrix(t),h=q.getValueOrDefault(l.plane,t,u.plane),_=q.getValueOrUndefined(l.dimensions,t,u.dimensions);return u.plane=h,u.dimensions=_,d=a9(h,_,d,d),new Ct({id:n,geometry:new PN(this._options),modelMatrix:d,attributes:o})};ju.prototype.createOutlineGeometryInstance=function(t){let n=this._entity,i=n.isAvailable(t),o=q.getValueOrDefault(this._outlineColorProperty,t,z.BLACK,Zse),r=this._distanceDisplayConditionProperty.getValue(t),s=n.plane,a=this._options,c=n.computeModelMatrix(t),l=q.getValueOrDefault(s.plane,t,a.plane),u=q.getValueOrUndefined(s.dimensions,t,a.dimensions);return a.plane=l,a.dimensions=u,c=a9(l,u,c,c),new Ct({id:n,geometry:new BN,modelMatrix:c,attributes:{show:new mn(i&&n.isShowing&&this._showProperty.getValue(t)&&this._showOutlineProperty.getValue(t)),color:Lt.fromColor(o),distanceDisplayCondition:Vn.fromDistanceDisplayCondition(r)}})};ju.prototype._isHidden=function(t,n){return!f(n.plane)||!f(n.dimensions)||!f(t.position)||ti.prototype._isHidden.call(this,t,n)};ju.prototype._getIsClosed=function(t){return!1};ju.prototype._isDynamic=function(t,n){return!t.position.isConstant||!q.isConstant(t.orientation)||!n.plane.isConstant||!n.dimensions.isConstant||!q.isConstant(n.outlineWidth)};ju.prototype._setStaticOptions=function(t,n){let i=this._materialProperty instanceof Rt,o=this._options;o.vertexFormat=i?tn.VERTEX_FORMAT:ro.MaterialSupport.TEXTURED.vertexFormat,o.plane=n.plane.getValue(Ue.MINIMUM_VALUE,o.plane),o.dimensions=n.dimensions.getValue(Ue.MINIMUM_VALUE,o.dimensions)};ju.DynamicGeometryUpdater=DT;function DT(t,n,i){ei.call(this,t,n,i)}f(Object.create)&&(DT.prototype=Object.create(ei.prototype),DT.prototype.constructor=DT);DT.prototype._isHidden=function(t,n,i){let o=this._options,r=q.getValueOrUndefined(t.position,i,s9e);return!f(r)||!f(o.plane)||!f(o.dimensions)||ei.prototype._isHidden.call(this,t,n,i)};DT.prototype._setOptions=function(t,n,i){let o=this._options;o.plane=q.getValueOrDefault(n.plane,i,o.plane),o.dimensions=q.getValueOrUndefined(n.dimensions,i,o.dimensions)};var c9e=new m,l9e=new m,u9e=new m,f9e=new m,d9e=new $,h9e=new $,m9e=new N;function a9(t,n,i,o){let r=t.normal,s=t.distance,a=m.multiplyByScalar(r,-s,u9e),c=m.clone(m.UNIT_Z,l9e);B.equalsEpsilon(Math.abs(m.dot(c,r)),1,B.EPSILON8)&&(c=m.clone(m.UNIT_Y,c));let l=m.cross(c,r,c9e);c=m.cross(r,l,c),m.normalize(l,l),m.normalize(c,c);let u=d9e;$.setColumn(u,0,l,u),$.setColumn(u,1,c,u),$.setColumn(u,2,r,u);let d=m.fromElements(n.x,n.y,1,f9e),h=$.multiplyByScale(u,d,h9e),_=N.fromRotationTranslation(h,a,m9e);return N.multiplyTransformation(i,_,o)}ju.createPrimitiveMatrix=a9;var ON=ju;var p9e=new m,_9e=new He,g9e=new W,y9e=new W,A9e=new m,C9e=new m,x9e=new m,$w=new m,T9e=new m,E9e=new m,Qse=new Me,b9e=new $,S9e=new $,w9e=new m;function D9e(t,n,i,o,r,s,a,c,l){let u=t.positions,d=ni.triangulate(t.positions2D,t.holes);d.length<3&&(d=[0,1,2]);let h=Ne.createTypedArray(u.length,d.length);h.set(d);let _=b9e;if(o!==0){let g=Me.fromAxisAngle(a,o,Qse);if(_=$.fromQuaternion(g,_),n.tangent||n.bitangent){g=Me.fromAxisAngle(a,-o,Qse);let b=$.fromQuaternion(g,S9e);c=m.normalize($.multiplyByVector(b,c,c),c),n.bitangent&&(l=m.normalize(m.cross(a,c,l),l))}}else _=$.clone($.IDENTITY,_);let y=y9e;n.st&&(y.x=i.x,y.y=i.y);let p=u.length,C=p*3,x=new Float64Array(C),T=n.normal?new Float32Array(C):void 0,E=n.tangent?new Float32Array(C):void 0,S=n.bitangent?new Float32Array(C):void 0,w=n.st?new Float32Array(p*2):void 0,D=0,I=0,O=0,M=0,L=0;for(let g=0;g<p;g++){let b=u[g];if(x[D++]=b.x,x[D++]=b.y,x[D++]=b.z,n.st)if(f(r)&&r.positions.length===p)w[L++]=r.positions[g].x,w[L++]=r.positions[g].y;else{let v=$.multiplyByVector(_,b,p9e),P=s(v,g9e);W.subtract(P,y,P);let R=B.clamp(P.x/i.width,0,1),V=B.clamp(P.y/i.height,0,1);w[L++]=R,w[L++]=V}n.normal&&(T[I++]=a.x,T[I++]=a.y,T[I++]=a.z),n.tangent&&(E[M++]=c.x,E[M++]=c.y,E[M++]=c.z),n.bitangent&&(S[O++]=l.x,S[O++]=l.y,S[O++]=l.z)}let F=new cn;return n.position&&(F.position=new we({componentDatatype:J.DOUBLE,componentsPerAttribute:3,values:x})),n.normal&&(F.normal=new we({componentDatatype:J.FLOAT,componentsPerAttribute:3,values:T})),n.tangent&&(F.tangent=new we({componentDatatype:J.FLOAT,componentsPerAttribute:3,values:E})),n.bitangent&&(F.bitangent=new we({componentDatatype:J.FLOAT,componentsPerAttribute:3,values:S})),n.st&&(F.st=new we({componentDatatype:J.FLOAT,componentsPerAttribute:2,values:w})),new at({attributes:F,indices:h,primitiveType:Re.TRIANGLES})}function Vy(t){t=A(t,A.EMPTY_OBJECT);let n=t.polygonHierarchy,i=t.textureCoordinates,o=A(t.vertexFormat,De.DEFAULT);this._vertexFormat=De.clone(o),this._polygonHierarchy=n,this._stRotation=A(t.stRotation,0),this._ellipsoid=oe.clone(A(t.ellipsoid,oe.WGS84)),this._workerName="createCoplanarPolygonGeometry",this._textureCoordinates=i,this.packedLength=Gn.computeHierarchyPackedLength(n,m)+De.packedLength+oe.packedLength+(f(i)?Gn.computeHierarchyPackedLength(i,W):1)+2}Vy.fromPositions=function(t){t=A(t,A.EMPTY_OBJECT);let n={polygonHierarchy:{positions:t.positions},vertexFormat:t.vertexFormat,stRotation:t.stRotation,ellipsoid:t.ellipsoid,textureCoordinates:t.textureCoordinates};return new Vy(n)};Vy.pack=function(t,n,i){return i=A(i,0),i=Gn.packPolygonHierarchy(t._polygonHierarchy,n,i,m),oe.pack(t._ellipsoid,n,i),i+=oe.packedLength,De.pack(t._vertexFormat,n,i),i+=De.packedLength,n[i++]=t._stRotation,f(t._textureCoordinates)?i=Gn.packPolygonHierarchy(t._textureCoordinates,n,i,W):n[i++]=-1,n[i++]=t.packedLength,n};var v9e=oe.clone(oe.UNIT_SPHERE),P9e=new De,I9e={polygonHierarchy:{}};Vy.unpack=function(t,n,i){n=A(n,0);let o=Gn.unpackPolygonHierarchy(t,n,m);n=o.startingIndex,delete o.startingIndex;let r=oe.unpack(t,n,v9e);n+=oe.packedLength;let s=De.unpack(t,n,P9e);n+=De.packedLength;let a=t[n++],c=t[n]===-1?void 0:Gn.unpackPolygonHierarchy(t,n,W);f(c)?(n=c.startingIndex,delete c.startingIndex):n++;let l=t[n++];return f(i)||(i=new Vy(I9e)),i._polygonHierarchy=o,i._ellipsoid=oe.clone(r,i._ellipsoid),i._vertexFormat=De.clone(s,i._vertexFormat),i._stRotation=a,i._textureCoordinates=c,i.packedLength=l,i};Vy.createGeometry=function(t){let n=t._vertexFormat,i=t._polygonHierarchy,o=t._stRotation,r=t._textureCoordinates,s=f(r),a=i.positions;if(a=Co(a,m.equalsEpsilon,!0),a.length<3)return;let c=A9e,l=C9e,u=x9e,d=T9e,h=E9e;if(!V_.computeProjectTo2DArguments(a,$w,d,h))return;if(c=m.cross(d,h,c),c=m.normalize(c,c),!m.equalsEpsilon($w,m.ZERO,B.EPSILON6)){let L=t._ellipsoid.geodeticSurfaceNormal($w,w9e);m.dot(c,L)<0&&(c=m.negate(c,c),d=m.negate(d,d))}let y=V_.createProjectPointsTo2DFunction($w,d,h),p=V_.createProjectPointTo2DFunction($w,d,h);n.tangent&&(l=m.clone(d,l)),n.bitangent&&(u=m.clone(h,u));let C=Gn.polygonsFromHierarchy(i,s,y,!1),x=C.hierarchy,T=C.polygons,E=function(L){return L},S=s?Gn.polygonsFromHierarchy(r,!0,E,!1).polygons:void 0;if(x.length===0)return;a=x[0].outerRing;let w=ae.fromPoints(a),D=Gn.computeBoundingRectangle(c,p,a,o,_9e),I=[];for(let L=0;L<T.length;L++){let F=new Ct({geometry:D9e(T[L],n,D,o,s?S[L]:void 0,p,c,l,u)});I.push(F)}let O=Fn.combineInstances(I)[0];O.attributes.position.values=new Float64Array(O.attributes.position.values),O.indices=Ne.createTypedArray(O.attributes.position.values.length/3,O.indices);let M=O.attributes;return n.position||delete M.position,new at({attributes:M,indices:O.indices,primitiveType:O.primitiveType,boundingSphere:w})};var RN=Vy;var B9e=new de,$se=new de;function O9e(t,n,i,o){let s=o.cartesianToCartographic(t,B9e).height,a=o.cartesianToCartographic(n,$se);a.height=s,o.cartographicToCartesian(a,n);let c=o.cartesianToCartographic(i,$se);c.height=s-100,o.cartographicToCartesian(c,i)}var R9e=new He,M9e=new m,L9e=new m,F9e=new m,N9e=new m,V9e=new m,k9e=new m,MN=new m,Th=new m,vT=new m,U9e=new W,z9e=new W,H9e=new m,eae=new Me,G9e=new $,W9e=new $;function c9(t){let n=t.vertexFormat,i=t.geometry,o=t.shadowVolume,r=i.attributes.position.values,s=f(i.attributes.st)?i.attributes.st.values:void 0,a=r.length,c=t.wall,l=t.top||c,u=t.bottom||c;if(n.st||n.normal||n.tangent||n.bitangent||o){let d=t.boundingRectangle,h=t.tangentPlane,_=t.ellipsoid,y=t.stRotation,p=t.perPositionHeight,C=U9e;C.x=d.x,C.y=d.y;let x=n.st?new Float32Array(2*(a/3)):void 0,T;n.normal&&(p&&l&&!c?T=i.attributes.normal.values:T=new Float32Array(a));let E=n.tangent?new Float32Array(a):void 0,S=n.bitangent?new Float32Array(a):void 0,w=o?new Float32Array(a):void 0,D=0,I=0,O=L9e,M=F9e,L=N9e,F=!0,g=G9e,b=W9e;if(y!==0){let R=Me.fromAxisAngle(h._plane.normal,y,eae);g=$.fromQuaternion(R,g),R=Me.fromAxisAngle(h._plane.normal,-y,eae),b=$.fromQuaternion(R,b)}else g=$.clone($.IDENTITY,g),b=$.clone($.IDENTITY,b);let v=0,P=0;l&&u&&(v=a/2,P=a/3,a/=2);for(let R=0;R<a;R+=3){let V=m.fromArray(r,R,H9e);if(n.st&&!f(s)){let H=$.multiplyByVector(g,V,M9e);H=_.scaleToGeodeticSurface(H,H);let U=h.projectPointOntoPlane(H,z9e);W.subtract(U,C,U);let G=B.clamp(U.x/d.width,0,1),k=B.clamp(U.y/d.height,0,1);u&&(x[D+P]=G,x[D+1+P]=k),l&&(x[D]=G,x[D+1]=k),D+=2}if(n.normal||n.tangent||n.bitangent||o){let H=I+1,U=I+2;if(c){if(R+3<a){let G=m.fromArray(r,R+3,V9e);if(F){let k=m.fromArray(r,R+a,k9e);p&&O9e(V,G,k,_),m.subtract(G,V,G),m.subtract(k,V,k),O=m.normalize(m.cross(k,G,O),O),F=!1}m.equalsEpsilon(G,V,B.EPSILON10)&&(F=!0)}(n.tangent||n.bitangent)&&(L=_.geodeticSurfaceNormal(V,L),n.tangent&&(M=m.normalize(m.cross(L,O,M),M)))}else O=_.geodeticSurfaceNormal(V,O),(n.tangent||n.bitangent)&&(p&&(MN=m.fromArray(T,I,MN),Th=m.cross(m.UNIT_Z,MN,Th),Th=m.normalize($.multiplyByVector(b,Th,Th),Th),n.bitangent&&(vT=m.normalize(m.cross(MN,Th,vT),vT))),M=m.cross(m.UNIT_Z,O,M),M=m.normalize($.multiplyByVector(b,M,M),M),n.bitangent&&(L=m.normalize(m.cross(O,M,L),L)));n.normal&&(t.wall?(T[I+v]=O.x,T[H+v]=O.y,T[U+v]=O.z):u&&(T[I+v]=-O.x,T[H+v]=-O.y,T[U+v]=-O.z),(l&&!p||c)&&(T[I]=O.x,T[H]=O.y,T[U]=O.z)),o&&(c&&(O=_.geodeticSurfaceNormal(V,O)),w[I+v]=-O.x,w[H+v]=-O.y,w[U+v]=-O.z),n.tangent&&(t.wall?(E[I+v]=M.x,E[H+v]=M.y,E[U+v]=M.z):u&&(E[I+v]=-M.x,E[H+v]=-M.y,E[U+v]=-M.z),l&&(p?(E[I]=Th.x,E[H]=Th.y,E[U]=Th.z):(E[I]=M.x,E[H]=M.y,E[U]=M.z))),n.bitangent&&(u&&(S[I+v]=L.x,S[H+v]=L.y,S[U+v]=L.z),l&&(p?(S[I]=vT.x,S[H]=vT.y,S[U]=vT.z):(S[I]=L.x,S[H]=L.y,S[U]=L.z))),I+=3}}n.st&&!f(s)&&(i.attributes.st=new we({componentDatatype:J.FLOAT,componentsPerAttribute:2,values:x})),n.normal&&(i.attributes.normal=new we({componentDatatype:J.FLOAT,componentsPerAttribute:3,values:T})),n.tangent&&(i.attributes.tangent=new we({componentDatatype:J.FLOAT,componentsPerAttribute:3,values:E})),n.bitangent&&(i.attributes.bitangent=new we({componentDatatype:J.FLOAT,componentsPerAttribute:3,values:S})),o&&(i.attributes.extrudeDirection=new we({componentDatatype:J.FLOAT,componentsPerAttribute:3,values:w}))}if(t.extrude&&f(t.offsetAttribute)){let d=r.length/3,h=new Uint8Array(d);if(t.offsetAttribute===en.TOP)l&&u||c?h=h.fill(1,0,d/2):l&&(h=h.fill(1));else{let _=t.offsetAttribute===en.NONE?0:1;h=h.fill(_)}i.attributes.applyOffset=new we({componentDatatype:J.UNSIGNED_BYTE,componentsPerAttribute:1,values:h})}return i}var j9e=new de,q9e=new de,lg={westOverIDL:0,eastOverIDL:0},PT=new Of;function iae(t,n,i,o,r){if(r=A(r,new le),!f(t)||t.length<3)return r.west=0,r.north=0,r.south=0,r.east=0,r;if(i===Zt.RHUMB)return le.fromCartesianArray(t,n,r);PT.ellipsoid.equals(n)||(PT=new Of(void 0,void 0,n)),r.west=Number.POSITIVE_INFINITY,r.east=Number.NEGATIVE_INFINITY,r.south=Number.POSITIVE_INFINITY,r.north=Number.NEGATIVE_INFINITY,lg.westOverIDL=Number.POSITIVE_INFINITY,lg.eastOverIDL=Number.NEGATIVE_INFINITY;let s=1/B.chordLength(o,n.maximumRadius),a=t.length,c=n.cartesianToCartographic(t[0],q9e),l=j9e,u;for(let d=1;d<a;d++)u=l,l=c,c=n.cartesianToCartographic(t[d],u),PT.setEndPoints(l,c),tae(PT,s,r,lg);return u=l,l=c,c=n.cartesianToCartographic(t[0],u),PT.setEndPoints(l,c),tae(PT,s,r,lg),r.east-r.west>lg.eastOverIDL-lg.westOverIDL&&(r.west=lg.westOverIDL,r.east=lg.eastOverIDL,r.east>B.PI&&(r.east=r.east-B.TWO_PI),r.west>B.PI&&(r.west=r.west-B.TWO_PI)),r}var Y9e=new de;function tae(t,n,i,o){let r=t.surfaceDistance,s=Math.ceil(r*n),a=s>0?r/(s-1):Number.POSITIVE_INFINITY,c=0;for(let l=0;l<s;l++){let u=t.interpolateUsingSurfaceDistance(c,Y9e);c+=a;let d=u.longitude,h=u.latitude;i.west=Math.min(i.west,d),i.east=Math.max(i.east,d),i.south=Math.min(i.south,h),i.north=Math.max(i.north,h);let _=d>=0?d:d+B.TWO_PI;o.westOverIDL=Math.min(o.westOverIDL,_),o.eastOverIDL=Math.max(o.eastOverIDL,_)}}var nae=[];function X9e(t,n,i,o,r,s,a,c,l,u){let d={walls:[]},h;if(a||c){let E=Gn.createGeometryFromPositions(t,n,i,o,s,l,u),S=E.attributes.position.values,w=E.indices,D,I;if(a&&c){let O=S.concat(S);D=O.length/3,I=Ne.createTypedArray(D,w.length*2),I.set(w);let M=w.length,L=D/2;for(h=0;h<M;h+=3){let F=I[h]+L,g=I[h+1]+L,b=I[h+2]+L;I[h+M]=b,I[h+1+M]=g,I[h+2+M]=F}if(E.attributes.position.values=O,s&&l.normal){let F=E.attributes.normal.values;E.attributes.normal.values=new Float32Array(O.length),E.attributes.normal.values.set(F)}if(l.st&&f(i)){let F=E.attributes.st.values;E.attributes.st.values=new Float32Array(D*2),E.attributes.st.values=F.concat(F)}E.indices=I}else if(c){for(D=S.length/3,I=Ne.createTypedArray(D,w.length),h=0;h<w.length;h+=3)I[h]=w[h+2],I[h+1]=w[h+1],I[h+2]=w[h];E.indices=I}d.topAndBottom=new Ct({geometry:E})}let _=r.outerRing,y=Ca.fromPoints(_,t),p=y.projectPointsOntoPlane(_,nae),C=ni.computeWindingOrder2D(p);C===$r.CLOCKWISE&&(_=_.slice().reverse());let x=Gn.computeWallGeometry(_,i,t,o,s,u);d.walls.push(new Ct({geometry:x}));let T=r.holes;for(h=0;h<T.length;h++){let E=T[h];y=Ca.fromPoints(E,t),p=y.projectPointsOntoPlane(E,nae),C=ni.computeWindingOrder2D(p),C===$r.COUNTER_CLOCKWISE&&(E=E.slice().reverse()),x=Gn.computeWallGeometry(E,i,t,o,s,u),d.walls.push(new Ct({geometry:x}))}return d}function Zf(t){let n=t.polygonHierarchy,i=A(t.vertexFormat,De.DEFAULT),o=A(t.ellipsoid,oe.WGS84),r=A(t.granularity,B.RADIANS_PER_DEGREE),s=A(t.stRotation,0),a=t.textureCoordinates,c=A(t.perPositionHeight,!1),l=c&&f(t.extrudedHeight),u=A(t.height,0),d=A(t.extrudedHeight,u);if(!l){let h=Math.max(u,d);d=Math.min(u,d),u=h}this._vertexFormat=De.clone(i),this._ellipsoid=oe.clone(o),this._granularity=r,this._stRotation=s,this._height=u,this._extrudedHeight=d,this._closeTop=A(t.closeTop,!0),this._closeBottom=A(t.closeBottom,!0),this._polygonHierarchy=n,this._perPositionHeight=c,this._perPositionHeightExtrude=l,this._shadowVolume=A(t.shadowVolume,!1),this._workerName="createPolygonGeometry",this._offsetAttribute=t.offsetAttribute,this._arcType=A(t.arcType,Zt.GEODESIC),this._rectangle=void 0,this._textureCoordinateRotationPoints=void 0,this._textureCoordinates=a,this.packedLength=Gn.computeHierarchyPackedLength(n,m)+oe.packedLength+De.packedLength+(a?Gn.computeHierarchyPackedLength(a,W):1)+12}Zf.fromPositions=function(t){t=A(t,A.EMPTY_OBJECT);let n={polygonHierarchy:{positions:t.positions},height:t.height,extrudedHeight:t.extrudedHeight,vertexFormat:t.vertexFormat,stRotation:t.stRotation,ellipsoid:t.ellipsoid,granularity:t.granularity,perPositionHeight:t.perPositionHeight,closeTop:t.closeTop,closeBottom:t.closeBottom,offsetAttribute:t.offsetAttribute,arcType:t.arcType,textureCoordinates:t.textureCoordinates};return new Zf(n)};Zf.pack=function(t,n,i){return i=A(i,0),i=Gn.packPolygonHierarchy(t._polygonHierarchy,n,i,m),oe.pack(t._ellipsoid,n,i),i+=oe.packedLength,De.pack(t._vertexFormat,n,i),i+=De.packedLength,n[i++]=t._height,n[i++]=t._extrudedHeight,n[i++]=t._granularity,n[i++]=t._stRotation,n[i++]=t._perPositionHeightExtrude?1:0,n[i++]=t._perPositionHeight?1:0,n[i++]=t._closeTop?1:0,n[i++]=t._closeBottom?1:0,n[i++]=t._shadowVolume?1:0,n[i++]=A(t._offsetAttribute,-1),n[i++]=t._arcType,f(t._textureCoordinates)?i=Gn.packPolygonHierarchy(t._textureCoordinates,n,i,W):n[i++]=-1,n[i++]=t.packedLength,n};var K9e=oe.clone(oe.UNIT_SPHERE),J9e=new De,Z9e={polygonHierarchy:{}};Zf.unpack=function(t,n,i){n=A(n,0);let o=Gn.unpackPolygonHierarchy(t,n,m);n=o.startingIndex,delete o.startingIndex;let r=oe.unpack(t,n,K9e);n+=oe.packedLength;let s=De.unpack(t,n,J9e);n+=De.packedLength;let a=t[n++],c=t[n++],l=t[n++],u=t[n++],d=t[n++]===1,h=t[n++]===1,_=t[n++]===1,y=t[n++]===1,p=t[n++]===1,C=t[n++],x=t[n++],T=t[n]===-1?void 0:Gn.unpackPolygonHierarchy(t,n,W);f(T)?(n=T.startingIndex,delete T.startingIndex):n++;let E=t[n++];return f(i)||(i=new Zf(Z9e)),i._polygonHierarchy=o,i._ellipsoid=oe.clone(r,i._ellipsoid),i._vertexFormat=De.clone(s,i._vertexFormat),i._height=a,i._extrudedHeight=c,i._granularity=l,i._stRotation=u,i._perPositionHeightExtrude=d,i._perPositionHeight=h,i._closeTop=_,i._closeBottom=y,i._shadowVolume=p,i._offsetAttribute=C===-1?void 0:C,i._arcType=x,i._textureCoordinates=T,i.packedLength=E,i};Zf.computeRectangle=function(t,n){let i=A(t.granularity,B.RADIANS_PER_DEGREE),o=A(t.arcType,Zt.GEODESIC),r=t.polygonHierarchy,s=A(t.ellipsoid,oe.WGS84);return iae(r.positions,s,o,i,n)};Zf.createGeometry=function(t){let n=t._vertexFormat,i=t._ellipsoid,o=t._granularity,r=t._stRotation,s=t._polygonHierarchy,a=t._perPositionHeight,c=t._closeTop,l=t._closeBottom,u=t._arcType,d=t._textureCoordinates,h=f(d),_=s.positions;if(_.length<3)return;let y=Ca.fromPoints(_,i),p=Gn.polygonsFromHierarchy(s,h,y.projectPointsOntoPlane.bind(y),!a,i),C=p.hierarchy,x=p.polygons,T=function(v){return v},E=h?Gn.polygonsFromHierarchy(d,!0,T,!1).polygons:void 0;if(C.length===0)return;_=C[0].outerRing;let S=Gn.computeBoundingRectangle(y.plane.normal,y.projectPointOntoPlane.bind(y),_,r,R9e),w=[],D=t._height,I=t._extrudedHeight,O=t._perPositionHeightExtrude||!B.equalsEpsilon(D,I,0,B.EPSILON2),M={perPositionHeight:a,vertexFormat:n,geometry:void 0,tangentPlane:y,boundingRectangle:S,ellipsoid:i,stRotation:r,textureCoordinates:void 0,bottom:!1,top:!0,wall:!1,extrude:!1,arcType:u},L;if(O)for(M.extrude=!0,M.top=c,M.bottom=l,M.shadowVolume=t._shadowVolume,M.offsetAttribute=t._offsetAttribute,L=0;L<x.length;L++){let v=X9e(i,x[L],h?E[L]:void 0,o,C[L],a,c,l,n,u),P;c&&l?(P=v.topAndBottom,M.geometry=Gn.scaleToGeodeticHeightExtruded(P.geometry,D,I,i,a)):c?(P=v.topAndBottom,P.geometry.attributes.position.values=ni.scaleToGeodeticHeight(P.geometry.attributes.position.values,D,i,!a),M.geometry=P.geometry):l&&(P=v.topAndBottom,P.geometry.attributes.position.values=ni.scaleToGeodeticHeight(P.geometry.attributes.position.values,I,i,!0),M.geometry=P.geometry),(c||l)&&(M.wall=!1,P.geometry=c9(M),w.push(P));let R=v.walls;M.wall=!0;for(let V=0;V<R.length;V++){let H=R[V];M.geometry=Gn.scaleToGeodeticHeightExtruded(H.geometry,D,I,i,a),H.geometry=c9(M),w.push(H)}}else for(L=0;L<x.length;L++){let v=new Ct({geometry:Gn.createGeometryFromPositions(i,x[L],h?E[L]:void 0,o,a,n,u)});if(v.geometry.attributes.position.values=ni.scaleToGeodeticHeight(v.geometry.attributes.position.values,D,i,!a),M.geometry=v.geometry,v.geometry=c9(M),f(t._offsetAttribute)){let P=v.geometry.attributes.position.values.length,R=t._offsetAttribute===en.NONE?0:1,V=new Uint8Array(P/3).fill(R);v.geometry.attributes.applyOffset=new we({componentDatatype:J.UNSIGNED_BYTE,componentsPerAttribute:1,values:V})}w.push(v)}let F=Fn.combineInstances(w)[0];F.attributes.position.values=new Float64Array(F.attributes.position.values),F.indices=Ne.createTypedArray(F.attributes.position.values.length/3,F.indices);let g=F.attributes,b=ae.fromVertices(g.position.values);return n.position||delete g.position,new at({attributes:g,indices:F.indices,primitiveType:F.primitiveType,boundingSphere:b,offsetAttribute:t._offsetAttribute})};Zf.createShadowVolume=function(t,n,i){let o=t._granularity,r=t._ellipsoid,s=n(o,r),a=i(o,r);return new Zf({polygonHierarchy:t._polygonHierarchy,ellipsoid:r,stRotation:t._stRotation,granularity:o,perPositionHeight:!1,extrudedHeight:s,height:a,vertexFormat:De.POSITION_ONLY,shadowVolume:!0,arcType:t._arcType})};function Q9e(t){let n=-t._stRotation;if(n===0)return[0,0,0,1,1,0];let i=t._ellipsoid,o=t._polygonHierarchy.positions,r=t.rectangle;return at._textureCoordinateRotationPoints(o,n,i,r)}Object.defineProperties(Zf.prototype,{rectangle:{get:function(){if(!f(this._rectangle)){let t=this._polygonHierarchy.positions;this._rectangle=iae(t,this._ellipsoid,this._arcType,this._granularity)}return this._rectangle}},textureCoordinateRotationPoints:{get:function(){return f(this._textureCoordinateRotationPoints)||(this._textureCoordinateRotationPoints=Q9e(this)),this._textureCoordinateRotationPoints}}});var IT=Zf;var oae=[],LN=[];function $9e(t,n,i,o,r){let a=Ca.fromPoints(n,t).projectPointsOntoPlane(n,oae);ni.computeWindingOrder2D(a)===$r.CLOCKWISE&&(a.reverse(),n=n.slice().reverse());let l,u,d=n.length,h=0;if(o)for(l=new Float64Array(d*2*3),u=0;u<d;u++){let p=n[u],C=n[(u+1)%d];l[h++]=p.x,l[h++]=p.y,l[h++]=p.z,l[h++]=C.x,l[h++]=C.y,l[h++]=C.z}else{let p=0;if(r===Zt.GEODESIC)for(u=0;u<d;u++)p+=Gn.subdivideLineCount(n[u],n[(u+1)%d],i);else if(r===Zt.RHUMB)for(u=0;u<d;u++)p+=Gn.subdivideRhumbLineCount(t,n[u],n[(u+1)%d],i);for(l=new Float64Array(p*3),u=0;u<d;u++){let C;r===Zt.GEODESIC?C=Gn.subdivideLine(n[u],n[(u+1)%d],i,LN):r===Zt.RHUMB&&(C=Gn.subdivideRhumbLine(t,n[u],n[(u+1)%d],i,LN));let x=C.length;for(let T=0;T<x;++T)l[h++]=C[T]}}d=l.length/3;let _=d*2,y=Ne.createTypedArray(d,_);for(h=0,u=0;u<d-1;u++)y[h++]=u,y[h++]=u+1;return y[h++]=d-1,y[h++]=0,new Ct({geometry:new at({attributes:new cn({position:new we({componentDatatype:J.DOUBLE,componentsPerAttribute:3,values:l})}),indices:y,primitiveType:Re.LINES})})}function eWe(t,n,i,o,r){let a=Ca.fromPoints(n,t).projectPointsOntoPlane(n,oae);ni.computeWindingOrder2D(a)===$r.CLOCKWISE&&(a.reverse(),n=n.slice().reverse());let l,u,d=n.length,h=new Array(d),_=0;if(o)for(l=new Float64Array(d*2*3*2),u=0;u<d;++u){h[u]=_/3;let x=n[u],T=n[(u+1)%d];l[_++]=x.x,l[_++]=x.y,l[_++]=x.z,l[_++]=T.x,l[_++]=T.y,l[_++]=T.z}else{let x=0;if(r===Zt.GEODESIC)for(u=0;u<d;u++)x+=Gn.subdivideLineCount(n[u],n[(u+1)%d],i);else if(r===Zt.RHUMB)for(u=0;u<d;u++)x+=Gn.subdivideRhumbLineCount(t,n[u],n[(u+1)%d],i);for(l=new Float64Array(x*3*2),u=0;u<d;++u){h[u]=_/3;let T;r===Zt.GEODESIC?T=Gn.subdivideLine(n[u],n[(u+1)%d],i,LN):r===Zt.RHUMB&&(T=Gn.subdivideRhumbLine(t,n[u],n[(u+1)%d],i,LN));let E=T.length;for(let S=0;S<E;++S)l[_++]=T[S]}}d=l.length/(3*2);let y=h.length,p=(d*2+y)*2,C=Ne.createTypedArray(d+y,p);for(_=0,u=0;u<d;++u)C[_++]=u,C[_++]=(u+1)%d,C[_++]=u+d,C[_++]=(u+1)%d+d;for(u=0;u<y;u++){let x=h[u];C[_++]=x,C[_++]=x+d}return new Ct({geometry:new at({attributes:new cn({position:new we({componentDatatype:J.DOUBLE,componentsPerAttribute:3,values:l})}),indices:C,primitiveType:Re.LINES})})}function ky(t){let n=t.polygonHierarchy,i=A(t.ellipsoid,oe.WGS84),o=A(t.granularity,B.RADIANS_PER_DEGREE),r=A(t.perPositionHeight,!1),s=r&&f(t.extrudedHeight),a=A(t.arcType,Zt.GEODESIC),c=A(t.height,0),l=A(t.extrudedHeight,c);if(!s){let u=Math.max(c,l);l=Math.min(c,l),c=u}this._ellipsoid=oe.clone(i),this._granularity=o,this._height=c,this._extrudedHeight=l,this._arcType=a,this._polygonHierarchy=n,this._perPositionHeight=r,this._perPositionHeightExtrude=s,this._offsetAttribute=t.offsetAttribute,this._workerName="createPolygonOutlineGeometry",this.packedLength=Gn.computeHierarchyPackedLength(n,m)+oe.packedLength+8}ky.pack=function(t,n,i){return i=A(i,0),i=Gn.packPolygonHierarchy(t._polygonHierarchy,n,i,m),oe.pack(t._ellipsoid,n,i),i+=oe.packedLength,n[i++]=t._height,n[i++]=t._extrudedHeight,n[i++]=t._granularity,n[i++]=t._perPositionHeightExtrude?1:0,n[i++]=t._perPositionHeight?1:0,n[i++]=t._arcType,n[i++]=A(t._offsetAttribute,-1),n[i]=t.packedLength,n};var tWe=oe.clone(oe.UNIT_SPHERE),nWe={polygonHierarchy:{}};ky.unpack=function(t,n,i){n=A(n,0);let o=Gn.unpackPolygonHierarchy(t,n,m);n=o.startingIndex,delete o.startingIndex;let r=oe.unpack(t,n,tWe);n+=oe.packedLength;let s=t[n++],a=t[n++],c=t[n++],l=t[n++]===1,u=t[n++]===1,d=t[n++],h=t[n++],_=t[n];return f(i)||(i=new ky(nWe)),i._polygonHierarchy=o,i._ellipsoid=oe.clone(r,i._ellipsoid),i._height=s,i._extrudedHeight=a,i._granularity=c,i._perPositionHeight=u,i._perPositionHeightExtrude=l,i._arcType=d,i._offsetAttribute=h===-1?void 0:h,i.packedLength=_,i};ky.fromPositions=function(t){t=A(t,A.EMPTY_OBJECT);let n={polygonHierarchy:{positions:t.positions},height:t.height,extrudedHeight:t.extrudedHeight,ellipsoid:t.ellipsoid,granularity:t.granularity,perPositionHeight:t.perPositionHeight,arcType:t.arcType,offsetAttribute:t.offsetAttribute};return new ky(n)};ky.createGeometry=function(t){let n=t._ellipsoid,i=t._granularity,o=t._polygonHierarchy,r=t._perPositionHeight,s=t._arcType,a=Gn.polygonOutlinesFromHierarchy(o,!r,n);if(a.length===0)return;let c,l=[],u=B.chordLength(i,n.maximumRadius),d=t._height,h=t._extrudedHeight,_=t._perPositionHeightExtrude||!B.equalsEpsilon(d,h,0,B.EPSILON2),y,p;if(_)for(p=0;p<a.length;p++){if(c=eWe(n,a[p],u,r,s),c.geometry=Gn.scaleToGeodeticHeightExtruded(c.geometry,d,h,n,r),f(t._offsetAttribute)){let T=c.geometry.attributes.position.values.length/3,E=new Uint8Array(T);t._offsetAttribute===en.TOP?E=E.fill(1,0,T/2):(y=t._offsetAttribute===en.NONE?0:1,E=E.fill(y)),c.geometry.attributes.applyOffset=new we({componentDatatype:J.UNSIGNED_BYTE,componentsPerAttribute:1,values:E})}l.push(c)}else for(p=0;p<a.length;p++){if(c=$9e(n,a[p],u,r,s),c.geometry.attributes.position.values=ni.scaleToGeodeticHeight(c.geometry.attributes.position.values,d,n,!r),f(t._offsetAttribute)){let T=c.geometry.attributes.position.values.length;y=t._offsetAttribute===en.NONE?0:1;let E=new Uint8Array(T/3).fill(y);c.geometry.attributes.applyOffset=new we({componentDatatype:J.UNSIGNED_BYTE,componentsPerAttribute:1,values:E})}l.push(c)}let C=Fn.combineInstances(l)[0],x=ae.fromVertices(C.attributes.position.values);return new at({attributes:C.attributes,indices:C.indices,primitiveType:C.primitiveType,boundingSphere:x,offsetAttribute:t._offsetAttribute})};var FN=ky;var rae="Entity polygons cannot have both height and perPositionHeight.  height will be ignored",sae="heightReference is not supported for entity polygons with perPositionHeight. heightReference will be ignored",aae=new z,cae=m.ZERO,lae=new m,uae=new le,iWe=[],oWe=new W;function rWe(t){this.id=t,this.vertexFormat=void 0,this.polygonHierarchy=void 0,this.perPositionHeight=void 0,this.closeTop=void 0,this.closeBottom=void 0,this.height=void 0,this.extrudedHeight=void 0,this.granularity=void 0,this.stRotation=void 0,this.offsetAttribute=void 0,this.arcType=void 0,this.textureCoordinates=void 0}function Ul(t,n){Wn.call(this,{entity:t,scene:n,geometryOptions:new rWe(t),geometryPropertyName:"polygon",observedPropertyNames:["availability","polygon"]}),this._onEntityPropertyChanged(t,"polygon",t.polygon,void 0)}f(Object.create)&&(Ul.prototype=Object.create(Wn.prototype),Ul.prototype.constructor=Ul);Ul.prototype.createFillGeometryInstance=function(t){let n=this._entity,i=n.isAvailable(t),o=this._options,r={show:new mn(i&&n.isShowing&&this._showProperty.getValue(t)&&this._fillProperty.getValue(t)),distanceDisplayCondition:Vn.fromDistanceDisplayCondition(this._distanceDisplayConditionProperty.getValue(t)),offset:void 0,color:void 0};if(this._materialProperty instanceof Rt){let a;f(this._materialProperty.color)&&(this._materialProperty.color.isConstant||i)&&(a=this._materialProperty.color.getValue(t,aae)),f(a)||(a=z.WHITE),r.color=Lt.fromColor(a)}f(o.offsetAttribute)&&(r.offset=Gi.fromCartesian3(q.getValueOrDefault(this._terrainOffsetProperty,t,cae,lae)));let s;return o.perPositionHeight&&!f(o.extrudedHeight)?s=new RN(o):s=new IT(o),new Ct({id:n,geometry:s,attributes:r})};Ul.prototype.createOutlineGeometryInstance=function(t){let n=this._entity,i=n.isAvailable(t),o=this._options,r=q.getValueOrDefault(this._outlineColorProperty,t,z.BLACK,aae),s=this._distanceDisplayConditionProperty.getValue(t),a={show:new mn(i&&n.isShowing&&this._showProperty.getValue(t)&&this._showOutlineProperty.getValue(t)),color:Lt.fromColor(r),distanceDisplayCondition:Vn.fromDistanceDisplayCondition(s),offset:void 0};f(o.offsetAttribute)&&(a.offset=Gi.fromCartesian3(q.getValueOrDefault(this._terrainOffsetProperty,t,cae,lae)));let c;return o.perPositionHeight&&!f(o.extrudedHeight)?c=new Gf(o):c=new FN(o),new Ct({id:n,geometry:c,attributes:a})};Ul.prototype._computeCenter=function(t,n){let i=q.getValueOrUndefined(this._entity.polygon.hierarchy,t);if(!f(i))return;let o=i.positions;if(o.length===0)return;let r=this._scene.mapProjection.ellipsoid,s=Ca.fromPoints(o,r),a=s.projectPointsOntoPlane(o,iWe),c=a.length,l=0,u=c-1,d=new W;for(let _=0;_<c;u=_++){let y=a[_],p=a[u],C=y.x*p.y-p.x*y.y,x=W.add(y,p,oWe);x=W.multiplyByScalar(x,C,x),d=W.add(d,x,d),l+=C}let h=1/(l*3);return d=W.multiplyByScalar(d,h,d),s.projectPointOntoEllipsoid(d,n)};Ul.prototype._isHidden=function(t,n){return!f(n.hierarchy)||ti.prototype._isHidden.call(this,t,n)};Ul.prototype._isOnTerrain=function(t,n){let i=Wn.prototype._isOnTerrain.call(this,t,n),o=n.perPositionHeight,r=f(o)&&(o.isConstant?o.getValue(Ue.MINIMUM_VALUE):!0);return i&&!r};Ul.prototype._isDynamic=function(t,n){return!n.hierarchy.isConstant||!q.isConstant(n.height)||!q.isConstant(n.extrudedHeight)||!q.isConstant(n.granularity)||!q.isConstant(n.stRotation)||!q.isConstant(n.textureCoordinates)||!q.isConstant(n.outlineWidth)||!q.isConstant(n.perPositionHeight)||!q.isConstant(n.closeTop)||!q.isConstant(n.closeBottom)||!q.isConstant(n.zIndex)||!q.isConstant(n.arcType)||this._onTerrain&&!q.isConstant(this._materialProperty)&&!(this._materialProperty instanceof Rt)};Ul.prototype._setStaticOptions=function(t,n){let i=this._materialProperty instanceof Rt,o=this._options;o.vertexFormat=i?tn.VERTEX_FORMAT:ro.MaterialSupport.TEXTURED.vertexFormat;let r=n.hierarchy.getValue(Ue.MINIMUM_VALUE),s=q.getValueOrUndefined(n.height,Ue.MINIMUM_VALUE),a=q.getValueOrDefault(n.heightReference,Ue.MINIMUM_VALUE,Ge.NONE),c=q.getValueOrUndefined(n.extrudedHeight,Ue.MINIMUM_VALUE),l=q.getValueOrDefault(n.extrudedHeightReference,Ue.MINIMUM_VALUE,Ge.NONE),u=q.getValueOrDefault(n.perPositionHeight,Ue.MINIMUM_VALUE,!1);s=Wn.getGeometryHeight(s,a);let d;u?(f(s)&&(s=void 0,Bt(rae)),a!==Ge.NONE&&u&&(s=void 0,Bt(sae))):(f(c)&&!f(s)&&(s=0),d=Wn.computeGeometryOffsetAttribute(s,a,c,l)),o.polygonHierarchy=r,o.granularity=q.getValueOrUndefined(n.granularity,Ue.MINIMUM_VALUE),o.stRotation=q.getValueOrUndefined(n.stRotation,Ue.MINIMUM_VALUE),o.perPositionHeight=u,o.closeTop=q.getValueOrDefault(n.closeTop,Ue.MINIMUM_VALUE,!0),o.closeBottom=q.getValueOrDefault(n.closeBottom,Ue.MINIMUM_VALUE,!0),o.offsetAttribute=d,o.height=s,o.arcType=q.getValueOrDefault(n.arcType,Ue.MINIMUM_VALUE,Zt.GEODESIC),o.textureCoordinates=q.getValueOrUndefined(n.textureCoordinates,Ue.MINIMUM_VALUE),c=Wn.getGeometryExtrudedHeight(c,l),c===Wn.CLAMP_TO_GROUND&&(c=ri.getMinimumMaximumHeights(IT.computeRectangle(o,uae)).minimumTerrainHeight),o.extrudedHeight=c};Ul.prototype._getIsClosed=function(t){let n=t.height,i=t.extrudedHeight,o=f(i)&&i!==n;return!t.perPositionHeight&&(!o&&n===0||o&&t.closeTop&&t.closeBottom)};Ul.DynamicGeometryUpdater=BT;function BT(t,n,i){ei.call(this,t,n,i)}f(Object.create)&&(BT.prototype=Object.create(ei.prototype),BT.prototype.constructor=BT);BT.prototype._isHidden=function(t,n,i){return!f(this._options.polygonHierarchy)||ei.prototype._isHidden.call(this,t,n,i)};BT.prototype._setOptions=function(t,n,i){let o=this._options;o.polygonHierarchy=q.getValueOrUndefined(n.hierarchy,i);let r=q.getValueOrUndefined(n.height,i),s=q.getValueOrDefault(n.heightReference,i,Ge.NONE),a=q.getValueOrDefault(n.extrudedHeightReference,i,Ge.NONE),c=q.getValueOrUndefined(n.extrudedHeight,i),l=q.getValueOrUndefined(n.perPositionHeight,i);r=Wn.getGeometryHeight(r,a);let u;l?(f(r)&&(r=void 0,Bt(rae)),s!==Ge.NONE&&l&&(r=void 0,Bt(sae))):(f(c)&&!f(r)&&(r=0),u=Wn.computeGeometryOffsetAttribute(r,s,c,a)),o.granularity=q.getValueOrUndefined(n.granularity,i),o.stRotation=q.getValueOrUndefined(n.stRotation,i),o.textureCoordinates=q.getValueOrUndefined(n.textureCoordinates,i),o.perPositionHeight=q.getValueOrUndefined(n.perPositionHeight,i),o.closeTop=q.getValueOrDefault(n.closeTop,i,!0),o.closeBottom=q.getValueOrDefault(n.closeBottom,i,!0),o.offsetAttribute=u,o.height=r,o.arcType=q.getValueOrDefault(n.arcType,i,Zt.GEODESIC),c=Wn.getGeometryExtrudedHeight(c,a),c===Wn.CLAMP_TO_GROUND&&(c=ri.getMinimumMaximumHeights(IT.computeRectangle(o,uae)).minimumTerrainHeight),o.extrudedHeight=c};var NN=Ul;function sWe(t,n,i,o){let r=new cn;o.position&&(r.position=new we({componentDatatype:J.DOUBLE,componentsPerAttribute:3,values:t}));let s=n.length,a=t.length/3,c=(a-s*2)/(s*2),l=ni.triangulate(n),u=(c-1)*s*6+l.length*2,d=Ne.createTypedArray(a,u),h,_,y,p,C,x,T=s*2,E=0;for(h=0;h<c-1;h++){for(_=0;_<s-1;_++)y=_*2+h*s*2,x=y+T,p=y+1,C=p+T,d[E++]=p,d[E++]=y,d[E++]=C,d[E++]=C,d[E++]=y,d[E++]=x;y=s*2-2+h*s*2,p=y+1,C=p+T,x=y+T,d[E++]=p,d[E++]=y,d[E++]=C,d[E++]=C,d[E++]=y,d[E++]=x}if(o.st||o.tangent||o.bitangent){let D=new Float32Array(a*2),I=1/(c-1),O=1/i.height,M=i.height/2,L,F,g=0;for(h=0;h<c;h++){for(L=h*I,F=O*(n[0].y+M),D[g++]=L,D[g++]=F,_=1;_<s;_++)F=O*(n[_].y+M),D[g++]=L,D[g++]=F,D[g++]=L,D[g++]=F;F=O*(n[0].y+M),D[g++]=L,D[g++]=F}for(_=0;_<s;_++)L=0,F=O*(n[_].y+M),D[g++]=L,D[g++]=F;for(_=0;_<s;_++)L=(c-1)*I,F=O*(n[_].y+M),D[g++]=L,D[g++]=F;r.st=new we({componentDatatype:J.FLOAT,componentsPerAttribute:2,values:new Float32Array(D)})}let S=a-s*2;for(h=0;h<l.length;h+=3){let D=l[h]+S,I=l[h+1]+S,O=l[h+2]+S;d[E++]=D,d[E++]=I,d[E++]=O,d[E++]=O+s,d[E++]=I+s,d[E++]=D+s}let w=new at({attributes:r,indices:d,boundingSphere:ae.fromVertices(t),primitiveType:Re.TRIANGLES});if(o.normal&&(w=Fn.computeNormal(w)),o.tangent||o.bitangent){try{w=Fn.computeTangentAndBitangent(w)}catch(D){Bt("polyline-volume-tangent-bitangent","Unable to compute tangents and bitangents for polyline volume geometry")}o.tangent||(w.attributes.tangent=void 0),o.bitangent||(w.attributes.bitangent=void 0),o.st||(w.attributes.st=void 0)}return w}function tD(t){t=A(t,A.EMPTY_OBJECT);let n=t.polylinePositions,i=t.shapePositions;this._positions=n,this._shape=i,this._ellipsoid=oe.clone(A(t.ellipsoid,oe.WGS84)),this._cornerType=A(t.cornerType,wi.ROUNDED),this._vertexFormat=De.clone(A(t.vertexFormat,De.DEFAULT)),this._granularity=A(t.granularity,B.RADIANS_PER_DEGREE),this._workerName="createPolylineVolumeGeometry";let o=1+n.length*m.packedLength;o+=1+i.length*W.packedLength,this.packedLength=o+oe.packedLength+De.packedLength+2}tD.pack=function(t,n,i){i=A(i,0);let o,r=t._positions,s=r.length;for(n[i++]=s,o=0;o<s;++o,i+=m.packedLength)m.pack(r[o],n,i);let a=t._shape;for(s=a.length,n[i++]=s,o=0;o<s;++o,i+=W.packedLength)W.pack(a[o],n,i);return oe.pack(t._ellipsoid,n,i),i+=oe.packedLength,De.pack(t._vertexFormat,n,i),i+=De.packedLength,n[i++]=t._cornerType,n[i]=t._granularity,n};var fae=oe.clone(oe.UNIT_SPHERE),dae=new De,eD={polylinePositions:void 0,shapePositions:void 0,ellipsoid:fae,vertexFormat:dae,cornerType:void 0,granularity:void 0};tD.unpack=function(t,n,i){n=A(n,0);let o,r=t[n++],s=new Array(r);for(o=0;o<r;++o,n+=m.packedLength)s[o]=m.unpack(t,n);r=t[n++];let a=new Array(r);for(o=0;o<r;++o,n+=W.packedLength)a[o]=W.unpack(t,n);let c=oe.unpack(t,n,fae);n+=oe.packedLength;let l=De.unpack(t,n,dae);n+=De.packedLength;let u=t[n++],d=t[n];return f(i)?(i._positions=s,i._shape=a,i._ellipsoid=oe.clone(c,i._ellipsoid),i._vertexFormat=De.clone(l,i._vertexFormat),i._cornerType=u,i._granularity=d,i):(eD.polylinePositions=s,eD.shapePositions=a,eD.cornerType=u,eD.granularity=d,new tD(eD))};var aWe=new He;tD.createGeometry=function(t){let n=t._positions,i=Co(n,m.equalsEpsilon),o=t._shape;if(o=mh.removeDuplicatesFromShape(o),i.length<2||o.length<3)return;ni.computeWindingOrder2D(o)===$r.CLOCKWISE&&o.reverse();let r=He.fromPoints(o,aWe),s=mh.computePositions(i,o,r,t,!0);return sWe(s,o,r,t._vertexFormat)};var VN=tD;function cWe(t,n){let i=new cn;i.position=new we({componentDatatype:J.DOUBLE,componentsPerAttribute:3,values:t});let o=n.length,r=i.position.values.length/3,a=t.length/3/o,c=Ne.createTypedArray(r,2*o*(a+1)),l,u,d=0;l=0;let h=l*o;for(u=0;u<o-1;u++)c[d++]=u+h,c[d++]=u+h+1;for(c[d++]=o-1+h,c[d++]=h,l=a-1,h=l*o,u=0;u<o-1;u++)c[d++]=u+h,c[d++]=u+h+1;for(c[d++]=o-1+h,c[d++]=h,l=0;l<a-1;l++){let y=o*l,p=y+o;for(u=0;u<o;u++)c[d++]=u+y,c[d++]=u+p}return new at({attributes:i,indices:Ne.createTypedArray(r,c),boundingSphere:ae.fromVertices(t),primitiveType:Re.LINES})}function iD(t){t=A(t,A.EMPTY_OBJECT);let n=t.polylinePositions,i=t.shapePositions;this._positions=n,this._shape=i,this._ellipsoid=oe.clone(A(t.ellipsoid,oe.WGS84)),this._cornerType=A(t.cornerType,wi.ROUNDED),this._granularity=A(t.granularity,B.RADIANS_PER_DEGREE),this._workerName="createPolylineVolumeOutlineGeometry";let o=1+n.length*m.packedLength;o+=1+i.length*W.packedLength,this.packedLength=o+oe.packedLength+2}iD.pack=function(t,n,i){i=A(i,0);let o,r=t._positions,s=r.length;for(n[i++]=s,o=0;o<s;++o,i+=m.packedLength)m.pack(r[o],n,i);let a=t._shape;for(s=a.length,n[i++]=s,o=0;o<s;++o,i+=W.packedLength)W.pack(a[o],n,i);return oe.pack(t._ellipsoid,n,i),i+=oe.packedLength,n[i++]=t._cornerType,n[i]=t._granularity,n};var hae=oe.clone(oe.UNIT_SPHERE),nD={polylinePositions:void 0,shapePositions:void 0,ellipsoid:hae,height:void 0,cornerType:void 0,granularity:void 0};iD.unpack=function(t,n,i){n=A(n,0);let o,r=t[n++],s=new Array(r);for(o=0;o<r;++o,n+=m.packedLength)s[o]=m.unpack(t,n);r=t[n++];let a=new Array(r);for(o=0;o<r;++o,n+=W.packedLength)a[o]=W.unpack(t,n);let c=oe.unpack(t,n,hae);n+=oe.packedLength;let l=t[n++],u=t[n];return f(i)?(i._positions=s,i._shape=a,i._ellipsoid=oe.clone(c,i._ellipsoid),i._cornerType=l,i._granularity=u,i):(nD.polylinePositions=s,nD.shapePositions=a,nD.cornerType=l,nD.granularity=u,new iD(nD))};var lWe=new He;iD.createGeometry=function(t){let n=t._positions,i=Co(n,m.equalsEpsilon),o=t._shape;if(o=mh.removeDuplicatesFromShape(o),i.length<2||o.length<3)return;ni.computeWindingOrder2D(o)===$r.CLOCKWISE&&o.reverse();let r=He.fromPoints(o,lWe),s=mh.computePositions(i,o,r,t,!1);return cWe(s,o)};var kN=iD;var mae=new z;function uWe(t){this.id=t,this.vertexFormat=void 0,this.polylinePositions=void 0,this.shapePositions=void 0,this.cornerType=void 0,this.granularity=void 0}function Eh(t,n){ti.call(this,{entity:t,scene:n,geometryOptions:new uWe(t),geometryPropertyName:"polylineVolume",observedPropertyNames:["availability","polylineVolume"]}),this._onEntityPropertyChanged(t,"polylineVolume",t.polylineVolume,void 0)}f(Object.create)&&(Eh.prototype=Object.create(ti.prototype),Eh.prototype.constructor=Eh);Eh.prototype.createFillGeometryInstance=function(t){let n=this._entity,i=n.isAvailable(t),o,r,s=new mn(i&&n.isShowing&&this._showProperty.getValue(t)&&this._fillProperty.getValue(t)),a=this._distanceDisplayConditionProperty.getValue(t),c=Vn.fromDistanceDisplayCondition(a);if(this._materialProperty instanceof Rt){let l;f(this._materialProperty.color)&&(this._materialProperty.color.isConstant||i)&&(l=this._materialProperty.color.getValue(t,mae)),f(l)||(l=z.WHITE),r=Lt.fromColor(l),o={show:s,distanceDisplayCondition:c,color:r}}else o={show:s,distanceDisplayCondition:c};return new Ct({id:n,geometry:new VN(this._options),attributes:o})};Eh.prototype.createOutlineGeometryInstance=function(t){let n=this._entity,i=n.isAvailable(t),o=q.getValueOrDefault(this._outlineColorProperty,t,z.BLACK,mae),r=this._distanceDisplayConditionProperty.getValue(t);return new Ct({id:n,geometry:new kN(this._options),attributes:{show:new mn(i&&n.isShowing&&this._showProperty.getValue(t)&&this._showOutlineProperty.getValue(t)),color:Lt.fromColor(o),distanceDisplayCondition:Vn.fromDistanceDisplayCondition(r)}})};Eh.prototype._isHidden=function(t,n){return!f(n.positions)||!f(n.shape)||ti.prototype._isHidden.call(this,t,n)};Eh.prototype._isDynamic=function(t,n){return!n.positions.isConstant||!n.shape.isConstant||!q.isConstant(n.granularity)||!q.isConstant(n.outlineWidth)||!q.isConstant(n.cornerType)};Eh.prototype._setStaticOptions=function(t,n){let i=n.granularity,o=n.cornerType,r=this._options,s=this._materialProperty instanceof Rt;r.vertexFormat=s?tn.VERTEX_FORMAT:ro.MaterialSupport.TEXTURED.vertexFormat,r.polylinePositions=n.positions.getValue(Ue.MINIMUM_VALUE,r.polylinePositions),r.shapePositions=n.shape.getValue(Ue.MINIMUM_VALUE,r.shape),r.granularity=f(i)?i.getValue(Ue.MINIMUM_VALUE):void 0,r.cornerType=f(o)?o.getValue(Ue.MINIMUM_VALUE):void 0};Eh.DynamicGeometryUpdater=OT;function OT(t,n,i){ei.call(this,t,n,i)}f(Object.create)&&(OT.prototype=Object.create(ei.prototype),OT.prototype.constructor=OT);OT.prototype._isHidden=function(t,n,i){let o=this._options;return!f(o.polylinePositions)||!f(o.shapePositions)||ei.prototype._isHidden.call(this,t,n,i)};OT.prototype._setOptions=function(t,n,i){let o=this._options;o.polylinePositions=q.getValueOrUndefined(n.positions,i,o.polylinePositions),o.shapePositions=q.getValueOrUndefined(n.shape,i),o.granularity=q.getValueOrUndefined(n.granularity,i),o.cornerType=q.getValueOrUndefined(n.cornerType,i)};var UN=Eh;var l9=new m,gae=new m,yae=new m,Aae=new m,Cae=new le,fWe=new W,dWe=new ae,hWe=new ae;function xae(t,n){let i=new at({attributes:new cn,primitiveType:Re.TRIANGLES});return i.attributes.position=new we({componentDatatype:J.DOUBLE,componentsPerAttribute:3,values:n.positions}),t.normal&&(i.attributes.normal=new we({componentDatatype:J.FLOAT,componentsPerAttribute:3,values:n.normals})),t.tangent&&(i.attributes.tangent=new we({componentDatatype:J.FLOAT,componentsPerAttribute:3,values:n.tangents})),t.bitangent&&(i.attributes.bitangent=new we({componentDatatype:J.FLOAT,componentsPerAttribute:3,values:n.bitangents})),i}function mWe(t,n,i,o){let r=t.length,s=n.normal?new Float32Array(r):void 0,a=n.tangent?new Float32Array(r):void 0,c=n.bitangent?new Float32Array(r):void 0,l=0,u=Aae,d=yae,h=gae;if(n.normal||n.tangent||n.bitangent)for(let _=0;_<r;_+=3){let y=m.fromArray(t,_,l9),p=l+1,C=l+2;h=i.geodeticSurfaceNormal(y,h),(n.tangent||n.bitangent)&&(m.cross(m.UNIT_Z,h,d),$.multiplyByVector(o,d,d),m.normalize(d,d),n.bitangent&&m.normalize(m.cross(h,d,u),u)),n.normal&&(s[l]=h.x,s[p]=h.y,s[C]=h.z),n.tangent&&(a[l]=d.x,a[p]=d.y,a[C]=d.z),n.bitangent&&(c[l]=u.x,c[p]=u.y,c[C]=u.z),l+=3}return xae(n,{positions:t,normals:s,tangents:a,bitangents:c})}var u9=new m,Tae=new m;function pWe(t,n,i){let o=t.length,r=n.normal?new Float32Array(o):void 0,s=n.tangent?new Float32Array(o):void 0,a=n.bitangent?new Float32Array(o):void 0,c=0,l=0,u=0,d=!0,h=Aae,_=yae,y=gae;if(n.normal||n.tangent||n.bitangent)for(let p=0;p<o;p+=6){let C=m.fromArray(t,p,l9),x=m.fromArray(t,(p+6)%o,u9);if(d){let T=m.fromArray(t,(p+3)%o,Tae);m.subtract(x,C,x),m.subtract(T,C,T),y=m.normalize(m.cross(T,x,y),y),d=!1}m.equalsEpsilon(x,C,B.EPSILON10)&&(d=!0),(n.tangent||n.bitangent)&&(h=i.geodeticSurfaceNormal(C,h),n.tangent&&(_=m.normalize(m.cross(h,y,_),_))),n.normal&&(r[c++]=y.x,r[c++]=y.y,r[c++]=y.z,r[c++]=y.x,r[c++]=y.y,r[c++]=y.z),n.tangent&&(s[l++]=_.x,s[l++]=_.y,s[l++]=_.z,s[l++]=_.x,s[l++]=_.y,s[l++]=_.z),n.bitangent&&(a[u++]=h.x,a[u++]=h.y,a[u++]=h.z,a[u++]=h.x,a[u++]=h.y,a[u++]=h.z)}return xae(n,{positions:t,normals:r,tangents:s,bitangents:a})}function Eae(t,n){let i=t._vertexFormat,o=t._ellipsoid,r=n.height,s=n.width,a=n.northCap,c=n.southCap,l=0,u=r,d=r,h=0;a&&(l=1,d-=1,h+=1),c&&(u-=1,d-=1,h+=1),h+=s*d;let _=i.position?new Float64Array(h*3):void 0,y=i.st?new Float32Array(h*2):void 0,p=0,C=0,x=l9,T=fWe,E=Number.MAX_VALUE,S=Number.MAX_VALUE,w=-Number.MAX_VALUE,D=-Number.MAX_VALUE;for(let b=l;b<u;++b)for(let v=0;v<s;++v)_s.computePosition(n,o,i.st,b,v,x,T),_[p++]=x.x,_[p++]=x.y,_[p++]=x.z,i.st&&(y[C++]=T.x,y[C++]=T.y,E=Math.min(E,T.x),S=Math.min(S,T.y),w=Math.max(w,T.x),D=Math.max(D,T.y));if(a&&(_s.computePosition(n,o,i.st,0,0,x,T),_[p++]=x.x,_[p++]=x.y,_[p++]=x.z,i.st&&(y[C++]=T.x,y[C++]=T.y,E=T.x,S=T.y,w=T.x,D=T.y)),c&&(_s.computePosition(n,o,i.st,r-1,0,x,T),_[p++]=x.x,_[p++]=x.y,_[p]=x.z,i.st&&(y[C++]=T.x,y[C]=T.y,E=Math.min(E,T.x),S=Math.min(S,T.y),w=Math.max(w,T.x),D=Math.max(D,T.y))),i.st&&(E<0||S<0||w>1||D>1))for(let b=0;b<y.length;b+=2)y[b]=(y[b]-E)/(w-E),y[b+1]=(y[b+1]-S)/(D-S);let I=mWe(_,i,o,n.tangentRotationMatrix),O=6*(s-1)*(d-1);a&&(O+=3*(s-1)),c&&(O+=3*(s-1));let M=Ne.createTypedArray(h,O),L=0,F=0,g;for(g=0;g<d-1;++g){for(let b=0;b<s-1;++b){let v=L,P=v+s,R=P+1,V=v+1;M[F++]=v,M[F++]=P,M[F++]=V,M[F++]=V,M[F++]=P,M[F++]=R,++L}++L}if(a||c){let b=h-1,v=h-1;a&&c&&(b=h-2);let P,R;if(L=0,a)for(g=0;g<s-1;g++)P=L,R=P+1,M[F++]=b,M[F++]=P,M[F++]=R,++L;if(c)for(L=(d-1)*s,g=0;g<s-1;g++)P=L,R=P+1,M[F++]=P,M[F++]=v,M[F++]=R,++L}return I.indices=M,i.st&&(I.attributes.st=new we({componentDatatype:J.FLOAT,componentsPerAttribute:2,values:y})),I}function RT(t,n,i,o,r){return t[n++]=o[i],t[n++]=o[i+1],t[n++]=o[i+2],t[n++]=r[i],t[n++]=r[i+1],t[n]=r[i+2],t}function MT(t,n,i,o){return t[n++]=o[i],t[n++]=o[i+1],t[n++]=o[i],t[n]=o[i+1],t}var f9=new De;function _We(t,n){let i=t._shadowVolume,o=t._offsetAttribute,r=t._vertexFormat,s=t._extrudedHeight,a=t._surfaceHeight,c=t._ellipsoid,l=n.height,u=n.width,d;if(i){let _t=De.clone(r,f9);_t.normal=!0,t._vertexFormat=_t}let h=Eae(t,n);i&&(t._vertexFormat=r);let _=ni.scaleToGeodeticHeight(h.attributes.position.values,a,c,!1);_=new Float64Array(_);let y=_.length,p=y*2,C=new Float64Array(p);C.set(_);let x=ni.scaleToGeodeticHeight(h.attributes.position.values,s,c);C.set(x,y),h.attributes.position.values=C;let T=r.normal?new Float32Array(p):void 0,E=r.tangent?new Float32Array(p):void 0,S=r.bitangent?new Float32Array(p):void 0,w=r.st?new Float32Array(p/3*2):void 0,D,I;if(r.normal){for(I=h.attributes.normal.values,T.set(I),d=0;d<y;d++)I[d]=-I[d];T.set(I,y),h.attributes.normal.values=T}if(i){I=h.attributes.normal.values,r.normal||(h.attributes.normal=void 0);let _t=new Float32Array(p);for(d=0;d<y;d++)I[d]=-I[d];_t.set(I,y),h.attributes.extrudeDirection=new we({componentDatatype:J.FLOAT,componentsPerAttribute:3,values:_t})}let O,M=f(o);if(M){let _t=y/3*2,Rn=new Uint8Array(_t);o===en.TOP?Rn=Rn.fill(1,0,_t/2):(O=o===en.NONE?0:1,Rn=Rn.fill(O)),h.attributes.applyOffset=new we({componentDatatype:J.UNSIGNED_BYTE,componentsPerAttribute:1,values:Rn})}if(r.tangent){let _t=h.attributes.tangent.values;for(E.set(_t),d=0;d<y;d++)_t[d]=-_t[d];E.set(_t,y),h.attributes.tangent.values=E}if(r.bitangent){let _t=h.attributes.bitangent.values;S.set(_t),S.set(_t,y),h.attributes.bitangent.values=S}r.st&&(D=h.attributes.st.values,w.set(D),w.set(D,y/3*2),h.attributes.st.values=w);let L=h.indices,F=L.length,g=y/3,b=Ne.createTypedArray(p/3,F*2);for(b.set(L),d=0;d<F;d+=3)b[d+F]=L[d+2]+g,b[d+1+F]=L[d+1]+g,b[d+2+F]=L[d]+g;h.indices=b;let v=n.northCap,P=n.southCap,R=l,V=2,H=0,U=4,G=4;v&&(V-=1,R-=1,H+=1,U-=2,G-=1),P&&(V-=1,R-=1,H+=1,U-=2,G-=1),H+=V*u+2*R-U;let k=(H+G)*2,X=new Float64Array(k*3),Y=i?new Float32Array(k*3):void 0,K=M?new Uint8Array(k):void 0,j=r.st?new Float32Array(k*2):void 0,Z=o===en.TOP;M&&!Z&&(O=o===en.ALL?1:0,K=K.fill(O));let Q=0,me=0,_e=0,re=0,fe=u*R,ge;for(d=0;d<fe;d+=u)ge=d*3,X=RT(X,Q,ge,_,x),Q+=6,r.st&&(j=MT(j,me,d*2,D),me+=4),i&&(_e+=3,Y[_e++]=I[ge],Y[_e++]=I[ge+1],Y[_e++]=I[ge+2]),Z&&(K[re++]=1,re+=1);if(P){let _t=v?fe+1:fe;for(ge=_t*3,d=0;d<2;d++)X=RT(X,Q,ge,_,x),Q+=6,r.st&&(j=MT(j,me,_t*2,D),me+=4),i&&(_e+=3,Y[_e++]=I[ge],Y[_e++]=I[ge+1],Y[_e++]=I[ge+2]),Z&&(K[re++]=1,re+=1)}else for(d=fe-u;d<fe;d++)ge=d*3,X=RT(X,Q,ge,_,x),Q+=6,r.st&&(j=MT(j,me,d*2,D),me+=4),i&&(_e+=3,Y[_e++]=I[ge],Y[_e++]=I[ge+1],Y[_e++]=I[ge+2]),Z&&(K[re++]=1,re+=1);for(d=fe-1;d>0;d-=u)ge=d*3,X=RT(X,Q,ge,_,x),Q+=6,r.st&&(j=MT(j,me,d*2,D),me+=4),i&&(_e+=3,Y[_e++]=I[ge],Y[_e++]=I[ge+1],Y[_e++]=I[ge+2]),Z&&(K[re++]=1,re+=1);if(v){let _t=fe;for(ge=_t*3,d=0;d<2;d++)X=RT(X,Q,ge,_,x),Q+=6,r.st&&(j=MT(j,me,_t*2,D),me+=4),i&&(_e+=3,Y[_e++]=I[ge],Y[_e++]=I[ge+1],Y[_e++]=I[ge+2]),Z&&(K[re++]=1,re+=1)}else for(d=u-1;d>=0;d--)ge=d*3,X=RT(X,Q,ge,_,x),Q+=6,r.st&&(j=MT(j,me,d*2,D),me+=4),i&&(_e+=3,Y[_e++]=I[ge],Y[_e++]=I[ge+1],Y[_e++]=I[ge+2]),Z&&(K[re++]=1,re+=1);let be=pWe(X,r,c);r.st&&(be.attributes.st=new we({componentDatatype:J.FLOAT,componentsPerAttribute:2,values:j})),i&&(be.attributes.extrudeDirection=new we({componentDatatype:J.FLOAT,componentsPerAttribute:3,values:Y})),M&&(be.attributes.applyOffset=new we({componentDatatype:J.UNSIGNED_BYTE,componentsPerAttribute:1,values:K}));let Be=Ne.createTypedArray(k,H*6),ke,qe,Nt,Wt;y=X.length/3;let un=0;for(d=0;d<y-1;d+=2){ke=d,Wt=(ke+2)%y;let _t=m.fromArray(X,ke*3,u9),Rn=m.fromArray(X,Wt*3,Tae);m.equalsEpsilon(_t,Rn,B.EPSILON10)||(qe=(ke+1)%y,Nt=(qe+2)%y,Be[un++]=ke,Be[un++]=qe,Be[un++]=Wt,Be[un++]=Wt,Be[un++]=qe,Be[un++]=Nt)}return be.indices=Be,be=Fn.combineInstances([new Ct({geometry:h}),new Ct({geometry:be})]),be[0]}var gWe=[new m,new m,new m,new m],bae=new de,yWe=new de;function d9(t,n,i,o,r){if(i===0)return le.clone(t,r);let s=_s.computeOptions(t,n,i,0,Cae,bae),a=s.height,c=s.width,l=gWe;return _s.computePosition(s,o,!1,0,0,l[0]),_s.computePosition(s,o,!1,0,c-1,l[1]),_s.computePosition(s,o,!1,a-1,0,l[2]),_s.computePosition(s,o,!1,a-1,c-1,l[3]),le.fromCartesianArray(l,o,r)}function bh(t){t=A(t,A.EMPTY_OBJECT);let n=t.rectangle,i=A(t.height,0),o=A(t.extrudedHeight,i);this._rectangle=le.clone(n),this._granularity=A(t.granularity,B.RADIANS_PER_DEGREE),this._ellipsoid=oe.clone(A(t.ellipsoid,oe.WGS84)),this._surfaceHeight=Math.max(i,o),this._rotation=A(t.rotation,0),this._stRotation=A(t.stRotation,0),this._vertexFormat=De.clone(A(t.vertexFormat,De.DEFAULT)),this._extrudedHeight=Math.min(i,o),this._shadowVolume=A(t.shadowVolume,!1),this._workerName="createRectangleGeometry",this._offsetAttribute=t.offsetAttribute,this._rotatedRectangle=void 0,this._textureCoordinateRotationPoints=void 0}bh.packedLength=le.packedLength+oe.packedLength+De.packedLength+7;bh.pack=function(t,n,i){return i=A(i,0),le.pack(t._rectangle,n,i),i+=le.packedLength,oe.pack(t._ellipsoid,n,i),i+=oe.packedLength,De.pack(t._vertexFormat,n,i),i+=De.packedLength,n[i++]=t._granularity,n[i++]=t._surfaceHeight,n[i++]=t._rotation,n[i++]=t._stRotation,n[i++]=t._extrudedHeight,n[i++]=t._shadowVolume?1:0,n[i]=A(t._offsetAttribute,-1),n};var Sae=new le,wae=oe.clone(oe.UNIT_SPHERE),ug={rectangle:Sae,ellipsoid:wae,vertexFormat:f9,granularity:void 0,height:void 0,rotation:void 0,stRotation:void 0,extrudedHeight:void 0,shadowVolume:void 0,offsetAttribute:void 0};bh.unpack=function(t,n,i){n=A(n,0);let o=le.unpack(t,n,Sae);n+=le.packedLength;let r=oe.unpack(t,n,wae);n+=oe.packedLength;let s=De.unpack(t,n,f9);n+=De.packedLength;let a=t[n++],c=t[n++],l=t[n++],u=t[n++],d=t[n++],h=t[n++]===1,_=t[n];return f(i)?(i._rectangle=le.clone(o,i._rectangle),i._ellipsoid=oe.clone(r,i._ellipsoid),i._vertexFormat=De.clone(s,i._vertexFormat),i._granularity=a,i._surfaceHeight=c,i._rotation=l,i._stRotation=u,i._extrudedHeight=d,i._shadowVolume=h,i._offsetAttribute=_===-1?void 0:_,i):(ug.granularity=a,ug.height=c,ug.rotation=l,ug.stRotation=u,ug.extrudedHeight=d,ug.shadowVolume=h,ug.offsetAttribute=_===-1?void 0:_,new bh(ug))};bh.computeRectangle=function(t,n){t=A(t,A.EMPTY_OBJECT);let i=t.rectangle,o=A(t.granularity,B.RADIANS_PER_DEGREE),r=A(t.ellipsoid,oe.WGS84),s=A(t.rotation,0);return d9(i,o,s,r,n)};var AWe=new $,pae=new Me,CWe=new de;bh.createGeometry=function(t){if(B.equalsEpsilon(t._rectangle.north,t._rectangle.south,B.EPSILON10)||B.equalsEpsilon(t._rectangle.east,t._rectangle.west,B.EPSILON10))return;let n=t._rectangle,i=t._ellipsoid,o=t._rotation,r=t._stRotation,s=t._vertexFormat,a=_s.computeOptions(n,t._granularity,o,r,Cae,bae,yWe),c=AWe;if(r!==0||o!==0){let y=le.center(n,CWe),p=i.geodeticSurfaceNormalCartographic(y,u9);Me.fromAxisAngle(p,-r,pae),$.fromQuaternion(pae,c)}else $.clone($.IDENTITY,c);let l=t._surfaceHeight,u=t._extrudedHeight,d=!B.equalsEpsilon(l,u,0,B.EPSILON2);a.lonScalar=1/t._rectangle.width,a.latScalar=1/t._rectangle.height,a.tangentRotationMatrix=c;let h,_;if(n=t._rectangle,d){h=_We(t,a);let y=ae.fromRectangle3D(n,i,l,hWe),p=ae.fromRectangle3D(n,i,u,dWe);_=ae.union(y,p)}else{if(h=Eae(t,a),h.attributes.position.values=ni.scaleToGeodeticHeight(h.attributes.position.values,l,i,!1),f(t._offsetAttribute)){let y=h.attributes.position.values.length,p=t._offsetAttribute===en.NONE?0:1,C=new Uint8Array(y/3).fill(p);h.attributes.applyOffset=new we({componentDatatype:J.UNSIGNED_BYTE,componentsPerAttribute:1,values:C})}_=ae.fromRectangle3D(n,i,l)}return s.position||delete h.attributes.position,new at({attributes:h.attributes,indices:h.indices,primitiveType:h.primitiveType,boundingSphere:_,offsetAttribute:t._offsetAttribute})};bh.createShadowVolume=function(t,n,i){let o=t._granularity,r=t._ellipsoid,s=n(o,r),a=i(o,r);return new bh({rectangle:t._rectangle,rotation:t._rotation,ellipsoid:r,stRotation:t._stRotation,granularity:o,extrudedHeight:a,height:s,vertexFormat:De.POSITION_ONLY,shadowVolume:!0})};var _ae=new le,xWe=[new W,new W,new W],TWe=new Ji,EWe=new de;function bWe(t){if(t._stRotation===0)return[0,0,0,1,1,0];let n=le.clone(t._rectangle,_ae),i=t._granularity,o=t._ellipsoid,r=t._rotation-t._stRotation,s=d9(n,i,r,o,_ae),a=xWe;a[0].x=s.west,a[0].y=s.south,a[1].x=s.west,a[1].y=s.north,a[2].x=s.east,a[2].y=s.south;let c=t.rectangle,l=Ji.fromRotation(t._stRotation,TWe),u=le.center(c,EWe);for(let p=0;p<3;++p){let C=a[p];C.x-=u.longitude,C.y-=u.latitude,Ji.multiplyByVector(l,C,C),C.x+=u.longitude,C.y+=u.latitude,C.x=(C.x-c.west)/c.width,C.y=(C.y-c.south)/c.height}let d=a[0],h=a[1],_=a[2],y=new Array(6);return W.pack(d,y),W.pack(h,y,2),W.pack(_,y,4),y}Object.defineProperties(bh.prototype,{rectangle:{get:function(){return f(this._rotatedRectangle)||(this._rotatedRectangle=d9(this._rectangle,this._granularity,this._rotation,this._ellipsoid)),this._rotatedRectangle}},textureCoordinateRotationPoints:{get:function(){return f(this._textureCoordinateRotationPoints)||(this._textureCoordinateRotationPoints=bWe(this)),this._textureCoordinateRotationPoints}}});var LT=bh;var Dae=new z,vae=m.ZERO,Pae=new m,Iae=new le,SWe=new le,wWe=new de;function DWe(t){this.id=t,this.vertexFormat=void 0,this.rectangle=void 0,this.height=void 0,this.extrudedHeight=void 0,this.granularity=void 0,this.stRotation=void 0,this.rotation=void 0,this.offsetAttribute=void 0}function Qf(t,n){Wn.call(this,{entity:t,scene:n,geometryOptions:new DWe(t),geometryPropertyName:"rectangle",observedPropertyNames:["availability","rectangle"]}),this._onEntityPropertyChanged(t,"rectangle",t.rectangle,void 0)}f(Object.create)&&(Qf.prototype=Object.create(Wn.prototype),Qf.prototype.constructor=Qf);Qf.prototype.createFillGeometryInstance=function(t){let n=this._entity,i=n.isAvailable(t),o={show:new mn(i&&n.isShowing&&this._showProperty.getValue(t)&&this._fillProperty.getValue(t)),distanceDisplayCondition:Vn.fromDistanceDisplayCondition(this._distanceDisplayConditionProperty.getValue(t)),offset:void 0,color:void 0};if(this._materialProperty instanceof Rt){let r;f(this._materialProperty.color)&&(this._materialProperty.color.isConstant||i)&&(r=this._materialProperty.color.getValue(t,Dae)),f(r)||(r=z.WHITE),o.color=Lt.fromColor(r)}return f(this._options.offsetAttribute)&&(o.offset=Gi.fromCartesian3(q.getValueOrDefault(this._terrainOffsetProperty,t,vae,Pae))),new Ct({id:n,geometry:new LT(this._options),attributes:o})};Qf.prototype.createOutlineGeometryInstance=function(t){let n=this._entity,i=n.isAvailable(t),o=q.getValueOrDefault(this._outlineColorProperty,t,z.BLACK,Dae),r=this._distanceDisplayConditionProperty.getValue(t),s={show:new mn(i&&n.isShowing&&this._showProperty.getValue(t)&&this._showOutlineProperty.getValue(t)),color:Lt.fromColor(o),distanceDisplayCondition:Vn.fromDistanceDisplayCondition(r),offset:void 0};return f(this._options.offsetAttribute)&&(s.offset=Gi.fromCartesian3(q.getValueOrDefault(this._terrainOffsetProperty,t,vae,Pae))),new Ct({id:n,geometry:new Wx(this._options),attributes:s})};Qf.prototype._computeCenter=function(t,n){let i=q.getValueOrUndefined(this._entity.rectangle.coordinates,t,SWe);if(!f(i))return;let o=le.center(i,wWe);return de.toCartesian(o,oe.WGS84,n)};Qf.prototype._isHidden=function(t,n){return!f(n.coordinates)||ti.prototype._isHidden.call(this,t,n)};Qf.prototype._isDynamic=function(t,n){return!n.coordinates.isConstant||!q.isConstant(n.height)||!q.isConstant(n.extrudedHeight)||!q.isConstant(n.granularity)||!q.isConstant(n.stRotation)||!q.isConstant(n.rotation)||!q.isConstant(n.outlineWidth)||!q.isConstant(n.zIndex)||this._onTerrain&&!q.isConstant(this._materialProperty)&&!(this._materialProperty instanceof Rt)};Qf.prototype._setStaticOptions=function(t,n){let i=this._materialProperty instanceof Rt,o=q.getValueOrUndefined(n.height,Ue.MINIMUM_VALUE),r=q.getValueOrDefault(n.heightReference,Ue.MINIMUM_VALUE,Ge.NONE),s=q.getValueOrUndefined(n.extrudedHeight,Ue.MINIMUM_VALUE),a=q.getValueOrDefault(n.extrudedHeightReference,Ue.MINIMUM_VALUE,Ge.NONE);f(s)&&!f(o)&&(o=0);let c=this._options;c.vertexFormat=i?tn.VERTEX_FORMAT:ro.MaterialSupport.TEXTURED.vertexFormat,c.rectangle=n.coordinates.getValue(Ue.MINIMUM_VALUE,c.rectangle),c.granularity=q.getValueOrUndefined(n.granularity,Ue.MINIMUM_VALUE),c.stRotation=q.getValueOrUndefined(n.stRotation,Ue.MINIMUM_VALUE),c.rotation=q.getValueOrUndefined(n.rotation,Ue.MINIMUM_VALUE),c.offsetAttribute=Wn.computeGeometryOffsetAttribute(o,r,s,a),c.height=Wn.getGeometryHeight(o,r),s=Wn.getGeometryExtrudedHeight(s,a),s===Wn.CLAMP_TO_GROUND&&(s=ri.getMinimumMaximumHeights(LT.computeRectangle(c,Iae)).minimumTerrainHeight),c.extrudedHeight=s};Qf.DynamicGeometryUpdater=FT;function FT(t,n,i){ei.call(this,t,n,i)}f(Object.create)&&(FT.prototype=Object.create(ei.prototype),FT.prototype.constructor=FT);FT.prototype._isHidden=function(t,n,i){return!f(this._options.rectangle)||ei.prototype._isHidden.call(this,t,n,i)};FT.prototype._setOptions=function(t,n,i){let o=this._options,r=q.getValueOrUndefined(n.height,i),s=q.getValueOrDefault(n.heightReference,i,Ge.NONE),a=q.getValueOrUndefined(n.extrudedHeight,i),c=q.getValueOrDefault(n.extrudedHeightReference,i,Ge.NONE);f(a)&&!f(r)&&(r=0),o.rectangle=q.getValueOrUndefined(n.coordinates,i,o.rectangle),o.granularity=q.getValueOrUndefined(n.granularity,i),o.stRotation=q.getValueOrUndefined(n.stRotation,i),o.rotation=q.getValueOrUndefined(n.rotation,i),o.offsetAttribute=Wn.computeGeometryOffsetAttribute(r,s,a,c),o.height=Wn.getGeometryHeight(r,s),a=Wn.getGeometryExtrudedHeight(a,c),a===Wn.CLAMP_TO_GROUND&&(a=ri.getMinimumMaximumHeights(LT.computeRectangle(o,Iae)).minimumTerrainHeight),o.extrudedHeight=a};var zN=Qf;var Bae=new z,vWe=new wt,PWe=new wt,IWe=m.ZERO,BWe=new m;function $f(t,n,i,o,r,s,a){this.translucent=n,this.appearanceType=i,this.depthFailAppearanceType=o,this.depthFailMaterialProperty=r,this.depthFailMaterial=void 0,this.closed=s,this.shadows=a,this.primitives=t,this.createPrimitive=!1,this.waitingOnCreate=!1,this.primitive=void 0,this.oldPrimitive=void 0,this.geometry=new yt,this.updaters=new yt,this.updatersWithAttributes=new yt,this.attributes=new yt,this.subscriptions=new yt,this.showsUpdated=new yt,this.itemsToRemove=[],this.invalidated=!1;let c;f(r)&&(c=r.definitionChanged.addEventListener($f.prototype.onMaterialChanged,this)),this.removeMaterialSubscription=c}$f.prototype.onMaterialChanged=function(){this.invalidated=!0};$f.prototype.isMaterial=function(t){let n=this.depthFailMaterialProperty,i=t.depthFailMaterialProperty;return i===n?!0:f(n)?n.equals(i):!1};$f.prototype.add=function(t,n){let i=t.id;if(this.createPrimitive=!0,this.geometry.set(i,n),this.updaters.set(i,t),!t.hasConstantFill||!t.fillMaterialProperty.isConstant||!q.isConstant(t.distanceDisplayConditionProperty)||!q.isConstant(t.terrainOffsetProperty))this.updatersWithAttributes.set(i,t);else{let o=this;this.subscriptions.set(i,t.entity.definitionChanged.addEventListener(function(r,s,a,c){s==="isShowing"&&o.showsUpdated.set(t.id,t)}))}};$f.prototype.remove=function(t){let n=t.id;if(this.createPrimitive=this.geometry.remove(n)||this.createPrimitive,this.updaters.remove(n)){this.updatersWithAttributes.remove(n);let i=this.subscriptions.get(n);return f(i)&&(i(),this.subscriptions.remove(n),this.showsUpdated.remove(n)),!0}return!1};$f.prototype.update=function(t){let n=!0,i=0,o=this.primitive,r=this.primitives,s;if(this.createPrimitive){let a=this.geometry.values;if(a.length>0){f(o)&&(f(this.oldPrimitive)?r.remove(o):this.oldPrimitive=o);let l;f(this.depthFailAppearanceType)&&(f(this.depthFailMaterialProperty)&&(this.depthFailMaterial=Zo.getValue(t,this.depthFailMaterialProperty,this.depthFailMaterial)),l=new this.depthFailAppearanceType({material:this.depthFailMaterial,translucent:this.translucent,closed:this.closed})),o=new Sn({show:!1,asynchronous:!0,geometryInstances:a.slice(),appearance:new this.appearanceType({translucent:this.translucent,closed:this.closed}),depthFailAppearance:l,shadows:this.shadows}),r.add(o),n=!1}else{f(o)&&(r.remove(o),o=void 0);let l=this.oldPrimitive;f(l)&&(r.remove(l),this.oldPrimitive=void 0)}this.attributes.removeAll(),this.primitive=o,this.createPrimitive=!1,this.waitingOnCreate=!0}else if(f(o)&&o.ready){o.show=!0,f(this.oldPrimitive)&&(r.remove(this.oldPrimitive),this.oldPrimitive=void 0),f(this.depthFailAppearanceType)&&!(this.depthFailMaterialProperty instanceof Rt)&&(this.depthFailMaterial=Zo.getValue(t,this.depthFailMaterialProperty,this.depthFailMaterial),this.primitive.depthFailAppearance.material=this.depthFailMaterial);let a=this.updatersWithAttributes.values,c=a.length,l=this.waitingOnCreate;for(s=0;s<c;s++){let u=a[s],d=this.geometry.get(u.id),h=this.attributes.get(d.id.id);if(f(h)||(h=o.getGeometryInstanceAttributes(d.id),this.attributes.set(d.id.id,h)),!u.fillMaterialProperty.isConstant||l){let x=u.fillMaterialProperty.color,T=q.getValueOrDefault(x,t,z.WHITE,Bae);z.equals(h._lastColor,T)||(h._lastColor=z.clone(T,h._lastColor),h.color=Lt.toValue(T,h.color),(this.translucent&&h.color[3]===255||!this.translucent&&h.color[3]!==255)&&(this.itemsToRemove[i++]=u))}if(f(this.depthFailAppearanceType)&&u.depthFailMaterialProperty instanceof Rt&&(!u.depthFailMaterialProperty.isConstant||l)){let x=u.depthFailMaterialProperty.color,T=q.getValueOrDefault(x,t,z.WHITE,Bae);z.equals(h._lastDepthFailColor,T)||(h._lastDepthFailColor=z.clone(T,h._lastDepthFailColor),h.depthFailColor=Lt.toValue(T,h.depthFailColor))}let _=u.entity.isShowing&&(u.hasConstantFill||u.isFilled(t)),y=h.show[0]===1;_!==y&&(h.show=mn.toValue(_,h.show));let p=u.distanceDisplayConditionProperty;if(!q.isConstant(p)){let x=q.getValueOrDefault(p,t,PWe,vWe);wt.equals(x,h._lastDistanceDisplayCondition)||(h._lastDistanceDisplayCondition=wt.clone(x,h._lastDistanceDisplayCondition),h.distanceDisplayCondition=Vn.toValue(x,h.distanceDisplayCondition))}let C=u.terrainOffsetProperty;if(!q.isConstant(C)){let x=q.getValueOrDefault(C,t,IWe,BWe);m.equals(x,h._lastOffset)||(h._lastOffset=m.clone(x,h._lastOffset),h.offset=Gi.toValue(x,h.offset))}}this.updateShows(o),this.waitingOnCreate=!1}else f(o)&&!o.ready&&(n=!1);return this.itemsToRemove.length=i,n};$f.prototype.updateShows=function(t){let n=this.showsUpdated.values,i=n.length;for(let o=0;o<i;o++){let r=n[o],s=this.geometry.get(r.id),a=this.attributes.get(s.id.id);f(a)||(a=t.getGeometryInstanceAttributes(s.id),this.attributes.set(s.id.id,a));let c=r.entity.isShowing,l=a.show[0]===1;c!==l&&(a.show=mn.toValue(c,a.show),s.attributes.show.value[0]=a.show[0])}this.showsUpdated.removeAll()};$f.prototype.contains=function(t){return this.updaters.contains(t.id)};$f.prototype.getBoundingSphere=function(t,n){let i=this.primitive;if(!i.ready)return rt.PENDING;let o=i.getGeometryInstanceAttributes(t.entity);return!f(o)||!f(o.boundingSphere)||f(o.show)&&o.show[0]===0?rt.FAILED:(o.boundingSphere.clone(n),rt.DONE)};$f.prototype.destroy=function(){let t=this.primitive,n=this.primitives;f(t)&&n.remove(t);let i=this.oldPrimitive;f(i)&&n.remove(i),f(this.removeMaterialSubscription)&&this.removeMaterialSubscription()};function NT(t,n,i,o,r){this._solidItems=[],this._translucentItems=[],this._primitives=t,this._appearanceType=n,this._depthFailAppearanceType=i,this._closed=o,this._shadows=r}NT.prototype.add=function(t,n){let i,o,r=n.createFillGeometryInstance(t);r.attributes.color.value[3]===255?(i=this._solidItems,o=!1):(i=this._translucentItems,o=!0);let s=i.length;for(let c=0;c<s;c++){let l=i[c];if(l.isMaterial(n)){l.add(n,r);return}}let a=new $f(this._primitives,o,this._appearanceType,this._depthFailAppearanceType,n.depthFailMaterialProperty,this._closed,this._shadows);a.add(n,r),i.push(a)};function Oae(t,n){let i=t.length;for(let o=i-1;o>=0;o--){let r=t[o];if(r.remove(n))return r.updaters.length===0&&(t.splice(o,1),r.destroy()),!0}return!1}NT.prototype.remove=function(t){Oae(this._solidItems,t)||Oae(this._translucentItems,t)};function Rae(t,n,i){let o=!1,r=n.length;for(let s=0;s<r;++s){let a=n[s],c=a.itemsToRemove,l=c.length;if(l>0)for(s=0;s<l;s++){let u=c[s];a.remove(u),t.add(i,u),o=!0}}return o}function HN(t,n,i,o){let r=n.length,s;for(s=r-1;s>=0;s--){let a=n[s];if(a.invalidated){n.splice(s,1);let c=a.updaters.values,l=c.length;for(let u=0;u<l;u++)t.add(i,c[u]);a.destroy()}}for(r=n.length,s=0;s<r;++s)o=n[s].update(i)&&o;return o}NT.prototype.update=function(t){let n=HN(this,this._solidItems,t,!0);n=HN(this,this._translucentItems,t,n)&&n;let i=Rae(this,this._solidItems,t),o=Rae(this,this._translucentItems,t);return(i||o)&&(n=HN(this,this._solidItems,t,n)&&n,n=HN(this,this._translucentItems,t,n)&&n),n};function Mae(t,n,i){let o=t.length;for(let r=0;r<o;r++){let s=t[r];if(s.contains(n))return s.getBoundingSphere(n,i)}return rt.FAILED}NT.prototype.getBoundingSphere=function(t,n){let i=Mae(this._solidItems,t,n);return i===rt.FAILED?Mae(this._translucentItems,t,n):i};function Lae(t){let n=t.length;for(let i=0;i<n;i++)t[i].destroy();t.length=0}NT.prototype.removeAllPrimitives=function(){Lae(this._solidItems),Lae(this._translucentItems)};var ed=NT;var OWe=new wt,RWe=new wt,MWe=m.ZERO,LWe=new m;function td(t,n,i,o,r,s,a){this.primitives=t,this.appearanceType=n,this.materialProperty=i,this.depthFailAppearanceType=o,this.depthFailMaterialProperty=r,this.closed=s,this.shadows=a,this.updaters=new yt,this.createPrimitive=!0,this.primitive=void 0,this.oldPrimitive=void 0,this.geometry=new yt,this.material=void 0,this.depthFailMaterial=void 0,this.updatersWithAttributes=new yt,this.attributes=new yt,this.invalidated=!1,this.removeMaterialSubscription=i.definitionChanged.addEventListener(td.prototype.onMaterialChanged,this),this.subscriptions=new yt,this.showsUpdated=new yt}td.prototype.onMaterialChanged=function(){this.invalidated=!0};td.prototype.isMaterial=function(t){let n=this.materialProperty,i=t.fillMaterialProperty,o=this.depthFailMaterialProperty,r=t.depthFailMaterialProperty;if(i===n&&r===o)return!0;let s=f(n)&&n.equals(i);return s=(!f(o)&&!f(r)||f(o)&&o.equals(r))&&s,s};td.prototype.add=function(t,n){let i=n.id;if(this.updaters.set(i,n),this.geometry.set(i,n.createFillGeometryInstance(t)),!n.hasConstantFill||!n.fillMaterialProperty.isConstant||!q.isConstant(n.distanceDisplayConditionProperty)||!q.isConstant(n.terrainOffsetProperty))this.updatersWithAttributes.set(i,n);else{let o=this;this.subscriptions.set(i,n.entity.definitionChanged.addEventListener(function(r,s,a,c){s==="isShowing"&&o.showsUpdated.set(n.id,n)}))}this.createPrimitive=!0};td.prototype.remove=function(t){let n=t.id;if(this.createPrimitive=this.geometry.remove(n)||this.createPrimitive,this.updaters.remove(n)){this.updatersWithAttributes.remove(n);let i=this.subscriptions.get(n);return f(i)&&(i(),this.subscriptions.remove(n),this.showsUpdated.remove(n)),!0}return!1};var FWe=new z;td.prototype.update=function(t){let n=!0,i=this.primitive,o=this.primitives,r=this.geometry.values,s;if(this.createPrimitive){if(r.length>0){f(i)&&(f(this.oldPrimitive)?o.remove(i):this.oldPrimitive=i),this.material=Zo.getValue(t,this.materialProperty,this.material);let c;f(this.depthFailMaterialProperty)&&(this.depthFailMaterial=Zo.getValue(t,this.depthFailMaterialProperty,this.depthFailMaterial),c=new this.depthFailAppearanceType({material:this.depthFailMaterial,translucent:this.depthFailMaterial.isTranslucent(),closed:this.closed})),i=new Sn({show:!1,asynchronous:!0,geometryInstances:r.slice(),appearance:new this.appearanceType({material:this.material,translucent:this.material.isTranslucent(),closed:this.closed}),depthFailAppearance:c,shadows:this.shadows}),o.add(i),n=!1}else{f(i)&&(o.remove(i),i=void 0);let c=this.oldPrimitive;f(c)&&(o.remove(c),this.oldPrimitive=void 0)}this.attributes.removeAll(),this.primitive=i,this.createPrimitive=!1}else if(f(i)&&i.ready){i.show=!0,f(this.oldPrimitive)&&(o.remove(this.oldPrimitive),this.oldPrimitive=void 0),this.material=Zo.getValue(t,this.materialProperty,this.material),this.primitive.appearance.material=this.material,f(this.depthFailAppearanceType)&&!(this.depthFailMaterialProperty instanceof Rt)&&(this.depthFailMaterial=Zo.getValue(t,this.depthFailMaterialProperty,this.depthFailMaterial),this.primitive.depthFailAppearance.material=this.depthFailMaterial);let a=this.updatersWithAttributes.values,c=a.length;for(s=0;s<c;s++){let l=a[s],u=l.entity,d=this.geometry.get(l.id),h=this.attributes.get(d.id.id);if(f(h)||(h=i.getGeometryInstanceAttributes(d.id),this.attributes.set(d.id.id,h)),f(this.depthFailAppearanceType)&&this.depthFailMaterialProperty instanceof Rt&&!l.depthFailMaterialProperty.isConstant){let x=l.depthFailMaterialProperty.color,T=q.getValueOrDefault(x,t,z.WHITE,FWe);z.equals(h._lastDepthFailColor,T)||(h._lastDepthFailColor=z.clone(T,h._lastDepthFailColor),h.depthFailColor=Lt.toValue(T,h.depthFailColor))}let _=u.isShowing&&(l.hasConstantFill||l.isFilled(t)),y=h.show[0]===1;_!==y&&(h.show=mn.toValue(_,h.show));let p=l.distanceDisplayConditionProperty;if(!q.isConstant(p)){let x=q.getValueOrDefault(p,t,RWe,OWe);wt.equals(x,h._lastDistanceDisplayCondition)||(h._lastDistanceDisplayCondition=wt.clone(x,h._lastDistanceDisplayCondition),h.distanceDisplayCondition=Vn.toValue(x,h.distanceDisplayCondition))}let C=l.terrainOffsetProperty;if(!q.isConstant(C)){let x=q.getValueOrDefault(C,t,MWe,LWe);m.equals(x,h._lastOffset)||(h._lastOffset=m.clone(x,h._lastOffset),h.offset=Gi.toValue(x,h.offset))}}this.updateShows(i)}else f(i)&&!i.ready&&(n=!1);return n};td.prototype.updateShows=function(t){let n=this.showsUpdated.values,i=n.length;for(let o=0;o<i;o++){let r=n[o],s=r.entity,a=this.geometry.get(r.id),c=this.attributes.get(a.id.id);f(c)||(c=t.getGeometryInstanceAttributes(a.id),this.attributes.set(a.id.id,c));let l=s.isShowing,u=c.show[0]===1;l!==u&&(c.show=mn.toValue(l,c.show),a.attributes.show.value[0]=c.show[0])}this.showsUpdated.removeAll()};td.prototype.contains=function(t){return this.updaters.contains(t.id)};td.prototype.getBoundingSphere=function(t,n){let i=this.primitive;if(!i.ready)return rt.PENDING;let o=i.getGeometryInstanceAttributes(t.entity);return!f(o)||!f(o.boundingSphere)||f(o.show)&&o.show[0]===0?rt.FAILED:(o.boundingSphere.clone(n),rt.DONE)};td.prototype.destroy=function(){let t=this.primitive,n=this.primitives;f(t)&&n.remove(t);let i=this.oldPrimitive;f(i)&&n.remove(i),this.removeMaterialSubscription()};function VT(t,n,i,o,r){this._items=[],this._primitives=t,this._appearanceType=n,this._depthFailAppearanceType=i,this._closed=o,this._shadows=r}VT.prototype.add=function(t,n){let i=this._items,o=i.length;for(let s=0;s<o;s++){let a=i[s];if(a.isMaterial(n)){a.add(t,n);return}}let r=new td(this._primitives,this._appearanceType,n.fillMaterialProperty,this._depthFailAppearanceType,n.depthFailMaterialProperty,this._closed,this._shadows);r.add(t,n),i.push(r)};VT.prototype.remove=function(t){let n=this._items,i=n.length;for(let o=i-1;o>=0;o--){let r=n[o];if(r.remove(t)){r.updaters.length===0&&(n.splice(o,1),r.destroy());break}}};VT.prototype.update=function(t){let n,i=this._items,o=i.length;for(n=o-1;n>=0;n--){let s=i[n];if(s.invalidated){i.splice(n,1);let a=s.updaters.values,c=a.length;for(let l=0;l<c;l++)this.add(t,a[l]);s.destroy()}}let r=!0;for(n=0;n<i.length;n++)r=i[n].update(t)&&r;return r};VT.prototype.getBoundingSphere=function(t,n){let i=this._items,o=i.length;for(let r=0;r<o;r++){let s=i[r];if(s.contains(t))return s.getBoundingSphere(t,n)}return rt.FAILED};VT.prototype.removeAllPrimitives=function(){let t=this._items,n=t.length;for(let i=0;i<n;i++)t[i].destroy();this._items.length=0};var nd=VT;var Nae=yo(Fae(),1);function GN(){this._tree=new Nae.default}function Uy(){this.minX=0,this.minY=0,this.maxX=0,this.maxY=0,this.id=""}Uy.fromRectangleAndId=function(t,n,i){return i.minX=n.west,i.minY=n.south,i.maxX=n.east,i.maxY=n.north,i.id=t,i};GN.prototype.insert=function(t,n){let i=Uy.fromRectangleAndId(t,n,new Uy);this._tree.insert(i)};function NWe(t,n){return t.id===n.id}var VWe=new Uy;GN.prototype.remove=function(t,n){let i=Uy.fromRectangleAndId(t,n,VWe);this._tree.remove(i,NWe)};var kWe=new Uy;GN.prototype.collides=function(t){let n=Uy.fromRectangleAndId("",t,kWe);return this._tree.collides(n)};var kT=GN;var UWe=new z,zWe=new wt,HWe=new wt;function fp(t,n,i,o){this.primitives=t,this.zIndex=o,this.classificationType=n,this.color=i,this.createPrimitive=!1,this.waitingOnCreate=!1,this.primitive=void 0,this.oldPrimitive=void 0,this.geometry=new yt,this.updaters=new yt,this.updatersWithAttributes=new yt,this.attributes=new yt,this.subscriptions=new yt,this.showsUpdated=new yt,this.itemsToRemove=[],this.isDirty=!1,this.rectangleCollisionCheck=new kT}fp.prototype.overlapping=function(t){return this.rectangleCollisionCheck.collides(t)};fp.prototype.add=function(t,n){let i=t.id;if(this.createPrimitive=!0,this.geometry.set(i,n),this.updaters.set(i,t),this.rectangleCollisionCheck.insert(i,n.geometry.rectangle),!t.hasConstantFill||!t.fillMaterialProperty.isConstant||!q.isConstant(t.distanceDisplayConditionProperty))this.updatersWithAttributes.set(i,t);else{let o=this;this.subscriptions.set(i,t.entity.definitionChanged.addEventListener(function(r,s,a,c){s==="isShowing"&&o.showsUpdated.set(t.id,t)}))}};fp.prototype.remove=function(t){let n=t.id,i=this.geometry.get(n);if(this.createPrimitive=this.geometry.remove(n)||this.createPrimitive,this.updaters.remove(n)){this.rectangleCollisionCheck.remove(n,i.geometry.rectangle),this.updatersWithAttributes.remove(n);let o=this.subscriptions.get(n);return f(o)&&(o(),this.subscriptions.remove(n),this.showsUpdated.remove(n)),!0}return!1};fp.prototype.update=function(t){let n=!0,i=0,o=this.primitive,r=this.primitives,s;if(this.createPrimitive){let a=this.geometry.values;if(a.length>0)f(o)&&(f(this.oldPrimitive)?r.remove(o):this.oldPrimitive=o),o=new Kc({show:!1,asynchronous:!0,geometryInstances:a.slice(),classificationType:this.classificationType}),r.add(o,this.zIndex),n=!1;else{f(o)&&(r.remove(o),o=void 0);let l=this.oldPrimitive;f(l)&&(r.remove(l),this.oldPrimitive=void 0)}this.attributes.removeAll(),this.primitive=o,this.createPrimitive=!1,this.waitingOnCreate=!0}else if(f(o)&&o.ready){o.show=!0,f(this.oldPrimitive)&&(r.remove(this.oldPrimitive),this.oldPrimitive=void 0);let a=this.updatersWithAttributes.values,c=a.length,l=this.waitingOnCreate;for(s=0;s<c;s++){let u=a[s],d=this.geometry.get(u.id),h=this.attributes.get(d.id.id);if(f(h)||(h=o.getGeometryInstanceAttributes(d.id),this.attributes.set(d.id.id,h)),!u.fillMaterialProperty.isConstant||l){let C=u.fillMaterialProperty.color,x=q.getValueOrDefault(C,t,z.WHITE,UWe);z.equals(h._lastColor,x)||(h._lastColor=z.clone(x,h._lastColor),h.color=Lt.toValue(x,h.color))}let _=u.entity.isShowing&&(u.hasConstantFill||u.isFilled(t)),y=h.show[0]===1;_!==y&&(h.show=mn.toValue(_,h.show));let p=u.distanceDisplayConditionProperty;if(!q.isConstant(p)){let C=q.getValueOrDefault(p,t,HWe,zWe);wt.equals(C,h._lastDistanceDisplayCondition)||(h._lastDistanceDisplayCondition=wt.clone(C,h._lastDistanceDisplayCondition),h.distanceDisplayCondition=Vn.toValue(C,h.distanceDisplayCondition))}}this.updateShows(o),this.waitingOnCreate=!1}else f(o)&&!o.ready&&(n=!1);return this.itemsToRemove.length=i,n};fp.prototype.updateShows=function(t){let n=this.showsUpdated.values,i=n.length;for(let o=0;o<i;o++){let r=n[o],s=this.geometry.get(r.id),a=this.attributes.get(s.id.id);f(a)||(a=t.getGeometryInstanceAttributes(s.id),this.attributes.set(s.id.id,a));let c=r.entity.isShowing,l=a.show[0]===1;c!==l&&(a.show=mn.toValue(c,a.show),s.attributes.show.value[0]=a.show[0])}this.showsUpdated.removeAll()};fp.prototype.contains=function(t){return this.updaters.contains(t.id)};fp.prototype.getBoundingSphere=function(t,n){let i=this.primitive;if(!i.ready)return rt.PENDING;let o=i.getBoundingSphere(t.entity);return f(o)?(o.clone(n),rt.DONE):rt.FAILED};fp.prototype.removeAllPrimitives=function(){let t=this.primitives,n=this.primitive;f(n)&&(t.remove(n),this.primitive=void 0,this.geometry.removeAll(),this.updaters.removeAll());let i=this.oldPrimitive;f(i)&&(t.remove(i),this.oldPrimitive=void 0)};function UT(t,n){this._batches=[],this._primitives=t,this._classificationType=n}UT.prototype.add=function(t,n){let i=n.createFillGeometryInstance(t),o=this._batches,r=q.getValueOrDefault(n.zIndex,0),s,a=o.length;for(let c=0;c<a;++c){let l=o[c];if(l.zIndex===r&&!l.overlapping(i.geometry.rectangle)){s=l;break}}return f(s)||(s=new fp(this._primitives,this._classificationType,i.attributes.color.value,r),o.push(s)),s.add(n,i),s};UT.prototype.remove=function(t){let n=this._batches,i=n.length;for(let o=0;o<i;++o)if(n[o].remove(t))return};UT.prototype.update=function(t){let n,i,o=!0,r=this._batches,s=r.length;for(n=0;n<s;++n)o=r[n].update(t)&&o;for(n=0;n<s;++n){let a=r[n],c=a.itemsToRemove,l=c.length;for(let u=0;u<l;u++){i=c[u],a.remove(i);let d=this.add(t,i);a.isDirty=!0,d.isDirty=!0}}for(n=s-1;n>=0;--n){let a=r[n];a.isDirty&&(o=r[n].update(t)&&o,a.isDirty=!1),a.geometry.length===0&&r.splice(n,1)}return o};UT.prototype.getBoundingSphere=function(t,n){let i=this._batches,o=i.length;for(let r=0;r<o;++r){let s=i[r];if(s.contains(t))return s.getBoundingSphere(t,n)}return rt.FAILED};UT.prototype.removeAllPrimitives=function(){let t=this._batches,n=t.length;for(let i=0;i<n;++i)t[i].removeAllPrimitives()};var oD=UT;var GWe=new wt,WWe=new wt;function qu(t,n,i,o,r,s){this.primitives=t,this.classificationType=n,this.appearanceType=i,this.materialProperty=o,this.updaters=new yt,this.createPrimitive=!0,this.primitive=void 0,this.oldPrimitive=void 0,this.geometry=new yt,this.material=void 0,this.updatersWithAttributes=new yt,this.attributes=new yt,this.invalidated=!1,this.removeMaterialSubscription=o.definitionChanged.addEventListener(qu.prototype.onMaterialChanged,this),this.subscriptions=new yt,this.showsUpdated=new yt,this.usingSphericalTextureCoordinates=r,this.zIndex=s,this.rectangleCollisionCheck=new kT}qu.prototype.onMaterialChanged=function(){this.invalidated=!0};qu.prototype.overlapping=function(t){return this.rectangleCollisionCheck.collides(t)};qu.prototype.isMaterial=function(t){let n=this.materialProperty,i=t.fillMaterialProperty;return i===n||i instanceof Rt&&n instanceof Rt?!0:f(n)&&n.equals(i)};qu.prototype.add=function(t,n,i){let o=n.id;if(this.updaters.set(o,n),this.geometry.set(o,i),this.rectangleCollisionCheck.insert(o,i.geometry.rectangle),!n.hasConstantFill||!n.fillMaterialProperty.isConstant||!q.isConstant(n.distanceDisplayConditionProperty))this.updatersWithAttributes.set(o,n);else{let r=this;this.subscriptions.set(o,n.entity.definitionChanged.addEventListener(function(s,a,c,l){a==="isShowing"&&r.showsUpdated.set(n.id,n)}))}this.createPrimitive=!0};qu.prototype.remove=function(t){let n=t.id,i=this.geometry.get(n);if(this.createPrimitive=this.geometry.remove(n)||this.createPrimitive,this.updaters.remove(n)){this.rectangleCollisionCheck.remove(n,i.geometry.rectangle),this.updatersWithAttributes.remove(n);let o=this.subscriptions.get(n);return f(o)&&(o(),this.subscriptions.remove(n)),!0}return!1};qu.prototype.update=function(t){let n=!0,i=this.primitive,o=this.primitives,r=this.geometry.values,s;if(this.createPrimitive){if(r.length>0)f(i)&&(f(this.oldPrimitive)?o.remove(i):this.oldPrimitive=i),this.material=Zo.getValue(t,this.materialProperty,this.material),i=new Kc({show:!1,asynchronous:!0,geometryInstances:r.slice(),appearance:new this.appearanceType({material:this.material}),classificationType:this.classificationType}),o.add(i,this.zIndex),n=!1;else{f(i)&&(o.remove(i),i=void 0);let c=this.oldPrimitive;f(c)&&(o.remove(c),this.oldPrimitive=void 0)}this.attributes.removeAll(),this.primitive=i,this.createPrimitive=!1}else if(f(i)&&i.ready){i.show=!0,f(this.oldPrimitive)&&(o.remove(this.oldPrimitive),this.oldPrimitive=void 0),this.material=Zo.getValue(t,this.materialProperty,this.material),this.primitive.appearance.material=this.material;let a=this.updatersWithAttributes.values,c=a.length;for(s=0;s<c;s++){let l=a[s],u=l.entity,d=this.geometry.get(l.id),h=this.attributes.get(d.id.id);f(h)||(h=i.getGeometryInstanceAttributes(d.id),this.attributes.set(d.id.id,h));let _=u.isShowing&&(l.hasConstantFill||l.isFilled(t)),y=h.show[0]===1;_!==y&&(h.show=mn.toValue(_,h.show));let p=l.distanceDisplayConditionProperty;if(!q.isConstant(p)){let C=q.getValueOrDefault(p,t,WWe,GWe);wt.equals(C,h._lastDistanceDisplayCondition)||(h._lastDistanceDisplayCondition=wt.clone(C,h._lastDistanceDisplayCondition),h.distanceDisplayCondition=Vn.toValue(C,h.distanceDisplayCondition))}}this.updateShows(i)}else f(i)&&!i.ready&&(n=!1);return n};qu.prototype.updateShows=function(t){let n=this.showsUpdated.values,i=n.length;for(let o=0;o<i;o++){let r=n[o],s=r.entity,a=this.geometry.get(r.id),c=this.attributes.get(a.id.id);f(c)||(c=t.getGeometryInstanceAttributes(a.id),this.attributes.set(a.id.id,c));let l=s.isShowing,u=c.show[0]===1;l!==u&&(c.show=mn.toValue(l,c.show),a.attributes.show.value[0]=c.show[0])}this.showsUpdated.removeAll()};qu.prototype.contains=function(t){return this.updaters.contains(t.id)};qu.prototype.getBoundingSphere=function(t,n){let i=this.primitive;if(!i.ready)return rt.PENDING;let o=i.getGeometryInstanceAttributes(t.entity);return!f(o)||!f(o.boundingSphere)||f(o.show)&&o.show[0]===0?rt.FAILED:(o.boundingSphere.clone(n),rt.DONE)};qu.prototype.destroy=function(){let t=this.primitive,n=this.primitives;f(t)&&n.remove(t);let i=this.oldPrimitive;f(i)&&n.remove(i),this.removeMaterialSubscription()};function zT(t,n,i){this._items=[],this._primitives=t,this._classificationType=n,this._appearanceType=i}zT.prototype.add=function(t,n){let i=this._items,o=i.length,r=n.createFillGeometryInstance(t),s=xu.shouldUseSphericalCoordinates(r.geometry.rectangle),a=q.getValueOrDefault(n.zIndex,0);for(let l=0;l<o;++l){let u=i[l];if(u.isMaterial(n)&&u.usingSphericalTextureCoordinates===s&&u.zIndex===a&&!u.overlapping(r.geometry.rectangle)){u.add(t,n,r);return}}let c=new qu(this._primitives,this._classificationType,this._appearanceType,n.fillMaterialProperty,s,a);c.add(t,n,r),i.push(c)};zT.prototype.remove=function(t){let n=this._items,i=n.length;for(let o=i-1;o>=0;o--){let r=n[o];if(r.remove(t)){r.updaters.length===0&&(n.splice(o,1),r.destroy());break}}};zT.prototype.update=function(t){let n,i=this._items,o=i.length;for(n=o-1;n>=0;n--){let s=i[n];if(s.invalidated){i.splice(n,1);let a=s.updaters.values,c=a.length;for(let l=0;l<c;l++)this.add(t,a[l]);s.destroy()}}let r=!0;for(n=0;n<i.length;n++)r=i[n].update(t)&&r;return r};zT.prototype.getBoundingSphere=function(t,n){let i=this._items,o=i.length;for(let r=0;r<o;r++){let s=i[r];if(s.contains(t))return s.getBoundingSphere(t,n)}return rt.FAILED};zT.prototype.removeAllPrimitives=function(){let t=this._items,n=t.length;for(let i=0;i<n;i++)t[i].destroy();this._items.length=0};var WN=zT;var jWe=new z,qWe=new wt,YWe=new wt,XWe=m.ZERO,KWe=new m;function dp(t,n,i,o){this.translucent=n,this.width=i,this.shadows=o,this.primitives=t,this.createPrimitive=!1,this.waitingOnCreate=!1,this.primitive=void 0,this.oldPrimitive=void 0,this.geometry=new yt,this.updaters=new yt,this.updatersWithAttributes=new yt,this.attributes=new yt,this.itemsToRemove=[],this.subscriptions=new yt,this.showsUpdated=new yt}dp.prototype.add=function(t,n){let i=t.id;if(this.createPrimitive=!0,this.geometry.set(i,n),this.updaters.set(i,t),!t.hasConstantOutline||!t.outlineColorProperty.isConstant||!q.isConstant(t.distanceDisplayConditionProperty)||!q.isConstant(t.terrainOffsetProperty))this.updatersWithAttributes.set(i,t);else{let o=this;this.subscriptions.set(i,t.entity.definitionChanged.addEventListener(function(r,s,a,c){s==="isShowing"&&o.showsUpdated.set(t.id,t)}))}};dp.prototype.remove=function(t){let n=t.id;if(this.createPrimitive=this.geometry.remove(n)||this.createPrimitive,this.updaters.remove(n)){this.updatersWithAttributes.remove(n);let i=this.subscriptions.get(n);return f(i)&&(i(),this.subscriptions.remove(n),this.showsUpdated.remove(n)),!0}return!1};dp.prototype.update=function(t){let n=!0,i=0,o=this.primitive,r=this.primitives,s;if(this.createPrimitive){let a=this.geometry.values;if(a.length>0)f(o)&&(f(this.oldPrimitive)?r.remove(o):this.oldPrimitive=o),o=new Sn({show:!1,asynchronous:!0,geometryInstances:a.slice(),appearance:new tn({flat:!0,translucent:this.translucent,renderState:{lineWidth:this.width}}),shadows:this.shadows}),r.add(o),n=!1;else{f(o)&&(r.remove(o),o=void 0);let l=this.oldPrimitive;f(l)&&(r.remove(l),this.oldPrimitive=void 0)}this.attributes.removeAll(),this.primitive=o,this.createPrimitive=!1,this.waitingOnCreate=!0}else if(f(o)&&o.ready){o.show=!0,f(this.oldPrimitive)&&(r.remove(this.oldPrimitive),this.oldPrimitive=void 0);let a=this.updatersWithAttributes.values,c=a.length,l=this.waitingOnCreate;for(s=0;s<c;s++){let u=a[s],d=this.geometry.get(u.id),h=this.attributes.get(d.id.id);if(f(h)||(h=o.getGeometryInstanceAttributes(d.id),this.attributes.set(d.id.id,h)),!u.outlineColorProperty.isConstant||l){let x=u.outlineColorProperty,T=q.getValueOrDefault(x,t,z.WHITE,jWe);z.equals(h._lastColor,T)||(h._lastColor=z.clone(T,h._lastColor),h.color=Lt.toValue(T,h.color),(this.translucent&&h.color[3]===255||!this.translucent&&h.color[3]!==255)&&(this.itemsToRemove[i++]=u))}let _=u.entity.isShowing&&(u.hasConstantOutline||u.isOutlineVisible(t)),y=h.show[0]===1;_!==y&&(h.show=mn.toValue(_,h.show));let p=u.distanceDisplayConditionProperty;if(!q.isConstant(p)){let x=q.getValueOrDefault(p,t,YWe,qWe);wt.equals(x,h._lastDistanceDisplayCondition)||(h._lastDistanceDisplayCondition=wt.clone(x,h._lastDistanceDisplayCondition),h.distanceDisplayCondition=Vn.toValue(x,h.distanceDisplayCondition))}let C=u.terrainOffsetProperty;if(!q.isConstant(C)){let x=q.getValueOrDefault(C,t,XWe,KWe);m.equals(x,h._lastOffset)||(h._lastOffset=m.clone(x,h._lastOffset),h.offset=Gi.toValue(x,h.offset))}}this.updateShows(o),this.waitingOnCreate=!1}else f(o)&&!o.ready&&(n=!1);return this.itemsToRemove.length=i,n};dp.prototype.updateShows=function(t){let n=this.showsUpdated.values,i=n.length;for(let o=0;o<i;o++){let r=n[o],s=this.geometry.get(r.id),a=this.attributes.get(s.id.id);f(a)||(a=t.getGeometryInstanceAttributes(s.id),this.attributes.set(s.id.id,a));let c=r.entity.isShowing,l=a.show[0]===1;c!==l&&(a.show=mn.toValue(c,a.show),s.attributes.show.value[0]=a.show[0])}this.showsUpdated.removeAll()};dp.prototype.contains=function(t){return this.updaters.contains(t.id)};dp.prototype.getBoundingSphere=function(t,n){let i=this.primitive;if(!i.ready)return rt.PENDING;let o=i.getGeometryInstanceAttributes(t.entity);return!f(o)||!f(o.boundingSphere)||f(o.show)&&o.show[0]===0?rt.FAILED:(o.boundingSphere.clone(n),rt.DONE)};dp.prototype.removeAllPrimitives=function(){let t=this.primitives,n=this.primitive;f(n)&&(t.remove(n),this.primitive=void 0,this.geometry.removeAll(),this.updaters.removeAll());let i=this.oldPrimitive;f(i)&&(t.remove(i),this.oldPrimitive=void 0)};function HT(t,n,i){this._primitives=t,this._scene=n,this._shadows=i,this._solidBatches=new yt,this._translucentBatches=new yt}HT.prototype.add=function(t,n){let i=n.createOutlineGeometryInstance(t),o=this._scene.clampLineWidth(n.outlineWidth),r,s;i.attributes.color.value[3]===255?(r=this._solidBatches,s=r.get(o),f(s)||(s=new dp(this._primitives,!1,o,this._shadows),r.set(o,s)),s.add(n,i)):(r=this._translucentBatches,s=r.get(o),f(s)||(s=new dp(this._primitives,!0,o,this._shadows),r.set(o,s)),s.add(n,i))};HT.prototype.remove=function(t){let n,i=this._solidBatches.values,o=i.length;for(n=0;n<o;n++)if(i[n].remove(t))return;let r=this._translucentBatches.values,s=r.length;for(n=0;n<s;n++)if(r[n].remove(t))return};HT.prototype.update=function(t){let n,i,o,r,s=this._solidBatches.values,a=s.length,c=this._translucentBatches.values,l=c.length,u,d=!0,h=!1;do{for(h=!1,i=0;i<a;i++){r=s[i],d=r.update(t),u=r.itemsToRemove;let _=u.length;if(_>0)for(h=!0,n=0;n<_;n++)o=u[n],r.remove(o),this.add(t,o)}for(i=0;i<l;i++){r=c[i],d=r.update(t),u=r.itemsToRemove;let _=u.length;if(_>0)for(h=!0,n=0;n<_;n++)o=u[n],r.remove(o),this.add(t,o)}}while(h);return d};HT.prototype.getBoundingSphere=function(t,n){let i,o=this._solidBatches.values,r=o.length;for(i=0;i<r;i++){let c=o[i];if(c.contains(t))return c.getBoundingSphere(t,n)}let s=this._translucentBatches.values,a=s.length;for(i=0;i<a;i++){let c=s[i];if(c.contains(t))return c.getBoundingSphere(t,n)}return rt.FAILED};HT.prototype.removeAllPrimitives=function(){let t,n=this._solidBatches.values,i=n.length;for(t=0;t<i;t++)n[t].removeAllPrimitives();let o=this._translucentBatches.values,r=o.length;for(t=0;t<r;t++)o[t].removeAllPrimitives()};var rD=HT;var Vae={};function JWe(t,n){return B.equalsEpsilon(t.latitude,n.latitude,B.EPSILON10)&&B.equalsEpsilon(t.longitude,n.longitude,B.EPSILON10)}var ZWe=new de,QWe=new de;function $We(t,n,i,o){n=Co(n,m.equalsEpsilon);let r=n.length;if(r<2)return;let s=f(o),a=f(i),c=new Array(r),l=new Array(r),u=new Array(r),d=n[0];c[0]=d;let h=t.cartesianToCartographic(d,ZWe);a&&(h.height=i[0]),l[0]=h.height,s?u[0]=o[0]:u[0]=0;let _=l[0],y=u[0],p=_===y,C=1;for(let x=1;x<r;++x){let T=n[x],E=t.cartesianToCartographic(T,QWe);a&&(E.height=i[x]),p=p&&E.height===0,JWe(h,E)?h.height<E.height&&(l[C-1]=E.height):(c[C]=T,l[C]=E.height,s?u[C]=o[x]:u[C]=0,p=p&&l[C]===u[C],de.clone(E,h),++C)}if(!(p||C<2))return c.length=C,l.length=C,u.length=C,{positions:c,topHeights:l,bottomHeights:u}}var e7e=new Array(2),t7e=new Array(2),n7e={positions:void 0,height:void 0,granularity:void 0,ellipsoid:void 0};Vae.computePositions=function(t,n,i,o,r,s){let a=$We(t,n,i,o);if(!f(a))return;n=a.positions,i=a.topHeights,o=a.bottomHeights;let c=n.length,l=c-2,u,d,h=B.chordLength(r,t.maximumRadius),_=n7e;if(_.minDistance=h,_.ellipsoid=t,s){let y=0,p;for(p=0;p<c-1;p++)y+=Si.numberOfPoints(n[p],n[p+1],h)+1;u=new Float64Array(y*3),d=new Float64Array(y*3);let C=e7e,x=t7e;_.positions=C,_.height=x;let T=0;for(p=0;p<c-1;p++){C[0]=n[p],C[1]=n[p+1],x[0]=i[p],x[1]=i[p+1];let E=Si.generateArc(_);u.set(E,T),x[0]=o[p],x[1]=o[p+1],d.set(Si.generateArc(_),T),T+=E.length}}else _.positions=n,_.height=i,u=new Float64Array(Si.generateArc(_)),_.height=o,d=new Float64Array(Si.generateArc(_));return{bottomPositions:d,topPositions:u,numCorners:l}};var GT=Vae;var p9=new m,jN=new m,i7e=new m,kae=new m,o7e=new m,r7e=new m,s7e=new m;function zy(t){t=A(t,A.EMPTY_OBJECT);let n=t.positions,i=t.maximumHeights,o=t.minimumHeights,r=A(t.vertexFormat,De.DEFAULT),s=A(t.granularity,B.RADIANS_PER_DEGREE),a=A(t.ellipsoid,oe.WGS84);this._positions=n,this._minimumHeights=o,this._maximumHeights=i,this._vertexFormat=De.clone(r),this._granularity=s,this._ellipsoid=oe.clone(a),this._workerName="createWallGeometry";let c=1+n.length*m.packedLength+2;f(o)&&(c+=o.length),f(i)&&(c+=i.length),this.packedLength=c+oe.packedLength+De.packedLength+1}zy.pack=function(t,n,i){i=A(i,0);let o,r=t._positions,s=r.length;for(n[i++]=s,o=0;o<s;++o,i+=m.packedLength)m.pack(r[o],n,i);let a=t._minimumHeights;if(s=f(a)?a.length:0,n[i++]=s,f(a))for(o=0;o<s;++o)n[i++]=a[o];let c=t._maximumHeights;if(s=f(c)?c.length:0,n[i++]=s,f(c))for(o=0;o<s;++o)n[i++]=c[o];return oe.pack(t._ellipsoid,n,i),i+=oe.packedLength,De.pack(t._vertexFormat,n,i),i+=De.packedLength,n[i]=t._granularity,n};var Uae=oe.clone(oe.UNIT_SPHERE),zae=new De,sD={positions:void 0,minimumHeights:void 0,maximumHeights:void 0,ellipsoid:Uae,vertexFormat:zae,granularity:void 0};zy.unpack=function(t,n,i){n=A(n,0);let o,r=t[n++],s=new Array(r);for(o=0;o<r;++o,n+=m.packedLength)s[o]=m.unpack(t,n);r=t[n++];let a;if(r>0)for(a=new Array(r),o=0;o<r;++o)a[o]=t[n++];r=t[n++];let c;if(r>0)for(c=new Array(r),o=0;o<r;++o)c[o]=t[n++];let l=oe.unpack(t,n,Uae);n+=oe.packedLength;let u=De.unpack(t,n,zae);n+=De.packedLength;let d=t[n];return f(i)?(i._positions=s,i._minimumHeights=a,i._maximumHeights=c,i._ellipsoid=oe.clone(l,i._ellipsoid),i._vertexFormat=De.clone(u,i._vertexFormat),i._granularity=d,i):(sD.positions=s,sD.minimumHeights=a,sD.maximumHeights=c,sD.granularity=d,new zy(sD))};zy.fromConstantHeights=function(t){t=A(t,A.EMPTY_OBJECT);let n=t.positions,i,o,r=t.minimumHeight,s=t.maximumHeight,a=f(r),c=f(s);if(a||c){let u=n.length;i=a?new Array(u):void 0,o=c?new Array(u):void 0;for(let d=0;d<u;++d)a&&(i[d]=r),c&&(o[d]=s)}let l={positions:n,maximumHeights:o,minimumHeights:i,ellipsoid:t.ellipsoid,vertexFormat:t.vertexFormat};return new zy(l)};zy.createGeometry=function(t){let n=t._positions,i=t._minimumHeights,o=t._maximumHeights,r=t._vertexFormat,s=t._granularity,a=t._ellipsoid,c=GT.computePositions(a,n,o,i,s,!0);if(!f(c))return;let l=c.bottomPositions,u=c.topPositions,d=c.numCorners,h=u.length,_=h*2,y=r.position?new Float64Array(_):void 0,p=r.normal?new Float32Array(_):void 0,C=r.tangent?new Float32Array(_):void 0,x=r.bitangent?new Float32Array(_):void 0,T=r.st?new Float32Array(_/3*2):void 0,E=0,S=0,w=0,D=0,I=0,O=s7e,M=r7e,L=o7e,F=!0;h/=3;let g,b=0,v=1/(h-d-1);for(g=0;g<h;++g){let U=g*3,G=m.fromArray(u,U,p9),k=m.fromArray(l,U,jN);if(r.position&&(y[E++]=k.x,y[E++]=k.y,y[E++]=k.z,y[E++]=G.x,y[E++]=G.y,y[E++]=G.z),r.st&&(T[I++]=b,T[I++]=0,T[I++]=b,T[I++]=1),r.normal||r.tangent||r.bitangent){let X=m.clone(m.ZERO,kae),Y=m.subtract(G,a.geodeticSurfaceNormal(G,jN),jN);if(g+1<h&&(X=m.fromArray(u,U+3,kae)),F){let K=m.subtract(X,G,i7e),j=m.subtract(Y,G,p9);O=m.normalize(m.cross(j,K,O),O),F=!1}m.equalsEpsilon(G,X,B.EPSILON10)?F=!0:(b+=v,r.tangent&&(M=m.normalize(m.subtract(X,G,M),M)),r.bitangent&&(L=m.normalize(m.cross(O,M,L),L))),r.normal&&(p[S++]=O.x,p[S++]=O.y,p[S++]=O.z,p[S++]=O.x,p[S++]=O.y,p[S++]=O.z),r.tangent&&(C[D++]=M.x,C[D++]=M.y,C[D++]=M.z,C[D++]=M.x,C[D++]=M.y,C[D++]=M.z),r.bitangent&&(x[w++]=L.x,x[w++]=L.y,x[w++]=L.z,x[w++]=L.x,x[w++]=L.y,x[w++]=L.z)}}let P=new cn;r.position&&(P.position=new we({componentDatatype:J.DOUBLE,componentsPerAttribute:3,values:y})),r.normal&&(P.normal=new we({componentDatatype:J.FLOAT,componentsPerAttribute:3,values:p})),r.tangent&&(P.tangent=new we({componentDatatype:J.FLOAT,componentsPerAttribute:3,values:C})),r.bitangent&&(P.bitangent=new we({componentDatatype:J.FLOAT,componentsPerAttribute:3,values:x})),r.st&&(P.st=new we({componentDatatype:J.FLOAT,componentsPerAttribute:2,values:T}));let R=_/3;_-=6*(d+1);let V=Ne.createTypedArray(R,_),H=0;for(g=0;g<R-2;g+=2){let U=g,G=g+2,k=m.fromArray(y,U*3,p9),X=m.fromArray(y,G*3,jN);if(m.equalsEpsilon(k,X,B.EPSILON10))continue;let Y=g+1,K=g+3;V[H++]=Y,V[H++]=U,V[H++]=K,V[H++]=K,V[H++]=U,V[H++]=G}return new at({attributes:P,indices:V,primitiveType:Re.TRIANGLES,boundingSphere:new ae.fromVertices(y)})};var qN=zy;var Hae=new m,Gae=new m;function Hy(t){t=A(t,A.EMPTY_OBJECT);let n=t.positions,i=t.maximumHeights,o=t.minimumHeights,r=A(t.granularity,B.RADIANS_PER_DEGREE),s=A(t.ellipsoid,oe.WGS84);this._positions=n,this._minimumHeights=o,this._maximumHeights=i,this._granularity=r,this._ellipsoid=oe.clone(s),this._workerName="createWallOutlineGeometry";let a=1+n.length*m.packedLength+2;f(o)&&(a+=o.length),f(i)&&(a+=i.length),this.packedLength=a+oe.packedLength+1}Hy.pack=function(t,n,i){i=A(i,0);let o,r=t._positions,s=r.length;for(n[i++]=s,o=0;o<s;++o,i+=m.packedLength)m.pack(r[o],n,i);let a=t._minimumHeights;if(s=f(a)?a.length:0,n[i++]=s,f(a))for(o=0;o<s;++o)n[i++]=a[o];let c=t._maximumHeights;if(s=f(c)?c.length:0,n[i++]=s,f(c))for(o=0;o<s;++o)n[i++]=c[o];return oe.pack(t._ellipsoid,n,i),i+=oe.packedLength,n[i]=t._granularity,n};var Wae=oe.clone(oe.UNIT_SPHERE),aD={positions:void 0,minimumHeights:void 0,maximumHeights:void 0,ellipsoid:Wae,granularity:void 0};Hy.unpack=function(t,n,i){n=A(n,0);let o,r=t[n++],s=new Array(r);for(o=0;o<r;++o,n+=m.packedLength)s[o]=m.unpack(t,n);r=t[n++];let a;if(r>0)for(a=new Array(r),o=0;o<r;++o)a[o]=t[n++];r=t[n++];let c;if(r>0)for(c=new Array(r),o=0;o<r;++o)c[o]=t[n++];let l=oe.unpack(t,n,Wae);n+=oe.packedLength;let u=t[n];return f(i)?(i._positions=s,i._minimumHeights=a,i._maximumHeights=c,i._ellipsoid=oe.clone(l,i._ellipsoid),i._granularity=u,i):(aD.positions=s,aD.minimumHeights=a,aD.maximumHeights=c,aD.granularity=u,new Hy(aD))};Hy.fromConstantHeights=function(t){t=A(t,A.EMPTY_OBJECT);let n=t.positions,i,o,r=t.minimumHeight,s=t.maximumHeight,a=f(r),c=f(s);if(a||c){let u=n.length;i=a?new Array(u):void 0,o=c?new Array(u):void 0;for(let d=0;d<u;++d)a&&(i[d]=r),c&&(o[d]=s)}let l={positions:n,maximumHeights:o,minimumHeights:i,ellipsoid:t.ellipsoid};return new Hy(l)};Hy.createGeometry=function(t){let n=t._positions,i=t._minimumHeights,o=t._maximumHeights,r=t._granularity,s=t._ellipsoid,a=GT.computePositions(s,n,o,i,r,!1);if(!f(a))return;let c=a.bottomPositions,l=a.topPositions,u=l.length,d=u*2,h=new Float64Array(d),_=0;u/=3;let y;for(y=0;y<u;++y){let E=y*3,S=m.fromArray(l,E,Hae),w=m.fromArray(c,E,Gae);h[_++]=w.x,h[_++]=w.y,h[_++]=w.z,h[_++]=S.x,h[_++]=S.y,h[_++]=S.z}let p=new cn({position:new we({componentDatatype:J.DOUBLE,componentsPerAttribute:3,values:h})}),C=d/3;d=2*C-4+C;let x=Ne.createTypedArray(C,d),T=0;for(y=0;y<C-2;y+=2){let E=y,S=y+2,w=m.fromArray(h,E*3,Hae),D=m.fromArray(h,S*3,Gae);if(m.equalsEpsilon(w,D,B.EPSILON10))continue;let I=y+1,O=y+3;x[T++]=I,x[T++]=E,x[T++]=I,x[T++]=O,x[T++]=E,x[T++]=S}return x[T++]=C-2,x[T++]=C-1,new at({attributes:p,indices:x,primitiveType:Re.LINES,boundingSphere:new ae.fromVertices(h)})};var YN=Hy;var jae=new z;function a7e(t){this.id=t,this.vertexFormat=void 0,this.positions=void 0,this.minimumHeights=void 0,this.maximumHeights=void 0,this.granularity=void 0}function id(t,n){ti.call(this,{entity:t,scene:n,geometryOptions:new a7e(t),geometryPropertyName:"wall",observedPropertyNames:["availability","wall"]}),this._onEntityPropertyChanged(t,"wall",t.wall,void 0)}f(Object.create)&&(id.prototype=Object.create(ti.prototype),id.prototype.constructor=id);id.prototype.createFillGeometryInstance=function(t){let n=this._entity,i=n.isAvailable(t),o,r,s=new mn(i&&n.isShowing&&this._showProperty.getValue(t)&&this._fillProperty.getValue(t)),a=this._distanceDisplayConditionProperty.getValue(t),c=Vn.fromDistanceDisplayCondition(a);if(this._materialProperty instanceof Rt){let l;f(this._materialProperty.color)&&(this._materialProperty.color.isConstant||i)&&(l=this._materialProperty.color.getValue(t,jae)),f(l)||(l=z.WHITE),r=Lt.fromColor(l),o={show:s,distanceDisplayCondition:c,color:r}}else o={show:s,distanceDisplayCondition:c};return new Ct({id:n,geometry:new qN(this._options),attributes:o})};id.prototype.createOutlineGeometryInstance=function(t){let n=this._entity,i=n.isAvailable(t),o=q.getValueOrDefault(this._outlineColorProperty,t,z.BLACK,jae),r=this._distanceDisplayConditionProperty.getValue(t);return new Ct({id:n,geometry:new YN(this._options),attributes:{show:new mn(i&&n.isShowing&&this._showProperty.getValue(t)&&this._showOutlineProperty.getValue(t)),color:Lt.fromColor(o),distanceDisplayCondition:Vn.fromDistanceDisplayCondition(r)}})};id.prototype._isHidden=function(t,n){return!f(n.positions)||ti.prototype._isHidden.call(this,t,n)};id.prototype._getIsClosed=function(t){return!1};id.prototype._isDynamic=function(t,n){return!n.positions.isConstant||!q.isConstant(n.minimumHeights)||!q.isConstant(n.maximumHeights)||!q.isConstant(n.outlineWidth)||!q.isConstant(n.granularity)};id.prototype._setStaticOptions=function(t,n){let i=n.minimumHeights,o=n.maximumHeights,r=n.granularity,s=this._materialProperty instanceof Rt,a=this._options;a.vertexFormat=s?tn.VERTEX_FORMAT:ro.MaterialSupport.TEXTURED.vertexFormat,a.positions=n.positions.getValue(Ue.MINIMUM_VALUE,a.positions),a.minimumHeights=f(i)?i.getValue(Ue.MINIMUM_VALUE,a.minimumHeights):void 0,a.maximumHeights=f(o)?o.getValue(Ue.MINIMUM_VALUE,a.maximumHeights):void 0,a.granularity=f(r)?r.getValue(Ue.MINIMUM_VALUE):void 0};id.DynamicGeometryUpdater=WT;function WT(t,n,i){ei.call(this,t,n,i)}f(Object.create)&&(WT.prototype=Object.create(ei.prototype),WT.prototype.constructor=WT);WT.prototype._isHidden=function(t,n,i){return!f(this._options.positions)||ei.prototype._isHidden.call(this,t,n,i)};WT.prototype._setOptions=function(t,n,i){let o=this._options;o.positions=q.getValueOrUndefined(n.positions,i,o.positions),o.minimumHeights=q.getValueOrUndefined(n.minimumHeights,i,o.minimumHeights),o.maximumHeights=q.getValueOrUndefined(n.maximumHeights,i,o.maximumHeights),o.granularity=q.getValueOrUndefined(n.granularity,i)};var XN=id;var c7e=[],qae=[TL,iN,KF,SN,wN,ON,NN,UN,zN,XN];function cD(t,n){this.entity=t,this.scene=n;let i=new Array(qae.length),o=new Ae;function r(a){o.raiseEvent(a)}let s=new Mr;for(let a=0;a<i.length;a++){let c=new qae[a](t,n);s.add(c.geometryChanged,r),i[a]=c}this.updaters=i,this.geometryChanged=o,this.eventHelper=s,this._removeEntitySubscription=t.definitionChanged.addEventListener(cD.prototype._onEntityPropertyChanged,this)}cD.prototype._onEntityPropertyChanged=function(t,n,i,o){let r=this.updaters;for(let s=0;s<r.length;s++)r[s]._onEntityPropertyChanged(t,n,i,o)};cD.prototype.forEach=function(t){let n=this.updaters;for(let i=0;i<n.length;i++)t(n[i])};cD.prototype.destroy=function(){this.eventHelper.removeAll();let t=this.updaters;for(let n=0;n<t.length;n++)t[n].destroy();this._removeEntitySubscription(),ue(this)};function Yu(t,n,i,o){i=A(i,t.primitives),o=A(o,t.groundPrimitives),this._scene=t,this._primitives=i,this._groundPrimitives=o,this._entityCollection=void 0,this._addedObjects=new yt,this._removedObjects=new yt,this._changedObjects=new yt;let r=gn.NUMBER_OF_SHADOW_MODES;this._outlineBatches=new Array(r*2),this._closedColorBatches=new Array(r*2),this._closedMaterialBatches=new Array(r*2),this._openColorBatches=new Array(r*2),this._openMaterialBatches=new Array(r*2);let s=Qo.supportsMaterialsforEntitiesOnTerrain(t);this._supportsMaterialsforEntitiesOnTerrain=s;let a;for(a=0;a<r;++a)this._outlineBatches[a]=new rD(i,t,a,!1),this._outlineBatches[r+a]=new rD(i,t,a,!0),this._closedColorBatches[a]=new ed(i,tn,void 0,!0,a,!0),this._closedColorBatches[r+a]=new ed(i,tn,void 0,!0,a,!1),this._closedMaterialBatches[a]=new nd(i,ro,void 0,!0,a,!0),this._closedMaterialBatches[r+a]=new nd(i,ro,void 0,!0,a,!1),this._openColorBatches[a]=new ed(i,tn,void 0,!1,a,!0),this._openColorBatches[r+a]=new ed(i,tn,void 0,!1,a,!1),this._openMaterialBatches[a]=new nd(i,ro,void 0,!1,a,!0),this._openMaterialBatches[r+a]=new nd(i,ro,void 0,!1,a,!1);let c=Un.NUMBER_OF_CLASSIFICATION_TYPES,l=new Array(c),u=[];if(s)for(a=0;a<c;++a)u.push(new WN(o,a,ro)),l[a]=new oD(o,a);else for(a=0;a<c;++a)l[a]=new oD(o,a);this._groundColorBatches=l,this._groundMaterialBatches=u,this._dynamicBatch=new CT(i,o),this._batches=this._outlineBatches.concat(this._closedColorBatches,this._closedMaterialBatches,this._openColorBatches,this._openMaterialBatches,this._groundColorBatches,this._groundMaterialBatches,this._dynamicBatch),this._subscriptions=new yt,this._updaterSets=new yt,this._entityCollection=n,n.collectionChanged.addEventListener(Yu.prototype._onCollectionChanged,this),this._onCollectionChanged(n,n.values,c7e)}Yu.prototype.update=function(t){let n=this._addedObjects,i=n.values,o=this._removedObjects,r=o.values,s=this._changedObjects,a=s.values,c,l,u,d,h=this;for(c=a.length-1;c>-1;c--)l=a[c],u=l.id,d=this._updaterSets.get(u),d.entity===l?d.forEach(function(C){h._removeUpdater(C),h._insertUpdaterIntoBatch(t,C)}):(r.push(l),i.push(l));for(c=r.length-1;c>-1;c--)l=r[c],u=l.id,d=this._updaterSets.get(u),d.forEach(this._removeUpdater.bind(this)),d.destroy(),this._updaterSets.remove(u),this._subscriptions.get(u)(),this._subscriptions.remove(u);for(c=i.length-1;c>-1;c--)l=i[c],u=l.id,d=new cD(l,this._scene),this._updaterSets.set(u,d),d.forEach(function(C){h._insertUpdaterIntoBatch(t,C)}),this._subscriptions.set(u,d.geometryChanged.addEventListener(Yu._onGeometryChanged,this));n.removeAll(),o.removeAll(),s.removeAll();let _=!0,y=this._batches,p=y.length;for(c=0;c<p;c++)_=y[c].update(t)&&_;return _};var l7e=[],u7e=new ae;Yu.prototype.getBoundingSphere=function(t,n){let i=l7e,o=u7e,r=0,s=rt.DONE,a=this._batches,c=a.length,l=t.id,u=this._updaterSets.get(l).updaters;for(let d=0;d<u.length;d++){let h=u[d];for(let _=0;_<c;_++){if(s=a[_].getBoundingSphere(h,o),s===rt.PENDING)return rt.PENDING;s===rt.DONE&&(i[r]=ae.clone(o,i[r]),r++)}}return r===0?rt.FAILED:(i.length=r,ae.fromBoundingSpheres(i,n),rt.DONE)};Yu.prototype.isDestroyed=function(){return!1};Yu.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(Yu.prototype._onCollectionChanged,this),this._addedObjects.removeAll(),this._removedObjects.removeAll();let t,n=this._batches,i=n.length;for(t=0;t<i;t++)n[t].removeAllPrimitives();let o=this._subscriptions.values;for(i=o.length,t=0;t<i;t++)o[t]();this._subscriptions.removeAll();let r=this._updaterSets.values;for(i=r.length,t=0;t<i;t++)r[t].destroy();return this._updaterSets.removeAll(),ue(this)};Yu.prototype._removeUpdater=function(t){let n=this._batches,i=n.length;for(let o=0;o<i;o++)n[o].remove(t)};Yu.prototype._insertUpdaterIntoBatch=function(t,n){if(n.isDynamic){this._dynamicBatch.add(t,n);return}let i;(n.outlineEnabled||n.fillEnabled)&&(i=n.shadowsProperty.getValue(t));let o=gn.NUMBER_OF_SHADOW_MODES;if(n.outlineEnabled&&(f(n.terrainOffsetProperty)?this._outlineBatches[o+i].add(t,n):this._outlineBatches[i].add(t,n)),n.fillEnabled)if(n.onTerrain){let r=n.classificationTypeProperty.getValue(t);n.fillMaterialProperty instanceof Rt?this._groundColorBatches[r].add(t,n):this._groundMaterialBatches[r].add(t,n)}else n.isClosed?n.fillMaterialProperty instanceof Rt?f(n.terrainOffsetProperty)?this._closedColorBatches[o+i].add(t,n):this._closedColorBatches[i].add(t,n):f(n.terrainOffsetProperty)?this._closedMaterialBatches[o+i].add(t,n):this._closedMaterialBatches[i].add(t,n):n.fillMaterialProperty instanceof Rt?f(n.terrainOffsetProperty)?this._openColorBatches[o+i].add(t,n):this._openColorBatches[i].add(t,n):f(n.terrainOffsetProperty)?this._openMaterialBatches[o+i].add(t,n):this._openMaterialBatches[i].add(t,n)};Yu._onGeometryChanged=function(t){let n=this._removedObjects,i=this._changedObjects,o=t.entity,r=o.id;!f(n.get(r))&&!f(i.get(r))&&i.set(r,o)};Yu.prototype._onCollectionChanged=function(t,n,i){let o=this._addedObjects,r=this._removedObjects,s=this._changedObjects,a,c,l;for(a=i.length-1;a>-1;a--)l=i[a],c=l.id,o.remove(c)||(r.set(c,l),s.remove(c));for(a=n.length-1;a>-1;a--)l=n[a],c=l.id,r.remove(c)?s.set(c,l):o.set(c,l)};var KN=Yu;var f7e=1,d7e="30px sans-serif",h7e=Lo.FILL,m7e=z.WHITE,p7e=z.BLACK,_7e=1,g7e=!1,y7e=new z(.165,.165,.165,.8),A7e=new W(7,5),C7e=W.ZERO,x7e=m.ZERO,T7e=Ge.NONE,E7e=ui.CENTER,b7e=vn.CENTER,S7e=new m,w7e=new z,D7e=new z,v7e=new z,P7e=new W,I7e=new m,B7e=new W,O7e=new Pt,R7e=new Pt,M7e=new Pt,L7e=new wt;function Yae(t){this.entity=t,this.label=void 0,this.index=void 0}function fg(t,n){n.collectionChanged.addEventListener(fg.prototype._onCollectionChanged,this),this._cluster=t,this._entityCollection=n,this._items=new yt,this._onCollectionChanged(n,n.values,[],[])}fg.prototype.update=function(t){let n=this._items.values,i=this._cluster;for(let o=0,r=n.length;o<r;o++){let s=n[o],a=s.entity,c=a._label,l,u=s.label,d=a.isShowing&&a.isAvailable(t)&&q.getValueOrDefault(c._show,t,!0),h;if(d&&(h=q.getValueOrUndefined(a._position,t,S7e),l=q.getValueOrUndefined(c._text,t),d=f(h)&&f(l)),!d){_9(s,a,i);continue}q.isConstant(a._position)||(i._clusterDirty=!0);let _=!1,y=q.getValueOrDefault(c._heightReference,t,T7e);f(u)||(u=i.getLabel(a),u.id=a,s.label=u,_=m.equals(u.position,h)&&u.heightReference===y),u.show=!0,u.position=h,u.text=l,u.scale=q.getValueOrDefault(c._scale,t,f7e),u.font=q.getValueOrDefault(c._font,t,d7e),u.style=q.getValueOrDefault(c._style,t,h7e),u.fillColor=q.getValueOrDefault(c._fillColor,t,m7e,w7e),u.outlineColor=q.getValueOrDefault(c._outlineColor,t,p7e,D7e),u.outlineWidth=q.getValueOrDefault(c._outlineWidth,t,_7e),u.showBackground=q.getValueOrDefault(c._showBackground,t,g7e),u.backgroundColor=q.getValueOrDefault(c._backgroundColor,t,y7e,v7e),u.backgroundPadding=q.getValueOrDefault(c._backgroundPadding,t,A7e,P7e),u.pixelOffset=q.getValueOrDefault(c._pixelOffset,t,C7e,B7e),u.eyeOffset=q.getValueOrDefault(c._eyeOffset,t,x7e,I7e),u.heightReference=y,u.horizontalOrigin=q.getValueOrDefault(c._horizontalOrigin,t,E7e),u.verticalOrigin=q.getValueOrDefault(c._verticalOrigin,t,b7e),u.translucencyByDistance=q.getValueOrUndefined(c._translucencyByDistance,t,O7e),u.pixelOffsetScaleByDistance=q.getValueOrUndefined(c._pixelOffsetScaleByDistance,t,R7e),u.scaleByDistance=q.getValueOrUndefined(c._scaleByDistance,t,M7e),u.distanceDisplayCondition=q.getValueOrUndefined(c._distanceDisplayCondition,t,L7e),u.disableDepthTestDistance=q.getValueOrUndefined(c._disableDepthTestDistance,t),_&&u._updateClamping()}return!0};fg.prototype.getBoundingSphere=function(t,n){let i=this._items.get(t.id);if(!f(i)||!f(i.label))return rt.FAILED;let o=i.label;return n.center=m.clone(A(o._clampedPosition,o.position),n.center),n.radius=0,rt.DONE};fg.prototype.isDestroyed=function(){return!1};fg.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(fg.prototype._onCollectionChanged,this);let t=this._entityCollection.values;for(let n=0;n<t.length;n++)this._cluster.removeLabel(t[n]);return ue(this)};fg.prototype._onCollectionChanged=function(t,n,i,o){let r,s,a=this._items,c=this._cluster;for(r=n.length-1;r>-1;r--)s=n[r],f(s._label)&&f(s._position)&&a.set(s.id,new Yae(s));for(r=o.length-1;r>-1;r--)s=o[r],f(s._label)&&f(s._position)?a.contains(s.id)||a.set(s.id,new Yae(s)):(_9(a.get(s.id),s,c),a.remove(s.id));for(r=i.length-1;r>-1;r--)s=i[r],_9(a.get(s.id),s,c),a.remove(s.id)};function _9(t,n,i){f(t)&&(t.label=void 0,i.removeLabel(n))}var JN=fg;function F7e(t,n,i){return t.readyPromise.then(function(){return k7e(t,n,i)})}function N7e(t,n){let i=t[0],o=i.terrainProvider.requestTileGeometry(i.x,i.y,i.level);if(!o)return!1;let r=o.then(U7e(i)).catch(z7e(i));return t.shift(),n.push(r),!0}function V7e(t){return new Promise(function(n){setTimeout(n,t)})}function g9(t,n){return t.length?N7e(t,n)?g9(t,n):V7e(100).then(()=>g9(t,n)):Promise.resolve()}function k7e(t,n,i){let o=t.tilingScheme,r,s=[],a={};for(r=0;r<i.length;++r){let l=o.positionToTileXY(i[r],n),u=l.toString();if(!a.hasOwnProperty(u)){let d={x:l.x,y:l.y,level:n,tilingScheme:o,terrainProvider:t,positions:[]};a[u]=d,s.push(d)}a[u].positions.push(i[r])}let c=[];return g9(s,c).then(function(){return Promise.all(c).then(function(){return i})})}function Xae(t,n,i){let o=n.interpolateHeight(i,t.longitude,t.latitude);return o===void 0?!1:(t.height=o,!0)}function U7e(t){let n=t.positions,i=t.tilingScheme.tileXYToRectangle(t.x,t.y,t.level);return function(o){let r=!1;for(let s=0;s<n.length;++s){let a=n[s];if(!Xae(a,o,i)){r=!0;break}}return r?o.createMesh({tilingScheme:t.tilingScheme,x:t.x,y:t.y,level:t.level,throttle:!1}).then(function(){for(let s=0;s<n.length;++s){let a=n[s];Xae(a,o,i)}}):Promise.resolve()}}function z7e(t){let n=t.positions;return function(){for(let i=0;i<n.length;++i){let o=n[i];o.height=void 0}}}var ZN=F7e;var y9=new W;function Kae(t,n){return t.readyPromise.then(function(){let i=[],o=[],r=t.availability,s=[];for(let a=0;a<n.length;++a){let c=n[a],l=r.computeMaximumLevelAtPosition(c);if(o[a]=l,l===0){t.tilingScheme.positionToTileXY(c,1,y9);let d=t.loadTileDataAvailability(y9.x,y9.y,1);f(d)&&s.push(d)}let u=i[l];f(u)||(i[l]=u=[]),u.push(c)}return Promise.all(s).then(function(){return Promise.all(i.map(function(a,c){if(f(a))return ZN(t,c,a)}))}).then(function(){let a=[];for(let c=0;c<n.length;++c){let l=n[c];r.computeMaximumLevelAtPosition(l)!==o[c]&&a.push(l)}if(a.length>0)return Kae(t,a)}).then(function(){return n})})}var dg=Kae;var H7e=1,G7e=0,W7e=!0,j7e=!0,q7e=gn.ENABLED,Y7e=Ge.NONE,X7e=z.RED,K7e=0,J7e=z.WHITE,Z7e=oc.HIGHLIGHT,Q7e=.5,$7e=new W(1,1),eje=new N,tje=new N,Jae=new z;function Sh(t,n){n.collectionChanged.addEventListener(Sh.prototype._onCollectionChanged,this),this._scene=t,this._primitives=t.primitives,this._entityCollection=n,this._modelHash={},this._entitiesToVisualize=new yt,this._onCollectionChanged(n,n.values,[],[])}Sh.prototype.update=function(t){let n=this._entitiesToVisualize.values,i=this._modelHash,o=this._primitives;for(let r=0,s=n.length;r<s;r++){let a=n[r],c=a._model,l,u=i[a.id],d=a.isShowing&&a.isAvailable(t)&&q.getValueOrDefault(c._show,t,!0),h;if(d&&(h=a.computeModelMatrix(t,eje),l=Ie.createIfNeeded(q.getValueOrUndefined(c._uri,t)),d=f(h)&&f(l)),!d){f(u)&&(u.modelPrimitive.show=!1);continue}let _=f(u)?u.modelPrimitive:void 0;if((!f(_)||l.url!==u.url)&&(f(_)&&(o.removeAndDestroy(_),delete i[a.id]),_=Au.fromGltf({url:l,incrementallyLoadTextures:q.getValueOrDefault(c._incrementallyLoadTextures,t,W7e),scene:this._scene}),_.id=a,o.add(_),u={modelPrimitive:_,url:l.url,animationsRunning:!1,nodeTransformationsScratch:{},articulationsScratch:{},loadFail:!1,awaitingSampleTerrain:!1,clampedBoundingSphere:void 0,sampleTerrainFailed:!1},i[a.id]=u,ije(_,a,i)),_.show=!0,_.scale=q.getValueOrDefault(c._scale,t,H7e),_.minimumPixelSize=q.getValueOrDefault(c._minimumPixelSize,t,G7e),_.maximumScale=q.getValueOrUndefined(c._maximumScale,t),_.modelMatrix=N.clone(h,_.modelMatrix),_.shadows=q.getValueOrDefault(c._shadows,t,q7e),_.heightReference=q.getValueOrDefault(c._heightReference,t,Y7e),_.distanceDisplayCondition=q.getValueOrUndefined(c._distanceDisplayCondition,t),_.silhouetteColor=q.getValueOrDefault(c._silhouetteColor,t,X7e,Jae),_.silhouetteSize=q.getValueOrDefault(c._silhouetteSize,t,K7e),_.color=q.getValueOrDefault(c._color,t,J7e,Jae),_.colorBlendMode=q.getValueOrDefault(c._colorBlendMode,t,Z7e),_.colorBlendAmount=q.getValueOrDefault(c._colorBlendAmount,t,Q7e),_.clippingPlanes=q.getValueOrUndefined(c._clippingPlanes,t),_.clampAnimations=q.getValueOrDefault(c._clampAnimations,t,j7e),_.imageBasedLighting.imageBasedLightingFactor=q.getValueOrDefault(c._imageBasedLightingFactor,t,$7e),_.lightColor=q.getValueOrUndefined(c._lightColor,t),_.customShader=q.getValueOrUndefined(c._customShader,t),_.ready){let y=q.getValueOrDefault(c._runAnimations,t,!0);u.animationsRunning!==y&&(y?_.activeAnimations.addAll({loop:ac.REPEAT}):_.activeAnimations.removeAll(),u.animationsRunning=y);let p=q.getValueOrUndefined(c._nodeTransformations,t,u.nodeTransformationsScratch);if(f(p)){let T=Object.keys(p);for(let E=0,S=T.length;E<S;++E){let w=T[E],D=p[w];if(!f(D))continue;let I=_.getNode(w);if(!f(I))continue;let O=N.fromTranslationRotationScale(D,tje);I.matrix=N.multiply(I.originalMatrix,O,O)}}let C=!1,x=q.getValueOrUndefined(c._articulations,t,u.articulationsScratch);if(f(x)){let T=Object.keys(x);for(let E=0,S=T.length;E<S;++E){let w=T[E],D=x[w];!f(D)||(C=!0,_.setArticulationStage(w,D))}}C&&_.applyArticulations()}}return!0};Sh.prototype.isDestroyed=function(){return!1};Sh.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(Sh.prototype._onCollectionChanged,this);let t=this._entitiesToVisualize.values,n=this._modelHash,i=this._primitives;for(let o=t.length-1;o>-1;o--)A9(this,t[o],n,i);return ue(this)};Sh._sampleTerrainMostDetailed=dg;var jT=new m,Zae=new de;Sh.prototype.getBoundingSphere=function(t,n){let i=this._modelHash[t.id];if(!f(i)||i.loadFail)return rt.FAILED;let o=i.modelPrimitive;if(!f(o)||!o.show)return rt.FAILED;if(!o.ready)return rt.PENDING;let s=this._scene.globe,a=s.ellipsoid,c=s.terrainProvider;if(o.heightReference!==Ge.NONE){if(!c.ready)return rt.PENDING;let u=o.modelMatrix;jT.x=u[12],jT.y=u[13],jT.z=u[14];let d=a.cartesianToCartographic(jT);if(!f(c.availability)){o.heightReference===Ge.CLAMP_TO_GROUND&&(d.height=0);let y=a.cartographicToCartesian(d);return ae.clone(o.boundingSphere,n),n.center=y,rt.DONE}let h=this._modelHash[t.id].clampedBoundingSphere;return this._modelHash[t.id].sampleTerrainFailed?(this._modelHash[t.id].sampleTerrainFailed=!1,rt.FAILED):f(h)?(ae.clone(h,n),this._modelHash[t.id].clampedBoundingSphere=void 0,rt.DONE):(h=new ae,this._modelHash[t.id].awaitingSampleTerrain||(de.clone(d,Zae),this._modelHash[t.id].awaitingSampleTerrain=!0,Sh._sampleTerrainMostDetailed(c,[Zae]).then(p=>{this._modelHash[t.id].awaitingSampleTerrain=!1;let C=p[0];o.heightReference===Ge.RELATIVE_TO_GROUND&&(C.height+=d.height),a.cartographicToCartesian(C,jT),ae.clone(o.boundingSphere,h),h.center=jT,this._modelHash[t.id].clampedBoundingSphere=ae.clone(h)}).catch(p=>{this._modelHash[t.id].sampleTerrainFailed=!0,this._modelHash[t.id].awaitingSampleTerrain=!1})),rt.PENDING)}return ae.clone(o.boundingSphere,n),rt.DONE};Sh.prototype._onCollectionChanged=function(t,n,i,o){let r,s,a=this._entitiesToVisualize,c=this._modelHash,l=this._primitives;for(r=n.length-1;r>-1;r--)s=n[r],f(s._model)&&f(s._position)&&a.set(s.id,s);for(r=o.length-1;r>-1;r--)s=o[r],f(s._model)&&f(s._position)?(nje(s,c),a.set(s.id,s)):(A9(this,s,c,l),a.remove(s.id));for(r=i.length-1;r>-1;r--)s=i[r],A9(this,s,c,l),a.remove(s.id)};function A9(t,n,i,o){let r=i[n.id];f(r)&&(o.removeAndDestroy(r.modelPrimitive),delete i[n.id])}function nje(t,n){let i=n[t.id];f(i)&&(i.nodeTransformationsScratch={},i.articulationsScratch={})}function ije(t,n,i){t.readyPromise.catch(function(o){console.error(o),i[n.id].loadFail=!0})}var QN=Sh;function hg(t){this._definitionChanged=new Ae,this._value=void 0,this._removeSubscription=void 0,this.setValue(t)}Object.defineProperties(hg.prototype,{isConstant:{get:function(){return q.isConstant(this._value)}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){return f(this._value)?this._value.referenceFrame:no.FIXED}}});hg.prototype.getValue=function(t,n){return this.getValueInReferenceFrame(t,no.FIXED,n)};hg.prototype.setValue=function(t){this._value!==t&&(this._value=t,f(this._removeSubscription)&&(this._removeSubscription(),this._removeSubscription=void 0),f(t)&&(this._removeSubscription=t.definitionChanged.addEventListener(this._raiseDefinitionChanged,this)),this._definitionChanged.raiseEvent(this))};hg.prototype.getValueInReferenceFrame=function(t,n,i){if(!!f(this._value))return i=this._value.getValueInReferenceFrame(t,n,i),f(i)?oe.WGS84.scaleToGeodeticSurface(i,i):void 0};hg.prototype.equals=function(t){return this===t||t instanceof hg&&this._value===t._value};hg.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)};var hp=hg;var oje=60,rje=1,ece=new xn,C9=new xn,x9=new xn;function Qae(t){this.entity=t,this.polyline=void 0,this.index=void 0,this.updater=void 0}function sje(t,n,i,o,r,s,a,c,l){let u=c,d;d=t.getValueInReferenceFrame(n,s,l[u]),f(d)&&(l[u++]=d);let h=!f(r)||te.lessThanOrEquals(r,n)||te.greaterThanOrEquals(r,i),_=0,y=o.length,p=o[_],C=i,x=!1,T,E,S;for(;_<y;){if(!h&&te.greaterThanOrEquals(p,r)&&(d=t.getValueInReferenceFrame(r,s,l[u]),f(d)&&(l[u++]=d),h=!0),te.greaterThan(p,n)&&te.lessThan(p,C)&&!p.equals(r)&&(d=t.getValueInReferenceFrame(p,s,l[u]),f(d)&&(l[u++]=d)),_<y-1){if(a>0&&!x){let w=o[_+1],D=te.secondsDifference(w,p);x=D>a,x&&(T=Math.ceil(D/a),E=0,S=D/Math.max(T,2),T=Math.max(T-1,1))}if(x&&E<T){p=te.addSeconds(p,S,new te),E++;continue}}x=!1,_++,p=o[_]}return d=t.getValueInReferenceFrame(i,s,l[u]),f(d)&&(l[u++]=d),u}function aje(t,n,i,o,r,s,a,c){let l,u=0,d=a,h=n,_=Math.max(s,60),y=!f(o)||te.lessThanOrEquals(o,n)||te.greaterThanOrEquals(o,i);for(;te.lessThan(h,i);)!y&&te.greaterThanOrEquals(h,o)&&(y=!0,l=t.getValueInReferenceFrame(o,r,c[d]),f(l)&&(c[d]=l,d++)),l=t.getValueInReferenceFrame(h,r,c[d]),f(l)&&(c[d]=l,d++),u++,h=te.addSeconds(n,_*u,new te);return l=t.getValueInReferenceFrame(i,r,c[d]),f(l)&&(c[d]=l,d++),d}function cje(t,n,i,o,r,s,a,c){x9.start=n,x9.stop=i;let l=a,u=t.intervals;for(let d=0;d<u.length;d++){let h=u.get(d);if(!xn.intersect(h,x9,ece).isEmpty){let _=h.start;h.isStartIncluded||(h.isStopIncluded?_=h.stop:_=te.addSeconds(h.start,te.secondsDifference(h.stop,h.start)/2,new te));let y=t.getValueInReferenceFrame(_,r,c[l]);f(y)&&(c[l]=y,l++)}}return l}function lje(t,n,i,o,r,s,a,c){let l=t.getValueInReferenceFrame(n,r,c[a]);return f(l)&&(c[a++]=l),a}function uje(t,n,i,o,r,s,a,c){C9.start=n,C9.stop=i;let l=a,u=t.intervals;for(let d=0;d<u.length;d++){let h=u.get(d);if(!xn.intersect(h,C9,ece).isEmpty){let _=h.start,y=h.stop,p=n;te.greaterThan(_,p)&&(p=_);let C=i;te.lessThan(y,C)&&(C=y),l=tce(h.data,p,C,o,r,s,l,c)}}return l}function tce(t,n,i,o,r,s,a,c){for(;t instanceof ng;)t=t.resolvedProperty;if(t instanceof oa){let l=t._property._times;a=sje(t,n,i,l,o,r,s,a,c)}else t instanceof ia?a=uje(t,n,i,o,r,s,a,c):t instanceof og?a=cje(t,n,i,o,r,s,a,c):t instanceof Jc||t instanceof hp&&q.isConstant(t)?a=lje(t,n,i,o,r,s,a,c):a=aje(t,n,i,o,r,s,a,c);return a}function nce(t,n,i,o,r,s,a){f(a)||(a=[]);let c=tce(t,n,i,o,r,s,0,a);return a.length=c,a}var $ae=new $;function lD(t,n){this._unusedIndexes=[],this._polylineCollection=new M_,this._scene=t,this._referenceFrame=n,t.primitives.add(this._polylineCollection)}lD.prototype.update=function(t){if(this._referenceFrame===no.INERTIAL){let n=vt.computeIcrfToFixedMatrix(t,$ae);f(n)||(n=vt.computeTemeToPseudoFixedMatrix(t,$ae)),N.fromRotationTranslation(n,m.ZERO,this._polylineCollection.modelMatrix)}};lD.prototype.updateObject=function(t,n){let i=n.entity,o=i._path,r=i._position,s,a,c=o._show,l=n.polyline,u=i.isShowing&&i.isAvailable(t)&&(!f(c)||c.getValue(t));if(u){let h=q.getValueOrUndefined(o._leadTime,t),_=q.getValueOrUndefined(o._trailTime,t),y=i._availability,p=f(y),C=f(h),x=f(_);if(u=p||C&&x,u){if(x&&(s=te.addSeconds(t,-_,new te)),C&&(a=te.addSeconds(t,h,new te)),p){let T=y.start,E=y.stop;(!x||te.greaterThan(T,s))&&(s=T),(!C||te.lessThan(E,a))&&(a=E)}u=te.lessThan(s,a)}}if(!u){f(l)&&(this._unusedIndexes.push(n.index),n.polyline=void 0,l.show=!1,n.index=void 0);return}if(!f(l)){let h=this._unusedIndexes;if(h.length>0){let y=h.pop();l=this._polylineCollection.get(y),n.index=y}else n.index=this._polylineCollection.length,l=this._polylineCollection.add();l.id=i,n.polyline=l}let d=q.getValueOrDefault(o._resolution,t,oje);l.show=!0,l.positions=nce(r,s,a,t,this._referenceFrame,d,l.positions.slice()),l.material=Zo.getValue(t,o._material,l.material),l.width=q.getValueOrDefault(o._width,t,rje),l.distanceDisplayCondition=q.getValueOrUndefined(o._distanceDisplayCondition,t,l.distanceDisplayCondition)};lD.prototype.removeObject=function(t){let n=t.polyline;f(n)&&(this._unusedIndexes.push(t.index),t.polyline=void 0,n.show=!1,n.id=void 0,t.index=void 0)};lD.prototype.destroy=function(){return this._scene.primitives.remove(this._polylineCollection),ue(this)};function mg(t,n){n.collectionChanged.addEventListener(mg.prototype._onCollectionChanged,this),this._scene=t,this._updaters={},this._entityCollection=n,this._items=new yt,this._onCollectionChanged(n,n.values,[],[])}mg.prototype.update=function(t){let n=this._updaters;for(let o in n)n.hasOwnProperty(o)&&n[o].update(t);let i=this._items.values;if(i.length===0&&f(this._updaters)&&Object.keys(this._updaters).length>0){for(let o in n)n.hasOwnProperty(o)&&n[o].destroy();this._updaters={}}for(let o=0,r=i.length;o<r;o++){let s=i[o],c=s.entity._position,l=s.updater,u=no.FIXED;this._scene.mode===ne.SCENE3D&&(u=c.referenceFrame);let d=this._updaters[u];if(l===d&&f(d)){d.updateObject(t,s);continue}f(l)&&l.removeObject(s),f(d)||(d=new lD(this._scene,u),d.update(t),this._updaters[u]=d),s.updater=d,f(d)&&d.updateObject(t,s)}return!0};mg.prototype.isDestroyed=function(){return!1};mg.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(mg.prototype._onCollectionChanged,this);let t=this._updaters;for(let n in t)t.hasOwnProperty(n)&&t[n].destroy();return ue(this)};mg.prototype._onCollectionChanged=function(t,n,i,o){let r,s,a,c=this._items;for(r=n.length-1;r>-1;r--)s=n[r],f(s._path)&&f(s._position)&&c.set(s.id,new Qae(s));for(r=o.length-1;r>-1;r--)s=o[r],f(s._path)&&f(s._position)?c.contains(s.id)||c.set(s.id,new Qae(s)):(a=c.get(s.id),f(a)&&(f(a.updater)&&a.updater.removeObject(a),c.remove(s.id)));for(r=i.length-1;r>-1;r--)s=i[r],a=c.get(s.id),f(a)&&(f(a.updater)&&a.updater.removeObject(a),c.remove(s.id))};mg._subSample=nce;var $N=mg;var ice=z.WHITE,oce=z.BLACK,rce=0,sce=1,ace=0,cce=new z,fje=new m,lce=new z,uce=new Pt,fce=new Pt,dce=new wt;function hce(t){this.entity=t,this.pointPrimitive=void 0,this.billboard=void 0,this.color=void 0,this.outlineColor=void 0,this.pixelSize=void 0,this.outlineWidth=void 0}function pg(t,n){n.collectionChanged.addEventListener(pg.prototype._onCollectionChanged,this),this._cluster=t,this._entityCollection=n,this._items=new yt,this._onCollectionChanged(n,n.values,[],[])}pg.prototype.update=function(t){let n=this._items.values,i=this._cluster;for(let o=0,r=n.length;o<r;o++){let s=n[o],a=s.entity,c=a._point,l=s.pointPrimitive,u=s.billboard,d=q.getValueOrDefault(c._heightReference,t,Ge.NONE),h=a.isShowing&&a.isAvailable(t)&&q.getValueOrDefault(c._show,t,!0),_;if(h&&(_=q.getValueOrUndefined(a._position,t,fje),h=f(_)),!h){uD(s,a,i);continue}q.isConstant(a._position)||(i._clusterDirty=!0);let y=!1,p=!1;if(d!==Ge.NONE&&!f(u)?(f(l)&&(uD(s,a,i),l=void 0),u=i.getBillboard(a),u.id=a,u.image=void 0,s.billboard=u,y=!0,p=m.equals(u.position,_)&&u.heightReference===d):d===Ge.NONE&&!f(l)&&(f(u)&&(uD(s,a,i),u=void 0),l=i.getPoint(a),l.id=a,s.pointPrimitive=l),f(l))l.show=!0,l.position=_,l.scaleByDistance=q.getValueOrUndefined(c._scaleByDistance,t,uce),l.translucencyByDistance=q.getValueOrUndefined(c._translucencyByDistance,t,fce),l.color=q.getValueOrDefault(c._color,t,ice,cce),l.outlineColor=q.getValueOrDefault(c._outlineColor,t,oce,lce),l.outlineWidth=q.getValueOrDefault(c._outlineWidth,t,rce),l.pixelSize=q.getValueOrDefault(c._pixelSize,t,sce),l.distanceDisplayCondition=q.getValueOrUndefined(c._distanceDisplayCondition,t,dce),l.disableDepthTestDistance=q.getValueOrDefault(c._disableDepthTestDistance,t,ace);else if(f(u)){u.show=!0,u.position=_,u.scaleByDistance=q.getValueOrUndefined(c._scaleByDistance,t,uce),u.translucencyByDistance=q.getValueOrUndefined(c._translucencyByDistance,t,fce),u.distanceDisplayCondition=q.getValueOrUndefined(c._distanceDisplayCondition,t,dce),u.disableDepthTestDistance=q.getValueOrDefault(c._disableDepthTestDistance,t,ace),u.heightReference=d;let C=q.getValueOrDefault(c._color,t,ice,cce),x=q.getValueOrDefault(c._outlineColor,t,oce,lce),T=Math.round(q.getValueOrDefault(c._outlineWidth,t,rce)),E=Math.max(1,Math.round(q.getValueOrDefault(c._pixelSize,t,sce)));if(T>0?(u.scale=1,y=y||T!==s.outlineWidth||E!==s.pixelSize||!z.equals(C,s.color)||!z.equals(x,s.outlineColor)):(u.scale=E/50,E=50,y=y||T!==s.outlineWidth||!z.equals(C,s.color)||!z.equals(x,s.outlineColor)),y){s.color=z.clone(C,s.color),s.outlineColor=z.clone(x,s.outlineColor),s.pixelSize=E,s.outlineWidth=T;let S=C.alpha,w=C.toCssColorString(),D=x.toCssColorString(),I=JSON.stringify([w,E,D,T]);u.setImage(I,Ix(S,w,D,T,E))}p&&u._updateClamping()}}return!0};pg.prototype.getBoundingSphere=function(t,n){let i=this._items.get(t.id);if(!f(i)||!(f(i.pointPrimitive)||f(i.billboard)))return rt.FAILED;if(f(i.pointPrimitive))n.center=m.clone(i.pointPrimitive.position,n.center);else{let o=i.billboard;if(!f(o._clampedPosition))return rt.PENDING;n.center=m.clone(o._clampedPosition,n.center)}return n.radius=0,rt.DONE};pg.prototype.isDestroyed=function(){return!1};pg.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(pg.prototype._onCollectionChanged,this);let t=this._entityCollection.values;for(let n=0;n<t.length;n++)this._cluster.removePoint(t[n]);return ue(this)};pg.prototype._onCollectionChanged=function(t,n,i,o){let r,s,a=this._items,c=this._cluster;for(r=n.length-1;r>-1;r--)s=n[r],f(s._point)&&f(s._position)&&a.set(s.id,new hce(s));for(r=o.length-1;r>-1;r--)s=o[r],f(s._point)&&f(s._position)?a.contains(s.id)||a.set(s.id,new hce(s)):(uD(a.get(s.id),s,c),a.remove(s.id));for(r=i.length-1;r>-1;r--)s=i[r],uD(a.get(s.id),s,c),a.remove(s.id)};function uD(t,n,i){if(f(t)){let o=t.pointPrimitive;if(f(o)){t.pointPrimitive=void 0,i.removePoint(n);return}let r=t.billboard;f(r)&&(t.billboard=void 0,i.removeBillboard(n))}}var e2=pg;var yce=[];function dje(t,n,i,o,r){let s=yce;s.length=r;let a,c=i.red,l=i.green,u=i.blue,d=i.alpha,h=o.red,_=o.green,y=o.blue,p=o.alpha;if(z.equals(i,o)){for(a=0;a<r;a++)s[a]=z.clone(i);return s}let C=(h-c)/r,x=(_-l)/r,T=(y-u)/r,E=(p-d)/r;for(a=0;a<r;a++)s[a]=new z(c+a*C,l+a*x,u+a*T,d+a*E);return s}function fD(t){t=A(t,A.EMPTY_OBJECT);let n=t.positions,i=t.colors,o=A(t.width,1),r=A(t.colorsPerVertex,!1);this._positions=n,this._colors=i,this._width=o,this._colorsPerVertex=r,this._vertexFormat=De.clone(A(t.vertexFormat,De.DEFAULT)),this._arcType=A(t.arcType,Zt.GEODESIC),this._granularity=A(t.granularity,B.RADIANS_PER_DEGREE),this._ellipsoid=oe.clone(A(t.ellipsoid,oe.WGS84)),this._workerName="createPolylineGeometry";let s=1+n.length*m.packedLength;s+=f(i)?1+i.length*z.packedLength:1,this.packedLength=s+oe.packedLength+De.packedLength+4}fD.pack=function(t,n,i){i=A(i,0);let o,r=t._positions,s=r.length;for(n[i++]=s,o=0;o<s;++o,i+=m.packedLength)m.pack(r[o],n,i);let a=t._colors;for(s=f(a)?a.length:0,n[i++]=s,o=0;o<s;++o,i+=z.packedLength)z.pack(a[o],n,i);return oe.pack(t._ellipsoid,n,i),i+=oe.packedLength,De.pack(t._vertexFormat,n,i),i+=De.packedLength,n[i++]=t._width,n[i++]=t._colorsPerVertex?1:0,n[i++]=t._arcType,n[i]=t._granularity,n};var Ace=oe.clone(oe.UNIT_SPHERE),Cce=new De,Gy={positions:void 0,colors:void 0,ellipsoid:Ace,vertexFormat:Cce,width:void 0,colorsPerVertex:void 0,arcType:void 0,granularity:void 0};fD.unpack=function(t,n,i){n=A(n,0);let o,r=t[n++],s=new Array(r);for(o=0;o<r;++o,n+=m.packedLength)s[o]=m.unpack(t,n);r=t[n++];let a=r>0?new Array(r):void 0;for(o=0;o<r;++o,n+=z.packedLength)a[o]=z.unpack(t,n);let c=oe.unpack(t,n,Ace);n+=oe.packedLength;let l=De.unpack(t,n,Cce);n+=De.packedLength;let u=t[n++],d=t[n++]===1,h=t[n++],_=t[n];return f(i)?(i._positions=s,i._colors=a,i._ellipsoid=oe.clone(c,i._ellipsoid),i._vertexFormat=De.clone(l,i._vertexFormat),i._width=u,i._colorsPerVertex=d,i._arcType=h,i._granularity=_,i):(Gy.positions=s,Gy.colors=a,Gy.width=u,Gy.colorsPerVertex=d,Gy.arcType=h,Gy.granularity=_,new fD(Gy))};var mce=new m,pce=new m,_ce=new m,gce=new m;fD.createGeometry=function(t){let n=t._width,i=t._vertexFormat,o=t._colors,r=t._colorsPerVertex,s=t._arcType,a=t._granularity,c=t._ellipsoid,l,u,d,h=[],_=Co(t._positions,m.equalsEpsilon,!1,h);if(f(o)&&h.length>0){let R=0,V=h[0];o=o.filter(function(H,U){let G=!1;return r?G=U===V||U===0&&V===1:G=U+1===V,G?(R++,V=h[R],!1):!0})}let y=_.length;if(y<2||n<=0)return;if(s===Zt.GEODESIC||s===Zt.RHUMB){let R,V;s===Zt.GEODESIC?(R=B.chordLength(a,c.maximumRadius),V=Si.numberOfPoints):(R=a,V=Si.numberOfPointsRhumbLine);let H=Si.extractHeights(_,c);if(f(o)){let U=1;for(l=0;l<y-1;++l)U+=V(_[l],_[l+1],R);let G=new Array(U),k=0;for(l=0;l<y-1;++l){let X=_[l],Y=_[l+1],K=o[l],j=V(X,Y,R);if(r&&l<U){let Z=o[l+1],Q=dje(X,Y,K,Z,j),me=Q.length;for(u=0;u<me;++u)G[k++]=Q[u]}else for(u=0;u<j;++u)G[k++]=z.clone(K)}G[k]=z.clone(o[o.length-1]),o=G,yce.length=0}s===Zt.GEODESIC?_=Si.generateCartesianArc({positions:_,minDistance:R,ellipsoid:c,height:H}):_=Si.generateCartesianRhumbArc({positions:_,granularity:R,ellipsoid:c,height:H})}y=_.length;let p=y*4-4,C=new Float64Array(p*3),x=new Float64Array(p*3),T=new Float64Array(p*3),E=new Float32Array(p*2),S=i.st?new Float32Array(p*2):void 0,w=f(o)?new Uint8Array(p*4):void 0,D=0,I=0,O=0,M=0,L;for(u=0;u<y;++u){u===0?(L=mce,m.subtract(_[0],_[1],L),m.add(_[0],L,L)):L=_[u-1],m.clone(L,_ce),m.clone(_[u],pce),u===y-1?(L=mce,m.subtract(_[y-1],_[y-2],L),m.add(_[y-1],L,L)):L=_[u+1],m.clone(L,gce);let R,V;f(w)&&(u!==0&&!r?R=o[u-1]:R=o[u],u!==y-1&&(V=o[u]));let H=u===0?2:0,U=u===y-1?2:4;for(d=H;d<U;++d){m.pack(pce,C,D),m.pack(_ce,x,D),m.pack(gce,T,D),D+=3;let G=d-2<0?-1:1;if(E[I++]=2*(d%2)-1,E[I++]=G*n,i.st&&(S[O++]=u/(y-1),S[O++]=Math.max(E[I-2],0)),f(w)){let k=d<2?R:V;w[M++]=z.floatToByte(k.red),w[M++]=z.floatToByte(k.green),w[M++]=z.floatToByte(k.blue),w[M++]=z.floatToByte(k.alpha)}}}let F=new cn;F.position=new we({componentDatatype:J.DOUBLE,componentsPerAttribute:3,values:C}),F.prevPosition=new we({componentDatatype:J.DOUBLE,componentsPerAttribute:3,values:x}),F.nextPosition=new we({componentDatatype:J.DOUBLE,componentsPerAttribute:3,values:T}),F.expandAndWidth=new we({componentDatatype:J.FLOAT,componentsPerAttribute:2,values:E}),i.st&&(F.st=new we({componentDatatype:J.FLOAT,componentsPerAttribute:2,values:S})),f(w)&&(F.color=new we({componentDatatype:J.UNSIGNED_BYTE,componentsPerAttribute:4,values:w,normalize:!0}));let g=Ne.createTypedArray(p,y*6-6),b=0,v=0,P=y-1;for(u=0;u<P;++u)g[v++]=b,g[v++]=b+2,g[v++]=b+1,g[v++]=b+1,g[v++]=b+2,g[v++]=b+3,b+=4;return new at({attributes:F,indices:g,primitiveType:Re.TRIANGLES,boundingSphere:ae.fromPoints(_),geometryType:yf.POLYLINES})};var _g=fD;var hje=new Kn(0),t2={},xce=new z,mje=new Rt(z.WHITE),pje=new Kn(!0),_je=new Kn(gn.DISABLED),gje=new Kn(new wt),yje=new Kn(Un.BOTH);function Aje(){this.vertexFormat=void 0,this.positions=void 0,this.width=void 0,this.arcType=void 0,this.granularity=void 0}function Cje(){this.positions=void 0,this.width=void 0,this.arcType=void 0,this.granularity=void 0}function od(t,n){this._entity=t,this._scene=n,this._entitySubscription=t.definitionChanged.addEventListener(od.prototype._onEntityPropertyChanged,this),this._fillEnabled=!1,this._dynamic=!1,this._geometryChanged=new Ae,this._showProperty=void 0,this._materialProperty=void 0,this._shadowsProperty=void 0,this._distanceDisplayConditionProperty=void 0,this._classificationTypeProperty=void 0,this._depthFailMaterialProperty=void 0,this._geometryOptions=new Aje,this._groundGeometryOptions=new Cje,this._id=`polyline-${t.id}`,this._clampToGround=!1,this._supportsPolylinesOnTerrain=Qo.supportsPolylinesOnTerrain(n),this._zIndex=0,this._onEntityPropertyChanged(t,"polyline",t.polyline,void 0)}Object.defineProperties(od.prototype,{id:{get:function(){return this._id}},entity:{get:function(){return this._entity}},fillEnabled:{get:function(){return this._fillEnabled}},hasConstantFill:{get:function(){return!this._fillEnabled||!f(this._entity.availability)&&q.isConstant(this._showProperty)}},fillMaterialProperty:{get:function(){return this._materialProperty}},depthFailMaterialProperty:{get:function(){return this._depthFailMaterialProperty}},outlineEnabled:{value:!1},hasConstantOutline:{value:!0},outlineColorProperty:{value:void 0},shadowsProperty:{get:function(){return this._shadowsProperty}},distanceDisplayConditionProperty:{get:function(){return this._distanceDisplayConditionProperty}},classificationTypeProperty:{get:function(){return this._classificationTypeProperty}},isDynamic:{get:function(){return this._dynamic}},isClosed:{value:!1},geometryChanged:{get:function(){return this._geometryChanged}},arcType:{get:function(){return this._arcType}},clampToGround:{get:function(){return this._clampToGround&&this._supportsPolylinesOnTerrain}},zIndex:{get:function(){return this._zIndex}}});od.prototype.isOutlineVisible=function(t){return!1};od.prototype.isFilled=function(t){let n=this._entity,i=this._fillEnabled&&n.isAvailable(t)&&this._showProperty.getValue(t);return A(i,!1)};od.prototype.createFillGeometryInstance=function(t){let n=this._entity,i=n.isAvailable(t),o=new mn(i&&n.isShowing&&this._showProperty.getValue(t)),r=this._distanceDisplayConditionProperty.getValue(t),s=Vn.fromDistanceDisplayCondition(r),a={show:o,distanceDisplayCondition:s},c;return this._materialProperty instanceof Rt&&(f(this._materialProperty.color)&&(this._materialProperty.color.isConstant||i)&&(c=this._materialProperty.color.getValue(t,xce)),f(c)||(c=z.WHITE),a.color=Lt.fromColor(c)),this.clampToGround?new Ct({id:n,geometry:new lx(this._groundGeometryOptions),attributes:a}):(f(this._depthFailMaterialProperty)&&this._depthFailMaterialProperty instanceof Rt&&(f(this._depthFailMaterialProperty.color)&&(this._depthFailMaterialProperty.color.isConstant||i)&&(c=this._depthFailMaterialProperty.color.getValue(t,xce)),f(c)||(c=z.WHITE),a.depthFailColor=Lt.fromColor(c)),new Ct({id:n,geometry:new _g(this._geometryOptions),attributes:a}))};od.prototype.createOutlineGeometryInstance=function(t){};od.prototype.isDestroyed=function(){return!1};od.prototype.destroy=function(){this._entitySubscription(),ue(this)};od.prototype._onEntityPropertyChanged=function(t,n,i,o){if(!(n==="availability"||n==="polyline"))return;let r=this._entity.polyline;if(!f(r)){this._fillEnabled&&(this._fillEnabled=!1,this._geometryChanged.raiseEvent(this));return}let s=r.positions,a=r.show;if(f(a)&&a.isConstant&&!a.getValue(Ue.MINIMUM_VALUE)||!f(s)){this._fillEnabled&&(this._fillEnabled=!1,this._geometryChanged.raiseEvent(this));return}let c=r.zIndex,l=A(r.material,mje),u=l instanceof Rt;this._materialProperty=l,this._depthFailMaterialProperty=r.depthFailMaterial,this._showProperty=A(a,pje),this._shadowsProperty=A(r.shadows,_je),this._distanceDisplayConditionProperty=A(r.distanceDisplayCondition,gje),this._classificationTypeProperty=A(r.classificationType,yje),this._fillEnabled=!0,this._zIndex=A(c,hje);let d=r.width,h=r.arcType,_=r.clampToGround,y=r.granularity;if(!s.isConstant||!q.isConstant(d)||!q.isConstant(h)||!q.isConstant(y)||!q.isConstant(_)||!q.isConstant(c))this._dynamic||(this._dynamic=!0,this._geometryChanged.raiseEvent(this));else{let p=this._geometryOptions,C=s.getValue(Ue.MINIMUM_VALUE,p.positions);if(!f(C)||C.length<2){this._fillEnabled&&(this._fillEnabled=!1,this._geometryChanged.raiseEvent(this));return}let x;u&&(!f(this._depthFailMaterialProperty)||this._depthFailMaterialProperty instanceof Rt)?x=Wr.VERTEX_FORMAT:x=na.VERTEX_FORMAT,p.vertexFormat=x,p.positions=C,p.width=f(d)?d.getValue(Ue.MINIMUM_VALUE):void 0,p.arcType=f(h)?h.getValue(Ue.MINIMUM_VALUE):void 0,p.granularity=f(y)?y.getValue(Ue.MINIMUM_VALUE):void 0;let T=this._groundGeometryOptions;T.positions=C,T.width=p.width,T.arcType=p.arcType,T.granularity=p.granularity,this._clampToGround=f(_)?_.getValue(Ue.MINIMUM_VALUE):!1,!this._clampToGround&&f(c)&&Bt("Entity polylines must have clampToGround: true when using zIndex.  zIndex will be ignored."),this._dynamic=!1,this._geometryChanged.raiseEvent(this)}};od.prototype.createDynamicUpdater=function(t,n){return new dD(t,n,this)};var qT={positions:void 0,granularity:void 0,height:void 0,ellipsoid:void 0};function dD(t,n,i){this._line=void 0,this._primitives=t,this._groundPrimitives=n,this._groundPolylinePrimitive=void 0,this._material=void 0,this._geometryUpdater=i,this._positions=[]}function Tce(t){if(f(t._line))return t._line;let n=t._geometryUpdater._scene.id,i=t2[n],o=t._primitives;!f(i)||i.isDestroyed()?(i=new M_,t2[n]=i,o.add(i)):o.contains(i)||o.add(i);let r=i.add();return r.id=t._geometryUpdater._entity,t._line=r,r}dD.prototype.update=function(t){let n=this._geometryUpdater,i=n._entity,o=i.polyline;if(o.isDynamic===!1)return;let r=o.positions,s=q.getValueOrUndefined(r,t,this._positions);n._clampToGround=q.getValueOrDefault(o._clampToGround,t,!1),n._groundGeometryOptions.positions=s,n._groundGeometryOptions.width=q.getValueOrDefault(o._width,t,1),n._groundGeometryOptions.arcType=q.getValueOrDefault(o._arcType,t,Zt.GEODESIC),n._groundGeometryOptions.granularity=q.getValueOrDefault(o._granularity,t,9999);let a=this._groundPrimitives;if(f(this._groundPolylinePrimitive)&&(a.remove(this._groundPolylinePrimitive),this._groundPolylinePrimitive=void 0),n.clampToGround){if(!i.isShowing||!i.isAvailable(t)||!q.getValueOrDefault(o._show,t,!0)||!f(s)||s.length<2)return;let d=n.fillMaterialProperty,h;if(d instanceof Rt)h=new Wr;else{let _=Zo.getValue(t,d,this._material);h=new na({material:_,translucent:_.isTranslucent()}),this._material=_}this._groundPolylinePrimitive=a.add(new eh({geometryInstances:n.createFillGeometryInstance(t),appearance:h,classificationType:n.classificationTypeProperty.getValue(t),asynchronous:!1}),q.getValueOrUndefined(n.zIndex,t)),f(this._line)&&(this._line.show=!1);return}let c=Tce(this);if(!i.isShowing||!i.isAvailable(t)||!q.getValueOrDefault(o._show,t,!0)){c.show=!1;return}if(!f(s)||s.length<2){c.show=!1;return}let l=Zt.GEODESIC;l=q.getValueOrDefault(o._arcType,t,l);let u=n._scene.globe;l!==Zt.NONE&&f(u)&&(qT.ellipsoid=u.ellipsoid,qT.positions=s,qT.granularity=q.getValueOrUndefined(o._granularity,t),qT.height=Si.extractHeights(s,u.ellipsoid),l===Zt.GEODESIC?s=Si.generateCartesianArc(qT):s=Si.generateCartesianRhumbArc(qT)),c.show=!0,c.positions=s.slice(),c.material=Zo.getValue(t,n.fillMaterialProperty,c.material),c.width=q.getValueOrDefault(o._width,t,1),c.distanceDisplayCondition=q.getValueOrUndefined(o._distanceDisplayCondition,t,c.distanceDisplayCondition)};dD.prototype.getBoundingSphere=function(t){if(this._geometryUpdater.clampToGround){let n=this._groundPolylinePrimitive;if(f(n)&&n.show&&n.ready){let i=n.getGeometryInstanceAttributes(this._geometryUpdater._entity);if(f(i)&&f(i.boundingSphere))return ae.clone(i.boundingSphere,t),rt.DONE}return f(n)&&!n.ready?rt.PENDING:rt.DONE}else{let n=Tce(this);if(n.show&&n.positions.length>0)return ae.fromPoints(n.positions,t),rt.DONE}return rt.FAILED};dD.prototype.isDestroyed=function(){return!1};dD.prototype.destroy=function(){let n=this._geometryUpdater._scene.id,i=t2[n];f(i)&&(i.remove(this._line),i.length===0&&(this._primitives.removeAndDestroy(i),delete t2[n])),f(this._groundPolylinePrimitive)&&this._groundPrimitives.remove(this._groundPolylinePrimitive),ue(this)};var n2=od;var xje=new z,Tje=new wt,Eje=new wt;function rd(t,n,i,o,r){let s;i instanceof Rt?s=Wr:s=na,this.orderedGroundPrimitives=t,this.classificationType=n,this.appearanceType=s,this.materialProperty=i,this.updaters=new yt,this.createPrimitive=!0,this.primitive=void 0,this.oldPrimitive=void 0,this.geometry=new yt,this.material=void 0,this.updatersWithAttributes=new yt,this.attributes=new yt,this.invalidated=!1,this.removeMaterialSubscription=i.definitionChanged.addEventListener(rd.prototype.onMaterialChanged,this),this.subscriptions=new yt,this.showsUpdated=new yt,this.zIndex=o,this._asynchronous=r}rd.prototype.onMaterialChanged=function(){this.invalidated=!0};rd.prototype.isMaterial=function(t){let n=this.materialProperty,i=t.fillMaterialProperty;return i===n||i instanceof Rt&&n instanceof Rt?!0:f(n)&&n.equals(i)};rd.prototype.add=function(t,n,i){let o=n.id;if(this.updaters.set(o,n),this.geometry.set(o,i),!n.hasConstantFill||!n.fillMaterialProperty.isConstant||!q.isConstant(n.distanceDisplayConditionProperty))this.updatersWithAttributes.set(o,n);else{let r=this;this.subscriptions.set(o,n.entity.definitionChanged.addEventListener(function(s,a,c,l){a==="isShowing"&&r.showsUpdated.set(n.id,n)}))}this.createPrimitive=!0};rd.prototype.remove=function(t){let n=t.id;if(this.createPrimitive=this.geometry.remove(n)||this.createPrimitive,this.updaters.remove(n)){this.updatersWithAttributes.remove(n);let i=this.subscriptions.get(n);return f(i)&&(i(),this.subscriptions.remove(n)),!0}return!1};rd.prototype.update=function(t){let n=!0,i=this.primitive,o=this.orderedGroundPrimitives,r=this.geometry.values,s;if(this.createPrimitive){if(r.length>0)f(i)&&(f(this.oldPrimitive)?o.remove(i):this.oldPrimitive=i),i=new eh({show:!1,asynchronous:this._asynchronous,geometryInstances:r.slice(),appearance:new this.appearanceType,classificationType:this.classificationType}),this.appearanceType===na&&(this.material=Zo.getValue(t,this.materialProperty,this.material),i.appearance.material=this.material),o.add(i,this.zIndex),n=!1;else{f(i)&&(o.remove(i),i=void 0);let c=this.oldPrimitive;f(c)&&(o.remove(c),this.oldPrimitive=void 0)}this.attributes.removeAll(),this.primitive=i,this.createPrimitive=!1}else if(f(i)&&i.ready){i.show=!0,f(this.oldPrimitive)&&(o.remove(this.oldPrimitive),this.oldPrimitive=void 0),this.appearanceType===na&&(this.material=Zo.getValue(t,this.materialProperty,this.material),this.primitive.appearance.material=this.material);let a=this.updatersWithAttributes.values,c=a.length;for(s=0;s<c;s++){let l=a[s],u=l.entity,d=this.geometry.get(l.id),h=this.attributes.get(d.id.id);if(f(h)||(h=i.getGeometryInstanceAttributes(d.id),this.attributes.set(d.id.id,h)),!l.fillMaterialProperty.isConstant){let C=l.fillMaterialProperty.color,x=q.getValueOrDefault(C,t,z.WHITE,xje);z.equals(h._lastColor,x)||(h._lastColor=z.clone(x,h._lastColor),h.color=Lt.toValue(x,h.color))}let _=u.isShowing&&(l.hasConstantFill||l.isFilled(t)),y=h.show[0]===1;_!==y&&(h.show=mn.toValue(_,h.show));let p=l.distanceDisplayConditionProperty;if(!q.isConstant(p)){let C=q.getValueOrDefault(p,t,Eje,Tje);wt.equals(C,h._lastDistanceDisplayCondition)||(h._lastDistanceDisplayCondition=wt.clone(C,h._lastDistanceDisplayCondition),h.distanceDisplayCondition=Vn.toValue(C,h.distanceDisplayCondition))}}this.updateShows(i)}else f(i)&&!i.ready&&(n=!1);return n};rd.prototype.updateShows=function(t){let n=this.showsUpdated.values,i=n.length;for(let o=0;o<i;o++){let r=n[o],s=r.entity,a=this.geometry.get(r.id),c=this.attributes.get(a.id.id);f(c)||(c=t.getGeometryInstanceAttributes(a.id),this.attributes.set(a.id.id,c));let l=s.isShowing,u=c.show[0]===1;l!==u&&(c.show=mn.toValue(l,c.show),a.attributes.show.value[0]=c.show[0])}this.showsUpdated.removeAll()};rd.prototype.contains=function(t){return this.updaters.contains(t.id)};rd.prototype.getBoundingSphere=function(t,n){let i=this.primitive;if(!i.ready)return rt.PENDING;let o=i.getGeometryInstanceAttributes(t.entity);return!f(o)||!f(o.boundingSphere)||f(o.show)&&o.show[0]===0?rt.FAILED:(o.boundingSphere.clone(n),rt.DONE)};rd.prototype.destroy=function(){let t=this.primitive,n=this.orderedGroundPrimitives;f(t)&&n.remove(t);let i=this.oldPrimitive;f(i)&&n.remove(i),this.removeMaterialSubscription()};function YT(t,n,i){this._items=[],this._orderedGroundPrimitives=t,this._classificationType=n,this._asynchronous=A(i,!0)}YT.prototype.add=function(t,n){let i=this._items,o=i.length,r=n.createFillGeometryInstance(t),s=q.getValueOrDefault(n.zIndex,0);for(let c=0;c<o;++c){let l=i[c];if(l.isMaterial(n)&&l.zIndex===s){l.add(t,n,r);return}}let a=new rd(this._orderedGroundPrimitives,this._classificationType,n.fillMaterialProperty,s,this._asynchronous);a.add(t,n,r),i.push(a)};YT.prototype.remove=function(t){let n=this._items,i=n.length;for(let o=i-1;o>=0;o--){let r=n[o];if(r.remove(t)){r.updaters.length===0&&(n.splice(o,1),r.destroy());break}}};YT.prototype.update=function(t){let n,i=this._items,o=i.length;for(n=o-1;n>=0;n--){let s=i[n];if(s.invalidated){i.splice(n,1);let a=s.updaters.values,c=a.length;for(let l=0;l<c;l++)this.add(t,a[l]);s.destroy()}}let r=!0;for(n=0;n<i.length;n++)r=i[n].update(t)&&r;return r};YT.prototype.getBoundingSphere=function(t,n){let i=this._items,o=i.length;for(let r=0;r<o;r++){let s=i[r];if(s.contains(t))return s.getBoundingSphere(t,n)}return rt.FAILED};YT.prototype.removeAllPrimitives=function(){let t=this._items,n=t.length;for(let i=0;i<n;i++)t[i].destroy();this._items.length=0};var i2=YT;var bje=[];function Ece(t,n){let i=t._batches,o=i.length;for(let r=0;r<o;r++)i[r].remove(n)}function bce(t,n,i){if(i.isDynamic){t._dynamicBatch.add(n,i);return}if(i.clampToGround&&i.fillEnabled){let a=i.classificationTypeProperty.getValue(n);t._groundBatches[a].add(n,i);return}let o;i.fillEnabled&&(o=i.shadowsProperty.getValue(n));let r=0;f(i.depthFailMaterialProperty)&&(r=i.depthFailMaterialProperty instanceof Rt?1:2);let s;f(o)&&(s=o+r*gn.NUMBER_OF_SHADOW_MODES),i.fillEnabled&&(i.fillMaterialProperty instanceof Rt?t._colorBatches[s].add(n,i):t._materialBatches[s].add(n,i))}function wh(t,n,i,o){o=A(o,t.groundPrimitives),i=A(i,t.primitives),this._scene=t,this._primitives=i,this._entityCollection=void 0,this._addedObjects=new yt,this._removedObjects=new yt,this._changedObjects=new yt;let r,s=gn.NUMBER_OF_SHADOW_MODES;for(this._colorBatches=new Array(s*3),this._materialBatches=new Array(s*3),r=0;r<s;++r)this._colorBatches[r]=new ed(i,Wr,void 0,!1,r),this._materialBatches[r]=new nd(i,na,void 0,!1,r),this._colorBatches[r+s]=new ed(i,Wr,Wr,!1,r),this._materialBatches[r+s]=new nd(i,na,Wr,!1,r),this._colorBatches[r+s*2]=new ed(i,Wr,na,!1,r),this._materialBatches[r+s*2]=new nd(i,na,na,!1,r);this._dynamicBatch=new CT(i,o);let a=Un.NUMBER_OF_CLASSIFICATION_TYPES;for(this._groundBatches=new Array(a),r=0;r<a;++r)this._groundBatches[r]=new i2(o,r);this._batches=this._colorBatches.concat(this._materialBatches,this._dynamicBatch,this._groundBatches),this._subscriptions=new yt,this._updaters=new yt,this._entityCollection=n,n.collectionChanged.addEventListener(wh.prototype._onCollectionChanged,this),this._onCollectionChanged(n,n.values,bje)}wh.prototype.update=function(t){let n=this._addedObjects,i=n.values,o=this._removedObjects,r=o.values,s=this._changedObjects,a=s.values,c,l,u,d;for(c=a.length-1;c>-1;c--)l=a[c],u=l.id,d=this._updaters.get(u),d.entity===l?(Ece(this,d),bce(this,t,d)):(r.push(l),i.push(l));for(c=r.length-1;c>-1;c--)l=r[c],u=l.id,d=this._updaters.get(u),Ece(this,d),d.destroy(),this._updaters.remove(u),this._subscriptions.get(u)(),this._subscriptions.remove(u);for(c=i.length-1;c>-1;c--)l=i[c],u=l.id,d=new n2(l,this._scene),this._updaters.set(u,d),bce(this,t,d),this._subscriptions.set(u,d.geometryChanged.addEventListener(wh._onGeometryChanged,this));n.removeAll(),o.removeAll(),s.removeAll();let h=!0,_=this._batches,y=_.length;for(c=0;c<y;c++)h=_[c].update(t)&&h;return h};var Sje=[],wje=new ae;wh.prototype.getBoundingSphere=function(t,n){let i=Sje,o=wje,r=0,s=rt.DONE,a=this._batches,c=a.length,l=this._updaters.get(t.id);for(let u=0;u<c;u++){if(s=a[u].getBoundingSphere(l,o),s===rt.PENDING)return rt.PENDING;s===rt.DONE&&(i[r]=ae.clone(o,i[r]),r++)}return r===0?rt.FAILED:(i.length=r,ae.fromBoundingSpheres(i,n),rt.DONE)};wh.prototype.isDestroyed=function(){return!1};wh.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(wh.prototype._onCollectionChanged,this),this._addedObjects.removeAll(),this._removedObjects.removeAll();let t,n=this._batches,i=n.length;for(t=0;t<i;t++)n[t].removeAllPrimitives();let o=this._subscriptions.values;for(i=o.length,t=0;t<i;t++)o[t]();return this._subscriptions.removeAll(),ue(this)};wh._onGeometryChanged=function(t){let n=this._removedObjects,i=this._changedObjects,o=t.entity,r=o.id;!f(n.get(r))&&!f(i.get(r))&&i.set(r,o)};wh.prototype._onCollectionChanged=function(t,n,i){let o=this._addedObjects,r=this._removedObjects,s=this._changedObjects,a,c,l;for(a=i.length-1;a>-1;a--)l=i[a],c=l.id,o.remove(c)||(r.set(c,l),s.remove(c));for(a=n.length-1;a>-1;a--)l=n[a],c=l.id,r.remove(c)?s.set(c,l):o.set(c,l)};var o2=wh;function Xu(t){Kc.initializeTerrainHeights(),eh.initializeTerrainHeights();let n=t.scene,i=t.dataSourceCollection;this._eventHelper=new Mr,this._eventHelper.add(i.dataSourceAdded,this._onDataSourceAdded,this),this._eventHelper.add(i.dataSourceRemoved,this._onDataSourceRemoved,this),this._eventHelper.add(i.dataSourceMoved,this._onDataSourceMoved,this),this._eventHelper.add(n.postRender,this._postRender,this),this._dataSourceCollection=i,this._scene=n,this._visualizersCallback=A(t.visualizersCallback,Xu.defaultVisualizersCallback);let o=!1,r=new Nl,s=new Nl;i.length>0&&(n.primitives.add(r),n.groundPrimitives.add(s),o=!0),this._primitives=r,this._groundPrimitives=s;for(let u=0,d=i.length;u<d;u++)this._onDataSourceAdded(i,i.get(u));let a=new eN;this._onDataSourceAdded(void 0,a),this._defaultDataSource=a;let c,l;if(!o){let u=this,d=function(){n.primitives.add(r),n.groundPrimitives.add(s),c(),l(),u._removeDefaultDataSourceListener=void 0,u._removeDataSourceCollectionListener=void 0};c=a.entities.collectionChanged.addEventListener(d),l=i.dataSourceAdded.addEventListener(d)}this._removeDefaultDataSourceListener=c,this._removeDataSourceCollectionListener=l,this._ready=!1}Xu.defaultVisualizersCallback=function(t,n,i){let o=i.entities;return[new vP(n,o),new KN(t,o,i._primitives,i._groundPrimitives),new JN(n,o),new QN(t,o),new kF(t,o),new e2(n,o),new $N(t,o),new o2(t,o,i._primitives,i._groundPrimitives)]};Object.defineProperties(Xu.prototype,{scene:{get:function(){return this._scene}},dataSources:{get:function(){return this._dataSourceCollection}},defaultDataSource:{get:function(){return this._defaultDataSource}},ready:{get:function(){return this._ready}}});Xu.prototype.isDestroyed=function(){return!1};Xu.prototype.destroy=function(){this._eventHelper.removeAll();let t=this._dataSourceCollection;for(let n=0,i=t.length;n<i;++n)this._onDataSourceRemoved(this._dataSourceCollection,t.get(n));return this._onDataSourceRemoved(void 0,this._defaultDataSource),f(this._removeDefaultDataSourceListener)?(this._removeDefaultDataSourceListener(),this._removeDataSourceCollectionListener()):(this._scene.primitives.remove(this._primitives),this._scene.groundPrimitives.remove(this._groundPrimitives)),ue(this)};Xu.prototype.update=function(t){if(!ri.initialized)return this._ready=!1,!1;let n=!0,i,o,r,s,a=this._dataSourceCollection,c=a.length;for(i=0;i<c;i++){let l=a.get(i);for(f(l.update)&&(n=l.update(t)&&n),r=l._visualizers,s=r.length,o=0;o<s;o++)n=r[o].update(t)&&n}for(r=this._defaultDataSource._visualizers,s=r.length,o=0;o<s;o++)n=r[o].update(t)&&n;return this._ready=n,n};Xu.prototype._postRender=function(){let t=this._scene.frameState,n=this._dataSourceCollection,i=n.length;for(let o=0;o<i;o++){let r=n.get(o),s=r.credit;f(s)&&t.creditDisplay.addCredit(s);let a=r._resourceCredits;if(f(a)){let c=a.length;for(let l=0;l<c;l++)t.creditDisplay.addCredit(a[l])}}};var Dje=[],vje=new ae;Xu.prototype.getBoundingSphere=function(t,n,i){if(!this._ready)return rt.PENDING;let o,r,s=this._defaultDataSource;if(!s.entities.contains(t)){s=void 0;let _=this._dataSourceCollection;for(r=_.length,o=0;o<r;o++){let y=_.get(o);if(y.entities.contains(t)){s=y;break}}}if(!f(s))return rt.FAILED;let a=Dje,c=vje,l=0,u=rt.DONE,d=s._visualizers,h=d.length;for(o=0;o<h;o++){let _=d[o];if(f(_.getBoundingSphere)){if(u=d[o].getBoundingSphere(t,c),!n&&u===rt.PENDING)return rt.PENDING;u===rt.DONE&&(a[l]=ae.clone(c,a[l]),l++)}}return l===0?rt.FAILED:(a.length=l,ae.fromBoundingSpheres(a,i),rt.DONE)};Xu.prototype._onDataSourceAdded=function(t,n){let i=this._scene,o=this._primitives,r=this._groundPrimitives,s=o.add(new Nl),a=r.add(new yN);n._primitives=s,n._groundPrimitives=a;let c=n.clustering;c._initialize(i),s.add(c),n._visualizers=this._visualizersCallback(i,c,n)};Xu.prototype._onDataSourceRemoved=function(t,n){let i=this._primitives,o=this._groundPrimitives,r=n._primitives,s=n._groundPrimitives,a=n.clustering;r.remove(a);let c=n._visualizers,l=c.length;for(let u=0;u<l;u++)c[u].destroy();i.remove(r),o.remove(s),n._visualizers=void 0};Xu.prototype._onDataSourceMoved=function(t,n,i){let o=this._primitives,r=this._groundPrimitives,s=t._primitives,a=t._groundPrimitives;n===i+1?(o.raise(s),r.raise(a)):n===i-1?(o.lower(s),r.lower(a)):n===0?(o.lowerToBottom(s),r.lowerToBottom(a),o.raise(s),r.raise(a)):(o.raiseToTop(s),r.raiseToTop(a))};var r2=Xu;function T9(t,n,i){this.heading=A(t,0),this.pitch=A(n,0),this.range=A(i,0)}T9.clone=function(t,n){if(!!f(t))return f(n)||(n=new T9),n.heading=t.heading,n.pitch=t.pitch,n.range=t.range,n};var Ku=T9;var Sce=new $,wce=new $,Dce=new $,Pje=new N,s2=new m,vce=new m,E9=new m,b9=new m,Pce=new m,Ice=new m,XT=new te,Ije=1.25;function Bje(t,n,i,o,r,s,a){let c=t.scene.mode,l=r.getValue(s,t._lastCartesian);if(f(l)){let u=!1,d=!1,h,_,y;if(c===ne.SCENE3D){te.addSeconds(s,.001,XT);let E=r.getValue(XT,s2);if(f(E)||(te.addSeconds(s,-.001,XT),E=r.getValue(XT,s2),d=!0),f(E)){let S=vt.computeFixedToIcrfMatrix(s,Sce),w=vt.computeFixedToIcrfMatrix(XT,wce),D;!f(S)||!f(w)?(D=vt.computeTemeToPseudoFixedMatrix(s,Dce),S=$.transpose(D,Sce),w=vt.computeTemeToPseudoFixedMatrix(XT,wce),$.transpose(w,w)):D=$.transpose(S,Dce);let I=$.multiplyByVector(S,l,Pce),O=$.multiplyByVector(w,E,Ice);m.subtract(I,O,b9);let M=m.magnitude(b9)*1e3,L=B.GRAVITATIONALPARAMETER,F=-L/(M*M-2*L/m.magnitude(I));F<0||F>Ije*a.maximumRadius?(h=vce,m.normalize(l,h),m.negate(h,h),y=m.clone(m.UNIT_Z,E9),_=m.cross(y,h,s2),m.magnitude(_)>B.EPSILON7&&(m.normalize(h,h),m.normalize(_,_),y=m.cross(h,_,E9),m.normalize(y,y),u=!0)):m.equalsEpsilon(l,E,B.EPSILON7)||(y=vce,m.normalize(I,y),m.normalize(O,O),_=m.cross(y,O,E9),d&&(_=m.multiplyByScalar(_,-1,_)),m.equalsEpsilon(_,m.ZERO,B.EPSILON7)||(h=m.cross(_,y,s2),$.multiplyByVector(D,h,h),$.multiplyByVector(D,_,_),$.multiplyByVector(D,y,y),m.normalize(h,h),m.normalize(_,_),m.normalize(y,y),u=!0))}}f(t.boundingSphere)&&(l=t.boundingSphere.center);let p,C,x;o&&(p=m.clone(n.position,b9),C=m.clone(n.direction,Pce),x=m.clone(n.up,Ice));let T=Pje;u?(T[0]=h.x,T[1]=h.y,T[2]=h.z,T[3]=0,T[4]=_.x,T[5]=_.y,T[6]=_.z,T[7]=0,T[8]=y.x,T[9]=y.y,T[10]=y.z,T[11]=0,T[12]=l.x,T[13]=l.y,T[14]=l.z,T[15]=0):vt.eastNorthUpToFixedFrame(l,a,T),n._setTransform(T),o&&(m.clone(p,n.position),m.clone(C,n.direction),m.clone(x,n.up),m.cross(C,x,n.right))}if(i){let u=c===ne.SCENE2D||m.equals(t._offset3D,m.ZERO)?void 0:t._offset3D;n.lookAtTransform(n.transform,u)}}function hD(t,n,i){this.entity=t,this.scene=n,this.ellipsoid=A(i,oe.WGS84),this.boundingSphere=void 0,this._lastEntity=void 0,this._mode=void 0,this._lastCartesian=new m,this._defaultOffset3D=void 0,this._offset3D=new m}Object.defineProperties(hD,{defaultOffset3D:{get:function(){return this._defaultOffset3D},set:function(t){this._defaultOffset3D=m.clone(t,new m)}}});hD.defaultOffset3D=new m(-14e3,3500,3500);var a2=new Ku,Oje=new m;hD.prototype.update=function(t,n){let i=this.scene,o=this.ellipsoid,r=i.mode;if(r===ne.MORPHING)return;let s=this.entity,a=s.position;if(!f(a))return;let c=s!==this._lastEntity,l=r!==this._mode,u=i.camera,d=c||l,h=!0;if(c){let _=s.viewFrom,y=f(_);if(!y&&f(n)){a2.pitch=-B.PI_OVER_FOUR,a2.range=0;let p=a.getValue(t,Oje);if(f(p)){let C=2-1/Math.max(1,m.magnitude(p)/o.maximumRadius);a2.pitch*=C}u.viewBoundingSphere(n,a2),this.boundingSphere=n,d=!1,h=!1}else(!y||!f(_.getValue(t,this._offset3D)))&&m.clone(hD._defaultOffset3D,this._offset3D)}else!l&&this._mode!==ne.SCENE2D&&m.clone(u.position,this._offset3D);this._lastEntity=s,this._mode=r,Bje(this,u,d,h,a,t,o)};var c2=hD;function p2(t){return _2(t.map(([n,i])=>new Array(n).fill(i,0,n)))}function _2(t){return t.reduce((n,i)=>n.concat(Array.isArray(i)?_2(i):i),[])}var Bce=[0,1,2,3].concat(...p2([[2,4],[2,5],[4,6],[4,7],[8,8],[8,9],[16,10],[16,11],[32,12],[32,13],[64,14],[64,15],[2,0],[1,16],[1,17],[2,18],[2,19],[4,20],[4,21],[8,22],[8,23],[16,24],[16,25],[32,26],[32,27],[64,28],[64,29]]));function ir(){let t=this;function n(r){let s=t.dyn_tree,a=t.stat_desc.static_tree,c=t.stat_desc.extra_bits,l=t.stat_desc.extra_base,u=t.stat_desc.max_length,d,h,_,y,p,C,x=0;for(y=0;y<=15;y++)r.bl_count[y]=0;for(s[r.heap[r.heap_max]*2+1]=0,d=r.heap_max+1;d<573;d++)h=r.heap[d],y=s[s[h*2+1]*2+1]+1,y>u&&(y=u,x++),s[h*2+1]=y,!(h>t.max_code)&&(r.bl_count[y]++,p=0,h>=l&&(p=c[h-l]),C=s[h*2],r.opt_len+=C*(y+p),a&&(r.static_len+=C*(a[h*2+1]+p)));if(x!==0){do{for(y=u-1;r.bl_count[y]===0;)y--;r.bl_count[y]--,r.bl_count[y+1]+=2,r.bl_count[u]--,x-=2}while(x>0);for(y=u;y!==0;y--)for(h=r.bl_count[y];h!==0;)_=r.heap[--d],!(_>t.max_code)&&(s[_*2+1]!=y&&(r.opt_len+=(y-s[_*2+1])*s[_*2],s[_*2+1]=y),h--)}}function i(r,s){let a=0;do a|=r&1,r>>>=1,a<<=1;while(--s>0);return a>>>1}function o(r,s,a){let c=[],l=0,u,d,h;for(u=1;u<=15;u++)c[u]=l=l+a[u-1]<<1;for(d=0;d<=s;d++)h=r[d*2+1],h!==0&&(r[d*2]=i(c[h]++,h))}t.build_tree=function(r){let s=t.dyn_tree,a=t.stat_desc.static_tree,c=t.stat_desc.elems,l,u,d=-1,h;for(r.heap_len=0,r.heap_max=573,l=0;l<c;l++)s[l*2]!==0?(r.heap[++r.heap_len]=d=l,r.depth[l]=0):s[l*2+1]=0;for(;r.heap_len<2;)h=r.heap[++r.heap_len]=d<2?++d:0,s[h*2]=1,r.depth[h]=0,r.opt_len--,a&&(r.static_len-=a[h*2+1]);for(t.max_code=d,l=Math.floor(r.heap_len/2);l>=1;l--)r.pqdownheap(s,l);h=c;do l=r.heap[1],r.heap[1]=r.heap[r.heap_len--],r.pqdownheap(s,1),u=r.heap[1],r.heap[--r.heap_max]=l,r.heap[--r.heap_max]=u,s[h*2]=s[l*2]+s[u*2],r.depth[h]=Math.max(r.depth[l],r.depth[u])+1,s[l*2+1]=s[u*2+1]=h,r.heap[1]=h++,r.pqdownheap(s,1);while(r.heap_len>=2);r.heap[--r.heap_max]=r.heap[1],n(r),o(s,t.max_code,r.bl_count)}}ir._length_code=[0,1,2,3,4,5,6,7].concat(...p2([[2,8],[2,9],[2,10],[2,11],[4,12],[4,13],[4,14],[4,15],[8,16],[8,17],[8,18],[8,19],[16,20],[16,21],[16,22],[16,23],[32,24],[32,25],[32,26],[31,27],[1,28]]));ir.base_length=[0,1,2,3,4,5,6,7,8,10,12,14,16,20,24,28,32,40,48,56,64,80,96,112,128,160,192,224,0];ir.base_dist=[0,1,2,3,4,6,8,12,16,24,32,48,64,96,128,192,256,384,512,768,1024,1536,2048,3072,4096,6144,8192,12288,16384,24576];ir.d_code=function(t){return t<256?Bce[t]:Bce[256+(t>>>7)]};ir.extra_lbits=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0];ir.extra_dbits=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13];ir.extra_blbits=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7];ir.bl_order=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];function ra(t,n,i,o,r){let s=this;s.static_tree=t,s.extra_bits=n,s.extra_base=i,s.elems=o,s.max_length=r}var Rje=[12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254,1,129,65,193,33,161,97,225,17,145,81,209,49,177,113,241,9,137,73,201,41,169,105,233,25,153,89,217,57,185,121,249,5,133,69,197,37,165,101,229,21,149,85,213,53,181,117,245,13,141,77,205,45,173,109,237,29,157,93,221,61,189,125,253,19,275,147,403,83,339,211,467,51,307,179,435,115,371,243,499,11,267,139,395,75,331,203,459,43,299,171,427,107,363,235,491,27,283,155,411,91,347,219,475,59,315,187,443,123,379,251,507,7,263,135,391,71,327,199,455,39,295,167,423,103,359,231,487,23,279,151,407,87,343,215,471,55,311,183,439,119,375,247,503,15,271,143,399,79,335,207,463,47,303,175,431,111,367,239,495,31,287,159,415,95,351,223,479,63,319,191,447,127,383,255,511,0,64,32,96,16,80,48,112,8,72,40,104,24,88,56,120,4,68,36,100,20,84,52,116,3,131,67,195,35,163,99,227],Mje=p2([[144,8],[112,9],[24,7],[8,8]]);ra.static_ltree=_2(Rje.map((t,n)=>[t,Mje[n]]));var Lje=[0,16,8,24,4,20,12,28,2,18,10,26,6,22,14,30,1,17,9,25,5,21,13,29,3,19,11,27,7,23],Fje=p2([[30,5]]);ra.static_dtree=_2(Lje.map((t,n)=>[t,Fje[n]]));ra.static_l_desc=new ra(ra.static_ltree,ir.extra_lbits,256+1,286,15);ra.static_d_desc=new ra(ra.static_dtree,ir.extra_dbits,0,30,15);ra.static_bl_desc=new ra(null,ir.extra_blbits,0,19,7);var Nje=9,Vje=8;function Dh(t,n,i,o,r){let s=this;s.good_length=t,s.max_lazy=n,s.nice_length=i,s.max_chain=o,s.func=r}var Rce=0,h2=1,Wy=2,sd=[new Dh(0,0,0,0,Rce),new Dh(4,4,8,4,h2),new Dh(4,5,16,8,h2),new Dh(4,6,32,32,h2),new Dh(4,4,16,16,Wy),new Dh(8,16,32,32,Wy),new Dh(8,16,128,128,Wy),new Dh(8,32,128,256,Wy),new Dh(32,128,258,1024,Wy),new Dh(32,258,258,4096,Wy)],l2=["need dictionary","stream end","","","stream error","data error","","buffer error","",""],Ju=0,u2=1,mD=2,f2=3,kje=32,S9=42,d2=113,pD=666,w9=8,Uje=0,D9=1,zje=2,lr=3,m2=258,zl=m2+lr+1;function Oce(t,n,i,o){let r=t[n*2],s=t[i*2];return r<s||r==s&&o[n]<=o[i]}function Hje(){let t=this,n,i,o,r,s,a,c,l,u,d,h,_,y,p,C,x,T,E,S,w,D,I,O,M,L,F,g,b,v,P,R,V,H,U=new ir,G=new ir,k=new ir;t.depth=[];let X,Y,K,j,Z,Q;t.bl_count=[],t.heap=[],R=[],V=[],H=[];function me(){u=2*s,h[y-1]=0;for(let Le=0;Le<y-1;Le++)h[Le]=0;F=sd[g].max_lazy,v=sd[g].good_length,P=sd[g].nice_length,L=sd[g].max_chain,D=0,T=0,O=0,E=M=lr-1,w=0,_=0}function _e(){let Le;for(Le=0;Le<286;Le++)R[Le*2]=0;for(Le=0;Le<30;Le++)V[Le*2]=0;for(Le=0;Le<19;Le++)H[Le*2]=0;R[256*2]=1,t.opt_len=t.static_len=0,Y=K=0}function re(){U.dyn_tree=R,U.stat_desc=ra.static_l_desc,G.dyn_tree=V,G.stat_desc=ra.static_d_desc,k.dyn_tree=H,k.stat_desc=ra.static_bl_desc,Z=0,Q=0,j=8,_e()}t.pqdownheap=function(Le,nt){let Qe=t.heap,Xe=Qe[nt],dt=nt<<1;for(;dt<=t.heap_len&&(dt<t.heap_len&&Oce(Le,Qe[dt+1],Qe[dt],t.depth)&&dt++,!Oce(Le,Xe,Qe[dt],t.depth));)Qe[nt]=Qe[dt],nt=dt,dt<<=1;Qe[nt]=Xe};function fe(Le,nt){let Qe=-1,Xe,dt=Le[0*2+1],Mt=0,bn=7,To=4;dt===0&&(bn=138,To=3),Le[(nt+1)*2+1]=65535;for(let Go=0;Go<=nt;Go++)Xe=dt,dt=Le[(Go+1)*2+1],!(++Mt<bn&&Xe==dt)&&(Mt<To?H[Xe*2]+=Mt:Xe!==0?(Xe!=Qe&&H[Xe*2]++,H[16*2]++):Mt<=10?H[17*2]++:H[18*2]++,Mt=0,Qe=Xe,dt===0?(bn=138,To=3):Xe==dt?(bn=6,To=3):(bn=7,To=4))}function ge(){let Le;for(fe(R,U.max_code),fe(V,G.max_code),k.build_tree(t),Le=19-1;Le>=3&&H[ir.bl_order[Le]*2+1]===0;Le--);return t.opt_len+=3*(Le+1)+5+5+4,Le}function be(Le){t.pending_buf[t.pending++]=Le}function Be(Le){be(Le&255),be(Le>>>8&255)}function ke(Le){be(Le>>8&255),be(Le&255&255)}function qe(Le,nt){let Qe,Xe=nt;Q>16-Xe?(Qe=Le,Z|=Qe<<Q&65535,Be(Z),Z=Qe>>>16-Q,Q+=Xe-16):(Z|=Le<<Q&65535,Q+=Xe)}function Nt(Le,nt){let Qe=Le*2;qe(nt[Qe]&65535,nt[Qe+1]&65535)}function Wt(Le,nt){let Qe,Xe=-1,dt,Mt=Le[0*2+1],bn=0,To=7,Go=4;for(Mt===0&&(To=138,Go=3),Qe=0;Qe<=nt;Qe++)if(dt=Mt,Mt=Le[(Qe+1)*2+1],!(++bn<To&&dt==Mt)){if(bn<Go)do Nt(dt,H);while(--bn!==0);else dt!==0?(dt!=Xe&&(Nt(dt,H),bn--),Nt(16,H),qe(bn-3,2)):bn<=10?(Nt(17,H),qe(bn-3,3)):(Nt(18,H),qe(bn-11,7));bn=0,Xe=dt,Mt===0?(To=138,Go=3):dt==Mt?(To=6,Go=3):(To=7,Go=4)}}function un(Le,nt,Qe){let Xe;for(qe(Le-257,5),qe(nt-1,5),qe(Qe-4,4),Xe=0;Xe<Qe;Xe++)qe(H[ir.bl_order[Xe]*2+1],3);Wt(R,Le-1),Wt(V,nt-1)}function _t(){Q==16?(Be(Z),Z=0,Q=0):Q>=8&&(be(Z&255),Z>>>=8,Q-=8)}function Rn(){qe(D9<<1,3),Nt(256,ra.static_ltree),_t(),1+j+10-Q<9&&(qe(D9<<1,3),Nt(256,ra.static_ltree),_t()),j=7}function oi(Le,nt){let Qe,Xe,dt;if(t.dist_buf[Y]=Le,t.lc_buf[Y]=nt&255,Y++,Le===0?R[nt*2]++:(K++,Le--,R[(ir._length_code[nt]+256+1)*2]++,V[ir.d_code(Le)*2]++),(Y&8191)===0&&g>2){for(Qe=Y*8,Xe=D-T,dt=0;dt<30;dt++)Qe+=V[dt*2]*(5+ir.extra_dbits[dt]);if(Qe>>>=3,K<Math.floor(Y/2)&&Qe<Math.floor(Xe/2))return!0}return Y==X-1}function lt(Le,nt){let Qe,Xe,dt=0,Mt,bn;if(Y!==0)do Qe=t.dist_buf[dt],Xe=t.lc_buf[dt],dt++,Qe===0?Nt(Xe,Le):(Mt=ir._length_code[Xe],Nt(Mt+256+1,Le),bn=ir.extra_lbits[Mt],bn!==0&&(Xe-=ir.base_length[Mt],qe(Xe,bn)),Qe--,Mt=ir.d_code(Qe),Nt(Mt,nt),bn=ir.extra_dbits[Mt],bn!==0&&(Qe-=ir.base_dist[Mt],qe(Qe,bn)));while(dt<Y);Nt(256,Le),j=Le[256*2+1]}function Yt(){Q>8?Be(Z):Q>0&&be(Z&255),Z=0,Q=0}function si(Le,nt,Qe){Yt(),j=8,Qe&&(Be(nt),Be(~nt)),t.pending_buf.set(l.subarray(Le,Le+nt),t.pending),t.pending+=nt}function ye(Le,nt,Qe){qe((Uje<<1)+(Qe?1:0),3),si(Le,nt,!0)}function Oe(Le,nt,Qe){let Xe,dt,Mt=0;g>0?(U.build_tree(t),G.build_tree(t),Mt=ge(),Xe=t.opt_len+3+7>>>3,dt=t.static_len+3+7>>>3,dt<=Xe&&(Xe=dt)):Xe=dt=nt+5,nt+4<=Xe&&Le!=-1?ye(Le,nt,Qe):dt==Xe?(qe((D9<<1)+(Qe?1:0),3),lt(ra.static_ltree,ra.static_dtree)):(qe((zje<<1)+(Qe?1:0),3),un(U.max_code+1,G.max_code+1,Mt+1),lt(R,V)),_e(),Qe&&Yt()}function Ye(Le){Oe(T>=0?T:-1,D-T,Le),T=D,n.flush_pending()}function Xt(){let Le,nt,Qe,Xe;do{if(Xe=u-O-D,Xe===0&&D===0&&O===0)Xe=s;else if(Xe==-1)Xe--;else if(D>=s+s-zl){l.set(l.subarray(s,s+s),0),I-=s,D-=s,T-=s,Le=y,Qe=Le;do nt=h[--Qe]&65535,h[Qe]=nt>=s?nt-s:0;while(--Le!==0);Le=s,Qe=Le;do nt=d[--Qe]&65535,d[Qe]=nt>=s?nt-s:0;while(--Le!==0);Xe+=s}if(n.avail_in===0)return;Le=n.read_buf(l,D+O,Xe),O+=Le,O>=lr&&(_=l[D]&255,_=(_<<x^l[D+1]&255)&C)}while(O<zl&&n.avail_in!==0)}function En(Le){let nt=65535,Qe;for(nt>o-5&&(nt=o-5);;){if(O<=1){if(Xt(),O===0&&Le==0)return Ju;if(O===0)break}if(D+=O,O=0,Qe=T+nt,(D===0||D>=Qe)&&(O=D-Qe,D=Qe,Ye(!1),n.avail_out===0)||D-T>=s-zl&&(Ye(!1),n.avail_out===0))return Ju}return Ye(Le==4),n.avail_out===0?Le==4?mD:Ju:Le==4?f2:u2}function Vi(Le){let nt=L,Qe=D,Xe,dt,Mt=M,bn=D>s-zl?D-(s-zl):0,To=P,Go=c,Kr=D+m2,As=l[Qe+Mt-1],io=l[Qe+Mt];M>=v&&(nt>>=2),To>O&&(To=O);do if(Xe=Le,!(l[Xe+Mt]!=io||l[Xe+Mt-1]!=As||l[Xe]!=l[Qe]||l[++Xe]!=l[Qe+1])){Qe+=2,Xe++;do;while(l[++Qe]==l[++Xe]&&l[++Qe]==l[++Xe]&&l[++Qe]==l[++Xe]&&l[++Qe]==l[++Xe]&&l[++Qe]==l[++Xe]&&l[++Qe]==l[++Xe]&&l[++Qe]==l[++Xe]&&l[++Qe]==l[++Xe]&&Qe<Kr);if(dt=m2-(Kr-Qe),Qe=Kr-m2,dt>Mt){if(I=Le,Mt=dt,dt>=To)break;As=l[Qe+Mt-1],io=l[Qe+Mt]}}while((Le=d[Le&Go]&65535)>bn&&--nt!==0);return Mt<=O?Mt:O}function ki(Le){let nt=0,Qe;for(;;){if(O<zl){if(Xt(),O<zl&&Le==0)return Ju;if(O===0)break}if(O>=lr&&(_=(_<<x^l[D+(lr-1)]&255)&C,nt=h[_]&65535,d[D&c]=h[_],h[_]=D),nt!==0&&(D-nt&65535)<=s-zl&&b!=2&&(E=Vi(nt)),E>=lr)if(Qe=oi(D-I,E-lr),O-=E,E<=F&&O>=lr){E--;do D++,_=(_<<x^l[D+(lr-1)]&255)&C,nt=h[_]&65535,d[D&c]=h[_],h[_]=D;while(--E!==0);D++}else D+=E,E=0,_=l[D]&255,_=(_<<x^l[D+1]&255)&C;else Qe=oi(0,l[D]&255),O--,D++;if(Qe&&(Ye(!1),n.avail_out===0))return Ju}return Ye(Le==4),n.avail_out===0?Le==4?mD:Ju:Le==4?f2:u2}function Xi(Le){let nt=0,Qe,Xe;for(;;){if(O<zl){if(Xt(),O<zl&&Le==0)return Ju;if(O===0)break}if(O>=lr&&(_=(_<<x^l[D+(lr-1)]&255)&C,nt=h[_]&65535,d[D&c]=h[_],h[_]=D),M=E,S=I,E=lr-1,nt!==0&&M<F&&(D-nt&65535)<=s-zl&&(b!=2&&(E=Vi(nt)),E<=5&&(b==1||E==lr&&D-I>4096)&&(E=lr-1)),M>=lr&&E<=M){Xe=D+O-lr,Qe=oi(D-1-S,M-lr),O-=M-1,M-=2;do++D<=Xe&&(_=(_<<x^l[D+(lr-1)]&255)&C,nt=h[_]&65535,d[D&c]=h[_],h[_]=D);while(--M!==0);if(w=0,E=lr-1,D++,Qe&&(Ye(!1),n.avail_out===0))return Ju}else if(w!==0){if(Qe=oi(0,l[D-1]&255),Qe&&Ye(!1),D++,O--,n.avail_out===0)return Ju}else w=1,D++,O--}return w!==0&&(Qe=oi(0,l[D-1]&255),w=0),Ye(Le==4),n.avail_out===0?Le==4?mD:Ju:Le==4?f2:u2}function li(Le){return Le.total_in=Le.total_out=0,Le.msg=null,t.pending=0,t.pending_out=0,i=d2,r=0,re(),me(),0}t.deflateInit=function(Le,nt,Qe,Xe,dt,Mt){return Xe||(Xe=w9),dt||(dt=Vje),Mt||(Mt=0),Le.msg=null,nt==-1&&(nt=6),dt<1||dt>Nje||Xe!=w9||Qe<9||Qe>15||nt<0||nt>9||Mt<0||Mt>2?-2:(Le.dstate=t,a=Qe,s=1<<a,c=s-1,p=dt+7,y=1<<p,C=y-1,x=Math.floor((p+lr-1)/lr),l=new Uint8Array(s*2),d=[],h=[],X=1<<dt+6,t.pending_buf=new Uint8Array(X*4),o=X*4,t.dist_buf=new Uint16Array(X),t.lc_buf=new Uint8Array(X),g=nt,b=Mt,li(Le))},t.deflateEnd=function(){return i!=S9&&i!=d2&&i!=pD?-2:(t.lc_buf=null,t.dist_buf=null,t.pending_buf=null,h=null,d=null,l=null,t.dstate=null,i==d2?-3:0)},t.deflateParams=function(Le,nt,Qe){let Xe=0;return nt==-1&&(nt=6),nt<0||nt>9||Qe<0||Qe>2?-2:(sd[g].func!=sd[nt].func&&Le.total_in!==0&&(Xe=Le.deflate(1)),g!=nt&&(g=nt,F=sd[g].max_lazy,v=sd[g].good_length,P=sd[g].nice_length,L=sd[g].max_chain),b=Qe,Xe)},t.deflateSetDictionary=function(Le,nt,Qe){let Xe=Qe,dt,Mt=0;if(!nt||i!=S9)return-2;if(Xe<lr)return 0;for(Xe>s-zl&&(Xe=s-zl,Mt=Qe-Xe),l.set(nt.subarray(Mt,Mt+Xe),0),D=Xe,T=Xe,_=l[0]&255,_=(_<<x^l[1]&255)&C,dt=0;dt<=Xe-lr;dt++)_=(_<<x^l[dt+(lr-1)]&255)&C,d[dt&c]=h[_],h[_]=dt;return 0},t.deflate=function(Le,nt){let Qe,Xe,dt,Mt,bn;if(nt>4||nt<0)return-2;if(!Le.next_out||!Le.next_in&&Le.avail_in!==0||i==pD&&nt!=4)return Le.msg=l2[2- -2],-2;if(Le.avail_out===0)return Le.msg=l2[2- -5],-5;if(n=Le,Mt=r,r=nt,i==S9&&(Xe=w9+(a-8<<4)<<8,dt=(g-1&255)>>1,dt>3&&(dt=3),Xe|=dt<<6,D!==0&&(Xe|=kje),Xe+=31-Xe%31,i=d2,ke(Xe)),t.pending!==0){if(n.flush_pending(),n.avail_out===0)return r=-1,0}else if(n.avail_in===0&&nt<=Mt&&nt!=4)return n.msg=l2[2- -5],-5;if(i==pD&&n.avail_in!==0)return Le.msg=l2[2- -5],-5;if(n.avail_in!==0||O!==0||nt!=0&&i!=pD){switch(bn=-1,sd[g].func){case Rce:bn=En(nt);break;case h2:bn=ki(nt);break;case Wy:bn=Xi(nt);break;default:}if((bn==mD||bn==f2)&&(i=pD),bn==Ju||bn==mD)return n.avail_out===0&&(r=-1),0;if(bn==u2){if(nt==1)Rn();else if(ye(0,0,!1),nt==3)for(Qe=0;Qe<y;Qe++)h[Qe]=0;if(n.flush_pending(),n.avail_out===0)return r=-1,0}}return nt!=4?0:1}}function Mce(){let t=this;t.next_in_index=0,t.next_out_index=0,t.avail_in=0,t.total_in=0,t.avail_out=0,t.total_out=0}Mce.prototype={deflateInit:function(t,n){let i=this;return i.dstate=new Hje,n||(n=15),i.dstate.deflateInit(i,t,n)},deflate:function(t){let n=this;return n.dstate?n.dstate.deflate(n,t):-2},deflateEnd:function(){let t=this;if(!t.dstate)return-2;let n=t.dstate.deflateEnd();return t.dstate=null,n},deflateParams:function(t,n){let i=this;return i.dstate?i.dstate.deflateParams(i,t,n):-2},deflateSetDictionary:function(t,n){let i=this;return i.dstate?i.dstate.deflateSetDictionary(i,t,n):-2},read_buf:function(t,n,i){let o=this,r=o.avail_in;return r>i&&(r=i),r===0?0:(o.avail_in-=r,t.set(o.next_in.subarray(o.next_in_index,o.next_in_index+r),n),o.next_in_index+=r,o.total_in+=r,r)},flush_pending:function(){let t=this,n=t.dstate.pending;n>t.avail_out&&(n=t.avail_out),n!==0&&(t.next_out.set(t.dstate.pending_buf.subarray(t.dstate.pending_out,t.dstate.pending_out+n),t.next_out_index),t.next_out_index+=n,t.dstate.pending_out+=n,t.total_out+=n,t.avail_out-=n,t.dstate.pending-=n,t.dstate.pending===0&&(t.dstate.pending_out=0))}};function Gje(t){let n=this,i=new Mce,o=Wje(t&&t.chunkSize?t.chunkSize:64*1024),r=0,s=new Uint8Array(o),a=t?t.level:-1;typeof a=="undefined"&&(a=-1),i.deflateInit(a),i.next_out=s,n.append=function(c,l){let u,d,h=0,_=0,y=0,p=[];if(!!c.length){i.next_in_index=0,i.next_in=c,i.avail_in=c.length;do{if(i.next_out_index=0,i.avail_out=o,u=i.deflate(r),u!=0)throw new Error("deflating: "+i.msg);i.next_out_index&&(i.next_out_index==o?p.push(new Uint8Array(s)):p.push(s.slice(0,i.next_out_index))),y+=i.next_out_index,l&&i.next_in_index>0&&i.next_in_index!=h&&(l(i.next_in_index),h=i.next_in_index)}while(i.avail_in>0||i.avail_out===0);return p.length>1?(d=new Uint8Array(y),p.forEach(function(C){d.set(C,_),_+=C.length})):d=p[0]||new Uint8Array(0),d}},n.flush=function(){let c,l,u=0,d=0,h=[];do{if(i.next_out_index=0,i.avail_out=o,c=i.deflate(4),c!=1&&c!=0)throw new Error("deflating: "+i.msg);o-i.avail_out>0&&h.push(s.slice(0,i.next_out_index)),d+=i.next_out_index}while(i.avail_in>0||i.avail_out===0);return i.deflateEnd(),l=new Uint8Array(d),h.forEach(function(_){l.set(_,u),u+=_.length}),l}}function Wje(t){return t+5*(Math.floor(t/16383)+1)}var Lce=Gje;var Hl=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],tle=1440,jje=0,qje=4,Yje=9,Xje=5,Kje=[96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,192,80,7,10,0,8,96,0,8,32,0,9,160,0,8,0,0,8,128,0,8,64,0,9,224,80,7,6,0,8,88,0,8,24,0,9,144,83,7,59,0,8,120,0,8,56,0,9,208,81,7,17,0,8,104,0,8,40,0,9,176,0,8,8,0,8,136,0,8,72,0,9,240,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,200,81,7,13,0,8,100,0,8,36,0,9,168,0,8,4,0,8,132,0,8,68,0,9,232,80,7,8,0,8,92,0,8,28,0,9,152,84,7,83,0,8,124,0,8,60,0,9,216,82,7,23,0,8,108,0,8,44,0,9,184,0,8,12,0,8,140,0,8,76,0,9,248,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,196,81,7,11,0,8,98,0,8,34,0,9,164,0,8,2,0,8,130,0,8,66,0,9,228,80,7,7,0,8,90,0,8,26,0,9,148,84,7,67,0,8,122,0,8,58,0,9,212,82,7,19,0,8,106,0,8,42,0,9,180,0,8,10,0,8,138,0,8,74,0,9,244,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,204,81,7,15,0,8,102,0,8,38,0,9,172,0,8,6,0,8,134,0,8,70,0,9,236,80,7,9,0,8,94,0,8,30,0,9,156,84,7,99,0,8,126,0,8,62,0,9,220,82,7,27,0,8,110,0,8,46,0,9,188,0,8,14,0,8,142,0,8,78,0,9,252,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,194,80,7,10,0,8,97,0,8,33,0,9,162,0,8,1,0,8,129,0,8,65,0,9,226,80,7,6,0,8,89,0,8,25,0,9,146,83,7,59,0,8,121,0,8,57,0,9,210,81,7,17,0,8,105,0,8,41,0,9,178,0,8,9,0,8,137,0,8,73,0,9,242,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,202,81,7,13,0,8,101,0,8,37,0,9,170,0,8,5,0,8,133,0,8,69,0,9,234,80,7,8,0,8,93,0,8,29,0,9,154,84,7,83,0,8,125,0,8,61,0,9,218,82,7,23,0,8,109,0,8,45,0,9,186,0,8,13,0,8,141,0,8,77,0,9,250,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,198,81,7,11,0,8,99,0,8,35,0,9,166,0,8,3,0,8,131,0,8,67,0,9,230,80,7,7,0,8,91,0,8,27,0,9,150,84,7,67,0,8,123,0,8,59,0,9,214,82,7,19,0,8,107,0,8,43,0,9,182,0,8,11,0,8,139,0,8,75,0,9,246,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,206,81,7,15,0,8,103,0,8,39,0,9,174,0,8,7,0,8,135,0,8,71,0,9,238,80,7,9,0,8,95,0,8,31,0,9,158,84,7,99,0,8,127,0,8,63,0,9,222,82,7,27,0,8,111,0,8,47,0,9,190,0,8,15,0,8,143,0,8,79,0,9,254,96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,193,80,7,10,0,8,96,0,8,32,0,9,161,0,8,0,0,8,128,0,8,64,0,9,225,80,7,6,0,8,88,0,8,24,0,9,145,83,7,59,0,8,120,0,8,56,0,9,209,81,7,17,0,8,104,0,8,40,0,9,177,0,8,8,0,8,136,0,8,72,0,9,241,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,201,81,7,13,0,8,100,0,8,36,0,9,169,0,8,4,0,8,132,0,8,68,0,9,233,80,7,8,0,8,92,0,8,28,0,9,153,84,7,83,0,8,124,0,8,60,0,9,217,82,7,23,0,8,108,0,8,44,0,9,185,0,8,12,0,8,140,0,8,76,0,9,249,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,197,81,7,11,0,8,98,0,8,34,0,9,165,0,8,2,0,8,130,0,8,66,0,9,229,80,7,7,0,8,90,0,8,26,0,9,149,84,7,67,0,8,122,0,8,58,0,9,213,82,7,19,0,8,106,0,8,42,0,9,181,0,8,10,0,8,138,0,8,74,0,9,245,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,205,81,7,15,0,8,102,0,8,38,0,9,173,0,8,6,0,8,134,0,8,70,0,9,237,80,7,9,0,8,94,0,8,30,0,9,157,84,7,99,0,8,126,0,8,62,0,9,221,82,7,27,0,8,110,0,8,46,0,9,189,0,8,14,0,8,142,0,8,78,0,9,253,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,195,80,7,10,0,8,97,0,8,33,0,9,163,0,8,1,0,8,129,0,8,65,0,9,227,80,7,6,0,8,89,0,8,25,0,9,147,83,7,59,0,8,121,0,8,57,0,9,211,81,7,17,0,8,105,0,8,41,0,9,179,0,8,9,0,8,137,0,8,73,0,9,243,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,203,81,7,13,0,8,101,0,8,37,0,9,171,0,8,5,0,8,133,0,8,69,0,9,235,80,7,8,0,8,93,0,8,29,0,9,155,84,7,83,0,8,125,0,8,61,0,9,219,82,7,23,0,8,109,0,8,45,0,9,187,0,8,13,0,8,141,0,8,77,0,9,251,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,199,81,7,11,0,8,99,0,8,35,0,9,167,0,8,3,0,8,131,0,8,67,0,9,231,80,7,7,0,8,91,0,8,27,0,9,151,84,7,67,0,8,123,0,8,59,0,9,215,82,7,19,0,8,107,0,8,43,0,9,183,0,8,11,0,8,139,0,8,75,0,9,247,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,207,81,7,15,0,8,103,0,8,39,0,9,175,0,8,7,0,8,135,0,8,71,0,9,239,80,7,9,0,8,95,0,8,31,0,9,159,84,7,99,0,8,127,0,8,63,0,9,223,82,7,27,0,8,111,0,8,47,0,9,191,0,8,15,0,8,143,0,8,79,0,9,255],Jje=[80,5,1,87,5,257,83,5,17,91,5,4097,81,5,5,89,5,1025,85,5,65,93,5,16385,80,5,3,88,5,513,84,5,33,92,5,8193,82,5,9,90,5,2049,86,5,129,192,5,24577,80,5,2,87,5,385,83,5,25,91,5,6145,81,5,7,89,5,1537,85,5,97,93,5,24577,80,5,4,88,5,769,84,5,49,92,5,12289,82,5,13,90,5,3073,86,5,193,192,5,24577],Zje=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],Qje=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,112,112],$je=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],eqe=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],gg=15;function B9(){let t=this,n,i,o,r,s,a;function c(u,d,h,_,y,p,C,x,T,E,S){let w,D,I,O,M,L,F,g,b,v,P,R,V,H,U;v=0,M=h;do o[u[d+v]]++,v++,M--;while(M!==0);if(o[0]==h)return C[0]=-1,x[0]=0,0;for(g=x[0],L=1;L<=gg&&o[L]===0;L++);for(F=L,g<L&&(g=L),M=gg;M!==0&&o[M]===0;M--);for(I=M,g>M&&(g=M),x[0]=g,H=1<<L;L<M;L++,H<<=1)if((H-=o[L])<0)return-3;if((H-=o[M])<0)return-3;for(o[M]+=H,a[1]=L=0,v=1,V=2;--M!==0;)a[V]=L+=o[v],V++,v++;M=0,v=0;do(L=u[d+v])!==0&&(S[a[L]++]=M),v++;while(++M<h);for(h=a[I],a[0]=M=0,v=0,O=-1,R=-g,s[0]=0,P=0,U=0;F<=I;F++)for(w=o[F];w--!==0;){for(;F>R+g;){if(O++,R+=g,U=I-R,U=U>g?g:U,(D=1<<(L=F-R))>w+1&&(D-=w+1,V=F,L<U))for(;++L<U&&!((D<<=1)<=o[++V]);)D-=o[V];if(U=1<<L,E[0]+U>tle)return-3;s[O]=P=E[0],E[0]+=U,O!==0?(a[O]=M,r[0]=L,r[1]=g,L=M>>>R-g,r[2]=P-s[O-1]-L,T.set(r,(s[O-1]+L)*3)):C[0]=P}for(r[1]=F-R,v>=h?r[0]=128+64:S[v]<_?(r[0]=S[v]<256?0:32+64,r[2]=S[v++]):(r[0]=p[S[v]-_]+16+64,r[2]=y[S[v++]-_]),D=1<<F-R,L=M>>>R;L<U;L+=D)T.set(r,(P+L)*3);for(L=1<<F-1;(M&L)!==0;L>>>=1)M^=L;for(M^=L,b=(1<<R)-1;(M&b)!=a[O];)O--,R-=g,b=(1<<R)-1}return H!==0&&I!=1?-5:0}function l(u){let d;for(n||(n=[],i=[],o=new Int32Array(gg+1),r=[],s=new Int32Array(gg),a=new Int32Array(gg+1)),i.length<u&&(i=[]),d=0;d<u;d++)i[d]=0;for(d=0;d<gg+1;d++)o[d]=0;for(d=0;d<3;d++)r[d]=0;s.set(o.subarray(0,gg),0),a.set(o.subarray(0,gg+1),0)}t.inflate_trees_bits=function(u,d,h,_,y){let p;return l(19),n[0]=0,p=c(u,0,19,19,null,null,h,d,_,n,i),p==-3?y.msg="oversubscribed dynamic bit lengths tree":(p==-5||d[0]===0)&&(y.msg="incomplete dynamic bit lengths tree",p=-3),p},t.inflate_trees_dynamic=function(u,d,h,_,y,p,C,x,T){let E;return l(288),n[0]=0,E=c(h,0,u,257,Zje,Qje,p,_,x,n,i),E!=0||_[0]===0?(E==-3?T.msg="oversubscribed literal/length tree":E!=-4&&(T.msg="incomplete literal/length tree",E=-3),E):(l(288),E=c(h,u,d,0,$je,eqe,C,y,x,n,i),E!=0||y[0]===0&&u>257?(E==-3?T.msg="oversubscribed distance tree":E==-5?(T.msg="incomplete distance tree",E=-3):E!=-4&&(T.msg="empty distance tree with lengths",E=-3),E):0)}}B9.inflate_trees_fixed=function(t,n,i,o){return t[0]=Yje,n[0]=Xje,i[0]=Kje,o[0]=Jje,0};var g2=0,Fce=1,Nce=2,Vce=3,kce=4,Uce=5,zce=6,v9=7,Hce=8,y2=9;function tqe(){let t=this,n,i=0,o,r=0,s=0,a=0,c=0,l=0,u=0,d=0,h,_=0,y,p=0;function C(x,T,E,S,w,D,I,O){let M,L,F,g,b,v,P,R,V,H,U,G,k,X,Y,K;P=O.next_in_index,R=O.avail_in,b=I.bitb,v=I.bitk,V=I.write,H=V<I.read?I.read-V-1:I.end-V,U=Hl[x],G=Hl[T];do{for(;v<20;)R--,b|=(O.read_byte(P++)&255)<<v,v+=8;if(M=b&U,L=E,F=S,K=(F+M)*3,(g=L[K])===0){b>>=L[K+1],v-=L[K+1],I.win[V++]=L[K+2],H--;continue}do{if(b>>=L[K+1],v-=L[K+1],(g&16)!==0){for(g&=15,k=L[K+2]+(b&Hl[g]),b>>=g,v-=g;v<15;)R--,b|=(O.read_byte(P++)&255)<<v,v+=8;M=b&G,L=w,F=D,K=(F+M)*3,g=L[K];do if(b>>=L[K+1],v-=L[K+1],(g&16)!==0){for(g&=15;v<g;)R--,b|=(O.read_byte(P++)&255)<<v,v+=8;if(X=L[K+2]+(b&Hl[g]),b>>=g,v-=g,H-=k,V>=X)Y=V-X,V-Y>0&&2>V-Y?(I.win[V++]=I.win[Y++],I.win[V++]=I.win[Y++],k-=2):(I.win.set(I.win.subarray(Y,Y+2),V),V+=2,Y+=2,k-=2);else{Y=V-X;do Y+=I.end;while(Y<0);if(g=I.end-Y,k>g){if(k-=g,V-Y>0&&g>V-Y)do I.win[V++]=I.win[Y++];while(--g!==0);else I.win.set(I.win.subarray(Y,Y+g),V),V+=g,Y+=g,g=0;Y=0}}if(V-Y>0&&k>V-Y)do I.win[V++]=I.win[Y++];while(--k!==0);else I.win.set(I.win.subarray(Y,Y+k),V),V+=k,Y+=k,k=0;break}else if((g&64)===0)M+=L[K+2],M+=b&Hl[g],K=(F+M)*3,g=L[K];else return O.msg="invalid distance code",k=O.avail_in-R,k=v>>3<k?v>>3:k,R+=k,P-=k,v-=k<<3,I.bitb=b,I.bitk=v,O.avail_in=R,O.total_in+=P-O.next_in_index,O.next_in_index=P,I.write=V,-3;while(!0);break}if((g&64)===0){if(M+=L[K+2],M+=b&Hl[g],K=(F+M)*3,(g=L[K])===0){b>>=L[K+1],v-=L[K+1],I.win[V++]=L[K+2],H--;break}}else return(g&32)!==0?(k=O.avail_in-R,k=v>>3<k?v>>3:k,R+=k,P-=k,v-=k<<3,I.bitb=b,I.bitk=v,O.avail_in=R,O.total_in+=P-O.next_in_index,O.next_in_index=P,I.write=V,1):(O.msg="invalid literal/length code",k=O.avail_in-R,k=v>>3<k?v>>3:k,R+=k,P-=k,v-=k<<3,I.bitb=b,I.bitk=v,O.avail_in=R,O.total_in+=P-O.next_in_index,O.next_in_index=P,I.write=V,-3)}while(!0)}while(H>=258&&R>=10);return k=O.avail_in-R,k=v>>3<k?v>>3:k,R+=k,P-=k,v-=k<<3,I.bitb=b,I.bitk=v,O.avail_in=R,O.total_in+=P-O.next_in_index,O.next_in_index=P,I.write=V,0}t.init=function(x,T,E,S,w,D){n=g2,u=x,d=T,h=E,_=S,y=w,p=D,o=null},t.proc=function(x,T,E){let S,w,D,I=0,O=0,M=0,L,F,g,b;for(M=T.next_in_index,L=T.avail_in,I=x.bitb,O=x.bitk,F=x.write,g=F<x.read?x.read-F-1:x.end-F;;)switch(n){case g2:if(g>=258&&L>=10&&(x.bitb=I,x.bitk=O,T.avail_in=L,T.total_in+=M-T.next_in_index,T.next_in_index=M,x.write=F,E=C(u,d,h,_,y,p,x,T),M=T.next_in_index,L=T.avail_in,I=x.bitb,O=x.bitk,F=x.write,g=F<x.read?x.read-F-1:x.end-F,E!=0)){n=E==1?v9:y2;break}s=u,o=h,r=_,n=Fce;case Fce:for(S=s;O<S;){if(L!==0)E=0;else return x.bitb=I,x.bitk=O,T.avail_in=L,T.total_in+=M-T.next_in_index,T.next_in_index=M,x.write=F,x.inflate_flush(T,E);L--,I|=(T.read_byte(M++)&255)<<O,O+=8}if(w=(r+(I&Hl[S]))*3,I>>>=o[w+1],O-=o[w+1],D=o[w],D===0){a=o[w+2],n=zce;break}if((D&16)!==0){c=D&15,i=o[w+2],n=Nce;break}if((D&64)===0){s=D,r=w/3+o[w+2];break}if((D&32)!==0){n=v9;break}return n=y2,T.msg="invalid literal/length code",E=-3,x.bitb=I,x.bitk=O,T.avail_in=L,T.total_in+=M-T.next_in_index,T.next_in_index=M,x.write=F,x.inflate_flush(T,E);case Nce:for(S=c;O<S;){if(L!==0)E=0;else return x.bitb=I,x.bitk=O,T.avail_in=L,T.total_in+=M-T.next_in_index,T.next_in_index=M,x.write=F,x.inflate_flush(T,E);L--,I|=(T.read_byte(M++)&255)<<O,O+=8}i+=I&Hl[S],I>>=S,O-=S,s=d,o=y,r=p,n=Vce;case Vce:for(S=s;O<S;){if(L!==0)E=0;else return x.bitb=I,x.bitk=O,T.avail_in=L,T.total_in+=M-T.next_in_index,T.next_in_index=M,x.write=F,x.inflate_flush(T,E);L--,I|=(T.read_byte(M++)&255)<<O,O+=8}if(w=(r+(I&Hl[S]))*3,I>>=o[w+1],O-=o[w+1],D=o[w],(D&16)!==0){c=D&15,l=o[w+2],n=kce;break}if((D&64)===0){s=D,r=w/3+o[w+2];break}return n=y2,T.msg="invalid distance code",E=-3,x.bitb=I,x.bitk=O,T.avail_in=L,T.total_in+=M-T.next_in_index,T.next_in_index=M,x.write=F,x.inflate_flush(T,E);case kce:for(S=c;O<S;){if(L!==0)E=0;else return x.bitb=I,x.bitk=O,T.avail_in=L,T.total_in+=M-T.next_in_index,T.next_in_index=M,x.write=F,x.inflate_flush(T,E);L--,I|=(T.read_byte(M++)&255)<<O,O+=8}l+=I&Hl[S],I>>=S,O-=S,n=Uce;case Uce:for(b=F-l;b<0;)b+=x.end;for(;i!==0;){if(g===0&&(F==x.end&&x.read!==0&&(F=0,g=F<x.read?x.read-F-1:x.end-F),g===0&&(x.write=F,E=x.inflate_flush(T,E),F=x.write,g=F<x.read?x.read-F-1:x.end-F,F==x.end&&x.read!==0&&(F=0,g=F<x.read?x.read-F-1:x.end-F),g===0)))return x.bitb=I,x.bitk=O,T.avail_in=L,T.total_in+=M-T.next_in_index,T.next_in_index=M,x.write=F,x.inflate_flush(T,E);x.win[F++]=x.win[b++],g--,b==x.end&&(b=0),i--}n=g2;break;case zce:if(g===0&&(F==x.end&&x.read!==0&&(F=0,g=F<x.read?x.read-F-1:x.end-F),g===0&&(x.write=F,E=x.inflate_flush(T,E),F=x.write,g=F<x.read?x.read-F-1:x.end-F,F==x.end&&x.read!==0&&(F=0,g=F<x.read?x.read-F-1:x.end-F),g===0)))return x.bitb=I,x.bitk=O,T.avail_in=L,T.total_in+=M-T.next_in_index,T.next_in_index=M,x.write=F,x.inflate_flush(T,E);E=0,x.win[F++]=a,g--,n=g2;break;case v9:if(O>7&&(O-=8,L++,M--),x.write=F,E=x.inflate_flush(T,E),F=x.write,g=F<x.read?x.read-F-1:x.end-F,x.read!=x.write)return x.bitb=I,x.bitk=O,T.avail_in=L,T.total_in+=M-T.next_in_index,T.next_in_index=M,x.write=F,x.inflate_flush(T,E);n=Hce;case Hce:return E=1,x.bitb=I,x.bitk=O,T.avail_in=L,T.total_in+=M-T.next_in_index,T.next_in_index=M,x.write=F,x.inflate_flush(T,E);case y2:return E=-3,x.bitb=I,x.bitk=O,T.avail_in=L,T.total_in+=M-T.next_in_index,T.next_in_index=M,x.write=F,x.inflate_flush(T,E);default:return E=-2,x.bitb=I,x.bitk=O,T.avail_in=L,T.total_in+=M-T.next_in_index,T.next_in_index=M,x.write=F,x.inflate_flush(T,E)}},t.free=function(){}}var Gce=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],KT=0,P9=1,Wce=2,jce=3,qce=4,Yce=5,A2=6,C2=7,Xce=8,jy=9;function nqe(t,n){let i=this,o=KT,r=0,s=0,a=0,c,l=[0],u=[0],d=new tqe,h=0,_=new Int32Array(tle*3),y=0,p=new B9;i.bitk=0,i.bitb=0,i.win=new Uint8Array(n),i.end=n,i.read=0,i.write=0,i.reset=function(C,x){x&&(x[0]=y),o==A2&&d.free(C),o=KT,i.bitk=0,i.bitb=0,i.read=i.write=0},i.reset(t,null),i.inflate_flush=function(C,x){let T,E,S;return E=C.next_out_index,S=i.read,T=(S<=i.write?i.write:i.end)-S,T>C.avail_out&&(T=C.avail_out),T!==0&&x==-5&&(x=0),C.avail_out-=T,C.total_out+=T,C.next_out.set(i.win.subarray(S,S+T),E),E+=T,S+=T,S==i.end&&(S=0,i.write==i.end&&(i.write=0),T=i.write-S,T>C.avail_out&&(T=C.avail_out),T!==0&&x==-5&&(x=0),C.avail_out-=T,C.total_out+=T,C.next_out.set(i.win.subarray(S,S+T),E),E+=T,S+=T),C.next_out_index=E,i.read=S,x},i.proc=function(C,x){let T,E,S,w,D,I,O,M;for(w=C.next_in_index,D=C.avail_in,E=i.bitb,S=i.bitk,I=i.write,O=I<i.read?i.read-I-1:i.end-I;;){let L,F,g,b,v,P,R,V;switch(o){case KT:for(;S<3;){if(D!==0)x=0;else return i.bitb=E,i.bitk=S,C.avail_in=D,C.total_in+=w-C.next_in_index,C.next_in_index=w,i.write=I,i.inflate_flush(C,x);D--,E|=(C.read_byte(w++)&255)<<S,S+=8}switch(T=E&7,h=T&1,T>>>1){case 0:E>>>=3,S-=3,T=S&7,E>>>=T,S-=T,o=P9;break;case 1:L=[],F=[],g=[[]],b=[[]],B9.inflate_trees_fixed(L,F,g,b),d.init(L[0],F[0],g[0],0,b[0],0),E>>>=3,S-=3,o=A2;break;case 2:E>>>=3,S-=3,o=jce;break;case 3:return E>>>=3,S-=3,o=jy,C.msg="invalid block type",x=-3,i.bitb=E,i.bitk=S,C.avail_in=D,C.total_in+=w-C.next_in_index,C.next_in_index=w,i.write=I,i.inflate_flush(C,x)}break;case P9:for(;S<32;){if(D!==0)x=0;else return i.bitb=E,i.bitk=S,C.avail_in=D,C.total_in+=w-C.next_in_index,C.next_in_index=w,i.write=I,i.inflate_flush(C,x);D--,E|=(C.read_byte(w++)&255)<<S,S+=8}if((~E>>>16&65535)!=(E&65535))return o=jy,C.msg="invalid stored block lengths",x=-3,i.bitb=E,i.bitk=S,C.avail_in=D,C.total_in+=w-C.next_in_index,C.next_in_index=w,i.write=I,i.inflate_flush(C,x);r=E&65535,E=S=0,o=r!==0?Wce:h!==0?C2:KT;break;case Wce:if(D===0||O===0&&(I==i.end&&i.read!==0&&(I=0,O=I<i.read?i.read-I-1:i.end-I),O===0&&(i.write=I,x=i.inflate_flush(C,x),I=i.write,O=I<i.read?i.read-I-1:i.end-I,I==i.end&&i.read!==0&&(I=0,O=I<i.read?i.read-I-1:i.end-I),O===0)))return i.bitb=E,i.bitk=S,C.avail_in=D,C.total_in+=w-C.next_in_index,C.next_in_index=w,i.write=I,i.inflate_flush(C,x);if(x=0,T=r,T>D&&(T=D),T>O&&(T=O),i.win.set(C.read_buf(w,T),I),w+=T,D-=T,I+=T,O-=T,(r-=T)!==0)break;o=h!==0?C2:KT;break;case jce:for(;S<14;){if(D!==0)x=0;else return i.bitb=E,i.bitk=S,C.avail_in=D,C.total_in+=w-C.next_in_index,C.next_in_index=w,i.write=I,i.inflate_flush(C,x);D--,E|=(C.read_byte(w++)&255)<<S,S+=8}if(s=T=E&16383,(T&31)>29||(T>>5&31)>29)return o=jy,C.msg="too many length or distance symbols",x=-3,i.bitb=E,i.bitk=S,C.avail_in=D,C.total_in+=w-C.next_in_index,C.next_in_index=w,i.write=I,i.inflate_flush(C,x);if(T=258+(T&31)+(T>>5&31),!c||c.length<T)c=[];else for(M=0;M<T;M++)c[M]=0;E>>>=14,S-=14,a=0,o=qce;case qce:for(;a<4+(s>>>10);){for(;S<3;){if(D!==0)x=0;else return i.bitb=E,i.bitk=S,C.avail_in=D,C.total_in+=w-C.next_in_index,C.next_in_index=w,i.write=I,i.inflate_flush(C,x);D--,E|=(C.read_byte(w++)&255)<<S,S+=8}c[Gce[a++]]=E&7,E>>>=3,S-=3}for(;a<19;)c[Gce[a++]]=0;if(l[0]=7,T=p.inflate_trees_bits(c,l,u,_,C),T!=0)return x=T,x==-3&&(c=null,o=jy),i.bitb=E,i.bitk=S,C.avail_in=D,C.total_in+=w-C.next_in_index,C.next_in_index=w,i.write=I,i.inflate_flush(C,x);a=0,o=Yce;case Yce:for(;T=s,!(a>=258+(T&31)+(T>>5&31));){let H,U;for(T=l[0];S<T;){if(D!==0)x=0;else return i.bitb=E,i.bitk=S,C.avail_in=D,C.total_in+=w-C.next_in_index,C.next_in_index=w,i.write=I,i.inflate_flush(C,x);D--,E|=(C.read_byte(w++)&255)<<S,S+=8}if(T=_[(u[0]+(E&Hl[T]))*3+1],U=_[(u[0]+(E&Hl[T]))*3+2],U<16)E>>>=T,S-=T,c[a++]=U;else{for(M=U==18?7:U-14,H=U==18?11:3;S<T+M;){if(D!==0)x=0;else return i.bitb=E,i.bitk=S,C.avail_in=D,C.total_in+=w-C.next_in_index,C.next_in_index=w,i.write=I,i.inflate_flush(C,x);D--,E|=(C.read_byte(w++)&255)<<S,S+=8}if(E>>>=T,S-=T,H+=E&Hl[M],E>>>=M,S-=M,M=a,T=s,M+H>258+(T&31)+(T>>5&31)||U==16&&M<1)return c=null,o=jy,C.msg="invalid bit length repeat",x=-3,i.bitb=E,i.bitk=S,C.avail_in=D,C.total_in+=w-C.next_in_index,C.next_in_index=w,i.write=I,i.inflate_flush(C,x);U=U==16?c[M-1]:0;do c[M++]=U;while(--H!==0);a=M}}if(u[0]=-1,v=[],P=[],R=[],V=[],v[0]=9,P[0]=6,T=s,T=p.inflate_trees_dynamic(257+(T&31),1+(T>>5&31),c,v,P,R,V,_,C),T!=0)return T==-3&&(c=null,o=jy),x=T,i.bitb=E,i.bitk=S,C.avail_in=D,C.total_in+=w-C.next_in_index,C.next_in_index=w,i.write=I,i.inflate_flush(C,x);d.init(v[0],P[0],_,R[0],_,V[0]),o=A2;case A2:if(i.bitb=E,i.bitk=S,C.avail_in=D,C.total_in+=w-C.next_in_index,C.next_in_index=w,i.write=I,(x=d.proc(i,C,x))!=1)return i.inflate_flush(C,x);if(x=0,d.free(C),w=C.next_in_index,D=C.avail_in,E=i.bitb,S=i.bitk,I=i.write,O=I<i.read?i.read-I-1:i.end-I,h===0){o=KT;break}o=C2;case C2:if(i.write=I,x=i.inflate_flush(C,x),I=i.write,O=I<i.read?i.read-I-1:i.end-I,i.read!=i.write)return i.bitb=E,i.bitk=S,C.avail_in=D,C.total_in+=w-C.next_in_index,C.next_in_index=w,i.write=I,i.inflate_flush(C,x);o=Xce;case Xce:return x=1,i.bitb=E,i.bitk=S,C.avail_in=D,C.total_in+=w-C.next_in_index,C.next_in_index=w,i.write=I,i.inflate_flush(C,x);case jy:return x=-3,i.bitb=E,i.bitk=S,C.avail_in=D,C.total_in+=w-C.next_in_index,C.next_in_index=w,i.write=I,i.inflate_flush(C,x);default:return x=-2,i.bitb=E,i.bitk=S,C.avail_in=D,C.total_in+=w-C.next_in_index,C.next_in_index=w,i.write=I,i.inflate_flush(C,x)}}},i.free=function(C){i.reset(C,null),i.win=null,_=null},i.set_dictionary=function(C,x,T){i.win.set(C.subarray(x,x+T),0),i.read=i.write=T},i.sync_point=function(){return o==P9?1:0}}var iqe=32,oqe=8,rqe=0,Kce=1,Jce=2,Zce=3,Qce=4,$ce=5,I9=6,_D=7,ele=12,yg=13,sqe=[0,0,255,255];function aqe(){let t=this;t.mode=0,t.method=0,t.was=[0],t.need=0,t.marker=0,t.wbits=0;function n(i){return!i||!i.istate?-2:(i.total_in=i.total_out=0,i.msg=null,i.istate.mode=_D,i.istate.blocks.reset(i,null),0)}t.inflateEnd=function(i){return t.blocks&&t.blocks.free(i),t.blocks=null,0},t.inflateInit=function(i,o){return i.msg=null,t.blocks=null,o<8||o>15?(t.inflateEnd(i),-2):(t.wbits=o,i.istate.blocks=new nqe(i,1<<o),n(i),0)},t.inflate=function(i,o){let r,s;if(!i||!i.istate||!i.next_in)return-2;let a=i.istate;for(o=o==qje?-5:0,r=-5;;)switch(a.mode){case rqe:if(i.avail_in===0)return r;if(r=o,i.avail_in--,i.total_in++,((a.method=i.read_byte(i.next_in_index++))&15)!=oqe){a.mode=yg,i.msg="unknown compression method",a.marker=5;break}if((a.method>>4)+8>a.wbits){a.mode=yg,i.msg="invalid win size",a.marker=5;break}a.mode=Kce;case Kce:if(i.avail_in===0)return r;if(r=o,i.avail_in--,i.total_in++,s=i.read_byte(i.next_in_index++)&255,((a.method<<8)+s)%31!==0){a.mode=yg,i.msg="incorrect header check",a.marker=5;break}if((s&iqe)===0){a.mode=_D;break}a.mode=Jce;case Jce:if(i.avail_in===0)return r;r=o,i.avail_in--,i.total_in++,a.need=(i.read_byte(i.next_in_index++)&255)<<24&4278190080,a.mode=Zce;case Zce:if(i.avail_in===0)return r;r=o,i.avail_in--,i.total_in++,a.need+=(i.read_byte(i.next_in_index++)&255)<<16&16711680,a.mode=Qce;case Qce:if(i.avail_in===0)return r;r=o,i.avail_in--,i.total_in++,a.need+=(i.read_byte(i.next_in_index++)&255)<<8&65280,a.mode=$ce;case $ce:return i.avail_in===0?r:(r=o,i.avail_in--,i.total_in++,a.need+=i.read_byte(i.next_in_index++)&255,a.mode=I9,2);case I9:return a.mode=yg,i.msg="need dictionary",a.marker=0,-2;case _D:if(r=a.blocks.proc(i,r),r==-3){a.mode=yg,a.marker=0;break}if(r==0&&(r=o),r!=1)return r;r=o,a.blocks.reset(i,a.was),a.mode=ele;case ele:return i.avail_in=0,1;case yg:return-3;default:return-2}},t.inflateSetDictionary=function(i,o,r){let s=0,a=r;if(!i||!i.istate||i.istate.mode!=I9)return-2;let c=i.istate;return a>=1<<c.wbits&&(a=(1<<c.wbits)-1,s=r-a),c.blocks.set_dictionary(o,s,a),c.mode=_D,0},t.inflateSync=function(i){let o,r,s,a,c;if(!i||!i.istate)return-2;let l=i.istate;if(l.mode!=yg&&(l.mode=yg,l.marker=0),(o=i.avail_in)===0)return-5;for(r=i.next_in_index,s=l.marker;o!==0&&s<4;)i.read_byte(r)==sqe[s]?s++:i.read_byte(r)!==0?s=0:s=4-s,r++,o--;return i.total_in+=r-i.next_in_index,i.next_in_index=r,i.avail_in=o,l.marker=s,s!=4?-3:(a=i.total_in,c=i.total_out,n(i),i.total_in=a,i.total_out=c,l.mode=_D,0)},t.inflateSyncPoint=function(i){return!i||!i.istate||!i.istate.blocks?-2:i.istate.blocks.sync_point()}}function nle(){}nle.prototype={inflateInit:function(t){let n=this;return n.istate=new aqe,t||(t=15),n.istate.inflateInit(n,t)},inflate:function(t){let n=this;return n.istate?n.istate.inflate(n,t):-2},inflateEnd:function(){let t=this;if(!t.istate)return-2;let n=t.istate.inflateEnd(t);return t.istate=null,n},inflateSync:function(){let t=this;return t.istate?t.istate.inflateSync(t):-2},inflateSetDictionary:function(t,n){let i=this;return i.istate?i.istate.inflateSetDictionary(i,t,n):-2},read_byte:function(t){return this.next_in[t]},read_buf:function(t,n){return this.next_in.subarray(t,t+n)}};function cqe(t){let n=this,i=new nle,o=t&&t.chunkSize?Math.floor(t.chunkSize*2):128*1024,r=jje,s=new Uint8Array(o),a=!1;i.inflateInit(),i.next_out=s,n.append=function(c,l){let u=[],d,h,_=0,y=0,p=0;if(c.length!==0){i.next_in_index=0,i.next_in=c,i.avail_in=c.length;do{if(i.next_out_index=0,i.avail_out=o,i.avail_in===0&&!a&&(i.next_in_index=0,a=!0),d=i.inflate(r),a&&d===-5){if(i.avail_in!==0)throw new Error("inflating: bad input")}else if(d!==0&&d!==1)throw new Error("inflating: "+i.msg);if((a||d===1)&&i.avail_in===c.length)throw new Error("inflating: bad input");i.next_out_index&&(i.next_out_index===o?u.push(new Uint8Array(s)):u.push(s.slice(0,i.next_out_index))),p+=i.next_out_index,l&&i.next_in_index>0&&i.next_in_index!=_&&(l(i.next_in_index),_=i.next_in_index)}while(i.avail_in>0||i.avail_out===0);return u.length>1?(h=new Uint8Array(p),u.forEach(function(C){h.set(C,y),y+=C.length})):h=u[0]||new Uint8Array(0),h}},n.flush=function(){i.inflateEnd()}}var ile=cqe;var lqe={chunkSize:524288,maxWorkers:typeof navigator!="undefined"&&navigator.hardwareConcurrency||2,terminateWorkerTimeout:5e3,useWebWorkers:!0,workerScripts:void 0},ol=Object.assign({},lqe);function x2(){return ol}function JT(t){if(t.baseURL!==void 0&&(ol.baseURL=t.baseURL),t.chunkSize!==void 0&&(ol.chunkSize=t.chunkSize),t.maxWorkers!==void 0&&(ol.maxWorkers=t.maxWorkers),t.terminateWorkerTimeout!==void 0&&(ol.terminateWorkerTimeout=t.terminateWorkerTimeout),t.useWebWorkers!==void 0&&(ol.useWebWorkers=t.useWebWorkers),t.Deflate!==void 0&&(ol.Deflate=t.Deflate),t.Inflate!==void 0&&(ol.Inflate=t.Inflate),t.workerScripts!==void 0){if(t.workerScripts.deflate){if(!Array.isArray(t.workerScripts.deflate))throw new Error("workerScripts.deflate must be an array");ol.workerScripts||(ol.workerScripts={}),ol.workerScripts.deflate=t.workerScripts.deflate}if(t.workerScripts.inflate){if(!Array.isArray(t.workerScripts.inflate))throw new Error("workerScripts.inflate must be an array");ol.workerScripts||(ol.workerScripts={}),ol.workerScripts.inflate=t.workerScripts.inflate}}}var ole=[];for(let t=0;t<256;t++){let n=t;for(let i=0;i<8;i++)n&1?n=n>>>1^3988292384:n=n>>>1;ole[t]=n}var O9=class{constructor(n){this.crc=n||-1}append(n){let i=this.crc|0;for(let o=0,r=n.length|0;o<r;o++)i=i>>>8^ole[(i^n[o])&255];this.crc=i}get(){return~this.crc}},Ag=O9;var gD=uqe;function uqe(t){if(typeof TextEncoder=="undefined"){t=unescape(encodeURIComponent(t));let n=new Uint8Array(t.length);for(let i=0;i<n.length;i++)n[i]=t.charCodeAt(i);return n}else return new TextEncoder().encode(t)}var Cc={concat(t,n){if(t.length===0||n.length===0)return t.concat(n);let i=t[t.length-1],o=Cc.getPartial(i);return o===32?t.concat(n):Cc._shiftRight(n,o,i|0,t.slice(0,t.length-1))},bitLength(t){let n=t.length;if(n===0)return 0;let i=t[n-1];return(n-1)*32+Cc.getPartial(i)},clamp(t,n){if(t.length*32<n)return t;t=t.slice(0,Math.ceil(n/32));let i=t.length;return n=n&31,i>0&&n&&(t[i-1]=Cc.partial(n,t[i-1]&2147483648>>n-1,1)),t},partial(t,n,i){return t===32?n:(i?n|0:n<<32-t)+t*1099511627776},getPartial(t){return Math.round(t/1099511627776)||32},_shiftRight(t,n,i,o){for(o===void 0&&(o=[]);n>=32;n-=32)o.push(i),i=0;if(n===0)return o.concat(t);for(let a=0;a<t.length;a++)o.push(i|t[a]>>>n),i=t[a]<<32-n;let r=t.length?t[t.length-1]:0,s=Cc.getPartial(r);return o.push(Cc.partial(n+s&31,n+s>32?i:o.pop(),1)),o}},yD={bytes:{fromBits(t){let i=Cc.bitLength(t)/8,o=new Uint8Array(i),r;for(let s=0;s<i;s++)(s&3)===0&&(r=t[s/4]),o[s]=r>>>24,r<<=8;return o},toBits(t){let n=[],i,o=0;for(i=0;i<t.length;i++)o=o<<8|t[i],(i&3)===3&&(n.push(o),o=0);return i&3&&n.push(Cc.partial(8*(i&3),o)),n}}},R9={};R9.sha1=function(t){t?(this._h=t._h.slice(0),this._buffer=t._buffer.slice(0),this._length=t._length):this.reset()};R9.sha1.prototype={blockSize:512,reset:function(){let t=this;return t._h=this._init.slice(0),t._buffer=[],t._length=0,t},update:function(t){let n=this;typeof t=="string"&&(t=yD.utf8String.toBits(t));let i=n._buffer=Cc.concat(n._buffer,t),o=n._length,r=n._length=o+Cc.bitLength(t);if(r>9007199254740991)throw new Error("Cannot hash more than 2^53 - 1 bits");let s=new Uint32Array(i),a=0;for(let c=n.blockSize+o-(n.blockSize+o&n.blockSize-1);c<=r;c+=n.blockSize)n._block(s.subarray(16*a,16*(a+1))),a+=1;return i.splice(0,16*a),n},finalize:function(){let t=this,n=t._buffer,i=t._h;n=Cc.concat(n,[Cc.partial(1,1)]);for(let o=n.length+2;o&15;o++)n.push(0);for(n.push(Math.floor(t._length/4294967296)),n.push(t._length|0);n.length;)t._block(n.splice(0,16));return t.reset(),i},_init:[1732584193,4023233417,2562383102,271733878,3285377520],_key:[1518500249,1859775393,2400959708,3395469782],_f:function(t,n,i,o){if(t<=19)return n&i|~n&o;if(t<=39)return n^i^o;if(t<=59)return n&i|n&o|i&o;if(t<=79)return n^i^o},_S:function(t,n){return n<<t|n>>>32-t},_block:function(t){let n=this,i=n._h,o=Array(80);for(let u=0;u<16;u++)o[u]=t[u];let r=i[0],s=i[1],a=i[2],c=i[3],l=i[4];for(let u=0;u<=79;u++){u>=16&&(o[u]=n._S(1,o[u-3]^o[u-8]^o[u-14]^o[u-16]));let d=n._S(5,r)+n._f(u,s,a,c)+l+o[u]+n._key[Math.floor(u/20)]|0;l=c,c=a,a=n._S(30,s),s=r,r=d}i[0]=i[0]+r|0,i[1]=i[1]+s|0,i[2]=i[2]+a|0,i[3]=i[3]+c|0,i[4]=i[4]+l|0}};var M9={};M9.aes=class{constructor(t){let n=this;n._tables=[[[],[],[],[],[]],[[],[],[],[],[]]],n._tables[0][0][0]||n._precompute();let i=n._tables[0][4],o=n._tables[1],r=t.length,s,a,c,l=1;if(r!==4&&r!==6&&r!==8)throw new Error("invalid aes key size");for(n._key=[a=t.slice(0),c=[]],s=r;s<4*r+28;s++){let u=a[s-1];(s%r===0||r===8&&s%r===4)&&(u=i[u>>>24]<<24^i[u>>16&255]<<16^i[u>>8&255]<<8^i[u&255],s%r===0&&(u=u<<8^u>>>24^l<<24,l=l<<1^(l>>7)*283)),a[s]=a[s-r]^u}for(let u=0;s;u++,s--){let d=a[u&3?s:s-4];s<=4||u<4?c[u]=d:c[u]=o[0][i[d>>>24]]^o[1][i[d>>16&255]]^o[2][i[d>>8&255]]^o[3][i[d&255]]}}encrypt(t){return this._crypt(t,0)}decrypt(t){return this._crypt(t,1)}_precompute(){let t=this._tables[0],n=this._tables[1],i=t[4],o=n[4],r=[],s=[],a,c,l,u;for(let d=0;d<256;d++)s[(r[d]=d<<1^(d>>7)*283)^d]=d;for(let d=a=0;!i[d];d^=c||1,a=s[a]||1){let h=a^a<<1^a<<2^a<<3^a<<4;h=h>>8^h&255^99,i[d]=h,o[h]=d,u=r[l=r[c=r[d]]];let _=u*16843009^l*65537^c*257^d*16843008,y=r[h]*257^h*16843008;for(let p=0;p<4;p++)t[p][d]=y=y<<24^y>>>8,n[p][h]=_=_<<24^_>>>8}for(let d=0;d<5;d++)t[d]=t[d].slice(0),n[d]=n[d].slice(0)}_crypt(t,n){if(t.length!==4)throw new Error("invalid aes block size");let i=this._key[n],o=i.length/4-2,r=[0,0,0,0],s=this._tables[n],a=s[0],c=s[1],l=s[2],u=s[3],d=s[4],h=t[0]^i[0],_=t[n?3:1]^i[1],y=t[2]^i[2],p=t[n?1:3]^i[3],C=4,x,T,E;for(let S=0;S<o;S++)x=a[h>>>24]^c[_>>16&255]^l[y>>8&255]^u[p&255]^i[C],T=a[_>>>24]^c[y>>16&255]^l[p>>8&255]^u[h&255]^i[C+1],E=a[y>>>24]^c[p>>16&255]^l[h>>8&255]^u[_&255]^i[C+2],p=a[p>>>24]^c[h>>16&255]^l[_>>8&255]^u[y&255]^i[C+3],C+=4,h=x,_=T,y=E;for(let S=0;S<4;S++)r[n?3&-S:S]=d[h>>>24]<<24^d[_>>16&255]<<16^d[y>>8&255]<<8^d[p&255]^i[C++],x=h,h=_,_=y,y=p,p=x;return r}};var rle={getRandomValues(t){let n=new Uint32Array(t.buffer),i=o=>{let r=987654321,s=4294967295;return function(){return r=36969*(r&65535)+(r>>16)&s,o=18e3*(o&65535)+(o>>16)&s,(((r<<16)+o&s)/4294967296+.5)*(Math.random()>.5?1:-1)}};for(let o=0,r;o<t.length;o+=4){let s=i((r||Math.random())*4294967296);r=s()*987654071,n[o/4]=s()*4294967296|0}return t}},L9={};L9.ctrGladman=class{constructor(t,n){this._prf=t,this._initIv=n,this._iv=n}reset(){this._iv=this._initIv}update(t){return this.calculate(this._prf,t,this._iv)}incWord(t){if((t>>24&255)===255){let n=t>>16&255,i=t>>8&255,o=t&255;n===255?(n=0,i===255?(i=0,o===255?o=0:++o):++i):++n,t=0,t+=n<<16,t+=i<<8,t+=o}else t+=1<<24;return t}incCounter(t){(t[0]=this.incWord(t[0]))===0&&(t[1]=this.incWord(t[1]))}calculate(t,n,i){let o;if(!(o=n.length))return[];let r=Cc.bitLength(n);for(let s=0;s<o;s+=4){this.incCounter(i);let a=t.encrypt(i);n[s]^=a[0],n[s+1]^=a[1],n[s+2]^=a[2],n[s+3]^=a[3]}return Cc.clamp(n,r)}};var ZT={importKey(t){return new ZT.hmacSha1(yD.bytes.toBits(t))},pbkdf2(t,n,i,o){if(i=i||1e4,o<0||i<0)throw new Error("invalid params to pbkdf2");let r=(o>>5)+1<<2,s,a,c,l,u,d=new ArrayBuffer(r),h=new DataView(d),_=0,y=Cc;for(n=yD.bytes.toBits(n),u=1;_<(r||1);u++){for(s=a=t.encrypt(y.concat(n,[u])),c=1;c<i;c++)for(a=t.encrypt(a),l=0;l<a.length;l++)s[l]^=a[l];for(c=0;_<(r||1)&&c<s.length;c++)h.setInt32(_,s[c]),_+=4}return d.slice(0,o/8)}};ZT.hmacSha1=class{constructor(t){let n=this,i=n._hash=R9.sha1,o=[[],[]],r=i.prototype.blockSize/32;n._baseHash=[new i,new i],t.length>r&&(t=i.hash(t));for(let s=0;s<r;s++)o[0][s]=t[s]^909522486,o[1][s]=t[s]^1549556828;n._baseHash[0].update(o[0]),n._baseHash[1].update(o[1]),n._resultHash=new i(n._baseHash[0])}reset(){let t=this;t._resultHash=new t._hash(t._baseHash[0]),t._updated=!1}update(t){let n=this;n._updated=!0,n._resultHash.update(t)}digest(){let t=this,n=t._resultHash.finalize(),i=new t._hash(t._baseHash[1]).update(n).finalize();return t.reset(),i}encrypt(t){if(this._updated)throw new Error("encrypt on already updated hmac called!");return this.update(t),this.digest(t)}};var $T="Invalid pasword",QT=16,fqe="raw",sle={name:"PBKDF2"},dqe={name:"HMAC"},hqe="SHA-1",mqe=Object.assign({hash:dqe},sle),ale=Object.assign({iterations:1e3,hash:{name:hqe}},sle),pqe=["deriveBits"],CD=[8,12,16],AD=[16,24,32],Cg=10,cle=[0,0,0,0],b2=typeof crypto!="undefined",lle=b2&&typeof crypto.subtle!="undefined",vh=yD.bytes,ule=M9.aes,fle=L9.ctrGladman,dle=ZT.hmacSha1,T2=class{constructor(n,i,o){Object.assign(this,{password:n,signed:i,strength:o-1,pendingInput:new Uint8Array(0)})}async append(n){let i=this;if(i.password){let r=Gl(n,0,CD[i.strength]+2);await _qe(i,r,i.password),i.password=null,i.aesCtrGladman=new fle(new ule(i.keys.key),Array.from(cle)),i.hmac=new dle(i.keys.authentication),n=Gl(n,CD[i.strength]+2)}let o=new Uint8Array(n.length-Cg-(n.length-Cg)%QT);return hle(i,n,o,0,Cg,!0)}flush(){let n=this,i=n.pendingInput,o=Gl(i,0,i.length-Cg),r=Gl(i,i.length-Cg),s=new Uint8Array(0);if(o.length){let c=vh.toBits(o);n.hmac.update(c);let l=n.aesCtrGladman.update(c);s=vh.fromBits(l)}let a=!0;if(n.signed){let c=Gl(vh.fromBits(n.hmac.digest()),0,Cg);for(let l=0;l<Cg;l++)c[l]!=r[l]&&(a=!1)}return{valid:a,data:s}}},E2=class{constructor(n,i){Object.assign(this,{password:n,strength:i-1,pendingInput:new Uint8Array(0)})}async append(n){let i=this,o=new Uint8Array(0);i.password&&(o=await gqe(i,i.password),i.password=null,i.aesCtrGladman=new fle(new ule(i.keys.key),Array.from(cle)),i.hmac=new dle(i.keys.authentication));let r=new Uint8Array(o.length+n.length-n.length%QT);return r.set(o,0),hle(i,n,r,o.length,0)}flush(){let n=this,i=new Uint8Array(0);if(n.pendingInput.length){let r=n.aesCtrGladman.update(vh.toBits(n.pendingInput));n.hmac.update(r),i=vh.fromBits(r)}let o=Gl(vh.fromBits(n.hmac.digest()),0,Cg);return{data:F9(i,o),signature:o}}};function hle(t,n,i,o,r,s){let a=n.length-r;t.pendingInput.length&&(n=F9(t.pendingInput,n),i=xqe(i,a-a%QT));let c;for(c=0;c<=a-QT;c+=QT){let l=vh.toBits(Gl(n,c,c+QT));s&&t.hmac.update(l);let u=t.aesCtrGladman.update(l);s||t.hmac.update(u),i.set(vh.fromBits(u),c+o)}return t.pendingInput=Gl(n,c),i}async function _qe(t,n,i){await mle(t,i,Gl(n,0,CD[t.strength]));let o=Gl(n,CD[t.strength]),r=t.keys.passwordVerification;if(r[0]!=o[0]||r[1]!=o[1])throw new Error($T)}async function gqe(t,n){let i=yqe(new Uint8Array(CD[t.strength]));return await mle(t,n,i),F9(i,t.keys.passwordVerification)}async function mle(t,n,i){let o=gD(n),r=await Aqe(fqe,o,mqe,!1,pqe),s=await Cqe(Object.assign({salt:i},ale),r,8*(AD[t.strength]*2+2)),a=new Uint8Array(s);t.keys={key:vh.toBits(Gl(a,0,AD[t.strength])),authentication:vh.toBits(Gl(a,AD[t.strength],AD[t.strength]*2)),passwordVerification:Gl(a,AD[t.strength]*2)}}function yqe(t){return b2&&typeof crypto.getRandomValues=="function"?crypto.getRandomValues(t):rle.getRandomValues(t)}function Aqe(t,n,i,o,r){return b2&&lle&&typeof crypto.subtle.importKey=="function"?crypto.subtle.importKey(t,n,i,o,r):ZT.importKey(n)}async function Cqe(t,n,i){return b2&&lle&&typeof crypto.subtle.deriveBits=="function"?await crypto.subtle.deriveBits(t,n,i):ZT.pbkdf2(n,t.salt,ale.iterations,i)}function F9(t,n){let i=t;return t.length+n.length&&(i=new Uint8Array(t.length+n.length),i.set(t,0),i.set(n,t.length)),i}function xqe(t,n){if(n&&n>t.length){let i=t;t=new Uint8Array(n),t.set(i,0)}return t}function Gl(t,n,i){return t.subarray(n,i)}var eE=12,S2=class{constructor(n,i){let o=this;Object.assign(o,{password:n,passwordVerification:i}),yle(o,n)}append(n){let i=this;if(i.password){let o=ple(i,n.subarray(0,eE));if(i.password=null,o[eE-1]!=i.passwordVerification)throw new Error($T);n=n.subarray(eE)}return ple(i,n)}flush(){return{valid:!0,data:new Uint8Array(0)}}},w2=class{constructor(n,i){let o=this;Object.assign(o,{password:n,passwordVerification:i}),yle(o,n)}append(n){let i=this,o,r;if(i.password){i.password=null;let s=crypto.getRandomValues(new Uint8Array(eE));s[eE-1]=i.passwordVerification,o=new Uint8Array(n.length+s.length),o.set(_le(i,s),0),r=eE}else o=new Uint8Array(n.length),r=0;return o.set(_le(i,n),r),o}flush(){return{data:new Uint8Array(0)}}};function ple(t,n){let i=new Uint8Array(n.length);for(let o=0;o<n.length;o++)i[o]=Ale(t)^n[o],N9(t,i[o]);return i}function _le(t,n){let i=new Uint8Array(n.length);for(let o=0;o<n.length;o++)i[o]=Ale(t)^n[o],N9(t,n[o]);return i}function yle(t,n){t.keys=[305419896,591751049,878082192],t.crcKey0=new Ag(t.keys[0]),t.crcKey2=new Ag(t.keys[2]);for(let i=0;i<n.length;i++)N9(t,n.charCodeAt(i))}function N9(t,n){t.crcKey0.append([n]),t.keys[0]=~t.crcKey0.get(),t.keys[1]=gle(t.keys[1]+Cle(t.keys[0])),t.keys[1]=gle(Math.imul(t.keys[1],134775813)+1),t.crcKey2.append([t.keys[1]>>>24]),t.keys[2]=~t.crcKey2.get()}function Ale(t){let n=t.keys[2]|2;return Cle(Math.imul(n,n^1)>>>8)}function Cle(t){return t&255}function gle(t){return t&4294967295}var v2="deflate",P2="inflate",D2="Invalid signature",V9=class{constructor(n,{signature:i,password:o,signed:r,compressed:s,zipCrypto:a,passwordVerification:c,encryptionStrength:l},{chunkSize:u}){let d=Boolean(o);Object.assign(this,{signature:i,encrypted:d,signed:r,compressed:s,inflate:s&&new n({chunkSize:u}),crc32:r&&new Ag,zipCrypto:a,decrypt:d&&a?new S2(o,c):new T2(o,r,l)})}async append(n){let i=this;return i.encrypted&&n.length&&(n=await i.decrypt.append(n)),i.compressed&&n.length&&(n=await i.inflate.append(n)),(!i.encrypted||i.zipCrypto)&&i.signed&&n.length&&i.crc32.append(n),n}async flush(){let n=this,i,o=new Uint8Array(0);if(n.encrypted){let r=n.decrypt.flush();if(!r.valid)throw new Error(D2);o=r.data}if((!n.encrypted||n.zipCrypto)&&n.signed){let r=new DataView(new Uint8Array(4).buffer);if(i=n.crc32.get(),r.setUint32(0,i),n.signature!=r.getUint32(0,!1))throw new Error(D2)}return n.compressed&&(o=await n.inflate.append(o)||new Uint8Array(0),await n.inflate.flush()),{data:o,signature:i}}},k9=class{constructor(n,{encrypted:i,signed:o,compressed:r,level:s,zipCrypto:a,password:c,passwordVerification:l,encryptionStrength:u},{chunkSize:d}){Object.assign(this,{encrypted:i,signed:o,compressed:r,deflate:r&&new n({level:s||5,chunkSize:d}),crc32:o&&new Ag,zipCrypto:a,encrypt:i&&a?new w2(c,l):new E2(c,u)})}async append(n){let i=this,o=n;return i.compressed&&n.length&&(o=await i.deflate.append(n)),i.encrypted&&o.length&&(o=await i.encrypt.append(o)),(!i.encrypted||i.zipCrypto)&&i.signed&&n.length&&i.crc32.append(n),o}async flush(){let n=this,i,o=new Uint8Array(0);if(n.compressed&&(o=await n.deflate.flush()||new Uint8Array(0)),n.encrypted){o=await n.encrypt.append(o);let r=n.encrypt.flush();i=r.signature;let s=new Uint8Array(o.length+r.data.length);s.set(o,0),s.set(r.data,o.length),o=s}return(!n.encrypted||n.zipCrypto)&&n.signed&&(i=n.crc32.get()),{data:o,signature:i}}};function xle(t,n,i){if(n.codecType.startsWith(v2))return new k9(t,n,i);if(n.codecType.startsWith(P2))return new V9(t,n,i)}var Tle="init",Ele="append",U9="flush",Tqe="message",ble=!0,I2=(t,n,i,o,r,s,a)=>(Object.assign(t,{busy:!0,codecConstructor:n,options:Object.assign({},i),scripts:a,terminate(){t.worker&&!t.busy&&(t.worker.terminate(),t.interface=null)},onTaskFinished(){t.busy=!1,r(t)}}),s?bqe(t,o):Eqe(t,o));function Eqe(t,n){let i=xle(t.codecConstructor,t.options,n);return{async append(o){try{return await i.append(o)}catch(r){throw t.onTaskFinished(),r}},async flush(){try{return await i.flush()}finally{t.onTaskFinished()}},abort(){t.onTaskFinished()}}}function bqe(t,n){let i,o={type:"module"};if(!t.interface){if(!ble)t.worker=r(o,n.baseURL);else try{t.worker=r({},n.baseURL)}catch(l){ble=!1,t.worker=r(o,n.baseURL)}t.worker.addEventListener(Tqe,c,!1),t.interface={append(l){return s({type:Ele,data:l})},flush(){return s({type:U9})},abort(){t.onTaskFinished()}}}return t.interface;function r(l,u){let d,h;d=t.scripts[0],typeof d=="function"&&(d=d());try{h=new URL(d,u)}catch(_){h=d}return new Worker(h,l)}async function s(l){if(!i){let u=t.options,d=t.scripts.slice(1);await a({scripts:d,type:Tle,options:u,config:{chunkSize:n.chunkSize}})}return a(l)}function a(l){let u=t.worker,d=new Promise((h,_)=>i={resolve:h,reject:_});try{if(l.data)try{l.data=l.data.buffer,u.postMessage(l,[l.data])}catch(h){u.postMessage(l)}else u.postMessage(l)}catch(h){i.reject(h),i=null,t.onTaskFinished()}return d}function c(l){let u=l.data;if(i){let d=u.error,h=u.type;if(d){let _=new Error(d.message);_.stack=d.stack,i.reject(_),i=null,t.onTaskFinished()}else if(h==Tle||h==U9||h==Ele){let _=u.data;h==U9?(i.resolve({data:new Uint8Array(_),signature:u.signature}),i=null,t.onTaskFinished()):i.resolve(_&&new Uint8Array(_))}}}}var qy=[],z9=[];function B2(t,n,i){let r=!(!n.compressed&&!n.signed&&!n.encrypted)&&(n.useWebWorkers||n.useWebWorkers===void 0&&i.useWebWorkers),s=r&&i.workerScripts?i.workerScripts[n.codecType]:[];if(qy.length<i.maxWorkers){let c={};return qy.push(c),I2(c,t,n,i,a,r,s)}else{let c=qy.find(l=>!l.busy);return c?(Sle(c),I2(c,t,n,i,a,r,s)):new Promise(l=>z9.push({resolve:l,codecConstructor:t,options:n,webWorker:r,scripts:s}))}function a(c){if(z9.length){let[{resolve:l,codecConstructor:u,options:d,webWorker:h,scripts:_}]=z9.splice(0,1);l(I2(c,u,d,i,a,h,_))}else c.worker?(Sle(c),Number.isFinite(i.terminateWorkerTimeout)&&i.terminateWorkerTimeout>=0&&(c.terminateTimeout=setTimeout(()=>{qy=qy.filter(l=>l!=c),c.terminate()},i.terminateWorkerTimeout))):qy=qy.filter(l=>l!=c)}}function Sle(t){t.terminateTimeout&&(clearTimeout(t.terminateTimeout),t.terminateTimeout=null)}var Dle="Abort error";async function O2(t,n,i,o,r,s,a){let c=Math.max(s.chunkSize,64);return l();async function l(u=0,d=0){let h=a.signal,_=r();if(u<_){H9(h,t);let y=await n.readUint8Array(u+o,Math.min(c,_-u)),p=y.length;H9(h,t);let C=await t.append(y);if(H9(h,t),d+=await wle(i,C),a.onprogress)try{a.onprogress(u+p,_)}catch(x){}return l(u+c,d)}else{let y=await t.flush();return d+=await wle(i,y.data),{signature:y.signature,length:d}}}}function H9(t,n){if(t&&t.aborted)throw n.abort(),new Error(Dle)}async function wle(t,n){return n.length&&await t.writeUint8Array(n),n.length}var G9="text/plain";var R2=class{constructor(){this.size=0}init(){this.initialized=!0}},M2=class extends R2{},xD=class extends R2{writeUint8Array(n){this.size+=n.length}},L2=class extends M2{constructor(n){super(),this.blobReader=new Yy(new Blob([n],{type:G9}))}init(){super.init(),this.blobReader.init(),this.size=this.blobReader.size}readUint8Array(n,i){return this.blobReader.readUint8Array(n,i)}},F2=class extends xD{constructor(n){super(),this.encoding=n,this.blob=new Blob([],{type:G9})}writeUint8Array(n){super.writeUint8Array(n),this.blob=new Blob([this.blob,n.buffer],{type:G9})}getData(){if(this.blob.text)return this.blob.text();{let n=new FileReader;return new Promise((i,o)=>{n.onload=r=>i(r.target.result),n.onerror=()=>o(n.error),n.readAsText(this.blob,this.encoding)})}}};var N2=class extends xD{constructor(n){super(),this.data="data:"+(n||"")+";base64,",this.pending=[]}writeUint8Array(n){super.writeUint8Array(n);let i=0,o=this.pending,r=this.pending.length;for(this.pending="",i=0;i<Math.floor((r+n.length)/3)*3-r;i++)o+=String.fromCharCode(n[i]);for(;i<n.length;i++)this.pending+=String.fromCharCode(n[i]);o.length>2?this.data+=btoa(o):this.pending=o}getData(){return this.data+btoa(this.pending)}},Yy=class extends M2{constructor(n){super(),this.blob=n,this.size=n.size}async readUint8Array(n,i){if(this.blob.arrayBuffer)return new Uint8Array(await this.blob.slice(n,n+i).arrayBuffer());{let o=new FileReader;return new Promise((r,s)=>{o.onload=a=>r(new Uint8Array(a.target.result)),o.onerror=()=>s(o.error),o.readAsArrayBuffer(this.blob.slice(n,n+i))})}}},tE=class extends xD{constructor(n){super(),this.contentType=n,this.arrayBuffersMaxlength=8,vle(this)}writeUint8Array(n){super.writeUint8Array(n),this.arrayBuffers.length==this.arrayBuffersMaxlength&&Ple(this),this.arrayBuffers.push(n.buffer)}getData(){return this.blob||(this.arrayBuffers.length&&Ple(this),this.blob=this.pendingBlob,vle(this)),this.blob}};function vle(t){t.pendingBlob=new Blob([],{type:t.contentType}),t.arrayBuffers=[]}function Ple(t){t.pendingBlob=new Blob([t.pendingBlob,...t.arrayBuffers],{type:t.contentType}),t.arrayBuffers=[]}var nE="/",W9=new Date(2107,11,31),j9=new Date(1980,0,1);var Sqe="\0\u263A\u263B\u2665\u2666\u2663\u2660\u2022\u25D8\u25CB\u25D9\u2642\u2640\u266A\u266B\u263C\u25BA\u25C4\u2195\u203C\xB6\xA7\u25AC\u21A8\u2191\u2193\u2192\u2190\u221F\u2194\u25B2\u25BC !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\u2302\xC7\xFC\xE9\xE2\xE4\xE0\xE5\xE7\xEA\xEB\xE8\xEF\xEE\xEC\xC4\xC5\xC9\xE6\xC6\xF4\xF6\xF2\xFB\xF9\xFF\xD6\xDC\xA2\xA3\xA5\u20A7\u0192\xE1\xED\xF3\xFA\xF1\xD1\xAA\xBA\xBF\u2310\xAC\xBD\xBC\xA1\xAB\xBB\u2591\u2592\u2593\u2502\u2524\u2561\u2562\u2556\u2555\u2563\u2551\u2557\u255D\u255C\u255B\u2510\u2514\u2534\u252C\u251C\u2500\u253C\u255E\u255F\u255A\u2554\u2569\u2566\u2560\u2550\u256C\u2567\u2568\u2564\u2565\u2559\u2558\u2552\u2553\u256B\u256A\u2518\u250C\u2588\u2584\u258C\u2590\u2580\u03B1\xDF\u0393\u03C0\u03A3\u03C3\xB5\u03C4\u03A6\u0398\u03A9\u03B4\u221E\u03C6\u03B5\u2229\u2261\xB1\u2265\u2264\u2320\u2321\xF7\u2248\xB0\u2219\xB7\u221A\u207F\xB2\u25A0 ".split(""),Ile=t=>{let n="";for(let i=0;i<t.length;i++)n+=Sqe[t[i]];return n};var V2=wqe;function wqe(t,n){if(n&&n.trim().toLowerCase()=="cp437")return Ile(t);if(typeof TextDecoder=="undefined"){let i=new FileReader;return new Promise((o,r)=>{i.onload=s=>o(s.target.result),i.onerror=()=>r(i.error),i.readAsText(new Blob([t]))})}else return new TextDecoder(n).decode(t)}var Dqe=["filename","rawFilename","directory","encrypted","compressedSize","uncompressedSize","lastModDate","rawLastModDate","comment","rawComment","signature","extraField","rawExtraField","bitFlag","extraFieldZip64","extraFieldUnicodePath","extraFieldUnicodeComment","extraFieldAES","filenameUTF8","commentUTF8","offset","zip64","compressionMethod","extraFieldNTFS","lastAccessDate","creationDate","extraFieldExtendedTimestamp","version","versionMadeBy","msDosCompatible","internalFileAttribute","externalFileAttribute"],mp=class{constructor(n){Dqe.forEach(i=>this[i]=n[i])}};var X9="File format is not recognized",Bqe="End of central directory not found",Oqe="End of Zip64 central directory not found",Rqe="End of Zip64 central directory locator not found",Mqe="Central directory header not found",Lqe="Local file header not found",Fqe="Zip64 extra field not found",Nqe="File contains encrypted entry",Vqe="Encryption method not supported",Ble="Compression method not supported",Ole="utf-8",Rle="cp437",Mle=["uncompressedSize","compressedSize","offset"],Y2=class{constructor(n,i={}){Object.assign(this,{reader:n,options:i,config:x2()})}async*getEntriesGenerator(n={}){let i=this,o=i.reader;if(o.initialized||await o.init(),o.size<22)throw new Error(X9);let r=await Gqe(o,101010256,o.size,22,65535*16);if(!r)throw new Error(Bqe);let s=Na(r),a=ks(s,12),c=ks(s,16),l=Wl(s,8),u=0;if(c==4294967295||a==4294967295||l==65535){let y=await xg(o,r.offset-20,20),p=Na(y);if(ks(p,0)!=117853008)throw new Error(Oqe);c=k2(p,8);let C=await xg(o,c,56),x=Na(C),T=r.offset-20-56;if(ks(x,0)!=101075792&&c!=T){let E=c;c=T,u=c-E,C=await xg(o,c,56),x=Na(C)}if(ks(x,0)!=101075792)throw new Error(Rqe);l=k2(x,32),a=k2(x,40),c-=a}if(c<0||c>=o.size)throw new Error(X9);let d=0,h=await xg(o,c,a),_=Na(h);if(a){let y=r.offset-a;if(ks(_,d)!=33639248&&c!=y){let p=c;c=y,u=c-p,h=await xg(o,c,a),_=Na(h)}}if(c<0||c>=o.size)throw new Error(X9);for(let y=0;y<l;y++){let p=new J9(o,i.config,i.options);if(ks(_,d)!=33639248)throw new Error(Mqe);Fle(p,_,d+6);let C=Boolean(p.bitFlag.languageEncodingFlag),x=d+46,T=x+p.filenameLength,E=T+p.extraFieldLength,S=Wl(_,d+4),w=(S&0)==0;Object.assign(p,{versionMadeBy:S,msDosCompatible:w,compressedSize:0,uncompressedSize:0,commentLength:Wl(_,d+32),directory:w&&(oE(_,d+38)&16)==16,offset:ks(_,d+42)+u,internalFileAttribute:ks(_,d+34),externalFileAttribute:ks(_,d+38),rawFilename:h.subarray(x,T),filenameUTF8:C,commentUTF8:C,rawExtraField:h.subarray(T,E)});let D=E+p.commentLength;p.rawComment=h.subarray(E,D);let I=iE(i,n,"filenameEncoding"),O=iE(i,n,"commentEncoding"),[M,L]=await Promise.all([V2(p.rawFilename,p.filenameUTF8?Ole:I||Rle),V2(p.rawComment,p.commentUTF8?Ole:O||Rle)]);p.filename=M,p.comment=L,!p.directory&&p.filename.endsWith(nE)&&(p.directory=!0),await Nle(p,p,_,d+6);let F=new mp(p);if(F.getData=(g,b)=>p.getData(g,F,b),d=D,n.onprogress)try{n.onprogress(y+1,l,new mp(p))}catch(g){}yield F}return!0}async getEntries(n={}){let i=[],o=this.getEntriesGenerator(n),r=o.next();for(;!(await r).done;)i.push((await r).value),r=o.next();return i}async close(){}};var J9=class{constructor(n,i,o){Object.assign(this,{reader:n,config:i,options:o})}async getData(n,i,o={}){let r=this,{reader:s,offset:a,extraFieldAES:c,compressionMethod:l,config:u,bitFlag:d,signature:h,rawLastModDate:_,compressedSize:y}=r,p=r.localDirectory={};s.initialized||await s.init();let C=await xg(s,a,30),x=Na(C),T=iE(r,o,"password");if(T=T&&T.length&&T,c&&c.originalCompressionMethod!=99)throw new Error(Ble);if(l!=0&&l!=8)throw new Error(Ble);if(ks(x,0)!=67324752)throw new Error(Lqe);Fle(p,x,4),C=await xg(s,a,30+p.filenameLength+p.extraFieldLength),p.rawExtraField=C.subarray(30+p.filenameLength),await Nle(r,p,x,4),i.lastAccessDate=p.lastAccessDate,i.creationDate=p.creationDate;let E=r.encrypted&&p.encrypted,S=E&&!c;if(E){if(!S&&c.strength===void 0)throw new Error(Vqe);if(!T)throw new Error(Nqe)}let w=await B2(u.Inflate,{codecType:P2,password:T,zipCrypto:S,encryptionStrength:c&&c.strength,signed:iE(r,o,"checkSignature"),passwordVerification:S&&(d.dataDescriptor?_>>>8&255:h>>>24&255),signature:h,compressed:l!=0,encrypted:E,useWebWorkers:iE(r,o,"useWebWorkers")},u);n.initialized||await n.init();let D=iE(r,o,"signal"),I=a+30+p.filenameLength+p.extraFieldLength;return await O2(w,s,n,I,()=>y,u,{onprogress:o.onprogress,signal:D}),n.getData()}};function Fle(t,n,i){let o=t.rawBitFlag=Wl(n,i+2),r=(o&1)==1,s=ks(n,i+6);Object.assign(t,{encrypted:r,version:Wl(n,i),bitFlag:{level:(o&6)>>1,dataDescriptor:(o&8)==8,languageEncodingFlag:(o&2048)==2048},rawLastModDate:s,lastModDate:Wqe(s),filenameLength:Wl(n,i+22),extraFieldLength:Wl(n,i+24)})}async function Nle(t,n,i,o){let r=n.rawExtraField,s=n.extraField=new Map,a=Na(new Uint8Array(r)),c=0;try{for(;c<r.length;){let C=Wl(a,c),x=Wl(a,c+2);s.set(C,{type:C,data:r.slice(c+4,c+4+x)}),c+=4+x}}catch(C){}let l=Wl(i,o+4);n.signature=ks(i,o+10),n.uncompressedSize=ks(i,o+18),n.compressedSize=ks(i,o+14);let u=s.get(1);u&&(kqe(u,n),n.extraFieldZip64=u);let d=s.get(28789);d&&(await Lle(d,"filename","rawFilename",n,t),n.extraFieldUnicodePath=d);let h=s.get(25461);h&&(await Lle(h,"comment","rawComment",n,t),n.extraFieldUnicodeComment=h);let _=s.get(39169);_?(Uqe(_,n,l),n.extraFieldAES=_):n.compressionMethod=l;let y=s.get(10);y&&(zqe(y,n),n.extraFieldNTFS=y);let p=s.get(21589);p&&(Hqe(p,n),n.extraFieldExtendedTimestamp=p)}function kqe(t,n){n.zip64=!0;let i=Na(t.data);t.values=[];for(let r=0;r<Math.floor(t.data.length/8);r++)t.values.push(k2(i,0+r*8));let o=Mle.filter(r=>n[r]==4294967295);for(let r=0;r<o.length;r++)t[o[r]]=t.values[r];Mle.forEach(r=>{if(n[r]==4294967295)if(t[r]!==void 0)n[r]=t[r];else throw new Error(Fqe)})}async function Lle(t,n,i,o,r){let s=Na(t.data);t.version=oE(s,0),t.signature=ks(s,1);let a=new Ag;a.append(r[i]);let c=Na(new Uint8Array(4));c.setUint32(0,a.get(),!0),t[n]=await V2(t.data.subarray(5)),t.valid=!r.bitFlag.languageEncodingFlag&&t.signature==ks(c,0),t.valid&&(o[n]=t[n],o[n+"UTF8"]=!0)}function Uqe(t,n,i){let o=Na(t.data);t.vendorVersion=oE(o,0),t.vendorId=oE(o,2);let r=oE(o,4);t.strength=r,t.originalCompressionMethod=i,n.compressionMethod=t.compressionMethod=Wl(o,5)}function zqe(t,n){let i=Na(t.data),o=4,r;try{for(;o<t.data.length&&!r;){let s=Wl(i,o),a=Wl(i,o+2);s==1&&(r=t.data.slice(o+4,o+4+a)),o+=4+a}}catch(s){}try{if(r&&r.length==24){let s=Na(r),a=s.getBigUint64(0,!0),c=s.getBigUint64(8,!0),l=s.getBigUint64(16,!0);Object.assign(t,{rawLastModDate:a,rawLastAccessDate:c,rawCreationDate:l});let u=K9(a),d=K9(c),h=K9(l),_={lastModDate:u,lastAccessDate:d,creationDate:h};Object.assign(t,_),Object.assign(n,_)}}catch(s){}}function Hqe(t,n){let i=Na(t.data),o=oE(i,0),r=[],s=[];(o&1)==1&&(r.push("lastModDate"),s.push("rawLastModDate")),(o&2)==2&&(r.push("lastAccessDate"),s.push("rawLastAccessDate")),(o&4)==4&&(r.push("creationDate"),s.push("rawCreationDate"));let a=1;r.forEach((c,l)=>{if(t.data.length>=a+4){let u=ks(i,a);n[c]=t[c]=new Date(u*1e3);let d=s[l];t[d]=u}a+=4})}async function Gqe(t,n,i,o,r){let s=new Uint8Array(4),a=Na(s);jqe(a,0,n);let c=o+r;return await l(o)||await l(Math.min(c,i));async function l(u){let d=i-u,h=await xg(t,d,u);for(let _=h.length-o;_>=0;_--)if(h[_]==s[0]&&h[_+1]==s[1]&&h[_+2]==s[2]&&h[_+3]==s[3])return{offset:d+_,buffer:h.slice(_,_+o).buffer}}}function iE(t,n,i){return n[i]===void 0?t.options[i]:n[i]}function Wqe(t){let n=(t&4294901760)>>16,i=t&65535;try{return new Date(1980+((n&65024)>>9),((n&480)>>5)-1,n&31,(i&63488)>>11,(i&2016)>>5,(i&31)*2,0)}catch(o){}}function K9(t){return new Date(Number(t/BigInt(1e4)-BigInt(116444736e5)))}function oE(t,n){return t.getUint8(n)}function Wl(t,n){return t.getUint16(n,!0)}function ks(t,n){return t.getUint32(n,!0)}function k2(t,n){return Number(t.getBigUint64(n,!0))}function jqe(t,n,i){t.setUint32(n,i,!0)}function Na(t){return new DataView(t.buffer)}function xg(t,n,i){return t.readUint8Array(n,i)}var Jqe="File already exists",Zqe="Zip file comment exceeds 64KB",Qqe="File entry comment exceeds 64KB",$qe="File entry name exceeds 64KB",Ule="Version exceeds 65535",eYe="The strength must equal 1, 2, or 3",tYe="Extra field type exceeds 65535",nYe="Extra field data exceeds 64KB",cW="Zip64 is not supported",zle=new Uint8Array([7,0,2,0,65,69,3,0,0]),Hle=24,sW=0,J2=class{constructor(n,i={}){Object.assign(this,{writer:n,options:i,config:x2(),files:new Map,offset:n.size,pendingCompressedSize:0,pendingEntries:[],pendingAddFileCalls:new Set})}async add(n="",i,o={}){let r=this;if(sW<r.config.maxWorkers){sW++;let s;try{return s=iYe(r,n,i,o),this.pendingAddFileCalls.add(s),await s}finally{this.pendingAddFileCalls.delete(s),sW--;let a=r.pendingEntries.shift();a&&r.add(a.name,a.reader,a.options).then(a.resolve).catch(a.reject)}}else return new Promise((s,a)=>r.pendingEntries.push({name:n,reader:i,options:o,resolve:s,reject:a}))}async close(n=new Uint8Array(0),i={}){for(;this.pendingAddFileCalls.size;)await Promise.all(Array.from(this.pendingAddFileCalls));return await sYe(this,n,i),this.writer.getData()}};async function iYe(t,n,i,o){if(n=n.trim(),o.directory&&!n.endsWith(nE)?n+=nE:o.directory=n.endsWith(nE),t.files.has(n))throw new Error(Jqe);let r=gD(n);if(r.length>65535)throw new Error($qe);let s=o.comment||"",a=gD(s);if(a.length>65535)throw new Error(Qqe);let c=t.options.version||o.version||0;if(c>65535)throw new Error(Ule);let l=t.options.versionMadeBy||o.versionMadeBy||20;if(l>65535)throw new Error(Ule);let u=sa(t,o,"lastModDate")||new Date,d=sa(t,o,"lastAccessDate"),h=sa(t,o,"creationDate"),_=sa(t,o,"password"),y=sa(t,o,"encryptionStrength")||3,p=sa(t,o,"zipCrypto");if(_!==void 0&&y!==void 0&&(y<1||y>3))throw new Error(eYe);let C=new Uint8Array(0),x=o.extraField;if(x){let V=0,H=0;x.forEach(U=>V+=4+U.length),C=new Uint8Array(V),x.forEach((U,G)=>{if(G>65535)throw new Error(tYe);if(U.length>65535)throw new Error(nYe);zs(C,new Uint16Array([G]),H),zs(C,new Uint16Array([U.length]),H+2),zs(C,U,H+4),H+=4+U.length})}let T=sa(t,o,"extendedTimestamp");T===void 0&&(T=!0);let E=0,S=sa(t,o,"keepOrder");S===void 0&&(S=!0);let w=0,D=sa(t,o,"msDosCompatible");D===void 0&&(D=!0);let I=sa(t,o,"internalFileAttribute")||0,O=sa(t,o,"externalFileAttribute")||0;i&&(i.initialized||await i.init(),w=i.size,E=cYe(w));let M=o.zip64||t.options.zip64||!1;if(t.offset+t.pendingCompressedSize>=4294967295||w>=4294967295||E>=4294967295){if(o.zip64===!1||t.options.zip64===!1||!S)throw new Error(cW);M=!0}t.pendingCompressedSize+=E,await Promise.resolve();let L=sa(t,o,"level"),F=sa(t,o,"useWebWorkers"),g=sa(t,o,"bufferedWrite"),b=sa(t,o,"dataDescriptor"),v=sa(t,o,"dataDescriptorSignature"),P=sa(t,o,"signal");b===void 0&&(b=!0),b&&v===void 0&&(v=!1);let R=await oYe(t,n,i,Object.assign({},o,{rawFilename:r,rawComment:a,version:c,versionMadeBy:l,lastModDate:u,lastAccessDate:d,creationDate:h,rawExtraField:C,zip64:M,password:_,level:L,useWebWorkers:F,encryptionStrength:y,extendedTimestamp:T,zipCrypto:p,bufferedWrite:g,keepOrder:S,dataDescriptor:b,dataDescriptorSignature:v,signal:P,msDosCompatible:D,internalFileAttribute:I,externalFileAttribute:O}));return E&&(t.pendingCompressedSize-=E),Object.assign(R,{name:n,comment:s,extraField:x}),new mp(R)}async function oYe(t,n,i,o){let r=t.files,s=t.writer,a=Array.from(r.values()).pop(),c={},l,u,d;r.set(n,c);try{let h,_,y;if(o.keepOrder&&(h=a&&a.lock),c.lock=y=new Promise(p=>d=p),o.bufferedWrite||t.lockWrite||!o.dataDescriptor?(_=new tE,_.init(),l=!0):(t.lockWrite=new Promise(p=>u=p),s.initialized||await s.init(),_=s),c=await rYe(i,_,t.config,o),c.lock=y,r.set(n,c),c.filename=n,l){let p=0,C=_.getData();await Promise.all([t.lockWrite,h]);let x;do x=Array.from(r.values()).find(T=>T.writingBufferedData),x&&await x.lock;while(x&&x.lock);if(c.writingBufferedData=!0,!o.dataDescriptor){let E=await Gle(C,0,26),S=new DataView(E);(!c.encrypted||o.zipCrypto)&&ao(S,14,c.signature),c.zip64?(ao(S,18,4294967295),ao(S,22,4294967295)):(ao(S,18,c.compressedSize),ao(S,22,c.uncompressedSize)),await s.writeUint8Array(new Uint8Array(E)),p=26}await aYe(s,C,p),delete c.writingBufferedData}if(c.offset=t.offset,c.zip64){let p=ad(c.rawExtraFieldZip64);rl(p,20,BigInt(c.offset))}else if(c.offset>=4294967295)throw new Error(cW);return t.offset+=c.length,c}catch(h){throw(l&&c.writingBufferedData||!l&&c.dataWritten)&&(h.corruptedEntry=t.hasCorruptedEntries=!0,c.uncompressedSize&&(t.offset+=c.uncompressedSize)),r.delete(n),h}finally{d(),u&&u()}}async function rYe(t,n,i,o){let{rawFilename:r,lastAccessDate:s,creationDate:a,password:c,level:l,zip64:u,zipCrypto:d,dataDescriptor:h,dataDescriptorSignature:_,directory:y,version:p,versionMadeBy:C,rawComment:x,rawExtraField:T,useWebWorkers:E,onprogress:S,signal:w,encryptionStrength:D,extendedTimestamp:I,msDosCompatible:O,internalFileAttribute:M,externalFileAttribute:L}=o,F=Boolean(c&&c.length),g=l!==0&&!y,b;if(F&&!d){b=new Uint8Array(zle.length+2);let ke=ad(b);No(ke,0,39169),zs(b,zle,2),Z2(ke,8,D)}else b=new Uint8Array(0);let v,P;if(I){P=new Uint8Array(9+(s?4:0)+(a?4:0));let ke=ad(P);No(ke,0,21589),No(ke,2,P.length-4);let qe=1+(s?2:0)+(a?4:0);Z2(ke,4,qe),ao(ke,5,Math.floor(o.lastModDate.getTime()/1e3)),s&&ao(ke,9,Math.floor(s.getTime()/1e3)),a&&ao(ke,13,Math.floor(a.getTime()/1e3));try{v=new Uint8Array(36);let Nt=ad(v),Wt=aW(o.lastModDate);No(Nt,0,10),No(Nt,2,32),No(Nt,8,1),No(Nt,10,24),rl(Nt,12,Wt),rl(Nt,20,aW(s)||Wt),rl(Nt,28,aW(a)||Wt)}catch(Nt){v=new Uint8Array(0)}}else v=P=new Uint8Array(0);let R={version:p||20,versionMadeBy:C,zip64:u,directory:Boolean(y),filenameUTF8:!0,rawFilename:r,commentUTF8:!0,rawComment:x,rawExtraFieldZip64:u?new Uint8Array(Hle+4):new Uint8Array(0),rawExtraFieldExtendedTimestamp:P,rawExtraFieldNTFS:v,rawExtraFieldAES:b,rawExtraField:T,extendedTimestamp:I,msDosCompatible:O,internalFileAttribute:M,externalFileAttribute:L},V=R.uncompressedSize=0,H=2048;h&&(H=H|8);let U=0;g&&(U=8),u&&(R.version=R.version>45?R.version:45),F&&(H=H|1,d||(R.version=R.version>51?R.version:51,U=99,g&&(R.rawExtraFieldAES[9]=8))),R.compressionMethod=U;let G=R.headerArray=new Uint8Array(26),k=ad(G);No(k,0,R.version),No(k,2,H),No(k,4,U);let X=new Uint32Array(1),Y=ad(X),K;o.lastModDate<j9?K=j9:o.lastModDate>W9?K=W9:K=o.lastModDate,No(Y,0,(K.getHours()<<6|K.getMinutes())<<5|K.getSeconds()/2),No(Y,2,(K.getFullYear()-1980<<4|K.getMonth()+1)<<5|K.getDate());let j=X[0];ao(k,6,j),No(k,22,r.length);let Z=b.length+P.length+v.length+R.rawExtraField.length;No(k,24,Z);let Q=new Uint8Array(30+r.length+Z),me=ad(Q);ao(me,0,67324752),zs(Q,G,4),zs(Q,r,30),zs(Q,b,30+r.length),zs(Q,P,30+r.length+b.length),zs(Q,v,30+r.length+b.length+P.length),zs(Q,R.rawExtraField,30+r.length+b.length+P.length+v.length);let _e,re=0;if(t){let ke=await B2(i.Deflate,{codecType:v2,level:l,password:c,encryptionStrength:D,zipCrypto:F&&d,passwordVerification:F&&d&&j>>8&255,signed:!0,compressed:g,encrypted:F,useWebWorkers:E},i);await n.writeUint8Array(Q),R.dataWritten=!0,_e=await O2(ke,t,n,0,()=>t.size,i,{onprogress:S,signal:w}),V=R.uncompressedSize=t.size,re=_e.length}else await n.writeUint8Array(Q),R.dataWritten=!0;let fe=new Uint8Array(0),ge,be=0;if(h&&(fe=new Uint8Array(u?_?24:20:_?16:12),ge=ad(fe),_&&(be=4,ao(ge,0,134695760))),t){let ke=_e.signature;if((!F||d)&&ke!==void 0&&(ao(k,10,ke),R.signature=ke,h&&ao(ge,be,ke)),u){let qe=ad(R.rawExtraFieldZip64);No(qe,0,1),No(qe,2,Hle),ao(k,14,4294967295),rl(qe,12,BigInt(re)),ao(k,18,4294967295),rl(qe,4,BigInt(V)),h&&(rl(ge,be+4,BigInt(re)),rl(ge,be+12,BigInt(V)))}else ao(k,14,re),ao(k,18,V),h&&(ao(ge,be+4,re),ao(ge,be+8,V))}h&&await n.writeUint8Array(fe);let Be=Q.length+re+fe.length;return Object.assign(R,{compressedSize:re,lastModDate:K,rawLastModDate:j,creationDate:a,lastAccessDate:s,encrypted:F,length:Be}),R}async function sYe(t,n,i){let o=t.writer,r=t.files,s=0,a=0,c=t.offset,l=r.size;for(let[,_]of r)a+=46+_.rawFilename.length+_.rawComment.length+_.rawExtraFieldZip64.length+_.rawExtraFieldAES.length+_.rawExtraFieldExtendedTimestamp.length+_.rawExtraFieldNTFS.length+_.rawExtraField.length;let u=i.zip64||t.options.zip64||!1;if(c>=4294967295||a>=4294967295||l>=65535){if(i.zip64===!1||t.options.zip64===!1)throw new Error(cW);u=!0}let d=new Uint8Array(a+(u?98:22)),h=ad(d);if(n&&n.length)if(n.length<=65535)No(h,s+20,n.length);else throw new Error(Zqe);for(let[_,y]of Array.from(r.values()).entries()){let{rawFilename:p,rawExtraFieldZip64:C,rawExtraFieldAES:x,rawExtraField:T,rawComment:E,versionMadeBy:S,headerArray:w,directory:D,zip64:I,msDosCompatible:O,internalFileAttribute:M,externalFileAttribute:L}=y,F,g;if(y.extendedTimestamp){g=y.rawExtraFieldNTFS,F=new Uint8Array(9);let v=ad(F);No(v,0,21589),No(v,2,F.length-4),Z2(v,4,1),ao(v,5,Math.floor(y.lastModDate.getTime()/1e3))}else g=F=new Uint8Array(0);let b=C.length+x.length+F.length+g.length+T.length;if(ao(h,s,33639248),No(h,s+4,S),zs(d,w,s+6),No(h,s+30,b),No(h,s+32,E.length),ao(h,s+34,M),L?ao(h,s+38,L):D&&O&&Z2(h,s+38,16),I?ao(h,s+42,4294967295):ao(h,s+42,y.offset),zs(d,p,s+46),zs(d,C,s+46+p.length),zs(d,x,s+46+p.length+C.length),zs(d,F,s+46+p.length+C.length+x.length),zs(d,g,s+46+p.length+C.length+x.length+F.length),zs(d,T,s+46+p.length+C.length+x.length+F.length+g.length),zs(d,E,s+46+p.length+b),s+=46+p.length+b+E.length,i.onprogress)try{i.onprogress(_+1,r.size,new mp(y))}catch(v){}}u&&(ao(h,s,101075792),rl(h,s+4,BigInt(44)),No(h,s+12,45),No(h,s+14,45),rl(h,s+24,BigInt(l)),rl(h,s+32,BigInt(l)),rl(h,s+40,BigInt(a)),rl(h,s+48,BigInt(c)),ao(h,s+56,117853008),rl(h,s+64,BigInt(c)+BigInt(a)),ao(h,s+72,1),l=65535,c=4294967295,a=4294967295,s+=76),ao(h,s,101010256),No(h,s+8,l),No(h,s+10,l),ao(h,s+12,a),ao(h,s+16,c),await o.writeUint8Array(d),n&&n.length&&await o.writeUint8Array(n)}function Gle(t,n,i){if(t.arrayBuffer)return n||i?t.slice(n,i).arrayBuffer():t.arrayBuffer();{let o=new FileReader;return new Promise((r,s)=>{o.onload=a=>r(a.target.result),o.onerror=()=>s(o.error),o.readAsArrayBuffer(n||i?t.slice(n,i):t)})}}async function aYe(t,n,i=0){await r();async function r(){if(i<n.size){let s=await Gle(n,i,i+536870912);await t.writeUint8Array(new Uint8Array(s)),i+=536870912,await r()}}}function aW(t){if(t)return(BigInt(t.getTime())+BigInt(116444736e5))*BigInt(1e4)}function sa(t,n,i){return n[i]===void 0?t.options[i]:n[i]}function cYe(t){return t+5*(Math.floor(t/16383)+1)}function Z2(t,n,i){t.setUint8(n,i)}function No(t,n,i){t.setUint16(n,i,!0)}function ao(t,n,i){t.setUint32(n,i,!0)}function rl(t,n,i){t.setBigUint64(n,i,!0)}function zs(t,n,i){t.set(n,i)}function ad(t){return new DataView(t.buffer)}JT({Deflate:Lce,Inflate:ile});var lW=32,lYe="http://www.opengis.net/kml/2.2",ld="http://www.google.com/kml/ext/2.2",uYe="http://www.w3.org/2000/xmlns/";function Q2(t){this._files={},this._promises=[],this._count=0,this._modelCallback=t}var fYe=/^data:image\/([^,;]+)/;Q2.prototype.texture=function(t){let n=this,i;if(typeof t=="string"||t instanceof Ie){if(t=Ie.createIfNeeded(t),!t.isDataUri)return t.url;let o=t.url.match(fYe);i=`texture_${++this._count}`,f(o)&&(i+=`.${o[1]}`);let r=t.fetchBlob().then(function(s){n._files[i]=s});return this._promises.push(r),i}if(t instanceof HTMLCanvasElement){i=`texture_${++this._count}.png`;let o=new Promise(r=>{t.toBlob(function(s){n._files[i]=s,r()})});return this._promises.push(o),i}return""};function dYe(t,n){return function(i){t._files[n]=i}}Q2.prototype.model=function(t,n){let i=this._modelCallback;if(!f(i))throw new he("Encountered a model entity while exporting to KML, but no model callback was supplied.");let o={},r=i(t,n,o);for(let s in o)if(o.hasOwnProperty(s)){let a=Promise.resolve(o[s]);this._promises.push(a),a.then(dYe(this,s))}return r};Object.defineProperties(Q2.prototype,{promise:{get:function(){return Promise.all(this._promises)}},files:{get:function(){return this._files}}});function $2(t){this._time=t}$2.prototype.get=function(t,n,i){let o;return f(t)&&(o=f(t.getValue)?t.getValue(this._time,i):t),A(o,n)};$2.prototype.getColor=function(t,n){let i=this.get(t,n);if(f(i))return Ky(i)};$2.prototype.getMaterialType=function(t){if(!!f(t))return t.getType(this._time)};function uW(){this._ids={},this._styles={},this._count=0}uW.prototype.get=function(t){let n=this._ids,i=t.innerHTML;if(f(n[i]))return n[i];let o=`style-${++this._count}`;return t.setAttribute("id",o),o=`#${o}`,n[i]=o,this._styles[i]=t,o};uW.prototype.save=function(t){let n=this._styles,i=t.childNodes[0];for(let o in n)n.hasOwnProperty(o)&&t.insertBefore(n[o],i)};function Yle(){this._ids={}}Yle.prototype.get=function(t){if(!f(t))return this.get(Bn());let n=this._ids;return f(n[t])?`${t.toString()}-${++n[t]}`:(n[t]=0,t)};function fW(t){t=A(t,A.EMPTY_OBJECT);let n=t.entities,i=A(t.kmz,!1),o=fW._createState(t),r=n.values.filter(function(u){return!f(u.parent)}),s=o.kmlDoc,a=s.documentElement;a.setAttributeNS(uYe,"xmlns:gx",ld);let c=s.createElement("Document");a.appendChild(c),Kle(o,c,r),o.styleCache.save(c);let l=o.externalFileHandler;return l.promise.then(function(){let d=new XMLSerializer().serializeToString(o.kmlDoc);return i?hYe(d,l.files):{kml:d,externalFiles:l.files}})}function hYe(t,n){let i=Qt("ThirdParty/Workers/z-worker-pako.js");JT({workerScripts:{deflate:[i,"./pako_deflate.min.js"],inflate:[i,"./pako_inflate.min.js"]}});let o=new tE,r=new J2(o);return r.add("doc.kml",new L2(t)).then(function(){let s=Object.keys(n);return Xle(r,s,n,0)}).then(function(){return r.close()}).then(function(s){return{kmz:s}})}function Xle(t,n,i,o){if(n.length===o)return;let r=n[o];return t.add(r,new Yy(i[r])).then(function(){return Xle(t,n,i,o+1)})}fW._createState=function(t){let n=t.entities,i=new uW,o=n.computeAvailability(),r=f(t.time)?t.time:o.start,s=A(t.defaultAvailability,o),a=A(t.sampleDuration,60);s.start===Ue.MINIMUM_VALUE?s.stop===Ue.MAXIMUM_VALUE?s=new xn:te.addSeconds(s.stop,-10*a,s.start):s.stop===Ue.MAXIMUM_VALUE&&te.addSeconds(s.start,10*a,s.stop);let c=new Q2(t.modelCallback);return{kmlDoc:document.implementation.createDocument(lYe,"kml"),ellipsoid:A(t.ellipsoid,oe.WGS84),idManager:new Yle,styleCache:i,externalFileHandler:c,time:r,valueGetter:new $2(r),sampleDuration:a,defaultAvailability:new Lr([s])}};function Kle(t,n,i){let o=t.kmlDoc,r=t.styleCache,s=t.valueGetter,a=t.idManager,c=i.length,l,u,d;for(let h=0;h<c;++h){let _=i[h];l=[],u=[],d=[],mYe(t,_,u,d),pYe(t,_.polyline,u,d),qle(t,_.rectangle,u,d,l),qle(t,_.polygon,u,d,l),AYe(t,_,_.model,u,d);let y,p=_.availability;f(p)&&(y=o.createElement("TimeSpan"),te.equals(p.start,Ue.MINIMUM_VALUE)||y.appendChild(sn(o,"begin",te.toIso8601(p.start))),te.equals(p.stop,Ue.MAXIMUM_VALUE)||y.appendChild(sn(o,"end",te.toIso8601(p.stop))));for(let T=0;T<l.length;++T){let E=l[T];E.setAttribute("id",a.get(_.id)),E.appendChild(sn(o,"name",_.name)),E.appendChild(sn(o,"visibility",_.show)),E.appendChild(sn(o,"description",_.description)),f(y)&&E.appendChild(y),n.appendChild(E)}let C=u.length;if(C>0){let T=o.createElement("Placemark");T.setAttribute("id",a.get(_.id));let E=_.name,S=_.label;if(f(S)){let D=o.createElement("LabelStyle"),I=s.get(S.text);E=f(I)&&I.length>0?I:E;let O=s.getColor(S.fillColor);f(O)&&(D.appendChild(sn(o,"color",O)),D.appendChild(sn(o,"colorMode","normal")));let M=s.get(S.scale);f(M)&&D.appendChild(sn(o,"scale",M)),d.push(D)}T.appendChild(sn(o,"name",E)),T.appendChild(sn(o,"visibility",_.show)),T.appendChild(sn(o,"description",_.description)),f(y)&&T.appendChild(y),n.appendChild(T);let w=d.length;if(w>0){let D=o.createElement("Style");for(let I=0;I<w;++I)D.appendChild(d[I]);T.appendChild(sn(o,"styleUrl",r.get(D)))}if(u.length===1)T.appendChild(u[0]);else if(u.length>1){let D=o.createElement("MultiGeometry");for(let I=0;I<C;++I)D.appendChild(u[I]);T.appendChild(D)}}let x=_._children;if(x.length>0){let T=o.createElement("Folder");T.setAttribute("id",a.get(_.id)),T.appendChild(sn(o,"name",_.name)),T.appendChild(sn(o,"visibility",_.show)),T.appendChild(sn(o,"description",_.description)),n.appendChild(T),Kle(t,T,x)}}}var sl=new m,xc=new de,cd=new te;function mYe(t,n,i,o){let r=t.kmlDoc,s=t.ellipsoid,a=t.valueGetter,c=A(n.billboard,n.point);if(!f(c)&&!f(n.path))return;let l=n.position;if(!l.isConstant){Jle(t,n,c,i,o);return}a.get(l,void 0,sl);let u=sn(r,"coordinates",Xy(sl,s)),d=r.createElement("Point"),h=r.createElement("altitudeMode");h.appendChild(Jy(t,c.heightReference)),d.appendChild(h),d.appendChild(u),i.push(d);let _=c instanceof Qa?Qle(t,c):Zle(t,c);o.push(_)}function Jle(t,n,i,o,r){let s=t.kmlDoc,a=t.ellipsoid,c=t.valueGetter,l,u=n.position,d=!0;u instanceof ia?(l=u.intervals,d=!1):l=A(n.availability,t.defaultAvailability);let h=i instanceof y_,_,y,p,C=[];for(_=0;_<l.length;++_){let T=l.get(_),E=d?u:T.data,S=s.createElement("altitudeMode");E instanceof hp?(E=E._value,S.appendChild(Jy(t,Ge.CLAMP_TO_GROUND))):f(i)?S.appendChild(Jy(t,i.heightReference)):S.appendChild(Jy(t,Ge.NONE));let w=[],D=[];if(E.isConstant){c.get(E,void 0,sl);let O=sn(s,"coordinates",Xy(sl,a));w.push(te.toIso8601(T.start)),D.push(O),w.push(te.toIso8601(T.stop)),D.push(O)}else if(E instanceof oa)for(p=E._property._times,y=0;y<p.length;++y)w.push(te.toIso8601(p[y])),E.getValueInReferenceFrame(p[y],no.FIXED,sl),D.push(Xy(sl,a));else if(E instanceof Hu){p=E._times;let O=E._values;for(y=0;y<p.length;++y)w.push(te.toIso8601(p[y])),m.fromArray(O,y*3,sl),D.push(Xy(sl,a))}else{let O=t.sampleDuration;T.start.clone(cd),T.isStartIncluded||te.addSeconds(cd,O,cd);let M=T.stop;for(;te.lessThan(cd,M);)E.getValue(cd,sl),w.push(te.toIso8601(cd)),D.push(Xy(sl,a)),te.addSeconds(cd,O,cd);T.isStopIncluded&&te.equals(cd,M)&&(E.getValue(cd,sl),w.push(te.toIso8601(cd)),D.push(Xy(sl,a)))}let I=s.createElementNS(ld,"Track");I.appendChild(S);for(let O=0;O<w.length;++O){let M=sn(s,"when",w[O]),L=sn(s,"coord",D[O],ld);I.appendChild(M),I.appendChild(L)}h&&I.appendChild($le(t,i)),C.push(I)}if(C.length===1)o.push(C[0]);else if(C.length>1){let T=s.createElementNS(ld,"MultiTrack");for(_=0;_<C.length;++_)T.appendChild(C[_]);o.push(T)}if(f(i)&&!h){let T=i instanceof Qa?Qle(t,i):Zle(t,i);r.push(T)}let x=n.path;if(f(x)){let T=c.get(x.width),E=x.material;if(f(E)||f(T)){let S=s.createElement("LineStyle");f(T)&&S.appendChild(sn(s,"width",T)),dW(t,E,S),r.push(S)}}}function Zle(t,n){let i=t.kmlDoc,o=t.valueGetter,r=i.createElement("IconStyle"),s=o.getColor(n.color);f(s)&&(r.appendChild(sn(i,"color",s)),r.appendChild(sn(i,"colorMode","normal")));let a=o.get(n.pixelSize);return f(a)&&r.appendChild(sn(i,"scale",a/lW)),r}function Qle(t,n){let i=t.kmlDoc,o=t.valueGetter,r=t.externalFileHandler,s=i.createElement("IconStyle"),a=o.get(n.image);if(f(a)){a=r.texture(a);let _=i.createElement("Icon");_.appendChild(sn(i,"href",a));let y=o.get(n.imageSubRegion);f(y)&&(_.appendChild(sn(i,"x",y.x,ld)),_.appendChild(sn(i,"y",y.y,ld)),_.appendChild(sn(i,"w",y.width,ld)),_.appendChild(sn(i,"h",y.height,ld))),s.appendChild(_)}let c=o.getColor(n.color);f(c)&&(s.appendChild(sn(i,"color",c)),s.appendChild(sn(i,"colorMode","normal")));let l=o.get(n.scale);f(l)&&s.appendChild(sn(i,"scale",l));let u=o.get(n.pixelOffset);if(f(u)){l=A(l,1),W.divideByScalar(u,l,u);let _=o.get(n.width,lW),y=o.get(n.height,lW),p=o.get(n.horizontalOrigin,ui.CENTER);p===ui.CENTER?u.x-=_*.5:p===ui.RIGHT&&(u.x-=_);let C=o.get(n.verticalOrigin,vn.CENTER);C===vn.TOP?u.y+=y:C===vn.CENTER&&(u.y+=y*.5);let x=i.createElement("hotSpot");x.setAttribute("x",-u.x),x.setAttribute("y",u.y),x.setAttribute("xunits","pixels"),x.setAttribute("yunits","pixels"),s.appendChild(x)}let d=o.get(n.rotation),h=o.get(n.alignedAxis);return f(d)&&m.equals(m.UNIT_Z,h)&&(d=B.toDegrees(-d),d===0&&(d=360),s.appendChild(sn(i,"heading",d))),s}function pYe(t,n,i,o){let r=t.kmlDoc,s=t.ellipsoid,a=t.valueGetter;if(!f(n))return;let c=r.createElement("LineString"),l=r.createElement("altitudeMode"),u=a.get(n.clampToGround,!1),d;u?(c.appendChild(sn(r,"tessellate",!0)),d=r.createTextNode("clampToGround")):d=r.createTextNode("absolute"),l.appendChild(d),c.appendChild(l);let h=n.positions,_=a.get(h),y=sn(r,"coordinates",Xy(_,s));c.appendChild(y);let p=a.get(n.zIndex);u&&f(p)&&c.appendChild(sn(r,"drawOrder",p,ld)),i.push(c);let C=r.createElement("LineStyle"),x=a.get(n.width);f(x)&&C.appendChild(sn(r,"width",x)),dW(t,n.material,C),o.push(C)}function _Ye(t,n,i){let o=t.kmlDoc,r=t.valueGetter,s=r.get(n.height,0);i>0&&(s=i);let a=n.coordinates,c=r.get(a),l=[],u=[le.northeast,le.southeast,le.southwest,le.northwest];for(let y=0;y<4;++y)u[y](c,xc),l.push(`${B.toDegrees(xc.longitude)},${B.toDegrees(xc.latitude)},${s}`);let d=sn(o,"coordinates",l.join(" ")),h=o.createElement("outerBoundaryIs"),_=o.createElement("LinearRing");return _.appendChild(d),h.appendChild(_),[h]}function jle(t,n,i,o){let r=t.kmlDoc,s=t.ellipsoid,a=[],c=n.length;for(let d=0;d<c;++d)de.fromCartesian(n[d],s,xc),a.push(`${B.toDegrees(xc.longitude)},${B.toDegrees(xc.latitude)},${o?xc.height:i}`);let l=sn(r,"coordinates",a.join(" ")),u=r.createElement("LinearRing");return u.appendChild(l),u}function gYe(t,n,i){let o=t.kmlDoc,r=t.valueGetter,s=r.get(n.height,0),a=r.get(n.perPositionHeight,!1);!a&&i>0&&(s=i);let c=[],l=n.hierarchy,u=r.get(l),d=Array.isArray(u)?u:u.positions,h=o.createElement("outerBoundaryIs");h.appendChild(jle(t,d,s,a)),c.push(h);let _=u.holes;if(f(_)){let y=_.length;for(let p=0;p<y;++p){let C=o.createElement("innerBoundaryIs");C.appendChild(jle(t,_[p].positions,s,a)),c.push(C)}}return c}function qle(t,n,i,o,r){let s=t.kmlDoc,a=t.valueGetter;if(!f(n))return;let c=n instanceof ih;if(c&&a.getMaterialType(n.material)==="Image"){yYe(t,n,r);return}let l=s.createElement("Polygon"),u=a.get(n.extrudedHeight,0);u>0&&l.appendChild(sn(s,"extrude",!0));let d=c?_Ye(t,n,u):gYe(t,n,u),h=d.length;for(let x=0;x<h;++x)l.appendChild(d[x]);let _=s.createElement("altitudeMode");_.appendChild(Jy(t,n.heightReference)),l.appendChild(_),i.push(l);let y=s.createElement("PolyStyle"),p=a.get(n.fill,!1);p&&y.appendChild(sn(s,"fill",p)),dW(t,n.material,y);let C=a.get(n.outline,!1);if(C){y.appendChild(sn(s,"outline",C));let x=s.createElement("LineStyle"),T=a.get(n.outlineWidth,1);x.appendChild(sn(s,"width",T));let E=a.getColor(n.outlineColor,z.BLACK);x.appendChild(sn(s,"color",E)),x.appendChild(sn(s,"colorMode","normal")),o.push(x)}o.push(y)}function yYe(t,n,i){let o=t.kmlDoc,r=t.valueGetter,s=t.externalFileHandler,a=o.createElement("GroundOverlay"),c=o.createElement("altitudeMode");c.appendChild(Jy(t,n.heightReference)),a.appendChild(c);let l=r.get(n.height);f(l)&&a.appendChild(sn(o,"altitude",l));let u=r.get(n.coordinates),d=o.createElement("LatLonBox");d.appendChild(sn(o,"north",B.toDegrees(u.north))),d.appendChild(sn(o,"south",B.toDegrees(u.south))),d.appendChild(sn(o,"east",B.toDegrees(u.east))),d.appendChild(sn(o,"west",B.toDegrees(u.west))),a.appendChild(d);let h=r.get(n.material),_=s.texture(h.image),y=o.createElement("Icon");y.appendChild(sn(o,"href",_)),a.appendChild(y);let p=h.color;f(p)&&a.appendChild(sn(o,"color",Ky(h.color))),i.push(a)}function $le(t,n){let i=t.kmlDoc,o=t.valueGetter,r=t.externalFileHandler,s=i.createElement("Model"),a=o.get(n.scale);if(f(a)){let u=i.createElement("scale");u.appendChild(sn(i,"x",a)),u.appendChild(sn(i,"y",a)),u.appendChild(sn(i,"z",a)),s.appendChild(u)}let c=i.createElement("Link"),l=r.model(n,t.time);return c.appendChild(sn(i,"href",l)),s.appendChild(c),s}function AYe(t,n,i,o,r){let s=t.kmlDoc,a=t.ellipsoid,c=t.valueGetter;if(!f(i))return;let l=n.position;if(!l.isConstant){Jle(t,n,i,o,r);return}let u=$le(t,i),d=s.createElement("altitudeMode");d.appendChild(Jy(t,i.heightReference)),u.appendChild(d),c.get(l,void 0,sl),de.fromCartesian(sl,a,xc);let h=s.createElement("Location");h.appendChild(sn(s,"longitude",B.toDegrees(xc.longitude))),h.appendChild(sn(s,"latitude",B.toDegrees(xc.latitude))),h.appendChild(sn(s,"altitude",xc.height)),u.appendChild(h),o.push(u)}function dW(t,n,i){let o=t.kmlDoc,r=t.valueGetter;if(!f(n))return;let s=r.get(n);if(!f(s))return;let a,c=r.getMaterialType(n),l,u;switch(c){case"Image":a=Ky(z.WHITE);break;case"Color":case"Grid":case"PolylineGlow":case"PolylineArrow":case"PolylineDash":a=Ky(s.color);break;case"PolylineOutline":a=Ky(s.color),l=Ky(s.outlineColor),u=s.outlineWidth,i.appendChild(sn(o,"outerColor",l,ld)),i.appendChild(sn(o,"outerWidth",u,ld));break;case"Stripe":a=Ky(s.oddColor);break}f(a)&&(i.appendChild(sn(o,"color",a)),i.appendChild(sn(o,"colorMode","normal")))}function Jy(t,n){let i=t.kmlDoc,r=t.valueGetter.get(n,Ge.NONE),s;switch(r){case Ge.NONE:s=i.createTextNode("absolute");break;case Ge.CLAMP_TO_GROUND:s=i.createTextNode("clampToGround");break;case Ge.RELATIVE_TO_GROUND:s=i.createTextNode("relativeToGround");break}return s}function Xy(t,n){Array.isArray(t)||(t=[t]);let i=t.length,o=[];for(let r=0;r<i;++r)de.fromCartesian(t[r],n,xc),o.push(`${B.toDegrees(xc.longitude)},${B.toDegrees(xc.latitude)},${xc.height}`);return o.join(" ")}function sn(t,n,i,o){i=A(i,""),typeof i=="boolean"&&(i=i?"1":"0");let r=f(o)?t.createElementNS(o,n):t.createElement(n),s=i==="string"&&i.indexOf("<")!==-1?t.createCDATASection(i):t.createTextNode(i);return r.appendChild(s),r}function Ky(t){let n="",i=t.toBytes();for(let o=3;o>=0;--o)n+=i[o]<16?`0${i[o].toString(16)}`:i[o].toString(16);return n}var eue=fW;function ED(){this._cache={}}ED.prototype.fromColor=function(t,n){return e3(void 0,void 0,t,n,this._cache)};ED.prototype.fromUrl=function(t,n,i){return e3(t,void 0,n,i,this._cache)};ED.prototype.fromMakiIconId=function(t,n,i){return e3(Qt(`Assets/Textures/maki/${encodeURIComponent(t)}.png`),void 0,n,i,this._cache)};ED.prototype.fromText=function(t,n,i){return e3(void 0,t,n,i,this._cache)};var CYe=new z;function xYe(t,n,i){t.save(),t.scale(i/24,i/24),t.fillStyle=n.toCssColorString(),t.strokeStyle=n.brighten(.6,CYe).toCssColorString(),t.lineWidth=.846,t.beginPath(),t.moveTo(6.72,.422),t.lineTo(17.28,.422),t.bezierCurveTo(18.553,.422,19.577,1.758,19.577,3.415),t.lineTo(19.577,10.973),t.bezierCurveTo(19.577,12.63,18.553,13.966,17.282,13.966),t.lineTo(14.386,14.008),t.lineTo(11.826,23.578),t.lineTo(9.614,14.008),t.lineTo(6.719,13.965),t.bezierCurveTo(5.446,13.983,4.422,12.629,4.422,10.972),t.lineTo(4.422,3.416),t.bezierCurveTo(4.423,1.76,5.447,.423,6.718,.423),t.closePath(),t.fill(),t.stroke(),t.restore()}function tue(t,n,i){let o=i/2.5,r=o,s=o;n.width>n.height?s=o*(n.height/n.width):n.width<n.height&&(r=o*(n.width/n.height));let a=Math.round((i-r)/2),c=Math.round(7/24*i-s/2);t.globalCompositeOperation="destination-out",t.drawImage(n,a-1,c,r,s),t.drawImage(n,a,c-1,r,s),t.drawImage(n,a+1,c,r,s),t.drawImage(n,a,c+1,r,s),t.globalCompositeOperation="destination-over",t.fillStyle=z.BLACK.toCssColorString(),t.fillRect(a-1,c-1,r+2,s+2),t.globalCompositeOperation="destination-out",t.drawImage(n,a,c,r,s),t.globalCompositeOperation="destination-over",t.fillStyle=z.WHITE.toCssColorString(),t.fillRect(a-1,c-2,r+2,s+2)}var TD=new Array(4);function e3(t,n,i,o,r){TD[0]=t,TD[1]=n,TD[2]=i,TD[3]=o;let s=JSON.stringify(TD),a=r[s];if(f(a))return a;let c=document.createElement("canvas");c.width=o,c.height=o;let l=c.getContext("2d");if(xYe(l,i,o),f(t)){let d=Ie.createIfNeeded(t).fetchImage().then(function(h){return tue(l,h,o),r[s]=c,c});return r[s]=d,d}else if(f(n)){let u=Ox(n,{font:`bold ${o}px sans-serif`});tue(l,u,o)}return r[s]=c,c}var Tg=ED;function hW(t){return t}function t3(t){if(t==null)return hW;var n,i,o=t.scale[0],r=t.scale[1],s=t.translate[0],a=t.translate[1];return function(c,l){l||(n=i=0);var u=2,d=c.length,h=new Array(d);for(h[0]=(n+=c[0])*o+s,h[1]=(i+=c[1])*r+a;u<d;)h[u]=c[u],++u;return h}}function nue(t,n){for(var i,o=t.length,r=o-n;r<--o;)i=t[r],t[r++]=t[o],t[o]=i}function mW(t,n){return typeof n=="string"&&(n=t.objects[n]),n.type==="GeometryCollection"?{type:"FeatureCollection",features:n.geometries.map(function(i){return iue(t,i)})}:iue(t,n)}function iue(t,n){var i=n.id,o=n.bbox,r=n.properties==null?{}:n.properties,s=pW(t,n);return i==null&&o==null?{type:"Feature",properties:r,geometry:s}:o==null?{type:"Feature",id:i,properties:r,geometry:s}:{type:"Feature",id:i,bbox:o,properties:r,geometry:s}}function pW(t,n){var i=t3(t.transform),o=t.arcs;function r(d,h){h.length&&h.pop();for(var _=o[d<0?~d:d],y=0,p=_.length;y<p;++y)h.push(i(_[y],y));d<0&&nue(h,p)}function s(d){return i(d)}function a(d){for(var h=[],_=0,y=d.length;_<y;++_)r(d[_],h);return h.length<2&&h.push(h[0]),h}function c(d){for(var h=a(d);h.length<4;)h.push(h[0]);return h}function l(d){return d.map(c)}function u(d){var h=d.type,_;switch(h){case"GeometryCollection":return{type:h,geometries:d.geometries.map(u)};case"Point":_=s(d.coordinates);break;case"MultiPoint":_=d.coordinates.map(s);break;case"LineString":_=a(d.arcs);break;case"MultiLineString":_=d.arcs.map(a);break;case"Polygon":_=l(d.arcs);break;case"MultiPolygon":_=d.arcs.map(l);break;default:return null}return{type:h,coordinates:_}}return u(n)}function n3(t){return m.fromDegrees(t[0],t[1],t[2])}var _W={"urn:ogc:def:crs:OGC:1.3:CRS84":n3,"EPSG:4326":n3,"urn:ogc:def:crs:EPSG::4326":n3},oue={},rue={},gW=48,yW,AW=z.ROYALBLUE,CW=z.YELLOW,xW=2,TW=z.fromBytes(255,255,0,100),EW=!1,wYe={small:24,medium:48,large:64},DYe=["title","description","marker-size","marker-symbol","marker-color","stroke","stroke-opacity","stroke-width","fill","fill-opacity"];function sue(t,n){let i="";for(let o in t)if(t.hasOwnProperty(o)){if(o===n||DYe.indexOf(o)!==-1)continue;let r=t[o];f(r)&&(typeof r=="object"?i+=`<tr><th>${o}</th><td>${sue(r)}</td></tr>`:i+=`<tr><th>${o}</th><td>${r}</td></tr>`)}return i.length>0&&(i=`<table class="cesium-infoBox-defaultTable"><tbody>${i}</tbody></table>`),i}function vYe(t,n,i){let o;return function(r,s){return f(o)||(o=t(n,i)),o}}function PYe(t,n){return new rh(vYe(sue,t,n),!0)}function i3(t,n,i){let o=t.id;if(!f(o)||t.type!=="Feature")o=Bn();else{let a=2,c=o;for(;f(n.getById(c));)c=`${o}_${a}`,a++;o=c}let r=n.getOrCreateEntity(o),s=t.properties;if(f(s)){r.properties=s;let a,c=s.title;if(f(c))r.name=c,a="title";else{let u=Number.MAX_VALUE;for(let d in s)if(s.hasOwnProperty(d)&&s[d]){let h=d.toLowerCase();if(u>1&&h==="title"){u=1,a=d;break}else u>2&&h==="name"?(u=2,a=d):u>3&&/title/i.test(d)?(u=3,a=d):u>4&&/name/i.test(d)&&(u=4,a=d)}f(a)&&(r.name=s[a])}let l=s.description;l!==null&&(r.description=f(l)?new Kn(l):i(s,a))}return r}function bW(t,n){let i=new Array(t.length);for(let o=0;o<t.length;o++)i[o]=n(t[o]);return i}var aue={Feature:lue,FeatureCollection:IYe,GeometryCollection:uue,LineString:pue,MultiLineString:_ue,MultiPoint:hue,MultiPolygon:Aue,Point:due,Polygon:yue,Topology:Cue},cue={GeometryCollection:uue,LineString:pue,MultiLineString:_ue,MultiPoint:hue,MultiPolygon:Aue,Point:due,Polygon:yue,Topology:Cue};function lue(t,n,i,o,r){if(n.geometry===null){i3(n,t._entityCollection,r.describe);return}if(!f(n.geometry))throw new he("feature.geometry is required.");let s=n.geometry.type,a=cue[s];if(!f(a))throw new he(`Unknown geometry type: ${s}`);a(t,n,n.geometry,o,r)}function IYe(t,n,i,o,r){let s=n.features;for(let a=0,c=s.length;a<c;a++)lue(t,s[a],void 0,o,r)}function uue(t,n,i,o,r){let s=i.geometries;for(let a=0,c=s.length;a<c;a++){let l=s[a],u=l.type,d=cue[u];if(!f(d))throw new he(`Unknown geometry type: ${u}`);d(t,n,l,o,r)}}function fue(t,n,i,o,r){let s=r.markerSymbol,a=r.markerColor,c=r.markerSize,l=n.properties;if(f(l)){let y=l["marker-color"];f(y)&&(a=z.fromCssColorString(y)),c=A(wYe[l["marker-size"]],c);let p=l["marker-symbol"];f(p)&&(s=p)}let u;f(s)?s.length===1?u=t._pinBuilder.fromText(s.toUpperCase(),a,c):u=t._pinBuilder.fromMakiIconId(s,a,c):u=t._pinBuilder.fromColor(a,c);let d=new Qa;d.verticalOrigin=new Kn(vn.BOTTOM),o.length===2&&r.clampToGround&&(d.heightReference=Ge.CLAMP_TO_GROUND);let h=i3(n,t._entityCollection,r.describe);h.billboard=d,h.position=new Jc(i(o));let _=Promise.resolve(u).then(function(y){d.image=new Kn(y)}).catch(function(){d.image=new Kn(t._pinBuilder.fromColor(a,c))});t._promises.push(_)}function due(t,n,i,o,r){fue(t,n,o,i.coordinates,r)}function hue(t,n,i,o,r){let s=i.coordinates;for(let a=0;a<s.length;a++)fue(t,n,o,s[a],r)}function mue(t,n,i,o,r){let s=r.strokeMaterialProperty,a=r.strokeWidthProperty,c=n.properties;if(f(c)){let d=c["stroke-width"];f(d)&&(a=new Kn(d));let h,_=c.stroke;f(_)&&(h=z.fromCssColorString(_));let y=c["stroke-opacity"];f(y)&&y!==1&&(f(h)||(h=s.color.getValue().clone()),h.alpha=y),f(h)&&(s=new Rt(h))}let l=i3(n,t._entityCollection,r.describe),u=new dc;l.polyline=u,u.clampToGround=r.clampToGround,u.material=s,u.width=a,u.positions=new Kn(bW(o,i)),u.arcType=Zt.RHUMB}function pue(t,n,i,o,r){mue(t,n,o,i.coordinates,r)}function _ue(t,n,i,o,r){let s=i.coordinates;for(let a=0;a<s.length;a++)mue(t,n,o,s[a],r)}function gue(t,n,i,o,r){if(o.length===0||o[0].length===0)return;let s=r.strokeMaterialProperty.color,a=r.fillMaterialProperty,c=r.strokeWidthProperty,l=n.properties;if(f(l)){let y=l["stroke-width"];f(y)&&(c=new Kn(y));let p,C=l.stroke;f(C)&&(p=z.fromCssColorString(C));let x=l["stroke-opacity"];f(x)&&x!==1&&(f(p)||(p=s.getValue().clone()),p.alpha=x),f(p)&&(s=new Kn(p));let T,E=l.fill,S=a.color.getValue();f(E)&&(T=z.fromCssColorString(E),T.alpha=S.alpha),x=l["fill-opacity"],f(x)&&x!==S.alpha&&(f(T)||(T=S.clone()),T.alpha=x),f(T)&&(a=new Rt(T))}let u=new nh;u.outline=new Kn(!0),u.outlineColor=s,u.outlineWidth=c,u.material=a,u.arcType=Zt.RHUMB;let d=[];for(let y=1,p=o.length;y<p;y++)d.push(new Zc(bW(o[y],i)));let h=o[0];u.hierarchy=new Kn(new Zc(bW(h,i),d)),h[0].length>2?u.perPositionHeight=new Kn(!0):r.clampToGround||(u.height=0);let _=i3(n,t._entityCollection,r.describe);_.polygon=u}function yue(t,n,i,o,r){gue(t,n,o,i.coordinates,r)}function Aue(t,n,i,o,r){let s=i.coordinates;for(let a=0;a<s.length;a++)gue(t,n,o,s[a],r)}function Cue(t,n,i,o,r){for(let s in i.objects)if(i.objects.hasOwnProperty(s)){let a=mW(i,i.objects[s]),c=aue[a.type];c(t,a,a,o,r)}}function Eg(t){this._name=t,this._changed=new Ae,this._error=new Ae,this._isLoading=!1,this._loading=new Ae,this._entityCollection=new Ms(this),this._promises=[],this._pinBuilder=new Tg,this._entityCluster=new Uu,this._credit=void 0,this._resourceCredits=[]}Eg.load=function(t,n){return new Eg().load(t,n)};Object.defineProperties(Eg,{markerSize:{get:function(){return gW},set:function(t){gW=t}},markerSymbol:{get:function(){return yW},set:function(t){yW=t}},markerColor:{get:function(){return AW},set:function(t){AW=t}},stroke:{get:function(){return CW},set:function(t){CW=t}},strokeWidth:{get:function(){return xW},set:function(t){xW=t}},fill:{get:function(){return TW},set:function(t){TW=t}},clampToGround:{get:function(){return EW},set:function(t){EW=t}},crsNames:{get:function(){return _W}},crsLinkHrefs:{get:function(){return oue}},crsLinkTypes:{get:function(){return rue}}});Object.defineProperties(Eg.prototype,{name:{get:function(){return this._name},set:function(t){this._name!==t&&(this._name=t,this._changed.raiseEvent(this))}},clock:{value:void 0,writable:!1},entities:{get:function(){return this._entityCollection}},isLoading:{get:function(){return this._isLoading}},changedEvent:{get:function(){return this._changed}},errorEvent:{get:function(){return this._error}},loadingEvent:{get:function(){return this._loading}},show:{get:function(){return this._entityCollection.show},set:function(t){this._entityCollection.show=t}},clustering:{get:function(){return this._entityCluster},set:function(t){this._entityCluster=t}},credit:{get:function(){return this._credit}}});Eg.prototype.load=function(t,n){return xue(this,t,n,!0)};Eg.prototype.process=function(t,n){return xue(this,t,n,!1)};function xue(t,n,i,o){Fr.setLoading(t,!0),i=A(i,A.EMPTY_OBJECT);let r=i.credit;typeof r=="string"&&(r=new Jt(r)),t._credit=r;let s=n,a=i.sourceUri;if(typeof n=="string"||n instanceof Ie){n=Ie.createIfNeeded(n),s=n.fetchJson(),a=A(a,n.getUrlComponent());let c=t._resourceCredits,l=n.credits;if(f(l)){let u=l.length;for(let d=0;d<u;d++)c.push(l[d])}}return i={describe:A(i.describe,PYe),markerSize:A(i.markerSize,gW),markerSymbol:A(i.markerSymbol,yW),markerColor:A(i.markerColor,AW),strokeWidthProperty:new Kn(A(i.strokeWidth,xW)),strokeMaterialProperty:new Rt(A(i.stroke,CW)),fillMaterialProperty:new Rt(A(i.fill,TW)),clampToGround:A(i.clampToGround,EW)},Promise.resolve(s).then(function(c){return BYe(t,c,i,a,o)}).catch(function(c){throw Fr.setLoading(t,!1),t._error.raiseEvent(t,c),c})}Eg.prototype.update=function(t){return!0};function BYe(t,n,i,o,r){let s;f(o)&&(s=$_(o)),f(s)&&t._name!==s&&(t._name=s,t._changed.raiseEvent(t));let a=aue[n.type];if(!f(a))throw new he(`Unsupported GeoJSON object type: ${n.type}`);let c=n.crs,l=c!==null?n3:null;if(f(c)){if(!f(c.properties))throw new he("crs.properties is undefined.");let u=c.properties;if(c.type==="name"){if(l=_W[u.name],!f(l))throw new he(`Unknown crs name: ${u.name}`)}else if(c.type==="link"){let d=oue[u.href];if(f(d)||(d=rue[u.type]),!f(d))throw new he(`Unable to resolve crs link: ${JSON.stringify(u)}`);l=d(u)}else if(c.type==="EPSG"){if(l=_W[`EPSG:${u.code}`],!f(l))throw new he(`Unknown crs EPSG code: ${u.code}`)}else throw new he(`Unknown crs type: ${c.type}`)}return Promise.resolve(l).then(function(u){return r&&t._entityCollection.removeAll(),u!==null&&a(t,n,n,u,i),Promise.all(t._promises).then(function(){return t._promises.length=0,Fr.setLoading(t,!1),t})})}var o3=Eg;var Tue="3.16.2";function Eue(t,n){for(var i in n)n.hasOwnProperty(i)&&t[i]===void 0&&(t[i]=n[i]);return t}function bue(t,n,i){var o;return t.length>n&&(i==null?(i="&hellip;",o=3):o=i.length,t=t.substring(0,n-o)+i),t}function SW(t,n){if(Array.prototype.indexOf)return t.indexOf(n);for(var i=0,o=t.length;i<o;i++)if(t[i]===n)return i;return-1}function bg(t,n){for(var i=t.length-1;i>=0;i--)n(t[i])===!0&&t.splice(i,1)}function Sue(t,n){if(!n.global)throw new Error("`splitRegex` must have the 'g' flag set");for(var i=[],o=0,r;r=n.exec(t);)i.push(t.substring(o,r.index)),i.push(r[0]),o=r.index+r[0].length;return i.push(t.substring(o)),i}function rE(t){throw new Error("Unhandled case for value: '".concat(t,"'"))}var bD=function(){function t(n){n===void 0&&(n={}),this.tagName="",this.attrs={},this.innerHTML="",this.whitespaceRegex=/\s+/,this.tagName=n.tagName||"",this.attrs=n.attrs||{},this.innerHTML=n.innerHtml||n.innerHTML||""}return t.prototype.setTagName=function(n){return this.tagName=n,this},t.prototype.getTagName=function(){return this.tagName||""},t.prototype.setAttr=function(n,i){var o=this.getAttrs();return o[n]=i,this},t.prototype.getAttr=function(n){return this.getAttrs()[n]},t.prototype.setAttrs=function(n){return Object.assign(this.getAttrs(),n),this},t.prototype.getAttrs=function(){return this.attrs||(this.attrs={})},t.prototype.setClass=function(n){return this.setAttr("class",n)},t.prototype.addClass=function(n){for(var i=this.getClass(),o=this.whitespaceRegex,r=i?i.split(o):[],s=n.split(o),a;a=s.shift();)SW(r,a)===-1&&r.push(a);return this.getAttrs().class=r.join(" "),this},t.prototype.removeClass=function(n){for(var i=this.getClass(),o=this.whitespaceRegex,r=i?i.split(o):[],s=n.split(o),a;r.length&&(a=s.shift());){var c=SW(r,a);c!==-1&&r.splice(c,1)}return this.getAttrs().class=r.join(" "),this},t.prototype.getClass=function(){return this.getAttrs().class||""},t.prototype.hasClass=function(n){return(" "+this.getClass()+" ").indexOf(" "+n+" ")!==-1},t.prototype.setInnerHTML=function(n){return this.innerHTML=n,this},t.prototype.setInnerHtml=function(n){return this.setInnerHTML(n)},t.prototype.getInnerHTML=function(){return this.innerHTML||""},t.prototype.getInnerHtml=function(){return this.getInnerHTML()},t.prototype.toAnchorString=function(){var n=this.getTagName(),i=this.buildAttrsStr();return i=i?" "+i:"",["<",n,i,">",this.getInnerHtml(),"</",n,">"].join("")},t.prototype.buildAttrsStr=function(){if(!this.attrs)return"";var n=this.getAttrs(),i=[];for(var o in n)n.hasOwnProperty(o)&&i.push(o+'="'+n[o]+'"');return i.join(" ")},t}();function wue(t,n,i){var o,r;i==null?(i="&hellip;",r=3,o=8):(r=i.length,o=i.length);var s=function(E){var S={},w=E,D=w.match(/^([a-z]+):\/\//i);return D&&(S.scheme=D[1],w=w.substr(D[0].length)),D=w.match(/^(.*?)(?=(\?|#|\/|$))/i),D&&(S.host=D[1],w=w.substr(D[0].length)),D=w.match(/^\/(.*?)(?=(\?|#|$))/i),D&&(S.path=D[1],w=w.substr(D[0].length)),D=w.match(/^\?(.*?)(?=(#|$))/i),D&&(S.query=D[1],w=w.substr(D[0].length)),D=w.match(/^#(.*?)$/i),D&&(S.fragment=D[1]),S},a=function(E){var S="";return E.scheme&&E.host&&(S+=E.scheme+"://"),E.host&&(S+=E.host),E.path&&(S+="/"+E.path),E.query&&(S+="?"+E.query),E.fragment&&(S+="#"+E.fragment),S},c=function(E,S){var w=S/2,D=Math.ceil(w),I=-1*Math.floor(w),O="";return I<0&&(O=E.substr(I)),E.substr(0,D)+i+O};if(t.length<=n)return t;var l=n-r,u=s(t);if(u.query){var d=u.query.match(/^(.*?)(?=(\?|\#))(.*?)$/i);d&&(u.query=u.query.substr(0,d[1].length),t=a(u))}if(t.length<=n||(u.host&&(u.host=u.host.replace(/^www\./,""),t=a(u)),t.length<=n))return t;var h="";if(u.host&&(h+=u.host),h.length>=l)return u.host.length==n?(u.host.substr(0,n-r)+i).substr(0,l+o):c(h,l).substr(0,l+o);var _="";if(u.path&&(_+="/"+u.path),u.query&&(_+="?"+u.query),_)if((h+_).length>=l){if((h+_).length==n)return(h+_).substr(0,n);var y=l-h.length;return(h+c(_,y)).substr(0,l+o)}else h+=_;if(u.fragment){var p="#"+u.fragment;if((h+p).length>=l){if((h+p).length==n)return(h+p).substr(0,n);var C=l-h.length;return(h+c(p,C)).substr(0,l+o)}else h+=p}if(u.scheme&&u.host){var x=u.scheme+"://";if((h+x).length<l)return(x+h).substr(0,n)}if(h.length<=n)return h;var T="";return l>0&&(T=h.substr(-1*Math.floor(l/2))),(h.substr(0,Math.ceil(l/2))+i+T).substr(0,l+o)}function Due(t,n,i){if(t.length<=n)return t;var o,r;i==null?(i="&hellip;",o=8,r=3):(o=i.length,r=i.length);var s=n-r,a="";return s>0&&(a=t.substr(-1*Math.floor(s/2))),(t.substr(0,Math.ceil(s/2))+i+a).substr(0,s+o)}function vue(t,n,i){return bue(t,n,i)}var wW=function(){function t(n){n===void 0&&(n={}),this.newWindow=!1,this.truncate={},this.className="",this.newWindow=n.newWindow||!1,this.truncate=n.truncate||{},this.className=n.className||""}return t.prototype.build=function(n){return new bD({tagName:"a",attrs:this.createAttrs(n),innerHtml:this.processAnchorText(n.getAnchorText())})},t.prototype.createAttrs=function(n){var i={href:n.getAnchorHref()},o=this.createCssClass(n);return o&&(i.class=o),this.newWindow&&(i.target="_blank",i.rel="noopener noreferrer"),this.truncate&&this.truncate.length&&this.truncate.length<n.getAnchorText().length&&(i.title=n.getAnchorHref()),i},t.prototype.createCssClass=function(n){var i=this.className;if(i){for(var o=[i],r=n.getCssClassSuffixes(),s=0,a=r.length;s<a;s++)o.push(i+"-"+r[s]);return o.join(" ")}else return""},t.prototype.processAnchorText=function(n){return n=this.doTruncate(n),n},t.prototype.doTruncate=function(n){var i=this.truncate;if(!i||!i.length)return n;var o=i.length,r=i.location;return r==="smart"?wue(n,o):r==="middle"?Due(n,o):vue(n,o)},t}();var Qu=function(){function t(n){this.__jsduckDummyDocProp=null,this.matchedText="",this.offset=0,this.tagBuilder=n.tagBuilder,this.matchedText=n.matchedText,this.offset=n.offset}return t.prototype.getMatchedText=function(){return this.matchedText},t.prototype.setOffset=function(n){this.offset=n},t.prototype.getOffset=function(){return this.offset},t.prototype.getCssClassSuffixes=function(){return[this.getType()]},t.prototype.buildTag=function(){return this.tagBuilder.build(this)},t}();var DW=function(t,n){return DW=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(i[r]=o[r])},DW(t,n)};function is(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");DW(t,n);function i(){this.constructor=t}t.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}var ur=function(){return ur=Object.assign||function(n){for(var i,o=1,r=arguments.length;o<r;o++){i=arguments[o];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(n[s]=i[s])}return n},ur.apply(this,arguments)};var r3=function(t){is(n,t);function n(i){var o=t.call(this,i)||this;return o.email="",o.email=i.email,o}return n.prototype.getType=function(){return"email"},n.prototype.getEmail=function(){return this.email},n.prototype.getAnchorHref=function(){return"mailto:"+this.email},n.prototype.getAnchorText=function(){return this.email},n}(Qu);var s3=function(t){is(n,t);function n(i){var o=t.call(this,i)||this;return o.serviceName="",o.hashtag="",o.serviceName=i.serviceName,o.hashtag=i.hashtag,o}return n.prototype.getType=function(){return"hashtag"},n.prototype.getServiceName=function(){return this.serviceName},n.prototype.getHashtag=function(){return this.hashtag},n.prototype.getAnchorHref=function(){var i=this.serviceName,o=this.hashtag;switch(i){case"twitter":return"https://twitter.com/hashtag/"+o;case"facebook":return"https://www.facebook.com/hashtag/"+o;case"instagram":return"https://instagram.com/explore/tags/"+o;case"tiktok":return"https://www.tiktok.com/tag/"+o;default:throw new Error("Unknown service name to point hashtag to: "+i)}},n.prototype.getAnchorText=function(){return"#"+this.hashtag},n}(Qu);var a3=function(t){is(n,t);function n(i){var o=t.call(this,i)||this;return o.serviceName="twitter",o.mention="",o.mention=i.mention,o.serviceName=i.serviceName,o}return n.prototype.getType=function(){return"mention"},n.prototype.getMention=function(){return this.mention},n.prototype.getServiceName=function(){return this.serviceName},n.prototype.getAnchorHref=function(){switch(this.serviceName){case"twitter":return"https://twitter.com/"+this.mention;case"instagram":return"https://instagram.com/"+this.mention;case"soundcloud":return"https://soundcloud.com/"+this.mention;case"tiktok":return"https://www.tiktok.com/@"+this.mention;default:throw new Error("Unknown service name to point mention to: "+this.serviceName)}},n.prototype.getAnchorText=function(){return"@"+this.mention},n.prototype.getCssClassSuffixes=function(){var i=t.prototype.getCssClassSuffixes.call(this),o=this.getServiceName();return o&&i.push(o),i},n}(Qu);var c3=function(t){is(n,t);function n(i){var o=t.call(this,i)||this;return o.number="",o.plusSign=!1,o.number=i.number,o.plusSign=i.plusSign,o}return n.prototype.getType=function(){return"phone"},n.prototype.getPhoneNumber=function(){return this.number},n.prototype.getNumber=function(){return this.getPhoneNumber()},n.prototype.getAnchorHref=function(){return"tel:"+(this.plusSign?"+":"")+this.number},n.prototype.getAnchorText=function(){return this.matchedText},n}(Qu);var l3=function(t){is(n,t);function n(i){var o=t.call(this,i)||this;return o.url="",o.urlMatchType="scheme",o.protocolUrlMatch=!1,o.protocolRelativeMatch=!1,o.stripPrefix={scheme:!0,www:!0},o.stripTrailingSlash=!0,o.decodePercentEncoding=!0,o.schemePrefixRegex=/^(https?:\/\/)?/i,o.wwwPrefixRegex=/^(https?:\/\/)?(www\.)?/i,o.protocolRelativeRegex=/^\/\//,o.protocolPrepended=!1,o.urlMatchType=i.urlMatchType,o.url=i.url,o.protocolUrlMatch=i.protocolUrlMatch,o.protocolRelativeMatch=i.protocolRelativeMatch,o.stripPrefix=i.stripPrefix,o.stripTrailingSlash=i.stripTrailingSlash,o.decodePercentEncoding=i.decodePercentEncoding,o}return n.prototype.getType=function(){return"url"},n.prototype.getUrlMatchType=function(){return this.urlMatchType},n.prototype.getUrl=function(){var i=this.url;return!this.protocolRelativeMatch&&!this.protocolUrlMatch&&!this.protocolPrepended&&(i=this.url="http://"+i,this.protocolPrepended=!0),i},n.prototype.getAnchorHref=function(){var i=this.getUrl();return i.replace(/&amp;/g,"&")},n.prototype.getAnchorText=function(){var i=this.getMatchedText();return this.protocolRelativeMatch&&(i=this.stripProtocolRelativePrefix(i)),this.stripPrefix.scheme&&(i=this.stripSchemePrefix(i)),this.stripPrefix.www&&(i=this.stripWwwPrefix(i)),this.stripTrailingSlash&&(i=this.removeTrailingSlash(i)),this.decodePercentEncoding&&(i=this.removePercentEncoding(i)),i},n.prototype.stripSchemePrefix=function(i){return i.replace(this.schemePrefixRegex,"")},n.prototype.stripWwwPrefix=function(i){return i.replace(this.wwwPrefixRegex,"$1")},n.prototype.stripProtocolRelativePrefix=function(i){return i.replace(this.protocolRelativeRegex,"")},n.prototype.removeTrailingSlash=function(i){return i.charAt(i.length-1)==="/"&&(i=i.slice(0,-1)),i},n.prototype.removePercentEncoding=function(i){var o=i.replace(/%22/gi,"&quot;").replace(/%26/gi,"&amp;").replace(/%27/gi,"&#39;").replace(/%3C/gi,"&lt;").replace(/%3E/gi,"&gt;");try{return decodeURIComponent(o)}catch(r){return o}},n}(Qu);var $u=function(){function t(n){this.__jsduckDummyDocProp=null,this.tagBuilder=n.tagBuilder}return t}();var f3=/[A-Za-z]/,Iue=/[\d]/,Bue=/[\D]/,Sg=/\s/,d3=/['"]/,Oue=/[\x00-\x1F\x7F]/,vW=/A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC/.source,OYe=/\u2700-\u27bf\udde6-\uddff\ud800-\udbff\udc00-\udfff\ufe0e\ufe0f\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0\ud83c\udffb-\udfff\u200d\u3299\u3297\u303d\u3030\u24c2\ud83c\udd70-\udd71\udd7e-\udd7f\udd8e\udd91-\udd9a\udde6-\uddff\ude01-\ude02\ude1a\ude2f\ude32-\ude3a\ude50-\ude51\u203c\u2049\u25aa-\u25ab\u25b6\u25c0\u25fb-\u25fe\u00a9\u00ae\u2122\u2139\udc04\u2600-\u26FF\u2b05\u2b06\u2b07\u2b1b\u2b1c\u2b50\u2b55\u231a\u231b\u2328\u23cf\u23e9-\u23f3\u23f8-\u23fa\udccf\u2935\u2934\u2190-\u21ff/.source,RYe=/\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D4-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C03\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D01-\u0D03\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ABE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF2-\u1CF4\u1CF8\u1CF9\u1DC0-\u1DF5\u1DFB-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F/.source,Rue=vW+OYe+RYe,u3=/0-9\u0660-\u0669\u06F0-\u06F9\u07C0-\u07C9\u0966-\u096F\u09E6-\u09EF\u0A66-\u0A6F\u0AE6-\u0AEF\u0B66-\u0B6F\u0BE6-\u0BEF\u0C66-\u0C6F\u0CE6-\u0CEF\u0D66-\u0D6F\u0DE6-\u0DEF\u0E50-\u0E59\u0ED0-\u0ED9\u0F20-\u0F29\u1040-\u1049\u1090-\u1099\u17E0-\u17E9\u1810-\u1819\u1946-\u194F\u19D0-\u19D9\u1A80-\u1A89\u1A90-\u1A99\u1B50-\u1B59\u1BB0-\u1BB9\u1C40-\u1C49\u1C50-\u1C59\uA620-\uA629\uA8D0-\uA8D9\uA900-\uA909\uA9D0-\uA9D9\uA9F0-\uA9F9\uAA50-\uAA59\uABF0-\uABF9\uFF10-\uFF19/.source,Mue=Rue+u3,wo=Rue+u3,sE=new RegExp("[".concat(wo,"]")),MYe="(?:["+u3+"]{1,3}\\.){3}["+u3+"]{1,3}",LYe="["+wo+"](?:["+wo+"\\-_]{0,61}["+wo+"])?",Pue=function(t){return"(?=("+LYe+"))\\"+t},h3=function(t){return"(?:"+Pue(t)+"(?:\\."+Pue(t+1)+"){0,126}|"+MYe+")"},eHn=new RegExp("["+wo+".\\-]*["+wo+"\\-]"),SD=sE;var m3=/(?:xn--vermgensberatung-pwb|xn--vermgensberater-ctb|xn--clchc0ea0b2g2a9gcd|xn--w4r85el8fhu5dnra|northwesternmutual|travelersinsurance|vermögensberatung|xn--5su34j936bgsg|xn--bck1b9a5dre4c|xn--mgbah1a3hjkrd|xn--mgbai9azgqp6j|xn--mgberp4a5d4ar|xn--xkc2dl3a5ee0h|vermögensberater|xn--fzys8d69uvgm|xn--mgba7c0bbn0a|xn--mgbcpq6gpa1a|xn--xkc2al3hye2a|americanexpress|kerryproperties|sandvikcoromant|xn--i1b6b1a6a2e|xn--kcrx77d1x4a|xn--lgbbat1ad8j|xn--mgba3a4f16a|xn--mgbaakc7dvf|xn--mgbc0a9azcg|xn--nqv7fs00ema|americanfamily|bananarepublic|cancerresearch|cookingchannel|kerrylogistics|weatherchannel|xn--54b7fta0cc|xn--6qq986b3xl|xn--80aqecdr1a|xn--b4w605ferd|xn--fiq228c5hs|xn--h2breg3eve|xn--jlq480n2rg|xn--jlq61u9w7b|xn--mgba3a3ejt|xn--mgbaam7a8h|xn--mgbayh7gpa|xn--mgbbh1a71e|xn--mgbca7dzdo|xn--mgbi4ecexp|xn--mgbx4cd0ab|xn--rvc1e0am3e|international|lifeinsurance|travelchannel|wolterskluwer|xn--cckwcxetd|xn--eckvdtc9d|xn--fpcrj9c3d|xn--fzc2c9e2c|xn--h2brj9c8c|xn--tiq49xqyj|xn--yfro4i67o|xn--ygbi2ammx|construction|lplfinancial|scholarships|versicherung|xn--3e0b707e|xn--45br5cyl|xn--4dbrk0ce|xn--80adxhks|xn--80asehdb|xn--8y0a063a|xn--gckr3f0f|xn--mgb9awbf|xn--mgbab2bd|xn--mgbgu82a|xn--mgbpl2fh|xn--mgbt3dhd|xn--mk1bu44c|xn--ngbc5azd|xn--ngbe9e0a|xn--ogbpf8fl|xn--qcka1pmc|accountants|barclaycard|blackfriday|blockbuster|bridgestone|calvinklein|contractors|creditunion|engineering|enterprises|foodnetwork|investments|kerryhotels|lamborghini|motorcycles|olayangroup|photography|playstation|productions|progressive|redumbrella|williamhill|xn--11b4c3d|xn--1ck2e1b|xn--1qqw23a|xn--2scrj9c|xn--3bst00m|xn--3ds443g|xn--3hcrj9c|xn--42c2d9a|xn--45brj9c|xn--55qw42g|xn--6frz82g|xn--80ao21a|xn--9krt00a|xn--cck2b3b|xn--czr694b|xn--d1acj3b|xn--efvy88h|xn--fct429k|xn--fjq720a|xn--flw351e|xn--g2xx48c|xn--gecrj9c|xn--gk3at1e|xn--h2brj9c|xn--hxt814e|xn--imr513n|xn--j6w193g|xn--jvr189m|xn--kprw13d|xn--kpry57d|xn--mgbbh1a|xn--mgbtx2b|xn--mix891f|xn--nyqy26a|xn--otu796d|xn--pgbs0dh|xn--q9jyb4c|xn--rhqv96g|xn--rovu88b|xn--s9brj9c|xn--ses554g|xn--t60b56a|xn--vuq861b|xn--w4rs40l|xn--xhq521b|xn--zfr164b|சிங்கப்பூர்|accountant|apartments|associates|basketball|bnpparibas|boehringer|capitalone|consulting|creditcard|cuisinella|eurovision|extraspace|foundation|healthcare|immobilien|industries|management|mitsubishi|nextdirect|properties|protection|prudential|realestate|republican|restaurant|schaeffler|tatamotors|technology|university|vlaanderen|volkswagen|xn--30rr7y|xn--3pxu8k|xn--45q11c|xn--4gbrim|xn--55qx5d|xn--5tzm5g|xn--80aswg|xn--90a3ac|xn--9dbq2a|xn--9et52u|xn--c2br7g|xn--cg4bki|xn--czrs0t|xn--czru2d|xn--fiq64b|xn--fiqs8s|xn--fiqz9s|xn--io0a7i|xn--kput3i|xn--mxtq1m|xn--o3cw4h|xn--pssy2u|xn--q7ce6a|xn--unup4y|xn--wgbh1c|xn--wgbl6a|xn--y9a3aq|accenture|alfaromeo|allfinanz|amsterdam|analytics|aquarelle|barcelona|bloomberg|christmas|community|directory|education|equipment|fairwinds|financial|firestone|fresenius|frontdoor|furniture|goldpoint|hisamitsu|homedepot|homegoods|homesense|institute|insurance|kuokgroup|lancaster|landrover|lifestyle|marketing|marshalls|melbourne|microsoft|panasonic|passagens|pramerica|richardli|shangrila|solutions|statebank|statefarm|stockholm|travelers|vacations|xn--90ais|xn--c1avg|xn--d1alf|xn--e1a4c|xn--fhbei|xn--j1aef|xn--j1amh|xn--l1acc|xn--ngbrx|xn--nqv7f|xn--p1acf|xn--qxa6a|xn--tckwe|xn--vhquv|yodobashi|موريتانيا|abudhabi|airforce|allstate|attorney|barclays|barefoot|bargains|baseball|boutique|bradesco|broadway|brussels|builders|business|capetown|catering|catholic|cipriani|cityeats|cleaning|clinique|clothing|commbank|computer|delivery|deloitte|democrat|diamonds|discount|discover|download|engineer|ericsson|etisalat|exchange|feedback|fidelity|firmdale|football|frontier|goodyear|grainger|graphics|guardian|hdfcbank|helsinki|holdings|hospital|infiniti|ipiranga|istanbul|jpmorgan|lighting|lundbeck|marriott|maserati|mckinsey|memorial|merckmsd|mortgage|observer|partners|pharmacy|pictures|plumbing|property|redstone|reliance|saarland|samsclub|security|services|shopping|showtime|softbank|software|stcgroup|supplies|training|vanguard|ventures|verisign|woodside|xn--90ae|xn--node|xn--p1ai|xn--qxam|yokohama|السعودية|abogado|academy|agakhan|alibaba|android|athleta|auction|audible|auspost|avianca|banamex|bauhaus|bentley|bestbuy|booking|brother|bugatti|capital|caravan|careers|channel|charity|chintai|citadel|clubmed|college|cologne|comcast|company|compare|contact|cooking|corsica|country|coupons|courses|cricket|cruises|dentist|digital|domains|exposed|express|farmers|fashion|ferrari|ferrero|finance|fishing|fitness|flights|florist|flowers|forsale|frogans|fujitsu|gallery|genting|godaddy|grocery|guitars|hamburg|hangout|hitachi|holiday|hosting|hoteles|hotmail|hyundai|ismaili|jewelry|juniper|kitchen|komatsu|lacaixa|lanxess|lasalle|latrobe|leclerc|limited|lincoln|markets|monster|netbank|netflix|network|neustar|okinawa|oldnavy|organic|origins|philips|pioneer|politie|realtor|recipes|rentals|reviews|rexroth|samsung|sandvik|schmidt|schwarz|science|shiksha|singles|staples|storage|support|surgery|systems|temasek|theater|theatre|tickets|tiffany|toshiba|trading|walmart|wanggou|watches|weather|website|wedding|whoswho|windows|winners|xfinity|yamaxun|youtube|zuerich|католик|اتصالات|البحرين|الجزائر|العليان|پاکستان|كاثوليك|இந்தியா|abarth|abbott|abbvie|africa|agency|airbus|airtel|alipay|alsace|alstom|amazon|anquan|aramco|author|bayern|beauty|berlin|bharti|bostik|boston|broker|camera|career|casino|center|chanel|chrome|church|circle|claims|clinic|coffee|comsec|condos|coupon|credit|cruise|dating|datsun|dealer|degree|dental|design|direct|doctor|dunlop|dupont|durban|emerck|energy|estate|events|expert|family|flickr|futbol|gallup|garden|george|giving|global|google|gratis|health|hermes|hiphop|hockey|hotels|hughes|imamat|insure|intuit|jaguar|joburg|juegos|kaufen|kinder|kindle|kosher|lancia|latino|lawyer|lefrak|living|locker|london|luxury|madrid|maison|makeup|market|mattel|mobile|monash|mormon|moscow|museum|mutual|nagoya|natura|nissan|nissay|norton|nowruz|office|olayan|online|oracle|orange|otsuka|pfizer|photos|physio|pictet|quebec|racing|realty|reisen|repair|report|review|rocher|rogers|ryukyu|safety|sakura|sanofi|school|schule|search|secure|select|shouji|soccer|social|stream|studio|supply|suzuki|swatch|sydney|taipei|taobao|target|tattoo|tennis|tienda|tjmaxx|tkmaxx|toyota|travel|unicom|viajes|viking|villas|virgin|vision|voting|voyage|vuelos|walter|webcam|xihuan|yachts|yandex|zappos|москва|онлайн|ابوظبي|ارامكو|الاردن|المغرب|امارات|فلسطين|مليسيا|भारतम्|இலங்கை|ファッション|actor|adult|aetna|amfam|amica|apple|archi|audio|autos|azure|baidu|beats|bible|bingo|black|boats|bosch|build|canon|cards|chase|cheap|cisco|citic|click|cloud|coach|codes|crown|cymru|dabur|dance|deals|delta|drive|dubai|earth|edeka|email|epson|faith|fedex|final|forex|forum|gallo|games|gifts|gives|glass|globo|gmail|green|gripe|group|gucci|guide|homes|honda|horse|house|hyatt|ikano|irish|jetzt|koeln|kyoto|lamer|lease|legal|lexus|lilly|linde|lipsy|loans|locus|lotte|lotto|macys|mango|media|miami|money|movie|music|nexus|nikon|ninja|nokia|nowtv|omega|osaka|paris|parts|party|phone|photo|pizza|place|poker|praxi|press|prime|promo|quest|radio|rehab|reise|ricoh|rocks|rodeo|rugby|salon|sener|seven|sharp|shell|shoes|skype|sling|smart|smile|solar|space|sport|stada|store|study|style|sucks|swiss|tatar|tires|tirol|tmall|today|tokyo|tools|toray|total|tours|trade|trust|tunes|tushu|ubank|vegas|video|vodka|volvo|wales|watch|weber|weibo|works|world|xerox|yahoo|ישראל|ایران|بازار|بھارت|سودان|سورية|همراه|भारोत|संगठन|বাংলা|భారత్|ഭാരതം|嘉里大酒店|aarp|able|adac|aero|akdn|ally|amex|arab|army|arpa|arte|asda|asia|audi|auto|baby|band|bank|bbva|beer|best|bike|bing|blog|blue|bofa|bond|book|buzz|cafe|call|camp|care|cars|casa|case|cash|cbre|cern|chat|citi|city|club|cool|coop|cyou|data|date|dclk|deal|dell|desi|diet|dish|docs|dvag|erni|fage|fail|fans|farm|fast|fiat|fido|film|fire|fish|flir|food|ford|free|fund|game|gbiz|gent|ggee|gift|gmbh|gold|golf|goog|guge|guru|hair|haus|hdfc|help|here|hgtv|host|hsbc|icbc|ieee|imdb|immo|info|itau|java|jeep|jobs|jprs|kddi|kids|kiwi|kpmg|kred|land|lego|lgbt|lidl|life|like|limo|link|live|loan|loft|love|ltda|luxe|maif|meet|meme|menu|mini|mint|mobi|moda|moto|name|navy|news|next|nico|nike|ollo|open|page|pars|pccw|pics|ping|pink|play|plus|pohl|porn|post|prod|prof|qpon|read|reit|rent|rest|rich|room|rsvp|ruhr|safe|sale|sarl|save|saxo|scot|seat|seek|sexy|shaw|shia|shop|show|silk|sina|site|skin|sncf|sohu|song|sony|spot|star|surf|talk|taxi|team|tech|teva|tiaa|tips|town|toys|tube|vana|visa|viva|vivo|vote|voto|wang|weir|wien|wiki|wine|work|xbox|yoga|zara|zero|zone|дети|сайт|بارت|بيتك|ڀارت|تونس|شبكة|عراق|عمان|موقع|भारत|ভারত|ভাৰত|ਭਾਰਤ|ભારત|ଭାରତ|ಭಾರತ|ලංකා|アマゾン|グーグル|クラウド|ポイント|组织机构|電訊盈科|香格里拉|aaa|abb|abc|aco|ads|aeg|afl|aig|anz|aol|app|art|aws|axa|bar|bbc|bbt|bcg|bcn|bet|bid|bio|biz|bms|bmw|bom|boo|bot|box|buy|bzh|cab|cal|cam|car|cat|cba|cbn|cbs|ceo|cfa|cfd|com|cpa|crs|dad|day|dds|dev|dhl|diy|dnp|dog|dot|dtv|dvr|eat|eco|edu|esq|eus|fan|fit|fly|foo|fox|frl|ftr|fun|fyi|gal|gap|gay|gdn|gea|gle|gmo|gmx|goo|gop|got|gov|hbo|hiv|hkt|hot|how|ibm|ice|icu|ifm|inc|ing|ink|int|ist|itv|jcb|jio|jll|jmp|jnj|jot|joy|kfh|kia|kim|kpn|krd|lat|law|lds|llc|llp|lol|lpl|ltd|man|map|mba|med|men|mil|mit|mlb|mls|mma|moe|moi|mom|mov|msd|mtn|mtr|nab|nba|nec|net|new|nfl|ngo|nhk|now|nra|nrw|ntt|nyc|obi|one|ong|onl|ooo|org|ott|ovh|pay|pet|phd|pid|pin|pnc|pro|pru|pub|pwc|red|ren|ril|rio|rip|run|rwe|sap|sas|sbi|sbs|sca|scb|ses|sew|sex|sfr|ski|sky|soy|spa|srl|stc|tab|tax|tci|tdk|tel|thd|tjx|top|trv|tui|tvs|ubs|uno|uol|ups|vet|vig|vin|vip|wed|win|wme|wow|wtc|wtf|xin|xxx|xyz|you|yun|zip|бел|ком|қаз|мкд|мон|орг|рус|срб|укр|հայ|קום|عرب|قطر|كوم|مصر|कॉम|नेट|คอม|ไทย|ລາວ|ストア|セール|みんな|中文网|亚马逊|天主教|我爱你|新加坡|淡马锡|诺基亚|飞利浦|ac|ad|ae|af|ag|ai|al|am|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cw|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|ss|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|za|zm|zw|ελ|ευ|бг|ею|рф|გე|닷넷|닷컴|삼성|한국|コム|世界|中信|中国|中國|企业|佛山|信息|健康|八卦|公司|公益|台湾|台灣|商城|商店|商标|嘉里|在线|大拿|娱乐|家電|广东|微博|慈善|手机|招聘|政务|政府|新闻|时尚|書籍|机构|游戏|澳門|点看|移动|网址|网店|网站|网络|联通|谷歌|购物|通販|集团|食品|餐厅|香港)/;var FYe=new RegExp("[".concat(wo,"!#$%&'*+/=?^_`{|}~-]")),NYe=new RegExp("^".concat(m3.source,"$")),PW=function(t){is(n,t);function n(){var i=t!==null&&t.apply(this,arguments)||this;return i.localPartCharRegex=FYe,i.strictTldRegex=NYe,i}return n.prototype.parseMatches=function(i){for(var o=this.tagBuilder,r=this.localPartCharRegex,s=this.strictTldRegex,a=[],c=i.length,l=new p3,u={m:"a",a:"i",i:"l",l:"t",t:"o",o:":"},d=0,h=0,_=l;d<c;){var y=i.charAt(d);switch(h){case 0:p(y);break;case 1:C(i.charAt(d-1),y);break;case 2:x(y);break;case 3:T(y);break;case 4:E(y);break;case 5:S(y);break;case 6:w(y);break;case 7:D(y);break;default:rE(h)}d++}return M(),a;function p(L){L==="m"?I(1):r.test(L)&&I()}function C(L,F){L===":"?r.test(F)?(h=2,_=new p3(ur(ur({},_),{hasMailtoPrefix:!0}))):O():u[L]===F||(r.test(F)?h=2:F==="."?h=3:F==="@"?h=4:O())}function x(L){L==="."?h=3:L==="@"?h=4:r.test(L)||O()}function T(L){L==="."||L==="@"?O():r.test(L)?h=2:O()}function E(L){SD.test(L)?h=5:O()}function S(L){L==="."?h=7:L==="-"?h=6:SD.test(L)||M()}function w(L){L==="-"||L==="."?M():SD.test(L)?h=5:M()}function D(L){L==="."||L==="-"?M():SD.test(L)?(h=5,_=new p3(ur(ur({},_),{hasDomainDot:!0}))):M()}function I(L){L===void 0&&(L=2),h=L,_=new p3({idx:d})}function O(){h=0,_=l}function M(){if(_.hasDomainDot){var L=i.slice(_.idx,d);/[-.]$/.test(L)&&(L=L.slice(0,-1));var F=_.hasMailtoPrefix?L.slice(7):L;g(F)&&a.push(new r3({tagBuilder:o,matchedText:L,offset:_.idx,email:F}))}O();function g(b){var v=b.split(".").pop()||"",P=v.toLowerCase(),R=s.test(P);return R}}},n}($u);var p3=function(){function t(n){n===void 0&&(n={}),this.idx=n.idx!==void 0?n.idx:-1,this.hasMailtoPrefix=!!n.hasMailtoPrefix,this.hasDomainDot=!!n.hasDomainDot}return t}();var Lue=function(){function t(){}return t.isValid=function(n,i){return!(i&&!this.isValidUriScheme(i)||this.urlMatchDoesNotHaveProtocolOrDot(n,i)||this.urlMatchDoesNotHaveAtLeastOneWordChar(n,i)&&!this.isValidIpAddress(n)||this.containsMultipleDots(n))},t.isValidIpAddress=function(n){var i=new RegExp(this.hasFullProtocolRegex.source+this.ipRegex.source),o=n.match(i);return o!==null},t.containsMultipleDots=function(n){var i=n;return this.hasFullProtocolRegex.test(n)&&(i=n.split("://")[1]),i.split("/")[0].indexOf("..")>-1},t.isValidUriScheme=function(n){var i=n.match(this.uriSchemeRegex),o=i&&i[0].toLowerCase();return o!=="javascript:"&&o!=="vbscript:"},t.urlMatchDoesNotHaveProtocolOrDot=function(n,i){return!!n&&(!i||!this.hasFullProtocolRegex.test(i))&&n.indexOf(".")===-1},t.urlMatchDoesNotHaveAtLeastOneWordChar=function(n,i){return n&&i?!this.hasFullProtocolRegex.test(i)&&!this.hasWordCharAfterProtocolRegex.test(n):!1},t.hasFullProtocolRegex=/^[A-Za-z][-.+A-Za-z0-9]*:\/\//,t.uriSchemeRegex=/^[A-Za-z][-.+A-Za-z0-9]*:/,t.hasWordCharAfterProtocolRegex=new RegExp(":[^\\s]*?["+vW+"]"),t.ipRegex=/[0-9][0-9]?[0-9]?\.[0-9][0-9]?[0-9]?\.[0-9][0-9]?[0-9]?\.[0-9][0-9]?[0-9]?(:[0-9]*)?\/?$/,t}();var VYe=function(){var t=/(?:[A-Za-z][-.+A-Za-z0-9]{0,63}:(?![A-Za-z][-.+A-Za-z0-9]{0,63}:\/\/)(?!\d+\/?)(?:\/\/)?)/,n=/(?:www\.)/,i=new RegExp("[/?#](?:["+wo+"\\-+&@#/%=~_()|'$*\\[\\]{}?!:,.;^\u2713]*["+wo+"\\-+&@#/%=~_()|'$*\\[\\]{}\u2713])?");return new RegExp(["(?:","(",t.source,h3(2),")","|","(","(//)?",n.source,h3(6),")","|","(","(//)?",h3(10)+"\\.",m3.source,"(?![-"+Mue+"])",")",")","(?::[0-9]+)?","(?:"+i.source+")?"].join(""),"gi")}(),kYe=new RegExp("["+wo+"]"),IW=function(t){is(n,t);function n(i){var o=t.call(this,i)||this;return o.stripPrefix={scheme:!0,www:!0},o.stripTrailingSlash=!0,o.decodePercentEncoding=!0,o.matcherRegex=VYe,o.wordCharRegExp=kYe,o.stripPrefix=i.stripPrefix,o.stripTrailingSlash=i.stripTrailingSlash,o.decodePercentEncoding=i.decodePercentEncoding,o}return n.prototype.parseMatches=function(i){for(var o=this.matcherRegex,r=this.stripPrefix,s=this.stripTrailingSlash,a=this.decodePercentEncoding,c=this.tagBuilder,l=[],u,d=function(){var _=u[0],y=u[1],p=u[4],C=u[5],x=u[9],T=u.index,E=C||x,S=i.charAt(T-1);if(!Lue.isValid(_,y)||T>0&&S==="@"||T>0&&E&&h.wordCharRegExp.test(S))return"continue";if(/\?$/.test(_)&&(_=_.substr(0,_.length-1)),h.matchHasUnbalancedClosingParen(_))_=_.substr(0,_.length-1);else{var w=h.matchHasInvalidCharAfterTld(_,y);w>-1&&(_=_.substr(0,w))}var D=["http://","https://"].find(function(L){return!!y&&y.indexOf(L)!==-1});if(D){var I=_.indexOf(D);_=_.substr(I),y=y.substr(I),T=T+I}var O=y?"scheme":p?"www":"tld",M=!!y;l.push(new l3({tagBuilder:c,matchedText:_,offset:T,urlMatchType:O,url:_,protocolUrlMatch:M,protocolRelativeMatch:!!E,stripPrefix:r,stripTrailingSlash:s,decodePercentEncoding:a}))},h=this;(u=o.exec(i))!==null;)d();return l},n.prototype.matchHasUnbalancedClosingParen=function(i){var o=i.charAt(i.length-1),r;if(o===")")r="(";else if(o==="]")r="[";else if(o==="}")r="{";else return!1;for(var s=0,a=0,c=i.length-1;a<c;a++){var l=i.charAt(a);l===r?s++:l===o&&(s=Math.max(s-1,0))}return s===0},n.prototype.matchHasInvalidCharAfterTld=function(i,o){if(!i)return-1;var r=0;o&&(r=i.indexOf(":"),i=i.slice(r));var s=new RegExp("^((.?//)?[-."+wo+"]*[-"+wo+"]\\.[-"+wo+"]+)"),a=s.exec(i);return a===null?-1:(r+=a[1].length,i=i.slice(a[1].length),/^[^-.A-Za-z0-9:\/?#]/.test(i)?r:-1)},n}($u);var Fue=new RegExp("[_".concat(wo,"]")),BW=function(t){is(n,t);function n(i){var o=t.call(this,i)||this;return o.serviceName="twitter",o.serviceName=i.serviceName,o}return n.prototype.parseMatches=function(i){for(var o=this.tagBuilder,r=this.serviceName,s=[],a=i.length,c=0,l=-1,u=0;c<a;){var d=i.charAt(c);switch(u){case 0:h(d);break;case 1:_(d);break;case 2:y(d);break;case 3:p(d);break;default:rE(u)}c++}return C(),s;function h(x){x==="#"?(u=2,l=c):sE.test(x)&&(u=1)}function _(x){sE.test(x)||(u=0)}function y(x){Fue.test(x)?u=3:sE.test(x)?u=1:u=0}function p(x){Fue.test(x)||(C(),l=-1,sE.test(x)?u=1:u=0)}function C(){if(l>-1&&c-l<=140){var x=i.slice(l,c),T=new s3({tagBuilder:o,matchedText:x,offset:l,serviceName:r,hashtag:x.slice(1)});s.push(T)}}},n}($u);var Nue=["twitter","facebook","instagram","tiktok"];var UYe=/(?:(?:(?:(\+)?\d{1,3}[-\040.]?)?\(?\d{3}\)?[-\040.]?\d{3}[-\040.]?\d{4})|(?:(\+)(?:9[976]\d|8[987530]\d|6[987]\d|5[90]\d|42\d|3[875]\d|2[98654321]\d|9[8543210]|8[6421]|6[6543210]|5[87654321]|4[987654310]|3[9643210]|2[70]|7|1)[-\040.]?(?:\d[-\040.]?){6,12}\d+))([,;]+[0-9]+#?)*/,zYe=/(0([1-9]{1}-?[1-9]\d{3}|[1-9]{2}-?\d{3}|[1-9]{2}\d{1}-?\d{2}|[1-9]{2}\d{2}-?\d{1})-?\d{4}|0[789]0-?\d{4}-?\d{4}|050-?\d{4}-?\d{4})/,HYe=new RegExp("".concat(UYe.source,"|").concat(zYe.source),"g"),OW=function(t){is(n,t);function n(){var i=t!==null&&t.apply(this,arguments)||this;return i.matcherRegex=HYe,i}return n.prototype.parseMatches=function(i){for(var o=this.matcherRegex,r=this.tagBuilder,s=[],a;(a=o.exec(i))!==null;){var c=a[0],l=c.replace(/[^0-9,;#]/g,""),u=!!(a[1]||a[2]),d=a.index==0?"":i.substr(a.index-1,1),h=i.substr(a.index+c.length,1),_=!d.match(/\d/)&&!h.match(/\d/);this.testMatch(a[3])&&this.testMatch(c)&&_&&s.push(new c3({tagBuilder:r,matchedText:c,offset:a.index,number:l,plusSign:u}))}return s},n.prototype.testMatch=function(i){return Bue.test(i)},n}($u);var GYe=new RegExp("@[_".concat(wo,"]{1,50}(?![_").concat(wo,"])"),"g"),WYe=new RegExp("@[_.".concat(wo,"]{1,30}(?![_").concat(wo,"])"),"g"),jYe=new RegExp("@[-_.".concat(wo,"]{1,50}(?![-_").concat(wo,"])"),"g"),qYe=new RegExp("@[_.".concat(wo,"]{1,23}[_").concat(wo,"](?![_").concat(wo,"])"),"g"),YYe=new RegExp("[^"+wo+"]"),RW=function(t){is(n,t);function n(i){var o=t.call(this,i)||this;return o.serviceName="twitter",o.matcherRegexes={twitter:GYe,instagram:WYe,soundcloud:jYe,tiktok:qYe},o.nonWordCharRegex=YYe,o.serviceName=i.serviceName,o}return n.prototype.parseMatches=function(i){var o=this.serviceName,r=this.matcherRegexes[this.serviceName],s=this.nonWordCharRegex,a=this.tagBuilder,c=[],l;if(!r)return c;for(;(l=r.exec(i))!==null;){var u=l.index,d=i.charAt(u-1);if(u===0||s.test(d)){var h=l[0].replace(/\.+$/g,""),_=h.slice(1);c.push(new a3({tagBuilder:a,matchedText:h,offset:u,serviceName:o,mention:_}))}}return c},n}($u);function Vue(t,n){for(var i=n.onOpenTag,o=n.onCloseTag,r=n.onText,s=n.onComment,a=n.onDoctype,c=new Ph,l=0,u=t.length,d=0,h=0,_=c;l<u;){var y=t.charAt(l);switch(d){case 0:p(y);break;case 1:C(y);break;case 2:T(y);break;case 3:x(y);break;case 4:E(y);break;case 5:S(y);break;case 6:w(y);break;case 7:D(y);break;case 8:I(y);break;case 9:O(y);break;case 10:M(y);break;case 11:L(y);break;case 12:F(y);break;case 13:g(y);break;case 14:b(y);break;case 15:v(y);break;case 16:P(y);break;case 17:R(y);break;case 18:V(y);break;case 19:H(y);break;case 20:U(y);break;default:rE(d)}l++}h<l&&Y();function p(Z){Z==="<"&&k()}function C(Z){Z==="!"?d=13:Z==="/"?(d=2,_=new Ph(ur(ur({},_),{isClosing:!0}))):Z==="<"?k():f3.test(Z)?(d=3,_=new Ph(ur(ur({},_),{isOpening:!0}))):(d=0,_=c)}function x(Z){Sg.test(Z)?(_=new Ph(ur(ur({},_),{name:K()})),d=4):Z==="<"?k():Z==="/"?(_=new Ph(ur(ur({},_),{name:K()})),d=12):Z===">"?(_=new Ph(ur(ur({},_),{name:K()})),X()):!f3.test(Z)&&!Iue.test(Z)&&Z!==":"&&G()}function T(Z){Z===">"?G():f3.test(Z)?d=3:G()}function E(Z){Sg.test(Z)||(Z==="/"?d=12:Z===">"?X():Z==="<"?k():Z==="="||d3.test(Z)||Oue.test(Z)?G():d=5)}function S(Z){Sg.test(Z)?d=6:Z==="/"?d=12:Z==="="?d=7:Z===">"?X():Z==="<"?k():d3.test(Z)&&G()}function w(Z){Sg.test(Z)||(Z==="/"?d=12:Z==="="?d=7:Z===">"?X():Z==="<"?k():d3.test(Z)?G():d=5)}function D(Z){Sg.test(Z)||(Z==='"'?d=8:Z==="'"?d=9:/[>=`]/.test(Z)?G():Z==="<"?k():d=10)}function I(Z){Z==='"'&&(d=11)}function O(Z){Z==="'"&&(d=11)}function M(Z){Sg.test(Z)?d=4:Z===">"?X():Z==="<"&&k()}function L(Z){Sg.test(Z)?d=4:Z==="/"?d=12:Z===">"?X():Z==="<"?k():(d=4,j())}function F(Z){Z===">"?(_=new Ph(ur(ur({},_),{isClosing:!0})),X()):d=4}function g(Z){t.substr(l,2)==="--"?(l+=2,_=new Ph(ur(ur({},_),{type:"comment"})),d=14):t.substr(l,7).toUpperCase()==="DOCTYPE"?(l+=7,_=new Ph(ur(ur({},_),{type:"doctype"})),d=20):G()}function b(Z){Z==="-"?d=15:Z===">"?G():d=16}function v(Z){Z==="-"?d=18:Z===">"?G():d=16}function P(Z){Z==="-"&&(d=17)}function R(Z){Z==="-"?d=18:d=16}function V(Z){Z===">"?X():Z==="!"?d=19:Z==="-"||(d=16)}function H(Z){Z==="-"?d=17:Z===">"?X():d=16}function U(Z){Z===">"?X():Z==="<"&&k()}function G(){d=0,_=c}function k(){d=1,_=new Ph({idx:l})}function X(){var Z=t.slice(h,_.idx);Z&&r(Z,h),_.type==="comment"?s(_.idx):_.type==="doctype"?a(_.idx):(_.isOpening&&i(_.name,_.idx),_.isClosing&&o(_.name,_.idx)),G(),h=l+1}function Y(){var Z=t.slice(h,l);r(Z,h),h=l+1}function K(){var Z=_.idx+(_.isClosing?2:1);return t.slice(Z,l).toLowerCase()}function j(){l--}}var Ph=function(){function t(n){n===void 0&&(n={}),this.idx=n.idx!==void 0?n.idx:-1,this.type=n.type||"tag",this.name=n.name||"",this.isOpening=!!n.isOpening,this.isClosing=!!n.isClosing}return t}();var XYe=function(){function t(n){n===void 0&&(n={}),this.version=t.version,this.urls={},this.email=!0,this.phone=!0,this.hashtag=!1,this.mention=!1,this.newWindow=!0,this.stripPrefix={scheme:!0,www:!0},this.stripTrailingSlash=!0,this.decodePercentEncoding=!0,this.truncate={length:0,location:"end"},this.className="",this.replaceFn=null,this.context=void 0,this.sanitizeHtml=!1,this.matchers=null,this.tagBuilder=null,this.urls=this.normalizeUrlsCfg(n.urls),this.email=typeof n.email=="boolean"?n.email:this.email,this.phone=typeof n.phone=="boolean"?n.phone:this.phone,this.hashtag=n.hashtag||this.hashtag,this.mention=n.mention||this.mention,this.newWindow=typeof n.newWindow=="boolean"?n.newWindow:this.newWindow,this.stripPrefix=this.normalizeStripPrefixCfg(n.stripPrefix),this.stripTrailingSlash=typeof n.stripTrailingSlash=="boolean"?n.stripTrailingSlash:this.stripTrailingSlash,this.decodePercentEncoding=typeof n.decodePercentEncoding=="boolean"?n.decodePercentEncoding:this.decodePercentEncoding,this.sanitizeHtml=n.sanitizeHtml||!1;var i=this.mention;if(i!==!1&&["twitter","instagram","soundcloud","tiktok"].indexOf(i)===-1)throw new Error("invalid `mention` cfg '".concat(i,"' - see docs"));var o=this.hashtag;if(o!==!1&&Nue.indexOf(o)===-1)throw new Error("invalid `hashtag` cfg '".concat(o,"' - see docs"));this.truncate=this.normalizeTruncateCfg(n.truncate),this.className=n.className||this.className,this.replaceFn=n.replaceFn||this.replaceFn,this.context=n.context||this}return t.link=function(n,i){var o=new t(i);return o.link(n)},t.parse=function(n,i){var o=new t(i);return o.parse(n)},t.prototype.normalizeUrlsCfg=function(n){return n==null&&(n=!0),typeof n=="boolean"?{schemeMatches:n,wwwMatches:n,tldMatches:n}:{schemeMatches:typeof n.schemeMatches=="boolean"?n.schemeMatches:!0,wwwMatches:typeof n.wwwMatches=="boolean"?n.wwwMatches:!0,tldMatches:typeof n.tldMatches=="boolean"?n.tldMatches:!0}},t.prototype.normalizeStripPrefixCfg=function(n){return n==null&&(n=!0),typeof n=="boolean"?{scheme:n,www:n}:{scheme:typeof n.scheme=="boolean"?n.scheme:!0,www:typeof n.www=="boolean"?n.www:!0}},t.prototype.normalizeTruncateCfg=function(n){return typeof n=="number"?{length:n,location:"end"}:Eue(n||{},{length:Number.POSITIVE_INFINITY,location:"end"})},t.prototype.parse=function(n){var i=this,o=["a","style","script"],r=0,s=[];return Vue(n,{onOpenTag:function(a){o.indexOf(a)>=0&&r++},onText:function(a,c){if(r===0){var l=/(&nbsp;|&#160;|&lt;|&#60;|&gt;|&#62;|&quot;|&#34;|&#39;)/gi,u=Sue(a,l),d=c;u.forEach(function(h,_){if(_%2===0){var y=i.parseText(h,d);s.push.apply(s,y)}d+=h.length})}},onCloseTag:function(a){o.indexOf(a)>=0&&(r=Math.max(r-1,0))},onComment:function(a){},onDoctype:function(a){}}),s=this.compactMatches(s),s=this.removeUnwantedMatches(s),s},t.prototype.compactMatches=function(n){n.sort(function(l,u){return l.getOffset()-u.getOffset()});for(var i=0;i<n.length-1;){var o=n[i],r=o.getOffset(),s=o.getMatchedText().length,a=r+s;if(i+1<n.length){if(n[i+1].getOffset()===r){var c=n[i+1].getMatchedText().length>s?i:i+1;n.splice(c,1);continue}if(n[i+1].getOffset()<a){n.splice(i+1,1);continue}}i++}return n},t.prototype.removeUnwantedMatches=function(n){return this.hashtag||bg(n,function(i){return i.getType()==="hashtag"}),this.email||bg(n,function(i){return i.getType()==="email"}),this.phone||bg(n,function(i){return i.getType()==="phone"}),this.mention||bg(n,function(i){return i.getType()==="mention"}),this.urls.schemeMatches||bg(n,function(i){return i.getType()==="url"&&i.getUrlMatchType()==="scheme"}),this.urls.wwwMatches||bg(n,function(i){return i.getType()==="url"&&i.getUrlMatchType()==="www"}),this.urls.tldMatches||bg(n,function(i){return i.getType()==="url"&&i.getUrlMatchType()==="tld"}),n},t.prototype.parseText=function(n,i){i===void 0&&(i=0),i=i||0;for(var o=this.getMatchers(),r=[],s=0,a=o.length;s<a;s++){for(var c=o[s].parseMatches(n),l=0,u=c.length;l<u;l++)c[l].setOffset(i+c[l].getOffset());r.push.apply(r,c)}return r},t.prototype.link=function(n){if(!n)return"";this.sanitizeHtml&&(n=n.replace(/</g,"&lt;").replace(/>/g,"&gt;"));for(var i=this.parse(n),o=[],r=0,s=0,a=i.length;s<a;s++){var c=i[s];o.push(n.substring(r,c.getOffset())),o.push(this.createMatchReturnVal(c)),r=c.getOffset()+c.getMatchedText().length}return o.push(n.substring(r)),o.join("")},t.prototype.createMatchReturnVal=function(n){var i;if(this.replaceFn&&(i=this.replaceFn.call(this.context,n)),typeof i=="string")return i;if(i===!1)return n.getMatchedText();if(i instanceof bD)return i.toAnchorString();var o=n.buildTag();return o.toAnchorString()},t.prototype.getMatchers=function(){if(this.matchers)return this.matchers;var n=this.getTagBuilder(),i=[new BW({tagBuilder:n,serviceName:this.hashtag}),new PW({tagBuilder:n}),new OW({tagBuilder:n}),new RW({tagBuilder:n,serviceName:this.mention}),new IW({tagBuilder:n,stripPrefix:this.stripPrefix,stripTrailingSlash:this.stripTrailingSlash,decodePercentEncoding:this.decodePercentEncoding})];return this.matchers=i},t.prototype.getTagBuilder=function(){var n=this.tagBuilder;return n||(n=this.tagBuilder=new wW({newWindow:this.newWindow,truncate:this.truncate,className:this.className})),n},t.version=Tue,t.AnchorTagBuilder=wW,t.HtmlTag=bD,t.matcher={Email:PW,Hashtag:BW,Matcher:$u,Mention:RW,Phone:OW,Url:IW},t.match={Email:r3,Hashtag:s3,Match:Qu,Mention:a3,Phone:c3,Url:l3},t}(),kue=XYe;var _3=kue;var Xue;typeof DOMParser!="undefined"&&(Xue=new DOMParser);var KYe=new _3({stripPrefix:!1,email:!1,replaceFn:function(t,n){if(!n.protocolUrlMatch)return!1}}),g3=32,Uue=2414016,zue=1,Hue=16093e3,Gue=.1,JYe=[null,void 0,"http://www.topografix.com/GPX/1/1"],xo={gpx:JYe};function ZYe(t){return new Promise((n,i)=>{let o=new FileReader;o.addEventListener("load",function(){n(o.result)}),o.addEventListener("error",function(){i(o.error)}),o.readAsText(t)})}function MW(t,n){let i=vD(t,"id");return i=f(i)?i:Bn(),n.getOrCreateEntity(i)}function LW(t){let n=Wue(t,"lon"),i=Wue(t,"lat"),o=wD(t,"ele",xo.gpx);return m.fromDegrees(n,i,o)}function Wue(t,n){if(!f(t))return;let i=t.getAttribute(n);if(i!==null){let o=parseFloat(i);return isNaN(o)?void 0:o}}function vD(t,n){if(!f(t))return;let i=t.getAttribute(n);return i!==null?i:void 0}function wg(t,n,i){if(!f(t))return;let o=t.childNodes,r=o.length;for(let s=0;s<r;s++){let a=o[s];if(a.localName===n&&i.indexOf(a.namespaceURI)!==-1)return a}}function FW(t,n,i){if(!f(t))return;let o=[],r=t.getElementsByTagName(n),s=r.length;for(let a=0;a<s;a++){let c=r[a];c.localName===n&&i.indexOf(c.namespaceURI)!==-1&&o.push(c)}return o}function wD(t,n,i){let o=wg(t,n,i);if(f(o)){let r=parseFloat(o.textContent);return isNaN(r)?void 0:r}}function al(t,n,i){let o=wg(t,n,i);if(f(o))return o.textContent.trim()}function Kue(t){let n=new Qa;return n.width=g3,n.height=g3,n.scaleByDistance=new Pt(Uue,zue,Hue,Gue),n.pixelOffsetScaleByDistance=new Pt(Uue,zue,Hue,Gue),n.verticalOrigin=new Kn(vn.BOTTOM),n.image=t,n}function QYe(){let t=new th;return t.translucencyByDistance=new Pt(3e6,1,5e6,0),t.pixelOffset=new W(17,0),t.horizontalOrigin=ui.LEFT,t.font="16px sans-serif",t.style=Lo.FILL_AND_OUTLINE,t}function Jue(t){let n=new dc;return n.width=4,n.material=new Oy,n.material.color=f(t)?t:z.RED,n.material.outlineWidth=2,n.material.outlineColor=z.BLACK,n}var jue={time:{text:"Time",tag:"time"},comment:{text:"Comment",tag:"cmt"},description:{text:"Description",tag:"desc"},source:{text:"Source",tag:"src"},number:{text:"GPS track/route number",tag:"number"},type:{text:"Type",tag:"type"}},DD;typeof document!="undefined"&&(DD=document.createElement("div"));function NW(t,n){let i,o="",r=Object.keys(jue),s=r.length;for(i=0;i<s;i++){let d=r[i],h=jue[d];h.value=A(al(t,h.tag,xo.gpx),""),f(h.value)&&h.value!==""&&(o=`${o}<p>${h.text}: ${h.value}</p>`)}if(!f(o)||o==="")return;o=KYe.link(o),DD.innerHTML=o;let a=DD.querySelectorAll("a");for(i=0;i<a.length;i++)a[i].setAttribute("target","_blank");let c=z.WHITE,l=z.BLACK,u='<div class="cesium-infoBox-description-lighter" style="';return u+="overflow:auto;",u+="word-wrap:break-word;",u+=`background-color:${c.toCssColorString()};`,u+=`color:${l.toCssColorString()};`,u+='">',u+=`${DD.innerHTML}</div>`,DD.innerHTML="",u}function Zue(t,n,i,o){let r=LW(n),s=MW(n,i);s.position=r;let a=f(o.waypointImage)?o.waypointImage:t._pinBuilder.fromMakiIconId("marker",z.RED,g3);s.billboard=Kue(a);let c=al(n,"name",xo.gpx);s.name=c,s.label=QYe(),s.label.text=c,s.description=NW(n,s),o.clampToGround&&(s.billboard.heightReference=Ge.CLAMP_TO_GROUND,s.label.heightReference=Ge.CLAMP_TO_GROUND)}function $Ye(t,n,i,o){let r=MW(n,i);r.description=NW(n,r);let s=FW(n,"rtept",xo.gpx),a=new Array(s.length);for(let c=0;c<s.length;c++)Zue(t,s[c],i,o),a[c]=LW(s[c]);r.polyline=Jue(o.routeColor),o.clampToGround&&(r.polyline.clampToGround=!0),r.polyline.positions=a}function eXe(t,n,i,o){let r=MW(n,i);r.description=NW(n,r);let s=FW(n,"trkseg",xo.gpx),a=[],c=[],l,u=!0,d=new oa;for(let h=0;h<s.length;h++)l=tXe(s[h]),a=a.concat(l.positions),l.times.length>0?(c=c.concat(l.times),d.addSamples(c,a),u=u&&!0):u=!1;if(u){let h=f(o.waypointImage)?o.waypointImage:t._pinBuilder.fromMakiIconId("marker",z.RED,g3);r.billboard=Kue(h),r.position=d,o.clampToGround&&(r.billboard.heightReference=Ge.CLAMP_TO_GROUND),r.availability=new Lr,r.availability.addInterval(new xn({start:c[0],stop:c[c.length-1]}))}r.polyline=Jue(o.trackColor),r.polyline.positions=a,o.clampToGround&&(r.polyline.clampToGround=!0)}function tXe(t){let n={positions:[],times:[]},i=FW(t,"trkpt",xo.gpx),o;for(let r=0;r<i.length;r++){let s=LW(i[r]);n.positions.push(s),o=al(i[r],"time",xo.gpx),f(o)&&n.times.push(te.fromIso8601(o))}return n}function nXe(t){let n=wg(t,"metadata",xo.gpx);if(f(n)){let i={name:al(n,"name",xo.gpx),desc:al(n,"desc",xo.gpx),author:iXe(n),copyright:rXe(n),link:Que(n),time:al(n,"time",xo.gpx),keywords:al(n,"keywords",xo.gpx),bounds:sXe(n)};if(f(i.name)||f(i.desc)||f(i.author)||f(i.copyright)||f(i.link)||f(i.time)||f(i.keywords)||f(i.bounds))return i}}function iXe(t){let n=wg(t,"author",xo.gpx);if(f(n)){let i={name:al(n,"name",xo.gpx),email:oXe(n),link:Que(n)};if(f(i.name)||f(i.email)||f(i.link))return i}}function oXe(t){let n=wg(t,"email",xo.gpx);if(f(n)){let i=al(n,"id",xo.gpx),o=al(n,"domain",xo.gpx);return`${i}@${o}`}}function Que(t){let n=wg(t,"link",xo.gpx);if(f(n)){let i={href:vD(n,"href"),text:al(n,"text",xo.gpx),mimeType:al(n,"type",xo.gpx)};if(f(i.href)||f(i.text)||f(i.mimeType))return i}}function rXe(t){let n=wg(t,"copyright",xo.gpx);if(f(n)){let i={author:vD(n,"author"),year:al(n,"year",xo.gpx),license:al(n,"license",xo.gpx)};if(f(i.author)||f(i.year)||f(i.license))return i}}function sXe(t){let n=wg(t,"bounds",xo.gpx);if(f(n)){let i={minLat:wD(n,"minlat",xo.gpx),maxLat:wD(n,"maxlat",xo.gpx),minLon:wD(n,"minlon",xo.gpx),maxLon:wD(n,"maxlon",xo.gpx)};if(f(i.minLat)||f(i.maxLat)||f(i.minLon)||f(i.maxLon))return i}}var que={wpt:Zue,rte:$Ye,trk:eXe};function aXe(t,n,i,o){let r=Object.keys(que),s=r.length;for(let a=0;a<s;a++){let c=r[a],l=que[c],u=n.childNodes,d=u.length;for(let h=0;h<d;h++){let _=u[h];_.localName===c&&xo.gpx.indexOf(_.namespaceURI)!==-1&&l(t,_,i,o)}}}function Yue(t,n,i){let o=t._entityCollection;o.removeAll();let r=n.documentElement,s=vD(r,"version"),a=vD(r,"creator"),c,l=nXe(r);f(l)&&(c=l.name),r.localName==="gpx"?aXe(t,r,o,i):console.log(`GPX - Unsupported node: ${r.localName}`);let u,d=o.computeAvailability(),h=d.start,_=d.stop,y=te.equals(h,Ue.MINIMUM_VALUE),p=te.equals(_,Ue.MAXIMUM_VALUE);if(!y||!p){let x;y&&(x=new Date,x.setHours(0,0,0,0),h=te.fromDate(x)),p&&(x=new Date,x.setHours(24,0,0,0),_=te.fromDate(x)),u=new gh,u.startTime=h,u.stopTime=_,u.currentTime=te.clone(h),u.clockRange=Nr.LOOP_STOP,u.clockStep=po.SYSTEM_CLOCK_MULTIPLIER,u.multiplier=Math.round(Math.min(Math.max(te.secondsDifference(_,h)/60,1),31556900))}let C=!1;return t._name!==c&&(t._name=c,C=!0),t._creator!==a&&(t._creator=a,C=!0),cXe(t._metadata,l)&&(t._metadata=l,C=!0),t._version!==s&&(t._version=s,C=!0),u!==t._clock&&(C=!0,t._clock=u),C&&t._changed.raiseEvent(t),Fr.setLoading(t,!1),t}function cXe(t,n){return!f(t)&&!f(n)?!1:f(t)&&f(n)?t.name!==n.name||t.dec!==n.desc||t.src!==n.src||t.author!==n.author||t.copyright!==n.copyright||t.link!==n.link||t.time!==n.time||t.bounds!==n.bounds:!0}function lXe(t,n,i,o){o=A(o,A.EMPTY_OBJECT);let r=i;if(typeof i=="string"||i instanceof Ie){i=Ie.createIfNeeded(i),r=i.fetchBlob();let s=t._resourceCredits,a=i.credits;if(f(a)){let c=a.length;for(let l=0;l<c;l++)s.push(a[l])}}return Promise.resolve(r).then(function(s){return s instanceof Blob?ZYe(s).then(function(a){let c,l;try{c=Xue.parseFromString(a,"application/xml")}catch(u){l=u.toString()}if(f(l)||c.body||c.documentElement.tagName==="parsererror"){let u=f(l)?l:c.documentElement.firstChild.nodeValue;throw u||(u=c.body.innerText),new he(u)}return Yue(t,c,o)}):Yue(t,s,o)}).catch(function(s){return t._error.raiseEvent(t,s),console.log(s),Promise.reject(s)})}function aE(){this._changed=new Ae,this._error=new Ae,this._loading=new Ae,this._clock=void 0,this._entityCollection=new Ms,this._entityCluster=new Uu,this._name=void 0,this._version=void 0,this._creator=void 0,this._metadata=void 0,this._isLoading=!1,this._pinBuilder=new Tg}aE.load=function(t,n){return new aE().load(t,n)};Object.defineProperties(aE.prototype,{name:{get:function(){return this._name}},version:{get:function(){return this._version}},creator:{get:function(){return this._creator}},metadata:{get:function(){return this._metadata}},clock:{get:function(){return this._clock}},entities:{get:function(){return this._entityCollection}},isLoading:{get:function(){return this._isLoading}},changedEvent:{get:function(){return this._changed}},errorEvent:{get:function(){return this._error}},loadingEvent:{get:function(){return this._loading}},show:{get:function(){return this._entityCollection.show},set:function(t){this._entityCollection.show=t}},clustering:{get:function(){return this._entityCluster},set:function(t){this._entityCluster=t}}});aE.prototype.update=function(t){return!0};aE.prototype.load=function(t,n){if(!f(t))throw new Ce("data is required.");n=A(n,A.EMPTY_OBJECT),Fr.setLoading(this,!0);let i=this._name,o=this;return lXe(this,this._entityCollection,t,n).then(function(){let r,s=o._entityCollection.computeAvailability(),a=s.start,c=s.stop,l=te.equals(a,Ue.MINIMUM_VALUE),u=te.equals(c,Ue.MAXIMUM_VALUE);if(!l||!u){let h;l&&(h=new Date,h.setHours(0,0,0,0),a=te.fromDate(h)),u&&(h=new Date,h.setHours(24,0,0,0),c=te.fromDate(h)),r=new gh,r.startTime=a,r.stopTime=c,r.currentTime=te.clone(a),r.clockRange=Nr.LOOP_STOP,r.clockStep=po.SYSTEM_CLOCK_MULTIPLIER,r.multiplier=Math.round(Math.min(Math.max(te.secondsDifference(c,a)/60,1),31556900))}let d=!1;return r!==o._clock&&(o._clock=r,d=!0),i!==o._name&&(d=!0),d&&o._changed.raiseEvent(o),Fr.setLoading(o,!1),o}).catch(function(r){return Fr.setLoading(o,!1),o._error.raiseEvent(o,r),console.log(r),Promise.reject(r)})};var y3=aE;function uXe(t,n){this.position=t,this.headingPitchRoll=n}var A3=uXe;var BD=yo(gl(),1);function fXe(t){return typeof t=="string"&&(t=document.getElementById(t)),t}var On=fXe;function dXe(t,n){this.position=t,this.headingPitchRange=n}var C3=dXe;function x3(t,n){this.id=n,this.name=t,this.playlistIndex=0,this.playlist=[],this.tourStart=new Ae,this.tourEnd=new Ae,this.entryStart=new Ae,this.entryEnd=new Ae,this._activeEntries=[]}x3.prototype.addPlaylistEntry=function(t){this.playlist.push(t)};x3.prototype.play=function(t,n){f(t.cesiumWidget)&&ws("viewer","The viewer parameter has been deprecated in Cesium 1.99. It will be removed in 1.100. Instead of a Viewer, pass a CesiumWidget instead."),this.tourStart.raiseEvent();let i=this;efe.call(this,t,n,function(o){i.playlistIndex=0,o||$ue(i._activeEntries),i.tourEnd.raiseEvent(o)})};x3.prototype.stop=function(){$ue(this._activeEntries)};function $ue(t){for(let n=t.pop();n!==void 0;n=t.pop())n.stop()}function efe(t,n,i){let o=this.playlist[this.playlistIndex];if(o){let r=hXe.bind(this,t,n,i);if(this._activeEntries.push(o),this.entryStart.raiseEvent(o),o.blocking)o.play(r,t.scene.camera,n);else{let s=this;o.play(function(){s.entryEnd.raiseEvent(o);let a=s._activeEntries.indexOf(o);a>=0&&s._activeEntries.splice(a,1)}),r(t,n,i)}}else f(i)&&i(!1)}function hXe(t,n,i,o){let r=this.playlist[this.playlistIndex];if(this.entryEnd.raiseEvent(r,o),o)i(o);else{let s=this._activeEntries.indexOf(r);s>=0&&this._activeEntries.splice(s,1),this.playlistIndex++,efe.call(this,t,n,i)}}var T3=x3;var vi={Linear:{None:function(t){return t}},Quadratic:{In:function(t){return t*t},Out:function(t){return t*(2-t)},InOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}},Cubic:{In:function(t){return t*t*t},Out:function(t){return--t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}},Quartic:{In:function(t){return t*t*t*t},Out:function(t){return 1- --t*t*t*t},InOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},Quintic:{In:function(t){return t*t*t*t*t},Out:function(t){return--t*t*t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},Sinusoidal:{In:function(t){return 1-Math.cos(t*Math.PI/2)},Out:function(t){return Math.sin(t*Math.PI/2)},InOut:function(t){return .5*(1-Math.cos(Math.PI*t))}},Exponential:{In:function(t){return t===0?0:Math.pow(1024,t-1)},Out:function(t){return t===1?1:1-Math.pow(2,-10*t)},InOut:function(t){return t===0?0:t===1?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(-Math.pow(2,-10*(t-1))+2)}},Circular:{In:function(t){return 1-Math.sqrt(1-t*t)},Out:function(t){return Math.sqrt(1- --t*t)},InOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},Elastic:{In:function(t){return t===0?0:t===1?1:-Math.pow(2,10*(t-1))*Math.sin((t-1.1)*5*Math.PI)},Out:function(t){return t===0?0:t===1?1:Math.pow(2,-10*t)*Math.sin((t-.1)*5*Math.PI)+1},InOut:function(t){return t===0?0:t===1?1:(t*=2,t<1?-.5*Math.pow(2,10*(t-1))*Math.sin((t-1.1)*5*Math.PI):.5*Math.pow(2,-10*(t-1))*Math.sin((t-1.1)*5*Math.PI)+1)}},Back:{In:function(t){var n=1.70158;return t*t*((n+1)*t-n)},Out:function(t){var n=1.70158;return--t*t*((n+1)*t+n)+1},InOut:function(t){var n=2.5949095;return(t*=2)<1?.5*(t*t*((n+1)*t-n)):.5*((t-=2)*t*((n+1)*t+n)+2)}},Bounce:{In:function(t){return 1-vi.Bounce.Out(1-t)},Out:function(t){return t<.36363636363636365?7.5625*t*t:t<.7272727272727273?7.5625*(t-=.5454545454545454)*t+.75:t<.9090909090909091?7.5625*(t-=.8181818181818182)*t+.9375:7.5625*(t-=.9545454545454546)*t+.984375},InOut:function(t){return t<.5?vi.Bounce.In(t*2)*.5:vi.Bounce.Out(t*2-1)*.5+.5}}},PD;typeof self=="undefined"&&typeof process!="undefined"&&process.hrtime?PD=function(){var t=process.hrtime();return t[0]*1e3+t[1]/1e6}:typeof self!="undefined"&&self.performance!==void 0&&self.performance.now!==void 0?PD=self.performance.now.bind(self.performance):Date.now!==void 0?PD=Date.now:PD=function(){return new Date().getTime()};var cE=PD,mXe=function(){function t(){this._tweens={},this._tweensAddedDuringUpdate={}}return t.prototype.getAll=function(){var n=this;return Object.keys(this._tweens).map(function(i){return n._tweens[i]})},t.prototype.removeAll=function(){this._tweens={}},t.prototype.add=function(n){this._tweens[n.getId()]=n,this._tweensAddedDuringUpdate[n.getId()]=n},t.prototype.remove=function(n){delete this._tweens[n.getId()],delete this._tweensAddedDuringUpdate[n.getId()]},t.prototype.update=function(n,i){n===void 0&&(n=cE()),i===void 0&&(i=!1);var o=Object.keys(this._tweens);if(o.length===0)return!1;for(;o.length>0;){this._tweensAddedDuringUpdate={};for(var r=0;r<o.length;r++){var s=this._tweens[o[r]],a=!i;s&&s.update(n,a)===!1&&!i&&delete this._tweens[o[r]]}o=Object.keys(this._tweensAddedDuringUpdate)}return!0},t}(),ID={Linear:function(t,n){var i=t.length-1,o=i*n,r=Math.floor(o),s=ID.Utils.Linear;return n<0?s(t[0],t[1],o):n>1?s(t[i],t[i-1],i-o):s(t[r],t[r+1>i?i:r+1],o-r)},Bezier:function(t,n){for(var i=0,o=t.length-1,r=Math.pow,s=ID.Utils.Bernstein,a=0;a<=o;a++)i+=r(1-n,o-a)*r(n,a)*t[a]*s(o,a);return i},CatmullRom:function(t,n){var i=t.length-1,o=i*n,r=Math.floor(o),s=ID.Utils.CatmullRom;return t[0]===t[i]?(n<0&&(r=Math.floor(o=i*(1+n))),s(t[(r-1+i)%i],t[r],t[(r+1)%i],t[(r+2)%i],o-r)):n<0?t[0]-(s(t[0],t[0],t[1],t[1],-o)-t[0]):n>1?t[i]-(s(t[i],t[i],t[i-1],t[i-1],o-i)-t[i]):s(t[r?r-1:0],t[r],t[i<r+1?i:r+1],t[i<r+2?i:r+2],o-r)},Utils:{Linear:function(t,n,i){return(n-t)*i+t},Bernstein:function(t,n){var i=ID.Utils.Factorial;return i(t)/i(n)/i(t-n)},Factorial:function(){var t=[1];return function(n){var i=1;if(t[n])return t[n];for(var o=n;o>1;o--)i*=o;return t[n]=i,i}}(),CatmullRom:function(t,n,i,o,r){var s=(i-t)*.5,a=(o-n)*.5,c=r*r,l=r*c;return(2*n-2*i+s+a)*l+(-3*n+3*i-2*s-a)*c+s*r+n}}},tfe=function(){function t(){}return t.nextId=function(){return t._nextId++},t._nextId=0,t}(),nfe=new mXe,ife=function(){function t(n,i){i===void 0&&(i=nfe),this._object=n,this._group=i,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=vi.Linear.None,this._interpolationFunction=ID.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._id=tfe.nextId(),this._isChainStopped=!1,this._goToEnd=!1}return t.prototype.getId=function(){return this._id},t.prototype.isPlaying=function(){return this._isPlaying},t.prototype.isPaused=function(){return this._isPaused},t.prototype.to=function(n,i){return this._valuesEnd=Object.create(n),i!==void 0&&(this._duration=i),this},t.prototype.duration=function(n){return this._duration=n,this},t.prototype.start=function(n){if(this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed){this._reversed=!1;for(var i in this._valuesStartRepeat)this._swapEndStartRepeatValues(i),this._valuesStart[i]=this._valuesStartRepeat[i]}return this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=n!==void 0?typeof n=="string"?cE()+parseFloat(n):n:cE(),this._startTime+=this._delayTime,this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat),this},t.prototype._setupProperties=function(n,i,o,r){for(var s in o){var a=n[s],c=Array.isArray(a),l=c?"array":typeof a,u=!c&&Array.isArray(o[s]);if(!(l==="undefined"||l==="function")){if(u){var d=o[s];if(d.length===0)continue;d=d.map(this._handleRelativeValue.bind(this,a)),o[s]=[a].concat(d)}if((l==="object"||c)&&a&&!u){i[s]=c?[]:{};for(var h in a)i[s][h]=a[h];r[s]=c?[]:{},this._setupProperties(a,i[s],o[s],r[s])}else typeof i[s]=="undefined"&&(i[s]=a),c||(i[s]*=1),u?r[s]=o[s].slice().reverse():r[s]=i[s]||0}}},t.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},t.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},t.prototype.pause=function(n){return n===void 0&&(n=cE()),this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._pauseStart=n,this._group&&this._group.remove(this),this)},t.prototype.resume=function(n){return n===void 0&&(n=cE()),!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._startTime+=n-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this)},t.prototype.stopChainedTweens=function(){for(var n=0,i=this._chainedTweens.length;n<i;n++)this._chainedTweens[n].stop();return this},t.prototype.group=function(n){return this._group=n,this},t.prototype.delay=function(n){return this._delayTime=n,this},t.prototype.repeat=function(n){return this._initialRepeat=n,this._repeat=n,this},t.prototype.repeatDelay=function(n){return this._repeatDelayTime=n,this},t.prototype.yoyo=function(n){return this._yoyo=n,this},t.prototype.easing=function(n){return this._easingFunction=n,this},t.prototype.interpolation=function(n){return this._interpolationFunction=n,this},t.prototype.chain=function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];return this._chainedTweens=n,this},t.prototype.onStart=function(n){return this._onStartCallback=n,this},t.prototype.onUpdate=function(n){return this._onUpdateCallback=n,this},t.prototype.onRepeat=function(n){return this._onRepeatCallback=n,this},t.prototype.onComplete=function(n){return this._onCompleteCallback=n,this},t.prototype.onStop=function(n){return this._onStopCallback=n,this},t.prototype.update=function(n,i){if(n===void 0&&(n=cE()),i===void 0&&(i=!0),this._isPaused)return!0;var o,r,s=this._startTime+this._duration;if(!this._goToEnd&&!this._isPlaying){if(n>s)return!1;i&&this.start(n)}if(this._goToEnd=!1,n<this._startTime)return!0;this._onStartCallbackFired===!1&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),r=(n-this._startTime)/this._duration,r=this._duration===0||r>1?1:r;var a=this._easingFunction(r);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,a),this._onUpdateCallback&&this._onUpdateCallback(this._object,r),r===1)if(this._repeat>0){isFinite(this._repeat)&&this._repeat--;for(o in this._valuesStartRepeat)!this._yoyo&&typeof this._valuesEnd[o]=="string"&&(this._valuesStartRepeat[o]=this._valuesStartRepeat[o]+parseFloat(this._valuesEnd[o])),this._yoyo&&this._swapEndStartRepeatValues(o),this._valuesStart[o]=this._valuesStartRepeat[o];return this._yoyo&&(this._reversed=!this._reversed),this._repeatDelayTime!==void 0?this._startTime=n+this._repeatDelayTime:this._startTime=n+this._delayTime,this._onRepeatCallback&&this._onRepeatCallback(this._object),!0}else{this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var c=0,l=this._chainedTweens.length;c<l;c++)this._chainedTweens[c].start(this._startTime+this._duration);return this._isPlaying=!1,!1}return!0},t.prototype._updateProperties=function(n,i,o,r){for(var s in o)if(i[s]!==void 0){var a=i[s]||0,c=o[s],l=Array.isArray(n[s]),u=Array.isArray(c),d=!l&&u;d?n[s]=this._interpolationFunction(c,r):typeof c=="object"&&c?this._updateProperties(n[s],a,c,r):(c=this._handleRelativeValue(a,c),typeof c=="number"&&(n[s]=a+(c-a)*r))}},t.prototype._handleRelativeValue=function(n,i){return typeof i!="string"?i:i.charAt(0)==="+"||i.charAt(0)==="-"?n+parseFloat(i):parseFloat(i)},t.prototype._swapEndStartRepeatValues=function(n){var i=this._valuesStartRepeat[n],o=this._valuesEnd[n];typeof o=="string"?this._valuesStartRepeat[n]=this._valuesStartRepeat[n]+parseFloat(o):this._valuesStartRepeat[n]=this._valuesEnd[n],this._valuesEnd[n]=i},t}();var fGn=tfe.nextId,Ih=nfe,dGn=Ih.getAll.bind(Ih),hGn=Ih.removeAll.bind(Ih),mGn=Ih.add.bind(Ih),pGn=Ih.remove.bind(Ih),_Gn=Ih.update.bind(Ih);var pXe={LINEAR_NONE:vi.Linear.None,QUADRATIC_IN:vi.Quadratic.In,QUADRATIC_OUT:vi.Quadratic.Out,QUADRATIC_IN_OUT:vi.Quadratic.InOut,CUBIC_IN:vi.Cubic.In,CUBIC_OUT:vi.Cubic.Out,CUBIC_IN_OUT:vi.Cubic.InOut,QUARTIC_IN:vi.Quartic.In,QUARTIC_OUT:vi.Quartic.Out,QUARTIC_IN_OUT:vi.Quartic.InOut,QUINTIC_IN:vi.Quintic.In,QUINTIC_OUT:vi.Quintic.Out,QUINTIC_IN_OUT:vi.Quintic.InOut,SINUSOIDAL_IN:vi.Sinusoidal.In,SINUSOIDAL_OUT:vi.Sinusoidal.Out,SINUSOIDAL_IN_OUT:vi.Sinusoidal.InOut,EXPONENTIAL_IN:vi.Exponential.In,EXPONENTIAL_OUT:vi.Exponential.Out,EXPONENTIAL_IN_OUT:vi.Exponential.InOut,CIRCULAR_IN:vi.Circular.In,CIRCULAR_OUT:vi.Circular.Out,CIRCULAR_IN_OUT:vi.Circular.InOut,ELASTIC_IN:vi.Elastic.In,ELASTIC_OUT:vi.Elastic.Out,ELASTIC_IN_OUT:vi.Elastic.InOut,BACK_IN:vi.Back.In,BACK_OUT:vi.Back.Out,BACK_IN_OUT:vi.Back.InOut,BOUNCE_IN:vi.Bounce.In,BOUNCE_OUT:vi.Bounce.Out,BOUNCE_IN_OUT:vi.Bounce.InOut},Vr=Object.freeze(pXe);function E3(t,n,i){this.type="KmlTourFlyTo",this.blocking=!0,this.activeCamera=null,this.activeCallback=null,this.duration=t,this.view=i,this.flyToMode=n}E3.prototype.play=function(t,n,i){if(this.activeCamera=n,f(t)&&t!==null){let r=this;this.activeCallback=function(s){delete r.activeCallback,delete r.activeCamera,t(f(s)?!1:s)}}let o=this.getCameraOptions(i);if(this.view.headingPitchRoll)n.flyTo(o);else if(this.view.headingPitchRange){let r=new ae(this.view.position);n.flyToBoundingSphere(r,o)}};E3.prototype.stop=function(){f(this.activeCamera)&&this.activeCamera.cancelFlight(),f(this.activeCallback)&&this.activeCallback(!0)};E3.prototype.getCameraOptions=function(t){let n={duration:this.duration};return f(this.activeCallback)&&(n.complete=this.activeCallback),this.flyToMode==="smooth"&&(n.easingFunction=Vr.LINEAR_NONE),this.view.headingPitchRoll?(n.destination=this.view.position,n.orientation=this.view.headingPitchRoll):this.view.headingPitchRange&&(n.offset=this.view.headingPitchRange),f(t)&&(n=At(n,t)),n};var b3=E3;function VW(t){this.type="KmlTourWait",this.blocking=!0,this.duration=t,this.timeout=null}VW.prototype.play=function(t){let n=this;this.activeCallback=t,this.timeout=setTimeout(function(){delete n.activeCallback,t(!1)},this.duration*1e3)};VW.prototype.stop=function(){clearTimeout(this.timeout),f(this.activeCallback)&&this.activeCallback(!0)};var S3=VW;var hfe={avi:"video/x-msvideo",bmp:"image/bmp",bz2:"application/x-bzip2",chm:"application/vnd.ms-htmlhelp",css:"text/css",csv:"text/csv",doc:"application/msword",dvi:"application/x-dvi",eps:"application/postscript",flv:"video/x-flv",gif:"image/gif",gz:"application/x-gzip",htm:"text/html",html:"text/html",ico:"image/vnd.microsoft.icon",jnlp:"application/x-java-jnlp-file",jpeg:"image/jpeg",jpg:"image/jpeg",m3u:"audio/x-mpegurl",m4v:"video/mp4",mathml:"application/mathml+xml",mid:"audio/midi",midi:"audio/midi",mov:"video/quicktime",mp3:"audio/mpeg",mp4:"video/mp4",mp4v:"video/mp4",mpeg:"video/mpeg",mpg:"video/mpeg",odp:"application/vnd.oasis.opendocument.presentation",ods:"application/vnd.oasis.opendocument.spreadsheet",odt:"application/vnd.oasis.opendocument.text",ogg:"application/ogg",pdf:"application/pdf",png:"image/png",pps:"application/vnd.ms-powerpoint",ppt:"application/vnd.ms-powerpoint",ps:"application/postscript",qt:"video/quicktime",rdf:"application/rdf+xml",rss:"application/rss+xml",rtf:"application/rtf",svg:"image/svg+xml",swf:"application/x-shockwave-flash",text:"text/plain",tif:"image/tiff",tiff:"image/tiff",txt:"text/plain",wav:"audio/x-wav",wma:"audio/x-ms-wma",wmv:"video/x-ms-wmv",xml:"application/xml",zip:"application/zip",detectFromFilename:function(t){let n=t.toLowerCase();return n=iC(n),hfe[n]}},jW;typeof DOMParser!="undefined"&&(jW=new DOMParser);var _Xe=new _3({stripPrefix:!1,email:!1,replaceFn:function(t){if(!t.protocolUrlMatch)return!1}}),Dg=32,ofe=2414016,rfe=1,sfe=16093e3,afe=.1,cfe=[null,void 0,"http://www.opengis.net/kml/2.2","http://earth.google.com/kml/2.2","http://earth.google.com/kml/2.1","http://earth.google.com/kml/2.0"],lfe=["http://www.google.com/kml/ext/2.2"],gXe=["http://www.w3.org/2005/Atom"],Pe={kml:cfe,gx:lfe,atom:gXe,kmlgx:cfe.concat(lfe)},qW={Document:Efe,Folder:FXe,Placemark:NXe,NetworkLink:qXe,GroundOverlay:GXe,PhotoOverlay:wfe,ScreenOverlay:HXe,Tour:kXe};function Bh(t){this._dataSource=t,this._deferred=Zr(),this._stack=[],this._promises=[],this._timeoutSet=!1,this._used=!1,this._started=0,this._timeThreshold=1e3}Object.defineProperties(Bh.prototype,{dataSource:{get:function(){return this._dataSource}}});Bh.prototype.addNodes=function(t,n){this._stack.push({nodes:t,index:0,processingData:n}),this._used=!0};Bh.prototype.addPromise=function(t){this._promises.push(t)};Bh.prototype.wait=function(){let t=this._deferred;return this._used||t.resolve(),Promise.all([t.promise,Promise.all(this._promises)])};Bh.prototype.process=function(){let t=this._stack.length===1;return t&&(this._started=Yl._getTimestamp()),this._process(t)};Bh.prototype._giveUpTime=function(){if(this._timeoutSet)return;this._timeoutSet=!0,this._timeThreshold=50;let t=this;setTimeout(function(){t._timeoutSet=!1,t._started=Yl._getTimestamp(),t._process(!0)},0)};Bh.prototype._nextNode=function(){let t=this._stack,n=t[t.length-1],i=n.index,o=n.nodes;if(i!==o.length)return++n.index,o[i]};Bh.prototype._pop=function(){let t=this._stack;return t.pop(),t.length===0?(this._deferred.resolve(),!1):!0};Bh.prototype._process=function(t){let n=this.dataSource,i=this._stack[this._stack.length-1].processingData,o=this._nextNode();for(;f(o);){let r=qW[o.localName];if(f(r)&&(Pe.kml.indexOf(o.namespaceURI)!==-1||Pe.gx.indexOf(o.namespaceURI)!==-1)&&(r(n,o,i,this),this._timeoutSet||Yl._getTimestamp()>this._started+this._timeThreshold)){this._giveUpTime();return}o=this._nextNode()}this._pop()&&t&&this._process(!0)};function yXe(t){let n=t.slice(0,Math.min(4,t.size)),i=Zr(),o=new FileReader;return o.addEventListener("load",function(){i.resolve(new DataView(o.result).getUint32(0,!1)===1347093252)}),o.addEventListener("error",function(){i.reject(o.error)}),o.readAsArrayBuffer(n),i.promise}function AXe(t){let n=Zr(),i=new FileReader;return i.addEventListener("load",function(){n.resolve(i.result)}),i.addEventListener("error",function(){n.reject(i.error)}),i.readAsText(t),n.promise}function mfe(t){let n={xsi:"http://www.w3.org/2001/XMLSchema-instance"},i,o,r,s;for(let a in n)n.hasOwnProperty(a)&&(r=RegExp(`[< ]${a}:`),s=`xmlns:${a}=`,r.test(t)&&t.indexOf(s)===-1&&(f(i)||(i=t.substr(0,t.indexOf("<kml")+4),o=t.substr(i.length)),i+=` ${s}"${n[a]}"`));return f(i)&&(t=i+o),t}function pfe(t){let n=t.indexOf("xmlns:"),i=t.indexOf(">",n),o,r,s;for(;n!==-1&&n<i;)o=t.slice(n,t.indexOf('"',n)),r=n,n=t.indexOf(o,n+1),n!==-1?(s=t.indexOf('"',t.indexOf('"',n)+1),t=t.slice(0,n-1)+t.slice(s+1,t.length),n=t.indexOf("xmlns:",r-1)):n=t.indexOf("xmlns:",r+1);return t}function CXe(t,n){return Promise.resolve(t.getData(new F2)).then(function(i){i=mfe(i),i=pfe(i),n.kml=jW.parseFromString(i,"application/xml")})}function kW(t,n){let i=A(hfe.detectFromFilename(t.filename),"application/octet-stream");return Promise.resolve(t.getData(new N2(i))).then(function(o){n[t.filename]=o})}function jl(t,n,i,o){let r=o.keys,s=new BD.default("."),a=t.querySelectorAll(n);for(let c=0;c<a.length;c++){let l=a[c],u=l.getAttribute(i);if(f(u)){let h=new BD.default(u).absoluteTo(s).toString(),_=r.indexOf(h);if(_!==-1){let y=r[_];l.setAttribute(i,o[y]),n==="a"&&l.getAttribute("download")===null&&l.setAttribute("download",y)}}}}function ql(t,n,i,o){let r=t.querySelectorAll(n);for(let s=0;s<r.length;s++){let a=r[s],c=a.getAttribute(i),l=YW(c,o);f(l)&&a.setAttribute(i,l.url)}}function _fe(t,n,i){let o=os(t,"id");o=f(o)&&o.length!==0?o:Bn(),f(i)&&(o=i+o);let r=n.getById(o);return f(r)&&(o=Bn(),f(i)&&(o=i+o)),r=n.add(new Qo({id:o})),f(r.kml)||(r.addProperty("kml"),r.kml=new JXe),r}function OD(t,n){return t==="absolute"||t==="relativeToGround"||n==="relativeToSeaFloor"}function P3(t,n){if(!f(t))return m.fromDegrees(0,0,0,n);let i=t.match(/[^\s,\n]+/g);if(!f(i))return m.fromDegrees(0,0,0,n);let o=parseFloat(i[0]),r=parseFloat(i[1]),s=parseFloat(i[2]);return o=isNaN(o)?0:o,r=isNaN(r)?0:r,s=isNaN(s)?0:s,m.fromDegrees(o,r,s,n)}function w3(t,n){if(!f(t))return;let i=t.textContent.match(/[^\s\n]+/g);if(!f(i))return;let o=i.length,r=new Array(o),s=0;for(let a=0;a<o;a++)r[s++]=P3(i[a],n);return r}function vg(t,n){if(!f(t))return;let i=t.getAttribute(n);if(i!==null){let o=parseFloat(i);return isNaN(o)?void 0:o}}function os(t,n){if(!f(t))return;let i=t.getAttribute(n);return i!==null?i:void 0}function gi(t,n,i){if(!f(t))return;let o=t.childNodes,r=o.length;for(let s=0;s<r;s++){let a=o[s];if(a.localName===n&&i.indexOf(a.namespaceURI)!==-1)return a}}function ufe(t,n,i){if(!f(t))return;let o=[],r=t.getElementsByTagNameNS("*",n),s=r.length;for(let a=0;a<s;a++){let c=r[a];c.localName===n&&i.indexOf(c.namespaceURI)!==-1&&o.push(c)}return o}function ud(t,n,i){if(!f(t))return[];let o=[],r=t.childNodes,s=r.length;for(let a=0;a<s;a++){let c=r[a];c.localName===n&&i.indexOf(c.namespaceURI)!==-1&&o.push(c)}return o}function Jn(t,n,i){let o=gi(t,n,i);if(f(o)){let r=parseFloat(o.textContent);return isNaN(r)?void 0:r}}function wn(t,n,i){let o=gi(t,n,i);if(f(o))return o.textContent.trim()}function fd(t,n,i){let o=gi(t,n,i);if(f(o)){let r=o.textContent.trim();return r==="1"||/^true$/i.test(r)}}function YW(t,n,i){if(!f(t))return;let o;if(f(i)){t=t.replace(/\\/g,"/");let r=i[t];if(f(r))o=new Ie({url:r});else{let s=new BD.default(n.getUrlComponent()),a=new BD.default(t);r=i[a.absoluteTo(s)],f(r)&&(o=new Ie({url:r}))}}return f(o)||(o=n.getDerivedResource({url:t})),o}var cl={maximumRed:void 0,red:void 0,maximumGreen:void 0,green:void 0,maximumBlue:void 0,blue:void 0};function GW(t,n){if(!f(t)||/^\s*$/gm.test(t))return;t[0]==="#"&&(t=t.substring(1));let i=parseInt(t.substring(0,2),16)/255,o=parseInt(t.substring(2,4),16)/255,r=parseInt(t.substring(4,6),16)/255,s=parseInt(t.substring(6,8),16)/255;return n?(s>0?(cl.maximumRed=s,cl.red=void 0):(cl.maximumRed=void 0,cl.red=0),r>0?(cl.maximumGreen=r,cl.green=void 0):(cl.maximumGreen=void 0,cl.green=0),o>0?(cl.maximumBlue=o,cl.blue=void 0):(cl.maximumBlue=void 0,cl.blue=0),cl.alpha=i,z.fromRandom(cl)):new z(s,r,o,i)}function Zy(t,n,i){let o=wn(t,n,i);if(!!f(o))return GW(o,wn(t,"colorMode",i)==="random")}function xXe(t){let n=gi(t,"TimeStamp",Pe.kmlgx),i=wn(n,"when",Pe.kmlgx);if(!f(n)||!f(i)||i.length===0)return;let o=te.fromIso8601(i),r=new Lr;return r.addInterval(new xn({start:o,stop:Ue.MAXIMUM_VALUE})),r}function TXe(t){let n=gi(t,"TimeSpan",Pe.kmlgx);if(!f(n))return;let i,o=gi(n,"begin",Pe.kmlgx),r=f(o)?te.fromIso8601(o.textContent):void 0,s=gi(n,"end",Pe.kmlgx),a=f(s)?te.fromIso8601(s.textContent):void 0;if(f(r)&&f(a)){if(te.lessThan(a,r)){let c=r;r=a,a=c}i=new Lr,i.addInterval(new xn({start:r,stop:a}))}else f(r)?(i=new Lr,i.addInterval(new xn({start:r,stop:Ue.MAXIMUM_VALUE}))):f(a)&&(i=new Lr,i.addInterval(new xn({start:Ue.MINIMUM_VALUE,stop:a})));return i}function gfe(){let t=new Qa;return t.width=Dg,t.height=Dg,t.scaleByDistance=new Pt(ofe,rfe,sfe,afe),t.pixelOffsetScaleByDistance=new Pt(ofe,rfe,sfe,afe),t}function XW(){let t=new nh;return t.outline=!0,t.outlineColor=z.WHITE,t}function yfe(){let t=new th;return t.translucencyByDistance=new Pt(3e6,1,5e6,0),t.pixelOffset=new W(17,0),t.horizontalOrigin=ui.LEFT,t.font="16px sans-serif",t.style=Lo.FILL_AND_OUTLINE,t}function KW(t,n,i,o,r){let s=wn(t,"href",Pe.kml);if(!f(s)||s.length===0)return;if(s.indexOf("root://icons/palette-")===0){let c=s.charAt(21),l=A(Jn(t,"x",Pe.gx),0),u=A(Jn(t,"y",Pe.gx),0);l=Math.min(l/32,7),u=7-Math.min(u/32,7);let d=8*u+l;s=`https://maps.google.com/mapfiles/kml/pal${c}/icon${d}.png`}let a=YW(s,i,o);if(r){let c=wn(t,"refreshMode",Pe.kml),l=wn(t,"viewRefreshMode",Pe.kml);c==="onInterval"||c==="onExpire"?Bt(`kml-refreshMode-${c}`,`KML - Unsupported Icon refreshMode: ${c}`):(l==="onStop"||l==="onRegion")&&Bt(`kml-refreshMode-${l}`,`KML - Unsupported Icon viewRefreshMode: ${l}`);let u=A(wn(t,"viewBoundScale",Pe.kml),1),d=l==="onStop"?"BBOX=[bboxWest],[bboxSouth],[bboxEast],[bboxNorth]":"",h=A(wn(t,"viewFormat",Pe.kml),d),_=wn(t,"httpQuery",Pe.kml);f(h)&&a.setQueryParameters(cu(v3(h))),f(_)&&a.setQueryParameters(cu(v3(_)));let y=n._ellipsoid;return ZW(a,n.camera,n.canvas,u,n._lastCameraView.bbox,y),a}return a}function EXe(t,n,i,o,r){let s=Jn(n,"scale",Pe.kml),a=Jn(n,"heading",Pe.kml),c=Zy(n,"color",Pe.kml),l=gi(n,"Icon",Pe.kml),u=KW(l,t,o,r,!1);f(l)&&!f(u)&&(u=!1);let d=Jn(l,"x",Pe.gx),h=Jn(l,"y",Pe.gx),_=Jn(l,"w",Pe.gx),y=Jn(l,"h",Pe.gx),p=gi(n,"hotSpot",Pe.kml),C=vg(p,"x"),x=vg(p,"y"),T=os(p,"xunits"),E=os(p,"yunits"),S=i.billboard;f(S)||(S=gfe(),i.billboard=S),S.image=u,S.scale=s,S.color=c,(f(d)||f(h)||f(_)||f(y))&&(S.imageSubRegion=new He(d,h,_,y)),f(a)&&a!==0&&(S.rotation=B.toRadians(-a),S.alignedAxis=m.UNIT_Z),s=A(s,1);let w,D;f(C)&&(T==="pixels"?w=-C*s:T==="insetPixels"?w=(C-Dg)*s:T==="fraction"&&(w=-C*Dg*s),w+=Dg*.5*s),f(x)&&(E==="pixels"?D=x*s:E==="insetPixels"?D=(-x+Dg)*s:E==="fraction"&&(D=x*Dg*s),D-=Dg*.5*s),(f(w)||f(D))&&(S.pixelOffset=new W(w,D))}function D3(t,n,i,o,r){for(let s=0,a=n.childNodes.length;s<a;s++){let c=n.childNodes.item(s);if(c.localName==="IconStyle")EXe(t,c,i,o,r);else if(c.localName==="LabelStyle"){let l=i.label;f(l)||(l=yfe(),i.label=l),l.scale=A(Jn(c,"scale",Pe.kml),l.scale),l.fillColor=A(Zy(c,"color",Pe.kml),l.fillColor),l.text=i.name}else if(c.localName==="LineStyle"){let l=i.polyline;f(l)||(l=new dc,i.polyline=l),l.width=Jn(c,"width",Pe.kml),l.material=Zy(c,"color",Pe.kml),f(Zy(c,"outerColor",Pe.gx))&&Bt("kml-gx:outerColor","KML - gx:outerColor is not supported in a LineStyle"),f(Jn(c,"outerWidth",Pe.gx))&&Bt("kml-gx:outerWidth","KML - gx:outerWidth is not supported in a LineStyle"),f(Jn(c,"physicalWidth",Pe.gx))&&Bt("kml-gx:physicalWidth","KML - gx:physicalWidth is not supported in a LineStyle"),f(fd(c,"labelVisibility",Pe.gx))&&Bt("kml-gx:labelVisibility","KML - gx:labelVisibility is not supported in a LineStyle")}else if(c.localName==="PolyStyle"){let l=i.polygon;f(l)||(l=XW(),i.polygon=l),l.material=A(Zy(c,"color",Pe.kml),l.material),l.fill=A(fd(c,"fill",Pe.kml),l.fill),l.outline=A(fd(c,"outline",Pe.kml),l.outline)}else if(c.localName==="BalloonStyle"){let l=A(GW(wn(c,"bgColor",Pe.kml)),z.WHITE),u=A(GW(wn(c,"textColor",Pe.kml)),z.BLACK),d=wn(c,"text",Pe.kml);i.addProperty("balloonStyle"),i.balloonStyle={bgColor:l,textColor:u,text:d}}else if(c.localName==="ListStyle"){let l=wn(c,"listItemType",Pe.kml);(l==="radioFolder"||l==="checkOffOnly")&&Bt(`kml-listStyle-${l}`,`KML - Unsupported ListStyle with listItemType: ${l}`)}}}function bXe(t,n,i,o,r){let s=new Qo,a,c=-1,l=n.childNodes,u=l.length;for(let h=0;h<u;h++){let _=l[h];(_.localName==="Style"||_.localName==="StyleMap")&&(c=h)}if(c!==-1){let h=l[c];if(h.localName==="Style")D3(t,h,s,o,r);else{let _=ud(h,"Pair",Pe.kml);for(let y=0;y<_.length;y++){let p=_[y],C=wn(p,"key",Pe.kml);if(C==="normal"){let x=wn(p,"styleUrl",Pe.kml);if(f(x))a=i.getById(x),f(a)||(a=i.getById(`#${x}`)),f(a)&&s.merge(a);else{let T=gi(p,"Style",Pe.kml);D3(t,T,s,o,r)}}else Bt(`kml-styleMap-${C}`,`KML - Unsupported StyleMap key: ${C}`)}}}let d=wn(n,"styleUrl",Pe.kml);if(f(d)){let h=d;if(d[0]!=="#"&&d.indexOf("#")!==-1){let _=d.split("#"),y=_[0];h=`${o.getDerivedResource({url:y}).getUrlComponent()}#${_[1]}`}a=i.getById(h),f(a)||(a=i.getById(`#${h}`)),f(a)&&s.merge(a)}return s}function SXe(t,n,i){return n.fetchXML().then(function(o){return Afe(t,o,i,n,!0)})}function Afe(t,n,i,o,r,s){let a,c,l,u,d=ufe(n,"Style",Pe.kml);if(f(d)){let C=d.length;for(a=0;a<C;a++)u=d[a],c=os(u,"id"),f(c)&&(c=`#${c}`,r&&f(o)&&(c=o.getUrlComponent()+c),f(i.getById(c))||(l=new Qo({id:c}),i.add(l),D3(t,u,l,o,s)))}let h=ufe(n,"StyleMap",Pe.kml);if(f(h)){let C=h.length;for(a=0;a<C;a++){let x=h[a];if(c=os(x,"id"),f(c)){let T=ud(x,"Pair",Pe.kml);for(let E=0;E<T.length;E++){let S=T[E],w=wn(S,"key",Pe.kml);if(w==="normal"){if(c=`#${c}`,r&&f(o)&&(c=o.getUrlComponent()+c),!f(i.getById(c))){l=i.getOrCreateEntity(c);let D=wn(S,"styleUrl",Pe.kml);if(f(D)){D[0]!=="#"&&(D=`#${D}`),r&&f(o)&&(D=o.getUrlComponent()+D);let I=i.getById(D);f(I)&&l.merge(I)}else u=gi(S,"Style",Pe.kml),D3(t,u,l,o,s)}}else Bt(`kml-styleMap-${w}`,`KML - Unsupported StyleMap key: ${w}`)}}}}let _=[],y=n.getElementsByTagName("styleUrl"),p=y.length;for(a=0;a<p;a++){let C=y[a].textContent;if(C[0]!=="#"){let x=C.split("#");if(x.length===2){let T=x[0],E=o.getDerivedResource({url:T});_.push(SXe(t,E,i))}}}return _}function JW(t,n,i){let o=new ng(t,n.id,["position"]),r=new hp(n.position);n.polyline=f(i.polyline)?i.polyline.clone():new dc,n.polyline.positions=new eg([o,r])}function Cfe(t,n){return!f(t)&&!f(n)||t==="clampToGround"?Ge.CLAMP_TO_GROUND:t==="relativeToGround"?Ge.RELATIVE_TO_GROUND:t==="absolute"?Ge.NONE:n==="clampToSeaFloor"?(Bt("kml-gx:altitudeMode-clampToSeaFloor","KML - <gx:altitudeMode>:clampToSeaFloor is currently not supported, using <kml:altitudeMode>:clampToGround."),Ge.CLAMP_TO_GROUND):n==="relativeToSeaFloor"?(Bt("kml-gx:altitudeMode-relativeToSeaFloor","KML - <gx:altitudeMode>:relativeToSeaFloor is currently not supported, using <kml:altitudeMode>:relativeToGround."),Ge.RELATIVE_TO_GROUND):(f(t)?Bt("kml-altitudeMode-unknown",`KML - Unknown <kml:altitudeMode>:${t}, using <kml:altitudeMode>:CLAMP_TO_GROUND.`):Bt("kml-gx:altitudeMode-unknown",`KML - Unknown <gx:altitudeMode>:${n}, using <kml:altitudeMode>:CLAMP_TO_GROUND.`),Ge.CLAMP_TO_GROUND)}function wXe(t,n,i){return i==="relativeToSeaFloor"||n==="absolute"||n==="relativeToGround"?t:((f(n)&&n!=="clampToGround"||f(i)&&i!=="clampToSeaFloor")&&Bt("kml-altitudeMode-unknown",`KML - Unknown altitudeMode: ${A(n,i)}`),new hp(t))}function DXe(t,n,i,o){if(!f(t))return;if(i==="relativeToSeaFloor"||n==="absolute"||n==="relativeToGround")return t;(f(n)&&n!=="clampToGround"||f(i)&&i!=="clampToSeaFloor")&&Bt("kml-altitudeMode-unknown",`KML - Unknown altitudeMode: ${A(n,i)}`);let r=t.length;for(let s=0;s<r;s++){let a=t[s];o.scaleToGeodeticSurface(a,a)}return t}function I3(t,n,i,o){let r=n.label;f(r)||(r=f(i.label)?i.label.clone():yfe(),n.label=r),r.text=n.name;let s=n.billboard;f(s)||(s=f(i.billboard)?i.billboard.clone():gfe(),n.billboard=s),f(s.image)?s.image.getValue()||(s.image=void 0):s.image=t._pinBuilder.fromColor(z.YELLOW,64);let a=1;f(s.scale)&&(a=s.scale.getValue(),a!==0?r.pixelOffset=new W(a*16+1,0):(r.pixelOffset=void 0,r.horizontalOrigin=void 0)),f(o)&&t._clampToGround&&(s.heightReference=o,r.heightReference=o)}function xfe(t,n){let i=t.path;f(i)||(i=new A_,i.leadTime=0,t.path=i);let o=n.polyline;f(o)&&(i.material=o.material,i.width=o.width)}function vXe(t,n,i,o,r){let s=wn(i,"coordinates",Pe.kml),a=wn(i,"altitudeMode",Pe.kml),c=wn(i,"altitudeMode",Pe.gx),l=fd(i,"extrude",Pe.kml),u=t._ellipsoid,d=P3(s,u);return o.position=d,I3(t,o,r,Cfe(a,c)),l&&OD(a,c)&&JW(n,o,r),!0}function ffe(t,n,i,o,r){let s=gi(i,"coordinates",Pe.kml),a=wn(i,"altitudeMode",Pe.kml),c=wn(i,"altitudeMode",Pe.gx),l=fd(i,"extrude",Pe.kml),u=fd(i,"tessellate",Pe.kml),d=OD(a,c),h=Jn(i,"drawOrder",Pe.gx),_=t._ellipsoid,y=w3(s,_),p=r.polyline;if(d&&l){let C=new C_;o.wall=C,C.positions=y;let x=r.polygon;f(x)&&(C.fill=x.fill,C.material=x.material),C.outline=!0,f(p)?(C.outlineColor=f(p.material)?p.material.color:z.WHITE,C.outlineWidth=p.width):f(x)&&(C.outlineColor=f(x.material)?x.material.color:z.WHITE)}else if(t._clampToGround&&!d&&u){let C=new dc;C.clampToGround=!0,o.polyline=C,C.positions=y,f(p)?(C.material=f(p.material)?p.material.color.getValue(Ue.MINIMUM_VALUE):z.WHITE,C.width=A(p.width,1)):(C.material=z.WHITE,C.width=1),C.zIndex=h}else f(h)&&Bt("kml-gx:drawOrder","KML - gx:drawOrder is not supported in LineStrings when clampToGround is false"),t._clampToGround&&!u&&Bt("kml-line-tesselate","Ignoring clampToGround for KML lines without the tessellate flag."),p=f(p)?p.clone():new dc,o.polyline=p,p.positions=DXe(y,a,c,_),(!u||d)&&(p.arcType=Zt.NONE);return!0}function PXe(t,n,i,o,r){let s=gi(i,"outerBoundaryIs",Pe.kml),a=gi(s,"LinearRing",Pe.kml),c=gi(a,"coordinates",Pe.kml),l=t._ellipsoid,u=w3(c,l),d=fd(i,"extrude",Pe.kml),h=wn(i,"altitudeMode",Pe.kml),_=wn(i,"altitudeMode",Pe.gx),y=OD(h,_),p=f(r.polygon)?r.polygon.clone():XW(),C=r.polyline;if(f(C)&&(p.outlineColor=f(C.material)?C.material.color:z.WHITE,p.outlineWidth=C.width),o.polygon=p,y?(p.perPositionHeight=!0,p.extrudedHeight=d?0:void 0):t._clampToGround||(p.height=0),f(u)){let x=new Zc(u),T=ud(i,"innerBoundaryIs",Pe.kml);for(let E=0;E<T.length;E++){a=ud(T[E],"LinearRing",Pe.kml);for(let S=0;S<a.length;S++)c=gi(a[S],"coordinates",Pe.kml),u=w3(c,l),f(u)&&x.holes.push(new Zc(u))}p.hierarchy=x}return!0}function IXe(t,n,i,o,r){let s=wn(i,"altitudeMode",Pe.kml),a=wn(i,"altitudeMode",Pe.gx),c=ud(i,"coord",Pe.gx),l=ud(i,"angles",Pe.gx),u=ud(i,"when",Pe.kml),d=fd(i,"extrude",Pe.kml),h=OD(s,a),_=t._ellipsoid;l.length>0&&Bt("kml-gx:angles","KML - gx:angles are not supported in gx:Tracks");let y=Math.min(c.length,u.length),p=[],C=[];for(let T=0;T<y;T++){let E=P3(c[T].textContent,_);p.push(E),C.push(te.fromIso8601(u[T].textContent))}let x=new oa;return x.addSamples(C,p),o.position=x,I3(t,o,r,Cfe(s,a)),xfe(o,r),o.availability=new Lr,u.length>0&&o.availability.addInterval(new xn({start:C[0],stop:C[C.length-1]})),h&&d&&JW(n,o,r),!0}function dfe(t,n,i,o,r,s,a,c,l){let u=t[0],d=t[t.length-1],h=new oa;h.addSamples(t,n),i.intervals.addInterval(new xn({start:u,stop:d,isStartIncluded:l,isStopIncluded:l,data:wXe(h,a,c)})),o.addInterval(new xn({start:u,stop:d,isStartIncluded:l,isStopIncluded:l})),r.intervals.addInterval(new xn({start:u,stop:d,isStartIncluded:l,isStopIncluded:l,data:s}))}function BXe(t,n,i,o,r){let s=fd(i,"interpolate",Pe.gx),a=ud(i,"Track",Pe.gx),c,l,u,d=!1,h=new rg,_=new Lr,y=new ia,p=t._ellipsoid;for(let C=0,x=a.length;C<x;C++){let T=a[C],E=ud(T,"when",Pe.kml),S=ud(T,"coord",Pe.gx),w=wn(T,"altitudeMode",Pe.kml),D=wn(T,"altitudeMode",Pe.gx),I=OD(w,D),O=fd(T,"extrude",Pe.kml),M=Math.min(S.length,E.length),L=[];c=[];for(let F=0;F<M;F++){let g=P3(S[F].textContent,p);L.push(g),c.push(te.fromIso8601(E[F].textContent))}s&&(f(l)&&dfe([l,c[0]],[u,L[0]],y,_,h,!1,"absolute",void 0,!1),l=c[M-1],u=L[L.length-1]),dfe(c,L,y,_,h,I&&O,w,D,!0),d=d||I&&O}return o.availability=_,o.position=y,I3(t,o,r),xfe(o,r),d&&(JW(n,o,r),o.polyline.show=h),!0}var Tfe={Point:vXe,LineString:ffe,LinearRing:ffe,Polygon:PXe,Track:IXe,MultiTrack:BXe,MultiGeometry:OXe,Model:RXe};function OXe(t,n,i,o,r,s){let a=i.childNodes,c=!1;for(let l=0,u=a.length;l<u;l++){let d=a.item(l),h=Tfe[d.localName];if(f(h)){let _=_fe(d,n,s);_.parent=o,_.name=o.name,_.availability=o.availability,_.description=o.description,_.kml=o.kml,h(t,n,d,_,r)&&(c=!0)}}return c}function RXe(t,n,i,o,r){return Bt("kml-unsupportedGeometry",`KML - Unsupported geometry: ${i.localName}`),!1}function MXe(t,n){let i=gi(t,"ExtendedData",Pe.kml);if(!f(i))return;f(gi(i,"SchemaData",Pe.kml))&&Bt("kml-schemaData","KML - SchemaData is unsupported"),f(os(i,"xmlns:prefix"))&&Bt("kml-extendedData","KML - ExtendedData with xmlns:prefix is unsupported");let o={},r=ud(i,"Data",Pe.kml);if(f(r)){let s=r.length;for(let a=0;a<s;a++){let c=r[a],l=os(c,"name");f(l)&&(o[l]={displayName:wn(c,"displayName",Pe.kml),value:wn(c,"value",Pe.kml)})}}n.kml.extendedData=o}var co;typeof document!="undefined"&&(co=document.createElement("div"));function LXe(t,n,i,o,r){let s,a,c,l=n.kml,u=l.extendedData,d=wn(t,"description",Pe.kml),h=A(n.balloonStyle,i.balloonStyle),_=z.WHITE,y=z.BLACK,p=d;f(h)&&(_=A(h.bgColor,z.WHITE),y=A(h.textColor,z.BLACK),p=A(h.text,d));let C;if(f(p)){if(p=p.replace("$[name]",A(n.name,"")),p=p.replace("$[description]",A(d,"")),p=p.replace("$[address]",A(l.address,"")),p=p.replace("$[Snippet]",A(l.snippet,"")),p=p.replace("$[id]",n.id),p=p.replace("$[geDirections]",""),f(u)){let E=p.match(/\$\[.+?\]/g);if(E!==null)for(s=0;s<E.length;s++){let S=E[s],w=S.substr(2,S.length-3),D=/\/displayName$/.test(w);w=w.replace(/\/displayName$/,""),C=u[w],f(C)&&(C=D?C.displayName:C.value),f(C)&&(p=p.replace(S,A(C,"")))}}}else if(f(u)&&(c=Object.keys(u),c.length>0)){for(p='<table class="cesium-infoBox-defaultTable cesium-infoBox-defaultTable-lighter"><tbody>',s=0;s<c.length;s++)a=c[s],C=u[a],p+=`<tr><th>${A(C.displayName,a)}</th><td>${A(C.value,"")}</td></tr>`;p+="</tbody></table>"}if(!f(p))return;p=_Xe.link(p),co.innerHTML=p;let x=co.querySelectorAll("a");for(s=0;s<x.length;s++)x[s].setAttribute("target","_blank");f(o)&&o.keys.length>1&&(jl(co,"a","href",o),jl(co,"link","href",o),jl(co,"area","href",o),jl(co,"img","src",o),jl(co,"iframe","src",o),jl(co,"video","src",o),jl(co,"audio","src",o),jl(co,"source","src",o),jl(co,"track","src",o),jl(co,"input","src",o),jl(co,"embed","src",o),jl(co,"script","src",o),jl(co,"video","poster",o)),ql(co,"a","href",r),ql(co,"link","href",r),ql(co,"area","href",r),ql(co,"img","src",r),ql(co,"iframe","src",r),ql(co,"video","src",r),ql(co,"audio","src",r),ql(co,"source","src",r),ql(co,"track","src",r),ql(co,"input","src",r),ql(co,"embed","src",r),ql(co,"script","src",r),ql(co,"video","poster",r);let T='<div class="cesium-infoBox-description-lighter" style="';T+="overflow:auto;",T+="word-wrap:break-word;",T+=`background-color:${_.toCssColorString()};`,T+=`color:${y.toCssColorString()};`,T+='">',T+=`${co.innerHTML}</div>`,co.innerHTML="",n.description=T}function B3(t,n,i){let o=i.entityCollection,r=i.parentEntity,s=i.sourceResource,a=i.uriResolver,c=_fe(n,o,i.context),l=c.kml,u=bXe(t,n,i.styleCollection,s,a),d=wn(n,"name",Pe.kml);c.name=d,c.parent=r;let h=TXe(n);f(h)||(h=xXe(n)),c.availability=h,$W(c);function _(S){return S?S.show&&_(S.parent):!0}let y=fd(n,"visibility",Pe.kml);c.show=_(r)&&A(y,!0);let p=gi(n,"author",Pe.atom),C=l.author;C.name=wn(p,"name",Pe.atom),C.uri=wn(p,"uri",Pe.atom),C.email=wn(p,"email",Pe.atom);let x=gi(n,"link",Pe.atom),T=l.link;T.href=os(x,"href"),T.hreflang=os(x,"hreflang"),T.rel=os(x,"rel"),T.type=os(x,"type"),T.title=os(x,"title"),T.length=os(x,"length"),l.address=wn(n,"address",Pe.kml),l.phoneNumber=wn(n,"phoneNumber",Pe.kml),l.snippet=wn(n,"Snippet",Pe.kml),MXe(n,c),LXe(n,c,u,a,s);let E=t._ellipsoid;return Sfe(n,c,E),bfe(n,c,E),f(gi(n,"Region",Pe.kml))&&Bt("kml-region","KML - Placemark Regions are unsupported"),{entity:c,styleEntity:u}}function Efe(t,n,i,o){o.addNodes(n.childNodes,i),o.process()}function FXe(t,n,i,o){let r=B3(t,n,i),s=tt(i);s.parentEntity=r.entity,Efe(t,n,s,o)}function NXe(t,n,i,o){let r=B3(t,n,i),s=r.entity,a=r.styleEntity,c=!1,l=n.childNodes;for(let u=0,d=l.length;u<d&&!c;u++){let h=l.item(u),_=Tfe[h.localName];f(_)&&(_(t,i.entityCollection,h,s,a,s.id),c=!0)}c||(s.merge(a),I3(t,s,a))}var VXe={FlyTo:zXe,Wait:UXe,SoundCue:UW,AnimatedUpdate:UW,TourControl:UW};function kXe(t,n,i,o){let r=wn(n,"name",Pe.kml),s=os(n,"id"),a=new T3(r,s),c=gi(n,"Playlist",Pe.gx);if(c){let l=t._ellipsoid,u=c.childNodes;for(let d=0;d<u.length;d++){let h=u[d];if(h.localName){let _=VXe[h.localName];_?_(a,h,l):console.log(`Unknown KML Tour playlist entry type ${h.localName}`)}}}t._kmlTours.push(a)}function UW(t,n){Bt(`KML Tour unsupported node ${n.localName}`)}function UXe(t,n){let i=Jn(n,"duration",Pe.gx);t.addPlaylistEntry(new S3(i))}function zXe(t,n,i){let o=Jn(n,"duration",Pe.gx),r=wn(n,"flyToMode",Pe.gx),s={kml:{}};Sfe(n,s,i),bfe(n,s,i);let a=s.kml.lookAt||s.kml.camera,c=new b3(o,r,a);t.addPlaylistEntry(c)}function bfe(t,n,i){let o=gi(t,"Camera",Pe.kml);if(f(o)){let r=A(Jn(o,"longitude",Pe.kml),0),s=A(Jn(o,"latitude",Pe.kml),0),a=A(Jn(o,"altitude",Pe.kml),0),c=A(Jn(o,"heading",Pe.kml),0),l=A(Jn(o,"tilt",Pe.kml),0),u=A(Jn(o,"roll",Pe.kml),0),d=m.fromDegrees(r,s,a,i),h=yl.fromDegrees(c,l-90,u);n.kml.camera=new A3(d,h)}}function Sfe(t,n,i){let o=gi(t,"LookAt",Pe.kml);if(f(o)){let r=A(Jn(o,"longitude",Pe.kml),0),s=A(Jn(o,"latitude",Pe.kml),0),a=A(Jn(o,"altitude",Pe.kml),0),c=Jn(o,"heading",Pe.kml),l=Jn(o,"tilt",Pe.kml),u=A(Jn(o,"range",Pe.kml),0);l=B.toRadians(A(l,0)),c=B.toRadians(A(c,0));let d=new Ku(c,l-B.PI_OVER_TWO,u),h=m.fromDegrees(r,s,a,i);n.kml.lookAt=new C3(h,d)}}function HXe(t,n,i,o){let r=i.screenOverlayContainer;if(!f(r))return;let s=i.sourceResource,a=i.uriResolver,c=gi(n,"Icon",Pe.kml),l=KW(c,t,s,a,!1);if(!f(l))return;let u=document.createElement("img");t._screenOverlays.push(u),u.src=l.url,u.onload=function(){let d=["position: absolute"],h=gi(n,"screenXY",Pe.kml),_=gi(n,"overlayXY",Pe.kml),y=gi(n,"size",Pe.kml),p,C,x,T,E,S;f(y)&&(p=vg(y,"x"),C=vg(y,"y"),x=os(y,"xunits"),T=os(y,"yunits"),f(p)&&p!==-1&&p!==0&&(x==="fraction"?E=`width: ${Math.floor(p*100)}%`:x==="pixels"&&(E=`width: ${p}px`),d.push(E)),f(C)&&C!==-1&&C!==0&&(T==="fraction"?S=`height: ${Math.floor(C*100)}%`:T==="pixels"&&(S=`height: ${C}px`),d.push(S))),u.style=d.join(";");let w=0,D=u.height;f(_)&&(p=vg(_,"x"),C=vg(_,"y"),x=os(_,"xunits"),T=os(_,"yunits"),f(p)&&(x==="fraction"?w=p*u.width:(x==="pixels"||x==="insetPixels")&&(w=p)),f(C)&&(T==="fraction"?D=C*u.height:(T==="pixels"||T==="insetPixels")&&(D=C))),f(h)&&(p=vg(h,"x"),C=vg(h,"y"),x=os(h,"xunits"),T=os(h,"yunits"),f(p)&&(x==="fraction"?E=`left: calc(${Math.floor(p*100)}% - ${w}px)`:x==="pixels"?E=`left: ${p-w}px`:x==="insetPixels"&&(E=`right: ${p-w}px`),d.push(E)),f(C)&&(T==="fraction"?S=`bottom: calc(${Math.floor(C*100)}% - ${D}px)`:T==="pixels"?S=`bottom: ${C-D}px`:T==="insetPixels"&&(S=`top: ${C-D}px`),d.push(S))),u.style=d.join(";")},r.appendChild(u)}function GXe(t,n,i,o){let s=B3(t,n,i).entity,a,c=!1,l=t._ellipsoid,u=w3(gi(n,"LatLonQuad",Pe.gx),l),d=Jn(n,"drawOrder",Pe.kml);if(f(u))a=XW(),a.hierarchy=new Zc(u),a.zIndex=d,s.polygon=a,c=!0;else{a=new ih,a.zIndex=d,s.rectangle=a;let p=gi(n,"LatLonBox",Pe.kml);if(f(p)){let C=Jn(p,"west",Pe.kml),x=Jn(p,"south",Pe.kml),T=Jn(p,"east",Pe.kml),E=Jn(p,"north",Pe.kml);f(C)&&(C=B.negativePiToPi(B.toRadians(C))),f(x)&&(x=B.clampToLatitudeRange(B.toRadians(x))),f(T)&&(T=B.negativePiToPi(B.toRadians(T))),f(E)&&(E=B.clampToLatitudeRange(B.toRadians(E))),a.coordinates=new le(C,x,T,E);let S=Jn(p,"rotation",Pe.kml);if(f(S)){let w=B.toRadians(S);a.rotation=w,a.stRotation=w}}}let h=gi(n,"Icon",Pe.kml),_=KW(h,t,i.sourceResource,i.uriResolver,!0);if(f(_)){c&&Bt("kml-gx:LatLonQuad","KML - gx:LatLonQuad Icon does not support texture projection.");let p=Jn(h,"x",Pe.gx),C=Jn(h,"y",Pe.gx),x=Jn(h,"w",Pe.gx),T=Jn(h,"h",Pe.gx);(f(p)||f(C)||f(x)||f(T))&&Bt("kml-groundOverlay-xywh","KML - gx:x, gx:y, gx:w, gx:h aren't supported for GroundOverlays"),a.material=_,a.material.color=Zy(n,"color",Pe.kml),a.material.transparent=!0}else a.material=Zy(n,"color",Pe.kml);let y=wn(n,"altitudeMode",Pe.kml);f(y)?y==="absolute"?(a.height=Jn(n,"altitude",Pe.kml),a.zIndex=void 0):y!=="clampToGround"&&Bt("kml-altitudeMode-unknown",`KML - Unknown altitudeMode: ${y}`):(y=wn(n,"altitudeMode",Pe.gx),y==="relativeToSeaFloor"?(Bt("kml-altitudeMode-relativeToSeaFloor","KML - altitudeMode relativeToSeaFloor is currently not supported, treating as absolute."),a.height=Jn(n,"altitude",Pe.kml),a.zIndex=void 0):y==="clampToSeaFloor"?Bt("kml-altitudeMode-clampToSeaFloor","KML - altitudeMode clampToSeaFloor is currently not supported, treating as clampToGround."):f(y)&&Bt("kml-altitudeMode-unknown",`KML - Unknown altitudeMode: ${y}`))}function wfe(t,n,i,o){t._unsupportedNode.raiseEvent(t,i.parentEntity,n,i.entityCollection,i.styleCollection,i.sourceResource,i.uriResolver),Bt(`kml-unsupportedFeature-${n.nodeName}`,`KML - Unsupported feature: ${n.nodeName}`)}var Pg={INTERVAL:0,EXPIRE:1,STOP:2};function v3(t){if(!f(t)||t.length===0)return"";let n=t[0];return(n==="&"||n==="?")&&(t=t.substring(1)),t}var WXe=new le,lE=new de,zW=new W,jXe=new m;function ZW(t,n,i,o,r,s){function a(u){return u<-B.PI_OVER_TWO?-B.PI_OVER_TWO:u>B.PI_OVER_TWO?B.PI_OVER_TWO:u}function c(u){return u>B.PI?u-B.TWO_PI:u<-B.PI?u+B.TWO_PI:u}let l=aC(t.queryParameters);if(l=l.replace(/%5B/g,"[").replace(/%5D/g,"]"),f(n)&&n._mode!==ne.MORPHING){let u,d;if(r=A(r,WXe),f(i)&&(zW.x=i.clientWidth*.5,zW.y=i.clientHeight*.5,u=n.pickEllipsoid(zW,s,jXe)),f(u)?d=s.cartesianToCartographic(u,lE):(d=le.center(r,lE),u=s.cartographicToCartesian(d)),f(o)&&!B.equalsEpsilon(o,1,B.EPSILON9)){let T=r.width*o*.5,E=r.height*o*.5;r=new le(c(d.longitude-T),a(d.latitude-E),c(d.longitude+T),a(d.latitude+E))}l=l.replace("[bboxWest]",B.toDegrees(r.west).toString()),l=l.replace("[bboxSouth]",B.toDegrees(r.south).toString()),l=l.replace("[bboxEast]",B.toDegrees(r.east).toString()),l=l.replace("[bboxNorth]",B.toDegrees(r.north).toString());let h=B.toDegrees(d.longitude).toString(),_=B.toDegrees(d.latitude).toString();l=l.replace("[lookatLon]",h),l=l.replace("[lookatLat]",_),l=l.replace("[lookatTilt]",B.toDegrees(n.pitch).toString()),l=l.replace("[lookatHeading]",B.toDegrees(n.heading).toString()),l=l.replace("[lookatRange]",m.distance(n.positionWC,u)),l=l.replace("[lookatTerrainLon]",h),l=l.replace("[lookatTerrainLat]",_),l=l.replace("[lookatTerrainAlt]",d.height.toString()),s.cartesianToCartographic(n.positionWC,lE),l=l.replace("[cameraLon]",B.toDegrees(lE.longitude).toString()),l=l.replace("[cameraLat]",B.toDegrees(lE.latitude).toString()),l=l.replace("[cameraAlt]",B.toDegrees(lE.height).toString());let y=n.frustum,p=y.aspectRatio,C="",x="";if(f(p)){let T=B.toDegrees(y.fov);p>1?(C=T,x=T/p):(x=T,C=T*p)}l=l.replace("[horizFov]",C.toString()),l=l.replace("[vertFov]",x.toString())}else l=l.replace("[bboxWest]","-180"),l=l.replace("[bboxSouth]","-90"),l=l.replace("[bboxEast]","180"),l=l.replace("[bboxNorth]","90"),l=l.replace("[lookatLon]",""),l=l.replace("[lookatLat]",""),l=l.replace("[lookatRange]",""),l=l.replace("[lookatTilt]",""),l=l.replace("[lookatHeading]",""),l=l.replace("[lookatTerrainLon]",""),l=l.replace("[lookatTerrainLat]",""),l=l.replace("[lookatTerrainAlt]",""),l=l.replace("[cameraLon]",""),l=l.replace("[cameraLat]",""),l=l.replace("[cameraAlt]",""),l=l.replace("[horizFov]",""),l=l.replace("[vertFov]","");f(i)?(l=l.replace("[horizPixels]",i.clientWidth),l=l.replace("[vertPixels]",i.clientHeight)):(l=l.replace("[horizPixels]",""),l=l.replace("[vertPixels]","")),l=l.replace("[terrainEnabled]","1"),l=l.replace("[clientVersion]","1"),l=l.replace("[kmlVersion]","2.2"),l=l.replace("[clientName]","Cesium"),l=l.replace("[language]","English"),t.setQueryParameters(cu(l))}function qXe(t,n,i,o){let s=B3(t,n,i).entity,a=i.sourceResource,c=i.uriResolver,l=gi(n,"Link",Pe.kml);if(f(l)||(l=gi(n,"Url",Pe.kml)),f(l)){let u=wn(l,"href",Pe.kml),d,h;if(f(u)){let _=u;if(u=YW(u,a,i.uriResolver),/^data:/.test(u.getUrlComponent()))/\.kmz/i.test(a.getUrlComponent())||(_=a.getDerivedResource({url:_}));else{if(_=u.clone(),d=wn(l,"viewRefreshMode",Pe.kml),d==="onRegion"){Bt("kml-refrehMode-onRegion","KML - Unsupported viewRefreshMode: onRegion");return}h=A(wn(l,"viewBoundScale",Pe.kml),1);let x=d==="onStop"?"BBOX=[bboxWest],[bboxSouth],[bboxEast],[bboxNorth]":"",T=A(wn(l,"viewFormat",Pe.kml),x),E=wn(l,"httpQuery",Pe.kml);f(T)&&u.setQueryParameters(cu(v3(T))),f(E)&&u.setQueryParameters(cu(v3(E)));let S=t._ellipsoid;ZW(u,t.camera,t.canvas,h,t._lastCameraView.bbox,S)}let y={sourceUri:_,uriResolver:c,context:s.id,screenOverlayContainer:i.screenOverlayContainer},p=new Ms,C=QW(t,p,u,y).then(function(x){let T=t._entityCollection,E=p.values;T.suspendEvents();for(let D=0;D<E.length;D++){let I=E[D];f(I.parent)||(I.parent=s,$W(I)),T.add(I)}T.resumeEvents();let S=wn(l,"refreshMode",Pe.kml),w=A(Jn(l,"refreshInterval",Pe.kml),0);if(S==="onInterval"&&w>0||S==="onExpire"||d==="onStop"){let D=gi(x,"NetworkLinkControl",Pe.kml),I=f(D),O=te.now(),M={id:Bn(),href:u,cookie:{},lastUpdated:O,updating:!1,entity:s,viewBoundScale:h,needsUpdate:!1,cameraUpdateTime:O},L=0;if(I&&(M.cookie=cu(A(wn(D,"cookie",Pe.kml),"")),L=A(Jn(D,"minRefreshPeriod",Pe.kml),0)),S==="onInterval")I&&(w=Math.max(L,w)),M.refreshMode=Pg.INTERVAL,M.time=w;else if(S==="onExpire"){let F;if(I&&(F=wn(D,"expires",Pe.kml)),f(F))try{let g=te.fromIso8601(F),b=te.secondsDifference(g,O);b>0&&b<L&&te.addSeconds(O,L,g),M.refreshMode=Pg.EXPIRE,M.time=g}catch(g){Bt("kml-refreshMode-onInterval-onExpire","KML - NetworkLinkControl expires is not a valid date")}else Bt("kml-refreshMode-onExpire","KML - refreshMode of onExpire requires the NetworkLinkControl to have an expires element")}else f(t.camera)?(M.refreshMode=Pg.STOP,M.time=A(Jn(l,"viewRefreshTime",Pe.kml),0)):Bt("kml-refrehMode-onStop-noCamera","A NetworkLink with viewRefreshMode=onStop requires the `camera` property to be defined.");f(M.refreshMode)&&t._networkLinks.set(M.id,M)}}).catch(function(x){Bt(`An error occured during loading ${u.url}`),t._error.raiseEvent(t,x)});o.addPromise(C)}}}function YXe(t,n,i,o){let r=qW[n.localName];return f(r)?r(t,n,i,o):wfe(t,n,i,o)}function WW(t,n,i,o,r,s,a){n.removeAll();let c=i.documentElement,l=c.localName==="Document"?c:gi(c,"Document",Pe.kml),u=wn(l,"name",Pe.kml);f(u)||(u=$_(o.getUrlComponent())),f(t._name)||(t._name=u);let d=new Yl._DeferredLoading(t),h=new Ms(t);return Promise.all(Afe(t,i,h,o,!1,r)).then(function(){let _=i.documentElement;if(_.localName==="kml"){let p=_.childNodes;for(let C=0;C<p.length;C++){let x=p[C];if(f(qW[x.localName])){_=x;break}}}let y={parentEntity:void 0,entityCollection:n,styleCollection:h,sourceResource:o,uriResolver:r,context:a,screenOverlayContainer:s};return n.suspendEvents(),YXe(t,_,y,d),n.resumeEvents(),d.wait().then(function(){return i.documentElement})})}function XXe(t,n,i,o,r){let s=Qt("ThirdParty/Workers/z-worker-pako.js");JT({workerScripts:{deflate:[s,"./pako_deflate.min.js"],inflate:[s,"./pako_inflate.min.js"]}});let a=new Y2(new Yy(i));return Promise.resolve(a.getEntries()).then(function(c){let l=[],u={},d;for(let h=0;h<c.length;h++){let _=c[h];_.directory||(/\.kml$/i.test(_.filename)&&(!f(d)||!/\//i.test(_.filename))?(f(d)&&l.push(kW(d,u)),d=_):l.push(kW(_,u)))}return f(d)&&l.push(CXe(d,u)),Promise.all(l).then(function(){if(a.close(),!f(u.kml))throw new he("KMZ file does not contain a KML document.");return u.keys=Object.keys(u),WW(t,n,u.kml,o,u,r)})})}function QW(t,n,i,o){o=A(o,A.EMPTY_OBJECT);let r=o.sourceUri,s=o.uriResolver,a=o.context,c=o.screenOverlayContainer,l=i;if(typeof i=="string"||i instanceof Ie){i=Ie.createIfNeeded(i),l=i.fetchBlob(),r=A(r,i.clone());let u=t._resourceCredits,d=i.credits;if(f(d)){let h=d.length;for(let _=0;_<h;_++)u.push(d[_])}}else r=A(r,Ie.DEFAULT.clone());return r=Ie.createIfNeeded(r),f(c)&&(c=On(c)),Promise.resolve(l).then(function(u){return u instanceof Blob?yXe(u).then(function(d){return d?XXe(t,n,u,r,c):AXe(u).then(function(h){h=mfe(h),h=pfe(h);let _,y;try{_=jW.parseFromString(h,"application/xml")}catch(p){y=p.toString()}if(f(y)||_.body||_.documentElement.tagName==="parsererror"){let p=f(y)?y:_.documentElement.firstChild.nodeValue;throw p||(p=_.body.innerText),new he(p)}return WW(t,n,_,r,s,c,a)})}):WW(t,n,u,r,s,c,a)}).catch(function(u){return t._error.raiseEvent(t,u),console.log(u),Promise.reject(u)})}function Yl(t){t=A(t,A.EMPTY_OBJECT);let n=t.camera,i=t.canvas;this._changed=new Ae,this._error=new Ae,this._loading=new Ae,this._refresh=new Ae,this._unsupportedNode=new Ae,this._clock=void 0,this._entityCollection=new Ms(this),this._name=void 0,this._isLoading=!1,this._pinBuilder=new Tg,this._networkLinks=new yt,this._entityCluster=new Uu,this.canvas=i,this.camera=n,this._lastCameraView={position:f(n)?m.clone(n.positionWC):void 0,direction:f(n)?m.clone(n.directionWC):void 0,up:f(n)?m.clone(n.upWC):void 0,bbox:f(n)?n.computeViewRectangle():le.clone(le.MAX_VALUE)},this._ellipsoid=A(t.ellipsoid,oe.WGS84);let o=t.credit;typeof o=="string"&&(o=new Jt(o)),this._credit=o,this._resourceCredits=[],this._kmlTours=[],this._screenOverlays=[]}Yl.load=function(t,n){return n=A(n,A.EMPTY_OBJECT),new Yl(n).load(t,n)};Object.defineProperties(Yl.prototype,{name:{get:function(){return this._name},set:function(t){this._name!==t&&(this._name=t,this._changed.raiseEvent(this))}},clock:{get:function(){return this._clock}},entities:{get:function(){return this._entityCollection}},isLoading:{get:function(){return this._isLoading}},changedEvent:{get:function(){return this._changed}},errorEvent:{get:function(){return this._error}},loadingEvent:{get:function(){return this._loading}},refreshEvent:{get:function(){return this._refresh}},unsupportedNodeEvent:{get:function(){return this._unsupportedNode}},show:{get:function(){return this._entityCollection.show},set:function(t){this._entityCollection.show=t}},clustering:{get:function(){return this._entityCluster},set:function(t){this._entityCluster=t}},credit:{get:function(){return this._credit}},kmlTours:{get:function(){return this._kmlTours}}});Yl.prototype.load=function(t,n){n=A(n,A.EMPTY_OBJECT),Fr.setLoading(this,!0);let i=this._name;this._name=void 0,this._clampToGround=A(n.clampToGround,!1);let o=this;return QW(this,this._entityCollection,t,n).then(function(){let r,s=o._entityCollection.computeAvailability(),a=s.start,c=s.stop,l=te.equals(a,Ue.MINIMUM_VALUE),u=te.equals(c,Ue.MAXIMUM_VALUE);if(!l||!u){let h;l&&(h=new Date,h.setHours(0,0,0,0),a=te.fromDate(h)),u&&(h=new Date,h.setHours(24,0,0,0),c=te.fromDate(h)),r=new gh,r.startTime=a,r.stopTime=c,r.currentTime=te.clone(a),r.clockRange=Nr.LOOP_STOP,r.clockStep=po.SYSTEM_CLOCK_MULTIPLIER,r.multiplier=Math.round(Math.min(Math.max(te.secondsDifference(c,a)/60,1),31556900))}let d=!1;return r!==o._clock&&(o._clock=r,d=!0),i!==o._name&&(d=!0),d&&o._changed.raiseEvent(o),Fr.setLoading(o,!1),o}).catch(function(r){return Fr.setLoading(o,!1),o._error.raiseEvent(o,r),console.log(r),Promise.reject(r)})};Yl.prototype.destroy=function(){for(;this._screenOverlays.length>0;)this._screenOverlays.pop().remove()};function $W(t){let n=t.parent;if(f(n)){let i=n.availability;if(f(i)){let o=t.availability;f(o)?o.intersect(i):t.availability=i}}}function KXe(t,n,i,o,r){return function(s){if(!o.contains(n.id))return;let a=!1,c=gi(s,"NetworkLinkControl",Pe.kml),l=f(c),u=0;if(l){if(f(gi(c,"Update",Pe.kml))){Bt("kml-networkLinkControl-update","KML - NetworkLinkControl updates aren't supported."),n.updating=!1,o.remove(n.id);return}n.cookie=cu(A(wn(c,"cookie",Pe.kml),"")),u=A(Jn(c,"minRefreshPeriod",Pe.kml),0)}let d=te.now(),h=n.refreshMode;if(h===Pg.INTERVAL)f(c)&&(n.time=Math.max(u,n.time));else if(h===Pg.EXPIRE){let O;if(f(c)&&(O=wn(c,"expires",Pe.kml)),f(O))try{let M=te.fromIso8601(O),L=te.secondsDifference(M,d);L>0&&L<u&&te.addSeconds(d,u,M),n.time=M}catch(M){Bt("kml-networkLinkControl-expires","KML - NetworkLinkControl expires is not a valid date"),a=!0}else Bt("kml-refreshMode-onExpire","KML - refreshMode of onExpire requires the NetworkLinkControl to have an expires element"),a=!0}let _=n.entity,y=t._entityCollection,p=i.values;function C(O){y.remove(O);let M=O._children,L=M.length;for(let F=0;F<L;++F)C(M[F])}y.suspendEvents();let x=y.values.slice(),T;for(T=0;T<x.length;++T){let O=x[T];O.parent===_&&(O.parent=void 0,C(O))}for(y.resumeEvents(),y.suspendEvents(),T=0;T<p.length;T++){let O=p[T];f(O.parent)||(O.parent=_,$W(O)),y.add(O)}y.resumeEvents(),a?o.remove(n.id):n.lastUpdated=d;let E=y.computeAvailability(),S=E.start,w=E.stop,D=te.equals(S,Ue.MINIMUM_VALUE),I=te.equals(w,Ue.MAXIMUM_VALUE);if(!D||!I){let O=t._clock;(O.startTime!==S||O.stopTime!==w)&&(O.startTime=S,O.stopTime=w,t._changed.raiseEvent(t))}n.updating=!1,n.needsUpdate=!1,t._refresh.raiseEvent(t,r.getUrlComponent(!0))}}var HW=new yt;Yl.prototype.update=function(t){let n=this._networkLinks;if(n.length===0)return!0;let i=te.now(),o=this;HW.removeAll();function r(d){let h=d._children,_=h.length;for(let y=0;y<_;++y){let p=h[y];HW.set(p.id,p),r(p)}}let s=!1,a=this._lastCameraView,c=this.camera;f(c)&&!(c.positionWC.equalsEpsilon(a.position,B.EPSILON7)&&c.directionWC.equalsEpsilon(a.direction,B.EPSILON7)&&c.upWC.equalsEpsilon(a.up,B.EPSILON7))&&(a.position=m.clone(c.positionWC),a.direction=m.clone(c.directionWC),a.up=m.clone(c.upWC),a.bbox=c.computeViewRectangle(),s=!0);let l=new yt,u=!1;return n.values.forEach(function(d){let h=d.entity;if(!HW.contains(h.id)){if(!d.updating){let _=!1;if(d.refreshMode===Pg.INTERVAL?te.secondsDifference(i,d.lastUpdated)>d.time&&(_=!0):d.refreshMode===Pg.EXPIRE?te.greaterThan(i,d.time)&&(_=!0):d.refreshMode===Pg.STOP&&(s&&(d.needsUpdate=!0,d.cameraUpdateTime=i),d.needsUpdate&&te.secondsDifference(i,d.cameraUpdateTime)>=d.time&&(_=!0)),_){r(h),d.updating=!0;let y=new Ms,p=d.href.clone();p.setQueryParameters(d.cookie);let C=A(o._ellipsoid,oe.WGS84);ZW(p,o.camera,o.canvas,d.viewBoundScale,a.bbox,C),QW(o,y,p,{context:h.id}).then(KXe(o,d,y,l,p)).catch(function(x){let T=`NetworkLink ${d.href} refresh failed: ${x}`;console.log(T),o._error.raiseEvent(o,T)}),u=!0}}l.set(d.id,d)}}),u&&(this._networkLinks=l,this._changed.raiseEvent(this)),!0};function JXe(){this.author={name:void 0,uri:void 0,email:void 0},this.link={href:void 0,hreflang:void 0,rel:void 0,type:void 0,title:void 0,length:void 0},this.address=void 0,this.phoneNumber=void 0,this.snippet=void 0,this.extendedData=void 0}Yl._DeferredLoading=Bh;Yl._getTimestamp=Fi;var O3=Yl;function RD(){Ce.throwInstantiationError()}RD.prototype.update=Ce.throwInstantiationError;RD.prototype.getBoundingSphere=Ce.throwInstantiationError;RD.prototype.isDestroyed=Ce.throwInstantiationError;RD.prototype.destroy=Ce.throwInstantiationError;var Dfe=RD;var ZXe={NONE:0,LERC:1},dd=Object.freeze(ZXe);var QXe={NONE:0,BITS12:1},Hs=Object.freeze(QXe);var Qy=new m,$Xe=new m,ef=new W,R3=new N,eKe=new N,tKe=Math.pow(2,12);function Va(t,n,i,o,r,s,a,c,l,u){let d=Hs.NONE,h,_;if(f(n)&&f(i)&&f(o)&&f(r)){let y=n.minimum,p=n.maximum,C=m.subtract(p,y,$Xe),x=o-i;Math.max(m.maximumComponent(C),x)<tKe-1?d=Hs.BITS12:d=Hs.NONE,h=N.inverseTransformation(r,new N);let E=m.negate(y,Qy);N.multiply(N.fromTranslation(E,R3),h,h);let S=Qy;S.x=1/C.x,S.y=1/C.y,S.z=1/C.z,N.multiply(N.fromScale(S,R3),h,h),_=N.clone(r),N.setTranslation(_,m.ZERO,_),r=N.clone(r,new N);let w=N.fromTranslation(y,R3),D=N.fromScale(C,eKe),I=N.multiply(w,D,R3);N.multiply(r,I,r),N.multiply(_,I,_)}this.quantization=d,this.minimumHeight=i,this.maximumHeight=o,this.center=m.clone(t),this.toScaledENU=h,this.fromScaledENU=r,this.matrix=_,this.hasVertexNormals=s,this.hasWebMercatorT=A(a,!1),this.hasGeodeticSurfaceNormals=A(c,!1),this.exaggeration=A(l,1),this.exaggerationRelativeHeight=A(u,0),this.stride=0,this._offsetGeodeticSurfaceNormal=0,this._offsetVertexNormal=0,this._calculateStrideAndOffsets()}Va.prototype.encode=function(t,n,i,o,r,s,a,c){let l=o.x,u=o.y;if(this.quantization===Hs.BITS12){i=N.multiplyByPoint(this.toScaledENU,i,Qy),i.x=B.clamp(i.x,0,1),i.y=B.clamp(i.y,0,1),i.z=B.clamp(i.z,0,1);let d=this.maximumHeight-this.minimumHeight,h=B.clamp((r-this.minimumHeight)/d,0,1);W.fromElements(i.x,i.y,ef);let _=zn.compressTextureCoordinates(ef);W.fromElements(i.z,h,ef);let y=zn.compressTextureCoordinates(ef);W.fromElements(l,u,ef);let p=zn.compressTextureCoordinates(ef);if(t[n++]=_,t[n++]=y,t[n++]=p,this.hasWebMercatorT){W.fromElements(a,0,ef);let C=zn.compressTextureCoordinates(ef);t[n++]=C}}else m.subtract(i,this.center,Qy),t[n++]=Qy.x,t[n++]=Qy.y,t[n++]=Qy.z,t[n++]=r,t[n++]=l,t[n++]=u,this.hasWebMercatorT&&(t[n++]=a);return this.hasVertexNormals&&(t[n++]=zn.octPackFloat(s)),this.hasGeodeticSurfaceNormals&&(t[n++]=c.x,t[n++]=c.y,t[n++]=c.z),n};var nKe=new m,vfe=new m;Va.prototype.addGeodeticSurfaceNormals=function(t,n,i){if(this.hasGeodeticSurfaceNormals)return;let o=this.stride,r=t.length/o;this.hasGeodeticSurfaceNormals=!0,this._calculateStrideAndOffsets();let s=this.stride;for(let a=0;a<r;a++){for(let d=0;d<o;d++){let h=a*o+d,_=a*s+d;n[_]=t[h]}let c=this.decodePosition(n,a,nKe),l=i.geodeticSurfaceNormal(c,vfe),u=a*s+this._offsetGeodeticSurfaceNormal;n[u]=l.x,n[u+1]=l.y,n[u+2]=l.z}};Va.prototype.removeGeodeticSurfaceNormals=function(t,n){if(!this.hasGeodeticSurfaceNormals)return;let i=this.stride,o=t.length/i;this.hasGeodeticSurfaceNormals=!1,this._calculateStrideAndOffsets();let r=this.stride;for(let s=0;s<o;s++)for(let a=0;a<r;a++){let c=s*i+a,l=s*r+a;n[l]=t[c]}};Va.prototype.decodePosition=function(t,n,i){if(f(i)||(i=new m),n*=this.stride,this.quantization===Hs.BITS12){let o=zn.decompressTextureCoordinates(t[n],ef);i.x=o.x,i.y=o.y;let r=zn.decompressTextureCoordinates(t[n+1],ef);return i.z=r.x,N.multiplyByPoint(this.fromScaledENU,i,i)}return i.x=t[n],i.y=t[n+1],i.z=t[n+2],m.add(i,this.center,i)};Va.prototype.getExaggeratedPosition=function(t,n,i){i=this.decodePosition(t,n,i);let o=this.exaggeration,r=this.exaggerationRelativeHeight;if(o!==1&&this.hasGeodeticSurfaceNormals){let a=this.decodeGeodeticSurfaceNormal(t,n,vfe),c=this.decodeHeight(t,n),l=kc.getHeight(c,o,r)-c;i.x+=a.x*l,i.y+=a.y*l,i.z+=a.z*l}return i};Va.prototype.decodeTextureCoordinates=function(t,n,i){return f(i)||(i=new W),n*=this.stride,this.quantization===Hs.BITS12?zn.decompressTextureCoordinates(t[n+2],i):W.fromElements(t[n+4],t[n+5],i)};Va.prototype.decodeHeight=function(t,n){return n*=this.stride,this.quantization===Hs.BITS12?zn.decompressTextureCoordinates(t[n+1],ef).y*(this.maximumHeight-this.minimumHeight)+this.minimumHeight:t[n+3]};Va.prototype.decodeWebMercatorT=function(t,n){return n*=this.stride,this.quantization===Hs.BITS12?zn.decompressTextureCoordinates(t[n+3],ef).x:t[n+6]};Va.prototype.getOctEncodedNormal=function(t,n,i){n=n*this.stride+this._offsetVertexNormal;let o=t[n]/256,r=Math.floor(o),s=(o-r)*256;return W.fromElements(r,s,i)};Va.prototype.decodeGeodeticSurfaceNormal=function(t,n,i){return n=n*this.stride+this._offsetGeodeticSurfaceNormal,i.x=t[n],i.y=t[n+1],i.z=t[n+2],i};Va.prototype._calculateStrideAndOffsets=function(){let t=0;switch(this.quantization){case Hs.BITS12:t+=3;break;default:t+=6}this.hasWebMercatorT&&(t+=1),this.hasVertexNormals&&(this._offsetVertexNormal=t,t+=1),this.hasGeodeticSurfaceNormals&&(this._offsetGeodeticSurfaceNormal=t,t+=3),this.stride=t};var M3={position3DAndHeight:0,textureCoordAndEncodedNormals:1,geodeticSurfaceNormal:2},L3={compressed0:0,compressed1:1,geodeticSurfaceNormal:2};Va.prototype.getAttributes=function(t){let n=J.FLOAT,i=J.getSizeInBytes(n),o=this.stride*i,r=0,s=[];function a(c,l){s.push({index:c,vertexBuffer:t,componentDatatype:n,componentsPerAttribute:l,offsetInBytes:r,strideInBytes:o}),r+=l*i}if(this.quantization===Hs.NONE){a(M3.position3DAndHeight,4);let c=2;c+=this.hasWebMercatorT?1:0,c+=this.hasVertexNormals?1:0,a(M3.textureCoordAndEncodedNormals,c),this.hasGeodeticSurfaceNormals&&a(M3.geodeticSurfaceNormal,3)}else{let c=this.hasWebMercatorT||this.hasVertexNormals,l=this.hasWebMercatorT&&this.hasVertexNormals;a(L3.compressed0,c?4:3),l&&a(L3.compressed1,1),this.hasGeodeticSurfaceNormals&&a(L3.geodeticSurfaceNormal,3)}return s};Va.prototype.getAttributeLocations=function(){return this.quantization===Hs.NONE?M3:L3};Va.clone=function(t,n){if(!!f(t))return f(n)||(n=new Va),n.quantization=t.quantization,n.minimumHeight=t.minimumHeight,n.maximumHeight=t.maximumHeight,n.center=m.clone(t.center),n.toScaledENU=N.clone(t.toScaledENU),n.fromScaledENU=N.clone(t.fromScaledENU),n.matrix=N.clone(t.matrix),n.hasVertexNormals=t.hasVertexNormals,n.hasWebMercatorT=t.hasWebMercatorT,n.hasGeodeticSurfaceNormals=t.hasGeodeticSurfaceNormals,n.exaggeration=t.exaggeration,n.exaggerationRelativeHeight=t.exaggerationRelativeHeight,n._calculateStrideAndOffsets(),n};var Tc=Va;var Oh={};Oh.DEFAULT_STRUCTURE=Object.freeze({heightScale:1,heightOffset:0,elementsPerHeight:1,stride:1,elementMultiplier:256,isBigEndian:!1});var e7=new m,iKe=new N,oKe=new m,rKe=new m;Oh.computeVertices=function(t){let n=Math.cos,i=Math.sin,o=Math.sqrt,r=Math.atan,s=Math.exp,a=B.PI_OVER_TWO,c=B.toRadians,l=t.heightmap,u=t.width,d=t.height,h=t.skirtHeight,_=h>0,y=A(t.isGeographic,!0),p=A(t.ellipsoid,oe.WGS84),C=1/p.maximumRadius,x=le.clone(t.nativeRectangle),T=le.clone(t.rectangle),E,S,w,D;f(T)?(E=T.west,S=T.south,w=T.east,D=T.north):y?(E=c(x.west),S=c(x.south),w=c(x.east),D=c(x.north)):(E=x.west*C,S=a-2*r(s(-x.south*C)),w=x.east*C,D=a-2*r(s(-x.north*C)));let I=t.relativeToCenter,O=f(I);I=O?I:m.ZERO;let M=A(t.includeWebMercatorT,!1),L=A(t.exaggeration,1),F=A(t.exaggerationRelativeHeight,0),b=L!==1,v=A(t.structure,Oh.DEFAULT_STRUCTURE),P=A(v.heightScale,Oh.DEFAULT_STRUCTURE.heightScale),R=A(v.heightOffset,Oh.DEFAULT_STRUCTURE.heightOffset),V=A(v.elementsPerHeight,Oh.DEFAULT_STRUCTURE.elementsPerHeight),H=A(v.stride,Oh.DEFAULT_STRUCTURE.stride),U=A(v.elementMultiplier,Oh.DEFAULT_STRUCTURE.elementMultiplier),G=A(v.isBigEndian,Oh.DEFAULT_STRUCTURE.isBigEndian),k=le.computeWidth(x),X=le.computeHeight(x),Y=k/(u-1),K=X/(d-1);y||(k*=C,X*=C);let j=p.radiiSquared,Z=j.x,Q=j.y,me=j.z,_e=65536,re=-65536,fe=vt.eastNorthUpToFixedFrame(I,p),ge=N.inverseTransformation(fe,iKe),be,Be;M&&(be=bi.geodeticLatitudeToMercatorAngle(S),Be=1/(bi.geodeticLatitudeToMercatorAngle(D)-be));let ke=oKe;ke.x=Number.POSITIVE_INFINITY,ke.y=Number.POSITIVE_INFINITY,ke.z=Number.POSITIVE_INFINITY;let qe=rKe;qe.x=Number.NEGATIVE_INFINITY,qe.y=Number.NEGATIVE_INFINITY,qe.z=Number.NEGATIVE_INFINITY;let Nt=Number.POSITIVE_INFINITY,Wt=u*d,un=h>0?u*2+d*2:0,_t=Wt+un,Rn=new Array(_t),oi=new Array(_t),lt=new Array(_t),Yt=M?new Array(_t):[],si=b?new Array(_t):[],ye=0,Oe=d,Ye=0,Xt=u;_&&(--ye,++Oe,--Ye,++Xt);let En=1e-5;for(let Xe=ye;Xe<Oe;++Xe){let dt=Xe;dt<0&&(dt=0),dt>=d&&(dt=d-1);let Mt=x.north-K*dt;y?Mt=c(Mt):Mt=a-2*r(s(-Mt*C));let bn=(Mt-S)/(D-S);bn=B.clamp(bn,0,1);let To=Xe===ye,Go=Xe===Oe-1;h>0&&(To?Mt+=En*X:Go&&(Mt-=En*X));let Kr=n(Mt),As=i(Mt),io=me*As,Ri;M&&(Ri=(bi.geodeticLatitudeToMercatorAngle(Mt)-be)*Be);for(let hr=Ye;hr<Xt;++hr){let Dr=hr;Dr<0&&(Dr=0),Dr>=u&&(Dr=u-1);let ru=dt*(u*H)+Dr*H,Ui;if(V===1)Ui=l[ru];else{Ui=0;let Ja;if(G)for(Ja=0;Ja<V;++Ja)Ui=Ui*U+l[ru+Ja];else for(Ja=V-1;Ja>=0;--Ja)Ui=Ui*U+l[ru+Ja]}Ui=Ui*P+R,re=Math.max(re,Ui),_e=Math.min(_e,Ui);let Ur=x.west+Y*Dr;y?Ur=c(Ur):Ur=Ur*C;let Xs=(Ur-E)/(w-E);Xs=B.clamp(Xs,0,1);let mr=dt*u+Dr;if(h>0){let Ja=hr===Ye,vr=hr===Xt-1,aP=To||Go||Ja||vr;if((To||Go)&&(Ja||vr))continue;aP&&(Ui-=h,Ja?(mr=Wt+(d-dt-1),Ur-=En*k):Go?mr=Wt+d+(u-Dr-1):vr?(mr=Wt+d+u+dt,Ur+=En*k):To&&(mr=Wt+d+u+d+Dr))}let ha=Kr*n(Ur),or=Kr*i(Ur),Oc=Z*ha,Rc=Q*or,Cs=1/o(Oc*ha+Rc*or+io*As),Zh=Oc*Cs,UA=Rc*Cs,db=io*Cs,Wo=new m;Wo.x=Zh+ha*Ui,Wo.y=UA+or*Ui,Wo.z=db+As*Ui,N.multiplyByPoint(ge,Wo,e7),m.minimumByComponent(e7,ke,ke),m.maximumByComponent(e7,qe,qe),Nt=Math.min(Nt,Ui),Rn[mr]=Wo,lt[mr]=new W(Xs,bn),oi[mr]=Ui,M&&(Yt[mr]=Ri),b&&(si[mr]=p.geodeticSurfaceNormal(Wo))}}let Vi=ae.fromPoints(Rn),ki;f(T)&&(ki=_i.fromRectangle(T,_e,re,p));let Xi;O&&(Xi=new Q_(p).computeHorizonCullingPointPossiblyUnderEllipsoid(I,Rn,_e));let li=new C0(ke,qe,I),Le=new Tc(I,li,Nt,re,fe,!1,M,b,L,F),nt=new Float32Array(_t*Le.stride),Qe=0;for(let Xe=0;Xe<_t;++Xe)Qe=Le.encode(nt,Qe,Rn[Xe],lt[Xe],oi[Xe],void 0,Yt[Xe],si[Xe]);return{vertices:nt,maximumHeight:re,minimumHeight:_e,encoding:Le,boundingSphere3D:Vi,orientedBoundingBox:ki,occludeePointInScaledSpace:Xi}};var MD=Oh;function Ig(){Ce.throwInstantiationError()}Object.defineProperties(Ig.prototype,{credits:{get:Ce.throwInstantiationError},waterMask:{get:Ce.throwInstantiationError}});Ig.prototype.interpolateHeight=Ce.throwInstantiationError;Ig.prototype.isChildAvailable=Ce.throwInstantiationError;Ig.prototype.createMesh=Ce.throwInstantiationError;Ig.prototype.upsample=Ce.throwInstantiationError;Ig.prototype.wasCreatedByUpsampling=Ce.throwInstantiationError;Ig.maximumAsynchronousTasks=5;var Rh=Ig;function sKe(t,n,i,o,r,s,a,c,l,u,d,h,_,y,p,C){this.center=t,this.vertices=n,this.stride=A(u,6),this.indices=i,this.indexCountWithoutSkirts=o,this.vertexCountWithoutSkirts=r,this.minimumHeight=s,this.maximumHeight=a,this.boundingSphere3D=c,this.occludeePointInScaledSpace=l,this.orientedBoundingBox=d,this.encoding=h,this.westIndicesSouthToNorth=_,this.southIndicesEastToWest=y,this.eastIndicesNorthToSouth=p,this.northIndicesWestToEast=C}var hd=sKe;function Ec(){Ce.throwInstantiationError()}Object.defineProperties(Ec.prototype,{errorEvent:{get:Ce.throwInstantiationError},credit:{get:Ce.throwInstantiationError},tilingScheme:{get:Ce.throwInstantiationError},ready:{get:Ce.throwInstantiationError},readyPromise:{get:Ce.throwInstantiationError},hasWaterMask:{get:Ce.throwInstantiationError},hasVertexNormals:{get:Ce.throwInstantiationError},availability:{get:Ce.throwInstantiationError}});var Pfe=[];Ec.getRegularGridIndices=function(t,n){let i=Pfe[t];f(i)||(Pfe[t]=i=[]);let o=i[n];return f(o)||(t*n<B.SIXTY_FOUR_KILOBYTES?o=i[n]=new Uint16Array((t-1)*(n-1)*6):o=i[n]=new Uint32Array((t-1)*(n-1)*6),Rfe(t,n,o,0)),o};var Ife=[];Ec.getRegularGridIndicesAndEdgeIndices=function(t,n){let i=Ife[t];f(i)||(Ife[t]=i=[]);let o=i[n];if(!f(o)){let r=Ec.getRegularGridIndices(t,n),s=Ofe(t,n),a=s.westIndicesSouthToNorth,c=s.southIndicesEastToWest,l=s.eastIndicesNorthToSouth,u=s.northIndicesWestToEast;o=i[n]={indices:r,westIndicesSouthToNorth:a,southIndicesEastToWest:c,eastIndicesNorthToSouth:l,northIndicesWestToEast:u}}return o};var Bfe=[];Ec.getRegularGridAndSkirtIndicesAndEdgeIndices=function(t,n){let i=Bfe[t];f(i)||(Bfe[t]=i=[]);let o=i[n];if(!f(o)){let r=t*n,s=(t-1)*(n-1)*6,a=t*2+n*2,c=Math.max(0,a-4)*6,l=r+a,u=s+c,d=Ofe(t,n),h=d.westIndicesSouthToNorth,_=d.southIndicesEastToWest,y=d.eastIndicesNorthToSouth,p=d.northIndicesWestToEast,C=Ne.createTypedArray(l,u);Rfe(t,n,C,0),Ec.addSkirtIndices(h,_,y,p,r,C,s),o=i[n]={indices:C,westIndicesSouthToNorth:h,southIndicesEastToWest:_,eastIndicesNorthToSouth:y,northIndicesWestToEast:p,indexCountWithoutSkirts:s}}return o};Ec.addSkirtIndices=function(t,n,i,o,r,s,a){let c=r;a=F3(t,c,s,a),c+=t.length,a=F3(n,c,s,a),c+=n.length,a=F3(i,c,s,a),c+=i.length,F3(o,c,s,a)};function Ofe(t,n){let i=new Array(n),o=new Array(t),r=new Array(n),s=new Array(t),a;for(a=0;a<t;++a)s[a]=a,o[a]=t*n-1-a;for(a=0;a<n;++a)r[a]=(a+1)*t-1,i[a]=(n-a-1)*t;return{westIndicesSouthToNorth:i,southIndicesEastToWest:o,eastIndicesNorthToSouth:r,northIndicesWestToEast:s}}function Rfe(t,n,i,o){let r=0;for(let s=0;s<n-1;++s){for(let a=0;a<t-1;++a){let c=r,l=c+t,u=l+1,d=c+1;i[o++]=c,i[o++]=l,i[o++]=d,i[o++]=d,i[o++]=l,i[o++]=u,++r}++r}}function F3(t,n,i,o){let r=t[0],s=t.length;for(let a=1;a<s;++a){let c=t[a];i[o++]=r,i[o++]=c,i[o++]=n,i[o++]=n,i[o++]=c,i[o++]=n+1,r=c,++n}return o}Ec.heightmapTerrainQuality=.25;Ec.getEstimatedLevelZeroGeometricErrorForAHeightmap=function(t,n,i){return t.maximumRadius*2*Math.PI*Ec.heightmapTerrainQuality/(n*i)};Ec.prototype.requestTileGeometry=Ce.throwInstantiationError;Ec.prototype.getLevelMaximumGeometricError=Ce.throwInstantiationError;Ec.prototype.getTileDataAvailable=Ce.throwInstantiationError;Ec.prototype.loadTileDataAvailability=Ce.throwInstantiationError;var Yr=Ec;function pp(t){this._buffer=t.buffer,this._width=t.width,this._height=t.height,this._childTileMask=A(t.childTileMask,15),this._encoding=A(t.encoding,dd.NONE);let n=MD.DEFAULT_STRUCTURE,i=t.structure;f(i)?i!==n&&(i.heightScale=A(i.heightScale,n.heightScale),i.heightOffset=A(i.heightOffset,n.heightOffset),i.elementsPerHeight=A(i.elementsPerHeight,n.elementsPerHeight),i.stride=A(i.stride,n.stride),i.elementMultiplier=A(i.elementMultiplier,n.elementMultiplier),i.isBigEndian=A(i.isBigEndian,n.isBigEndian)):i=n,this._structure=i,this._createdByUpsampling=A(t.createdByUpsampling,!1),this._waterMask=t.waterMask,this._skirtHeight=void 0,this._bufferType=this._encoding===dd.LERC?Float32Array:this._buffer.constructor,this._mesh=void 0}Object.defineProperties(pp.prototype,{credits:{get:function(){}},waterMask:{get:function(){return this._waterMask}},childTileMask:{get:function(){return this._childTileMask}}});var Mfe="createVerticesFromHeightmap",aKe=new fi(Mfe),cKe=new fi(Mfe,Rh.maximumAsynchronousTasks);pp.prototype.createMesh=function(t){t=A(t,A.EMPTY_OBJECT);let n=t.tilingScheme,i=t.x,o=t.y,r=t.level,s=A(t.exaggeration,1),a=A(t.exaggerationRelativeHeight,0),c=A(t.throttle,!0),l=n.ellipsoid,u=n.tileXYToNativeRectangle(i,o,r),d=n.tileXYToRectangle(i,o,r),h=l.cartographicToCartesian(le.center(d)),_=this._structure,p=Yr.getEstimatedLevelZeroGeometricErrorForAHeightmap(l,this._width,n.getNumberOfXTilesAtLevel(0))/(1<<r);this._skirtHeight=Math.min(p*4,1e3);let x=(c?cKe:aKe).scheduleTask({heightmap:this._buffer,structure:_,includeWebMercatorT:!0,width:this._width,height:this._height,nativeRectangle:u,rectangle:d,relativeToCenter:h,ellipsoid:l,skirtHeight:this._skirtHeight,isGeographic:n.projection instanceof Ci,exaggeration:s,exaggerationRelativeHeight:a,encoding:this._encoding});if(!f(x))return;let T=this;return Promise.resolve(x).then(function(E){let S;T._skirtHeight>0?S=Yr.getRegularGridAndSkirtIndicesAndEdgeIndices(E.gridWidth,E.gridHeight):S=Yr.getRegularGridIndicesAndEdgeIndices(E.gridWidth,E.gridHeight);let w=E.gridWidth*E.gridHeight;return T._mesh=new hd(h,new Float32Array(E.vertices),S.indices,S.indexCountWithoutSkirts,w,E.minimumHeight,E.maximumHeight,ae.clone(E.boundingSphere3D),m.clone(E.occludeePointInScaledSpace),E.numberOfAttributes,_i.clone(E.orientedBoundingBox),Tc.clone(E.encoding),S.westIndicesSouthToNorth,S.southIndicesEastToWest,S.eastIndicesNorthToSouth,S.northIndicesWestToEast),T._buffer=void 0,T._mesh})};pp.prototype._createMeshSync=function(t){let n=t.tilingScheme,i=t.x,o=t.y,r=t.level,s=A(t.exaggeration,1),a=A(t.exaggerationRelativeHeight,0),c=n.ellipsoid,l=n.tileXYToNativeRectangle(i,o,r),u=n.tileXYToRectangle(i,o,r),d=c.cartographicToCartesian(le.center(u)),h=this._structure,y=Yr.getEstimatedLevelZeroGeometricErrorForAHeightmap(c,this._width,n.getNumberOfXTilesAtLevel(0))/(1<<r);this._skirtHeight=Math.min(y*4,1e3);let p=MD.computeVertices({heightmap:this._buffer,structure:h,includeWebMercatorT:!0,width:this._width,height:this._height,nativeRectangle:l,rectangle:u,relativeToCenter:d,ellipsoid:c,skirtHeight:this._skirtHeight,isGeographic:n.projection instanceof Ci,exaggeration:s,exaggerationRelativeHeight:a});this._buffer=void 0;let C;this._skirtHeight>0?C=Yr.getRegularGridAndSkirtIndicesAndEdgeIndices(this._width,this._height):C=Yr.getRegularGridIndicesAndEdgeIndices(this._width,this._height);let x=p.gridWidth*p.gridHeight;return this._mesh=new hd(d,p.vertices,C.indices,C.indexCountWithoutSkirts,x,p.minimumHeight,p.maximumHeight,p.boundingSphere3D,p.occludeePointInScaledSpace,p.encoding.stride,p.orientedBoundingBox,p.encoding,C.westIndicesSouthToNorth,C.southIndicesEastToWest,C.eastIndicesNorthToSouth,C.northIndicesWestToEast),this._mesh};pp.prototype.interpolateHeight=function(t,n,i){let o=this._width,r=this._height,s=this._structure,a=s.stride,c=s.elementsPerHeight,l=s.elementMultiplier,u=s.isBigEndian,d=s.heightOffset,h=s.heightScale,_=f(this._mesh),y=this._encoding===dd.LERC;if(!_&&y)return;let C;if(_){let x=this._mesh.vertices,T=this._mesh.encoding;C=Lfe(x,T,d,h,t,o,r,n,i)}else C=lKe(this._buffer,c,l,a,u,t,o,r,n,i),C=C*h+d;return C};pp.prototype.upsample=function(t,n,i,o,r,s,a){let c=this._mesh;if(!f(c))return;let l=this._width,u=this._height,d=this._structure,h=d.stride,_=new this._bufferType(l*u*h),y=c.vertices,p=c.encoding,C=t.tileXYToRectangle(n,i,o),x=t.tileXYToRectangle(r,s,a),T=d.heightOffset,E=d.heightScale,S=d.elementsPerHeight,w=d.elementMultiplier,D=d.isBigEndian,I=Math.pow(w,S-1);for(let O=0;O<u;++O){let M=B.lerp(x.north,x.south,O/(u-1));for(let L=0;L<l;++L){let F=B.lerp(x.west,x.east,L/(l-1)),g=Lfe(y,p,T,E,C,l,u,F,M);g=g<d.lowestEncodedHeight?d.lowestEncodedHeight:g,g=g>d.highestEncodedHeight?d.highestEncodedHeight:g,uKe(_,S,w,I,h,D,O*l+L,g)}}return Promise.resolve(new pp({buffer:_,width:l,height:u,childTileMask:0,structure:this._structure,createdByUpsampling:!0}))};pp.prototype.isChildAvailable=function(t,n,i,o){let r=2;return i!==t*2&&++r,o!==n*2&&(r-=2),(this._childTileMask&1<<r)!==0};pp.prototype.wasCreatedByUpsampling=function(){return this._createdByUpsampling};function lKe(t,n,i,o,r,s,a,c,l,u){let d=(l-s.west)*(a-1)/(s.east-s.west),h=(u-s.south)*(c-1)/(s.north-s.south),_=d|0,y=_+1;y>=a&&(y=a-1,_=a-2);let p=h|0,C=p+1;C>=c&&(C=c-1,p=c-2);let x=d-_,T=h-p;p=c-1-p,C=c-1-C;let E=N3(t,n,i,o,r,p*a+_),S=N3(t,n,i,o,r,p*a+y),w=N3(t,n,i,o,r,C*a+_),D=N3(t,n,i,o,r,C*a+y);return Ffe(x,T,E,S,w,D)}function Lfe(t,n,i,o,r,s,a,c,l){let u=(c-r.west)*(s-1)/(r.east-r.west),d=(l-r.south)*(a-1)/(r.north-r.south),h=u|0,_=h+1;_>=s&&(_=s-1,h=s-2);let y=d|0,p=y+1;p>=a&&(p=a-1,y=a-2);let C=u-h,x=d-y;y=a-1-y,p=a-1-p;let T=(n.decodeHeight(t,y*s+h)-i)/o,E=(n.decodeHeight(t,y*s+_)-i)/o,S=(n.decodeHeight(t,p*s+h)-i)/o,w=(n.decodeHeight(t,p*s+_)-i)/o;return Ffe(C,x,T,E,S,w)}function Ffe(t,n,i,o,r,s){return n<t?i+t*(o-i)+n*(s-o):i+t*(s-r)+n*(r-i)}function N3(t,n,i,o,r,s){s*=o;let a=0,c;if(r)for(c=0;c<n;++c)a=a*i+t[s+c];else for(c=n-1;c>=0;--c)a=a*i+t[s+c];return a}function uKe(t,n,i,o,r,s,a,c){a*=r;let l;if(s)for(l=0;l<n-1;++l)t[a+l]=c/o|0,c-=t[a+l]*o,o/=i;else for(l=n-1;l>0;--l)t[a+l]=c/o|0,c-=t[a+l]*o,o/=i;t[a+l]=c}var ka=pp;function dE(t,n){this._tilingScheme=t,this._maximumLevel=n,this._rootNodes=[]}var $y=new le;function fKe(t,n,i,o){let r=o.length;for(let s=0;s<r;++s){let a=o[s];if(a.x===n&&a.y===i&&a.level===t)return!0}return!1}dE.prototype.addAvailableTileRange=function(t,n,i,o,r){let s=this._tilingScheme,a=this._rootNodes;if(t===0)for(let _=i;_<=r;++_)for(let y=n;y<=o;++y)fKe(t,y,_,a)||a.push(new uE(s,void 0,0,y,_));s.tileXYToRectangle(n,i,t,$y);let c=$y.west,l=$y.north;s.tileXYToRectangle(o,r,t,$y);let u=$y.east,d=$y.south,h=new _Ke(t,c,d,u,l);for(let _=0;_<a.length;++_){let y=a[_];t7(y.extent,h)&&gKe(this._maximumLevel,y,h)}};dE.prototype.computeMaximumLevelAtPosition=function(t){let n;for(let i=0;i<this._rootNodes.length;++i){let o=this._rootNodes[i];if(fE(o.extent,t)){n=o;break}}return f(n)?LD(void 0,n,t):-1};var dKe=[],hKe=[],mKe=new le,pKe=new le;dE.prototype.computeBestAvailableLevelOverRectangle=function(t){let n=dKe;n.length=0,t.east<t.west?(n.push(le.fromRadians(-Math.PI,t.south,t.east,t.north,mKe)),n.push(le.fromRadians(t.west,t.south,Math.PI,t.north,pKe))):n.push(t);let i=hKe;i.length=0;let o;for(o=0;o<this._rootNodes.length;++o)FD(i,this._rootNodes[o],n);for(o=i.length-1;o>=0;--o)if(f(i[o])&&i[o].length===0)return o;return 0};var Nfe=new de;dE.prototype.isTileAvailable=function(t,n,i){let o=this._tilingScheme.tileXYToRectangle(n,i,t,$y);return le.center(o,Nfe),this.computeMaximumLevelAtPosition(Nfe)>=t};dE.prototype.computeChildMaskForTile=function(t,n,i){let o=t+1;if(o>=this._maximumLevel)return 0;let r=0;return r|=this.isTileAvailable(o,2*n,2*i+1)?1:0,r|=this.isTileAvailable(o,2*n+1,2*i+1)?2:0,r|=this.isTileAvailable(o,2*n,2*i)?4:0,r|=this.isTileAvailable(o,2*n+1,2*i)?8:0,r};function uE(t,n,i,o,r){this.tilingScheme=t,this.parent=n,this.level=i,this.x=o,this.y=r,this.extent=t.tileXYToRectangle(o,r,i),this.rectangles=[],this._sw=void 0,this._se=void 0,this._nw=void 0,this._ne=void 0}Object.defineProperties(uE.prototype,{nw:{get:function(){return this._nw||(this._nw=new uE(this.tilingScheme,this,this.level+1,this.x*2,this.y*2)),this._nw}},ne:{get:function(){return this._ne||(this._ne=new uE(this.tilingScheme,this,this.level+1,this.x*2+1,this.y*2)),this._ne}},sw:{get:function(){return this._sw||(this._sw=new uE(this.tilingScheme,this,this.level+1,this.x*2,this.y*2+1)),this._sw}},se:{get:function(){return this._se||(this._se=new uE(this.tilingScheme,this,this.level+1,this.x*2+1,this.y*2+1)),this._se}}});function _Ke(t,n,i,o,r){this.level=t,this.west=n,this.south=i,this.east=o,this.north=r}function t7(t,n){let i=Math.max(t.west,n.west),o=Math.max(t.south,n.south),r=Math.min(t.east,n.east),s=Math.min(t.north,n.north);return o<s&&i<r}function gKe(t,n,i){for(;n.level<t;)if(V3(n.nw.extent,i))n=n.nw;else if(V3(n.ne.extent,i))n=n.ne;else if(V3(n.sw.extent,i))n=n.sw;else if(V3(n.se.extent,i))n=n.se;else break;if(n.rectangles.length===0||n.rectangles[n.rectangles.length-1].level<=i.level)n.rectangles.push(i);else{let o=jo(n.rectangles,i.level,yKe);o<0&&(o=~o),n.rectangles.splice(o,0,i)}}function yKe(t,n){return t.level-n}function V3(t,n){return n.west>=t.west&&n.east<=t.east&&n.south>=t.south&&n.north<=t.north}function fE(t,n){return n.longitude>=t.west&&n.longitude<=t.east&&n.latitude>=t.south&&n.latitude<=t.north}function LD(t,n,i){let o=0,r=!1;for(;!r;){let s=n._nw&&fE(n._nw.extent,i),a=n._ne&&fE(n._ne.extent,i),c=n._sw&&fE(n._sw.extent,i),l=n._se&&fE(n._se.extent,i);if(s+a+c+l>1){s&&(o=Math.max(o,LD(n,n._nw,i))),a&&(o=Math.max(o,LD(n,n._ne,i))),c&&(o=Math.max(o,LD(n,n._sw,i))),l&&(o=Math.max(o,LD(n,n._se,i)));break}else s?n=n._nw:a?n=n._ne:c?n=n._sw:l?n=n._se:r=!0}for(;n!==t;){let s=n.rectangles;for(let a=s.length-1;a>=0&&s[a].level>o;--a){let c=s[a];fE(c,i)&&(o=c.level)}n=n.parent}return o}function FD(t,n,i){if(!n)return;let o,r=!1;for(o=0;o<i.length;++o)r=r||t7(n.extent,i[o]);if(!r)return;let s=n.rectangles;for(o=0;o<s.length;++o){let a=s[o];t[a.level]||(t[a.level]=i),t[a.level]=AKe(t[a.level],a)}FD(t,n._nw,i),FD(t,n._ne,i),FD(t,n._sw,i),FD(t,n._se,i)}function AKe(t,n){let i=[];for(let o=0;o<t.length;++o){let r=t[o];t7(r,n)?(r.west<n.west&&i.push(new le(r.west,r.south,n.west,r.north)),r.east>n.east&&i.push(new le(n.east,r.south,r.east,r.north)),r.south<n.south&&i.push(new le(Math.max(n.west,r.west),r.south,Math.min(n.east,r.east),n.south)),r.north>n.north&&i.push(new le(Math.max(n.west,r.west),n.north,Math.min(n.east,r.east),r.north))):i.push(r)}return i}var Mh=dE;function CKe(t){let n,i=t.name,o=t.message;f(i)&&f(o)?n=`${i}: ${o}`:n=t.toString();let r=t.stack;return f(r)&&(n+=`
${r}`),n}var _p=CKe;function k3(t,n,i,o,r,s,a){this.provider=t,this.message=n,this.x=i,this.y=o,this.level=r,this.timesRetried=A(s,0),this.retry=!1,this.error=a}k3.reportError=function(t,n,i,o,r,s,a,c){let l=t;return f(t)?(l.provider=n,l.message=o,l.x=r,l.y=s,l.level=a,l.retry=!1,l.error=c,++l.timesRetried):l=new k3(n,o,r,s,a,0,c),i.numberOfListeners>0?i.raiseEvent(l):console.log(`An error occurred in "${n.constructor.name}": ${_p(o)}`),l};k3.reportSuccess=function(t){f(t)&&(t.timesRetried=-1)};var qn=k3;function Bg(t){if(t=A(t,A.EMPTY_OBJECT),this._ellipsoid=A(t.ellipsoid,oe.WGS84),this._numberOfLevelZeroTilesX=A(t.numberOfLevelZeroTilesX,1),this._numberOfLevelZeroTilesY=A(t.numberOfLevelZeroTilesY,1),this._projection=new bi(this._ellipsoid),f(t.rectangleSouthwestInMeters)&&f(t.rectangleNortheastInMeters))this._rectangleSouthwestInMeters=t.rectangleSouthwestInMeters,this._rectangleNortheastInMeters=t.rectangleNortheastInMeters;else{let o=this._ellipsoid.maximumRadius*Math.PI;this._rectangleSouthwestInMeters=new W(-o,-o),this._rectangleNortheastInMeters=new W(o,o)}let n=this._projection.unproject(this._rectangleSouthwestInMeters),i=this._projection.unproject(this._rectangleNortheastInMeters);this._rectangle=new le(n.longitude,n.latitude,i.longitude,i.latitude)}Object.defineProperties(Bg.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},rectangle:{get:function(){return this._rectangle}},projection:{get:function(){return this._projection}}});Bg.prototype.getNumberOfXTilesAtLevel=function(t){return this._numberOfLevelZeroTilesX<<t};Bg.prototype.getNumberOfYTilesAtLevel=function(t){return this._numberOfLevelZeroTilesY<<t};Bg.prototype.rectangleToNativeRectangle=function(t,n){let i=this._projection,o=i.project(le.southwest(t)),r=i.project(le.northeast(t));return f(n)?(n.west=o.x,n.south=o.y,n.east=r.x,n.north=r.y,n):new le(o.x,o.y,r.x,r.y)};Bg.prototype.tileXYToNativeRectangle=function(t,n,i,o){let r=this.getNumberOfXTilesAtLevel(i),s=this.getNumberOfYTilesAtLevel(i),a=(this._rectangleNortheastInMeters.x-this._rectangleSouthwestInMeters.x)/r,c=this._rectangleSouthwestInMeters.x+t*a,l=this._rectangleSouthwestInMeters.x+(t+1)*a,u=(this._rectangleNortheastInMeters.y-this._rectangleSouthwestInMeters.y)/s,d=this._rectangleNortheastInMeters.y-n*u,h=this._rectangleNortheastInMeters.y-(n+1)*u;return f(o)?(o.west=c,o.south=h,o.east=l,o.north=d,o):new le(c,h,l,d)};Bg.prototype.tileXYToRectangle=function(t,n,i,o){let r=this.tileXYToNativeRectangle(t,n,i,o),s=this._projection,a=s.unproject(new W(r.west,r.south)),c=s.unproject(new W(r.east,r.north));return r.west=a.longitude,r.south=a.latitude,r.east=c.longitude,r.north=c.latitude,r};Bg.prototype.positionToTileXY=function(t,n,i){let o=this._rectangle;if(!le.contains(o,t))return;let r=this.getNumberOfXTilesAtLevel(n),s=this.getNumberOfYTilesAtLevel(n),c=(this._rectangleNortheastInMeters.x-this._rectangleSouthwestInMeters.x)/r,u=(this._rectangleNortheastInMeters.y-this._rectangleSouthwestInMeters.y)/s,h=this._projection.project(t),_=h.x-this._rectangleSouthwestInMeters.x,y=this._rectangleNortheastInMeters.y-h.y,p=_/c|0;p>=r&&(p=r-1);let C=y/u|0;return C>=s&&(C=s-1),f(i)?(i.x=p,i.y=C,i):new W(p,C)};var Xr=Bg;var xKe=15;function hE(t){this._resource=void 0,this._credit=void 0,this._tilingScheme=void 0,this._levelZeroMaximumGeometricError=void 0,this._maxLevel=void 0,this._terrainDataStructure=void 0,this._ready=!1,this._width=void 0,this._height=void 0,this._encoding=void 0;let n=t.token;this._hasAvailability=!1,this._tilesAvailable=void 0,this._tilesAvailablityLoaded=void 0,this._availableCache={};let i=this,o=A(t.ellipsoid,oe.WGS84);this._readyPromise=Promise.resolve(t.url).then(function(r){let s=Ie.createIfNeeded(r);return s.appendForwardSlash(),f(n)&&(s=s.getDerivedResource({queryParameters:{token:n}})),i._resource=s,s.getDerivedResource({queryParameters:{f:"pjson"}}).fetchJson()}).then(function(r){let s=r.copyrightText;f(s)&&(i._credit=new Jt(s));let a=r.spatialReference,c=A(a.latestWkid,a.wkid),l=r.extent,u={ellipsoid:o};if(c===4326)u.rectangle=le.fromDegrees(l.xmin,l.ymin,l.xmax,l.ymax),i._tilingScheme=new Wi(u);else if(c===3857){let _=Math.PI*o.maximumRadius;r.extent.xmax>_&&(r.extent.xmax=_),r.extent.ymax>_&&(r.extent.ymax=_),r.extent.xmin<-_&&(r.extent.xmin=-_),r.extent.ymin<-_&&(r.extent.ymin=-_),u.rectangleSouthwestInMeters=new W(l.xmin,l.ymin),u.rectangleNortheastInMeters=new W(l.xmax,l.ymax),i._tilingScheme=new Xr(u)}else return Promise.reject(new he("Invalid spatial reference"));let d=r.tileInfo;return f(d)?(i._width=d.rows+1,i._height=d.cols+1,i._encoding=d.format==="LERC"?dd.LERC:dd.NONE,i._lodCount=d.lods.length-1,(i._hasAvailability=r.capabilities.indexOf("Tilemap")!==-1)&&(i._tilesAvailable=new Mh(i._tilingScheme,i._lodCount),i._tilesAvailable.addAvailableTileRange(0,0,0,i._tilingScheme.getNumberOfXTilesAtLevel(0),i._tilingScheme.getNumberOfYTilesAtLevel(0)),i._tilesAvailablityLoaded=new Mh(i._tilingScheme,i._lodCount)),i._levelZeroMaximumGeometricError=Yr.getEstimatedLevelZeroGeometricErrorForAHeightmap(i._tilingScheme.ellipsoid,i._width,i._tilingScheme.getNumberOfXTilesAtLevel(0)),r.bandCount>1&&console.log("ArcGISTiledElevationTerrainProvider: Terrain data has more than 1 band. Using the first one."),f(r.minValues)&&f(r.maxValues)?i._terrainDataStructure={elementMultiplier:1,lowestEncodedHeight:r.minValues[0],highestEncodedHeight:r.maxValues[0]}:i._terrainDataStructure={elementMultiplier:1},i._ready=!0,!0):Promise.reject(new he("tileInfo is required"))}).catch(function(r){let s=`An error occurred while accessing ${i._resource.url}.`;return qn.reportError(void 0,i,i._errorEvent,s),Promise.reject(r)}),this._errorEvent=new Ae}Object.defineProperties(hE.prototype,{errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){return this._credit}},tilingScheme:{get:function(){return this._tilingScheme}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise}},hasWaterMask:{get:function(){return!1}},hasVertexNormals:{get:function(){return!1}},availability:{get:function(){return this._tilesAvailable}}});hE.prototype.requestTileGeometry=function(t,n,i,o){let r=this._resource.getDerivedResource({url:`tile/${i}/${n}/${t}`,request:o}),s=this._hasAvailability,a=Promise.resolve(!0),c;if(s&&!f(n7(this,i+1,t*2,n*2))){let h=Vfe(this,i+1,t*2,n*2);a=h.promise,c=h.request}let l=r.fetchArrayBuffer();if(!f(l)||!f(a))return;let u=this,d=this._tilesAvailable;return Promise.all([l,a]).then(function(h){return new ka({buffer:h[0],width:u._width,height:u._height,childTileMask:s?d.computeChildMaskForTile(i,t,n):xKe,structure:u._terrainDataStructure,encoding:u._encoding})}).catch(function(h){return f(c)&&c.state===ai.CANCELLED?(o.cancel(),o.deferred.promise.finally(function(){return o.state=ai.CANCELLED,Promise.reject(h)})):Promise.reject(h)})};function n7(t,n,i,o){if(!t._hasAvailability)return;let r=t._tilesAvailablityLoaded,s=t._tilesAvailable;if(n>t._lodCount)return!1;if(s.isTileAvailable(n,i,o))return!0;if(r.isTileAvailable(n,i,o))return!1}hE.prototype.getLevelMaximumGeometricError=function(t){return this._levelZeroMaximumGeometricError/(1<<t)};hE.prototype.getTileDataAvailable=function(t,n,i){if(!this._hasAvailability)return;let o=n7(this,i,t,n);if(f(o))return o;Vfe(this,i,t,n)};hE.prototype.loadTileDataAvailability=function(t,n,i){};function TKe(t,n,i,o){let r=n-1,s=i-1,a=o[t.y*n+t.x],c=[],l={startX:t.x,startY:t.y,endX:0,endY:0},u=new W(t.x+1,t.y+1),d=!1,h=!1;for(;!(d&&h);){let _=u.x,y=h?u.y+1:u.y;if(!d){for(let p=t.y;p<y;++p)if(o[p*n+u.x]!==a){d=!0;break}d?(c.push(new W(u.x,t.y)),--u.x,--_,l.endX=u.x):u.x===r?(l.endX=u.x,d=!0):++u.x}if(!h){let p=u.y*n;for(let C=t.x;C<=_;++C)if(o[p+C]!==a){h=!0;break}h?(c.push(new W(t.x,u.y)),--u.y,l.endY=u.y):u.y===s?(l.endY=u.y,h=!0):++u.y}}return{endingIndices:c,range:l,value:a}}function EKe(t,n,i,o,r){let s=[];if(r.every(function(l){return l===r[0]}))return r[0]===1&&s.push({startX:t,startY:n,endX:t+i-1,endY:n+o-1}),s;let c=[new W(0,0)];for(;c.length>0;){let l=c.pop(),u=TKe(l,i,o,r);if(u.value===1){let h=u.range;h.startX+=t,h.endX+=t,h.startY+=n,h.endY+=n,s.push(h)}let d=u.endingIndices;d.length>0&&(c=c.concat(d))}return s}function Vfe(t,n,i,o){if(!t._hasAvailability)return{};let r=Math.floor(i/128)*128,s=Math.floor(o/128)*128,a=Math.min(1<<n,128),c=`tilemap/${n}/${s}/${r}/${a}/${a}`,l=t._availableCache;if(f(l[c]))return l[c];let u=new qo({throttle:!1,throttleByServer:!0,type:Qr.TERRAIN}),h=t._resource.getDerivedResource({url:c,request:u}).fetchJson();return f(h)?(h=h.then(function(_){let y=EKe(r,s,a,a,_.data);t._tilesAvailablityLoaded.addAvailableTileRange(n,r,s,r+a,s+a);let p=t._tilesAvailable;for(let C=0;C<y.length;++C){let x=y[C];p.addAvailableTileRange(n,x.startX,x.startY,x.endX,x.endY)}return n7(t,n,i,o)}),l[c]={promise:h,request:u},h=h.finally(function(_){return delete l[c],_}),{promise:h,request:u}):{}}var kfe=hE;var Ufe="https://dev.virtualearth.net/REST/v1/Locations";function i7(t){t=A(t,A.EMPTY_OBJECT);let n=t.key;this._key=n;let i={key:n};f(t.culture)&&(i.culture=t.culture),this._resource=new Ie({url:Ufe,queryParameters:i})}Object.defineProperties(i7.prototype,{url:{get:function(){return Ufe}},key:{get:function(){return this._key}}});i7.prototype.geocode=function(t){return this._resource.getDerivedResource({queryParameters:{query:t}}).fetchJsonp("jsonp").then(function(i){return i.resourceSets.length===0?[]:i.resourceSets[0].resources.map(function(r){let s=r.bbox,a=s[0],c=s[1],l=s[2],u=s[3];return{displayName:r.name,destination:le.fromDegrees(c,a,u,l)}})})};var zfe=i7;function Hfe(){}Hfe.prototype.geocode=function(t){let n=t.match(/[^\s,\n]+/g);if(n.length===2||n.length===3){let i=+n[0],o=+n[1],r=n.length===3?+n[2]:300;if(isNaN(i)&&isNaN(o)){let s=/^(\d+.?\d*)([nsew])/i;for(let a=0;a<n.length;++a){let c=n[a].match(s);s.test(n[a])&&c.length===3&&(/^[ns]/i.test(c[2])?o=/^[n]/i.test(c[2])?+c[1]:-c[1]:/^[ew]/i.test(c[2])&&(i=/^[e]/i.test(c[2])?+c[1]:-c[1]))}}if(!isNaN(i)&&!isNaN(o)&&!isNaN(r)){let s={displayName:t,destination:m.fromDegrees(i,o,r)};return Promise.resolve([s])}}return Promise.resolve([])};var U3=Hfe;var bKe=new se,Gfe=new m,mE=new m;function SKe(t){let n=t.points,i=t.times;if(n.length<3){let o=i[0],r=1/(i[1]-o),s=n[0],a=n[1];return function(c,l){f(l)||(l=new m);let u=(c-o)*r;return m.lerp(s,a,u,l)}}return function(o,r){f(r)||(r=new m);let s=t._lastTimeIndex=t.findTimeInterval(o,t._lastTimeIndex),a=(o-i[s])/(i[s+1]-i[s]),c=bKe;c.z=a,c.y=a*a,c.x=c.y*a,c.w=1;let l,u,d,h,_;return s===0?(l=n[0],u=n[1],d=t.firstTangent,h=m.subtract(n[2],l,Gfe),m.multiplyByScalar(h,.5,h),_=N.multiplyByVector(N0.hermiteCoefficientMatrix,c,c)):s===n.length-2?(l=n[s],u=n[s+1],h=t.lastTangent,d=m.subtract(u,n[s-1],Gfe),m.multiplyByScalar(d,.5,d),_=N.multiplyByVector(N0.hermiteCoefficientMatrix,c,c)):(l=n[s-1],u=n[s],d=n[s+1],h=n[s+2],_=N.multiplyByVector(Og.catmullRomCoefficientMatrix,c,c)),r=m.multiplyByScalar(l,_.x,r),m.multiplyByScalar(u,_.y,mE),m.add(r,mE,r),m.multiplyByScalar(d,_.z,mE),m.add(r,mE,r),m.multiplyByScalar(h,_.w,mE),m.add(r,mE,r)}}var wKe=new m,DKe=new m;function Og(t){t=A(t,A.EMPTY_OBJECT);let n=t.points,i=t.times,o=t.firstTangent,r=t.lastTangent;if(n.length>2&&(f(o)||(o=wKe,m.multiplyByScalar(n[1],2,o),m.subtract(o,n[2],o),m.subtract(o,n[0],o),m.multiplyByScalar(o,.5,o)),!f(r))){let s=n.length-1;r=DKe,m.multiplyByScalar(n[s-1],2,r),m.subtract(n[s],r,r),m.add(r,n[s-2],r),m.multiplyByScalar(r,.5,r)}this._times=i,this._points=n,this._firstTangent=m.clone(o),this._lastTangent=m.clone(r),this._evaluateFunction=SKe(this),this._lastTimeIndex=0}Object.defineProperties(Og.prototype,{times:{get:function(){return this._times}},points:{get:function(){return this._points}},firstTangent:{get:function(){return this._firstTangent}},lastTangent:{get:function(){return this._lastTangent}}});Og.catmullRomCoefficientMatrix=new N(-.5,1,-.5,0,1.5,-2.5,0,1,-1.5,2,.5,0,.5,-.5,0,0);Og.prototype.findTimeInterval=to.prototype.findTimeInterval;Og.prototype.wrapTime=to.prototype.wrapTime;Og.prototype.clampTime=to.prototype.clampTime;Og.prototype.evaluate=function(t,n){return this._evaluateFunction(t,n)};var Wfe=Og;var z3={};z3.clipTriangleAtAxisAlignedThreshold=function(t,n,i,o,r,s){f(s)?s.length=0:s=[];let a,c,l;n?(a=i<t,c=o<t,l=r<t):(a=i>t,c=o>t,l=r>t);let u=a+c+l,d,h,_,y,p,C;return u===1?a?(d=(t-i)/(o-i),h=(t-i)/(r-i),s.push(1),s.push(2),h!==1&&(s.push(-1),s.push(0),s.push(2),s.push(h)),d!==1&&(s.push(-1),s.push(0),s.push(1),s.push(d))):c?(_=(t-o)/(r-o),y=(t-o)/(i-o),s.push(2),s.push(0),y!==1&&(s.push(-1),s.push(1),s.push(0),s.push(y)),_!==1&&(s.push(-1),s.push(1),s.push(2),s.push(_))):l&&(p=(t-r)/(i-r),C=(t-r)/(o-r),s.push(0),s.push(1),C!==1&&(s.push(-1),s.push(2),s.push(1),s.push(C)),p!==1&&(s.push(-1),s.push(2),s.push(0),s.push(p))):u===2?!a&&i!==t?(y=(t-o)/(i-o),p=(t-r)/(i-r),s.push(0),s.push(-1),s.push(1),s.push(0),s.push(y),s.push(-1),s.push(2),s.push(0),s.push(p)):!c&&o!==t?(C=(t-r)/(o-r),d=(t-i)/(o-i),s.push(1),s.push(-1),s.push(2),s.push(1),s.push(C),s.push(-1),s.push(0),s.push(1),s.push(d)):!l&&r!==t&&(h=(t-i)/(r-i),_=(t-o)/(r-o),s.push(2),s.push(-1),s.push(0),s.push(2),s.push(h),s.push(-1),s.push(1),s.push(2),s.push(_)):u!==3&&(s.push(0),s.push(1),s.push(2)),s};z3.computeBarycentricCoordinates=function(t,n,i,o,r,s,a,c,l){let u=i-a,d=a-r,h=s-c,_=o-c,y=1/(h*u+d*_),p=n-c,C=t-a,x=(h*C+d*p)*y,T=(-_*C+u*p)*y,E=1-x-T;return f(l)?(l.x=x,l.y=T,l.z=E,l):new m(x,T,E)};z3.computeLineSegmentLineSegmentIntersection=function(t,n,i,o,r,s,a,c,l){let u=(a-r)*(n-s)-(c-s)*(t-r),d=(i-t)*(n-s)-(o-n)*(t-r),h=(c-s)*(i-t)-(a-r)*(o-n);if(h===0)return;let _=u/h,y=d/h;if(_>=0&&_<=1&&y>=0&&y<=1)return f(l)||(l=new W),l.x=t+_*(i-t),l.y=n+_*(o-n),l};var Rg=z3;function Mg(t){this._quantizedVertices=t.quantizedVertices,this._encodedNormals=t.encodedNormals,this._indices=t.indices,this._minimumHeight=t.minimumHeight,this._maximumHeight=t.maximumHeight,this._boundingSphere=t.boundingSphere,this._orientedBoundingBox=t.orientedBoundingBox,this._horizonOcclusionPoint=t.horizonOcclusionPoint,this._credits=t.credits;let n=this._quantizedVertices.length/3,i=this._uValues=this._quantizedVertices.subarray(0,n),o=this._vValues=this._quantizedVertices.subarray(n,2*n);this._heightValues=this._quantizedVertices.subarray(2*n,3*n);function r(a,c){return o[a]-o[c]}function s(a,c){return i[a]-i[c]}this._westIndices=G3(t.westIndices,r,n),this._southIndices=G3(t.southIndices,s,n),this._eastIndices=G3(t.eastIndices,r,n),this._northIndices=G3(t.northIndices,s,n),this._westSkirtHeight=t.westSkirtHeight,this._southSkirtHeight=t.southSkirtHeight,this._eastSkirtHeight=t.eastSkirtHeight,this._northSkirtHeight=t.northSkirtHeight,this._childTileMask=A(t.childTileMask,15),this._createdByUpsampling=A(t.createdByUpsampling,!1),this._waterMask=t.waterMask,this._mesh=void 0}Object.defineProperties(Mg.prototype,{credits:{get:function(){return this._credits}},waterMask:{get:function(){return this._waterMask}},childTileMask:{get:function(){return this._childTileMask}},canUpsample:{get:function(){return f(this._mesh)}}});var H3=[];function G3(t,n,i){H3.length=t.length;let o=!1;for(let r=0,s=t.length;r<s;++r)H3[r]=t[r],o=o||r>0&&n(t[r-1],t[r])>0;return o?(H3.sort(n),Ne.createTypedArray(i,H3)):t}var jfe="createVerticesFromQuantizedTerrainMesh",vKe=new fi(jfe),PKe=new fi(jfe,Rh.maximumAsynchronousTasks);Mg.prototype.createMesh=function(t){t=A(t,A.EMPTY_OBJECT);let n=t.tilingScheme,i=t.x,o=t.y,r=t.level,s=A(t.exaggeration,1),a=A(t.exaggerationRelativeHeight,0),c=A(t.throttle,!0),l=n.ellipsoid,u=n.tileXYToRectangle(i,o,r),h=(c?PKe:vKe).scheduleTask({minimumHeight:this._minimumHeight,maximumHeight:this._maximumHeight,quantizedVertices:this._quantizedVertices,octEncodedNormals:this._encodedNormals,includeWebMercatorT:!0,indices:this._indices,westIndices:this._westIndices,southIndices:this._southIndices,eastIndices:this._eastIndices,northIndices:this._northIndices,westSkirtHeight:this._westSkirtHeight,southSkirtHeight:this._southSkirtHeight,eastSkirtHeight:this._eastSkirtHeight,northSkirtHeight:this._northSkirtHeight,rectangle:u,relativeToCenter:this._boundingSphere.center,ellipsoid:l,exaggeration:s,exaggerationRelativeHeight:a});if(!f(h))return;let _=this;return Promise.resolve(h).then(function(y){let p=_._quantizedVertices.length/3,C=p+_._westIndices.length+_._southIndices.length+_._eastIndices.length+_._northIndices.length,x=Ne.createTypedArray(C,y.indices),T=new Float32Array(y.vertices),E=y.center,S=y.minimumHeight,w=y.maximumHeight,D=_._boundingSphere,I=_._orientedBoundingBox,O=A(m.clone(y.occludeePointInScaledSpace),_._horizonOcclusionPoint),M=y.vertexStride,L=Tc.clone(y.encoding);return _._mesh=new hd(E,T,x,y.indexCountWithoutSkirts,p,S,w,D,O,M,I,L,y.westIndicesSouthToNorth,y.southIndicesEastToWest,y.eastIndicesNorthToSouth,y.northIndicesWestToEast),_._quantizedVertices=void 0,_._encodedNormals=void 0,_._indices=void 0,_._uValues=void 0,_._vValues=void 0,_._heightValues=void 0,_._westIndices=void 0,_._southIndices=void 0,_._eastIndices=void 0,_._northIndices=void 0,_._mesh})};var IKe=new fi("upsampleQuantizedTerrainMesh",Rh.maximumAsynchronousTasks);Mg.prototype.upsample=function(t,n,i,o,r,s,a){let c=this._mesh;if(!f(this._mesh))return;let l=n*2!==r,u=i*2===s,d=t.ellipsoid,h=t.tileXYToRectangle(r,s,a),_=IKe.scheduleTask({vertices:c.vertices,vertexCountWithoutSkirts:c.vertexCountWithoutSkirts,indices:c.indices,indexCountWithoutSkirts:c.indexCountWithoutSkirts,encoding:c.encoding,minimumHeight:this._minimumHeight,maximumHeight:this._maximumHeight,isEastChild:l,isNorthChild:u,childRectangle:h,ellipsoid:d});if(!f(_))return;let y=Math.min(this._westSkirtHeight,this._eastSkirtHeight);y=Math.min(y,this._southSkirtHeight),y=Math.min(y,this._northSkirtHeight);let p=l?y*.5:this._westSkirtHeight,C=u?y*.5:this._southSkirtHeight,x=l?this._eastSkirtHeight:y*.5,T=u?this._northSkirtHeight:y*.5,E=this._credits;return Promise.resolve(_).then(function(S){let w=new Uint16Array(S.vertices),D=Ne.createTypedArray(w.length/3,S.indices),I;return f(S.encodedNormals)&&(I=new Uint8Array(S.encodedNormals)),new Mg({quantizedVertices:w,indices:D,encodedNormals:I,minimumHeight:S.minimumHeight,maximumHeight:S.maximumHeight,boundingSphere:ae.clone(S.boundingSphere),orientedBoundingBox:_i.clone(S.orientedBoundingBox),horizonOcclusionPoint:m.clone(S.horizonOcclusionPoint),westIndices:S.westIndices,southIndices:S.southIndices,eastIndices:S.eastIndices,northIndices:S.northIndices,westSkirtHeight:p,southSkirtHeight:C,eastSkirtHeight:x,northSkirtHeight:T,childTileMask:0,credits:E,createdByUpsampling:!0})})};var o7=32767,qfe=new m;Mg.prototype.interpolateHeight=function(t,n,i){let o=B.clamp((n-t.west)/t.width,0,1);o*=o7;let r=B.clamp((i-t.south)/t.height,0,1);return r*=o7,f(this._mesh)?MKe(this,o,r):LKe(this,o,r)};function Yfe(t,n,i,o,r,s,a,c){let l=Math.min(i,r,a),u=Math.max(i,r,a),d=Math.min(o,s,c),h=Math.max(o,s,c);return t>=l&&t<=u&&n>=d&&n<=h}var BKe=new W,OKe=new W,RKe=new W;function MKe(t,n,i){let o=t._mesh,r=o.vertices,s=o.encoding,a=o.indices;for(let c=0,l=a.length;c<l;c+=3){let u=a[c],d=a[c+1],h=a[c+2],_=s.decodeTextureCoordinates(r,u,BKe),y=s.decodeTextureCoordinates(r,d,OKe),p=s.decodeTextureCoordinates(r,h,RKe);if(Yfe(n,i,_.x,_.y,y.x,y.y,p.x,p.y)){let C=Rg.computeBarycentricCoordinates(n,i,_.x,_.y,y.x,y.y,p.x,p.y,qfe);if(C.x>=-1e-15&&C.y>=-1e-15&&C.z>=-1e-15){let x=s.decodeHeight(r,u),T=s.decodeHeight(r,d),E=s.decodeHeight(r,h);return C.x*x+C.y*T+C.z*E}}}}function LKe(t,n,i){let o=t._uValues,r=t._vValues,s=t._heightValues,a=t._indices;for(let c=0,l=a.length;c<l;c+=3){let u=a[c],d=a[c+1],h=a[c+2],_=o[u],y=o[d],p=o[h],C=r[u],x=r[d],T=r[h];if(Yfe(n,i,_,C,y,x,p,T)){let E=Rg.computeBarycentricCoordinates(n,i,_,C,y,x,p,T,qfe);if(E.x>=-1e-15&&E.y>=-1e-15&&E.z>=-1e-15){let S=E.x*s[u]+E.y*s[d]+E.z*s[h];return B.lerp(t._minimumHeight,t._maximumHeight,S/o7)}}}}Mg.prototype.isChildAvailable=function(t,n,i,o){let r=2;return i!==t*2&&++r,o!==n*2&&(r-=2),(this._childTileMask&1<<r)!==0};Mg.prototype.wasCreatedByUpsampling=function(){return this._createdByUpsampling};var pE=Mg;function FKe(t){this.resource=t.resource,this.version=t.version,this.isHeightmap=t.isHeightmap,this.tileUrlTemplates=t.tileUrlTemplates,this.availability=t.availability,this.hasVertexNormals=t.hasVertexNormals,this.hasWaterMask=t.hasWaterMask,this.hasMetadata=t.hasMetadata,this.availabilityLevels=t.availabilityLevels,this.availabilityTilesLoaded=t.availabilityTilesLoaded,this.littleEndianExtensionSize=t.littleEndianExtensionSize,this.availabilityPromiseCache={}}function eA(t){this._heightmapWidth=65,this._heightmapStructure=void 0,this._hasWaterMask=!1,this._hasVertexNormals=!1,this._ellipsoid=t.ellipsoid,this._requestVertexNormals=A(t.requestVertexNormals,!1),this._requestWaterMask=A(t.requestWaterMask,!1),this._requestMetadata=A(t.requestMetadata,!0),this._errorEvent=new Ae;let n=t.credit;typeof n=="string"&&(n=new Jt(n)),this._credit=n,this._availability=void 0,this._ready=!1,this._tileCredits=void 0;let i=this,o,r,s,a=this._layers=[],c="",l=[],u=0;this._readyPromise=Promise.resolve(t.url).then(function(C){let x=Ie.createIfNeeded(C);return x.appendForwardSlash(),o=x,r=o.getDerivedResource({url:"layer.json"}),i._tileCredits=x.credits,p()});function d(C){let x;if(!C.format)return x="The tile format is not specified in the layer.json file.",s=qn.reportError(s,i,i._errorEvent,x),s.retry?p():Promise.reject(new he(x));if(!C.tiles||C.tiles.length===0)return x="The layer.json file does not specify any tile URL templates.",s=qn.reportError(s,i,i._errorEvent,x),s.retry?p():Promise.reject(new he(x));let T=!1,E=!1,S=!1,w=!0,D=!1;if(C.format==="heightmap-1.0")D=!0,f(i._heightmapStructure)||(i._heightmapStructure={heightScale:1/5,heightOffset:-1e3,elementsPerHeight:1,stride:1,elementMultiplier:256,isBigEndian:!1,lowestEncodedHeight:0,highestEncodedHeight:256*256-1}),E=!0,i._requestWaterMask=!0;else if(C.format.indexOf("quantized-mesh-1.")!==0)return x=`The tile format "${C.format}" is invalid or not supported.`,s=qn.reportError(s,i,i._errorEvent,x),s.retry?p():Promise.reject(new he(x));let I=C.tiles,O=C.maxzoom;if(u=Math.max(u,O),!C.projection||C.projection==="EPSG:4326")i._tilingScheme=new Wi({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:1,ellipsoid:i._ellipsoid});else if(C.projection==="EPSG:3857")i._tilingScheme=new Xr({numberOfLevelZeroTilesX:1,numberOfLevelZeroTilesY:1,ellipsoid:i._ellipsoid});else return x=`The projection "${C.projection}" is invalid or not supported.`,s=qn.reportError(s,i,i._errorEvent,x),s.retry?p():Promise.reject(new he(x));if(i._levelZeroMaximumGeometricError=Yr.getEstimatedLevelZeroGeometricErrorForAHeightmap(i._tilingScheme.ellipsoid,i._heightmapWidth,i._tilingScheme.getNumberOfXTilesAtLevel(0)),!C.scheme||C.scheme==="tms"||C.scheme==="slippyMap")i._scheme=C.scheme;else return x=`The scheme "${C.scheme}" is invalid or not supported.`,s=qn.reportError(s,i,i._errorEvent,x),s.retry?p():Promise.reject(new he(x));let M;f(C.extensions)&&C.extensions.indexOf("octvertexnormals")!==-1?T=!0:f(C.extensions)&&C.extensions.indexOf("vertexnormals")!==-1&&(T=!0,w=!1),f(C.extensions)&&C.extensions.indexOf("watermask")!==-1&&(E=!0),f(C.extensions)&&C.extensions.indexOf("metadata")!==-1&&(S=!0);let L=C.metadataAvailability,F=C.available,g;if(f(F)&&!f(L)){g=new Mh(i._tilingScheme,F.length);for(let v=0;v<F.length;++v){let P=F[v],R=i._tilingScheme.getNumberOfYTilesAtLevel(v);f(l[v])||(l[v]=[]);for(let V=0;V<P.length;++V){let H=P[V],U=R-H.endY-1,G=R-H.startY-1;l[v].push([H.startX,U,H.endX,G]),g.addAvailableTileRange(v,H.startX,U,H.endX,G)}}}else f(L)&&(M=new Mh(i._tilingScheme,O),g=new Mh(i._tilingScheme,O),l[0]=[[0,0,1,0]],g.addAvailableTileRange(0,0,0,1,0));i._hasWaterMask=i._hasWaterMask||E,i._hasVertexNormals=i._hasVertexNormals||T,i._hasMetadata=i._hasMetadata||S,f(C.attribution)&&(c.length>0&&(c+=" "),c+=C.attribution),a.push(new FKe({resource:o,version:C.version,isHeightmap:D,tileUrlTemplates:I,availability:g,hasVertexNormals:T,hasWaterMask:E,hasMetadata:S,availabilityLevels:L,availabilityTilesLoaded:M,littleEndianExtensionSize:w}));let b=C.parentUrl;if(f(b)){if(!f(g))return console.log("A layer.json can't have a parentUrl if it does't have an available array."),Promise.resolve(!0);o=o.getDerivedResource({url:b}),o.appendForwardSlash(),r=o.getDerivedResource({url:"layer.json"});let v=r.fetchJson();return Promise.resolve(v).then(d).catch(h)}return Promise.resolve(!0)}function h(C){let x=`An error occurred while accessing ${r.url}.`;return s=qn.reportError(s,i,i._errorEvent,x),s.retry?p():Promise.reject(new he(x))}function _(C){return d(C).then(function(){if(f(s))return;let x=l.length;if(x>0){let T=i._availability=new Mh(i._tilingScheme,u);for(let E=0;E<x;++E){let S=l[E];for(let w=0;w<S.length;++w){let D=S[w];T.addAvailableTileRange(E,D[0],D[1],D[2],D[3])}}}if(c.length>0){let T=new Jt(c);f(i._tileCredits)?i._tileCredits.push(T):i._tileCredits=[T]}return i._ready=!0,Promise.resolve(!0)})}function y(C){return f(C)&&C.statusCode===404?_({tilejson:"2.1.0",format:"heightmap-1.0",version:"1.0.0",scheme:"tms",tiles:["{z}/{x}/{y}.terrain?v={version}"]}):h(C)}function p(){return Promise.resolve(r.fetchJson()).then(_).catch(y)}}var r7={OCT_VERTEX_NORMALS:1,WATER_MASK:2,METADATA:4};function Xfe(t){return!f(t)||t.length===0?{Accept:"application/vnd.quantized-mesh,application/octet-stream;q=0.9,*/*;q=0.01"}:{Accept:`application/vnd.quantized-mesh;extensions=${t.join("-")},application/octet-stream;q=0.9,*/*;q=0.01`}}function NKe(t,n,i,o,r){let s=new Uint16Array(n,0,t._heightmapWidth*t._heightmapWidth);return new ka({buffer:s,childTileMask:new Uint8Array(n,s.byteLength,1)[0],waterMask:new Uint8Array(n,s.byteLength+1,n.byteLength-s.byteLength-1),width:t._heightmapWidth,height:t._heightmapWidth,structure:t._heightmapStructure,credits:t._tileCredits})}function VKe(t,n,i,o,r,s){let a=s.littleEndianExtensionSize,c=0,l=3,u=l+1,d=Float64Array.BYTES_PER_ELEMENT*l,h=Float64Array.BYTES_PER_ELEMENT*u,_=3,y=Uint16Array.BYTES_PER_ELEMENT*_,p=3,C=Uint16Array.BYTES_PER_ELEMENT,x=C*p,T=new DataView(n),E=new m(T.getFloat64(c,!0),T.getFloat64(c+8,!0),T.getFloat64(c+16,!0));c+=d;let S=T.getFloat32(c,!0);c+=Float32Array.BYTES_PER_ELEMENT;let w=T.getFloat32(c,!0);c+=Float32Array.BYTES_PER_ELEMENT;let D=new ae(new m(T.getFloat64(c,!0),T.getFloat64(c+8,!0),T.getFloat64(c+16,!0)),T.getFloat64(c+d,!0));c+=h;let I=new m(T.getFloat64(c,!0),T.getFloat64(c+8,!0),T.getFloat64(c+16,!0));c+=d;let O=T.getUint32(c,!0);c+=Uint32Array.BYTES_PER_ELEMENT;let M=new Uint16Array(n,c,O*3);c+=O*y,O>64*1024&&(C=Uint32Array.BYTES_PER_ELEMENT,x=C*p);let L=M.subarray(0,O),F=M.subarray(O,2*O),g=M.subarray(O*2,3*O);zn.zigZagDeltaDecode(L,F,g),c%C!==0&&(c+=C-c%C);let b=T.getUint32(c,!0);c+=Uint32Array.BYTES_PER_ELEMENT;let v=Ne.createTypedArrayFromArrayBuffer(O,n,c,b*p);c+=b*x;let P=0,R=v.length;for(let re=0;re<R;++re){let fe=v[re];v[re]=P-fe,fe===0&&++P}let V=T.getUint32(c,!0);c+=Uint32Array.BYTES_PER_ELEMENT;let H=Ne.createTypedArrayFromArrayBuffer(O,n,c,V);c+=V*C;let U=T.getUint32(c,!0);c+=Uint32Array.BYTES_PER_ELEMENT;let G=Ne.createTypedArrayFromArrayBuffer(O,n,c,U);c+=U*C;let k=T.getUint32(c,!0);c+=Uint32Array.BYTES_PER_ELEMENT;let X=Ne.createTypedArrayFromArrayBuffer(O,n,c,k);c+=k*C;let Y=T.getUint32(c,!0);c+=Uint32Array.BYTES_PER_ELEMENT;let K=Ne.createTypedArrayFromArrayBuffer(O,n,c,Y);c+=Y*C;let j,Z;for(;c<T.byteLength;){let re=T.getUint8(c,!0);c+=Uint8Array.BYTES_PER_ELEMENT;let fe=T.getUint32(c,a);if(c+=Uint32Array.BYTES_PER_ELEMENT,re===r7.OCT_VERTEX_NORMALS&&t._requestVertexNormals)j=new Uint8Array(n,c,O*2);else if(re===r7.WATER_MASK&&t._requestWaterMask)Z=new Uint8Array(n,c,fe);else if(re===r7.METADATA&&t._requestMetadata){let ge=T.getUint32(c,!0);if(ge>0){let Be=Ko(new Uint8Array(n),c+Uint32Array.BYTES_PER_ELEMENT,ge).available;if(f(Be))for(let ke=0;ke<Be.length;++ke){let qe=i+ke+1,Nt=Be[ke],Wt=t._tilingScheme.getNumberOfYTilesAtLevel(qe);for(let un=0;un<Nt.length;++un){let _t=Nt[un],Rn=Wt-_t.endY-1,oi=Wt-_t.startY-1;t.availability.addAvailableTileRange(qe,_t.startX,Rn,_t.endX,oi),s.availability.addAvailableTileRange(qe,_t.startX,Rn,_t.endX,oi)}}}s.availabilityTilesLoaded.addAvailableTileRange(i,o,r,o,r)}c+=fe}let Q=t.getLevelMaximumGeometricError(i)*5,me=t._tilingScheme.tileXYToRectangle(o,r,i),_e=_i.fromRectangle(me,S,w,t._tilingScheme.ellipsoid);return new pE({center:E,minimumHeight:S,maximumHeight:w,boundingSphere:D,orientedBoundingBox:_e,horizonOcclusionPoint:I,quantizedVertices:M,encodedNormals:j,indices:v,westIndices:H,southIndices:G,eastIndices:X,northIndices:K,westSkirtHeight:Q,southSkirtHeight:Q,eastSkirtHeight:Q,northSkirtHeight:Q,childTileMask:t.availability.computeChildMaskForTile(i,o,r),waterMask:Z,credits:t._tileCredits})}eA.prototype.requestTileGeometry=function(t,n,i,o){let r=this._layers,s,a=r.length;if(a===1)s=r[0];else for(let c=0;c<a;++c){let l=r[c];if(!f(l.availability)||l.availability.isTileAvailable(i,t,n)){s=l;break}}return Kfe(this,t,n,i,s,o)};function Kfe(t,n,i,o,r,s){if(!f(r))return Promise.reject(new he("Terrain tile doesn't exist"));let a=r.tileUrlTemplates;if(a.length===0)return;let c;!t._scheme||t._scheme==="tms"?c=t._tilingScheme.getNumberOfYTilesAtLevel(o)-i-1:c=i;let l=[];t._requestVertexNormals&&r.hasVertexNormals&&l.push(r.littleEndianExtensionSize?"octvertexnormals":"vertexnormals"),t._requestWaterMask&&r.hasWaterMask&&l.push("watermask"),t._requestMetadata&&r.hasMetadata&&l.push("metadata");let u,d,h=a[(n+c+o)%a.length],_=r.resource;f(_._ionEndpoint)&&!f(_._ionEndpoint.externalType)?(l.length!==0&&(d={extensions:l.join("-")}),u=Xfe(void 0)):u=Xfe(l);let y=_.getDerivedResource({url:h,templateValues:{version:r.version,z:o,x:n,y:c},queryParameters:d,headers:u,request:s}).fetchArrayBuffer();if(!!f(y))return y.then(function(p){return f(p)?f(t._heightmapStructure)?NKe(t,p,o,n,i):VKe(t,p,o,n,i,r):Promise.reject(new he("Mesh buffer doesn't exist."))})}Object.defineProperties(eA.prototype,{errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){return this._credit}},tilingScheme:{get:function(){return this._tilingScheme}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise}},hasWaterMask:{get:function(){return this._hasWaterMask&&this._requestWaterMask}},hasVertexNormals:{get:function(){return this._hasVertexNormals&&this._requestVertexNormals}},hasMetadata:{get:function(){return this._hasMetadata&&this._requestMetadata}},requestVertexNormals:{get:function(){return this._requestVertexNormals}},requestWaterMask:{get:function(){return this._requestWaterMask}},requestMetadata:{get:function(){return this._requestMetadata}},availability:{get:function(){return this._availability}}});eA.prototype.getLevelMaximumGeometricError=function(t){return this._levelZeroMaximumGeometricError/(1<<t)};eA.prototype.getTileDataAvailable=function(t,n,i){if(!f(this._availability))return;if(i>this._availability._maximumLevel)return!1;if(this._availability.isTileAvailable(i,t,n))return!0;if(!this._hasMetadata)return!1;let o=this._layers,r=o.length;for(let s=0;s<r;++s)if(Jfe(this,t,n,i,o[s],s===0).result)return;return!1};eA.prototype.loadTileDataAvailability=function(t,n,i){if(!f(this._availability)||i>this._availability._maximumLevel||this._availability.isTileAvailable(i,t,n)||!this._hasMetadata)return;let o=this._layers,r=o.length;for(let s=0;s<r;++s){let a=Jfe(this,t,n,i,o[s],s===0);if(f(a.promise))return a.promise}};function s7(t,n,i,o){if(o===0)return;let r=t.availabilityLevels,s=o%r===0?o-r:(o/r|0)*r,a=1<<o-s,c=n/a|0,l=i/a|0;return{level:s,x:c,y:l}}function Jfe(t,n,i,o,r,s){if(!f(r.availabilityLevels))return{result:!1};let a,c=function(){delete r.availabilityPromiseCache[a]},l=r.availabilityTilesLoaded,u=r.availability,d=s7(r,n,i,o);for(;f(d);){if(u.isTileAvailable(d.level,d.x,d.y)&&!l.isTileAvailable(d.level,d.x,d.y)){let h;if(!s&&(a=`${d.level}-${d.x}-${d.y}`,h=r.availabilityPromiseCache[a],!f(h))){let _=new qo({throttle:!1,throttleByServer:!0,type:Qr.TERRAIN});h=Kfe(t,d.x,d.y,d.level,r,_),f(h)&&(r.availabilityPromiseCache[a]=h,h.then(c))}return{result:!0,promise:h}}d=s7(r,d.x,d.y,d.level)}return{result:!1}}eA._getAvailabilityTile=s7;var W3=eA;function gp(t){t=A(t,A.EMPTY_OBJECT);let n=t.radius,i={center:t.center,semiMajorAxis:n,semiMinorAxis:n,ellipsoid:t.ellipsoid,height:t.height,extrudedHeight:t.extrudedHeight,granularity:t.granularity,vertexFormat:t.vertexFormat,stRotation:t.stRotation,shadowVolume:t.shadowVolume};this._ellipseGeometry=new il(i),this._workerName="createCircleGeometry"}gp.packedLength=il.packedLength;gp.pack=function(t,n,i){return il.pack(t._ellipseGeometry,n,i)};var kKe=new il({center:new m,semiMajorAxis:1,semiMinorAxis:1}),Ua={center:new m,radius:void 0,ellipsoid:oe.clone(oe.UNIT_SPHERE),height:void 0,extrudedHeight:void 0,granularity:void 0,vertexFormat:new De,stRotation:void 0,semiMajorAxis:void 0,semiMinorAxis:void 0,shadowVolume:void 0};gp.unpack=function(t,n,i){let o=il.unpack(t,n,kKe);return Ua.center=m.clone(o._center,Ua.center),Ua.ellipsoid=oe.clone(o._ellipsoid,Ua.ellipsoid),Ua.height=o._height,Ua.extrudedHeight=o._extrudedHeight,Ua.granularity=o._granularity,Ua.vertexFormat=De.clone(o._vertexFormat,Ua.vertexFormat),Ua.stRotation=o._stRotation,Ua.shadowVolume=o._shadowVolume,f(i)?(Ua.semiMajorAxis=o._semiMajorAxis,Ua.semiMinorAxis=o._semiMinorAxis,i._ellipseGeometry=new il(Ua),i):(Ua.radius=o._semiMajorAxis,new gp(Ua))};gp.createGeometry=function(t){return il.createGeometry(t._ellipseGeometry)};gp.createShadowVolume=function(t,n,i){let o=t._ellipseGeometry._granularity,r=t._ellipseGeometry._ellipsoid,s=n(o,r),a=i(o,r);return new gp({center:t._ellipseGeometry._center,radius:t._ellipseGeometry._semiMajorAxis,ellipsoid:r,stRotation:t._ellipseGeometry._stRotation,granularity:o,extrudedHeight:s,height:a,vertexFormat:De.POSITION_ONLY,shadowVolume:!0})};Object.defineProperties(gp.prototype,{rectangle:{get:function(){return this._ellipseGeometry.rectangle}},textureCoordinateRotationPoints:{get:function(){return this._ellipseGeometry.textureCoordinateRotationPoints}}});var Zfe=gp;function _E(t){t=A(t,A.EMPTY_OBJECT);let n=t.radius,i={center:t.center,semiMajorAxis:n,semiMinorAxis:n,ellipsoid:t.ellipsoid,height:t.height,extrudedHeight:t.extrudedHeight,granularity:t.granularity,numberOfVerticalLines:t.numberOfVerticalLines};this._ellipseGeometry=new Wu(i),this._workerName="createCircleOutlineGeometry"}_E.packedLength=Wu.packedLength;_E.pack=function(t,n,i){return Wu.pack(t._ellipseGeometry,n,i)};var UKe=new Wu({center:new m,semiMajorAxis:1,semiMinorAxis:1}),Xl={center:new m,radius:void 0,ellipsoid:oe.clone(oe.UNIT_SPHERE),height:void 0,extrudedHeight:void 0,granularity:void 0,numberOfVerticalLines:void 0,semiMajorAxis:void 0,semiMinorAxis:void 0};_E.unpack=function(t,n,i){let o=Wu.unpack(t,n,UKe);return Xl.center=m.clone(o._center,Xl.center),Xl.ellipsoid=oe.clone(o._ellipsoid,Xl.ellipsoid),Xl.height=o._height,Xl.extrudedHeight=o._extrudedHeight,Xl.granularity=o._granularity,Xl.numberOfVerticalLines=o._numberOfVerticalLines,f(i)?(Xl.semiMajorAxis=o._semiMajorAxis,Xl.semiMinorAxis=o._semiMinorAxis,i._ellipseGeometry=new Wu(Xl),i):(Xl.radius=o._semiMajorAxis,new _E(Xl))};_E.createGeometry=function(t){return Wu.createGeometry(t._ellipseGeometry)};var Qfe=_E;var c7=yo(gl(),1);var a7,$fe="",j3={};j3.defaultAccessToken=$fe;j3.defaultServer=new Ie({url:"https://api.cesium.com/"});j3.getDefaultTokenCredit=function(t){if(t===$fe){if(!f(a7)){let n=`<b>             This application is using Cesium's default ion access token. Please assign <i>Cesium.Ion.defaultAccessToken</i>             with an access token from your ion account before making any Cesium API calls.             You can sign up for a free ion account at <a href="https://cesium.com">https://cesium.com</a>.</b>`;a7=new Jt(n,!0)}return a7}};var Lh=j3;function bc(t,n){let i,o=t.externalType,r=f(o);if(!r)i={url:t.url,retryAttempts:1,retryCallback:zKe};else if(o==="3DTILES"||o==="STK_TERRAIN_SERVER")i={url:t.options.url};else throw new he("Ion.createResource does not support external imagery assets; use IonImageryProvider instead.");Ie.call(this,i),this._ionEndpoint=t,this._ionEndpointDomain=r?void 0:new c7.default(t.url).authority(),this._ionEndpointResource=n,this._ionRoot=void 0,this._pendingPromise=void 0,this._credits=void 0,this._isExternal=r}f(Object.create)&&(bc.prototype=Object.create(Ie.prototype),bc.prototype.constructor=bc);bc.fromAssetId=function(t,n){let i=bc._createEndpointResource(t,n);return i.fetchJson().then(function(o){return new bc(o,i)})};Object.defineProperties(bc.prototype,{credits:{get:function(){return f(this._ionRoot)?this._ionRoot.credits:f(this._credits)?this._credits:(this._credits=bc.getCreditsFromEndpoint(this._ionEndpoint,this._ionEndpointResource),this._credits)}}});bc.getCreditsFromEndpoint=function(t,n){let i=t.attributions.map(Jt.getIonCredit),o=Lh.getDefaultTokenCredit(n.queryParameters.access_token);return f(o)&&i.push(Jt.clone(o)),i};bc.prototype.clone=function(t){let n=A(this._ionRoot,this);return f(t)||(t=new bc(n._ionEndpoint,n._ionEndpointResource)),t=Ie.prototype.clone.call(this,t),t._ionRoot=n,t._isExternal=this._isExternal,t};bc.prototype.fetchImage=function(t){if(!this._isExternal){let n=t;t={preferBlob:!0},f(n)&&(t.flipY=n.flipY,t.preferImageBitmap=n.preferImageBitmap)}return Ie.prototype.fetchImage.call(this,t)};bc.prototype._makeRequest=function(t){return this._isExternal||new c7.default(this.url).authority()!==this._ionEndpointDomain?Ie.prototype._makeRequest.call(this,t):(f(t.headers)||(t.headers={}),t.headers.Authorization=`Bearer ${this._ionEndpoint.accessToken}`,Ie.prototype._makeRequest.call(this,t))};bc._createEndpointResource=function(t,n){n=A(n,A.EMPTY_OBJECT);let i=A(n.server,Lh.defaultServer),o=A(n.accessToken,Lh.defaultAccessToken);i=Ie.createIfNeeded(i);let r={url:`v1/assets/${t}/endpoint`};return f(o)&&(r.queryParameters={access_token:o}),i.getDerivedResource(r)};function zKe(t,n){let i=A(t._ionRoot,t),o=i._ionEndpointResource,r=typeof Image!="undefined";return!f(n)||n.statusCode!==401&&!(r&&n.target instanceof Image)?Promise.resolve(!1):(f(i._pendingPromise)||(i._pendingPromise=o.fetchJson().then(function(s){return i._ionEndpoint=s,s}).finally(function(s){return i._pendingPromise=void 0,s})),i._pendingPromise.then(function(s){return t._ionEndpoint=s,!0}))}var Fh=bc;function HKe(t){return t=A(t,A.EMPTY_OBJECT),new W3({url:Fh.fromAssetId(1),requestVertexNormals:A(t.requestVertexNormals,!1),requestWaterMask:A(t.requestWaterMask,!1)})}var q3=HKe;function gE(t){t=A(t,A.EMPTY_OBJECT),this._callback=t.callback,this._tilingScheme=t.tilingScheme,f(this._tilingScheme)||(this._tilingScheme=new Wi({ellipsoid:A(t.ellipsoid,oe.WGS84)})),this._width=t.width,this._height=t.height;let n=Math.max(this._width,this._height);this._levelZeroMaximumGeometricError=Yr.getEstimatedLevelZeroGeometricErrorForAHeightmap(this._tilingScheme.ellipsoid,n,this._tilingScheme.getNumberOfXTilesAtLevel(0)),this._errorEvent=new Ae;let i=t.credit;typeof i=="string"&&(i=new Jt(i)),this._credit=i,this._readyPromise=Promise.resolve(!0)}Object.defineProperties(gE.prototype,{errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){return this._credit}},tilingScheme:{get:function(){return this._tilingScheme}},ready:{get:function(){return!0}},readyPromise:{get:function(){return this._readyPromise}},hasWaterMask:{get:function(){return!1}},hasVertexNormals:{get:function(){return!1}},width:{get:function(){return this._width}},height:{get:function(){return this._height}}});gE.prototype.requestTileGeometry=function(t,n,i,o){let r=this._callback(t,n,i);if(!f(r))return;let s=this._width,a=this._height;return Promise.resolve(r).then(function(c){let l=c;return Array.isArray(l)&&(l=new Float64Array(l)),new ka({buffer:l,width:s,height:a})})};gE.prototype.getLevelMaximumGeometricError=function(t){return this._levelZeroMaximumGeometricError/(1<<t)};gE.prototype.getTileDataAvailable=function(t,n,i){};gE.prototype.loadTileDataAvailability=function(t,n,i){};var ede=gE;var GKe=1953029805,WKe=2917034100;function l7(t,n){if(l7.passThroughDataForTesting)return n;let i=t.byteLength;if(i===0||i%4!==0)throw new he("The length of key must be greater than 0 and a multiple of 4.");let o=new DataView(n),r=o.getUint32(0,!0);if(r===GKe||r===WKe)return n;let s=new DataView(t),a=0,c=n.byteLength,l=c-c%8,u=i,d,h=8;for(;a<l;)for(h=(h+8)%24,d=h;a<l&&d<u;)o.setUint32(a,o.getUint32(a,!0)^s.getUint32(d,!0),!0),o.setUint32(a+4,o.getUint32(a+4,!0)^s.getUint32(d+4,!0),!0),a+=8,d+=24;if(a<c)for(d>=u&&(h=(h+8)%24,d=h);a<c;)o.setUint8(a,o.getUint8(a)^s.getUint8(d)),a++,d++}l7.passThroughDataForTesting=!1;var Y3=l7;function tde(t){this.proxy=t}tde.prototype.getURL=function(t){let n=this.proxy.indexOf("?")===-1?"?":"";return this.proxy+n+encodeURIComponent(t)};var nde=tde;function md(t){this._comparator=t.comparator,this._maximumLength=t.maximumLength,this._array=f(t.maximumLength)?new Array(t.maximumLength):[],this._length=0}Object.defineProperties(md.prototype,{length:{get:function(){return this._length}},maximumLength:{get:function(){return this._maximumLength},set:function(t){if(f(t)){for(;this._length>t;)this.removeMinimum();this._array.length=t}this._maximumLength=t}},internalArray:{get:function(){return this._array}},comparator:{get:function(){return this._comparator}}});md.prototype.clone=function(){let t=this._maximumLength,n=this._comparator,i=this._array,o=this._length,r=new md({comparator:n,maximumLength:t});r._length=o;for(let s=0;s<o;s++)r._array[s]=i[s];return r};md.prototype.reset=function(){this._length=0;let t=this._maximumLength;if(f(t))for(let n=0;n<t;n++)this._array[n]=void 0;else this._array.length=0};md.prototype.resort=function(){let t=this._length;for(let n=0;n<t;n++)ide(this,n)};md.prototype.insert=function(t){let n,i=this._maximumLength;if(f(i)){if(i===0)return;if(this._length===i){let r=this._array[0];if(this._comparator(t,r)<=0)return t;n=this.removeMinimum()}}let o=this._length;return this._array[o]=t,this._length++,ide(this,o),n};md.prototype.removeMinimum=function(){let t=this._length;if(t===0)return;this._length--;let n=this._array[0];return t>=2&&(this._array[0]=this._array[t-1],ode(this,0)),this._array[t-1]=void 0,n};md.prototype.removeMaximum=function(){let t=this._length;if(t===0)return;this._length--;let n;if(t<=2)n=this._array[t-1];else{let i=u7(this,1,2)?1:2;n=this._array[i],this._array[i]=this._array[t-1],t>=4&&ode(this,i)}return this._array[t-1]=void 0,n};md.prototype.getMinimum=function(){if(this._length!==0)return this._array[0]};md.prototype.getMaximum=function(){let t=this._length;if(t!==0)return t<=2?this._array[t-1]:this._array[u7(this,1,2)?1:2]};function X3(t,n,i){let o=t._array,r=o[n];o[n]=o[i],o[i]=r}function ND(t,n,i){return t._comparator(t._array[n],t._array[i])<0}function u7(t,n,i){return t._comparator(t._array[n],t._array[i])>0}function ide(t,n){if(n===0)return;let i=Math.floor(B.log2(n+1))%2===0,o=Math.floor((n-1)/2),r=ND(t,n,o);for(r!==i&&(X3(t,n,o),n=o);n>=3;){let s=Math.floor((n-3)/4);if(ND(t,n,s)!==r)break;X3(t,n,s),n=s}}function ode(t,n){let i=t._length,o=Math.floor(B.log2(n+1))%2===0,r;for(;(r=2*n+1)<i;){let s=r,a=r+1;if(a<i){ND(t,a,s)===o&&(s=a);let c=2*r+1,l=Math.max(Math.min(i-c,4),0);for(let u=0;u<l;u++){let d=c+u;ND(t,d,s)===o&&(s=d)}}if(ND(t,s,n)===o&&(X3(t,s,n),s!==r&&s!==a)){let c=Math.floor((s-1)/2);u7(t,s,c)===o&&X3(t,s,c)}n=s}}var rde=md;function yE(t){t=A(t,A.EMPTY_OBJECT),this._tilingScheme=t.tilingScheme,f(this._tilingScheme)||(this._tilingScheme=new Wi({ellipsoid:A(t.ellipsoid,oe.WGS84)})),this._levelZeroMaximumGeometricError=Yr.getEstimatedLevelZeroGeometricErrorForAHeightmap(this._tilingScheme.ellipsoid,64,this._tilingScheme.getNumberOfXTilesAtLevel(0)),this._errorEvent=new Ae,this._readyPromise=Promise.resolve(!0)}Object.defineProperties(yE.prototype,{errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){}},tilingScheme:{get:function(){return this._tilingScheme}},ready:{get:function(){return!0}},readyPromise:{get:function(){return this._readyPromise}},hasWaterMask:{get:function(){return!1}},hasVertexNormals:{get:function(){return!1}},availability:{get:function(){}}});yE.prototype.requestTileGeometry=function(t,n,i,o){return Promise.resolve(new ka({buffer:new Uint8Array(16*16),width:16,height:16}))};yE.prototype.getLevelMaximumGeometricError=function(t){return this._levelZeroMaximumGeometricError/(1<<t)};yE.prototype.getTileDataAvailable=function(t,n,i){};yE.prototype.loadTileDataAvailability=function(t,n,i){};var Lg=yE;function Nh(t){t=A(t,A.EMPTY_OBJECT),this.left=t.left,this._left=void 0,this.right=t.right,this._right=void 0,this.top=t.top,this._top=void 0,this.bottom=t.bottom,this._bottom=void 0,this.near=A(t.near,1),this._near=this.near,this.far=A(t.far,5e8),this._far=this.far,this._cullingVolume=new $s,this._perspectiveMatrix=new N,this._infinitePerspective=new N}function f7(t){let n=t.top,i=t.bottom,o=t.right,r=t.left,s=t.near,a=t.far;(n!==t._top||i!==t._bottom||r!==t._left||o!==t._right||s!==t._near||a!==t._far)&&(t._left=r,t._right=o,t._top=n,t._bottom=i,t._near=s,t._far=a,t._perspectiveMatrix=N.computePerspectiveOffCenter(r,o,i,n,s,a,t._perspectiveMatrix),t._infinitePerspective=N.computeInfinitePerspectiveOffCenter(r,o,i,n,s,t._infinitePerspective))}Object.defineProperties(Nh.prototype,{projectionMatrix:{get:function(){return f7(this),this._perspectiveMatrix}},infiniteProjectionMatrix:{get:function(){return f7(this),this._infinitePerspective}}});var jKe=new m,qKe=new m,YKe=new m,XKe=new m;Nh.prototype.computeCullingVolume=function(t,n,i){let o=this._cullingVolume.planes,r=this.top,s=this.bottom,a=this.right,c=this.left,l=this.near,u=this.far,d=m.cross(n,i,jKe),h=qKe;m.multiplyByScalar(n,l,h),m.add(t,h,h);let _=YKe;m.multiplyByScalar(n,u,_),m.add(t,_,_);let y=XKe;m.multiplyByScalar(d,c,y),m.add(h,y,y),m.subtract(y,t,y),m.normalize(y,y),m.cross(y,i,y),m.normalize(y,y);let p=o[0];if(f(p)||(p=o[0]=new se),p.x=y.x,p.y=y.y,p.z=y.z,p.w=-m.dot(y,t),m.multiplyByScalar(d,a,y),m.add(h,y,y),m.subtract(y,t,y),m.cross(i,y,y),m.normalize(y,y),p=o[1],f(p)||(p=o[1]=new se),p.x=y.x,p.y=y.y,p.z=y.z,p.w=-m.dot(y,t),m.multiplyByScalar(i,s,y),m.add(h,y,y),m.subtract(y,t,y),m.cross(d,y,y),m.normalize(y,y),p=o[2],f(p)||(p=o[2]=new se),p.x=y.x,p.y=y.y,p.z=y.z,p.w=-m.dot(y,t),m.multiplyByScalar(i,r,y),m.add(h,y,y),m.subtract(y,t,y),m.cross(y,d,y),m.normalize(y,y),p=o[3],f(p)||(p=o[3]=new se),p.x=y.x,p.y=y.y,p.z=y.z,p.w=-m.dot(y,t),p=o[4],f(p)||(p=o[4]=new se),p.x=n.x,p.y=n.y,p.z=n.z,p.w=-m.dot(n,h),m.negate(n,y),p=o[5],f(p)||(p=o[5]=new se),p.x=y.x,p.y=y.y,p.z=y.z,p.w=-m.dot(y,_),this.topToCull){let C=new m;m.multiplyByScalar(i,this.topToCull,C),m.add(h,C,C),m.subtract(C,t,C),m.cross(C,d,C),m.normalize(C,C);let x=this._cullingVolume.topPlaneToCull;f(x)||(x=this._cullingVolume.topPlaneToCull=new se),x.x=C.x,x.y=C.y,x.z=C.z,x.w=-m.dot(C,t)}return this._cullingVolume};Nh.prototype.getPixelDimensions=function(t,n,i,o,r){f7(this);let s=1/this.near,a=this.top*s,c=2*o*i*a/n;a=this.right*s;let l=2*o*i*a/t;return r.x=l,r.y=c,r};Nh.prototype.clone=function(t){return f(t)||(t=new Nh),t.right=this.right,t.left=this.left,t.top=this.top,t.bottom=this.bottom,t.near=this.near,t.far=this.far,t._left=void 0,t._right=void 0,t._top=void 0,t._bottom=void 0,t._near=void 0,t._far=void 0,t};Nh.prototype.equals=function(t){return f(t)&&t instanceof Nh&&this.right===t.right&&this.left===t.left&&this.top===t.top&&this.bottom===t.bottom&&this.near===t.near&&this.far===t.far};Nh.prototype.equalsEpsilon=function(t,n,i){return t===this||f(t)&&t instanceof Nh&&B.equalsEpsilon(this.right,t.right,n,i)&&B.equalsEpsilon(this.left,t.left,n,i)&&B.equalsEpsilon(this.top,t.top,n,i)&&B.equalsEpsilon(this.bottom,t.bottom,n,i)&&B.equalsEpsilon(this.near,t.near,n,i)&&B.equalsEpsilon(this.far,t.far,n,i)};var ll=Nh;function ul(t){t=A(t,A.EMPTY_OBJECT),this._offCenterFrustum=new ll,this.fov=t.fov,this._fov=void 0,this._fovy=void 0,this._sseDenominator=void 0,this.aspectRatio=t.aspectRatio,this._aspectRatio=void 0,this.near=A(t.near,1),this._near=this.near,this.far=A(t.far,5e8),this._far=this.far,this.xOffset=A(t.xOffset,0),this._xOffset=this.xOffset,this.yOffset=A(t.yOffset,0),this._yOffset=this.yOffset}ul.packedLength=6;ul.pack=function(t,n,i){return i=A(i,0),n[i++]=t.fov,n[i++]=t.aspectRatio,n[i++]=t.near,n[i++]=t.far,n[i++]=t.xOffset,n[i]=t.yOffset,n};ul.unpack=function(t,n,i){return n=A(n,0),f(i)||(i=new ul),i.fov=t[n++],i.aspectRatio=t[n++],i.near=t[n++],i.far=t[n++],i.xOffset=t[n++],i.yOffset=t[n],i};function Vh(t){let n=t._offCenterFrustum;if(t.fov!==t._fov||t.aspectRatio!==t._aspectRatio||t.near!==t._near||t.far!==t._far||t.xOffset!==t._xOffset||t.yOffset!==t._yOffset){t._aspectRatio=t.aspectRatio,t._fov=t.fov,t._fovy=t.aspectRatio<=1?t.fov:Math.atan(Math.tan(t.fov*.5)/t.aspectRatio)*2,t._near=t.near,t._far=t.far,t._sseDenominator=2*Math.tan(.5*t._fovy),t._xOffset=t.xOffset,t._yOffset=t.yOffset,n.top=t.near*Math.tan(.5*t._fovy);let i=56;i=i*Math.PI/180;let o=t.aspectRatio<=1?i:Math.atan(Math.tan(i*.5)/t.aspectRatio)*2;n.topToCull=t.near*Math.tan(.5*o),n.bottom=-n.top,n.right=t.aspectRatio*n.top,n.left=-n.right,n.near=t.near,n.far=t.far,n.right+=t.xOffset,n.left+=t.xOffset,n.top+=t.yOffset,n.bottom+=t.yOffset}}Object.defineProperties(ul.prototype,{projectionMatrix:{get:function(){return Vh(this),this._offCenterFrustum.projectionMatrix}},infiniteProjectionMatrix:{get:function(){return Vh(this),this._offCenterFrustum.infiniteProjectionMatrix}},fovy:{get:function(){return Vh(this),this._fovy}},sseDenominator:{get:function(){return Vh(this),this._sseDenominator}}});ul.prototype.computeCullingVolume=function(t,n,i){return Vh(this),this._offCenterFrustum.computeCullingVolume(t,n,i)};ul.prototype.getPixelDimensions=function(t,n,i,o,r){return Vh(this),this._offCenterFrustum.getPixelDimensions(t,n,i,o,r)};ul.prototype.clone=function(t){return f(t)||(t=new ul),t.aspectRatio=this.aspectRatio,t.fov=this.fov,t.near=this.near,t.far=this.far,t._aspectRatio=void 0,t._fov=void 0,t._near=void 0,t._far=void 0,this._offCenterFrustum.clone(t._offCenterFrustum),t};ul.prototype.equals=function(t){return!f(t)||!(t instanceof ul)?!1:(Vh(this),Vh(t),this.fov===t.fov&&this.aspectRatio===t.aspectRatio&&this._offCenterFrustum.equals(t._offCenterFrustum))};ul.prototype.equalsEpsilon=function(t,n,i){return!f(t)||!(t instanceof ul)?!1:(Vh(this),Vh(t),B.equalsEpsilon(this.fov,t.fov,n,i)&&B.equalsEpsilon(this.aspectRatio,t.aspectRatio,n,i)&&this._offCenterFrustum.equalsEpsilon(t._offCenterFrustum,n,i))};var yi=ul;var K3=0,KKe=1;function tA(t){let n=t.frustum,i=t.orientation,o=t.origin,r=A(t.vertexFormat,De.DEFAULT),s=A(t._drawNearPlane,!0),a,c;n instanceof yi?(a=K3,c=yi.packedLength):n instanceof $t&&(a=KKe,c=$t.packedLength),this._frustumType=a,this._frustum=n.clone(),this._origin=m.clone(o),this._orientation=Me.clone(i),this._drawNearPlane=s,this._vertexFormat=r,this._workerName="createFrustumGeometry",this.packedLength=2+c+m.packedLength+Me.packedLength+De.packedLength}tA.pack=function(t,n,i){i=A(i,0);let o=t._frustumType,r=t._frustum;return n[i++]=o,o===K3?(yi.pack(r,n,i),i+=yi.packedLength):($t.pack(r,n,i),i+=$t.packedLength),m.pack(t._origin,n,i),i+=m.packedLength,Me.pack(t._orientation,n,i),i+=Me.packedLength,De.pack(t._vertexFormat,n,i),i+=De.packedLength,n[i]=t._drawNearPlane?1:0,n};var JKe=new yi,ZKe=new $t,QKe=new Me,$Ke=new m,eJe=new De;tA.unpack=function(t,n,i){n=A(n,0);let o=t[n++],r;o===K3?(r=yi.unpack(t,n,JKe),n+=yi.packedLength):(r=$t.unpack(t,n,ZKe),n+=$t.packedLength);let s=m.unpack(t,n,$Ke);n+=m.packedLength;let a=Me.unpack(t,n,QKe);n+=Me.packedLength;let c=De.unpack(t,n,eJe);n+=De.packedLength;let l=t[n]===1;if(!f(i))return new tA({frustum:r,origin:s,orientation:a,vertexFormat:c,_drawNearPlane:l});let u=o===i._frustumType?i._frustum:void 0;return i._frustum=r.clone(u),i._frustumType=o,i._origin=m.clone(s,i._origin),i._orientation=Me.clone(a,i._orientation),i._vertexFormat=De.clone(c,i._vertexFormat),i._drawNearPlane=l,i};function AE(t,n,i,o,r,s,a,c){let l=t/3*2;for(let u=0;u<4;++u)f(n)&&(n[t]=s.x,n[t+1]=s.y,n[t+2]=s.z),f(i)&&(i[t]=a.x,i[t+1]=a.y,i[t+2]=a.z),f(o)&&(o[t]=c.x,o[t+1]=c.y,o[t+2]=c.z),t+=3;r[l]=0,r[l+1]=0,r[l+2]=1,r[l+3]=0,r[l+4]=1,r[l+5]=1,r[l+6]=0,r[l+7]=1}var tJe=new $,nJe=new N,d7=new N,sde=new m,ade=new m,cde=new m,iJe=new m,oJe=new m,rJe=new m,Fg=new Array(3),VD=new Array(4);VD[0]=new se(-1,-1,1,1);VD[1]=new se(1,-1,1,1);VD[2]=new se(1,1,1,1);VD[3]=new se(-1,1,1,1);var lde=new Array(4);for(let t=0;t<4;++t)lde[t]=new se;tA._computeNearFarPlanes=function(t,n,i,o,r,s,a,c){let l=$.fromQuaternion(n,tJe),u=A(s,sde),d=A(a,ade),h=A(c,cde);u=$.getColumn(l,0,u),d=$.getColumn(l,1,d),h=$.getColumn(l,2,h),m.normalize(u,u),m.normalize(d,d),m.normalize(h,h),m.negate(u,u);let _=N.computeView(t,h,d,u,nJe),y,p;if(i===K3){let C=o.projectionMatrix,x=N.multiply(C,_,d7);p=N.inverse(x,d7)}else y=N.inverseTransformation(_,d7);f(p)?(Fg[0]=o.near,Fg[1]=o.far):(Fg[0]=0,Fg[1]=o.near,Fg[2]=o.far);for(let C=0;C<2;++C)for(let x=0;x<4;++x){let T=se.clone(VD[x],lde[x]);if(f(p)){T=N.multiplyByVector(p,T,T);let E=1/T.w;m.multiplyByScalar(T,E,T),m.subtract(T,t,T),m.normalize(T,T);let S=m.dot(h,T);m.multiplyByScalar(T,Fg[C]/S,T),m.add(T,t,T)}else{f(o._offCenterFrustum)&&(o=o._offCenterFrustum);let E=Fg[C],S=Fg[C+1];T.x=(T.x*(o.right-o.left)+o.left+o.right)*.5,T.y=(T.y*(o.top-o.bottom)+o.bottom+o.top)*.5,T.z=(T.z*(E-S)-E-S)*.5,T.w=1,N.multiplyByVector(y,T,T)}r[12*C+x*3]=T.x,r[12*C+x*3+1]=T.y,r[12*C+x*3+2]=T.z}};tA.createGeometry=function(t){let n=t._frustumType,i=t._frustum,o=t._origin,r=t._orientation,s=t._drawNearPlane,a=t._vertexFormat,c=s?6:5,l=new Float64Array(3*4*6);tA._computeNearFarPlanes(o,r,n,i,l);let u=3*4*2;l[u]=l[3*4],l[u+1]=l[3*4+1],l[u+2]=l[3*4+2],l[u+3]=l[0],l[u+4]=l[1],l[u+5]=l[2],l[u+6]=l[3*3],l[u+7]=l[3*3+1],l[u+8]=l[3*3+2],l[u+9]=l[3*7],l[u+10]=l[3*7+1],l[u+11]=l[3*7+2],u+=3*4,l[u]=l[3*5],l[u+1]=l[3*5+1],l[u+2]=l[3*5+2],l[u+3]=l[3],l[u+4]=l[3+1],l[u+5]=l[3+2],l[u+6]=l[0],l[u+7]=l[1],l[u+8]=l[2],l[u+9]=l[3*4],l[u+10]=l[3*4+1],l[u+11]=l[3*4+2],u+=3*4,l[u]=l[3],l[u+1]=l[3+1],l[u+2]=l[3+2],l[u+3]=l[3*5],l[u+4]=l[3*5+1],l[u+5]=l[3*5+2],l[u+6]=l[3*6],l[u+7]=l[3*6+1],l[u+8]=l[3*6+2],l[u+9]=l[3*2],l[u+10]=l[3*2+1],l[u+11]=l[3*2+2],u+=3*4,l[u]=l[3*2],l[u+1]=l[3*2+1],l[u+2]=l[3*2+2],l[u+3]=l[3*6],l[u+4]=l[3*6+1],l[u+5]=l[3*6+2],l[u+6]=l[3*7],l[u+7]=l[3*7+1],l[u+8]=l[3*7+2],l[u+9]=l[3*3],l[u+10]=l[3*3+1],l[u+11]=l[3*3+2],s||(l=l.subarray(3*4));let d=new cn({position:new we({componentDatatype:J.DOUBLE,componentsPerAttribute:3,values:l})});if(f(a.normal)||f(a.tangent)||f(a.bitangent)||f(a.st)){let _=f(a.normal)?new Float32Array(12*c):void 0,y=f(a.tangent)?new Float32Array(3*4*c):void 0,p=f(a.bitangent)?new Float32Array(3*4*c):void 0,C=f(a.st)?new Float32Array(2*4*c):void 0,x=sde,T=ade,E=cde,S=m.negate(x,iJe),w=m.negate(T,oJe),D=m.negate(E,rJe);u=0,s&&(AE(u,_,y,p,C,D,x,T),u+=3*4),AE(u,_,y,p,C,E,S,T),u+=3*4,AE(u,_,y,p,C,S,D,T),u+=3*4,AE(u,_,y,p,C,w,D,S),u+=3*4,AE(u,_,y,p,C,x,E,T),u+=3*4,AE(u,_,y,p,C,T,E,S),f(_)&&(d.normal=new we({componentDatatype:J.FLOAT,componentsPerAttribute:3,values:_})),f(y)&&(d.tangent=new we({componentDatatype:J.FLOAT,componentsPerAttribute:3,values:y})),f(p)&&(d.bitangent=new we({componentDatatype:J.FLOAT,componentsPerAttribute:3,values:p})),f(C)&&(d.st=new we({componentDatatype:J.FLOAT,componentsPerAttribute:2,values:C}))}let h=new Uint16Array(6*c);for(let _=0;_<c;++_){let y=_*6,p=_*4;h[y]=p,h[y+1]=p+1,h[y+2]=p+2,h[y+3]=p,h[y+4]=p+2,h[y+5]=p+3}return new at({attributes:d,indices:h,primitiveType:Re.TRIANGLES,boundingSphere:ae.fromVertices(l)})};var CE=tA;var h7=0,sJe=1;function kD(t){let n=t.frustum,i=t.orientation,o=t.origin,r=A(t._drawNearPlane,!0),s,a;n instanceof yi?(s=h7,a=yi.packedLength):n instanceof $t&&(s=sJe,a=$t.packedLength),this._frustumType=s,this._frustum=n.clone(),this._origin=m.clone(o),this._orientation=Me.clone(i),this._drawNearPlane=r,this._workerName="createFrustumOutlineGeometry",this.packedLength=2+a+m.packedLength+Me.packedLength}kD.pack=function(t,n,i){i=A(i,0);let o=t._frustumType,r=t._frustum;return n[i++]=o,o===h7?(yi.pack(r,n,i),i+=yi.packedLength):($t.pack(r,n,i),i+=$t.packedLength),m.pack(t._origin,n,i),i+=m.packedLength,Me.pack(t._orientation,n,i),i+=Me.packedLength,n[i]=t._drawNearPlane?1:0,n};var aJe=new yi,cJe=new $t,lJe=new Me,uJe=new m;kD.unpack=function(t,n,i){n=A(n,0);let o=t[n++],r;o===h7?(r=yi.unpack(t,n,aJe),n+=yi.packedLength):(r=$t.unpack(t,n,cJe),n+=$t.packedLength);let s=m.unpack(t,n,uJe);n+=m.packedLength;let a=Me.unpack(t,n,lJe);n+=Me.packedLength;let c=t[n]===1;if(!f(i))return new kD({frustum:r,origin:s,orientation:a,_drawNearPlane:c});let l=o===i._frustumType?i._frustum:void 0;return i._frustum=r.clone(l),i._frustumType=o,i._origin=m.clone(s,i._origin),i._orientation=Me.clone(a,i._orientation),i._drawNearPlane=c,i};kD.createGeometry=function(t){let n=t._frustumType,i=t._frustum,o=t._origin,r=t._orientation,s=t._drawNearPlane,a=new Float64Array(3*4*2);CE._computeNearFarPlanes(o,r,n,i,a);let c=new cn({position:new we({componentDatatype:J.DOUBLE,componentsPerAttribute:3,values:a})}),l,u,d=s?2:1,h=new Uint16Array(8*(d+1)),_=s?0:1;for(;_<2;++_)l=s?_*8:0,u=_*4,h[l]=u,h[l+1]=u+1,h[l+2]=u+1,h[l+3]=u+2,h[l+4]=u+2,h[l+5]=u+3,h[l+6]=u+3,h[l+7]=u;for(_=0;_<2;++_)l=(d+_)*8,u=_*4,h[l]=u,h[l+1]=u+4,h[l+2]=u+1,h[l+3]=u+5,h[l+4]=u+2,h[l+5]=u+6,h[l+6]=u+3,h[l+7]=u+7;return new at({attributes:c,indices:h,primitiveType:Re.LINES,boundingSphere:ae.fromVertices(a)})};var J3=kD;function ude(){}ude.prototype.geocode=Ce.throwInstantiationError;var fde=ude;var fJe={SEARCH:0,AUTOCOMPLETE:1},nA=Object.freeze(fJe);function dde(){Ce.throwInstantiationError()}dde.createGeometry=function(t){Ce.throwInstantiationError()};var hde=dde;function dJe(t,n,i){let o=new Uint8ClampedArray(t.buffer),r=new ImageData(o,n,i),s=document.createElement("canvas");return s.width=n,s.height=i,s.getContext("2d").putImageData(r,0,0),s}var Z3=dJe;var yJe=yo(m7(),1);function hJe(t,n){return(t&n)!==0}var Sc=hJe;var mJe=[1,2,4,8],mde=15,pJe=16,_Je=64,gJe=128;function kh(t,n,i,o,r,s){this._bits=t,this.cnodeVersion=n,this.imageryVersion=i,this.terrainVersion=o,this.imageryProvider=r,this.terrainProvider=s,this.ancestorHasTerrain=!1,this.terrainState=void 0}kh.clone=function(t,n){return f(n)?(n._bits=t._bits,n.cnodeVersion=t.cnodeVersion,n.imageryVersion=t.imageryVersion,n.terrainVersion=t.terrainVersion,n.imageryProvider=t.imageryProvider,n.terrainProvider=t.terrainProvider):n=new kh(t._bits,t.cnodeVersion,t.imageryVersion,t.terrainVersion,t.imageryProvider,t.terrainProvider),n.ancestorHasTerrain=t.ancestorHasTerrain,n.terrainState=t.terrainState,n};kh.prototype.setParent=function(t){this.ancestorHasTerrain=t.ancestorHasTerrain||this.hasTerrain()};kh.prototype.hasSubtree=function(){return Sc(this._bits,pJe)};kh.prototype.hasImagery=function(){return Sc(this._bits,_Je)};kh.prototype.hasTerrain=function(){return Sc(this._bits,gJe)};kh.prototype.hasChildren=function(){return Sc(this._bits,mde)};kh.prototype.hasChild=function(t){return Sc(this._bits,mJe[t])};kh.prototype.getChildBitmask=function(){return this._bits&mde};var Q3=kh;function AJe(t){let n=t.length,i=new ArrayBuffer(n),o=new Uint8Array(i);for(let r=0;r<n;++r)o[r]=t.charCodeAt(r);return i}var CJe=AJe(`E\xF4\xBD\vy\xE2jE"\x92,\xCDq\xF8IFgQ\0B%\xC6\xE8a,f)\b\xC64\xDCjb%y
wmi\xD6\xF0\x9Ck\x93\xA1\xBDNu\xE0A[\xDF@V\f\xD9\xBBr\x9B\x81|3S\xEEOl\xD4q\xB0{\xC0\x7FEVZ\xADwUe\v3\x92*\xACl5\xC50s\xF83>mF8J\xB4\xDD\xF0.\xDDu\xDA\x8CDt"\xFAa"\f3"So\xAF9D\v\x8C9\xD99L\xB9\xBF\x7F\xAB\\\x8CP_\x9F"ux\xE9\x07q\x91h;\xC1\xC4\x9B\x7F\xF0<VqH\x82'UfYNe\x98u\xA3aF}a?A\0\x9F\xD7\xB44M\xCE\x87F\xB0\xD5\xB8\x8A'{\x8B\xDC+\xBBMg0\xC8\xD1\xF6\\\x8FP\xFA[/F\x9Bn5/'C.\xEB
\f^\xA5s\x1Be4\xE5l.jC'c#U\xA9?q{gC}:\xAF\xCD\xE2TU\x9C\xFDK\xC6\xE2\x9F/(\xED\xCB\\\xC6-f\x07\x88\xA7;/*"N\xB0k.\xDD\r\x95}}G\xBAC\xB2\xB2+>M\xAA>}\xE6\xCEI\x89\xC6\xE6x\fa1-\xA4O\xA5~q \x88\xEC\r1\xE8N\v\0nPh}=\b\r\x95\xA6n\xA3h\x97$[k\xF3#\xF3\xB6s\xB3\r\v@\xC0\x9F\xD8Q]\xFA".j\xDFI\0\xB9\xA0wU\xC6\xEFj\xBF{GL\x7F\x83\xEE\xDC\xDCF\x85\xA9\xADS\x07+S4\x07\xFF\x94Y\xE48\xE81\x83N\xB9XFk\xCB-#\x86\x92p\x005\x88"\xCF1\xB2&/\xE7\xC3u-6,rt\xB0#G\xB7\xD3\xD1&\x857r\xE2\0\x8CD\xCF\xDA3-\xDE\`\x86i#i*|\xCDKQ\r\x95T9w.)\xEA\x1B\xA6P\xA2j\x8FoP\x99\\>T\xFB\xEFP[\v\x07E\x89m(w7\xDB\x8EJfJo\x99 \xE5p\xE2\xB9q~\fmI-z\xFEr\xC7\xF2Y0\x8F\xBB]s\xE5\xC9 \xEAx\xEC \x90\xF0\x8A\x7FB|G\`\xB0\xBD&\xB7q\xB6\xC7\x9F\xD13\x82=\xD3\xAB\xEEc\x99\xC8+S\xA0D\\q\xC6\xCCD2O<\xCA\xC0)=R\xD3aX\xA9}e\xB4\xDC\xCF\r\xF4=\xF1\b\xA9B\xDA#	\xD8\xBF^PI\xF8M\xC0\xCBGLO\xF7{+\xD8\xC51\x92;\xB5o\xDCl\r\x92\x88\xD1\x9E\xDB?\xE2\xE9\xDA_\xD4\x84\xE2FaZ\xDEU\xCF\xA4\0\xBE\xFD\xCEg\xF1Ji\x97\xE6 H\xD8]\x7F~\xAEq N\xAE\xC0V\xA9\x91<\x82r\xE7v\xEC)I\xD6]-\x83\xE3\xDB6\xA9;f\x97\x87j\xD5\xB6=P^R\xB9K\xC7sWx\xC9\xF4.Y\x07\x95\x93o\xD0KW>''\xC7\`\xDB;\xED\x9ASD>?\x8D\x92mw\xA2
\xEB?R\xA8\xC6U^1I7\x85\xF4\xC5&-\xA9\xBF\x8B'T\xDA\xC3j \xE5*x\xB0\xD6\x90pr\xAA\x8Bh\xBD\x88\xF7_H\xB1~\xC0XL?f\xF9>\xE1e\xC0p\xA7\xCF8i\xAF\xF0VldI\x9C'\xADxtO\xC2\x87\xDEV9\0\xDAw\v\xCB-\x1B\x89\xFB5O\xF5\bQ\`\xC1
ZGM&30x\xDA\xC0\x9CFG\xE2[y\`In7gS
>\xE9\xECF9\xB2\xF14\r\xC6\x84Sun\xE1\fY\xD9\xDE)\x85{II\xA5wy\xBEIV.6\xE7\v:\xBBOb{\xD2M1\x95/\xBD8{\xA8O!\xE1\xECFpv\x95})"x\x88
\x90\xDD\x9D\\\xDA\xDEQ\xCF\xF0\xFCYRe|3\xDF\xF3H\xDA\xBB*u\xDB\`\xB2\xD4\xFC\xED\x1B\xEC\x7F5\xA8\xFF(1\x07-\xC8\xDC\x88F|\x8A["`);function pd(t){let n=t;typeof n!="string"&&!(n instanceof Ie)&&(n=t.url);let i=Ie.createIfNeeded(n);i.appendForwardSlash(),this._resource=i,this.imageryPresent=!0,this.protoImagery=void 0,this.terrainPresent=!0,this.negativeAltitudeExponentBias=32,this.negativeAltitudeThreshold=B.EPSILON12,this.providers={},this.key=void 0,this._quadPacketVersion=1,this._tileInfo={},this._subtreePromises={};let o=this;this._readyPromise=xJe(this).then(function(){return o.getQuadTreePacket("",o._quadPacketVersion)}).then(function(){return!0}).catch(function(r){let s=`An error occurred while accessing ${_de(o,"",1).url}.`;return Promise.reject(new he(s))})}Object.defineProperties(pd.prototype,{url:{get:function(){return this._resource.url}},proxy:{get:function(){return this._resource.proxy}},resource:{get:function(){return this._resource}},readyPromise:{get:function(){return this._readyPromise}}});pd.tileXYToQuadKey=function(t,n,i){let o="";for(let r=i;r>=0;--r){let s=1<<r,a=0;Sc(n,s)?Sc(t,s)&&(a|=1):(a|=2,Sc(t,s)||(a|=1)),o+=a}return o};pd.quadKeyToTileXY=function(t){let n=0,i=0,o=t.length-1;for(let r=o;r>=0;--r){let s=1<<r,a=+t[o-r];Sc(a,2)?Sc(a,1)||(n|=s):(i|=s,Sc(a,1)&&(n|=s))}return{x:n,y:i,level:o}};pd.prototype.isValid=function(t){let n=this.getTileInformationFromQuadKey(t);if(f(n))return n!==null;let i=!0,o=t,r;for(;o.length>1;)if(r=o.substring(o.length-1),o=o.substring(0,o.length-1),n=this.getTileInformationFromQuadKey(o),f(n)){!n.hasSubtree()&&!n.hasChild(parseInt(r))&&(i=!1);break}else if(n===null){i=!1;break}return i};var pde=new fi("decodeGoogleEarthEnterprisePacket");pd.prototype.getQuadTreePacket=function(t,n,i){n=A(n,1),t=A(t,"");let r=_de(this,t,n,i).fetchArrayBuffer();if(!f(r))return;let s=this._tileInfo,a=this.key;return r.then(function(c){return pde.scheduleTask({buffer:c,quadKey:t,type:"Metadata",key:a},[c]).then(function(u){let d,h=-1;if(t!==""){h=t.length+1;let p=u[t];d=s[t],d._bits|=p._bits,delete u[t]}let _=Object.keys(u);_.sort(function(p,C){return p.length-C.length});let y=_.length;for(let p=0;p<y;++p){let C=_[p];if(u[C]!==null){let T=Q3.clone(u[C]),E=C.length;if(E===h)T.setParent(d);else if(E>1){let S=s[C.substring(0,C.length-1)];T.setParent(S)}s[C]=T}else s[C]=null}})})};pd.prototype.populateSubtree=function(t,n,i,o){let r=pd.tileXYToQuadKey(t,n,i);return g7(this,r,o)};function g7(t,n,i){let o=t._tileInfo,r=n,s=o[r];if(f(s)&&(!s.hasSubtree()||s.hasChildren()))return s;for(;s===void 0&&r.length>1;)r=r.substring(0,r.length-1),s=o[r];let a,c=t._subtreePromises,l=c[r];if(f(l))return l.then(function(){return a=new qo({throttle:i.throttle,throttleByServer:i.throttleByServer,type:i.type,priorityFunction:i.priorityFunction}),g7(t,n,a)});if(!f(s)||!s.hasSubtree())return Promise.reject(new he(`Couldn't load metadata for tile ${n}`));if(l=t.getQuadTreePacket(r,s.cnodeVersion,i),!!f(l))return c[r]=l,l.then(function(){return a=new qo({throttle:i.throttle,throttleByServer:i.throttleByServer,type:i.type,priorityFunction:i.priorityFunction}),g7(t,n,a)}).finally(function(){delete c[r]})}pd.prototype.getTileInformation=function(t,n,i){let o=pd.tileXYToQuadKey(t,n,i);return this._tileInfo[o]};pd.prototype.getTileInformationFromQuadKey=function(t){return this._tileInfo[t]};function _de(t,n,i,o){return t._resource.getDerivedResource({url:`flatfile?q2-0${n}-q.${i.toString()}`,request:o})}var p7,_7;function xJe(t){let n=t._resource.getDerivedResource({url:"dbRoot.v5",queryParameters:{output:"proto"}});if(!f(_7)){let i=Qt("ThirdParty/google-earth-dbroot-parser.js"),o=window.cesiumGoogleEarthDbRootParser;_7=sC(i).then(function(){p7=window.cesiumGoogleEarthDbRootParser(yJe),f(o)?window.cesiumGoogleEarthDbRootParser=o:delete window.cesiumGoogleEarthDbRootParser})}return _7.then(function(){return n.fetchArrayBuffer()}).then(function(i){let o=p7.EncryptedDbRootProto.decode(new Uint8Array(i)),r=o.encryptionData,s=r.byteOffset,a=s+r.byteLength,c=t.key=r.buffer.slice(s,a);r=o.dbrootData,s=r.byteOffset,a=s+r.byteLength;let l=r.buffer.slice(s,a);return pde.scheduleTask({buffer:l,type:"DbRoot",key:c},[l])}).then(function(i){let o=p7.DbRootProto.decode(new Uint8Array(i.buffer));if(t.imageryPresent=A(o.imageryPresent,t.imageryPresent),t.protoImagery=o.protoImagery,t.terrainPresent=A(o.terrainPresent,t.terrainPresent),f(o.endSnippet)&&f(o.endSnippet.model)){let c=o.endSnippet.model;t.negativeAltitudeExponentBias=A(c.negativeAltitudeExponentBias,t.negativeAltitudeExponentBias),t.negativeAltitudeThreshold=A(c.compressedNegativeAltitudeThreshold,t.negativeAltitudeThreshold)}f(o.databaseVersion)&&(t._quadPacketVersion=A(o.databaseVersion.quadtreeVersion,t._quadPacketVersion));let r=t.providers,s=A(o.providerInfo,[]),a=s.length;for(let c=0;c<a;++c){let l=s[c],u=l.copyrightString;f(u)&&(r[l.providerId]=new Jt(u.value))}}).catch(function(){console.log(`Failed to retrieve ${n.url}. Using defaults.`),t.key=CJe})}var Uh=pd;function iA(t){t=A(t,A.EMPTY_OBJECT),this._buffer=t.buffer,this._credits=t.credits,this._negativeAltitudeExponentBias=t.negativeAltitudeExponentBias,this._negativeElevationThreshold=t.negativeElevationThreshold;let n=A(t.childTileMask,15),i=n&3;i|=n&4?8:0,i|=n&8?4:0,this._childTileMask=i,this._createdByUpsampling=A(t.createdByUpsampling,!1),this._skirtHeight=void 0,this._bufferType=this._buffer.constructor,this._mesh=void 0,this._minimumHeight=void 0,this._maximumHeight=void 0}Object.defineProperties(iA.prototype,{credits:{get:function(){return this._credits}},waterMask:{get:function(){}}});var Ade="createVerticesFromGoogleEarthEnterpriseBuffer",TJe=new fi(Ade),EJe=new fi(Ade,Rh.maximumAsynchronousTasks),gde=new le,y7=new le;iA.prototype.createMesh=function(t){t=A(t,A.EMPTY_OBJECT);let n=t.tilingScheme,i=t.x,o=t.y,r=t.level,s=A(t.exaggeration,1),a=A(t.exaggerationRelativeHeight,0),c=A(t.throttle,!0),l=n.ellipsoid;n.tileXYToNativeRectangle(i,o,r,gde),n.tileXYToRectangle(i,o,r,y7);let u=l.cartographicToCartesian(le.center(y7)),h=40075.16/(1<<r);this._skirtHeight=Math.min(h*8,1e3);let y=(c?EJe:TJe).scheduleTask({buffer:this._buffer,nativeRectangle:gde,rectangle:y7,relativeToCenter:u,ellipsoid:l,skirtHeight:this._skirtHeight,exaggeration:s,exaggerationRelativeHeight:a,includeWebMercatorT:!0,negativeAltitudeExponentBias:this._negativeAltitudeExponentBias,negativeElevationThreshold:this._negativeElevationThreshold});if(!f(y))return;let p=this;return y.then(function(C){return p._mesh=new hd(u,new Float32Array(C.vertices),new Uint16Array(C.indices),C.indexCountWithoutSkirts,C.vertexCountWithoutSkirts,C.minimumHeight,C.maximumHeight,ae.clone(C.boundingSphere3D),m.clone(C.occludeePointInScaledSpace),C.numberOfAttributes,_i.clone(C.orientedBoundingBox),Tc.clone(C.encoding),C.westIndicesSouthToNorth,C.southIndicesEastToWest,C.eastIndicesNorthToSouth,C.northIndicesWestToEast),p._minimumHeight=C.minimumHeight,p._maximumHeight=C.maximumHeight,p._buffer=void 0,p._mesh})};iA.prototype.interpolateHeight=function(t,n,i){let o=B.clamp((n-t.west)/t.width,0,1),r=B.clamp((i-t.south)/t.height,0,1);return f(this._mesh)?vJe(this,o,r):BJe(this,o,r,t)};var bJe=new fi("upsampleQuantizedTerrainMesh",Rh.maximumAsynchronousTasks);iA.prototype.upsample=function(t,n,i,o,r,s,a){let c=this._mesh;if(!f(this._mesh))return;let l=n*2!==r,u=i*2===s,d=t.ellipsoid,h=t.tileXYToRectangle(r,s,a),_=bJe.scheduleTask({vertices:c.vertices,indices:c.indices,indexCountWithoutSkirts:c.indexCountWithoutSkirts,vertexCountWithoutSkirts:c.vertexCountWithoutSkirts,encoding:c.encoding,minimumHeight:this._minimumHeight,maximumHeight:this._maximumHeight,isEastChild:l,isNorthChild:u,childRectangle:h,ellipsoid:d});if(!f(_))return;let y=this;return _.then(function(p){let C=new Uint16Array(p.vertices),x=Ne.createTypedArray(C.length/3,p.indices),T=y._skirtHeight;return new pE({quantizedVertices:C,indices:x,minimumHeight:p.minimumHeight,maximumHeight:p.maximumHeight,boundingSphere:ae.clone(p.boundingSphere),orientedBoundingBox:_i.clone(p.orientedBoundingBox),horizonOcclusionPoint:m.clone(p.horizonOcclusionPoint),westIndices:p.westIndices,southIndices:p.southIndices,eastIndices:p.eastIndices,northIndices:p.northIndices,westSkirtHeight:T,southSkirtHeight:T,eastSkirtHeight:T,northSkirtHeight:T,childTileMask:0,createdByUpsampling:!0,credits:y._credits})})};iA.prototype.isChildAvailable=function(t,n,i,o){let r=2;return i!==t*2&&++r,o!==n*2&&(r-=2),(this._childTileMask&1<<r)!==0};iA.prototype.wasCreatedByUpsampling=function(){return this._createdByUpsampling};var SJe=new W,wJe=new W,DJe=new W,Cde=new m;function vJe(t,n,i){let o=t._mesh,r=o.vertices,s=o.encoding,a=o.indices;for(let c=0,l=a.length;c<l;c+=3){let u=a[c],d=a[c+1],h=a[c+2],_=s.decodeTextureCoordinates(r,u,SJe),y=s.decodeTextureCoordinates(r,d,wJe),p=s.decodeTextureCoordinates(r,h,DJe),C=Rg.computeBarycentricCoordinates(n,i,_.x,_.y,y.x,y.y,p.x,p.y,Cde);if(C.x>=-1e-15&&C.y>=-1e-15&&C.z>=-1e-15){let x=s.decodeHeight(r,u),T=s.decodeHeight(r,d),E=s.decodeHeight(r,h);return C.x*x+C.y*T+C.z*E}}}var PJe=Uint16Array.BYTES_PER_ELEMENT,yde=Uint32Array.BYTES_PER_ELEMENT,A7=Int32Array.BYTES_PER_ELEMENT,IJe=Float32Array.BYTES_PER_ELEMENT,C7=Float64Array.BYTES_PER_ELEMENT;function BJe(t,n,i,o){let r=t._buffer,s=0,a=0,c=0;i>.5?(n>.5?(s=2,a=.5):s=3,c=.5):n>.5&&(s=1,a=.5);let l=new DataView(r),u=0;for(let D=0;D<s;++D)u+=l.getUint32(u,!0),u+=yde;u+=yde,u+=2*C7;let d=B.toRadians(l.getFloat64(u,!0)*180);u+=C7;let h=B.toRadians(l.getFloat64(u,!0)*180);u+=C7;let _=o.width/d/2,y=o.height/h/2,p=l.getInt32(u,!0);u+=A7;let C=l.getInt32(u,!0)*3;u+=A7,u+=A7;let x=new Array(p),T=new Array(p),E=new Array(p),S;for(S=0;S<p;++S)x[S]=a+l.getUint8(u++)*_,T[S]=c+l.getUint8(u++)*y,E[S]=l.getFloat32(u,!0)*6371010,u+=IJe;let w=new Array(C);for(S=0;S<C;++S)w[S]=l.getUint16(u,!0),u+=PJe;for(S=0;S<C;S+=3){let D=w[S],I=w[S+1],O=w[S+2],M=x[D],L=x[I],F=x[O],g=T[D],b=T[I],v=T[O],P=Rg.computeBarycentricCoordinates(n,i,M,g,L,b,F,v,Cde);if(P.x>=-1e-15&&P.y>=-1e-15&&P.z>=-1e-15)return P.x*E[D]+P.y*E[I]+P.z*E[O]}}var UD=iA;var tf={UNKNOWN:0,NONE:1,SELF:2,PARENT:3},$3=new te;function eV(){this._terrainCache={},this._lastTidy=te.now()}eV.prototype.add=function(t,n){this._terrainCache[t]={buffer:n,timestamp:te.now()}};eV.prototype.get=function(t){let i=this._terrainCache[t];if(f(i))return delete this._terrainCache[t],i.buffer};eV.prototype.tidy=function(){if(te.now($3),te.secondsDifference($3,this._lastTidy)>10){let t=this._terrainCache,n=Object.keys(t),i=n.length;for(let o=0;o<i;++o){let r=n[o],s=t[r];te.secondsDifference($3,s.timestamp)>10&&delete t[r]}te.clone($3,this._lastTidy)}};function xE(t){t=A(t,A.EMPTY_OBJECT);let n;if(f(t.metadata))n=t.metadata;else{let s=Ie.createIfNeeded(t.url);n=new Uh(s)}this._metadata=n,this._tilingScheme=new Wi({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:2,rectangle:new le(-B.PI,-B.PI,B.PI,B.PI),ellipsoid:t.ellipsoid});let i=t.credit;typeof i=="string"&&(i=new Jt(i)),this._credit=i,this._levelZeroMaximumGeometricError=40075.16,this._terrainCache=new eV,this._terrainPromises={},this._terrainRequests={},this._errorEvent=new Ae,this._ready=!1;let o=this,r;this._readyPromise=n.readyPromise.then(function(s){if(!n.terrainPresent){let a=new he(`The server ${n.url} doesn't have terrain`);return r=qn.reportError(r,o,o._errorEvent,a.message,void 0,void 0,void 0,a),Promise.reject(a)}return qn.reportSuccess(r),o._ready=s,s}).catch(function(s){return r=qn.reportError(r,o,o._errorEvent,s.message,void 0,void 0,void 0,s),Promise.reject(s)})}Object.defineProperties(xE.prototype,{url:{get:function(){return this._metadata.url}},proxy:{get:function(){return this._metadata.proxy}},tilingScheme:{get:function(){return this._tilingScheme}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise}},credit:{get:function(){return this._credit}},hasWaterMask:{get:function(){return!1}},hasVertexNormals:{get:function(){return!1}},availability:{get:function(){}}});var OJe=new fi("decodeGoogleEarthEnterprisePacket");function xde(t,n,i){let o=n.getChildBitmask();if(n.terrainState===tf.PARENT){o=0;for(let r=0;r<4;++r){let s=i.getTileInformationFromQuadKey(t+r.toString());f(s)&&s.hasTerrain()&&(o|=1<<r)}}return o}xE.prototype.requestTileGeometry=function(t,n,i,o){let r=Uh.tileXYToQuadKey(t,n,i),s=this._terrainCache,a=this._metadata,c=a.getTileInformationFromQuadKey(r);if(!f(c))return Promise.reject(new he("Terrain tile doesn't exist"));let l=c.terrainState;f(l)||(l=c.terrainState=tf.UNKNOWN);let u=s.get(r);if(f(u)){let T=a.providers[c.terrainProvider];return Promise.resolve(new UD({buffer:u,childTileMask:xde(r,c,a),credits:f(T)?[T]:void 0,negativeAltitudeExponentBias:a.negativeAltitudeExponentBias,negativeElevationThreshold:a.negativeAltitudeThreshold}))}if(s.tidy(),c.ancestorHasTerrain){if(l===tf.NONE)return Promise.reject(new he("Terrain tile doesn't exist"))}else return Promise.resolve(new ka({buffer:new Uint8Array(16*16),width:16,height:16}));let d,h=r,_=-1;switch(l){case tf.SELF:_=c.terrainVersion;break;case tf.PARENT:h=h.substring(0,h.length-1),d=a.getTileInformationFromQuadKey(h),_=d.terrainVersion;break;case tf.UNKNOWN:c.hasTerrain()?_=c.terrainVersion:(h=h.substring(0,h.length-1),d=a.getTileInformationFromQuadKey(h),f(d)&&d.hasTerrain()&&(_=d.terrainVersion));break}if(_<0)return Promise.reject(new he("Terrain tile doesn't exist"));let y=this._terrainPromises,p=this._terrainRequests,C,x;if(f(y[h]))C=y[h],x=p[h];else{x=o;let T=RJe(this,h,_,x).fetchArrayBuffer();if(!f(T))return;C=T.then(function(E){return f(E)?OJe.scheduleTask({buffer:E,type:"Terrain",key:a.key},[E]).then(function(S){let w=a.getTileInformationFromQuadKey(h);w.terrainState=tf.SELF,s.add(h,S[0]);let D=w.terrainProvider,I=S.length-1;for(let O=0;O<I;++O){let M=h+O.toString(),L=a.getTileInformationFromQuadKey(M);f(L)&&(s.add(M,S[O+1]),L.terrainState=tf.PARENT,L.terrainProvider===0&&(L.terrainProvider=D))}}):Promise.reject(new he("Failed to load terrain."))}),y[h]=C,p[h]=x,C=C.finally(function(){delete y[h],delete p[h]})}return C.then(function(){let T=s.get(r);if(f(T)){let E=a.providers[c.terrainProvider];return new UD({buffer:T,childTileMask:xde(r,c,a),credits:f(E)?[E]:void 0,negativeAltitudeExponentBias:a.negativeAltitudeExponentBias,negativeElevationThreshold:a.negativeAltitudeThreshold})}return Promise.reject(new he("Failed to load terrain."))}).catch(function(T){return x.state===ai.CANCELLED?(o.state=x.state,Promise.reject(T)):(c.terrainState=tf.NONE,Promise.reject(T))})};xE.prototype.getLevelMaximumGeometricError=function(t){return this._levelZeroMaximumGeometricError/(1<<t)};xE.prototype.getTileDataAvailable=function(t,n,i){let o=this._metadata,r=Uh.tileXYToQuadKey(t,n,i),s=o.getTileInformation(t,n,i);if(s===null)return!1;if(f(s)){if(!s.ancestorHasTerrain)return!0;let a=s.terrainState;if(a===tf.NONE)return!1;if((!f(a)||a===tf.UNKNOWN)&&(s.terrainState=tf.UNKNOWN,!s.hasTerrain())){r=r.substring(0,r.length-1);let c=o.getTileInformationFromQuadKey(r);if(!f(c)||!c.hasTerrain())return!1}return!0}if(o.isValid(r)){let a=new qo({throttle:!1,throttleByServer:!0,type:Qr.TERRAIN});o.populateSubtree(t,n,i,a)}return!1};xE.prototype.loadTileDataAvailability=function(t,n,i){};function RJe(t,n,i,o){return i=f(i)&&i>0?i:1,t._metadata.resource.getDerivedResource({url:`flatfile?f1c-0${n}-t.${i.toString()}`,request:o})}var Tde=xE;function MJe(t,n,i,o){this.rightAscension=t,this.declination=n,this.rotation=i,this.rotationRate=o}var tV=MJe;var Fde={},LJe=32.184,FJe=2451545,Ede=-.0529921,bde=-.1059842,Sde=13.0120009,wde=13.3407154,Dde=.9856003,vde=26.4057084,Pde=13.064993,Ide=.3287146,Bde=1.7484877,Ode=-.1589763,Rde=.0036096,Mde=.1643573,Lde=12.9590088,x7=new te;Fde.ComputeMoon=function(t,n){f(t)||(t=te.now()),x7=te.addSeconds(t,LJe,x7);let i=te.totalDays(x7)-FJe,o=i/Yn.DAYS_PER_JULIAN_CENTURY,r=(125.045+Ede*i)*B.RADIANS_PER_DEGREE,s=(250.089+bde*i)*B.RADIANS_PER_DEGREE,a=(260.008+Sde*i)*B.RADIANS_PER_DEGREE,c=(176.625+wde*i)*B.RADIANS_PER_DEGREE,l=(357.529+Dde*i)*B.RADIANS_PER_DEGREE,u=(311.589+vde*i)*B.RADIANS_PER_DEGREE,d=(134.963+Pde*i)*B.RADIANS_PER_DEGREE,h=(276.617+Ide*i)*B.RADIANS_PER_DEGREE,_=(34.226+Bde*i)*B.RADIANS_PER_DEGREE,y=(15.134+Ode*i)*B.RADIANS_PER_DEGREE,p=(119.743+Rde*i)*B.RADIANS_PER_DEGREE,C=(239.961+Mde*i)*B.RADIANS_PER_DEGREE,x=(25.053+Lde*i)*B.RADIANS_PER_DEGREE,T=Math.sin(r),E=Math.sin(s),S=Math.sin(a),w=Math.sin(c),D=Math.sin(l),I=Math.sin(u),O=Math.sin(d),M=Math.sin(h),L=Math.sin(_),F=Math.sin(y),g=Math.sin(p),b=Math.sin(C),v=Math.sin(x),P=Math.cos(r),R=Math.cos(s),V=Math.cos(a),H=Math.cos(c),U=Math.cos(l),G=Math.cos(u),k=Math.cos(d),X=Math.cos(h),Y=Math.cos(_),K=Math.cos(y),j=Math.cos(p),Z=Math.cos(C),Q=Math.cos(x),me=(269.9949+.0031*o-3.8787*T-.1204*E+.07*S-.0172*w+.0072*I-.0052*F+.0043*v)*B.RADIANS_PER_DEGREE,_e=(66.5392+.013*o+1.5419*P+.0239*R-.0278*V+.0068*H-.0029*G+9e-4*k+8e-4*K-9e-4*Q)*B.RADIANS_PER_DEGREE,re=(38.3213+13.17635815*i-14e-13*i*i+3.561*T+.1208*E-.0642*S+.0158*w+.0252*D-.0066*I-.0047*O-.0046*M+.0028*L+.0052*F+.004*g+.0019*b-.0044*v)*B.RADIANS_PER_DEGREE,fe=(13.17635815-14e-13*(2*i)+3.561*P*Ede+.1208*R*bde-.0642*V*Sde+.0158*H*wde+.0252*U*Dde-.0066*G*vde-.0047*k*Pde-.0046*X*Ide+.0028*Y*Bde+.0052*K*Ode+.004*j*Rde+.0019*Z*Mde-.0044*Q*Lde)/86400*B.RADIANS_PER_DEGREE;return f(n)||(n=new tV),n.rightAscension=me,n.declination=_e,n.rotation=re,n.rotationRate=fe,n};var nV=Fde;function Nde(t){(!f(t)||typeof t!="function")&&(t=nV.ComputeMoon),this._computeFunction=t}var NJe=new m,VJe=new m,kJe=new m;function UJe(t,n,i){let o=NJe;o.x=Math.cos(t+B.PI_OVER_TWO),o.y=Math.sin(t+B.PI_OVER_TWO),o.z=0;let r=Math.cos(n),s=kJe;s.x=r*Math.cos(t),s.y=r*Math.sin(t),s.z=Math.sin(n);let a=m.cross(s,o,VJe);return f(i)||(i=new $),i[0]=o.x,i[1]=a.x,i[2]=s.x,i[3]=o.y,i[4]=a.y,i[5]=s.y,i[6]=o.z,i[7]=a.z,i[8]=s.z,i}var zJe=new $,HJe=new Me;Nde.prototype.evaluate=function(t,n){f(t)||(t=te.now());let i=this._computeFunction(t),o=UJe(i.rightAscension,i.declination,n),r=B.zeroToTwoPi(i.rotation),s=Me.fromAxisAngle(m.UNIT_Z,r,HJe),a=$.fromQuaternion(Me.conjugate(s,s),zJe);return $.multiply(a,o,o)};var iV=Nde;var zD={};zD.type=void 0;zD.getRequiredDataPoints=Ce.throwInstantiationError;zD.interpolateOrderZero=Ce.throwInstantiationError;zD.interpolate=Ce.throwInstantiationError;var Vde=zD;function T7(t){this._url=Ie.createIfNeeded(t),this._url.appendForwardSlash()}Object.defineProperties(T7.prototype,{url:{get:function(){return this._url}}});T7.prototype.geocode=function(t,n){return this._url.getDerivedResource({url:n===nA.AUTOCOMPLETE?"autocomplete":"search",queryParameters:{text:t}}).fetchJson().then(function(o){return o.features.map(function(r){let s,a=r.bbox;if(f(a))s=le.fromDegrees(a[0],a[1],a[2],a[3]);else{let c=r.geometry.coordinates[0],l=r.geometry.coordinates[1];s=m.fromDegrees(c,l)}return{displayName:r.properties.label,destination:s}})})};var oV=T7;function kde(t){t=A(t,A.EMPTY_OBJECT);let n=A(t.accessToken,Lh.defaultAccessToken),i=Ie.createIfNeeded(A(t.server,Lh.defaultServer));i.appendForwardSlash();let o=Lh.getDefaultTokenCredit(n);f(o)&&t.scene.frameState.creditDisplay.addDefaultCredit(Jt.clone(o));let r=i.getDerivedResource({url:"v1/geocode"});f(n)&&r.appendQueryParameters({access_token:n}),this._accessToken=n,this._server=i,this._pelias=new oV(r)}kde.prototype.geocode=function(t,n){return this._pelias.geocode(t,n)};var rV=kde;var GJe={SHIFT:0,CTRL:1,ALT:2},aa=Object.freeze(GJe);function sV(){Ce.throwInstantiationError()}Object.defineProperties(sV.prototype,{ellipsoid:{get:Ce.throwInstantiationError}});sV.prototype.project=Ce.throwInstantiationError;sV.prototype.unproject=Ce.throwInstantiationError;var Ude=sV;var E7=[],b7=[];function WJe(t,n,i,o,r,s){let a=r-o+1,c=s-r,l=E7,u=b7,d,h;for(d=0;d<a;++d)l[d]=t[o+d];for(h=0;h<c;++h)u[h]=t[r+h+1];d=0,h=0;for(let _=o;_<=s;++_){let y=l[d],p=u[h];d<a&&(h>=c||n(y,p,i)<=0)?(t[_]=y,++d):h<c&&(t[_]=p,++h)}}function S7(t,n,i,o,r){if(o>=r)return;let s=Math.floor((o+r)*.5);S7(t,n,i,o,s),S7(t,n,i,s+1,r),WJe(t,n,i,o,s,r)}function jJe(t,n,i){let o=t.length,r=Math.ceil(o*.5);E7.length=r,b7.length=r,S7(t,n,i,0,o-1),E7.length=0,b7.length=0}var oA=jJe;function TE(t){t=A(t,A.EMPTY_OBJECT);let n=t.weights,i=t.times;this._times=i,this._weights=n,this._count=n.length/i.length,this._lastTimeIndex=0}Object.defineProperties(TE.prototype,{times:{get:function(){return this._times}},weights:{get:function(){return this._weights}}});TE.prototype.findTimeInterval=to.prototype.findTimeInterval;TE.prototype.wrapTime=to.prototype.wrapTime;TE.prototype.clampTime=to.prototype.clampTime;TE.prototype.evaluate=function(t,n){let i=this.weights,o=this.times,r=this._lastTimeIndex=this.findTimeInterval(t,this._lastTimeIndex),s=(t-o[r])/(o[r+1]-o[r]);f(n)||(n=new Array(this._count));for(let a=0;a<this._count;a++){let c=r*this._count+a;n[a]=i[c]*(1-s)+i[c+this._count]*s}return n};var zde=TE;var qJe={NONE:-1,PARTIAL:0,FULL:1},fr=Object.freeze(qJe);function za(t,n){this._occluderPosition=m.clone(t.center),this._occluderRadius=t.radius,this._horizonDistance=0,this._horizonPlaneNormal=void 0,this._horizonPlanePosition=void 0,this._cameraPosition=void 0,this.cameraPosition=n}var aV=new m;Object.defineProperties(za.prototype,{position:{get:function(){return this._occluderPosition}},radius:{get:function(){return this._occluderRadius}},cameraPosition:{set:function(t){t=m.clone(t,this._cameraPosition);let n=m.subtract(this._occluderPosition,t,aV),i=m.magnitudeSquared(n),o=this._occluderRadius*this._occluderRadius,r,s,a;if(i>o){r=Math.sqrt(i-o),i=1/Math.sqrt(i),s=m.multiplyByScalar(n,i,aV);let c=r*r*i;a=m.add(t,m.multiplyByScalar(s,c,aV),aV)}else r=Number.MAX_VALUE;this._horizonDistance=r,this._horizonPlaneNormal=s,this._horizonPlanePosition=a,this._cameraPosition=t}}});za.fromBoundingSphere=function(t,n,i){return f(i)?(m.clone(t.center,i._occluderPosition),i._occluderRadius=t.radius,i.cameraPosition=n,i):new za(t,n)};var Gde=new m;za.prototype.isPointVisible=function(t){if(this._horizonDistance!==Number.MAX_VALUE){let n=m.subtract(t,this._occluderPosition,Gde),i=this._occluderRadius;if(i=m.magnitudeSquared(n)-i*i,i>0)return i=Math.sqrt(i)+this._horizonDistance,n=m.subtract(t,this._cameraPosition,n),i*i>m.magnitudeSquared(n)}return!1};var YJe=new m;za.prototype.isBoundingSphereVisible=function(t){let n=m.clone(t.center,YJe),i=t.radius;if(this._horizonDistance!==Number.MAX_VALUE){let o=m.subtract(n,this._occluderPosition,Gde),r=this._occluderRadius-i;if(r=m.magnitudeSquared(o)-r*r,i<this._occluderRadius)return r>0?(r=Math.sqrt(r)+this._horizonDistance,o=m.subtract(n,this._cameraPosition,o),r*r+i*i>m.magnitudeSquared(o)):!1;if(r>0){o=m.subtract(n,this._cameraPosition,o);let s=m.magnitudeSquared(o),a=this._occluderRadius*this._occluderRadius,c=i*i;return(this._horizonDistance*this._horizonDistance+a)*c>s*a?!0:(r=Math.sqrt(r)+this._horizonDistance,r*r+c>s)}return!0}return!1};var XJe=new m;za.prototype.computeVisibility=function(t){let n=m.clone(t.center),i=t.radius;if(i>this._occluderRadius)return fr.FULL;if(this._horizonDistance!==Number.MAX_VALUE){let o=m.subtract(n,this._occluderPosition,XJe),r=this._occluderRadius-i,s=m.magnitudeSquared(o);if(r=s-r*r,r>0){r=Math.sqrt(r)+this._horizonDistance,o=m.subtract(n,this._cameraPosition,o);let a=m.magnitudeSquared(o);return r*r+i*i<a?fr.NONE:(r=this._occluderRadius+i,r=s-r*r,r>0?(r=Math.sqrt(r)+this._horizonDistance,a<r*r+i*i?fr.FULL:fr.PARTIAL):(o=m.subtract(n,this._horizonPlanePosition,o),m.dot(o,this._horizonPlaneNormal)>-i?fr.PARTIAL:fr.FULL))}}return fr.NONE};var cV=new m;za.computeOccludeePoint=function(t,n,i){let o=m.clone(n),r=m.clone(t.center),s=t.radius,a=i.length,c=m.normalize(m.subtract(o,r,cV),cV),l=-m.dot(c,r),u=za._anyRotationVector(r,c,l),d=za._horizonToPlaneNormalDotProduct(t,c,l,u,i[0]);if(!d)return;let h;for(let y=1;y<a;++y){if(h=za._horizonToPlaneNormalDotProduct(t,c,l,u,i[y]),!h)return;h<d&&(d=h)}if(d<.0017453283658983088)return;let _=s/d;return m.add(r,m.multiplyByScalar(c,_,cV),cV)};var KJe=[];za.computeOccludeePointFromRectangle=function(t,n){n=A(n,oe.WGS84);let i=le.subsample(t,n,0,KJe),o=ae.fromPoints(i),r=m.ZERO;if(!m.equals(r,o.center))return za.computeOccludeePoint(new ae(r,n.minimumRadius),o.center,i)};var JJe=new m;za._anyRotationVector=function(t,n,i){let o=m.abs(n,JJe),r=o.x>o.y?0:1;(r===0&&o.z>o.x||r===1&&o.z>o.y)&&(r=2);let s=new m,a;r===0?(o.x=t.x,o.y=t.y+1,o.z=t.z+1,a=m.UNIT_X):r===1?(o.x=t.x+1,o.y=t.y,o.z=t.z+1,a=m.UNIT_Y):(o.x=t.x+1,o.y=t.y+1,o.z=t.z,a=m.UNIT_Z);let c=(m.dot(n,o)+i)/-m.dot(n,a);return m.normalize(m.subtract(m.add(o,m.multiplyByScalar(a,c,s),o),t,o),o)};var ZJe=new m;za._rotationVector=function(t,n,i,o,r){let s=m.subtract(o,t,ZJe);if(s=m.normalize(s,s),m.dot(n,s)<.9999999847691291){let a=m.cross(n,s,s);if(m.magnitude(a)>B.EPSILON13)return m.normalize(a,new m)}return r};var w7=new m,QJe=new m,lV=new m,Hde=new m;za._horizonToPlaneNormalDotProduct=function(t,n,i,o,r){let s=m.clone(r,w7),a=m.clone(t.center,QJe),c=t.radius,l=m.subtract(a,s,lV),u=m.magnitudeSquared(l),d=c*c;if(u<d)return!1;let h=u-d,_=Math.sqrt(h),p=1/Math.sqrt(u),x=_*p*_;l=m.normalize(l,l);let T=m.add(s,m.multiplyByScalar(l,x,Hde),Hde),E=Math.sqrt(h-x*x),S=this._rotationVector(a,n,i,s,o),w=m.fromElements(S.x*S.x*l.x+(S.x*S.y-S.z)*l.y+(S.x*S.z+S.y)*l.z,(S.x*S.y+S.z)*l.x+S.y*S.y*l.y+(S.y*S.z-S.x)*l.z,(S.x*S.z-S.y)*l.x+(S.y*S.z+S.x)*l.y+S.z*S.z*l.z,w7);w=m.normalize(w,w);let D=m.multiplyByScalar(w,E,w7);S=m.normalize(m.subtract(m.add(T,D,lV),a,lV),lV);let I=m.dot(n,S);S=m.normalize(m.subtract(m.subtract(T,D,S),a,S),S);let O=m.dot(n,S);return I<O?I:O};var uV=za;function D7(t,n,i){t=Ie.createIfNeeded(t),t.appendForwardSlash(),t.setQueryParameters({key:n}),this._url=t,this._params=A(i,{})}Object.defineProperties(D7.prototype,{url:{get:function(){return this._url}},params:{get:function(){return this._params}}});D7.prototype.geocode=function(t){return this._url.getDerivedResource({url:"json",queryParameters:At(this._params,{q:t})}).fetchJson().then(function(i){return i.results.map(function(o){let r,s=o.bounds;if(f(s))r=le.fromDegrees(s.southwest.lng,s.southwest.lat,s.northeast.lng,s.northeast.lat);else{let a=o.geometry.lat,c=o.geometry.lng;r=m.fromDegrees(a,c)}return{displayName:o.formatted,destination:r}})})};var Wde=D7;var $Je={packedLength:void 0,pack:Ce.throwInstantiationError,unpack:Ce.throwInstantiationError},jde=$Je;var eZe={packedInterpolationLength:void 0,convertPackedArrayForInterpolation:Ce.throwInstantiationError,unpackInterpolationResult:Ce.throwInstantiationError},qde=eZe;var tZe=new m;function nZe(t,n,i,o){let r=TC(t,n,i,o,tZe);return f(r)?r.x>0&&r.y>0&&r.z>0:!1}var Yde=nZe;function Xde(){Ce.throwInstantiationError()}Xde.prototype.getURL=Ce.throwInstantiationError;var Kde=Xde;var iZe={LEFT_DOWN:0,LEFT_UP:1,LEFT_CLICK:2,LEFT_DOUBLE_CLICK:3,RIGHT_DOWN:5,RIGHT_UP:6,RIGHT_CLICK:7,MIDDLE_DOWN:10,MIDDLE_UP:11,MIDDLE_CLICK:12,MOUSE_MOVE:15,WHEEL:16,PINCH_START:17,PINCH_END:18,PINCH_MOVE:19},yn=Object.freeze(iZe);function Ng(t,n,i){let o=t._element;if(o===document)return i.x=n.clientX,i.y=n.clientY,i;let r=o.getBoundingClientRect();return i.x=n.clientX-r.left,i.y=n.clientY-r.top,i}function R7(t,n){let i=t;return f(n)&&(i+=`+${n}`),i}function rA(t){if(t.shiftKey)return aa.SHIFT;if(t.ctrlKey)return aa.CTRL;if(t.altKey)return aa.ALT}var rs={LEFT:0,MIDDLE:1,RIGHT:2};function Kl(t,n,i,o){function r(s){o(t,s)}Vt.isInternetExplorer()?i.addEventListener(n,r,!1):i.addEventListener(n,r,{capture:!1,passive:!1}),t._removalFunctions.push(function(){i.removeEventListener(n,r,!1)})}function oZe(t){let n=t._element,i=f(n.disableRootEvents)?n:document;Vt.supportsPointerEvents()?(Kl(t,"pointerdown",n,uZe),Kl(t,"pointerup",n,rhe),Kl(t,"pointermove",n,fZe),Kl(t,"pointercancel",n,rhe)):(Kl(t,"mousedown",n,she),Kl(t,"mouseup",i,ahe),Kl(t,"mousemove",i,che),Kl(t,"touchstart",n,cZe),Kl(t,"touchend",i,ehe),Kl(t,"touchmove",i,lZe),Kl(t,"touchcancel",i,ehe)),Kl(t,"dblclick",n,sZe);let o;"onwheel"in n?o="wheel":document.onmousewheel!==void 0?o="mousewheel":o="DOMMouseScroll",Kl(t,o,n,aZe)}function rZe(t){let n=t._removalFunctions;for(let i=0;i<n.length;++i)n[i]()}var Jde={position:new W};function M7(t){t._lastSeenTouchEvent=Fi()}function L7(t){return Fi()-t._lastSeenTouchEvent>_d.mouseEmulationIgnoreMilliseconds}function O7(t,n,i){let o=t.x-n.x,r=t.y-n.y;return Math.sqrt(o*o+r*r)<i}function she(t,n){if(!L7(t))return;let i=n.button;t._buttonDown[i]=!0;let o;if(i===rs.LEFT)o=yn.LEFT_DOWN;else if(i===rs.MIDDLE)o=yn.MIDDLE_DOWN;else if(i===rs.RIGHT)o=yn.RIGHT_DOWN;else return;let r=Ng(t,n,t._primaryPosition);W.clone(r,t._primaryStartPosition),W.clone(r,t._primaryPreviousPosition);let s=rA(n),a=t.getInputAction(o,s);f(a)&&(W.clone(r,Jde.position),a(Jde))}var Zde={position:new W},Qde={position:new W};function v7(t,n,i,o){let r=rA(o),s=t.getInputAction(n,r),a=t.getInputAction(i,r);if(f(s)||f(a)){let c=Ng(t,o,t._primaryPosition);if(f(s)&&(W.clone(c,Zde.position),s(Zde)),f(a)){let l=t._primaryStartPosition;O7(l,c,t._clickPixelTolerance)&&(W.clone(c,Qde.position),a(Qde))}}}function ahe(t,n){if(!L7(t))return;let i=n.button;i!==rs.LEFT&&i!==rs.MIDDLE&&i!==rs.RIGHT||(t._buttonDown[rs.LEFT]&&(v7(t,yn.LEFT_UP,yn.LEFT_CLICK,n),t._buttonDown[rs.LEFT]=!1),t._buttonDown[rs.MIDDLE]&&(v7(t,yn.MIDDLE_UP,yn.MIDDLE_CLICK,n),t._buttonDown[rs.MIDDLE]=!1),t._buttonDown[rs.RIGHT]&&(v7(t,yn.RIGHT_UP,yn.RIGHT_CLICK,n),t._buttonDown[rs.RIGHT]=!1))}var P7={startPosition:new W,endPosition:new W};function che(t,n){if(!L7(t))return;let i=rA(n),o=Ng(t,n,t._primaryPosition),r=t._primaryPreviousPosition,s=t.getInputAction(yn.MOUSE_MOVE,i);f(s)&&(W.clone(r,P7.startPosition),W.clone(o,P7.endPosition),s(P7)),W.clone(o,r),(t._buttonDown[rs.LEFT]||t._buttonDown[rs.MIDDLE]||t._buttonDown[rs.RIGHT])&&n.preventDefault()}var $de={position:new W};function sZe(t,n){let i=n.button,o;if(i===rs.LEFT)o=yn.LEFT_DOUBLE_CLICK;else return;let r=rA(n),s=t.getInputAction(o,r);f(s)&&(Ng(t,n,$de.position),s($de))}function aZe(t,n){let i;if(f(n.deltaY)){let s=n.deltaMode;s===n.DOM_DELTA_PIXEL?i=-n.deltaY:s===n.DOM_DELTA_LINE?i=-n.deltaY*40:i=-n.deltaY*120}else n.detail>0?i=n.detail*-120:i=n.wheelDelta;if(!f(i))return;let o=rA(n),r=t.getInputAction(yn.WHEEL,o);f(r)&&(r(i),n.preventDefault())}function cZe(t,n){M7(t);let i=n.changedTouches,o,r=i.length,s,a,c=t._positions;for(o=0;o<r;++o)s=i[o],a=s.identifier,c.set(a,Ng(t,s,new W));fV(t,n);let l=t._previousPositions;for(o=0;o<r;++o)s=i[o],a=s.identifier,l.set(a,W.clone(c.get(a)))}function ehe(t,n){M7(t);let i=n.changedTouches,o,r=i.length,s,a,c=t._positions;for(o=0;o<r;++o)s=i[o],a=s.identifier,c.remove(a);fV(t,n);let l=t._previousPositions;for(o=0;o<r;++o)s=i[o],a=s.identifier,l.remove(a)}var the={position:new W},I7={position1:new W,position2:new W},nhe={position:new W},ihe={position:new W},ohe={position:new W};function fV(t,n){let i=rA(n),o=t._positions,r=o.length,s,a,c=t._isPinching;if(r!==1&&t._buttonDown[rs.LEFT]){if(t._buttonDown[rs.LEFT]=!1,f(t._touchHoldTimer)&&(clearTimeout(t._touchHoldTimer),t._touchHoldTimer=void 0),s=t.getInputAction(yn.LEFT_UP,i),f(s)&&(W.clone(t._primaryPosition,nhe.position),s(nhe)),r===0&&!t._isTouchHolding&&(a=t.getInputAction(yn.LEFT_CLICK,i),f(a))){let l=t._primaryStartPosition,u=t._previousPositions.values[0];O7(l,u,t._clickPixelTolerance)&&(W.clone(t._primaryPosition,ihe.position),a(ihe))}t._isTouchHolding=!1}if(r===0&&c&&(t._isPinching=!1,s=t.getInputAction(yn.PINCH_END,i),f(s)&&s()),r===1&&!c){let l=o.values[0];W.clone(l,t._primaryPosition),W.clone(l,t._primaryStartPosition),W.clone(l,t._primaryPreviousPosition),t._buttonDown[rs.LEFT]=!0,s=t.getInputAction(yn.LEFT_DOWN,i),f(s)&&(W.clone(l,the.position),s(the)),t._touchHoldTimer=setTimeout(function(){if(!t.isDestroyed()&&(t._touchHoldTimer=void 0,t._isTouchHolding=!0,a=t.getInputAction(yn.RIGHT_CLICK,i),f(a))){let u=t._primaryStartPosition,d=t._previousPositions.values[0];O7(u,d,t._holdPixelTolerance)&&(W.clone(t._primaryPosition,ohe.position),a(ohe))}},_d.touchHoldDelayMilliseconds),n.preventDefault()}r===2&&!c&&(t._isPinching=!0,s=t.getInputAction(yn.PINCH_START,i),f(s)&&(W.clone(o.values[0],I7.position1),W.clone(o.values[1],I7.position2),s(I7),n.preventDefault()))}function lZe(t,n){M7(t);let i=n.changedTouches,o,r=i.length,s,a,c=t._positions;for(o=0;o<r;++o){s=i[o],a=s.identifier;let u=c.get(a);f(u)&&Ng(t,s,u)}lhe(t,n);let l=t._previousPositions;for(o=0;o<r;++o)s=i[o],a=s.identifier,W.clone(c.get(a),l.get(a))}var B7={startPosition:new W,endPosition:new W},HD={distance:{startPosition:new W,endPosition:new W},angleAndHeight:{startPosition:new W,endPosition:new W}};function lhe(t,n){let i=rA(n),o=t._positions,r=t._previousPositions,s=o.length,a;if(s===1&&t._buttonDown[rs.LEFT]){let c=o.values[0];W.clone(c,t._primaryPosition);let l=t._primaryPreviousPosition;a=t.getInputAction(yn.MOUSE_MOVE,i),f(a)&&(W.clone(l,B7.startPosition),W.clone(c,B7.endPosition),a(B7)),W.clone(c,l),n.preventDefault()}else if(s===2&&t._isPinching&&(a=t.getInputAction(yn.PINCH_MOVE,i),f(a))){let c=o.values[0],l=o.values[1],u=r.values[0],d=r.values[1],h=l.x-c.x,_=l.y-c.y,y=Math.sqrt(h*h+_*_)*.25,p=d.x-u.x,C=d.y-u.y,x=Math.sqrt(p*p+C*C)*.25,T=(l.y+c.y)*.125,E=(d.y+u.y)*.125,S=Math.atan2(_,h),w=Math.atan2(C,p);W.fromElements(0,x,HD.distance.startPosition),W.fromElements(0,y,HD.distance.endPosition),W.fromElements(w,E,HD.angleAndHeight.startPosition),W.fromElements(S,T,HD.angleAndHeight.endPosition),a(HD)}}function uZe(t,n){if(n.target.setPointerCapture(n.pointerId),n.pointerType==="touch"){let i=t._positions,o=n.pointerId;i.set(o,Ng(t,n,new W)),fV(t,n),t._previousPositions.set(o,W.clone(i.get(o)))}else she(t,n)}function rhe(t,n){if(n.pointerType==="touch"){let i=t._positions,o=n.pointerId;i.remove(o),fV(t,n),t._previousPositions.remove(o)}else ahe(t,n)}function fZe(t,n){if(n.pointerType==="touch"){let i=t._positions,o=n.pointerId,r=i.get(o);if(!f(r))return;Ng(t,n,r),lhe(t,n);let s=t._previousPositions;W.clone(i.get(o),s.get(o))}else che(t,n)}function _d(t){this._inputEvents={},this._buttonDown={LEFT:!1,MIDDLE:!1,RIGHT:!1},this._isPinching=!1,this._isTouchHolding=!1,this._lastSeenTouchEvent=-_d.mouseEmulationIgnoreMilliseconds,this._primaryStartPosition=new W,this._primaryPosition=new W,this._primaryPreviousPosition=new W,this._positions=new yt,this._previousPositions=new yt,this._removalFunctions=[],this._touchHoldTimer=void 0,this._clickPixelTolerance=5,this._holdPixelTolerance=25,this._element=A(t,document),oZe(this)}_d.prototype.setInputAction=function(t,n,i){let o=R7(n,i);this._inputEvents[o]=t};_d.prototype.getInputAction=function(t,n){let i=R7(t,n);return this._inputEvents[i]};_d.prototype.removeInputAction=function(t,n){let i=R7(t,n);delete this._inputEvents[i]};_d.prototype.isDestroyed=function(){return!1};_d.prototype.destroy=function(){return rZe(this),ue(this)};_d.mouseEmulationIgnoreMilliseconds=800;_d.touchHoldDelayMilliseconds=1500;var nf=_d;var F7={};function dZe(t){let n=6.239996+.0172019696544*t;return .001657*Math.sin(n+.01671*Math.sin(n))}var hZe=32.184,mZe=2451545;function vhe(t,n){n=te.addSeconds(t,hZe,n);let i=te.totalDays(n)-mZe;return n=te.addSeconds(n,dZe(i),n),n}var dV=new te(2451545,0,jn.TAI),pZe=1e3,of=B.RADIANS_PER_DEGREE,Jl=B.RADIANS_PER_ARCSECOND,ca=14959787e4,uhe=new $;function Phe(t,n,i,o,r,s,a){i<0&&(i=-i,r+=B.PI);let c=t*(1-n),l=o-r,u=r,d=gZe(s-o,n),h=_Ze(n,0);TZe(l,i,u,uhe);let _=c*(1+n),y=Math.cos(d),p=Math.sin(d),C=1+n*y,x=_/C;return f(a)?(a.x=x*y,a.y=x*p,a.z=0):a=new m(x*y,x*p,0),$.multiplyByVector(uhe,a,a)}function _Ze(t,n){return t<=n?"Circular":t<1-n?"Elliptical":t<=1+n?"Parabolic":"Hyperbolic"}function gZe(t,n){let i=CZe(t,n);return xZe(i,n)}var yZe=50,AZe=B.EPSILON8;function CZe(t,n){let i=Math.floor(t/B.TWO_PI);t-=i*B.TWO_PI;let o=t+n*Math.sin(t)/(1-Math.sin(t+n)+Math.sin(t)),r=Number.MAX_VALUE,s;for(s=0;s<yZe&&Math.abs(r-o)>AZe;++s){r=o;let a=r-n*Math.sin(r)-t,c=1-n*Math.cos(r);o=r-a/c}return r=o+i*B.TWO_PI,r}function xZe(t,n){let i=Math.floor(t/B.TWO_PI);t-=i*B.TWO_PI;let o=Math.cos(t)-n,r=Math.sin(t)*Math.sqrt(1-n*n),s=Math.atan2(r,o);return s=B.zeroToTwoPi(s),t<0&&(s-=B.TWO_PI),s+=i*B.TWO_PI,s}function TZe(t,n,i,o){let r=Math.cos(t),s=Math.sin(t),a=Math.cos(n),c=Math.sin(n),l=Math.cos(i),u=Math.sin(i);return f(o)?(o[0]=l*r-u*s*a,o[1]=u*r+l*s*a,o[2]=s*c,o[3]=-l*s-u*r*a,o[4]=-u*s+l*r*a,o[5]=r*c,o[6]=u*c,o[7]=-l*c,o[8]=a):o=new $(l*r-u*s*a,-l*s-u*r*a,u*c,u*r+l*s*a,-u*s+l*r*a,-l*c,s*c,r*c,a),o}var EZe=1.0000010178*ca,bZe=100.46645683*of,SZe=129597742283429e-5*Jl,fhe=16002,dhe=21863,hhe=32004,mhe=10931,phe=14529,_he=16368,ghe=15318,yhe=32794,wZe=64*1e-7*ca,DZe=-152*1e-7*ca,vZe=62*1e-7*ca,PZe=-8*1e-7*ca,IZe=32*1e-7*ca,BZe=-41*1e-7*ca,OZe=19*1e-7*ca,RZe=-11*1e-7*ca,MZe=-150*1e-7*ca,LZe=-46*1e-7*ca,FZe=68*1e-7*ca,NZe=54*1e-7*ca,VZe=14*1e-7*ca,kZe=24*1e-7*ca,UZe=-28*1e-7*ca,zZe=22*1e-7*ca,Ahe=10,Che=16002,xhe=21863,The=10931,Ehe=1473,bhe=32004,She=4387,whe=73,HZe=-325*1e-7,GZe=-322*1e-7,WZe=-79*1e-7,jZe=232*1e-7,qZe=-52*1e-7,YZe=97*1e-7,XZe=55*1e-7,KZe=-41*1e-7,JZe=-105*1e-7,ZZe=-137*1e-7,QZe=258*1e-7,$Ze=35*1e-7,eQe=-116*1e-7,tQe=-88*1e-7,nQe=-112*1e-7,iQe=-80*1e-7,EE=new te(0,0,jn.TAI);function oQe(t,n){vhe(t,EE);let o=(EE.dayNumber-dV.dayNumber+(EE.secondsOfDay-dV.secondsOfDay)/Yn.SECONDS_PER_DAY)/(Yn.DAYS_PER_JULIAN_CENTURY*10),r=.3595362*o,s=EZe+wZe*Math.cos(fhe*r)+MZe*Math.sin(fhe*r)+DZe*Math.cos(dhe*r)+LZe*Math.sin(dhe*r)+vZe*Math.cos(hhe*r)+FZe*Math.sin(hhe*r)+PZe*Math.cos(mhe*r)+NZe*Math.sin(mhe*r)+IZe*Math.cos(phe*r)+VZe*Math.sin(phe*r)+BZe*Math.cos(_he*r)+kZe*Math.sin(_he*r)+OZe*Math.cos(ghe*r)+UZe*Math.sin(ghe*r)+RZe*Math.cos(yhe*r)+zZe*Math.sin(yhe*r),a=bZe+SZe*o+HZe*Math.cos(Ahe*r)+JZe*Math.sin(Ahe*r)+GZe*Math.cos(Che*r)+ZZe*Math.sin(Che*r)+WZe*Math.cos(xhe*r)+QZe*Math.sin(xhe*r)+jZe*Math.cos(The*r)+$Ze*Math.sin(The*r)+qZe*Math.cos(Ehe*r)+eQe*Math.sin(Ehe*r)+YZe*Math.cos(bhe*r)+tQe*Math.sin(bhe*r)+XZe*Math.cos(She*r)+nQe*Math.sin(She*r)+KZe*Math.cos(whe*r)+iQe*Math.sin(whe*r),c=.0167086342-.0004203654*o,l=102.93734808*of+11612.3529*Jl*o,u=469.97289*Jl*o,d=174.87317577*of-8679.27034*Jl*o;return Phe(s,c,u,l,d,a,n)}function Ihe(t,n){vhe(t,EE);let o=(EE.dayNumber-dV.dayNumber+(EE.secondsOfDay-dV.secondsOfDay)/Yn.SECONDS_PER_DAY)/Yn.DAYS_PER_JULIAN_CENTURY,r=o*o,s=r*o,a=s*o,c=383397.7725+.004*o,l=.055545526-16e-9*o,u=5.15668983*of,d=-8e-5*o+.02966*r-42e-6*s-13e-8*a,h=83.35324312*of,_=146434202669e-4*o-38.2702*r-.045047*s+21301e-8*a,y=125.04455501*of,p=-69679193631e-4*o+6.3602*r+.007625*s-3586e-8*a,C=218.31664563*of,x=17325593434847e-4*o-6.391*r+.006588*s-3169e-8*a,T=297.85019547*of+Jl*(1602961601209e-3*o-6.3706*r+.006593*s-3169e-8*a),E=93.27209062*of+Jl*(17395272628478e-4*o-12.7512*r-.001037*s+417e-8*a),S=134.96340251*of+Jl*(17179159232178e-4*o+31.8792*r+.051635*s-2447e-7*a),w=357.52910918*of+Jl*(1295965810481e-4*o-.5532*r+136e-6*s-1149e-8*a),D=310.17137918*of-Jl*(6967051436e-3*o+6.2068*r+.007618*s-3219e-8*a),I=2*T,O=4*T,M=6*T,L=2*S,F=3*S,g=4*S,b=2*E;c+=3400.4*Math.cos(I)-635.6*Math.cos(I-S)-235.6*Math.cos(S)+218.1*Math.cos(I-w)+181*Math.cos(I+S),l+=.014216*Math.cos(I-S)+.008551*Math.cos(I-L)-.001383*Math.cos(S)+.001356*Math.cos(I+S)-.001147*Math.cos(O-F)-914e-6*Math.cos(O-L)+869e-6*Math.cos(I-w-S)-627e-6*Math.cos(I)-394e-6*Math.cos(O-g)+282e-6*Math.cos(I-w-L)-279e-6*Math.cos(T-S)-236e-6*Math.cos(L)+231e-6*Math.cos(O)+229e-6*Math.cos(M-g)-201e-6*Math.cos(L-b),d+=486.26*Math.cos(I-b)-40.13*Math.cos(I)+37.51*Math.cos(b)+25.73*Math.cos(L-b)+19.97*Math.cos(I-w-b),_+=-55609*Math.sin(I-S)-34711*Math.sin(I-L)-9792*Math.sin(S)+9385*Math.sin(O-F)+7505*Math.sin(O-L)+5318*Math.sin(I+S)+3484*Math.sin(O-g)-3417*Math.sin(I-w-S)-2530*Math.sin(M-g)-2376*Math.sin(I)-2075*Math.sin(I-F)-1883*Math.sin(L)-1736*Math.sin(M-5*S)+1626*Math.sin(w)-1370*Math.sin(M-F),p+=-5392*Math.sin(I-b)-540*Math.sin(w)-441*Math.sin(I)+423*Math.sin(b)-288*Math.sin(L-b),x+=-3332.9*Math.sin(I)+1197.4*Math.sin(I-S)-662.5*Math.sin(w)+396.3*Math.sin(S)-218*Math.sin(I-w);let v=2*D,P=3*D;d+=46.997*Math.cos(D)*o-.614*Math.cos(I-b+D)*o+.614*Math.cos(I-b-D)*o-.0297*Math.cos(v)*r-.0335*Math.cos(D)*r+.0012*Math.cos(I-b+v)*r-16e-5*Math.cos(D)*s+4e-5*Math.cos(P)*s+4e-5*Math.cos(v)*s;let R=2.116*Math.sin(D)*o-.111*Math.sin(I-b-D)*o-.0015*Math.sin(D)*r;_+=R,x+=R,p+=-520.77*Math.sin(D)*o+13.66*Math.sin(I-b+D)*o+1.12*Math.sin(I-D)*o-1.06*Math.sin(b-D)*o+.66*Math.sin(v)*r+.371*Math.sin(D)*r-.035*Math.sin(I-b+v)*r-.015*Math.sin(I-b+D)*r+.0014*Math.sin(D)*s-.0011*Math.sin(P)*s-9e-4*Math.sin(v)*s,c*=pZe;let V=u+d*Jl,H=h+_*Jl,U=C+x*Jl,G=y+p*Jl;return Phe(c,l,V,H,G,U,n)}var Dhe=.012300034,rQe=Dhe/(Dhe+1)*-1;function sQe(t,n){return n=Ihe(t,n),m.multiplyByScalar(n,rQe,n)}var Bhe=new $(1.0000000000000002,5619723173785822e-31,4690511510146299e-34,-5154129427414611e-31,.9174820620691819,-.39777715593191376,-223970096136568e-30,.39777715593191376,.9174820620691819),GD=new m;F7.computeSunPositionInEarthInertialFrame=function(t,n){return f(t)||(t=te.now()),f(n)||(n=new m),GD=oQe(t,GD),n=m.negate(GD,n),sQe(t,GD),m.subtract(n,GD,n),$.multiplyByVector(Bhe,n,n),n};F7.computeMoonPositionInEarthInertialFrame=function(t,n){return f(t)||(t=te.now()),n=Ihe(t,n),$.multiplyByVector(Bhe,n,n),n};var sA=F7;function aQe(t,n,i,o,r,s,a){let c=Si.numberOfPoints(t,n,r),l,u=i.red,d=i.green,h=i.blue,_=i.alpha,y=o.red,p=o.green,C=o.blue,x=o.alpha;if(z.equals(i,o)){for(l=0;l<c;l++)s[a++]=z.floatToByte(u),s[a++]=z.floatToByte(d),s[a++]=z.floatToByte(h),s[a++]=z.floatToByte(_);return a}let T=(y-u)/c,E=(p-d)/c,S=(C-h)/c,w=(x-_)/c,D=a;for(l=0;l<c;l++)s[D++]=z.floatToByte(u+l*T),s[D++]=z.floatToByte(d+l*E),s[D++]=z.floatToByte(h+l*S),s[D++]=z.floatToByte(_+l*w);return D}function WD(t){t=A(t,A.EMPTY_OBJECT);let n=t.positions,i=t.colors,o=A(t.colorsPerVertex,!1);this._positions=n,this._colors=i,this._colorsPerVertex=o,this._arcType=A(t.arcType,Zt.GEODESIC),this._granularity=A(t.granularity,B.RADIANS_PER_DEGREE),this._ellipsoid=A(t.ellipsoid,oe.WGS84),this._workerName="createSimplePolylineGeometry";let r=1+n.length*m.packedLength;r+=f(i)?1+i.length*z.packedLength:1,this.packedLength=r+oe.packedLength+3}WD.pack=function(t,n,i){i=A(i,0);let o,r=t._positions,s=r.length;for(n[i++]=s,o=0;o<s;++o,i+=m.packedLength)m.pack(r[o],n,i);let a=t._colors;for(s=f(a)?a.length:0,n[i++]=s,o=0;o<s;++o,i+=z.packedLength)z.pack(a[o],n,i);return oe.pack(t._ellipsoid,n,i),i+=oe.packedLength,n[i++]=t._colorsPerVertex?1:0,n[i++]=t._arcType,n[i]=t._granularity,n};WD.unpack=function(t,n,i){n=A(n,0);let o,r=t[n++],s=new Array(r);for(o=0;o<r;++o,n+=m.packedLength)s[o]=m.unpack(t,n);r=t[n++];let a=r>0?new Array(r):void 0;for(o=0;o<r;++o,n+=z.packedLength)a[o]=z.unpack(t,n);let c=oe.unpack(t,n);n+=oe.packedLength;let l=t[n++]===1,u=t[n++],d=t[n];return f(i)?(i._positions=s,i._colors=a,i._ellipsoid=c,i._colorsPerVertex=l,i._arcType=u,i._granularity=d,i):new WD({positions:s,colors:a,ellipsoid:c,colorsPerVertex:l,arcType:u,granularity:d})};var hV=new Array(2),mV=new Array(2),cQe={positions:hV,height:mV,ellipsoid:void 0,minDistance:void 0,granularity:void 0};WD.createGeometry=function(t){let n=t._positions,i=t._colors,o=t._colorsPerVertex,r=t._arcType,s=t._granularity,a=t._ellipsoid,c=B.chordLength(s,a.maximumRadius),l=f(i)&&!o,u,d=n.length,h,_,y,p,C=0;if(r===Zt.GEODESIC||r===Zt.RHUMB){let w,D,I;r===Zt.GEODESIC?(w=B.chordLength(s,a.maximumRadius),D=Si.numberOfPoints,I=Si.generateArc):(w=s,D=Si.numberOfPointsRhumbLine,I=Si.generateRhumbArc);let O=Si.extractHeights(n,a),M=cQe;if(r===Zt.GEODESIC?M.minDistance=c:M.granularity=s,M.ellipsoid=a,l){let L=0;for(u=0;u<d-1;u++)L+=D(n[u],n[u+1],w)+1;h=new Float64Array(L*3),y=new Uint8Array(L*4),M.positions=hV,M.height=mV;let F=0;for(u=0;u<d-1;++u){hV[0]=n[u],hV[1]=n[u+1],mV[0]=O[u],mV[1]=O[u+1];let g=I(M);if(f(i)){let b=g.length/3;p=i[u];for(let v=0;v<b;++v)y[F++]=z.floatToByte(p.red),y[F++]=z.floatToByte(p.green),y[F++]=z.floatToByte(p.blue),y[F++]=z.floatToByte(p.alpha)}h.set(g,C),C+=g.length}}else if(M.positions=n,M.height=O,h=new Float64Array(I(M)),f(i)){for(y=new Uint8Array(h.length/3*4),u=0;u<d-1;++u){let F=n[u],g=n[u+1],b=i[u],v=i[u+1];C=aQe(F,g,b,v,c,y,C)}let L=i[d-1];y[C++]=z.floatToByte(L.red),y[C++]=z.floatToByte(L.green),y[C++]=z.floatToByte(L.blue),y[C++]=z.floatToByte(L.alpha)}}else{_=l?d*2-2:d,h=new Float64Array(_*3),y=f(i)?new Uint8Array(_*4):void 0;let w=0,D=0;for(u=0;u<d;++u){let I=n[u];if(l&&u>0&&(m.pack(I,h,w),w+=3,p=i[u-1],y[D++]=z.floatToByte(p.red),y[D++]=z.floatToByte(p.green),y[D++]=z.floatToByte(p.blue),y[D++]=z.floatToByte(p.alpha)),l&&u===d-1)break;m.pack(I,h,w),w+=3,f(i)&&(p=i[u],y[D++]=z.floatToByte(p.red),y[D++]=z.floatToByte(p.green),y[D++]=z.floatToByte(p.blue),y[D++]=z.floatToByte(p.alpha))}}let x=new cn;x.position=new we({componentDatatype:J.DOUBLE,componentsPerAttribute:3,values:h}),f(i)&&(x.color=new we({componentDatatype:J.UNSIGNED_BYTE,componentsPerAttribute:4,values:y,normalize:!0})),_=h.length/3;let T=(_-1)*2,E=Ne.createTypedArray(_,T),S=0;for(u=0;u<_-1;++u)E[S++]=u,E[S++]=u+1;return new at({attributes:x,indices:E,primitiveType:Re.LINES,boundingSphere:ae.fromPoints(n)})};var Ohe=WD;function bE(t){let n=A(t.radius,1),o={radii:new m(n,n,n),stackPartitions:t.stackPartitions,slicePartitions:t.slicePartitions,vertexFormat:t.vertexFormat};this._ellipsoidGeometry=new Vs(o),this._workerName="createSphereGeometry"}bE.packedLength=Vs.packedLength;bE.pack=function(t,n,i){return Vs.pack(t._ellipsoidGeometry,n,i)};var lQe=new Vs,Vg={radius:void 0,radii:new m,vertexFormat:new De,stackPartitions:void 0,slicePartitions:void 0};bE.unpack=function(t,n,i){let o=Vs.unpack(t,n,lQe);return Vg.vertexFormat=De.clone(o._vertexFormat,Vg.vertexFormat),Vg.stackPartitions=o._stackPartitions,Vg.slicePartitions=o._slicePartitions,f(i)?(m.clone(o._radii,Vg.radii),i._ellipsoidGeometry=new Vs(Vg),i):(Vg.radius=o._radii.x,new bE(Vg))};bE.createGeometry=function(t){return Vs.createGeometry(t._ellipsoidGeometry)};var Rhe=bE;var uQe={WEST:0,NORTH:1,EAST:2,SOUTH:3,NORTHWEST:4,NORTHEAST:5,SOUTHWEST:6,SOUTHEAST:7},hn=uQe;function kg(t){}Object.defineProperties(kg.prototype,{ellipsoid:{get:Ce.throwInstantiationError},rectangle:{get:Ce.throwInstantiationError},projection:{get:Ce.throwInstantiationError}});kg.prototype.getNumberOfXTilesAtLevel=Ce.throwInstantiationError;kg.prototype.getNumberOfYTilesAtLevel=Ce.throwInstantiationError;kg.prototype.rectangleToNativeRectangle=Ce.throwInstantiationError;kg.prototype.tileXYToNativeRectangle=Ce.throwInstantiationError;kg.prototype.tileXYToRectangle=Ce.throwInstantiationError;kg.prototype.positionToTileXY=Ce.throwInstantiationError;var Mhe=kg;function aA(t){t=A(t,A.EMPTY_OBJECT),this._clock=void 0,this._element=void 0,this._clockSubscription=void 0,this._seekFunction=void 0,this._lastPlaybackRate=void 0,this.clock=t.clock,this.element=t.element,this.epoch=A(t.epoch,Ue.MINIMUM_VALUE),this.tolerance=A(t.tolerance,1),this._seeking=!1,this._seekFunction=void 0,this._firstTickAfterSeek=!1}Object.defineProperties(aA.prototype,{clock:{get:function(){return this._clock},set:function(t){let n=this._clock;n!==t&&(f(n)&&(this._clockSubscription(),this._clockSubscription=void 0),f(t)&&(this._clockSubscription=t.onTick.addEventListener(aA.prototype._onTick,this)),this._clock=t)}},element:{get:function(){return this._element},set:function(t){let n=this._element;n!==t&&(f(n)&&n.removeEventListener("seeked",this._seekFunction,!1),f(t)&&(this._seeking=!1,this._seekFunction=fQe(this),t.addEventListener("seeked",this._seekFunction,!1)),this._element=t,this._seeking=!1,this._firstTickAfterSeek=!1)}}});aA.prototype.destroy=function(){return this.element=void 0,this.clock=void 0,ue(this)};aA.prototype.isDestroyed=function(){return!1};aA.prototype._trySetPlaybackRate=function(t){if(this._lastPlaybackRate===t.multiplier)return;let n=this._element;try{n.playbackRate=t.multiplier}catch(i){n.playbackRate=0}this._lastPlaybackRate=t.multiplier};aA.prototype._onTick=function(t){let n=this._element;if(!f(n)||n.readyState<2)return;let i=n.paused,o=t.shouldAnimate;if(o===i&&(o?n.play():n.pause()),this._seeking||this._firstTickAfterSeek){this._firstTickAfterSeek=!1;return}this._trySetPlaybackRate(t);let r=t.currentTime,s=A(this.epoch,Ue.MINIMUM_VALUE),a=te.secondsDifference(r,s),c=n.duration,l,u=n.currentTime;n.loop?(a=a%c,a<0&&(a=c-a),l=a):a>c?l=c:a<0?l=0:l=a;let d=o?A(this.tolerance,1):.001;Math.abs(l-u)>d&&(this._seeking=!0,n.currentTime=l)};function fQe(t){return function(){t._seeking=!1,t._firstTickAfterSeek=!0}}var Lhe=aA;function dQe(t,n){this.rectangle=t,this.maxLevel=n}function SE(t){t=A(t,A.EMPTY_OBJECT);let n=Ie.createIfNeeded(t.url);this._resource=n,this._errorEvent=new Ae,this._ready=!1,this._terrainDataStructure={heightScale:1/1e3,heightOffset:-1e3,elementsPerHeight:3,stride:4,elementMultiplier:256,isBigEndian:!0,lowestEncodedHeight:0,highestEncodedHeight:256*256*256-1};let i=t.credit;typeof i=="string"&&(i=new Jt(i)),this._credit=i,this._tilingScheme=void 0,this._rectangles=[];let o=this,r,s=A(t.ellipsoid,oe.WGS84);function a(u){let d=u.getElementsByTagName("SRS")[0].textContent;if(d==="EPSG:4326")o._tilingScheme=new Wi({ellipsoid:s});else return Promise.reject(new he(`SRS ${d} is not supported.`));let h=u.getElementsByTagName("TileFormat")[0];o._heightmapWidth=parseInt(h.getAttribute("width"),10),o._heightmapHeight=parseInt(h.getAttribute("height"),10),o._levelZeroMaximumGeometricError=Yr.getEstimatedLevelZeroGeometricErrorForAHeightmap(s,Math.min(o._heightmapWidth,o._heightmapHeight),o._tilingScheme.getNumberOfXTilesAtLevel(0));let _=u.getElementsByTagName("DataExtent");for(let y=0;y<_.length;++y){let p=_[y],C=B.toRadians(parseFloat(p.getAttribute("minx"))),x=B.toRadians(parseFloat(p.getAttribute("miny"))),T=B.toRadians(parseFloat(p.getAttribute("maxx"))),E=B.toRadians(parseFloat(p.getAttribute("maxy"))),S=parseInt(p.getAttribute("maxlevel"),10);o._rectangles.push(new dQe(new le(C,x,T,E),S))}return o._ready=!0,Promise.resolve(!0)}function c(u){let d=A(f(u)?u.message:void 0,`An error occurred while accessing ${o._resource.url}.`);return r=qn.reportError(r,o,o._errorEvent,d),r.retry?l():Promise.reject(new he(d))}function l(){return o._resource.fetchXML().then(a).catch(c)}this._readyPromise=l()}Object.defineProperties(SE.prototype,{errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){return this._credit}},tilingScheme:{get:function(){return this._tilingScheme}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise}},hasWaterMask:{get:function(){return!1}},hasVertexNormals:{get:function(){return!1}},availability:{get:function(){}}});SE.prototype.requestTileGeometry=function(t,n,i,o){let r=this._tilingScheme.getNumberOfYTilesAtLevel(i),a=this._resource.getDerivedResource({url:`${i}/${t}/${r-n-1}.tif`,queryParameters:{cesium:!0},request:o}).fetchImage({preferImageBitmap:!0});if(!f(a))return;let c=this;return Promise.resolve(a).then(function(l){return new ka({buffer:Id(l),width:c._heightmapWidth,height:c._heightmapHeight,childTileMask:hQe(c,t,n,i),structure:c._terrainDataStructure})})};SE.prototype.getLevelMaximumGeometricError=function(t){return this._levelZeroMaximumGeometricError/(1<<t)};var Fhe=new le;function hQe(t,n,i,o){let r=t._tilingScheme,s=t._rectangles,a=r.tileXYToRectangle(n,i,o),c=0;for(let l=0;l<s.length&&c!==15;++l){let u=s[l];if(u.maxLevel<=o)continue;let d=u.rectangle,h=le.intersection(d,a,Fhe);f(h)&&(pV(r,d,n*2,i*2,o+1)&&(c|=4),pV(r,d,n*2+1,i*2,o+1)&&(c|=8),pV(r,d,n*2,i*2+1,o+1)&&(c|=1),pV(r,d,n*2+1,i*2+1,o+1)&&(c|=2))}return c}function pV(t,n,i,o,r){let s=t.tileXYToRectangle(i,o,r);return f(le.intersection(s,n,Fhe))}SE.prototype.getTileDataAvailable=function(t,n,i){};SE.prototype.loadTileDataAvailability=function(t,n,i){};var Nhe=SE;var mQe={VK_FORMAT_UNDEFINED:0,VK_FORMAT_R4G4_UNORM_PACK8:1,VK_FORMAT_R4G4B4A4_UNORM_PACK16:2,VK_FORMAT_B4G4R4A4_UNORM_PACK16:3,VK_FORMAT_R5G6B5_UNORM_PACK16:4,VK_FORMAT_B5G6R5_UNORM_PACK16:5,VK_FORMAT_R5G5B5A1_UNORM_PACK16:6,VK_FORMAT_B5G5R5A1_UNORM_PACK16:7,VK_FORMAT_A1R5G5B5_UNORM_PACK16:8,VK_FORMAT_R8_UNORM:9,VK_FORMAT_R8_SNORM:10,VK_FORMAT_R8_USCALED:11,VK_FORMAT_R8_SSCALED:12,VK_FORMAT_R8_UINT:13,VK_FORMAT_R8_SINT:14,VK_FORMAT_R8_SRGB:15,VK_FORMAT_R8G8_UNORM:16,VK_FORMAT_R8G8_SNORM:17,VK_FORMAT_R8G8_USCALED:18,VK_FORMAT_R8G8_SSCALED:19,VK_FORMAT_R8G8_UINT:20,VK_FORMAT_R8G8_SINT:21,VK_FORMAT_R8G8_SRGB:22,VK_FORMAT_R8G8B8_UNORM:23,VK_FORMAT_R8G8B8_SNORM:24,VK_FORMAT_R8G8B8_USCALED:25,VK_FORMAT_R8G8B8_SSCALED:26,VK_FORMAT_R8G8B8_UINT:27,VK_FORMAT_R8G8B8_SINT:28,VK_FORMAT_R8G8B8_SRGB:29,VK_FORMAT_B8G8R8_UNORM:30,VK_FORMAT_B8G8R8_SNORM:31,VK_FORMAT_B8G8R8_USCALED:32,VK_FORMAT_B8G8R8_SSCALED:33,VK_FORMAT_B8G8R8_UINT:34,VK_FORMAT_B8G8R8_SINT:35,VK_FORMAT_B8G8R8_SRGB:36,VK_FORMAT_R8G8B8A8_UNORM:37,VK_FORMAT_R8G8B8A8_SNORM:38,VK_FORMAT_R8G8B8A8_USCALED:39,VK_FORMAT_R8G8B8A8_SSCALED:40,VK_FORMAT_R8G8B8A8_UINT:41,VK_FORMAT_R8G8B8A8_SINT:42,VK_FORMAT_R8G8B8A8_SRGB:43,VK_FORMAT_B8G8R8A8_UNORM:44,VK_FORMAT_B8G8R8A8_SNORM:45,VK_FORMAT_B8G8R8A8_USCALED:46,VK_FORMAT_B8G8R8A8_SSCALED:47,VK_FORMAT_B8G8R8A8_UINT:48,VK_FORMAT_B8G8R8A8_SINT:49,VK_FORMAT_B8G8R8A8_SRGB:50,VK_FORMAT_A8B8G8R8_UNORM_PACK32:51,VK_FORMAT_A8B8G8R8_SNORM_PACK32:52,VK_FORMAT_A8B8G8R8_USCALED_PACK32:53,VK_FORMAT_A8B8G8R8_SSCALED_PACK32:54,VK_FORMAT_A8B8G8R8_UINT_PACK32:55,VK_FORMAT_A8B8G8R8_SINT_PACK32:56,VK_FORMAT_A8B8G8R8_SRGB_PACK32:57,VK_FORMAT_A2R10G10B10_UNORM_PACK32:58,VK_FORMAT_A2R10G10B10_SNORM_PACK32:59,VK_FORMAT_A2R10G10B10_USCALED_PACK32:60,VK_FORMAT_A2R10G10B10_SSCALED_PACK32:61,VK_FORMAT_A2R10G10B10_UINT_PACK32:62,VK_FORMAT_A2R10G10B10_SINT_PACK32:63,VK_FORMAT_A2B10G10R10_UNORM_PACK32:64,VK_FORMAT_A2B10G10R10_SNORM_PACK32:65,VK_FORMAT_A2B10G10R10_USCALED_PACK32:66,VK_FORMAT_A2B10G10R10_SSCALED_PACK32:67,VK_FORMAT_A2B10G10R10_UINT_PACK32:68,VK_FORMAT_A2B10G10R10_SINT_PACK32:69,VK_FORMAT_R16_UNORM:70,VK_FORMAT_R16_SNORM:71,VK_FORMAT_R16_USCALED:72,VK_FORMAT_R16_SSCALED:73,VK_FORMAT_R16_UINT:74,VK_FORMAT_R16_SINT:75,VK_FORMAT_R16_SFLOAT:76,VK_FORMAT_R16G16_UNORM:77,VK_FORMAT_R16G16_SNORM:78,VK_FORMAT_R16G16_USCALED:79,VK_FORMAT_R16G16_SSCALED:80,VK_FORMAT_R16G16_UINT:81,VK_FORMAT_R16G16_SINT:82,VK_FORMAT_R16G16_SFLOAT:83,VK_FORMAT_R16G16B16_UNORM:84,VK_FORMAT_R16G16B16_SNORM:85,VK_FORMAT_R16G16B16_USCALED:86,VK_FORMAT_R16G16B16_SSCALED:87,VK_FORMAT_R16G16B16_UINT:88,VK_FORMAT_R16G16B16_SINT:89,VK_FORMAT_R16G16B16_SFLOAT:90,VK_FORMAT_R16G16B16A16_UNORM:91,VK_FORMAT_R16G16B16A16_SNORM:92,VK_FORMAT_R16G16B16A16_USCALED:93,VK_FORMAT_R16G16B16A16_SSCALED:94,VK_FORMAT_R16G16B16A16_UINT:95,VK_FORMAT_R16G16B16A16_SINT:96,VK_FORMAT_R16G16B16A16_SFLOAT:97,VK_FORMAT_R32_UINT:98,VK_FORMAT_R32_SINT:99,VK_FORMAT_R32_SFLOAT:100,VK_FORMAT_R32G32_UINT:101,VK_FORMAT_R32G32_SINT:102,VK_FORMAT_R32G32_SFLOAT:103,VK_FORMAT_R32G32B32_UINT:104,VK_FORMAT_R32G32B32_SINT:105,VK_FORMAT_R32G32B32_SFLOAT:106,VK_FORMAT_R32G32B32A32_UINT:107,VK_FORMAT_R32G32B32A32_SINT:108,VK_FORMAT_R32G32B32A32_SFLOAT:109,VK_FORMAT_R64_UINT:110,VK_FORMAT_R64_SINT:111,VK_FORMAT_R64_SFLOAT:112,VK_FORMAT_R64G64_UINT:113,VK_FORMAT_R64G64_SINT:114,VK_FORMAT_R64G64_SFLOAT:115,VK_FORMAT_R64G64B64_UINT:116,VK_FORMAT_R64G64B64_SINT:117,VK_FORMAT_R64G64B64_SFLOAT:118,VK_FORMAT_R64G64B64A64_UINT:119,VK_FORMAT_R64G64B64A64_SINT:120,VK_FORMAT_R64G64B64A64_SFLOAT:121,VK_FORMAT_B10G11R11_UFLOAT_PACK32:122,VK_FORMAT_E5B9G9R9_UFLOAT_PACK32:123,VK_FORMAT_D16_UNORM:124,VK_FORMAT_X8_D24_UNORM_PACK32:125,VK_FORMAT_D32_SFLOAT:126,VK_FORMAT_S8_UINT:127,VK_FORMAT_D16_UNORM_S8_UINT:128,VK_FORMAT_D24_UNORM_S8_UINT:129,VK_FORMAT_D32_SFLOAT_S8_UINT:130,VK_FORMAT_BC1_RGB_UNORM_BLOCK:131,VK_FORMAT_BC1_RGB_SRGB_BLOCK:132,VK_FORMAT_BC1_RGBA_UNORM_BLOCK:133,VK_FORMAT_BC1_RGBA_SRGB_BLOCK:134,VK_FORMAT_BC2_UNORM_BLOCK:135,VK_FORMAT_BC2_SRGB_BLOCK:136,VK_FORMAT_BC3_UNORM_BLOCK:137,VK_FORMAT_BC3_SRGB_BLOCK:138,VK_FORMAT_BC4_UNORM_BLOCK:139,VK_FORMAT_BC4_SNORM_BLOCK:140,VK_FORMAT_BC5_UNORM_BLOCK:141,VK_FORMAT_BC5_SNORM_BLOCK:142,VK_FORMAT_BC6H_UFLOAT_BLOCK:143,VK_FORMAT_BC6H_SFLOAT_BLOCK:144,VK_FORMAT_BC7_UNORM_BLOCK:145,VK_FORMAT_BC7_SRGB_BLOCK:146,VK_FORMAT_ETC2_R8G8B8_UNORM_BLOCK:147,VK_FORMAT_ETC2_R8G8B8_SRGB_BLOCK:148,VK_FORMAT_ETC2_R8G8B8A1_UNORM_BLOCK:149,VK_FORMAT_ETC2_R8G8B8A1_SRGB_BLOCK:150,VK_FORMAT_ETC2_R8G8B8A8_UNORM_BLOCK:151,VK_FORMAT_ETC2_R8G8B8A8_SRGB_BLOCK:152,VK_FORMAT_EAC_R11_UNORM_BLOCK:153,VK_FORMAT_EAC_R11_SNORM_BLOCK:154,VK_FORMAT_EAC_R11G11_UNORM_BLOCK:155,VK_FORMAT_EAC_R11G11_SNORM_BLOCK:156,VK_FORMAT_ASTC_4x4_UNORM_BLOCK:157,VK_FORMAT_ASTC_4x4_SRGB_BLOCK:158,VK_FORMAT_ASTC_5x4_UNORM_BLOCK:159,VK_FORMAT_ASTC_5x4_SRGB_BLOCK:160,VK_FORMAT_ASTC_5x5_UNORM_BLOCK:161,VK_FORMAT_ASTC_5x5_SRGB_BLOCK:162,VK_FORMAT_ASTC_6x5_UNORM_BLOCK:163,VK_FORMAT_ASTC_6x5_SRGB_BLOCK:164,VK_FORMAT_ASTC_6x6_UNORM_BLOCK:165,VK_FORMAT_ASTC_6x6_SRGB_BLOCK:166,VK_FORMAT_ASTC_8x5_UNORM_BLOCK:167,VK_FORMAT_ASTC_8x5_SRGB_BLOCK:168,VK_FORMAT_ASTC_8x6_UNORM_BLOCK:169,VK_FORMAT_ASTC_8x6_SRGB_BLOCK:170,VK_FORMAT_ASTC_8x8_UNORM_BLOCK:171,VK_FORMAT_ASTC_8x8_SRGB_BLOCK:172,VK_FORMAT_ASTC_10x5_UNORM_BLOCK:173,VK_FORMAT_ASTC_10x5_SRGB_BLOCK:174,VK_FORMAT_ASTC_10x6_UNORM_BLOCK:175,VK_FORMAT_ASTC_10x6_SRGB_BLOCK:176,VK_FORMAT_ASTC_10x8_UNORM_BLOCK:177,VK_FORMAT_ASTC_10x8_SRGB_BLOCK:178,VK_FORMAT_ASTC_10x10_UNORM_BLOCK:179,VK_FORMAT_ASTC_10x10_SRGB_BLOCK:180,VK_FORMAT_ASTC_12x10_UNORM_BLOCK:181,VK_FORMAT_ASTC_12x10_SRGB_BLOCK:182,VK_FORMAT_ASTC_12x12_UNORM_BLOCK:183,VK_FORMAT_ASTC_12x12_SRGB_BLOCK:184,VK_FORMAT_G8B8G8R8_422_UNORM:1000156e3,VK_FORMAT_B8G8R8G8_422_UNORM:1000156001,VK_FORMAT_G8_B8_R8_3PLANE_420_UNORM:1000156002,VK_FORMAT_G8_B8R8_2PLANE_420_UNORM:1000156003,VK_FORMAT_G8_B8_R8_3PLANE_422_UNORM:1000156004,VK_FORMAT_G8_B8R8_2PLANE_422_UNORM:1000156005,VK_FORMAT_G8_B8_R8_3PLANE_444_UNORM:1000156006,VK_FORMAT_R10X6_UNORM_PACK16:1000156007,VK_FORMAT_R10X6G10X6_UNORM_2PACK16:1000156008,VK_FORMAT_R10X6G10X6B10X6A10X6_UNORM_4PACK16:1000156009,VK_FORMAT_G10X6B10X6G10X6R10X6_422_UNORM_4PACK16:1000156010,VK_FORMAT_B10X6G10X6R10X6G10X6_422_UNORM_4PACK16:1000156011,VK_FORMAT_G10X6_B10X6_R10X6_3PLANE_420_UNORM_3PACK16:1000156012,VK_FORMAT_G10X6_B10X6R10X6_2PLANE_420_UNORM_3PACK16:1000156013,VK_FORMAT_G10X6_B10X6_R10X6_3PLANE_422_UNORM_3PACK16:1000156014,VK_FORMAT_G10X6_B10X6R10X6_2PLANE_422_UNORM_3PACK16:1000156015,VK_FORMAT_G10X6_B10X6_R10X6_3PLANE_444_UNORM_3PACK16:1000156016,VK_FORMAT_R12X4_UNORM_PACK16:1000156017,VK_FORMAT_R12X4G12X4_UNORM_2PACK16:1000156018,VK_FORMAT_R12X4G12X4B12X4A12X4_UNORM_4PACK16:1000156019,VK_FORMAT_G12X4B12X4G12X4R12X4_422_UNORM_4PACK16:1000156020,VK_FORMAT_B12X4G12X4R12X4G12X4_422_UNORM_4PACK16:1000156021,VK_FORMAT_G12X4_B12X4_R12X4_3PLANE_420_UNORM_3PACK16:1000156022,VK_FORMAT_G12X4_B12X4R12X4_2PLANE_420_UNORM_3PACK16:1000156023,VK_FORMAT_G12X4_B12X4_R12X4_3PLANE_422_UNORM_3PACK16:1000156024,VK_FORMAT_G12X4_B12X4R12X4_2PLANE_422_UNORM_3PACK16:1000156025,VK_FORMAT_G12X4_B12X4_R12X4_3PLANE_444_UNORM_3PACK16:1000156026,VK_FORMAT_G16B16G16R16_422_UNORM:1000156027,VK_FORMAT_B16G16R16G16_422_UNORM:1000156028,VK_FORMAT_G16_B16_R16_3PLANE_420_UNORM:1000156029,VK_FORMAT_G16_B16R16_2PLANE_420_UNORM:1000156030,VK_FORMAT_G16_B16_R16_3PLANE_422_UNORM:1000156031,VK_FORMAT_G16_B16R16_2PLANE_422_UNORM:1000156032,VK_FORMAT_G16_B16_R16_3PLANE_444_UNORM:1000156033,VK_FORMAT_PVRTC1_2BPP_UNORM_BLOCK_IMG:1000054e3,VK_FORMAT_PVRTC1_4BPP_UNORM_BLOCK_IMG:1000054001,VK_FORMAT_PVRTC2_2BPP_UNORM_BLOCK_IMG:1000054002,VK_FORMAT_PVRTC2_4BPP_UNORM_BLOCK_IMG:1000054003,VK_FORMAT_PVRTC1_2BPP_SRGB_BLOCK_IMG:1000054004,VK_FORMAT_PVRTC1_4BPP_SRGB_BLOCK_IMG:1000054005,VK_FORMAT_PVRTC2_2BPP_SRGB_BLOCK_IMG:1000054006,VK_FORMAT_PVRTC2_4BPP_SRGB_BLOCK_IMG:1000054007,VK_FORMAT_ASTC_4x4_SFLOAT_BLOCK_EXT:1000066e3,VK_FORMAT_ASTC_5x4_SFLOAT_BLOCK_EXT:1000066001,VK_FORMAT_ASTC_5x5_SFLOAT_BLOCK_EXT:1000066002,VK_FORMAT_ASTC_6x5_SFLOAT_BLOCK_EXT:1000066003,VK_FORMAT_ASTC_6x6_SFLOAT_BLOCK_EXT:1000066004,VK_FORMAT_ASTC_8x5_SFLOAT_BLOCK_EXT:1000066005,VK_FORMAT_ASTC_8x6_SFLOAT_BLOCK_EXT:1000066006,VK_FORMAT_ASTC_8x8_SFLOAT_BLOCK_EXT:1000066007,VK_FORMAT_ASTC_10x5_SFLOAT_BLOCK_EXT:1000066008,VK_FORMAT_ASTC_10x6_SFLOAT_BLOCK_EXT:1000066009,VK_FORMAT_ASTC_10x8_SFLOAT_BLOCK_EXT:1000066010,VK_FORMAT_ASTC_10x10_SFLOAT_BLOCK_EXT:1000066011,VK_FORMAT_ASTC_12x10_SFLOAT_BLOCK_EXT:1000066012,VK_FORMAT_ASTC_12x12_SFLOAT_BLOCK_EXT:1000066013,VK_FORMAT_G8B8G8R8_422_UNORM_KHR:1000156e3,VK_FORMAT_B8G8R8G8_422_UNORM_KHR:1000156001,VK_FORMAT_G8_B8_R8_3PLANE_420_UNORM_KHR:1000156002,VK_FORMAT_G8_B8R8_2PLANE_420_UNORM_KHR:1000156003,VK_FORMAT_G8_B8_R8_3PLANE_422_UNORM_KHR:1000156004,VK_FORMAT_G8_B8R8_2PLANE_422_UNORM_KHR:1000156005,VK_FORMAT_G8_B8_R8_3PLANE_444_UNORM_KHR:1000156006,VK_FORMAT_R10X6_UNORM_PACK16_KHR:1000156007,VK_FORMAT_R10X6G10X6_UNORM_2PACK16_KHR:1000156008,VK_FORMAT_R10X6G10X6B10X6A10X6_UNORM_4PACK16_KHR:1000156009,VK_FORMAT_G10X6B10X6G10X6R10X6_422_UNORM_4PACK16_KHR:1000156010,VK_FORMAT_B10X6G10X6R10X6G10X6_422_UNORM_4PACK16_KHR:1000156011,VK_FORMAT_G10X6_B10X6_R10X6_3PLANE_420_UNORM_3PACK16_KHR:1000156012,VK_FORMAT_G10X6_B10X6R10X6_2PLANE_420_UNORM_3PACK16_KHR:1000156013,VK_FORMAT_G10X6_B10X6_R10X6_3PLANE_422_UNORM_3PACK16_KHR:1000156014,VK_FORMAT_G10X6_B10X6R10X6_2PLANE_422_UNORM_3PACK16_KHR:1000156015,VK_FORMAT_G10X6_B10X6_R10X6_3PLANE_444_UNORM_3PACK16_KHR:1000156016,VK_FORMAT_R12X4_UNORM_PACK16_KHR:1000156017,VK_FORMAT_R12X4G12X4_UNORM_2PACK16_KHR:1000156018,VK_FORMAT_R12X4G12X4B12X4A12X4_UNORM_4PACK16_KHR:1000156019,VK_FORMAT_G12X4B12X4G12X4R12X4_422_UNORM_4PACK16_KHR:1000156020,VK_FORMAT_B12X4G12X4R12X4G12X4_422_UNORM_4PACK16_KHR:1000156021,VK_FORMAT_G12X4_B12X4_R12X4_3PLANE_420_UNORM_3PACK16_KHR:1000156022,VK_FORMAT_G12X4_B12X4R12X4_2PLANE_420_UNORM_3PACK16_KHR:1000156023,VK_FORMAT_G12X4_B12X4_R12X4_3PLANE_422_UNORM_3PACK16_KHR:1000156024,VK_FORMAT_G12X4_B12X4R12X4_2PLANE_422_UNORM_3PACK16_KHR:1000156025,VK_FORMAT_G12X4_B12X4_R12X4_3PLANE_444_UNORM_3PACK16_KHR:1000156026,VK_FORMAT_G16B16G16R16_422_UNORM_KHR:1000156027,VK_FORMAT_B16G16R16G16_422_UNORM_KHR:1000156028,VK_FORMAT_G16_B16_R16_3PLANE_420_UNORM_KHR:1000156029,VK_FORMAT_G16_B16R16_2PLANE_420_UNORM_KHR:1000156030,VK_FORMAT_G16_B16_R16_3PLANE_422_UNORM_KHR:1000156031,VK_FORMAT_G16_B16R16_2PLANE_422_UNORM_KHR:1000156032,VK_FORMAT_G16_B16_R16_3PLANE_444_UNORM_KHR:1000156033},Vhe=Object.freeze(mQe);function pQe(t){switch(t){case ee.FLOAT:return"float";case ee.FLOAT_VEC2:return"vec2";case ee.FLOAT_VEC3:return"vec3";case ee.FLOAT_VEC4:return"vec4";case ee.FLOAT_MAT2:return"mat2";case ee.FLOAT_MAT3:return"mat3";case ee.FLOAT_MAT4:return"mat4";case ee.SAMPLER_2D:return"sampler2D";case ee.BOOL:return"bool"}}var khe=pQe;function _Qe(t,n,i){return function(){i.apply(t,arguments),n.apply(t,arguments)}}var _V=_Qe;var gQe={POINT:1,SPOT:2},Ha=Object.freeze(gQe);function zh(){this.directionalLight=[],this.pointLight=[],this.spotLight=[],this._changedLightList=new yt,this._pointLightDistanceDecayVisible=[],this._spotLightDistanceDecayCosVisible=[],this.listenFn=null}zh.prototype.addLightSource=function(t){if(this._changedLightList.set(t.id,t.id),t.lightType==Ha.POINT)return this.pointLight.push(t),t;if(t.lightType==Ha.SPOT)return this.spotLight.push(t),t;if(t.lightType==Ha.DIRECTIONAL)return this.directionalLight.push(t),t};zh.prototype.removeLightSource=function(t){if(this._changedLightList.set(t.id,t.id),t.lightType==Ha.POINT){let n=this.pointLight.findIndex(function(i){return i.id==t.id});if(n>-1)return this.pointLight.splice(n,1),t}else if(t.lightType==Ha.SPOT){let n=this.spotLight.findIndex(function(i){return i.id==t.id});if(n>-1)return this.spotLight.splice(n,1),t}else if(t.lightType==Ha.DIRECTIONAL){let n=this.directionalLight.findIndex(function(i){return i.id==t.id});if(n>-1)return this.directionalLight.splice(n,1),t}};zh.prototype.removeLightSourceById=function(t,n){if(this._changedLightList.set(n,n),t==Ha.POINT){let i=this.pointLight.findIndex(function(o){return o.id==n});if(i>-1)return this.pointLight.splice(i,1)}else if(t==Ha.SPOT){let i=this.spotLight.findIndex(function(o){return o.id==n});if(i>-1)return this.spotLight.splice(i,1)}else if(t==Ha.DIRECTIONAL){let i=this.directionalLight.findIndex(function(o){return o.id==n});if(i>-1)return this.directionalLight.splice(i,1)}};zh.prototype.hasChange=function(){return this._changedLightList.values.length>0};zh.prototype.resetChange=function(){this._changedLightList.removeAll()};zh.prototype.combineUniformValue=function(){this._pointLightDistanceDecayVisible=[],this._spotLightDistanceDecayCosVisible=[];for(let t=0;t<this.pointLight.length;t++){let n=this.pointLight[t],i=new m;i.x=n.distance,i.y=n.decay,i.z=n.visibleInCullingVolume,this._pointLightDistanceDecayVisible.push(i)}for(let t=0;t<this.spotLight.length;t++){let n=this.spotLight[t],i=new se;i.x=n.distance,i.y=n.decay,i.z=n.angleCos,i.w=n.visibleInCullingVolume,this._spotLightDistanceDecayCosVisible.push(i)}this.listenFn&&this.listenFn()};zh.prototype.createUniformMap=function(){let t=this;return{uDirectionalLightDirectionEC:function(){return[]},uDirectionalLightColor:function(){return[]},uPointLightPositionEC:function(){let n=[];for(let i=0;i<t.pointLight.length;i++)n.push(t.pointLight[i].positionEC);return n},uPointLightColor:function(){let n=[];for(let i=0;i<t.pointLight.length;i++)n.push(t.pointLight[i].lightColor);return n},uPointLightDistanceAndDecayAndVisible:function(){return t._pointLightDistanceDecayVisible},uSpotLightColor:function(){let n=[];for(let i=0;i<t.spotLight.length;i++)n.push(t.spotLight[i].lightColor);return n},uSpotLightPositionEC:function(){let n=[];for(let i=0;i<t.spotLight.length;i++)n.push(t.spotLight[i].positionEC);return n},uSpotLightDirectionEC:function(){let n=[];for(let i=0;i<t.spotLight.length;i++)n.push(t.spotLight[i].directionEC);return n},uSpotLightDistanceDecayCosVisible:function(){return t._spotLightDistanceDecayCosVisible},uSpotLightExponent:function(){let n=[];for(let i=0;i<t.spotLight.length;i++)n.push(t.spotLight[i].exponent);return n}}};zh.prototype.addListenFn=function(t){this.listenFn=t};zh.prototype.removeListenFn=function(){this.listenFn=null};var gV=zh;function N7(t){this._id=Bn(),this._position=m.clone(t.position),this._color=A(t.color,new z(1,1,1,1)),this._intensity=A(t.intensity,2),this._distance=A(t.distance,10),this._decay=A(t.decay,1),this._lightColor=z.multiplyByScalar(this._color,this._intensity,new z),this._positionEC=new m,this._visibleInCullingVolume=1}Object.defineProperties(N7.prototype,{id:{get:function(){return this._id}},position:{get:function(){return this._position},set:function(t){Ki.defined("point light positionEC",t),this._position=t}},positionEC:{get:function(){return this._positionEC},set:function(t){Ki.defined("point light positionEC",t),this._positionEC=t}},color:{get:function(){return this._color},set:function(t){Ki.defined("point color color",t),this._color=t,z.multiplyByScalar(this._color,this._intensity,this._lightColor)}},intensity:{get:function(){return this._intensity},set:function(t){Ki.typeOf.number("point light intensity",t),this._intensity=t,z.multiplyByScalar(this._color,this._intensity,this._lightColor)}},lightColor:{get:function(){return this._lightColor},set:function(t){Ki.defined("point light positionEC",e),this._lightColor=t}},distance:{get:function(){return this._distance},set:function(t){Ki.typeOf.number("point light distance",t),this._distance=t}},decay:{get:function(){return this._decay},set:function(t){Ki.typeOf.number("point light decay",t),this._decay=t}},lightType:{get:function(){return Ha.POINT}},visibleInCullingVolume:{get:function(){return this._visibleInCullingVolume}}});N7.prototype.computeVisiblityInCullingVolume=function(t){var n=new ae;n.radius=this._distance,n.center=this._position,this._visibleInCullingVolume=t.computeVisibility(n)!==jt.OUTSIDE?1:0};var Uhe=N7;function V7(t){this._id=Bn(),this._position=m.clone(t.position),this._targetPosition=m.clone(t.targetPosition),this._color=A(t.color,new z(1,1,1,1)),this._intensity=A(t.intensity,2),this._distance=A(t.distance,10),this._angle=A(t.angle,Math.PI/6),this._exponent=A(t.exponent,10),this._decay=A(t.decay,1),this._direction=new m,this._directionEC=new m,m.subtract(this._position,this._targetPosition,this._direction),m.normalize(this._direction,this._direction),this._lightColor=z.multiplyByScalar(this._color,this._intensity,new z),this._angleCos=Math.cos(this._angle),this._positionEC=new m,this._visibleInCullingVolume=1}Object.defineProperties(V7.prototype,{id:{get:function(){return this._id}},lightType:{get:function(){return Ha.SPOT}},position:{get:function(){return this._position},set:function(t){Ki.defined("spot light position",t),m.equals(t,this._targetPosition)||(this._position=t,m.subtract(this._position,this._targetPosition,this._direction),m.normalize(this._direction,this._direction))}},targetPosition:{get:function(){return this._targetPosition},set:function(t){Ki.defined("spot light targetPosition",t),m.equals(t,this._position)||(this._targetPosition=t,m.subtract(this._position,this._targetPosition,this._direction),m.normalize(this._direction,this._direction))}},color:{get:function(){return this._color},set:function(t){Ki.defined("point color color",t),this._color=t,z.multiplyByScalar(this._color,this._intensity,this._lightColor)}},intensity:{get:function(){return this._intensity},set:function(t){Ki.typeOf.number("spot light intensity",t),this._intensity=t,z.multiplyByScalar(this._color,this._intensity,this._lightColor)}},distance:{get:function(){return this._distance},set:function(t){Ki.typeOf.number("spot light distance",t),this._distance=t}},angle:{get:function(){return this._angle},set:function(t){Ki.typeOf.number("spot light angle",t),this._angle=t,this._angleCos=Math.cos(this._angle)}},exponent:{get:function(){return this._exponent},set:function(t){Ki.typeOf.number("spot light exponent",t),this._exponent=t}},decay:{get:function(){return this._decay},set:function(t){Ki.typeOf.number("spot light decay",t),this._decay=t}},direction:{get:function(){return this._direction}},lightColor:{get:function(){return this._lightColor}},angleCos:{get:function(){return this._angleCos}},positionEC:{get:function(){return this._positionEC},set:function(t){Ki.defined("spot light positionEC",t),this._positionEC=t}},directionEC:{get:function(){return this._directionEC},set:function(t){Ki.defined("spot light directionEC",t),this._directionEC=t}},visibleInCullingVolume:{get:function(){return this._visibleInCullingVolume}}});V7.prototype.computeVisiblityInCullingVolume=function(t){var n=new ae;n.radius=this._distance,n.center=this._position,this._visibleInCullingVolume=t.computeVisibility(n)!==jt.OUTSIDE?1:0};var zhe=V7;var wE=`attribute vec4 position;
attribute vec2 textureCoordinates;
varying vec2 v_textureCoordinates;
void main()
{
gl_Position = position;
v_textureCoordinates = textureCoordinates;
}
`;function yV(t){this._context=t}var jD,yQe=new et({primitiveType:Re.TRIANGLES}),AQe=new Qn({color:new z(0,0,0,0)});function CQe(t,n){return new Xo({context:t,colorTextures:[n],destroyAttachments:!1})}function xQe(t,n){return qt.fromCache({context:t,vertexShaderSource:wE,fragmentShaderSource:n,attributeLocations:{position:0,textureCoordinates:1}})}function TQe(t,n){return(!f(jD)||jD.viewport.width!==t||jD.viewport.height!==n)&&(jD=Ve.fromCache({viewport:new He(0,0,t,n)})),jD}yV.prototype.execute=function(t){f(t.preExecute)&&t.preExecute(t);let n=t.outputTexture,i=n.width,o=n.height,r=this._context,s=f(t.vertexArray)?t.vertexArray:r.getViewportQuadVertexArray(),a=f(t.shaderProgram)?t.shaderProgram:xQe(r,t.fragmentShaderSource),c=CQe(r,n),l=TQe(i,o),u=t.uniformMap,d=AQe;d.framebuffer=c,d.renderState=l,d.execute(r);let h=yQe;h.vertexArray=s,h.renderState=l,h.shaderProgram=a,h.uniformMap=u,h.framebuffer=c,h.execute(r),c.destroy(),t.persists||(a.destroy(),f(t.vertexArray)&&s.destroy()),f(t.postExecute)&&t.postExecute(n)};yV.prototype.isDestroyed=function(){return!1};yV.prototype.destroy=function(){return ue(this)};var AV=yV;function EQe(t){this.context=t,this.framebuffer=void 0,this.blendingEnabled=void 0,this.scissorTest=void 0,this.viewport=void 0}var wc=EQe;function gd(t){this._context=t,this._shaders={},this._numberOfShaders=0,this._shadersToRelease={}}Object.defineProperties(gd.prototype,{numberOfShaders:{get:function(){return this._numberOfShaders}}});gd.prototype.replaceShaderProgram=function(t){return f(t.shaderProgram)&&t.shaderProgram.destroy(),this.getShaderProgram(t)};function bQe(t){let n=Object.keys(t).sort();return JSON.stringify(t,n)}gd.prototype.getShaderProgram=function(t){let n=t.vertexShaderSource,i=t.fragmentShaderSource,o=t.attributeLocations;typeof n=="string"&&(n=new ze({sources:[n]})),typeof i=="string"&&(i=new ze({sources:[i]}));let r=n.getCacheKey(),s=i.getCacheKey(),a=f(o)?bQe(o):"",c=`${r}:${s}:${a}`,l;if(f(this._shaders[c]))l=this._shaders[c],delete this._shadersToRelease[c];else{let u=this._context,d=n.createCombinedVertexShader(u),h=i.createCombinedFragmentShader(u),_=new qt({gl:u._gl,logShaderCompilation:u.logShaderCompilation,debugShaders:u.debugShaders,vertexShaderSource:n,vertexShaderText:d,fragmentShaderSource:i,fragmentShaderText:h,attributeLocations:o});l={cache:this,shaderProgram:_,keyword:c,derivedKeywords:[],count:0},_._cachedShader=l,this._shaders[c]=l,++this._numberOfShaders}return++l.count,l.shaderProgram};gd.prototype.replaceDerivedShaderProgram=function(t,n,i){let o=t._cachedShader,r=n+o.keyword,s=this._shaders[r];if(f(s)){k7(this,s);let a=o.derivedKeywords.indexOf(n);a>-1&&o.derivedKeywords.splice(a,1)}return this.createDerivedShaderProgram(t,n,i)};gd.prototype.getDerivedShaderProgram=function(t,n){let i=t._cachedShader,o=n+i.keyword,r=this._shaders[o];if(!!f(r))return r.shaderProgram};gd.prototype.createDerivedShaderProgram=function(t,n,i){let o=t._cachedShader,r=n+o.keyword,s=i.vertexShaderSource,a=i.fragmentShaderSource,c=i.attributeLocations;typeof s=="string"&&(s=new ze({sources:[s]})),typeof a=="string"&&(a=new ze({sources:[a]}));let l=this._context,u=s.createCombinedVertexShader(l),d=a.createCombinedFragmentShader(l),h=new qt({gl:l._gl,logShaderCompilation:l.logShaderCompilation,debugShaders:l.debugShaders,vertexShaderSource:s,vertexShaderText:u,fragmentShaderSource:a,fragmentShaderText:d,attributeLocations:c}),_={cache:this,shaderProgram:h,keyword:r,derivedKeywords:[],count:0};return o.derivedKeywords.push(n),h._cachedShader=_,this._shaders[r]=_,h};function k7(t,n){let i=n.derivedKeywords,o=i.length;for(let r=0;r<o;++r){let s=i[r]+n.keyword,a=t._shaders[s];k7(t,a)}delete t._shaders[n.keyword],n.shaderProgram.finalDestroy()}gd.prototype.destroyReleasedShaderPrograms=function(){let t=this._shadersToRelease;for(let n in t)if(t.hasOwnProperty(n)){let i=t[n];k7(this,i),--this._numberOfShaders}this._shadersToRelease={}};gd.prototype.releaseShaderProgram=function(t){if(f(t)){let n=t._cachedShader;n&&--n.count===0&&(this._shadersToRelease[n.keyword]=n)}};gd.prototype.isDestroyed=function(){return!1};gd.prototype.destroy=function(){let t=this._shaders;for(let n in t)t.hasOwnProperty(n)&&t[n].shaderProgram.finalDestroy();return ue(this)};var CV=gd;function cA(){this._textures={},this._numberOfTextures=0,this._texturesToRelease={}}Object.defineProperties(cA.prototype,{numberOfTextures:{get:function(){return this._numberOfTextures}}});cA.prototype.getTexture=function(t){let n=this._textures[t];if(!!f(n))return delete this._texturesToRelease[t],++n.count,n.texture};cA.prototype.addTexture=function(t,n){let i={texture:n,count:1};n.finalDestroy=n.destroy;let o=this;n.destroy=function(){--i.count===0&&(o._texturesToRelease[t]=i)},this._textures[t]=i,++this._numberOfTextures};cA.prototype.destroyReleasedTextures=function(){let t=this._texturesToRelease;for(let n in t)if(t.hasOwnProperty(n)){let i=t[n];delete this._textures[n],i.texture.finalDestroy(),--this._numberOfTextures}this._texturesToRelease={}};cA.prototype.isDestroyed=function(){return!1};cA.prototype.destroy=function(){let t=this._textures;for(let n in t)t.hasOwnProperty(n)&&t[n].texture.finalDestroy();return ue(this)};var xV=cA;function SQe(t){t=A(t,A.EMPTY_OBJECT),this.color=z.clone(A(t.color,z.WHITE)),this.intensity=A(t.intensity,2)}var Ug=SQe;function lA(){this.globeDepthTexture=void 0,this.gamma=void 0,this._viewport=new He,this._viewportCartesian4=new se,this._viewportDirty=!1,this._viewportOrthographicMatrix=N.clone(N.IDENTITY),this._viewportTransformation=N.clone(N.IDENTITY),this._model=N.clone(N.IDENTITY),this._view=N.clone(N.IDENTITY),this._inverseView=N.clone(N.IDENTITY),this._projection=N.clone(N.IDENTITY),this._infiniteProjection=N.clone(N.IDENTITY),this._entireFrustum=new W,this._currentFrustum=new W,this._frustumPlanes=new se,this._farDepthFromNearPlusOne=void 0,this._log2FarDepthFromNearPlusOne=void 0,this._oneOverLog2FarDepthFromNearPlusOne=void 0,this._frameState=void 0,this._temeToPseudoFixed=$.clone(N.IDENTITY),this._view3DDirty=!0,this._view3D=new N,this._inverseView3DDirty=!0,this._inverseView3D=new N,this._inverseModelDirty=!0,this._inverseModel=new N,this._inverseTransposeModelDirty=!0,this._inverseTransposeModel=new $,this._viewRotation=new $,this._inverseViewRotation=new $,this._viewRotation3D=new $,this._inverseViewRotation3D=new $,this._inverseProjectionDirty=!0,this._inverseProjection=new N,this._modelViewDirty=!0,this._modelView=new N,this._modelView3DDirty=!0,this._modelView3D=new N,this._modelViewRelativeToEyeDirty=!0,this._modelViewRelativeToEye=new N,this._inverseModelViewDirty=!0,this._inverseModelView=new N,this._inverseModelView3DDirty=!0,this._inverseModelView3D=new N,this._viewProjectionDirty=!0,this._viewProjection=new N,this._inverseViewProjectionDirty=!0,this._inverseViewProjection=new N,this._modelViewProjectionDirty=!0,this._modelViewProjection=new N,this._inverseModelViewProjectionDirty=!0,this._inverseModelViewProjection=new N,this._modelViewProjectionRelativeToEyeDirty=!0,this._modelViewProjectionRelativeToEye=new N,this._modelViewInfiniteProjectionDirty=!0,this._modelViewInfiniteProjection=new N,this._normalDirty=!0,this._normal=new $,this._normal3DDirty=!0,this._normal3D=new $,this._inverseNormalDirty=!0,this._inverseNormal=new $,this._inverseNormal3DDirty=!0,this._inverseNormal3D=new $,this._encodedCameraPositionMCDirty=!0,this._encodedCameraPositionMC=new Hn,this._cameraPosition=new m,this._sunPositionWC=new m,this._sunPositionColumbusView=new m,this._sunDirectionWC=new m,this._sunDirectionEC=new m,this._moonDirectionEC=new m,this._lightDirectionWC=new m,this._lightDirectionEC=new m,this._lightColor=new m,this._lightColorHdr=new m,this._pass=void 0,this._mode=void 0,this._mapProjection=void 0,this._ellipsoid=void 0,this._cameraDirection=new m,this._cameraRight=new m,this._cameraUp=new m,this._frustum2DWidth=0,this._eyeHeight=0,this._eyeHeight2D=new W,this._pixelRatio=1,this._orthographicIn3D=!1,this._backgroundColor=new z,this._brdfLut=void 0,this._environmentMap=void 0,this._sphericalHarmonicCoefficients=void 0,this._specularEnvironmentMaps=void 0,this._specularEnvironmentMapsDimensions=new W,this._specularEnvironmentMapsMaximumLOD=void 0,this._fogDensity=void 0,this._invertClassificationColor=void 0,this._splitPosition=0,this._pixelSizePerMeter=void 0,this._geometricToleranceOverMeter=void 0,this._minimumDisableDepthTestDistance=void 0}Object.defineProperties(lA.prototype,{frameState:{get:function(){return this._frameState}},viewport:{get:function(){return this._viewport},set:function(t){if(!He.equals(t,this._viewport)){He.clone(t,this._viewport);let n=this._viewport,i=this._viewportCartesian4;i.x=n.x,i.y=n.y,i.z=n.width,i.w=n.height,this._viewportDirty=!0}}},viewportCartesian4:{get:function(){return this._viewportCartesian4}},viewportOrthographic:{get:function(){return Hhe(this),this._viewportOrthographicMatrix}},viewportTransformation:{get:function(){return Hhe(this),this._viewportTransformation}},model:{get:function(){return this._model},set:function(t){N.clone(t,this._model),this._modelView3DDirty=!0,this._inverseModelView3DDirty=!0,this._inverseModelDirty=!0,this._inverseTransposeModelDirty=!0,this._modelViewDirty=!0,this._inverseModelViewDirty=!0,this._modelViewRelativeToEyeDirty=!0,this._inverseModelViewDirty=!0,this._modelViewProjectionDirty=!0,this._inverseModelViewProjectionDirty=!0,this._modelViewProjectionRelativeToEyeDirty=!0,this._modelViewInfiniteProjectionDirty=!0,this._normalDirty=!0,this._inverseNormalDirty=!0,this._normal3DDirty=!0,this._inverseNormal3DDirty=!0,this._encodedCameraPositionMCDirty=!0}},inverseModel:{get:function(){return this._inverseModelDirty&&(this._inverseModelDirty=!1,N.inverse(this._model,this._inverseModel)),this._inverseModel}},inverseTransposeModel:{get:function(){let t=this._inverseTransposeModel;return this._inverseTransposeModelDirty&&(this._inverseTransposeModelDirty=!1,N.getMatrix3(this.inverseModel,t),$.transpose(t,t)),t}},view:{get:function(){return this._view}},view3D:{get:function(){return U7(this),this._view3D}},viewRotation:{get:function(){return U7(this),this._viewRotation}},viewRotation3D:{get:function(){return U7(this),this._viewRotation3D}},inverseView:{get:function(){return this._inverseView}},inverseView3D:{get:function(){return jhe(this),this._inverseView3D}},inverseViewRotation:{get:function(){return this._inverseViewRotation}},inverseViewRotation3D:{get:function(){return jhe(this),this._inverseViewRotation3D}},projection:{get:function(){return this._projection}},inverseProjection:{get:function(){return LQe(this),this._inverseProjection}},infiniteProjection:{get:function(){return this._infiniteProjection}},modelView:{get:function(){return FQe(this),this._modelView}},modelView3D:{get:function(){return NQe(this),this._modelView3D}},modelViewRelativeToEye:{get:function(){return GQe(this),this._modelViewRelativeToEye}},inverseModelView:{get:function(){return VQe(this),this._inverseModelView}},inverseModelView3D:{get:function(){return kQe(this),this._inverseModelView3D}},viewProjection:{get:function(){return UQe(this),this._viewProjection}},inverseViewProjection:{get:function(){return zQe(this),this._inverseViewProjection}},modelViewProjection:{get:function(){return HQe(this),this._modelViewProjection}},inverseModelViewProjection:{get:function(){return WQe(this),this._inverseModelViewProjection}},modelViewProjectionRelativeToEye:{get:function(){return jQe(this),this._modelViewProjectionRelativeToEye}},modelViewInfiniteProjection:{get:function(){return qQe(this),this._modelViewInfiniteProjection}},normal:{get:function(){return YQe(this),this._normal}},normal3D:{get:function(){return XQe(this),this._normal3D}},inverseNormal:{get:function(){return KQe(this),this._inverseNormal}},inverseNormal3D:{get:function(){return JQe(this),this._inverseNormal3D}},entireFrustum:{get:function(){return this._entireFrustum}},currentFrustum:{get:function(){return this._currentFrustum}},frustumPlanes:{get:function(){return this._frustumPlanes}},farDepthFromNearPlusOne:{get:function(){return this._farDepthFromNearPlusOne}},log2FarDepthFromNearPlusOne:{get:function(){return this._log2FarDepthFromNearPlusOne}},oneOverLog2FarDepthFromNearPlusOne:{get:function(){return this._oneOverLog2FarDepthFromNearPlusOne}},eyeHeight:{get:function(){return this._eyeHeight}},eyeHeight2D:{get:function(){return this._eyeHeight2D}},sunPositionWC:{get:function(){return this._sunPositionWC}},sunPositionColumbusView:{get:function(){return this._sunPositionColumbusView}},sunDirectionWC:{get:function(){return this._sunDirectionWC}},sunDirectionEC:{get:function(){return this._sunDirectionEC}},moonDirectionEC:{get:function(){return this._moonDirectionEC}},lightDirectionWC:{get:function(){return this._lightDirectionWC}},lightDirectionEC:{get:function(){return this._lightDirectionEC}},lightColor:{get:function(){return this._lightColor}},lightColorHdr:{get:function(){return this._lightColorHdr}},encodedCameraPositionMCHigh:{get:function(){return Whe(this),this._encodedCameraPositionMC.high}},encodedCameraPositionMCLow:{get:function(){return Whe(this),this._encodedCameraPositionMC.low}},temeToPseudoFixedMatrix:{get:function(){return this._temeToPseudoFixed}},pixelRatio:{get:function(){return this._pixelRatio}},fogDensity:{get:function(){return this._fogDensity}},geometricToleranceOverMeter:{get:function(){return this._geometricToleranceOverMeter}},pass:{get:function(){return this._pass}},backgroundColor:{get:function(){return this._backgroundColor}},brdfLut:{get:function(){return this._brdfLut}},environmentMap:{get:function(){return this._environmentMap}},sphericalHarmonicCoefficients:{get:function(){return this._sphericalHarmonicCoefficients}},specularEnvironmentMaps:{get:function(){return this._specularEnvironmentMaps}},specularEnvironmentMapsDimensions:{get:function(){return this._specularEnvironmentMapsDimensions}},specularEnvironmentMapsMaximumLOD:{get:function(){return this._specularEnvironmentMapsMaximumLOD}},splitPosition:{get:function(){return this._splitPosition}},minimumDisableDepthTestDistance:{get:function(){return this._minimumDisableDepthTestDistance}},invertClassificationColor:{get:function(){return this._invertClassificationColor}},orthographicIn3D:{get:function(){return this._orthographicIn3D}},ellipsoid:{get:function(){return A(this._ellipsoid,oe.WGS84)}}});function wQe(t,n){N.clone(n,t._view),N.getMatrix3(n,t._viewRotation),t._view3DDirty=!0,t._inverseView3DDirty=!0,t._modelViewDirty=!0,t._modelView3DDirty=!0,t._modelViewRelativeToEyeDirty=!0,t._inverseModelViewDirty=!0,t._inverseModelView3DDirty=!0,t._viewProjectionDirty=!0,t._inverseViewProjectionDirty=!0,t._modelViewProjectionDirty=!0,t._modelViewProjectionRelativeToEyeDirty=!0,t._modelViewInfiniteProjectionDirty=!0,t._normalDirty=!0,t._inverseNormalDirty=!0,t._normal3DDirty=!0,t._inverseNormal3DDirty=!0}function DQe(t,n){N.clone(n,t._inverseView),N.getMatrix3(n,t._inverseViewRotation)}function vQe(t,n){N.clone(n,t._projection),t._inverseProjectionDirty=!0,t._viewProjectionDirty=!0,t._inverseViewProjectionDirty=!0,t._modelViewProjectionDirty=!0,t._modelViewProjectionRelativeToEyeDirty=!0}function PQe(t,n){N.clone(n,t._infiniteProjection),t._modelViewInfiniteProjectionDirty=!0}function IQe(t,n){m.clone(n.positionWC,t._cameraPosition),m.clone(n.directionWC,t._cameraDirection),m.clone(n.rightWC,t._cameraRight),m.clone(n.upWC,t._cameraUp);let i=n.positionCartographic;f(i)?t._eyeHeight=i.height:t._eyeHeight=-t._ellipsoid.maximumRadius,t._encodedCameraPositionMCDirty=!0}var qD=new $,BQe=new de;function OQe(t,n){f(vt.computeIcrfToFixedMatrix(n.time,qD))||(qD=vt.computeTemeToPseudoFixedMatrix(n.time,qD));let i=sA.computeSunPositionInEarthInertialFrame(n.time,t._sunPositionWC);$.multiplyByVector(qD,i,i),m.normalize(i,t._sunDirectionWC),i=$.multiplyByVector(t.viewRotation3D,i,t._sunDirectionEC),m.normalize(i,i),i=sA.computeMoonPositionInEarthInertialFrame(n.time,t._moonDirectionEC),$.multiplyByVector(qD,i,i),$.multiplyByVector(t.viewRotation3D,i,i),m.normalize(i,i);let o=n.mapProjection,s=o.ellipsoid.cartesianToCartographic(t._sunPositionWC,BQe);o.project(s,t._sunPositionColumbusView)}lA.prototype.updateCamera=function(t){wQe(this,t.viewMatrix),DQe(this,t.inverseViewMatrix),IQe(this,t),this._entireFrustum.x=t.frustum.near,this._entireFrustum.y=t.frustum.far,this.updateFrustum(t.frustum),this._orthographicIn3D=this._mode!==ne.SCENE2D&&t.frustum instanceof $t};lA.prototype.updateFrustum=function(t){vQe(this,t.projectionMatrix),f(t.infiniteProjectionMatrix)&&PQe(this,t.infiniteProjectionMatrix),this._currentFrustum.x=t.near,this._currentFrustum.y=t.far,this._farDepthFromNearPlusOne=t.far-t.near+1,this._log2FarDepthFromNearPlusOne=B.log2(this._farDepthFromNearPlusOne),this._oneOverLog2FarDepthFromNearPlusOne=1/this._log2FarDepthFromNearPlusOne,f(t._offCenterFrustum)&&(t=t._offCenterFrustum),this._frustumPlanes.x=t.top,this._frustumPlanes.y=t.bottom,this._frustumPlanes.z=t.left,this._frustumPlanes.w=t.right};lA.prototype.updatePass=function(t){this._pass=t};lA.prototype.updateLightSource=function(t){let n=t.pointLight;for(let o=0;o<n.length;o++)n[o].positionEC=N.multiplyByPoint(this._view,n[o].position,n[o].positionEC);let i=t.spotLight;for(let o=0;o<i.length;o++){let r=i[o];r.positionEC=N.multiplyByPoint(this._view,r.position,r.positionEC),r.directionEC=$.multiplyByVector(this.viewRotation3D,r.direction,r.directionEC),m.normalize(r.directionEC,r.directionEC)}t.combineUniformValue()};var RQe=[],MQe=new Ug;lA.prototype.update=function(t){this._mode=t.mode,this._mapProjection=t.mapProjection,this._ellipsoid=t.mapProjection.ellipsoid,this._pixelRatio=t.pixelRatio;let n=t.camera;this.updateCamera(n),t.mode===ne.SCENE2D?(this._frustum2DWidth=n.frustum.right-n.frustum.left,this._eyeHeight2D.x=this._frustum2DWidth*.5,this._eyeHeight2D.y=this._eyeHeight2D.x*this._eyeHeight2D.x):(this._frustum2DWidth=0,this._eyeHeight2D.x=0,this._eyeHeight2D.y=0),xt.updateLight(this),this.updateLightSource(t.lightSource),OQe(this,t);let i=A(t.light,MQe);i instanceof Ug?(this._lightDirectionWC=m.clone(this._sunDirectionWC,this._lightDirectionWC),this._lightDirectionEC=m.clone(this._sunDirectionEC,this._lightDirectionEC)):(this._lightDirectionWC=m.normalize(m.negate(i.direction,this._lightDirectionWC),this._lightDirectionWC),this._lightDirectionEC=$.multiplyByVector(this.viewRotation3D,this._lightDirectionWC,this._lightDirectionEC));let o=i.color,r=m.fromElements(o.red,o.green,o.blue,this._lightColorHdr);r=m.multiplyByScalar(r,i.intensity,r);let s=m.maximumComponent(r);s>1?m.divideByScalar(r,s,this._lightColor):m.clone(r,this._lightColor);let a=t.brdfLutGenerator,c=f(a)?a.colorTexture:void 0;this._brdfLut=c,this._environmentMap=A(t.environmentMap,t.context.defaultCubeMap),this._sphericalHarmonicCoefficients=A(t.sphericalHarmonicCoefficients,RQe),this._specularEnvironmentMaps=t.specularEnvironmentMaps,this._specularEnvironmentMapsMaximumLOD=t.specularEnvironmentMapsMaximumLOD,f(this._specularEnvironmentMaps)&&W.clone(this._specularEnvironmentMaps.dimensions,this._specularEnvironmentMapsDimensions),this._fogDensity=t.fog.density,this._invertClassificationColor=t.invertClassificationColor,this._frameState=t,this._temeToPseudoFixed=vt.computeTemeToPseudoFixedMatrix(t.time,this._temeToPseudoFixed),this._splitPosition=t.splitPosition*t.context.drawingBufferWidth;let l=n.frustum.fov,u=this._viewport,d;f(l)?u.height>u.width?d=Math.tan(.5*l)*2/u.height:d=Math.tan(.5*l)*2/u.width:d=1/Math.max(u.width,u.height),this._geometricToleranceOverMeter=d*t.maximumScreenSpaceError,z.clone(t.backgroundColor,this._backgroundColor),this._minimumDisableDepthTestDistance=t.minimumDisableDepthTestDistance,this._minimumDisableDepthTestDistance*=this._minimumDisableDepthTestDistance,this._minimumDisableDepthTestDistance===Number.POSITIVE_INFINITY&&(this._minimumDisableDepthTestDistance=-1)};function Hhe(t){if(t._viewportDirty){let n=t._viewport;N.computeOrthographicOffCenter(n.x,n.x+n.width,n.y,n.y+n.height,0,1,t._viewportOrthographicMatrix),N.computeViewportTransformation(n,0,1,t._viewportTransformation),t._viewportDirty=!1}}function LQe(t){t._inverseProjectionDirty&&(t._inverseProjectionDirty=!1,t._mode!==ne.SCENE2D&&t._mode!==ne.MORPHING&&!t._orthographicIn3D?N.inverse(t._projection,t._inverseProjection):N.clone(N.ZERO,t._inverseProjection))}function FQe(t){t._modelViewDirty&&(t._modelViewDirty=!1,N.multiplyTransformation(t._view,t._model,t._modelView))}function NQe(t){t._modelView3DDirty&&(t._modelView3DDirty=!1,N.multiplyTransformation(t.view3D,t._model,t._modelView3D))}function VQe(t){t._inverseModelViewDirty&&(t._inverseModelViewDirty=!1,N.inverse(t.modelView,t._inverseModelView))}function kQe(t){t._inverseModelView3DDirty&&(t._inverseModelView3DDirty=!1,N.inverse(t.modelView3D,t._inverseModelView3D))}function UQe(t){t._viewProjectionDirty&&(t._viewProjectionDirty=!1,N.multiply(t._projection,t._view,t._viewProjection))}function zQe(t){t._inverseViewProjectionDirty&&(t._inverseViewProjectionDirty=!1,N.inverse(t.viewProjection,t._inverseViewProjection))}function HQe(t){t._modelViewProjectionDirty&&(t._modelViewProjectionDirty=!1,N.multiply(t._projection,t.modelView,t._modelViewProjection))}function GQe(t){if(t._modelViewRelativeToEyeDirty){t._modelViewRelativeToEyeDirty=!1;let n=t.modelView,i=t._modelViewRelativeToEye;i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[4]=n[4],i[5]=n[5],i[6]=n[6],i[7]=n[7],i[8]=n[8],i[9]=n[9],i[10]=n[10],i[11]=n[11],i[12]=0,i[13]=0,i[14]=0,i[15]=n[15]}}function WQe(t){t._inverseModelViewProjectionDirty&&(t._inverseModelViewProjectionDirty=!1,N.inverse(t.modelViewProjection,t._inverseModelViewProjection))}function jQe(t){t._modelViewProjectionRelativeToEyeDirty&&(t._modelViewProjectionRelativeToEyeDirty=!1,N.multiply(t._projection,t.modelViewRelativeToEye,t._modelViewProjectionRelativeToEye))}function qQe(t){t._modelViewInfiniteProjectionDirty&&(t._modelViewInfiniteProjectionDirty=!1,N.multiply(t._infiniteProjection,t.modelView,t._modelViewInfiniteProjection))}function YQe(t){if(t._normalDirty){t._normalDirty=!1;let n=t._normal;N.getMatrix3(t.inverseModelView,n),$.getRotation(n,n),$.transpose(n,n)}}function XQe(t){if(t._normal3DDirty){t._normal3DDirty=!1;let n=t._normal3D;N.getMatrix3(t.inverseModelView3D,n),$.getRotation(n,n),$.transpose(n,n)}}function KQe(t){t._inverseNormalDirty&&(t._inverseNormalDirty=!1,N.getMatrix3(t.inverseModelView,t._inverseNormal),$.getRotation(t._inverseNormal,t._inverseNormal))}function JQe(t){t._inverseNormal3DDirty&&(t._inverseNormal3DDirty=!1,N.getMatrix3(t.inverseModelView3D,t._inverseNormal3D),$.getRotation(t._inverseNormal3D,t._inverseNormal3D))}var Ghe=new m;function Whe(t){t._encodedCameraPositionMCDirty&&(t._encodedCameraPositionMCDirty=!1,N.multiplyByPoint(t.inverseModel,t._cameraPosition,Ghe),Hn.fromCartesian(Ghe,t._encodedCameraPositionMC))}var ZQe=new m,QQe=new m,$Qe=new m,e$e=new m,t$e=new de,n$e=new m,i$e=new N;function o$e(t,n,i,o,r,s,a,c){let l=ZQe;l.x=t.y,l.y=t.z,l.z=t.x;let u=QQe;u.x=i.y,u.y=i.z,u.z=i.x;let d=$Qe;d.x=o.y,d.y=o.z,d.z=o.x;let h=e$e;h.x=n.y,h.y=n.z,h.z=n.x,s===ne.SCENE2D&&(l.z=r*.5);let _=a.unproject(l,t$e);_.longitude=B.clamp(_.longitude,-Math.PI,Math.PI),_.latitude=B.clamp(_.latitude,-B.PI_OVER_TWO,B.PI_OVER_TWO);let y=a.ellipsoid,p=y.cartographicToCartesian(_,n$e),C=vt.eastNorthUpToFixedFrame(p,y,i$e);return N.multiplyByPointAsVector(C,u,u),N.multiplyByPointAsVector(C,d,d),N.multiplyByPointAsVector(C,h,h),f(c)||(c=new N),c[0]=u.x,c[1]=d.x,c[2]=-h.x,c[3]=0,c[4]=u.y,c[5]=d.y,c[6]=-h.y,c[7]=0,c[8]=u.z,c[9]=d.z,c[10]=-h.z,c[11]=0,c[12]=-m.dot(u,p),c[13]=-m.dot(d,p),c[14]=m.dot(h,p),c[15]=1,c}function U7(t){t._view3DDirty&&(t._mode===ne.SCENE3D?N.clone(t._view,t._view3D):o$e(t._cameraPosition,t._cameraDirection,t._cameraRight,t._cameraUp,t._frustum2DWidth,t._mode,t._mapProjection,t._view3D),N.getMatrix3(t._view3D,t._viewRotation3D),t._view3DDirty=!1)}function jhe(t){t._inverseView3DDirty&&(N.inverseTransformation(t.view3D,t._inverseView3D),N.getMatrix3(t._inverseView3D,t._inverseViewRotation3D),t._inverseView3DDirty=!1)}var TV=lA;function r$e(t,n){let i="WebGL Error:  ";switch(n){case t.INVALID_ENUM:i+="INVALID_ENUM";break;case t.INVALID_VALUE:i+="INVALID_VALUE";break;case t.INVALID_OPERATION:i+="INVALID_OPERATION";break;case t.OUT_OF_MEMORY:i+="OUT_OF_MEMORY";break;case t.CONTEXT_LOST_WEBGL:i+="CONTEXT_LOST_WEBGL lost";break;default:i+=`Unknown (${n})`}return i}function s$e(t,n,i,o){let r=`${r$e(t,o)}: ${n.name}(`;for(let s=0;s<i.length;++s)s!==0&&(r+=", "),r+=i[s];return r+=");",r}function a$e(t,n,i){let o=t.getError();if(o!==t.NO_ERROR)throw new he(s$e(t,n,i,o))}function c$e(t,n,i){return{get:function(){let o=t[n];return i(t,`get: ${n}`,o),t[n]},set:function(o){t[n]=o,i(t,`set: ${n}`,o)}}}function l$e(t,n){if(!f(n))return t;function i(r){return function(){let s=r.apply(t,arguments);return n(t,r,arguments),s}}let o={};for(let r in t){let s=t[r];s instanceof Function?o[r]=i(s):Object.defineProperty(o,r,c$e(t,r,n))}return o}function Sr(t,n){let i=n.length;for(let o=0;o<i;++o){let r=t.getExtension(n[o]);if(r)return r}}function rf(t,n){if(typeof WebGLRenderingContext=="undefined")throw new he("The browser does not support WebGL.  Visit http://get.webgl.org.");this._canvas=t,n=tt(n,!0),n=A(n,{}),n.allowTextureFilterAnisotropic=A(n.allowTextureFilterAnisotropic,!0);let i=A(n.webgl,{});i.alpha=A(i.alpha,!1),i.stencil=A(i.stencil,!0);let o=A(n.requestWebgl2,!1)&&typeof WebGL2RenderingContext!="undefined",r=!1,s,a=n.getWebGLStub;if(f(a))s=a(t,i);else if(o&&(s=t.getContext("webgl2",i)||t.getContext("experimental-webgl2",i)||void 0,f(s)&&(r=!0)),f(s)||(s=t.getContext("webgl",i)||t.getContext("experimental-webgl",i)||void 0),!f(s))throw new he("The browser supports WebGL, but initialization failed.");this._originalGLContext=s,this._gl=s,this._webgl2=r,this._id=Bn(),this.validateFramebuffer=!1,this.validateShaderProgram=!1,this.logShaderCompilation=!1,this._throwOnWebGLError=!1,this._shaderCache=new CV(this),this._textureCache=new xV;let c=s;this._stencilBits=c.getParameter(c.STENCIL_BITS),Ut._maximumCombinedTextureImageUnits=c.getParameter(c.MAX_COMBINED_TEXTURE_IMAGE_UNITS),Ut._maximumCubeMapSize=c.getParameter(c.MAX_CUBE_MAP_TEXTURE_SIZE),Ut._maximumFragmentUniformVectors=c.getParameter(c.MAX_FRAGMENT_UNIFORM_VECTORS),Ut._maximumTextureImageUnits=c.getParameter(c.MAX_TEXTURE_IMAGE_UNITS),Ut._maximumRenderbufferSize=c.getParameter(c.MAX_RENDERBUFFER_SIZE),Ut._maximumTextureSize=c.getParameter(c.MAX_TEXTURE_SIZE),Ut._maximumVaryingVectors=c.getParameter(c.MAX_VARYING_VECTORS),Ut._maximumVertexAttributes=c.getParameter(c.MAX_VERTEX_ATTRIBS),Ut._maximumVertexTextureImageUnits=c.getParameter(c.MAX_VERTEX_TEXTURE_IMAGE_UNITS),Ut._maximumVertexUniformVectors=c.getParameter(c.MAX_VERTEX_UNIFORM_VECTORS),Ut._maximumSamples=this._webgl2?c.getParameter(c.MAX_SAMPLES):0;let l=c.getParameter(c.ALIASED_LINE_WIDTH_RANGE);Ut._minimumAliasedLineWidth=l[0],Ut._maximumAliasedLineWidth=l[1];let u=c.getParameter(c.ALIASED_POINT_SIZE_RANGE);Ut._minimumAliasedPointSize=u[0],Ut._maximumAliasedPointSize=u[1];let d=c.getParameter(c.MAX_VIEWPORT_DIMS);Ut._maximumViewportWidth=d[0],Ut._maximumViewportHeight=d[1];let h=c.getShaderPrecisionFormat(c.FRAGMENT_SHADER,c.HIGH_FLOAT);Ut._highpFloatSupported=h.precision!==0;let _=c.getShaderPrecisionFormat(c.FRAGMENT_SHADER,c.HIGH_INT);Ut._highpIntSupported=_.rangeMax!==0,this._antialias=c.getContextAttributes().antialias,this._standardDerivatives=!!Sr(c,["OES_standard_derivatives"]),this._blendMinmax=!!Sr(c,["EXT_blend_minmax"]),this._elementIndexUint=!!Sr(c,["OES_element_index_uint"]),this._depthTexture=!!Sr(c,["WEBGL_depth_texture","WEBKIT_WEBGL_depth_texture"]),this._fragDepth=!!Sr(c,["EXT_frag_depth"]),this._debugShaders=Sr(c,["WEBGL_debug_shaders"]),this._textureFloat=!!Sr(c,["OES_texture_float"]),this._textureHalfFloat=!!Sr(c,["OES_texture_half_float"]),this._textureFloatLinear=!!Sr(c,["OES_texture_float_linear"]),this._textureHalfFloatLinear=!!Sr(c,["OES_texture_half_float_linear"]),this._colorBufferFloat=!!Sr(c,["EXT_color_buffer_float","WEBGL_color_buffer_float"]),this._floatBlend=!!Sr(c,["EXT_float_blend"]),this._colorBufferHalfFloat=!!Sr(c,["EXT_color_buffer_half_float"]),this._s3tc=!!Sr(c,["WEBGL_compressed_texture_s3tc","MOZ_WEBGL_compressed_texture_s3tc","WEBKIT_WEBGL_compressed_texture_s3tc"]),this._pvrtc=!!Sr(c,["WEBGL_compressed_texture_pvrtc","WEBKIT_WEBGL_compressed_texture_pvrtc"]),this._astc=!!Sr(c,["WEBGL_compressed_texture_astc"]),this._etc=!!Sr(c,["WEBG_compressed_texture_etc"]),this._etc1=!!Sr(c,["WEBGL_compressed_texture_etc1"]),this._bc7=!!Sr(c,["EXT_texture_compression_bptc"]),xl.setKTX2SupportedFormats(this._s3tc,this._pvrtc,this._astc,this._etc,this._etc1,this._bc7);let y=n.allowTextureFilterAnisotropic?Sr(c,["EXT_texture_filter_anisotropic","WEBKIT_EXT_texture_filter_anisotropic"]):void 0;this._textureFilterAnisotropic=y,Ut._maximumTextureFilterAnisotropy=f(y)?c.getParameter(y.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1;let p,C,x,T,E,S,w,D,I,O;if(r){let g=this;p=function(){return g._gl.createVertexArray()},C=function(b){g._gl.bindVertexArray(b)},x=function(b){g._gl.deleteVertexArray(b)},T=function(b,v,P,R,V){c.drawElementsInstanced(b,v,P,R,V)},E=function(b,v,P,R){c.drawArraysInstanced(b,v,P,R)},S=function(b,v){c.vertexAttribDivisor(b,v)},w=function(b){c.drawBuffers(b)}}else D=Sr(c,["OES_vertex_array_object"]),f(D)&&(p=function(){return D.createVertexArrayOES()},C=function(g){D.bindVertexArrayOES(g)},x=function(g){D.deleteVertexArrayOES(g)}),I=Sr(c,["ANGLE_instanced_arrays"]),f(I)&&(T=function(g,b,v,P,R){I.drawElementsInstancedANGLE(g,b,v,P,R)},E=function(g,b,v,P){I.drawArraysInstancedANGLE(g,b,v,P)},S=function(g,b){I.vertexAttribDivisorANGLE(g,b)}),O=Sr(c,["WEBGL_draw_buffers"]),f(O)&&(w=function(g){O.drawBuffersWEBGL(g)});this.glCreateVertexArray=p,this.glBindVertexArray=C,this.glDeleteVertexArray=x,this.glDrawElementsInstanced=T,this.glDrawArraysInstanced=E,this.glVertexAttribDivisor=S,this.glDrawBuffers=w,this._vertexArrayObject=!!D,this._instancedArrays=!!I,this._drawBuffers=!!O,Ut._maximumDrawBuffers=this.drawBuffers?c.getParameter(ee.MAX_DRAW_BUFFERS):1,Ut._maximumColorAttachments=this.drawBuffers?c.getParameter(ee.MAX_COLOR_ATTACHMENTS):1,this._clearColor=new z(0,0,0,0),this._clearDepth=1,this._clearStencil=0;let M=new TV,L=new wc(this),F=Ve.fromCache();this._defaultPassState=L,this._defaultRenderState=F,this._defaultTexture=void 0,this._defaultEmissiveTexture=void 0,this._defaultNormalTexture=void 0,this._defaultCubeMap=void 0,this._us=M,this._currentRenderState=F,this._currentPassState=L,this._currentFramebuffer=void 0,this._maxFrameTextureUnitIndex=0,this._vertexAttribDivisors=[],this._previousDrawInstanced=!1;for(let g=0;g<Ut._maximumVertexAttributes;g++)this._vertexAttribDivisors.push(0);this._pickObjects={},this._nextPickColor=new Uint32Array(1),this.options=n,this.cache={},Ve.apply(c,F,L)}var u$e={};Object.defineProperties(rf.prototype,{id:{get:function(){return this._id}},webgl2:{get:function(){return this._webgl2}},canvas:{get:function(){return this._canvas}},shaderCache:{get:function(){return this._shaderCache}},textureCache:{get:function(){return this._textureCache}},uniformState:{get:function(){return this._us}},stencilBits:{get:function(){return this._stencilBits}},stencilBuffer:{get:function(){return this._stencilBits>=8}},antialias:{get:function(){return this._antialias}},msaa:{get:function(){return this._webgl2}},standardDerivatives:{get:function(){return this._standardDerivatives||this._webgl2}},floatBlend:{get:function(){return this._floatBlend}},blendMinmax:{get:function(){return this._blendMinmax||this._webgl2}},elementIndexUint:{get:function(){return this._elementIndexUint||this._webgl2}},depthTexture:{get:function(){return this._depthTexture||this._webgl2}},floatingPointTexture:{get:function(){return this._webgl2||this._textureFloat}},halfFloatingPointTexture:{get:function(){return this._webgl2||this._textureHalfFloat}},textureFloatLinear:{get:function(){return this._textureFloatLinear}},textureHalfFloatLinear:{get:function(){return this._webgl2&&this._textureFloatLinear||!this._webgl2&&this._textureHalfFloatLinear}},textureFilterAnisotropic:{get:function(){return!!this._textureFilterAnisotropic}},s3tc:{get:function(){return this._s3tc}},pvrtc:{get:function(){return this._pvrtc}},astc:{get:function(){return this._astc}},etc:{get:function(){return this._etc}},etc1:{get:function(){return this._etc1}},bc7:{get:function(){return this._bc7}},supportsBasis:{get:function(){return this._s3tc||this._pvrtc||this._astc||this._etc||this._etc1||this._bc7}},vertexArrayObject:{get:function(){return this._vertexArrayObject||this._webgl2}},fragmentDepth:{get:function(){return this._fragDepth||this._webgl2}},instancedArrays:{get:function(){return this._instancedArrays||this._webgl2}},colorBufferFloat:{get:function(){return this._colorBufferFloat}},colorBufferHalfFloat:{get:function(){return this._webgl2&&this._colorBufferFloat||!this._webgl2&&this._colorBufferHalfFloat}},drawBuffers:{get:function(){return this._drawBuffers||this._webgl2}},debugShaders:{get:function(){return this._debugShaders}},throwOnWebGLError:{get:function(){return this._throwOnWebGLError},set:function(t){this._throwOnWebGLError=t,this._gl=l$e(this._originalGLContext,t?a$e:void 0)}},defaultTexture:{get:function(){return this._defaultTexture===void 0&&(this._defaultTexture=new St({context:this,source:{width:1,height:1,arrayBufferView:new Uint8Array([255,255,255,255])},flipY:!1})),this._defaultTexture}},defaultEmissiveTexture:{get:function(){return this._defaultEmissiveTexture===void 0&&(this._defaultEmissiveTexture=new St({context:this,pixelFormat:st.RGB,source:{width:1,height:1,arrayBufferView:new Uint8Array([0,0,0])},flipY:!1})),this._defaultEmissiveTexture}},defaultNormalTexture:{get:function(){return this._defaultNormalTexture===void 0&&(this._defaultNormalTexture=new St({context:this,pixelFormat:st.RGB,source:{width:1,height:1,arrayBufferView:new Uint8Array([128,128,255])},flipY:!1})),this._defaultNormalTexture}},defaultCubeMap:{get:function(){if(this._defaultCubeMap===void 0){let t={width:1,height:1,arrayBufferView:new Uint8Array([255,255,255,255])};this._defaultCubeMap=new tc({context:this,source:{positiveX:t,negativeX:t,positiveY:t,negativeY:t,positiveZ:t,negativeZ:t},flipY:!1})}return this._defaultCubeMap}},drawingBufferHeight:{get:function(){return this._gl.drawingBufferHeight}},drawingBufferWidth:{get:function(){return this._gl.drawingBufferWidth}},defaultFramebuffer:{get:function(){return u$e}}});function qhe(t,n,i,o){let r=t._currentRenderState,s=t._currentPassState;t._currentRenderState=n,t._currentPassState=i,Ve.partialApply(t._gl,r,n,s,i,o)}var z7;typeof WebGLRenderingContext!="undefined"&&(z7=[ee.BACK]);function H7(t,n){if(n!==t._currentFramebuffer){t._currentFramebuffer=n;let i=z7;if(f(n))n._bind(),i=n._getActiveColorAttachments();else{let o=t._gl;o.bindFramebuffer(o.FRAMEBUFFER,null)}t.drawBuffers&&t.glDrawBuffers(i)}}var f$e=new Qn;rf.prototype.clear=function(t,n){t=A(t,f$e),n=A(n,this._defaultPassState);let i=this._gl,o=0,r=t.color,s=t.depth,a=t.stencil;f(r)&&(z.equals(this._clearColor,r)||(z.clone(r,this._clearColor),i.clearColor(r.red,r.green,r.blue,r.alpha)),o|=i.COLOR_BUFFER_BIT),f(s)&&(s!==this._clearDepth&&(this._clearDepth=s,i.clearDepth(s)),o|=i.DEPTH_BUFFER_BIT),f(a)&&(a!==this._clearStencil&&(this._clearStencil=a,i.clearStencil(a)),o|=i.STENCIL_BUFFER_BIT);let c=A(t.renderState,this._defaultRenderState);qhe(this,c,n,!0);let l=A(t.framebuffer,n.framebuffer);H7(this,l),i.clear(o)};function d$e(t,n,i,o,r){H7(t,n),qhe(t,r,i,!1),o._bind(),t._maxFrameTextureUnitIndex=Math.max(t._maxFrameTextureUnitIndex,o.maximumTextureUnitIndex)}function h$e(t,n,i,o){let r=n._primitiveType,s=n._vertexArray,a=n._offset,c=n._count,l=n.instanceCount;t._us.model=A(n._modelMatrix,N.IDENTITY),i._setUniforms(o,t._us,t.validateShaderProgram),s._bind();let u=s.indexBuffer;f(u)?(a=a*u.bytesPerIndex,c=A(c,u.numberOfIndices),l===0?t._gl.drawElements(r,c,u.indexDatatype,a):t.glDrawElementsInstanced(r,c,u.indexDatatype,a,l)):(c=A(c,s.numberOfVertices),l===0?t._gl.drawArrays(r,a,c):t.glDrawArraysInstanced(r,a,c,l)),s._unBind()}rf.prototype.draw=function(t,n,i,o){n=A(n,this._defaultPassState);let r=A(t._framebuffer,n.framebuffer),s=A(t._renderState,this._defaultRenderState);i=A(i,t._shaderProgram),o=A(o,t._uniformMap),d$e(this,r,n,i,s),h$e(this,t,i,o)};rf.prototype.endFrame=function(){let t=this._gl;t.useProgram(null),this._currentFramebuffer=void 0,t.bindFramebuffer(t.FRAMEBUFFER,null);let n=z7;this.drawBuffers&&this.glDrawBuffers(n);let i=this._maxFrameTextureUnitIndex;this._maxFrameTextureUnitIndex=0;for(let o=0;o<i;++o)t.activeTexture(t.TEXTURE0+o),t.bindTexture(t.TEXTURE_2D,null),t.bindTexture(t.TEXTURE_CUBE_MAP,null)};rf.prototype.readPixels=function(t){let n=this._gl;t=A(t,A.EMPTY_OBJECT);let i=Math.max(A(t.x,0),0),o=Math.max(A(t.y,0),0),r=A(t.width,n.drawingBufferWidth),s=A(t.height,n.drawingBufferHeight),a=t.framebuffer,c=je.UNSIGNED_BYTE;f(a)&&a.numberOfColorAttachments>0&&(c=a.getColorTexture(0).pixelDatatype);let l=st.createTypedArray(st.RGBA,c,r,s);return H7(this,a),n.readPixels(i,o,r,s,st.RGBA,je.toWebGLConstant(c,this),l),l};var Yhe={position:0,textureCoordinates:1};rf.prototype.getViewportQuadVertexArray=function(){let t=this.cache.viewportQuad_vertexArray;if(!f(t)){let n=new at({attributes:{position:new we({componentDatatype:J.FLOAT,componentsPerAttribute:2,values:[-1,-1,1,-1,1,1,-1,1]}),textureCoordinates:new we({componentDatatype:J.FLOAT,componentsPerAttribute:2,values:[0,0,1,0,1,1,0,1]})},indices:new Uint16Array([0,1,2,0,2,3]),primitiveType:Re.TRIANGLES});t=$n.fromGeometry({context:this,geometry:n,attributeLocations:Yhe,bufferUsage:Fe.STATIC_DRAW,interleave:!0}),this.cache.viewportQuad_vertexArray=t}return t};rf.prototype.createViewportQuadCommand=function(t,n){return n=A(n,A.EMPTY_OBJECT),new et({vertexArray:this.getViewportQuadVertexArray(),primitiveType:Re.TRIANGLES,renderState:n.renderState,shaderProgram:qt.fromCache({context:this,vertexShaderSource:wE,fragmentShaderSource:t,attributeLocations:Yhe}),uniformMap:n.uniformMap,owner:n.owner,framebuffer:n.framebuffer,pass:n.pass})};rf.prototype.getObjectByPickColor=function(t){return this._pickObjects[t.toRgba()]};function G7(t,n,i){this._pickObjects=t,this.key=n,this.color=i}Object.defineProperties(G7.prototype,{object:{get:function(){return this._pickObjects[this.key]},set:function(t){this._pickObjects[this.key]=t}}});G7.prototype.destroy=function(){delete this._pickObjects[this.key]};rf.prototype.createPickId=function(t){++this._nextPickColor[0];let n=this._nextPickColor[0];if(n===0)throw new he("Out of unique Pick IDs.");return this._pickObjects[n]=t,new G7(this._pickObjects,n,z.fromRgba(n))};rf.prototype.isDestroyed=function(){return!1};rf.prototype.destroy=function(){let t=this.cache;for(let n in t)if(t.hasOwnProperty(n)){let i=t[n];f(i.destroy)&&i.destroy()}return this._shaderCache=this._shaderCache.destroy(),this._textureCache=this._textureCache.destroy(),this._defaultTexture=this._defaultTexture&&this._defaultTexture.destroy(),this._defaultEmissiveTexture=this._defaultEmissiveTexture&&this._defaultEmissiveTexture.destroy(),this._defaultNormalTexture=this._defaultNormalTexture&&this._defaultNormalTexture.destroy(),this._defaultCubeMap=this._defaultCubeMap&&this._defaultCubeMap.destroy(),ue(this)};var EV=rf;var YD;typeof ko!="undefined"&&(YD=ko);(function(){/*!
 * Knockout JavaScript library v3.5.1
 * (c) The Knockout.js team - http://knockoutjs.com/
 * License: MIT (http://www.opensource.org/licenses/mit-license.php)
 */(function(){(function(t){var n=this||(0,eval)("this"),i=n.document,o=n.navigator,r=n.jQuery,s=n.JSON;r||typeof jQuery=="undefined"||(r=jQuery),function(a){a(n.ko={})}(function(a,c){function l(g,b){return g===null||typeof g in C?g===b:!1}function u(g,b){var v;return function(){v||(v=p.a.setTimeout(function(){v=t,g()},b))}}function d(g,b){var v;return function(){clearTimeout(v),v=p.a.setTimeout(g,b)}}function h(g,b){b&&b!=="change"?b==="beforeChange"?this.pc(g):this.gb(g,b):this.qc(g)}function _(g,b){b!==null&&b.s&&b.s()}function y(g,b){var v=this.qd,P=v[w];P.ra||(this.Qb&&this.mb[b]?(v.uc(b,g,this.mb[b]),this.mb[b]=null,--this.Qb):P.I[b]||v.uc(b,g,P.J?{da:g}:v.$c(g)),g.Ja&&g.gd())}var p=typeof a!="undefined"?a:{};p.b=function(g,b){for(var v=g.split("."),P=p,R=0;R<v.length-1;R++)P=P[v[R]];P[v[v.length-1]]=b},p.L=function(g,b,v){g[b]=v},p.version="3.5.1",p.b("version",p.version),p.options={deferUpdates:!1,useOnlyNativeEvents:!1,foreachHidesDestroyed:!1},p.a=function(){function g(j,Z){for(var Q in j)R.call(j,Q)&&Z(Q,j[Q])}function b(j,Z){if(Z)for(var Q in Z)R.call(Z,Q)&&(j[Q]=Z[Q]);return j}function v(j,Z){return j.__proto__=Z,j}function P(j,Z,Q,me){var _e=j[Z].match(Y)||[];p.a.D(Q.match(Y),function(re){p.a.Na(_e,re,me)}),j[Z]=_e.join(" ")}var R=Object.prototype.hasOwnProperty,V={__proto__:[]}instanceof Array,H=typeof Symbol=="function",U={},G={};U[o&&/Firefox\/2/i.test(o.userAgent)?"KeyboardEvent":"UIEvents"]=["keyup","keydown","keypress"],U.MouseEvents="click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave".split(" "),g(U,function(j,Z){if(Z.length)for(var Q=0,me=Z.length;Q<me;Q++)G[Z[Q]]=j});var k={propertychange:!0},X=i&&function(){for(var j=3,Z=i.createElement("div"),Q=Z.getElementsByTagName("i");Z.innerHTML="<!--[if gt IE "+ ++j+"]><i></i><![endif]-->",Q[0];);return 4<j?j:t}(),Y=/\S+/g,K;return{Jc:["authenticity_token",/^__RequestVerificationToken(_.*)?$/],D:function(j,Z,Q){for(var me=0,_e=j.length;me<_e;me++)Z.call(Q,j[me],me,j)},A:typeof Array.prototype.indexOf=="function"?function(j,Z){return Array.prototype.indexOf.call(j,Z)}:function(j,Z){for(var Q=0,me=j.length;Q<me;Q++)if(j[Q]===Z)return Q;return-1},Lb:function(j,Z,Q){for(var me=0,_e=j.length;me<_e;me++)if(Z.call(Q,j[me],me,j))return j[me];return t},Pa:function(j,Z){var Q=p.a.A(j,Z);0<Q?j.splice(Q,1):Q===0&&j.shift()},wc:function(j){var Z=[];return j&&p.a.D(j,function(Q){0>p.a.A(Z,Q)&&Z.push(Q)}),Z},Mb:function(j,Z,Q){var me=[];if(j)for(var _e=0,re=j.length;_e<re;_e++)me.push(Z.call(Q,j[_e],_e));return me},jb:function(j,Z,Q){var me=[];if(j)for(var _e=0,re=j.length;_e<re;_e++)Z.call(Q,j[_e],_e)&&me.push(j[_e]);return me},Nb:function(j,Z){if(Z instanceof Array)j.push.apply(j,Z);else for(var Q=0,me=Z.length;Q<me;Q++)j.push(Z[Q]);return j},Na:function(j,Z,Q){var me=p.a.A(p.a.bc(j),Z);0>me?Q&&j.push(Z):Q||j.splice(me,1)},Ba:V,extend:b,setPrototypeOf:v,Ab:V?v:b,P:g,Ga:function(j,Z,Q){if(!j)return j;var me={},_e;for(_e in j)R.call(j,_e)&&(me[_e]=Z.call(Q,j[_e],_e,j));return me},Tb:function(j){for(;j.firstChild;)p.removeNode(j.firstChild)},Yb:function(j){j=p.a.la(j);for(var Z=(j[0]&&j[0].ownerDocument||i).createElement("div"),Q=0,me=j.length;Q<me;Q++)Z.appendChild(p.oa(j[Q]));return Z},Ca:function(j,Z){for(var Q=0,me=j.length,_e=[];Q<me;Q++){var re=j[Q].cloneNode(!0);_e.push(Z?p.oa(re):re)}return _e},va:function(j,Z){if(p.a.Tb(j),Z)for(var Q=0,me=Z.length;Q<me;Q++)j.appendChild(Z[Q])},Xc:function(j,Z){var Q=j.nodeType?[j]:j;if(0<Q.length){for(var me=Q[0],_e=me.parentNode,re=0,fe=Z.length;re<fe;re++)_e.insertBefore(Z[re],me);for(re=0,fe=Q.length;re<fe;re++)p.removeNode(Q[re])}},Ua:function(j,Z){if(j.length){for(Z=Z.nodeType===8&&Z.parentNode||Z;j.length&&j[0].parentNode!==Z;)j.splice(0,1);for(;1<j.length&&j[j.length-1].parentNode!==Z;)j.length--;if(1<j.length){var Q=j[0],me=j[j.length-1];for(j.length=0;Q!==me;)j.push(Q),Q=Q.nextSibling;j.push(me)}}return j},Zc:function(j,Z){7>X?j.setAttribute("selected",Z):j.selected=Z},Db:function(j){return j===null||j===t?"":j.trim?j.trim():j.toString().replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},Ud:function(j,Z){return j=j||"",Z.length>j.length?!1:j.substring(0,Z.length)===Z},vd:function(j,Z){if(j===Z)return!0;if(j.nodeType===11)return!1;if(Z.contains)return Z.contains(j.nodeType!==1?j.parentNode:j);if(Z.compareDocumentPosition)return(Z.compareDocumentPosition(j)&16)==16;for(;j&&j!=Z;)j=j.parentNode;return!!j},Sb:function(j){return p.a.vd(j,j.ownerDocument.documentElement)},kd:function(j){return!!p.a.Lb(j,p.a.Sb)},R:function(j){return j&&j.tagName&&j.tagName.toLowerCase()},Ac:function(j){return p.onError?function(){try{return j.apply(this,arguments)}catch(Z){throw p.onError&&p.onError(Z),Z}}:j},setTimeout:function(j,Z){return setTimeout(p.a.Ac(j),Z)},Gc:function(j){setTimeout(function(){throw p.onError&&p.onError(j),j},0)},B:function(j,Z,Q){var me=p.a.Ac(Q);if(Q=k[Z],p.options.useOnlyNativeEvents||Q||!r)if(Q||typeof j.addEventListener!="function")if(typeof j.attachEvent!="undefined"){var _e=function(fe){me.call(j,fe)},re="on"+Z;j.attachEvent(re,_e),p.a.K.za(j,function(){j.detachEvent(re,_e)})}else throw Error("Browser doesn't support addEventListener or attachEvent");else j.addEventListener(Z,me,!1);else K||(K=typeof r(j).on=="function"?"on":"bind"),r(j)[K](Z,me)},Fb:function(j,Z){if(!j||!j.nodeType)throw Error("element must be a DOM node when calling triggerEvent");var Q;if(p.a.R(j)==="input"&&j.type&&Z.toLowerCase()=="click"?(Q=j.type,Q=Q=="checkbox"||Q=="radio"):Q=!1,p.options.useOnlyNativeEvents||!r||Q)if(typeof i.createEvent=="function")if(typeof j.dispatchEvent=="function")Q=i.createEvent(G[Z]||"HTMLEvents"),Q.initEvent(Z,!0,!0,n,0,0,0,0,0,!1,!1,!1,!1,0,j),j.dispatchEvent(Q);else throw Error("The supplied element doesn't support dispatchEvent");else if(Q&&j.click)j.click();else if(typeof j.fireEvent!="undefined")j.fireEvent("on"+Z);else throw Error("Browser doesn't support triggering events");else r(j).trigger(Z)},f:function(j){return p.O(j)?j():j},bc:function(j){return p.O(j)?j.v():j},Eb:function(j,Z,Q){var me;Z&&(typeof j.classList=="object"?(me=j.classList[Q?"add":"remove"],p.a.D(Z.match(Y),function(_e){me.call(j.classList,_e)})):typeof j.className.baseVal=="string"?P(j.className,"baseVal",Z,Q):P(j,"className",Z,Q))},Bb:function(j,Z){var Q=p.a.f(Z);(Q===null||Q===t)&&(Q="");var me=p.h.firstChild(j);!me||me.nodeType!=3||p.h.nextSibling(me)?p.h.va(j,[j.ownerDocument.createTextNode(Q)]):me.data=Q,p.a.Ad(j)},Yc:function(j,Z){if(j.name=Z,7>=X)try{var Q=j.name.replace(/[&<>'"]/g,function(me){return"&#"+me.charCodeAt(0)+";"});j.mergeAttributes(i.createElement("<input name='"+Q+"'/>"),!1)}catch(me){}},Ad:function(j){9<=X&&(j=j.nodeType==1?j:j.parentNode,j.style&&(j.style.zoom=j.style.zoom))},wd:function(j){if(X){var Z=j.style.width;j.style.width=0,j.style.width=Z}},Pd:function(j,Z){j=p.a.f(j),Z=p.a.f(Z);for(var Q=[],me=j;me<=Z;me++)Q.push(me);return Q},la:function(j){for(var Z=[],Q=0,me=j.length;Q<me;Q++)Z.push(j[Q]);return Z},Da:function(j){return H?Symbol(j):j},Zd:X===6,$d:X===7,W:X,Lc:function(j,Z){for(var Q=p.a.la(j.getElementsByTagName("input")).concat(p.a.la(j.getElementsByTagName("textarea"))),me=typeof Z=="string"?function(fe){return fe.name===Z}:function(fe){return Z.test(fe.name)},_e=[],re=Q.length-1;0<=re;re--)me(Q[re])&&_e.push(Q[re]);return _e},Nd:function(j){return typeof j=="string"&&(j=p.a.Db(j))?s&&s.parse?s.parse(j):new Function("return "+j)():null},hc:function(j,Z,Q){if(!s||!s.stringify)throw Error("Cannot find JSON.stringify(). Some browsers (e.g., IE < 8) don't support it natively, but you can overcome this by adding a script reference to json2.js, downloadable from http://www.json.org/json2.js");return s.stringify(p.a.f(j),Z,Q)},Od:function(j,Z,Q){Q=Q||{};var me=Q.params||{},_e=Q.includeFields||this.Jc,re=j;if(typeof j=="object"&&p.a.R(j)==="form")for(var re=j.action,fe=_e.length-1;0<=fe;fe--)for(var ge=p.a.Lc(j,_e[fe]),be=ge.length-1;0<=be;be--)me[ge[be].name]=ge[be].value;Z=p.a.f(Z);var Be=i.createElement("form");Be.style.display="none",Be.action=re,Be.method="post";for(var ke in Z)j=i.createElement("input"),j.type="hidden",j.name=ke,j.value=p.a.hc(p.a.f(Z[ke])),Be.appendChild(j);g(me,function(qe,Nt){var Wt=i.createElement("input");Wt.type="hidden",Wt.name=qe,Wt.value=Nt,Be.appendChild(Wt)}),i.body.appendChild(Be),Q.submitter?Q.submitter(Be):Be.submit(),setTimeout(function(){Be.parentNode.removeChild(Be)},0)}}}(),p.b("utils",p.a),p.b("utils.arrayForEach",p.a.D),p.b("utils.arrayFirst",p.a.Lb),p.b("utils.arrayFilter",p.a.jb),p.b("utils.arrayGetDistinctValues",p.a.wc),p.b("utils.arrayIndexOf",p.a.A),p.b("utils.arrayMap",p.a.Mb),p.b("utils.arrayPushAll",p.a.Nb),p.b("utils.arrayRemoveItem",p.a.Pa),p.b("utils.cloneNodes",p.a.Ca),p.b("utils.createSymbolOrString",p.a.Da),p.b("utils.extend",p.a.extend),p.b("utils.fieldsIncludedWithJsonPost",p.a.Jc),p.b("utils.getFormFields",p.a.Lc),p.b("utils.objectMap",p.a.Ga),p.b("utils.peekObservable",p.a.bc),p.b("utils.postJson",p.a.Od),p.b("utils.parseJson",p.a.Nd),p.b("utils.registerEventHandler",p.a.B),p.b("utils.stringifyJson",p.a.hc),p.b("utils.range",p.a.Pd),p.b("utils.toggleDomNodeCssClass",p.a.Eb),p.b("utils.triggerEvent",p.a.Fb),p.b("utils.unwrapObservable",p.a.f),p.b("utils.objectForEach",p.a.P),p.b("utils.addOrRemoveItem",p.a.Na),p.b("utils.setTextContent",p.a.Bb),p.b("unwrap",p.a.f),Function.prototype.bind||(Function.prototype.bind=function(g){var b=this;if(arguments.length===1)return function(){return b.apply(g,arguments)};var v=Array.prototype.slice.call(arguments,1);return function(){var P=v.slice(0);return P.push.apply(P,arguments),b.apply(g,P)}}),p.a.g=new function(){var g=0,b="__ko__"+new Date().getTime(),v={},P,R;return p.a.W?(P=function(V,H){var U=V[b];if(!U||U==="null"||!v[U]){if(!H)return t;U=V[b]="ko"+g++,v[U]={}}return v[U]},R=function(V){var H=V[b];return H?(delete v[H],V[b]=null,!0):!1}):(P=function(V,H){var U=V[b];return!U&&H&&(U=V[b]={}),U},R=function(V){return V[b]?(delete V[b],!0):!1}),{get:function(V,H){var U=P(V,!1);return U&&U[H]},set:function(V,H,U){(V=P(V,U!==t))&&(V[H]=U)},Ub:function(V,H,U){return V=P(V,!0),V[H]||(V[H]=U)},clear:R,Z:function(){return g+++b}}},p.b("utils.domData",p.a.g),p.b("utils.domData.clear",p.a.g.clear),p.a.K=new function(){function g(H,U){var G=p.a.g.get(H,P);return G===t&&U&&(G=[],p.a.g.set(H,P,G)),G}function b(H){var U=g(H,!1);if(U)for(var U=U.slice(0),G=0;G<U.length;G++)U[G](H);p.a.g.clear(H),p.a.K.cleanExternalData(H),V[H.nodeType]&&v(H.childNodes,!0)}function v(H,U){for(var G=[],k,X=0;X<H.length;X++)if((!U||H[X].nodeType===8)&&(b(G[G.length]=k=H[X]),H[X]!==k))for(;X--&&p.a.A(G,H[X])==-1;);}var P=p.a.g.Z(),R={1:!0,8:!0,9:!0},V={1:!0,9:!0};return{za:function(H,U){if(typeof U!="function")throw Error("Callback must be a function");g(H,!0).push(U)},yb:function(H,U){var G=g(H,!1);G&&(p.a.Pa(G,U),G.length==0&&p.a.g.set(H,P,t))},oa:function(H){return p.u.G(function(){R[H.nodeType]&&(b(H),V[H.nodeType]&&v(H.getElementsByTagName("*")))}),H},removeNode:function(H){p.oa(H),H.parentNode&&H.parentNode.removeChild(H)},cleanExternalData:function(H){r&&typeof r.cleanData=="function"&&r.cleanData([H])}}},p.oa=p.a.K.oa,p.removeNode=p.a.K.removeNode,p.b("cleanNode",p.oa),p.b("removeNode",p.removeNode),p.b("utils.domNodeDisposal",p.a.K),p.b("utils.domNodeDisposal.addDisposeCallback",p.a.K.za),p.b("utils.domNodeDisposal.removeDisposeCallback",p.a.K.yb),function(){var g=[0,"",""],b=[1,"<table>","</table>"],v=[3,"<table><tbody><tr>","</tr></tbody></table>"],P=[1,"<select multiple='multiple'>","</select>"],R={thead:b,tbody:b,tfoot:b,tr:[2,"<table><tbody>","</tbody></table>"],td:v,th:v,option:P,optgroup:P},V=8>=p.a.W;p.a.ua=function(H,U){var G;if(r){if(r.parseHTML)G=r.parseHTML(H,U)||[];else if((G=r.clean([H],U))&&G[0]){for(var k=G[0];k.parentNode&&k.parentNode.nodeType!==11;)k=k.parentNode;k.parentNode&&k.parentNode.removeChild(k)}}else{(G=U)||(G=i);var k=G.parentWindow||G.defaultView||n,X=p.a.Db(H).toLowerCase(),Y=G.createElement("div"),K;for(K=(X=X.match(/^(?:\x3c!--.*?--\x3e\s*?)*?<([a-z]+)[\s>]/))&&R[X[1]]||g,X=K[0],K="ignored<div>"+K[1]+H+K[2]+"</div>",typeof k.innerShiv=="function"?Y.appendChild(k.innerShiv(K)):(V&&G.body.appendChild(Y),Y.innerHTML=K,V&&Y.parentNode.removeChild(Y));X--;)Y=Y.lastChild;G=p.a.la(Y.lastChild.childNodes)}return G},p.a.Md=function(H,U){var G=p.a.ua(H,U);return G.length&&G[0].parentElement||p.a.Yb(G)},p.a.fc=function(H,U){if(p.a.Tb(H),U=p.a.f(U),U!==null&&U!==t)if(typeof U!="string"&&(U=U.toString()),r)r(H).html(U);else for(var G=p.a.ua(U,H.ownerDocument),k=0;k<G.length;k++)H.appendChild(G[k])}}(),p.b("utils.parseHtmlFragment",p.a.ua),p.b("utils.setHtml",p.a.fc),p.aa=function(){function g(v,P){if(v){if(v.nodeType==8){var R=p.aa.Uc(v.nodeValue);R!=null&&P.push({ud:v,Kd:R})}else if(v.nodeType==1)for(var R=0,V=v.childNodes,H=V.length;R<H;R++)g(V[R],P)}}var b={};return{Xb:function(v){if(typeof v!="function")throw Error("You can only pass a function to ko.memoization.memoize()");var P=(4294967296*(1+Math.random())|0).toString(16).substring(1)+(4294967296*(1+Math.random())|0).toString(16).substring(1);return b[P]=v,"<!--[ko_memo:"+P+"]-->"},bd:function(v,P){var R=b[v];if(R===t)throw Error("Couldn't find any memo with ID "+v+". Perhaps it's already been unmemoized.");try{return R.apply(null,P||[]),!0}finally{delete b[v]}},cd:function(v,P){var R=[];g(v,R);for(var V=0,H=R.length;V<H;V++){var U=R[V].ud,G=[U];P&&p.a.Nb(G,P),p.aa.bd(R[V].Kd,G),U.nodeValue="",U.parentNode&&U.parentNode.removeChild(U)}},Uc:function(v){return(v=v.match(/^\[ko_memo\:(.*?)\]$/))?v[1]:null}}}(),p.b("memoization",p.aa),p.b("memoization.memoize",p.aa.Xb),p.b("memoization.unmemoize",p.aa.bd),p.b("memoization.parseMemoText",p.aa.Uc),p.b("memoization.unmemoizeDomNodeAndDescendants",p.aa.cd),p.na=function(){function g(){if(R){for(var U=R,G=0,k;H<R;)if(k=P[H++]){if(H>U){if(5e3<=++G){H=R,p.a.Gc(Error("'Too much recursion' after processing "+G+" task groups."));break}U=R}try{k()}catch(X){p.a.Gc(X)}}}}function b(){g(),H=R=P.length=0}var v,P=[],R=0,V=1,H=0;return n.MutationObserver?v=function(U){var G=i.createElement("div");return new MutationObserver(U).observe(G,{attributes:!0}),function(){G.classList.toggle("foo")}}(b):v=i&&"onreadystatechange"in i.createElement("script")?function(U){var G=i.createElement("script");G.onreadystatechange=function(){G.onreadystatechange=null,i.documentElement.removeChild(G),G=null,U()},i.documentElement.appendChild(G)}:function(U){setTimeout(U,0)},{scheduler:v,zb:function(U){return R||p.na.scheduler(b),P[R++]=U,V++},cancel:function(U){U=U-(V-R),U>=H&&U<R&&(P[U]=null)},resetForTesting:function(){var U=R-H;return H=R=P.length=0,U},Sd:g}}(),p.b("tasks",p.na),p.b("tasks.schedule",p.na.zb),p.b("tasks.runEarly",p.na.Sd),p.Ta={throttle:function(g,b){g.throttleEvaluation=b;var v=null;return p.$({read:g,write:function(P){clearTimeout(v),v=p.a.setTimeout(function(){g(P)},b)}})},rateLimit:function(g,b){var v,P,R;typeof b=="number"?v=b:(v=b.timeout,P=b.method),g.Hb=!1,R=typeof P=="function"?P:P=="notifyWhenChangesStop"?d:u,g.ub(function(V){return R(V,v,b)})},deferred:function(g,b){if(b!==!0)throw Error("The 'deferred' extender only accepts the value 'true', because it is not supported to turn deferral off once enabled.");g.Hb||(g.Hb=!0,g.ub(function(v){var P,R=!1;return function(){if(!R){p.na.cancel(P),P=p.na.zb(v);try{R=!0,g.notifySubscribers(t,"dirty")}finally{R=!1}}}}))},notify:function(g,b){g.equalityComparer=b=="always"?null:l}};var C={undefined:1,boolean:1,number:1,string:1};p.b("extenders",p.Ta),p.ic=function(g,b,v){this.da=g,this.lc=b,this.mc=v,this.Ib=!1,this.fb=this.Jb=null,p.L(this,"dispose",this.s),p.L(this,"disposeWhenNodeIsRemoved",this.l)},p.ic.prototype.s=function(){this.Ib||(this.fb&&p.a.K.yb(this.Jb,this.fb),this.Ib=!0,this.mc(),this.da=this.lc=this.mc=this.Jb=this.fb=null)},p.ic.prototype.l=function(g){this.Jb=g,p.a.K.za(g,this.fb=this.s.bind(this))},p.T=function(){p.a.Ab(this,x),x.qb(this)};var x={qb:function(g){g.U={change:[]},g.sc=1},subscribe:function(g,b,v){var P=this;v=v||"change";var R=new p.ic(P,b?g.bind(b):g,function(){p.a.Pa(P.U[v],R),P.hb&&P.hb(v)});return P.Qa&&P.Qa(v),P.U[v]||(P.U[v]=[]),P.U[v].push(R),R},notifySubscribers:function(g,b){if(b=b||"change",b==="change"&&this.Gb(),this.Wa(b)){var v=b==="change"&&this.ed||this.U[b].slice(0);try{p.u.xc();for(var P=0,R;R=v[P];++P)R.Ib||R.lc(g)}finally{p.u.end()}}},ob:function(){return this.sc},Dd:function(g){return this.ob()!==g},Gb:function(){++this.sc},ub:function(g){var b=this,v=p.O(b),P,R,V,H,U;b.gb||(b.gb=b.notifySubscribers,b.notifySubscribers=h);var G=g(function(){b.Ja=!1,v&&H===b&&(H=b.nc?b.nc():b());var k=R||U&&b.sb(V,H);U=R=P=!1,k&&b.gb(V=H)});b.qc=function(k,X){X&&b.Ja||(U=!X),b.ed=b.U.change.slice(0),b.Ja=P=!0,H=k,G()},b.pc=function(k){P||(V=k,b.gb(k,"beforeChange"))},b.rc=function(){U=!0},b.gd=function(){b.sb(V,b.v(!0))&&(R=!0)}},Wa:function(g){return this.U[g]&&this.U[g].length},Bd:function(g){if(g)return this.U[g]&&this.U[g].length||0;var b=0;return p.a.P(this.U,function(v,P){v!=="dirty"&&(b+=P.length)}),b},sb:function(g,b){return!this.equalityComparer||!this.equalityComparer(g,b)},toString:function(){return"[object Object]"},extend:function(g){var b=this;return g&&p.a.P(g,function(v,P){var R=p.Ta[v];typeof R=="function"&&(b=R(b,P)||b)}),b}};p.L(x,"init",x.qb),p.L(x,"subscribe",x.subscribe),p.L(x,"extend",x.extend),p.L(x,"getSubscriptionsCount",x.Bd),p.a.Ba&&p.a.setPrototypeOf(x,Function.prototype),p.T.fn=x,p.Qc=function(g){return g!=null&&typeof g.subscribe=="function"&&typeof g.notifySubscribers=="function"},p.b("subscribable",p.T),p.b("isSubscribable",p.Qc),p.S=p.u=function(){function g(V){v.push(P),P=V}function b(){P=v.pop()}var v=[],P,R=0;return{xc:g,end:b,cc:function(V){if(P){if(!p.Qc(V))throw Error("Only subscribable things can act as dependencies");P.od.call(P.pd,V,V.fd||(V.fd=++R))}},G:function(V,H,U){try{return g(),V.apply(H,U||[])}finally{b()}},qa:function(){if(P)return P.o.qa()},Va:function(){if(P)return P.o.Va()},Ya:function(){if(P)return P.Ya},o:function(){if(P)return P.o}}}(),p.b("computedContext",p.S),p.b("computedContext.getDependenciesCount",p.S.qa),p.b("computedContext.getDependencies",p.S.Va),p.b("computedContext.isInitial",p.S.Ya),p.b("computedContext.registerDependency",p.S.cc),p.b("ignoreDependencies",p.Yd=p.u.G);var T=p.a.Da("_latestValue");p.ta=function(g){function b(){return 0<arguments.length?(b.sb(b[T],arguments[0])&&(b.ya(),b[T]=arguments[0],b.xa()),this):(p.u.cc(b),b[T])}return b[T]=g,p.a.Ba||p.a.extend(b,p.T.fn),p.T.fn.qb(b),p.a.Ab(b,E),p.options.deferUpdates&&p.Ta.deferred(b,!0),b};var E={equalityComparer:l,v:function(){return this[T]},xa:function(){this.notifySubscribers(this[T],"spectate"),this.notifySubscribers(this[T])},ya:function(){this.notifySubscribers(this[T],"beforeChange")}};p.a.Ba&&p.a.setPrototypeOf(E,p.T.fn);var S=p.ta.Ma="__ko_proto__";E[S]=p.ta,p.O=function(g){if((g=typeof g=="function"&&g[S])&&g!==E[S]&&g!==p.o.fn[S])throw Error("Invalid object that looks like an observable; possibly from another Knockout instance");return!!g},p.Za=function(g){return typeof g=="function"&&(g[S]===E[S]||g[S]===p.o.fn[S]&&g.Nc)},p.b("observable",p.ta),p.b("isObservable",p.O),p.b("isWriteableObservable",p.Za),p.b("isWritableObservable",p.Za),p.b("observable.fn",E),p.L(E,"peek",E.v),p.L(E,"valueHasMutated",E.xa),p.L(E,"valueWillMutate",E.ya),p.Ha=function(g){if(g=g||[],typeof g!="object"||!("length"in g))throw Error("The argument passed when initializing an observable array must be an array, or null, or undefined.");return g=p.ta(g),p.a.Ab(g,p.Ha.fn),g.extend({trackArrayChanges:!0})},p.Ha.fn={remove:function(g){for(var b=this.v(),v=[],P=typeof g!="function"||p.O(g)?function(H){return H===g}:g,R=0;R<b.length;R++){var V=b[R];if(P(V)){if(v.length===0&&this.ya(),b[R]!==V)throw Error("Array modified during remove; cannot remove item");v.push(V),b.splice(R,1),R--}}return v.length&&this.xa(),v},removeAll:function(g){if(g===t){var b=this.v(),v=b.slice(0);return this.ya(),b.splice(0,b.length),this.xa(),v}return g?this.remove(function(P){return 0<=p.a.A(g,P)}):[]},destroy:function(g){var b=this.v(),v=typeof g!="function"||p.O(g)?function(V){return V===g}:g;this.ya();for(var P=b.length-1;0<=P;P--){var R=b[P];v(R)&&(R._destroy=!0)}this.xa()},destroyAll:function(g){return g===t?this.destroy(function(){return!0}):g?this.destroy(function(b){return 0<=p.a.A(g,b)}):[]},indexOf:function(g){var b=this();return p.a.A(b,g)},replace:function(g,b){var v=this.indexOf(g);0<=v&&(this.ya(),this.v()[v]=b,this.xa())},sorted:function(g){var b=this().slice(0);return g?b.sort(g):b.sort()},reversed:function(){return this().slice(0).reverse()}},p.a.Ba&&p.a.setPrototypeOf(p.Ha.fn,p.ta.fn),p.a.D("pop push reverse shift sort splice unshift".split(" "),function(g){p.Ha.fn[g]=function(){var b=this.v();this.ya(),this.zc(b,g,arguments);var v=b[g].apply(b,arguments);return this.xa(),v===b?this:v}}),p.a.D(["slice"],function(g){p.Ha.fn[g]=function(){var b=this();return b[g].apply(b,arguments)}}),p.Pc=function(g){return p.O(g)&&typeof g.remove=="function"&&typeof g.push=="function"},p.b("observableArray",p.Ha),p.b("isObservableArray",p.Pc),p.Ta.trackArrayChanges=function(g,b){function v(){function Y(){if(U){var K=[].concat(g.v()||[]),j;g.Wa("arrayChange")&&((!R||1<U)&&(R=p.a.Pb(G,K,g.Ob)),j=R),G=K,R=null,U=0,j&&j.length&&g.notifySubscribers(j,"arrayChange")}}P?Y():(P=!0,H=g.subscribe(function(){++U},null,"spectate"),G=[].concat(g.v()||[]),R=null,V=g.subscribe(Y))}if(g.Ob={},b&&typeof b=="object"&&p.a.extend(g.Ob,b),g.Ob.sparse=!0,!g.zc){var P=!1,R=null,V,H,U=0,G,k=g.Qa,X=g.hb;g.Qa=function(Y){k&&k.call(g,Y),Y==="arrayChange"&&v()},g.hb=function(Y){X&&X.call(g,Y),Y!=="arrayChange"||g.Wa("arrayChange")||(V&&V.s(),H&&H.s(),H=V=null,P=!1,G=t)},g.zc=function(Y,K,j){function Z(Be,ke,qe){return Q[Q.length]={status:Be,value:ke,index:qe}}if(P&&!U){var Q=[],me=Y.length,_e=j.length,re=0;switch(K){case"push":re=me;case"unshift":for(K=0;K<_e;K++)Z("added",j[K],re+K);break;case"pop":re=me-1;case"shift":me&&Z("deleted",Y[re],re);break;case"splice":K=Math.min(Math.max(0,0>j[0]?me+j[0]:j[0]),me);for(var me=_e===1?me:Math.min(K+(j[1]||0),me),_e=K+_e-2,re=Math.max(me,_e),fe=[],ge=[],be=2;K<re;++K,++be)K<me&&ge.push(Z("deleted",Y[K],K)),K<_e&&fe.push(Z("added",j[be],K));p.a.Kc(ge,fe);break;default:return}R=Q}}}};var w=p.a.Da("_state");p.o=p.$=function(g,b,v){function P(){if(0<arguments.length){if(typeof R=="function")R.apply(V.nb,arguments);else throw Error("Cannot write a value to a ko.computed unless you specify a 'write' option. If you wish to read the current value, don't pass any parameters.");return this}return V.ra||p.u.cc(P),(V.ka||V.J&&P.Xa())&&P.ha(),V.X}if(typeof g=="object"?v=g:(v=v||{},g&&(v.read=g)),typeof v.read!="function")throw Error("Pass a function that returns the value of the ko.computed");var R=v.write,V={X:t,sa:!0,ka:!0,rb:!1,jc:!1,ra:!1,wb:!1,J:!1,Wc:v.read,nb:b||v.owner,l:v.disposeWhenNodeIsRemoved||v.l||null,Sa:v.disposeWhen||v.Sa,Rb:null,I:{},V:0,Ic:null};return P[w]=V,P.Nc=typeof R=="function",p.a.Ba||p.a.extend(P,p.T.fn),p.T.fn.qb(P),p.a.Ab(P,D),v.pure?(V.wb=!0,V.J=!0,p.a.extend(P,I)):v.deferEvaluation&&p.a.extend(P,O),p.options.deferUpdates&&p.Ta.deferred(P,!0),V.l&&(V.jc=!0,V.l.nodeType||(V.l=null)),V.J||v.deferEvaluation||P.ha(),V.l&&P.ja()&&p.a.K.za(V.l,V.Rb=function(){P.s()}),P};var D={equalityComparer:l,qa:function(){return this[w].V},Va:function(){var g=[];return p.a.P(this[w].I,function(b,v){g[v.Ka]=v.da}),g},Vb:function(g){if(!this[w].V)return!1;var b=this.Va();return p.a.A(b,g)!==-1?!0:!!p.a.Lb(b,function(v){return v.Vb&&v.Vb(g)})},uc:function(g,b,v){if(this[w].wb&&b===this)throw Error("A 'pure' computed must not be called recursively");this[w].I[g]=v,v.Ka=this[w].V++,v.La=b.ob()},Xa:function(){var g,b,v=this[w].I;for(g in v)if(Object.prototype.hasOwnProperty.call(v,g)&&(b=v[g],this.Ia&&b.da.Ja||b.da.Dd(b.La)))return!0},Jd:function(){this.Ia&&!this[w].rb&&this.Ia(!1)},ja:function(){var g=this[w];return g.ka||0<g.V},Rd:function(){this.Ja?this[w].ka&&(this[w].sa=!0):this.Hc()},$c:function(g){if(g.Hb){var b=g.subscribe(this.Jd,this,"dirty"),v=g.subscribe(this.Rd,this);return{da:g,s:function(){b.s(),v.s()}}}return g.subscribe(this.Hc,this)},Hc:function(){var g=this,b=g.throttleEvaluation;b&&0<=b?(clearTimeout(this[w].Ic),this[w].Ic=p.a.setTimeout(function(){g.ha(!0)},b)):g.Ia?g.Ia(!0):g.ha(!0)},ha:function(g){var b=this[w],v=b.Sa,P=!1;if(!b.rb&&!b.ra){if(b.l&&!p.a.Sb(b.l)||v&&v()){if(!b.jc){this.s();return}}else b.jc=!1;b.rb=!0;try{P=this.zd(g)}finally{b.rb=!1}return P}},zd:function(g){var b=this[w],P=!1,v=b.wb?t:!b.V,P={qd:this,mb:b.I,Qb:b.V};p.u.xc({pd:P,od:y,o:this,Ya:v}),b.I={},b.V=0;var R=this.yd(b,P);return b.V?P=this.sb(b.X,R):(this.s(),P=!0),P&&(b.J?this.Gb():this.notifySubscribers(b.X,"beforeChange"),b.X=R,this.notifySubscribers(b.X,"spectate"),!b.J&&g&&this.notifySubscribers(b.X),this.rc&&this.rc()),v&&this.notifySubscribers(b.X,"awake"),P},yd:function(g,b){try{var v=g.Wc;return g.nb?v.call(g.nb):v()}finally{p.u.end(),b.Qb&&!g.J&&p.a.P(b.mb,_),g.sa=g.ka=!1}},v:function(g){var b=this[w];return(b.ka&&(g||!b.V)||b.J&&this.Xa())&&this.ha(),b.X},ub:function(g){p.T.fn.ub.call(this,g),this.nc=function(){return this[w].J||(this[w].sa?this.ha():this[w].ka=!1),this[w].X},this.Ia=function(b){this.pc(this[w].X),this[w].ka=!0,b&&(this[w].sa=!0),this.qc(this,!b)}},s:function(){var g=this[w];!g.J&&g.I&&p.a.P(g.I,function(b,v){v.s&&v.s()}),g.l&&g.Rb&&p.a.K.yb(g.l,g.Rb),g.I=t,g.V=0,g.ra=!0,g.sa=!1,g.ka=!1,g.J=!1,g.l=t,g.Sa=t,g.Wc=t,this.Nc||(g.nb=t)}},I={Qa:function(g){var b=this,v=b[w];if(!v.ra&&v.J&&g=="change"){if(v.J=!1,v.sa||b.Xa())v.I=null,v.V=0,b.ha()&&b.Gb();else{var P=[];p.a.P(v.I,function(R,V){P[V.Ka]=R}),p.a.D(P,function(R,V){var H=v.I[R],U=b.$c(H.da);U.Ka=V,U.La=H.La,v.I[R]=U}),b.Xa()&&b.ha()&&b.Gb()}v.ra||b.notifySubscribers(v.X,"awake")}},hb:function(g){var b=this[w];b.ra||g!="change"||this.Wa("change")||(p.a.P(b.I,function(v,P){P.s&&(b.I[v]={da:P.da,Ka:P.Ka,La:P.La},P.s())}),b.J=!0,this.notifySubscribers(t,"asleep"))},ob:function(){var g=this[w];return g.J&&(g.sa||this.Xa())&&this.ha(),p.T.fn.ob.call(this)}},O={Qa:function(g){g!="change"&&g!="beforeChange"||this.v()}};p.a.Ba&&p.a.setPrototypeOf(D,p.T.fn);var M=p.ta.Ma;D[M]=p.o,p.Oc=function(g){return typeof g=="function"&&g[M]===D[M]},p.Fd=function(g){return p.Oc(g)&&g[w]&&g[w].wb},p.b("computed",p.o),p.b("dependentObservable",p.o),p.b("isComputed",p.Oc),p.b("isPureComputed",p.Fd),p.b("computed.fn",D),p.L(D,"peek",D.v),p.L(D,"dispose",D.s),p.L(D,"isActive",D.ja),p.L(D,"getDependenciesCount",D.qa),p.L(D,"getDependencies",D.Va),p.xb=function(g,b){return typeof g=="function"?p.o(g,b,{pure:!0}):(g=p.a.extend({},g),g.pure=!0,p.o(g,b))},p.b("pureComputed",p.xb),function(){function g(P,R,V){if(V=V||new v,P=R(P),typeof P!="object"||P===null||P===t||P instanceof RegExp||P instanceof Date||P instanceof String||P instanceof Number||P instanceof Boolean)return P;var H=P instanceof Array?[]:{};return V.save(P,H),b(P,function(U){var G=R(P[U]);switch(typeof G){case"boolean":case"number":case"string":case"function":H[U]=G;break;case"object":case"undefined":var k=V.get(G);H[U]=k!==t?k:g(G,R,V)}}),H}function b(P,R){if(P instanceof Array){for(var V=0;V<P.length;V++)R(V);typeof P.toJSON=="function"&&R("toJSON")}else for(V in P)R(V)}function v(){this.keys=[],this.values=[]}p.ad=function(P){if(arguments.length==0)throw Error("When calling ko.toJS, pass the object you want to convert.");return g(P,function(R){for(var V=0;p.O(R)&&10>V;V++)R=R();return R})},p.toJSON=function(P,R,V){return P=p.ad(P),p.a.hc(P,R,V)},v.prototype={constructor:v,save:function(P,R){var V=p.a.A(this.keys,P);0<=V?this.values[V]=R:(this.keys.push(P),this.values.push(R))},get:function(P){return P=p.a.A(this.keys,P),0<=P?this.values[P]:t}}}(),p.b("toJS",p.ad),p.b("toJSON",p.toJSON),p.Wd=function(g,b,v){function P(R){var V=p.xb(g,v).extend({ma:"always"}),H=V.subscribe(function(U){U&&(H.s(),R(U))});return V.notifySubscribers(V.v()),H}return typeof Promise!="function"||b?P(b.bind(v)):new Promise(P)},p.b("when",p.Wd),function(){p.w={M:function(g){switch(p.a.R(g)){case"option":return g.__ko__hasDomDataOptionValue__===!0?p.a.g.get(g,p.c.options.$b):7>=p.a.W?g.getAttributeNode("value")&&g.getAttributeNode("value").specified?g.value:g.text:g.value;case"select":return 0<=g.selectedIndex?p.w.M(g.options[g.selectedIndex]):t;default:return g.value}},cb:function(g,b,v){switch(p.a.R(g)){case"option":typeof b=="string"?(p.a.g.set(g,p.c.options.$b,t),"__ko__hasDomDataOptionValue__"in g&&delete g.__ko__hasDomDataOptionValue__,g.value=b):(p.a.g.set(g,p.c.options.$b,b),g.__ko__hasDomDataOptionValue__=!0,g.value=typeof b=="number"?b:"");break;case"select":(b===""||b===null)&&(b=t);for(var P=-1,R=0,V=g.options.length,H;R<V;++R)if(H=p.w.M(g.options[R]),H==b||H===""&&b===t){P=R;break}(v||0<=P||b===t&&1<g.size)&&(g.selectedIndex=P,p.a.W===6&&p.a.setTimeout(function(){g.selectedIndex=P},0));break;default:(b===null||b===t)&&(b=""),g.value=b}}}}(),p.b("selectExtensions",p.w),p.b("selectExtensions.readValue",p.w.M),p.b("selectExtensions.writeValue",p.w.cb),p.m=function(){function g(U){U=p.a.Db(U),U.charCodeAt(0)===123&&(U=U.slice(1,-1)),U+=`
,`;var G=[],k=U.match(P),X,Y=[],K=0;if(1<k.length){for(var j=0,Z;Z=k[j];++j){var Q=Z.charCodeAt(0);if(Q===44){if(0>=K){G.push(X&&Y.length?{key:X,value:Y.join("")}:{unknown:X||Y.join("")}),X=K=0,Y=[];continue}}else if(Q===58){if(!K&&!X&&Y.length===1){X=Y.pop();continue}}else{if(Q===47&&1<Z.length&&(Z.charCodeAt(1)===47||Z.charCodeAt(1)===42))continue;Q===47&&j&&1<Z.length?(Q=k[j-1].match(R))&&!V[Q[0]]&&(U=U.substr(U.indexOf(Z)+1),k=U.match(P),j=-1,Z="/"):Q===40||Q===123||Q===91?++K:Q===41||Q===125||Q===93?--K:X||Y.length||Q!==34&&Q!==39||(Z=Z.slice(1,-1))}Y.push(Z)}if(0<K)throw Error("Unbalanced parentheses, braces, or brackets")}return G}var b=["true","false","null","undefined"],v=/^(?:[$_a-z][$\w]*|(.+)(\.\s*[$_a-z][$\w]*|\[.+\]))$/i,P=RegExp(`"(?:\\\\.|[^"])*"|'(?:\\\\.|[^'])*'|\`(?:\\\\.|[^\`])*\`|/\\*(?:[^*]|\\*+[^*/])*\\*+/|//.*
|/(?:\\\\.|[^/])+/w*|[^\\s:,/][^,"'\`{}()/:[\\]]*[^\\s,"'\`{}()/:[\\]]|[^\\s]`,"g"),R=/[\])"'A-Za-z0-9_$]+$/,V={in:1,return:1,typeof:1},H={};return{Ra:[],wa:H,ac:g,vb:function(U,G){function k(Q,me){var _e;if(!j){var re=p.getBindingHandler(Q);if(re&&re.preprocess&&!(me=re.preprocess(me,Q,k)))return;(re=H[Q])&&(_e=me,0<=p.a.A(b,_e)?_e=!1:(re=_e.match(v),_e=re===null?!1:re[1]?"Object("+re[1]+")"+re[2]:_e),re=_e),re&&Y.push("'"+(typeof H[Q]=="string"?H[Q]:Q)+"':function(_z){"+_e+"=_z}")}K&&(me="function(){return "+me+" }"),X.push("'"+Q+"':"+me)}G=G||{};var X=[],Y=[],K=G.valueAccessors,j=G.bindingParams,Z=typeof U=="string"?g(U):U;return p.a.D(Z,function(Q){k(Q.key||Q.unknown,Q.value)}),Y.length&&k("_ko_property_writers","{"+Y.join(",")+" }"),X.join(",")},Id:function(U,G){for(var k=0;k<U.length;k++)if(U[k].key==G)return!0;return!1},eb:function(U,G,k,X,Y){U&&p.O(U)?!p.Za(U)||Y&&U.v()===X||U(X):(U=G.get("_ko_property_writers"))&&U[k]&&U[k](X)}}}(),p.b("expressionRewriting",p.m),p.b("expressionRewriting.bindingRewriteValidators",p.m.Ra),p.b("expressionRewriting.parseObjectLiteral",p.m.ac),p.b("expressionRewriting.preProcessBindings",p.m.vb),p.b("expressionRewriting._twoWayBindings",p.m.wa),p.b("jsonExpressionRewriting",p.m),p.b("jsonExpressionRewriting.insertPropertyAccessorsIntoJson",p.m.vb),function(){function g(k){return k.nodeType==8&&V.test(R?k.text:k.nodeValue)}function b(k){return k.nodeType==8&&H.test(R?k.text:k.nodeValue)}function v(k,X){for(var Y=k,K=1,j=[];Y=Y.nextSibling;){if(b(Y)&&(p.a.g.set(Y,G,!0),K--,K===0))return j;j.push(Y),g(Y)&&K++}if(!X)throw Error("Cannot find closing comment tag to match: "+k.nodeValue);return null}function P(k,X){var Y=v(k,X);return Y?0<Y.length?Y[Y.length-1].nextSibling:k.nextSibling:null}var R=i&&i.createComment("test").text==="<!--test-->",V=R?/^\x3c!--\s*ko(?:\s+([\s\S]+))?\s*--\x3e$/:/^\s*ko(?:\s+([\s\S]+))?\s*$/,H=R?/^\x3c!--\s*\/ko\s*--\x3e$/:/^\s*\/ko\s*$/,U={ul:!0,ol:!0},G="__ko_matchedEndComment__";p.h={ea:{},childNodes:function(k){return g(k)?v(k):k.childNodes},Ea:function(k){if(g(k)){k=p.h.childNodes(k);for(var X=0,Y=k.length;X<Y;X++)p.removeNode(k[X])}else p.a.Tb(k)},va:function(k,X){if(g(k)){p.h.Ea(k);for(var Y=k.nextSibling,K=0,j=X.length;K<j;K++)Y.parentNode.insertBefore(X[K],Y)}else p.a.va(k,X)},Vc:function(k,X){var Y;g(k)?(Y=k.nextSibling,k=k.parentNode):Y=k.firstChild,Y?X!==Y&&k.insertBefore(X,Y):k.appendChild(X)},Wb:function(k,X,Y){Y?(Y=Y.nextSibling,g(k)&&(k=k.parentNode),Y?X!==Y&&k.insertBefore(X,Y):k.appendChild(X)):p.h.Vc(k,X)},firstChild:function(k){if(g(k))return!k.nextSibling||b(k.nextSibling)?null:k.nextSibling;if(k.firstChild&&b(k.firstChild))throw Error("Found invalid end comment, as the first child of "+k);return k.firstChild},nextSibling:function(k){if(g(k)&&(k=P(k)),k.nextSibling&&b(k.nextSibling)){var X=k.nextSibling;if(b(X)&&!p.a.g.get(X,G))throw Error("Found end comment without a matching opening comment, as child of "+k);return null}return k.nextSibling},Cd:g,Vd:function(k){return(k=(R?k.text:k.nodeValue).match(V))?k[1]:null},Sc:function(k){if(U[p.a.R(k)]){var X=k.firstChild;if(X)do if(X.nodeType===1){var Y;Y=X.firstChild;var K=null;if(Y)do if(K)K.push(Y);else if(g(Y)){var j=P(Y,!0);j?Y=j:K=[Y]}else b(Y)&&(K=[Y]);while(Y=Y.nextSibling);if(Y=K)for(K=X.nextSibling,j=0;j<Y.length;j++)K?k.insertBefore(Y[j],K):k.appendChild(Y[j])}while(X=X.nextSibling)}}}}(),p.b("virtualElements",p.h),p.b("virtualElements.allowedBindings",p.h.ea),p.b("virtualElements.emptyNode",p.h.Ea),p.b("virtualElements.insertAfter",p.h.Wb),p.b("virtualElements.prepend",p.h.Vc),p.b("virtualElements.setDomNodeChildren",p.h.va),function(){p.ga=function(){this.nd={}},p.a.extend(p.ga.prototype,{nodeHasBindings:function(g){switch(g.nodeType){case 1:return g.getAttribute("data-bind")!=null||p.j.getComponentNameForNode(g);case 8:return p.h.Cd(g);default:return!1}},getBindings:function(g,b){var v=this.getBindingsString(g,b),v=v?this.parseBindingsString(v,b,g):null;return p.j.tc(v,g,b,!1)},getBindingAccessors:function(g,b){var v=this.getBindingsString(g,b),v=v?this.parseBindingsString(v,b,g,{valueAccessors:!0}):null;return p.j.tc(v,g,b,!0)},getBindingsString:function(g){switch(g.nodeType){case 1:return g.getAttribute("data-bind");case 8:return p.h.Vd(g);default:return null}},parseBindingsString:function(g,b,v,P){try{var R=this.nd,V=g+(P&&P.valueAccessors||""),H;if(!(H=R[V])){var U,G="with($context){with($data||{}){return{"+p.m.vb(g,P)+"}}}";U=new Function("$context","$element",G),H=R[V]=U}return H(b,v)}catch(k){throw k.message=`Unable to parse bindings.
Bindings value: `+g+`
Message: `+k.message,k}}}),p.ga.instance=new p.ga}(),p.b("bindingProvider",p.ga),function(){function g(re){var fe=(re=p.a.g.get(re,_e))&&re.N;fe&&(re.N=null,fe.Tc())}function b(re,fe,ge){this.node=re,this.yc=fe,this.kb=[],this.H=!1,fe.N||p.a.K.za(re,g),ge&&ge.N&&(ge.N.kb.push(re),this.Kb=ge)}function v(re){return function(){return re}}function P(re){return re()}function R(re){return p.a.Ga(p.u.G(re),function(fe,ge){return function(){return re()[ge]}})}function V(re,fe,ge){return typeof re=="function"?R(re.bind(null,fe,ge)):p.a.Ga(re,v)}function H(re,fe){return R(this.getBindings.bind(this,re,fe))}function U(re,fe){var ge=p.h.firstChild(fe);if(ge){var be,Be=p.ga.instance,ke=Be.preprocessNode;if(ke){for(;be=ge;)ge=p.h.nextSibling(be),ke.call(Be,be);ge=p.h.firstChild(fe)}for(;be=ge;)ge=p.h.nextSibling(be),G(re,be)}p.i.ma(fe,p.i.H)}function G(re,fe){var ge=re,be=fe.nodeType===1;be&&p.h.Sc(fe),(be||p.ga.instance.nodeHasBindings(fe))&&(ge=X(fe,null,re).bindingContextForDescendants),ge&&!Q[p.a.R(fe)]&&U(ge,fe)}function k(re){var fe=[],ge={},be=[];return p.a.P(re,function Be(ke){if(!ge[ke]){var qe=p.getBindingHandler(ke);qe&&(qe.after&&(be.push(ke),p.a.D(qe.after,function(Nt){if(re[Nt]){if(p.a.A(be,Nt)!==-1)throw Error("Cannot combine the following bindings, because they have a cyclic dependency: "+be.join(", "));Be(Nt)}}),be.length--),fe.push({key:ke,Mc:qe})),ge[ke]=!0}}),fe}function X(re,fe,ge){var be=p.a.g.Ub(re,_e,{}),Be=be.hd;if(!fe){if(Be)throw Error("You cannot apply bindings multiple times to the same element.");be.hd=!0}Be||(be.context=ge),be.Zb||(be.Zb={});var ke;if(fe&&typeof fe!="function")ke=fe;else{var qe=p.ga.instance,Nt=qe.getBindingAccessors||H,Wt=p.$(function(){return(ke=fe?fe(ge,re):Nt.call(qe,re,ge))&&(ge[K]&&ge[K](),ge[Z]&&ge[Z]()),ke},null,{l:re});ke&&Wt.ja()||(Wt=null)}var un=ge,_t;if(ke){var Rn=function(){return p.a.Ga(Wt?Wt():ke,P)},oi=Wt?function(lt){return function(){return P(Wt()[lt])}}:function(lt){return ke[lt]};Rn.get=function(lt){return ke[lt]&&P(oi(lt))},Rn.has=function(lt){return lt in ke},p.i.H in ke&&p.i.subscribe(re,p.i.H,function(){var lt=(0,ke[p.i.H])();if(lt){var Yt=p.h.childNodes(re);Yt.length&&lt(Yt,p.Ec(Yt[0]))}}),p.i.pa in ke&&(un=p.i.Cb(re,ge),p.i.subscribe(re,p.i.pa,function(){var lt=(0,ke[p.i.pa])();lt&&p.h.firstChild(re)&&lt(re)})),be=k(ke),p.a.D(be,function(lt){var Yt=lt.Mc.init,si=lt.Mc.update,ye=lt.key;if(re.nodeType===8&&!p.h.ea[ye])throw Error("The binding '"+ye+"' cannot be used with virtual elements");try{typeof Yt=="function"&&p.u.G(function(){var Oe=Yt(re,oi(ye),Rn,un.$data,un);if(Oe&&Oe.controlsDescendantBindings){if(_t!==t)throw Error("Multiple bindings ("+_t+" and "+ye+") are trying to control descendant bindings of the same element. You cannot use these bindings together on the same element.");_t=ye}}),typeof si=="function"&&p.$(function(){si(re,oi(ye),Rn,un.$data,un)},null,{l:re})}catch(Oe){throw Oe.message='Unable to process binding "'+ye+": "+ke[ye]+`"
Message: `+Oe.message,Oe}})}return be=_t===t,{shouldBindDescendants:be,bindingContextForDescendants:be&&un}}function Y(re,fe){return re&&re instanceof p.fa?re:new p.fa(re,t,t,fe)}var K=p.a.Da("_subscribable"),j=p.a.Da("_ancestorBindingInfo"),Z=p.a.Da("_dataDependency");p.c={};var Q={script:!0,textarea:!0,template:!0};p.getBindingHandler=function(re){return p.c[re]};var me={};p.fa=function(re,fe,ge,be,Be){function ke(){var oi=un?Wt():Wt,lt=p.a.f(oi);return fe?(p.a.extend(qe,fe),j in fe&&(qe[j]=fe[j])):(qe.$parents=[],qe.$root=lt,qe.ko=p),qe[K]=_t,Nt?lt=qe.$data:(qe.$rawData=oi,qe.$data=lt),ge&&(qe[ge]=lt),be&&be(qe,fe,lt),fe&&fe[K]&&!p.S.o().Vb(fe[K])&&fe[K](),Rn&&(qe[Z]=Rn),qe.$data}var qe=this,Nt=re===me,Wt=Nt?t:re,un=typeof Wt=="function"&&!p.O(Wt),_t,Rn=Be&&Be.dataDependency;Be&&Be.exportDependencies?ke():(_t=p.xb(ke),_t.v(),_t.ja()?_t.equalityComparer=null:qe[K]=t)},p.fa.prototype.createChildContext=function(re,fe,ge,be){if(!be&&fe&&typeof fe=="object"&&(be=fe,fe=be.as,ge=be.extend),fe&&be&&be.noChildContext){var Be=typeof re=="function"&&!p.O(re);return new p.fa(me,this,null,function(ke){ge&&ge(ke),ke[fe]=Be?re():re},be)}return new p.fa(re,this,fe,function(ke,qe){ke.$parentContext=qe,ke.$parent=qe.$data,ke.$parents=(qe.$parents||[]).slice(0),ke.$parents.unshift(ke.$parent),ge&&ge(ke)},be)},p.fa.prototype.extend=function(re,fe){return new p.fa(me,this,null,function(ge){p.a.extend(ge,typeof re=="function"?re(ge):re)},fe)};var _e=p.a.g.Z();b.prototype.Tc=function(){this.Kb&&this.Kb.N&&this.Kb.N.sd(this.node)},b.prototype.sd=function(re){p.a.Pa(this.kb,re),!this.kb.length&&this.H&&this.Cc()},b.prototype.Cc=function(){this.H=!0,this.yc.N&&!this.kb.length&&(this.yc.N=null,p.a.K.yb(this.node,g),p.i.ma(this.node,p.i.pa),this.Tc())},p.i={H:"childrenComplete",pa:"descendantsComplete",subscribe:function(re,fe,ge,be,Be){var ke=p.a.g.Ub(re,_e,{});return ke.Fa||(ke.Fa=new p.T),Be&&Be.notifyImmediately&&ke.Zb[fe]&&p.u.G(ge,be,[re]),ke.Fa.subscribe(ge,be,fe)},ma:function(re,fe){var ge=p.a.g.get(re,_e);if(ge&&(ge.Zb[fe]=!0,ge.Fa&&ge.Fa.notifySubscribers(re,fe),fe==p.i.H)){if(ge.N)ge.N.Cc();else if(ge.N===t&&ge.Fa&&ge.Fa.Wa(p.i.pa))throw Error("descendantsComplete event not supported for bindings on this node")}},Cb:function(re,fe){var ge=p.a.g.Ub(re,_e,{});return ge.N||(ge.N=new b(re,ge,fe[j])),fe[j]==ge?fe:fe.extend(function(be){be[j]=ge})}},p.Td=function(re){return(re=p.a.g.get(re,_e))&&re.context},p.ib=function(re,fe,ge){return re.nodeType===1&&p.h.Sc(re),X(re,fe,Y(ge))},p.ld=function(re,fe,ge){return ge=Y(ge),p.ib(re,V(fe,ge,re),ge)},p.Oa=function(re,fe){fe.nodeType!==1&&fe.nodeType!==8||U(Y(re),fe)},p.vc=function(re,fe,ge){if(!r&&n.jQuery&&(r=n.jQuery),2>arguments.length){if(fe=i.body,!fe)throw Error("ko.applyBindings: could not find document.body; has the document been loaded?")}else if(!fe||fe.nodeType!==1&&fe.nodeType!==8)throw Error("ko.applyBindings: first parameter should be your view model; second parameter should be a DOM node");G(Y(re,ge),fe)},p.Dc=function(re){return!re||re.nodeType!==1&&re.nodeType!==8?t:p.Td(re)},p.Ec=function(re){return(re=p.Dc(re))?re.$data:t},p.b("bindingHandlers",p.c),p.b("bindingEvent",p.i),p.b("bindingEvent.subscribe",p.i.subscribe),p.b("bindingEvent.startPossiblyAsyncContentBinding",p.i.Cb),p.b("applyBindings",p.vc),p.b("applyBindingsToDescendants",p.Oa),p.b("applyBindingAccessorsToNode",p.ib),p.b("applyBindingsToNode",p.ld),p.b("contextFor",p.Dc),p.b("dataFor",p.Ec)}(),function(g){function b(H,U){var G=Object.prototype.hasOwnProperty.call(R,H)?R[H]:g,k;G?G.subscribe(U):(G=R[H]=new p.T,G.subscribe(U),v(H,function(X,Y){var K=!(!Y||!Y.synchronous);V[H]={definition:X,Gd:K},delete R[H],k||K?G.notifySubscribers(X):p.na.zb(function(){G.notifySubscribers(X)})}),k=!0)}function v(H,U){P("getConfig",[H],function(G){G?P("loadComponent",[H,G],function(k){U(k,G)}):U(null,null)})}function P(H,U,G,k){k||(k=p.j.loaders.slice(0));var X=k.shift();if(X){var Y=X[H];if(Y){var K=!1;if(Y.apply(X,U.concat(function(j){K?G(null):j!==null?G(j):P(H,U,G,k)}))!==g&&(K=!0,!X.suppressLoaderExceptions))throw Error("Component loaders must supply values by invoking the callback, not by returning values synchronously.")}else P(H,U,G,k)}else G(null)}var R={},V={};p.j={get:function(H,U){var G=Object.prototype.hasOwnProperty.call(V,H)?V[H]:g;G?G.Gd?p.u.G(function(){U(G.definition)}):p.na.zb(function(){U(G.definition)}):b(H,U)},Bc:function(H){delete V[H]},oc:P},p.j.loaders=[],p.b("components",p.j),p.b("components.get",p.j.get),p.b("components.clearCachedDefinition",p.j.Bc)}(),function(){function g(G,k,X,Y){function K(){--Z===0&&Y(j)}var j={},Z=2,Q=X.template;X=X.viewModel,Q?R(k,Q,function(me){p.j.oc("loadTemplate",[G,me],function(_e){j.template=_e,K()})}):K(),X?R(k,X,function(me){p.j.oc("loadViewModel",[G,me],function(_e){j[U]=_e,K()})}):K()}function b(G,k,X){if(typeof k=="function")X(function(K){return new k(K)});else if(typeof k[U]=="function")X(k[U]);else if("instance"in k){var Y=k.instance;X(function(){return Y})}else"viewModel"in k?b(G,k.viewModel,X):G("Unknown viewModel value: "+k)}function v(G){switch(p.a.R(G)){case"script":return p.a.ua(G.text);case"textarea":return p.a.ua(G.value);case"template":if(P(G.content))return p.a.Ca(G.content.childNodes)}return p.a.Ca(G.childNodes)}function P(G){return n.DocumentFragment?G instanceof DocumentFragment:G&&G.nodeType===11}function R(G,k,X){typeof k.require=="string"?c||n.require?(c||n.require)([k.require],function(Y){Y&&typeof Y=="object"&&Y.Xd&&Y.default&&(Y=Y.default),X(Y)}):G("Uses require, but no AMD loader is present"):X(k)}function V(G){return function(k){throw Error("Component '"+G+"': "+k)}}var H={};p.j.register=function(G,k){if(!k)throw Error("Invalid configuration for "+G);if(p.j.tb(G))throw Error("Component "+G+" is already registered");H[G]=k},p.j.tb=function(G){return Object.prototype.hasOwnProperty.call(H,G)},p.j.unregister=function(G){delete H[G],p.j.Bc(G)},p.j.Fc={getConfig:function(G,k){k(p.j.tb(G)?H[G]:null)},loadComponent:function(G,k,X){var Y=V(G);R(Y,k,function(K){g(G,Y,K,X)})},loadTemplate:function(G,k,X){if(G=V(G),typeof k=="string")X(p.a.ua(k));else if(k instanceof Array)X(k);else if(P(k))X(p.a.la(k.childNodes));else if(k.element)if(k=k.element,n.HTMLElement?k instanceof HTMLElement:k&&k.tagName&&k.nodeType===1)X(v(k));else if(typeof k=="string"){var Y=i.getElementById(k);Y?X(v(Y)):G("Cannot find element with ID "+k)}else G("Unknown element type: "+k);else G("Unknown template value: "+k)},loadViewModel:function(G,k,X){b(V(G),k,X)}};var U="createViewModel";p.b("components.register",p.j.register),p.b("components.isRegistered",p.j.tb),p.b("components.unregister",p.j.unregister),p.b("components.defaultLoader",p.j.Fc),p.j.loaders.push(p.j.Fc),p.j.dd=H}(),function(){function g(v,P){var R=v.getAttribute("params");if(R){var R=b.parseBindingsString(R,P,v,{valueAccessors:!0,bindingParams:!0}),R=p.a.Ga(R,function(U){return p.o(U,null,{l:v})}),V=p.a.Ga(R,function(U){var G=U.v();return U.ja()?p.o({read:function(){return p.a.f(U())},write:p.Za(G)&&function(k){U()(k)},l:v}):G});return Object.prototype.hasOwnProperty.call(V,"$raw")||(V.$raw=R),V}return{$raw:{}}}p.j.getComponentNameForNode=function(v){var P=p.a.R(v);if(p.j.tb(P)&&(P.indexOf("-")!=-1||""+v=="[object HTMLUnknownElement]"||8>=p.a.W&&v.tagName===P))return P},p.j.tc=function(v,P,R,V){if(P.nodeType===1){var H=p.j.getComponentNameForNode(P);if(H){if(v=v||{},v.component)throw Error('Cannot use the "component" binding on a custom element matching a component');var U={name:H,params:g(P,R)};v.component=V?function(){return U}:U}}return v};var b=new p.ga;9>p.a.W&&(p.j.register=function(v){return function(P){return v.apply(this,arguments)}}(p.j.register),i.createDocumentFragment=function(v){return function(){var P=v(),R=p.j.dd,V;for(V in R);return P}}(i.createDocumentFragment))}(),function(){function g(P,R,V){if(R=R.template,!R)throw Error("Component '"+P+"' has no template");P=p.a.Ca(R),p.h.va(V,P)}function b(P,R,V){var H=P.createViewModel;return H?H.call(P,R,V):R}var v=0;p.c.component={init:function(P,R,V,H,U){function G(){var j=k&&k.dispose;typeof j=="function"&&j.call(k),Y&&Y.s(),X=k=Y=null}var k,X,Y,K=p.a.la(p.h.childNodes(P));return p.h.Ea(P),p.a.K.za(P,G),p.o(function(){var j=p.a.f(R()),Z,Q;if(typeof j=="string"?Z=j:(Z=p.a.f(j.name),Q=p.a.f(j.params)),!Z)throw Error("No component name specified");var me=p.i.Cb(P,U),_e=X=++v;p.j.get(Z,function(re){if(X===_e){if(G(),!re)throw Error("Unknown component '"+Z+"'");g(Z,re,P);var fe=b(re,Q,{element:P,templateNodes:K});re=me.createChildContext(fe,{extend:function(ge){ge.$component=fe,ge.$componentTemplateNodes=K}}),fe&&fe.koDescendantsComplete&&(Y=p.i.subscribe(P,p.i.pa,fe.koDescendantsComplete,fe)),k=fe,p.Oa(re,P)}})},null,{l:P}),{controlsDescendantBindings:!0}}},p.h.ea.component=!0}();var L={class:"className",for:"htmlFor"};p.c.attr={update:function(g,b){var v=p.a.f(b())||{};p.a.P(v,function(P,R){R=p.a.f(R);var V=P.indexOf(":"),V="lookupNamespaceURI"in g&&0<V&&g.lookupNamespaceURI(P.substr(0,V)),H=R===!1||R===null||R===t;H?V?g.removeAttributeNS(V,P):g.removeAttribute(P):R=R.toString(),8>=p.a.W&&P in L?(P=L[P],H?g.removeAttribute(P):g[P]=R):H||(V?g.setAttributeNS(V,P,R):g.setAttribute(P,R)),P==="name"&&p.a.Yc(g,H?"":R)})}},function(){p.c.checked={after:["value","attr"],init:function(g,b,v){function P(){var j=g.checked,Z=V();if(!p.S.Ya()&&(j||!U&&!p.S.qa())){var Q=p.u.G(b);if(k){var me=X?Q.v():Q,_e=K;K=Z,_e!==Z?j&&(p.a.Na(me,Z,!0),p.a.Na(me,_e,!1)):p.a.Na(me,Z,j),X&&p.Za(Q)&&Q(me)}else H&&(Z===t?Z=j:j||(Z=t)),p.m.eb(Q,v,"checked",Z,!0)}}function R(){var j=p.a.f(b()),Z=V();k?(g.checked=0<=p.a.A(j,Z),K=Z):g.checked=H&&Z===t?!!j:V()===j}var V=p.xb(function(){if(v.has("checkedValue"))return p.a.f(v.get("checkedValue"));if(Y)return v.has("value")?p.a.f(v.get("value")):g.value}),H=g.type=="checkbox",U=g.type=="radio";if(H||U){var G=b(),k=H&&p.a.f(G)instanceof Array,X=!(k&&G.push&&G.splice),Y=U||k,K=k?V():t;U&&!g.name&&p.c.uniqueName.init(g,function(){return!0}),p.o(P,null,{l:g}),p.a.B(g,"click",P),p.o(R,null,{l:g}),G=t}}},p.m.wa.checked=!0,p.c.checkedValue={update:function(g,b){g.value=p.a.f(b())}}}(),p.c.class={update:function(g,b){var v=p.a.Db(p.a.f(b()));p.a.Eb(g,g.__ko__cssValue,!1),g.__ko__cssValue=v,p.a.Eb(g,v,!0)}},p.c.css={update:function(g,b){var v=p.a.f(b());v!==null&&typeof v=="object"?p.a.P(v,function(P,R){R=p.a.f(R),p.a.Eb(g,P,R)}):p.c.class.update(g,b)}},p.c.enable={update:function(g,b){var v=p.a.f(b());v&&g.disabled?g.removeAttribute("disabled"):v||g.disabled||(g.disabled=!0)}},p.c.disable={update:function(g,b){p.c.enable.update(g,function(){return!p.a.f(b())})}},p.c.event={init:function(g,b,v,P,R){var V=b()||{};p.a.P(V,function(H){typeof H=="string"&&p.a.B(g,H,function(U){var G,k=b()[H];if(k){try{var X=p.a.la(arguments);P=R.$data,X.unshift(P),G=k.apply(P,X)}finally{G!==!0&&(U.preventDefault?U.preventDefault():U.returnValue=!1)}v.get(H+"Bubble")===!1&&(U.cancelBubble=!0,U.stopPropagation&&U.stopPropagation())}})})}},p.c.foreach={Rc:function(g){return function(){var b=g(),v=p.a.bc(b);return!v||typeof v.length=="number"?{foreach:b,templateEngine:p.ba.Ma}:(p.a.f(b),{foreach:v.data,as:v.as,noChildContext:v.noChildContext,includeDestroyed:v.includeDestroyed,afterAdd:v.afterAdd,beforeRemove:v.beforeRemove,afterRender:v.afterRender,beforeMove:v.beforeMove,afterMove:v.afterMove,templateEngine:p.ba.Ma})}},init:function(g,b){return p.c.template.init(g,p.c.foreach.Rc(b))},update:function(g,b,v,P,R){return p.c.template.update(g,p.c.foreach.Rc(b),v,P,R)}},p.m.Ra.foreach=!1,p.h.ea.foreach=!0,p.c.hasfocus={init:function(g,b,v){function P(H){g.__ko_hasfocusUpdating=!0;var U=g.ownerDocument;if("activeElement"in U){var G;try{G=U.activeElement}catch(k){G=U.body}H=G===g}U=b(),p.m.eb(U,v,"hasfocus",H,!0),g.__ko_hasfocusLastValue=H,g.__ko_hasfocusUpdating=!1}var R=P.bind(null,!0),V=P.bind(null,!1);p.a.B(g,"focus",R),p.a.B(g,"focusin",R),p.a.B(g,"blur",V),p.a.B(g,"focusout",V),g.__ko_hasfocusLastValue=!1},update:function(g,b){var v=!!p.a.f(b());g.__ko_hasfocusUpdating||g.__ko_hasfocusLastValue===v||(v?g.focus():g.blur(),!v&&g.__ko_hasfocusLastValue&&g.ownerDocument.body.focus(),p.u.G(p.a.Fb,null,[g,v?"focusin":"focusout"]))}},p.m.wa.hasfocus=!0,p.c.hasFocus=p.c.hasfocus,p.m.wa.hasFocus="hasfocus",p.c.html={init:function(){return{controlsDescendantBindings:!0}},update:function(g,b){p.a.fc(g,b())}},function(){function g(b,v,P){p.c[b]={init:function(R,V,H,U,G){var k,X,Y={},K,j,Z;if(v){U=H.get("as");var Q=H.get("noChildContext");Z=!(U&&Q),Y={as:U,noChildContext:Q,exportDependencies:Z}}return j=(K=H.get("completeOn")=="render")||H.has(p.i.pa),p.o(function(){var me=p.a.f(V()),_e=!P!=!me,re=!X,fe;(Z||_e!==k)&&(j&&(G=p.i.Cb(R,G)),_e&&((!v||Z)&&(Y.dataDependency=p.S.o()),fe=v?G.createChildContext(typeof me=="function"?me:V,Y):p.S.qa()?G.extend(null,Y):G),re&&p.S.qa()&&(X=p.a.Ca(p.h.childNodes(R),!0)),_e?(re||p.h.va(R,p.a.Ca(X)),p.Oa(fe,R)):(p.h.Ea(R),K||p.i.ma(R,p.i.H)),k=_e)},null,{l:R}),{controlsDescendantBindings:!0}}},p.m.Ra[b]=!1,p.h.ea[b]=!0}g("if"),g("ifnot",!1,!0),g("with",!0)}(),p.c.let={init:function(g,b,v,P,R){return b=R.extend(b),p.Oa(b,g),{controlsDescendantBindings:!0}}},p.h.ea.let=!0;var F={};p.c.options={init:function(g){if(p.a.R(g)!=="select")throw Error("options binding applies only to SELECT elements");for(;0<g.length;)g.remove(0);return{controlsDescendantBindings:!0}},update:function(g,b,v){function P(){return p.a.jb(g.options,function(Q){return Q.selected})}function R(Q,me,_e){var re=typeof me;return re=="function"?me(Q):re=="string"?Q[me]:_e}function V(Q,me){if(j&&k)p.i.ma(g,p.i.H);else if(K.length){var _e=0<=p.a.A(K,p.w.M(me[0]));p.a.Zc(me[0],_e),j&&!_e&&p.u.G(p.a.Fb,null,[g,"change"])}}var H=g.multiple,U=g.length!=0&&H?g.scrollTop:null,G=p.a.f(b()),k=v.get("valueAllowUnset")&&v.has("value"),X=v.get("optionsIncludeDestroyed");b={};var Y,K=[];k||(H?K=p.a.Mb(P(),p.w.M):0<=g.selectedIndex&&K.push(p.w.M(g.options[g.selectedIndex]))),G&&(typeof G.length=="undefined"&&(G=[G]),Y=p.a.jb(G,function(Q){return X||Q===t||Q===null||!p.a.f(Q._destroy)}),v.has("optionsCaption")&&(G=p.a.f(v.get("optionsCaption")),G!==null&&G!==t&&Y.unshift(F)));var j=!1;if(b.beforeRemove=function(Q){g.removeChild(Q)},G=V,v.has("optionsAfterRender")&&typeof v.get("optionsAfterRender")=="function"&&(G=function(Q,me){V(0,me),p.u.G(v.get("optionsAfterRender"),null,[me[0],Q!==F?Q:t])}),p.a.ec(g,Y,function(Q,me,_e){return _e.length&&(K=!k&&_e[0].selected?[p.w.M(_e[0])]:[],j=!0),me=g.ownerDocument.createElement("option"),Q===F?(p.a.Bb(me,v.get("optionsCaption")),p.w.cb(me,t)):(_e=R(Q,v.get("optionsValue"),Q),p.w.cb(me,p.a.f(_e)),Q=R(Q,v.get("optionsText"),_e),p.a.Bb(me,Q)),[me]},b,G),!k){var Z;H?Z=K.length&&P().length<K.length:Z=K.length&&0<=g.selectedIndex?p.w.M(g.options[g.selectedIndex])!==K[0]:K.length||0<=g.selectedIndex,Z&&p.u.G(p.a.Fb,null,[g,"change"])}(k||p.S.Ya())&&p.i.ma(g,p.i.H),p.a.wd(g),U&&20<Math.abs(U-g.scrollTop)&&(g.scrollTop=U)}},p.c.options.$b=p.a.g.Z(),p.c.selectedOptions={init:function(g,b,v){function P(){var H=b(),U=[];p.a.D(g.getElementsByTagName("option"),function(G){G.selected&&U.push(p.w.M(G))}),p.m.eb(H,v,"selectedOptions",U)}function R(){var H=p.a.f(b()),U=g.scrollTop;H&&typeof H.length=="number"&&p.a.D(g.getElementsByTagName("option"),function(G){var k=0<=p.a.A(H,p.w.M(G));G.selected!=k&&p.a.Zc(G,k)}),g.scrollTop=U}if(p.a.R(g)!="select")throw Error("selectedOptions binding applies only to SELECT elements");var V;p.i.subscribe(g,p.i.H,function(){V?P():(p.a.B(g,"change",P),V=p.o(R,null,{l:g}))},null,{notifyImmediately:!0})},update:function(){}},p.m.wa.selectedOptions=!0,p.c.style={update:function(g,b){var v=p.a.f(b()||{});p.a.P(v,function(P,R){if(R=p.a.f(R),(R===null||R===t||R===!1)&&(R=""),r)r(g).css(P,R);else if(/^--/.test(P))g.style.setProperty(P,R);else{P=P.replace(/-(\w)/g,function(H,U){return U.toUpperCase()});var V=g.style[P];g.style[P]=R,R===V||g.style[P]!=V||isNaN(R)||(g.style[P]=R+"px")}})}},p.c.submit={init:function(g,b,v,P,R){if(typeof b()!="function")throw Error("The value for a submit binding must be a function");p.a.B(g,"submit",function(V){var H,U=b();try{H=U.call(R.$data,g)}finally{H!==!0&&(V.preventDefault?V.preventDefault():V.returnValue=!1)}})}},p.c.text={init:function(){return{controlsDescendantBindings:!0}},update:function(g,b){p.a.Bb(g,b())}},p.h.ea.text=!0,function(){if(n&&n.navigator){var g=function(Y){if(Y)return parseFloat(Y[1])},b=n.navigator.userAgent,v,P,R,V,H;(v=n.opera&&n.opera.version&&parseInt(n.opera.version()))||(H=g(b.match(/Edge\/([^ ]+)$/)))||g(b.match(/Chrome\/([^ ]+)/))||(P=g(b.match(/Version\/([^ ]+) Safari/)))||(R=g(b.match(/Firefox\/([^ ]+)/)))||(V=p.a.W||g(b.match(/MSIE ([^ ]+)/)))||(V=g(b.match(/rv:([^ )]+)/)))}if(8<=V&&10>V)var U=p.a.g.Z(),G=p.a.g.Z(),k=function(Y){var K=this.activeElement;(K=K&&p.a.g.get(K,G))&&K(Y)},X=function(Y,K){var j=Y.ownerDocument;p.a.g.get(j,U)||(p.a.g.set(j,U,!0),p.a.B(j,"selectionchange",k)),p.a.g.set(Y,G,K)};p.c.textInput={init:function(Y,K,j){function Z(ke,qe){p.a.B(Y,ke,qe)}function Q(){var ke=p.a.f(K());(ke===null||ke===t)&&(ke=""),ge!==t&&ke===ge?p.a.setTimeout(Q,4):Y.value!==ke&&(Be=!0,Y.value=ke,Be=!1,re=Y.value)}function me(){fe||(ge=Y.value,fe=p.a.setTimeout(_e,4))}function _e(){clearTimeout(fe),ge=fe=t;var ke=Y.value;re!==ke&&(re=ke,p.m.eb(K(),j,"textInput",ke))}var re=Y.value,fe,ge,be=p.a.W==9?me:_e,Be=!1;V&&Z("keypress",_e),11>V&&Z("propertychange",function(ke){Be||ke.propertyName!=="value"||be(ke)}),V==8&&(Z("keyup",_e),Z("keydown",_e)),X&&(X(Y,be),Z("dragend",me)),(!V||9<=V)&&Z("input",be),5>P&&p.a.R(Y)==="textarea"?(Z("keydown",me),Z("paste",me),Z("cut",me)):11>v?Z("keydown",me):4>R?(Z("DOMAutoComplete",_e),Z("dragdrop",_e),Z("drop",_e)):H&&Y.type==="number"&&Z("keydown",me),Z("change",_e),Z("blur",_e),p.o(Q,null,{l:Y})}},p.m.wa.textInput=!0,p.c.textinput={preprocess:function(Y,K,j){j("textInput",Y)}}}(),p.c.uniqueName={init:function(g,b){if(b()){var v="ko_unique_"+ ++p.c.uniqueName.rd;p.a.Yc(g,v)}}},p.c.uniqueName.rd=0,p.c.using={init:function(g,b,v,P,R){var V;return v.has("as")&&(V={as:v.get("as"),noChildContext:v.get("noChildContext")}),b=R.createChildContext(b,V),p.Oa(b,g),{controlsDescendantBindings:!0}}},p.h.ea.using=!0,p.c.value={init:function(g,b,v){var P=p.a.R(g),R=P=="input";if(!R||g.type!="checkbox"&&g.type!="radio"){var V=[],H=v.get("valueUpdate"),U=!1,G=null;H&&(typeof H=="string"?V=[H]:V=p.a.wc(H),p.a.Pa(V,"change"));var k=function(){G=null,U=!1;var K=b(),j=p.w.M(g);p.m.eb(K,v,"value",j)};!p.a.W||!R||g.type!="text"||g.autocomplete=="off"||g.form&&g.form.autocomplete=="off"||p.a.A(V,"propertychange")!=-1||(p.a.B(g,"propertychange",function(){U=!0}),p.a.B(g,"focus",function(){U=!1}),p.a.B(g,"blur",function(){U&&k()})),p.a.D(V,function(K){var j=k;p.a.Ud(K,"after")&&(j=function(){G=p.w.M(g),p.a.setTimeout(k,0)},K=K.substring(5)),p.a.B(g,K,j)});var X;if(X=R&&g.type=="file"?function(){var K=p.a.f(b());K===null||K===t||K===""?g.value="":p.u.G(k)}:function(){var K=p.a.f(b()),j=p.w.M(g);G!==null&&K===G?p.a.setTimeout(X,0):(K!==j||j===t)&&(P==="select"?(j=v.get("valueAllowUnset"),p.w.cb(g,K,j),j||K===p.w.M(g)||p.u.G(k)):p.w.cb(g,K))},P==="select"){var Y;p.i.subscribe(g,p.i.H,function(){Y?v.get("valueAllowUnset")?X():k():(p.a.B(g,"change",k),Y=p.o(X,null,{l:g}))},null,{notifyImmediately:!0})}else p.a.B(g,"change",k),p.o(X,null,{l:g})}else p.ib(g,{checkedValue:b})},update:function(){}},p.m.wa.value=!0,p.c.visible={update:function(g,b){var v=p.a.f(b()),P=g.style.display!="none";v&&!P?g.style.display="":!v&&P&&(g.style.display="none")}},p.c.hidden={update:function(g,b){p.c.visible.update(g,function(){return!p.a.f(b())})}},function(g){p.c[g]={init:function(b,v,P,R,V){return p.c.event.init.call(this,b,function(){var H={};return H[g]=v(),H},P,R,V)}}}("click"),p.ca=function(){},p.ca.prototype.renderTemplateSource=function(){throw Error("Override renderTemplateSource")},p.ca.prototype.createJavaScriptEvaluatorBlock=function(){throw Error("Override createJavaScriptEvaluatorBlock")},p.ca.prototype.makeTemplateSource=function(g,b){if(typeof g=="string"){b=b||i;var v=b.getElementById(g);if(!v)throw Error("Cannot find template with ID "+g);return new p.C.F(v)}if(g.nodeType==1||g.nodeType==8)return new p.C.ia(g);throw Error("Unknown template type: "+g)},p.ca.prototype.renderTemplate=function(g,b,v,P){return g=this.makeTemplateSource(g,P),this.renderTemplateSource(g,b,v,P)},p.ca.prototype.isTemplateRewritten=function(g,b){return this.allowTemplateRewriting===!1?!0:this.makeTemplateSource(g,b).data("isRewritten")},p.ca.prototype.rewriteTemplate=function(g,b,v){g=this.makeTemplateSource(g,v),b=b(g.text()),g.text(b),g.data("isRewritten",!0)},p.b("templateEngine",p.ca),p.kc=function(){function g(P,R,V,H){P=p.m.ac(P);for(var U=p.m.Ra,G=0;G<P.length;G++){var k=P[G].key;if(Object.prototype.hasOwnProperty.call(U,k)){var X=U[k];if(typeof X=="function"){if(k=X(P[G].value))throw Error(k)}else if(!X)throw Error("This template engine does not support the '"+k+"' binding within its templates")}}return V="ko.__tr_ambtns(function($context,$element){return(function(){return{ "+p.m.vb(P,{valueAccessors:!0})+" } })()},'"+V.toLowerCase()+"')",H.createJavaScriptEvaluatorBlock(V)+R}var b=/(<([a-z]+\d*)(?:\s+(?!data-bind\s*=\s*)[a-z0-9\-]+(?:=(?:\"[^\"]*\"|\'[^\']*\'|[^>]*))?)*\s+)data-bind\s*=\s*(["'])([\s\S]*?)\3/gi,v=/\x3c!--\s*ko\b\s*([\s\S]*?)\s*--\x3e/g;return{xd:function(P,R,V){R.isTemplateRewritten(P,V)||R.rewriteTemplate(P,function(H){return p.kc.Ld(H,R)},V)},Ld:function(P,R){return P.replace(b,function(V,H,U,G,k){return g(k,H,U,R)}).replace(v,function(V,H){return g(H,"<!-- ko -->","#comment",R)})},md:function(P,R){return p.aa.Xb(function(V,H){var U=V.nextSibling;U&&U.nodeName.toLowerCase()===R&&p.ib(U,P,H)})}}}(),p.b("__tr_ambtns",p.kc.md),function(){p.C={},p.C.F=function(v){if(this.F=v){var P=p.a.R(v);this.ab=P==="script"?1:P==="textarea"?2:P=="template"&&v.content&&v.content.nodeType===11?3:4}},p.C.F.prototype.text=function(){var v=this.ab===1?"text":this.ab===2?"value":"innerHTML";if(arguments.length==0)return this.F[v];var P=arguments[0];v==="innerHTML"?p.a.fc(this.F,P):this.F[v]=P};var g=p.a.g.Z()+"_";p.C.F.prototype.data=function(v){if(arguments.length===1)return p.a.g.get(this.F,g+v);p.a.g.set(this.F,g+v,arguments[1])};var b=p.a.g.Z();p.C.F.prototype.nodes=function(){var v=this.F;if(arguments.length==0){var P=p.a.g.get(v,b)||{},R=P.lb||(this.ab===3?v.content:this.ab===4?v:t);if(!R||P.jd){var V=this.text();V&&V!==P.bb&&(R=p.a.Md(V,v.ownerDocument),p.a.g.set(v,b,{lb:R,bb:V,jd:!0}))}return R}P=arguments[0],this.ab!==t&&this.text(""),p.a.g.set(v,b,{lb:P})},p.C.ia=function(v){this.F=v},p.C.ia.prototype=new p.C.F,p.C.ia.prototype.constructor=p.C.ia,p.C.ia.prototype.text=function(){if(arguments.length==0){var v=p.a.g.get(this.F,b)||{};return v.bb===t&&v.lb&&(v.bb=v.lb.innerHTML),v.bb}p.a.g.set(this.F,b,{bb:arguments[0]})},p.b("templateSources",p.C),p.b("templateSources.domElement",p.C.F),p.b("templateSources.anonymousTemplate",p.C.ia)}(),function(){function g(G,k,X){var Y;for(k=p.h.nextSibling(k);G&&(Y=G)!==k;)G=p.h.nextSibling(Y),X(Y,G)}function b(G,k){if(G.length){var X=G[0],Y=G[G.length-1],K=X.parentNode,j=p.ga.instance,Z=j.preprocessNode;if(Z){if(g(X,Y,function(Q,me){var _e=Q.previousSibling,re=Z.call(j,Q);re&&(Q===X&&(X=re[0]||me),Q===Y&&(Y=re[re.length-1]||_e))}),G.length=0,!X)return;X===Y?G.push(X):(G.push(X,Y),p.a.Ua(G,K))}g(X,Y,function(Q){Q.nodeType!==1&&Q.nodeType!==8||p.vc(k,Q)}),g(X,Y,function(Q){Q.nodeType!==1&&Q.nodeType!==8||p.aa.cd(Q,[k])}),p.a.Ua(G,K)}}function v(G){return G.nodeType?G:0<G.length?G[0]:null}function P(G,k,X,Y,K){K=K||{};var j=(G&&v(G)||X||{}).ownerDocument,Z=K.templateEngine||V;if(p.kc.xd(X,Z,j),X=Z.renderTemplate(X,Y,K,j),typeof X.length!="number"||0<X.length&&typeof X[0].nodeType!="number")throw Error("Template engine must return an array of DOM nodes");switch(j=!1,k){case"replaceChildren":p.h.va(G,X),j=!0;break;case"replaceNode":p.a.Xc(G,X),j=!0;break;case"ignoreTargetNode":break;default:throw Error("Unknown renderMode: "+k)}return j&&(b(X,Y),K.afterRender&&p.u.G(K.afterRender,null,[X,Y[K.as||"$data"]]),k=="replaceChildren"&&p.i.ma(G,p.i.H)),X}function R(G,k,X){return p.O(G)?G():typeof G=="function"?G(k,X):G}var V;p.gc=function(G){if(G!=t&&!(G instanceof p.ca))throw Error("templateEngine must inherit from ko.templateEngine");V=G},p.dc=function(G,k,X,Y,K){if(X=X||{},(X.templateEngine||V)==t)throw Error("Set a template engine before calling renderTemplate");if(K=K||"replaceChildren",Y){var j=v(Y);return p.$(function(){var Q=k&&k instanceof p.fa?k:new p.fa(k,null,null,null,{exportDependencies:!0}),Z=R(G,Q.$data,Q),Q=P(Y,K,Z,Q,X);K=="replaceNode"&&(Y=Q,j=v(Y))},null,{Sa:function(){return!j||!p.a.Sb(j)},l:j&&K=="replaceNode"?j.parentNode:j})}return p.aa.Xb(function(Z){p.dc(G,k,X,Z,"replaceNode")})},p.Qd=function(G,k,X,Y,K){function j(ge,be){p.u.G(p.a.ec,null,[Y,ge,Q,X,Z,be]),p.i.ma(Y,p.i.H)}function Z(ge,be){b(be,me),X.afterRender&&X.afterRender(be,ge),me=null}function Q(ge,be){me=K.createChildContext(ge,{as:_e,noChildContext:X.noChildContext,extend:function(ke){ke.$index=be,_e&&(ke[_e+"Index"]=be)}});var Be=R(G,ge,me);return P(Y,"ignoreTargetNode",Be,me,X)}var me,_e=X.as,re=X.includeDestroyed===!1||p.options.foreachHidesDestroyed&&!X.includeDestroyed;if(re||X.beforeRemove||!p.Pc(k))return p.$(function(){var ge=p.a.f(k)||[];typeof ge.length=="undefined"&&(ge=[ge]),re&&(ge=p.a.jb(ge,function(be){return be===t||be===null||!p.a.f(be._destroy)})),j(ge)},null,{l:Y});j(k.v());var fe=k.subscribe(function(ge){j(k(),ge)},null,"arrayChange");return fe.l(Y),fe};var H=p.a.g.Z(),U=p.a.g.Z();p.c.template={init:function(G,k){var X=p.a.f(k());if(typeof X=="string"||"name"in X)p.h.Ea(G);else if("nodes"in X){if(X=X.nodes||[],p.O(X))throw Error('The "nodes" option must be a plain, non-observable array.');var Y=X[0]&&X[0].parentNode;Y&&p.a.g.get(Y,U)||(Y=p.a.Yb(X),p.a.g.set(Y,U,!0)),new p.C.ia(G).nodes(Y)}else if(X=p.h.childNodes(G),0<X.length)Y=p.a.Yb(X),new p.C.ia(G).nodes(Y);else throw Error("Anonymous template defined, but no template content was provided");return{controlsDescendantBindings:!0}},update:function(G,k,X,Y,K){var j=k();k=p.a.f(j),X=!0,Y=null,typeof k=="string"?k={}:(j="name"in k?k.name:G,"if"in k&&(X=p.a.f(k.if)),X&&"ifnot"in k&&(X=!p.a.f(k.ifnot)),X&&!j&&(X=!1)),"foreach"in k?Y=p.Qd(j,X&&k.foreach||[],k,G,K):X?(X=K,"data"in k&&(X=K.createChildContext(k.data,{as:k.as,noChildContext:k.noChildContext,exportDependencies:!0})),Y=p.dc(j,X,k,G)):p.h.Ea(G),K=Y,(k=p.a.g.get(G,H))&&typeof k.s=="function"&&k.s(),p.a.g.set(G,H,!K||K.ja&&!K.ja()?t:K)}},p.m.Ra.template=function(G){return G=p.m.ac(G),G.length==1&&G[0].unknown||p.m.Id(G,"name")?null:"This template engine does not support anonymous templates nested within its templates"},p.h.ea.template=!0}(),p.b("setTemplateEngine",p.gc),p.b("renderTemplate",p.dc),p.a.Kc=function(g,b,v){if(g.length&&b.length){var P,R,V,H,U;for(P=R=0;(!v||P<v)&&(H=g[R]);++R){for(V=0;U=b[V];++V)if(H.value===U.value){H.moved=U.index,U.moved=H.index,b.splice(V,1),P=V=0;break}P+=V}}},p.a.Pb=function(){function g(b,v,P,R,V){var H=Math.min,U=Math.max,G=[],k,X=b.length,Y,K=v.length,j=K-X||1,Z=X+K+1,Q,me,_e;for(k=0;k<=X;k++)for(me=Q,G.push(Q=[]),_e=H(K,k+j),Y=U(0,k-1);Y<=_e;Y++)Q[Y]=Y?k?b[k-1]===v[Y-1]?me[Y-1]:H(me[Y]||Z,Q[Y-1]||Z)+1:Y+1:k+1;for(H=[],U=[],j=[],k=X,Y=K;k||Y;)K=G[k][Y]-1,Y&&K===G[k][Y-1]?U.push(H[H.length]={status:P,value:v[--Y],index:Y}):k&&K===G[k-1][Y]?j.push(H[H.length]={status:R,value:b[--k],index:k}):(--Y,--k,V.sparse||H.push({status:"retained",value:v[Y]}));return p.a.Kc(j,U,!V.dontLimitMoves&&10*X),H.reverse()}return function(b,v,P){return P=typeof P=="boolean"?{dontLimitMoves:P}:P||{},b=b||[],v=v||[],b.length<v.length?g(b,v,"added","deleted",P):g(v,b,"deleted","added",P)}}(),p.b("utils.compareArrays",p.a.Pb),function(){function g(P,R,V,H,U){var G=[],k=p.$(function(){var X=R(V,U,p.a.Ua(G,P))||[];0<G.length&&(p.a.Xc(G,X),H&&p.u.G(H,null,[V,X,U])),G.length=0,p.a.Nb(G,X)},null,{l:P,Sa:function(){return!p.a.kd(G)}});return{Y:G,$:k.ja()?k:t}}var b=p.a.g.Z(),v=p.a.g.Z();p.a.ec=function(P,R,V,H,U,G){function k(lt){Be={Aa:lt,pb:p.ta(me++)},Z.push(Be),j||be.push(Be)}function X(lt){Be=K[lt],me!==Be.pb.v()&&ge.push(Be),Be.pb(me++),p.a.Ua(Be.Y,P),Z.push(Be)}function Y(lt,Yt){if(lt)for(var si=0,ye=Yt.length;si<ye;si++)p.a.D(Yt[si].Y,function(Oe){lt(Oe,si,Yt[si].Aa)})}R=R||[],typeof R.length=="undefined"&&(R=[R]),H=H||{};var K=p.a.g.get(P,b),j=!K,Z=[],Q=0,me=0,_e=[],re=[],fe=[],ge=[],be=[],Be,ke=0;if(j)p.a.D(R,k);else{if(!G||K&&K._countWaitingForRemove){var qe=p.a.Mb(K,function(lt){return lt.Aa});G=p.a.Pb(qe,R,{dontLimitMoves:H.dontLimitMoves,sparse:!0})}for(var qe=0,Nt,Wt,un;Nt=G[qe];qe++)switch(Wt=Nt.moved,un=Nt.index,Nt.status){case"deleted":for(;Q<un;)X(Q++);Wt===t&&(Be=K[Q],Be.$&&(Be.$.s(),Be.$=t),p.a.Ua(Be.Y,P).length&&(H.beforeRemove&&(Z.push(Be),ke++,Be.Aa===v?Be=null:fe.push(Be)),Be&&_e.push.apply(_e,Be.Y))),Q++;break;case"added":for(;me<un;)X(Q++);Wt!==t?(re.push(Z.length),X(Wt)):k(Nt.value)}for(;me<R.length;)X(Q++);Z._countWaitingForRemove=ke}p.a.g.set(P,b,Z),Y(H.beforeMove,ge),p.a.D(_e,H.beforeRemove?p.oa:p.removeNode);var _t,Rn,oi;try{oi=P.ownerDocument.activeElement}catch(lt){}if(re.length)for(;(qe=re.shift())!=t;){for(Be=Z[qe],_t=t;qe;)if((Rn=Z[--qe].Y)&&Rn.length){_t=Rn[Rn.length-1];break}for(R=0;Q=Be.Y[R];_t=Q,R++)p.h.Wb(P,Q,_t)}for(qe=0;Be=Z[qe];qe++){for(Be.Y||p.a.extend(Be,g(P,V,Be.Aa,U,Be.pb)),R=0;Q=Be.Y[R];_t=Q,R++)p.h.Wb(P,Q,_t);!Be.Ed&&U&&(U(Be.Aa,Be.Y,Be.pb),Be.Ed=!0,_t=Be.Y[Be.Y.length-1])}for(oi&&P.ownerDocument.activeElement!=oi&&oi.focus(),Y(H.beforeRemove,fe),qe=0;qe<fe.length;++qe)fe[qe].Aa=v;Y(H.afterMove,ge),Y(H.afterAdd,be)}}(),p.b("utils.setDomNodeChildrenFromArrayMapping",p.a.ec),p.ba=function(){this.allowTemplateRewriting=!1},p.ba.prototype=new p.ca,p.ba.prototype.constructor=p.ba,p.ba.prototype.renderTemplateSource=function(g,b,v,P){return(b=!(9>p.a.W)&&g.nodes?g.nodes():null)?p.a.la(b.cloneNode(!0).childNodes):(g=g.text(),p.a.ua(g,P))},p.ba.Ma=new p.ba,p.gc(p.ba.Ma),p.b("nativeTemplateEngine",p.ba),function(){p.$a=function(){var b=this.Hd=function(){if(!r||!r.tmpl)return 0;try{if(0<=r.tmpl.tag.tmpl.open.toString().indexOf("__"))return 2}catch(v){}return 1}();this.renderTemplateSource=function(v,P,R,V){if(V=V||i,R=R||{},2>b)throw Error("Your version of jQuery.tmpl is too old. Please upgrade to jQuery.tmpl 1.0.0pre or later.");var H=v.data("precompiled");return H||(H=v.text()||"",H=r.template(null,"{{ko_with $item.koBindingContext}}"+H+"{{/ko_with}}"),v.data("precompiled",H)),v=[P.$data],P=r.extend({koBindingContext:P},R.templateOptions),P=r.tmpl(H,v,P),P.appendTo(V.createElement("div")),r.fragments={},P},this.createJavaScriptEvaluatorBlock=function(v){return"{{ko_code ((function() { return "+v+" })()) }}"},this.addTemplate=function(v,P){i.write("<script type='text/html' id='"+v+"'>"+P+"<\/script>")},0<b&&(r.tmpl.tag.ko_code={open:"__.push($1 || '');"},r.tmpl.tag.ko_with={open:"with($1) {",close:"} "})},p.$a.prototype=new p.ca,p.$a.prototype.constructor=p.$a;var g=new p.$a;0<g.Hd&&p.gc(g),p.b("jqueryTmplTemplateEngine",p.$a)}()})})()})()})();var m$e=ko;typeof window!="undefined"?(ko=window.ko,typeof YD!="undefined"?window.ko=YD:delete window.ko):(ko=global.ko,typeof YD!="undefined"?global.ko=YD:delete global.ko);var DE=m$e;/**
 * @license
 * Knockout ES5 plugin - https://github.com/SteveSanderson/knockout-es5
 * Copyright (c) Steve Sanderson
 * MIT license
 */var W7="__knockoutObservables",j7="__knockoutSubscribable";function Xhe(t,n){if(!t)throw new Error("When calling ko.track, you must pass an object as the first parameter.");var i=this,o=Khe(t,!0);return n=n||Object.getOwnPropertyNames(t),n.forEach(function(r){if(!(r===W7||r===j7)&&!(r in o)){var s=t[r],a=s instanceof Array,c=i.isObservable(s)?s:a?i.observableArray(s):i.observable(s);Object.defineProperty(t,r,{configurable:!0,enumerable:!0,get:c,set:i.isWriteableObservable(c)?c:void 0}),o[r]=c,a&&_$e(i,c)}}),t}function Khe(t,n){var i=t[W7];return!i&&n&&(i={},Object.defineProperty(t,W7,{value:i})),i}function p$e(t,n,i){var o=this,r={owner:t,deferEvaluation:!0};if(typeof i=="function")r.read=i;else{if("value"in i)throw new Error('For ko.defineProperty, you must not specify a "value" for the property. You must provide a "get" function.');if(typeof i.get!="function")throw new Error('For ko.defineProperty, the third parameter must be either an evaluator function, or an options object containing a function called "get".');r.read=i.get,r.write=i.set}return t[n]=o.computed(r),Xhe.call(o,t,[n]),t}function _$e(t,n){var i=null;t.computed(function(){i&&(i.dispose(),i=null);var o=n();o instanceof Array&&(i=g$e(t,n,o))})}function g$e(t,n,i){var o=y$e(t,i);return o.subscribe(n)}function y$e(t,n){var i=n[j7];if(!i){i=new t.subscribable,Object.defineProperty(n,j7,{value:i});var o={};A$e(n,i,o),C$e(t,n,i,o)}return i}function A$e(t,n,i){["pop","push","reverse","shift","sort","splice","unshift"].forEach(function(o){var r=t[o];t[o]=function(){var s=r.apply(this,arguments);return i.pause!==!0&&n.notifySubscribers(this),s}})}function C$e(t,n,i,o){["remove","removeAll","destroy","destroyAll","replace"].forEach(function(r){Object.defineProperty(n,r,{enumerable:!1,value:function(){var s;o.pause=!0;try{s=t.observableArray.fn[r].apply(t.observableArray(n),arguments)}finally{o.pause=!1}return i.notifySubscribers(n),s}})})}function Jhe(t,n){if(!t)return null;var i=Khe(t,!1);return i&&i[n]||null}function x$e(t,n){var i=Jhe(t,n);i&&i.valueHasMutated()}function T$e(t){t.track=Xhe,t.getObservable=Jhe,t.valueHasMutated=x$e,t.defineProperty=p$e}var bV={attachToKo:T$e};var Zhe="http://www.w3.org/2000/svg",Qhe="cesium-svgPath-svg",E$e={register:function(t){t.bindingHandlers.cesiumSvgPath={init:function(n,i){let o=document.createElementNS(Zhe,"svg:svg");o.setAttribute("class",Qhe);let r=document.createElementNS(Zhe,"path");return o.appendChild(r),t.virtualElements.setDomNodeChildren(n,[o]),t.computed({read:function(){let s=t.unwrap(i());r.setAttribute("d",t.unwrap(s.path));let a=t.unwrap(s.width),c=t.unwrap(s.height);o.setAttribute("width",a),o.setAttribute("height",c),o.setAttribute("viewBox",`0 0 ${a} ${c}`),s.css&&o.setAttribute("class",`${Qhe} ${t.unwrap(s.css)}`)},disposeWhenNodeIsRemoved:n}),{controlsDescendantBindings:!0}}},t.virtualElements.allowedBindings.cesiumSvgPath=!0}},SV=E$e;bV.attachToKo(DE);SV.register(DE);var xe=DE;var XD=`#ifdef MRT
#extension GL_EXT_draw_buffers : enable
#endif
uniform vec4 u_bgColor;
uniform sampler2D u_depthTexture;
varying vec2 v_textureCoordinates;
void main()
{
if (texture2D(u_depthTexture, v_textureCoordinates).r < 1.0)
{
#ifdef MRT
gl_FragData[0] = u_bgColor;
gl_FragData[1] = vec4(u_bgColor.a);
#else
gl_FragColor = u_bgColor;
#endif
return;
}
discard;
}
`;var zg=`uniform vec3 u_radiiAndDynamicAtmosphereColor;
uniform float u_atmosphereLightIntensity;
uniform float u_atmosphereRayleighScaleHeight;
uniform float u_atmosphereMieScaleHeight;
uniform float u_atmosphereMieAnisotropy;
uniform vec3 u_atmosphereRayleighCoefficient;
uniform vec3 u_atmosphereMieCoefficient;
const float ATMOSPHERE_THICKNESS = 111e3;
const int PRIMARY_STEPS = 16;
const int LIGHT_STEPS = 4;
void computeScattering(
czm_ray primaryRay,
float primaryRayLength,
vec3 lightDirection,
float atmosphereInnerRadius,
out vec3 rayleighColor,
out vec3 mieColor,
out float opacity
) {
rayleighColor = vec3(0.0);
mieColor = vec3(0.0);
opacity = 0.0;
float atmosphereOuterRadius = atmosphereInnerRadius + ATMOSPHERE_THICKNESS;
vec3 origin = vec3(0.0);
czm_raySegment primaryRayAtmosphereIntersect = czm_raySphereIntersectionInterval(primaryRay, origin, atmosphereOuterRadius);
if (primaryRayAtmosphereIntersect == czm_emptyRaySegment) {
return;
}
primaryRayAtmosphereIntersect.start = max(primaryRayAtmosphereIntersect.start, 0.0);
primaryRayAtmosphereIntersect.stop = min(primaryRayAtmosphereIntersect.stop, length(primaryRayLength));
float rayStepLength = (primaryRayAtmosphereIntersect.stop - primaryRayAtmosphereIntersect.start) / float(PRIMARY_STEPS);
float rayPositionLength = primaryRayAtmosphereIntersect.start;
vec3 rayleighAccumulation = vec3(0.0);
vec3 mieAccumulation = vec3(0.0);
vec2 opticalDepth = vec2(0.0);
vec2 heightScale = vec2(u_atmosphereRayleighScaleHeight, u_atmosphereMieScaleHeight);
for (int i = 0; i < PRIMARY_STEPS; i++) {
vec3 samplePosition = primaryRay.origin + primaryRay.direction * (rayPositionLength + rayStepLength);
float sampleHeight = length(samplePosition) - atmosphereInnerRadius;
vec2 sampleDensity = exp(-sampleHeight / heightScale) * rayStepLength;
opticalDepth += sampleDensity;
czm_ray lightRay = czm_ray(samplePosition, lightDirection);
czm_raySegment lightRayAtmosphereIntersect = czm_raySphereIntersectionInterval(lightRay, origin, atmosphereOuterRadius);
float lightStepLength = lightRayAtmosphereIntersect.stop / float(LIGHT_STEPS);
float lightPositionLength = 0.0;
vec2 lightOpticalDepth = vec2(0.0);
for (int j = 0; j < LIGHT_STEPS; j++) {
vec3 lightPosition = samplePosition + lightDirection * (lightPositionLength + lightStepLength * 0.5);
float lightHeight = length(lightPosition) - atmosphereInnerRadius;
lightOpticalDepth += exp(-lightHeight / heightScale) * lightStepLength;
lightPositionLength += lightStepLength;
}
vec3 attenuation = exp(-((u_atmosphereMieCoefficient * (opticalDepth.y + lightOpticalDepth.y)) + (u_atmosphereRayleighCoefficient * (opticalDepth.x + lightOpticalDepth.x))));
rayleighAccumulation += sampleDensity.x * attenuation;
mieAccumulation += sampleDensity.y * attenuation;
rayPositionLength += rayStepLength;
}
rayleighColor = u_atmosphereRayleighCoefficient * rayleighAccumulation;
mieColor = u_atmosphereMieCoefficient * mieAccumulation;
opacity = length(exp(-((u_atmosphereMieCoefficient * opticalDepth.y) + (u_atmosphereRayleighCoefficient * opticalDepth.x))));
}
vec4 computeAtmosphereColor(
vec3 positionWC,
vec3 lightDirection,
vec3 rayleighColor,
vec3 mieColor,
float opacity
) {
vec3 cameraToPositionWC = positionWC - czm_viewerPositionWC;
vec3 cameraToPositionWCDirection = normalize(cameraToPositionWC);
float cosAngle = dot(cameraToPositionWCDirection, lightDirection);
float cosAngleSq = cosAngle * cosAngle;
float G = u_atmosphereMieAnisotropy;
float GSq = G * G;
float rayleighPhase = 3.0 / (50.2654824574) * (1.0 + cosAngleSq);
float miePhase = 3.0 / (25.1327412287) * ((1.0 - GSq) * (cosAngleSq + 1.0)) / (pow(1.0 + GSq - 2.0 * cosAngle * G, 1.5) * (2.0 + GSq));
vec3 rayleigh = rayleighPhase * rayleighColor;
vec3 mie = miePhase * mieColor;
vec3 color = (rayleigh + mie) * u_atmosphereLightIntensity;
return vec4(color, opacity);
}
`;var wV=`varying vec2 v_textureCoordinates;
const float M_PI = 3.141592653589793;
float vdcRadicalInverse(int i)
{
float r;
float base = 2.0;
float value = 0.0;
float invBase = 1.0 / base;
float invBi = invBase;
for (int x = 0; x < 100; x++)
{
if (i <= 0)
{
break;
}
r = mod(float(i), base);
value += r * invBi;
invBi *= invBase;
i = int(float(i) * invBase);
}
return value;
}
vec2 hammersley2D(int i, int N)
{
return vec2(float(i) / float(N), vdcRadicalInverse(i));
}
vec3 importanceSampleGGX(vec2 xi, float roughness, vec3 N)
{
float a = roughness * roughness;
float phi = 2.0 * M_PI * xi.x;
float cosTheta = sqrt((1.0 - xi.y) / (1.0 + (a * a - 1.0) * xi.y));
float sinTheta = sqrt(1.0 - cosTheta * cosTheta);
vec3 H = vec3(sinTheta * cos(phi), sinTheta * sin(phi), cosTheta);
vec3 upVector = abs(N.z) < 0.999 ? vec3(0.0, 0.0, 1.0) : vec3(1.0, 0.0, 0.0);
vec3 tangentX = normalize(cross(upVector, N));
vec3 tangentY = cross(N, tangentX);
return tangentX * H.x + tangentY * H.y + N * H.z;
}
float G1_Smith(float NdotV, float k)
{
return NdotV / (NdotV * (1.0 - k) + k);
}
float G_Smith(float roughness, float NdotV, float NdotL)
{
float k = roughness * roughness / 2.0;
return G1_Smith(NdotV, k) * G1_Smith(NdotL, k);
}
vec2 integrateBrdf(float roughness, float NdotV)
{
vec3 V = vec3(sqrt(1.0 - NdotV * NdotV), 0.0, NdotV);
float A = 0.0;
float B = 0.0;
const int NumSamples = 1024;
for (int i = 0; i < NumSamples; i++)
{
vec2 xi = hammersley2D(i, NumSamples);
vec3 H = importanceSampleGGX(xi, roughness, vec3(0.0, 0.0, 1.0));
vec3 L = 2.0 * dot(V, H) * H - V;
float NdotL = clamp(L.z, 0.0, 1.0);
float NdotH = clamp(H.z, 0.0, 1.0);
float VdotH = clamp(dot(V, H), 0.0, 1.0);
if (NdotL > 0.0)
{
float G = G_Smith(roughness, NdotV, NdotL);
float G_Vis = G * VdotH / (NdotH * NdotV);
float Fc = pow(1.0 - VdotH, 5.0);
A += (1.0 - Fc) * G_Vis;
B += Fc * G_Vis;
}
}
return vec2(A, B) / float(NumSamples);
}
void main()
{
gl_FragColor = vec4(integrateBrdf(v_textureCoordinates.y, v_textureCoordinates.x), 0.0, 1.0);
}
`;var DV=`uniform sampler2D u_noiseTexture;
uniform vec3 u_noiseTextureDimensions;
uniform float u_noiseDetail;
varying vec2 v_offset;
varying vec3 v_maximumSize;
varying vec4 v_color;
varying float v_slice;
varying float v_brightness;
float wrap(float value, float rangeLength) {
if(value < 0.0) {
float absValue = abs(value);
float modValue = mod(absValue, rangeLength);
return mod(rangeLength - modValue, rangeLength);
}
return mod(value, rangeLength);
}
vec3 wrapVec(vec3 value, float rangeLength) {
return vec3(wrap(value.x, rangeLength),
wrap(value.y, rangeLength),
wrap(value.z, rangeLength));
}
float textureSliceWidth = u_noiseTextureDimensions.x;
float noiseTextureRows = u_noiseTextureDimensions.y;
float inverseNoiseTextureRows = u_noiseTextureDimensions.z;
float textureSliceWidthSquared = textureSliceWidth * textureSliceWidth;
vec2 inverseNoiseTextureDimensions = vec2(noiseTextureRows / textureSliceWidthSquared,
inverseNoiseTextureRows / textureSliceWidth);
vec2 voxelToUV(vec3 voxelIndex) {
vec3 wrappedIndex = wrapVec(voxelIndex, textureSliceWidth);
float column = mod(wrappedIndex.z, textureSliceWidth * inverseNoiseTextureRows);
float row = floor(wrappedIndex.z / textureSliceWidth * noiseTextureRows);
float xPixelCoord = wrappedIndex.x + column * textureSliceWidth;
float yPixelCoord = wrappedIndex.y + row * textureSliceWidth;
return vec2(xPixelCoord, yPixelCoord) * inverseNoiseTextureDimensions;
}
vec4 lerpSamplesX(vec3 voxelIndex, float x) {
vec2 uv0 = voxelToUV(voxelIndex);
vec2 uv1 = voxelToUV(voxelIndex + vec3(1.0, 0.0, 0.0));
vec4 sample0 = texture2D(u_noiseTexture, uv0);
vec4 sample1 = texture2D(u_noiseTexture, uv1);
return mix(sample0, sample1, x);
}
vec4 sampleNoiseTexture(vec3 position) {
vec3 recenteredPos = position + vec3(textureSliceWidth / 2.0);
vec3 lerpValue = fract(recenteredPos);
vec3 voxelIndex = floor(recenteredPos);
vec4 xLerp00 = lerpSamplesX(voxelIndex, lerpValue.x);
vec4 xLerp01 = lerpSamplesX(voxelIndex + vec3(0.0, 0.0, 1.0), lerpValue.x);
vec4 xLerp10 = lerpSamplesX(voxelIndex + vec3(0.0, 1.0, 0.0), lerpValue.x);
vec4 xLerp11 = lerpSamplesX(voxelIndex + vec3(0.0, 1.0, 1.0), lerpValue.x);
vec4 yLerp0 = mix(xLerp00, xLerp10, lerpValue.y);
vec4 yLerp1 = mix(xLerp01, xLerp11, lerpValue.y);
return mix(yLerp0, yLerp1, lerpValue.z);
}
bool intersectSphere(vec3 origin, vec3 dir, float slice,
out vec3 point, out vec3 normal) {
float A = dot(dir, dir);
float B = dot(origin, dir);
float C = dot(origin, origin) - 0.25;
float discriminant = (B * B) - (A * C);
if(discriminant < 0.0) {
return false;
}
float root = sqrt(discriminant);
float t = (-B - root) / A;
if(t < 0.0) {
t = (-B + root) / A;
}
point = origin + t * dir;
if(slice >= 0.0) {
point.z = (slice / 2.0) - 0.5;
if(length(point) > 0.5) {
return false;
}
}
normal = normalize(point);
point -= czm_epsilon2 * normal;
return true;
}
bool intersectEllipsoid(vec3 origin, vec3 dir, vec3 center, vec3 scale, float slice,
out vec3 point, out vec3 normal) {
if(scale.x <= 0.01 || scale.y < 0.01 || scale.z < 0.01) {
return false;
}
vec3 o = (origin - center) / scale;
vec3 d = dir / scale;
vec3 p, n;
bool intersected = intersectSphere(o, d, slice, p, n);
if(intersected) {
point = (p * scale) + center;
normal = n;
}
return intersected;
}
vec2 phaseShift2D(vec2 p, vec2 freq) {
return (czm_pi / 2.0) * sin(freq.yx * p.yx);
}
vec2 phaseShift3D(vec3 p, vec2 freq) {
return phaseShift2D(p.xy, freq) + czm_pi * vec2(sin(freq.x * p.z));
}
const float T0    = 0.6;
const float k     = 0.1;
const float C0    = 0.8;
const float FX0   = 0.6;
const float FY0   = 0.6;
const int octaves = 5;
float T(vec3 point) {
vec2 sum = vec2(0.0);
float Ci = C0;
vec2 FXY = vec2(FX0, FY0);
vec2 PXY = vec2(0.0);
for(int i = 1; i <= octaves; i++) {
PXY = phaseShift3D(point, FXY);
Ci *= 0.707;
FXY *= 2.0;
vec2 sinTerm = sin(FXY * point.xy + PXY);
sum += Ci * sinTerm + vec2(T0);
}
return k * sum.x * sum.y;
}
const float a = 0.5;
const float t = 0.4;
const float s = 0.25;
float I(float Id, float Is, float It) {
return (1.0 - a) * ((1.0 - t) * ((1.0 - s) * Id + s * Is) + t * It) + a;
}
const vec3 lightDir = normalize(vec3(0.2, -1.0, 0.7));
vec4 drawCloud(vec3 rayOrigin, vec3 rayDir, vec3 cloudCenter, vec3 cloudScale, float cloudSlice,
float brightness) {
vec3 cloudPoint, cloudNormal;
if(!intersectEllipsoid(rayOrigin, rayDir, cloudCenter, cloudScale, cloudSlice,
cloudPoint, cloudNormal)) {
return vec4(0.0);
}
float Id = clamp(dot(cloudNormal, -lightDir), 0.0, 1.0);
float Is = max(pow(dot(-lightDir, -rayDir), 2.0), 0.0);
float It = T(cloudPoint);
float intensity = I(Id, Is, It);
vec3 color = vec3(intensity * clamp(brightness, 0.1, 1.0));
vec4 noise = sampleNoiseTexture(u_noiseDetail * cloudPoint);
float W = noise.x;
float W2 = noise.y;
float W3 = noise.z;
float ndDot = clamp(dot(cloudNormal, -rayDir), 0.0, 1.0);
float TR = pow(ndDot, 3.0) - W;
TR *= 1.3;
float minusDot = 0.5 - ndDot;
TR -= min(minusDot * W2, 0.0);
TR -= 0.8 * (minusDot + 0.25) * W3;
float shading = mix(1.0 - 0.8 * W * W, 1.0, Id * TR);
shading = clamp(shading + 0.2, 0.3, 1.0);
vec3 finalColor = mix(vec3(0.5), shading * color, 1.15);
return vec4(finalColor, clamp(TR, 0.0, 1.0)) * v_color;
}
void main() {
#ifdef DEBUG_BILLBOARDS
gl_FragColor = vec4(0.0, 0.5, 0.5, 1.0);
#endif
vec2 coordinate = v_maximumSize.xy * v_offset;
vec3 ellipsoidScale = 0.82 * v_maximumSize;
vec3 ellipsoidCenter = vec3(0.0);
float zOffset = max(ellipsoidScale.z - 10.0, 0.0);
vec3 eye = vec3(0, 0, -10.0 - zOffset);
vec3 rayDir = normalize(vec3(coordinate, 1.0) - eye);
vec3 rayOrigin = eye;
#ifdef DEBUG_ELLIPSOIDS
vec3 point, normal;
if(intersectEllipsoid(rayOrigin, rayDir, ellipsoidCenter, ellipsoidScale, v_slice,
point, normal)) {
gl_FragColor = v_brightness * v_color;
}
#else
#ifndef DEBUG_BILLBOARDS
vec4 cloud = drawCloud(rayOrigin, rayDir,
ellipsoidCenter, ellipsoidScale, v_slice, v_brightness);
if(cloud.w < 0.01) {
discard;
}
gl_FragColor = cloud;
#endif
#endif
}
`;var vV=`#ifdef INSTANCED
attribute vec2 direction;
#endif
attribute vec4 positionHighAndScaleX;
attribute vec4 positionLowAndScaleY;
attribute vec4 packedAttribute0;
attribute vec4 packedAttribute1;
attribute vec4 color;
varying vec2 v_offset;
varying vec3 v_maximumSize;
varying vec4 v_color;
varying float v_slice;
varying float v_brightness;
void main() {
vec3 positionHigh = positionHighAndScaleX.xyz;
vec3 positionLow = positionLowAndScaleY.xyz;
vec2 scale = vec2(positionHighAndScaleX.w, positionLowAndScaleY.w);
float show = packedAttribute0.x;
float brightness = packedAttribute0.y;
vec2 coordinates = packedAttribute0.wz;
vec3 maximumSize = packedAttribute1.xyz;
float slice = packedAttribute1.w;
#ifdef INSTANCED
vec2 dir = direction;
#else
vec2 dir = coordinates;
#endif
vec2 offset = dir - vec2(0.5, 0.5);
vec2 scaledOffset = scale * offset;
vec4 p = czm_translateRelativeToEye(positionHigh, positionLow);
vec4 positionEC = czm_modelViewRelativeToEye * p;
positionEC.xy += scaledOffset;
positionEC.xyz *= show;
gl_Position = czm_projection * positionEC;
v_offset = offset;
v_maximumSize = maximumSize;
v_color = color;
v_slice = slice;
v_brightness = brightness;
}
`;var PV=`uniform vec3 u_noiseTextureDimensions;
uniform float u_noiseDetail;
uniform vec3 u_noiseOffset;
varying vec2 v_position;
float textureSliceWidth = u_noiseTextureDimensions.x;
float inverseNoiseTextureRows = u_noiseTextureDimensions.z;
float wrap(float value, float rangeLength) {
if(value < 0.0) {
float absValue = abs(value);
float modValue = mod(absValue, rangeLength);
return mod(rangeLength - modValue, rangeLength);
}
return mod(value, rangeLength);
}
vec3 wrapVec(vec3 value, float rangeLength) {
return vec3(wrap(value.x, rangeLength),
wrap(value.y, rangeLength),
wrap(value.z, rangeLength));
}
vec3 random3(vec3 p) {
float dot1 = dot(p, vec3(127.1, 311.7, 932.8));
float dot2 = dot(p, vec3(269.5, 183.3, 421.4));
return fract(vec3(sin(dot1 - dot2), cos(dot1 * dot2), dot1 * dot2));
}
vec3 getWorleyCellPoint(vec3 centerCell, vec3 offset, float freq) {
vec3 cell = centerCell + offset;
cell = wrapVec(cell, textureSliceWidth / u_noiseDetail);
cell += floor(u_noiseOffset / u_noiseDetail);
vec3 p = offset + random3(cell);
return p;
}
float worleyNoise(vec3 p, float freq) {
vec3 centerCell = floor(p * freq);
vec3 pointInCell = fract(p * freq);
float shortestDistance = 1000.0;
for(float z = -1.0; z <= 1.0; z++) {
for(float y = -1.0; y <= 1.0; y++) {
for(float x = -1.0; x <= 1.0; x++) {
vec3 offset = vec3(x, y, z);
vec3 point = getWorleyCellPoint(centerCell, offset, freq);
float distance = length(pointInCell - point);
if(distance < shortestDistance) {
shortestDistance = distance;
}
}
}
}
return shortestDistance;
}
const float MAX_FBM_ITERATIONS = 10.0;
float worleyFBMNoise(vec3 p, float octaves, float scale) {
float noise = 0.0;
float freq = 1.0;
float persistence = 0.625;
for(float i = 0.0; i < MAX_FBM_ITERATIONS; i++) {
if(i >= octaves) {
break;
}
noise += worleyNoise(p * scale, freq * scale) * persistence;
persistence *= 0.5;
freq *= 2.0;
}
return noise;
}
void main() {
float x = mod(v_position.x, textureSliceWidth);
float y = mod(v_position.y, textureSliceWidth);
float sliceRow = floor(v_position.y / textureSliceWidth);
float z = floor(v_position.x / textureSliceWidth) + sliceRow * inverseNoiseTextureRows * textureSliceWidth;
vec3 position = vec3(x, y, z);
position /= u_noiseDetail;
float worley0 = clamp(worleyFBMNoise(position, 3.0, 1.0), 0.0, 1.0);
float worley1 = clamp(worleyFBMNoise(position, 3.0, 2.0), 0.0, 1.0);
float worley2 = clamp(worleyFBMNoise(position, 3.0, 3.0), 0.0, 1.0);
gl_FragColor = vec4(worley0, worley1, worley2, 1.0);
}
`;var IV=`uniform vec3 u_noiseTextureDimensions;
attribute vec2 position;
varying vec2 v_position;
void main()
{
gl_Position = vec4(position, 0.1, 1.0);
float textureSliceWidth = u_noiseTextureDimensions.x;
float noiseTextureRows = u_noiseTextureDimensions.y;
float inverseNoiseTextureRows = u_noiseTextureDimensions.z;
vec2 transformedPos = (position * 0.5) + vec2(0.5);
transformedPos *= textureSliceWidth;
transformedPos.x *= textureSliceWidth * inverseNoiseTextureRows;
transformedPos.y *= noiseTextureRows;
v_position = transformedPos;
}
`;var BV=`uniform sampler2D u_opaqueDepthTexture;
uniform sampler2D u_translucentDepthTexture;
varying vec2 v_textureCoordinates;
void main()
{
float opaqueDepth = texture2D(u_opaqueDepthTexture, v_textureCoordinates).r;
float translucentDepth = texture2D(u_translucentDepthTexture, v_textureCoordinates).r;
translucentDepth = czm_branchFreeTernary(translucentDepth > opaqueDepth, 1.0, translucentDepth);
gl_FragColor = czm_packDepth(translucentDepth);
}
`;var OV=`uniform sampler2D u_opaque;
uniform sampler2D u_accumulation;
uniform sampler2D u_revealage;
varying vec2 v_textureCoordinates;
void main()
{
vec4 opaque = texture2D(u_opaque, v_textureCoordinates);
vec4 accum = texture2D(u_accumulation, v_textureCoordinates);
float r = texture2D(u_revealage, v_textureCoordinates).r;
#ifdef MRT
vec4 transparent = vec4(accum.rgb / clamp(r, 1e-4, 5e4), accum.a);
#else
vec4 transparent = vec4(accum.rgb / clamp(accum.a, 1e-4, 5e4), r);
#endif
gl_FragColor = (1.0 - transparent.a) * transparent + transparent.a * opaque;
if (opaque != czm_backgroundColor)
{
gl_FragColor.a = 1.0;
}
}
`;var RV=`varying vec4 positionEC;
void main()
{
vec3 position;
vec3 direction;
if (czm_orthographicIn3D == 1.0)
{
vec2 uv = (gl_FragCoord.xy -  czm_viewport.xy) / czm_viewport.zw;
vec2 minPlane = vec2(czm_frustumPlanes.z, czm_frustumPlanes.y);
vec2 maxPlane = vec2(czm_frustumPlanes.w, czm_frustumPlanes.x);
position = vec3(mix(minPlane, maxPlane, uv), 0.0);
direction = vec3(0.0, 0.0, -1.0);
}
else
{
position = vec3(0.0);
direction = normalize(positionEC.xyz);
}
czm_ray ray = czm_ray(position, direction);
vec3 ellipsoid_center = czm_view[3].xyz;
czm_raySegment intersection = czm_rayEllipsoidIntersectionInterval(ray, ellipsoid_center, czm_ellipsoidInverseRadii);
if (!czm_isEmpty(intersection))
{
gl_FragColor = vec4(1.0, 1.0, 0.0, 1.0);
}
else
{
discard;
}
czm_writeLogDepth();
}
`;var MV=`attribute vec4 position;
varying vec4 positionEC;
void main()
{
positionEC = czm_modelView * position;
gl_Position = czm_projection * positionEC;
czm_vertexLogDepth();
}
`;var KD=`#ifdef WRITE_DEPTH
#ifdef GL_EXT_frag_depth
#extension GL_EXT_frag_depth : enable
#endif
#endif
uniform vec3 u_radii;
uniform vec3 u_oneOverEllipsoidRadiiSquared;
varying vec3 v_positionEC;
vec4 computeEllipsoidColor(czm_ray ray, float intersection, float side)
{
vec3 positionEC = czm_pointAlongRay(ray, intersection);
vec3 positionMC = (czm_inverseModelView * vec4(positionEC, 1.0)).xyz;
vec3 geodeticNormal = normalize(czm_geodeticSurfaceNormal(positionMC, vec3(0.0), u_oneOverEllipsoidRadiiSquared));
vec3 sphericalNormal = normalize(positionMC / u_radii);
vec3 normalMC = geodeticNormal * side;
vec3 normalEC = normalize(czm_normal * normalMC);
vec2 st = czm_ellipsoidWgs84TextureCoordinates(sphericalNormal);
vec3 positionToEyeEC = -positionEC;
czm_materialInput materialInput;
materialInput.s = st.s;
materialInput.st = st;
materialInput.str = (positionMC + u_radii) / u_radii;
materialInput.normalEC = normalEC;
materialInput.tangentToEyeMatrix = czm_eastNorthUpToEyeCoordinates(positionMC, normalEC);
materialInput.positionToEyeEC = positionToEyeEC;
czm_material material = czm_getMaterial(materialInput);
#ifdef ONLY_SUN_LIGHTING
return czm_private_phong(normalize(positionToEyeEC), material, czm_sunDirectionEC);
#else
return czm_phong(normalize(positionToEyeEC), material, czm_lightDirectionEC);
#endif
}
void main()
{
float maxRadius = max(u_radii.x, max(u_radii.y, u_radii.z)) * 1.5;
vec3 direction = normalize(v_positionEC);
vec3 ellipsoidCenter = czm_modelView[3].xyz;
float t1 = -1.0;
float t2 = -1.0;
float b = -2.0 * dot(direction, ellipsoidCenter);
float c = dot(ellipsoidCenter, ellipsoidCenter) - maxRadius * maxRadius;
float discriminant = b * b - 4.0 * c;
if (discriminant >= 0.0) {
t1 = (-b - sqrt(discriminant)) * 0.5;
t2 = (-b + sqrt(discriminant)) * 0.5;
}
if (t1 < 0.0 && t2 < 0.0) {
discard;
}
float t = min(t1, t2);
if (t < 0.0) {
t = 0.0;
}
czm_ray ray = czm_ray(t * direction, direction);
vec3 ellipsoid_inverseRadii = vec3(1.0 / u_radii.x, 1.0 / u_radii.y, 1.0 / u_radii.z);
czm_raySegment intersection = czm_rayEllipsoidIntersectionInterval(ray, ellipsoidCenter, ellipsoid_inverseRadii);
if (czm_isEmpty(intersection))
{
discard;
}
vec4 outsideFaceColor = (intersection.start != 0.0) ? computeEllipsoidColor(ray, intersection.start, 1.0) : vec4(0.0);
vec4 insideFaceColor = (outsideFaceColor.a < 1.0) ? computeEllipsoidColor(ray, intersection.stop, -1.0) : vec4(0.0);
gl_FragColor = mix(insideFaceColor, outsideFaceColor, outsideFaceColor.a);
gl_FragColor.a = 1.0 - (1.0 - insideFaceColor.a) * (1.0 - outsideFaceColor.a);
#ifdef WRITE_DEPTH
#ifdef GL_EXT_frag_depth
t = (intersection.start != 0.0) ? intersection.start : intersection.stop;
vec3 positionEC = czm_pointAlongRay(ray, t);
vec4 positionCC = czm_projection * vec4(positionEC, 1.0);
#ifdef LOG_DEPTH
czm_writeLogDepth(1.0 + positionCC.w);
#else
float z = positionCC.z / positionCC.w;
float n = czm_depthRange.near;
float f = czm_depthRange.far;
gl_FragDepthEXT = (z * (f - n) + f + n) * 0.5;
#endif
#endif
#endif
}
`;var JD=`attribute vec3 position;
uniform vec3 u_radii;
varying vec3 v_positionEC;
void main()
{
vec4 p = vec4(u_radii * position, 1.0);
v_positionEC = (czm_modelView * p).xyz;
gl_Position = czm_modelViewProjection * p;
gl_Position.z = clamp(gl_Position.z, czm_depthRange.near, czm_depthRange.far);
czm_vertexLogDepth();
}
`;/**
 * @license
 * Copyright (c) 2014-2015, NVIDIA CORPORATION. All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 *  * Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 *  * Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 *  * Neither the name of NVIDIA CORPORATION nor the names of its
 *    contributors may be used to endorse or promote products derived
 *    from this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS ``AS IS'' AND ANY
 * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
 * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR
 * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
 * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
 * PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
 * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */var LV=`#if (FXAA_QUALITY_PRESET == 10)
#define FXAA_QUALITY_PS 3
#define FXAA_QUALITY_P0 1.5
#define FXAA_QUALITY_P1 3.0
#define FXAA_QUALITY_P2 12.0
#endif
#if (FXAA_QUALITY_PRESET == 11)
#define FXAA_QUALITY_PS 4
#define FXAA_QUALITY_P0 1.0
#define FXAA_QUALITY_P1 1.5
#define FXAA_QUALITY_P2 3.0
#define FXAA_QUALITY_P3 12.0
#endif
#if (FXAA_QUALITY_PRESET == 12)
#define FXAA_QUALITY_PS 5
#define FXAA_QUALITY_P0 1.0
#define FXAA_QUALITY_P1 1.5
#define FXAA_QUALITY_P2 2.0
#define FXAA_QUALITY_P3 4.0
#define FXAA_QUALITY_P4 12.0
#endif
#if (FXAA_QUALITY_PRESET == 13)
#define FXAA_QUALITY_PS 6
#define FXAA_QUALITY_P0 1.0
#define FXAA_QUALITY_P1 1.5
#define FXAA_QUALITY_P2 2.0
#define FXAA_QUALITY_P3 2.0
#define FXAA_QUALITY_P4 4.0
#define FXAA_QUALITY_P5 12.0
#endif
#if (FXAA_QUALITY_PRESET == 14)
#define FXAA_QUALITY_PS 7
#define FXAA_QUALITY_P0 1.0
#define FXAA_QUALITY_P1 1.5
#define FXAA_QUALITY_P2 2.0
#define FXAA_QUALITY_P3 2.0
#define FXAA_QUALITY_P4 2.0
#define FXAA_QUALITY_P5 4.0
#define FXAA_QUALITY_P6 12.0
#endif
#if (FXAA_QUALITY_PRESET == 15)
#define FXAA_QUALITY_PS 8
#define FXAA_QUALITY_P0 1.0
#define FXAA_QUALITY_P1 1.5
#define FXAA_QUALITY_P2 2.0
#define FXAA_QUALITY_P3 2.0
#define FXAA_QUALITY_P4 2.0
#define FXAA_QUALITY_P5 2.0
#define FXAA_QUALITY_P6 4.0
#define FXAA_QUALITY_P7 12.0
#endif
#if (FXAA_QUALITY_PRESET == 20)
#define FXAA_QUALITY_PS 3
#define FXAA_QUALITY_P0 1.5
#define FXAA_QUALITY_P1 2.0
#define FXAA_QUALITY_P2 8.0
#endif
#if (FXAA_QUALITY_PRESET == 21)
#define FXAA_QUALITY_PS 4
#define FXAA_QUALITY_P0 1.0
#define FXAA_QUALITY_P1 1.5
#define FXAA_QUALITY_P2 2.0
#define FXAA_QUALITY_P3 8.0
#endif
#if (FXAA_QUALITY_PRESET == 22)
#define FXAA_QUALITY_PS 5
#define FXAA_QUALITY_P0 1.0
#define FXAA_QUALITY_P1 1.5
#define FXAA_QUALITY_P2 2.0
#define FXAA_QUALITY_P3 2.0
#define FXAA_QUALITY_P4 8.0
#endif
#if (FXAA_QUALITY_PRESET == 23)
#define FXAA_QUALITY_PS 6
#define FXAA_QUALITY_P0 1.0
#define FXAA_QUALITY_P1 1.5
#define FXAA_QUALITY_P2 2.0
#define FXAA_QUALITY_P3 2.0
#define FXAA_QUALITY_P4 2.0
#define FXAA_QUALITY_P5 8.0
#endif
#if (FXAA_QUALITY_PRESET == 24)
#define FXAA_QUALITY_PS 7
#define FXAA_QUALITY_P0 1.0
#define FXAA_QUALITY_P1 1.5
#define FXAA_QUALITY_P2 2.0
#define FXAA_QUALITY_P3 2.0
#define FXAA_QUALITY_P4 2.0
#define FXAA_QUALITY_P5 3.0
#define FXAA_QUALITY_P6 8.0
#endif
#if (FXAA_QUALITY_PRESET == 25)
#define FXAA_QUALITY_PS 8
#define FXAA_QUALITY_P0 1.0
#define FXAA_QUALITY_P1 1.5
#define FXAA_QUALITY_P2 2.0
#define FXAA_QUALITY_P3 2.0
#define FXAA_QUALITY_P4 2.0
#define FXAA_QUALITY_P5 2.0
#define FXAA_QUALITY_P6 4.0
#define FXAA_QUALITY_P7 8.0
#endif
#if (FXAA_QUALITY_PRESET == 26)
#define FXAA_QUALITY_PS 9
#define FXAA_QUALITY_P0 1.0
#define FXAA_QUALITY_P1 1.5
#define FXAA_QUALITY_P2 2.0
#define FXAA_QUALITY_P3 2.0
#define FXAA_QUALITY_P4 2.0
#define FXAA_QUALITY_P5 2.0
#define FXAA_QUALITY_P6 2.0
#define FXAA_QUALITY_P7 4.0
#define FXAA_QUALITY_P8 8.0
#endif
#if (FXAA_QUALITY_PRESET == 27)
#define FXAA_QUALITY_PS 10
#define FXAA_QUALITY_P0 1.0
#define FXAA_QUALITY_P1 1.5
#define FXAA_QUALITY_P2 2.0
#define FXAA_QUALITY_P3 2.0
#define FXAA_QUALITY_P4 2.0
#define FXAA_QUALITY_P5 2.0
#define FXAA_QUALITY_P6 2.0
#define FXAA_QUALITY_P7 2.0
#define FXAA_QUALITY_P8 4.0
#define FXAA_QUALITY_P9 8.0
#endif
#if (FXAA_QUALITY_PRESET == 28)
#define FXAA_QUALITY_PS 11
#define FXAA_QUALITY_P0 1.0
#define FXAA_QUALITY_P1 1.5
#define FXAA_QUALITY_P2 2.0
#define FXAA_QUALITY_P3 2.0
#define FXAA_QUALITY_P4 2.0
#define FXAA_QUALITY_P5 2.0
#define FXAA_QUALITY_P6 2.0
#define FXAA_QUALITY_P7 2.0
#define FXAA_QUALITY_P8 2.0
#define FXAA_QUALITY_P9 4.0
#define FXAA_QUALITY_P10 8.0
#endif
#if (FXAA_QUALITY_PRESET == 29)
#define FXAA_QUALITY_PS 12
#define FXAA_QUALITY_P0 1.0
#define FXAA_QUALITY_P1 1.5
#define FXAA_QUALITY_P2 2.0
#define FXAA_QUALITY_P3 2.0
#define FXAA_QUALITY_P4 2.0
#define FXAA_QUALITY_P5 2.0
#define FXAA_QUALITY_P6 2.0
#define FXAA_QUALITY_P7 2.0
#define FXAA_QUALITY_P8 2.0
#define FXAA_QUALITY_P9 2.0
#define FXAA_QUALITY_P10 4.0
#define FXAA_QUALITY_P11 8.0
#endif
#if (FXAA_QUALITY_PRESET == 39)
#define FXAA_QUALITY_PS 12
#define FXAA_QUALITY_P0 1.0
#define FXAA_QUALITY_P1 1.0
#define FXAA_QUALITY_P2 1.0
#define FXAA_QUALITY_P3 1.0
#define FXAA_QUALITY_P4 1.0
#define FXAA_QUALITY_P5 1.5
#define FXAA_QUALITY_P6 2.0
#define FXAA_QUALITY_P7 2.0
#define FXAA_QUALITY_P8 2.0
#define FXAA_QUALITY_P9 2.0
#define FXAA_QUALITY_P10 4.0
#define FXAA_QUALITY_P11 8.0
#endif
#define FxaaBool bool
#define FxaaFloat float
#define FxaaFloat2 vec2
#define FxaaFloat3 vec3
#define FxaaFloat4 vec4
#define FxaaHalf float
#define FxaaHalf2 vec2
#define FxaaHalf3 vec3
#define FxaaHalf4 vec4
#define FxaaInt2 vec2
#define FxaaTex sampler2D
#define FxaaSat(x) clamp(x, 0.0, 1.0)
#define FxaaTexTop(t, p) texture2D(t, p)
#define FxaaTexOff(t, p, o, r) texture2D(t, p + (o * r))
FxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.y; }
FxaaFloat4 FxaaPixelShader(
FxaaFloat2 pos,
FxaaTex tex,
FxaaFloat2 fxaaQualityRcpFrame,
FxaaFloat fxaaQualitySubpix,
FxaaFloat fxaaQualityEdgeThreshold,
FxaaFloat fxaaQualityEdgeThresholdMin
) {
FxaaFloat2 posM;
posM.x = pos.x;
posM.y = pos.y;
FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);
#define lumaM rgbyM.y
FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0, 1), fxaaQualityRcpFrame.xy));
FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 0), fxaaQualityRcpFrame.xy));
FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0,-1), fxaaQualityRcpFrame.xy));
FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 0), fxaaQualityRcpFrame.xy));
FxaaFloat maxSM = max(lumaS, lumaM);
FxaaFloat minSM = min(lumaS, lumaM);
FxaaFloat maxESM = max(lumaE, maxSM);
FxaaFloat minESM = min(lumaE, minSM);
FxaaFloat maxWN = max(lumaN, lumaW);
FxaaFloat minWN = min(lumaN, lumaW);
FxaaFloat rangeMax = max(maxWN, maxESM);
FxaaFloat rangeMin = min(minWN, minESM);
FxaaFloat rangeMaxScaled = rangeMax * fxaaQualityEdgeThreshold;
FxaaFloat range = rangeMax - rangeMin;
FxaaFloat rangeMaxClamped = max(fxaaQualityEdgeThresholdMin, rangeMaxScaled);
FxaaBool earlyExit = range < rangeMaxClamped;
if(earlyExit)
return rgbyM;
FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1,-1), fxaaQualityRcpFrame.xy));
FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 1), fxaaQualityRcpFrame.xy));
FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1,-1), fxaaQualityRcpFrame.xy));
FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));
FxaaFloat lumaNS = lumaN + lumaS;
FxaaFloat lumaWE = lumaW + lumaE;
FxaaFloat subpixRcpRange = 1.0/range;
FxaaFloat subpixNSWE = lumaNS + lumaWE;
FxaaFloat edgeHorz1 = (-2.0 * lumaM) + lumaNS;
FxaaFloat edgeVert1 = (-2.0 * lumaM) + lumaWE;
FxaaFloat lumaNESE = lumaNE + lumaSE;
FxaaFloat lumaNWNE = lumaNW + lumaNE;
FxaaFloat edgeHorz2 = (-2.0 * lumaE) + lumaNESE;
FxaaFloat edgeVert2 = (-2.0 * lumaN) + lumaNWNE;
FxaaFloat lumaNWSW = lumaNW + lumaSW;
FxaaFloat lumaSWSE = lumaSW + lumaSE;
FxaaFloat edgeHorz4 = (abs(edgeHorz1) * 2.0) + abs(edgeHorz2);
FxaaFloat edgeVert4 = (abs(edgeVert1) * 2.0) + abs(edgeVert2);
FxaaFloat edgeHorz3 = (-2.0 * lumaW) + lumaNWSW;
FxaaFloat edgeVert3 = (-2.0 * lumaS) + lumaSWSE;
FxaaFloat edgeHorz = abs(edgeHorz3) + edgeHorz4;
FxaaFloat edgeVert = abs(edgeVert3) + edgeVert4;
FxaaFloat subpixNWSWNESE = lumaNWSW + lumaNESE;
FxaaFloat lengthSign = fxaaQualityRcpFrame.x;
FxaaBool horzSpan = edgeHorz >= edgeVert;
FxaaFloat subpixA = subpixNSWE * 2.0 + subpixNWSWNESE;
if(!horzSpan) lumaN = lumaW;
if(!horzSpan) lumaS = lumaE;
if(horzSpan) lengthSign = fxaaQualityRcpFrame.y;
FxaaFloat subpixB = (subpixA * (1.0/12.0)) - lumaM;
FxaaFloat gradientN = lumaN - lumaM;
FxaaFloat gradientS = lumaS - lumaM;
FxaaFloat lumaNN = lumaN + lumaM;
FxaaFloat lumaSS = lumaS + lumaM;
FxaaBool pairN = abs(gradientN) >= abs(gradientS);
FxaaFloat gradient = max(abs(gradientN), abs(gradientS));
if(pairN) lengthSign = -lengthSign;
FxaaFloat subpixC = FxaaSat(abs(subpixB) * subpixRcpRange);
FxaaFloat2 posB;
posB.x = posM.x;
posB.y = posM.y;
FxaaFloat2 offNP;
offNP.x = (!horzSpan) ? 0.0 : fxaaQualityRcpFrame.x;
offNP.y = ( horzSpan) ? 0.0 : fxaaQualityRcpFrame.y;
if(!horzSpan) posB.x += lengthSign * 0.5;
if( horzSpan) posB.y += lengthSign * 0.5;
FxaaFloat2 posN;
posN.x = posB.x - offNP.x * FXAA_QUALITY_P0;
posN.y = posB.y - offNP.y * FXAA_QUALITY_P0;
FxaaFloat2 posP;
posP.x = posB.x + offNP.x * FXAA_QUALITY_P0;
posP.y = posB.y + offNP.y * FXAA_QUALITY_P0;
FxaaFloat subpixD = ((-2.0)*subpixC) + 3.0;
FxaaFloat lumaEndN = FxaaLuma(FxaaTexTop(tex, posN));
FxaaFloat subpixE = subpixC * subpixC;
FxaaFloat lumaEndP = FxaaLuma(FxaaTexTop(tex, posP));
if(!pairN) lumaNN = lumaSS;
FxaaFloat gradientScaled = gradient * 1.0/4.0;
FxaaFloat lumaMM = lumaM - lumaNN * 0.5;
FxaaFloat subpixF = subpixD * subpixE;
FxaaBool lumaMLTZero = lumaMM < 0.0;
lumaEndN -= lumaNN * 0.5;
lumaEndP -= lumaNN * 0.5;
FxaaBool doneN = abs(lumaEndN) >= gradientScaled;
FxaaBool doneP = abs(lumaEndP) >= gradientScaled;
if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P1;
if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P1;
FxaaBool doneNP = (!doneN) || (!doneP);
if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P1;
if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P1;
if(doneNP) {
if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));
if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));
if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;
if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;
doneN = abs(lumaEndN) >= gradientScaled;
doneP = abs(lumaEndP) >= gradientScaled;
if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P2;
if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P2;
doneNP = (!doneN) || (!doneP);
if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P2;
if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P2;
#if (FXAA_QUALITY_PS > 3)
if(doneNP) {
if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));
if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));
if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;
if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;
doneN = abs(lumaEndN) >= gradientScaled;
doneP = abs(lumaEndP) >= gradientScaled;
if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P3;
if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P3;
doneNP = (!doneN) || (!doneP);
if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P3;
if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P3;
#if (FXAA_QUALITY_PS > 4)
if(doneNP) {
if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));
if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));
if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;
if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;
doneN = abs(lumaEndN) >= gradientScaled;
doneP = abs(lumaEndP) >= gradientScaled;
if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P4;
if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P4;
doneNP = (!doneN) || (!doneP);
if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P4;
if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P4;
#if (FXAA_QUALITY_PS > 5)
if(doneNP) {
if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));
if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));
if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;
if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;
doneN = abs(lumaEndN) >= gradientScaled;
doneP = abs(lumaEndP) >= gradientScaled;
if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P5;
if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P5;
doneNP = (!doneN) || (!doneP);
if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P5;
if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P5;
#if (FXAA_QUALITY_PS > 6)
if(doneNP) {
if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));
if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));
if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;
if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;
doneN = abs(lumaEndN) >= gradientScaled;
doneP = abs(lumaEndP) >= gradientScaled;
if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P6;
if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P6;
doneNP = (!doneN) || (!doneP);
if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P6;
if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P6;
#if (FXAA_QUALITY_PS > 7)
if(doneNP) {
if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));
if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));
if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;
if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;
doneN = abs(lumaEndN) >= gradientScaled;
doneP = abs(lumaEndP) >= gradientScaled;
if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P7;
if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P7;
doneNP = (!doneN) || (!doneP);
if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P7;
if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P7;
#if (FXAA_QUALITY_PS > 8)
if(doneNP) {
if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));
if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));
if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;
if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;
doneN = abs(lumaEndN) >= gradientScaled;
doneP = abs(lumaEndP) >= gradientScaled;
if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P8;
if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P8;
doneNP = (!doneN) || (!doneP);
if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P8;
if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P8;
#if (FXAA_QUALITY_PS > 9)
if(doneNP) {
if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));
if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));
if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;
if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;
doneN = abs(lumaEndN) >= gradientScaled;
doneP = abs(lumaEndP) >= gradientScaled;
if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P9;
if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P9;
doneNP = (!doneN) || (!doneP);
if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P9;
if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P9;
#if (FXAA_QUALITY_PS > 10)
if(doneNP) {
if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));
if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));
if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;
if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;
doneN = abs(lumaEndN) >= gradientScaled;
doneP = abs(lumaEndP) >= gradientScaled;
if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P10;
if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P10;
doneNP = (!doneN) || (!doneP);
if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P10;
if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P10;
#if (FXAA_QUALITY_PS > 11)
if(doneNP) {
if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));
if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));
if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;
if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;
doneN = abs(lumaEndN) >= gradientScaled;
doneP = abs(lumaEndP) >= gradientScaled;
if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P11;
if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P11;
doneNP = (!doneN) || (!doneP);
if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P11;
if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P11;
#if (FXAA_QUALITY_PS > 12)
if(doneNP) {
if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));
if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));
if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;
if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;
doneN = abs(lumaEndN) >= gradientScaled;
doneP = abs(lumaEndP) >= gradientScaled;
if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P12;
if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P12;
doneNP = (!doneN) || (!doneP);
if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P12;
if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P12;
}
#endif
}
#endif
}
#endif
}
#endif
}
#endif
}
#endif
}
#endif
}
#endif
}
#endif
}
#endif
}
FxaaFloat dstN = posM.x - posN.x;
FxaaFloat dstP = posP.x - posM.x;
if(!horzSpan) dstN = posM.y - posN.y;
if(!horzSpan) dstP = posP.y - posM.y;
FxaaBool goodSpanN = (lumaEndN < 0.0) != lumaMLTZero;
FxaaFloat spanLength = (dstP + dstN);
FxaaBool goodSpanP = (lumaEndP < 0.0) != lumaMLTZero;
FxaaFloat spanLengthRcp = 1.0/spanLength;
FxaaBool directionN = dstN < dstP;
FxaaFloat dst = min(dstN, dstP);
FxaaBool goodSpan = directionN ? goodSpanN : goodSpanP;
FxaaFloat subpixG = subpixF * subpixF;
FxaaFloat pixelOffset = (dst * (-spanLengthRcp)) + 0.5;
FxaaFloat subpixH = subpixG * fxaaQualitySubpix;
FxaaFloat pixelOffsetGood = goodSpan ? pixelOffset : 0.0;
FxaaFloat pixelOffsetSubpix = max(pixelOffsetGood, subpixH);
if(!horzSpan) posM.x += pixelOffsetSubpix * lengthSign;
if( horzSpan) posM.y += pixelOffsetSubpix * lengthSign;
return FxaaFloat4(FxaaTexTop(tex, posM).xyz, lumaM);
}
`;var FV=`uniform vec4 u_initialColor;
#if TEXTURE_UNITS > 0
uniform sampler2D u_dayTextures[TEXTURE_UNITS];
uniform vec4 u_dayTextureTranslationAndScale[TEXTURE_UNITS];
uniform bool u_dayTextureUseWebMercatorT[TEXTURE_UNITS];
#ifdef APPLY_ALPHA
uniform float u_dayTextureAlpha[TEXTURE_UNITS];
#endif
#ifdef APPLY_DAY_NIGHT_ALPHA
uniform float u_dayTextureNightAlpha[TEXTURE_UNITS];
uniform float u_dayTextureDayAlpha[TEXTURE_UNITS];
#endif
#ifdef APPLY_SPLIT
uniform float u_dayTextureSplit[TEXTURE_UNITS];
#endif
#ifdef APPLY_BRIGHTNESS
uniform float u_dayTextureBrightness[TEXTURE_UNITS];
#endif
#ifdef APPLY_CONTRAST
uniform float u_dayTextureContrast[TEXTURE_UNITS];
#endif
#ifdef APPLY_HUE
uniform float u_dayTextureHue[TEXTURE_UNITS];
#endif
#ifdef APPLY_SATURATION
uniform float u_dayTextureSaturation[TEXTURE_UNITS];
#endif
#ifdef APPLY_GAMMA
uniform float u_dayTextureOneOverGamma[TEXTURE_UNITS];
#endif
#ifdef APPLY_IMAGERY_CUTOUT
uniform vec4 u_dayTextureCutoutRectangles[TEXTURE_UNITS];
#endif
#ifdef APPLY_COLOR_TO_ALPHA
uniform vec4 u_colorsToAlpha[TEXTURE_UNITS];
#endif
uniform vec4 u_dayTextureTexCoordsRectangle[TEXTURE_UNITS];
#endif
#ifdef SHOW_REFLECTIVE_OCEAN
uniform sampler2D u_waterMask;
uniform vec4 u_waterMaskTranslationAndScale;
uniform float u_zoomedOutOceanSpecularIntensity;
#endif
#ifdef SHOW_OCEAN_WAVES
uniform sampler2D u_oceanNormalMap;
#endif
#if defined(ENABLE_DAYNIGHT_SHADING) || defined(GROUND_ATMOSPHERE)
uniform vec2 u_lightingFadeDistance;
#endif
#ifdef TILE_LIMIT_RECTANGLE
uniform vec4 u_cartographicLimitRectangle;
#endif
#ifdef GROUND_ATMOSPHERE
uniform vec2 u_nightFadeDistance;
#endif
#ifdef ENABLE_CLIPPING_PLANES
uniform highp sampler2D u_clippingPlanes;
uniform mat4 u_clippingPlanesMatrix;
uniform vec4 u_clippingPlanesEdgeStyle;
#endif
#if defined(GROUND_ATMOSPHERE) || defined(FOG) && defined(DYNAMIC_ATMOSPHERE_LIGHTING) && (defined(ENABLE_VERTEX_LIGHTING) || defined(ENABLE_DAYNIGHT_SHADING))
uniform float u_minimumBrightness;
#endif
#ifdef COLOR_CORRECT
uniform vec3 u_hsbShift;
#endif
#ifdef HIGHLIGHT_FILL_TILE
uniform vec4 u_fillHighlightColor;
#endif
#ifdef TRANSLUCENT
uniform vec4 u_frontFaceAlphaByDistance;
uniform vec4 u_backFaceAlphaByDistance;
uniform vec4 u_translucencyRectangle;
#endif
#ifdef UNDERGROUND_COLOR
uniform vec4 u_undergroundColor;
uniform vec4 u_undergroundColorAlphaByDistance;
#endif
#ifdef ENABLE_VERTEX_LIGHTING
uniform float u_lambertDiffuseMultiplier;
#endif
varying vec3 v_positionMC;
varying vec3 v_positionEC;
varying vec3 v_textureCoordinates;
varying vec3 v_normalMC;
varying vec3 v_normalEC;
#ifdef APPLY_MATERIAL
varying float v_height;
varying float v_slope;
varying float v_aspect;
#endif
#if defined(FOG) || defined(GROUND_ATMOSPHERE) || defined(UNDERGROUND_COLOR) || defined(TRANSLUCENT)
varying float v_distance;
#endif
#if defined(GROUND_ATMOSPHERE) || defined(FOG)
varying vec3 v_atmosphereRayleighColor;
varying vec3 v_atmosphereMieColor;
varying float v_atmosphereOpacity;
#endif
#if defined(UNDERGROUND_COLOR) || defined(TRANSLUCENT)
float interpolateByDistance(vec4 nearFarScalar, float distance)
{
float startDistance = nearFarScalar.x;
float startValue = nearFarScalar.y;
float endDistance = nearFarScalar.z;
float endValue = nearFarScalar.w;
float t = clamp((distance - startDistance) / (endDistance - startDistance), 0.0, 1.0);
return mix(startValue, endValue, t);
}
#endif
#if defined(UNDERGROUND_COLOR) || defined(TRANSLUCENT) || defined(APPLY_MATERIAL)
vec4 alphaBlend(vec4 sourceColor, vec4 destinationColor)
{
return sourceColor * vec4(sourceColor.aaa, 1.0) + destinationColor * (1.0 - sourceColor.a);
}
#endif
#ifdef TRANSLUCENT
bool inTranslucencyRectangle()
{
return
v_textureCoordinates.x > u_translucencyRectangle.x &&
v_textureCoordinates.x < u_translucencyRectangle.z &&
v_textureCoordinates.y > u_translucencyRectangle.y &&
v_textureCoordinates.y < u_translucencyRectangle.w;
}
#endif
vec4 sampleAndBlend(
vec4 previousColor,
sampler2D textureToSample,
vec2 tileTextureCoordinates,
vec4 textureCoordinateRectangle,
vec4 textureCoordinateTranslationAndScale,
float textureAlpha,
float textureNightAlpha,
float textureDayAlpha,
float textureBrightness,
float textureContrast,
float textureHue,
float textureSaturation,
float textureOneOverGamma,
float split,
vec4 colorToAlpha,
float nightBlend)
{
vec2 alphaMultiplier = step(textureCoordinateRectangle.st, tileTextureCoordinates);
textureAlpha = textureAlpha * alphaMultiplier.x * alphaMultiplier.y;
alphaMultiplier = step(vec2(0.0), textureCoordinateRectangle.pq - tileTextureCoordinates);
textureAlpha = textureAlpha * alphaMultiplier.x * alphaMultiplier.y;
#if defined(APPLY_DAY_NIGHT_ALPHA) && defined(ENABLE_DAYNIGHT_SHADING)
textureAlpha *= mix(textureDayAlpha, textureNightAlpha, nightBlend);
#endif
vec2 translation = textureCoordinateTranslationAndScale.xy;
vec2 scale = textureCoordinateTranslationAndScale.zw;
vec2 textureCoordinates = tileTextureCoordinates * scale + translation;
vec4 value = texture2D(textureToSample, textureCoordinates);
vec3 color = value.rgb;
float alpha = value.a;
#ifdef APPLY_COLOR_TO_ALPHA
vec3 colorDiff = abs(color.rgb - colorToAlpha.rgb);
colorDiff.r = max(max(colorDiff.r, colorDiff.g), colorDiff.b);
alpha = czm_branchFreeTernary(colorDiff.r < colorToAlpha.a, 0.0, alpha);
#endif
#if !defined(APPLY_GAMMA)
vec4 tempColor = czm_gammaCorrect(vec4(color, alpha));
color = tempColor.rgb;
alpha = tempColor.a;
#else
color = pow(color, vec3(textureOneOverGamma));
#endif
#ifdef APPLY_SPLIT
float splitPosition = czm_splitPosition;
if (split < 0.0 && gl_FragCoord.x > splitPosition) {
alpha = 0.0;
}
else if (split > 0.0 && gl_FragCoord.x < splitPosition) {
alpha = 0.0;
}
#endif
#ifdef APPLY_BRIGHTNESS
color = mix(vec3(0.0), color, textureBrightness);
#endif
#ifdef APPLY_CONTRAST
color = mix(vec3(0.5), color, textureContrast);
#endif
#ifdef APPLY_HUE
color = czm_hue(color, textureHue);
#endif
#ifdef APPLY_SATURATION
color = czm_saturation(color, textureSaturation);
#endif
float sourceAlpha = alpha * textureAlpha;
float outAlpha = mix(previousColor.a, 1.0, sourceAlpha);
outAlpha += sign(outAlpha) - 1.0;
vec3 outColor = mix(previousColor.rgb * previousColor.a, color, sourceAlpha) / outAlpha;
return vec4(outColor, max(outAlpha, 0.0));
}
vec3 colorCorrect(vec3 rgb) {
#ifdef COLOR_CORRECT
vec3 hsb = czm_RGBToHSB(rgb);
hsb.x += u_hsbShift.x;
hsb.y = clamp(hsb.y + u_hsbShift.y, 0.0, 1.0);
hsb.z = hsb.z > czm_epsilon7 ? hsb.z + u_hsbShift.z : 0.0;
rgb = czm_HSBToRGB(hsb);
#endif
return rgb;
}
vec4 computeDayColor(vec4 initialColor, vec3 textureCoordinates, float nightBlend);
vec4 computeWaterColor(vec3 positionEyeCoordinates, vec2 textureCoordinates, mat3 enuToEye, vec4 imageryColor, float specularMapValue, float fade);
const float fExposure = 2.0;
vec3 computeEllipsoidPosition()
{
float mpp = czm_metersPerPixel(vec4(0.0, 0.0, -czm_currentFrustum.x, 1.0), 1.0);
vec2 xy = gl_FragCoord.xy / czm_viewport.zw * 2.0 - vec2(1.0);
xy *= czm_viewport.zw * mpp * 0.5;
vec3 direction = normalize(vec3(xy, -czm_currentFrustum.x));
czm_ray ray = czm_ray(vec3(0.0), direction);
vec3 ellipsoid_center = czm_view[3].xyz;
czm_raySegment intersection = czm_rayEllipsoidIntersectionInterval(ray, ellipsoid_center, czm_ellipsoidInverseRadii);
vec3 ellipsoidPosition = czm_pointAlongRay(ray, intersection.start);
return (czm_inverseView * vec4(ellipsoidPosition, 1.0)).xyz;
}
void main()
{
#ifdef TILE_LIMIT_RECTANGLE
if (v_textureCoordinates.x < u_cartographicLimitRectangle.x || u_cartographicLimitRectangle.z < v_textureCoordinates.x ||
v_textureCoordinates.y < u_cartographicLimitRectangle.y || u_cartographicLimitRectangle.w < v_textureCoordinates.y)
{
discard;
}
#endif
#ifdef ENABLE_CLIPPING_PLANES
float clipDistance = clip(gl_FragCoord, u_clippingPlanes, u_clippingPlanesMatrix);
#endif
#if defined(SHOW_REFLECTIVE_OCEAN) || defined(ENABLE_DAYNIGHT_SHADING) || defined(HDR)
vec3 normalMC = czm_geodeticSurfaceNormal(v_positionMC, vec3(0.0), vec3(1.0));
vec3 normalEC = czm_normal3D * normalMC;
#endif
#if defined(APPLY_DAY_NIGHT_ALPHA) && defined(ENABLE_DAYNIGHT_SHADING)
float nightBlend = 1.0 - clamp(czm_getLambertDiffuse(czm_lightDirectionEC, normalEC) * 5.0, 0.0, 1.0);
#else
float nightBlend = 0.0;
#endif
vec4 color = computeDayColor(u_initialColor, clamp(v_textureCoordinates, 0.0, 1.0), nightBlend);
#ifdef SHOW_TILE_BOUNDARIES
if (v_textureCoordinates.x < (1.0/256.0) || v_textureCoordinates.x > (255.0/256.0) ||
v_textureCoordinates.y < (1.0/256.0) || v_textureCoordinates.y > (255.0/256.0))
{
color = vec4(1.0, 0.0, 0.0, 1.0);
}
#endif
#if defined(ENABLE_DAYNIGHT_SHADING) || defined(GROUND_ATMOSPHERE)
float cameraDist;
if (czm_sceneMode == czm_sceneMode2D)
{
cameraDist = max(czm_frustumPlanes.x - czm_frustumPlanes.y, czm_frustumPlanes.w - czm_frustumPlanes.z) * 0.5;
}
else if (czm_sceneMode == czm_sceneModeColumbusView)
{
cameraDist = -czm_view[3].z;
}
else
{
cameraDist = length(czm_view[3]);
}
float fadeOutDist = u_lightingFadeDistance.x;
float fadeInDist = u_lightingFadeDistance.y;
if (czm_sceneMode != czm_sceneMode3D) {
vec3 radii = czm_ellipsoidRadii;
float maxRadii = max(radii.x, max(radii.y, radii.z));
fadeOutDist -= maxRadii;
fadeInDist -= maxRadii;
}
float fade = clamp((cameraDist - fadeOutDist) / (fadeInDist - fadeOutDist), 0.0, 1.0);
#else
float fade = 0.0;
#endif
#ifdef SHOW_REFLECTIVE_OCEAN
vec2 waterMaskTranslation = u_waterMaskTranslationAndScale.xy;
vec2 waterMaskScale = u_waterMaskTranslationAndScale.zw;
vec2 waterMaskTextureCoordinates = v_textureCoordinates.xy * waterMaskScale + waterMaskTranslation;
waterMaskTextureCoordinates.y = 1.0 - waterMaskTextureCoordinates.y;
float mask = texture2D(u_waterMask, waterMaskTextureCoordinates).r;
if (mask > 0.0)
{
mat3 enuToEye = czm_eastNorthUpToEyeCoordinates(v_positionMC, normalEC);
vec2 ellipsoidTextureCoordinates = czm_ellipsoidWgs84TextureCoordinates(normalMC);
vec2 ellipsoidFlippedTextureCoordinates = czm_ellipsoidWgs84TextureCoordinates(normalMC.zyx);
vec2 textureCoordinates = mix(ellipsoidTextureCoordinates, ellipsoidFlippedTextureCoordinates, czm_morphTime * smoothstep(0.9, 0.95, normalMC.z));
color = computeWaterColor(v_positionEC, textureCoordinates, enuToEye, color, mask, fade);
}
#endif
#ifdef APPLY_MATERIAL
czm_materialInput materialInput;
materialInput.st = v_textureCoordinates.st;
materialInput.normalEC = normalize(v_normalEC);
materialInput.positionToEyeEC = -v_positionEC;
materialInput.tangentToEyeMatrix = czm_eastNorthUpToEyeCoordinates(v_positionMC, normalize(v_normalEC));
materialInput.slope = v_slope;
materialInput.height = v_height;
materialInput.aspect = v_aspect;
czm_material material = czm_getMaterial(materialInput);
vec4 materialColor = vec4(material.diffuse, material.alpha);
color = alphaBlend(materialColor, color);
#endif
#ifdef ENABLE_VERTEX_LIGHTING
float diffuseIntensity = clamp(czm_getLambertDiffuse(czm_lightDirectionEC, normalize(v_normalEC)) * u_lambertDiffuseMultiplier + 0.3, 0.0, 1.0);
vec4 finalColor = vec4(color.rgb * czm_lightColor * diffuseIntensity, color.a);
#elif defined(ENABLE_DAYNIGHT_SHADING)
float diffuseIntensity = clamp(czm_getLambertDiffuse(czm_lightDirectionEC, normalEC) * 5.0 + 0.3, 0.0, 1.0);
diffuseIntensity = mix(1.0, diffuseIntensity, fade);
vec4 finalColor = vec4(color.rgb * czm_lightColor * diffuseIntensity, color.a);
#else
vec4 finalColor = color;
#endif
#ifdef ENABLE_CLIPPING_PLANES
vec4 clippingPlanesEdgeColor = vec4(1.0);
clippingPlanesEdgeColor.rgb = u_clippingPlanesEdgeStyle.rgb;
float clippingPlanesEdgeWidth = u_clippingPlanesEdgeStyle.a;
if (clipDistance < clippingPlanesEdgeWidth)
{
finalColor = clippingPlanesEdgeColor;
}
#endif
#ifdef HIGHLIGHT_FILL_TILE
finalColor = vec4(mix(finalColor.rgb, u_fillHighlightColor.rgb, u_fillHighlightColor.a), finalColor.a);
#endif
#if defined(DYNAMIC_ATMOSPHERE_LIGHTING_FROM_SUN)
vec3 atmosphereLightDirection = czm_sunDirectionWC;
#else
vec3 atmosphereLightDirection = czm_lightDirectionWC;
#endif
#if defined(GROUND_ATMOSPHERE) || defined(FOG)
if (!czm_backFacing())
{
bool dynamicLighting = false;
#if defined(DYNAMIC_ATMOSPHERE_LIGHTING) && (defined(ENABLE_DAYNIGHT_SHADING) || defined(ENABLE_VERTEX_LIGHTING))
dynamicLighting = true;
#endif
vec3 rayleighColor;
vec3 mieColor;
float opacity;
vec3 positionWC;
vec3 lightDirection;
#ifdef PER_FRAGMENT_GROUND_ATMOSPHERE
positionWC = computeEllipsoidPosition();
lightDirection = czm_branchFreeTernary(dynamicLighting, atmosphereLightDirection, normalize(positionWC));
computeAtmosphereScattering(
positionWC,
lightDirection,
rayleighColor,
mieColor,
opacity
);
#else
positionWC = v_positionMC;
lightDirection = czm_branchFreeTernary(dynamicLighting, atmosphereLightDirection, normalize(positionWC));
rayleighColor = v_atmosphereRayleighColor;
mieColor = v_atmosphereMieColor;
opacity = v_atmosphereOpacity;
#endif
rayleighColor = colorCorrect(rayleighColor);
mieColor = colorCorrect(mieColor);
vec4 groundAtmosphereColor = computeAtmosphereColor(positionWC, lightDirection, rayleighColor, mieColor, opacity);
#ifdef FOG
vec3 fogColor = groundAtmosphereColor.rgb;
#if defined(DYNAMIC_ATMOSPHERE_LIGHTING) && (defined(ENABLE_VERTEX_LIGHTING) || defined(ENABLE_DAYNIGHT_SHADING))
float darken = clamp(dot(normalize(czm_viewerPositionWC), atmosphereLightDirection), u_minimumBrightness, 1.0);
fogColor *= darken;
#endif
#ifndef HDR
fogColor.rgb = czm_acesTonemapping(fogColor.rgb);
fogColor.rgb = czm_inverseGamma(fogColor.rgb);
#endif
const float modifier = 0.15;
finalColor = vec4(czm_fog(v_distance, finalColor.rgb, fogColor.rgb, modifier), finalColor.a);
#else
const float transmittanceModifier = 0.5;
float transmittance = transmittanceModifier + clamp(1.0 - groundAtmosphereColor.a, 0.0, 1.0);
vec3 finalAtmosphereColor = finalColor.rgb + groundAtmosphereColor.rgb * transmittance;
#if defined(DYNAMIC_ATMOSPHERE_LIGHTING) && (defined(ENABLE_VERTEX_LIGHTING) || defined(ENABLE_DAYNIGHT_SHADING))
float fadeInDist = u_nightFadeDistance.x;
float fadeOutDist = u_nightFadeDistance.y;
float sunlitAtmosphereIntensity = clamp((cameraDist - fadeOutDist) / (fadeInDist - fadeOutDist), 0.05, 1.0);
float darken = clamp(dot(normalize(positionWC), atmosphereLightDirection), 0.0, 1.0);
vec3 darkenendGroundAtmosphereColor = mix(groundAtmosphereColor.rgb, finalAtmosphereColor.rgb, darken);
finalAtmosphereColor = mix(darkenendGroundAtmosphereColor, finalAtmosphereColor, sunlitAtmosphereIntensity);
#endif
#ifndef HDR
finalAtmosphereColor.rgb = vec3(1.0) - exp(-fExposure * finalAtmosphereColor.rgb);
#else
finalAtmosphereColor.rgb = czm_saturation(finalAtmosphereColor.rgb, 1.6);
#endif
finalColor.rgb = mix(finalColor.rgb, finalAtmosphereColor.rgb, fade);
#endif
}
#endif
#ifdef UNDERGROUND_COLOR
if (czm_backFacing())
{
float distanceFromEllipsoid = max(czm_eyeHeight, 0.0);
float distance = max(v_distance - distanceFromEllipsoid, 0.0);
float blendAmount = interpolateByDistance(u_undergroundColorAlphaByDistance, distance);
vec4 undergroundColor = vec4(u_undergroundColor.rgb, u_undergroundColor.a * blendAmount);
finalColor = alphaBlend(undergroundColor, finalColor);
}
#endif
#ifdef TRANSLUCENT
if (inTranslucencyRectangle())
{
vec4 alphaByDistance = gl_FrontFacing ? u_frontFaceAlphaByDistance : u_backFaceAlphaByDistance;
finalColor.a *= interpolateByDistance(alphaByDistance, v_distance);
}
#endif
gl_FragColor =  finalColor;
}
#ifdef SHOW_REFLECTIVE_OCEAN
float waveFade(float edge0, float edge1, float x)
{
float y = clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);
return pow(1.0 - y, 5.0);
}
float linearFade(float edge0, float edge1, float x)
{
return clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);
}
const float oceanFrequencyLowAltitude = 825000.0;
const float oceanAnimationSpeedLowAltitude = 0.004;
const float oceanOneOverAmplitudeLowAltitude = 1.0 / 2.0;
const float oceanSpecularIntensity = 0.5;
const float oceanFrequencyHighAltitude = 125000.0;
const float oceanAnimationSpeedHighAltitude = 0.008;
const float oceanOneOverAmplitudeHighAltitude = 1.0 / 2.0;
vec4 computeWaterColor(vec3 positionEyeCoordinates, vec2 textureCoordinates, mat3 enuToEye, vec4 imageryColor, float maskValue, float fade)
{
vec3 positionToEyeEC = -positionEyeCoordinates;
float positionToEyeECLength = length(positionToEyeEC);
vec3 normalizedPositionToEyeEC = normalize(normalize(positionToEyeEC));
float waveIntensity = waveFade(70000.0, 1000000.0, positionToEyeECLength);
#ifdef SHOW_OCEAN_WAVES
float time = czm_frameNumber * oceanAnimationSpeedHighAltitude;
vec4 noise = czm_getWaterNoise(u_oceanNormalMap, textureCoordinates * oceanFrequencyHighAltitude, time, 0.0);
vec3 normalTangentSpaceHighAltitude = vec3(noise.xy, noise.z * oceanOneOverAmplitudeHighAltitude);
time = czm_frameNumber * oceanAnimationSpeedLowAltitude;
noise = czm_getWaterNoise(u_oceanNormalMap, textureCoordinates * oceanFrequencyLowAltitude, time, 0.0);
vec3 normalTangentSpaceLowAltitude = vec3(noise.xy, noise.z * oceanOneOverAmplitudeLowAltitude);
float highAltitudeFade = linearFade(0.0, 60000.0, positionToEyeECLength);
float lowAltitudeFade = 1.0 - linearFade(20000.0, 60000.0, positionToEyeECLength);
vec3 normalTangentSpace =
(highAltitudeFade * normalTangentSpaceHighAltitude) +
(lowAltitudeFade * normalTangentSpaceLowAltitude);
normalTangentSpace = normalize(normalTangentSpace);
normalTangentSpace.xy *= waveIntensity;
normalTangentSpace = normalize(normalTangentSpace);
#else
vec3 normalTangentSpace = vec3(0.0, 0.0, 1.0);
#endif
vec3 normalEC = enuToEye * normalTangentSpace;
const vec3 waveHighlightColor = vec3(0.3, 0.45, 0.6);
float diffuseIntensity = czm_getLambertDiffuse(czm_lightDirectionEC, normalEC) * maskValue;
vec3 diffuseHighlight = waveHighlightColor * diffuseIntensity * (1.0 - fade);
#ifdef SHOW_OCEAN_WAVES
float tsPerturbationRatio = normalTangentSpace.z;
vec3 nonDiffuseHighlight = mix(waveHighlightColor * 5.0 * (1.0 - tsPerturbationRatio), vec3(0.0), diffuseIntensity);
#else
vec3 nonDiffuseHighlight = vec3(0.0);
#endif
float specularIntensity = czm_getSpecular(czm_lightDirectionEC, normalizedPositionToEyeEC, normalEC, 10.0);
float surfaceReflectance = mix(0.0, mix(u_zoomedOutOceanSpecularIntensity, oceanSpecularIntensity, waveIntensity), maskValue);
float specular = specularIntensity * surfaceReflectance;
#ifdef HDR
specular *= 1.4;
float e = 0.2;
float d = 3.3;
float c = 1.7;
vec3 color = imageryColor.rgb + (c * (vec3(e) + imageryColor.rgb * d) * (diffuseHighlight + nonDiffuseHighlight + specular));
#else
vec3 color = imageryColor.rgb + diffuseHighlight + nonDiffuseHighlight + specular;
#endif
return vec4(color, imageryColor.a);
}
#endif // #ifdef SHOW_REFLECTIVE_OCEAN
`;var NV=`#ifdef QUANTIZATION_BITS12
attribute vec4 compressed0;
attribute float compressed1;
#else
attribute vec4 position3DAndHeight;
attribute vec4 textureCoordAndEncodedNormals;
#endif
#ifdef GEODETIC_SURFACE_NORMALS
attribute vec3 geodeticSurfaceNormal;
#endif
#ifdef EXAGGERATION
uniform vec2 u_terrainExaggerationAndRelativeHeight;
#endif
uniform vec3 u_center3D;
uniform mat4 u_modifiedModelView;
uniform mat4 u_modifiedModelViewProjection;
uniform vec4 u_tileRectangle;
uniform vec2 u_southAndNorthLatitude;
uniform vec2 u_southMercatorYAndOneOverHeight;
varying vec3 v_positionMC;
varying vec3 v_positionEC;
varying vec3 v_textureCoordinates;
varying vec3 v_normalMC;
varying vec3 v_normalEC;
#ifdef APPLY_MATERIAL
varying float v_slope;
varying float v_aspect;
varying float v_height;
#endif
#if defined(FOG) || defined(GROUND_ATMOSPHERE) || defined(UNDERGROUND_COLOR) || defined(TRANSLUCENT)
varying float v_distance;
#endif
#if defined(FOG) || defined(GROUND_ATMOSPHERE)
varying vec3 v_atmosphereRayleighColor;
varying vec3 v_atmosphereMieColor;
varying float v_atmosphereOpacity;
#endif
vec4 getPosition(vec3 position, float height, vec2 textureCoordinates);
float get2DYPositionFraction(vec2 textureCoordinates);
vec4 getPosition3DMode(vec3 position, float height, vec2 textureCoordinates)
{
return u_modifiedModelViewProjection * vec4(position, 1.0);
}
float get2DMercatorYPositionFraction(vec2 textureCoordinates)
{
const float maxTileWidth = 0.003068;
float positionFraction = textureCoordinates.y;
float southLatitude = u_southAndNorthLatitude.x;
float northLatitude = u_southAndNorthLatitude.y;
if (northLatitude - southLatitude > maxTileWidth)
{
float southMercatorY = u_southMercatorYAndOneOverHeight.x;
float oneOverMercatorHeight = u_southMercatorYAndOneOverHeight.y;
float currentLatitude = mix(southLatitude, northLatitude, textureCoordinates.y);
currentLatitude = clamp(currentLatitude, -czm_webMercatorMaxLatitude, czm_webMercatorMaxLatitude);
positionFraction = czm_latitudeToWebMercatorFraction(currentLatitude, southMercatorY, oneOverMercatorHeight);
}
return positionFraction;
}
float get2DGeographicYPositionFraction(vec2 textureCoordinates)
{
return textureCoordinates.y;
}
vec4 getPositionPlanarEarth(vec3 position, float height, vec2 textureCoordinates)
{
float yPositionFraction = get2DYPositionFraction(textureCoordinates);
vec4 rtcPosition2D = vec4(height, mix(u_tileRectangle.st, u_tileRectangle.pq, vec2(textureCoordinates.x, yPositionFraction)), 1.0);
return u_modifiedModelViewProjection * rtcPosition2D;
}
vec4 getPosition2DMode(vec3 position, float height, vec2 textureCoordinates)
{
return getPositionPlanarEarth(position, 0.0, textureCoordinates);
}
vec4 getPositionColumbusViewMode(vec3 position, float height, vec2 textureCoordinates)
{
return getPositionPlanarEarth(position, height, textureCoordinates);
}
vec4 getPositionMorphingMode(vec3 position, float height, vec2 textureCoordinates)
{
vec3 position3DWC = position + u_center3D;
float yPositionFraction = get2DYPositionFraction(textureCoordinates);
vec4 position2DWC = vec4(height, mix(u_tileRectangle.st, u_tileRectangle.pq, vec2(textureCoordinates.x, yPositionFraction)), 1.0);
vec4 morphPosition = czm_columbusViewMorph(position2DWC, vec4(position3DWC, 1.0), czm_morphTime);
return czm_modelViewProjection * morphPosition;
}
#ifdef QUANTIZATION_BITS12
uniform vec2 u_minMaxHeight;
uniform mat4 u_scaleAndBias;
#endif
void main()
{
#ifdef QUANTIZATION_BITS12
vec2 xy = czm_decompressTextureCoordinates(compressed0.x);
vec2 zh = czm_decompressTextureCoordinates(compressed0.y);
vec3 position = vec3(xy, zh.x);
float height = zh.y;
vec2 textureCoordinates = czm_decompressTextureCoordinates(compressed0.z);
height = height * (u_minMaxHeight.y - u_minMaxHeight.x) + u_minMaxHeight.x;
position = (u_scaleAndBias * vec4(position, 1.0)).xyz;
#if (defined(ENABLE_VERTEX_LIGHTING) || defined(GENERATE_POSITION_AND_NORMAL)) && defined(INCLUDE_WEB_MERCATOR_Y)
float webMercatorT = czm_decompressTextureCoordinates(compressed0.w).x;
float encodedNormal = compressed1;
#elif defined(INCLUDE_WEB_MERCATOR_Y)
float webMercatorT = czm_decompressTextureCoordinates(compressed0.w).x;
float encodedNormal = 0.0;
#elif defined(ENABLE_VERTEX_LIGHTING) || defined(GENERATE_POSITION_AND_NORMAL)
float webMercatorT = textureCoordinates.y;
float encodedNormal = compressed0.w;
#else
float webMercatorT = textureCoordinates.y;
float encodedNormal = 0.0;
#endif
#else
vec3 position = position3DAndHeight.xyz;
float height = position3DAndHeight.w;
vec2 textureCoordinates = textureCoordAndEncodedNormals.xy;
#if (defined(ENABLE_VERTEX_LIGHTING) || defined(GENERATE_POSITION_AND_NORMAL) || defined(APPLY_MATERIAL)) && defined(INCLUDE_WEB_MERCATOR_Y)
float webMercatorT = textureCoordAndEncodedNormals.z;
float encodedNormal = textureCoordAndEncodedNormals.w;
#elif defined(ENABLE_VERTEX_LIGHTING) || defined(GENERATE_POSITION_AND_NORMAL) || defined(APPLY_MATERIAL)
float webMercatorT = textureCoordinates.y;
float encodedNormal = textureCoordAndEncodedNormals.z;
#elif defined(INCLUDE_WEB_MERCATOR_Y)
float webMercatorT = textureCoordAndEncodedNormals.z;
float encodedNormal = 0.0;
#else
float webMercatorT = textureCoordinates.y;
float encodedNormal = 0.0;
#endif
#endif
vec3 position3DWC = position + u_center3D;
#ifdef GEODETIC_SURFACE_NORMALS
vec3 ellipsoidNormal = geodeticSurfaceNormal;
#else
vec3 ellipsoidNormal = normalize(position3DWC);
#endif
#if defined(EXAGGERATION) && defined(GEODETIC_SURFACE_NORMALS)
float exaggeration = u_terrainExaggerationAndRelativeHeight.x;
float relativeHeight = u_terrainExaggerationAndRelativeHeight.y;
float newHeight = (height - relativeHeight) * exaggeration + relativeHeight;
float minRadius = min(min(czm_ellipsoidRadii.x, czm_ellipsoidRadii.y), czm_ellipsoidRadii.z);
newHeight = max(newHeight, -minRadius);
vec3 offset = ellipsoidNormal * (newHeight - height);
position += offset;
position3DWC += offset;
height = newHeight;
#endif
gl_Position = getPosition(position, height, textureCoordinates);
v_positionEC = (u_modifiedModelView * vec4(position, 1.0)).xyz;
v_positionMC = position3DWC;
v_textureCoordinates = vec3(textureCoordinates, webMercatorT);
#if defined(ENABLE_VERTEX_LIGHTING) || defined(GENERATE_POSITION_AND_NORMAL) || defined(APPLY_MATERIAL)
vec3 normalMC = czm_octDecode(encodedNormal);
#if defined(EXAGGERATION) && defined(GEODETIC_SURFACE_NORMALS)
vec3 projection = dot(normalMC, ellipsoidNormal) * ellipsoidNormal;
vec3 rejection = normalMC - projection;
normalMC = normalize(projection + rejection * exaggeration);
#endif
v_normalMC = normalMC;
v_normalEC = czm_normal3D * v_normalMC;
#endif
#if defined(FOG) || (defined(GROUND_ATMOSPHERE) && !defined(PER_FRAGMENT_GROUND_ATMOSPHERE))
bool dynamicLighting = false;
#if defined(DYNAMIC_ATMOSPHERE_LIGHTING) && (defined(ENABLE_DAYNIGHT_SHADING) || defined(ENABLE_VERTEX_LIGHTING))
dynamicLighting = true;
#endif
#if defined(DYNAMIC_ATMOSPHERE_LIGHTING_FROM_SUN)
vec3 atmosphereLightDirection = czm_sunDirectionWC;
#else
vec3 atmosphereLightDirection = czm_lightDirectionWC;
#endif
vec3 lightDirection = czm_branchFreeTernary(dynamicLighting, atmosphereLightDirection, normalize(position3DWC));
computeAtmosphereScattering(
position3DWC,
lightDirection,
v_atmosphereRayleighColor,
v_atmosphereMieColor,
v_atmosphereOpacity
);
#endif
#if defined(FOG) || defined(GROUND_ATMOSPHERE) || defined(UNDERGROUND_COLOR) || defined(TRANSLUCENT)
v_distance = length((czm_modelView3D * vec4(position3DWC, 1.0)).xyz);
#endif
#ifdef APPLY_MATERIAL
float northPoleZ = czm_ellipsoidRadii.z;
vec3 northPolePositionMC = vec3(0.0, 0.0, northPoleZ);
vec3 vectorEastMC = normalize(cross(northPolePositionMC - v_positionMC, ellipsoidNormal));
float dotProd = abs(dot(ellipsoidNormal, v_normalMC));
v_slope = acos(dotProd);
vec3 normalRejected = ellipsoidNormal * dotProd;
vec3 normalProjected = v_normalMC - normalRejected;
vec3 aspectVector = normalize(normalProjected);
v_aspect = acos(dot(aspectVector, vectorEastMC));
float determ = dot(cross(vectorEastMC, aspectVector), ellipsoidNormal);
v_aspect = czm_branchFreeTernary(determ < 0.0, 2.0 * czm_pi - v_aspect, v_aspect);
v_height = height;
#endif
}
`;var ZD=`void computeAtmosphereScattering(vec3 positionWC, vec3 lightDirection, out vec3 rayleighColor, out vec3 mieColor, out float opacity) {
vec3 cameraToPositionWC = positionWC - czm_viewerPositionWC;
vec3 cameraToPositionWCDirection = normalize(cameraToPositionWC);
czm_ray primaryRay = czm_ray(czm_viewerPositionWC, cameraToPositionWCDirection);
float atmosphereInnerRadius = length(positionWC);
computeScattering(
primaryRay,
length(cameraToPositionWC),
lightDirection,
atmosphereInnerRadius,
rayleighColor,
mieColor,
opacity
);
}
`;var VV=`uniform sampler2D u_texture;
varying vec2 v_textureCoordinates;
void main()
{
gl_FragColor = texture2D(u_texture, v_textureCoordinates);
}
`;var kV=`attribute vec4 position;
attribute float webMercatorT;
uniform vec2 u_textureDimensions;
varying vec2 v_textureCoordinates;
void main()
{
v_textureCoordinates = vec2(position.x, webMercatorT);
gl_Position = czm_viewportOrthographic * (position * vec4(u_textureDimensions, 1.0, 1.0));
}
`;var QD=`float interpolateByDistance(vec4 nearFarScalar, float distance)
{
float startDistance = nearFarScalar.x;
float startValue = nearFarScalar.y;
float endDistance = nearFarScalar.z;
float endValue = nearFarScalar.w;
float t = clamp((distance - startDistance) / (endDistance - startDistance), 0.0, 1.0);
return mix(startValue, endValue, t);
}
vec3 getLightDirection(vec3 positionWC)
{
float lightEnum = u_radiiAndDynamicAtmosphereColor.z;
vec3 lightDirection =
positionWC * float(lightEnum == 0.0) +
czm_lightDirectionWC * float(lightEnum == 1.0) +
czm_sunDirectionWC * float(lightEnum == 2.0);
return normalize(lightDirection);
}
void computeAtmosphereScattering(vec3 positionWC, vec3 lightDirection, out vec3 rayleighColor, out vec3 mieColor, out float opacity, out float underTranslucentGlobe)
{
float ellipsoidRadiiDifference = czm_ellipsoidRadii.x - czm_ellipsoidRadii.z;
float distanceAdjustMin = czm_ellipsoidRadii.x / 4.0;
float distanceAdjustMax = czm_ellipsoidRadii.x;
float distanceAdjustModifier = ellipsoidRadiiDifference / 2.0;
float distanceAdjust = distanceAdjustModifier * clamp((czm_eyeHeight - distanceAdjustMin) / (distanceAdjustMax - distanceAdjustMin), 0.0, 1.0);
float radiusAdjust = (ellipsoidRadiiDifference / 4.0) + distanceAdjust;
float atmosphereInnerRadius = (length(czm_viewerPositionWC) - czm_eyeHeight) - radiusAdjust;
vec3 cameraToPositionWC = positionWC - czm_viewerPositionWC;
vec3 cameraToPositionWCDirection = normalize(cameraToPositionWC);
czm_ray primaryRay = czm_ray(czm_viewerPositionWC, cameraToPositionWCDirection);
underTranslucentGlobe = 0.0;
#if defined(GLOBE_TRANSLUCENT)
czm_raySegment primaryRayEarthIntersect = czm_raySphereIntersectionInterval(primaryRay, vec3(0.0), atmosphereInnerRadius + radiusAdjust);
if (primaryRayEarthIntersect.start > 0.0 && primaryRayEarthIntersect.stop > 0.0) {
vec3 direction = normalize(positionWC);
czm_ray ellipsoidRay = czm_ray(positionWC, -direction);
czm_raySegment ellipsoidIntersection = czm_rayEllipsoidIntersectionInterval(ellipsoidRay, vec3(0.0), czm_ellipsoidInverseRadii);
vec3 onEarth = positionWC - (direction * ellipsoidIntersection.start);
float angle = dot(normalize(czm_viewerPositionWC), normalize(onEarth));
opacity = interpolateByDistance(vec4(0.0, 1.0, czm_ellipsoidRadii.x, 0.0), length(czm_viewerPositionWC - onEarth));
vec3 horizonColor = vec3(0.1, 0.2, 0.3);
vec3 nearColor = vec3(0.0);
rayleighColor = mix(nearColor, horizonColor, exp(-angle) * opacity);
underTranslucentGlobe = 1.0;
return;
}
#endif
computeScattering(
primaryRay,
length(cameraToPositionWC),
lightDirection,
atmosphereInnerRadius,
rayleighColor,
mieColor,
opacity
);
float cameraHeight = czm_eyeHeight + atmosphereInnerRadius;
float atmosphereOuterRadius = atmosphereInnerRadius + ATMOSPHERE_THICKNESS;
opacity = clamp((atmosphereOuterRadius - cameraHeight) / (atmosphereOuterRadius - atmosphereInnerRadius), 0.0, 1.0);
float nightAlpha = (u_radiiAndDynamicAtmosphereColor.z != 0.0) ? clamp(dot(normalize(positionWC), lightDirection), 0.0, 1.0) : 1.0;
opacity *= pow(nightAlpha, 0.5);
}
`;var UV=`varying vec3 v_outerPositionWC;
uniform vec3 u_hsbShift;
#ifndef PER_FRAGMENT_ATMOSPHERE
varying vec3 v_mieColor;
varying vec3 v_rayleighColor;
varying float v_opacity;
varying float v_translucent;
#endif
void main (void)
{
vec3 lightDirection = getLightDirection(v_outerPositionWC);
vec3 mieColor;
vec3 rayleighColor;
float opacity;
float translucent;
#ifdef PER_FRAGMENT_ATMOSPHERE
computeAtmosphereScattering(
v_outerPositionWC,
lightDirection,
rayleighColor,
mieColor,
opacity,
translucent
);
#else
mieColor = v_mieColor;
rayleighColor = v_rayleighColor;
opacity = v_opacity;
translucent = v_translucent;
#endif
vec4 color = computeAtmosphereColor(v_outerPositionWC, lightDirection, rayleighColor, mieColor, opacity);
#ifndef HDR
color.rgb = czm_acesTonemapping(color.rgb);
color.rgb = czm_inverseGamma(color.rgb);
#endif
#ifdef COLOR_CORRECT
vec3 hsb = czm_RGBToHSB(color.rgb);
hsb.x += u_hsbShift.x;
hsb.y = clamp(hsb.y + u_hsbShift.y, 0.0, 1.0);
hsb.z = hsb.z > czm_epsilon7 ? hsb.z + u_hsbShift.z : 0.0;
color.rgb = czm_HSBToRGB(hsb);
#endif
if (translucent == 0.0) {
color.a = mix(color.b, 1.0, color.a) * smoothstep(0.0, 1.0, czm_morphTime);
}
gl_FragColor = color;
}
`;var zV=`attribute vec4 position;
varying vec3 v_outerPositionWC;
#ifndef PER_FRAGMENT_ATMOSPHERE
varying vec3 v_mieColor;
varying vec3 v_rayleighColor;
varying float v_opacity;
varying float v_translucent;
#endif
void main(void)
{
vec4 positionWC = czm_model * position;
vec3 lightDirection = getLightDirection(positionWC.xyz);
#ifndef PER_FRAGMENT_ATMOSPHERE
computeAtmosphereScattering(
positionWC.xyz,
lightDirection,
v_rayleighColor,
v_mieColor,
v_opacity,
v_translucent
);
#endif
v_outerPositionWC = positionWC.xyz;
gl_Position = czm_modelViewProjection * position;
}
`;var HV=`uniform sampler2D u_texture;
varying vec2 v_textureCoordinates;
void main()
{
vec4 color = texture2D(u_texture, v_textureCoordinates);
gl_FragColor = czm_gammaCorrect(color);
}
`;var GV=`uniform float u_radiusTS;
varying vec2 v_textureCoordinates;
vec2 rotate(vec2 p, vec2 direction)
{
return vec2(p.x * direction.x - p.y * direction.y, p.x * direction.y + p.y * direction.x);
}
vec4 addBurst(vec2 position, vec2 direction, float lengthScalar)
{
vec2 rotatedPosition = rotate(position, direction) * vec2(25.0, 0.75);
float radius = length(rotatedPosition) * lengthScalar;
float burst = 1.0 - smoothstep(0.0, 0.55, radius);
return vec4(burst);
}
void main()
{
float lengthScalar = 2.0 / sqrt(2.0);
vec2 position = v_textureCoordinates - vec2(0.5);
float radius = length(position) * lengthScalar;
float surface = step(radius, u_radiusTS);
vec4 color = vec4(vec2(1.0), surface + 0.2, surface);
float glow = 1.0 - smoothstep(0.0, 0.55, radius);
color.ba += mix(vec2(0.0), vec2(1.0), glow) * 0.75;
vec4 burst = vec4(0.0);
burst += 0.4 * addBurst(position, vec2(0.38942,  0.92106), lengthScalar);
burst += 0.4 * addBurst(position, vec2(0.99235,  0.12348), lengthScalar);
burst += 0.4 * addBurst(position, vec2(0.60327, -0.79754), lengthScalar);
burst += 0.3 * addBurst(position, vec2(0.31457,  0.94924), lengthScalar);
burst += 0.3 * addBurst(position, vec2(0.97931,  0.20239), lengthScalar);
burst += 0.3 * addBurst(position, vec2(0.66507, -0.74678), lengthScalar);
color += clamp(burst, vec4(0.0), vec4(1.0)) * 0.15;
gl_FragColor = clamp(color, vec4(0.0), vec4(1.0));
}
`;var WV=`attribute vec2 direction;
uniform float u_size;
varying vec2 v_textureCoordinates;
void main()
{
vec4 position;
if (czm_morphTime == 1.0)
{
position = vec4(czm_sunPositionWC, 1.0);
}
else
{
position = vec4(czm_sunPositionColumbusView.zxy, 1.0);
}
vec4 positionEC = czm_view * position;
vec4 positionWC = czm_eyeToWindowCoordinates(positionEC);
vec2 halfSize = vec2(u_size * 0.5);
halfSize *= ((direction * 2.0) - 1.0);
gl_Position = czm_viewportOrthographic * vec4(positionWC.xy + halfSize, -positionWC.z, 1.0);
v_textureCoordinates = direction;
}
`;var jV=`varying vec2 v_textureCoordinates;
void main()
{
czm_materialInput materialInput;
materialInput.s = v_textureCoordinates.s;
materialInput.st = v_textureCoordinates;
materialInput.str = vec3(v_textureCoordinates, 0.0);
materialInput.normalEC = vec3(0.0, 0.0, -1.0);
czm_material material = czm_getMaterial(materialInput);
gl_FragColor = vec4(material.diffuse + material.emission, material.alpha);
}
`;function q7(t){t=A(t,A.EMPTY_OBJECT),this._pixelsToCheck=t.pixelsToCheck,this._missingImagePixels=void 0,this._missingImageByteLength=void 0,this._isReady=!1;let n=Ie.createIfNeeded(t.missingImageUrl),i=this;function o(s){f(s.blob)&&(i._missingImageByteLength=s.blob.size);let a=Id(s);if(t.disableCheckIfAllPixelsAreTransparent){let c=!0,l=s.width,u=t.pixelsToCheck;for(let d=0,h=u.length;c&&d<h;++d){let _=u[d],y=_.x*4+_.y*l;a[y+3]>0&&(c=!1)}c&&(a=void 0)}i._missingImagePixels=a,i._isReady=!0}function r(){i._missingImagePixels=void 0,i._isReady=!0}n.fetchImage({preferBlob:!0,preferImageBitmap:!0,flipY:!0}).then(o).catch(r)}q7.prototype.isReady=function(){return this._isReady};q7.prototype.shouldDiscardImage=function(t){let n=this._pixelsToCheck,i=this._missingImagePixels;if(!f(i)||f(t.blob)&&t.blob.size!==this._missingImageByteLength)return!1;let o=Id(t),r=t.width;for(let s=0,a=n.length;s<a;++s){let c=n[s],l=c.x*4+c.y*r;for(let u=0;u<4;++u){let d=l+u;if(o[d]!==i[d])return!1}}return!0};var qV=q7;function Y7(){this.name=void 0,this.description=void 0,this.position=void 0,this.data=void 0,this.imageryLayer=void 0}Y7.prototype.configureNameFromProperties=function(t){let n=10,i;for(let o in t)if(t.hasOwnProperty(o)&&t[o]){let r=o.toLowerCase();n>1&&r==="name"?(n=1,i=o):n>2&&r==="title"?(n=2,i=o):n>3&&/name/i.test(o)?(n=3,i=o):n>4&&/title/i.test(o)&&(n=4,i=o)}f(i)&&(this.name=t[i])};Y7.prototype.configureDescriptionFromProperties=function(t){function n(i){let o='<table class="cesium-infoBox-defaultTable">';for(let r in i)if(i.hasOwnProperty(r)){let s=i[r];f(s)&&(typeof s=="object"?o+=`<tr><td>${r}</td><td>${n(s)}</td></tr>`:o+=`<tr><td>${r}</td><td>${s}</td></tr>`)}return o+="</table>",o}this.description=n(t)};var Hh=Y7;function vE(){this.defaultAlpha=void 0,this.defaultNightAlpha=void 0,this.defaultDayAlpha=void 0,this.defaultBrightness=void 0,this.defaultContrast=void 0,this.defaultHue=void 0,this.defaultSaturation=void 0,this.defaultGamma=void 0,this.defaultMinificationFilter=void 0,this.defaultMagnificationFilter=void 0,Ce.throwInstantiationError()}Object.defineProperties(vE.prototype,{ready:{get:Ce.throwInstantiationError},readyPromise:{get:Ce.throwInstantiationError},rectangle:{get:Ce.throwInstantiationError},tileWidth:{get:Ce.throwInstantiationError},tileHeight:{get:Ce.throwInstantiationError},maximumLevel:{get:Ce.throwInstantiationError},minimumLevel:{get:Ce.throwInstantiationError},tilingScheme:{get:Ce.throwInstantiationError},tileDiscardPolicy:{get:Ce.throwInstantiationError},errorEvent:{get:Ce.throwInstantiationError},credit:{get:Ce.throwInstantiationError},proxy:{get:Ce.throwInstantiationError},hasAlphaChannel:{get:Ce.throwInstantiationError}});vE.prototype.getTileCredits=function(t,n,i){Ce.throwInstantiationError()};vE.prototype.requestImage=function(t,n,i,o){Ce.throwInstantiationError()};vE.prototype.pickFeatures=function(t,n,i,o,r){Ce.throwInstantiationError()};var b$e=/\.ktx2$/i;vE.loadImage=function(t,n){let i=Ie.createIfNeeded(n);return b$e.test(i.url)?xl(i):f(t)&&f(t.tileDiscardPolicy)?i.fetchImage({preferBlob:!0,preferImageBitmap:!0,flipY:!0}):i.fetchImage({preferImageBitmap:!0,flipY:!0})};var fl=vE;function $D(t){t=A(t,A.EMPTY_OBJECT),this.defaultAlpha=void 0,this.defaultNightAlpha=void 0,this.defaultDayAlpha=void 0,this.defaultBrightness=void 0,this.defaultContrast=void 0,this.defaultHue=void 0,this.defaultSaturation=void 0,this.defaultGamma=void 0,this.defaultMinificationFilter=void 0,this.defaultMagnificationFilter=void 0;let n=Ie.createIfNeeded(t.url);n.appendForwardSlash(),f(t.token)&&n.setQueryParameters({token:t.token}),this._resource=n,this._tileDiscardPolicy=t.tileDiscardPolicy,this._tileWidth=A(t.tileWidth,256),this._tileHeight=A(t.tileHeight,256),this._maximumLevel=t.maximumLevel,this._tilingScheme=A(t.tilingScheme,new Wi({ellipsoid:t.ellipsoid})),this._useTiles=A(t.usePreCachedTilesIfAvailable,!0),this._rectangle=A(t.rectangle,this._tilingScheme.rectangle),this._layers=t.layers;let i=t.credit;typeof i=="string"&&(i=new Jt(i)),this._credit=i,this.enablePickFeatures=A(t.enablePickFeatures,!0),this._errorEvent=new Ae,this._ready=!1;let o=this,r;function s(l){let u=l.tileInfo;if(!f(u))o._useTiles=!1;else{if(o._tileWidth=u.rows,o._tileHeight=u.cols,u.spatialReference.wkid===102100||u.spatialReference.wkid===102113)o._tilingScheme=new Xr({ellipsoid:t.ellipsoid});else if(l.tileInfo.spatialReference.wkid===4326)o._tilingScheme=new Wi({ellipsoid:t.ellipsoid});else{let d=`Tile spatial reference WKID ${l.tileInfo.spatialReference.wkid} is not supported.`;return r=qn.reportError(r,o,o._errorEvent,d,void 0,void 0,void 0),r.retry?c():Promise.reject(new he(d))}if(o._maximumLevel=l.tileInfo.lods.length-1,f(l.fullExtent)){if(f(l.fullExtent.spatialReference)&&f(l.fullExtent.spatialReference.wkid))if(l.fullExtent.spatialReference.wkid===102100||l.fullExtent.spatialReference.wkid===102113){let d=new bi,h=l.fullExtent,_=d.unproject(new m(Math.max(h.xmin,-o._tilingScheme.ellipsoid.maximumRadius*Math.PI),Math.max(h.ymin,-o._tilingScheme.ellipsoid.maximumRadius*Math.PI),0)),y=d.unproject(new m(Math.min(h.xmax,o._tilingScheme.ellipsoid.maximumRadius*Math.PI),Math.min(h.ymax,o._tilingScheme.ellipsoid.maximumRadius*Math.PI),0));o._rectangle=new le(_.longitude,_.latitude,y.longitude,y.latitude)}else if(l.fullExtent.spatialReference.wkid===4326)o._rectangle=le.fromDegrees(l.fullExtent.xmin,l.fullExtent.ymin,l.fullExtent.xmax,l.fullExtent.ymax);else{let d=`fullExtent.spatialReference WKID ${l.fullExtent.spatialReference.wkid} is not supported.`;return r=qn.reportError(r,o,o._errorEvent,d,void 0,void 0,void 0),r.retry?c():Promise.reject(new he(d))}}else o._rectangle=o._tilingScheme.rectangle;f(o._tileDiscardPolicy)||(o._tileDiscardPolicy=new qV({missingImageUrl:$he(o,0,0,o._maximumLevel).url,pixelsToCheck:[new W(0,0),new W(200,20),new W(20,200),new W(80,110),new W(160,130)],disableCheckIfAllPixelsAreTransparent:!0})),o._useTiles=!0}return f(l.copyrightText)&&l.copyrightText.length>0&&(o._credit=new Jt(l.copyrightText)),o._ready=!0,qn.reportSuccess(r),Promise.resolve(!0)}function a(l){let u=`An error occurred while accessing ${o._resource.url}.`;return r=qn.reportError(r,o,o._errorEvent,u,void 0,void 0,void 0),Promise.reject(new he(u))}function c(){return o._resource.getDerivedResource({queryParameters:{f:"json"}}).fetchJsonp().then(s).catch(a)}this._useTiles?this._readyPromise=c():(this._ready=!0,this._readyPromise=Promise.resolve(!0))}function $he(t,n,i,o,r){let s;if(t._useTiles)s=t._resource.getDerivedResource({url:`tile/${o}/${i}/${n}`,request:r});else{let a=t._tilingScheme.tileXYToNativeRectangle(n,i,o),l={bbox:`${a.west},${a.south},${a.east},${a.north}`,size:`${t._tileWidth},${t._tileHeight}`,format:"png32",transparent:!0,f:"image"};t._tilingScheme.projection instanceof Ci?(l.bboxSR=4326,l.imageSR=4326):(l.bboxSR=3857,l.imageSR=3857),t.layers&&(l.layers=`show:${t.layers}`),s=t._resource.getDerivedResource({url:"export",request:r,queryParameters:l})}return s}Object.defineProperties($D.prototype,{url:{get:function(){return this._resource._url}},token:{get:function(){return this._resource.queryParameters.token}},proxy:{get:function(){return this._resource.proxy}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){return this._maximumLevel}},minimumLevel:{get:function(){return 0}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._rectangle}},tileDiscardPolicy:{get:function(){return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise}},credit:{get:function(){return this._credit}},usingPrecachedTiles:{get:function(){return this._useTiles}},hasAlphaChannel:{get:function(){return!0}},layers:{get:function(){return this._layers}}});$D.prototype.getTileCredits=function(t,n,i){};$D.prototype.requestImage=function(t,n,i,o){return fl.loadImage(this,$he(this,t,n,i,o))};$D.prototype.pickFeatures=function(t,n,i,o,r){if(!this.enablePickFeatures)return;let s=this._tilingScheme.tileXYToNativeRectangle(t,n,i),a,c,l;if(this._tilingScheme.projection instanceof Ci)a=B.toDegrees(o),c=B.toDegrees(r),l="4326";else{let _=this._tilingScheme.projection.project(new de(o,r,0));a=_.x,c=_.y,l="3857"}let u="visible";f(this._layers)&&(u+=`:${this._layers}`);let d={f:"json",tolerance:2,geometryType:"esriGeometryPoint",geometry:`${a},${c}`,mapExtent:`${s.west},${s.south},${s.east},${s.north}`,imageDisplay:`${this._tileWidth},${this._tileHeight},96`,sr:l,layers:u};return this._resource.getDerivedResource({url:"identify",queryParameters:d}).fetchJson().then(function(_){let y=[],p=_.results;if(!f(p))return y;for(let C=0;C<p.length;++C){let x=p[C],T=new Hh;if(T.data=x,T.name=x.value,T.properties=x.attributes,T.configureDescriptionFromProperties(x.attributes),x.geometryType==="esriGeometryPoint"&&x.geometry){let E=x.geometry.spatialReference&&x.geometry.spatialReference.wkid?x.geometry.spatialReference.wkid:4326;if(E===4326||E===4283)T.position=de.fromDegrees(x.geometry.x,x.geometry.y,x.geometry.z);else if(E===102100||E===900913||E===3857){let S=new bi;T.position=S.unproject(new m(x.geometry.x,x.geometry.y,x.geometry.z))}}y.push(T)}return y})};var Hg=$D;function uA(){this._uniformMap=void 0,this._command=void 0,this._colorTexture=void 0,this._depthTexture=void 0,this._ready=!1,this._name="czm_autoexposure",this._logDepthChanged=void 0,this._useLogDepth=void 0,this._framebuffers=void 0,this._previousLuminance=new ci,this._commands=void 0,this._clearCommand=void 0,this._minMaxLuminance=new W,this.enabled=!0,this._enabled=!0,this.minimumLuminance=.1,this.maximumLuminance=10}Object.defineProperties(uA.prototype,{ready:{get:function(){return this._ready}},name:{get:function(){return this._name}},outputTexture:{get:function(){let t=this._framebuffers;if(!!f(t))return t[t.length-1].getColorTexture(0)}}});function eme(t){let n=t._framebuffers;if(!f(n))return;let i=n.length;for(let o=0;o<i;++o)n[o].destroy();t._framebuffers=void 0,t._previousLuminance.destroy(),t._previousLuminance=void 0}function S$e(t,n){eme(t);let i=t._width,o=t._height,r=n.halfFloatingPointTexture?je.HALF_FLOAT:je.FLOAT,s=Math.ceil(Math.log(Math.max(i,o))/Math.log(3)),a=new Array(s);for(let l=0;l<s;++l)i=Math.max(Math.ceil(i/3),1),o=Math.max(Math.ceil(o/3),1),a[l]=new ci,a[l].update(n,i,o,1,r);let c=a[s-1].getColorTexture(0);t._previousLuminance.update(n,c.width,c.height,1,r),t._framebuffers=a}function tme(t){let n=t._commands;if(!f(n))return;let i=n.length;for(let o=0;o<i;++o)n[o].shaderProgram.destroy();t._commands=void 0}function w$e(t,n){let i;if(n===0)i={colorTexture:function(){return t._colorTexture},colorTextureDimensions:function(){return t._colorTexture.dimensions}};else{let o=t._framebuffers[n-1].getColorTexture(0);i={colorTexture:function(){return o},colorTextureDimensions:function(){return o.dimensions}}}return i.minMaxLuminance=function(){return t._minMaxLuminance},i.previousLuminance=function(){return t._previousLuminance.getColorTexture(0)},i}function D$e(t,n){let i=`uniform sampler2D colorTexture; 
varying vec2 v_textureCoordinates; 
float sampleTexture(vec2 offset) { 
`;return t===0?i+=`    vec4 color = texture2D(colorTexture, v_textureCoordinates + offset); 
    return czm_luminance(color.rgb); 
`:i+=`    return texture2D(colorTexture, v_textureCoordinates + offset).r; 
`,i+=`}

`,i+=`uniform vec2 colorTextureDimensions; 
uniform vec2 minMaxLuminance; 
uniform sampler2D previousLuminance; 
void main() { 
    float color = 0.0; 
    float xStep = 1.0 / colorTextureDimensions.x; 
    float yStep = 1.0 / colorTextureDimensions.y; 
    int count = 0; 
    for (int i = 0; i < 3; ++i) { 
        for (int j = 0; j < 3; ++j) { 
            vec2 offset; 
            offset.x = -xStep + float(i) * xStep; 
            offset.y = -yStep + float(j) * yStep; 
            if (offset.x < 0.0 || offset.x > 1.0 || offset.y < 0.0 || offset.y > 1.0) { 
                continue; 
            } 
            color += sampleTexture(offset); 
            ++count; 
        } 
    } 
    if (count > 0) { 
        color /= float(count); 
    } 
`,t===n-1&&(i+=`    float previous = texture2D(previousLuminance, vec2(0.5)).r; 
    color = clamp(color, minMaxLuminance.x, minMaxLuminance.y); 
    color = previous + (color - previous) / (60.0 * 1.5); 
    color = clamp(color, minMaxLuminance.x, minMaxLuminance.y); 
`),i+=`    gl_FragColor = vec4(color); 
} 
`,i}function v$e(t,n){tme(t);let i=t._framebuffers,o=i.length,r=new Array(o);for(let s=0;s<o;++s)r[s]=n.createViewportQuadCommand(D$e(s,o),{framebuffer:i[s].framebuffer,uniformMap:w$e(t,s)});t._commands=r}uA.prototype.clear=function(t){let n=this._framebuffers;if(!f(n))return;let i=this._clearCommand;f(i)||(i=this._clearCommand=new Qn({color:new z(0,0,0,0),framebuffer:void 0}));let o=n.length;for(let r=0;r<o;++r)n[r].clear(t,i)};uA.prototype.update=function(t){let n=t.drawingBufferWidth,i=t.drawingBufferHeight;(n!==this._width||i!==this._height)&&(this._width=n,this._height=i,S$e(this,t),v$e(this,t),this._ready||(this._ready=!0)),this._minMaxLuminance.x=this.minimumLuminance,this._minMaxLuminance.y=this.maximumLuminance;let o=this._framebuffers,r=o[o.length-1];o[o.length-1]=this._previousLuminance,this._commands[this._commands.length-1].framebuffer=this._previousLuminance.framebuffer,this._previousLuminance=r};uA.prototype.execute=function(t,n){this._colorTexture=n;let i=this._commands;if(!f(i))return;let o=i.length;for(let r=0;r<o;++r)i[r].execute(t)};uA.prototype.isDestroyed=function(){return!1};uA.prototype.destroy=function(){return eme(this),tme(this),ue(this)};var YV=uA;var P$e={AERIAL:"Aerial",AERIAL_WITH_LABELS:"AerialWithLabels",AERIAL_WITH_LABELS_ON_DEMAND:"AerialWithLabelsOnDemand",ROAD:"Road",ROAD_ON_DEMAND:"RoadOnDemand",CANVAS_DARK:"CanvasDark",CANVAS_LIGHT:"CanvasLight",CANVAS_GRAY:"CanvasGray",ORDNANCE_SURVEY:"OrdnanceSurvey",COLLINS_BART:"CollinsBart"},XV=Object.freeze(P$e);function ev(t){}ev.prototype.isReady=function(){return!0};ev.prototype.shouldDiscardImage=function(t){return ev.EMPTY_IMAGE===t};var KV;Object.defineProperties(ev,{EMPTY_IMAGE:{get:function(){return f(KV)||(KV=new Image,KV.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII="),KV}}});var tv=ev;function Gs(t){t=A(t,A.EMPTY_OBJECT);let n=t.key;this.defaultAlpha=void 0,this.defaultNightAlpha=void 0,this.defaultDayAlpha=void 0,this.defaultBrightness=void 0,this.defaultContrast=void 0,this.defaultHue=void 0,this.defaultSaturation=void 0,this.defaultGamma=1,this.defaultMinificationFilter=void 0,this.defaultMagnificationFilter=void 0,this._key=n,this._resource=Ie.createIfNeeded(t.url),this._resource.appendForwardSlash(),this._tileProtocol=t.tileProtocol,this._mapStyle=A(t.mapStyle,XV.AERIAL),this._culture=A(t.culture,""),this._tileDiscardPolicy=t.tileDiscardPolicy,f(this._tileDiscardPolicy)||(this._tileDiscardPolicy=new tv),this._proxy=t.proxy,this._credit=new Jt(`<a href="http://www.bing.com"><img src="${Gs.logoUrl}" title="Bing Imagery"/></a>`),this._tilingScheme=new Xr({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:2,ellipsoid:t.ellipsoid}),this._tileWidth=void 0,this._tileHeight=void 0,this._maximumLevel=void 0,this._imageUrlTemplate=void 0,this._imageUrlSubdomains=void 0,this._errorEvent=new Ae,this._ready=!1;let i=this._tileProtocol;f(i)?i.length>0&&i[i.length-1]===":"&&(i=i.substr(0,i.length-1)):i=document.location.protocol==="http:"?"http":"https";let o=this._resource.getDerivedResource({url:`REST/v1/Imagery/Metadata/${this._mapStyle}`,queryParameters:{incl:"ImageryProviders",key:this._key,uriScheme:i}}),r=this,s;function a(h){if(h.resourceSets.length!==1)return c();let _=h.resourceSets[0].resources[0];r._tileWidth=_.imageWidth,r._tileHeight=_.imageHeight,r._maximumLevel=_.zoomMax-1,r._imageUrlSubdomains=_.imageUrlSubdomains,r._imageUrlTemplate=_.imageUrl;let y=r._attributionList=_.imageryProviders;y||(y=r._attributionList=[]);for(let p=0,C=y.length;p<C;++p){let x=y[p];if(x.credit instanceof Jt)break;x.credit=new Jt(x.attribution);let T=x.coverageAreas;for(let E=0,S=x.coverageAreas.length;E<S;++E){let w=T[E],D=w.bbox;w.bbox=new le(B.toRadians(D[1]),B.toRadians(D[0]),B.toRadians(D[3]),B.toRadians(D[2]))}}return r._ready=!0,qn.reportSuccess(s),Promise.resolve(!0)}function c(h){let _=`An error occurred while accessing ${o.url}.`;return s=qn.reportError(s,r,r._errorEvent,_,void 0,void 0,void 0),s.retry?u():Promise.reject(new he(_))}let l=o.url;function u(){let h=o.fetchJsonp("jsonp");return Gs._metadataCache[l]=h,h.then(a).catch(c)}let d=Gs._metadataCache[l];f(d)?this._readyPromise=d.then(a).catch(c):this._readyPromise=u()}Object.defineProperties(Gs.prototype,{url:{get:function(){return this._resource.url}},proxy:{get:function(){return this._resource.proxy}},key:{get:function(){return this._key}},mapStyle:{get:function(){return this._mapStyle}},culture:{get:function(){return this._culture}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){return this._maximumLevel}},minimumLevel:{get:function(){return 0}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return!1}}});var I$e=new le;Gs.prototype.getTileCredits=function(t,n,i){let o=this._tilingScheme.tileXYToRectangle(t,n,i,I$e);return R$e(this._attributionList,i,o)};Gs.prototype.requestImage=function(t,n,i,o){let r=fl.loadImage(this,B$e(this,t,n,i,o));if(f(r))return r.catch(function(s){return f(s.blob)&&s.blob.size===0?tv.EMPTY_IMAGE:Promise.reject(s)})};Gs.prototype.pickFeatures=function(t,n,i,o,r){};Gs.tileXYToQuadKey=function(t,n,i){let o="";for(let r=i;r>=0;--r){let s=1<<r,a=0;(t&s)!==0&&(a|=1),(n&s)!==0&&(a|=2),o+=a}return o};Gs.quadKeyToTileXY=function(t){let n=0,i=0,o=t.length-1;for(let r=o;r>=0;--r){let s=1<<r,a=+t[o-r];(a&1)!==0&&(n|=s),(a&2)!==0&&(i|=s)}return{x:n,y:i,level:o}};Gs._logoUrl=void 0;Object.defineProperties(Gs,{logoUrl:{get:function(){return f(Gs._logoUrl)||(Gs._logoUrl=Qt("Assets/Images/bing_maps_credit.png")),Gs._logoUrl},set:function(t){Gs._logoUrl=t}}});function B$e(t,n,i,o,r){let s=t._imageUrlTemplate,a=t._imageUrlSubdomains,c=(n+i+o)%a.length;return t._resource.getDerivedResource({url:s,request:r,templateValues:{quadkey:Gs.tileXYToQuadKey(n,i,o),subdomain:a[c],culture:t._culture},queryParameters:{n:"z"}})}var O$e=new le;function R$e(t,n,i){++n;let o=[];for(let r=0,s=t.length;r<s;++r){let a=t[r],c=a.coverageAreas,l=!1;for(let u=0,d=a.coverageAreas.length;!l&&u<d;++u){let h=c[u];if(n>=h.zoomMin&&n<=h.zoomMax){let _=le.intersection(i,h.bbox,O$e);f(_)&&(l=!0)}}l&&o.push(a.credit)}return o}Gs._metadataCache={};var JV=Gs;var M$e=new m(1,1,1);function X7(t){t=A(t,M$e),this._dimensions=m.clone(t)}Object.defineProperties(X7.prototype,{dimensions:{get:function(){return this._dimensions},set:function(t){m.clone(t,this._dimensions)}}});var L$e=new m;X7.prototype.emit=function(t){let n=this._dimensions,i=m.multiplyByScalar(n,.5,L$e),o=B.randomBetween(-i.x,i.x),r=B.randomBetween(-i.y,i.y),s=B.randomBetween(-i.z,i.z);t.position=m.fromElements(o,r,s,t.position),t.velocity=m.normalize(t.position,t.velocity)};var nme=X7;function nv(){this._colorTexture=void 0,this._drawCommand=void 0}Object.defineProperties(nv.prototype,{colorTexture:{get:function(){return this._colorTexture}}});function F$e(t,n,i){let o=n.createViewportQuadCommand(wV,{framebuffer:i,renderState:Ve.fromCache({viewport:new He(0,0,256,256)})});t._drawCommand=o}nv.prototype.update=function(t){if(!f(this._colorTexture)){let n=t.context,i=new St({context:n,width:256,height:256,pixelFormat:st.RGBA,pixelDatatype:je.UNSIGNED_BYTE,sampler:pn.NEAREST});this._colorTexture=i;let o=new Xo({context:n,colorTextures:[i],destroyAttachments:!1});F$e(this,n,o),this._drawCommand.execute(n),o.destroy(),this._drawCommand.shaderProgram=this._drawCommand.shaderProgram&&this._drawCommand.shaderProgram.destroy()}};nv.prototype.isDestroyed=function(){return!1};nv.prototype.destroy=function(){return this._colorTexture=this._colorTexture&&this._colorTexture.destroy(),ue(this)};var ZV=nv;var sme={};function N$e(t,n,i){let o,r,s;if(t instanceof yi){let a=Math.tan(.5*t.fovy);return o=t.near,r=t.near*a,s=t.aspectRatio*r,Math.max(n*o/s,i*o/r)}else if(t instanceof ll)return o=t.near,r=t.top,s=t.right,Math.max(n*o/s,i*o/r);return Math.max(n,i)}var V$e=new m,ime=new m;function ame(t,n,i,o){if(f(o)&&i(.5)>o){let r=i(0),s=i(1),a=i(.5),c=a-r,l=a-s;return function(u){let d=i(u);if(u<=.5){let _=(d-r)/c;return B.lerp(t,-B.PI_OVER_TWO,_)}let h=(d-s)/l;return B.lerp(-B.PI_OVER_TWO,n,1-h)}}return function(r){return B.lerp(t,n,r)}}function J7(t,n,i,o,r){let s=r,a=Math.max(i,o);if(!f(s)){let c=t.position,l=n,u=t.up,d=t.right,h=t.frustum,_=m.subtract(c,l,V$e),y=m.magnitude(m.multiplyByScalar(u,m.dot(_,u),ime)),p=m.magnitude(m.multiplyByScalar(d,m.dot(_,d),ime));s=Math.min(N$e(h,y,p)*.2,1e9)}if(a<s){let u=-Math.pow((s-i)*1e6,.125),d=Math.pow((s-o)*1e6,1/8);return function(h){let _=h*(d-u)+u;return-Math.pow(_,8)/1e6+s}}return function(c){return B.lerp(i,o,c)}}function iv(t,n){return B.equalsEpsilon(t,B.TWO_PI,B.EPSILON11)&&(t=0),n>t+Math.PI?t+=B.TWO_PI:n<t-Math.PI&&(t-=B.TWO_PI),t}var cme=new m;function k$e(t,n,i,o,r,s,a,c){let l=t.camera,u=m.clone(l.position,cme),d=l.pitch,h=iv(l.heading,o),_=iv(l.roll,s),y=J7(l,i,u.z,i.z,a),p=ame(d,r,y,c);function C(x){let T=x.time/n;l.setView({orientation:{heading:B.lerp(h,o,T),pitch:p(T),roll:B.lerp(_,s,T)}}),W.lerp(u,i,T,l.position),l.position.z=y(T)}return C}function U$e(t,n){t.longitude<n.longitude?t.longitude+=B.TWO_PI:n.longitude+=B.TWO_PI}function z$e(t,n){let i=t.longitude-n.longitude;i<-B.PI?t.longitude+=B.TWO_PI:i>B.PI&&(n.longitude+=B.TWO_PI)}var H$e=new de,G$e=new de;function W$e(t,n,i,o,r,s,a,c,l,u){let d=t.camera,_=t.mapProjection.ellipsoid,y=de.clone(d.positionCartographic,H$e),p=d.pitch,C=iv(d.heading,o),x=iv(d.roll,s),T=_.cartesianToCartographic(i,G$e);y.longitude=B.zeroToTwoPi(y.longitude),T.longitude=B.zeroToTwoPi(T.longitude);let E=!1;if(f(c)){let I=B.zeroToTwoPi(c),O=Math.min(y.longitude,T.longitude),M=Math.max(y.longitude,T.longitude),L=I>=O&&I<=M;if(f(l)){let F=Math.abs(y.longitude-T.longitude),g=B.TWO_PI-F;(L?F:g)<(L?g:F)*l&&!L&&(E=!0)}else L||(E=!0)}E?U$e(y,T):z$e(y,T);let S=J7(d,i,y.height,T.height,a),w=ame(p,r,S,u);function D(){let I=y.longitude,O=T.longitude,M=y.latitude,L=T.latitude;return function(g){let b=g.time/n,v=m.fromRadians(B.lerp(I,O,b),B.lerp(M,L,b),S(b),_);d.setView({destination:v,orientation:{heading:B.lerp(C,o,b),pitch:w(b),roll:B.lerp(x,s,b)}})}}return D()}function j$e(t,n,i,o,r,s,a){let c=t.camera,l=m.clone(c.position,cme),u=iv(c.heading,o),d=c.frustum.right-c.frustum.left,h=J7(c,i,d,i.z,a);function _(y){let p=y.time/n;c.setView({orientation:{heading:B.lerp(u,o,p)}}),W.lerp(l,i,p,c.position);let C=h(p),x=c.frustum,T=x.top/x.right,E=(C-(x.right-x.left))*.5;x.right+=E,x.left-=E,x.top=T*x.right,x.bottom=-x.top}return _}var ome=new de,q$e=new m;function K7(t,n){return{startObject:{},stopObject:{},duration:0,complete:t,cancel:n}}function rme(t,n){function i(){typeof n=="function"&&n(),t.enableInputs=!0}return i}sme.createTween=function(t,n){n=A(n,A.EMPTY_OBJECT);let i=n.destination,o=t.mode;if(o===ne.MORPHING)return K7();let r=A(n.convert,!0),s=t.mapProjection,a=s.ellipsoid,c=n.maximumHeight,l=n.flyOverLongitude,u=n.flyOverLongitudeWeight,d=n.pitchAdjustHeight,h=n.easingFunction;r&&o!==ne.SCENE3D&&(a.cartesianToCartographic(i,ome),i=s.project(ome,q$e));let _=t.camera,y=n.endTransform;f(y)&&_._setTransform(y);let p=n.duration;f(p)||(p=Math.ceil(m.distance(_.position,i)/1e6)+2,p=Math.min(p,3));let C=A(n.heading,0),x=A(n.pitch,-B.PI_OVER_TWO),T=A(n.roll,0),E=t.screenSpaceCameraController;E.enableInputs=!1;let S=rme(E,n.complete),w=rme(E,n.cancel),D=_.frustum,I=t.mode===ne.SCENE2D;if(I=I&&W.equalsEpsilon(_.position,i,B.EPSILON6),I=I&&B.equalsEpsilon(Math.max(D.right-D.left,D.top-D.bottom),i.z,B.EPSILON6),I=I||t.mode!==ne.SCENE2D&&m.equalsEpsilon(i,_.position,B.EPSILON10),I=I&&B.equalsEpsilon(B.negativePiToPi(C),B.negativePiToPi(_.heading),B.EPSILON10)&&B.equalsEpsilon(B.negativePiToPi(x),B.negativePiToPi(_.pitch),B.EPSILON10)&&B.equalsEpsilon(B.negativePiToPi(T),B.negativePiToPi(_.roll),B.EPSILON10),I)return K7(S,w);let O=new Array(4);if(O[ne.SCENE2D]=j$e,O[ne.SCENE3D]=W$e,O[ne.COLUMBUS_VIEW]=k$e,p<=0)return K7(function(){O[o](t,1,i,C,x,T,c,l,u,d)({time:1}),typeof S=="function"&&S()},w);let M=O[o](t,p,i,C,x,T,c,l,u,d);if(!f(h)){let L=_.positionCartographic.height,F=o===ne.SCENE3D?a.cartesianToCartographic(i).height:i.z;L>F&&L>11500?h=Vr.CUBIC_OUT:h=Vr.QUINTIC_IN_OUT}return{duration:p,easingFunction:h,startObject:{time:0},stopObject:{time:p},update:M,complete:S,cancel:w}};var QV=sme;var Y$e={ROTATE:0,INFINITE_SCROLL:1},Zl=Object.freeze(Y$e);function Kt(t){this._scene=t,this._transform=N.clone(N.IDENTITY),this._invTransform=N.clone(N.IDENTITY),this._actualTransform=N.clone(N.IDENTITY),this._actualInvTransform=N.clone(N.IDENTITY),this._transformChanged=!1,this.position=new m,this._position=new m,this._positionWC=new m,this._positionCartographic=new de,this._oldPositionWC=void 0,this.positionWCDeltaMagnitude=0,this.positionWCDeltaMagnitudeLastFrame=0,this.timeSinceMoved=0,this._lastMovedTimestamp=0,this.direction=new m,this._direction=new m,this._directionWC=new m,this.up=new m,this._up=new m,this._upWC=new m,this.right=new m,this._right=new m,this._rightWC=new m,this.frustum=new yi,this.frustum.aspectRatio=t.drawingBufferWidth/t.drawingBufferHeight,this.frustum.fov=B.toRadians(60),this.defaultMoveAmount=1e5,this.defaultLookAmount=Math.PI/60,this.defaultRotateAmount=Math.PI/3600,this.defaultZoomAmount=1e5,this.constrainedAxis=void 0,this.maximumZoomFactor=1.5,this._moveStart=new Ae,this._moveEnd=new Ae,this._changed=new Ae,this._changedPosition=void 0,this._changedDirection=void 0,this._changedFrustum=void 0,this._changedHeading=void 0,this.percentageChanged=.5,this._viewMatrix=new N,this._invViewMatrix=new N,_me(this),this._mode=ne.SCENE3D,this._modeChanged=!0;let n=t.mapProjection;this._projection=n,this._maxCoord=n.project(new de(Math.PI,B.PI_OVER_TWO)),this._max2Dfrustum=void 0,vme(this,Kt.DEFAULT_VIEW_RECTANGLE,this.position,!0);let i=m.magnitude(this.position);i+=i*Kt.DEFAULT_VIEW_FACTOR,m.normalize(this.position,this.position),m.multiplyByScalar(this.position,i,this.position)}Kt.TRANSFORM_2D=new N(0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,1);Kt.TRANSFORM_2D_INVERSE=N.inverseTransformation(Kt.TRANSFORM_2D,new N);Kt.DEFAULT_VIEW_RECTANGLE=le.fromDegrees(-95,-20,-70,90);Kt.DEFAULT_VIEW_FACTOR=.5;Kt.DEFAULT_OFFSET=new Ku(0,-B.PI_OVER_FOUR,0);function _me(t){N.computeView(t._position,t._direction,t._up,t._right,t._viewMatrix),N.multiply(t._viewMatrix,t._actualInvTransform,t._viewMatrix),N.inverseTransformation(t._viewMatrix,t._invViewMatrix)}function X$e(t){if(!f(t._oldPositionWC))t._oldPositionWC=m.clone(t.positionWC,t._oldPositionWC);else{t.positionWCDeltaMagnitudeLastFrame=t.positionWCDeltaMagnitude;let n=m.subtract(t.positionWC,t._oldPositionWC,t._oldPositionWC);t.positionWCDeltaMagnitude=m.magnitude(n),t._oldPositionWC=m.clone(t.positionWC,t._oldPositionWC),t.positionWCDeltaMagnitude>0?(t.timeSinceMoved=0,t._lastMovedTimestamp=Fi()):t.timeSinceMoved=Math.max(Fi()-t._lastMovedTimestamp,0)/1e3}}Kt.prototype.canPreloadFlight=function(){return f(this._currentFlight)&&this._mode!==ne.SCENE2D};Kt.prototype._updateCameraChanged=function(){let t=this;if(X$e(t),t._changed.numberOfListeners===0)return;let n=t.percentageChanged,i=t.heading;f(t._changedHeading)||(t._changedHeading=i);let o=Math.abs(t._changedHeading-i)%B.TWO_PI;o=o>B.PI?B.TWO_PI-o:o;let r=o/Math.PI;if(r>n&&(t._changed.raiseEvent(r),t._changedHeading=i),t._mode===ne.SCENE2D){if(!f(t._changedFrustum)){t._changedPosition=m.clone(t.position,t._changedPosition),t._changedFrustum=t.frustum.clone();return}let u=t.position,d=t._changedPosition,h=t.frustum,_=t._changedFrustum,y=u.x+h.left,p=u.x+h.right,C=d.x+_.left,x=d.x+_.right,T=u.y+h.bottom,E=u.y+h.top,S=d.y+_.bottom,w=d.y+_.top,D=Math.max(y,C),I=Math.min(p,x),O=Math.max(T,S),M=Math.min(E,w),L;if(D>=I||O>=E)L=1;else{let F=_;y<C&&p>x&&T<S&&E>w&&(F=h),L=1-(I-D)*(M-O)/((F.right-F.left)*(F.top-F.bottom))}L>n&&(t._changed.raiseEvent(L),t._changedPosition=m.clone(t.position,t._changedPosition),t._changedFrustum=t.frustum.clone(t._changedFrustum));return}if(!f(t._changedDirection)){t._changedPosition=m.clone(t.positionWC,t._changedPosition),t._changedDirection=m.clone(t.directionWC,t._changedDirection);return}let s=B.acosClamped(m.dot(t.directionWC,t._changedDirection)),a;f(t.frustum.fovy)?a=s/(t.frustum.fovy*.5):a=s;let l=m.distance(t.positionWC,t._changedPosition)/t.positionCartographic.height;(a>n||l>n)&&(t._changed.raiseEvent(Math.max(a,l)),t._changedPosition=m.clone(t.positionWC,t._changedPosition),t._changedDirection=m.clone(t.directionWC,t._changedDirection))};function K$e(t){vt.basisTo2D(t._projection,t._transform,t._actualTransform)}var J$e=new de,Z$e=new m,$V=new m,Q$e=new se,$$e=new se,eet=new se,tet=new se,net=new se;function iet(t){let n=t._projection,i=n.ellipsoid,o=N.getColumn(t._transform,3,Q$e),r=i.cartesianToCartographic(o,J$e),s=n.project(r,Z$e),a=$$e;a.x=s.z,a.y=s.x,a.z=s.y,a.w=1;let c=se.clone(se.UNIT_X,net),l=se.add(N.getColumn(t._transform,0,$V),o,$V);i.cartesianToCartographic(l,r),n.project(r,s);let u=eet;u.x=s.z,u.y=s.x,u.z=s.y,u.w=0,m.subtract(u,a,u),u.x=0;let d=tet;if(m.magnitudeSquared(u)>B.EPSILON10)m.cross(c,u,d);else{let h=se.add(N.getColumn(t._transform,1,$V),o,$V);i.cartesianToCartographic(h,r),n.project(r,s),d.x=s.z,d.y=s.x,d.z=s.y,d.w=0,m.subtract(d,a,d),d.x=0,m.magnitudeSquared(d)<B.EPSILON10&&(se.clone(se.UNIT_Y,u),se.clone(se.UNIT_Z,d))}m.cross(d,c,u),m.normalize(u,u),m.cross(c,u,d),m.normalize(d,d),N.setColumn(t._actualTransform,0,u,t._actualTransform),N.setColumn(t._actualTransform,1,d,t._actualTransform),N.setColumn(t._actualTransform,2,c,t._actualTransform),N.setColumn(t._actualTransform,3,a,t._actualTransform)}var Z7=new m;function Wa(t){let n=t._mode,i=!1,o=0;n===ne.SCENE2D&&(o=t.frustum.right-t.frustum.left,i=o!==t._positionCartographic.height);let r=t._position,s=!m.equals(r,t.position)||i;s&&(r=m.clone(t.position,t._position));let a=t._direction,c=!m.equals(a,t.direction);c&&(m.normalize(t.direction,t.direction),a=m.clone(t.direction,t._direction));let l=t._up,u=!m.equals(l,t.up);u&&(m.normalize(t.up,t.up),l=m.clone(t.up,t._up));let d=t._right,h=!m.equals(d,t.right);h&&(m.normalize(t.right,t.right),d=m.clone(t.right,t._right));let _=t._transformChanged||t._modeChanged;t._transformChanged=!1,_&&(N.inverseTransformation(t._transform,t._invTransform),t._mode===ne.COLUMBUS_VIEW||t._mode===ne.SCENE2D?N.equals(N.IDENTITY,t._transform)?N.clone(Kt.TRANSFORM_2D,t._actualTransform):t._mode===ne.COLUMBUS_VIEW?K$e(t):iet(t):N.clone(t._transform,t._actualTransform),N.inverseTransformation(t._actualTransform,t._actualInvTransform),t._modeChanged=!1);let y=t._actualTransform;if(s||_)if(t._positionWC=N.multiplyByPoint(y,r,t._positionWC),n===ne.SCENE3D||n===ne.MORPHING)t._positionCartographic=t._projection.ellipsoid.cartesianToCartographic(t._positionWC,t._positionCartographic);else{let p=Z7;p.x=t._positionWC.y,p.y=t._positionWC.z,p.z=t._positionWC.x,n===ne.SCENE2D&&(p.z=o),t._projection.unproject(p,t._positionCartographic)}if(c||u||h){let p=m.dot(a,m.cross(l,d,Z7));if(Math.abs(1-p)>B.EPSILON2){let C=1/m.magnitudeSquared(l),x=m.dot(l,a)*C,T=m.multiplyByScalar(a,x,Z7);l=m.normalize(m.subtract(l,T,t._up),t._up),m.clone(l,t.up),d=m.cross(a,l,t._right),m.clone(d,t.right)}}(c||_)&&(t._directionWC=N.multiplyByPointAsVector(y,a,t._directionWC),m.normalize(t._directionWC,t._directionWC)),(u||_)&&(t._upWC=N.multiplyByPointAsVector(y,l,t._upWC),m.normalize(t._upWC,t._upWC)),(h||_)&&(t._rightWC=N.multiplyByPointAsVector(y,d,t._rightWC),m.normalize(t._rightWC,t._rightWC)),(s||c||u||h||_)&&_me(t)}function gme(t,n){let i;return B.equalsEpsilon(Math.abs(t.z),1,B.EPSILON3)?i=Math.atan2(n.y,n.x)-B.PI_OVER_TWO:i=Math.atan2(t.y,t.x)-B.PI_OVER_TWO,B.TWO_PI-B.zeroToTwoPi(i)}function yme(t){return B.PI_OVER_TWO-B.acosClamped(t.z)}function Ame(t,n,i){let o=0;return B.equalsEpsilon(Math.abs(t.z),1,B.EPSILON3)||(o=Math.atan2(-i.z,n.z),o=B.zeroToTwoPi(o+B.TWO_PI)),o}var nk=new N,ik=new N;Object.defineProperties(Kt.prototype,{transform:{get:function(){return this._transform}},inverseTransform:{get:function(){return Wa(this),this._invTransform}},viewMatrix:{get:function(){return Wa(this),this._viewMatrix}},inverseViewMatrix:{get:function(){return Wa(this),this._invViewMatrix}},positionCartographic:{get:function(){return Wa(this),this._positionCartographic}},positionWC:{get:function(){return Wa(this),this._positionWC}},directionWC:{get:function(){return Wa(this),this._directionWC}},upWC:{get:function(){return Wa(this),this._upWC}},rightWC:{get:function(){return Wa(this),this._rightWC}},heading:{get:function(){if(this._mode!==ne.MORPHING){let t=this._projection.ellipsoid,n=N.clone(this._transform,nk),i=vt.eastNorthUpToFixedFrame(this.positionWC,t,ik);this._setTransform(i);let o=gme(this.direction,this.up);return this._setTransform(n),o}}},pitch:{get:function(){if(this._mode!==ne.MORPHING){let t=this._projection.ellipsoid,n=N.clone(this._transform,nk),i=vt.eastNorthUpToFixedFrame(this.positionWC,t,ik);this._setTransform(i);let o=yme(this.direction);return this._setTransform(n),o}}},roll:{get:function(){if(this._mode!==ne.MORPHING){let t=this._projection.ellipsoid,n=N.clone(this._transform,nk),i=vt.eastNorthUpToFixedFrame(this.positionWC,t,ik);this._setTransform(i);let o=Ame(this.direction,this.up,this.right);return this._setTransform(n),o}}},moveStart:{get:function(){return this._moveStart}},moveEnd:{get:function(){return this._moveEnd}},changed:{get:function(){return this._changed}}});Kt.prototype.update=function(t){let n=!1;if(t!==this._mode&&(this._mode=t,this._modeChanged=t!==ne.MORPHING,n=this._mode===ne.SCENE2D),n){let i=this._max2Dfrustum=this.frustum.clone(),o=2,r=i.top/i.right;i.right=this._maxCoord.x*o,i.left=-i.right,i.top=r*i.right,i.bottom=-i.top}this._mode===ne.SCENE2D&&Eme(this,this.position)};var oet=new m,ret=new m,set=new m;Kt.prototype._setTransform=function(t){let n=m.clone(this.positionWC,oet),i=m.clone(this.upWC,ret),o=m.clone(this.directionWC,set);N.clone(t,this._transform),this._transformChanged=!0,Wa(this);let r=this._actualInvTransform;N.multiplyByPoint(r,n,this.position),N.multiplyByPointAsVector(r,o,this.direction),N.multiplyByPointAsVector(r,i,this.up),m.cross(this.direction,this.up,this.right),Wa(this)};var aet=new W,cet=new dn,uet=new m,fet=new m;function Cme(t){if(!N.equals(N.IDENTITY,t.transform))return m.magnitude(t.position);let n=t._scene,i=n.globe,o=aet;o.x=n.drawingBufferWidth/2,o.y=n.drawingBufferHeight/2;let r;if(f(i)){let c=t.getPickRay(o,cet);r=i.pickWorldCoordinates(c,n,!0,uet)}let s;n.pickPositionSupported&&(s=n.pickPositionWorldCoordinates(o,fet));let a;if(f(r)||f(s)){let c=f(s)?m.distance(s,t.positionWC):Number.POSITIVE_INFINITY,l=f(r)?m.distance(r,t.positionWC):Number.POSITIVE_INFINITY;a=Math.min(c,l)}else a=Math.max(t.positionCartographic.height,0);return a}Kt.prototype._adjustOrthographicFrustum=function(t){this.frustum instanceof $t&&(!t&&this._positionCartographic.height<15e4||(this.frustum.width=Cme(this)))};var ok=new m,nj=new N,det=new N,ij=new Me,oj=new $,xme=new de;function het(t,n,i){let o=N.clone(t.transform,nj),r=vt.eastNorthUpToFixedFrame(n,t._projection.ellipsoid,det);t._setTransform(r),m.clone(m.ZERO,t.position),i.heading=i.heading-B.PI_OVER_TWO;let s=Me.fromHeadingPitchRoll(i,ij),a=$.fromQuaternion(s,oj);$.getColumn(a,0,t.direction),$.getColumn(a,2,t.up),m.cross(t.direction,t.up,t.right),t._setTransform(o),t._adjustOrthographicFrustum(!0)}function met(t,n,i,o){let r=N.clone(t.transform,nj);if(t._setTransform(N.IDENTITY),!m.equals(n,t.positionWC)){if(o){let c=t._projection,l=c.ellipsoid.cartesianToCartographic(n,xme);n=c.project(l,ok)}m.clone(n,t.position)}i.heading=i.heading-B.PI_OVER_TWO;let s=Me.fromHeadingPitchRoll(i,ij),a=$.fromQuaternion(s,oj);$.getColumn(a,0,t.direction),$.getColumn(a,2,t.up),m.cross(t.direction,t.up,t.right),t._setTransform(r),t._adjustOrthographicFrustum(!0)}function pet(t,n,i,o){let r=N.clone(t.transform,nj);if(t._setTransform(N.IDENTITY),!m.equals(n,t.positionWC)){if(o){let l=t._projection,u=l.ellipsoid.cartesianToCartographic(n,xme);n=l.project(u,ok)}W.clone(n,t.position);let s=-n.z*.5,a=-s,c=t.frustum;if(a>s){let l=c.top/c.right;c.right=a,c.left=s,c.top=c.right*l,c.bottom=-c.top}}if(t._scene.mapMode2D===Zl.ROTATE){i.heading=i.heading-B.PI_OVER_TWO,i.pitch=-B.PI_OVER_TWO,i.roll=0;let s=Me.fromHeadingPitchRoll(i,ij),a=$.fromQuaternion(s,oj);$.getColumn(a,2,t.up),m.cross(t.direction,t.up,t.right)}t._setTransform(r)}var _et=new m,get=new m,yet=new m;function Tme(t,n,i,o){let r=m.clone(i.direction,_et),s=m.clone(i.up,get);if(t._scene.mode===ne.SCENE3D){let c=t._projection.ellipsoid,l=vt.eastNorthUpToFixedFrame(n,c,nk),u=N.inverseTransformation(l,ik);N.multiplyByPointAsVector(u,r,r),N.multiplyByPointAsVector(u,s,s)}let a=m.cross(r,s,yet);return o.heading=gme(r,s),o.pitch=yme(r),o.roll=Ame(r,s,a),o}var tj={destination:void 0,orientation:{direction:void 0,up:void 0,heading:void 0,pitch:void 0,roll:void 0},convert:void 0,endTransform:void 0},PE=new yl;Kt.prototype.setView=function(t){t=A(t,A.EMPTY_OBJECT);let n=A(t.orientation,A.EMPTY_OBJECT),i=this._mode;if(i===ne.MORPHING)return;f(t.endTransform)&&this._setTransform(t.endTransform);let o=A(t.convert,!0),r=A(t.destination,m.clone(this.positionWC,ok));f(r)&&f(r.west)&&(r=this.getRectangleCameraCoordinates(r,ok),o=!1),f(n.direction)&&(n=Tme(this,r,n,tj.orientation)),PE.heading=A(n.heading,0),PE.pitch=A(n.pitch,-B.PI_OVER_TWO),PE.roll=A(n.roll,0),i===ne.SCENE3D?het(this,r,PE):i===ne.SCENE2D?pet(this,r,PE,o):met(this,r,PE,o)};var Aet=new m;Kt.prototype.flyHome=function(t){let n=this._mode;if(n===ne.MORPHING&&this._scene.completeMorph(),n===ne.SCENE2D)this.flyTo({destination:Kt.DEFAULT_VIEW_RECTANGLE,duration:t,endTransform:N.IDENTITY});else if(n===ne.SCENE3D){let i=this.getRectangleCameraCoordinates(Kt.DEFAULT_VIEW_RECTANGLE),o=m.magnitude(i);o+=o*Kt.DEFAULT_VIEW_FACTOR,m.normalize(i,i),m.multiplyByScalar(i,o,i),this.flyTo({destination:i,duration:t,endTransform:N.IDENTITY})}else if(n===ne.COLUMBUS_VIEW){let i=this._projection.ellipsoid.maximumRadius,o=new m(0,-1,1);o=m.multiplyByScalar(m.normalize(o,o),5*i,o),this.flyTo({destination:o,duration:t,orientation:{heading:0,pitch:-Math.acos(m.normalize(o,Aet).z),roll:0},endTransform:N.IDENTITY,convert:!1})}};Kt.prototype.worldToCameraCoordinates=function(t,n){return f(n)||(n=new se),Wa(this),N.multiplyByVector(this._actualInvTransform,t,n)};Kt.prototype.worldToCameraCoordinatesPoint=function(t,n){return f(n)||(n=new m),Wa(this),N.multiplyByPoint(this._actualInvTransform,t,n)};Kt.prototype.worldToCameraCoordinatesVector=function(t,n){return f(n)||(n=new m),Wa(this),N.multiplyByPointAsVector(this._actualInvTransform,t,n)};Kt.prototype.cameraToWorldCoordinates=function(t,n){return f(n)||(n=new se),Wa(this),N.multiplyByVector(this._actualTransform,t,n)};Kt.prototype.cameraToWorldCoordinatesPoint=function(t,n){return f(n)||(n=new m),Wa(this),N.multiplyByPoint(this._actualTransform,t,n)};Kt.prototype.cameraToWorldCoordinatesVector=function(t,n){return f(n)||(n=new m),Wa(this),N.multiplyByPointAsVector(this._actualTransform,t,n)};function Eme(t,n){let i=t._scene.mapMode2D===Zl.ROTATE,o=t._maxCoord.x,r=t._maxCoord.y,s,a;i?(a=o,s=-a):(a=n.x-o*2,s=n.x+o*2),n.x>o&&(n.x=a),n.x<-o&&(n.x=s),n.y>r&&(n.y=r),n.y<-r&&(n.y=-r)}var lme=new m;Kt.prototype.move=function(t,n){let i=this.position;m.multiplyByScalar(t,n,lme),m.add(i,lme,i),this._mode===ne.SCENE2D&&Eme(this,i),this._adjustOrthographicFrustum(!0)};Kt.prototype.moveForward=function(t){t=A(t,this.defaultMoveAmount),this._mode===ne.SCENE2D?rk(this,t):this.move(this.direction,t)};Kt.prototype.moveBackward=function(t){t=A(t,this.defaultMoveAmount),this._mode===ne.SCENE2D?rk(this,-t):this.move(this.direction,-t)};Kt.prototype.moveUp=function(t){t=A(t,this.defaultMoveAmount),this.move(this.up,t)};Kt.prototype.moveDown=function(t){t=A(t,this.defaultMoveAmount),this.move(this.up,-t)};Kt.prototype.moveRight=function(t){t=A(t,this.defaultMoveAmount),this.move(this.right,t)};Kt.prototype.moveLeft=function(t){t=A(t,this.defaultMoveAmount),this.move(this.right,-t)};Kt.prototype.lookLeft=function(t){t=A(t,this.defaultLookAmount),this._mode!==ne.SCENE2D&&this.look(this.up,-t)};Kt.prototype.lookRight=function(t){t=A(t,this.defaultLookAmount),this._mode!==ne.SCENE2D&&this.look(this.up,t)};Kt.prototype.lookUp=function(t){t=A(t,this.defaultLookAmount),this._mode!==ne.SCENE2D&&this.look(this.right,-t)};Kt.prototype.lookDown=function(t){t=A(t,this.defaultLookAmount),this._mode!==ne.SCENE2D&&this.look(this.right,t)};var Cet=new Me,xet=new $;Kt.prototype.look=function(t,n){let i=A(n,this.defaultLookAmount),o=Me.fromAxisAngle(t,-i,Cet),r=$.fromQuaternion(o,xet),s=this.direction,a=this.up,c=this.right;$.multiplyByVector(r,s,s),$.multiplyByVector(r,a,a),$.multiplyByVector(r,c,c)};Kt.prototype.twistLeft=function(t){t=A(t,this.defaultLookAmount),this.look(this.direction,t)};Kt.prototype.twistRight=function(t){t=A(t,this.defaultLookAmount),this.look(this.direction,-t)};var Tet=new Me,Eet=new $;Kt.prototype.rotate=function(t,n){let i=A(n,this.defaultRotateAmount),o=Me.fromAxisAngle(t,-i,Tet),r=$.fromQuaternion(o,Eet);$.multiplyByVector(r,this.position,this.position),$.multiplyByVector(r,this.direction,this.direction),$.multiplyByVector(r,this.up,this.up),m.cross(this.direction,this.up,this.right),m.cross(this.right,this.direction,this.up),this._adjustOrthographicFrustum(!1)};Kt.prototype.rotateDown=function(t){t=A(t,this.defaultRotateAmount),bme(this,t)};Kt.prototype.rotateUp=function(t){t=A(t,this.defaultRotateAmount),bme(this,-t)};var bet=new m,wet=new m,Det=new m,ume=new m;function bme(t,n){let i=t.position;if(f(t.constrainedAxis)&&!m.equalsEpsilon(t.position,m.ZERO,B.EPSILON2)){let o=m.normalize(i,bet),r=m.equalsEpsilon(o,t.constrainedAxis,B.EPSILON2),s=m.equalsEpsilon(o,m.negate(t.constrainedAxis,ume),B.EPSILON2);if(!r&&!s){let a=m.normalize(t.constrainedAxis,wet),c=m.dot(o,a),l=B.acosClamped(c);n>0&&n>l&&(n=l-B.EPSILON4),c=m.dot(o,m.negate(a,ume)),l=B.acosClamped(c),n<0&&-n>l&&(n=-l+B.EPSILON4);let u=m.cross(a,o,Det);t.rotate(u,n)}else(r&&n<0||s&&n>0)&&t.rotate(t.right,n)}else t.rotate(t.right,n)}Kt.prototype.rotateRight=function(t){t=A(t,this.defaultRotateAmount),Sme(this,-t)};Kt.prototype.rotateLeft=function(t){t=A(t,this.defaultRotateAmount),Sme(this,t)};function Sme(t,n){f(t.constrainedAxis)?t.rotate(t.constrainedAxis,n):t.rotate(t.up,n)}function rk(t,n){let i=t.frustum,o;if(n=n*.5,Math.abs(i.top)+Math.abs(i.bottom)>Math.abs(i.left)+Math.abs(i.right)){let r=i.top-n,s=i.bottom+n,a=t._maxCoord.y;t._scene.mapMode2D===Zl.ROTATE&&(a*=t.maximumZoomFactor),s>a&&(s=a,r=-a),r<=s&&(r=1,s=-1),o=i.right/i.top,i.top=r,i.bottom=s,i.right=i.top*o,i.left=-i.right}else{let r=i.right-n,s=i.left+n,a=t._maxCoord.x;t._scene.mapMode2D===Zl.ROTATE&&(a*=t.maximumZoomFactor),r>a&&(r=a,s=-a),r<=s&&(r=1,s=-1),o=i.top/i.right,i.right=r,i.left=s,i.top=i.right*o,i.bottom=-i.top}}function wme(t,n){t.move(t.direction,n)}Kt.prototype.zoomIn=function(t){t=A(t,this.defaultZoomAmount),this._mode===ne.SCENE2D?rk(this,t):wme(this,t)};Kt.prototype.zoomOut=function(t){t=A(t,this.defaultZoomAmount),this._mode===ne.SCENE2D?rk(this,-t):wme(this,-t)};Kt.prototype.getMagnitude=function(){if(this._mode===ne.SCENE3D)return m.magnitude(this.position);if(this._mode===ne.COLUMBUS_VIEW)return Math.abs(this.position.z);if(this._mode===ne.SCENE2D)return Math.max(this.frustum.right-this.frustum.left,this.frustum.top-this.frustum.bottom)};var vet=new N;Kt.prototype.lookAt=function(t,n){let i=vt.eastNorthUpToFixedFrame(t,oe.WGS84,vet);this.lookAtTransform(i,n)};var Pet=new m,Iet=new Me,Bet=new Me,Oet=new $;function Dme(t,n,i){n=B.clamp(n,-B.PI_OVER_TWO,B.PI_OVER_TWO),t=B.zeroToTwoPi(t)-B.PI_OVER_TWO;let o=Me.fromAxisAngle(m.UNIT_Y,-n,Iet),r=Me.fromAxisAngle(m.UNIT_Z,-t,Bet),s=Me.multiply(r,o,r),a=$.fromQuaternion(s,Oet),c=m.clone(m.UNIT_X,Pet);return $.multiplyByVector(a,c,c),m.negate(c,c),m.multiplyByScalar(c,i,c),c}Kt.prototype.lookAtTransform=function(t,n){if(this._setTransform(t),!f(n))return;let i;if(f(n.heading)?i=Dme(n.heading,n.pitch,n.range):i=n,this._mode===ne.SCENE2D){W.clone(W.ZERO,this.position),m.negate(i,this.up),this.up.z=0,m.magnitudeSquared(this.up)<B.EPSILON10&&m.clone(m.UNIT_Y,this.up),m.normalize(this.up,this.up),this._setTransform(N.IDENTITY),m.negate(m.UNIT_Z,this.direction),m.cross(this.direction,this.up,this.right),m.normalize(this.right,this.right);let o=this.frustum,r=o.top/o.right;o.right=m.magnitude(i)*.5,o.left=-o.right,o.top=r*o.right,o.bottom=-o.top,this._setTransform(t);return}m.clone(i,this.position),m.negate(this.position,this.direction),m.normalize(this.direction,this.direction),m.cross(this.direction,m.UNIT_Z,this.right),m.magnitudeSquared(this.right)<B.EPSILON10&&m.clone(m.UNIT_X,this.right),m.normalize(this.right,this.right),m.cross(this.right,this.direction,this.up),m.normalize(this.up,this.up),this._adjustOrthographicFrustum(!0)};var ov=new de,Ret=new de,Met=new m,Let=new m,Fet=new m,Net=new m,Vet=new m,ket=new m,Uet=new m,Q7=new m,zet={direction:new m,right:new m,up:new m},fme;function Ga(t,n,i,o){return Math.abs(m.dot(n,i))/o-m.dot(t,i)}function vme(t,n,i,o){let r=t._projection.ellipsoid,s=o?t:zet,a=n.north,c=n.south,l=n.east,u=n.west;u>l&&(l+=B.TWO_PI);let d=(u+l)*.5,h;if(c<-B.PI_OVER_TWO+B.RADIANS_PER_DEGREE&&a>B.PI_OVER_TWO-B.RADIANS_PER_DEGREE)h=0;else{let L=ov;L.longitude=d,L.latitude=a,L.height=0;let F=Ret;F.longitude=d,F.latitude=c,F.height=0;let g=fme;(!f(g)||g.ellipsoid!==r)&&(fme=g=new Of(void 0,void 0,r)),g.setEndPoints(L,F),h=g.interpolateUsingFraction(.5,ov).latitude}let _=ov;_.longitude=d,_.latitude=h,_.height=0;let y=r.cartographicToCartesian(_,Uet),p=ov;p.longitude=l,p.latitude=a;let C=r.cartographicToCartesian(p,Met);p.longitude=u;let x=r.cartographicToCartesian(p,Fet);p.longitude=d;let T=r.cartographicToCartesian(p,Vet);p.latitude=c;let E=r.cartographicToCartesian(p,ket);p.longitude=l;let S=r.cartographicToCartesian(p,Net);p.longitude=u;let w=r.cartographicToCartesian(p,Let);m.subtract(x,y,x),m.subtract(S,y,S),m.subtract(C,y,C),m.subtract(w,y,w),m.subtract(T,y,T),m.subtract(E,y,E);let D=r.geodeticSurfaceNormal(y,s.direction);m.negate(D,D);let I=m.cross(D,m.UNIT_Z,s.right);m.normalize(I,I);let O=m.cross(I,D,s.up),M;if(t.frustum instanceof $t){let L=Math.max(m.distance(C,x),m.distance(S,w)),F=Math.max(m.distance(C,S),m.distance(x,w)),g,b,v=t.frustum._offCenterFrustum.right/t.frustum._offCenterFrustum.top,P=F*v;L>P?(g=L,b=g/v):(b=F,g=P),M=Math.max(g,b)}else{let L=Math.tan(t.frustum.fovy*.5),F=t.frustum.aspectRatio*L;if(M=Math.max(Ga(D,O,x,L),Ga(D,O,S,L),Ga(D,O,C,L),Ga(D,O,w,L),Ga(D,O,T,L),Ga(D,O,E,L),Ga(D,I,x,F),Ga(D,I,S,F),Ga(D,I,C,F),Ga(D,I,w,F),Ga(D,I,T,F),Ga(D,I,E,F)),c<0&&a>0){let g=ov;g.longitude=u,g.latitude=0,g.height=0;let b=r.cartographicToCartesian(g,Q7);m.subtract(b,y,b),M=Math.max(M,Ga(D,O,b,L),Ga(D,I,b,F)),g.longitude=l,b=r.cartographicToCartesian(g,Q7),m.subtract(b,y,b),M=Math.max(M,Ga(D,O,b,L),Ga(D,I,b,F))}}return m.add(y,m.multiplyByScalar(D,-M,Q7),i)}var Het=new de,Get=new m,Wet=new m;function jet(t,n,i){let o=t._projection;n.west>n.east&&(n=le.MAX_VALUE);let r=t._actualTransform,s=t._actualInvTransform,a=Het;a.longitude=n.east,a.latitude=n.north;let c=o.project(a,Get);N.multiplyByPoint(r,c,c),N.multiplyByPoint(s,c,c),a.longitude=n.west,a.latitude=n.south;let l=o.project(a,Wet);if(N.multiplyByPoint(r,l,l),N.multiplyByPoint(s,l,l),i.x=(c.x-l.x)*.5+l.x,i.y=(c.y-l.y)*.5+l.y,f(t.frustum.fovy)){let u=Math.tan(t.frustum.fovy*.5),d=t.frustum.aspectRatio*u;i.z=Math.max((c.x-l.x)/d,(c.y-l.y)/u)*.5}else{let u=c.x-l.x,d=c.y-l.y;i.z=Math.max(u,d)}return i}var qet=new de,Yet=new m,Xet=new m;function Ket(t,n,i){let o=t._projection,r=n.east;n.west>n.east&&(t._scene.mapMode2D===Zl.INFINITE_SCROLL?r+=B.TWO_PI:(n=le.MAX_VALUE,r=n.east));let s=qet;s.longitude=r,s.latitude=n.north;let a=o.project(s,Yet);s.longitude=n.west,s.latitude=n.south;let c=o.project(s,Xet),l=Math.abs(a.x-c.x)*.5,u=Math.abs(a.y-c.y)*.5,d,h,_=t.frustum.right/t.frustum.top,y=u*_;return l>y?(d=l,h=d/_):(h=u,d=y),u=Math.max(2*d,2*h),i.x=(a.x-c.x)*.5+c.x,i.y=(a.y-c.y)*.5+c.y,s=o.unproject(i,s),s.height=u,i=o.project(s,i),i}Kt.prototype.getRectangleCameraCoordinates=function(t,n){let i=this._mode;if(f(n)||(n=new m),i===ne.SCENE3D)return vme(this,t,n);if(i===ne.COLUMBUS_VIEW)return jet(this,t,n);if(i===ne.SCENE2D)return Ket(this,t,n)};var Jet=new dn;function Zet(t,n,i,o){i=A(i,oe.WGS84);let r=t.getPickRay(n,Jet),s=ji.rayEllipsoid(r,i);if(!s)return;let a=s.start>0?s.start:s.stop;return dn.getPoint(r,a,o)}var Qet=new dn;function $et(t,n,i,o){let s=t.getPickRay(n,Qet).origin;s=m.fromElements(s.y,s.z,0,s);let a=i.unproject(s);if(!(a.latitude<-B.PI_OVER_TWO||a.latitude>B.PI_OVER_TWO))return i.ellipsoid.cartographicToCartesian(a,o)}var ett=new dn;function ttt(t,n,i,o){let r=t.getPickRay(n,ett),s=-r.origin.x/r.direction.x;dn.getPoint(r,s,o);let a=i.unproject(new m(o.y,o.z,0));if(!(a.latitude<-B.PI_OVER_TWO||a.latitude>B.PI_OVER_TWO||a.longitude<-Math.PI||a.longitude>Math.PI))return i.ellipsoid.cartographicToCartesian(a,o)}Kt.prototype.pickEllipsoid=function(t,n,i){let o=this._scene.canvas;if(!(o.clientWidth===0||o.clientHeight===0)){if(f(i)||(i=new m),n=A(n,oe.WGS84),this._mode===ne.SCENE3D)i=Zet(this,t,n,i);else if(this._mode===ne.SCENE2D)i=$et(this,t,this._projection,i);else if(this._mode===ne.COLUMBUS_VIEW)i=ttt(this,t,this._projection,i);else return;return i}};var ntt=new m,itt=new m,ott=new m;function rtt(t,n,i){let o=t._scene.canvas,r=o.clientWidth,s=o.clientHeight,a=Math.tan(t.frustum.fovy*.5),c=t.frustum.aspectRatio*a,l=t.frustum.near,u=2/r*n.x-1,d=2/s*(s-n.y)-1,h=t.positionWC;m.clone(h,i.origin);let _=m.multiplyByScalar(t.directionWC,l,ntt);m.add(h,_,_);let y=m.multiplyByScalar(t.rightWC,u*l*c,itt),p=m.multiplyByScalar(t.upWC,d*l*a,ott),C=m.add(_,y,i.direction);return m.add(C,p,C),m.subtract(C,h,C),m.normalize(C,C),i}var ek=new m;function stt(t,n,i){let o=t._scene.canvas,r=o.clientWidth,s=o.clientHeight,a=t.frustum;f(a._offCenterFrustum)&&(a=a._offCenterFrustum);let c=2/r*n.x-1;c*=(a.right-a.left)*.5;let l=2/s*(s-n.y)-1;l*=(a.top-a.bottom)*.5;let u=i.origin;return m.clone(t.position,u),m.multiplyByScalar(t.right,c,ek),m.add(ek,u,u),m.multiplyByScalar(t.up,l,ek),m.add(ek,u,u),m.clone(t.directionWC,i.direction),(t._mode===ne.COLUMBUS_VIEW||t._mode===ne.SCENE2D)&&m.fromElements(i.origin.z,i.origin.x,i.origin.y,i.origin),i}Kt.prototype.getPickRay=function(t,n){f(n)||(n=new dn);let i=this._scene.canvas;if(i.clientWidth<=0||i.clientHeight<=0)return;let o=this.frustum;return f(o.aspectRatio)&&f(o.fov)&&f(o.near)?rtt(this,t,n):stt(this,t,n)};var att=new m,ctt=new m;Kt.prototype.distanceToBoundingSphere=function(t){let n=m.subtract(this.positionWC,t.center,att),i=m.multiplyByScalar(this.directionWC,m.dot(n,this.directionWC),ctt);return Math.max(0,m.magnitude(i)-t.radius)};var ltt=new W;Kt.prototype.getPixelSize=function(t,n,i){let o=this.distanceToBoundingSphere(t),r=this.frustum.getPixelDimensions(n,i,o,this._scene.pixelRatio,ltt);return Math.max(r.x,r.y)};function utt(t,n,i,o,r,s){let a=m.clone(n);i.y>o?a.y-=i.y-o:i.y<-o&&(a.y+=-o-i.y),i.z>r?a.z-=i.z-r:i.z<-r&&(a.z+=-r-i.z);function c(l){let u=m.lerp(n,a,l.time,new m);t.worldToCameraCoordinatesPoint(u,t.position)}return{easingFunction:Vr.EXPONENTIAL_OUT,startObject:{time:0},stopObject:{time:1},duration:s,update:c}}var ftt=new m,dme=new m,dtt=new m,htt=new m;function mtt(t,n){let i=t.position,o=t.direction,r=t.worldToCameraCoordinatesVector(m.UNIT_X,ftt),s=-m.dot(r,i)/m.dot(r,o),a=m.add(i,m.multiplyByScalar(o,s,dme),dme);t.cameraToWorldCoordinatesPoint(a,a),i=t.cameraToWorldCoordinatesPoint(t.position,dtt);let c=Math.tan(t.frustum.fovy*.5),l=t.frustum.aspectRatio*c,u=m.magnitude(m.subtract(i,a,htt)),d=l*u,h=c*u,_=t._maxCoord.x,y=t._maxCoord.y,p=Math.max(d-_,_),C=Math.max(h-y,y);if(i.z<-p||i.z>p||i.y<-C||i.y>C){let x=a.y<-p||a.y>p,T=a.z<-C||a.z>C;if(x||T)return utt(t,i,a,p,C,n)}}Kt.prototype.createCorrectPositionTween=function(t){if(this._mode===ne.COLUMBUS_VIEW)return mtt(this,t)};var ptt=new m,gs={destination:void 0,heading:void 0,pitch:void 0,roll:void 0,duration:void 0,complete:void 0,cancel:void 0,endTransform:void 0,maximumHeight:void 0,easingFunction:void 0};Kt.prototype.cancelFlight=function(){f(this._currentFlight)&&(this._currentFlight.cancelTween(),this._currentFlight=void 0)};Kt.prototype.completeFlight=function(){if(f(this._currentFlight)){this._currentFlight.cancelTween();let t={destination:void 0,orientation:{heading:void 0,pitch:void 0,roll:void 0}};t.destination=gs.destination,t.orientation.heading=gs.heading,t.orientation.pitch=gs.pitch,t.orientation.roll=gs.roll,this.setView(t),f(this._currentFlight.complete)&&this._currentFlight.complete(),this._currentFlight=void 0}};Kt.prototype.flyTo=function(t){t=A(t,A.EMPTY_OBJECT);let n=t.destination;if(this._mode===ne.MORPHING)return;this.cancelFlight();let o=n instanceof le;o&&(n=this.getRectangleCameraCoordinates(n,ptt));let r=A(t.orientation,A.EMPTY_OBJECT);if(f(r.direction)&&(r=Tme(this,n,r,tj.orientation)),f(t.duration)&&t.duration<=0){let d=tj;d.destination=t.destination,d.orientation.heading=r.heading,d.orientation.pitch=r.pitch,d.orientation.roll=r.roll,d.convert=t.convert,d.endTransform=t.endTransform,this.setView(d),typeof t.complete=="function"&&t.complete();return}let s=this,a;gs.destination=n,gs.heading=r.heading,gs.pitch=r.pitch,gs.roll=r.roll,gs.duration=t.duration,gs.complete=function(){a===s._currentFlight&&(s._currentFlight=void 0),f(t.complete)&&t.complete()},gs.cancel=t.cancel,gs.endTransform=t.endTransform,gs.convert=o?!1:t.convert,gs.maximumHeight=t.maximumHeight,gs.pitchAdjustHeight=t.pitchAdjustHeight,gs.flyOverLongitude=t.flyOverLongitude,gs.flyOverLongitudeWeight=t.flyOverLongitudeWeight,gs.easingFunction=t.easingFunction;let c=this._scene,l=QV.createTween(c,gs);if(l.duration===0){typeof l.complete=="function"&&l.complete();return}a=c.tweens.add(l),this._currentFlight=a;let u=this._scene.preloadFlightCamera;this._mode!==ne.SCENE2D&&(f(u)||(u=Kt.clone(this)),u.setView({destination:n,orientation:r}),this._scene.preloadFlightCullingVolume=u.frustum.computeCullingVolume(u.positionWC,u.directionWC,u.upWC))};function _tt(t,n){let i=t.frustum,o=Math.tan(i.fovy*.5),r=i.aspectRatio*o;return Math.max(n/r,n/o)}function gtt(t,n){let i=t.frustum;f(i._offCenterFrustum)&&(i=i._offCenterFrustum);let o,r,s=i.right/i.top,a=n*s;return n>a?(o=n,r=o/s):(r=n,o=a),Math.max(o,r)*1.5}var ytt=100;function Pme(t,n,i){i=Ku.clone(f(i)?i:Kt.DEFAULT_OFFSET);let o=t._scene.screenSpaceCameraController.minimumZoomDistance,r=t._scene.screenSpaceCameraController.maximumZoomDistance,s=i.range;if(!f(s)||s===0){let a=n.radius;a===0?i.range=ytt:t.frustum instanceof $t||t._mode===ne.SCENE2D?i.range=gtt(t,a):i.range=_tt(t,a),i.range=B.clamp(i.range,o,r)}return i}Kt.prototype.viewBoundingSphere=function(t,n){n=Pme(this,t,n),this.lookAt(t.center,n)};var Att=new N,Ctt=new m,xtt=new m,Ttt=new m,Ett=new m,btt=new se,Stt=new Me,wtt=new $;Kt.prototype.flyToBoundingSphere=function(t,n){n=A(n,A.EMPTY_OBJECT);let i=this._mode===ne.SCENE2D||this._mode===ne.COLUMBUS_VIEW;this._setTransform(N.IDENTITY);let o=Pme(this,t,n.offset),r;i?r=m.multiplyByScalar(m.UNIT_Z,o.range,Ctt):r=Dme(o.heading,o.pitch,o.range);let s=vt.eastNorthUpToFixedFrame(t.center,oe.WGS84,Att);N.multiplyByPoint(s,r,r);let a,c;if(!i){if(a=m.subtract(t.center,r,xtt),m.normalize(a,a),c=N.multiplyByPointAsVector(s,m.UNIT_Z,Ttt),1-Math.abs(m.dot(a,c))<B.EPSILON6){let u=Me.fromAxisAngle(a,o.heading,Stt),d=$.fromQuaternion(u,wtt);m.fromCartesian4(N.getColumn(s,1,btt),c),$.multiplyByVector(d,c,c)}let l=m.cross(a,c,Ett);m.cross(l,a,c),m.normalize(c,c)}this.flyTo({destination:r,orientation:{direction:a,up:c},duration:n.duration,complete:n.complete,cancel:n.cancel,endTransform:n.endTransform,maximumHeight:n.maximumHeight,easingFunction:n.easingFunction,flyOverLongitude:n.flyOverLongitude,flyOverLongitudeWeight:n.flyOverLongitudeWeight,pitchAdjustHeight:n.pitchAdjustHeight})};var hme=new m,mme=new m,$7=new m,pme=new m,rv=[new m,new m,new m,new m];function Dtt(t,n){let i=n.radii,o=t.positionWC,r=m.multiplyComponents(n.oneOverRadii,o,hme),s=m.magnitude(r),a=m.normalize(r,mme),c,l;m.equalsEpsilon(a,m.UNIT_Z,B.EPSILON10)?(c=new m(0,1,0),l=new m(0,0,1)):(c=m.normalize(m.cross(m.UNIT_Z,a,$7),$7),l=m.normalize(m.cross(a,c,pme),pme));let u=Math.sqrt(m.magnitudeSquared(r)-1),d=m.multiplyByScalar(a,1/s,hme),h=u/s,_=m.multiplyByScalar(c,h,mme),y=m.multiplyByScalar(l,h,$7),p=m.add(d,y,rv[0]);m.subtract(p,_,p),m.multiplyComponents(i,p,p);let C=m.subtract(d,y,rv[1]);m.subtract(C,_,C),m.multiplyComponents(i,C,C);let x=m.subtract(d,y,rv[2]);m.add(x,_,x),m.multiplyComponents(i,x,x);let T=m.add(d,y,rv[3]);return m.add(T,_,T),m.multiplyComponents(i,T,T),rv}var ej=new W,vtt=new m,Gg=[new de,new de,new de,new de];function tk(t,n,i,o,r,s){ej.x=t,ej.y=n;let a=o.pickEllipsoid(ej,r,vtt);return f(a)?(Gg[i]=r.cartesianToCartographic(a,Gg[i]),1):(Gg[i]=r.cartesianToCartographic(s[i],Gg[i]),0)}Kt.prototype.computeViewRectangle=function(t,n){t=A(t,oe.WGS84);let i=this.frustum.computeCullingVolume(this.positionWC,this.directionWC,this.upWC),o=new ae(m.ZERO,t.maximumRadius);if(i.computeVisibility(o)===jt.OUTSIDE)return;let s=this._scene.canvas,a=s.clientWidth,c=s.clientHeight,l=0,u=Dtt(this,t);if(l+=tk(0,0,0,this,t,u),l+=tk(0,c,1,this,t,u),l+=tk(a,c,2,this,t,u),l+=tk(a,0,3,this,t,u),l<2)return le.MAX_VALUE;n=le.fromCartographicArray(Gg,n);let d=0,h=Gg[3].longitude;for(let _=0;_<4;++_){let y=Gg[_].longitude,p=Math.abs(y-h);p>B.PI?d+=B.TWO_PI-p:d+=p,h=y}return B.equalsEpsilon(Math.abs(d),B.TWO_PI,B.EPSILON9)&&(n.west=-B.PI,n.east=B.PI,Gg[0].latitude>=0?n.north=B.PI_OVER_TWO:n.south=-B.PI_OVER_TWO),n};Kt.prototype.switchToPerspectiveFrustum=function(){if(this._mode===ne.SCENE2D||this.frustum instanceof yi)return;let t=this._scene;this.frustum=new yi,this.frustum.aspectRatio=t.drawingBufferWidth/t.drawingBufferHeight,this.frustum.fov=B.toRadians(60)};Kt.prototype.switchToOrthographicFrustum=function(){if(this._mode===ne.SCENE2D||this.frustum instanceof $t)return;let t=Cme(this),n=this._scene;this.frustum=new $t,this.frustum.aspectRatio=n.drawingBufferWidth/n.drawingBufferHeight,this.frustum.width=t};Kt.clone=function(t,n){return f(n)||(n=new Kt(t._scene)),m.clone(t.position,n.position),m.clone(t.direction,n.direction),m.clone(t.up,n.up),m.clone(t.right,n.right),N.clone(t._transform,n.transform),n._transformChanged=!0,n.frustum=t.frustum.clone(),n};var lo=Kt;var Ptt={LEFT_DRAG:0,RIGHT_DRAG:1,MIDDLE_DRAG:2,WHEEL:3,PINCH:4},Pi=Object.freeze(Ptt);function ja(t,n){let i=t;return f(n)&&(i+=`+${n}`),i}function Itt(t,n){W.clone(t.distance.startPosition,n.distance.startPosition),W.clone(t.distance.endPosition,n.distance.endPosition),W.clone(t.angleAndHeight.startPosition,n.angleAndHeight.startPosition),W.clone(t.angleAndHeight.endPosition,n.angleAndHeight.endPosition)}function Ime(t,n,i){let o=ja(Pi.PINCH,n),r=t._update,s=t._isDown,a=t._eventStartPosition,c=t._pressTime,l=t._releaseTime;r[o]=!0,s[o]=!1,a[o]=new W;let u=t._movement[o];f(u)||(u=t._movement[o]={}),u.distance={startPosition:new W,endPosition:new W},u.angleAndHeight={startPosition:new W,endPosition:new W},u.prevAngle=0,t._eventHandler.setInputAction(function(d){t._buttonsDown++,s[o]=!0,c[o]=new Date,W.lerp(d.position1,d.position2,.5,a[o])},yn.PINCH_START,n),t._eventHandler.setInputAction(function(){t._buttonsDown=Math.max(t._buttonsDown-1,0),s[o]=!1,l[o]=new Date},yn.PINCH_END,n),t._eventHandler.setInputAction(function(d){if(s[o]){r[o]?(Itt(d,u),r[o]=!1,u.prevAngle=u.angleAndHeight.startPosition.x):(W.clone(d.distance.endPosition,u.distance.endPosition),W.clone(d.angleAndHeight.endPosition,u.angleAndHeight.endPosition));let h=u.angleAndHeight.endPosition.x,_=u.prevAngle,y=Math.PI*2;for(;h>=_+Math.PI;)h-=y;for(;h<_-Math.PI;)h+=y;u.angleAndHeight.endPosition.x=-h*i.clientWidth/12,u.angleAndHeight.startPosition.x=-_*i.clientWidth/12}},yn.PINCH_MOVE,n)}function Bme(t,n){let i=ja(Pi.WHEEL,n),o=t._update;o[i]=!0;let r=t._movement[i];f(r)||(r=t._movement[i]={}),r.startPosition=new W,r.endPosition=new W,t._eventHandler.setInputAction(function(s){let a=15*B.toRadians(s);o[i]?(W.clone(W.ZERO,r.startPosition),r.endPosition.x=0,r.endPosition.y=a,o[i]=!1):r.endPosition.y=r.endPosition.y+a},yn.WHEEL,n)}function IE(t,n,i){let o=ja(i,n),r=t._isDown,s=t._eventStartPosition,a=t._pressTime,c=t._releaseTime;r[o]=!1,s[o]=new W;let l=t._lastMovement[o];f(l)||(l=t._lastMovement[o]={startPosition:new W,endPosition:new W,valid:!1});let u,d;i===Pi.LEFT_DRAG?(u=yn.LEFT_DOWN,d=yn.LEFT_UP):i===Pi.RIGHT_DRAG?(u=yn.RIGHT_DOWN,d=yn.RIGHT_UP):i===Pi.MIDDLE_DRAG&&(u=yn.MIDDLE_DOWN,d=yn.MIDDLE_UP),t._eventHandler.setInputAction(function(h){t._buttonsDown++,l.valid=!1,r[o]=!0,a[o]=new Date,W.clone(h.position,s[o])},u,n),t._eventHandler.setInputAction(function(){t._buttonsDown=Math.max(t._buttonsDown-1,0),r[o]=!1,c[o]=new Date},d,n)}function Ome(t,n){W.clone(t.startPosition,n.startPosition),W.clone(t.endPosition,n.endPosition)}function Rme(t,n){let i=t._update,o=t._movement,r=t._lastMovement,s=t._isDown;for(let a in Pi)if(Pi.hasOwnProperty(a)){let c=Pi[a];if(f(c)){let l=ja(c,n);i[l]=!0,f(t._lastMovement[l])||(t._lastMovement[l]={startPosition:new W,endPosition:new W,valid:!1}),f(t._movement[l])||(t._movement[l]={startPosition:new W,endPosition:new W})}}t._eventHandler.setInputAction(function(a){for(let c in Pi)if(Pi.hasOwnProperty(c)){let l=Pi[c];if(f(l)){let u=ja(l,n);s[u]&&(i[u]?(Ome(o[u],r[u]),r[u].valid=!0,Ome(a,o[u]),i[u]=!1):W.clone(a.endPosition,o[u].endPosition))}}W.clone(a.endPosition,t._currentMousePosition)},yn.MOUSE_MOVE,n)}function sf(t){this._eventHandler=new nf(t),this._update={},this._movement={},this._lastMovement={},this._isDown={},this._eventStartPosition={},this._pressTime={},this._releaseTime={},this._buttonsDown=0,this._currentMousePosition=new W,Bme(this,void 0),Ime(this,void 0,t),IE(this,void 0,Pi.LEFT_DRAG),IE(this,void 0,Pi.RIGHT_DRAG),IE(this,void 0,Pi.MIDDLE_DRAG),Rme(this,void 0);for(let n in aa)if(aa.hasOwnProperty(n)){let i=aa[n];f(i)&&(Bme(this,i),Ime(this,i,t),IE(this,i,Pi.LEFT_DRAG),IE(this,i,Pi.RIGHT_DRAG),IE(this,i,Pi.MIDDLE_DRAG),Rme(this,i))}}Object.defineProperties(sf.prototype,{currentMousePosition:{get:function(){return this._currentMousePosition}},anyButtonDown:{get:function(){let t=!this._update[ja(Pi.WHEEL)]||!this._update[ja(Pi.WHEEL,aa.SHIFT)]||!this._update[ja(Pi.WHEEL,aa.CTRL)]||!this._update[ja(Pi.WHEEL,aa.ALT)];return this._buttonsDown>0||t}}});sf.prototype.isMoving=function(t,n){let i=ja(t,n);return!this._update[i]};sf.prototype.getMovement=function(t,n){let i=ja(t,n);return this._movement[i]};sf.prototype.getLastMovement=function(t,n){let i=ja(t,n),o=this._lastMovement[i];if(o.valid)return o};sf.prototype.isButtonDown=function(t,n){let i=ja(t,n);return this._isDown[i]};sf.prototype.getStartMousePosition=function(t,n){if(t===Pi.WHEEL)return this._currentMousePosition;let i=ja(t,n);return this._eventStartPosition[i]};sf.prototype.getButtonPressTime=function(t,n){let i=ja(t,n);return this._pressTime[i]};sf.prototype.getButtonReleaseTime=function(t,n){let i=ja(t,n);return this._releaseTime[i]};sf.prototype.reset=function(){for(let t in this._update)this._update.hasOwnProperty(t)&&(this._update[t]=!0)};sf.prototype.isDestroyed=function(){return!1};sf.prototype.destroy=function(){return this._eventHandler=this._eventHandler&&this._eventHandler.destroy(),ue(this)};var sk=sf;function yp(){this.featurePropertiesDirty=!1}Object.defineProperties(yp.prototype,{featuresLength:{get:function(){Ce.throwInstantiationError()}},pointsLength:{get:function(){Ce.throwInstantiationError()}},trianglesLength:{get:function(){Ce.throwInstantiationError()}},geometryByteLength:{get:function(){Ce.throwInstantiationError()}},texturesByteLength:{get:function(){Ce.throwInstantiationError()}},batchTableByteLength:{get:function(){Ce.throwInstantiationError()}},innerContents:{get:function(){Ce.throwInstantiationError()}},readyPromise:{get:function(){Ce.throwInstantiationError()}},tileset:{get:function(){Ce.throwInstantiationError()}},tile:{get:function(){Ce.throwInstantiationError()}},url:{get:function(){Ce.throwInstantiationError()}},batchTable:{get:function(){Ce.throwInstantiationError()}},metadata:{get:function(){Ce.throwInstantiationError()},set:function(t){Ce.throwInstantiationError()}},group:{get:function(){Ce.throwInstantiationError()},set:function(t){Ce.throwInstantiationError()}}});yp.prototype.hasProperty=function(t,n){Ce.throwInstantiationError()};yp.prototype.getFeature=function(t){Ce.throwInstantiationError()};yp.prototype.applyDebugSettings=function(t,n){Ce.throwInstantiationError()};yp.prototype.applyStyle=function(t){Ce.throwInstantiationError()};yp.prototype.update=function(t,n){Ce.throwInstantiationError()};yp.prototype.isDestroyed=function(){Ce.throwInstantiationError()};yp.prototype.destroy=function(){Ce.throwInstantiationError()};var Mme=yp;function Btt(t){this.pass=t.pass,this.commandList=t.commandList,this.camera=t.camera,this.cullingVolume=t.cullingVolume,this.ready=!1}var yd=Btt;function BE(t,n){this._conditionsExpression=tt(t,!0),this._conditions=t.conditions,this._runtimeConditions=void 0,Rtt(this,n)}Object.defineProperties(BE.prototype,{conditionsExpression:{get:function(){return this._conditionsExpression}}});function Ott(t,n){this.condition=t,this.expression=n}function Rtt(t,n){let i=[],o=t._conditions;if(!f(o))return;let r=o.length;for(let s=0;s<r;++s){let a=o[s],c=String(a[0]),l=String(a[1]);i.push(new Ott(new Mf(c,n),new Mf(l,n)))}t._runtimeConditions=i}BE.prototype.evaluate=function(t,n){let i=this._runtimeConditions;if(!f(i))return;let o=i.length;for(let r=0;r<o;++r){let s=i[r];if(s.condition.evaluate(t))return s.expression.evaluate(t,n)}};BE.prototype.evaluateColor=function(t,n){let i=this._runtimeConditions;if(!f(i))return;let o=i.length;for(let r=0;r<o;++r){let s=i[r];if(s.condition.evaluate(t))return s.expression.evaluateColor(t,n)}};BE.prototype.getShaderFunction=function(t,n,i,o){let r=this._runtimeConditions;if(!f(r)||r.length===0)return;let s="",a=r.length;for(let c=0;c<a;++c){let l=r[c],u=l.condition.getShaderExpression(n,i),d=l.expression.getShaderExpression(n,i);s+=`    ${c===0?"if":"else if"} (${u})
    {
        return ${d};
    }
`}return s=`${o} ${t}
{
${s}    return ${o}(1.0);
}
`,s};BE.prototype.getVariables=function(){let t=[],n=this._runtimeConditions;if(!f(n)||n.length===0)return t;let i=n.length;for(let o=0;o<i;++o){let r=n[o];t.push.apply(t,r.condition.getVariables()),t.push.apply(t,r.expression.getVariables())}return t=t.filter(function(o,r,s){return s.indexOf(o)===r}),t};var ak=BE;function Wg(t){this._style={},this._ready=!1,this._show=void 0,this._color=void 0,this._pointSize=void 0,this._pointOutlineColor=void 0,this._pointOutlineWidth=void 0,this._labelColor=void 0,this._labelOutlineColor=void 0,this._labelOutlineWidth=void 0,this._font=void 0,this._labelStyle=void 0,this._labelText=void 0,this._backgroundColor=void 0,this._backgroundPadding=void 0,this._backgroundEnabled=void 0,this._scaleByDistance=void 0,this._translucencyByDistance=void 0,this._distanceDisplayCondition=void 0,this._heightOffset=void 0,this._anchorLineEnabled=void 0,this._anchorLineColor=void 0,this._image=void 0,this._disableDepthTestDistance=void 0,this._horizontalOrigin=void 0,this._verticalOrigin=void 0,this._labelHorizontalOrigin=void 0,this._labelVerticalOrigin=void 0,this._meta=void 0,this._colorShaderFunction=void 0,this._showShaderFunction=void 0,this._pointSizeShaderFunction=void 0,this._colorShaderFunctionReady=!1,this._showShaderFunctionReady=!1,this._pointSizeShaderFunctionReady=!1,this._colorShaderTranslucent=!1,Mtt(this,t)}function Mtt(t,n){n=A(tt(n,!0),t._style),t._style=n,t.show=n.show,t.color=n.color,t.pointSize=n.pointSize,t.pointOutlineColor=n.pointOutlineColor,t.pointOutlineWidth=n.pointOutlineWidth,t.labelColor=n.labelColor,t.labelOutlineColor=n.labelOutlineColor,t.labelOutlineWidth=n.labelOutlineWidth,t.labelStyle=n.labelStyle,t.font=n.font,t.labelText=n.labelText,t.backgroundColor=n.backgroundColor,t.backgroundPadding=n.backgroundPadding,t.backgroundEnabled=n.backgroundEnabled,t.scaleByDistance=n.scaleByDistance,t.translucencyByDistance=n.translucencyByDistance,t.distanceDisplayCondition=n.distanceDisplayCondition,t.heightOffset=n.heightOffset,t.anchorLineEnabled=n.anchorLineEnabled,t.anchorLineColor=n.anchorLineColor,t.image=n.image,t.disableDepthTestDistance=n.disableDepthTestDistance,t.horizontalOrigin=n.horizontalOrigin,t.verticalOrigin=n.verticalOrigin,t.labelHorizontalOrigin=n.labelHorizontalOrigin,t.labelVerticalOrigin=n.labelVerticalOrigin;let i={};if(f(n.meta)){let o=n.defines,r=A(n.meta,A.EMPTY_OBJECT);for(let s in r)r.hasOwnProperty(s)&&(i[s]=new Mf(r[s],o))}t._meta=i,t._ready=!0}function Vo(t,n){let i=A(t._style,A.EMPTY_OBJECT).defines;if(f(n)){if(typeof n=="boolean"||typeof n=="number")return new Mf(String(n));if(typeof n=="string")return new Mf(n,i);if(f(n.conditions))return new ak(n,i)}else return;return n}function Uo(t){if(f(t)){if(f(t.expression))return t.expression;if(f(t.conditionsExpression))return tt(t.conditionsExpression,!0)}else return;return t}Object.defineProperties(Wg.prototype,{style:{get:function(){return this._style}},show:{get:function(){return this._show},set:function(t){this._show=Vo(this,t),this._style.show=Uo(this._show),this._showShaderFunctionReady=!1}},color:{get:function(){return this._color},set:function(t){this._color=Vo(this,t),this._style.color=Uo(this._color),this._colorShaderFunctionReady=!1}},pointSize:{get:function(){return this._pointSize},set:function(t){this._pointSize=Vo(this,t),this._style.pointSize=Uo(this._pointSize),this._pointSizeShaderFunctionReady=!1}},pointOutlineColor:{get:function(){return this._pointOutlineColor},set:function(t){this._pointOutlineColor=Vo(this,t),this._style.pointOutlineColor=Uo(this._pointOutlineColor)}},pointOutlineWidth:{get:function(){return this._pointOutlineWidth},set:function(t){this._pointOutlineWidth=Vo(this,t),this._style.pointOutlineWidth=Uo(this._pointOutlineWidth)}},labelColor:{get:function(){return this._labelColor},set:function(t){this._labelColor=Vo(this,t),this._style.labelColor=Uo(this._labelColor)}},labelOutlineColor:{get:function(){return this._labelOutlineColor},set:function(t){this._labelOutlineColor=Vo(this,t),this._style.labelOutlineColor=Uo(this._labelOutlineColor)}},labelOutlineWidth:{get:function(){return this._labelOutlineWidth},set:function(t){this._labelOutlineWidth=Vo(this,t),this._style.labelOutlineWidth=Uo(this._labelOutlineWidth)}},font:{get:function(){return this._font},set:function(t){this._font=Vo(this,t),this._style.font=Uo(this._font)}},labelStyle:{get:function(){return this._labelStyle},set:function(t){this._labelStyle=Vo(this,t),this._style.labelStyle=Uo(this._labelStyle)}},labelText:{get:function(){return this._labelText},set:function(t){this._labelText=Vo(this,t),this._style.labelText=Uo(this._labelText)}},backgroundColor:{get:function(){return this._backgroundColor},set:function(t){this._backgroundColor=Vo(this,t),this._style.backgroundColor=Uo(this._backgroundColor)}},backgroundPadding:{get:function(){return this._backgroundPadding},set:function(t){this._backgroundPadding=Vo(this,t),this._style.backgroundPadding=Uo(this._backgroundPadding)}},backgroundEnabled:{get:function(){return this._backgroundEnabled},set:function(t){this._backgroundEnabled=Vo(this,t),this._style.backgroundEnabled=Uo(this._backgroundEnabled)}},scaleByDistance:{get:function(){return this._scaleByDistance},set:function(t){this._scaleByDistance=Vo(this,t),this._style.scaleByDistance=Uo(this._scaleByDistance)}},translucencyByDistance:{get:function(){return this._translucencyByDistance},set:function(t){this._translucencyByDistance=Vo(this,t),this._style.translucencyByDistance=Uo(this._translucencyByDistance)}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(t){this._distanceDisplayCondition=Vo(this,t),this._style.distanceDisplayCondition=Uo(this._distanceDisplayCondition)}},heightOffset:{get:function(){return this._heightOffset},set:function(t){this._heightOffset=Vo(this,t),this._style.heightOffset=Uo(this._heightOffset)}},anchorLineEnabled:{get:function(){return this._anchorLineEnabled},set:function(t){this._anchorLineEnabled=Vo(this,t),this._style.anchorLineEnabled=Uo(this._anchorLineEnabled)}},anchorLineColor:{get:function(){return this._anchorLineColor},set:function(t){this._anchorLineColor=Vo(this,t),this._style.anchorLineColor=Uo(this._anchorLineColor)}},image:{get:function(){return this._image},set:function(t){this._image=Vo(this,t),this._style.image=Uo(this._image)}},disableDepthTestDistance:{get:function(){return this._disableDepthTestDistance},set:function(t){this._disableDepthTestDistance=Vo(this,t),this._style.disableDepthTestDistance=Uo(this._disableDepthTestDistance)}},horizontalOrigin:{get:function(){return this._horizontalOrigin},set:function(t){this._horizontalOrigin=Vo(this,t),this._style.horizontalOrigin=Uo(this._horizontalOrigin)}},verticalOrigin:{get:function(){return this._verticalOrigin},set:function(t){this._verticalOrigin=Vo(this,t),this._style.verticalOrigin=Uo(this._verticalOrigin)}},labelHorizontalOrigin:{get:function(){return this._labelHorizontalOrigin},set:function(t){this._labelHorizontalOrigin=Vo(this,t),this._style.labelHorizontalOrigin=Uo(this._labelHorizontalOrigin)}},labelVerticalOrigin:{get:function(){return this._labelVerticalOrigin},set:function(t){this._labelVerticalOrigin=Vo(this,t),this._style.labelVerticalOrigin=Uo(this._labelVerticalOrigin)}},meta:{get:function(){return this._meta},set:function(t){this._meta=t}}});Wg.fromUrl=function(t){return Ie.createIfNeeded(t).fetchJson(t).then(function(i){return new Wg(i)})};Wg.prototype.getColorShaderFunction=function(t,n,i){return this._colorShaderFunctionReady?(i.translucent=this._colorShaderTranslucent,this._colorShaderFunction):(this._colorShaderFunctionReady=!0,f(this.color)&&f(this.color.getShaderFunction)?this._colorShaderFunction=this.color.getShaderFunction(t,n,i,"vec4"):this._colorShaderFunction=void 0,this._colorShaderTranslucent=i.translucent,this._colorShaderFunction)};Wg.prototype.getShowShaderFunction=function(t,n,i){return this._showShaderFunctionReady?this._showShaderFunction:(this._showShaderFunctionReady=!0,f(this.show)&&f(this.show.getShaderFunction)?this._showShaderFunction=this.show.getShaderFunction(t,n,i,"bool"):this._showShaderFunction=void 0,this._showShaderFunction)};Wg.prototype.getPointSizeShaderFunction=function(t,n,i){return this._pointSizeShaderFunctionReady?this._pointSizeShaderFunction:(this._pointSizeShaderFunctionReady=!0,f(this.pointSize)&&f(this.pointSize.getShaderFunction)?this._pointSizeShaderFunction=this.pointSize.getShaderFunction(t,n,i,"float"):this._pointSizeShaderFunction=void 0,this._pointSizeShaderFunction)};Wg.prototype.getVariables=function(){let t=[];return f(this.color)&&f(this.color.getVariables)&&t.push.apply(t,this.color.getVariables()),f(this.show)&&f(this.show.getVariables)&&t.push.apply(t,this.show.getVariables()),f(this.pointSize)&&f(this.pointSize.getVariables)&&t.push.apply(t,this.pointSize.getVariables()),t=t.filter(function(n,i,o){return o.indexOf(n)===i}),t};var OE=Wg;function rj(t){t=A(t,1),this._radius=A(t,1)}Object.defineProperties(rj.prototype,{radius:{get:function(){return this._radius},set:function(t){this._radius=t}}});rj.prototype.emit=function(t){let n=B.randomBetween(0,B.TWO_PI),i=B.randomBetween(0,this._radius),o=i*Math.cos(n),r=i*Math.sin(n),s=0;t.position=m.fromElements(o,r,s,t.position),t.velocity=m.clone(m.UNIT_Z,t.velocity)};var ck=rj;var sj={CUMULUS:0};sj.validate=function(t){return t===sj.CUMULUS};var sv=Object.freeze(sj);function Ad(t,n){if(t=A(t,A.EMPTY_OBJECT),this._show=A(t.show,!0),this._position=m.clone(A(t.position,m.ZERO)),!f(t.scale)&&f(t.maximumSize))this._maximumSize=m.clone(t.maximumSize),this._scale=new W(this._maximumSize.x,this._maximumSize.y);else{this._scale=W.clone(A(t.scale,new W(20,12)));let i=new m(this._scale.x,this._scale.y,Math.min(this._scale.x,this._scale.y)/1.5);this._maximumSize=m.clone(A(t.maximumSize,i))}this._slice=A(t.slice,-1),this._color=z.clone(A(t.color,z.WHITE)),this._brightness=A(t.brightness,1),this._cloudCollection=n,this._index=-1}var Ltt=Ad.SHOW_INDEX=0,Ftt=Ad.POSITION_INDEX=1,Ntt=Ad.SCALE_INDEX=2,Vtt=Ad.MAXIMUM_SIZE_INDEX=3,ktt=Ad.SLICE_INDEX=4,Utt=Ad.BRIGHTNESS_INDEX=5,ztt=Ad.COLOR_INDEX=6;Ad.NUMBER_OF_PROPERTIES=7;function fA(t,n){let i=t._cloudCollection;f(i)&&(i._updateCloud(t,n),t._dirty=!0)}Object.defineProperties(Ad.prototype,{show:{get:function(){return this._show},set:function(t){this._show!==t&&(this._show=t,fA(this,Ltt))}},position:{get:function(){return this._position},set:function(t){let n=this._position;m.equals(n,t)||(m.clone(t,n),fA(this,Ftt))}},scale:{get:function(){return this._scale},set:function(t){let n=this._scale;W.equals(n,t)||(W.clone(t,n),fA(this,Ntt))}},maximumSize:{get:function(){return this._maximumSize},set:function(t){let n=this._maximumSize;m.equals(n,t)||(m.clone(t,n),fA(this,Vtt))}},color:{get:function(){return this._color},set:function(t){let n=this._color;z.equals(n,t)||(z.clone(t,n),fA(this,ztt))}},slice:{get:function(){return this._slice},set:function(t){this._slice!==t&&(this._slice=t,fA(this,ktt))}},brightness:{get:function(){return this._brightness},set:function(t){this._brightness!==t&&(this._brightness=t,fA(this,Utt))}}});Ad.prototype._destroy=function(){this._cloudCollection=void 0};var af=Ad;var Ql,lk=new m,Htt={positionHighAndScaleX:0,positionLowAndScaleY:1,packedAttribute0:2,packedAttribute1:3,color:4},Gtt={direction:0,positionHighAndScaleX:1,positionLowAndScaleY:2,packedAttribute0:3,packedAttribute1:4,color:5},Wtt=af.SHOW_INDEX,jtt=af.POSITION_INDEX,qtt=af.SCALE_INDEX,Ytt=af.MAXIMUM_SIZE_INDEX,Xtt=af.SLICE_INDEX,Ktt=af.BRIGHTNESS_INDEX,Jtt=af.NUMBER_OF_PROPERTIES,Ztt=af.COLOR_INDEX;function Cd(t){t=A(t,A.EMPTY_OBJECT),this._clouds=[],this._cloudsToUpdate=[],this._cloudsToUpdateIndex=0,this._cloudsRemoved=!1,this._createVertexArray=!1,this._propertiesChanged=new Uint32Array(Jtt),this._noiseTexture=void 0,this._textureSliceWidth=128,this._noiseTextureRows=4,this.noiseDetail=A(t.noiseDetail,16),this.noiseOffset=m.clone(A(t.noiseOffset,m.ZERO)),this._loading=!1,this._ready=!1;let n=this;this._uniforms={u_noiseTexture:function(){return n._noiseTexture},u_noiseTextureDimensions:Lme(n),u_noiseDetail:function(){return n.noiseDetail}},this._vaNoise=void 0,this._spNoise=void 0,this._spCreated=!1,this._sp=void 0,this._rs=void 0,this.show=A(t.show,!0),this._colorCommands=[],this.debugBillboards=A(t.debugBillboards,!1),this._compiledDebugBillboards=!1,this.debugEllipsoids=A(t.debugEllipsoids,!1),this._compiledDebugEllipsoids=!1}function Lme(t){return function(){return lk.x=t._textureSliceWidth,lk.y=t._noiseTextureRows,lk.z=1/t._noiseTextureRows,lk}}Object.defineProperties(Cd.prototype,{length:{get:function(){return cj(this),this._clouds.length}}});function Fme(t){let n=t.length;for(let i=0;i<n;++i)t[i]&&t[i]._destroy()}Cd.prototype.add=function(t){t=A(t,A.EMPTY_OBJECT);let n=A(t.cloudType,sv.CUMULUS),i;return n===sv.CUMULUS&&(i=new af(t,this),i._index=this._clouds.length,this._clouds.push(i),this._createVertexArray=!0),i};Cd.prototype.remove=function(t){return this.contains(t)?(this._clouds[t._index]=void 0,this._cloudsRemoved=!0,this._createVertexArray=!0,t._destroy(),!0):!1};Cd.prototype.removeAll=function(){Fme(this._clouds),this._clouds=[],this._cloudsToUpdate=[],this._cloudsToUpdateIndex=0,this._cloudsRemoved=!1,this._createVertexArray=!0};function cj(t){if(t._cloudsRemoved){t._cloudsRemoved=!1;let n=[],i=t._clouds,o=i.length;for(let r=0,s=0;r<o;++r){let a=i[r];f(a)&&(i._index=s++,n.push(a))}t._clouds=n}}Cd.prototype._updateCloud=function(t,n){t._dirty||(this._cloudsToUpdate[this._cloudsToUpdateIndex++]=t),++this._propertiesChanged[n]};Cd.prototype.contains=function(t){return f(t)&&t._cloudCollection===this};Cd.prototype.get=function(t){return cj(this),this._clouds[t]};var Qtt=new Float32Array([-1,-1,1,-1,1,1,-1,1]),$tt=new Uint16Array([0,1,2,0,2,3]);function ent(t){let n=ut.createVertexBuffer({context:t,typedArray:Qtt,usage:Fe.STATIC_DRAW}),i=ut.createIndexBuffer({context:t,typedArray:$tt,usage:Fe.STATIC_DRAW,indexDatatype:Ne.UNSIGNED_SHORT}),o=[{index:0,vertexBuffer:n,componentsPerAttribute:2,componentDatatype:J.FLOAT}];return new $n({context:t,attributes:o,indexBuffer:i})}var lj;function tnt(t){let i=t.cache.cloudCollection_indexBufferBatched;if(f(i))return i;let o=16384*6-6,r=new Uint16Array(o);for(let s=0,a=0;s<o;s+=6,a+=4)r[s]=a,r[s+1]=a+1,r[s+2]=a+2,r[s+3]=a,r[s+4]=a+2,r[s+5]=a+3;return i=ut.createIndexBuffer({context:t,typedArray:r,usage:Fe.STATIC_DRAW,indexDatatype:Ne.UNSIGNED_SHORT}),i.vertexArrayDestroyable=!1,t.cache.cloudCollection_indexBufferBatched=i,i}function nnt(t){let n=t.cache.cloudCollection_indexBufferInstanced;return f(n)||(n=ut.createIndexBuffer({context:t,typedArray:new Uint16Array([0,1,2,0,2,3]),usage:Fe.STATIC_DRAW,indexDatatype:Ne.UNSIGNED_SHORT}),n.vertexArrayDestroyable=!1,t.cache.cloudCollection_indexBufferInstanced=n),n}function int(t){let n=t.cache.cloudCollection_vertexBufferInstanced;return f(n)||(n=ut.createVertexBuffer({context:t,typedArray:new Float32Array([0,0,1,0,1,1,0,1]),usage:Fe.STATIC_DRAW}),n.vertexArrayDestroyable=!1,t.cache.cloudCollection_vertexBufferInstanced=n),n}function ont(t,n,i){let o=[{index:Ql.positionHighAndScaleX,componentsPerAttribute:4,componentDatatype:J.FLOAT,usage:Fe.STATIC_DRAW},{index:Ql.positionLowAndScaleY,componentsPerAttribute:4,componentDatatype:J.FLOAT,usage:Fe.STATIC_DRAW},{index:Ql.packedAttribute0,componentsPerAttribute:4,componentDatatype:J.FLOAT,usage:Fe.STATIC_DRAW},{index:Ql.packedAttribute1,componentsPerAttribute:4,componentDatatype:J.FLOAT,usage:Fe.STATIC_DRAW},{index:Ql.color,componentsPerAttribute:4,componentDatatype:J.UNSIGNED_BYTE,normalize:!0,usage:Fe.STATIC_DRAW}];i&&o.push({index:Ql.direction,componentsPerAttribute:2,componentDatatype:J.FLOAT,vertexBuffer:int(t)});let r=i?n:4*n;return new I_(t,o,r,i)}var aj=new Hn;function Nme(t,n,i,o){let r,s=i[Ql.positionHighAndScaleX],a=i[Ql.positionLowAndScaleY],c=o.position;Hn.fromCartesian(c,aj);let l=o.scale,u=aj.high,d=aj.low;t._instanced?(r=o._index,s(r,u.x,u.y,u.z,l.x),a(r,d.x,d.y,d.z,l.y)):(r=o._index*4,s(r+0,u.x,u.y,u.z,l.x),s(r+1,u.x,u.y,u.z,l.x),s(r+2,u.x,u.y,u.z,l.x),s(r+3,u.x,u.y,u.z,l.x),a(r+0,d.x,d.y,d.z,l.y),a(r+1,d.x,d.y,d.z,l.y),a(r+2,d.x,d.y,d.z,l.y),a(r+3,d.x,d.y,d.z,l.y))}function Vme(t,n,i,o){let r,s=i[Ql.packedAttribute0],a=o.show,c=o.brightness;t._instanced?(r=o._index,s(r,a,c,0,0)):(r=o._index*4,s(r+0,a,c,0,0),s(r+1,a,c,1,0),s(r+2,a,c,1,1),s(r+3,a,c,0,1))}function kme(t,n,i,o){let r,s=i[Ql.packedAttribute1],a=o.maximumSize,c=o.slice;t._instanced?(r=o._index,s(r,a.x,a.y,a.z,c)):(r=o._index*4,s(r+0,a.x,a.y,a.z,c),s(r+1,a.x,a.y,a.z,c),s(r+2,a.x,a.y,a.z,c),s(r+3,a.x,a.y,a.z,c))}function Ume(t,n,i,o){let r,s=i[Ql.color],a=o.color,c=z.floatToByte(a.red),l=z.floatToByte(a.green),u=z.floatToByte(a.blue),d=z.floatToByte(a.alpha);t._instanced?(r=o._index,s(r,c,l,u,d)):(r=o._index*4,s(r+0,c,l,u,d),s(r+1,c,l,u,d),s(r+2,c,l,u,d),s(r+3,c,l,u,d))}function rnt(t,n,i,o){Nme(t,n,i,o),Vme(t,n,i,o),kme(t,n,i,o),Ume(t,n,i,o)}function snt(t,n,i,o){let r=t,s=r._textureSliceWidth,a=r._noiseTextureRows,c=n.context;r._vaNoise=ent(c),r._spNoise=qt.fromCache({context:c,vertexShaderSource:i,fragmentShaderSource:o,attributeLocations:{position:0}});let l=r.noiseDetail,u=r.noiseOffset;r._noiseTexture=new St({context:c,width:s*s/a,height:s*a,pixelDatatype:je.UNSIGNED_BYTE,pixelFormat:st.RGBA,sampler:new pn({wrapS:Mn.REPEAT,wrapT:Mn.REPEAT,minificationFilter:fn.NEAREST,magnificationFilter:Qi.NEAREST})});let d=new Pf({vertexArray:r._vaNoise,shaderProgram:r._spNoise,outputTexture:r._noiseTexture,uniformMap:{u_noiseTextureDimensions:Lme(r),u_noiseDetail:function(){return l},u_noiseOffset:function(){return u}},persists:!1,owner:t,postExecute:function(h){r._ready=!0,r._loading=!1}});n.commandList.push(d),r._loading=!0}function ant(t,n){let i=t,o=n.context;i._createVertexArray=!1,i._vaf=i._vaf&&i._vaf.destroy();let r=t._clouds,s=r.length;if(s>0){i._vaf=ont(o,s,i._instanced);let a=i._vaf.writers,c;for(c=0;c<s;++c){let l=r[c];rnt(t,n,a,l)}i._vaf.commit(lj(o))}}var cnt=[];function lnt(t,n){let i=n.context,o=t,s=o._clouds.length,a=o._cloudsToUpdate,c=o._cloudsToUpdateIndex,l=o._propertiesChanged,u=cnt;u.length=0,(l[jtt]||l[qtt])&&u.push(Nme),(l[Wtt]||l[Ktt])&&u.push(Vme),(l[Ytt]||l[Xtt])&&u.push(kme),l[Ztt]&&u.push(Ume);let d=u.length,h=o._vaf.writers,_,y,p;if(c/s>.1){for(_=0;_<c;++_)for(y=a[_],y._dirty=!1,p=0;p<d;++p)u[p](t,n,h,y);o._vaf.commit(lj(i))}else{for(_=0;_<c;++_){for(y=a[_],y._dirty=!1,p=0;p<d;++p)u[p](t,n,h,y);o._instanced?o._vaf.subCommit(y._index,1):o._vaf.subCommit(y._index*4,4)}o._vaf.endSubCommits()}o._cloudsToUpdateIndex=0}function unt(t,n,i,o){let r=n.context,s=t,a=new ze({defines:[],sources:[i]});s._instanced&&a.defines.push("INSTANCED");let c=new ze({defines:[],sources:[o]});s.debugBillboards&&c.defines.push("DEBUG_BILLBOARDS"),s.debugEllipsoids&&c.defines.push("DEBUG_ELLIPSOIDS"),s._sp=qt.replaceCache({context:r,shaderProgram:s._sp,vertexShaderSource:a,fragmentShaderSource:c,attributeLocations:Ql}),s._rs=Ve.fromCache({depthTest:{enabled:!0,func:ee.LESS},depthMask:!1,blending:ln.ALPHA_BLEND}),s._spCreated=!0,s._compiledDebugBillboards=s.debugBillboards,s._compiledDebugEllipsoids=s.debugEllipsoids}function fnt(t,n){let i=t,o=n.passes,r=i._uniforms,s=n.commandList;if(o.render){let a=i._colorCommands,c=i._vaf.va,l=c.length;a.length=l;for(let u=0;u<l;u++){let d=a[u];f(d)||(d=a[u]=new et),d.pass=Te.TRANSLUCENT,d.owner=t,d.uniformMap=r,d.count=c[u].indicesCount,d.vertexArray=c[u].va,d.shaderProgram=i._sp,d.renderState=i._rs,i._instanced&&(d.count=6,d.instanceCount=i._clouds.length),s.push(d)}}}Cd.prototype.update=function(t){if(cj(this),!this.show)return;let n=this.debugBillboards||this.debugEllipsoids;this._ready=n?!0:f(this._noiseTexture),!this._ready&&!this._loading&&!n&&snt(this,t,IV,PV),this._instanced=t.context.instancedArrays,Ql=this._instanced?Gtt:Htt,lj=this._instanced?nnt:tnt;let o=this._clouds.length,r=this._cloudsToUpdate,s=this._cloudsToUpdateIndex;this._createVertexArray?ant(this,t):s>0&&lnt(this,t),s>o*1.5&&(r.length=o),!(!f(this._vaf)||!f(this._vaf.va)||!this._ready&!n)&&((!this._spCreated||this.debugBillboards!==this._compiledDebugBillboards||this.debugEllipsoids!==this._compiledDebugEllipsoids)&&unt(this,t,vV,DV),fnt(this,t))};Cd.prototype.isDestroyed=function(){return!1};Cd.prototype.destroy=function(){return this._noiseTexture=this._noiseTexture&&this._noiseTexture.destroy(),this._sp=this._sp&&this._sp.destroy(),this._vaf=this._vaf&&this._vaf.destroy(),Fme(this._clouds),ue(this)};var zme=Cd;function uj(t,n){let i=n.terrainProvider,o=n.mapProjection,r=o.ellipsoid,s,a=n.camera.getRectangleCameraCoordinates(t);return n.mode===ne.SCENE3D?s=r.cartesianToCartographic(a):s=o.unproject(a),f(i)?i.readyPromise.then(function(){let c=i.availability;if(!f(c)||n.mode===ne.SCENE2D)return s;let l=[le.center(t),le.southeast(t),le.southwest(t),le.northeast(t),le.northwest(t)];return uj._sampleTerrainMostDetailed(i,l).then(function(u){let d=u.reduce(function(_,y){return Math.max(y.height,_)},-Number.MAX_VALUE),h=s;return h.height+=d,h})}):Promise.resolve(s)}uj._sampleTerrainMostDetailed=dg;var RE=uj;var dnt=B.toRadians(30);function fj(t){this._angle=A(t,dnt)}Object.defineProperties(fj.prototype,{angle:{get:function(){return this._angle},set:function(t){this._angle=t}}});fj.prototype.emit=function(t){let n=Math.tan(this._angle),i=B.randomBetween(0,B.TWO_PI),o=B.randomBetween(0,n),r=o*Math.cos(i),s=o*Math.sin(i),a=1;t.velocity=m.fromElements(r,s,a,t.velocity),m.normalize(t.velocity,t.velocity),t.position=m.clone(m.ZERO,t.position)};var Hme=fj;var hnt=new z,mnt=new z,pnt=new z,_nt=new z,Gme=new se,av=new Uint8Array(4);function Wme(t,n,i,o){let r=n.height===i.height?0:(t-n.height)/(i.height-n.height);return z.lerp(n.color,i.color,r,o)}function uk(t,n){return{height:t,color:z.clone(n)}}function jme(t){return t=t.filter(function(n,i,o){let r=i>0,s=i<o.length-1,a=r?n.height===o[i-1].height:!0,c=s?n.height===o[i+1].height:!0;return!a||!c}),t=t.filter(function(n,i,o){let r=i>0,s=i<o.length-1,a=r?z.equals(n.color,o[i-1].color):!1,c=s?z.equals(n.color,o[i+1].color):!1;return!a||!c}),t=t.filter(function(n,i,o){let r=i>0,s=r?z.equals(n.color,o[i-1].color):!1,a=r?n.height===o[i-1].height:!0;return!s||!a}),t}function gnt(t){let n,i,o=[],r=t.length;for(n=0;n<r;n++){let s=t[n],a=s.entries,c=a.length,l=[];for(i=0;i<c;i++){let y=a[i],p=B.clamp(y.height,dl._minimumHeight,dl._maximumHeight),C=z.clone(y.color,hnt);C.red*=C.alpha,C.green*=C.alpha,C.blue*=C.alpha,l.push(uk(p,C))}let u=!0,d=!0;for(i=0;i<c-1;i++){let y=l[i+0],p=l[i+1];u=u&&y.height<=p.height,d=d&&y.height>=p.height}d?l=l.reverse():u||oA(l,function(y,p){return B.sign(y.height-p.height)});let h=A(s.extendDownwards,!1),_=A(s.extendUpwards,!1);l.length===1&&!h&&!_&&(h=!0,_=!0),h&&l.splice(0,0,uk(dl._minimumHeight,l[0].color)),_&&l.splice(l.length,0,uk(dl._maximumHeight,l[l.length-1].color)),l=jme(l),o.push(l)}return o}function ynt(t){let n=gnt(t),i=[],o=[],r;function s(u,d){i.push(uk(u,d))}function a(u,d,h){let _=z.multiplyByScalar(h,1-d.alpha,_nt);_=z.add(_,d,_),s(u,_)}let c=n.length;for(r=0;r<c;r++){let u=n[r],d=0,h=0;o=i,i=[];let _=u.length,y=o.length;for(;d<_||h<y;){let p=d<_?u[d]:void 0,C=d>0?u[d-1]:void 0,x=d<_-1?u[d+1]:void 0,T=h<y?o[h]:void 0,E=h>0?o[h-1]:void 0,S=h<y-1?o[h+1]:void 0;if(f(p)&&f(T)&&p.height===T.height){let w=f(S)&&T.height===S.height,D=!f(E),I=!f(S),O=f(x)&&p.height===x.height,M=!f(C),L=!f(x);w?O?(a(p.height,p.color,T.color),a(p.height,x.color,S.color)):M?(s(p.height,T.color),a(p.height,p.color,S.color)):L?(a(p.height,p.color,T.color),s(p.height,S.color)):(a(p.height,p.color,T.color),a(p.height,p.color,S.color)):D?O?(s(p.height,p.color),a(p.height,x.color,T.color)):L?(s(p.height,p.color),s(p.height,T.color)):(M||s(p.height,p.color),a(p.height,p.color,T.color)):I?O?(a(p.height,p.color,T.color),s(p.height,x.color)):M?(s(p.height,T.color),s(p.height,p.color)):L?a(p.height,p.color,T.color):(a(p.height,p.color,T.color),s(p.height,p.color)):O?(a(p.height,p.color,T.color),a(p.height,x.color,T.color)):M?(s(p.height,T.color),a(p.height,p.color,T.color)):L?(a(p.height,p.color,T.color),s(p.height,T.color)):a(p.height,p.color,T.color),d+=O?2:1,h+=w?2:1}else if(f(p)&&f(T)&&f(E)&&p.height<T.height){let w=Wme(p.height,E,T,pnt);f(C)?f(x)?a(p.height,p.color,w):(a(p.height,p.color,w),s(p.height,w)):(s(p.height,w),a(p.height,p.color,w)),d++}else if(f(T)&&f(p)&&f(C)&&T.height<p.height){let w=Wme(T.height,C,p,mnt);f(E)?f(S)?a(T.height,w,T.color):(a(T.height,w,T.color),s(T.height,w)):(s(T.height,w),a(T.height,w,T.color)),h++}else f(p)&&(!f(T)||p.height<T.height)?(f(T)&&!f(E)&&!f(x)?(s(p.height,p.color),s(p.height,dl._emptyColor),s(T.height,dl._emptyColor)):(!f(T)&&f(E)&&!f(C)&&(s(E.height,dl._emptyColor),s(p.height,dl._emptyColor)),s(p.height,p.color)),d++):f(T)&&(!f(p)||T.height<p.height)&&(s(T.height,T.color),h++)}}return jme(i)}function dl(t){t=A(t,A.EMPTY_OBJECT);let n=t.scene,i=t.layers,o=ynt(i),r=o.length,s,a,c,l;if(!dl._useFloatTexture(n.context))for(c=je.UNSIGNED_BYTE,l=st.RGBA,a=new Uint8Array(r*4),s=0;s<r;s++)se.packFloat(o[s].height,Gme),se.pack(Gme,a,s*4);else for(c=je.FLOAT,l=st.LUMINANCE,a=new Float32Array(r),s=0;s<r;s++)a[s]=o[s].height;let d=St.create({context:n.context,pixelFormat:l,pixelDatatype:c,source:{arrayBufferView:a,width:r,height:1},sampler:new pn({wrapS:Mn.CLAMP_TO_EDGE,wrapT:Mn.CLAMP_TO_EDGE,minificationFilter:fn.NEAREST,magnificationFilter:Qi.NEAREST})}),h=new Uint8Array(r*4);for(s=0;s<r;s++)o[s].color.toBytes(av),h[s*4+0]=av[0],h[s*4+1]=av[1],h[s*4+2]=av[2],h[s*4+3]=av[3];let _=St.create({context:n.context,pixelFormat:st.RGBA,pixelDatatype:je.UNSIGNED_BYTE,source:{arrayBufferView:h,width:r,height:1},sampler:new pn({wrapS:Mn.CLAMP_TO_EDGE,wrapT:Mn.CLAMP_TO_EDGE,minificationFilter:fn.LINEAR,magnificationFilter:Qi.LINEAR})});return $i.fromType("ElevationBand",{heights:d,colors:_})}dl._useFloatTexture=function(t){return t.floatingPointTexture};dl._maximumHeight=5906376425472;dl._minimumHeight=-5906376425472;dl._emptyColor=new z(0,0,0,0);var qme=dl;function Ant(t){t=At(t,{url:Fh.fromAssetId(96188)});let n=new $c(t),i=t.style;if(!f(i)){let o=A(t.defaultColor,z.WHITE).toCssColorString();i=new OE({color:`Boolean(\${feature['cesium#color']}) ? color(\${feature['cesium#color']}) : ${o}`})}return n.style=i,n}var Yme=Ant;function Cnt(t){t=A(t,A.EMPTY_OBJECT);let n=[],i=t.geometry;(!f(i.attributes)||!f(i.primitiveType))&&(i=i.constructor.createGeometry(i));let o=i.attributes,r=N.clone(A(t.modelMatrix,N.IDENTITY)),s=A(t.length,1e4);if(f(o.normal)&&n.push(new Ct({geometry:Fn.createLineSegmentsForVectors(i,"normal",s),attributes:{color:new Lt(1,0,0,1)},modelMatrix:r})),f(o.tangent)&&n.push(new Ct({geometry:Fn.createLineSegmentsForVectors(i,"tangent",s),attributes:{color:new Lt(0,1,0,1)},modelMatrix:r})),f(o.bitangent)&&n.push(new Ct({geometry:Fn.createLineSegmentsForVectors(i,"bitangent",s),attributes:{color:new Lt(0,0,1,1)},modelMatrix:r})),n.length>0)return new Sn({asynchronous:!1,geometryInstances:n,appearance:new tn({flat:!0,translucent:!1})})}var Xme=Cnt;var Kme=/{[^}]+}/g,Jme={x:bnt,y:wnt,z:Pnt,s:Int,reverseX:Snt,reverseY:Dnt,reverseZ:vnt,westDegrees:Bnt,southDegrees:Ont,eastDegrees:Rnt,northDegrees:Mnt,westProjected:Lnt,southProjected:Fnt,eastProjected:Nnt,northProjected:Vnt,width:knt,height:Unt},xnt=At(Jme,{i:znt,j:Hnt,reverseI:Gnt,reverseJ:Wnt,longitudeDegrees:qnt,latitudeDegrees:Ynt,longitudeProjected:Xnt,latitudeProjected:Knt,format:Znt});function FE(t){this._errorEvent=new Ae,this._resource=void 0,this._urlSchemeZeroPadding=void 0,this._pickFeaturesResource=void 0,this._tileWidth=void 0,this._tileHeight=void 0,this._maximumLevel=void 0,this._minimumLevel=void 0,this._tilingScheme=void 0,this._rectangle=void 0,this._tileDiscardPolicy=void 0,this._credit=void 0,this._hasAlphaChannel=void 0,this._readyPromise=void 0,this._tags=void 0,this._pickFeaturesTags=void 0,this.urlDomains=t.urlDomains,this.defaultAlpha=void 0,this.defaultNightAlpha=void 0,this.defaultDayAlpha=void 0,this.defaultBrightness=void 0,this.defaultContrast=void 0,this.defaultHue=void 0,this.defaultSaturation=void 0,this.defaultGamma=void 0,this.defaultMinificationFilter=void 0,this.defaultMagnificationFilter=void 0,this.enablePickFeatures=!0,this.reinitialize(t)}Object.defineProperties(FE.prototype,{url:{get:function(){return this._resource.url}},urlSchemeZeroPadding:{get:function(){return this._urlSchemeZeroPadding}},pickFeaturesUrl:{get:function(){return this._pickFeaturesResource.url}},proxy:{get:function(){return this._resource.proxy}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){return this._maximumLevel}},minimumLevel:{get:function(){return this._minimumLevel}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._rectangle}},tileDiscardPolicy:{get:function(){return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return f(this._resource)}},readyPromise:{get:function(){return this._readyPromise}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return this._hasAlphaChannel}}});FE.prototype.reinitialize=function(t){let n=this;n._readyPromise=Promise.resolve(t).then(function(i){let o=i.customTags,r=At(Jme,o),s=At(xnt,o),a=Ie.createIfNeeded(i.url),c=Ie.createIfNeeded(i.pickFeaturesUrl);n.enablePickFeatures=A(i.enablePickFeatures,n.enablePickFeatures),n._urlSchemeZeroPadding=A(i.urlSchemeZeroPadding,n.urlSchemeZeroPadding),n._tileDiscardPolicy=i.tileDiscardPolicy,n._getFeatureInfoFormats=i.getFeatureInfoFormats,n._subdomains=i.subdomains,Array.isArray(n._subdomains)?n._subdomains=n._subdomains.slice():f(n._subdomains)&&n._subdomains.length>0?n._subdomains=n._subdomains.split(""):n._subdomains=["a","b","c"],n._tileWidth=A(i.tileWidth,256),n._tileHeight=A(i.tileHeight,256),n._minimumLevel=A(i.minimumLevel,0),n._maximumLevel=i.maximumLevel,n._tilingScheme=A(i.tilingScheme,new Xr({ellipsoid:i.ellipsoid})),n._rectangle=A(i.rectangle,n._tilingScheme.rectangle),n._rectangle=le.intersection(n._rectangle,n._tilingScheme.rectangle),n._hasAlphaChannel=A(i.hasAlphaChannel,!0);let l=i.credit;return typeof l=="string"&&(l=new Jt(l)),n._credit=l,n._resource=a,n._tags=r,n._pickFeaturesResource=c,n._pickFeaturesTags=s,!0})};FE.prototype.getTileCredits=function(t,n,i){};FE.prototype.requestImage=function(t,n,i,o){return fl.loadImage(this,Tnt(this,t,n,i,o))};FE.prototype.pickFeatures=function(t,n,i,o,r){if(!this.enablePickFeatures||!f(this._pickFeaturesResource)||this._getFeatureInfoFormats.length===0)return;let s=0,a=this;function c(u,d){return u.callback(d)}function l(){if(s>=a._getFeatureInfoFormats.length)return Promise.resolve([]);let u=a._getFeatureInfoFormats[s],d=Ent(a,t,n,i,o,r,u.format);return++s,u.type==="json"?d.fetchJson().then(u.callback).catch(l):u.type==="xml"?d.fetchXML().then(u.callback).catch(l):u.type==="text"||u.type==="html"?d.fetchText().then(u.callback).catch(l):d.fetch({responseType:u.format}).then(c.bind(void 0,u)).catch(l)}return l()};var fk=!1,$l=new le,dk=!1,cv=new le;function Tnt(t,n,i,o,r){fk=!1,dk=!1;let s=t._resource,a=s.getUrlComponent(!0),c=t._tags,l={},u=a.match(Kme);f(u)&&u.forEach(function(h){let _=h.substring(1,h.length-1);f(c[_])&&(l[_]=c[_](t,n,i,o))});let d=s.getDerivedResource({request:r,templateValues:l});if(d.url.indexOf("{DOMAIN}")>-1&&t.urlDomains){let h=Math.floor(Math.random()*t.urlDomains.length),_=t.urlDomains[h];d.url=d.url.replace("{DOMAIN}",_)}return d}var dj=!1,LE=new W,hj=!1;function Ent(t,n,i,o,r,s,a){fk=!1,dk=!1,dj=!1,hj=!1;let c=t._pickFeaturesResource,l=c.getUrlComponent(!0),u=t._pickFeaturesTags,d={},h=l.match(Kme);return f(h)&&h.forEach(function(_){let y=_.substring(1,_.length-1);f(u[y])&&(d[y]=u[y](t,n,i,o,r,s,a))}),c.getDerivedResource({templateValues:d})}function NE(t,n,i){if(t&&t.urlSchemeZeroPadding&&t.urlSchemeZeroPadding.hasOwnProperty(n)){let o=t.urlSchemeZeroPadding[n];if(typeof o=="string"){let r=o.length;r>1&&(i=i.length>=r?i:new Array(r-i.toString().length+1).join("0")+i)}}return i}function bnt(t,n,i,o){return NE(t,"{x}",n)}function Snt(t,n,i,o){let r=t.tilingScheme.getNumberOfXTilesAtLevel(o)-n-1;return NE(t,"{reverseX}",r)}function wnt(t,n,i,o){return NE(t,"{y}",i)}function Dnt(t,n,i,o){let r=t.tilingScheme.getNumberOfYTilesAtLevel(o)-i-1;return NE(t,"{reverseY}",r)}function vnt(t,n,i,o){let r=t.maximumLevel,s=f(r)&&o<r?r-o-1:o;return NE(t,"{reverseZ}",s)}function Pnt(t,n,i,o){return NE(t,"{z}",o)}function Int(t,n,i,o){let r=(n+i+o)%t._subdomains.length;return t._subdomains[r]}function hk(t,n,i,o){fk||(t.tilingScheme.tileXYToRectangle(n,i,o,$l),$l.west=B.toDegrees($l.west),$l.south=B.toDegrees($l.south),$l.east=B.toDegrees($l.east),$l.north=B.toDegrees($l.north),fk=!0)}function Bnt(t,n,i,o){return hk(t,n,i,o),$l.west}function Ont(t,n,i,o){return hk(t,n,i,o),$l.south}function Rnt(t,n,i,o){return hk(t,n,i,o),$l.east}function Mnt(t,n,i,o){return hk(t,n,i,o),$l.north}function mk(t,n,i,o){dk||(t.tilingScheme.tileXYToNativeRectangle(n,i,o,cv),dk=!0)}function Lnt(t,n,i,o){return mk(t,n,i,o),cv.west}function Fnt(t,n,i,o){return mk(t,n,i,o),cv.south}function Nnt(t,n,i,o){return mk(t,n,i,o),cv.east}function Vnt(t,n,i,o){return mk(t,n,i,o),cv.north}function knt(t,n,i,o){return t.tileWidth}function Unt(t,n,i,o){return t.tileHeight}function znt(t,n,i,o,r,s,a){return pk(t,n,i,o,r,s),LE.x}function Hnt(t,n,i,o,r,s,a){return pk(t,n,i,o,r,s),LE.y}function Gnt(t,n,i,o,r,s,a){return pk(t,n,i,o,r,s),t.tileWidth-LE.x-1}function Wnt(t,n,i,o,r,s,a){return pk(t,n,i,o,r,s),t.tileHeight-LE.y-1}var jnt=new le,ME=new m;function pk(t,n,i,o,r,s,a){if(dj)return;mj(t,n,i,o,r,s);let c=ME,l=t.tilingScheme.tileXYToNativeRectangle(n,i,o,jnt);LE.x=t.tileWidth*(c.x-l.west)/l.width|0,LE.y=t.tileHeight*(l.north-c.y)/l.height|0,dj=!0}function qnt(t,n,i,o,r,s,a){return B.toDegrees(r)}function Ynt(t,n,i,o,r,s,a){return B.toDegrees(s)}function Xnt(t,n,i,o,r,s,a){return mj(t,n,i,o,r,s),ME.x}function Knt(t,n,i,o,r,s,a){return mj(t,n,i,o,r,s),ME.y}var Jnt=new de;function mj(t,n,i,o,r,s,a){if(!hj){if(t.tilingScheme.projection instanceof Ci)ME.x=B.toDegrees(r),ME.y=B.toDegrees(s);else{let c=Jnt;c.longitude=r,c.latitude=s,t.tilingScheme.projection.project(c,ME)}hj=!0}}function Znt(t,n,i,o,r,s,a){return a}var qa=FE;function dA(t){t=A(t,A.EMPTY_OBJECT),this._tmsResource=void 0,this._xmlResource=void 0,this._options=t,this._metadataError=void 0,this._metadataSuccess=this._metadataSuccess.bind(this),this._metadataFailure=this._metadataFailure.bind(this),this._requestMetadata=this._requestMetadata.bind(this);let n,i=this,o=Promise.resolve(t.url).then(function(r){return n=Ie.createIfNeeded(r),n.appendForwardSlash(),i._tmsResource=n,i._xmlResource=n.getDerivedResource({url:"tilemapresource.xml"}),i._requestMetadata()}).catch(r=>Promise.reject(r));qa.call(this,o),this._promise=o}f(Object.create)&&(dA.prototype=Object.create(qa.prototype),dA.prototype.constructor=dA);dA.prototype._requestMetadata=function(){return this._xmlResource.fetchXML().then(this._metadataSuccess).catch(t=>t instanceof rm?this._metadataFailure():Promise.reject(t))};function Zme(t,n){return t.west<n.rectangle.west&&(t.west=n.rectangle.west),t.east>n.rectangle.east&&(t.east=n.rectangle.east),t.south<n.rectangle.south&&(t.south=n.rectangle.south),t.north>n.rectangle.north&&(t.north=n.rectangle.north),t}function Qme(t,n,i){let o=t.positionToTileXY(le.southwest(n),i),r=t.positionToTileXY(le.northeast(n),i);return(Math.abs(r.x-o.x)+1)*(Math.abs(r.y-o.y)+1)>4?0:i}dA.prototype._metadataSuccess=function(t){let n=/tileformat/i,i=/tileset/i,o=/tilesets/i,r=/boundingbox/i,s,a,c,l=[],u=this._xmlResource,d=this._metadataError,h=this._requestMetadata,_=t.childNodes[0].childNodes;for(let M=0;M<_.length;M++)if(n.test(_.item(M).nodeName))s=_.item(M);else if(o.test(_.item(M).nodeName)){c=_.item(M);let L=_.item(M).childNodes;for(let F=0;F<L.length;F++)i.test(L.item(F).nodeName)&&l.push(L.item(F))}else r.test(_.item(M).nodeName)&&(a=_.item(M));let y;if(!f(c)||!f(a))return y=`Unable to find expected tilesets or bbox attributes in ${u.url}.`,d=qn.reportError(d,this,this.errorEvent,y),d.retry?(this._metadataError=d,h()):Promise.reject(new he(y));let p=this._options,C=A(p.fileExtension,s.getAttribute("extension")),x=A(p.tileWidth,parseInt(s.getAttribute("width"),10)),T=A(p.tileHeight,parseInt(s.getAttribute("height"),10)),E=A(p.minimumLevel,parseInt(l[0].getAttribute("order"),10)),S=A(p.maximumLevel,parseInt(l[l.length-1].getAttribute("order"),10)),w=c.getAttribute("profile"),D=p.tilingScheme;if(!f(D))if(w==="geodetic"||w==="global-geodetic")D=new Wi({ellipsoid:p.ellipsoid});else if(w==="mercator"||w==="global-mercator")D=new Xr({ellipsoid:p.ellipsoid});else return y=`${u.url}specifies an unsupported profile attribute, ${w}.`,d=qn.reportError(d,this,this.errorEvent,y),d.retry?(this._metadataError=d,h()):Promise.reject(new he(y));let I=le.clone(p.rectangle);if(!f(I)){let M,L,F,g;A(p.flipXY,!1)?(F=new W(parseFloat(a.getAttribute("miny")),parseFloat(a.getAttribute("minx"))),g=new W(parseFloat(a.getAttribute("maxy")),parseFloat(a.getAttribute("maxx")))):(F=new W(parseFloat(a.getAttribute("minx")),parseFloat(a.getAttribute("miny"))),g=new W(parseFloat(a.getAttribute("maxx")),parseFloat(a.getAttribute("maxy"))));let v=w==="geodetic"||w==="mercator";if(D.projection instanceof Ci||v)M=de.fromDegrees(F.x,F.y),L=de.fromDegrees(g.x,g.y);else{let P=D.projection;M=P.unproject(F),L=P.unproject(g)}I=new le(M.longitude,M.latitude,L.longitude,L.latitude)}I=Zme(I,D),E=Qme(D,I,E);let O=this._tmsResource.getDerivedResource({url:`{z}/{x}/{reverseY}.${C}`});return Promise.resolve({url:O,tilingScheme:D,rectangle:I,tileWidth:x,tileHeight:T,minimumLevel:E,maximumLevel:S,tileDiscardPolicy:p.tileDiscardPolicy,credit:p.credit})};dA.prototype._metadataFailure=function(){let t=this._options,n=A(t.fileExtension,"png"),i=A(t.tileWidth,256),o=A(t.tileHeight,256),r=t.maximumLevel,s=f(t.tilingScheme)?t.tilingScheme:new Xr({ellipsoid:t.ellipsoid}),a=A(t.rectangle,s.rectangle);a=Zme(a,s);let c=Qme(s,a,t.minimumLevel),l=this._tmsResource.getDerivedResource({url:`{z}/{x}/{reverseY}.${n}`});return Promise.resolve({url:l,tilingScheme:s,rectangle:a,tileWidth:i,tileHeight:o,minimumLevel:c,maximumLevel:r,tileDiscardPolicy:t.tileDiscardPolicy,credit:t.credit})};var hA=dA;function cf(t){t=A(t,{}),this.defaultAlpha=void 0,this.defaultNightAlpha=void 0,this.defaultDayAlpha=void 0,this.defaultBrightness=void 0,this.defaultContrast=void 0,this.defaultHue=void 0,this.defaultSaturation=void 0,this.defaultGamma=1.9,this.defaultMinificationFilter=void 0,this.defaultMagnificationFilter=void 0;let n=t.url,i=A(t.path,"/default_map"),o=Ie.createIfNeeded(n).getDerivedResource({url:i[0]==="/"?i.substring(1):i});o.appendForwardSlash(),this._resource=o,this._url=n,this._path=i,this._tileDiscardPolicy=t.tileDiscardPolicy,this._channel=t.channel,this._requestType="ImageryMaps",this._credit=new Jt(`<a href="http://www.google.com/enterprise/mapsearth/products/earthenterprise.html"><img src="${cf.logoUrl}" title="Google Imagery"/></a>`),this._tilingScheme=void 0,this._version=void 0,this._tileWidth=256,this._tileHeight=256,this._maximumLevel=t.maximumLevel,this._errorEvent=new Ae,this._ready=!1;let r=o.getDerivedResource({url:"query",queryParameters:{request:"Json",vars:"geeServerDefs",is2d:"t"}}),s=this,a;function c(d){let h;try{h=JSON.parse(d)}catch(p){h=JSON.parse(d.replace(/([\[\{,])[\n\r ]*([A-Za-z0-9]+)[\n\r ]*:/g,'$1"$2":'))}let _;for(let p=0;p<h.layers.length;p++)if(h.layers[p].id===s._channel){_=h.layers[p];break}let y;if(!f(_))return y=`Could not find layer with channel (id) of ${s._channel}.`,a=qn.reportError(a,s,s._errorEvent,y),a.retry?u():Promise.reject(new he(y));if(!f(_.version))return y=`Could not find a version in channel (id) ${s._channel}.`,a=qn.reportError(a,s,s._errorEvent,y),a.retry?u():Promise.reject(new he(y));if(s._version=_.version,f(h.projection)&&h.projection==="flat")s._tilingScheme=new Wi({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:2,rectangle:new le(-Math.PI,-Math.PI,Math.PI,Math.PI),ellipsoid:t.ellipsoid});else if(!f(h.projection)||h.projection==="mercator")s._tilingScheme=new Xr({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:2,ellipsoid:t.ellipsoid});else return y=`Unsupported projection ${h.projection}.`,a=qn.reportError(a,s,s._errorEvent,y),a.retry?u():Promise.reject(new he(y));return s._ready=!0,qn.reportSuccess(a),Promise.resolve(!0)}function l(d){let h=A(d.message,`An error occurred while accessing ${r.url}.`);return a=qn.reportError(a,s,s._errorEvent,h),Promise.reject(new he(h))}function u(){return r.fetchText().then(c).catch(l)}this._readyPromise=u()}Object.defineProperties(cf.prototype,{url:{get:function(){return this._url}},path:{get:function(){return this._path}},proxy:{get:function(){return this._resource.proxy}},channel:{get:function(){return this._channel}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){return this._maximumLevel}},minimumLevel:{get:function(){return 0}},tilingScheme:{get:function(){return this._tilingScheme}},version:{get:function(){return this._version}},requestType:{get:function(){return this._requestType}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return!0}}});cf.prototype.getTileCredits=function(t,n,i){};cf.prototype.requestImage=function(t,n,i,o){let r=this._resource.getDerivedResource({url:"query",request:o,queryParameters:{request:this._requestType,channel:this._channel,version:this._version,x:t,y:n,z:i+1}});return fl.loadImage(this,r)};cf.prototype.pickFeatures=function(t,n,i,o,r){};cf._logoUrl=void 0;Object.defineProperties(cf,{logoUrl:{get:function(){return f(cf._logoUrl)||(cf._logoUrl=Qt("Assets/Images/google_earth_credit.png")),cf._logoUrl},set:function(t){cf._logoUrl=t}}});var _k=cf;var Qnt=/\/$/,$me=new Jt('&copy; <a href="https://www.mapbox.com/about/maps/">Mapbox</a> &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> <strong><a href="https://www.mapbox.com/map-feedback/">Improve this map</a></strong>');function VE(t){t=A(t,A.EMPTY_OBJECT);let n=t.mapId,i=t.accessToken;this.defaultAlpha=void 0,this.defaultNightAlpha=void 0,this.defaultDayAlpha=void 0,this.defaultBrightness=void 0,this.defaultContrast=void 0,this.defaultHue=void 0,this.defaultSaturation=void 0,this.defaultGamma=void 0,this.defaultMinificationFilter=void 0,this.defaultMagnificationFilter=void 0;let o=Ie.createIfNeeded(A(t.url,"https://{s}.tiles.mapbox.com/v4/"));this._mapId=n,this._accessToken=i;let r=A(t.format,"png");/\./.test(r)||(r=`.${r}`),this._format=r;let s=o.getUrlComponent();Qnt.test(s)||(s+="/"),s+=`${n}/{z}/{x}/{y}${this._format}`,o.url=s,o.setQueryParameters({access_token:i});let a;f(t.credit)?(a=t.credit,typeof a=="string"&&(a=new Jt(a))):a=$me,this._resource=o,this._imageryProvider=new qa({url:o,credit:a,ellipsoid:t.ellipsoid,minimumLevel:t.minimumLevel,maximumLevel:t.maximumLevel,rectangle:t.rectangle})}Object.defineProperties(VE.prototype,{url:{get:function(){return this._imageryProvider.url}},ready:{get:function(){return this._imageryProvider.ready}},readyPromise:{get:function(){return this._imageryProvider.readyPromise}},rectangle:{get:function(){return this._imageryProvider.rectangle}},tileWidth:{get:function(){return this._imageryProvider.tileWidth}},tileHeight:{get:function(){return this._imageryProvider.tileHeight}},maximumLevel:{get:function(){return this._imageryProvider.maximumLevel}},minimumLevel:{get:function(){return this._imageryProvider.minimumLevel}},tilingScheme:{get:function(){return this._imageryProvider.tilingScheme}},tileDiscardPolicy:{get:function(){return this._imageryProvider.tileDiscardPolicy}},errorEvent:{get:function(){return this._imageryProvider.errorEvent}},credit:{get:function(){return this._imageryProvider.credit}},proxy:{get:function(){return this._imageryProvider.proxy}},hasAlphaChannel:{get:function(){return this._imageryProvider.hasAlphaChannel}}});VE.prototype.getTileCredits=function(t,n,i){};VE.prototype.requestImage=function(t,n,i,o){return this._imageryProvider.requestImage(t,n,i,o)};VE.prototype.pickFeatures=function(t,n,i,o,r){return this._imageryProvider.pickFeatures(t,n,i,o,r)};VE._defaultCredit=$me;var gk=VE;function lv(t){t=A(t,A.EMPTY_OBJECT),this.defaultAlpha=void 0,this.defaultNightAlpha=void 0,this.defaultDayAlpha=void 0,this.defaultBrightness=void 0,this.defaultContrast=void 0,this.defaultHue=void 0,this.defaultSaturation=void 0,this.defaultGamma=void 0,this.defaultMinificationFilter=void 0,this.defaultMagnificationFilter=void 0;let n=Ie.createIfNeeded(t.url),i=A(t.rectangle,le.MAX_VALUE),o=new Wi({rectangle:i,numberOfLevelZeroTilesX:1,numberOfLevelZeroTilesY:1,ellipsoid:t.ellipsoid});this._tilingScheme=o,this._resource=n,this._image=void 0,this._texture=void 0,this._tileWidth=0,this._tileHeight=0,this._errorEvent=new Ae,this._ready=!1;let r=t.credit;typeof r=="string"&&(r=new Jt(r)),this._credit=r;let s=this,a;function c(d){return s._image=d,s._tileWidth=d.width,s._tileHeight=d.height,s._ready=!0,qn.reportSuccess(s._errorEvent),Promise.resolve(!0)}function l(d){let h=`Failed to load image ${n.url}.`;return a=qn.reportError(a,s,s._errorEvent,h,0,0,0),a.retry?u():Promise.reject(new he(h))}function u(){return fl.loadImage(null,n).then(c).catch(l)}this._readyPromise=u()}Object.defineProperties(lv.prototype,{url:{get:function(){return this._resource.url}},proxy:{get:function(){return this._resource.proxy}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){return 0}},minimumLevel:{get:function(){return 0}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return!0}}});lv.prototype.getTileCredits=function(t,n,i){};lv.prototype.requestImage=function(t,n,i,o){if(!!f(this._image))return Promise.resolve(this._image)};lv.prototype.pickFeatures=function(t,n,i,o,r){};var yk=lv;function $nt(t,n,i){this.type=t,f(n)||(t==="json"?n="application/json":t==="xml"?n="text/xml":t==="html"?n="text/html":t==="text"&&(n="text/plain")),this.format=n,f(i)||(t==="json"?i=eit:t==="xml"?i=oit:(t==="html"||t==="text")&&(i=epe)),this.callback=i}function eit(t){let n=[],i=t.features;for(let o=0;o<i.length;++o){let r=i[o],s=new Hh;if(s.data=r,s.properties=r.properties,s.configureNameFromProperties(r.properties),s.configureDescriptionFromProperties(r.properties),f(r.geometry)&&r.geometry.type==="Point"){let a=r.geometry.coordinates[0],c=r.geometry.coordinates[1];s.position=de.fromDegrees(a,c)}n.push(s)}return n}var pj="http://www.mapinfo.com/mxp",tit="http://www.esri.com/wms",nit="http://www.opengis.net/wfs",iit="http://www.opengis.net/gml";function oit(t){let n=t.documentElement;if(n.localName==="MultiFeatureCollection"&&n.namespaceURI===pj)return rit(t);if(n.localName==="FeatureInfoResponse"&&n.namespaceURI===tit)return sit(t);if(n.localName==="FeatureCollection"&&n.namespaceURI===nit)return ait(t);if(n.localName==="ServiceExceptionReport")throw new he(new XMLSerializer().serializeToString(n));return n.localName==="msGMLOutput"?cit(t):lit(t)}function rit(t){let n=[],o=t.documentElement.getElementsByTagNameNS(pj,"Feature");for(let r=0;r<o.length;++r){let s=o[r],a={},c=s.getElementsByTagNameNS(pj,"Val");for(let u=0;u<c.length;++u){let d=c[u];if(d.hasAttribute("ref")){let h=d.getAttribute("ref"),_=d.textContent.trim();a[h]=_}}let l=new Hh;l.data=s,l.properties=a,l.configureNameFromProperties(a),l.configureDescriptionFromProperties(a),n.push(l)}return n}function sit(t){let n=t.documentElement,i=[],o,r=n.getElementsByTagNameNS("*","FIELDS");if(r.length>0)for(let s=0;s<r.length;++s){let a=r[s];o={};let c=a.attributes;for(let l=0;l<c.length;++l){let u=c[l];o[u.name]=u.value}i.push(Ak(a,o))}else{let s=n.getElementsByTagNameNS("*","FeatureInfo");for(let a=0;a<s.length;++a){let c=s[a];o={};let l=c.childNodes;for(let u=0;u<l.length;++u){let d=l[u];d.nodeType===Node.ELEMENT_NODE&&(o[d.localName]=d.textContent)}i.push(Ak(c,o))}}return i}function ait(t){let n=[],o=t.documentElement.getElementsByTagNameNS(iit,"featureMember");for(let r=0;r<o.length;++r){let s=o[r],a={};_j(s,a),n.push(Ak(s,a))}return n}function cit(t){let n=[],i,o=t.documentElement.childNodes;for(let s=0;s<o.length;s++)if(o[s].nodeType===Node.ELEMENT_NODE){i=o[s];break}if(!f(i))throw new he("Unable to find first child of the feature info xml document");let r=i.childNodes;for(let s=0;s<r.length;++s){let a=r[s];if(a.nodeType===Node.ELEMENT_NODE){let c={};_j(a,c),n.push(Ak(a,c))}}return n}function _j(t,n){let i=!0;for(let o=0;o<t.childNodes.length;++o){let r=t.childNodes[o];r.nodeType===Node.ELEMENT_NODE&&(i=!1),!(r.localName==="Point"||r.localName==="LineString"||r.localName==="Polygon"||r.localName==="boundedBy")&&r.hasChildNodes()&&_j(r,n)&&(n[r.localName]=r.textContent)}return i}function Ak(t,n){let i=new Hh;return i.data=t,i.properties=n,i.configureNameFromProperties(n),i.configureDescriptionFromProperties(n),i}function lit(t){let n=new XMLSerializer().serializeToString(t),i=document.createElement("div"),o=document.createElement("pre");o.textContent=n,i.appendChild(o);let r=new Hh;return r.data=t,r.description=i.innerHTML,[r]}var uit=/<body>\s*<\/body>/im,fit=/<ServiceExceptionReport([\s\S]*)<\/ServiceExceptionReport>/im,dit=/<title>([\s\S]*)<\/title>/im;function epe(t){if(uit.test(t)||fit.test(t))return;let n,i=dit.exec(t);i&&i.length>1&&(n=i[1]);let o=new Hh;return o.name=n,o.description=t,o.data=t,[o]}var kE=$nt;function uv(t){t=A(t,A.EMPTY_OBJECT),this._tileCache={},this._tilesRequestedForInterval=[];let n=this._clock=t.clock;this._times=t.times,this._requestImageFunction=t.requestImageFunction,this._reloadFunction=t.reloadFunction,this._currentIntervalIndex=-1,n.onTick.addEventListener(this._clockOnTick,this),this._clockOnTick(n)}Object.defineProperties(uv.prototype,{clock:{get:function(){return this._clock},set:function(t){this._clock!==t&&(this._clock=t,this._clockOnTick(t),this._reloadFunction())}},times:{get:function(){return this._times},set:function(t){this._times!==t&&(this._times=t,this._clockOnTick(this._clock),this._reloadFunction())}},currentInterval:{get:function(){return this._times.get(this._currentIntervalIndex)}}});uv.prototype.getFromCache=function(t,n,i,o){let r=tpe(t,n,i),s,a=this._tileCache[this._currentIntervalIndex];if(f(a)&&f(a[r])){let c=a[r];s=c.promise.catch(function(l){throw o.state=c.request.state,l}),delete a[r]}return s};uv.prototype.checkApproachingInterval=function(t,n,i,o){let r=tpe(t,n,i),s=this._tilesRequestedForInterval,a=npe(this),c={key:r,priorityFunction:o.priorityFunction};(!f(a)||!ipe(this,c,a))&&s.push(c),s.length>=512&&s.splice(0,256)};uv.prototype._clockOnTick=function(t){let n=t.currentTime,o=this._times.indexOf(n),r=this._currentIntervalIndex;if(o!==r){let a=this._tileCache[r];for(let c in a)a.hasOwnProperty(c)&&a[c].request.cancel();delete this._tileCache[r],this._tilesRequestedForInterval=[],this._currentIntervalIndex=o,this._reloadFunction();return}let s=npe(this);if(f(s)){let a=this._tilesRequestedForInterval,c=!0;for(;c&&a.length!==0;){let l=a.pop();c=ipe(this,l,s),c||a.push(l)}}};function tpe(t,n,i){return`${t}-${n}-${i}`}function hit(t){let n=t.split("-");if(n.length===3)return{x:Number(n[0]),y:Number(n[1]),level:Number(n[2])}}function npe(t){let n=t._times;if(!f(n))return;let i=t._clock,o=i.currentTime,r=i.canAnimate&&i.shouldAnimate,s=i.multiplier;if(!r&&s!==0)return;let a,c=n.indexOf(o);if(c<0)return;let l=n.get(c);return s>0?(a=te.secondsDifference(l.stop,o),++c):(a=te.secondsDifference(l.start,o),--c),a/=s,c>=0&&a<=5?n.get(c):void 0}function ipe(t,n,i){let o=t._times.indexOf(i.start),r=t._tileCache,s=r[o];f(s)||(s=r[o]={});let a=n.key;if(f(s[a]))return!0;let c=hit(a),l=new qo({throttle:!1,throttleByServer:!0,type:Qr.IMAGERY,priorityFunction:n.priorityFunction}),u=t._requestImageFunction(c.x,c.y,c.level,l,i);return f(u)?(s[a]={promise:u,request:l},!0):!1}var UE=uv;var mit=[3034,3035,3042,3043,3044],pit=[4471,4559];function xd(t){if(t=A(t,A.EMPTY_OBJECT),f(t.times)&&!f(t.clock))throw new Ce("options.times was specified, so options.clock is required.");this.defaultAlpha=void 0,this.defaultNightAlpha=void 0,this.defaultDayAlpha=void 0,this.defaultBrightness=void 0,this.defaultContrast=void 0,this.defaultHue=void 0,this.defaultSaturation=void 0,this.defaultGamma=void 0,this.defaultMinificationFilter=void 0,this.defaultMagnificationFilter=void 0,this._getFeatureInfoUrl=A(t.getFeatureInfoUrl,t.url);let n=Ie.createIfNeeded(t.url),i=Ie.createIfNeeded(this._getFeatureInfoUrl);n.setQueryParameters(xd.DefaultParameters,!0),i.setQueryParameters(xd.GetFeatureInfoDefaultParameters,!0),f(t.parameters)&&n.setQueryParameters(ope(t.parameters)),f(t.getFeatureInfoParameters)&&i.setQueryParameters(ope(t.getFeatureInfoParameters));let o=this;this._reload=void 0,f(t.times)&&(this._timeDynamicImagery=new UE({clock:t.clock,times:t.times,requestImageFunction:function(a,c,l,u,d){return rpe(o,a,c,l,u,d)},reloadFunction:function(){f(o._reload)&&o._reload()}}));let r={};if(r.layers=t.layers,r.bbox="{westProjected},{southProjected},{eastProjected},{northProjected}",r.width="{width}",r.height="{height}",parseFloat(n.queryParameters.version)>=1.3){r.crs=A(t.crs,t.tilingScheme&&t.tilingScheme.projection instanceof bi?"EPSG:3857":"CRS:84");let a=r.crs.split(":");if(a[0]==="EPSG"&&a.length===2){let c=Number(a[1]);(c>=4e3&&c<5e3&&!pit.includes(c)||mit.includes(c))&&(r.bbox="{southProjected},{westProjected},{northProjected},{eastProjected}")}}else r.srs=A(t.srs,t.tilingScheme&&t.tilingScheme.projection instanceof bi?"EPSG:3857":"EPSG:4326");n.setQueryParameters(r,!0),i.setQueryParameters(r,!0);let s={query_layers:t.layers,info_format:"{format}"};parseFloat(i.queryParameters.version)>=1.3?(s.i="{i}",s.j="{j}"):(s.x="{i}",s.y="{j}"),i.setQueryParameters(s,!0),this._resource=n,this._pickFeaturesResource=i,this._layers=t.layers,this._tileProvider=new qa({url:n,pickFeaturesUrl:i,tilingScheme:A(t.tilingScheme,new Wi({ellipsoid:t.ellipsoid})),rectangle:t.rectangle,tileWidth:t.tileWidth,tileHeight:t.tileHeight,minimumLevel:t.minimumLevel,maximumLevel:t.maximumLevel,subdomains:t.subdomains,tileDiscardPolicy:t.tileDiscardPolicy,credit:t.credit,getFeatureInfoFormats:A(t.getFeatureInfoFormats,xd.DefaultGetFeatureInfoFormats),enablePickFeatures:t.enablePickFeatures})}function rpe(t,n,i,o,r,s){let a=f(s)?s.data:void 0,c=t._tileProvider;return f(a)&&c._resource.setQueryParameters(a),c.requestImage(n,i,o,r)}function _it(t,n,i,o,r,s,a){let c=f(a)?a.data:void 0,l=t._tileProvider;return f(c)&&l._pickFeaturesResource.setQueryParameters(c),l.pickFeatures(n,i,o,r,s)}Object.defineProperties(xd.prototype,{url:{get:function(){return this._resource._url}},proxy:{get:function(){return this._resource.proxy}},layers:{get:function(){return this._layers}},tileWidth:{get:function(){return this._tileProvider.tileWidth}},tileHeight:{get:function(){return this._tileProvider.tileHeight}},maximumLevel:{get:function(){return this._tileProvider.maximumLevel}},minimumLevel:{get:function(){return this._tileProvider.minimumLevel}},tilingScheme:{get:function(){return this._tileProvider.tilingScheme}},rectangle:{get:function(){return this._tileProvider.rectangle}},tileDiscardPolicy:{get:function(){return this._tileProvider.tileDiscardPolicy}},errorEvent:{get:function(){return this._tileProvider.errorEvent}},ready:{get:function(){return this._tileProvider.ready}},readyPromise:{get:function(){return this._tileProvider.readyPromise}},credit:{get:function(){return this._tileProvider.credit}},hasAlphaChannel:{get:function(){return this._tileProvider.hasAlphaChannel}},enablePickFeatures:{get:function(){return this._tileProvider.enablePickFeatures},set:function(t){this._tileProvider.enablePickFeatures=t}},clock:{get:function(){return this._timeDynamicImagery.clock},set:function(t){this._timeDynamicImagery.clock=t}},times:{get:function(){return this._timeDynamicImagery.times},set:function(t){this._timeDynamicImagery.times=t}},getFeatureInfoUrl:{get:function(){return this._getFeatureInfoUrl}}});xd.prototype.getTileCredits=function(t,n,i){return this._tileProvider.getTileCredits(t,n,i)};xd.prototype.requestImage=function(t,n,i,o){let r,s=this._timeDynamicImagery,a;return f(s)&&(a=s.currentInterval,r=s.getFromCache(t,n,i,o)),f(r)||(r=rpe(this,t,n,i,o,a)),f(r)&&f(s)&&s.checkApproachingInterval(t,n,i,o),r};xd.prototype.pickFeatures=function(t,n,i,o,r){let s=this._timeDynamicImagery,a=f(s)?s.currentInterval:void 0;return _it(this,t,n,i,o,r,a)};xd.DefaultParameters=Object.freeze({service:"WMS",version:"1.1.1",request:"GetMap",styles:"",format:"image/jpeg"});xd.GetFeatureInfoDefaultParameters=Object.freeze({service:"WMS",version:"1.1.1",request:"GetFeatureInfo"});xd.DefaultGetFeatureInfoFormats=Object.freeze([Object.freeze(new kE("json","application/json")),Object.freeze(new kE("xml","text/xml")),Object.freeze(new kE("text","text/html"))]);function ope(t){let n={};for(let i in t)t.hasOwnProperty(i)&&(n[i.toLowerCase()]=t[i]);return n}var Ck=xd;var git=Object.freeze({service:"WMTS",version:"1.0.0",request:"GetTile"});function fv(t){t=A(t,A.EMPTY_OBJECT),this.defaultAlpha=void 0,this.defaultNightAlpha=void 0,this.defaultDayAlpha=void 0,this.defaultBrightness=void 0,this.defaultContrast=void 0,this.defaultHue=void 0,this.defaultSaturation=void 0,this.defaultGamma=void 0,this.defaultMinificationFilter=void 0,this.defaultMagnificationFilter=void 0;let n=Ie.createIfNeeded(t.url),i=t.style,o=t.tileMatrixSetID,r=n.url,s=r.match(/{/g);if(!f(s)||s.length===1&&/{s}/.test(r))n.setQueryParameters(git),this._useKvp=!0;else{let h={style:i,Style:i,TileMatrixSet:o};n.setTemplateValues(h),this._useKvp=!1}this._resource=n,this._layer=t.layer,this._style=i,this._tileMatrixSetID=o,this._tileMatrixLabels=t.tileMatrixLabels,this._format=A(t.format,"image/jpeg"),this._tileDiscardPolicy=t.tileDiscardPolicy,this._tilingScheme=f(t.tilingScheme)?t.tilingScheme:new Xr({ellipsoid:t.ellipsoid}),this._tileWidth=A(t.tileWidth,256),this._tileHeight=A(t.tileHeight,256),this._minimumLevel=A(t.minimumLevel,0),this._maximumLevel=t.maximumLevel,this._rectangle=A(t.rectangle,this._tilingScheme.rectangle),this._dimensions=t.dimensions;let a=this;this._reload=void 0,f(t.times)&&(this._timeDynamicImagery=new UE({clock:t.clock,times:t.times,requestImageFunction:function(h,_,y,p,C){return spe(a,h,_,y,p,C)},reloadFunction:function(){f(a._reload)&&a._reload()}})),this._readyPromise=Promise.resolve(!0);let c=this._tilingScheme.positionToTileXY(le.southwest(this._rectangle),this._minimumLevel),l=this._tilingScheme.positionToTileXY(le.northeast(this._rectangle),this._minimumLevel),u=(Math.abs(l.x-c.x)+1)*(Math.abs(l.y-c.y)+1);this._errorEvent=new Ae;let d=t.credit;this._credit=typeof d=="string"?new Jt(d):d,this._subdomains=t.subdomains,Array.isArray(this._subdomains)?this._subdomains=this._subdomains.slice():f(this._subdomains)&&this._subdomains.length>0?this._subdomains=this._subdomains.split(""):this._subdomains=["a","b","c"]}function spe(t,n,i,o,r,s){let a=t._tileMatrixLabels,c=f(a)?a[o]:o.toString(),l=t._subdomains,u=t._dimensions,d=f(s)?s.data:void 0,h,_;if(!t._useKvp)_={TileMatrix:c,TileRow:i.toString(),TileCol:n.toString(),s:l[(n+i+o)%l.length]},h=t._resource.getDerivedResource({request:r}),h.setTemplateValues(_),f(u)&&h.setTemplateValues(u),f(d)&&h.setTemplateValues(d);else{let y={};y.tilematrix=c,y.layer=t._layer,y.style=t._style,y.tilerow=i,y.tilecol=n,y.tilematrixset=t._tileMatrixSetID,y.format=t._format,f(u)&&(y=At(y,u)),f(d)&&(y=At(y,d)),_={s:l[(n+i+o)%l.length]},h=t._resource.getDerivedResource({queryParameters:y,request:r}),h.setTemplateValues(_)}return fl.loadImage(t,h)}Object.defineProperties(fv.prototype,{url:{get:function(){return this._resource.url}},proxy:{get:function(){return this._resource.proxy}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){return this._maximumLevel}},minimumLevel:{get:function(){return this._minimumLevel}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._rectangle}},tileDiscardPolicy:{get:function(){return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},format:{get:function(){return this._format}},ready:{value:!0},readyPromise:{get:function(){return this._readyPromise}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return!0}},clock:{get:function(){return this._timeDynamicImagery.clock},set:function(t){this._timeDynamicImagery.clock=t}},times:{get:function(){return this._timeDynamicImagery.times},set:function(t){this._timeDynamicImagery.times=t}},dimensions:{get:function(){return this._dimensions},set:function(t){this._dimensions!==t&&(this._dimensions=t,f(this._reload)&&this._reload())}}});fv.prototype.getTileCredits=function(t,n,i){};fv.prototype.requestImage=function(t,n,i,o){let r,s=this._timeDynamicImagery,a;return f(s)&&(a=s.currentInterval,r=s.getFromCache(t,n,i,o)),f(r)||(r=spe(this,t,n,i,o,a)),f(r)&&f(s)&&s.checkApproachingInterval(t,n,i,o),r};fv.prototype.pickFeatures=function(t,n,i,o,r){};var xk=fv;function Ap(t){return function(n){return new t(n)}}var yit={ARCGIS_MAPSERVER:Ap(Hg),BING:Ap(JV),GOOGLE_EARTH:Ap(_k),MAPBOX:Ap(gk),SINGLE_TILE:Ap(yk),TMS:Ap(hA),URL_TEMPLATE:Ap(qa),WMS:Ap(Ck),WMTS:Ap(xk)};function jg(t){t=A(t,A.EMPTY_OBJECT);let n=t.assetId;this.defaultAlpha=void 0,this.defaultNightAlpha=void 0,this.defaultDayAlpha=void 0,this.defaultBrightness=void 0,this.defaultContrast=void 0,this.defaultHue=void 0,this.defaultSaturation=void 0,this.defaultGamma=void 0,this.defaultMinificationFilter=void 0,this.defaultMagnificationFilter=void 0,this._ready=!1,this._tileCredits=void 0,this._errorEvent=new Ae;let i=this,o=Fh._createEndpointResource(n,t),r=t.assetId.toString()+t.accessToken+t.server,s=jg._endpointCache[r];f(s)||(s=o.fetchJson(),jg._endpointCache[r]=s),this._readyPromise=s.then(function(a){if(a.type!=="IMAGERY")return Promise.reject(new he(`Cesium ion asset ${n} is not an imagery asset.`));let c,l=a.externalType;if(!f(l))c=new hA({url:new Fh(a,o)});else{let u=yit[l];if(!f(u))return Promise.reject(new he(`Unrecognized Cesium ion imagery type: ${l}`));c=u(a.options)}return i._tileCredits=Fh.getCreditsFromEndpoint(a,o),c.errorEvent.addEventListener(function(u){u.provider=i,i._errorEvent.raiseEvent(u)}),i._imageryProvider=c,c.readyPromise.then(function(){return i._ready=!0,!0})})}Object.defineProperties(jg.prototype,{ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise}},rectangle:{get:function(){return this._imageryProvider.rectangle}},tileWidth:{get:function(){return this._imageryProvider.tileWidth}},tileHeight:{get:function(){return this._imageryProvider.tileHeight}},maximumLevel:{get:function(){return this._imageryProvider.maximumLevel}},minimumLevel:{get:function(){return this._imageryProvider.minimumLevel}},tilingScheme:{get:function(){return this._imageryProvider.tilingScheme}},tileDiscardPolicy:{get:function(){return this._imageryProvider.tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){return this._imageryProvider.credit}},hasAlphaChannel:{get:function(){return this._imageryProvider.hasAlphaChannel},proxy:{get:function(){}}}});jg.prototype.getTileCredits=function(t,n,i){let o=this._imageryProvider.getTileCredits(t,n,i);return f(o)?this._tileCredits.concat(o):this._tileCredits};jg.prototype.requestImage=function(t,n,i,o){return this._imageryProvider.requestImage(t,n,i,o)};jg.prototype.pickFeatures=function(t,n,i,o,r){return this._imageryProvider.pickFeatures(t,n,i,o,r)};jg._endpointCache={};var qg=jg;var Ait={AERIAL:2,AERIAL_WITH_LABELS:3,ROAD:4},Yg=Object.freeze(Ait);function Cit(t){t=A(t,A.EMPTY_OBJECT);let n=A(t.style,Yg.AERIAL);return new qg({assetId:n})}var Xg=Cit;var fpe=yo(gl(),1),ape=576,xit=100,dv="#ffffff",gj="#48b";function dpe(t,n){this.credit=t,this.count=A(n,1)}function Tit(t,n){let i=t.length;for(let o=0;o<i;o++){let r=t[o];if(Jt.equals(r,n))return!0}return!1}function Eit(t){let n=t._previousCesiumCredit,i=t._currentCesiumCredit;Jt.equals(i,n)||(f(n)&&t._cesiumCreditContainer.removeChild(n.element),f(i)&&t._cesiumCreditContainer.appendChild(i.element),t._previousCesiumCredit=i)}var hpe="cesium-credit-delimiter";function cpe(t){let n=document.createElement("span");return n.textContent=t,n.className=hpe,n}function lpe(t,n){if(f(n)){let i=document.createElement(n);i._creditId=t._creditId,i.appendChild(t),t=i}return t}function upe(t,n,i,o){let r=t.childNodes,s=-1;n.sort(function(a,c){return c.count-a.count});for(let a=0;a<n.length;++a){let c=n[a].credit;if(f(c)){if(s=a,f(i)&&(s*=2,a>0)){let u=s-1;if(r.length<=u)t.appendChild(cpe(i));else{let d=r[u];d.className!==hpe&&t.replaceChild(cpe(i),d)}}let l=c.element;if(r.length<=s)t.appendChild(lpe(l,o));else{let u=r[s];u._creditId!==c._id&&t.replaceChild(lpe(l,o),u)}}}for(++s;s<r.length;)t.removeChild(r[s])}function bit(t){let n=t._lightboxCredits,i=t.viewport.clientWidth,o=t.viewport.clientHeight;i!==t._lastViewportWidth&&(i<ape?(n.className="cesium-credit-lightbox cesium-credit-lightbox-mobile",n.style.marginTop="0"):(n.className="cesium-credit-lightbox cesium-credit-lightbox-expanded",n.style.marginTop=`${Math.floor((o-n.clientHeight)*.5)}px`),t._lastViewportWidth=i),i>=ape&&o!==t._lastViewportHeight&&(n.style.marginTop=`${Math.floor((o-n.clientHeight)*.5)}px`,t._lastViewportHeight=o)}function Ya(t,n){let i=`${t} {`;for(let o in n)n.hasOwnProperty(o)&&(i+=`${o}: ${n[o]}; `);return i+=` }
`,i}function Sit(){let t="";t+=Ya(".cesium-credit-lightbox-overlay",{display:"none","z-index":"1",position:"absolute",top:"0",left:"0",width:"100%",height:"100%","background-color":"rgba(80, 80, 80, 0.8)"}),t+=Ya(".cesium-credit-lightbox",{"background-color":"#303336",color:dv,position:"relative","min-height":`${xit}px`,margin:"auto"}),t+=Ya(".cesium-credit-lightbox > ul > li a, .cesium-credit-lightbox > ul > li a:visited",{color:dv}),t+=Ya(".cesium-credit-lightbox > ul > li a:hover",{color:gj}),t+=Ya(".cesium-credit-lightbox.cesium-credit-lightbox-expanded",{border:"1px solid #444","border-radius":"5px","max-width":"370px"}),t+=Ya(".cesium-credit-lightbox.cesium-credit-lightbox-mobile",{height:"100%",width:"100%"}),t+=Ya(".cesium-credit-lightbox-title",{padding:"20px 20px 0 20px"}),t+=Ya(".cesium-credit-lightbox-close",{"font-size":"18pt",cursor:"pointer",position:"absolute",top:"0",right:"6px",color:dv}),t+=Ya(".cesium-credit-lightbox-close:hover",{color:gj}),t+=Ya(".cesium-credit-lightbox > ul",{margin:"0",padding:"12px 20px 12px 40px","font-size":"13px"}),t+=Ya(".cesium-credit-lightbox > ul > li",{"padding-bottom":"6px"}),t+=Ya(".cesium-credit-lightbox > ul > li *",{padding:"0",margin:"0"}),t+=Ya(".cesium-credit-expand-link",{"padding-left":"5px",cursor:"pointer","text-decoration":"underline",color:dv}),t+=Ya(".cesium-credit-expand-link:hover",{color:gj}),t+=Ya(".cesium-credit-text",{color:dv}),t+=Ya(".cesium-credit-textContainer *, .cesium-credit-logoContainer *",{display:"inline"});let n=document.head,i=document.createElement("style");i.innerHTML=t,n.insertBefore(i,n.firstChild)}function dr(t,n,i){let o=this;i=A(i,document.body);let r=document.createElement("div");r.className="cesium-credit-lightbox-overlay",i.appendChild(r);let s=document.createElement("div");s.className="cesium-credit-lightbox",r.appendChild(s);function a(p){s.contains(p.target)||o.hideLightbox()}r.addEventListener("click",a,!1);let c=document.createElement("div");c.className="cesium-credit-lightbox-title",c.textContent="Data provided by:",s.appendChild(c);let l=document.createElement("a");l.onclick=this.hideLightbox.bind(this),l.innerHTML="&times;",l.className="cesium-credit-lightbox-close",s.appendChild(l);let u=document.createElement("ul");s.appendChild(u);let d=document.createElement("div");d.className="cesium-credit-logoContainer",d.style.display="inline",t.appendChild(d);let h=document.createElement("div");h.className="cesium-credit-textContainer",h.style.display="inline",t.appendChild(h);let _=document.createElement("a");_.className="cesium-credit-expand-link",_.onclick=this.showLightbox.bind(this),_.textContent="Data attribution",t.appendChild(_),Sit();let y=Jt.clone(dr.cesiumCredit);this._delimiter=A(n," \u2022 "),this._screenContainer=h,this._cesiumCreditContainer=d,this._lastViewportHeight=void 0,this._lastViewportWidth=void 0,this._lightboxCredits=s,this._creditList=u,this._lightbox=r,this._hideLightbox=a,this._expandLink=_,this._expanded=!1,this._defaultCredits=[],this._cesiumCredit=y,this._previousCesiumCredit=void 0,this._currentCesiumCredit=y,this._creditDisplayElementPool=[],this._creditDisplayElementIndex=0,this._currentFrameCredits={screenCredits:new yt,lightboxCredits:new yt},this._defaultCredit=void 0,this.viewport=i,this.container=t}function mpe(t,n,i,o){o=A(o,1);let r=n.get(i.id);if(f(r))r.count<Number.MAX_VALUE&&(r.count+=o);else{let s=t._creditDisplayElementPool,a=t._creditDisplayElementPoolIndex;a<s.length?(r=s[a],r.credit=i,r.count=o):(r=new dpe(i,o),s.push(r)),++t._creditDisplayElementPoolIndex,n.set(i.id,r)}}dr.prototype.addCredit=function(t){if(t._isIon){f(this._defaultCredit)||(this._defaultCredit=Jt.clone(ppe())),this._currentCesiumCredit=this._defaultCredit;return}let n;t.showOnScreen?n=this._currentFrameCredits.screenCredits:n=this._currentFrameCredits.lightboxCredits,mpe(this,n,t)};dr.prototype.addDefaultCredit=function(t){let n=this._defaultCredits;Tit(n,t)||n.push(t)};dr.prototype.removeDefaultCredit=function(t){let n=this._defaultCredits,i=n.indexOf(t);i!==-1&&n.splice(i,1)};dr.prototype.showLightbox=function(){this._lightbox.style.display="block",this._expanded=!0};dr.prototype.hideLightbox=function(){this._lightbox.style.display="none",this._expanded=!1};dr.prototype.update=function(){this._expanded&&bit(this)};dr.prototype.beginFrame=function(){let t=this._currentFrameCredits;this._creditDisplayElementPoolIndex=0;let n=t.screenCredits;n.removeAll();let i=this._defaultCredits;for(let o=0;o<i.length;++o){let r=i[o];mpe(this,n,r,Number.MAX_VALUE)}t.lightboxCredits.removeAll(),Jt.equals(dr.cesiumCredit,this._cesiumCredit)||(this._cesiumCredit=Jt.clone(dr.cesiumCredit)),this._currentCesiumCredit=this._cesiumCredit};dr.prototype.endFrame=function(){let t=this._currentFrameCredits.screenCredits.values;upe(this._screenContainer,t,this._delimiter,void 0);let n=this._currentFrameCredits.lightboxCredits.values;this._expandLink.style.display=n.length>0?"inline":"none",upe(this._creditList,n,void 0,"li"),Eit(this)};dr.prototype.destroy=function(){return this._lightbox.removeEventListener("click",this._hideLightbox,!1),this.container.removeChild(this._cesiumCreditContainer),this.container.removeChild(this._screenContainer),this.container.removeChild(this._expandLink),this.viewport.removeChild(this._lightbox),ue(this)};dr.prototype.isDestroyed=function(){return!1};dr._cesiumCredit=void 0;dr._cesiumCreditInitialized=!1;var Tk;function ppe(){if(!f(Tk)){let t=Qt("Assets/Images/ion-credit.png");t.indexOf("http://")!==0&&t.indexOf("https://")!==0&&t.indexOf("data:")!==0&&(t=new fpe.default(t).path()),Tk=new Jt(`<a href="https://cesium.com/" target="_blank"><img src="${t}" title="Cesium ion"/></a>`,!0)}return dr._cesiumCreditInitialized||(dr._cesiumCredit=Tk,dr._cesiumCreditInitialized=!0),Tk}Object.defineProperties(dr,{cesiumCredit:{get:function(){return ppe(),dr._cesiumCredit},set:function(t){dr._cesiumCredit=t,dr._cesiumCreditInitialized=!0}}});dr.CreditDisplayElement=dpe;var Ek=dr;function hv(t){t=A(t,A.EMPTY_OBJECT);let n=t.attributeName,i=t.perInstanceAttribute;f(i)||(i=!1);let o=A(t.glslDatatype,"vec3"),r=`v_${n}`,s;if(n==="normal"||n==="tangent"||n==="bitangent")s=`vec4 getColor() { return vec4((${r} + vec3(1.0)) * 0.5, 1.0); }
`;else switch(n==="st"&&(o="vec2"),o){case"float":s=`vec4 getColor() { return vec4(vec3(${r}), 1.0); }
`;break;case"vec2":s=`vec4 getColor() { return vec4(${r}, 0.0, 1.0); }
`;break;case"vec3":s=`vec4 getColor() { return vec4(${r}, 1.0); }
`;break;case"vec4":s=`vec4 getColor() { return ${r}; }
`;break}let a=`attribute vec3 position3DHigh;
attribute vec3 position3DLow;
attribute float batchId;
${i?"":`attribute ${o} ${n};
`}varying ${o} ${r};
void main()
{
vec4 p = czm_translateRelativeToEye(position3DHigh, position3DLow);
${i?`${r} = czm_batchTable_${n}(batchId);
`:`${r} = ${n};
`}gl_Position = czm_modelViewProjectionRelativeToEye * p;
}`,c=`varying ${o} ${r};
${s}
void main()
{
gl_FragColor = getColor();
}`;this.material=void 0,this.translucent=A(t.translucent,!1),this._vertexShaderSource=A(t.vertexShaderSource,a),this._fragmentShaderSource=A(t.fragmentShaderSource,c),this._renderState=Zi.getDefaultRenderState(!1,!1,t.renderState),this._closed=A(t.closed,!1),this._attributeName=n,this._glslDatatype=o}Object.defineProperties(hv.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},attributeName:{get:function(){return this._attributeName}},glslDatatype:{get:function(){return this._glslDatatype}}});hv.prototype.getFragmentShaderSource=Zi.prototype.getFragmentShaderSource;hv.prototype.isTranslucent=Zi.prototype.isTranslucent;hv.prototype.getRenderState=Zi.prototype.getRenderState;var _pe=hv;function bk(t){t=A(t,A.EMPTY_OBJECT),this._camera=t.camera,this._frustumSplits=t.frustumSplits,this._color=A(t.color,z.CYAN),this._updateOnChange=A(t.updateOnChange,!0),this.show=A(t.show,!0),this.id=t.id,this._id=void 0,this._outlinePrimitives=[],this._planesPrimitives=[]}var wit=new m,Dit=new $,vit=new Me,Pit=new yi,Iit=new ll,Bit=new $t,Oit=new Br,Rit=new z,Mit=[1,1e5];bk.prototype.update=function(t){if(!this.show)return;let n=this._planesPrimitives,i=this._outlinePrimitives,o,r;if(this._updateOnChange){for(r=n.length,o=0;o<r;++o)i[o]=i[o]&&i[o].destroy(),n[o]=n[o]&&n[o].destroy();n.length=0,i.length=0}if(n.length===0){let s=this._camera,a=s.frustum,c;a instanceof yi?c=Pit:a instanceof ll?c=Iit:a instanceof $t?c=Bit:c=Oit,c=a.clone(c);let l,u=this._frustumSplits;!f(u)||u.length<=1?(u=Mit,u[0]=this._camera.frustum.near,u[1]=this._camera.frustum.far,l=1):l=u.length-1;let d=s.positionWC,h=s.directionWC,_=s.upWC,y=s.rightWC;y=m.negate(y,wit);let p=Dit;$.setColumn(p,0,y,p),$.setColumn(p,1,_,p),$.setColumn(p,2,h,p);let C=Me.fromRotationMatrix(p,vit);for(n.length=i.length=l,o=0;o<l;++o)c.near=u[o],c.far=u[o+1],n[o]=new Sn({geometryInstances:new Ct({geometry:new CE({origin:d,orientation:C,frustum:c,_drawNearPlane:o===0}),attributes:{color:Lt.fromColor(z.fromAlpha(this._color,.1,Rit))},id:this.id,pickPrimitive:this}),appearance:new tn({translucent:!0,flat:!0}),asynchronous:!1}),i[o]=new Sn({geometryInstances:new Ct({geometry:new J3({origin:d,orientation:C,frustum:c,_drawNearPlane:o===0}),attributes:{color:Lt.fromColor(this._color)},id:this.id,pickPrimitive:this}),appearance:new tn({translucent:!1,flat:!0}),asynchronous:!1})}for(r=n.length,o=0;o<r;++o)i[o].update(t),n[o].update(t)};bk.prototype.isDestroyed=function(){return!1};bk.prototype.destroy=function(){let t=this._planesPrimitives.length;for(let n=0;n<t;++n)this._outlinePrimitives[n]=this._outlinePrimitives[n]&&this._outlinePrimitives[n].destroy(),this._planesPrimitives[n]=this._planesPrimitives[n]&&this._planesPrimitives[n].destroy();return ue(this)};var Cp=bk;function gpe(){this._cachedShowFrustumsShaders={}}function Lit(t){let n={},i=t.vertexAttributes;for(let o in i)i.hasOwnProperty(o)&&(n[o]=i[o].index);return n}function Fit(t,n){let i=t.context,o=n,r=o.fragmentShaderSource.clone(),s=[];r.sources=r.sources.map(function(d){d=ze.replaceMain(d,"czm_Debug_main");let h=/gl_FragData\[(\d+)\]/g,_;for(;(_=h.exec(d))!==null;)s.indexOf(_[1])===-1&&s.push(_[1]);return d});let a=s.length,c="";c+=`uniform vec3 debugShowCommandsColor;
`,c+=`uniform vec3 debugShowFrustumsColor;
`,c+=`void main() 
{ 
    czm_Debug_main(); 
`;let l;if(a>0)for(l=0;l<a;++l)c+=`    gl_FragData[${s[l]}].rgb *= debugShowCommandsColor;
`,c+=`    gl_FragData[${s[l]}].rgb *= debugShowFrustumsColor;
`;else c+=`    gl_FragColor.rgb *= debugShowCommandsColor;
`,c+=`    gl_FragColor.rgb *= debugShowFrustumsColor;
`;c+="}",r.sources.push(c);let u=Lit(o);return qt.fromCache({context:i,vertexShaderSource:o.vertexShaderSource,fragmentShaderSource:r,attributeLocations:u})}var mv=new z;function Nit(t,n){let i;return f(n.uniformMap)?i=n.uniformMap:i={},f(i.debugShowCommandsColor)||f(i.debugShowFrustumsColor)||(i.debugShowCommandsColor=function(){return t.debugShowCommands?(f(n._debugColor)||(n._debugColor=z.fromRandom()),n._debugColor):z.WHITE},i.debugShowFrustumsColor=function(){return t.debugShowFrustums?(mv.red=n.debugOverlappingFrustums&1<<0?1:0,mv.green=n.debugOverlappingFrustums&1<<1?1:0,mv.blue=n.debugOverlappingFrustums&1<<2?1:0,mv.alpha=1,mv):z.WHITE}),i}var Vit=new et;gpe.prototype.executeDebugShowFrustumsCommand=function(t,n,i){let o=n.shaderProgram.id,r=this._cachedShowFrustumsShaders[o];f(r)||(r=Fit(t,n.shaderProgram),this._cachedShowFrustumsShaders[o]=r);let s=et.shallowClone(n,Vit);s.shaderProgram=r,s.uniformMap=Nit(t,n),s.execute(t.context,i)};var Sk=gpe;function wk(t){t=A(t,A.EMPTY_OBJECT),this.length=A(t.length,1e7),this._length=void 0,this.width=A(t.width,2),this._width=void 0,this.show=A(t.show,!0),this.modelMatrix=N.clone(A(t.modelMatrix,N.IDENTITY)),this._modelMatrix=new N,this.id=t.id,this._id=void 0,this._primitive=void 0}wk.prototype.update=function(t){if(!!this.show){if(!f(this._primitive)||!N.equals(this._modelMatrix,this.modelMatrix)||this._length!==this.length||this._width!==this.width||this._id!==this.id){this._modelMatrix=N.clone(this.modelMatrix,this._modelMatrix),this._length=this.length,this._width=this.width,this._id=this.id,f(this._primitive)&&this._primitive.destroy(),this.modelMatrix[12]===0&&this.modelMatrix[13]===0&&this.modelMatrix[14]===0&&(this.modelMatrix[14]=.01);let n=new Ct({geometry:new _g({positions:[m.ZERO,m.UNIT_X],width:this.width,vertexFormat:Wr.VERTEX_FORMAT,colors:[z.RED,z.RED],arcType:Zt.NONE}),modelMatrix:N.multiplyByUniformScale(this.modelMatrix,this.length,new N),id:this.id,pickPrimitive:this}),i=new Ct({geometry:new _g({positions:[m.ZERO,m.UNIT_Y],width:this.width,vertexFormat:Wr.VERTEX_FORMAT,colors:[z.GREEN,z.GREEN],arcType:Zt.NONE}),modelMatrix:N.multiplyByUniformScale(this.modelMatrix,this.length,new N),id:this.id,pickPrimitive:this}),o=new Ct({geometry:new _g({positions:[m.ZERO,m.UNIT_Z],width:this.width,vertexFormat:Wr.VERTEX_FORMAT,colors:[z.BLUE,z.BLUE],arcType:Zt.NONE}),modelMatrix:N.multiplyByUniformScale(this.modelMatrix,this.length,new N),id:this.id,pickPrimitive:this});this._primitive=new Sn({geometryInstances:[n,i,o],appearance:new Wr,asynchronous:!1})}this._primitive.update(t)}};wk.prototype.isDestroyed=function(){return!1};wk.prototype.destroy=function(){return this._primitive=this._primitive&&this._primitive.destroy(),ue(this)};var Dk=wk;function _v(t){this._rs=void 0,this._sp=void 0,this._va=void 0,this._command=void 0,this._mode=void 0,this._useLogDepth=!1,this._ellipsoidOffset=A(t,0)}var pv=Vt.supportsTypedArrays()?new Float32Array(12):[],ype=new m,Ape=new m,yj=new m,Cpe=new m,vk=new m;function kit(t,n){let i=t.radii,o=n.camera,r,s,a;if(o.frustum instanceof $t)r=m.ZERO,s=o.rightWC,a=o.upWC;else{let h=o.positionWC,_=m.multiplyComponents(t.oneOverRadii,h,ype),y=m.normalize(_,Ape),p=m.normalize(m.cross(m.UNIT_Z,_,yj),yj),C=m.normalize(m.cross(y,p,Cpe),Cpe),x=m.magnitude(_),T=Math.sqrt(x*x-1);r=m.multiplyByScalar(y,1/x,ype);let E=T/x;s=m.multiplyByScalar(p,E,Ape),a=m.multiplyByScalar(C,E,yj)}let c=m.add(r,a,vk);m.subtract(c,s,c),m.multiplyComponents(i,c,c),m.pack(c,pv,0);let l=m.subtract(r,a,vk);m.subtract(l,s,l),m.multiplyComponents(i,l,l),m.pack(l,pv,3);let u=m.add(r,a,vk);m.add(u,s,u),m.multiplyComponents(i,u,u),m.pack(u,pv,6);let d=m.subtract(r,a,vk);return m.add(d,s,d),m.multiplyComponents(i,d,d),m.pack(d,pv,9),pv}_v.prototype.update=function(t){if(this._mode=t.mode,t.mode!==ne.SCENE3D)return;let n=t.context,i=t.mapProjection.ellipsoid.radii,o=new oe(i.x+this._ellipsoidOffset,i.y+this._ellipsoidOffset,i.z+this._ellipsoidOffset),r=t.useLogDepth;if(f(this._command)||(this._rs=Ve.fromCache({cull:{enabled:!0},depthTest:{enabled:!0},colorMask:{red:!1,green:!1,blue:!1,alpha:!1}}),this._command=new et({renderState:this._rs,boundingVolume:new ae(m.ZERO,o.maximumRadius),pass:Te.OPAQUE,owner:this})),!f(this._sp)||this._useLogDepth!==r){this._useLogDepth=r;let a=new ze({sources:[MV]}),c=new ze({sources:[RV]});if(r){let l=`#ifdef GL_EXT_frag_depth 
#extension GL_EXT_frag_depth : enable 
#endif 

`;c.sources.push(l),c.defines.push("LOG_DEPTH"),a.defines.push("LOG_DEPTH")}this._sp=qt.replaceCache({shaderProgram:this._sp,context:n,vertexShaderSource:a,fragmentShaderSource:c,attributeLocations:{position:0}}),this._command.shaderProgram=this._sp}let s=kit(o,t);if(f(this._va))this._va.getAttribute(0).vertexBuffer.copyFromArrayView(s);else{let a=new at({attributes:{position:new we({componentDatatype:J.FLOAT,componentsPerAttribute:3,values:s})},indices:[0,1,2,2,1,3],primitiveType:Re.TRIANGLES});this._va=$n.fromGeometry({context:n,geometry:a,attributeLocations:{position:0},bufferUsage:Fe.DYNAMIC_DRAW}),this._command.vertexArray=this._va}};_v.prototype.execute=function(t,n){this._mode===ne.SCENE3D&&this._command.execute(t,n)};_v.prototype.isDestroyed=function(){return!1};_v.prototype.destroy=function(){this._sp=this._sp&&this._sp.destroy(),this._va=this._va&&this._va.destroy()};var Pk=_v;function gv(){}var Uit=/\bgl_FragDepthEXT\b/,zit=/\bdiscard\b/;function Hit(t,n){let i=t.shaderCache.getDerivedShaderProgram(n,"depthOnly");if(!f(i)){let o=n._attributeLocations,r=n.fragmentShaderSource,s,a=!1,c=r.sources,l=c.length;for(s=0;s<l;++s)if(Uit.test(c[s])||zit.test(c[s])){a=!0;break}let u=!1,d=r.defines;for(l=d.length,s=0;s<l;++s)if(d[s]==="LOG_DEPTH"){u=!0;break}let h;!a&&!u?(h=`void main() 
{ 
    gl_FragColor = vec4(1.0); 
} 
`,r=new ze({sources:[h]})):!a&&u&&(h=`#ifdef GL_EXT_frag_depth 
#extension GL_EXT_frag_depth : enable 
#endif 

void main() 
{ 
    gl_FragColor = vec4(1.0); 
    czm_writeLogDepth(); 
} 
`,r=new ze({defines:["LOG_DEPTH"],sources:[h]})),i=t.shaderCache.createDerivedShaderProgram(n,"depthOnly",{vertexShaderSource:n.vertexShaderSource,fragmentShaderSource:r,attributeLocations:o})}return i}function Git(t,n){let i=t._depthOnlyRenderStateCache,o=i[n.id];if(!f(o)){let r=Ve.getState(n);r.depthMask=!0,r.colorMask={red:!1,green:!1,blue:!1,alpha:!1},o=Ve.fromCache(r),i[n.id]=o}return o}gv.createDepthOnlyDerivedCommand=function(t,n,i,o){f(o)||(o={});let r,s;return f(o.depthOnlyCommand)&&(r=o.depthOnlyCommand.shaderProgram,s=o.depthOnlyCommand.renderState),o.depthOnlyCommand=et.shallowClone(n,o.depthOnlyCommand),!f(r)||o.shaderProgramId!==n.shaderProgram.id?(o.depthOnlyCommand.shaderProgram=Hit(i,n.shaderProgram),o.depthOnlyCommand.renderState=Git(t,n.renderState),o.shaderProgramId=n.shaderProgram.id):(o.depthOnlyCommand.shaderProgram=r,o.depthOnlyCommand.renderState=s),o};var Wit=/\s+czm_writeLogDepth\(/,jit=/\s+czm_vertexLogDepth\(/,qit=/\s*#extension\s+GL_EXT_frag_depth\s*:\s*enable/;function Yit(t,n){let i=t.shaderCache.getDerivedShaderProgram(n,"logDepth");if(!f(i)){let o=n._attributeLocations,r=n.vertexShaderSource.clone(),s=n.fragmentShaderSource.clone();r.defines=f(r.defines)?r.defines.slice(0):[],r.defines.push("LOG_DEPTH"),s.defines=f(s.defines)?s.defines.slice(0):[],s.defines.push("LOG_DEPTH");let a,c,l=!1,u=r.sources,d=u.length;for(a=0;a<d;++a)if(jit.test(u[a])){l=!0;break}if(!l){for(a=0;a<d;++a)u[a]=ze.replaceMain(u[a],"czm_log_depth_main");c=`

void main() 
{ 
    czm_log_depth_main(); 
    czm_vertexLogDepth(); 
} 
`,u.push(c)}for(u=s.sources,d=u.length,l=!1,a=0;a<d;++a)Wit.test(u[a])&&(l=!0);s.defines.indexOf("LOG_DEPTH_WRITE")!==-1&&(l=!0);let h=!0;for(a=0;a<d;++a)qit.test(u[a])&&(h=!1);let _="";if(h&&(_+=`#ifdef GL_EXT_frag_depth 
#extension GL_EXT_frag_depth : enable 
#endif 

`),!l){for(a=0;a<d;a++)u[a]=ze.replaceMain(u[a],"czm_log_depth_main");_+=`
void main() 
{ 
    czm_log_depth_main(); 
    czm_writeLogDepth(); 
} 
`}u.push(_),i=t.shaderCache.createDerivedShaderProgram(n,"logDepth",{vertexShaderSource:r,fragmentShaderSource:s,attributeLocations:o})}return i}gv.createLogDepthCommand=function(t,n,i){f(i)||(i={});let o;return f(i.command)&&(o=i.command.shaderProgram),i.command=et.shallowClone(t,i.command),!f(o)||i.shaderProgramId!==t.shaderProgram.id?(i.command.shaderProgram=Yit(n,t.shaderProgram),i.shaderProgramId=t.shaderProgram.id):i.command.shaderProgram=o,i};function Xit(t,n,i){let o=t.shaderCache.getDerivedShaderProgram(n,"pick");if(!f(o)){let r=n._attributeLocations,s=n.fragmentShaderSource,a=s.sources,c=a.length,l=`void main() 
{ 
    czm_non_pick_main(); 
    if (gl_FragColor.a == 0.0) { 
        discard; 
    } 
    gl_FragColor = ${i}; 
} 
`,u=new Array(c+1);for(let d=0;d<c;++d)u[d]=ze.replaceMain(a[d],"czm_non_pick_main");u[c]=l,s=new ze({sources:u,defines:s.defines}),o=t.shaderCache.createDerivedShaderProgram(n,"pick",{vertexShaderSource:n.vertexShaderSource,fragmentShaderSource:s,attributeLocations:r})}return o}function Kit(t,n){let i=t.picking.pickRenderStateCache,o=i[n.id];if(!f(o)){let r=Ve.getState(n);r.blending.enabled=!1,r.depthMask=!0,o=Ve.fromCache(r),i[n.id]=o}return o}gv.createPickDerivedCommand=function(t,n,i,o){f(o)||(o={});let r,s;return f(o.pickCommand)&&(r=o.pickCommand.shaderProgram,s=o.pickCommand.renderState),o.pickCommand=et.shallowClone(n,o.pickCommand),!f(r)||o.shaderProgramId!==n.shaderProgram.id?(o.pickCommand.shaderProgram=Xit(i,n.shaderProgram,n.pickId),o.pickCommand.renderState=Kit(t,n.renderState),o.shaderProgramId=n.shaderProgram.id):(o.pickCommand.shaderProgram=r,o.pickCommand.renderState=s),o};function Jit(t,n){let i=t.shaderCache.getDerivedShaderProgram(n,"HDR");if(!f(i)){let o=n._attributeLocations,r=n.vertexShaderSource.clone(),s=n.fragmentShaderSource.clone();r.defines=f(r.defines)?r.defines.slice(0):[],r.defines.push("HDR"),s.defines=f(s.defines)?s.defines.slice(0):[],s.defines.push("HDR"),i=t.shaderCache.createDerivedShaderProgram(n,"HDR",{vertexShaderSource:r,fragmentShaderSource:s,attributeLocations:o})}return i}gv.createHdrCommand=function(t,n,i){f(i)||(i={});let o;return f(i.command)&&(o=i.command.shaderProgram),i.command=et.shallowClone(t,i.command),!f(o)||i.shaderProgramId!==t.shaderProgram.id?(i.command.shaderProgram=Jit(n,t.shaderProgram),i.shaderProgramId=t.shaderProgram.id):i.command.shaderProgram=o,i};var Kg=gv;function Ik(t){this._scene=t,this._lastAlpha=void 0,this._lastBeta=void 0,this._lastGamma=void 0,this._alpha=void 0,this._beta=void 0,this._gamma=void 0;let n=this;function i(o){let r=o.alpha;if(!f(r)){n._alpha=void 0,n._beta=void 0,n._gamma=void 0;return}n._alpha=B.toRadians(r),n._beta=B.toRadians(o.beta),n._gamma=B.toRadians(o.gamma)}window.addEventListener("deviceorientation",i,!1),this._removeListener=function(){window.removeEventListener("deviceorientation",i,!1)}}var Zit=new Me,xpe=new Me,Qit=new $;function $it(t,n,i,o){let r=t.direction,s=t.right,a=t.up,c=Me.fromAxisAngle(r,i,xpe),l=Me.fromAxisAngle(s,o,Zit),u=Me.multiply(l,c,l),d=Me.fromAxisAngle(a,n,xpe);Me.multiply(d,u,u);let h=$.fromQuaternion(u,Qit);$.multiplyByVector(h,s,s),$.multiplyByVector(h,a,a),$.multiplyByVector(h,r,r)}Ik.prototype.update=function(){if(!f(this._alpha))return;f(this._lastAlpha)||(this._lastAlpha=this._alpha,this._lastBeta=this._beta,this._lastGamma=this._gamma);let t=this._lastAlpha-this._alpha,n=this._lastBeta-this._beta,i=this._lastGamma-this._gamma;$it(this._scene.camera,-t,n,i),this._lastAlpha=this._alpha,this._lastBeta=this._beta,this._lastGamma=this._gamma};Ik.prototype.isDestroyed=function(){return!1};Ik.prototype.destroy=function(){return this._removeListener(),ue(this)};var Bk=Ik;function eot(t){this.direction=m.clone(t.direction),this.color=z.clone(A(t.color,z.WHITE)),this.intensity=A(t.intensity,1)}var Tpe=eot;var Aj={position:0};function Ok(t){t=A(t,A.EMPTY_OBJECT),this.center=m.clone(A(t.center,m.ZERO)),this._center=new m,this.radii=m.clone(t.radii),this._radii=new m,this._oneOverEllipsoidRadiiSquared=new m,this._boundingSphere=new ae,this.modelMatrix=N.clone(A(t.modelMatrix,N.IDENTITY)),this._modelMatrix=new N,this._computedModelMatrix=new N,this.show=A(t.show,!0),this.material=A(t.material,$i.fromType($i.ColorType)),this._material=void 0,this._translucent=void 0,this.id=t.id,this._id=void 0,this.debugShowBoundingVolume=A(t.debugShowBoundingVolume,!1),this.onlySunLighting=A(t.onlySunLighting,!1),this._onlySunLighting=!1,this._depthTestEnabled=A(t.depthTestEnabled,!0),this._useLogDepth=!1,this._sp=void 0,this._rs=void 0,this._va=void 0,this._pickSP=void 0,this._pickId=void 0,this._colorCommand=new et({owner:A(t._owner,this)}),this._pickCommand=new et({owner:A(t._owner,this),pickOnly:!0});let n=this;this._uniforms={u_radii:function(){return n.radii},u_oneOverEllipsoidRadiiSquared:function(){return n._oneOverEllipsoidRadiiSquared}},this._pickUniforms={czm_pickColor:function(){return n._pickId.color}}}function tot(t){let n=t.cache.ellipsoidPrimitive_vertexArray;if(f(n))return n;let i=Cl.createGeometry(Cl.fromDimensions({dimensions:new m(2,2,2),vertexFormat:De.POSITION_ONLY}));return n=$n.fromGeometry({context:t,geometry:i,attributeLocations:Aj,bufferUsage:Fe.STATIC_DRAW,interleave:!0}),t.cache.ellipsoidPrimitive_vertexArray=n,n}var Epe=`#ifdef GL_EXT_frag_depth 
#extension GL_EXT_frag_depth : enable 
#endif 

`;Ok.prototype.update=function(t){if(!this.show||t.mode!==ne.SCENE3D||!f(this.center)||!f(this.radii))return;let n=t.context,i=this.material.isTranslucent(),o=this._translucent!==i;(!f(this._rs)||o)&&(this._translucent=i,this._rs=Ve.fromCache({cull:{enabled:!0,face:xi.FRONT},depthTest:{enabled:this._depthTestEnabled},depthMask:!i&&n.fragmentDepth,blending:i?ln.ALPHA_BLEND:void 0})),f(this._va)||(this._va=tot(n));let r=!1,s=this.radii;if(!m.equals(this._radii,s)){m.clone(s,this._radii);let C=this._oneOverEllipsoidRadiiSquared;C.x=1/(s.x*s.x),C.y=1/(s.y*s.y),C.z=1/(s.z*s.z),r=!0}(!N.equals(this.modelMatrix,this._modelMatrix)||!m.equals(this.center,this._center))&&(N.clone(this.modelMatrix,this._modelMatrix),m.clone(this.center,this._center),N.multiplyByTranslation(this.modelMatrix,this.center,this._computedModelMatrix),r=!0),r&&(m.clone(m.ZERO,this._boundingSphere.center),this._boundingSphere.radius=m.maximumComponent(s),ae.transform(this._boundingSphere,this._computedModelMatrix,this._boundingSphere));let a=this._material!==this.material;this._material=this.material,this._material.update(n);let c=this.onlySunLighting!==this._onlySunLighting;this._onlySunLighting=this.onlySunLighting;let l=t.useLogDepth,u=this._useLogDepth!==l;this._useLogDepth=l;let d=this._colorCommand,h,_;(a||c||o||u)&&(h=new ze({sources:[JD]}),_=new ze({sources:[this.material.shaderSource,KD]}),this.onlySunLighting&&_.defines.push("ONLY_SUN_LIGHTING"),!i&&n.fragmentDepth&&_.defines.push("WRITE_DEPTH"),this._useLogDepth&&(h.defines.push("LOG_DEPTH"),_.defines.push("LOG_DEPTH"),_.sources.push(Epe)),this._sp=qt.replaceCache({context:n,shaderProgram:this._sp,vertexShaderSource:h,fragmentShaderSource:_,attributeLocations:Aj}),d.vertexArray=this._va,d.renderState=this._rs,d.shaderProgram=this._sp,d.uniformMap=At(this._uniforms,this.material._uniforms),d.executeInClosestFrustum=i);let y=t.commandList,p=t.passes;if(p.render&&(d.boundingVolume=this._boundingSphere,d.debugShowBoundingVolume=this.debugShowBoundingVolume,d.modelMatrix=this._computedModelMatrix,d.pass=i?Te.TRANSLUCENT:Te.OPAQUE,y.push(d)),p.pick){let C=this._pickCommand;(!f(this._pickId)||this._id!==this.id)&&(this._id=this.id,this._pickId=this._pickId&&this._pickId.destroy(),this._pickId=n.createPickId({primitive:this,id:this.id})),(a||c||!f(this._pickSP)||u)&&(h=new ze({sources:[JD]}),_=new ze({sources:[this.material.shaderSource,KD],pickColorQualifier:"uniform"}),this.onlySunLighting&&_.defines.push("ONLY_SUN_LIGHTING"),!i&&n.fragmentDepth&&_.defines.push("WRITE_DEPTH"),this._useLogDepth&&(h.defines.push("LOG_DEPTH"),_.defines.push("LOG_DEPTH"),_.sources.push(Epe)),this._pickSP=qt.replaceCache({context:n,shaderProgram:this._pickSP,vertexShaderSource:h,fragmentShaderSource:_,attributeLocations:Aj}),C.vertexArray=this._va,C.renderState=this._rs,C.shaderProgram=this._pickSP,C.uniformMap=At(At(this._uniforms,this._pickUniforms),this.material._uniforms),C.executeInClosestFrustum=i),C.boundingVolume=this._boundingSphere,C.modelMatrix=this._computedModelMatrix,C.pass=i?Te.TRANSLUCENT:Te.OPAQUE,y.push(C)}};Ok.prototype.isDestroyed=function(){return!1};Ok.prototype.destroy=function(){return this._sp=this._sp&&this._sp.destroy(),this._pickSP=this._pickSP&&this._pickSP.destroy(),this._pickId=this._pickId&&this._pickId.destroy(),ue(this)};var Rk=Ok;var Mk=`varying vec3 v_positionMC;
varying vec3 v_positionEC;
varying vec2 v_st;
void main()
{
czm_materialInput materialInput;
vec3 normalEC = normalize(czm_normal3D * czm_geodeticSurfaceNormal(v_positionMC, vec3(0.0), vec3(1.0)));
#ifdef FACE_FORWARD
normalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);
#endif
materialInput.s = v_st.s;
materialInput.st = v_st;
materialInput.str = vec3(v_st, 0.0);
materialInput.normalEC = normalEC;
materialInput.tangentToEyeMatrix = czm_eastNorthUpToEyeCoordinates(v_positionMC, materialInput.normalEC);
vec3 positionToEyeEC = -v_positionEC;
materialInput.positionToEyeEC = positionToEyeEC;
czm_material material = czm_getMaterial(materialInput);
#ifdef FLAT
gl_FragColor = vec4(material.diffuse + material.emission, material.alpha);
#else
gl_FragColor = czm_phong(normalize(positionToEyeEC), material, czm_lightDirectionEC);
#endif
}
`;var Lk=`attribute vec3 position3DHigh;
attribute vec3 position3DLow;
attribute vec2 st;
attribute float batchId;
varying vec3 v_positionMC;
varying vec3 v_positionEC;
varying vec2 v_st;
void main()
{
vec4 p = czm_computePosition();
v_positionMC = position3DHigh + position3DLow;
v_positionEC = (czm_modelViewRelativeToEye * p).xyz;
v_st = st;
gl_Position = czm_modelViewProjectionRelativeToEye * p;
}
`;function mA(t){t=A(t,A.EMPTY_OBJECT);let n=A(t.translucent,!0),i=A(t.aboveGround,!1);this.material=f(t.material)?t.material:$i.fromType($i.ColorType),this.translucent=A(t.translucent,!0),this._vertexShaderSource=A(t.vertexShaderSource,Lk),this._fragmentShaderSource=A(t.fragmentShaderSource,Mk),this._renderState=Zi.getDefaultRenderState(n,!i,t.renderState),this._closed=!1,this._flat=A(t.flat,!1),this._faceForward=A(t.faceForward,i),this._aboveGround=i}Object.defineProperties(mA.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},vertexFormat:{get:function(){return mA.VERTEX_FORMAT}},flat:{get:function(){return this._flat}},faceForward:{get:function(){return this._faceForward}},aboveGround:{get:function(){return this._aboveGround}}});mA.VERTEX_FORMAT=De.POSITION_AND_ST;mA.prototype.getFragmentShaderSource=Zi.prototype.getFragmentShaderSource;mA.prototype.isTranslucent=Zi.prototype.isTranslucent;mA.prototype.getRenderState=Zi.prototype.getRenderState;var bpe=mA;function Spe(){this.enabled=!0,this.renderable=!0,this.density=2e-4,this.screenSpaceErrorFactor=2,this.minimumBrightness=.03}var Fk=[359.393,800.749,1275.6501,2151.1192,3141.7763,4777.5198,6281.2493,12364.307,15900.765,49889.0549,78026.8259,99260.7344,120036.3873,151011.0158,156091.1953,203849.3112,274866.9803,319916.3149,493552.0528,628733.5874],Gh=[2e-5,2e-4,1e-4,7e-5,5e-5,4e-5,3e-5,19e-6,1e-5,85e-7,62e-7,58e-7,53e-7,52e-7,51e-7,42e-7,4e-6,34e-7,26e-7,22e-7];for(let t=0;t<Gh.length;++t)Gh[t]*=1e6;var wpe=Gh[1],Cj=Gh[Gh.length-1];for(let t=0;t<Gh.length;++t)Gh[t]=(Gh[t]-Cj)/(wpe-Cj);var Ws=0;function not(t){let n=Fk,i=n.length;if(t<n[0])return Ws=0,Ws;if(t>n[i-1])return Ws=i-2,Ws;if(t>=n[Ws]){if(Ws+1<i&&t<n[Ws+1])return Ws;if(Ws+2<i&&t<n[Ws+2])return++Ws,Ws}else if(Ws-1>=0&&t>=n[Ws-1])return--Ws,Ws;let o;for(o=0;o<i-2&&!(t>=n[o]&&t<n[o+1]);++o);return Ws=o,Ws}var iot=new m;Spe.prototype.update=function(t){if(!(t.fog.enabled=this.enabled))return;t.fog.renderable=this.renderable;let i=t.camera,o=i.positionCartographic;if(!f(o)||o.height>8e5||t.mode!==ne.SCENE3D){t.fog.enabled=!1;return}let r=o.height,s=not(r),a=B.clamp((r-Fk[s])/(Fk[s+1]-Fk[s]),0,1),c=B.lerp(Gh[s],Gh[s+1],a),l=this.density*1e6,u=l/wpe*Cj;c=c*(l-u)*1e-6;let d=m.normalize(i.positionWC,iot),h=Math.abs(m.dot(i.directionWC,d));c*=1-h,t.fog.density=c,t.fog.sse=this.screenSpaceErrorFactor,t.fog.minimumBrightness=this.minimumBrightness};var Nk=Spe;function hl(t){this._scene=t.scene,this.samplingWindow=A(t.samplingWindow,hl.defaultSettings.samplingWindow),this.quietPeriod=A(t.quietPeriod,hl.defaultSettings.quietPeriod),this.warmupPeriod=A(t.warmupPeriod,hl.defaultSettings.warmupPeriod),this.minimumFrameRateDuringWarmup=A(t.minimumFrameRateDuringWarmup,hl.defaultSettings.minimumFrameRateDuringWarmup),this.minimumFrameRateAfterWarmup=A(t.minimumFrameRateAfterWarmup,hl.defaultSettings.minimumFrameRateAfterWarmup),this._lowFrameRate=new Ae,this._nominalFrameRate=new Ae,this._frameTimes=[],this._needsQuietPeriod=!0,this._quietPeriodEndTime=0,this._warmupPeriodEndTime=0,this._frameRateIsLow=!1,this._lastFramesPerSecond=void 0,this._pauseCount=0;let n=this;this._preUpdateRemoveListener=this._scene.preUpdate.addEventListener(function(r,s){oot(n,s)}),this._hiddenPropertyName=document.hidden!==void 0?"hidden":document.mozHidden!==void 0?"mozHidden":document.msHidden!==void 0?"msHidden":document.webkitHidden!==void 0?"webkitHidden":void 0;let i=document.hidden!==void 0?"visibilitychange":document.mozHidden!==void 0?"mozvisibilitychange":document.msHidden!==void 0?"msvisibilitychange":document.webkitHidden!==void 0?"webkitvisibilitychange":void 0;function o(){rot(n)}this._visibilityChangeRemoveListener=void 0,f(i)&&(document.addEventListener(i,o,!1),this._visibilityChangeRemoveListener=function(){document.removeEventListener(i,o,!1)})}hl.defaultSettings={samplingWindow:5,quietPeriod:2,warmupPeriod:5,minimumFrameRateDuringWarmup:4,minimumFrameRateAfterWarmup:8};hl.fromScene=function(t){return(!f(t._frameRateMonitor)||t._frameRateMonitor.isDestroyed())&&(t._frameRateMonitor=new hl({scene:t})),t._frameRateMonitor};Object.defineProperties(hl.prototype,{scene:{get:function(){return this._scene}},lowFrameRate:{get:function(){return this._lowFrameRate}},nominalFrameRate:{get:function(){return this._nominalFrameRate}},lastFramesPerSecond:{get:function(){return this._lastFramesPerSecond}}});hl.prototype.pause=function(){++this._pauseCount,this._pauseCount===1&&(this._frameTimes.length=0,this._lastFramesPerSecond=void 0)};hl.prototype.unpause=function(){--this._pauseCount,this._pauseCount<=0&&(this._pauseCount=0,this._needsQuietPeriod=!0)};hl.prototype.isDestroyed=function(){return!1};hl.prototype.destroy=function(){return this._preUpdateRemoveListener(),f(this._visibilityChangeRemoveListener)&&this._visibilityChangeRemoveListener(),ue(this)};function oot(t,n){if(t._pauseCount>0)return;let i=Fi();if(t._needsQuietPeriod)t._needsQuietPeriod=!1,t._frameTimes.length=0,t._quietPeriodEndTime=i+t.quietPeriod/Yn.SECONDS_PER_MILLISECOND,t._warmupPeriodEndTime=t._quietPeriodEndTime+(t.warmupPeriod+t.samplingWindow)/Yn.SECONDS_PER_MILLISECOND;else if(i>=t._quietPeriodEndTime){t._frameTimes.push(i);let o=i-t.samplingWindow/Yn.SECONDS_PER_MILLISECOND;if(t._frameTimes.length>=2&&t._frameTimes[0]<=o){for(;t._frameTimes.length>=2&&t._frameTimes[1]<o;)t._frameTimes.shift();let r=(i-t._frameTimes[0])/(t._frameTimes.length-1);t._lastFramesPerSecond=1e3/r;let s=1e3/(i>t._warmupPeriodEndTime?t.minimumFrameRateAfterWarmup:t.minimumFrameRateDuringWarmup);r>s?t._frameRateIsLow||(t._frameRateIsLow=!0,t._needsQuietPeriod=!0,t.lowFrameRate.raiseEvent(t.scene,t._lastFramesPerSecond)):t._frameRateIsLow&&(t._frameRateIsLow=!1,t._needsQuietPeriod=!0,t.nominalFrameRate.raiseEvent(t.scene,t._lastFramesPerSecond))}}}function rot(t){document[t._hiddenPropertyName]?t.pause():t.unpause()}var Vk=hl;function sot(t,n,i){this.context=t,this.commandList=[],this.shadowMaps=[],this.brdfLutGenerator=void 0,this.environmentMap=void 0,this.sphericalHarmonicCoefficients=void 0,this.specularEnvironmentMaps=void 0,this.specularEnvironmentMapsMaximumLOD=void 0,this.mode=ne.SCENE3D,this.morphTime=ne.getMorphTime(ne.SCENE3D),this.frameNumber=0,this.newFrame=!1,this.time=void 0,this.jobScheduler=i,this.mapProjection=void 0,this.camera=void 0,this.cameraUnderground=!1,this.globeTranslucencyState=void 0,this.cullingVolume=void 0,this.occluder=void 0,this.maximumScreenSpaceError=void 0,this.pixelRatio=1,this.passes={render:!1,pick:!1,depth:!1,postProcess:!1,offscreen:!1},this.creditDisplay=n,this.afterRender=[],this.scene3DOnly=!1,this.fog={enabled:!1,density:void 0,sse:void 0,minimumBrightness:void 0},this.terrainExaggeration=1,this.terrainExaggerationRelativeHeight=0,this.shadowState={shadowsEnabled:!0,shadowMaps:[],lightShadowMaps:[],nearPlane:1,farPlane:5e3,closestObjectSize:1e3,lastDirtyTime:0,outOfView:!0},this.splitPosition=0,this.frustumSplits=[],this.backgroundColor=void 0,this.light=void 0,this.minimumDisableDepthTestDistance=void 0,this.invertClassification=!1,this.invertClassificationColor=void 0,this.useLogDepth=!1,this.tilesetPassState=void 0,this.minimumTerrainHeight=0}var kk=sot;function aot(t,n){this.near=A(t,0),this.far=A(n,0);let i=Te.NUMBER_OF_PASSES,o=new Array(i),r=new Array(i);for(let s=0;s<i;++s)o[s]=[],r[s]=0;this.commands=o,this.indices=r}var Uk=aot;function cot(t,n,i){return`    float clipDistance = clip(gl_FragCoord, ${t}, ${n}); 
    vec4 clippingPlanesEdgeColor = vec4(1.0); 
    clippingPlanesEdgeColor.rgb = ${i}.rgb; 
    float clippingPlanesEdgeWidth = ${i}.a; 
    if (clipDistance > 0.0 && clipDistance < clippingPlanesEdgeWidth) 
    { 
        gl_FragColor = clippingPlanesEdgeColor;
    } 
`}var zk=cot;var lot=new W;function uot(t,n){let i=t.unionClippingRegions,o=t.length,r=Qs.useFloatTexture(n),s=Qs.getTextureResolution(t,n,lot),a=s.x,c=s.y,l=r?hot(a,c):mot(a,c);return l+=`
`,l+=i?fot(o):dot(o),l}function fot(t){return`float clip(vec4 fragCoord, sampler2D clippingPlanes, mat4 clippingPlanesMatrix)
{
    vec4 position = czm_windowToEyeCoordinates(fragCoord);
    vec3 clipNormal = vec3(0.0);
    vec3 clipPosition = vec3(0.0);
    float clipAmount;
    float pixelWidth = czm_metersPerPixel(position);
    bool breakAndDiscard = false;
    for (int i = 0; i < ${t}; ++i)
    {
        vec4 clippingPlane = getClippingPlane(clippingPlanes, i, clippingPlanesMatrix);
        clipNormal = clippingPlane.xyz;
        clipPosition = -clippingPlane.w * clipNormal;
        float amount = dot(clipNormal, (position.xyz - clipPosition)) / pixelWidth;
        clipAmount = czm_branchFreeTernary(i == 0, amount, min(amount, clipAmount));
        if (amount <= 0.0)
        {
           breakAndDiscard = true;
           break;
        }
    }
    if (breakAndDiscard) {
        discard;
    }
    return clipAmount;
}
`}function dot(t){return`float clip(vec4 fragCoord, sampler2D clippingPlanes, mat4 clippingPlanesMatrix)
{
    bool clipped = true;
    vec4 position = czm_windowToEyeCoordinates(fragCoord);
    vec3 clipNormal = vec3(0.0);
    vec3 clipPosition = vec3(0.0);
    float clipAmount = 0.0;
    float pixelWidth = czm_metersPerPixel(position);
    for (int i = 0; i < ${t}; ++i)
    {
        vec4 clippingPlane = getClippingPlane(clippingPlanes, i, clippingPlanesMatrix);
        clipNormal = clippingPlane.xyz;
        clipPosition = -clippingPlane.w * clipNormal;
        float amount = dot(clipNormal, (position.xyz - clipPosition)) / pixelWidth;
        clipAmount = max(amount, clipAmount);
        clipped = clipped && (amount <= 0.0);
    }
    if (clipped)
    {
        discard;
    }
    return clipAmount;
}
`}function hot(t,n){let i=1/t,o=1/n,r=`${i}`;r.indexOf(".")===-1&&(r+=".0");let s=`${o}`;return s.indexOf(".")===-1&&(s+=".0"),`vec4 getClippingPlane(highp sampler2D packedClippingPlanes, int clippingPlaneNumber, mat4 transform)
{
    int pixY = clippingPlaneNumber / ${t};
    int pixX = clippingPlaneNumber - (pixY * ${t});
    float u = (float(pixX) + 0.5) * ${r};
    float v = (float(pixY) + 0.5) * ${s};
    vec4 plane = texture2D(packedClippingPlanes, vec2(u, v));
    return czm_transformPlane(plane, transform);
}
`}function mot(t,n){let i=1/t,o=1/n,r=`${i}`;r.indexOf(".")===-1&&(r+=".0");let s=`${o}`;return s.indexOf(".")===-1&&(s+=".0"),`vec4 getClippingPlane(highp sampler2D packedClippingPlanes, int clippingPlaneNumber, mat4 transform)
{
    int clippingPlaneStartIndex = clippingPlaneNumber * 2;
    int pixY = clippingPlaneStartIndex / ${t};
    int pixX = clippingPlaneStartIndex - (pixY * ${t});
    float u = (float(pixX) + 0.5) * ${r};
    float v = (float(pixY) + 0.5) * ${s};
    vec4 oct32 = texture2D(packedClippingPlanes, vec2(u, v)) * 255.0;
    vec2 oct = vec2(oct32.x * 256.0 + oct32.y, oct32.z * 256.0 + oct32.w);
    vec4 plane;
    plane.xyz = czm_octDecode(oct, 65535.0);
    plane.w = czm_unpackFloat(texture2D(packedClippingPlanes, vec2(u + ${r}, v)));
    return czm_transformPlane(plane, transform);
}
`}var zE=uot;function pot(t,n,i,o,r){this.numberOfDayTextures=t,this.flags=n,this.material=i,this.shaderProgram=o,this.clippingShaderState=r}function xj(){this.baseVertexShaderSource=void 0,this.baseFragmentShaderSource=void 0,this._shadersByTexturesFlags=[],this.material=void 0}function _ot(t){let n="vec4 getPosition(vec3 position, float height, vec2 textureCoordinates) { return getPosition3DMode(position, height, textureCoordinates); }",i="vec4 getPosition(vec3 position, float height, vec2 textureCoordinates) { return getPositionColumbusViewMode(position, height, textureCoordinates); }",o="vec4 getPosition(vec3 position, float height, vec2 textureCoordinates) { return getPositionMorphingMode(position, height, textureCoordinates); }",r;switch(t){case ne.SCENE3D:r=n;break;case ne.SCENE2D:case ne.COLUMBUS_VIEW:r=i;break;case ne.MORPHING:r=o;break}return r}function got(t){return t?"float get2DYPositionFraction(vec2 textureCoordinates) { return get2DMercatorYPositionFraction(textureCoordinates); }":"float get2DYPositionFraction(vec2 textureCoordinates) { return get2DGeographicYPositionFraction(textureCoordinates); }"}xj.prototype.getShaderProgram=function(t){let n=t.frameState,i=t.surfaceTile,o=t.numberOfDayTextures,r=t.applyBrightness,s=t.applyContrast,a=t.applyHue,c=t.applySaturation,l=t.applyGamma,u=t.applyAlpha,d=t.applyDayNightAlpha,h=t.applySplit,_=t.showReflectiveOcean,y=t.showOceanWaves,p=t.enableLighting,C=t.dynamicAtmosphereLighting,x=t.dynamicAtmosphereLightingFromSun,T=t.showGroundAtmosphere,E=t.perFragmentGroundAtmosphere,S=t.hasVertexNormals,w=t.useWebMercatorProjection,D=t.enableFog,I=t.enableClippingPlanes,O=t.clippingPlanes,M=t.clippedByBoundaries,L=t.hasImageryLayerCutout,F=t.colorCorrect,g=t.highlightFillTile,b=t.colorToAlpha,v=t.hasGeodeticSurfaceNormals,P=t.hasExaggeration,R=t.showUndergroundColor,V=t.translucent,H=0,U="",k=i.renderedMesh.encoding;k.quantization===Hs.BITS12&&(H=1,U="QUANTIZATION_BITS12");let Y=0,K="";M&&(Y=1,K="TILE_LIMIT_RECTANGLE");let j=0,Z="";L&&(j=1,Z="APPLY_IMAGERY_CUTOUT");let Q=n.mode,me=Q|r<<2|s<<3|a<<4|c<<5|l<<6|u<<7|_<<8|y<<9|p<<10|C<<11|x<<12|T<<13|E<<14|S<<15|w<<16|D<<17|H<<18|h<<19|I<<20|Y<<21|j<<22|F<<23|g<<24|b<<25|v<<26|P<<27|R<<28|V<<29|d<<30,_e=0;f(O)&&O.length>0&&(_e=I?O.clippingPlanesState:0);let re=i.surfaceShader;if(f(re)&&re.numberOfDayTextures===o&&re.flags===me&&re.material===this.material&&re.clippingShaderState===_e)return re.shaderProgram;let fe=this._shadersByTexturesFlags[o];if(f(fe)||(fe=this._shadersByTexturesFlags[o]=[]),re=fe[me],!f(re)||re.material!==this.material||re.clippingShaderState!==_e){let ge=this.baseVertexShaderSource.clone(),be=this.baseFragmentShaderSource.clone();_e!==0&&be.sources.unshift(zE(O,n.context)),ge.defines.push(U),be.defines.push(`TEXTURE_UNITS ${o}`,K,Z),r&&be.defines.push("APPLY_BRIGHTNESS"),s&&be.defines.push("APPLY_CONTRAST"),a&&be.defines.push("APPLY_HUE"),c&&be.defines.push("APPLY_SATURATION"),l&&be.defines.push("APPLY_GAMMA"),u&&be.defines.push("APPLY_ALPHA"),d&&be.defines.push("APPLY_DAY_NIGHT_ALPHA"),_&&(be.defines.push("SHOW_REFLECTIVE_OCEAN"),ge.defines.push("SHOW_REFLECTIVE_OCEAN")),y&&be.defines.push("SHOW_OCEAN_WAVES"),b&&be.defines.push("APPLY_COLOR_TO_ALPHA"),R&&(ge.defines.push("UNDERGROUND_COLOR"),be.defines.push("UNDERGROUND_COLOR")),V&&(ge.defines.push("TRANSLUCENT"),be.defines.push("TRANSLUCENT")),p&&(S?(ge.defines.push("ENABLE_VERTEX_LIGHTING"),be.defines.push("ENABLE_VERTEX_LIGHTING")):(ge.defines.push("ENABLE_DAYNIGHT_SHADING"),be.defines.push("ENABLE_DAYNIGHT_SHADING"))),C&&(ge.defines.push("DYNAMIC_ATMOSPHERE_LIGHTING"),be.defines.push("DYNAMIC_ATMOSPHERE_LIGHTING"),x&&(ge.defines.push("DYNAMIC_ATMOSPHERE_LIGHTING_FROM_SUN"),be.defines.push("DYNAMIC_ATMOSPHERE_LIGHTING_FROM_SUN"))),T&&(ge.defines.push("GROUND_ATMOSPHERE"),be.defines.push("GROUND_ATMOSPHERE"),E&&(ge.defines.push("PER_FRAGMENT_GROUND_ATMOSPHERE"),be.defines.push("PER_FRAGMENT_GROUND_ATMOSPHERE"))),ge.defines.push("INCLUDE_WEB_MERCATOR_Y"),be.defines.push("INCLUDE_WEB_MERCATOR_Y"),D&&(ge.defines.push("FOG"),be.defines.push("FOG")),h&&be.defines.push("APPLY_SPLIT"),I&&be.defines.push("ENABLE_CLIPPING_PLANES"),F&&be.defines.push("COLOR_CORRECT"),g&&be.defines.push("HIGHLIGHT_FILL_TILE"),v&&ge.defines.push("GEODETIC_SURFACE_NORMALS"),P&&ge.defines.push("EXAGGERATION");let Be=`    vec4 computeDayColor(vec4 initialColor, vec3 textureCoordinates, float nightBlend)
    {
        vec4 color = initialColor;
`;L&&(Be+=`        vec4 cutoutAndColorResult;
        bool texelUnclipped;
`);for(let qe=0;qe<o;++qe)L?Be+=`        cutoutAndColorResult = u_dayTextureCutoutRectangles[${qe}];
        texelUnclipped = v_textureCoordinates.x < cutoutAndColorResult.x || cutoutAndColorResult.z < v_textureCoordinates.x || v_textureCoordinates.y < cutoutAndColorResult.y || cutoutAndColorResult.w < v_textureCoordinates.y;
        cutoutAndColorResult = sampleAndBlend(
`:Be+=`        color = sampleAndBlend(
`,Be+=`            color,
            u_dayTextures[${qe}],
            u_dayTextureUseWebMercatorT[${qe}] ? textureCoordinates.xz : textureCoordinates.xy,
            u_dayTextureTexCoordsRectangle[${qe}],
            u_dayTextureTranslationAndScale[${qe}],
            ${u?`u_dayTextureAlpha[${qe}]`:"1.0"},
            ${d?`u_dayTextureNightAlpha[${qe}]`:"1.0"},
${d?`u_dayTextureDayAlpha[${qe}]`:"1.0"},
${r?`u_dayTextureBrightness[${qe}]`:"0.0"},
            ${s?`u_dayTextureContrast[${qe}]`:"0.0"},
            ${a?`u_dayTextureHue[${qe}]`:"0.0"},
            ${c?`u_dayTextureSaturation[${qe}]`:"0.0"},
            ${l?`u_dayTextureOneOverGamma[${qe}]`:"0.0"},
            ${h?`u_dayTextureSplit[${qe}]`:"0.0"},
            ${b?`u_colorsToAlpha[${qe}]`:"vec4(0.0)"},
        nightBlend        );
`,L&&(Be+=`        color = czm_branchFreeTernary(texelUnclipped, cutoutAndColorResult, color);
`);Be+=`        return color;
    }`,be.sources.push(Be),ge.sources.push(_ot(Q)),ge.sources.push(got(w));let ke=qt.fromCache({context:n.context,vertexShaderSource:ge,fragmentShaderSource:be,attributeLocations:k.getAttributeLocations()});re=fe[me]=new pot(o,me,this.material,ke,_e)}return i.surfaceShader=re,re.shaderProgram};xj.prototype.destroy=function(){let t,n,i=this._shadersByTexturesFlags;for(let o in i)if(i.hasOwnProperty(o)){let r=i[o];if(!f(r))continue;for(t in r)r.hasOwnProperty(t)&&(n=r[t],f(n)&&n.shaderProgram.destroy())}return ue(this)};var Hk=xj;var yot={UNLOADED:0,TRANSITIONING:1,RECEIVED:2,TEXTURE_LOADED:3,READY:4,FAILED:5,INVALID:6,PLACEHOLDER:7},ii=Object.freeze(yot);var Aot={START:0,LOADING:1,DONE:2,FAILED:3},js=Object.freeze(Aot);var Cot={FAILED:0,UNLOADED:1,RECEIVING:2,RECEIVED:3,TRANSFORMING:4,TRANSFORMED:5,READY:6},_o=Object.freeze(Cot);function zo(){this.imagery=[],this.waterMaskTexture=void 0,this.waterMaskTranslationAndScale=new se(0,0,1,1),this.terrainData=void 0,this.vertexArray=void 0,this.tileBoundingRegion=void 0,this.occludeePointInScaledSpace=new m,this.boundingVolumeSourceTile=void 0,this.boundingVolumeIsFromMesh=!1,this.terrainState=_o.UNLOADED,this.mesh=void 0,this.fill=void 0,this.pickBoundingSphere=new ae,this.surfaceShader=void 0,this.isClipped=!0,this.clippedByBoundaries=!1}Object.defineProperties(zo.prototype,{eligibleForUnloading:{get:function(){let t=this.terrainState,i=!(t===_o.RECEIVING||t===_o.TRANSFORMING),o=this.imagery;for(let r=0,s=o.length;i&&r<s;++r){let a=o[r];i=!f(a.loadingImagery)||a.loadingImagery.state!==ii.TRANSITIONING}return i}},renderedMesh:{get:function(){if(f(this.vertexArray))return this.mesh;if(f(this.fill))return this.fill.mesh}}});var xot=new de;function Tj(t,n,i,o,r,s){let a=t.getExaggeratedPosition(o,r,s);if(f(n)&&n!==ne.SCENE3D){let l=i.ellipsoid.cartesianToCartographic(a,xot);a=i.project(l,s),a=m.fromElements(a.z,a.x,a.y,s)}return a}var Tot=new m,Eot=new m,bot=new m;zo.prototype.pick=function(t,n,i,o,r){let s=this.renderedMesh;if(!f(s))return;let a=s.vertices,c=s.indices,l=s.encoding,u=c.length,d=Number.MAX_VALUE;for(let h=0;h<u;h+=3){let _=c[h],y=c[h+1],p=c[h+2],C=Tj(l,n,i,a,_,Tot),x=Tj(l,n,i,a,y,Eot),T=Tj(l,n,i,a,p,bot),E=ji.rayTriangleParametric(t,C,x,T,o);f(E)&&E<d&&E>=0&&(d=E)}return d!==Number.MAX_VALUE?dn.getPoint(t,d,r):void 0};zo.prototype.freeResources=function(){f(this.waterMaskTexture)&&(--this.waterMaskTexture.referenceCount,this.waterMaskTexture.referenceCount===0&&this.waterMaskTexture.destroy(),this.waterMaskTexture=void 0),this.terrainData=void 0,this.terrainState=_o.UNLOADED,this.mesh=void 0,this.fill=this.fill&&this.fill.destroy();let t=this.imagery;for(let n=0,i=t.length;n<i;++n)t[n].freeResources();this.imagery.length=0,this.freeVertexArray()};zo.prototype.freeVertexArray=function(){zo._freeVertexArray(this.vertexArray),this.vertexArray=void 0,zo._freeVertexArray(this.wireframeVertexArray),this.wireframeVertexArray=void 0};zo.initialize=function(t,n,i){let o=t.data;f(o)||(o=t.data=new zo),t.state===js.START&&(Sot(t,n,i),t.state=js.LOADING)};zo.processStateMachine=function(t,n,i,o,r,s,a){zo.initialize(t,i,o);let c=t.data;if(t.state===js.LOADING&&wot(t,n,i,o,r,s),a)return;let l=t.renderable;t.renderable=f(c.vertexArray);let u=c.terrainState===_o.READY;t.upsampledFromParent=f(c.terrainData)&&c.terrainData.wasCreatedByUpsampling();let d=c.processImagery(t,i,n);if(u&&d){let h=t._loadedCallbacks,_={};for(let y in h)h.hasOwnProperty(y)&&(h[y](t)||(_[y]=h[y]));t._loadedCallbacks=_,t.state=js.DONE}l&&(t.renderable=!0)};zo.prototype.processImagery=function(t,n,i,o){let r=t.data,s=t.upsampledFromParent,a=!1,c=!0,l=r.imagery,u,d;for(u=0,d=l.length;u<d;++u){let h=l[u];if(!f(h.loadingImagery)){s=!1;continue}if(h.loadingImagery.state===ii.PLACEHOLDER){let y=h.loadingImagery.imageryLayer;if(y.imageryProvider.ready){h.freeResources(),l.splice(u,1),y._createTileImagerySkeletons(t,n,u),--u,d=l.length;continue}else s=!1}let _=h.processStateMachine(t,i,o);c=c&&_,a=a||_||f(h.readyImagery),s=s&&f(h.loadingImagery)&&(h.loadingImagery.state===ii.FAILED||h.loadingImagery.state===ii.INVALID)}return t.upsampledFromParent=s,t.renderable=t.renderable&&(a||c),c};function Dpe(t,n,i,o){let r=t.renderedMesh,s=r.vertices,a=r.encoding,c=s.length/a.stride,l=Tc.clone(a);l.hasGeodeticSurfaceNormals=n,l=Tc.clone(l);let u=l.stride,d=new Float32Array(c*u);n?a.addGeodeticSurfaceNormals(s,d,i):a.removeGeodeticSurfaceNormals(s,d),r.vertices=d,r.stride=u,r!==t.mesh?(zo._freeVertexArray(t.fill.vertexArray),t.fill.vertexArray=zo._createVertexArrayForMesh(o.context,r)):(zo._freeVertexArray(t.vertexArray),t.vertexArray=zo._createVertexArrayForMesh(o.context,r)),zo._freeVertexArray(t.wireframeVertexArray),t.wireframeVertexArray=void 0}zo.prototype.addGeodeticSurfaceNormals=function(t,n){Dpe(this,!0,t,n)};zo.prototype.removeGeodeticSurfaceNormals=function(t){Dpe(this,!1,void 0,t)};zo.prototype.updateExaggeration=function(t,n,i){let o=this,r=o.renderedMesh;if(r===void 0)return;let s=n.terrainExaggeration,a=n.terrainExaggerationRelativeHeight,c=s!==1,l=r.encoding,u=l.exaggeration!==s,d=l.exaggerationRelativeHeight!==a;if(u||d){if(u)if(c&&!l.hasGeodeticSurfaceNormals){let h=t.tilingScheme.ellipsoid;o.addGeodeticSurfaceNormals(h,n)}else!c&&l.hasGeodeticSurfaceNormals&&o.removeGeodeticSurfaceNormals(n);if(l.exaggeration=s,l.exaggerationRelativeHeight=a,i!==void 0){i._tileToUpdateHeights.push(t);let h=t.customData,_=h.length;for(let y=0;y<_;y++){let p=h[y];p.level=-1}}}};function Sot(t,n,i){let o=n.getTileDataAvailable(t.x,t.y,t.level);if(!f(o)&&f(t.parent)){let r=t.parent,s=r.data;f(s)&&f(s.terrainData)&&(o=s.terrainData.isChildAvailable(r.x,r.y,t.x,t.y))}o===!1&&(t.data.terrainState=_o.FAILED);for(let r=0,s=i.length;r<s;++r){let a=i.get(r);a.show&&a._createTileImagerySkeletons(t,n)}}function wot(t,n,i,o,r,s){let a=t.data,c=t.parent;if(a.terrainState===_o.FAILED&&c!==void 0&&(c.data!==void 0&&c.data.terrainData!==void 0&&c.data.terrainData.canUpsample!==!1||zo.processStateMachine(c,n,i,o,r,s,!0)),a.terrainState===_o.FAILED&&Dot(a,t,n,i,t.x,t.y,t.level),a.terrainState===_o.UNLOADED&&vot(a,i,t.x,t.y,t.level),a.terrainState===_o.RECEIVED&&Iot(a,n,i,t.x,t.y,t.level),a.terrainState===_o.TRANSFORMED&&(Bot(a,n.context,i,t.x,t.y,t.level,s),a.updateExaggeration(t,n,r)),a.terrainState>=_o.RECEIVED&&a.waterMaskTexture===void 0&&i.hasWaterMask)if(a.terrainData.waterMask!==void 0)Rot(n.context,a);else{let u=a._findAncestorTileWithTerrainData(t);f(u)&&f(u.data.waterMaskTexture)&&(a.waterMaskTexture=u.data.waterMaskTexture,++a.waterMaskTexture.referenceCount,a._computeWaterMaskTranslationAndScale(t,u,a.waterMaskTranslationAndScale))}}function Dot(t,n,i,o,r,s,a){let c=n.parent;if(!c){n.state=js.FAILED;return}let l=c.data.terrainData,u=c.x,d=c.y,h=c.level;if(!f(l))return;let _=l.upsample(o.tilingScheme,u,d,h,r,s,a);!f(_)||(t.terrainState=_o.RECEIVING,Promise.resolve(_).then(function(y){t.terrainData=y,t.terrainState=_o.RECEIVED}).catch(function(){t.terrainState=_o.FAILED}))}function vot(t,n,i,o,r){function s(l){t.terrainData=l,t.terrainState=_o.RECEIVED,t.request=void 0}function a(l){if(t.request.state===ai.CANCELLED){t.terrainData=void 0,t.terrainState=_o.UNLOADED,t.request=void 0;return}t.terrainState=_o.FAILED,t.request=void 0;let u=`Failed to obtain terrain tile X: ${i} Y: ${o} Level: ${r}. Error message: "${l}"`;n._requestError=qn.reportError(n._requestError,n,n.errorEvent,u,i,o,r),n._requestError.retry&&c()}function c(){let l=new qo({throttle:!1,throttleByServer:!0,type:Qr.TERRAIN});t.request=l;let u=n.requestTileGeometry(i,o,r,l);f(u)?(t.terrainState=_o.RECEIVING,Promise.resolve(u).then(function(d){s(d)}).catch(function(d){a(d)})):(t.terrainState=_o.UNLOADED,t.request=void 0)}c()}var Pot={tilingScheme:void 0,x:0,y:0,level:0,exaggeration:1,exaggerationRelativeHeight:0,throttle:!0};function Iot(t,n,i,o,r,s){let a=i.tilingScheme,c=Pot;c.tilingScheme=a,c.x=o,c.y=r,c.level=s,c.exaggeration=n.terrainExaggeration,c.exaggerationRelativeHeight=n.terrainExaggerationRelativeHeight,c.throttle=!0;let u=t.terrainData.createMesh(c);!f(u)||(t.terrainState=_o.TRANSFORMING,Promise.resolve(u).then(function(d){t.mesh=d,t.terrainState=_o.TRANSFORMED}).catch(function(){t.terrainState=_o.FAILED}))}zo._createVertexArrayForMesh=function(t,n){let i=n.vertices,o=ut.createVertexBuffer({context:t,typedArray:i,usage:Fe.STATIC_DRAW}),r=n.encoding.getAttributes(o),s=n.indices.indexBuffers||{},a=s[t.id];if(!f(a)||a.isDestroyed()){let c=n.indices;a=ut.createIndexBuffer({context:t,typedArray:c,usage:Fe.STATIC_DRAW,indexDatatype:Ne.fromSizeInBytes(c.BYTES_PER_ELEMENT)}),a.vertexArrayDestroyable=!1,a.referenceCount=1,s[t.id]=a,n.indices.indexBuffers=s}else++a.referenceCount;return new $n({context:t,attributes:r,indexBuffer:a})};zo._freeVertexArray=function(t){if(f(t)){let n=t.indexBuffer;t.isDestroyed()||t.destroy(),f(n)&&!n.isDestroyed()&&f(n.referenceCount)&&(--n.referenceCount,n.referenceCount===0&&n.destroy())}};function Bot(t,n,i,o,r,s,a){t.vertexArray=zo._createVertexArrayForMesh(n,t.mesh),t.terrainState=_o.READY,t.fill=t.fill&&t.fill.destroy(a)}function Oot(t){let n=t.cache.tile_waterMaskData;if(!f(n)){let i=St.create({context:t,pixelFormat:st.LUMINANCE,pixelDatatype:je.UNSIGNED_BYTE,source:{arrayBufferView:new Uint8Array([255]),width:1,height:1}});i.referenceCount=1;let o=new pn({wrapS:Mn.CLAMP_TO_EDGE,wrapT:Mn.CLAMP_TO_EDGE,minificationFilter:fn.LINEAR,magnificationFilter:Qi.LINEAR});n={allWaterTexture:i,sampler:o,destroy:function(){this.allWaterTexture.destroy()}},t.cache.tile_waterMaskData=n}return n}function Rot(t,n){let i=n.terrainData.waterMask,o=Oot(t),r,s=i.length;if(s===1)if(i[0]!==0)r=o.allWaterTexture;else return;else{let a=Math.sqrt(s);r=St.create({context:t,pixelFormat:st.LUMINANCE,pixelDatatype:je.UNSIGNED_BYTE,source:{width:a,height:a,arrayBufferView:i},sampler:o.sampler,flipY:!1}),r.referenceCount=0}++r.referenceCount,n.waterMaskTexture=r,se.fromElements(0,0,1,1,n.waterMaskTranslationAndScale)}zo.prototype._findAncestorTileWithTerrainData=function(t){let n=t.parent;for(;f(n)&&(!f(n.data)||!f(n.data.terrainData)||n.data.terrainData.wasCreatedByUpsampling());)n=n.parent;return n};zo.prototype._computeWaterMaskTranslationAndScale=function(t,n,i){let o=n.rectangle,r=t.rectangle,s=r.width,a=r.height,c=s/o.width,l=a/o.height;return i.x=c*(r.west-o.west)/s,i.y=l*(r.south-o.south)/a,i.z=c,i.w=l,i};var Td=zo;function HE(t,n,i,o,r){if(this.imageryLayer=t,this.x=n,this.y=i,this.level=o,this.request=void 0,o!==0){let s=n/2|0,a=i/2|0,c=o-1;this.parent=t.getImageryFromCache(s,a,c)}this.state=ii.UNLOADED,this.imageUrl=void 0,this.image=void 0,this.texture=void 0,this.textureWebMercator=void 0,this.credits=void 0,this.referenceCount=0,!f(r)&&t.imageryProvider.ready&&(r=t.imageryProvider.tilingScheme.tileXYToRectangle(n,i,o)),this.rectangle=r}HE.createPlaceholder=function(t){let n=new HE(t,0,0,0);return n.addReference(),n.state=ii.PLACEHOLDER,n};HE.prototype.addReference=function(){++this.referenceCount};HE.prototype.releaseReference=function(){return--this.referenceCount,this.referenceCount===0?(this.imageryLayer.removeImageryFromCache(this),f(this.parent)&&this.parent.releaseReference(),f(this.image)&&f(this.image.destroy)&&this.image.destroy(),f(this.texture)&&this.texture.destroy(),f(this.textureWebMercator)&&this.texture!==this.textureWebMercator&&this.textureWebMercator.destroy(),ue(this),0):this.referenceCount};HE.prototype.processStateMachine=function(t,n,i){this.state===ii.UNLOADED&&!i&&(this.state=ii.TRANSITIONING,this.imageryLayer._requestImagery(this)),this.state===ii.RECEIVED&&(this.state=ii.TRANSITIONING,this.imageryLayer._createTexture(t.context,this));let o=this.state===ii.READY&&n&&!this.texture;(this.state===ii.TEXTURE_LOADED||o)&&(this.state=ii.TRANSITIONING,this.imageryLayer._reprojectTexture(t,this,n))};var yv=HE;function Ej(t,n,i){this.readyImagery=void 0,this.loadingImagery=t,this.textureCoordinateRectangle=n,this.textureTranslationAndScale=void 0,this.useWebMercatorT=i}Ej.prototype.freeResources=function(){f(this.readyImagery)&&this.readyImagery.releaseReference(),f(this.loadingImagery)&&this.loadingImagery.releaseReference()};Ej.prototype.processStateMachine=function(t,n,i){let o=this.loadingImagery,r=o.imageryLayer;if(o.processStateMachine(n,!this.useWebMercatorT,i),o.state===ii.READY)return f(this.readyImagery)&&this.readyImagery.releaseReference(),this.readyImagery=this.loadingImagery,this.loadingImagery=void 0,this.textureTranslationAndScale=r._calculateTextureTranslationAndScale(t,this),!0;let s=o.parent,a;for(;f(s)&&(s.state!==ii.READY||!this.useWebMercatorT&&!f(s.texture));)s.state!==ii.FAILED&&s.state!==ii.INVALID&&(a=a||s),s=s.parent;return this.readyImagery!==s&&(f(this.readyImagery)&&this.readyImagery.releaseReference(),this.readyImagery=s,f(s)&&(s.addReference(),this.textureTranslationAndScale=r._calculateTextureTranslationAndScale(t,this))),o.state===ii.FAILED||o.state===ii.INVALID?f(a)?(a.processStateMachine(n,!this.useWebMercatorT,i),!1):!0:!1};var Av=Ej;function Oi(t,n){this._imageryProvider=t,n=A(n,A.EMPTY_OBJECT),this.alpha=A(n.alpha,A(t.defaultAlpha,1)),this.nightAlpha=A(n.nightAlpha,A(t.defaultNightAlpha,1)),this.dayAlpha=A(n.dayAlpha,A(t.defaultDayAlpha,1)),this.brightness=A(n.brightness,A(t.defaultBrightness,Oi.DEFAULT_BRIGHTNESS)),this.contrast=A(n.contrast,A(t.defaultContrast,Oi.DEFAULT_CONTRAST)),this.hue=A(n.hue,A(t.defaultHue,Oi.DEFAULT_HUE)),this.saturation=A(n.saturation,A(t.defaultSaturation,Oi.DEFAULT_SATURATION)),this.gamma=A(n.gamma,A(t.defaultGamma,Oi.DEFAULT_GAMMA)),this.splitDirection=A(n.splitDirection,A(t.defaultSplit,Oi.DEFAULT_SPLIT)),this.minificationFilter=A(n.minificationFilter,A(t.defaultMinificationFilter,Oi.DEFAULT_MINIFICATION_FILTER)),this.magnificationFilter=A(n.magnificationFilter,A(t.defaultMagnificationFilter,Oi.DEFAULT_MAGNIFICATION_FILTER)),this.show=A(n.show,!0),this._minimumTerrainLevel=n.minimumTerrainLevel,this._maximumTerrainLevel=n.maximumTerrainLevel,this._rectangle=A(n.rectangle,le.MAX_VALUE),this._maximumAnisotropy=n.maximumAnisotropy,this._imageryCache={},this._skeletonPlaceholder=new Av(yv.createPlaceholder(this)),this._show=!0,this._layerIndex=-1,this._isBaseLayer=!1,this._requestImageError=void 0,this._reprojectComputeCommands=[],this.cutoutRectangle=n.cutoutRectangle,this.colorToAlpha=n.colorToAlpha,this.colorToAlphaThreshold=A(n.colorToAlphaThreshold,Oi.DEFAULT_APPLY_COLOR_TO_ALPHA_THRESHOLD)}Object.defineProperties(Oi.prototype,{imageryProvider:{get:function(){return this._imageryProvider}},rectangle:{get:function(){return this._rectangle}}});Oi.DEFAULT_BRIGHTNESS=1;Oi.DEFAULT_CONTRAST=1;Oi.DEFAULT_HUE=0;Oi.DEFAULT_SATURATION=1;Oi.DEFAULT_GAMMA=1;Oi.DEFAULT_SPLIT=Wc.NONE;Oi.DEFAULT_MINIFICATION_FILTER=fn.LINEAR;Oi.DEFAULT_MAGNIFICATION_FILTER=Qi.LINEAR;Oi.DEFAULT_APPLY_COLOR_TO_ALPHA_THRESHOLD=.004;Oi.prototype.isBaseLayer=function(){return this._isBaseLayer};Oi.prototype.isDestroyed=function(){return!1};Oi.prototype.destroy=function(){return ue(this)};var Ipe=new le,vpe=new le,bj=new le,Bpe=new le;Oi.prototype.getViewableRectangle=function(){let t=this._imageryProvider,n=this._rectangle;return t.readyPromise.then(function(){return le.intersection(t.rectangle,n)})};Oi.prototype._createTileImagerySkeletons=function(t,n,i){let o=t.data;if(f(this._minimumTerrainLevel)&&t.level<this._minimumTerrainLevel||f(this._maximumTerrainLevel)&&t.level>this._maximumTerrainLevel)return!1;let r=this._imageryProvider;if(f(i)||(i=o.imagery.length),!r.ready)return this._skeletonPlaceholder.loadingImagery.addReference(),o.imagery.splice(i,0,this._skeletonPlaceholder),!0;let s=r.tilingScheme.projection instanceof bi&&t.rectangle.north<bi.MaximumLatitude&&t.rectangle.south>-bi.MaximumLatitude,a=le.intersection(r.rectangle,this._rectangle,Ipe),c=le.intersection(t.rectangle,a,vpe);if(!f(c)){if(!this.isBaseLayer())return!1;let v=a,P=t.rectangle;c=vpe,P.south>=v.north?c.north=c.south=v.north:P.north<=v.south?c.north=c.south=v.south:(c.south=Math.max(P.south,v.south),c.north=Math.min(P.north,v.north)),P.west>=v.east?c.west=c.east=v.east:P.east<=v.west?c.west=c.east=v.west:(c.west=Math.max(P.west,v.west),c.east=Math.min(P.east,v.east))}let l=0;c.south>0?l=c.south:c.north<0&&(l=c.north);let d=1*n.getLevelMaximumGeometricError(t.level),h=Fot(this,d,l);h=Math.max(0,h);let _=r.maximumLevel;if(h>_&&(h=_),f(r.minimumLevel)){let v=r.minimumLevel;h<v&&(h=v)}let y=r.tilingScheme,p=y.positionToTileXY(le.northwest(c),h),C=y.positionToTileXY(le.southeast(c),h),x=t.rectangle.width/512,T=t.rectangle.height/512,E=y.tileXYToRectangle(p.x,p.y,h);Math.abs(E.south-t.rectangle.north)<T&&p.y<C.y&&++p.y,Math.abs(E.east-t.rectangle.west)<x&&p.x<C.x&&++p.x;let S=y.tileXYToRectangle(C.x,C.y,h);Math.abs(S.north-t.rectangle.south)<T&&C.y>p.y&&--C.y,Math.abs(S.west-t.rectangle.east)<x&&C.x>p.x&&--C.x;let w=le.clone(t.rectangle,Bpe),D=y.tileXYToRectangle(p.x,p.y,h),I=le.intersection(D,a,bj),O;s?(y.rectangleToNativeRectangle(w,w),y.rectangleToNativeRectangle(D,D),y.rectangleToNativeRectangle(I,I),y.rectangleToNativeRectangle(a,a),O=y.tileXYToNativeRectangle.bind(y),x=w.width/512,T=w.height/512):O=y.tileXYToRectangle.bind(y);let M,L=0,F=1,g;!this.isBaseLayer()&&Math.abs(I.west-w.west)>=x&&(L=Math.min(1,(I.west-w.west)/w.width)),!this.isBaseLayer()&&Math.abs(I.north-w.north)>=T&&(F=Math.max(0,(I.north-w.south)/w.height));let b=F;for(let v=p.x;v<=C.x;v++)if(M=L,D=O(v,p.y,h),I=le.simpleIntersection(D,a,bj),!!f(I)){L=Math.min(1,(I.east-w.west)/w.width),v===C.x&&(this.isBaseLayer()||Math.abs(I.east-w.east)<x)&&(L=1),F=b;for(let P=p.y;P<=C.y;P++){if(g=F,D=O(v,P,h),I=le.simpleIntersection(D,a,bj),!f(I))continue;F=Math.max(0,(I.south-w.south)/w.height),P===C.y&&(this.isBaseLayer()||Math.abs(I.south-w.south)<T)&&(F=0);let R=new se(M,F,L,g),V=this.getImageryFromCache(v,P,h);o.imagery.splice(i,0,new Av(V,R,s)),++i}}return!0};Oi.prototype._calculateTextureTranslationAndScale=function(t,n){let i=n.readyImagery.rectangle,o=t.rectangle;if(n.useWebMercatorT){let l=n.readyImagery.imageryLayer.imageryProvider.tilingScheme;i=l.rectangleToNativeRectangle(i,Ipe),o=l.rectangleToNativeRectangle(o,Bpe)}let r=o.width,s=o.height,a=r/i.width,c=s/i.height;return new se(a*(o.west-i.west)/r,c*(o.south-i.south)/s,a,c)};Oi.prototype._requestImagery=function(t){let n=this._imageryProvider,i=this;function o(a){if(!f(a))return r();t.image=a,t.state=ii.RECEIVED,t.request=void 0,qn.reportSuccess(i._requestImageError)}function r(a){if(t.request.state===ai.CANCELLED){t.state=ii.UNLOADED,t.request=void 0;return}t.state=ii.FAILED,t.request=void 0;let c=`Failed to obtain image tile X: ${t.x} Y: ${t.y} Level: ${t.level}.`;i._requestImageError=qn.reportError(i._requestImageError,n,n.errorEvent,c,t.x,t.y,t.level,a),i._requestImageError.retry&&s()}function s(){let a=new qo({throttle:!1,throttleByServer:!0,type:Qr.IMAGERY});t.request=a,t.state=ii.TRANSITIONING;let c=n.requestImage(t.x,t.y,t.level,a);if(!f(c)){t.state=ii.UNLOADED,t.request=void 0;return}f(n.getTileCredits)&&(t.credits=n.getTileCredits(t.x,t.y,t.level)),c.then(function(l){o(l)}).catch(function(l){r(l)})}s()};Oi.prototype._createTextureWebGL=function(t,n){let i=new pn({minificationFilter:this.minificationFilter,magnificationFilter:this.magnificationFilter}),o=n.image;return f(o.internalFormat)?new St({context:t,pixelFormat:o.internalFormat,width:o.width,height:o.height,source:{arrayBufferView:o.bufferView},sampler:i}):new St({context:t,source:o,pixelFormat:this._imageryProvider.hasAlphaChannel?st.RGBA:st.RGB,sampler:i})};Oi.prototype._createTexture=function(t,n){let i=this._imageryProvider,o=n.image;if(f(i.tileDiscardPolicy)){let s=i.tileDiscardPolicy;if(f(s)){if(!s.isReady()){n.state=ii.RECEIVED;return}if(s.shouldDiscardImage(o)){n.state=ii.INVALID;return}}}let r=this._createTextureWebGL(t,n);i.tilingScheme.projection instanceof bi?n.textureWebMercator=r:n.texture=r,n.image=void 0,n.state=ii.TEXTURE_LOADED};function Ppe(t,n,i){return`${t}:${n}:${i}`}Oi.prototype._finalizeReprojectTexture=function(t,n){let i=this.minificationFilter,o=this.magnificationFilter;if(i===fn.LINEAR&&o===Qi.LINEAR&&!st.isCompressedFormat(n.pixelFormat)&&B.isPowerOfTwo(n.width)&&B.isPowerOfTwo(n.height)){i=fn.LINEAR_MIPMAP_LINEAR;let s=Ut.maximumTextureFilterAnisotropy,a=Math.min(s,A(this._maximumAnisotropy,s)),c=Ppe(i,o,a),l=t.cache.imageryLayerMipmapSamplers;f(l)||(l={},t.cache.imageryLayerMipmapSamplers=l);let u=l[c];f(u)||(u=l[c]=new pn({wrapS:Mn.CLAMP_TO_EDGE,wrapT:Mn.CLAMP_TO_EDGE,minificationFilter:i,magnificationFilter:o,maximumAnisotropy:a})),n.generateMipmap(lm.NICEST),n.sampler=u}else{let s=Ppe(i,o,0),a=t.cache.imageryLayerNonMipmapSamplers;f(a)||(a={},t.cache.imageryLayerNonMipmapSamplers=a);let c=a[s];f(c)||(c=a[s]=new pn({wrapS:Mn.CLAMP_TO_EDGE,wrapT:Mn.CLAMP_TO_EDGE,minificationFilter:i,magnificationFilter:o})),n.sampler=c}};Oi.prototype._reprojectTexture=function(t,n,i){let o=n.textureWebMercator||n.texture,r=n.rectangle,s=t.context;if(i=A(i,!0),i&&!(this._imageryProvider.tilingScheme.projection instanceof Ci)&&r.width/o.width>1e-5){let a=this;n.addReference();let c=new Pf({persists:!0,owner:this,preExecute:function(l){Lot(l,s,o,n.rectangle)},postExecute:function(l){n.texture=l,a._finalizeReprojectTexture(s,l),n.state=ii.READY,n.releaseReference()},canceled:function(){n.state=ii.TEXTURE_LOADED,n.releaseReference()}});this._reprojectComputeCommands.push(c)}else i&&(n.texture=o),this._finalizeReprojectTexture(s,o),n.state=ii.READY};Oi.prototype.queueReprojectionCommands=function(t){let n=this._reprojectComputeCommands,i=n.length;for(let o=0;o<i;++o)t.commandList.push(n[o]);n.length=0};Oi.prototype.cancelReprojections=function(){this._reprojectComputeCommands.forEach(function(t){f(t.canceled)&&t.canceled()}),this._reprojectComputeCommands.length=0};Oi.prototype.getImageryFromCache=function(t,n,i,o){let r=Ope(t,n,i),s=this._imageryCache[r];return f(s)||(s=new yv(this,t,n,i,o),this._imageryCache[r]=s),s.addReference(),s};Oi.prototype.removeImageryFromCache=function(t){let n=Ope(t.x,t.y,t.level);delete this._imageryCache[n]};function Ope(t,n,i){return JSON.stringify([t,n,i])}var Gk={u_textureDimensions:function(){return this.textureDimensions},u_texture:function(){return this.texture},textureDimensions:new W,texture:void 0},Mot=Vt.supportsTypedArrays()?new Float32Array(2*64):void 0;function Lot(t,n,i,o){let r=n.cache.imageryLayer_reproject;if(!f(r)){r=n.cache.imageryLayer_reproject={vertexArray:void 0,shaderProgram:void 0,sampler:void 0,destroy:function(){f(this.framebuffer)&&this.framebuffer.destroy(),f(this.vertexArray)&&this.vertexArray.destroy(),f(this.shaderProgram)&&this.shaderProgram.destroy()}};let x=new Float32Array(2*64*2),T=0;for(let I=0;I<64;++I){let O=I/63;x[T++]=0,x[T++]=O,x[T++]=1,x[T++]=O}let E={position:0,webMercatorT:1},S=Yr.getRegularGridIndices(2,64),w=ut.createIndexBuffer({context:n,typedArray:S,usage:Fe.STATIC_DRAW,indexDatatype:Ne.UNSIGNED_SHORT});r.vertexArray=new $n({context:n,attributes:[{index:E.position,vertexBuffer:ut.createVertexBuffer({context:n,typedArray:x,usage:Fe.STATIC_DRAW}),componentsPerAttribute:2},{index:E.webMercatorT,vertexBuffer:ut.createVertexBuffer({context:n,sizeInBytes:64*2*4,usage:Fe.STREAM_DRAW}),componentsPerAttribute:1}],indexBuffer:w});let D=new ze({sources:[kV]});r.shaderProgram=qt.fromCache({context:n,vertexShaderSource:D,fragmentShaderSource:VV,attributeLocations:E}),r.sampler=new pn({wrapS:Mn.CLAMP_TO_EDGE,wrapT:Mn.CLAMP_TO_EDGE,minificationFilter:fn.LINEAR,magnificationFilter:Qi.LINEAR})}i.sampler=r.sampler;let s=i.width,a=i.height;Gk.textureDimensions.x=s,Gk.textureDimensions.y=a,Gk.texture=i;let c=Math.sin(o.south),l=.5*Math.log((1+c)/(1-c));c=Math.sin(o.north);let d=1/(.5*Math.log((1+c)/(1-c))-l),h=new St({context:n,width:s,height:a,pixelFormat:i.pixelFormat,pixelDatatype:i.pixelDatatype,preMultiplyAlpha:i.preMultiplyAlpha});B.isPowerOfTwo(s)&&B.isPowerOfTwo(a)&&h.generateMipmap(lm.NICEST);let _=o.south,y=o.north,p=Mot,C=0;for(let x=0;x<64;++x){let T=x/63,E=B.lerp(_,y,T);c=Math.sin(E);let w=(.5*Math.log((1+c)/(1-c))-l)*d;p[C++]=w,p[C++]=w}r.vertexArray.getAttribute(1).vertexBuffer.copyFromArrayView(p),t.shaderProgram=r.shaderProgram,t.outputTexture=h,t.uniformMap=Gk,t.vertexArray=r.vertexArray}function Fot(t,n,i){let o=t._imageryProvider,r=o.tilingScheme,s=r.ellipsoid,a=t._imageryProvider.tilingScheme.projection instanceof Ci?1:Math.cos(i),c=r.rectangle,u=s.maximumRadius*c.width*a/(o.tileWidth*r.getNumberOfXTilesAtLevel(0))/n,d=Math.log(u)/Math.log(2);return Math.round(d)|0}var lf=Oi;var Rpe={NONE:0,CULLED:1,RENDERED:2,REFINED:3,RENDERED_AND_KICKED:6,REFINED_AND_KICKED:7,CULLED_BUT_NEEDED:9,wasKicked:function(t){return t>=Rpe.RENDERED_AND_KICKED},originalResult:function(t){return t&3},kick:function(t){return t|4}},Xn=Rpe;function WE(t){this.tile=t,this.frameLastUpdated=void 0,this.westMeshes=[],this.westTiles=[],this.southMeshes=[],this.southTiles=[],this.eastMeshes=[],this.eastTiles=[],this.northMeshes=[],this.northTiles=[],this.southwestMesh=void 0,this.southwestTile=void 0,this.southeastMesh=void 0,this.southeastTile=void 0,this.northwestMesh=void 0,this.northwestTile=void 0,this.northeastMesh=void 0,this.northeastTile=void 0,this.changedThisFrame=!0,this.visitedFrame=void 0,this.enqueuedFrame=void 0,this.mesh=void 0,this.vertexArray=void 0,this.waterMaskTexture=void 0,this.waterMaskTranslationAndScale=new se}WE.prototype.update=function(t,n,i){this.changedThisFrame&&(Upe(t,n,this.tile,i),this.changedThisFrame=!1)};WE.prototype.destroy=function(t){this._destroyVertexArray(t),f(this.waterMaskTexture)&&(--this.waterMaskTexture.referenceCount,this.waterMaskTexture.referenceCount===0&&this.waterMaskTexture.destroy(),this.waterMaskTexture=void 0)};WE.prototype._destroyVertexArray=function(t){f(this.vertexArray)&&(f(t)?t.push(this.vertexArray):Td._freeVertexArray(this.vertexArray),this.vertexArray=void 0)};var Not=new gy;WE.updateFillTiles=function(t,n,i,o){let r=t._quadtree,s=r._levelZeroTiles,a=r._lastSelectionFrameNumber,c=Not;c.clear();for(let u=0;u<n.length;++u){let d=n[u];f(d.data.vertexArray)&&c.enqueue(n[u])}let l=c.dequeue();for(;l!==void 0;){let u=l.findTileToWest(s),d=l.findTileToSouth(s),h=l.findTileToEast(s),_=l.findTileToNorth(s);ss(t,i,l,u,a,hn.EAST,!1,c,o),ss(t,i,l,d,a,hn.NORTH,!1,c,o),ss(t,i,l,h,a,hn.WEST,!1,c,o),ss(t,i,l,_,a,hn.SOUTH,!1,c,o);let y=u.findTileToNorth(s),p=u.findTileToSouth(s),C=h.findTileToNorth(s),x=h.findTileToSouth(s);ss(t,i,l,y,a,hn.SOUTHEAST,!1,c,o),ss(t,i,l,C,a,hn.SOUTHWEST,!1,c,o),ss(t,i,l,p,a,hn.NORTHEAST,!1,c,o),ss(t,i,l,x,a,hn.NORTHWEST,!1,c,o),l=c.dequeue()}};function ss(t,n,i,o,r,s,a,c,l){if(o===void 0)return;let u=o;for(;u&&(u._lastSelectionResultFrame!==r||Xn.wasKicked(u._lastSelectionResult)||Xn.originalResult(u._lastSelectionResult)===Xn.CULLED);){if(a)return;let d=u.parent;if(s>=hn.NORTHWEST&&d!==void 0)switch(s){case hn.NORTHWEST:u=u===d.northwestChild?d:void 0;break;case hn.NORTHEAST:u=u===d.northeastChild?d:void 0;break;case hn.SOUTHWEST:u=u===d.southwestChild?d:void 0;break;case hn.SOUTHEAST:u=u===d.southeastChild?d:void 0;break}else u=d}if(u!==void 0){if(u._lastSelectionResult===Xn.RENDERED){if(f(u.data.vertexArray))return;Vot(t,n,i,u,s,r,c,l);return}if(Xn.originalResult(o._lastSelectionResult)!==Xn.CULLED)switch(s){case hn.WEST:ss(t,n,i,o.northwestChild,r,s,!0,c,l),ss(t,n,i,o.southwestChild,r,s,!0,c,l);break;case hn.EAST:ss(t,n,i,o.southeastChild,r,s,!0,c,l),ss(t,n,i,o.northeastChild,r,s,!0,c,l);break;case hn.SOUTH:ss(t,n,i,o.southwestChild,r,s,!0,c,l),ss(t,n,i,o.southeastChild,r,s,!0,c,l);break;case hn.NORTH:ss(t,n,i,o.northeastChild,r,s,!0,c,l),ss(t,n,i,o.northwestChild,r,s,!0,c,l);break;case hn.NORTHWEST:ss(t,n,i,o.northwestChild,r,s,!0,c,l);break;case hn.NORTHEAST:ss(t,n,i,o.northeastChild,r,s,!0,c,l);break;case hn.SOUTHWEST:ss(t,n,i,o.southwestChild,r,s,!0,c,l);break;case hn.SOUTHEAST:ss(t,n,i,o.southeastChild,r,s,!0,c,l);break;default:throw new Ce("Invalid edge")}}}function Vot(t,n,i,o,r,s,a,c){let l=o.data;if(l.fill===void 0)l.fill=new WE(o);else if(l.fill.visitedFrame===s)return;l.fill.enqueuedFrame!==s&&(l.fill.enqueuedFrame=s,l.fill.changedThisFrame=!1,a.enqueue(o)),kot(t,n,i,o,r,c)}function kot(t,n,i,o,r,s){let a=o.data.fill,c,l=i.data.fill;f(l)?(l.visitedFrame=n.frameNumber,l.changedThisFrame&&(Upe(t,n,i,s),l.changedThisFrame=!1),c=i.data.fill.mesh):c=i.data.mesh;let u,d;switch(r){case hn.WEST:u=a.westMeshes,d=a.westTiles;break;case hn.SOUTH:u=a.southMeshes,d=a.southTiles;break;case hn.EAST:u=a.eastMeshes,d=a.eastTiles;break;case hn.NORTH:u=a.northMeshes,d=a.northTiles;break;case hn.NORTHWEST:a.changedThisFrame=a.changedThisFrame||a.northwestMesh!==c,a.northwestMesh=c,a.northwestTile=i;return;case hn.NORTHEAST:a.changedThisFrame=a.changedThisFrame||a.northeastMesh!==c,a.northeastMesh=c,a.northeastTile=i;return;case hn.SOUTHWEST:a.changedThisFrame=a.changedThisFrame||a.southwestMesh!==c,a.southwestMesh=c,a.southwestTile=i;return;case hn.SOUTHEAST:a.changedThisFrame=a.changedThisFrame||a.southeastMesh!==c,a.southeastMesh=c,a.southeastTile=i;return}if(i.level<=o.level){a.changedThisFrame=a.changedThisFrame||u[0]!==c||u.length!==1,u[0]=c,d[0]=i,u.length=1,d.length=1;return}let h,_,y,p,C=i.rectangle,x,T=o.rectangle;switch(r){case hn.WEST:for(x=(T.north-T.south)*B.EPSILON5,h=0;h<d.length&&(y=d[h],p=y.rectangle,!B.greaterThan(C.north,p.south,x));++h);for(_=h;_<d.length&&(y=d[_],p=y.rectangle,!B.greaterThanOrEquals(C.south,p.north,x));++_);break;case hn.SOUTH:for(x=(T.east-T.west)*B.EPSILON5,h=0;h<d.length&&(y=d[h],p=y.rectangle,!B.lessThan(C.west,p.east,x));++h);for(_=h;_<d.length&&(y=d[_],p=y.rectangle,!B.lessThanOrEquals(C.east,p.west,x));++_);break;case hn.EAST:for(x=(T.north-T.south)*B.EPSILON5,h=0;h<d.length&&(y=d[h],p=y.rectangle,!B.lessThan(C.south,p.north,x));++h);for(_=h;_<d.length&&(y=d[_],p=y.rectangle,!B.lessThanOrEquals(C.north,p.south,x));++_);break;case hn.NORTH:for(x=(T.east-T.west)*B.EPSILON5,h=0;h<d.length&&(y=d[h],p=y.rectangle,!B.greaterThan(C.east,p.west,x));++h);for(_=h;_<d.length&&(y=d[_],p=y.rectangle,!B.greaterThanOrEquals(C.west,p.east,x));++_);break}_-h===1?(a.changedThisFrame=a.changedThisFrame||u[h]!==c,u[h]=c,d[h]=i):(a.changedThisFrame=!0,u.splice(h,_-h,c),d.splice(h,_-h,i))}var pA=new de,Uot=new de,GE=new m,vj=new m,Sj=new W,wj=new W,eu=new W;function Jk(){this.height=0,this.encodedNormal=new W}function Wk(t,n,i,o,r,s,a,c,l){if(f(r))return r;let u;if(f(s)&&f(a))u=(s.height+a.height)*.5;else if(f(s))u=s.height;else if(f(a))u=a.height;else if(f(c))u=c.height;else{let h=t.tile.data.tileBoundingRegion,_=0,y=0;f(h)&&(_=h.minimumHeight,y=h.maximumHeight),u=(_+y)*.5}return zpe(t,n,i,o,u,l),l}var zot={minimumHeight:0,maximumHeight:0},Hot=new m,Mpe=new Jk,Lpe=new Jk,Fpe=new Jk,Npe=new Jk,Got=typeof Uint8Array!="undefined"?new Uint8Array(9*9):void 0,Wot={tilingScheme:void 0,x:0,y:0,level:0,exaggeration:1,exaggerationRelativeHeight:0};function Upe(t,n,i,o){Td.initialize(i,t.terrainProvider,t._imageryLayers);let r=i.data,s=r.fill,a=i.rectangle,c=n.terrainExaggeration,l=n.terrainExaggerationRelativeHeight,u=c!==1,d=i.tilingScheme.ellipsoid,h=qk(s,d,0,1,s.northwestTile,s.northwestMesh,s.northTiles,s.northMeshes,s.westTiles,s.westMeshes,Fpe),_=qk(s,d,0,0,s.southwestTile,s.southwestMesh,s.westTiles,s.westMeshes,s.southTiles,s.southMeshes,Mpe),y=qk(s,d,1,0,s.southeastTile,s.southeastMesh,s.southTiles,s.southMeshes,s.eastTiles,s.eastMeshes,Lpe),p=qk(s,d,1,1,s.northeastTile,s.northeastMesh,s.eastTiles,s.eastMeshes,s.northTiles,s.northMeshes,Npe);h=Wk(s,d,0,1,h,_,p,y,Fpe),_=Wk(s,d,0,0,_,h,y,p,Mpe),y=Wk(s,d,1,1,y,_,p,h,Lpe),p=Wk(s,d,1,1,p,y,h,_,Npe);let C=_.height,x=y.height,T=h.height,E=p.height,S=Math.min(C,x,T,E),w=Math.max(C,x,T,E),D=(S+w)*.5,I,O,M=t.getLevelMaximumGeometricError(i.level),L=d.maximumRadius-M,F=Math.acos(L/d.maximumRadius)*4;if(F*=1.5,a.width>F&&w-S<=M){let v=new ka({width:9,height:9,buffer:Got,structure:{heightOffset:w}}),P=Wot;P.tilingScheme=i.tilingScheme,P.x=i.x,P.y=i.y,P.level=i.level,P.exaggeration=c,P.exaggerationRelativeHeight=l,s.mesh=v._createMeshSync(P)}else{let v=u,P=le.center(a,Uot);P.height=D;let R=d.cartographicToCartesian(P,Hot),V=new Tc(R,void 0,void 0,void 0,void 0,!0,!0,v,c,l),H=5,U;for(U=s.westMeshes,I=0,O=U.length;I<O;++I)H+=U[I].eastIndicesNorthToSouth.length;for(U=s.southMeshes,I=0,O=U.length;I<O;++I)H+=U[I].northIndicesWestToEast.length;for(U=s.eastMeshes,I=0,O=U.length;I<O;++I)H+=U[I].westIndicesSouthToNorth.length;for(U=s.northMeshes,I=0,O=U.length;I<O;++I)H+=U[I].southIndicesEastToWest.length;let G=zot;G.minimumHeight=S,G.maximumHeight=w;let k=V.stride,X=new Float32Array(H*k),Y=0,K=Y;Y=jk(d,a,V,X,Y,0,1,h.height,h.encodedNormal,1,G),Y=Xk(s,d,V,X,Y,s.westTiles,s.westMeshes,hn.EAST,G);let j=Y;Y=jk(d,a,V,X,Y,0,0,_.height,_.encodedNormal,0,G),Y=Xk(s,d,V,X,Y,s.southTiles,s.southMeshes,hn.NORTH,G);let Z=Y;Y=jk(d,a,V,X,Y,1,0,y.height,y.encodedNormal,0,G),Y=Xk(s,d,V,X,Y,s.eastTiles,s.eastMeshes,hn.WEST,G);let Q=Y;Y=jk(d,a,V,X,Y,1,1,p.height,p.encodedNormal,1,G),Y=Xk(s,d,V,X,Y,s.northTiles,s.northMeshes,hn.SOUTH,G),S=G.minimumHeight,w=G.maximumHeight;let me=_i.fromRectangle(a,S,w,i.tilingScheme.ellipsoid),_e=bi.geodeticLatitudeToMercatorAngle(a.south),re=1/(bi.geodeticLatitudeToMercatorAngle(a.north)-_e),fe=(bi.geodeticLatitudeToMercatorAngle(P.latitude)-_e)*re,ge=d.geodeticSurfaceNormalCartographic(pA,vj),be=zn.octEncode(ge,Sj),Be=Y;V.encode(X,Y*k,me.center,W.fromElements(.5,.5,eu),D,be,fe,ge),++Y;let ke=Y,qe=ke<256?1:2,Nt=(ke-1)*3,Wt=Nt*qe,un=(X.length-ke*k)*Float32Array.BYTES_PER_ELEMENT,_t;if(un>=Wt){let ye=ke*k*Float32Array.BYTES_PER_ELEMENT;_t=ke<256?new Uint8Array(X.buffer,ye,Nt):new Uint16Array(X.buffer,ye,Nt)}else _t=ke<256?new Uint8Array(Nt):new Uint16Array(Nt);X=new Float32Array(X.buffer,0,ke*k);let Rn=0;for(I=0;I<ke-2;++I)_t[Rn++]=Be,_t[Rn++]=I,_t[Rn++]=I+1;_t[Rn++]=Be,_t[Rn++]=I,_t[Rn++]=0;let oi=[];for(I=j;I>=K;--I)oi.push(I);let lt=[];for(I=Z;I>=j;--I)lt.push(I);let Yt=[];for(I=Q;I>=Z;--I)Yt.push(I);let si=[];for(si.push(0),I=Be-1;I>=Q;--I)si.push(I);s.mesh=new hd(V.center,X,_t,Nt,ke,S,w,ae.fromOrientedBoundingBox(me),Zot(t,me.center,a,S,w),V.stride,me,V,oi,lt,Yt,si)}let g=n.context;s._destroyVertexArray(o),s.vertexArray=Td._createVertexArrayForMesh(g,s.mesh),r.processImagery(i,t.terrainProvider,n,!0);let b=s.waterMaskTexture;if(s.waterMaskTexture=void 0,t.terrainProvider.hasWaterMask){let v=r._findAncestorTileWithTerrainData(i);f(v)&&f(v.data.waterMaskTexture)&&(s.waterMaskTexture=v.data.waterMaskTexture,++s.waterMaskTexture.referenceCount,r._computeWaterMaskTranslationAndScale(i,v,s.waterMaskTranslationAndScale))}f(b)&&(--b.referenceCount,b.referenceCount===0&&b.destroy())}function jk(t,n,i,o,r,s,a,c,l,u,d){let h=pA;h.longitude=B.lerp(n.west,n.east,s),h.latitude=B.lerp(n.south,n.north,a),h.height=c;let _=t.cartographicToCartesian(h,GE),y;i.hasGeodeticSurfaceNormals&&(y=t.geodeticSurfaceNormal(_,vj));let p=wj;return p.x=s,p.y=a,i.encode(o,r*i.stride,_,p,c,l,u,y),d.minimumHeight=Math.min(d.minimumHeight,c),d.maximumHeight=Math.max(d.maximumHeight,c),r+1}var Kk=new le;function Cv(t,n,i,o){let r=t.rectangle,s=n.rectangle;n.x===0&&i.x===1&&t.x===t.tilingScheme.getNumberOfXTilesAtLevel(t.level)-1?(r=le.clone(t.rectangle,Kk),r.west-=B.TWO_PI,r.east-=B.TWO_PI):t.x===0&&i.x===0&&n.x===n.tilingScheme.getNumberOfXTilesAtLevel(n.level)-1&&(r=le.clone(t.rectangle,Kk),r.west+=B.TWO_PI,r.east+=B.TWO_PI);let a=r.east-r.west,c=(s.west-r.west)/a,l=(s.east-r.west)/a,u=r.north-r.south,d=(s.south-r.south)/u,h=(s.north-r.south)/u,_=(i.x-c)/(l-c),y=(i.y-d)/(h-d);return Math.abs(_)<Math.EPSILON5?_=0:Math.abs(_-1)<Math.EPSILON5&&(_=1),Math.abs(y)<Math.EPSILON5?y=0:Math.abs(y-1)<Math.EPSILON5&&(y=1),o.x=_,o.y=y,o}var jot=new W;function Dj(t,n,i,o,r){let s=t.encoding,a=t.vertices;if(r.height=s.decodeHeight(a,n),s.hasVertexNormals)s.getOctEncodedNormal(a,n,r.encodedNormal);else{let c=r.encodedNormal;c.x=0,c.y=0}}var qot=new W,Yot=new m;function Xot(t,n,i,o,r,s,a,c,l,u){let d=o.encoding,h=o.vertices,_=Cv(n,i,d.decodeTextureCoordinates(h,r,eu),eu),y=Cv(n,i,d.decodeTextureCoordinates(h,s,wj),wj),p;l?p=(a-_.x)/(y.x-_.x):p=(c-_.y)/(y.y-_.y);let C=d.decodeHeight(h,r),x=d.decodeHeight(h,s),T=i.rectangle;pA.longitude=B.lerp(T.west,T.east,a),pA.latitude=B.lerp(T.south,T.north,c),u.height=pA.height=B.lerp(C,x,p);let E;if(d.hasVertexNormals){let S=d.getOctEncodedNormal(h,r,jot),w=d.getOctEncodedNormal(h,s,qot),D=zn.octDecode(S.x,S.y,GE),I=zn.octDecode(w.x,w.y,Yot);E=m.lerp(D,I,p,GE),m.normalize(E,E),zn.octEncode(E,u.encodedNormal)}else E=t.geodeticSurfaceNormalCartographic(pA,GE),zn.octEncode(E,u.encodedNormal)}function zpe(t,n,i,o,r,s){s.height=r;let a=n.geodeticSurfaceNormalCartographic(pA,GE);zn.octEncode(a,s.encodedNormal)}function qk(t,n,i,o,r,s,a,c,l,u,d){if(kpe(t,n,c,a,!1,i,o,d)||kpe(t,n,u,l,!0,i,o,d))return d;let _;if(Pj(r,s))return i===0?o===0?_=s.eastIndicesNorthToSouth[0]:_=s.southIndicesEastToWest[0]:o===0?_=s.northIndicesWestToEast[0]:_=s.westIndicesSouthToNorth[0],Dj(s,_,i,o,d),d;let y;if(i===0?o===0?y=Yk(t.westMeshes,t.westTiles,hn.EAST,t.southMeshes,t.southTiles,hn.NORTH,i,o):y=Yk(t.northMeshes,t.northTiles,hn.SOUTH,t.westMeshes,t.westTiles,hn.EAST,i,o):o===0?y=Yk(t.southMeshes,t.southTiles,hn.NORTH,t.eastMeshes,t.eastTiles,hn.WEST,i,o):y=Yk(t.eastMeshes,t.eastTiles,hn.WEST,t.northMeshes,t.northTiles,hn.SOUTH,i,o),f(y))return zpe(t,n,i,o,y,d),d}function Yk(t,n,i,o,r,s,a,c){let l=Vpe(t,n,!1,i,a,c),u=Vpe(o,r,!0,s,a,c);return f(l)&&f(u)?(l+u)*.5:f(l)?l:u}function Xk(t,n,i,o,r,s,a,c,l){for(let u=0;u<s.length;++u)r=Kot(t,n,i,o,r,s[u],a[u],c,l);return r}function Kot(t,n,i,o,r,s,a,c,l){let u=s.rectangle;c===hn.EAST&&t.tile.x===0?(u=le.clone(s.rectangle,Kk),u.west-=B.TWO_PI,u.east-=B.TWO_PI):c===hn.WEST&&s.x===0&&(u=le.clone(s.rectangle,Kk),u.west+=B.TWO_PI,u.east+=B.TWO_PI);let d=t.tile.rectangle,h,_;r>0&&(i.decodeTextureCoordinates(o,r-1,eu),h=eu.x,_=eu.y);let y,p;switch(c){case hn.WEST:y=a.westIndicesSouthToNorth,p=!1;break;case hn.NORTH:y=a.northIndicesWestToEast,p=!0;break;case hn.EAST:y=a.eastIndicesNorthToSouth,p=!1;break;case hn.SOUTH:y=a.southIndicesEastToWest,p=!0;break}let C=s,x=t.tile,T=a.encoding,E=a.vertices,S=i.stride,w,D;T.hasWebMercatorT&&(w=bi.geodeticLatitudeToMercatorAngle(d.south),D=1/(bi.geodeticLatitudeToMercatorAngle(d.north)-w));for(let I=0;I<y.length;++I){let O=y[I],M=T.decodeTextureCoordinates(E,O,eu);Cv(C,x,M,M);let L=M.x,F=M.y,g=p?L:F;if(g<0||g>1||Math.abs(L-h)<B.EPSILON5&&Math.abs(F-_)<B.EPSILON5)continue;let b=Math.abs(L)<B.EPSILON5||Math.abs(L-1)<B.EPSILON5,v=Math.abs(F)<B.EPSILON5||Math.abs(F-1)<B.EPSILON5;if(b&&v)continue;let P=T.decodePosition(E,O,GE),R=T.decodeHeight(E,O),V;T.hasVertexNormals?V=T.getOctEncodedNormal(E,O,Sj):(V=Sj,V.x=0,V.y=0);let H=F;if(T.hasWebMercatorT){let G=B.lerp(d.south,d.north,F);H=(bi.geodeticLatitudeToMercatorAngle(G)-w)*D}let U;i.hasGeodeticSurfaceNormals&&(U=n.geodeticSurfaceNormal(P,vj)),i.encode(o,r*S,P,M,R,V,H,U),l.minimumHeight=Math.min(l.minimumHeight,R),l.maximumHeight=Math.max(l.maximumHeight,R),++r}return r}function Vpe(t,n,i,o,r,s){let a,c,l;i?(a=0,c=t.length,l=1):(a=t.length-1,c=-1,l=-1);for(let u=a;u!==c;u+=l){let d=t[u],h=n[u];if(!Pj(h,d))continue;let _;switch(o){case hn.WEST:_=d.westIndicesSouthToNorth;break;case hn.SOUTH:_=d.southIndicesEastToWest;break;case hn.EAST:_=d.eastIndicesNorthToSouth;break;case hn.NORTH:_=d.northIndicesWestToEast;break}let y=_[i?0:_.length-1];if(f(y))return d.encoding.decodeHeight(d.vertices,y)}}function Pj(t,n){return f(n)&&(!f(t.data.fill)||!t.data.fill.changedThisFrame)}function kpe(t,n,i,o,r,s,a,c){let l,u,d,h,_,y=o[r?0:i.length-1],p=i[r?0:i.length-1];if(Pj(y,p)&&(s===0?a===0?(l=r?p.northIndicesWestToEast:p.eastIndicesNorthToSouth,u=r,d=r):(l=r?p.eastIndicesNorthToSouth:p.southIndicesEastToWest,u=!r,d=!1):a===0?(l=r?p.westIndicesSouthToNorth:p.northIndicesWestToEast,u=!r,d=!0):(l=r?p.southIndicesEastToWest:p.westIndicesSouthToNorth,u=r,d=!r),l.length>0)){h=r?0:l.length-1,_=l[h],p.encoding.decodeTextureCoordinates(p.vertices,_,eu);let C=Cv(y,t.tile,eu,eu);if(C.x===s&&C.y===a)return Dj(p,_,s,a,c),!0;if(h=jo(l,u?s:a,function(x,T){p.encoding.decodeTextureCoordinates(p.vertices,x,eu);let E=Cv(y,t.tile,eu,eu);return d?u?E.x-s:E.y-a:u?s-E.x:a-E.y}),h<0){if(h=~h,h>0&&h<l.length)return Xot(n,y,t.tile,p,l[h-1],l[h],s,a,u,c),!0}else return Dj(p,l[h],s,a,c),!0}return!1}var Jot=[new m,new m,new m,new m];function Zot(t,n,i,o,r,s){let a=t.quadtree._occluders.ellipsoid,c=a.ellipsoid,l=Jot;return m.fromRadians(i.west,i.south,r,c,l[0]),m.fromRadians(i.east,i.south,r,c,l[1]),m.fromRadians(i.west,i.north,r,c,l[2]),m.fromRadians(i.east,i.north,r,c,l[3]),a.computeHorizonCullingPointPossiblyUnderEllipsoid(n,l,o,s)}var xv=WE;function Ho(t){this.lightingFadeOutDistance=65e5,this.lightingFadeInDistance=9e6,this.hasWaterMask=!1,this.oceanNormalMap=void 0,this.zoomedOutOceanSpecularIntensity=.5,this.enableLighting=!1,this.dynamicAtmosphereLighting=!1,this.dynamicAtmosphereLightingFromSun=!1,this.showGroundAtmosphere=!1,this.shadows=gn.RECEIVE_ONLY,this.fillHighlightColor=void 0,this.hueShift=0,this.saturationShift=0,this.brightnessShift=0,this.showSkirts=!0,this.backFaceCulling=!0,this.undergroundColor=void 0,this.undergroundColorAlphaByDistance=void 0,this.lambertDiffuseMultiplier=0,this.materialUniformMap=void 0,this._materialUniformMap=void 0,this._quadtree=void 0,this._terrainProvider=t.terrainProvider,this._imageryLayers=t.imageryLayers,this._surfaceShaderSet=t.surfaceShaderSet,this._renderState=void 0,this._blendRenderState=void 0,this._disableCullingRenderState=void 0,this._disableCullingBlendRenderState=void 0,this._errorEvent=new Ae,this._imageryLayers.layerAdded.addEventListener(Ho.prototype._onLayerAdded,this),this._imageryLayers.layerRemoved.addEventListener(Ho.prototype._onLayerRemoved,this),this._imageryLayers.layerMoved.addEventListener(Ho.prototype._onLayerMoved,this),this._imageryLayers.layerShownOrHidden.addEventListener(Ho.prototype._onLayerShownOrHidden,this),this._imageryLayersUpdatedEvent=new Ae,this._layerOrderChanged=!1,this._tilesToRenderByTextureCount=[],this._drawCommands=[],this._uniformMaps=[],this._usedDrawCommands=0,this._vertexArraysToDestroy=[],this._debug={wireframe:!1,boundingSphereTile:void 0},this._baseColor=void 0,this._firstPassInitialColor=void 0,this.baseColor=new z(0,0,.5,1),this._clippingPlanes=void 0,this.cartographicLimitRectangle=le.clone(le.MAX_VALUE),this._hasLoadedTilesThisFrame=!1,this._hasFillTilesThisFrame=!1,this._oldTerrainExaggeration=void 0,this._oldTerrainExaggerationRelativeHeight=void 0}Object.defineProperties(Ho.prototype,{baseColor:{get:function(){return this._baseColor},set:function(t){this._baseColor=t,this._firstPassInitialColor=se.fromColor(t,this._firstPassInitialColor)}},quadtree:{get:function(){return this._quadtree},set:function(t){this._quadtree=t}},ready:{get:function(){return this._terrainProvider.ready&&(this._imageryLayers.length===0||this._imageryLayers.get(0).imageryProvider.ready)}},tilingScheme:{get:function(){return this._terrainProvider.tilingScheme}},errorEvent:{get:function(){return this._errorEvent}},imageryLayersUpdatedEvent:{get:function(){return this._imageryLayersUpdatedEvent}},terrainProvider:{get:function(){return this._terrainProvider},set:function(t){this._terrainProvider!==t&&(this._terrainProvider=t,f(this._quadtree)&&this._quadtree.invalidateAllTiles())}},clippingPlanes:{get:function(){return this._clippingPlanes},set:function(t){Qs.setOwner(t,this,"_clippingPlanes")}}});function Qot(t,n){let i=t.loadingImagery;f(i)||(i=t.readyImagery);let o=n.loadingImagery;return f(o)||(o=n.readyImagery),i.imageryLayer._layerIndex-o.imageryLayer._layerIndex}Ho.prototype.update=function(t){this._imageryLayers._update()};function $ot(t,n){let i=n.creditDisplay;t._terrainProvider.ready&&f(t._terrainProvider.credit)&&i.addCredit(t._terrainProvider.credit);let o=t._imageryLayers;for(let r=0,s=o.length;r<s;++r){let a=o.get(r).imageryProvider;a.ready&&f(a.credit)&&i.addCredit(a.credit)}}Ho.prototype.initialize=function(t){this._imageryLayers.queueReprojectionCommands(t),this._layerOrderChanged&&(this._layerOrderChanged=!1,this._quadtree.forEachLoadedTile(function(o){o.data.imagery.sort(Qot)})),$ot(this,t);let n=this._vertexArraysToDestroy,i=n.length;for(let o=0;o<i;++o)Td._freeVertexArray(n[o]);n.length=0};Ho.prototype.beginUpdate=function(t){let n=this._tilesToRenderByTextureCount;for(let o=0,r=n.length;o<r;++o){let s=n[o];f(s)&&(s.length=0)}let i=this._clippingPlanes;f(i)&&i.enabled&&i.update(t),this._usedDrawCommands=0,this._hasLoadedTilesThisFrame=!1,this._hasFillTilesThisFrame=!1};Ho.prototype.endUpdate=function(t){if(!f(this._renderState)){this._renderState=Ve.fromCache({cull:{enabled:!0},depthTest:{enabled:!0,func:cc.LESS}}),this._blendRenderState=Ve.fromCache({cull:{enabled:!0},depthTest:{enabled:!0,func:cc.LESS_OR_EQUAL},blending:ln.ALPHA_BLEND});let a=tt(this._renderState,!0);a.cull.enabled=!1,this._disableCullingRenderState=Ve.fromCache(a),a=tt(this._blendRenderState,!0),a.cull.enabled=!1,this._disableCullingBlendRenderState=Ve.fromCache(a)}this._hasFillTilesThisFrame&&this._hasLoadedTilesThisFrame&&xv.updateFillTiles(this,this._quadtree._tilesToRender,t,this._vertexArraysToDestroy);let n=this.quadtree,i=t.terrainExaggeration,o=t.terrainExaggerationRelativeHeight,r=this._oldTerrainExaggeration!==i||this._oldTerrainExaggerationRelativeHeight!==o;this._oldTerrainExaggeration=i,this._oldTerrainExaggerationRelativeHeight=o,r&&n.forEachLoadedTile(function(a){a.data.updateExaggeration(a,t,n)});let s=this._tilesToRenderByTextureCount;for(let a=0,c=s.length;a<c;++a){let l=s[a];if(!!f(l))for(let u=0,d=l.length;u<d;++u){let h=l[u],_=h.data.tileBoundingRegion;Ert(this,h,t),t.minimumTerrainHeight=Math.min(t.minimumTerrainHeight,_.minimumHeight)}}};function qpe(t,n){let i=n.globeTranslucencyState;if(i.translucent){let o=t.renderState.blending.enabled;i.pushDerivedCommands(t,o,n)}else n.commandList.push(t)}Ho.prototype.updateForPick=function(t){let n=this._drawCommands;for(let i=0,o=this._usedDrawCommands;i<o;++i)qpe(n[i],t)};Ho.prototype.cancelReprojections=function(){this._imageryLayers.cancelReprojections()};Ho.prototype.getLevelMaximumGeometricError=function(t){return this._terrainProvider.getLevelMaximumGeometricError(t)};Ho.prototype.loadTile=function(t,n){let i=n.data,o=!0,r;f(i)&&(o=i.boundingVolumeSourceTile!==n||n._lastSelectionResult===Xn.CULLED_BUT_NEEDED,r=i.terrainState),Td.processStateMachine(n,t,this.terrainProvider,this._imageryLayers,this.quadtree,this._vertexArraysToDestroy,o),i=n.data,o&&r!==n.data.terrainState&&this.computeTileVisibility(n,t,this.quadtree.occluders)!==fr.NONE&&i.boundingVolumeSourceTile===n&&(o=!1,Td.processStateMachine(n,t,this.terrainProvider,this._imageryLayers,this.quadtree,this._vertexArraysToDestroy,o))};var ert=new ae,Ype=new le,trt=new le,nrt=new de;function Qk(t,n){if(n.west<n.east)return n;let i=le.clone(n,trt);return le.center(t,nrt).longitude>0?i.east=B.PI:i.west=-B.PI,i}function Xpe(t,n){if(n.cameraUnderground||n.globeTranslucencyState.translucent)return!0;if(t.backFaceCulling)return!1;let i=t._clippingPlanes;return!!(f(i)&&i.enabled||!le.equals(t.cartographicLimitRectangle,le.MAX_VALUE))}Ho.prototype.computeTileVisibility=function(t,n,i){let o=this.computeDistanceToTile(t,n);t._distance=o;let r=Xpe(this,n);if(n.fog.enabled&&!r&&B.fog(o,n.fog.density)>=1)return fr.NONE;let s=t.data,a=s.tileBoundingRegion;if(s.boundingVolumeSourceTile===void 0)return fr.PARTIAL;let c=n.cullingVolume,l=a.boundingVolume;f(l)||(l=a.boundingSphere),s.clippedByBoundaries=!1;let u=Qk(t.rectangle,this.cartographicLimitRectangle),d=le.simpleIntersection(u,t.rectangle,Ype);if(!f(d))return fr.NONE;if(le.equals(d,t.rectangle)||(s.clippedByBoundaries=!0),n.mode!==ne.SCENE3D&&(l=ert,ae.fromRectangleWithHeights2D(t.rectangle,n.mapProjection,a.minimumHeight,a.maximumHeight,l),m.fromElements(l.center.z,l.center.x,l.center.y,l.center),n.mode===ne.MORPHING&&f(s.renderedMesh)&&(l=ae.union(a.boundingSphere,l,l))),!f(l))return fr.PARTIAL;let h=this._clippingPlanes;if(f(h)&&h.enabled){let C=h.computeIntersectionWithBoundingVolume(l);if(t.isClipped=C!==jt.INSIDE,C===jt.OUTSIDE)return fr.NONE}let _,y=c.computeVisibility(l);if(y===jt.OUTSIDE?_=fr.NONE:y===jt.INTERSECTING?_=fr.PARTIAL:y===jt.INSIDE&&(_=fr.FULL),_===fr.NONE)return _;let p=n.mode===ne.SCENE3D&&n.camera.frustum instanceof $t;if(n.mode===ne.SCENE3D&&!p&&f(i)&&!r){let C=s.occludeePointInScaledSpace;return!f(C)||i.ellipsoid.isScaledSpacePointVisiblePossiblyUnderEllipsoid(C,a.minimumHeight)?_:fr.NONE}return _};Ho.prototype.canRefine=function(t){return f(t.data.terrainData)?!0:this.terrainProvider.getTileDataAvailable(t.x*2,t.y*2,t.level+1)!==void 0};var irt=[],ort=[];Ho.prototype.canRenderWithoutLosingDetail=function(t,n){let i=t.data,o=irt;o.length=this._imageryLayers.length;let r=!1,s=!1,a;f(i)&&(r=i.terrainState===_o.READY,s=!0,a=i.imagery);let c,l;for(c=0,l=o.length;c<l;++c)o[c]=s;if(f(a))for(c=0,l=a.length;c<l;++c){let h=a[c],_=h.loadingImagery,y=!f(_)||_.state===ii.FAILED||_.state===ii.INVALID,p=(h.loadingImagery||h.readyImagery).imageryLayer._layerIndex;o[p]=y&&o[p]}let u=this.quadtree._lastSelectionFrameNumber,d=ort;for(d.length=0,d.push(t.southwestChild,t.southeastChild,t.northwestChild,t.northeastChild);d.length>0;){let h=d.pop(),_=h._lastSelectionResultFrame===u?h._lastSelectionResult:Xn.NONE;if(_===Xn.RENDERED){let y=h.data;if(!f(y))continue;if(!r&&h.data.terrainState===_o.READY)return!1;let p=h.data.imagery;for(c=0,l=p.length;c<l;++c){let C=p[c],x=C.loadingImagery,T=!f(x)||x.state===ii.FAILED||x.state===ii.INVALID,E=(C.loadingImagery||C.readyImagery).imageryLayer._layerIndex;if(T&&!o[E])return!1}}else _===Xn.REFINED&&d.push(h.southwestChild,h.southeastChild,h.northwestChild,h.northeastChild)}return!0};var rrt=new m;Ho.prototype.computeTileLoadPriority=function(t,n){let i=t.data;if(i===void 0)return 0;let o=i.tileBoundingRegion.boundingVolume;if(o===void 0)return 0;let r=n.camera.positionWC,s=n.camera.directionWC,a=m.subtract(o.center,r,rrt),c=m.magnitude(a);return c<B.EPSILON5?0:(m.divideByScalar(a,c,a),(1-m.dot(a,s))*t._distance)};var Hpe=new N,Zk=new N,srt=new se,art=new se,crt=new se,lrt=new m,Gpe=new m,urt=new m,frt=new m;Ho.prototype.showTileThisFrame=function(t,n){let i=0,o=t.data.imagery;for(let c=0,l=o.length;c<l;++c){let u=o[c];f(u.readyImagery)&&u.readyImagery.imageryLayer.alpha!==0&&++i}let r=this._tilesToRenderByTextureCount[i];f(r)||(r=[],this._tilesToRenderByTextureCount[i]=r),r.push(t);let s=t.data;f(s.vertexArray)?this._hasLoadedTilesThisFrame=!0:this._hasFillTilesThisFrame=!0;let a=this._debug;++a.tilesRendered,a.texturesRendered+=i};var drt=[new m,new m,new m,new m];function Wpe(t,n,i,o,r,s){let a=t.quadtree._occluders.ellipsoid,c=a.ellipsoid,l=drt;return m.fromRadians(i.west,i.south,r,c,l[0]),m.fromRadians(i.east,i.south,r,c,l[1]),m.fromRadians(i.west,i.north,r,c,l[2]),m.fromRadians(i.east,i.north,r,c,l[3]),a.computeHorizonCullingPointPossiblyUnderEllipsoid(n,l,o,s)}Ho.prototype.computeDistanceToTile=function(t,n){hrt(t,this,n);let i=t.data;if(i.boundingVolumeSourceTile===void 0)return 9999999999;let r=i.tileBoundingRegion,s=r.minimumHeight,a=r.maximumHeight;if(i.boundingVolumeSourceTile!==t){let l=n.camera.positionCartographic.height,u=Math.abs(l-s),d=Math.abs(l-a);u>d?(r.minimumHeight=s,r.maximumHeight=s):(r.minimumHeight=a,r.maximumHeight=a)}let c=r.distanceToCamera(n);return r.minimumHeight=s,r.maximumHeight=a,c};function hrt(t,n,i){let o=t.data;o===void 0&&(o=t.data=new Td);let r=t.tilingScheme.ellipsoid;o.tileBoundingRegion===void 0&&(o.tileBoundingRegion=new Hf({computeBoundingVolumes:!1,rectangle:t.rectangle,ellipsoid:r,minimumHeight:0,maximumHeight:0}));let s=o.tileBoundingRegion,a=s.minimumHeight,c=s.maximumHeight,l=!1,u=t,d=o.mesh,h=o.terrainData;if(d!==void 0&&d.minimumHeight!==void 0&&d.maximumHeight!==void 0)s.minimumHeight=d.minimumHeight,s.maximumHeight=d.maximumHeight,l=!0;else if(h!==void 0&&h._minimumHeight!==void 0&&h._maximumHeight!==void 0)s.minimumHeight=h._minimumHeight,s.maximumHeight=h._maximumHeight;else{s.minimumHeight=Number.NaN,s.maximumHeight=Number.NaN;let _=t.parent;for(;_!==void 0;){let y=_.data;if(y!==void 0){let p=y.mesh,C=y.terrainData;if(p!==void 0&&p.minimumHeight!==void 0&&p.maximumHeight!==void 0){s.minimumHeight=p.minimumHeight,s.maximumHeight=p.maximumHeight;break}else if(C!==void 0&&C._minimumHeight!==void 0&&C._maximumHeight!==void 0){s.minimumHeight=C._minimumHeight,s.maximumHeight=C._maximumHeight;break}}_=_.parent}u=_}if(u!==void 0){let _=i.terrainExaggeration,y=i.terrainExaggerationRelativeHeight;if(_!==1&&(l=!1,s.minimumHeight=kc.getHeight(s.minimumHeight,_,y),s.maximumHeight=kc.getHeight(s.maximumHeight,_,y)),l)o.boundingVolumeIsFromMesh||(s._orientedBoundingBox=_i.clone(d.orientedBoundingBox,s._orientedBoundingBox),s._boundingSphere=ae.clone(d.boundingSphere3D,s._boundingSphere),o.occludeePointInScaledSpace=m.clone(d.occludeePointInScaledSpace,o.occludeePointInScaledSpace),f(o.occludeePointInScaledSpace)||(o.occludeePointInScaledSpace=Wpe(n,s._orientedBoundingBox.center,t.rectangle,s.minimumHeight,s.maximumHeight,o.occludeePointInScaledSpace)));else{let C=s._orientedBoundingBox===void 0||s._boundingSphere===void 0;(s.minimumHeight!==a||s.maximumHeight!==c||C)&&(s.computeBoundingVolumes(r),o.occludeePointInScaledSpace=Wpe(n,s._orientedBoundingBox.center,t.rectangle,s.minimumHeight,s.maximumHeight,o.occludeePointInScaledSpace))}o.boundingVolumeSourceTile=u,o.boundingVolumeIsFromMesh=l}else o.boundingVolumeSourceTile=void 0,o.boundingVolumeIsFromMesh=!1}Ho.prototype.isDestroyed=function(){return!1};Ho.prototype.destroy=function(){return this._tileProvider=this._tileProvider&&this._tileProvider.destroy(),this._clippingPlanes=this._clippingPlanes&&this._clippingPlanes.destroy(),ue(this)};function mrt(t,n,i){return function(o){let r,s,a=-1,c=o.data.imagery,l=c.length,u;for(u=0;u<l;++u)if(r=c[u],s=A(r.readyImagery,r.loadingImagery),s.imageryLayer===n){a=u;break}if(a!==-1){let d=a+t;if(r=c[d],s=f(r)?A(r.readyImagery,r.loadingImagery):void 0,!f(s)||s.imageryLayer!==n)return!n._createTileImagerySkeletons(o,i,d);for(u=a;u<d;++u)c[u].freeResources();c.splice(a,t)}return!0}}Ho.prototype._onLayerAdded=function(t,n){if(t.show){let i=this._terrainProvider,o=this,r=t.imageryProvider,s=this._imageryLayersUpdatedEvent;r._reload=function(){t._imageryCache={},o._quadtree.forEachLoadedTile(function(a){if(f(a._loadedCallbacks[t._layerIndex]))return;let c,l=a.data.imagery,u=l.length,d=-1,h=0;for(c=0;c<u;++c){let y=l[c];if(A(y.readyImagery,y.loadingImagery).imageryLayer===t)d===-1&&(d=c),++h;else if(d!==-1)break}if(d===-1)return;let _=d+h;t._createTileImagerySkeletons(a,i,_)&&(a._loadedCallbacks[t._layerIndex]=mrt(h,t,i),a.state=js.LOADING)})},this._quadtree.forEachLoadedTile(function(a){t._createTileImagerySkeletons(a,i)&&(a.state=js.LOADING,a.level!==0&&(a._lastSelectionResultFrame!==o.quadtree._lastSelectionFrameNumber||a._lastSelectionResult!==Xn.RENDERED)&&(a.renderable=!1))}),this._layerOrderChanged=!0,s.raiseEvent()}};Ho.prototype._onLayerRemoved=function(t,n){this._quadtree.forEachLoadedTile(function(i){let o=i.data.imagery,r=-1,s=0;for(let a=0,c=o.length;a<c;++a){let l=o[a],u=l.loadingImagery;if(f(u)||(u=l.readyImagery),u.imageryLayer===t)r===-1&&(r=a),l.freeResources(),++s;else if(r!==-1)break}r!==-1&&o.splice(r,s)}),f(t.imageryProvider)&&(t.imageryProvider._reload=void 0),this._imageryLayersUpdatedEvent.raiseEvent()};Ho.prototype._onLayerMoved=function(t,n,i){this._layerOrderChanged=!0,this._imageryLayersUpdatedEvent.raiseEvent()};Ho.prototype._onLayerShownOrHidden=function(t,n,i){i?this._onLayerAdded(t,n):this._onLayerRemoved(t,n)};var prt=new N,_rt=new N;function jpe(t,n){let i={u_initialColor:function(){return this.properties.initialColor},u_fillHighlightColor:function(){return this.properties.fillHighlightColor},u_zoomedOutOceanSpecularIntensity:function(){return this.properties.zoomedOutOceanSpecularIntensity},u_oceanNormalMap:function(){return this.properties.oceanNormalMap},u_atmosphereLightIntensity:function(){return this.properties.atmosphereLightIntensity},u_atmosphereRayleighCoefficient:function(){return this.properties.atmosphereRayleighCoefficient},u_atmosphereMieCoefficient:function(){return this.properties.atmosphereMieCoefficient},u_atmosphereRayleighScaleHeight:function(){return this.properties.atmosphereRayleighScaleHeight},u_atmosphereMieScaleHeight:function(){return this.properties.atmosphereMieScaleHeight},u_atmosphereMieAnisotropy:function(){return this.properties.atmosphereMieAnisotropy},u_lightingFadeDistance:function(){return this.properties.lightingFadeDistance},u_nightFadeDistance:function(){return this.properties.nightFadeDistance},u_center3D:function(){return this.properties.center3D},u_terrainExaggerationAndRelativeHeight:function(){return this.properties.terrainExaggerationAndRelativeHeight},u_tileRectangle:function(){return this.properties.tileRectangle},u_modifiedModelView:function(){let o=t.context.uniformState.view,r=N.multiplyByPoint(o,this.properties.rtc,Gpe);return N.setTranslation(o,r,Hpe),Hpe},u_modifiedModelViewProjection:function(){let o=t.context.uniformState.view,r=t.context.uniformState.projection,s=N.multiplyByPoint(o,this.properties.rtc,Gpe);return N.setTranslation(o,s,Zk),N.multiply(r,Zk,Zk),Zk},u_dayTextures:function(){return this.properties.dayTextures},u_dayTextureTranslationAndScale:function(){return this.properties.dayTextureTranslationAndScale},u_dayTextureTexCoordsRectangle:function(){return this.properties.dayTextureTexCoordsRectangle},u_dayTextureUseWebMercatorT:function(){return this.properties.dayTextureUseWebMercatorT},u_dayTextureAlpha:function(){return this.properties.dayTextureAlpha},u_dayTextureNightAlpha:function(){return this.properties.dayTextureNightAlpha},u_dayTextureDayAlpha:function(){return this.properties.dayTextureDayAlpha},u_dayTextureBrightness:function(){return this.properties.dayTextureBrightness},u_dayTextureContrast:function(){return this.properties.dayTextureContrast},u_dayTextureHue:function(){return this.properties.dayTextureHue},u_dayTextureSaturation:function(){return this.properties.dayTextureSaturation},u_dayTextureOneOverGamma:function(){return this.properties.dayTextureOneOverGamma},u_dayIntensity:function(){return this.properties.dayIntensity},u_southAndNorthLatitude:function(){return this.properties.southAndNorthLatitude},u_southMercatorYAndOneOverHeight:function(){return this.properties.southMercatorYAndOneOverHeight},u_waterMask:function(){return this.properties.waterMask},u_waterMaskTranslationAndScale:function(){return this.properties.waterMaskTranslationAndScale},u_minMaxHeight:function(){return this.properties.minMaxHeight},u_scaleAndBias:function(){return this.properties.scaleAndBias},u_dayTextureSplit:function(){return this.properties.dayTextureSplit},u_dayTextureCutoutRectangles:function(){return this.properties.dayTextureCutoutRectangles},u_clippingPlanes:function(){let o=n._clippingPlanes;return f(o)&&f(o.texture)?o.texture:t.context.defaultTexture},u_cartographicLimitRectangle:function(){return this.properties.localizedCartographicLimitRectangle},u_clippingPlanesMatrix:function(){let o=n._clippingPlanes,r=f(o)?N.multiply(t.context.uniformState.view,o.modelMatrix,prt):N.IDENTITY;return N.inverseTranspose(r,_rt)},u_clippingPlanesEdgeStyle:function(){let o=this.properties.clippingPlanesEdgeColor;return o.alpha=this.properties.clippingPlanesEdgeWidth,o},u_minimumBrightness:function(){return t.fog.minimumBrightness},u_hsbShift:function(){return this.properties.hsbShift},u_colorsToAlpha:function(){return this.properties.colorsToAlpha},u_frontFaceAlphaByDistance:function(){return this.properties.frontFaceAlphaByDistance},u_backFaceAlphaByDistance:function(){return this.properties.backFaceAlphaByDistance},u_translucencyRectangle:function(){return this.properties.localizedTranslucencyRectangle},u_undergroundColor:function(){return this.properties.undergroundColor},u_undergroundColorAlphaByDistance:function(){return this.properties.undergroundColorAlphaByDistance},u_lambertDiffuseMultiplier:function(){return this.properties.lambertDiffuseMultiplier},properties:{initialColor:new se(0,0,.5,1),fillHighlightColor:new z(0,0,0,0),zoomedOutOceanSpecularIntensity:.5,oceanNormalMap:void 0,lightingFadeDistance:new W(65e5,9e6),nightFadeDistance:new W(1e7,4e7),atmosphereLightIntensity:10,atmosphereRayleighCoefficient:new m(55e-7,13e-6,284e-7),atmosphereMieCoefficient:new m(21e-6,21e-6,21e-6),atmosphereRayleighScaleHeight:1e4,atmosphereMieScaleHeight:3200,atmosphereMieAnisotropy:.9,hsbShift:new m,center3D:void 0,rtc:new m,modifiedModelView:new N,tileRectangle:new se,terrainExaggerationAndRelativeHeight:new W(1,0),dayTextures:[],dayTextureTranslationAndScale:[],dayTextureTexCoordsRectangle:[],dayTextureUseWebMercatorT:[],dayTextureAlpha:[],dayTextureNightAlpha:[],dayTextureDayAlpha:[],dayTextureBrightness:[],dayTextureContrast:[],dayTextureHue:[],dayTextureSaturation:[],dayTextureOneOverGamma:[],dayTextureSplit:[],dayTextureCutoutRectangles:[],dayIntensity:0,colorsToAlpha:[],southAndNorthLatitude:new W,southMercatorYAndOneOverHeight:new W,waterMask:void 0,waterMaskTranslationAndScale:new se,minMaxHeight:new W,scaleAndBias:new N,clippingPlanesEdgeColor:z.clone(z.WHITE),clippingPlanesEdgeWidth:0,localizedCartographicLimitRectangle:new se,frontFaceAlphaByDistance:new se,backFaceAlphaByDistance:new se,localizedTranslucencyRectangle:new se,undergroundColor:z.clone(z.TRANSPARENT),undergroundColorAlphaByDistance:new se,lambertDiffuseMultiplier:0}};return f(n.materialUniformMap)?At(i,n.materialUniformMap):i}function grt(t,n,i){let o=i.data,r,s;if(f(o.vertexArray)?(r=o.mesh,s=o.vertexArray):f(o.fill)&&f(o.fill.vertexArray)&&(r=o.fill.mesh,s=o.fill.vertexArray),!(!f(r)||!f(s))){if(f(o.wireframeVertexArray)){if(o.wireframeVertexArray.mesh===r)return;o.wireframeVertexArray.destroy(),o.wireframeVertexArray=void 0}o.wireframeVertexArray=yrt(t,s,r),o.wireframeVertexArray.mesh=r}}function yrt(t,n,i){let r={indices:i.indices,primitiveType:Re.TRIANGLES};Fn.toWireframe(r);let s=r.indices,a=ut.createIndexBuffer({context:t,typedArray:s,usage:Fe.STATIC_DRAW,indexDatatype:Ne.fromSizeInBytes(s.BYTES_PER_ELEMENT)});return new $n({context:t,attributes:n._attributes,indexBuffer:a})}var Kpe,Jpe,$k;(function(){let t=new Ct({geometry:Ld.fromDimensions({dimensions:new m(2,2,2)})}),n=new Ct({geometry:new H_({radius:1})}),i=new N,o,r;function s(a){return new Sn({geometryInstances:a,appearance:new tn({translucent:!1,flat:!0}),asynchronous:!1})}Kpe=function(a,c){return a===o||($k(),o=a,i=N.fromRotationTranslation(a.halfAxes,a.center,i),t.modelMatrix=i,t.attributes.color=Lt.fromColor(c),r=s(t)),r},Jpe=function(a,c){return a===o||($k(),o=a,i=N.fromTranslation(a.center,i),i=N.multiplyByUniformScale(i,a.radius,i),n.modelMatrix=i,n.attributes.color=Lt.fromColor(c),r=s(n)),r},$k=function(){f(r)&&(r.destroy(),r=void 0,o=void 0)}})();var Art=new se(0,0,0,0),Crt={frameState:void 0,surfaceTile:void 0,numberOfDayTextures:void 0,applyBrightness:void 0,applyContrast:void 0,applyHue:void 0,applySaturation:void 0,applyGamma:void 0,applyAlpha:void 0,applyDayNightAlpha:void 0,applySplit:void 0,showReflectiveOcean:void 0,showOceanWaves:void 0,enableLighting:void 0,dynamicAtmosphereLighting:void 0,dynamicAtmosphereLightingFromSun:void 0,showGroundAtmosphere:void 0,perFragmentGroundAtmosphere:void 0,hasVertexNormals:void 0,useWebMercatorProjection:void 0,enableFog:void 0,enableClippingPlanes:void 0,clippingPlanes:void 0,clippedByBoundaries:void 0,hasImageryLayerCutout:void 0,colorCorrect:void 0,colorToAlpha:void 0,hasGeodeticSurfaceNormals:void 0,hasExaggeration:void 0},xrt=z.TRANSPARENT,Trt=new Pt;function Ert(t,n,i){let o=n.data;f(o.vertexArray)||(o.fill===void 0&&(o.fill=new xv(n)),o.fill.update(t,i));let r=i.creditDisplay,s=o.terrainData;if(f(s)&&f(s.credits)){let lt=s.credits;for(let Yt=0,si=lt.length;Yt<si;++Yt)r.addCredit(lt[Yt])}let a=Ut.maximumTextureImageUnits,c=o.waterMaskTexture,l=o.waterMaskTranslationAndScale;!f(c)&&f(o.fill)&&(c=o.fill.waterMaskTexture,l=o.fill.waterMaskTranslationAndScale);let u=i.cameraUnderground,d=i.globeTranslucencyState,h=d.translucent,_=d.frontFaceAlphaByDistance,y=d.backFaceAlphaByDistance,p=d.rectangle,C=A(t.undergroundColor,xrt),x=A(t.undergroundColorAlphaByDistance,Trt),T=Xpe(t,i)&&i.mode===ne.SCENE3D&&C.alpha>0&&(x.nearValue>0||x.farValue>0),E=t.lambertDiffuseMultiplier,S=t.hasWaterMask&&f(c),w=t.oceanNormalMap,D=S&&f(w),I=t.terrainProvider.ready&&t.terrainProvider.hasVertexNormals,O=i.fog.enabled&&i.fog.renderable&&!u,M=t.showGroundAtmosphere&&i.mode===ne.SCENE3D,L=gn.castShadows(t.shadows)&&!h,F=gn.receiveShadows(t.shadows)&&!h,g=t.hueShift,b=t.saturationShift,v=t.brightnessShift,P=!(B.equalsEpsilon(g,0,B.EPSILON7)&&B.equalsEpsilon(b,0,B.EPSILON7)&&B.equalsEpsilon(v,0,B.EPSILON7)),R=!1;if(M){let lt=m.magnitude(i.camera.positionWC),Yt=t.nightFadeOutDistance;R=lt>Yt}S&&--a,D&&--a,f(i.shadowState)&&i.shadowState.shadowsEnabled&&--a,f(t.clippingPlanes)&&t.clippingPlanes.enabled&&--a,a-=d.numberOfTextureUniforms;let V=o.renderedMesh,H=V.center,U=V.encoding,G=o.tileBoundingRegion,k=i.terrainExaggeration,X=i.terrainExaggerationRelativeHeight,Y=k!==1,K=U.hasGeodeticSurfaceNormals,j=srt,Z=0,Q=0,me=0,_e=0,re=!1;if(i.mode!==ne.SCENE3D){let lt=i.mapProjection,Yt=lt.project(le.southwest(n.rectangle),urt),si=lt.project(le.northeast(n.rectangle),frt);if(j.x=Yt.x,j.y=Yt.y,j.z=si.x,j.w=si.y,i.mode!==ne.MORPHING&&(H=lrt,H.x=0,H.y=(j.z+j.x)*.5,H.z=(j.w+j.y)*.5,j.x-=H.y,j.y-=H.z,j.z-=H.y,j.w-=H.z),i.mode===ne.SCENE2D&&U.quantization===Hs.BITS12){let ye=1/(Math.pow(2,12)-1)*.5,Oe=(j.z-j.x)*ye,Ye=(j.w-j.y)*ye;j.x-=Oe,j.y-=Ye,j.z+=Oe,j.w+=Ye}lt instanceof bi&&(Z=n.rectangle.south,Q=n.rectangle.north,me=bi.geodeticLatitudeToMercatorAngle(Z),_e=1/(bi.geodeticLatitudeToMercatorAngle(Q)-me),re=!0)}let fe=Crt;fe.frameState=i,fe.surfaceTile=o,fe.showReflectiveOcean=S,fe.showOceanWaves=D,fe.enableLighting=t.enableLighting,fe.dynamicAtmosphereLighting=t.dynamicAtmosphereLighting,fe.dynamicAtmosphereLightingFromSun=t.dynamicAtmosphereLightingFromSun,fe.showGroundAtmosphere=M,fe.atmosphereLightIntensity=t.atmosphereLightIntensity,fe.atmosphereRayleighCoefficient=t.atmosphereRayleighCoefficient,fe.atmosphereMieCoefficient=t.atmosphereMieCoefficient,fe.atmosphereRayleighScaleHeight=t.atmosphereRayleighScaleHeight,fe.atmosphereMieScaleHeight=t.atmosphereMieScaleHeight,fe.atmosphereMieAnisotropy=t.atmosphereMieAnisotropy,fe.perFragmentGroundAtmosphere=R,fe.hasVertexNormals=I,fe.useWebMercatorProjection=re,fe.clippedByBoundaries=o.clippedByBoundaries,fe.hasGeodeticSurfaceNormals=K,fe.hasExaggeration=Y;let ge=o.imagery,be=0,Be=ge.length,ke=t.showSkirts&&!u&&!h,qe=t.backFaceCulling&&!u&&!h,Nt=qe?t._renderState:t._disableCullingRenderState,Wt=qe?t._blendRenderState:t._disableCullingBlendRenderState,un=Nt,_t=t._firstPassInitialColor,Rn=i.context;if(f(t._debug.boundingSphereTile)||$k(),t._materialUniformMap!==t.materialUniformMap){t._materialUniformMap=t.materialUniformMap;let lt=t._drawCommands.length;for(let Yt=0;Yt<lt;++Yt)t._uniformMaps[Yt]=jpe(i,t)}do{let lt=0,Yt,si;if(t._drawCommands.length<=t._usedDrawCommands?(Yt=new et,Yt.owner=n,Yt.cull=!1,Yt.boundingVolume=new ae,Yt.orientedBoundingBox=void 0,si=jpe(i,t),t._drawCommands.push(Yt),t._uniformMaps.push(si)):(Yt=t._drawCommands[t._usedDrawCommands],si=t._uniformMaps[t._usedDrawCommands]),Yt.owner=n,++t._usedDrawCommands,n===t._debug.boundingSphereTile){let Xs=G.boundingVolume,mr=G.boundingSphere;f(Xs)?Kpe(Xs,z.RED).update(i):f(mr)&&Jpe(mr,z.RED).update(i)}let ye=si.properties;se.clone(_t,ye.initialColor),ye.oceanNormalMap=w,ye.lightingFadeDistance.x=t.lightingFadeOutDistance,ye.lightingFadeDistance.y=t.lightingFadeInDistance,ye.nightFadeDistance.x=t.nightFadeOutDistance,ye.nightFadeDistance.y=t.nightFadeInDistance,ye.atmosphereLightIntensity=t.atmosphereLightIntensity,ye.atmosphereRayleighCoefficient=t.atmosphereRayleighCoefficient,ye.atmosphereMieCoefficient=t.atmosphereMieCoefficient,ye.atmosphereRayleighScaleHeight=t.atmosphereRayleighScaleHeight,ye.atmosphereMieScaleHeight=t.atmosphereMieScaleHeight,ye.atmosphereMieAnisotropy=t.atmosphereMieAnisotropy,ye.zoomedOutOceanSpecularIntensity=t.zoomedOutOceanSpecularIntensity;let Oe=u?y:_,Ye=u?_:y;f(Oe)&&(se.fromElements(Oe.near,Oe.nearValue,Oe.far,Oe.farValue,ye.frontFaceAlphaByDistance),se.fromElements(Ye.near,Ye.nearValue,Ye.far,Ye.farValue,ye.backFaceAlphaByDistance)),se.fromElements(x.near,x.nearValue,x.far,x.farValue,ye.undergroundColorAlphaByDistance),z.clone(C,ye.undergroundColor),ye.lambertDiffuseMultiplier=E;let Xt=!f(o.vertexArray)&&f(t.fillHighlightColor)&&t.fillHighlightColor.alpha>0;Xt&&z.clone(t.fillHighlightColor,ye.fillHighlightColor),ye.terrainExaggerationAndRelativeHeight.x=k,ye.terrainExaggerationAndRelativeHeight.y=X,ye.center3D=V.center,m.clone(H,ye.rtc),se.clone(j,ye.tileRectangle),ye.southAndNorthLatitude.x=Z,ye.southAndNorthLatitude.y=Q,ye.southMercatorYAndOneOverHeight.x=me,ye.southMercatorYAndOneOverHeight.y=_e;let En=art,Vi=Qk(n.rectangle,t.cartographicLimitRectangle),ki=crt,Xi=Qk(n.rectangle,p);m.fromElements(g,b,v,ye.hsbShift);let li=n.rectangle,Le=1/li.width,nt=1/li.height;En.x=(Vi.west-li.west)*Le,En.y=(Vi.south-li.south)*nt,En.z=(Vi.east-li.west)*Le,En.w=(Vi.north-li.south)*nt,se.clone(En,ye.localizedCartographicLimitRectangle),ki.x=(Xi.west-li.west)*Le,ki.y=(Xi.south-li.south)*nt,ki.z=(Xi.east-li.west)*Le,ki.w=(Xi.north-li.south)*nt,se.clone(ki,ye.localizedTranslucencyRectangle);let Qe=O&&B.fog(n._distance,i.fog.density)>B.EPSILON3;P=P&&(Qe||M);let Xe=!1,dt=!1,Mt=!1,bn=!1,To=!1,Go=!1,Kr=!1,As=!1,io=!1,Ri=!1;for(;lt<a&&be<Be;){let Xs=ge[be],mr=Xs.readyImagery;if(++be,!f(mr)||mr.imageryLayer.alpha===0)continue;let ha=Xs.useWebMercatorT?mr.textureWebMercator:mr.texture,or=mr.imageryLayer;f(Xs.textureTranslationAndScale)||(Xs.textureTranslationAndScale=or._calculateTextureTranslationAndScale(n,Xs)),ye.dayTextures[lt]=ha,ye.dayTextureTranslationAndScale[lt]=Xs.textureTranslationAndScale,ye.dayTextureTexCoordsRectangle[lt]=Xs.textureCoordinateRectangle,ye.dayTextureUseWebMercatorT[lt]=Xs.useWebMercatorT,ye.dayTextureAlpha[lt]=or.alpha,Go=Go||ye.dayTextureAlpha[lt]!==1,ye.dayTextureNightAlpha[lt]=or.nightAlpha,Kr=Kr||ye.dayTextureNightAlpha[lt]!==1,ye.dayTextureDayAlpha[lt]=or.dayAlpha,Kr=Kr||ye.dayTextureDayAlpha[lt]!==1,ye.dayTextureBrightness[lt]=or.brightness,Xe=Xe||ye.dayTextureBrightness[lt]!==lf.DEFAULT_BRIGHTNESS,ye.dayTextureContrast[lt]=or.contrast,dt=dt||ye.dayTextureContrast[lt]!==lf.DEFAULT_CONTRAST,ye.dayTextureHue[lt]=or.hue,Mt=Mt||ye.dayTextureHue[lt]!==lf.DEFAULT_HUE,ye.dayTextureSaturation[lt]=or.saturation,bn=bn||ye.dayTextureSaturation[lt]!==lf.DEFAULT_SATURATION,ye.dayTextureOneOverGamma[lt]=1/or.gamma,To=To||ye.dayTextureOneOverGamma[lt]!==1/lf.DEFAULT_GAMMA,ye.dayTextureSplit[lt]=or.splitDirection,As=As||ye.dayTextureSplit[lt]!==0;let Oc=ye.dayTextureCutoutRectangles[lt];if(f(Oc)||(Oc=ye.dayTextureCutoutRectangles[lt]=new se),se.clone(se.ZERO,Oc),f(or.cutoutRectangle)){let Cs=Qk(li,or.cutoutRectangle),Zh=le.simpleIntersection(Cs,li,Ype);io=f(Zh)||io,Oc.x=(Cs.west-li.west)*Le,Oc.y=(Cs.south-li.south)*nt,Oc.z=(Cs.east-li.west)*Le,Oc.w=(Cs.north-li.south)*nt}let Rc=ye.colorsToAlpha[lt];f(Rc)||(Rc=ye.colorsToAlpha[lt]=new se);let fb=f(or.colorToAlpha)&&or.colorToAlphaThreshold>0;if(Ri=Ri||fb,fb){let Cs=or.colorToAlpha;Rc.x=Cs.red,Rc.y=Cs.green,Rc.z=Cs.blue,Rc.w=or.colorToAlphaThreshold}else Rc.w=-1;if(f(mr.credits)){let Cs=mr.credits;for(let Zh=0,UA=Cs.length;Zh<UA;++Zh)r.addCredit(Cs[Zh])}++lt}ye.dayTextures.length=lt,ye.waterMask=c,se.clone(l,ye.waterMaskTranslationAndScale),ye.minMaxHeight.x=U.minimumHeight,ye.minMaxHeight.y=U.maximumHeight,N.clone(U.matrix,ye.scaleAndBias);let hr=t._clippingPlanes,Dr=f(hr)&&hr.enabled&&n.isClipped;Dr&&(ye.clippingPlanesEdgeColor=z.clone(hr.edgeColor,ye.clippingPlanesEdgeColor),ye.clippingPlanesEdgeWidth=hr.edgeWidth),fe.numberOfDayTextures=lt,fe.applyBrightness=Xe,fe.applyContrast=dt,fe.applyHue=Mt,fe.applySaturation=bn,fe.applyGamma=To,fe.applyAlpha=Go,fe.applyDayNightAlpha=Kr,fe.applySplit=As,fe.enableFog=Qe,fe.enableClippingPlanes=Dr,fe.clippingPlanes=hr,fe.hasImageryLayerCutout=io,fe.colorCorrect=P,fe.highlightFillTile=Xt,fe.colorToAlpha=Ri,fe.showUndergroundColor=T,fe.translucent=h;let ru=o.renderedMesh.indices.length;ke||(ru=o.renderedMesh.indexCountWithoutSkirts),Yt.shaderProgram=t._surfaceShaderSet.getShaderProgram(fe),Yt.castShadows=L,Yt.receiveShadows=F,Yt.renderState=un,Yt.primitiveType=Re.TRIANGLES,Yt.vertexArray=o.vertexArray||o.fill.vertexArray,Yt.count=ru,Yt.uniformMap=si,Yt.pass=Te.GLOBE,t._debug.wireframe&&(grt(Rn,t,n),f(o.wireframeVertexArray)&&(Yt.vertexArray=o.wireframeVertexArray,Yt.primitiveType=Re.LINES,Yt.count=ru*2));let Ui=Yt.boundingVolume,Ur=Yt.orientedBoundingBox;i.mode!==ne.SCENE3D?(ae.fromRectangleWithHeights2D(n.rectangle,i.mapProjection,G.minimumHeight,G.maximumHeight,Ui),m.fromElements(Ui.center.z,Ui.center.x,Ui.center.y,Ui.center),i.mode===ne.MORPHING&&(Ui=ae.union(G.boundingSphere,Ui,Ui))):(Yt.boundingVolume=ae.clone(G.boundingSphere,Ui),Yt.orientedBoundingBox=_i.clone(G.boundingVolume,Ur)),Yt.dirty=!0,h&&d.updateDerivedCommands(Yt,i),qpe(Yt,i),un=Wt,_t=Art}while(be<Be)}var eU=Ho;function Zpe(){this._enabled=!1,this._frontFaceAlpha=1,this._frontFaceAlphaByDistance=void 0,this._backFaceAlpha=1,this._backFaceAlphaByDistance=void 0,this._rectangle=le.clone(le.MAX_VALUE)}Object.defineProperties(Zpe.prototype,{enabled:{get:function(){return this._enabled},set:function(t){this._enabled=t}},frontFaceAlpha:{get:function(){return this._frontFaceAlpha},set:function(t){this._frontFaceAlpha=t}},frontFaceAlphaByDistance:{get:function(){return this._frontFaceAlphaByDistance},set:function(t){this._frontFaceAlphaByDistance=Pt.clone(t,this._frontFaceAlphaByDistance)}},backFaceAlpha:{get:function(){return this._backFaceAlpha},set:function(t){this._backFaceAlpha=t}},backFaceAlphaByDistance:{get:function(){return this._backFaceAlphaByDistance},set:function(t){this._backFaceAlphaByDistance=Pt.clone(t,this._backFaceAlphaByDistance)}},rectangle:{get:function(){return this._rectangle},set:function(t){f(t)||(t=le.clone(le.MAX_VALUE)),le.clone(t,this._rectangle)}}});var tU=Zpe;function as(){this._layers=[],this.layerAdded=new Ae,this.layerRemoved=new Ae,this.layerMoved=new Ae,this.layerShownOrHidden=new Ae}Object.defineProperties(as.prototype,{length:{get:function(){return this._layers.length}}});as.prototype.add=function(t,n){f(n)?this._layers.splice(n,0,t):(n=this._layers.length,this._layers.push(t)),this._update(),this.layerAdded.raiseEvent(t,n)};as.prototype.addImageryProvider=function(t,n){let i=new lf(t);return this.add(i,n),i};as.prototype.remove=function(t,n){n=A(n,!0);let i=this._layers.indexOf(t);return i!==-1?(this._layers.splice(i,1),this._update(),this.layerRemoved.raiseEvent(t,i),n&&t.destroy(),!0):!1};as.prototype.removeAll=function(t){t=A(t,!0);let n=this._layers;for(let i=0,o=n.length;i<o;i++){let r=n[i];this.layerRemoved.raiseEvent(r,i),t&&r.destroy()}this._layers=[]};as.prototype.contains=function(t){return this.indexOf(t)!==-1};as.prototype.indexOf=function(t){return this._layers.indexOf(t)};as.prototype.get=function(t){return this._layers[t]};function nU(t,n){return t.indexOf(n)}function Qpe(t,n,i){let o=t._layers;if(n=B.clamp(n,0,o.length-1),i=B.clamp(i,0,o.length-1),n===i)return;let r=o[n];o[n]=o[i],o[i]=r,t._update(),t.layerMoved.raiseEvent(r,i,n)}as.prototype.raise=function(t){let n=nU(this._layers,t);Qpe(this,n,n+1)};as.prototype.lower=function(t){let n=nU(this._layers,t);Qpe(this,n,n-1)};as.prototype.raiseToTop=function(t){let n=nU(this._layers,t);n!==this._layers.length-1&&(this._layers.splice(n,1),this._layers.push(t),this._update(),this.layerMoved.raiseEvent(t,this._layers.length-1,n))};as.prototype.lowerToBottom=function(t){let n=nU(this._layers,t);n!==0&&(this._layers.splice(n,1),this._layers.splice(0,0,t),this._update(),this.layerMoved.raiseEvent(t,0,n))};var brt=new le;function $pe(t,n,i,o){let r=t.globe._surface._tilesToRender,s;for(let c=0;!f(s)&&c<r.length;++c){let l=r[c];le.contains(l.rectangle,n)&&(s=l)}if(!f(s))return;let a=s.data.imagery;for(let c=a.length-1;c>=0;--c){let l=a[c],u=l.readyImagery;if(!f(u))continue;let d=u.imageryLayer.imageryProvider;if(i&&!f(d.pickFeatures)||!le.contains(u.rectangle,n))continue;let h=brt,_=1/1024;h.west=B.lerp(s.rectangle.west,s.rectangle.east,l.textureCoordinateRectangle.x-_),h.east=B.lerp(s.rectangle.west,s.rectangle.east,l.textureCoordinateRectangle.z+_),h.south=B.lerp(s.rectangle.south,s.rectangle.north,l.textureCoordinateRectangle.y-_),h.north=B.lerp(s.rectangle.south,s.rectangle.north,l.textureCoordinateRectangle.w+_),le.contains(h,n)&&o(u)}}as.prototype.pickImageryLayers=function(t,n){let i=n.globe.pick(t,n);if(!f(i))return;let o=n.globe.ellipsoid.cartesianToCartographic(i),r=[];if($pe(n,o,!1,function(s){r.push(s.imageryLayer)}),r.length!==0)return r};as.prototype.pickImageryLayerFeatures=function(t,n){let i=n.globe.pick(t,n);if(!f(i))return;let o=n.globe.ellipsoid.cartesianToCartographic(i),r=[],s=[];if($pe(n,o,!0,function(a){let l=a.imageryLayer.imageryProvider.pickFeatures(a.x,a.y,a.level,o.longitude,o.latitude);f(l)&&(r.push(l),s.push(a.imageryLayer))}),r.length!==0)return Promise.all(r).then(function(a){let c=[];for(let l=0;l<a.length;++l){let u=a[l],d=s[l];if(f(u)&&u.length>0)for(let h=0;h<u.length;++h){let _=u[h];_.imageryLayer=d,f(_.position)||(_.position=o),c.push(_)}}return c})};as.prototype.queueReprojectionCommands=function(t){let n=this._layers;for(let i=0,o=n.length;i<o;++i)n[i].queueReprojectionCommands(t)};as.prototype.cancelReprojections=function(){let t=this._layers;for(let n=0,i=t.length;n<i;++n)t[n].cancelReprojections()};as.prototype.isDestroyed=function(){return!1};as.prototype.destroy=function(){return this.removeAll(!0),ue(this)};as.prototype._update=function(){let t=!0,n=this._layers,i,o,r,s;for(r=0,s=n.length;r<s;++r)o=n[r],o._layerIndex=r,o.show?(o._isBaseLayer=t,t=!1):o._isBaseLayer=!1,o.show!==o._show&&(f(o._show)&&(f(i)||(i=[]),i.push(o)),o._show=o.show);if(f(i))for(r=0,s=i.length;r<s;++r)o=i[r],this.layerShownOrHidden.raiseEvent(o,o._layerIndex,o.show)};var iU=as;function e_e(t){this._ellipsoid=new Q_(t.ellipsoid,m.ZERO)}Object.defineProperties(e_e.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}});var oU=e_e;function Dc(t){this._tilingScheme=t.tilingScheme,this._x=t.x,this._y=t.y,this._level=t.level,this._parent=t.parent,this._rectangle=this._tilingScheme.tileXYToRectangle(this._x,this._y,this._level),this._southwestChild=void 0,this._southeastChild=void 0,this._northwestChild=void 0,this._northeastChild=void 0,this.replacementPrevious=void 0,this.replacementNext=void 0,this._distance=0,this._loadPriority=0,this._customData=[],this._frameUpdated=void 0,this._lastSelectionResult=Xn.NONE,this._lastSelectionResultFrame=void 0,this._loadedCallbacks={},this.state=js.START,this.renderable=!1,this.upsampledFromParent=!1,this.data=void 0}Dc.createLevelZeroTiles=function(t){let n=t.getNumberOfXTilesAtLevel(0),i=t.getNumberOfYTilesAtLevel(0),o=new Array(n*i),r=0;for(let s=0;s<i;++s)for(let a=0;a<n;++a)o[r++]=new Dc({tilingScheme:t,x:a,y:s,level:0});return o};Dc.prototype._updateCustomData=function(t,n,i){let o=this.customData,r,s,a;if(f(n)&&f(i)){for(o=o.filter(function(c){return i.indexOf(c)===-1}),this._customData=o,a=this._rectangle,r=0;r<n.length;++r)s=n[r],le.contains(a,s.positionCartographic)&&o.push(s);this._frameUpdated=t}else{let c=this._parent;if(f(c)&&this._frameUpdated!==c._frameUpdated){o.length=0,a=this._rectangle;let l=c.customData;for(r=0;r<l.length;++r)s=l[r],le.contains(a,s.positionCartographic)&&o.push(s);this._frameUpdated=c._frameUpdated}}};Object.defineProperties(Dc.prototype,{tilingScheme:{get:function(){return this._tilingScheme}},x:{get:function(){return this._x}},y:{get:function(){return this._y}},level:{get:function(){return this._level}},parent:{get:function(){return this._parent}},rectangle:{get:function(){return this._rectangle}},children:{get:function(){return[this.northwestChild,this.northeastChild,this.southwestChild,this.southeastChild]}},southwestChild:{get:function(){return f(this._southwestChild)||(this._southwestChild=new Dc({tilingScheme:this.tilingScheme,x:this.x*2,y:this.y*2+1,level:this.level+1,parent:this})),this._southwestChild}},southeastChild:{get:function(){return f(this._southeastChild)||(this._southeastChild=new Dc({tilingScheme:this.tilingScheme,x:this.x*2+1,y:this.y*2+1,level:this.level+1,parent:this})),this._southeastChild}},northwestChild:{get:function(){return f(this._northwestChild)||(this._northwestChild=new Dc({tilingScheme:this.tilingScheme,x:this.x*2,y:this.y*2,level:this.level+1,parent:this})),this._northwestChild}},northeastChild:{get:function(){return f(this._northeastChild)||(this._northeastChild=new Dc({tilingScheme:this.tilingScheme,x:this.x*2+1,y:this.y*2,level:this.level+1,parent:this})),this._northeastChild}},customData:{get:function(){return this._customData}},needsLoading:{get:function(){return this.state<js.DONE}},eligibleForUnloading:{get:function(){let t=!0;return f(this.data)&&(t=this.data.eligibleForUnloading,f(t)||(t=!0)),t}}});Dc.prototype.findLevelZeroTile=function(t,n,i){let o=this.tilingScheme.getNumberOfXTilesAtLevel(0);if(n<0?n+=o:n>=o&&(n-=o),!(i<0||i>=this.tilingScheme.getNumberOfYTilesAtLevel(0)))return t.filter(function(r){return r.x===n&&r.y===i})[0]};Dc.prototype.findTileToWest=function(t){let n=this.parent;if(n===void 0)return this.findLevelZeroTile(t,this.x-1,this.y);if(n.southeastChild===this)return n.southwestChild;if(n.northeastChild===this)return n.northwestChild;let i=n.findTileToWest(t);if(i!==void 0)return n.southwestChild===this?i.southeastChild:i.northeastChild};Dc.prototype.findTileToEast=function(t){let n=this.parent;if(n===void 0)return this.findLevelZeroTile(t,this.x+1,this.y);if(n.southwestChild===this)return n.southeastChild;if(n.northwestChild===this)return n.northeastChild;let i=n.findTileToEast(t);if(i!==void 0)return n.southeastChild===this?i.southwestChild:i.northwestChild};Dc.prototype.findTileToSouth=function(t){let n=this.parent;if(n===void 0)return this.findLevelZeroTile(t,this.x,this.y+1);if(n.northwestChild===this)return n.southwestChild;if(n.northeastChild===this)return n.southeastChild;let i=n.findTileToSouth(t);if(i!==void 0)return n.southwestChild===this?i.northwestChild:i.northeastChild};Dc.prototype.findTileToNorth=function(t){let n=this.parent;if(n===void 0)return this.findLevelZeroTile(t,this.x,this.y-1);if(n.southwestChild===this)return n.northwestChild;if(n.southeastChild===this)return n.northeastChild;let i=n.findTileToNorth(t);if(i!==void 0)return n.northwestChild===this?i.southwestChild:i.southeastChild};Dc.prototype.freeResources=function(){this.state=js.START,this.renderable=!1,this.upsampledFromParent=!1,f(this.data)&&f(this.data.freeResources)&&this.data.freeResources(),rU(this._southwestChild),this._southwestChild=void 0,rU(this._southeastChild),this._southeastChild=void 0,rU(this._northwestChild),this._northwestChild=void 0,rU(this._northeastChild),this._northeastChild=void 0};function rU(t){f(t)&&t.freeResources()}var sU=Dc;function aU(){this.head=void 0,this.tail=void 0,this.count=0,this._lastBeforeStartOfFrame=void 0}aU.prototype.markStartOfRenderFrame=function(){this._lastBeforeStartOfFrame=this.head};aU.prototype.trimTiles=function(t){let n=this.tail,i=!0;for(;i&&f(this._lastBeforeStartOfFrame)&&this.count>t&&f(n);){i=n!==this._lastBeforeStartOfFrame;let o=n.replacementPrevious;n.eligibleForUnloading&&(n.freeResources(),t_e(this,n)),n=o}};function t_e(t,n){let i=n.replacementPrevious,o=n.replacementNext;n===t._lastBeforeStartOfFrame&&(t._lastBeforeStartOfFrame=o),n===t.head?t.head=o:i.replacementNext=o,n===t.tail?t.tail=i:o.replacementPrevious=i,n.replacementPrevious=void 0,n.replacementNext=void 0,--t.count}aU.prototype.markTileRendered=function(t){let n=this.head;if(n===t){t===this._lastBeforeStartOfFrame&&(this._lastBeforeStartOfFrame=t.replacementNext);return}if(++this.count,!f(n)){t.replacementPrevious=void 0,t.replacementNext=void 0,this.head=t,this.tail=t;return}(f(t.replacementPrevious)||f(t.replacementNext))&&t_e(this,t),t.replacementPrevious=void 0,t.replacementNext=n,n.replacementPrevious=t,this.head=t};var cU=aU;function uf(t){this._tileProvider=t.tileProvider,this._tileProvider.quadtree=this,this._debug={enableDebugOutput:!1,maxDepth:0,maxDepthVisited:0,tilesVisited:0,tilesCulled:0,tilesRendered:0,tilesWaitingForChildren:0,lastMaxDepth:-1,lastMaxDepthVisited:-1,lastTilesVisited:-1,lastTilesCulled:-1,lastTilesRendered:-1,lastTilesWaitingForChildren:-1,suspendLodUpdate:!1};let i=this._tileProvider.tilingScheme.ellipsoid;this._tilesToRender=[],this._tileLoadQueueHigh=[],this._tileLoadQueueMedium=[],this._tileLoadQueueLow=[],this._tileReplacementQueue=new cU,this._levelZeroTiles=void 0,this._loadQueueTimeSlice=5,this._tilesInvalidated=!1,this._addHeightCallbacks=[],this._removeHeightCallbacks=[],this._tileToUpdateHeights=[],this._lastTileIndex=0,this._updateHeightsTimeSlice=2,this._cameraPositionCartographic=void 0,this._cameraReferenceFrameOriginCartographic=void 0,this.maximumScreenSpaceError=A(t.maximumScreenSpaceError,2),this.tileCacheSize=A(t.tileCacheSize,100),this.loadingDescendantLimit=20,this.preloadAncestors=!0,this.preloadSiblings=!1,this._occluders=new oU({ellipsoid:i}),this._tileLoadProgressEvent=new Ae,this._lastTileLoadQueueLength=0,this._lastSelectionFrameNumber=void 0}Object.defineProperties(uf.prototype,{tileProvider:{get:function(){return this._tileProvider}},tileLoadProgressEvent:{get:function(){return this._tileLoadProgressEvent}},occluders:{get:function(){return this._occluders}}});uf.prototype.invalidateAllTiles=function(){this._tilesInvalidated=!0};function Srt(t){let n=t._tileReplacementQueue;n.head=void 0,n.tail=void 0,n.count=0,i_e(t);let i=t._levelZeroTiles;if(f(i))for(let o=0;o<i.length;++o){let s=i[o].customData,a=s.length;for(let c=0;c<a;++c){let l=s[c];l.level=0,t._addHeightCallbacks.push(l)}i[o].freeResources()}t._levelZeroTiles=void 0,t._tileProvider.cancelReprojections()}uf.prototype.forEachLoadedTile=function(t){let n=this._tileReplacementQueue.head;for(;f(n);)n.state!==js.START&&t(n),n=n.replacementNext};uf.prototype.forEachRenderedTile=function(t){let n=this._tilesToRender;for(let i=0,o=n.length;i<o;++i)t(n[i])};uf.prototype.updateHeight=function(t,n){let i=this,o={positionOnEllipsoidSurface:void 0,positionCartographic:t,level:-1,callback:n};return o.removeFunc=function(){let r=i._addHeightCallbacks,s=r.length;for(let a=0;a<s;++a)if(r[a]===o){r.splice(a,1);break}i._removeHeightCallbacks.push(o),o.callback&&(o.callback=void 0)},i._addHeightCallbacks.push(o),o.removeFunc};uf.prototype.update=function(t){f(this._tileProvider.update)&&this._tileProvider.update(t)};function i_e(t){let n=t._debug;n.maxDepth=0,n.maxDepthVisited=0,n.tilesVisited=0,n.tilesCulled=0,n.tilesRendered=0,n.tilesWaitingForChildren=0,t._tileLoadQueueHigh.length=0,t._tileLoadQueueMedium.length=0,t._tileLoadQueueLow.length=0}uf.prototype.beginFrame=function(t){!t.passes.render||(this._tilesInvalidated&&(Srt(this),this._tilesInvalidated=!1),this._tileProvider.initialize(t),i_e(this),!this._debug.suspendLodUpdate&&this._tileReplacementQueue.markStartOfRenderFrame())};uf.prototype.render=function(t){let n=t.passes,i=this._tileProvider;n.render&&(i.beginUpdate(t),Prt(this,t),krt(this,t),i.endUpdate(t)),n.pick&&this._tilesToRender.length>0&&i.updateForPick(t)};function wrt(t,n){let i=t._tileLoadQueueHigh.length+t._tileLoadQueueMedium.length+t._tileLoadQueueLow.length;if(i!==t._lastTileLoadQueueLength||t._tilesInvalidated){let r=Ae.prototype.raiseEvent.bind(t._tileLoadProgressEvent,i);n.afterRender.push(()=>(r(),!0)),t._lastTileLoadQueueLength=i}let o=t._debug;o.enableDebugOutput&&!o.suspendLodUpdate&&(o.maxDepth=t._tilesToRender.reduce(function(r,s){return Math.max(r,s.level)},-1),o.tilesRendered=t._tilesToRender.length,(o.tilesVisited!==o.lastTilesVisited||o.tilesRendered!==o.lastTilesRendered||o.tilesCulled!==o.lastTilesCulled||o.maxDepth!==o.lastMaxDepth||o.tilesWaitingForChildren!==o.lastTilesWaitingForChildren||o.maxDepthVisited!==o.lastMaxDepthVisited)&&(console.log(`Visited ${o.tilesVisited}, Rendered: ${o.tilesRendered}, Culled: ${o.tilesCulled}, Max Depth Rendered: ${o.maxDepth}, Max Depth Visited: ${o.maxDepthVisited}, Waiting for children: ${o.tilesWaitingForChildren}`),o.lastTilesVisited=o.tilesVisited,o.lastTilesRendered=o.tilesRendered,o.lastTilesCulled=o.tilesCulled,o.lastMaxDepth=o.maxDepth,o.lastTilesWaitingForChildren=o.tilesWaitingForChildren,o.lastMaxDepthVisited=o.maxDepthVisited))}uf.prototype.endFrame=function(t){!t.passes.render||t.mode===ne.MORPHING||(Lrt(this,t),Vrt(this,t),wrt(this,t))};uf.prototype.isDestroyed=function(){return!1};uf.prototype.destroy=function(){this._tileProvider=this._tileProvider&&this._tileProvider.destroy()};var Ev,n_e=new de;function Drt(t,n){let i=le.center(t.rectangle,n_e),o=i.longitude-Ev.longitude,r=i.latitude-Ev.latitude;i=le.center(n.rectangle,n_e);let s=i.longitude-Ev.longitude,a=i.latitude-Ev.latitude;return o*o+r*r-(s*s+a*a)}var vrt=new m,Tv=[];function Prt(t,n){let i=t._debug;if(i.suspendLodUpdate)return;let o=t._tilesToRender;o.length=0;let r,s=t._tileProvider;if(!f(t._levelZeroTiles))if(s.ready){let C=s.tilingScheme;t._levelZeroTiles=sU.createLevelZeroTiles(C);let x=t._levelZeroTiles.length;if(Tv.length<x)for(Tv=new Array(x),r=0;r<x;++r)Tv[r]===void 0&&(Tv[r]=new bv)}else return;t._occluders.ellipsoid.cameraPosition=n.camera.positionWC;let a,c=t._levelZeroTiles,l=c.length>1?t._occluders:void 0;Ev=n.camera.positionCartographic,c.sort(Drt);let u=t._addHeightCallbacks,d=t._removeHeightCallbacks,h=n.frameNumber,_;if(u.length>0||d.length>0){for(r=0,_=c.length;r<_;++r)a=c[r],a._updateCustomData(h,u,d);u.length=0,d.length=0}let y=n.camera;t._cameraPositionCartographic=y.positionCartographic;let p=N.getTranslation(y.transform,vrt);for(t._cameraReferenceFrameOriginCartographic=t.tileProvider.tilingScheme.ellipsoid.cartesianToCartographic(p,t._cameraReferenceFrameOriginCartographic),r=0,_=c.length;r<_;++r)a=c[r],t._tileReplacementQueue.markTileRendered(a),a.renderable?la(t,a,s,n,l,!1,Tv[r]):(xp(t,t._tileLoadQueueHigh,a,n),++i.tilesWaitingForChildren);t._lastSelectionFrameNumber=h}function xp(t,n,i,o){!i.needsLoading||(t.tileProvider.computeTileLoadPriority!==void 0&&(i._loadPriority=t.tileProvider.computeTileLoadPriority(i,o)),n.push(i))}function bv(){this.allAreRenderable=!0,this.anyWereRenderedLastFrame=!1,this.notYetRenderableCount=0}function o_e(){this.southwest=new bv,this.southeast=new bv,this.northwest=new bv,this.northeast=new bv}o_e.prototype.combine=function(t){let n=this.southwest,i=this.southeast,o=this.northwest,r=this.northeast;t.allAreRenderable=n.allAreRenderable&&i.allAreRenderable&&o.allAreRenderable&&r.allAreRenderable,t.anyWereRenderedLastFrame=n.anyWereRenderedLastFrame||i.anyWereRenderedLastFrame||o.anyWereRenderedLastFrame||r.anyWereRenderedLastFrame,t.notYetRenderableCount=n.notYetRenderableCount+i.notYetRenderableCount+o.notYetRenderableCount+r.notYetRenderableCount};var Oj=new Array(31);for(let t=0;t<Oj.length;++t)Oj[t]=new o_e;function Irt(t,n,i,o,r){let s=t._debug;++s.tilesVisited,t._tileReplacementQueue.markTileRendered(i),i._updateCustomData(n.frameNumber),i.level>s.maxDepthVisited&&(s.maxDepthVisited=i.level);let a=Rrt(t,n,i)<t.maximumScreenSpaceError,c=i.southwestChild,l=i.southeastChild,u=i.northwestChild,d=i.northeastChild,h=t._lastSelectionFrameNumber,_=i._lastSelectionResultFrame===h?i._lastSelectionResult:Xn.NONE,y=t.tileProvider;if(a||o){let p=Xn.originalResult(_)===Xn.RENDERED,C=Xn.originalResult(_)===Xn.CULLED||_===Xn.NONE,x=i.state===js.DONE,T=p||C||x;if(T||f(y.canRenderWithoutLosingDetail)&&(T=y.canRenderWithoutLosingDetail(i)),T){a&&xp(t,t._tileLoadQueueMedium,i,n),lU(t,i),r.allAreRenderable=i.renderable,r.anyWereRenderedLastFrame=_===Xn.RENDERED,r.notYetRenderableCount=i.renderable?0:1,i._lastSelectionResultFrame=n.frameNumber,i._lastSelectionResult=Xn.RENDERED,r.anyWereRenderedLastFrame||t._tileToUpdateHeights.push(i);return}o=!0,a&&xp(t,t._tileLoadQueueHigh,i,n)}if(y.canRefine(i)){if(c.upsampledFromParent&&l.upsampledFromParent&&u.upsampledFromParent&&d.upsampledFromParent){lU(t,i),xp(t,t._tileLoadQueueMedium,i,n),t._tileReplacementQueue.markTileRendered(c),t._tileReplacementQueue.markTileRendered(l),t._tileReplacementQueue.markTileRendered(u),t._tileReplacementQueue.markTileRendered(d),r.allAreRenderable=i.renderable,r.anyWereRenderedLastFrame=_===Xn.RENDERED,r.notYetRenderableCount=i.renderable?0:1,i._lastSelectionResultFrame=n.frameNumber,i._lastSelectionResult=Xn.RENDERED,r.anyWereRenderedLastFrame||t._tileToUpdateHeights.push(i);return}i._lastSelectionResultFrame=n.frameNumber,i._lastSelectionResult=Xn.REFINED;let C=t._tilesToRender.length,x=t._tileLoadQueueLow.length,T=t._tileLoadQueueMedium.length,E=t._tileLoadQueueHigh.length,S=t._tileToUpdateHeights.length;if(Brt(t,c,l,u,d,n,o,r),C!==t._tilesToRender.length){let w=r.allAreRenderable,D=r.anyWereRenderedLastFrame,I=r.notYetRenderableCount,O=!1;if(!w&&!D){let M=t._tilesToRender;for(let F=C;F<M.length;++F){let g=M[F];for(;g!==void 0&&g._lastSelectionResult!==Xn.KICKED&&g!==i;)g._lastSelectionResult=Xn.kick(g._lastSelectionResult),g=g.parent}t._tilesToRender.length=C,t._tileToUpdateHeights.length=S,lU(t,i),i._lastSelectionResult=Xn.RENDERED;let L=_===Xn.RENDERED;!L&&I>t.loadingDescendantLimit&&(t._tileLoadQueueLow.length=x,t._tileLoadQueueMedium.length=T,t._tileLoadQueueHigh.length=E,xp(t,t._tileLoadQueueMedium,i,n),r.notYetRenderableCount=i.renderable?0:1,O=!0),r.allAreRenderable=i.renderable,r.anyWereRenderedLastFrame=L,L||t._tileToUpdateHeights.push(i),++s.tilesWaitingForChildren}t.preloadAncestors&&!O&&xp(t,t._tileLoadQueueLow,i,n)}return}i._lastSelectionResultFrame=n.frameNumber,i._lastSelectionResult=Xn.RENDERED,lU(t,i),xp(t,t._tileLoadQueueHigh,i,n),r.allAreRenderable=i.renderable,r.anyWereRenderedLastFrame=_===Xn.RENDERED,r.notYetRenderableCount=i.renderable?0:1}function Brt(t,n,i,o,r,s,a,c){let l=s.camera.positionCartographic,u=t._tileProvider,d=t._occluders,h=Oj[n.level],_=h.southwest,y=h.southeast,p=h.northwest,C=h.northeast;l.longitude<n.rectangle.east?l.latitude<n.rectangle.north?(la(t,n,u,s,d,a,_),la(t,i,u,s,d,a,y),la(t,o,u,s,d,a,p),la(t,r,u,s,d,a,C)):(la(t,o,u,s,d,a,p),la(t,n,u,s,d,a,_),la(t,r,u,s,d,a,C),la(t,i,u,s,d,a,y)):l.latitude<n.rectangle.north?(la(t,i,u,s,d,a,y),la(t,n,u,s,d,a,_),la(t,r,u,s,d,a,C),la(t,o,u,s,d,a,p)):(la(t,r,u,s,d,a,C),la(t,o,u,s,d,a,p),la(t,i,u,s,d,a,y),la(t,n,u,s,d,a,_)),h.combine(c)}function Ort(t,n){let i=n.rectangle;return f(t._cameraPositionCartographic)&&le.contains(i,t._cameraPositionCartographic)||f(t._cameraReferenceFrameOriginCartographic)&&le.contains(i,t._cameraReferenceFrameOriginCartographic)}function la(t,n,i,o,r,s,a){if(i.computeTileVisibility(n,o,r)!==fr.NONE)return Irt(t,o,n,s,a);if(++t._debug.tilesCulled,t._tileReplacementQueue.markTileRendered(n),a.allAreRenderable=!0,a.anyWereRenderedLastFrame=!1,a.notYetRenderableCount=0,Ort(t,n)){(!f(n.data)||!f(n.data.vertexArray))&&xp(t,t._tileLoadQueueMedium,n,o);let c=t._lastSelectionFrameNumber,l=n._lastSelectionResultFrame===c?n._lastSelectionResult:Xn.NONE;l!==Xn.CULLED_BUT_NEEDED&&l!==Xn.RENDERED&&t._tileToUpdateHeights.push(n),n._lastSelectionResult=Xn.CULLED_BUT_NEEDED}else t.preloadSiblings||n.level===0?(xp(t,t._tileLoadQueueLow,n,o),n._lastSelectionResult=Xn.CULLED):n._lastSelectionResult=Xn.CULLED;n._lastSelectionResultFrame=o.frameNumber}function Rrt(t,n,i){if(n.mode===ne.SCENE2D||n.camera.frustum instanceof $t||n.camera.frustum instanceof Br)return Mrt(t,n,i);let o=t._tileProvider.getLevelMaximumGeometricError(i.level),r=i._distance,s=n.context.drawingBufferHeight,a=n.camera.frustum.sseDenominator,c=o*s/(r*a);return n.fog.enabled&&(c-=B.fog(r,n.fog.density)*n.fog.sse),c/=n.pixelRatio,c}function Mrt(t,n,i){let r=n.camera.frustum;f(r._offCenterFrustum)&&(r=r._offCenterFrustum);let s=n.context,a=s.drawingBufferWidth,c=s.drawingBufferHeight,l=t._tileProvider.getLevelMaximumGeometricError(i.level),u=Math.max(r.top-r.bottom,r.right-r.left)/Math.max(a,c),d=l/u;return n.fog.enabled&&n.mode!==ne.SCENE2D&&(d-=B.fog(i._distance,n.fog.density)*n.fog.sse),d/=n.pixelRatio,d}function lU(t,n){t._tilesToRender.push(n)}function Lrt(t,n){let i=t._tileLoadQueueHigh,o=t._tileLoadQueueMedium,r=t._tileLoadQueueLow;if(i.length===0&&o.length===0&&r.length===0)return;t._tileReplacementQueue.trimTiles(t.tileCacheSize);let s=Fi()+t._loadQueueTimeSlice,a=t._tileProvider,c=Ij(t,n,a,s,i,!1);c=Ij(t,n,a,s,o,c),Ij(t,n,a,s,r,c)}function Frt(t,n){return t._loadPriority-n._loadPriority}function Ij(t,n,i,o,r,s){i.computeTileLoadPriority!==void 0&&r.sort(Frt);for(let a=0,c=r.length;a<c&&(Fi()<o||!s);++a){let l=r[a];t._tileReplacementQueue.markTileRendered(l),i.loadTile(n,l),s=!0}return s}var jE=new dn,Bj=new de,Jg=new m,Nrt=[];function Vrt(t,n){if(!t.tileProvider.ready)return;let i=Nrt;i.length=0;let o=t._tileToUpdateHeights,r=Fi(),s=t._updateHeightsTimeSlice,a=r+s,c=n.mode,l=n.mapProjection,u=t.tileProvider.tilingScheme.ellipsoid,d;for(;o.length>0;){let h=o[0];if(!f(h.data)||!f(h.data.mesh)){let C=h._lastSelectionResultFrame===t._lastSelectionFrameNumber?h._lastSelectionResult:Xn.NONE;(C===Xn.RENDERED||C===Xn.CULLED_BUT_NEEDED)&&i.push(h),o.shift(),t._lastTileIndex=0;continue}let _=h.customData,y=_.length,p=!1;for(d=t._lastTileIndex;d<y;++d){let C=_[d],x=h.data.terrainData,T=f(x)&&x.wasCreatedByUpsampling();if(h.level>C.level&&!T){if(f(C.positionOnEllipsoidSurface)||(C.positionOnEllipsoidSurface=m.fromRadians(C.positionCartographic.longitude,C.positionCartographic.latitude,0,u)),c===ne.SCENE3D){let S=u.geodeticSurfaceNormal(C.positionOnEllipsoidSurface,jE.direction),w=u.getSurfaceNormalIntersectionWithZAxis(C.positionOnEllipsoidSurface,11500,jE.origin);if(!f(w)){let D=0;f(h.data.tileBoundingRegion)&&(D=h.data.tileBoundingRegion.minimumHeight);let I=Math.min(D,-11500),O=m.multiplyByScalar(S,Math.abs(I)+1,Jg);m.subtract(C.positionOnEllipsoidSurface,O,jE.origin)}}else de.clone(C.positionCartographic,Bj),Bj.height=-11500,l.project(Bj,Jg),m.fromElements(Jg.z,Jg.x,Jg.y,Jg),m.clone(Jg,jE.origin),m.clone(m.UNIT_X,jE.direction);let E=h.data.pick(jE,c,l,!1,Jg);f(E)&&(f(C.callback)&&C.callback(E),C.level=h.level)}if(Fi()>=a){p=!0;break}}if(p){t._lastTileIndex=d;break}else t._lastTileIndex=0,o.shift()}for(d=0;d<i.length;d++)o.push(i[d])}function krt(t,n){let i=t._tileProvider,o=t._tilesToRender;for(let r=0,s=o.length;r<s;++r){let a=o[r];i.showTileThisFrame(a,n)}}var uU=uf;function Ed(t){t=A(t,oe.WGS84);let n=new Lg({ellipsoid:t}),i=new iU;this._ellipsoid=t,this._imageryLayerCollection=i,this._surfaceShaderSet=new Hk,this._material=void 0,this._surface=new uU({tileProvider:new eU({terrainProvider:n,imageryLayers:i,surfaceShaderSet:this._surfaceShaderSet})}),this._terrainProvider=n,this._terrainProviderChanged=new Ae,this._undergroundColor=z.clone(z.BLACK),this._undergroundColorAlphaByDistance=new Pt(t.maximumRadius/1e3,0,t.maximumRadius/5,1),this._translucency=new tU,Mj(this),this.show=!0,this._oceanNormalMapResourceDirty=!0,this._oceanNormalMapResource=new Ie({url:Qt("Assets/Textures/waterNormalsSmall.jpg")}),this.maximumScreenSpaceError=2,this.tileCacheSize=100,this.loadingDescendantLimit=20,this.preloadAncestors=!0,this.preloadSiblings=!1,this.fillHighlightColor=void 0,this.enableLighting=!1,this.lambertDiffuseMultiplier=.9,this.dynamicAtmosphereLighting=!0,this.dynamicAtmosphereLightingFromSun=!1,this.showGroundAtmosphere=!0,this.atmosphereLightIntensity=10,this.atmosphereRayleighCoefficient=new m(55e-7,13e-6,284e-7),this.atmosphereMieCoefficient=new m(21e-6,21e-6,21e-6),this.atmosphereRayleighScaleHeight=1e4,this.atmosphereMieScaleHeight=3200,this.atmosphereMieAnisotropy=.9,this.lightingFadeOutDistance=1e7,this.lightingFadeInDistance=2e7,this.nightFadeOutDistance=1e7,this.nightFadeInDistance=5e7,this.showWaterEffect=!0,this.depthTestAgainstTerrain=!1,this.shadows=gn.RECEIVE_ONLY,this.atmosphereHueShift=0,this.atmosphereSaturationShift=0,this.atmosphereBrightnessShift=0,this.terrainExaggeration=1,this.terrainExaggerationRelativeHeight=0,this.showSkirts=!0,this.backFaceCulling=!0,this._oceanNormalMap=void 0,this._zoomedOutOceanSpecularIntensity=void 0}Object.defineProperties(Ed.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},imageryLayers:{get:function(){return this._imageryLayerCollection}},imageryLayersUpdatedEvent:{get:function(){return this._surface.tileProvider.imageryLayersUpdatedEvent}},tilesLoaded:{get:function(){return f(this._surface)?this._surface.tileProvider.ready&&this._surface._tileLoadQueueHigh.length===0&&this._surface._tileLoadQueueMedium.length===0&&this._surface._tileLoadQueueLow.length===0:!0}},baseColor:{get:function(){return this._surface.tileProvider.baseColor},set:function(t){this._surface.tileProvider.baseColor=t}},clippingPlanes:{get:function(){return this._surface.tileProvider.clippingPlanes},set:function(t){this._surface.tileProvider.clippingPlanes=t}},cartographicLimitRectangle:{get:function(){return this._surface.tileProvider.cartographicLimitRectangle},set:function(t){f(t)||(t=le.clone(le.MAX_VALUE)),this._surface.tileProvider.cartographicLimitRectangle=t}},oceanNormalMapUrl:{get:function(){return this._oceanNormalMapResource.url},set:function(t){this._oceanNormalMapResource.url=t,this._oceanNormalMapResourceDirty=!0}},terrainProvider:{get:function(){return this._terrainProvider},set:function(t){t!==this._terrainProvider&&(this._terrainProvider=t,this._terrainProviderChanged.raiseEvent(t),f(this._material)&&Mj(this))}},terrainProviderChanged:{get:function(){return this._terrainProviderChanged}},tileLoadProgressEvent:{get:function(){return this._surface.tileLoadProgressEvent}},material:{get:function(){return this._material},set:function(t){this._material!==t&&(this._material=t,Mj(this))}},undergroundColor:{get:function(){return this._undergroundColor},set:function(t){this._undergroundColor=z.clone(t,this._undergroundColor)}},undergroundColorAlphaByDistance:{get:function(){return this._undergroundColorAlphaByDistance},set:function(t){this._undergroundColorAlphaByDistance=Pt.clone(t,this._undergroundColorAlphaByDistance)}},translucency:{get:function(){return this._translucency}}});function Mj(t){let n=[],i=f(t._material)&&(t._material.shaderSource.match(/slope/)||t._material.shaderSource.match("normalEC")),o=[zg,ZD];f(t._material)&&(!i||t._terrainProvider.requestVertexNormals)?(o.push(t._material.shaderSource),n.push("APPLY_MATERIAL"),t._surface._tileProvider.materialUniformMap=t._material._uniforms):t._surface._tileProvider.materialUniformMap=void 0,o.push(FV),t._surfaceShaderSet.baseVertexShaderSource=new ze({sources:[zg,ZD,NV],defines:n}),t._surfaceShaderSet.baseFragmentShaderSource=new ze({sources:o,defines:n}),t._surfaceShaderSet.material=t._material}function Urt(t){return function(n,i){let o=ae.distanceSquaredTo(n.pickBoundingSphere,t),r=ae.distanceSquaredTo(i.pickBoundingSphere,t);return o-r}}var zrt=[],Hrt={start:0,stop:0};Ed.prototype.pickWorldCoordinates=function(t,n,i,o){i=A(i,!0);let r=n.mode,s=n.mapProjection,a=zrt;a.length=0;let c=this._surface._tilesToRender,l=c.length,u,d;for(d=0;d<l;++d){u=c[d];let _=u.data;if(!f(_))continue;let y=_.pickBoundingSphere;if(r!==ne.SCENE3D)_.pickBoundingSphere=y=ae.fromRectangleWithHeights2D(u.rectangle,s,_.tileBoundingRegion.minimumHeight,_.tileBoundingRegion.maximumHeight,y),m.fromElements(y.center.z,y.center.x,y.center.y,y.center);else if(f(_.renderedMesh))ae.clone(_.tileBoundingRegion.boundingSphere,y);else continue;let p=ji.raySphere(t,y,Hrt);f(p)&&a.push(_)}a.sort(Urt(t.origin));let h;for(l=a.length,d=0;d<l&&(h=a[d].pick(t,n.mode,n.mapProjection,i,o),!f(h));++d);return h};var Grt=new de;Ed.prototype.pick=function(t,n,i){if(i=this.pickWorldCoordinates(t,n,!0,i),f(i)&&n.mode!==ne.SCENE3D){i=m.fromElements(i.y,i.z,i.x,i);let o=n.mapProjection.unproject(i,Grt);i=n.globe.ellipsoid.cartographicToCartesian(o,i)}return i};var Wrt=new m,r_e=new m,jrt=new de,qrt=new dn;function Rj(t,n){return f(t)&&le.contains(t.rectangle,n)?t:void 0}Ed.prototype.getHeight=function(t){let n=this._surface._levelZeroTiles;if(!f(n))return;let i,o,r=n.length;for(o=0;o<r&&(i=n[o],!le.contains(i.rectangle,t));++o);if(o>=r)return;let s=i;for(;f(i);)i=Rj(i._southwestChild,t)||Rj(i._southeastChild,t)||Rj(i._northwestChild,t)||i._northeastChild,f(i)&&f(i.data)&&f(i.data.renderedMesh)&&(s=i);if(i=s,!f(i)||!f(i.data)||!f(i.data.renderedMesh))return;let a=this._surface._tileProvider.tilingScheme.projection,c=this._surface._tileProvider.tilingScheme.ellipsoid,l=m.fromRadians(t.longitude,t.latitude,0,c,Wrt),u=qrt,d=c.geodeticSurfaceNormal(l,u.direction),h=c.getSurfaceNormalIntersectionWithZAxis(l,11500,u.origin);if(!f(h)){let y;f(i.data.tileBoundingRegion)&&(y=i.data.tileBoundingRegion.minimumHeight);let p=Math.min(A(y,0),-11500),C=m.multiplyByScalar(d,Math.abs(p)+1,r_e);m.subtract(l,C,u.origin)}let _=i.data.pick(u,void 0,a,!1,r_e);if(!!f(_))return c.cartesianToCartographic(_,jrt).height};Ed.prototype.update=function(t){!this.show||t.passes.render&&this._surface.update(t)};Ed.prototype.beginFrame=function(t){let n=this._surface,i=n.tileProvider,o=this.terrainProvider,r=this.showWaterEffect&&o.ready&&o.hasWaterMask;if(r&&this._oceanNormalMapResourceDirty){this._oceanNormalMapResourceDirty=!1;let c=this._oceanNormalMapResource,l=c.url;if(f(l)){let u=this;c.fetchImage().then(function(d){l===u._oceanNormalMapResource.url&&(u._oceanNormalMap=u._oceanNormalMap&&u._oceanNormalMap.destroy(),u._oceanNormalMap=new St({context:t.context,source:d}))})}else this._oceanNormalMap=this._oceanNormalMap&&this._oceanNormalMap.destroy()}let s=t.passes,a=t.mode;s.render&&(this.showGroundAtmosphere?this._zoomedOutOceanSpecularIntensity=.4:this._zoomedOutOceanSpecularIntensity=.5,n.maximumScreenSpaceError=this.maximumScreenSpaceError,n.tileCacheSize=this.tileCacheSize,n.loadingDescendantLimit=this.loadingDescendantLimit,n.preloadAncestors=this.preloadAncestors,n.preloadSiblings=this.preloadSiblings,i.terrainProvider=this.terrainProvider,i.lightingFadeOutDistance=this.lightingFadeOutDistance,i.lightingFadeInDistance=this.lightingFadeInDistance,i.nightFadeOutDistance=this.nightFadeOutDistance,i.nightFadeInDistance=this.nightFadeInDistance,i.zoomedOutOceanSpecularIntensity=a===ne.SCENE3D?this._zoomedOutOceanSpecularIntensity:0,i.hasWaterMask=r,i.oceanNormalMap=this._oceanNormalMap,i.enableLighting=this.enableLighting,i.dynamicAtmosphereLighting=this.dynamicAtmosphereLighting,i.dynamicAtmosphereLightingFromSun=this.dynamicAtmosphereLightingFromSun,i.showGroundAtmosphere=this.showGroundAtmosphere,i.atmosphereLightIntensity=this.atmosphereLightIntensity,i.atmosphereRayleighCoefficient=this.atmosphereRayleighCoefficient,i.atmosphereMieCoefficient=this.atmosphereMieCoefficient,i.atmosphereRayleighScaleHeight=this.atmosphereRayleighScaleHeight,i.atmosphereMieScaleHeight=this.atmosphereMieScaleHeight,i.atmosphereMieAnisotropy=this.atmosphereMieAnisotropy,i.shadows=this.shadows,i.hueShift=this.atmosphereHueShift,i.saturationShift=this.atmosphereSaturationShift,i.brightnessShift=this.atmosphereBrightnessShift,i.fillHighlightColor=this.fillHighlightColor,i.showSkirts=this.showSkirts,i.backFaceCulling=this.backFaceCulling,i.undergroundColor=this._undergroundColor,i.undergroundColorAlphaByDistance=this._undergroundColorAlphaByDistance,i.lambertDiffuseMultiplier=this.lambertDiffuseMultiplier,n.beginFrame(t))};Ed.prototype.render=function(t){!this.show||(f(this._material)&&this._material.update(t.context),this._surface.render(t))};Ed.prototype.endFrame=function(t){!this.show||t.passes.render&&this._surface.endFrame(t)};Ed.prototype.isDestroyed=function(){return!1};Ed.prototype.destroy=function(){return this._surfaceShaderSet=this._surfaceShaderSet&&this._surfaceShaderSet.destroy(),this._surface=this._surface&&this._surface.destroy(),this._oceanNormalMap=this._oceanNormalMap&&this._oceanNormalMap.destroy(),ue(this)};var fU=Ed;var tu=`uniform sampler2D colorTexture;
varying vec2 v_textureCoordinates;
void main()
{
gl_FragColor = texture2D(colorTexture, v_textureCoordinates);
}
`;var _A=`uniform highp sampler2D u_depthTexture;
varying vec2 v_textureCoordinates;
void main()
{
gl_FragColor = czm_packDepth(texture2D(u_depthTexture, v_textureCoordinates).r);
}
`;function Wh(){this._picking=!1,this._numSamples=1,this._tempCopyDepthTexture=void 0,this._pickColorFramebuffer=new ci({depthStencil:!0,supportsDepthTexture:!0}),this._outputFramebuffer=new ci({depthStencil:!0,supportsDepthTexture:!0}),this._copyDepthFramebuffer=new ci,this._tempCopyDepthFramebuffer=new ci,this._updateDepthFramebuffer=new ci({createColorAttachments:!1,createDepthAttachments:!1,depthStencil:!0}),this._clearGlobeColorCommand=void 0,this._copyColorCommand=void 0,this._copyDepthCommand=void 0,this._tempCopyDepthCommand=void 0,this._updateDepthCommand=void 0,this._viewport=new He,this._rs=void 0,this._rsBlend=void 0,this._rsUpdate=void 0,this._useScissorTest=!1,this._scissorRectangle=void 0,this._useHdr=void 0,this._clearGlobeDepth=void 0}Object.defineProperties(Wh.prototype,{colorFramebufferManager:{get:function(){return this._picking?this._pickColorFramebuffer:this._outputFramebuffer}},framebuffer:{get:function(){return this.colorFramebufferManager.framebuffer}},depthStencilTexture:{get:function(){return this.colorFramebufferManager.getDepthStencilTexture()}},picking:{get:function(){return this._picking},set:function(t){this._picking=t}}});function Yrt(t){t._pickColorFramebuffer.destroy(),t._outputFramebuffer.destroy(),t._copyDepthFramebuffer.destroy(),t._tempCopyDepthFramebuffer.destroy(),t._updateDepthFramebuffer.destroy()}function s_e(t,n,i,o,r){t._viewport.width=i,t._viewport.height=o;let s=!He.equals(t._viewport,r.viewport),a=s!==t._useScissorTest;t._useScissorTest=s,He.equals(t._scissorRectangle,r.viewport)||(t._scissorRectangle=He.clone(r.viewport,t._scissorRectangle),a=!0),(!f(t._rs)||!He.equals(t._viewport,t._rs.viewport)||a)&&(t._rs=Ve.fromCache({viewport:t._viewport,scissorTest:{enabled:t._useScissorTest,rectangle:t._scissorRectangle}}),t._rsBlend=Ve.fromCache({viewport:t._viewport,scissorTest:{enabled:t._useScissorTest,rectangle:t._scissorRectangle},blending:ln.ALPHA_BLEND}),t._rsUpdate=Ve.fromCache({viewport:t._viewport,scissorTest:{enabled:t._useScissorTest,rectangle:t._scissorRectangle},stencilTest:{enabled:!0,frontFunction:kn.EQUAL,frontOperation:{fail:ft.KEEP,zFail:ft.KEEP,zPass:ft.KEEP},backFunction:kn.NEVER,reference:Ot.CESIUM_3D_TILE_MASK,mask:Ot.CESIUM_3D_TILE_MASK}})),f(t._copyDepthCommand)||(t._copyDepthCommand=n.createViewportQuadCommand(_A,{uniformMap:{u_depthTexture:function(){return t.colorFramebufferManager.getDepthStencilTexture()}},owner:t})),t._copyDepthCommand.framebuffer=t._copyDepthFramebuffer.framebuffer,t._copyDepthCommand.renderState=t._rs,f(t._copyColorCommand)||(t._copyColorCommand=n.createViewportQuadCommand(tu,{uniformMap:{colorTexture:function(){return t.colorFramebufferManager.getColorTexture()}},owner:t})),t._copyColorCommand.renderState=t._rs,f(t._tempCopyDepthCommand)||(t._tempCopyDepthCommand=n.createViewportQuadCommand(_A,{uniformMap:{u_depthTexture:function(){return t._tempCopyDepthTexture}},owner:t})),t._tempCopyDepthCommand.framebuffer=t._tempCopyDepthFramebuffer.framebuffer,t._tempCopyDepthCommand.renderState=t._rs,f(t._updateDepthCommand)||(t._updateDepthCommand=n.createViewportQuadCommand(tu,{uniformMap:{colorTexture:function(){return t._tempCopyDepthFramebuffer.getColorTexture()}},owner:t})),t._updateDepthCommand.framebuffer=t._updateDepthFramebuffer.framebuffer,t._updateDepthCommand.renderState=t._rsUpdate,f(t._clearGlobeColorCommand)||(t._clearGlobeColorCommand=new Qn({color:new z(0,0,0,0),stencil:0,owner:t})),t._clearGlobeColorCommand.framebuffer=t.framebuffer}Wh.prototype.update=function(t,n,i,o,r,s){let a=i.width,c=i.height,l=r?t.halfFloatingPointTexture?je.HALF_FLOAT:je.FLOAT:je.UNSIGNED_BYTE;this._numSamples=o,this.picking?this._pickColorFramebuffer.update(t,a,c):this._outputFramebuffer.update(t,a,c,o,l),this._copyDepthFramebuffer.update(t,a,c),s_e(this,t,a,c,n),t.uniformState.globeDepthTexture=void 0,this._useHdr=r,this._clearGlobeDepth=s};Wh.prototype.prepareColorTextures=function(t,n){!this.picking&&this._numSamples>1&&this._outputFramebuffer.prepareTextures(t,n)};Wh.prototype.executeCopyDepth=function(t,n){f(this._copyDepthCommand)&&(this.prepareColorTextures(t),this._copyDepthCommand.execute(t,n),t.uniformState.globeDepthTexture=this._copyDepthFramebuffer.getColorTexture())};Wh.prototype.executeUpdateDepth=function(t,n,i,o){let r=f(o)?o:n.framebuffer.depthStencilTexture;if(i||r!==this.colorFramebufferManager.getDepthStencilTexture()){if(f(this._updateDepthCommand)){if(!f(this._updateDepthFramebuffer.framebuffer)||this._updateDepthFramebuffer.getDepthStencilTexture()!==r||this._updateDepthFramebuffer.getColorTexture()!==this._copyDepthFramebuffer.getColorTexture()){let s=this._copyDepthFramebuffer.getColorTexture().width,a=this._copyDepthFramebuffer.getColorTexture().height;this._tempCopyDepthFramebuffer.destroy(),this._tempCopyDepthFramebuffer.update(t,s,a);let c=this._copyDepthFramebuffer.getColorTexture();this._updateDepthFramebuffer.setColorTexture(c,0),this._updateDepthFramebuffer.setDepthStencilTexture(r),this._updateDepthFramebuffer.update(t,s,a),s_e(this,t,s,a,n)}this._tempCopyDepthTexture=r,this._tempCopyDepthCommand.execute(t,n),this._updateDepthCommand.execute(t,n)}return}f(this._copyDepthCommand)&&this._copyDepthCommand.execute(t,n)};Wh.prototype.executeCopyColor=function(t,n){f(this._copyColorCommand)&&this._copyColorCommand.execute(t,n)};Wh.prototype.clear=function(t,n,i){let o=this._clearGlobeColorCommand;f(o)&&(z.clone(i,o.color),this.colorFramebufferManager.clear(t,o,n))};Wh.prototype.isDestroyed=function(){return!1};Wh.prototype.destroy=function(){return Yrt(this),f(this._copyColorCommand)&&(this._copyColorCommand.shaderProgram=this._copyColorCommand.shaderProgram.destroy()),f(this._copyDepthCommand)&&(this._copyDepthCommand.shaderProgram=this._copyDepthCommand.shaderProgram.destroy()),f(this._tempCopyDepthCommand)&&(this._tempCopyDepthCommand.shaderProgram=this._tempCopyDepthCommand.shaderProgram.destroy()),f(this._updateDepthCommand)&&(this._updateDepthCommand.shaderProgram=this._updateDepthCommand.shaderProgram.destroy()),ue(this)};var dU=Wh;function gA(){this._framebuffer=new ci({depthStencil:!0,supportsDepthTexture:!0}),this._packedDepthFramebuffer=new ci,this._renderState=void 0,this._packedDepthCommand=void 0,this._clearCommand=void 0,this._viewport=new He,this._useScissorTest=!1,this._scissorRectangle=void 0,this._useHdr=void 0}Object.defineProperties(gA.prototype,{classificationTexture:{get:function(){return this._framebuffer.getColorTexture()}},classificationFramebuffer:{get:function(){return this._framebuffer.framebuffer}},packedDepthFramebuffer:{get:function(){return this._packedDepthFramebuffer.framebuffer}},depthStencilTexture:{get:function(){return this._framebuffer.getDepthStencilTexture()}},depthStencilRenderbuffer:{get:function(){return this._framebuffer.getDepthStencilRenderbuffer()}},packedDepthTexture:{get:function(){return this._packedDepthFramebuffer.getColorTexture()}}});function Xrt(t){t._framebuffer.destroy(),t._packedDepthFramebuffer.destroy()}function Krt(t,n,i,o,r){let s=r?n.halfFloatingPointTexture?je.HALF_FLOAT:je.FLOAT:je.UNSIGNED_BYTE;t._framebuffer.update(n,i,o,1,s),t._packedDepthFramebuffer.update(n,i,o)}function Jrt(t,n,i,o,r){t._viewport.width=i,t._viewport.height=o;let s=!He.equals(t._viewport,r.viewport),a=s!==t._useScissorTest;t._useScissorTest=s,He.equals(t._scissorRectangle,r.viewport)||(t._scissorRectangle=He.clone(r.viewport,t._scissorRectangle),a=!0),(!f(t._renderState)||!He.equals(t._viewport,t._renderState.viewport)||a)&&(t._renderState=Ve.fromCache({viewport:t._viewport,scissorTest:{enabled:t._useScissorTest,rectangle:t._scissorRectangle}})),f(t._packedDepthCommand)||(t._packedDepthCommand=n.createViewportQuadCommand(_A,{uniformMap:{u_depthTexture:function(){return t.depthStencilTexture}},owner:t})),f(t._clearCommand)||(t._clearCommand=new Qn({color:new z(0,0,0,0),depth:1,stencil:0,owner:t})),t._packedDepthCommand.framebuffer=t._packedDepthFramebuffer.framebuffer,t._packedDepthCommand.renderState=t._renderState,t._clearCommand.framebuffer=t.classificationFramebuffer,t._clearCommand.renderState=t._renderState}gA.prototype.updateAndClear=function(t,n,i,o){let r=n.width,s=n.height;Krt(this,i,r,s,t),Jrt(this,i,r,s,o),this._useHdr=t};gA.prototype.clearClassification=function(t,n){this._clearCommand.execute(t,n)};gA.prototype.packDepth=function(t,n){return this._packedDepthCommand.execute(t,n),this.packedDepthTexture};gA.prototype.isDestroyed=function(){return!1};gA.prototype.destroy=function(){return Xrt(this),ue(this)};var hU=gA;var qs={OPAQUE_FRONT_FACE:0,OPAQUE_BACK_FACE:1,DEPTH_ONLY_FRONT_FACE:2,DEPTH_ONLY_BACK_FACE:3,DEPTH_ONLY_FRONT_AND_BACK_FACE:4,TRANSLUCENT_FRONT_FACE:5,TRANSLUCENT_BACK_FACE:6,TRANSLUCENT_FRONT_FACE_MANUAL_DEPTH_TEST:7,TRANSLUCENT_BACK_FACE_MANUAL_DEPTH_TEST:8,PICK_FRONT_FACE:9,PICK_BACK_FACE:10,DERIVED_COMMANDS_MAXIMUM_LENGTH:11},yA=qs.DERIVED_COMMANDS_MAXIMUM_LENGTH,__e=["opaqueFrontFaceCommand","opaqueBackFaceCommand","depthOnlyFrontFaceCommand","depthOnlyBackFaceCommand","depthOnlyFrontAndBackFaceCommand","translucentFrontFaceCommand","translucentBackFaceCommand","translucentFrontFaceManualDepthTestCommand","translucentBackFaceManualDepthTestCommand","pickFrontFaceCommand","pickBackFaceCommand"];function AA(){this._frontFaceAlphaByDistance=new Pt(0,1,0,1),this._backFaceAlphaByDistance=new Pt(0,1,0,1),this._frontFaceTranslucent=!1,this._backFaceTranslucent=!1,this._requiresManualDepthTest=!1,this._sunVisibleThroughGlobe=!1,this._environmentVisible=!1,this._useDepthPlane=!1,this._numberOfTextureUniforms=0,this._globeTranslucencyFramebuffer=void 0,this._rectangle=le.clone(le.MAX_VALUE),this._derivedCommandKey=0,this._derivedCommandsDirty=!1,this._derivedCommandPacks=void 0,this._derivedCommandTypes=new Array(yA),this._derivedBlendCommandTypes=new Array(yA),this._derivedPickCommandTypes=new Array(yA),this._derivedCommandTypesToUpdate=new Array(yA),this._derivedCommandsLength=0,this._derivedBlendCommandsLength=0,this._derivedPickCommandsLength=0,this._derivedCommandsToUpdateLength=0}Object.defineProperties(AA.prototype,{frontFaceAlphaByDistance:{get:function(){return this._frontFaceAlphaByDistance}},backFaceAlphaByDistance:{get:function(){return this._backFaceAlphaByDistance}},translucent:{get:function(){return this._frontFaceTranslucent}},sunVisibleThroughGlobe:{get:function(){return this._sunVisibleThroughGlobe}},environmentVisible:{get:function(){return this._environmentVisible}},useDepthPlane:{get:function(){return this._useDepthPlane}},numberOfTextureUniforms:{get:function(){return this._numberOfTextureUniforms}},rectangle:{get:function(){return this._rectangle}}});AA.prototype.update=function(t){let n=t.globe;if(!f(n)||!n.show){this._frontFaceTranslucent=!1,this._backFaceTranslucent=!1,this._sunVisibleThroughGlobe=!0,this._environmentVisible=!0,this._useDepthPlane=!1;return}this._frontFaceAlphaByDistance=a_e(n.translucency.enabled,n.translucency.frontFaceAlpha,n.translucency.frontFaceAlphaByDistance,this._frontFaceAlphaByDistance),this._backFaceAlphaByDistance=a_e(n.translucency.enabled,n.translucency.backFaceAlpha,n.translucency.backFaceAlphaByDistance,this._backFaceAlphaByDistance),this._frontFaceTranslucent=c_e(n.translucency.enabled,this._frontFaceAlphaByDistance,n),this._backFaceTranslucent=c_e(n.translucency.enabled,this._backFaceAlphaByDistance,n),this._requiresManualDepthTest=est(this,t,n),this._sunVisibleThroughGlobe=Zrt(this,t),this._environmentVisible=Qrt(this,t),this._useDepthPlane=$rt(this,t),this._numberOfTextureUniforms=tst(this),this._rectangle=le.clone(n.translucency.rectangle,this._rectangle),nst(this,t)};function a_e(t,n,i,o){return t?f(i)?(Pt.clone(i,o),o.nearValue*=n,o.farValue*=n,o):(o.nearValue=n,o.farValue=n,o):(o.nearValue=1,o.farValue=1,o)}function c_e(t,n,i){return t&&(i.baseColor.alpha<1||n.nearValue<1||n.farValue<1)}function Zrt(t,n){let i=t._frontFaceTranslucent,o=t._backFaceTranslucent;return i&&(n.cameraUnderground||o)}function Qrt(t,n){return!n.cameraUnderground||t._frontFaceTranslucent}function $rt(t,n){return!n.cameraUnderground&&!t._frontFaceTranslucent}function est(t,n,i){return t._frontFaceTranslucent&&!t._backFaceTranslucent&&!i.depthTestAgainstTerrain&&n.mode!==ne.SCENE2D&&n.context.depthTexture}function tst(t){let n=0;return t._frontFaceTranslucent&&++n,t._requiresManualDepthTest&&++n,n}function nst(t,n){t._derivedCommandsLength=Lj(t,n,!1,!1,t._derivedCommandTypes),t._derivedBlendCommandsLength=Lj(t,n,!0,!1,t._derivedBlendCommandTypes),t._derivedPickCommandsLength=Lj(t,n,!1,!0,t._derivedPickCommandTypes);let i,o=0;for(i=0;i<t._derivedCommandsLength;++i)o|=1<<t._derivedCommandTypes[i];for(i=0;i<t._derivedBlendCommandsLength;++i)o|=1<<t._derivedBlendCommandTypes[i];for(i=0;i<t._derivedPickCommandsLength;++i)o|=1<<t._derivedPickCommandTypes[i];let r=0;for(i=0;i<yA;++i)(o&1<<i)>0&&(t._derivedCommandTypesToUpdate[r++]=i);t._derivedCommandsToUpdateLength=r;let s=o!==t._derivedCommandKey;t._derivedCommandKey=o,t._derivedCommandsDirty=s,!f(t._derivedCommandPacks)&&t._frontFaceTranslucent&&(t._derivedCommandPacks=gst())}function Lj(t,n,i,o,r){let s=0,a=t._frontFaceTranslucent,c=t._backFaceTranslucent;if(!a)return s;let l=n.cameraUnderground,u=t._requiresManualDepthTest,d=o?qs.PICK_FRONT_FACE:u?qs.TRANSLUCENT_FRONT_FACE_MANUAL_DEPTH_TEST:qs.TRANSLUCENT_FRONT_FACE,h=o?qs.PICK_BACK_FACE:u?qs.TRANSLUCENT_BACK_FACE_MANUAL_DEPTH_TEST:qs.TRANSLUCENT_BACK_FACE;return n.mode===ne.SCENE2D?(r[s++]=qs.DEPTH_ONLY_FRONT_FACE,r[s++]=d,s):(c?(i||(r[s++]=qs.DEPTH_ONLY_FRONT_AND_BACK_FACE),l?(r[s++]=d,r[s++]=h):(r[s++]=h,r[s++]=d)):l?(i||(r[s++]=qs.DEPTH_ONLY_BACK_FACE),r[s++]=qs.OPAQUE_FRONT_FACE,r[s++]=h):(i||(r[s++]=qs.DEPTH_ONLY_FRONT_FACE),r[s++]=qs.OPAQUE_BACK_FACE,r[s++]=d),s)}function ff(t,n){let i=t.indexOf(n);i>-1&&t.splice(i,1)}function l_e(t,n){return t.indexOf(n)>-1}function ist(t,n){ff(t.defines,"TRANSLUCENT"),ff(n.defines,"TRANSLUCENT")}function ost(t,n){ff(t.defines,"GROUND_ATMOSPHERE"),ff(n.defines,"GROUND_ATMOSPHERE"),ff(t.defines,"FOG"),ff(n.defines,"FOG"),ff(t.defines,"TRANSLUCENT"),ff(n.defines,"TRANSLUCENT")}function Fj(t,n){if(l_e(n.defines,"TILE_LIMIT_RECTANGLE")||l_e(n.defines,"ENABLE_CLIPPING_PLANES"))return;let i=`void main() 
{ 
    gl_FragColor = vec4(1.0); 
} 
`;n.sources=[i]}function Nj(t,n){let i=n.sources,o=i.length;for(let s=0;s<o;++s)i[s]=ze.replaceMain(i[s],"czm_globe_translucency_main");let r=`

uniform sampler2D u_classificationTexture; 
void main() 
{ 
    vec2 st = gl_FragCoord.xy / czm_viewport.zw; 
#ifdef MANUAL_DEPTH_TEST 
    float logDepthOrDepth = czm_unpackDepth(texture2D(czm_globeDepthTexture, st)); 
    if (logDepthOrDepth != 0.0) 
    { 
        vec4 eyeCoordinate = czm_windowToEyeCoordinates(gl_FragCoord.xy, logDepthOrDepth); 
        float depthEC = eyeCoordinate.z / eyeCoordinate.w; 
        if (v_positionEC.z < depthEC) 
        { 
            discard; 
        } 
    } 
#endif 
    czm_globe_translucency_main(); 
    vec4 classificationColor = texture2D(u_classificationTexture, st); 
    if (classificationColor.a > 0.0) 
    { 
        // Reverse premultiplication process to get the correct composited result of the classification primitives 
        classificationColor.rgb /= classificationColor.a; 
    } 
    gl_FragColor = classificationColor * vec4(classificationColor.aaa, 1.0) + gl_FragColor * (1.0 - classificationColor.a); 
} 
`;i.push(r)}function g_e(t,n){Nj(t,n),ff(t.defines,"GROUND_ATMOSPHERE"),ff(n.defines,"GROUND_ATMOSPHERE"),ff(t.defines,"FOG"),ff(n.defines,"FOG")}function rst(t,n){Nj(t,n),t.defines.push("GENERATE_POSITION"),n.defines.push("MANUAL_DEPTH_TEST")}function sst(t,n){g_e(t,n),t.defines.push("GENERATE_POSITION"),n.defines.push("MANUAL_DEPTH_TEST")}function u_e(t,n){let i=`uniform sampler2D u_classificationTexture; 
void main() 
{ 
    vec2 st = gl_FragCoord.xy / czm_viewport.zw; 
    vec4 pickColor = texture2D(u_classificationTexture, st); 
    if (pickColor == vec4(0.0)) 
    { 
        discard; 
    } 
    gl_FragColor = pickColor; 
} 
`;n.sources=[i]}function ast(t,n,i,o,r,s){if(!f(r))return n;if(!o&&f(i))return i;let a=t.shaderCache.getDerivedShaderProgram(n,s);if(!f(a)){let c=n._attributeLocations,l=n.vertexShaderSource.clone(),u=n.fragmentShaderSource.clone();l.defines=f(l.defines)?l.defines.slice(0):[],u.defines=f(u.defines)?u.defines.slice(0):[],r(l,u),a=t.shaderCache.createDerivedShaderProgram(n,s,{vertexShaderSource:l,fragmentShaderSource:u,attributeLocations:c})}return a}function cst(t){t.cull.face=xi.BACK,t.cull.enabled=!0}function lst(t){t.cull.face=xi.FRONT,t.cull.enabled=!0}function ust(t){t.cull.face=xi.BACK,t.cull.enabled=!0,t.colorMask={red:!1,green:!1,blue:!1,alpha:!1}}function fst(t){t.cull.face=xi.FRONT,t.cull.enabled=!0,t.colorMask={red:!1,green:!1,blue:!1,alpha:!1}}function dst(t){t.cull.enabled=!1,t.colorMask={red:!1,green:!1,blue:!1,alpha:!1}}function f_e(t){t.cull.face=xi.BACK,t.cull.enabled=!0,t.depthMask=!1,t.blending=ln.ALPHA_BLEND}function d_e(t){t.cull.face=xi.FRONT,t.cull.enabled=!0,t.depthMask=!1,t.blending=ln.ALPHA_BLEND}function hst(t){t.cull.face=xi.BACK,t.cull.enabled=!0,t.blending.enabled=!1}function mst(t){t.cull.face=xi.FRONT,t.cull.enabled=!0,t.blending.enabled=!1}function pst(t,n,i,o,r){if(!f(o))return t;if(!i&&f(n))return n;let s=r[t.id];if(!f(s)){let a=Ve.getState(t);o(a),s=Ve.fromCache(a),r[t.id]=s}return s}function qE(t){return{u_classificationTexture:function(){return t._globeTranslucencyFramebuffer.classificationTexture}}}function _st(t,n,i,o,r){return f(r)?!o&&f(i)?i:At(n,r(t),!1):n}function bd(t){this.pass=t.pass,this.pickOnly=t.pickOnly,this.getShaderProgramFunction=t.getShaderProgramFunction,this.getRenderStateFunction=t.getRenderStateFunction,this.getUniformMapFunction=t.getUniformMapFunction,this.renderStateCache={}}function gst(){return[new bd({pass:Te.GLOBE,pickOnly:!1,getShaderProgramFunction:ist,getRenderStateFunction:cst,getUniformMapFunction:void 0}),new bd({pass:Te.GLOBE,pickOnly:!1,getShaderProgramFunction:ost,getRenderStateFunction:lst,getUniformMapFunction:void 0}),new bd({pass:Te.GLOBE,pickOnly:!1,getShaderProgramFunction:Fj,getRenderStateFunction:ust,getUniformMapFunction:void 0}),new bd({pass:Te.GLOBE,pickOnly:!1,getShaderProgramFunction:Fj,getRenderStateFunction:fst,getUniformMapFunction:void 0}),new bd({pass:Te.GLOBE,pickOnly:!1,getShaderProgramFunction:Fj,getRenderStateFunction:dst,getUniformMapFunction:void 0}),new bd({pass:Te.TRANSLUCENT,pickOnly:!1,getShaderProgramFunction:Nj,getRenderStateFunction:f_e,getUniformMapFunction:qE}),new bd({pass:Te.TRANSLUCENT,pickOnly:!1,getShaderProgramFunction:g_e,getRenderStateFunction:d_e,getUniformMapFunction:qE}),new bd({pass:Te.TRANSLUCENT,pickOnly:!1,getShaderProgramFunction:rst,getRenderStateFunction:f_e,getUniformMapFunction:qE}),new bd({pass:Te.TRANSLUCENT,pickOnly:!1,getShaderProgramFunction:sst,getRenderStateFunction:d_e,getUniformMapFunction:qE}),new bd({pass:Te.TRANSLUCENT,pickOnly:!0,getShaderProgramFunction:u_e,getRenderStateFunction:hst,getUniformMapFunction:qE}),new bd({pass:Te.TRANSLUCENT,pickOnly:!0,getShaderProgramFunction:u_e,getRenderStateFunction:mst,getUniformMapFunction:qE})]}var h_e=new Array(yA),m_e=new Array(yA);AA.prototype.updateDerivedCommands=function(t,n){let i=this._derivedCommandTypesToUpdate,o=this._derivedCommandsToUpdateLength;if(o!==0){for(let r=0;r<o;++r)m_e[r]=this._derivedCommandPacks[i[r]],h_e[r]=__e[i[r]];yst(this,t,o,i,h_e,m_e,n)}};function yst(t,n,i,o,r,s,a){let c=n.derivedCommands.globeTranslucency,l=t._derivedCommandsDirty;if(n.dirty||!f(c)||l){n.dirty=!1,f(c)||(c={},n.derivedCommands.globeTranslucency=c);let u=a.frameNumber,d=A(c.uniformMapDirtyFrame,0),h=A(c.shaderProgramDirtyFrame,0),_=A(c.renderStateDirtyFrame,0),y=c.uniformMap!==n.uniformMap,p=c.shaderProgramId!==n.shaderProgram.id,C=c.renderStateId!==n.renderState.id;y&&(c.uniformMapDirtyFrame=u),p&&(c.shaderProgramDirtyFrame=u),C&&(c.renderStateDirtyFrame=u),c.uniformMap=n.uniformMap,c.shaderProgramId=n.shaderProgram.id,c.renderStateId=n.renderState.id;for(let x=0;x<i;++x){let T=s[x],E=o[x],S=r[x],w=c[S],D,I,O;f(w)?(D=w.uniformMap,I=w.shaderProgram,O=w.renderState):(D=void 0,I=void 0,O=void 0),w=et.shallowClone(n,w),c[S]=w;let M=A(w.derivedCommands.uniformMapDirtyFrame,0),L=A(w.derivedCommands.shaderProgramDirtyFrame,0),F=A(w.derivedCommands.renderStateDirtyFrame,0),g=y||M<d,b=p||L<h,v=C||F<_;g&&(w.derivedCommands.uniformMapDirtyFrame=u),b&&(w.derivedCommands.shaderProgramDirtyFrame=u),v&&(w.derivedCommands.renderStateDirtyFrame=u),w.derivedCommands.type=E,w.pass=T.pass,w.pickOnly=T.pickOnly,w.uniformMap=_st(t,n.uniformMap,D,g,T.getUniformMapFunction),w.shaderProgram=ast(a.context,n.shaderProgram,I,b,T.getShaderProgramFunction,S),w.renderState=pst(n.renderState,O,v,T.getRenderStateFunction,T.renderStateCache)}}}AA.prototype.pushDerivedCommands=function(t,n,i){let o=i.passes.pick;if(o&&n)return;let r=this._derivedCommandTypes,s=this._derivedCommandsLength;if(o?(r=this._derivedPickCommandTypes,s=this._derivedPickCommandsLength):n&&(r=this._derivedBlendCommandTypes,s=this._derivedBlendCommandsLength),s===0){i.commandList.push(t);return}let a=t.derivedCommands.globeTranslucency;for(let c=0;c<s;++c){let l=__e[r[c]];i.commandList.push(a[l])}};function y_e(t,n,i,o,r,s,a){for(let c=0;c<n;++c){let l=t[c],u=l.derivedCommands.type;(!f(a)||a.indexOf(u)>-1)&&i(l,o,r,s)}}function p_e(t,n,i,o,r,s){for(let a=0;a<n;++a)i(t[a],o,r,s)}var Ast=[qs.OPAQUE_FRONT_FACE,qs.OPAQUE_BACK_FACE],Cst=[qs.DEPTH_ONLY_FRONT_FACE,qs.DEPTH_ONLY_BACK_FACE,qs.DEPTH_ONLY_FRONT_AND_BACK_FACE];AA.prototype.executeGlobeCommands=function(t,n,i,o,r){let s=o.context,a=t.commands[Te.GLOBE],c=t.indices[Te.GLOBE];c!==0&&(this._globeTranslucencyFramebuffer=i,i.clearClassification(s,r),y_e(a,c,n,o,s,r,Ast))};AA.prototype.executeGlobeClassificationCommands=function(t,n,i,o,r){let s=o.context,a=t.commands[Te.GLOBE],c=t.indices[Te.GLOBE],l=t.commands[Te.TERRAIN_CLASSIFICATION],u=t.indices[Te.TERRAIN_CLASSIFICATION];if(c===0||u===0)return;let d=this._frontFaceTranslucent,h=this._backFaceTranslucent;if((!d||!h)&&p_e(l,u,n,o,s,r),!d&&!h)return;this._globeTranslucencyFramebuffer=i;let _=s.uniformState.globeDepthTexture,y=r.framebuffer;if(r.framebuffer=i.classificationFramebuffer,y_e(a,c,n,o,s,r,Cst),s.depthTexture){let p=i.packDepth(s,r);s.uniformState.globeDepthTexture=p}p_e(l,u,n,o,s,r),s.uniformState.globeDepthTexture=_,r.framebuffer=y};var mU=AA;var A_e=yo(m7(),1);function Vj(){this._image=new Image}Vj.prototype.isReady=function(){return!0};Vj.prototype.shouldDiscardImage=function(t){return t===this._image};function Sv(t){t=A(t,A.EMPTY_OBJECT),this.defaultAlpha=void 0,this.defaultNightAlpha=void 0,this.defaultDayAlpha=void 0,this.defaultBrightness=void 0,this.defaultContrast=void 0,this.defaultHue=void 0,this.defaultSaturation=void 0,this.defaultGamma=void 0,this.defaultMinificationFilter=void 0,this.defaultMagnificationFilter=void 0;let n;if(f(t.metadata))n=t.metadata;else{let s=Ie.createIfNeeded(t.url);n=new Uh(s)}this._metadata=n,this._tileDiscardPolicy=t.tileDiscardPolicy,this._tilingScheme=new Wi({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:2,rectangle:new le(-B.PI,-B.PI,B.PI,B.PI),ellipsoid:t.ellipsoid});let i=t.credit;typeof i=="string"&&(i=new Jt(i)),this._credit=i,this._tileWidth=256,this._tileHeight=256,this._maximumLevel=23,f(this._tileDiscardPolicy)||(this._tileDiscardPolicy=new Vj),this._errorEvent=new Ae,this._ready=!1;let o=this,r;this._readyPromise=n.readyPromise.then(function(s){if(!n.imageryPresent){let a=new he(`The server ${n.url} doesn't have imagery`);return r=qn.reportError(r,o,o._errorEvent,a.message,void 0,void 0,void 0,a),Promise.reject(a)}return qn.reportSuccess(r),o._ready=s,s}).catch(function(s){return r=qn.reportError(r,o,o._errorEvent,s.message,void 0,void 0,void 0,s),Promise.reject(s)})}Object.defineProperties(Sv.prototype,{url:{get:function(){return this._metadata.url}},proxy:{get:function(){return this._metadata.proxy}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){return this._maximumLevel}},minimumLevel:{get:function(){return 0}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return!1}}});Sv.prototype.getTileCredits=function(t,n,i){let o=this._metadata,r=o.getTileInformation(t,n,i);if(f(r)){let s=o.providers[r.imageryProvider];if(f(s))return[s]}};Sv.prototype.requestImage=function(t,n,i,o){let r=this._tileDiscardPolicy._image,s=this._metadata,a=Uh.tileXYToQuadKey(t,n,i),c=s.getTileInformation(t,n,i);if(!f(c)){if(s.isValid(a)){let u=new qo({throttle:o.throttle,throttleByServer:o.throttleByServer,type:o.type,priorityFunction:o.priorityFunction});s.populateSubtree(t,n,i,u);return}return Promise.resolve(r)}if(!c.hasImagery())return Promise.resolve(r);let l=xst(this,c,t,n,i,o).fetchArrayBuffer();if(!!f(l))return l.then(function(u){Y3(s.key,u);let d=new Uint8Array(u),h,_=s.protoImagery;if((!f(_)||!_)&&(h=Tst(d)),!f(h)&&(!f(_)||_)){let y=Est(d);h=y.imageType,d=y.imageData}return!f(h)||!f(d)?r:MC({uint8Array:d,format:h,flipY:!0})})};Sv.prototype.pickFeatures=function(t,n,i,o,r){};function xst(t,n,i,o,r,s){let a=Uh.tileXYToQuadKey(i,o,r),c=n.imageryVersion;return c=f(c)&&c>0?c:1,t._metadata.resource.getDerivedResource({url:`flatfile?f1-0${a}-i.${c.toString()}`,request:s})}function Tst(t){let n="JFIF";if(t[6]===n.charCodeAt(0)&&t[7]===n.charCodeAt(1)&&t[8]===n.charCodeAt(2)&&t[9]===n.charCodeAt(3))return"image/jpeg";let i="PNG";if(t[1]===i.charCodeAt(0)&&t[2]===i.charCodeAt(1)&&t[3]===i.charCodeAt(2))return"image/png"}function Est(t){let n=A_e.Reader.create(t),i=n.len,o={};for(;n.pos<i;){let a=n.uint32(),c;switch(a>>>3){case 1:o.imageType=n.uint32();break;case 2:o.imageData=n.bytes();break;case 3:o.alphaType=n.uint32();break;case 4:o.imageAlpha=n.bytes();break;case 5:if(c=o.copyrightIds,f(c)||(c=o.copyrightIds=[]),(a&7)===2){let l=n.uint32()+n.pos;for(;n.pos<l;)c.push(n.uint32())}else c.push(n.uint32());break;default:n.skipType(a&7);break}}let r=o.imageType;if(f(r))switch(r){case 0:o.imageType="image/jpeg";break;case 4:o.imageType="image/png";break;default:throw new he("GoogleEarthEnterpriseImageryProvider: Unsupported image type.")}let s=o.alphaType;return f(s)&&s!==0&&(console.log("GoogleEarthEnterpriseImageryProvider: External alpha not supported."),delete o.alphaType,delete o.imageAlpha),o}var C_e=Sv;var bst=new z(1,1,1,.4),Sst=new z(0,1,0,.05),wst=new z(0,.5,0,.2);function CA(t){t=A(t,A.EMPTY_OBJECT),this.defaultAlpha=void 0,this.defaultNightAlpha=void 0,this.defaultDayAlpha=void 0,this.defaultBrightness=void 0,this.defaultContrast=void 0,this.defaultHue=void 0,this.defaultSaturation=void 0,this.defaultGamma=void 0,this.defaultMinificationFilter=void 0,this.defaultMagnificationFilter=void 0,this._tilingScheme=f(t.tilingScheme)?t.tilingScheme:new Wi({ellipsoid:t.ellipsoid}),this._cells=A(t.cells,8),this._color=A(t.color,bst),this._glowColor=A(t.glowColor,Sst),this._glowWidth=A(t.glowWidth,6),this._backgroundColor=A(t.backgroundColor,wst),this._errorEvent=new Ae,this._tileWidth=A(t.tileWidth,256),this._tileHeight=A(t.tileHeight,256),this._canvasSize=A(t.canvasSize,256),this._canvas=this._createGridCanvas(),this._readyPromise=Promise.resolve(!0)}Object.defineProperties(CA.prototype,{proxy:{get:function(){}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){}},minimumLevel:{get:function(){}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return!0}},readyPromise:{get:function(){return this._readyPromise}},credit:{get:function(){}},hasAlphaChannel:{get:function(){return!0}}});CA.prototype._drawGrid=function(t){let i=this._canvasSize;for(let o=0;o<=this._cells;++o){let s=1+o/this._cells*(i-1);t.moveTo(s,0),t.lineTo(s,i),t.moveTo(0,s),t.lineTo(i,s)}t.stroke()};CA.prototype._createGridCanvas=function(){let t=document.createElement("canvas");t.width=this._canvasSize,t.height=this._canvasSize;let n=0,i=this._canvasSize,o=t.getContext("2d"),r=this._backgroundColor.toCssColorString();o.fillStyle=r,o.fillRect(n,n,i,i);let s=this._glowColor.toCssColorString();o.strokeStyle=s,o.lineWidth=this._glowWidth,o.strokeRect(n,n,i,i),this._drawGrid(o),o.lineWidth=this._glowWidth*.5,o.strokeRect(n,n,i,i),this._drawGrid(o);let a=this._color.toCssColorString();return o.strokeStyle=a,o.lineWidth=2,o.strokeRect(n,n,i,i),o.lineWidth=1,this._drawGrid(o),t};CA.prototype.getTileCredits=function(t,n,i){};CA.prototype.requestImage=function(t,n,i,o){return Promise.resolve(this._canvas)};CA.prototype.pickFeatures=function(t,n,i,o,r){};var x_e=CA;function kj(t,n){this._parent=t,this._dataProvider=t._dataProvider,this._layer=t._layer,f(this._parent._nodeIndex)?this._resource=this._parent._layer.resource.getDerivedResource({url:`nodes/${this._parent._data.mesh.attribute.resource}/${n}`}):this._resource=this._parent.resource.getDerivedResource({url:n})}Object.defineProperties(kj.prototype,{resource:{get:function(){return this._resource}},data:{get:function(){return this._data}}});kj.prototype.load=function(){let t=this;return this._dataProvider._loadJson(this._resource).then(function(n){return t._data=n,n})};var pU=kj;function YE(t,n){this._storageInfo=n,this._parent=t,this._dataProvider=t._dataProvider;let i=`attributes/${n.key}/0`;f(this._parent._nodeIndex)?this._resource=this._parent._layer.resource.getDerivedResource({url:`nodes/${this._parent._data.mesh.attribute.resource}/${i}`}):this._resource=this._parent.resource.getDerivedResource({url:i})}Object.defineProperties(YE.prototype,{resource:{get:function(){return this._resource}},header:{get:function(){return this._header}},values:{get:function(){return f(this._values)&&f(this._values.attributeValues)?this._values.attributeValues:[]}},name:{get:function(){return this._storageInfo.name}}});function Dst(t){return t==="UInt8"||t==="Int8"?1:t==="UInt16"||t==="Int16"?2:t==="UInt32"||t==="Int32"||t==="Oid32"||t==="Float32"?4:t==="UInt64"||t==="Int64"||t==="Float64"?8:0}YE.prototype.load=function(){let t=this;return this._dataProvider._loadBinary(this._resource).then(function(n){let i=new DataView(n),o=!0;if(i.getUint8(0)==="{".charCodeAt(0)&&new TextDecoder().decode(n).includes("404")&&(o=!1,console.error(`Failed to load: ${t.resource.url}`)),o){t._data=n;let r=t._parseHeader(i),s=Dst(t._storageInfo.attributeValues.valueType);s>0&&(r=Math.ceil(r/s)*s),t._parseBody(i,r)}})};YE.prototype._parseValue=function(t,n,i){let o;if(n==="UInt8")o=t.getUint8(i),i+=1;else if(n==="Int8")o=t.getInt8(i),i+=1;else if(n==="UInt16")o=t.getUint16(i,!0),i+=2;else if(n==="Int16")o=t.getInt16(i,!0),i+=2;else if(n==="UInt32")o=t.getUint32(i,!0),i+=4;else if(n==="Oid32")o=t.getUint32(i,!0),i+=4;else if(n==="Int32")o=t.getInt32(i,!0),i+=4;else if(n==="UInt64"){let r=t.getUint32(i,!0),s=t.getUint32(i+4,!0);o=r+Math.pow(2,32)*s,i+=8}else if(n==="Int64"){let r=t.getUint32(i,!0),s=t.getUint32(i+4,!0);s<Math.pow(2,31)?o=r+Math.pow(2,32)*s:o=r+Math.pow(2,32)*(s-Math.pow(2,32)),i+=8}else n==="Float32"?(o=t.getFloat32(i,!0),i+=4):n==="Float64"?(o=t.getFloat64(i,!0),i+=8):n==="String"&&(o=String.fromCharCode(t.getUint8(i)),i+=1);return{value:o,offset:i}};YE.prototype._parseHeader=function(t){let n=0;this._header={};for(let i=0;i<this._storageInfo.header.length;i++){let o=this._storageInfo.header[i],r=this._parseValue(t,o.valueType,n);this._header[o.property]=r.value,n=r.offset}return n};YE.prototype._parseBody=function(t,n){this._values={};for(let i=0;i<this._storageInfo.ordering.length;i++){let o=this._storageInfo.ordering[i],r=this._storageInfo[o];if(f(r)){this._values[o]=[];for(let s=0;s<this._header.count;++s)if(r.valueType!=="String"){let a=this._parseValue(t,r.valueType,n);this._values[o].push(a.value),n=a.offset}else{let a=this._values.attributeByteCounts[s],c="";for(let l=0;l<a;++l){let u=this._parseValue(t,r.valueType,n);u.value.charCodeAt(0)!==0&&(c+=u.value),n=u.offset}this._values[o].push(c)}}}};var _U=YE;function wv(t,n){let i=t._dataProvider,o=t._layer,r;f(t._nodeIndex)?r=o.resource.getDerivedResource({url:`nodes/${t._data.mesh.geometry.resource}/${n}`}):r=t.resource.getDerivedResource({url:n}),this._parent=t,this._dataProvider=i,this._layer=o,this._resource=r,this._customAttributes=void 0}Object.defineProperties(wv.prototype,{resource:{get:function(){return this._resource}},data:{get:function(){return this._data}},customAttributes:{get:function(){return this._customAttributes}}});wv.prototype.load=function(){let t=this;return this._dataProvider._loadBinary(this._resource).then(function(n){return t._data=n,n})};var vst=new m,Pst=new m,Ist=new m,Bst=new m,Ost=new m;function Uj(t,n,i,o){let r=m.subtract(o,i,vst),s=m.cross(r,m.subtract(t,i,Pst),Bst),a=m.cross(r,m.subtract(n,i,Ist),Ost);return m.dot(s,a)>=0}var Rst=new m,Mst=new m,Lst=new m,Fst=new m,Nst=new m,Vst=new m,kst=new m,Ust=new m,zst=new m,Hst=new m;wv.prototype.getClosestPointIndexOnTriangle=function(t,n,i){if(f(this._customAttributes)&&f(this._customAttributes.positions)){let o=new m(t,n,i);o.x-=this._customAttributes.cartesianCenter.x,o.y-=this._customAttributes.cartesianCenter.y,o.z-=this._customAttributes.cartesianCenter.z,$.multiplyByVector(this._customAttributes.parentRotation,o,o);let r=Number.MAX_VALUE,s,a,c,l,u=this._customAttributes.positions,d=this._customAttributes.indices,h;f(d)?h=d.length:h=u.length/3;for(let _=0;_<h;_++){let y,p,C;f(d)?(y=d[_],p=d[_+1],C=d[_+2]):(y=_*3,p=_*3+1,C=_*3+2);let x=m.fromElements(u[y*3],u[y*3+1],u[y*3+2],Rst),T=m.fromElements(u[p*3],u[p*3+1],u[p*3+2],Mst),E=new m(u[C*3],u[C*3+1],u[C*3+2],Lst);if(!Uj(o,x,T,E)||!Uj(o,T,x,E)||!Uj(o,E,x,T))continue;let S=m.subtract(T,x,Fst),w=m.subtract(E,x,Nst),D=m.cross(S,w,Vst);if(m.magnitude(D)===0)continue;let I=m.normalize(D,kst),O=m.subtract(o,x,Ust),M=Math.abs(m.dot(O,I));if(M<r){r=M,s=_;let L=m.magnitudeSquared(m.subtract(o,x,O)),F=m.magnitudeSquared(m.subtract(o,T,zst)),g=m.magnitudeSquared(m.subtract(o,E,Hst));L<F&&L<g?(c=y,l=x,a=L):F<g?(c=p,l=T,a=F):(c=C,l=E,a=g)}}if(f(s))return{index:c,distanceSquared:a,distance:Math.sqrt(a),queriedPosition:o,closestPosition:m.clone(l)}}return{index:-1,distanceSquared:Number.Infinity,distance:Number.Infinity}};wv.prototype._generateGltf=function(t,n,i,o,r,s){let a={pbrMetallicRoughness:{metallicFactor:0},doubleSided:!0,name:"Material"},c=!1,l,u="";if(f(this._parent._data.mesh)&&f(this._layer._data.materialDefinitions)){let C=this._parent._data.mesh.material.definition;if(C>=0&&C<this._layer._data.materialDefinitions.length&&(l=this._layer._data.materialDefinitions[C],a=l,f(a.pbrMetallicRoughness)&&f(a.pbrMetallicRoughness.baseColorTexture))){c=!0,a.pbrMetallicRoughness.baseColorTexture.index=0;let x="0";if(f(this._layer._data.textureSetDefinitions))for(let T=0;T<this._layer._data.textureSetDefinitions.length;T++){let E=this._layer._data.textureSetDefinitions[T];for(let S=0;S<E.formats.length;S++){let w=E.formats[S];if(w.format==="jpg"){x=w.name;break}}}f(this._parent._data.mesh)&&this._parent._data.mesh.material.resource>=0&&(u=this._layer.resource.getDerivedResource({url:`nodes/${this._parent._data.mesh.material.resource}/textures/${x}`}).url)}}else f(this._parent._data.textureData)&&(c=!0,u=this._parent.resource.getDerivedResource({url:`${this._parent._data.textureData[0].href}`}).url,a.pbrMetallicRoughness.baseColorTexture={index:0});let d=[],h=[],_=[];return c&&(d=[{sampler:0,source:0}],h=[{uri:u}],_=[{magFilter:9729,minFilter:9986,wrapS:10497,wrapT:10497}]),{scene:0,scenes:[{nodes:t}],nodes:n,meshes:i,buffers:o,bufferViews:r,accessors:s,materials:[a],textures:d,images:h,samplers:_,asset:{version:"2.0"}}};var Dv=wv;function ml(t,n,i){let o,r,s,a;i?(o=0,r=t):(o=t._level+1,r=t._layer),typeof n=="number"?s=n:a=t.resource.getDerivedResource({url:`${n}/`}),this._parent=t,this._dataProvider=t._dataProvider,this._isRoot=i,this._level=o,this._layer=r,this._nodeIndex=s,this._resource=a,this._tile=void 0,this._data=void 0,this._geometryData=[],this._featureData=[],this._fields={},this._children=[],this._childrenReadyPromise=void 0,this._globalTransform=void 0,this._inverseGlobalTransform=void 0,this._inverseRotationMatrix=void 0}Object.defineProperties(ml.prototype,{resource:{get:function(){return this._resource}},layer:{get:function(){return this._layer}},parent:{get:function(){return this._parent}},children:{get:function(){return this._children}},geometryData:{get:function(){return this._geometryData}},featureData:{get:function(){return this._featureData}},fields:{get:function(){return this._fields}},tile:{get:function(){return this._tile}},data:{get:function(){return this._data}}});ml.prototype.load=function(){let t=this;function n(){if(!t._isRoot){let i=t._create3DTileDefinition();t._tile=new Lu(t._layer._tileset,t._dataProvider.resource,i,t._parent._tile),t._tile._i3sNode=t}}return f(this._nodeIndex)?this._layer._getNodeInNodePages(this._nodeIndex).then(function(i){t._data=i;let o;t._isRoot?o="nodes/root/":f(i.mesh)&&(o=`../${i.mesh.geometry.resource}/`),f(o)&&(t._resource=t._parent.resource.getDerivedResource({url:o})),n()}):this._dataProvider._loadJson(this._resource).then(function(i){t._data=i,n()})};ml.prototype.loadFields=function(){let t=this._layer._data.attributeStorageInfo,n=this;function i(r,s){let a=new _U(n,r[s]);return n._fields[a._storageInfo.name]=a,a.load()}let o=[];if(f(t))for(let r=0;r<t.length;r++)o.push(i(t,r));return Promise.all(o)};ml.prototype.getFieldsForPickedPosition=function(t){let n=this.geometryData[0];if(!f(n.customAttributes.featureIndex))return{};let i=n.getClosestPointIndexOnTriangle(t.x,t.y,t.z);if(i.index===-1||i.index>n.customAttributes.featureIndex.length)return{};let o=n.customAttributes.featureIndex[i.index];return this.getFieldsForFeature(o)};ml.prototype.getFieldsForFeature=function(t){let n={};for(let i in this.fields)if(this.fields.hasOwnProperty(i)){let o=this.fields[i];t>=0&&t<o.values.length&&(n[o.name]=o.values[t])}return n};ml.prototype._loadChildren=function(){let t=this;if(f(this._childrenReadyPromise))return this._childrenReadyPromise;let n=[];if(f(t._data.children))for(let i=0;i<t._data.children.length;i++){let o=t._data.children[i],r=new ml(t,A(o.href,o),!1);t._children.push(r),n.push(r.load())}return this._childrenReadyPromise=Promise.all(n).then(function(){for(let i=0;i<t._children.length;i++)t._tile.children.push(t._children[i]._tile)}),this._childrenReadyPromise};ml.prototype._loadGeometryData=function(){let t=[];if(f(this._data.geometryData))for(let n=0;n<this._data.geometryData.length;n++){let i=new Dv(this,this._data.geometryData[n].href);this._geometryData.push(i),t.push(i.load())}else if(f(this._data.mesh)){let n=this._layer._findBestGeometryBuffers(this._data.mesh.geometry.definition,["position","uv0"]),i=`./geometries/${n.bufferIndex}/`,o=new Dv(this,i);o._geometryDefinitions=n.definition,o._geometryBufferInfo=n.geometryBufferInfo,this._geometryData.push(o),t.push(o.load())}return Promise.all(t)};ml.prototype._loadFeatureData=function(){let t=[];if(f(this._data.featureData))for(let n=0;n<this._data.featureData.length;n++){let i=new pU(this,this._data.featureData[n].href);this._featureData.push(i),t.push(i.load())}return Promise.all(t)};ml.prototype._clearGeometryData=function(){this._geometryData=[]};ml.prototype._create3DTileDefinition=function(){let t=this._data.obb,n=this._data.mbs;if(!f(t)&&!f(n)){console.error("Failed to load I3S node. Bounding volume is required.");return}let i;if(f(t)?i=de.fromDegrees(t.center[0],t.center[1],t.center[2]):i=de.fromDegrees(n[0],n[1],n[2]),f(this._dataProvider._geoidDataList)&&f(i))for(let T=0;T<this._dataProvider._geoidDataList.length;T++){let E=this._dataProvider._geoidDataList[T],S=E.projection.project(i);if(S.x>E.nativeExtent.west&&S.x<E.nativeExtent.east&&S.y>E.nativeExtent.south&&S.y<E.nativeExtent.north){i.height+=Wst(S.x,S.y,E);break}}let o={},r,s=0;f(t)?(o={box:[0,0,0,t.halfSize[0],0,0,0,t.halfSize[1],0,0,0,t.halfSize[2]]},s=Math.max(Math.max(this._data.obb.halfSize[0],this._data.obb.halfSize[1]),this._data.obb.halfSize[2]),r=oe.WGS84.cartographicToCartesian(i)):(o={sphere:[0,0,0,n[3]]},r=oe.WGS84.cartographicToCartesian(i),s=this._data.mbs[3]),s*=2;let a=1/0;if(f(this._data.lodThreshold))if(this._layer._data.nodePages.lodSelectionMetricType==="maxScreenThresholdSQ"){let T=Math.sqrt(this._data.lodThreshold/(Math.PI*.25));a=s/T}else if(this._layer._data.nodePages.lodSelectionMetricType==="maxScreenThreshold"){let T=this._data.lodThreshold;a=s/T}else console.error("Invalid lodSelectionMetricType in Layer");else if(f(this._data.lodSelection))for(let T=0;T<this._data.lodSelection.length;T++)this._data.lodSelection[T].metricType==="maxScreenThreshold"&&(a=s/this._data.lodSelection[T].maxError);a===1/0&&(a=1e5);let c=a*16,l=new yl(0,0,0),u=vt.headingPitchRollQuaternion(r,l);f(this._data.obb)&&(u=new Me(this._data.obb.quaternion[0],this._data.obb.quaternion[1],this._data.obb.quaternion[2],this._data.obb.quaternion[3]));let d=$.fromQuaternion(u),h=$.inverse(d,new $),_=new N(d[0],d[1],d[2],0,d[3],d[4],d[5],0,d[6],d[7],d[8],0,r.x,r.y,r.z,1),y=N.inverse(_,new N),p=N.clone(_);f(this._parent._globalTransform)&&N.multiply(_,this._parent._inverseGlobalTransform,p),this._globalTransform=_,this._inverseGlobalTransform=y,this._inverseRotationMatrix=h;let C=[];for(let T=0;T<this._children.length;T++)C.push(this._children[T]._create3DTileDefinition());return{children:C,refine:"REPLACE",boundingVolume:o,transform:[p[0],p[4],p[8],p[12],p[1],p[5],p[9],p[13],p[2],p[6],p[10],p[14],p[3],p[7],p[11],p[15]],content:{uri:f(this._resource)?this._resource.url:void 0},geometricError:c}};ml.prototype._createI3SDecoderTask=function(t,n){let i=n.geometryData._parent._data,o=n.geometryData._parent._inverseRotationMatrix,r=0,s=0,a=0;f(i.obb)?(r=i.obb.center[0],s=i.obb.center[1],a=i.obb.center[2]):f(i.mbs)&&(r=i.mbs[0],s=i.mbs[1],a=i.mbs[2]);let c=$.fromRotationX(-B.PI_OVER_TWO),l=new $;$.multiply(c,o,l);let u=de.fromDegrees(r,s,a),d=oe.WGS84.cartographicToCartesian(u),h={binaryData:n.geometryData._data,featureData:f(n.featureData)&&f(n.featureData[0])?n.featureData[0].data:void 0,schema:n.defaultGeometrySchema,bufferInfo:n.geometryData._geometryBufferInfo,ellipsoidRadiiSquare:oe.WGS84.radiiSquared,url:n.url,geoidDataList:n.geometryData._dataProvider._geoidDataList,cartographicCenter:u,cartesianCenter:d,parentRotation:l},_=t._getDecoderTaskProcessor(),y=[];return t._taskProcessorReadyPromise.then(function(){return _.scheduleTask(h,y)})};ml.prototype._createContentURL=function(){let t={scene:0,scenes:[{nodes:[0]}],nodes:[{name:"singleNode"}],meshes:[],buffers:[],bufferViews:[],accessors:[],materials:[],textures:[],images:[],samplers:[],asset:{version:"2.0"}},n=[this._loadGeometryData()];this._dataProvider.legacyVersion16&&n.push(this._loadFeatureData());let i=this;return Promise.all(n).then(function(){let o=Promise.resolve();if(f(i._geometryData)&&i._geometryData.length>0){let r={geometryData:i._geometryData[0],featureData:i._featureData,defaultGeometrySchema:i._layer._data.store.defaultGeometrySchema,url:i._geometryData[0].resource.url,tile:i._tile},s=i._createI3SDecoderTask(i._dataProvider,r);if(!f(s))return;o=s.then(function(a){t=r.geometryData._generateGltf(a.meshData.nodesInScene,a.meshData.nodes,a.meshData.meshes,a.meshData.buffers,a.meshData.bufferViews,a.meshData.accessors),i._geometryData[0]._customAttributes=a.meshData._customAttributes})}return o.then(function(){let r=i._dataProvider._binarizeGltf(t),s=new Blob([r],{type:"application/binary"});i._glbURL=URL.createObjectURL(s)})})};Lu.prototype._hookedRequestContent=Lu.prototype.requestContent;Lu.prototype._resolveHookedObject=function(){let t=this;this._hookedRequestContent(),this._contentReadyToProcessPromise.then(function(){t._contentReadyToProcessDefer.resolve()}),this._contentReadyPromise.then(function(n){t._isLoading=!1,t._contentReadyDefer.resolve(n)})};Lu.prototype.requestContent=function(){let t=this;return this.tileset._isI3STileSet?this._isLoading?1:(this._isLoading=!0,this._contentReadyToProcessDefer=Zr(),this._contentReadyDefer=Zr(),this._contentReadyToProcessPromise=this._contentReadyToProcessDefer.promise,this._contentReadyPromise=this._contentReadyDefer.promise,this._i3sNode._createContentURL().then(function(){t._contentResource=new Ie({url:t._i3sNode._glbURL}),t._resolveHookedObject()}),0):this._hookedRequestContent()};function Gst(t,n,i,o,r,s){let a=i*(1-t)+o*t,c=r*(1-t)+s*t;return a*(1-n)+c*n}function gU(t,n,i,o){let r=t+n*i;return o[r]}function Wst(t,n,i){let o=i.nativeExtent,r=(t-o.west)/(o.east-o.west)*(i.width-1),s=(n-o.south)/(o.north-o.south)*(i.height-1),a=Math.floor(r),c=Math.floor(s);r-=a,s-=c;let l=a<i.width?a+1:a,u=c<i.height?c+1:c;c=i.height-1-c,u=i.height-1-u;let d=gU(a,c,i.width,i.buffer),h=gU(l,c,i.width,i.buffer),_=gU(a,u,i.width,i.buffer),y=gU(l,u,i.width,i.buffer),p=Gst(r,s,d,h,_,y);return p=p*i.scale+i.offset,p}Object.defineProperties(Lu.prototype,{i3sNode:{get:function(){return this._i3sNode}}});var vv=ml;function df(t,n,i){this._dataProvider=t,f(n.href)||(n.href=`./layers/${i}`);let o=this._dataProvider.resource.getUrlComponent(),r="";o.match(/layers\/\d/)?r=`${o}`.replace(/\/+$/,""):r=`${o}`.replace(/\/?$/,"/").concat(`${n.href}`),this._version=n.store.version;let s=this._version.split(".");this._majorVersion=parseInt(s[0]),this._minorVersion=s.length>1?parseInt(s[1]):0,this._resource=new Ie({url:r}),this._resource.setQueryParameters(this._dataProvider.resource.queryParameters),this._resource.appendForwardSlash(),this._data=n,this._rootNode=void 0,this._nodePages={},this._nodePageFetches={},this._extent=void 0,this._tileset=void 0,this._geometryDefinitions=void 0,this._computeGeometryDefinitions(!0),this._computeExtent()}Object.defineProperties(df.prototype,{resource:{get:function(){return this._resource}},rootNode:{get:function(){return this._rootNode}},tileset:{get:function(){return this._tileset}},data:{get:function(){return this._data}},version:{get:function(){return this._version}},majorVersion:{get:function(){return this._majorVersion}},minorVersion:{get:function(){return this._minorVersion}},legacyVersion16:{get:function(){if(!!f(this.version))return this.majorVersion<1||this.majorVersion===1&&this.minorVersion<=6}}});df.prototype.load=function(){let t=this;return this._data.spatialReference.wkid!==4326?(console.log(`Unsupported spatial reference: ${this._data.spatialReference.wkid}`),Promise.reject()):this._dataProvider._geoidDataIsReadyPromise.then(function(){return t._loadRootNode().then(function(){return t._create3DTileset(),t._tileset.readyPromise.then(function(){if(t._rootNode._tile=t._tileset._root,t._tileset._root._i3sNode=t._rootNode,t.legacyVersion16)return t._rootNode._loadChildren()})})})};df.prototype._computeGeometryDefinitions=function(t){if(this._geometryDefinitions=[],f(this._data.geometryDefinitions))for(let n=0;n<this._data.geometryDefinitions.length;n++){let i=[],o=this._data.geometryDefinitions[n].geometryBuffers;for(let r=0;r<o.length;r++){let s=o[r],a=[],c=!1;if(f(s.compressedAttributes)&&t){c=!0;let l=s.compressedAttributes.attributes;for(let u=0;u<l.length;u++)a.push(l[u])}else for(let l in s)l!=="offset"&&a.push(l);i.push({compressed:c,attributes:a,index:o.indexOf(s)})}i.sort(function(r,s){return r.compressed&&!s.compressed?-1:!r.compressed&&s.compressed?1:r.attributes.length-s.attributes.length}),this._geometryDefinitions.push(i)}};df.prototype._findBestGeometryBuffers=function(t,n){let i=this._geometryDefinitions[t];if(f(i))for(let o=0;o<i.length;++o){let r=i[o],s=!1,a=r.attributes;for(let c=0;c<n.length;c++)if(!a.includes(n[c])){s=!0;break}if(!s)return{bufferIndex:r.index,definition:i,geometryBufferInfo:r}}return 0};df.prototype._loadRootNode=function(){if(f(this._data.nodePages)){let t=0;f(this._data.nodePages.rootIndex)&&(t=this._data.nodePages.rootIndex),this._rootNode=new vv(this,t,!0)}else this._rootNode=new vv(this,this._data.store.rootNode,!0);return this._rootNode.load()};df.prototype._getNodeInNodePages=function(t){let n=Math.floor(t/this._data.nodePages.nodesPerPage),i=t%this._data.nodePages.nodesPerPage,o=this;return this._loadNodePage(n).then(function(){return o._nodePages[n][i]})};df._fetchJson=function(t){return t.fetchJson()};df.prototype._loadNodePage=function(t){let n=this;if(!f(this._nodePageFetches[t])){let i=this.resource.getDerivedResource({url:`nodepages/${t}/`}),o=df._fetchJson(i).then(function(r){return f(r.error)&&r.error.code!==200?Promise.reject(r.error):(n._nodePages[t]=r.nodes,r)});this._nodePageFetches[t]=o}return this._nodePageFetches[t]};df.prototype._computeExtent=function(){f(this._data.fullExtent)?this._extent=le.fromDegrees(this._data.fullExtent.xmin,this._data.fullExtent.ymin,this._data.fullExtent.xmax,this._data.fullExtent.ymax):f(this._data.store.extent)&&(this._extent=le.fromDegrees(this._data.store.extent[0],this._data.store.extent[1],this._data.store.extent[2],this._data.store.extent[3]))};df.prototype._create3DTileset=function(){let t={asset:{version:"1.0"},geometricError:Number.MAX_VALUE,root:this._rootNode._create3DTileDefinition()},n=new Blob([JSON.stringify(t)],{type:"application/json"}),i=URL.createObjectURL(n),o={};if(f(this._dataProvider._cesium3dTilesetOptions))for(let s in this._dataProvider._cesium3dTilesetOptions)this._dataProvider._cesium3dTilesetOptions.hasOwnProperty(s)&&(o[s]=this._dataProvider._cesium3dTilesetOptions[s]);o.url=i,o.show=this._dataProvider.show,this._tileset=new $c(o),this._tileset._isI3STileSet=!0;let r=this;this._tileset.readyPromise.then(function(){r._tileset.tileUnload.addEventListener(function(s){s._i3sNode._clearGeometryData(),URL.revokeObjectURL(s._contentResource._url),s._contentResource=s._i3sNode.resource}),r._tileset.tileVisible.addEventListener(function(s){f(s._i3sNode)&&s._i3sNode._loadChildren()})})};var Pv=df;var E_e=yo(T_e(),1);function ua(t){t=A(t,A.EMPTY_OBJECT),this._resource=Ie.createIfNeeded(t.url),this._name=t.name,this._show=A(t.show,!0),this._geoidTiledTerrainProvider=t.geoidTiledTerrainProvider,this._traceFetches=A(t.traceFetches,!1),this._cesium3dTilesetOptions=A(t.cesium3dTilesetOptions,A.EMPTY_OBJECT),this._layers=[],this._data=void 0,this._extent=void 0,this._geoidDataIsReadyPromise=void 0,this._geoidDataList=void 0,this._decoderTaskProcessor=void 0,this._readyPromise=void 0,this._ready=!1,this._load()}Object.defineProperties(ua.prototype,{name:{get:function(){return this._name}},show:{get:function(){return this._show},set:function(t){this._show=t;for(let n=0;n<this._layers.length;n++)f(this._layers[n]._tileset)&&(this._layers[n]._tileset.show=this._show)}},traceFetches:{get:function(){return this._traceFetches},set:function(t){this._traceFetches=t}},geoidTiledTerrainProvider:{get:function(){return this._geoidTiledTerrainProvider}},layers:{get:function(){return this._layers}},data:{get:function(){return this._data}},extent:{get:function(){return this._extent}},readyPromise:{get:function(){return this._readyPromise}},ready:{get:function(){return this._ready}},resource:{get:function(){return this._resource}}});ua.prototype.destroy=function(){for(let t=0;t<this._layers.length;t++)f(this._layers[t]._tileset)&&this._layers[t]._tileset.destroy();return ue(this)};ua.prototype.isDestroyed=function(){return!1};ua.prototype.update=function(t){for(let n=0;n<this._layers.length;n++)f(this._layers[n]._tileset)&&this._layers[n]._tileset.ready&&this._layers[n]._tileset.update(t)};ua.prototype.prePassesUpdate=function(t){for(let n=0;n<this._layers.length;n++)f(this._layers[n]._tileset)&&this._layers[n]._tileset.ready&&this._layers[n]._tileset.prePassesUpdate(t)};ua.prototype.postPassesUpdate=function(t){for(let n=0;n<this._layers.length;n++)f(this._layers[n]._tileset)&&this._layers[n]._tileset.ready&&this._layers[n]._tileset.postPassesUpdate(t)};ua.prototype.updateForPass=function(t,n){for(let i=0;i<this._layers.length;i++)f(this._layers[i]._tileset)&&this._layers[i]._tileset.ready&&this._layers[i]._tileset.updateForPass(t,n)};ua.prototype._load=function(){let t=this;return this._readyPromise=this._loadJson(this._resource).then(function(n){if(t._data=n,f(t._data.layers))for(let o=0;o<t._data.layers.length;o++){let r=new Pv(t,t._data.layers[o],o);t._layers.push(r)}else{let o=new Pv(t,t._data,t._data.id);t._layers.push(o)}t._computeExtent(),t._loadGeoidData();let i=[];for(let o=0;o<t._layers.length;o++)i.push(t._layers[o].load());return Promise.all(i).then(function(){return t._ready=!0,t})}),this._readyPromise};ua._fetchJson=function(t){return t.fetchJson()};ua.prototype._loadJson=function(t){return this._traceFetches&&console.log("I3S FETCH:",t.url),ua._fetchJson(t).then(function(n){if(f(n.error)){if(console.error("Failed to fetch I3S ",t.url),f(n.error.message)&&console.error(n.error.message),f(n.error.details))for(let i=0;i<n.error.details.length;i++)console.log(n.error.details[i]);return Promise.reject(n.error)}return n})};ua.prototype._loadBinary=function(t){return this._traceFetches&&console.log("I3S FETCH:",t.url),t.fetchArrayBuffer()};ua.prototype._binarizeGltf=function(t){let i=new TextEncoder().encode(JSON.stringify(t)),o=new Uint8Array(i.byteLength+20),r={magic:new Uint8Array(o.buffer,0,4),version:new Uint32Array(o.buffer,4,1),length:new Uint32Array(o.buffer,8,1),chunkLength:new Uint32Array(o.buffer,12,1),chunkType:new Uint32Array(o.buffer,16,1),chunkData:new Uint8Array(o.buffer,20,i.byteLength)};return r.magic[0]="g".charCodeAt(),r.magic[1]="l".charCodeAt(),r.magic[2]="T".charCodeAt(),r.magic[3]="F".charCodeAt(),r.version[0]=2,r.length[0]=o.byteLength,r.chunkLength[0]=i.byteLength,r.chunkType[0]=1313821514,r.chunkData.set(i),o};ua.prototype._getDecoderTaskProcessor=function(){if(!f(this._decoderTaskProcessor)){let t=new fi("decodeI3S");this._taskProcessorReadyPromise=t.initWebAssemblyModule({modulePath:"ThirdParty/Workers/draco_decoder_nodejs.js",wasmBinaryFile:"ThirdParty/draco_decoder.wasm"}),this._decoderTaskProcessor=t}return this._decoderTaskProcessor};function jst(t,n){return t.readyPromise.then(function(){return Yst(t,n)})}var qst=new W;function Yst(t,n){let i=t.tilingScheme,o=[],r={},s=t._lodCount,a=de.fromRadians(n.west,n.north),c=de.fromRadians(n.east,n.south),l=i.positionToTileXY(a,s),u=i.positionToTileXY(c,s);for(let h=l.x;h<=u.x;h++)for(let _=l.y;_<=u.y;_++){let y=W.fromElements(h,_,qst),p=y.toString();if(!r.hasOwnProperty(p)){let C={x:y.x,y:y.y,level:s,tilingScheme:i,terrainProvider:t,positions:[]};r[p]=C,o.push(C)}}let d=[];for(let h=0;h<o.length;++h){let _=o[h],y=_.terrainProvider.requestTileGeometry(_.x,_.y,_.level);d.push(y)}return Promise.all(d).then(function(h){let _=[];for(let y=0;y<h.length;y++){let p={tilingScheme:i,x:o[y].x,y:o[y].y,level:o[y].level},C=h[y],x="Geographic";i._projection instanceof bi&&(x="WebMercator");let T={projectionType:x,projection:i._projection,nativeExtent:i.tileXYToNativeRectangle(p.x,p.y,p.level),height:C._height,width:C._width,scale:C._structure.heightScale,offset:C._structure.heightOffset};if(C._encoding===dd.LERC){let E=E_e.default.decode(C._buffer);T.buffer=E.pixels[0]}else T.buffer=C._buffer;_.push(T)}return _})}ua.prototype._loadGeoidData=function(){let t=this,n=this._geoidTiledTerrainProvider;return f(n)?(this._geoidDataIsReadyPromise=n.readyPromise.then(function(){return jst(n,t._extent).then(function(o){t._geoidDataList=o})}),this._geoidDataIsReadyPromise):(console.log("No Geoid Terrain service provided - no geoid conversion will be performed."),this._geoidDataIsReadyPromise=Promise.resolve(),this._geoidDataIsReadyPromise)};ua.prototype._computeExtent=function(){let t;for(let n=0;n<this._layers.length;n++)if(f(this._layers[n]._extent)){let i=this._layers[n]._extent;f(t)?le.union(t,i,t):t=le.clone(i)}this._extent=t};var b_e=ua;function jh(){this._numSamples=1,this.previousFramebuffer=void 0,this._previousFramebuffer=void 0,this._depthStencilTexture=void 0,this._depthStencilRenderbuffer=void 0,this._fbo=new ci({depthStencil:!0,createDepthAttachments:!1}),this._fboClassified=new ci({depthStencil:!0,createDepthAttachments:!1}),this._rsUnclassified=void 0,this._rsClassified=void 0,this._unclassifiedCommand=void 0,this._classifiedCommand=void 0,this._translucentCommand=void 0,this._clearColorCommand=new Qn({color:new z(0,0,0,0),owner:this}),this._clearCommand=new Qn({color:new z(0,0,0,0),depth:1,stencil:0});let t=this;this._uniformMap={colorTexture:function(){return t._fbo.getColorTexture()},depthTexture:function(){return t._depthStencilTexture},classifiedTexture:function(){return t._fboClassified.getColorTexture()}}}Object.defineProperties(jh.prototype,{unclassifiedCommand:{get:function(){return this._unclassifiedCommand}}});jh.isTranslucencySupported=function(t){return t.depthTexture&&t.fragmentDepth};var Xst={depthMask:!1,stencilTest:{enabled:!0,frontFunction:kn.EQUAL,frontOperation:{fail:ft.KEEP,zFail:ft.KEEP,zPass:ft.KEEP},backFunction:kn.NEVER,reference:0,mask:Ot.CLASSIFICATION_MASK},blending:ln.ALPHA_BLEND},Kst={depthMask:!1,stencilTest:{enabled:!0,frontFunction:kn.NOT_EQUAL,frontOperation:{fail:ft.KEEP,zFail:ft.KEEP,zPass:ft.KEEP},backFunction:kn.NEVER,reference:0,mask:Ot.CLASSIFICATION_MASK},blending:ln.ALPHA_BLEND},Jst={depthMask:!0,depthTest:{enabled:!0},stencilTest:Ot.setCesium3DTileBit(),stencilMask:Ot.CESIUM_3D_TILE_MASK,blending:ln.ALPHA_BLEND},Zst=`#extension GL_EXT_frag_depth : enable
uniform sampler2D colorTexture;
uniform sampler2D depthTexture;
uniform sampler2D classifiedTexture;
varying vec2 v_textureCoordinates;
void main()
{
    vec4 color = texture2D(colorTexture, v_textureCoordinates);
    if (color.a == 0.0)
    {
        discard;
    }
    bool isClassified = all(equal(texture2D(classifiedTexture, v_textureCoordinates), vec4(0.0)));
#ifdef UNCLASSIFIED
    vec4 highlightColor = czm_invertClassificationColor;
    if (isClassified)
    {
        discard;
    }
#else
    vec4 highlightColor = vec4(1.0);
    if (!isClassified)
    {
        discard;
    }
#endif
    gl_FragColor = color * highlightColor;
    gl_FragDepthEXT = texture2D(depthTexture, v_textureCoordinates).r;
}
`,Qst=`uniform sampler2D colorTexture;
varying vec2 v_textureCoordinates;
void main()
{
    vec4 color = texture2D(colorTexture, v_textureCoordinates);
    if (color.a == 0.0)
    {
        discard;
    }
#ifdef UNCLASSIFIED
    gl_FragColor = color * czm_invertClassificationColor;
#else
    gl_FragColor = color;
#endif
}
`;jh.prototype.update=function(t,n,i){let o=this._fbo.getColorTexture(),r=this.previousFramebuffer!==this._previousFramebuffer;this._previousFramebuffer=this.previousFramebuffer;let s=this._numSamples!==n,a=t.drawingBufferWidth,c=t.drawingBufferHeight,l=!f(o)||o.width!==a||o.height!==c;if((l||r||s)&&(this._numSamples=n,this._depthStencilTexture=this._depthStencilTexture&&this._depthStencilTexture.destroy(),this._depthStencilRenderbuffer=this._depthStencilRenderbuffer&&this._depthStencilRenderbuffer.destroy(),f(this._previousFramebuffer)||(this._depthStencilTexture=new St({context:t,width:a,height:c,pixelFormat:st.DEPTH_STENCIL,pixelDatatype:je.UNSIGNED_INT_24_8}),n>1&&(this._depthStencilRenderbuffer=new mu({context:t,width:a,height:c,format:Hc.DEPTH24_STENCIL8,numSamples:n})))),!f(this._fbo.framebuffer)||l||r||s){this._fbo.destroy(),this._fboClassified.destroy();let u,d;f(this._previousFramebuffer)?(u=i.getDepthStencilTexture(),d=i.getDepthStencilRenderbuffer()):(u=this._depthStencilTexture,d=this._depthStencilRenderbuffer),this._fbo.setDepthStencilTexture(u),f(d)&&this._fbo.setDepthStencilRenderbuffer(d),this._fbo.update(t,a,c,n),f(this._previousFramebuffer)||(this._fboClassified.setDepthStencilTexture(u),this._fboClassified.update(t,a,c))}if(f(this._rsUnclassified)||(this._rsUnclassified=Ve.fromCache(Xst),this._rsClassified=Ve.fromCache(Kst),this._rsDefault=Ve.fromCache(Jst)),!f(this._unclassifiedCommand)||r||s){f(this._unclassifiedCommand)&&(this._unclassifiedCommand.shaderProgram=this._unclassifiedCommand.shaderProgram&&this._unclassifiedCommand.shaderProgram.destroy(),this._classifiedCommand.shaderProgram=this._classifiedCommand.shaderProgram&&this._classifiedCommand.shaderProgram.destroy());let u=f(this._previousFramebuffer)?Qst:Zst,d=new ze({defines:["UNCLASSIFIED"],sources:[u]}),h=new ze({sources:[u]});this._unclassifiedCommand=t.createViewportQuadCommand(d,{renderState:f(this._previousFramebuffer)?this._rsUnclassified:this._rsDefault,uniformMap:this._uniformMap,owner:this}),this._classifiedCommand=t.createViewportQuadCommand(h,{renderState:f(this._previousFramebuffer)?this._rsClassified:this._rsDefault,uniformMap:this._uniformMap,owner:this}),f(this._translucentCommand)&&(this._translucentCommand.shaderProgram=this._translucentCommand.shaderProgram&&this._translucentCommand.shaderProgram.destroy()),f(this._previousFramebuffer)||(this._translucentCommand=t.createViewportQuadCommand(tu,{renderState:this._rsUnclassified,uniformMap:this._uniformMap,owner:this}))}};jh.prototype.prepareTextures=function(t,n){this._fbo._numSamples>1&&this._fbo.prepareTextures(t,n)};jh.prototype.clear=function(t,n){f(this._previousFramebuffer)?this._fbo.clear(t,this._clearColorCommand,n):(this._fbo.clear(t,this._clearCommand,n),this._fboClassified.clear(t,this._clearCommand,n))};jh.prototype.executeClassified=function(t,n){if(!f(this._previousFramebuffer)){let i=n.framebuffer;this.prepareTextures(t,!0),n.framebuffer=this._fboClassified.framebuffer,this._translucentCommand.execute(t,n),n.framebuffer=i}this._classifiedCommand.execute(t,n)};jh.prototype.executeUnclassified=function(t,n){this._unclassifiedCommand.execute(t,n)};jh.prototype.isDestroyed=function(){return!1};jh.prototype.destroy=function(){return this._fbo.destroy(),this._fboClassified.destroy(),this._depthStencilTexture=this._depthStencilTexture&&this._depthStencilTexture.destroy(),this._depthStencilRenderbuffer=this._depthStencilRenderbuffer&&this._depthStencilRenderbuffer.destroy(),f(this._unclassifiedCommand)&&(this._unclassifiedCommand.shaderProgram=this._unclassifiedCommand.shaderProgram&&this._unclassifiedCommand.shaderProgram.destroy(),this._classifiedCommand.shaderProgram=this._classifiedCommand.shaderProgram&&this._classifiedCommand.shaderProgram.destroy()),ue(this)};var Iv=jh;function AU(t){this._total=t,this.usedThisFrame=0,this.stolenFromMeThisFrame=0,this.starvedThisFrame=!1,this.starvedLastFrame=!1}Object.defineProperties(AU.prototype,{total:{get:function(){return this._total}}});function Zg(t){let n=new Array(Sa.NUMBER_OF_JOB_TYPES);n[Sa.TEXTURE]=new AU(f(t)?t[Sa.TEXTURE]:10),n[Sa.PROGRAM]=new AU(f(t)?t[Sa.PROGRAM]:10),n[Sa.BUFFER]=new AU(f(t)?t[Sa.BUFFER]:30);let i=n.length,o,r=0;for(o=0;o<i;++o)r+=n[o].total;let s=new Array(i);for(o=0;o<i;++o)s[o]=!1;this._totalBudget=r,this._totalUsedThisFrame=0,this._budgets=n,this._executedThisFrame=s}Zg.getTimestamp=Fi;Object.defineProperties(Zg.prototype,{totalBudget:{get:function(){return this._totalBudget}}});Zg.prototype.disableThisFrame=function(){this._totalUsedThisFrame=this._totalBudget};Zg.prototype.resetBudgets=function(){let t=this._budgets,n=t.length;for(let i=0;i<n;++i){let o=t[i];o.starvedLastFrame=o.starvedThisFrame,o.starvedThisFrame=!1,o.usedThisFrame=0,o.stolenFromMeThisFrame=0}this._totalUsedThisFrame=0};Zg.prototype.execute=function(t,n){let i=this._budgets,o=i[n],r=this._executedThisFrame[n];if(this._totalUsedThisFrame>=this._totalBudget&&r)return o.starvedThisFrame=!0,!1;let s;if(o.usedThisFrame+o.stolenFromMeThisFrame>=o.total){let l=i.length,u;for(u=0;u<l&&(s=i[u],!(s.usedThisFrame+s.stolenFromMeThisFrame<s.total&&!s.starvedLastFrame));++u);if(u===l&&r)return!1;r&&(o.starvedThisFrame=!0)}let a=Zg.getTimestamp();t.execute();let c=Zg.getTimestamp()-a;return this._totalUsedThisFrame+=c,s?s.stolenFromMeThisFrame+=c:o.usedThisFrame+=c,this._executedThisFrame[n]=!0,!0};var CU=Zg;function S_e(){}Object.defineProperties(S_e.prototype,{color:{get:Ce.throwInstantiationError},intensity:{get:Ce.throwInstantiationError}});var w_e=S_e;var $st=/\/$/,D_e=new Jt('&copy; <a href="https://www.mapbox.com/about/maps/">Mapbox</a> &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> <strong><a href="https://www.mapbox.com/map-feedback/">Improve this map</a></strong>');function XE(t){t=A(t,A.EMPTY_OBJECT);let n=t.styleId,i=t.accessToken;this.defaultAlpha=void 0,this.defaultNightAlpha=void 0,this.defaultDayAlpha=void 0,this.defaultBrightness=void 0,this.defaultContrast=void 0,this.defaultHue=void 0,this.defaultSaturation=void 0,this.defaultGamma=void 0,this.defaultMinificationFilter=void 0,this.defaultMagnificationFilter=void 0;let o=Ie.createIfNeeded(A(t.url,"https://api.mapbox.com/styles/v1/"));this._styleId=n,this._accessToken=i;let r=A(t.tilesize,512);this._tilesize=r;let s=A(t.username,"mapbox");this._username=s;let a=f(t.scaleFactor)?"@2x":"",c=o.getUrlComponent();$st.test(c)||(c+="/"),c+=`${this._username}/${n}/tiles/${this._tilesize}/{z}/{x}/{y}${a}`,o.url=c,o.setQueryParameters({access_token:i});let l;f(t.credit)?(l=t.credit,typeof l=="string"&&(l=new Jt(l))):l=D_e,this._resource=o,this._imageryProvider=new qa({url:o,credit:l,ellipsoid:t.ellipsoid,minimumLevel:t.minimumLevel,maximumLevel:t.maximumLevel,rectangle:t.rectangle})}Object.defineProperties(XE.prototype,{url:{get:function(){return this._imageryProvider.url}},ready:{get:function(){return this._imageryProvider.ready}},readyPromise:{get:function(){return this._imageryProvider.readyPromise}},rectangle:{get:function(){return this._imageryProvider.rectangle}},tileWidth:{get:function(){return this._imageryProvider.tileWidth}},tileHeight:{get:function(){return this._imageryProvider.tileHeight}},maximumLevel:{get:function(){return this._imageryProvider.maximumLevel}},minimumLevel:{get:function(){return this._imageryProvider.minimumLevel}},tilingScheme:{get:function(){return this._imageryProvider.tilingScheme}},tileDiscardPolicy:{get:function(){return this._imageryProvider.tileDiscardPolicy}},errorEvent:{get:function(){return this._imageryProvider.errorEvent}},credit:{get:function(){return this._imageryProvider.credit}},proxy:{get:function(){return this._imageryProvider.proxy}},hasAlphaChannel:{get:function(){return this._imageryProvider.hasAlphaChannel}}});XE.prototype.getTileCredits=function(t,n,i){};XE.prototype.requestImage=function(t,n,i,o){return this._imageryProvider.requestImage(t,n,i,o)};XE.prototype.pickFeatures=function(t,n,i,o,r){return this._imageryProvider.pickFeatures(t,n,i,o,r)};XE._defaultCredit=D_e;var v_e=XE;function Bv(t){t=A(t,A.EMPTY_OBJECT);let n=t.textureUrl;f(n)||(n=Qt("Assets/Textures/moonSmall.jpg")),this.show=A(t.show,!0),this.textureUrl=n,this._ellipsoid=A(t.ellipsoid,oe.MOON),this.onlySunLighting=A(t.onlySunLighting,!0),this._ellipsoidPrimitive=new Rk({radii:this.ellipsoid.radii,material:$i.fromType($i.ImageType),depthTestEnabled:!1,_owner:this}),this._ellipsoidPrimitive.material.translucent=!1,this._axes=new iV}Object.defineProperties(Bv.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}});var xU=new $,eat=new $,tat=new m,TU=[];Bv.prototype.update=function(t){if(!this.show)return;let n=this._ellipsoidPrimitive;n.material.uniforms.image=this.textureUrl,n.onlySunLighting=this.onlySunLighting;let i=t.time;f(vt.computeIcrfToFixedMatrix(i,xU))||vt.computeTemeToPseudoFixedMatrix(i,xU);let o=this._axes.evaluate(i,eat);$.transpose(o,o),$.multiply(xU,o,o);let r=sA.computeMoonPositionInEarthInertialFrame(i,tat);$.multiplyByVector(xU,r,r),N.fromRotationTranslation(o,r,n.modelMatrix);let s=t.commandList;return t.commandList=TU,TU.length=0,n.update(t),t.commandList=s,TU.length===1?TU[0]:void 0};Bv.prototype.isDestroyed=function(){return!1};Bv.prototype.destroy=function(){return this._ellipsoidPrimitive=this._ellipsoidPrimitive&&this._ellipsoidPrimitive.destroy(),ue(this)};var EU=Bv;function zj(t){}zj.prototype.isReady=function(){return!0};zj.prototype.shouldDiscardImage=function(t){return!1};var P_e=zj;function Tp(t){this._numSamples=1,this._translucentMultipassSupport=!1,this._translucentMRTSupport=!1;let n=t.colorBufferFloat&&t.depthTexture&&t.floatBlend;this._translucentMRTSupport=t.drawBuffers&&n,this._translucentMultipassSupport=!this._translucentMRTSupport&&n,this._opaqueFBO=void 0,this._opaqueTexture=void 0,this._depthStencilTexture=void 0,this._accumulationTexture=void 0,this._translucentFBO=new ci({colorAttachmentsLength:this._translucentMRTSupport?2:1,createColorAttachments:!1,createDepthAttachments:!1,depth:!0}),this._alphaFBO=new ci({createColorAttachments:!1,createDepthAttachments:!1,depth:!0}),this._adjustTranslucentFBO=new ci({colorAttachmentsLength:this._translucentMRTSupport?2:1,createColorAttachments:!1}),this._adjustAlphaFBO=new ci({createColorAttachments:!1}),this._opaqueClearCommand=new Qn({color:new z(0,0,0,0),owner:this}),this._translucentMRTClearCommand=new Qn({color:new z(0,0,0,1),owner:this}),this._translucentMultipassClearCommand=new Qn({color:new z(0,0,0,0),owner:this}),this._alphaClearCommand=new Qn({color:new z(1,1,1,1),owner:this}),this._translucentRenderStateCache={},this._alphaRenderStateCache={},this._compositeCommand=void 0,this._adjustTranslucentCommand=void 0,this._adjustAlphaCommand=void 0,this._viewport=new He,this._rs=void 0,this._useScissorTest=!1,this._scissorRectangle=void 0,this._useHDR=!1}function I_e(t){t._accumulationTexture=t._accumulationTexture&&!t._accumulationTexture.isDestroyed()&&t._accumulationTexture.destroy(),t._revealageTexture=t._revealageTexture&&!t._revealageTexture.isDestroyed()&&t._revealageTexture.destroy()}function Hj(t){t._translucentFBO.destroy(),t._alphaFBO.destroy(),t._adjustTranslucentFBO.destroy(),t._adjustAlphaFBO.destroy()}function B_e(t){I_e(t),Hj(t)}function nat(t,n,i,o){I_e(t),t._accumulationTexture=new St({context:n,width:i,height:o,pixelFormat:st.RGBA,pixelDatatype:je.FLOAT});let r=new Float32Array(i*o*4);t._revealageTexture=new St({context:n,pixelFormat:st.RGBA,pixelDatatype:je.FLOAT,source:{arrayBufferView:r,width:i,height:o},flipY:!1})}function iat(t,n){Hj(t);let i=ee.FRAMEBUFFER_COMPLETE,o=!0,r=t._accumulationTexture.width,s=t._accumulationTexture.height;if(t._translucentMRTSupport&&(t._translucentFBO.setColorTexture(t._accumulationTexture,0),t._translucentFBO.setColorTexture(t._revealageTexture,1),t._translucentFBO.setDepthStencilTexture(t._depthStencilTexture),t._translucentFBO.update(n,r,s),t._adjustTranslucentFBO.setColorTexture(t._accumulationTexture,0),t._adjustTranslucentFBO.setColorTexture(t._revealageTexture,1),t._adjustTranslucentFBO.update(n,r,s),(t._translucentFBO.status!==i||t._adjustTranslucentFBO.status!==i)&&(Hj(t),t._translucentMRTSupport=!1)),!t._translucentMRTSupport){t._translucentFBO.setColorTexture(t._accumulationTexture),t._translucentFBO.setDepthStencilTexture(t._depthStencilTexture),t._translucentFBO.update(n,r,s),t._alphaFBO.setColorTexture(t._revealageTexture),t._alphaFBO.setDepthStencilTexture(t._depthStencilTexture),t._alphaFBO.update(n,r,s),t._adjustTranslucentFBO.setColorTexture(t._accumulationTexture),t._adjustTranslucentFBO.update(n,r,s),t._adjustAlphaFBO.setColorTexture(t._revealageTexture),t._adjustAlphaFBO.update(n,r,s);let a=t._translucentFBO.status===i,c=t._alphaFBO.status===i,l=t._adjustTranslucentFBO.status===i,u=t._adjustAlphaFBO.status===i;(!a||!c||!l||!u)&&(B_e(t),t._translucentMultipassSupport=!1,o=!1)}return o}Tp.prototype.update=function(t,n,i,o,r){if(!this.isSupported())return;this._opaqueFBO=i,this._opaqueTexture=i.getColorTexture(0),this._depthStencilTexture=i.getDepthStencilTexture();let s=this._opaqueTexture.width,a=this._opaqueTexture.height,c=this._accumulationTexture,l=!f(c)||c.width!==s||c.height!==a||o!==this._useHDR,u=this._numSamples!==r;if((l||u)&&(this._numSamples=r,nat(this,t,s,a)),(!f(this._translucentFBO.framebuffer)||l||u)&&!iat(this,t))return;this._useHDR=o;let d=this,h,_;f(this._compositeCommand)||(h=new ze({sources:[OV]}),this._translucentMRTSupport&&h.defines.push("MRT"),_={u_opaque:function(){return d._opaqueTexture},u_accumulation:function(){return d._accumulationTexture},u_revealage:function(){return d._revealageTexture}},this._compositeCommand=t.createViewportQuadCommand(h,{uniformMap:_,owner:this})),f(this._adjustTranslucentCommand)||(this._translucentMRTSupport?(h=new ze({defines:["MRT"],sources:[XD]}),_={u_bgColor:function(){return d._translucentMRTClearCommand.color},u_depthTexture:function(){return d._depthStencilTexture}},this._adjustTranslucentCommand=t.createViewportQuadCommand(h,{uniformMap:_,owner:this})):this._translucentMultipassSupport&&(h=new ze({sources:[XD]}),_={u_bgColor:function(){return d._translucentMultipassClearCommand.color},u_depthTexture:function(){return d._depthStencilTexture}},this._adjustTranslucentCommand=t.createViewportQuadCommand(h,{uniformMap:_,owner:this}),_={u_bgColor:function(){return d._alphaClearCommand.color},u_depthTexture:function(){return d._depthStencilTexture}},this._adjustAlphaCommand=t.createViewportQuadCommand(h,{uniformMap:_,owner:this}))),this._viewport.width=s,this._viewport.height=a;let y=!He.equals(this._viewport,n.viewport),p=y!==this._useScissorTest;this._useScissorTest=y,He.equals(this._scissorRectangle,n.viewport)||(this._scissorRectangle=He.clone(n.viewport,this._scissorRectangle),p=!0),(!f(this._rs)||!He.equals(this._viewport,this._rs.viewport)||p)&&(this._rs=Ve.fromCache({viewport:this._viewport,scissorTest:{enabled:this._useScissorTest,rectangle:this._scissorRectangle}})),f(this._compositeCommand)&&(this._compositeCommand.renderState=this._rs),this._adjustTranslucentCommand&&(this._adjustTranslucentCommand.renderState=this._rs),f(this._adjustAlphaCommand)&&(this._adjustAlphaCommand.renderState=this._rs)};var oat={enabled:!0,color:new z(0,0,0,0),equationRgb:Aa.ADD,equationAlpha:Aa.ADD,functionSourceRgb:Eo.ONE,functionDestinationRgb:Eo.ONE,functionSourceAlpha:Eo.ZERO,functionDestinationAlpha:Eo.ONE_MINUS_SOURCE_ALPHA},rat={enabled:!0,color:new z(0,0,0,0),equationRgb:Aa.ADD,equationAlpha:Aa.ADD,functionSourceRgb:Eo.ONE,functionDestinationRgb:Eo.ONE,functionSourceAlpha:Eo.ONE,functionDestinationAlpha:Eo.ONE},sat={enabled:!0,color:new z(0,0,0,0),equationRgb:Aa.ADD,equationAlpha:Aa.ADD,functionSourceRgb:Eo.ZERO,functionDestinationRgb:Eo.ONE_MINUS_SOURCE_ALPHA,functionSourceAlpha:Eo.ZERO,functionDestinationAlpha:Eo.ONE_MINUS_SOURCE_ALPHA};function Gj(t,n,i,o){let r=i[o.id];if(!f(r)){let s=Ve.getState(o);s.depthMask=!1,s.blending=n,r=Ve.fromCache(s),i[o.id]=r}return r}function aat(t,n,i){return Gj(n,oat,t._translucentRenderStateCache,i)}function cat(t,n,i){return Gj(n,rat,t._translucentRenderStateCache,i)}function lat(t,n,i){return Gj(n,sat,t._alphaRenderStateCache,i)}var uat=`    vec3 Ci = czm_gl_FragColor.rgb * czm_gl_FragColor.a;
    float ai = czm_gl_FragColor.a;
    float wzi = czm_alphaWeight(ai);
    gl_FragData[0] = vec4(Ci * wzi, ai);
    gl_FragData[1] = vec4(ai * wzi);
`,fat=`    vec3 Ci = czm_gl_FragColor.rgb * czm_gl_FragColor.a;
    float ai = czm_gl_FragColor.a;
    float wzi = czm_alphaWeight(ai);
    gl_FragColor = vec4(Ci, ai) * wzi;
`,dat=`    float ai = czm_gl_FragColor.a;
    gl_FragColor = vec4(ai);
`;function Wj(t,n,i,o){let r=t.shaderCache.getDerivedShaderProgram(n,i);if(!f(r)){let s=n._attributeLocations,a=n.fragmentShaderSource.clone();a.sources=a.sources.map(function(c){return c=ze.replaceMain(c,"czm_translucent_main"),c=c.replace(/gl_FragColor/g,"czm_gl_FragColor"),c=c.replace(/\bdiscard\b/g,"czm_discard = true"),c=c.replace(/czm_phong/g,"czm_translucentPhong"),c}),a.sources.splice(0,0,`${o.indexOf("gl_FragData")!==-1?`#extension GL_EXT_draw_buffers : enable 
`:""}vec4 czm_gl_FragColor;
bool czm_discard = false;
`),a.sources.push(`void main()
{
    czm_translucent_main();
    if (czm_discard)
    {
        discard;
    }
${o}}
`),r=t.shaderCache.createDerivedShaderProgram(n,i,{vertexShaderSource:n.vertexShaderSource,fragmentShaderSource:a,attributeLocations:s})}return r}function hat(t,n){return Wj(t,n,"translucentMRT",uat)}function mat(t,n){return Wj(t,n,"translucentMultipass",fat)}function pat(t,n){return Wj(t,n,"alphaMultipass",dat)}Tp.prototype.createDerivedCommands=function(t,n,i){if(f(i)||(i={}),this._translucentMRTSupport){let o,r;f(i.translucentCommand)&&(o=i.translucentCommand.shaderProgram,r=i.translucentCommand.renderState),i.translucentCommand=et.shallowClone(t,i.translucentCommand),!f(o)||i.shaderProgramId!==t.shaderProgram.id?(i.translucentCommand.shaderProgram=hat(n,t.shaderProgram),i.translucentCommand.renderState=aat(this,n,t.renderState),i.shaderProgramId=t.shaderProgram.id):(i.translucentCommand.shaderProgram=o,i.translucentCommand.renderState=r)}else{let o,r,s,a;f(i.translucentCommand)&&(o=i.translucentCommand.shaderProgram,r=i.translucentCommand.renderState,s=i.alphaCommand.shaderProgram,a=i.alphaCommand.renderState),i.translucentCommand=et.shallowClone(t,i.translucentCommand),i.alphaCommand=et.shallowClone(t,i.alphaCommand),!f(o)||i.shaderProgramId!==t.shaderProgram.id?(i.translucentCommand.shaderProgram=mat(n,t.shaderProgram),i.translucentCommand.renderState=cat(this,n,t.renderState),i.alphaCommand.shaderProgram=pat(n,t.shaderProgram),i.alphaCommand.renderState=lat(this,n,t.renderState),i.shaderProgramId=t.shaderProgram.id):(i.translucentCommand.shaderProgram=o,i.translucentCommand.renderState=r,i.alphaCommand.shaderProgram=s,i.alphaCommand.renderState=a)}return i};function _at(t,n,i,o,r,s){let a,c,l,u=n.context,d=n.frameState.useLogDepth,h=n._hdr,_=o.framebuffer,y=r.length,p=n.frameState.shadowState.lightShadowsEnabled;o.framebuffer=t._adjustTranslucentFBO.framebuffer,t._adjustTranslucentCommand.execute(u,o),o.framebuffer=t._adjustAlphaFBO.framebuffer,t._adjustAlphaCommand.execute(u,o);let C=t._opaqueFBO.framebuffer;for(o.framebuffer=t._translucentFBO.framebuffer,l=0;l<y;++l)a=r[l],a=d?a.derivedCommands.logDepth.command:a,a=h?a.derivedCommands.hdr.command:a,c=p&&a.receiveShadows?a.derivedCommands.oit.shadows.translucentCommand:a.derivedCommands.oit.translucentCommand,i(c,n,u,o,C);for(f(s)&&(a=s.unclassifiedCommand,c=p&&a.receiveShadows?a.derivedCommands.oit.shadows.translucentCommand:a.derivedCommands.oit.translucentCommand,i(c,n,u,o,C)),o.framebuffer=t._alphaFBO.framebuffer,l=0;l<y;++l)a=r[l],a=d?a.derivedCommands.logDepth.command:a,a=h?a.derivedCommands.hdr.command:a,c=p&&a.receiveShadows?a.derivedCommands.oit.shadows.alphaCommand:a.derivedCommands.oit.alphaCommand,i(c,n,u,o,C);f(s)&&(a=s.unclassifiedCommand,c=p&&a.receiveShadows?a.derivedCommands.oit.shadows.alphaCommand:a.derivedCommands.oit.alphaCommand,i(c,n,u,o,C)),o.framebuffer=_}function gat(t,n,i,o,r,s){let a=n.context,c=n.frameState.useLogDepth,l=n._hdr,u=o.framebuffer,d=r.length,h=n.frameState.shadowState.lightShadowsEnabled;o.framebuffer=t._adjustTranslucentFBO.framebuffer,t._adjustTranslucentCommand.execute(a,o);let _=t._opaqueFBO.framebuffer;o.framebuffer=t._translucentFBO.framebuffer;let y,p;for(let C=0;C<d;++C)y=r[C],y=c?y.derivedCommands.logDepth.command:y,y=l?y.derivedCommands.hdr.command:y,p=h&&y.receiveShadows?y.derivedCommands.oit.shadows.translucentCommand:y.derivedCommands.oit.translucentCommand,i(p,n,a,o,_);f(s)&&(y=s.unclassifiedCommand,p=h&&y.receiveShadows?y.derivedCommands.oit.shadows.translucentCommand:y.derivedCommands.oit.translucentCommand,i(p,n,a,o,_)),o.framebuffer=u}Tp.prototype.executeCommands=function(t,n,i,o,r){if(this._translucentMRTSupport){gat(this,t,n,i,o,r);return}_at(this,t,n,i,o,r)};Tp.prototype.execute=function(t,n){this._compositeCommand.execute(t,n)};Tp.prototype.clear=function(t,n,i){let o=n.framebuffer;n.framebuffer=this._opaqueFBO.framebuffer,z.clone(i,this._opaqueClearCommand.color),this._opaqueClearCommand.execute(t,n),n.framebuffer=this._translucentFBO.framebuffer,(this._translucentMRTSupport?this._translucentMRTClearCommand:this._translucentMultipassClearCommand).execute(t,n),this._translucentMultipassSupport&&(n.framebuffer=this._alphaFBO.framebuffer,this._alphaClearCommand.execute(t,n)),n.framebuffer=o};Tp.prototype.isSupported=function(){return this._translucentMRTSupport||this._translucentMultipassSupport};Tp.prototype.isDestroyed=function(){return!1};Tp.prototype.destroy=function(){return B_e(this),f(this._compositeCommand)&&(this._compositeCommand.shaderProgram=this._compositeCommand.shaderProgram&&this._compositeCommand.shaderProgram.destroy()),f(this._adjustTranslucentCommand)&&(this._adjustTranslucentCommand.shaderProgram=this._adjustTranslucentCommand.shaderProgram&&this._adjustTranslucentCommand.shaderProgram.destroy()),f(this._adjustAlphaCommand)&&(this._adjustAlphaCommand.shaderProgram=this._adjustAlphaCommand.shaderProgram&&this._adjustAlphaCommand.shaderProgram.destroy()),ue(this)};var bU=Tp;var yat=new Jt("MapQuest, Open Street Map and contributors, CC-BY-SA");function SU(t){t=A(t,A.EMPTY_OBJECT);let n=Ie.createIfNeeded(A(t.url,"https://a.tile.openstreetmap.org/"));n.appendForwardSlash(),n.url+=`{z}/{x}/{y}.${A(t.fileExtension,"png")}`;let i=new Xr({ellipsoid:t.ellipsoid}),o=256,r=256,s=A(t.minimumLevel,0),a=t.maximumLevel,c=A(t.rectangle,i.rectangle),l=i.positionToTileXY(le.southwest(c),s),u=i.positionToTileXY(le.northeast(c),s),d=(Math.abs(u.x-l.x)+1)*(Math.abs(u.y-l.y)+1),h=A(t.credit,yat);typeof h=="string"&&(h=new Jt(h)),qa.call(this,{url:n,credit:h,tilingScheme:i,tileWidth:o,tileHeight:r,minimumLevel:s,maximumLevel:a,rectangle:c})}f(Object.create)&&(SU.prototype=Object.create(qa.prototype),SU.prototype.constructor=SU);var KE=SU;var Aat=new W(1,1);function jj(t){t=A(t,A.EMPTY_OBJECT),this.mass=A(t.mass,1),this.position=m.clone(A(t.position,m.ZERO)),this.velocity=m.clone(A(t.velocity,m.ZERO)),this.life=A(t.life,Number.MAX_VALUE),this.image=t.image,this.startColor=z.clone(A(t.startColor,z.WHITE)),this.endColor=z.clone(A(t.endColor,z.WHITE)),this.startScale=A(t.startScale,1),this.endScale=A(t.endScale,1),this.imageSize=W.clone(A(t.imageSize,Aat)),this._age=0,this._normalizedAge=0,this._billboard=void 0}Object.defineProperties(jj.prototype,{age:{get:function(){return this._age}},normalizedAge:{get:function(){return this._normalizedAge}}});var O_e=new m;jj.prototype.update=function(t,n){return m.multiplyByScalar(this.velocity,t,O_e),m.add(this.position,O_e,this.position),f(n)&&n(this,t),this._age+=t,this.life===Number.MAX_VALUE?this._normalizedAge=0:this._normalizedAge=this._age/this.life,this._age<=this.life};var Ov=jj;function R_e(t){t=A(t,A.EMPTY_OBJECT),this.time=A(t.time,0),this.minimum=A(t.minimum,0),this.maximum=A(t.maximum,50),this._complete=!1}Object.defineProperties(R_e.prototype,{complete:{get:function(){return this._complete}}});var M_e=R_e;function L_e(t){}L_e.prototype.emit=function(t){Ce.throwInstantiationError()};var F_e=L_e;var N_e=new W(1,1);function Rv(t){t=A(t,A.EMPTY_OBJECT),this.show=A(t.show,!0),this.updateCallback=t.updateCallback,this.loop=A(t.loop,!0),this.image=A(t.image,void 0);let n=t.emitter;f(n)||(n=new ck(.5)),this._emitter=n,this._bursts=t.bursts,this._modelMatrix=N.clone(A(t.modelMatrix,N.IDENTITY)),this._emitterModelMatrix=N.clone(A(t.emitterModelMatrix,N.IDENTITY)),this._matrixDirty=!0,this._combinedMatrix=new N,this._startColor=z.clone(A(t.color,A(t.startColor,z.WHITE))),this._endColor=z.clone(A(t.color,A(t.endColor,z.WHITE))),this._startScale=A(t.scale,A(t.startScale,1)),this._endScale=A(t.scale,A(t.endScale,1)),this._emissionRate=A(t.emissionRate,5),this._minimumSpeed=A(t.speed,A(t.minimumSpeed,1)),this._maximumSpeed=A(t.speed,A(t.maximumSpeed,1)),this._minimumParticleLife=A(t.particleLife,A(t.minimumParticleLife,5)),this._maximumParticleLife=A(t.particleLife,A(t.maximumParticleLife,5)),this._minimumMass=A(t.mass,A(t.minimumMass,1)),this._maximumMass=A(t.mass,A(t.maximumMass,1)),this._minimumImageSize=W.clone(A(t.imageSize,A(t.minimumImageSize,N_e))),this._maximumImageSize=W.clone(A(t.imageSize,A(t.maximumImageSize,N_e))),this._sizeInMeters=A(t.sizeInMeters,!1),this._lifetime=A(t.lifetime,Number.MAX_VALUE),this._billboardCollection=void 0,this._particles=[],this._particlePool=[],this._previousTime=void 0,this._currentTime=0,this._carryOver=0,this._complete=new Ae,this._isComplete=!1,this._updateParticlePool=!0,this._particleEstimate=0}Object.defineProperties(Rv.prototype,{emitter:{get:function(){return this._emitter},set:function(t){this._emitter=t}},bursts:{get:function(){return this._bursts},set:function(t){this._bursts=t,this._updateParticlePool=!0}},modelMatrix:{get:function(){return this._modelMatrix},set:function(t){this._matrixDirty=this._matrixDirty||!N.equals(this._modelMatrix,t),N.clone(t,this._modelMatrix)}},emitterModelMatrix:{get:function(){return this._emitterModelMatrix},set:function(t){this._matrixDirty=this._matrixDirty||!N.equals(this._emitterModelMatrix,t),N.clone(t,this._emitterModelMatrix)}},startColor:{get:function(){return this._startColor},set:function(t){z.clone(t,this._startColor)}},endColor:{get:function(){return this._endColor},set:function(t){z.clone(t,this._endColor)}},startScale:{get:function(){return this._startScale},set:function(t){this._startScale=t}},endScale:{get:function(){return this._endScale},set:function(t){this._endScale=t}},emissionRate:{get:function(){return this._emissionRate},set:function(t){this._emissionRate=t,this._updateParticlePool=!0}},minimumSpeed:{get:function(){return this._minimumSpeed},set:function(t){this._minimumSpeed=t}},maximumSpeed:{get:function(){return this._maximumSpeed},set:function(t){this._maximumSpeed=t}},minimumParticleLife:{get:function(){return this._minimumParticleLife},set:function(t){this._minimumParticleLife=t}},maximumParticleLife:{get:function(){return this._maximumParticleLife},set:function(t){this._maximumParticleLife=t,this._updateParticlePool=!0}},minimumMass:{get:function(){return this._minimumMass},set:function(t){this._minimumMass=t}},maximumMass:{get:function(){return this._maximumMass},set:function(t){this._maximumMass=t}},minimumImageSize:{get:function(){return this._minimumImageSize},set:function(t){this._minimumImageSize=t}},maximumImageSize:{get:function(){return this._maximumImageSize},set:function(t){this._maximumImageSize=t}},sizeInMeters:{get:function(){return this._sizeInMeters},set:function(t){this._sizeInMeters=t}},lifetime:{get:function(){return this._lifetime},set:function(t){this._lifetime=t}},complete:{get:function(){return this._complete}},isComplete:{get:function(){return this._isComplete}}});function Cat(t){let n=t._emissionRate,i=t._maximumParticleLife,o=0,r=t._bursts;if(f(r)){let h=r.length;for(let _=0;_<h;++_)o+=r[_].maximum}let s=t._billboardCollection,a=t.image,c=Math.ceil(n*i+o),l=t._particles,u=t._particlePool,d=Math.max(c-l.length-u.length,0);for(let h=0;h<d;++h){let _=new Ov;_._billboard=s.add({image:a}),u.push(_)}t._particleEstimate=c}function xat(t){let n=t._particlePool.pop();return f(n)||(n=new Ov),n}function Tat(t,n){t._particlePool.push(n)}function Eat(t){let n=t._particles,i=t._particlePool,o=t._billboardCollection,r=n.length,s=i.length,a=t._particleEstimate,c=s-Math.max(a-r-s,0);for(let l=c;l<s;++l){let u=i[l];o.remove(u._billboard)}i.length=c}function bat(t){f(t._billboard)&&(t._billboard.show=!1)}function V_e(t,n){let i=n._billboard;f(i)||(i=n._billboard=t._billboardCollection.add({image:n.image})),i.width=n.imageSize.x,i.height=n.imageSize.y,i.position=n.position,i.sizeInMeters=t.sizeInMeters,i.show=!0;let o=B.lerp(n.startColor.red,n.endColor.red,n.normalizedAge),r=B.lerp(n.startColor.green,n.endColor.green,n.normalizedAge),s=B.lerp(n.startColor.blue,n.endColor.blue,n.normalizedAge),a=B.lerp(n.startColor.alpha,n.endColor.alpha,n.normalizedAge);i.color=new z(o,r,s,a),i.scale=B.lerp(n.startScale,n.endScale,n.normalizedAge)}function Sat(t,n){n.startColor=z.clone(t._startColor,n.startColor),n.endColor=z.clone(t._endColor,n.endColor),n.startScale=t._startScale,n.endScale=t._endScale,n.image=t.image,n.life=B.randomBetween(t._minimumParticleLife,t._maximumParticleLife),n.mass=B.randomBetween(t._minimumMass,t._maximumMass),n.imageSize.x=B.randomBetween(t._minimumImageSize.x,t._maximumImageSize.x),n.imageSize.y=B.randomBetween(t._minimumImageSize.y,t._maximumImageSize.y),n._normalizedAge=0,n._age=0;let i=B.randomBetween(t._minimumSpeed,t._maximumSpeed);m.multiplyByScalar(n.velocity,i,n.velocity),t._particles.push(n)}function wat(t,n){if(t._isComplete)return 0;n=B.mod(n,t._lifetime);let i=n*t._emissionRate,o=Math.floor(i);if(t._carryOver+=i-o,t._carryOver>1&&(o++,t._carryOver-=1),f(t.bursts)){let r=t.bursts.length;for(let s=0;s<r;s++){let a=t.bursts[s],c=t._currentTime;f(a)&&!a._complete&&c>a.time&&(o+=B.randomBetween(a.minimum,a.maximum),a._complete=!0)}}return o}var wU=new m;Rv.prototype.update=function(t){if(!this.show)return;f(this._billboardCollection)||(this._billboardCollection=new vu),this._updateParticlePool&&(Cat(this),this._updateParticlePool=!1);let n=0;this._previousTime&&(n=te.secondsDifference(t.time,this._previousTime)),n<0&&(n=0);let i=this._particles,o=this._emitter,r=this.updateCallback,s,a,c=i.length;for(s=0;s<c;++s)a=i[s],a.update(n,r)?V_e(this,a):(bat(a),Tat(this,a),i[s]=i[c-1],--s,--c);i.length=c;let l=wat(this,n);if(l>0&&f(o)){this._matrixDirty&&(this._combinedMatrix=N.multiply(this.modelMatrix,this.emitterModelMatrix,this._combinedMatrix),this._matrixDirty=!1);let u=this._combinedMatrix;for(s=0;s<l;s++)a=xat(this),this._emitter.emit(a),m.add(a.position,a.velocity,wU),N.multiplyByPoint(u,wU,wU),a.position=N.multiplyByPoint(u,a.position,a.position),m.subtract(wU,a.position,a.velocity),m.normalize(a.velocity,a.velocity),Sat(this,a),V_e(this,a)}if(this._billboardCollection.update(t),this._previousTime=te.clone(t.time,this._previousTime),this._currentTime+=n,this._lifetime!==Number.MAX_VALUE&&this._currentTime>this._lifetime)if(this.loop){if(this._currentTime=B.mod(this._currentTime,this._lifetime),this.bursts){let u=this.bursts.length;for(s=0;s<u;s++)this.bursts[s]._complete=!1}}else this._isComplete=!0,this._complete.raiseEvent(this);t.frameNumber%120===0&&Eat(this)};Rv.prototype.isDestroyed=function(){return!1};Rv.prototype.destroy=function(){return this._billboardCollection=this._billboardCollection&&this._billboardCollection.destroy(),ue(this)};var k_e=Rv;function DU(t){t=A(t,A.EMPTY_OBJECT);let n=On(t.container);this._container=n;let i=document.createElement("div");i.className="cesium-performanceDisplay";let o=document.createElement("div");o.className="cesium-performanceDisplay-fps",this._fpsText=document.createTextNode(""),o.appendChild(this._fpsText);let r=document.createElement("div");r.className="cesium-performanceDisplay-ms",this._msText=document.createTextNode(""),r.appendChild(this._msText),i.appendChild(r),i.appendChild(o),this._container.appendChild(i),this._lastFpsSampleTime=Fi(),this._lastMsSampleTime=Fi(),this._fpsFrameCount=0,this._msFrameCount=0,this._throttled=!1;let s=document.createElement("div");s.className="cesium-performanceDisplay-throttled",this._throttledText=document.createTextNode(""),s.appendChild(this._throttledText),i.appendChild(s)}Object.defineProperties(DU.prototype,{throttled:{get:function(){return this._throttled},set:function(t){this._throttled!==t&&(t?this._throttledText.nodeValue="(throttled)":this._throttledText.nodeValue="",this._throttled=t)}}});DU.prototype.update=function(t){let n=Fi(),i=A(t,!0);this._fpsFrameCount++;let o=n-this._lastFpsSampleTime;if(o>1e3){let s="N/A";i&&(s=this._fpsFrameCount*1e3/o|0),this._fpsText.nodeValue=`${s} FPS`,this._lastFpsSampleTime=n,this._fpsFrameCount=0}this._msFrameCount++;let r=n-this._lastMsSampleTime;if(r>200){let s="N/A";i&&(s=(r/this._msFrameCount).toFixed(2)),this._msText.nodeValue=`${s} MS`,this._lastMsSampleTime=n,this._msFrameCount=0}};DU.prototype.destroy=function(){return ue(this)};var Qg=DU;function xA(){this._framebuffer=new ci,this._textureToCopy=void 0,this._copyDepthCommand=void 0}Object.defineProperties(xA.prototype,{framebuffer:{get:function(){return this._framebuffer.framebuffer}}});function Dat(t,n,i){let o=i.width,r=i.height;t._framebuffer.update(n,o,r)}function vat(t,n,i){if(!f(t._copyDepthCommand)){let o=`uniform highp sampler2D u_texture;
varying vec2 v_textureCoordinates;
void main()
{
    gl_FragColor = czm_packDepth(texture2D(u_texture, v_textureCoordinates).r);
}
`;t._copyDepthCommand=n.createViewportQuadCommand(o,{renderState:Ve.fromCache(),uniformMap:{u_texture:function(){return t._textureToCopy}},owner:t})}t._textureToCopy=i,t._copyDepthCommand.framebuffer=t.framebuffer}xA.prototype.update=function(t,n){Dat(this,t,n),vat(this,t,n)};var Pat=new se,Iat=new se(1,1/255,1/65025,1/16581375);xA.prototype.getDepth=function(t,n,i){if(!f(this.framebuffer))return;let o=t.readPixels({x:n,y:i,width:1,height:1,framebuffer:this.framebuffer}),r=se.unpack(o,0,Pat);return se.divideByScalar(r,255,r),se.dot(r,Iat)};xA.prototype.executeCopyDepth=function(t,n){this._copyDepthCommand.execute(t,n)};xA.prototype.isDestroyed=function(){return!1};xA.prototype.destroy=function(){return this._framebuffer.destroy(),f(this._copyDepthCommand)&&(this._copyDepthCommand.shaderProgram=f(this._copyDepthCommand.shaderProgram)&&this._copyDepthCommand.shaderProgram.destroy()),ue(this)};var vU=xA;function Mv(){this._framebuffer=new ci({color:!1,depthStencil:!0,supportsDepthTexture:!0}),this._passState=void 0}Object.defineProperties(Mv.prototype,{framebuffer:{get:function(){return this._framebuffer.framebuffer}}});function Bat(t){t._framebuffer.destroy()}function Oat(t,n){let i=n.drawingBufferWidth,o=n.drawingBufferHeight;t._framebuffer.update(n,i,o);let r=new wc(n);r.blendingEnabled=!1,r.scissorTest={enabled:!0,rectangle:new He},r.viewport=new He,t._passState=r}Mv.prototype.update=function(t,n,i){let o=i.width,r=i.height;this._framebuffer.isDirty(o,r)&&Oat(this,t);let s=this.framebuffer,a=this._passState;return a.framebuffer=s,a.viewport.width=o,a.viewport.height=r,a.scissorTest.rectangle.x=n.x,a.scissorTest.rectangle.y=r-n.y,a.scissorTest.rectangle.width=1,a.scissorTest.rectangle.height=1,a};Mv.prototype.isDestroyed=function(){return!1};Mv.prototype.destroy=function(){return Bat(this),ue(this)};var PU=Mv;function Fv(t){let n=new wc(t);n.blendingEnabled=!1,n.scissorTest={enabled:!0,rectangle:new He},n.viewport=new He,this._context=t,this._fb=new ci({depthStencil:!0}),this._passState=n,this._width=0,this._height=0}Fv.prototype.begin=function(t,n){let i=this._context,o=n.width,r=n.height;return He.clone(t,this._passState.scissorTest.rectangle),this._width=o,this._height=r,this._fb.update(i,o,r),this._passState.framebuffer=this._fb.framebuffer,this._passState.viewport.width=o,this._passState.viewport.height=r,this._passState};var Lv=new z;Fv.prototype.end=function(t){let n=A(t.width,1),i=A(t.height,1),o=this._context,r=o.readPixels({x:t.x,y:t.y,width:n,height:i,framebuffer:this._fb.framebuffer}),s=Math.max(n,i),a=s*s,c=Math.floor(n*.5),l=Math.floor(i*.5),u=0,d=0,h=0,_=-1;for(let y=0;y<a;++y){if(-c<=u&&u<=c&&-l<=d&&d<=l){let p=4*((l-d)*n+u+c);Lv.red=z.byteToFloat(r[p]),Lv.green=z.byteToFloat(r[p+1]),Lv.blue=z.byteToFloat(r[p+2]),Lv.alpha=z.byteToFloat(r[p+3]);let C=o.getObjectByPickColor(Lv);if(f(C))return C}if(u===d||u<0&&-u===d||u>0&&u===1-d){let p=h;h=-_,_=p}u+=h,d+=_}};Fv.prototype.isDestroyed=function(){return!1};Fv.prototype.destroy=function(){return this._fb.destroy(),ue(this)};var IU=Fv;function Ep(){this._numSamples=1,this._colorFramebuffer=new ci({depthStencil:!0,supportsDepthTexture:!0}),this._idFramebuffer=new ci({depthStencil:!0,supportsDepthTexture:!0}),this._idClearColor=new z(0,0,0,0),this._clearCommand=new Qn({color:new z(0,0,0,0),depth:1,owner:this})}function Rat(t){t._colorFramebuffer.destroy(),t._idFramebuffer.destroy()}Object.defineProperties(Ep.prototype,{framebuffer:{get:function(){return this._colorFramebuffer.framebuffer}},idFramebuffer:{get:function(){return this._idFramebuffer.framebuffer}},depthStencilTexture:{get:function(){return this._colorFramebuffer.getDepthStencilTexture()}}});Ep.prototype.update=function(t,n,i,o){let r=n.width,s=n.height,a=i?t.halfFloatingPointTexture?je.HALF_FLOAT:je.FLOAT:je.UNSIGNED_BYTE;this._numSamples=o,this._colorFramebuffer.update(t,r,s,o,a),this._idFramebuffer.update(t,r,s)};Ep.prototype.clear=function(t,n,i){z.clone(i,this._clearCommand.color),z.clone(this._idClearColor,this._clearCommand.color),this._colorFramebuffer.clear(t,this._clearCommand,n),this._idFramebuffer.clear(t,this._clearCommand,n)};Ep.prototype.getFramebuffer=function(){return this._colorFramebuffer.framebuffer};Ep.prototype.getIdFramebuffer=function(){return this._idFramebuffer.framebuffer};Ep.prototype.prepareColorTextures=function(t){this._numSamples>1&&this._colorFramebuffer.prepareTextures(t)};Ep.prototype.isDestroyed=function(){return!1};Ep.prototype.destroy=function(){return Rat(this),ue(this)};var JE=Ep;function TA(){}TA.getShadowCastShaderKeyword=function(t,n,i,o){return`castShadow ${t} ${n} ${i} ${o}`};TA.createShadowCastVertexShader=function(t,n,i){let o=t.defines.slice(0),r=t.sources.slice(0);o.push("SHADOW_MAP"),i&&o.push("GENERATE_POSITION");let s=ze.findPositionVarying(t),a=f(s);if(n&&!a){let c=r.length;for(let u=0;u<c;++u)r[u]=ze.replaceMain(r[u],"czm_shadow_cast_main");let l=`varying vec3 v_positionEC; 
void main() 
{ 
    czm_shadow_cast_main(); 
    v_positionEC = (czm_inverseProjection * gl_Position).xyz; 
}`;r.push(l)}return new ze({defines:o,sources:r})};TA.createShadowCastFragmentShader=function(t,n,i,o){let r=t.defines.slice(0),s=t.sources.slice(0);r.push("SHADOW_MAP");let a=ze.findPositionVarying(t),c=f(a);c||(a="v_positionEC");let l=s.length;for(let d=0;d<l;++d)s[d]=ze.replaceMain(s[d],"czm_shadow_cast_main");let u="";return n&&(c||(u+=`varying vec3 v_positionEC; 
`),u+=`uniform vec4 shadowMap_lightPositionEC; 
`),o?u+=`void main() 
{ 
`:u+=`void main() 
{ 
    czm_shadow_cast_main(); 
    if (gl_FragColor.a == 0.0) 
    { 
       discard; 
    } 
`,n?u+=`    float distance = length(${a}); 
    if (distance >= shadowMap_lightPositionEC.w) 
    { 
        discard; 
    } 
    distance /= shadowMap_lightPositionEC.w; // radius 
    gl_FragColor = czm_packDepth(distance); 
`:i?u+=`    gl_FragColor = vec4(1.0); 
`:u+=`    gl_FragColor = czm_packDepth(gl_FragCoord.z); 
`,u+=`} 
`,s.push(u),new ze({defines:r,sources:s})};TA.getShadowReceiveShaderKeyword=function(t,n,i,o){let r=t._usesDepthTexture,s=t._polygonOffsetSupported,a=t._isPointLight,c=t._isSpotLight,l=t._numberOfCascades>1,u=t.debugCascadeColors,d=t.softShadows;return`receiveShadow ${r}${s}${a}${c}${l}${u}${d}${n}${i}${o}`};TA.createShadowReceiveVertexShader=function(t,n,i){let o=t.defines.slice(0),r=t.sources.slice(0);return o.push("SHADOW_MAP"),n&&(i?o.push("GENERATE_POSITION_AND_NORMAL"):o.push("GENERATE_POSITION")),new ze({defines:o,sources:r})};TA.createShadowReceiveFragmentShader=function(t,n,i,o,r){let s=ze.findNormalVarying(t),a=!o&&f(s)||o&&r,c=ze.findPositionVarying(t),l=f(c),u=n._usesDepthTexture,d=n._polygonOffsetSupported,h=n._isPointLight,_=n._isSpotLight,y=n._numberOfCascades>1,p=n.debugCascadeColors,C=n.softShadows,x=h?n._pointBias:o?n._terrainBias:n._primitiveBias,T=t.defines.slice(0),E=t.sources.slice(0),S=E.length;for(let I=0;I<S;++I)E[I]=ze.replaceMain(E[I],"czm_shadow_receive_main");h?T.push("USE_CUBE_MAP_SHADOW"):u&&T.push("USE_SHADOW_DEPTH_TEXTURE"),C&&!h&&T.push("USE_SOFT_SHADOWS"),y&&i&&o&&(a?T.push("ENABLE_VERTEX_LIGHTING"):T.push("ENABLE_DAYNIGHT_SHADING")),i&&x.normalShading&&a&&(T.push("USE_NORMAL_SHADING"),x.normalShadingSmooth>0&&T.push("USE_NORMAL_SHADING_SMOOTH"));let w="";h?w+=`uniform samplerCube shadowMap_textureCube; 
`:w+=`uniform sampler2D shadowMap_texture; 
`;let D;return l?D=`    return vec4(${c}, 1.0); 
`:D=`#ifndef LOG_DEPTH 
    return czm_windowToEyeCoordinates(gl_FragCoord); 
#else 
    return vec4(v_logPositionEC, 1.0); 
#endif 
`,w+=`uniform mat4 shadowMap_matrix; 
uniform vec3 shadowMap_lightDirectionEC; 
uniform vec4 shadowMap_lightPositionEC; 
uniform vec4 shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness; 
uniform vec4 shadowMap_texelSizeDepthBiasAndNormalShadingSmooth; 
#ifdef LOG_DEPTH 
varying vec3 v_logPositionEC; 
#endif 
vec4 getPositionEC() 
{ 
${D}} 
vec3 getNormalEC() 
{ 
${a?`    return normalize(${s}); 
`:`    return vec3(1.0); 
`}} 
void applyNormalOffset(inout vec4 positionEC, vec3 normalEC, float nDotL) 
{ 
${x.normalOffset&&a?`    float normalOffset = shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness.x; 
    float normalOffsetScale = 1.0 - nDotL; 
    vec3 offset = normalOffset * normalOffsetScale * normalEC; 
    positionEC.xyz += offset; 
`:""}} 
`,w+=`void main() 
{ 
    czm_shadow_receive_main(); 
    vec4 positionEC = getPositionEC(); 
    vec3 normalEC = getNormalEC(); 
    float depth = -positionEC.z; 
`,w+=`    czm_shadowParameters shadowParameters; 
    shadowParameters.texelStepSize = shadowMap_texelSizeDepthBiasAndNormalShadingSmooth.xy; 
    shadowParameters.depthBias = shadowMap_texelSizeDepthBiasAndNormalShadingSmooth.z; 
    shadowParameters.normalShadingSmooth = shadowMap_texelSizeDepthBiasAndNormalShadingSmooth.w; 
    shadowParameters.darkness = shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness.w; 
`,o?w+=`    shadowParameters.depthBias *= max(depth * 0.01, 1.0); 
`:d||(w+=`    shadowParameters.depthBias *= mix(1.0, 100.0, depth * 0.0015); 
`),h?w+=`    vec3 directionEC = positionEC.xyz - shadowMap_lightPositionEC.xyz; 
    float distance = length(directionEC); 
    directionEC = normalize(directionEC); 
    float radius = shadowMap_lightPositionEC.w; 
    // Stop early if the fragment is beyond the point light radius 
    if (distance > radius) 
    { 
        return; 
    } 
    vec3 directionWC  = czm_inverseViewRotation * directionEC; 
    shadowParameters.depth = distance / radius; 
    shadowParameters.nDotL = clamp(dot(normalEC, -directionEC), 0.0, 1.0); 
    shadowParameters.texCoords = directionWC; 
    float visibility = czm_shadowVisibility(shadowMap_textureCube, shadowParameters); 
`:_?w+=`    vec3 directionEC = normalize(positionEC.xyz - shadowMap_lightPositionEC.xyz); 
    float nDotL = clamp(dot(normalEC, -directionEC), 0.0, 1.0); 
    applyNormalOffset(positionEC, normalEC, nDotL); 
    vec4 shadowPosition = shadowMap_matrix * positionEC; 
    // Spot light uses a perspective projection, so perform the perspective divide 
    shadowPosition /= shadowPosition.w; 
    // Stop early if the fragment is not in the shadow bounds 
    if (any(lessThan(shadowPosition.xyz, vec3(0.0))) || any(greaterThan(shadowPosition.xyz, vec3(1.0)))) 
    { 
        return; 
    } 
    shadowParameters.texCoords = shadowPosition.xy; 
    shadowParameters.depth = shadowPosition.z; 
    shadowParameters.nDotL = nDotL; 
    float visibility = czm_shadowVisibility(shadowMap_texture, shadowParameters); 
`:y?w+=`    float maxDepth = shadowMap_cascadeSplits[1].w; 
    // Stop early if the eye depth exceeds the last cascade 
    if (depth > maxDepth) 
    { 
        return; 
    } 
    // Get the cascade based on the eye-space depth 
    vec4 weights = czm_cascadeWeights(depth); 
    // Apply normal offset 
    float nDotL = clamp(dot(normalEC, shadowMap_lightDirectionEC), 0.0, 1.0); 
    applyNormalOffset(positionEC, normalEC, nDotL); 
    // Transform position into the cascade 
    vec4 shadowPosition = czm_cascadeMatrix(weights) * positionEC; 
    // Get visibility 
    shadowParameters.texCoords = shadowPosition.xy; 
    shadowParameters.depth = shadowPosition.z; 
    shadowParameters.nDotL = nDotL; 
    float visibility = czm_shadowVisibility(shadowMap_texture, shadowParameters); 
    // Fade out shadows that are far away 
    float shadowMapMaximumDistance = shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness.z; 
    float fade = max((depth - shadowMapMaximumDistance * 0.8) / (shadowMapMaximumDistance * 0.2), 0.0); 
    visibility = mix(visibility, 1.0, fade); 
${p?`    // Draw cascade colors for debugging 
    gl_FragColor *= czm_cascadeColor(weights); 
`:""}`:w+=`    float nDotL = clamp(dot(normalEC, shadowMap_lightDirectionEC), 0.0, 1.0); 
    applyNormalOffset(positionEC, normalEC, nDotL); 
    vec4 shadowPosition = shadowMap_matrix * positionEC; 
    // Stop early if the fragment is not in the shadow bounds 
    if (any(lessThan(shadowPosition.xyz, vec3(0.0))) || any(greaterThan(shadowPosition.xyz, vec3(1.0)))) 
    { 
        return; 
    } 
    shadowParameters.texCoords = shadowPosition.xy; 
    shadowParameters.depth = shadowPosition.z; 
    shadowParameters.nDotL = nDotL; 
    float visibility = czm_shadowVisibility(shadowMap_texture, shadowParameters); 
`,w+=`    gl_FragColor.rgb *= visibility; 
} 
`,E.push(w),new ze({defines:T,sources:E})};var bp=TA;function qh(t){t=A(t,A.EMPTY_OBJECT);let n=t.context;this._enabled=A(t.enabled,!0),this._softShadows=A(t.softShadows,!1),this._normalOffset=A(t.normalOffset,!0),this.dirty=!0,this.fromLightSource=A(t.fromLightSource,!0),this.darkness=A(t.darkness,.3),this._darkness=this.darkness,this.fadingEnabled=A(t.fadingEnabled,!0),this.maximumDistance=A(t.maximumDistance,5e3),this._outOfView=!1,this._outOfViewPrevious=!1,this._needsUpdate=!0;let i=!0;(Vt.isInternetExplorer()||Vt.isEdge()||(Vt.isChrome()||Vt.isFirefox())&&Vt.isWindows()&&!n.depthTexture)&&(i=!1),this._polygonOffsetSupported=i,this._terrainBias={polygonOffset:i,polygonOffsetFactor:1.1,polygonOffsetUnits:4,normalOffset:this._normalOffset,normalOffsetScale:.5,normalShading:!0,normalShadingSmooth:.3,depthBias:1e-4},this._primitiveBias={polygonOffset:i,polygonOffsetFactor:1.1,polygonOffsetUnits:4,normalOffset:this._normalOffset,normalOffsetScale:.1,normalShading:!0,normalShadingSmooth:.05,depthBias:2e-5},this._pointBias={polygonOffset:!1,polygonOffsetFactor:1.1,polygonOffsetUnits:4,normalOffset:this._normalOffset,normalOffsetScale:0,normalShading:!0,normalShadingSmooth:.1,depthBias:5e-4},this._depthAttachment=void 0,this._colorAttachment=void 0,this._shadowMapMatrix=new N,this._shadowMapTexture=void 0,this._lightDirectionEC=new m,this._lightPositionEC=new se,this._distance=0,this._lightCamera=t.lightCamera,this._shadowMapCamera=new BU,this._shadowMapCullingVolume=void 0,this._sceneCamera=void 0,this._boundingSphere=new ae,this._isPointLight=A(t.isPointLight,!1),this._pointLightRadius=A(t.pointLightRadius,100),this._cascadesEnabled=this._isPointLight?!1:A(t.cascadesEnabled,!0),this._numberOfCascades=this._cascadesEnabled?A(t.numberOfCascades,4):0,this._fitNearFar=!0,this._maximumCascadeDistances=[25,150,700,Number.MAX_VALUE],this._textureSize=new W,this._isSpotLight=!1,this._cascadesEnabled?this._shadowMapCamera.frustum=new Br:f(this._lightCamera.frustum.fov)&&(this._isSpotLight=!0),this._cascadeSplits=[new se,new se],this._cascadeMatrices=[new N,new N,new N,new N],this._cascadeDistances=new se;let o;this._isPointLight?o=6:this._cascadesEnabled?o=this._numberOfCascades:o=1,this._passes=new Array(o);for(let r=0;r<o;++r)this._passes[r]=new Mat(n);this.debugShow=!1,this.debugFreezeFrame=!1,this._debugFreezeFrame=!1,this._debugCascadeColors=!1,this._debugLightFrustum=void 0,this._debugCameraFrustum=void 0,this._debugCascadeFrustums=new Array(this._numberOfCascades),this._debugShadowViewCommand=void 0,this._usesDepthTexture=n.depthTexture,this._isPointLight&&(this._usesDepthTexture=!1),this._primitiveRenderState=void 0,this._terrainRenderState=void 0,this._pointRenderState=void 0,Yj(this),this._clearCommand=new Qn({depth:1,color:new z}),this._clearPassState=new wc(n),this._size=A(t.size,2048),this.size=this._size}qh.MAXIMUM_DISTANCE=2e4;function Mat(t){this.camera=new BU,this.passState=new wc(t),this.framebuffer=void 0,this.textureOffsets=void 0,this.commandList=[],this.cullingVolume=void 0}function qj(t,n){return Ve.fromCache({cull:{enabled:!0,face:xi.BACK},depthTest:{enabled:!0},colorMask:{red:t,green:t,blue:t,alpha:t},depthMask:!0,polygonOffset:{enabled:n.polygonOffset,factor:n.polygonOffsetFactor,units:n.polygonOffsetUnits}})}function Yj(t){let n=!t._usesDepthTexture;t._primitiveRenderState=qj(n,t._primitiveBias),t._terrainRenderState=qj(n,t._terrainBias),t._pointRenderState=qj(n,t._pointBias)}qh.prototype.debugCreateRenderStates=function(){Yj(this)};Object.defineProperties(qh.prototype,{enabled:{get:function(){return this._enabled},set:function(t){this.dirty=this._enabled!==t,this._enabled=t}},normalOffset:{get:function(){return this._normalOffset},set:function(t){this.dirty=this._normalOffset!==t,this._normalOffset=t,this._terrainBias.normalOffset=t,this._primitiveBias.normalOffset=t,this._pointBias.normalOffset=t}},softShadows:{get:function(){return this._softShadows},set:function(t){this.dirty=this._softShadows!==t,this._softShadows=t}},size:{get:function(){return this._size},set:function(t){Uat(this,t)}},outOfView:{get:function(){return this._outOfView}},shadowMapCullingVolume:{get:function(){return this._shadowMapCullingVolume}},passes:{get:function(){return this._passes}},isPointLight:{get:function(){return this._isPointLight}},debugCascadeColors:{get:function(){return this._debugCascadeColors},set:function(t){this.dirty=this._debugCascadeColors!==t,this._debugCascadeColors=t}}});function Xj(t){let n=t._passes.length;for(let i=0;i<n;++i){let o=t._passes[i],r=o.framebuffer;f(r)&&!r.isDestroyed()&&r.destroy(),o.framebuffer=void 0}t._depthAttachment=t._depthAttachment&&t._depthAttachment.destroy(),t._colorAttachment=t._colorAttachment&&t._colorAttachment.destroy()}function Lat(t,n){let i=new mu({context:n,width:t._textureSize.x,height:t._textureSize.y,format:Hc.DEPTH_COMPONENT16}),o=new St({context:n,width:t._textureSize.x,height:t._textureSize.y,pixelFormat:st.RGBA,pixelDatatype:je.UNSIGNED_BYTE,sampler:pn.NEAREST}),r=new Xo({context:n,depthRenderbuffer:i,colorTextures:[o],destroyAttachments:!1}),s=t._passes.length;for(let a=0;a<s;++a){let c=t._passes[a];c.framebuffer=r,c.passState.framebuffer=r}t._shadowMapTexture=o,t._depthAttachment=i,t._colorAttachment=o}function Fat(t,n){let i=new St({context:n,width:t._textureSize.x,height:t._textureSize.y,pixelFormat:st.DEPTH_STENCIL,pixelDatatype:je.UNSIGNED_INT_24_8,sampler:pn.NEAREST}),o=new Xo({context:n,depthStencilTexture:i,destroyAttachments:!1}),r=t._passes.length;for(let s=0;s<r;++s){let a=t._passes[s];a.framebuffer=o,a.passState.framebuffer=o}t._shadowMapTexture=i,t._depthAttachment=i}function Nat(t,n){let i=new mu({context:n,width:t._textureSize.x,height:t._textureSize.y,format:Hc.DEPTH_COMPONENT16}),o=new tc({context:n,width:t._textureSize.x,height:t._textureSize.y,pixelFormat:st.RGBA,pixelDatatype:je.UNSIGNED_BYTE,sampler:pn.NEAREST}),r=[o.negativeX,o.negativeY,o.negativeZ,o.positiveX,o.positiveY,o.positiveZ];for(let s=0;s<6;++s){let a=new Xo({context:n,depthRenderbuffer:i,colorTextures:[r[s]],destroyAttachments:!1}),c=t._passes[s];c.framebuffer=a,c.passState.framebuffer=a}t._shadowMapTexture=o,t._depthAttachment=i,t._colorAttachment=o}function H_e(t,n){t._isPointLight?Nat(t,n):t._usesDepthTexture?Fat(t,n):Lat(t,n)}function Vat(t,n){t._usesDepthTexture&&t._passes[0].framebuffer.status!==ee.FRAMEBUFFER_COMPLETE&&(t._usesDepthTexture=!1,Yj(t),Xj(t),H_e(t,n))}function kat(t,n){(!f(t._passes[0].framebuffer)||t._shadowMapTexture.width!==t._textureSize.x)&&(Xj(t),H_e(t,n),Vat(t,n),G_e(t,n))}function G_e(t,n,i){i=A(i,0),(t._isPointLight||i===0)&&(t._clearCommand.framebuffer=t._passes[i].framebuffer,t._clearCommand.execute(n,t._clearPassState))}function Uat(t,n){t._size=n;let i=t._passes,o=i.length,r=t._textureSize;if(t._isPointLight){n=Ut.maximumCubeMapSize>=n?n:Ut.maximumCubeMapSize,r.x=n,r.y=n;let s=new He(0,0,n,n);i[0].passState.viewport=s,i[1].passState.viewport=s,i[2].passState.viewport=s,i[3].passState.viewport=s,i[4].passState.viewport=s,i[5].passState.viewport=s}else o===1?(n=Ut.maximumTextureSize>=n?n:Ut.maximumTextureSize,r.x=n,r.y=n,i[0].passState.viewport=new He(0,0,n,n)):o===4&&(n=Ut.maximumTextureSize>=n*2?n:Ut.maximumTextureSize/2,r.x=n*2,r.y=n*2,i[0].passState.viewport=new He(0,0,n,n),i[1].passState.viewport=new He(n,0,n,n),i[2].passState.viewport=new He(0,n,n,n),i[3].passState.viewport=new He(n,n,n,n));t._clearPassState.viewport=new He(0,0,r.x,r.y);for(let s=0;s<o;++s){let a=i[s],c=a.passState.viewport,l=c.x/r.x,u=c.y/r.y,d=c.width/r.x,h=c.height/r.y;a.textureOffsets=new N(d,0,0,l,0,h,0,u,0,0,1,0,0,0,0,1)}}var zat=new He;function Hat(t,n){let i;t._isPointLight?i=`uniform samplerCube shadowMap_textureCube; 
varying vec2 v_textureCoordinates; 
void main() 
{ 
    vec2 uv = v_textureCoordinates; 
    vec3 dir; 
 
    if (uv.y < 0.5) 
    { 
        if (uv.x < 0.333) 
        { 
            dir.x = -1.0; 
            dir.y = uv.x * 6.0 - 1.0; 
            dir.z = uv.y * 4.0 - 1.0; 
        } 
        else if (uv.x < 0.666) 
        { 
            dir.y = -1.0; 
            dir.x = uv.x * 6.0 - 3.0; 
            dir.z = uv.y * 4.0 - 1.0; 
        } 
        else 
        { 
            dir.z = -1.0; 
            dir.x = uv.x * 6.0 - 5.0; 
            dir.y = uv.y * 4.0 - 1.0; 
        } 
    } 
    else 
    { 
        if (uv.x < 0.333) 
        { 
            dir.x = 1.0; 
            dir.y = uv.x * 6.0 - 1.0; 
            dir.z = uv.y * 4.0 - 3.0; 
        } 
        else if (uv.x < 0.666) 
        { 
            dir.y = 1.0; 
            dir.x = uv.x * 6.0 - 3.0; 
            dir.z = uv.y * 4.0 - 3.0; 
        } 
        else 
        { 
            dir.z = 1.0; 
            dir.x = uv.x * 6.0 - 5.0; 
            dir.y = uv.y * 4.0 - 3.0; 
        } 
    } 
 
    float shadow = czm_unpackDepth(textureCube(shadowMap_textureCube, dir)); 
    gl_FragColor = vec4(vec3(shadow), 1.0); 
} 
`:i=`uniform sampler2D shadowMap_texture; 
varying vec2 v_textureCoordinates; 
void main() 
{ 
${t._usesDepthTexture?`    float shadow = texture2D(shadowMap_texture, v_textureCoordinates).r; 
`:`    float shadow = czm_unpackDepth(texture2D(shadowMap_texture, v_textureCoordinates)); 
`}    gl_FragColor = vec4(vec3(shadow), 1.0); 
} 
`;let o=n.createViewportQuadCommand(i,{uniformMap:{shadowMap_texture:function(){return t._shadowMapTexture},shadowMap_textureCube:function(){return t._shadowMapTexture}}});return o.pass=Te.OVERLAY,o}function Gat(t,n){let i=n.context,o=n.context.drawingBufferWidth,r=n.context.drawingBufferHeight,s=Math.min(o,r)*.3,a=zat;a.x=o-s,a.y=0,a.width=s,a.height=s;let c=t._debugShadowViewCommand;f(c)||(c=Hat(t,i),t._debugShadowViewCommand=c),(!f(c.renderState)||!He.equals(c.renderState.viewport,a))&&(c.renderState=Ve.fromCache({viewport:He.clone(a)})),n.commandList.push(t._debugShadowViewCommand)}var Yh=new Array(8);Yh[0]=new se(-1,-1,-1,1);Yh[1]=new se(1,-1,-1,1);Yh[2]=new se(1,1,-1,1);Yh[3]=new se(-1,1,-1,1);Yh[4]=new se(-1,-1,1,1);Yh[5]=new se(1,-1,1,1);Yh[6]=new se(1,1,1,1);Yh[7]=new se(-1,1,1,1);var $g=new N,Kj=new Array(8);for(let t=0;t<8;++t)Kj[t]=new se;function Wat(t,n){let i=new Ct({geometry:new Ld({minimum:new m(-.5,-.5,-.5),maximum:new m(.5,.5,.5)}),attributes:{color:Lt.fromColor(n)}}),o=new Ct({geometry:new H_({radius:.5}),attributes:{color:Lt.fromColor(n)}});return new Sn({geometryInstances:[i,o],appearance:new tn({translucent:!1,flat:!0}),asynchronous:!1,modelMatrix:t})}var jat=[z.RED,z.GREEN,z.BLUE,z.MAGENTA],qat=new m;function Yat(t,n){Gat(t,n);let i=t.debugFreezeFrame&&!t._debugFreezeFrame;if(t._debugFreezeFrame=t.debugFreezeFrame,t.debugFreezeFrame&&(i&&(t._debugCameraFrustum=t._debugCameraFrustum&&t._debugCameraFrustum.destroy(),t._debugCameraFrustum=new Cp({camera:t._sceneCamera,color:z.CYAN,updateOnChange:!1})),t._debugCameraFrustum.update(n)),t._cascadesEnabled){if(t.debugFreezeFrame){i&&(t._debugLightFrustum=t._debugLightFrustum&&t._debugLightFrustum.destroy(),t._debugLightFrustum=new Cp({camera:t._shadowMapCamera,color:z.YELLOW,updateOnChange:!1})),t._debugLightFrustum.update(n);for(let o=0;o<t._numberOfCascades;++o)i&&(t._debugCascadeFrustums[o]=t._debugCascadeFrustums[o]&&t._debugCascadeFrustums[o].destroy(),t._debugCascadeFrustums[o]=new Cp({camera:t._passes[o].camera,color:jat[o],updateOnChange:!1})),t._debugCascadeFrustums[o].update(n)}}else if(t._isPointLight){if(!f(t._debugLightFrustum)||t._needsUpdate){let o=t._shadowMapCamera.positionWC,r=Me.IDENTITY,s=t._pointLightRadius*2,a=m.fromElements(s,s,s,qat),c=N.fromTranslationQuaternionRotationScale(o,r,a,$g);t._debugLightFrustum=t._debugLightFrustum&&t._debugLightFrustum.destroy(),t._debugLightFrustum=Wat(c,z.YELLOW)}t._debugLightFrustum.update(n)}else(!f(t._debugLightFrustum)||t._needsUpdate)&&(t._debugLightFrustum=new Cp({camera:t._shadowMapCamera,color:z.YELLOW,updateOnChange:!1})),t._debugLightFrustum.update(n)}function BU(){this.viewMatrix=new N,this.inverseViewMatrix=new N,this.frustum=void 0,this.positionCartographic=new de,this.positionWC=new m,this.directionWC=m.clone(m.UNIT_Z),this.upWC=m.clone(m.UNIT_Y),this.rightWC=m.clone(m.UNIT_X),this.viewProjectionMatrix=new N}BU.prototype.clone=function(t){N.clone(t.viewMatrix,this.viewMatrix),N.clone(t.inverseViewMatrix,this.inverseViewMatrix),this.frustum=t.frustum.clone(this.frustum),de.clone(t.positionCartographic,this.positionCartographic),m.clone(t.positionWC,this.positionWC),m.clone(t.directionWC,this.directionWC),m.clone(t.upWC,this.upWC),m.clone(t.rightWC,this.rightWC)};var Xat=new N(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1);BU.prototype.getViewProjection=function(){let t=this.viewMatrix,n=this.frustum.projectionMatrix;return N.multiply(n,t,this.viewProjectionMatrix),N.multiply(Xat,this.viewProjectionMatrix,this.viewProjectionMatrix),this.viewProjectionMatrix};var Kat=new Array(5),Jat=new yi,Zat=new Array(4),W_e=new m,j_e=new m;function Qat(t,n){let i=t._shadowMapCamera,o=t._sceneCamera,r=o.frustum.near,s=o.frustum.far,a=t._numberOfCascades,c,l=s-r,u=s/r,d=.9,h=!1;n.shadowState.closestObjectSize<200&&(h=!0,d=.9);let _=Zat,y=Kat;for(y[0]=r,y[a]=s,c=0;c<a;++c){let F=(c+1)/a,g=r*Math.pow(u,F),b=r+l*F,v=B.lerp(b,g,d);y[c+1]=v,_[c]=v-y[c]}if(h){for(c=0;c<a;++c)_[c]=Math.min(_[c],t._maximumCascadeDistances[c]);let F=y[0];for(c=0;c<a-1;++c)F+=_[c],y[c+1]=F}se.unpack(y,0,t._cascadeSplits[0]),se.unpack(y,1,t._cascadeSplits[1]),se.unpack(_,0,t._cascadeDistances);let p=i.frustum,C=p.left,x=p.right,T=p.bottom,E=p.top,S=p.near,w=p.far,D=i.positionWC,I=i.directionWC,O=i.upWC,M=o.frustum.clone(Jat),L=i.getViewProjection();for(c=0;c<a;++c){M.near=y[c],M.far=y[c+1];let F=N.multiply(M.projectionMatrix,o.viewMatrix,$g),g=N.inverse(F,$g),b=N.multiply(L,g,$g),v=m.fromElements(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,W_e),P=m.fromElements(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE,j_e);for(let G=0;G<8;++G){let k=se.clone(Yh[G],Kj[G]);N.multiplyByVector(b,k,k),m.divideByScalar(k,k.w,k),m.minimumByComponent(k,v,v),m.maximumByComponent(k,P,P)}v.x=Math.max(v.x,0),v.y=Math.max(v.y,0),v.z=0,P.x=Math.min(P.x,1),P.y=Math.min(P.y,1),P.z=Math.min(P.z,1);let R=t._passes[c],V=R.camera;V.clone(i);let H=V.frustum;H.left=C+v.x*(x-C),H.right=C+P.x*(x-C),H.bottom=T+v.y*(E-T),H.top=T+P.y*(E-T),H.near=S+v.z*(w-S),H.far=S+P.z*(w-S),R.cullingVolume=V.frustum.computeCullingVolume(D,I,O);let U=t._cascadeMatrices[c];N.multiply(V.getViewProjection(),o.inverseViewMatrix,U),N.multiply(R.textureOffsets,U,U)}}var $at=new N,ect=new m,tct=new m,U_e=new m;function nct(t,n){let i=t._shadowMapCamera,o=t._sceneCamera,r=N.multiply(o.frustum.projectionMatrix,o.viewMatrix,$g),s=N.inverse(r,$g),a=i.directionWC,c=o.directionWC;m.equalsEpsilon(a,c,B.EPSILON10)&&(c=o.upWC);let l=m.cross(a,c,ect);c=m.cross(l,a,tct),m.normalize(c,c),m.normalize(l,l);let u=m.fromElements(0,0,0,U_e),d=N.computeView(u,a,c,l,$at),h=N.multiply(d,s,$g),_=m.fromElements(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,W_e),y=m.fromElements(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE,j_e);for(let w=0;w<8;++w){let D=se.clone(Yh[w],Kj[w]);N.multiplyByVector(h,D,D),m.divideByScalar(D,D.w,D),m.minimumByComponent(D,_,_),m.maximumByComponent(D,y,y)}y.z+=1e3,_.z-=10;let p=U_e;p.x=-(.5*(_.x+y.x)),p.y=-(.5*(_.y+y.y)),p.z=-y.z;let C=N.fromTranslation(p,$g);d=N.multiply(C,d,d);let x=.5*(y.x-_.x),T=.5*(y.y-_.y),E=y.z-_.z,S=i.frustum;S.left=-x,S.right=x,S.bottom=-T,S.top=T,S.near=.01,S.far=E,N.clone(d,i.viewMatrix),N.inverse(d,i.inverseViewMatrix),N.getTranslation(i.inverseViewMatrix,i.positionWC),n.mapProjection.ellipsoid.cartesianToCartographic(i.positionWC,i.positionCartographic),m.clone(a,i.directionWC),m.clone(c,i.upWC),m.clone(l,i.rightWC)}var ict=[new m(-1,0,0),new m(0,-1,0),new m(0,0,-1),new m(1,0,0),new m(0,1,0),new m(0,0,1)],oct=[new m(0,-1,0),new m(0,0,-1),new m(0,-1,0),new m(0,-1,0),new m(0,0,1),new m(0,-1,0)],rct=[new m(0,0,1),new m(1,0,0),new m(-1,0,0),new m(0,0,-1),new m(1,0,0),new m(1,0,0)];function sct(t,n){let i=new yi;i.fov=B.PI_OVER_TWO,i.near=1,i.far=t._pointLightRadius,i.aspectRatio=1;for(let o=0;o<6;++o){let r=t._passes[o].camera;r.positionWC=t._shadowMapCamera.positionWC,r.positionCartographic=n.mapProjection.ellipsoid.cartesianToCartographic(r.positionWC,r.positionCartographic),r.directionWC=ict[o],r.upWC=oct[o],r.rightWC=rct[o],N.computeView(r.positionWC,r.directionWC,r.upWC,r.rightWC,r.viewMatrix),N.inverse(r.viewMatrix,r.inverseViewMatrix),r.frustum=i}}var act=new m,cct=new m,q_e=new ae,z_e=q_e.center;function lct(t,n){let i=t._sceneCamera,o=t._shadowMapCamera,r=q_e;if(t._cascadesEnabled){if(i.frustum.near>=t.maximumDistance){t._outOfView=!0,t._needsUpdate=!1;return}let s=n.mapProjection.ellipsoid.geodeticSurfaceNormal(i.positionWC,act),a=m.negate(o.directionWC,cct),c=m.dot(s,a);if(t.fadingEnabled){let l=B.clamp(c/.1,0,1);t._darkness=B.lerp(1,t.darkness,l)}else t._darkness=t.darkness;if(c<0){t._outOfView=!0,t._needsUpdate=!1;return}t._needsUpdate=!0,t._outOfView=!1}else if(t._isPointLight)r.center=o.positionWC,r.radius=t._pointLightRadius,t._outOfView=n.cullingVolume.computeVisibility(r)===jt.OUTSIDE,t._needsUpdate=!t._outOfView&&!t._boundingSphere.equals(r),ae.clone(r,t._boundingSphere);else{let s=o.frustum.far/2,a=m.add(o.positionWC,m.multiplyByScalar(o.directionWC,s,z_e),z_e);r.center=a,r.radius=s,t._outOfView=n.cullingVolume.computeVisibility(r)===jt.OUTSIDE,t._needsUpdate=!t._outOfView&&!t._boundingSphere.equals(r),ae.clone(r,t._boundingSphere)}}function uct(t,n){let i=n.camera,o=t._lightCamera,r=t._sceneCamera,s=t._shadowMapCamera;t._cascadesEnabled?m.clone(o.directionWC,s.directionWC):t._isPointLight?m.clone(o.positionWC,s.positionWC):s.clone(o);let a=t._lightDirectionEC;N.multiplyByPointAsVector(i.viewMatrix,s.directionWC,a),m.normalize(a,a),m.negate(a,a),N.multiplyByPoint(i.viewMatrix,s.positionWC,t._lightPositionEC),t._lightPositionEC.w=t._pointLightRadius;let c,l;t._fitNearFar?(c=Math.min(n.shadowState.nearPlane,t.maximumDistance),l=Math.min(n.shadowState.farPlane,t.maximumDistance),l=Math.max(l,c+1)):(c=i.frustum.near,l=t.maximumDistance),t._sceneCamera=lo.clone(i,r),i.frustum.clone(t._sceneCamera.frustum),t._sceneCamera.frustum.near=c,t._sceneCamera.frustum.far=l,t._distance=l-c,lct(t,n),!t._outOfViewPrevious&&t._outOfView&&(t._needsUpdate=!0),t._outOfViewPrevious=t._outOfView}qh.prototype.update=function(t){if(uct(this,t),this._needsUpdate)if(kat(this,t.context),this._isPointLight&&sct(this,t),this._cascadesEnabled&&(nct(this,t),this._numberOfCascades>1&&Qat(this,t)),this._isPointLight)this._shadowMapCullingVolume=$s.fromBoundingSphere(this._boundingSphere);else{let n=this._shadowMapCamera,i=n.positionWC,o=n.directionWC,r=n.upWC;this._shadowMapCullingVolume=n.frustum.computeCullingVolume(i,o,r),this._passes.length===1&&this._passes[0].camera.clone(n)}if(this._passes.length===1){let n=this._sceneCamera.inverseViewMatrix;N.multiply(this._shadowMapCamera.getViewProjection(),n,this._shadowMapMatrix)}this.debugShow&&Yat(this,t)};qh.prototype.updatePass=function(t,n){G_e(this,t,n)};var fct=new W;function Y_e(t,n,i){let o=t._isPointLight?t._pointBias:i?t._terrainBias:t._primitiveBias,r={shadowMap_texture:function(){return t._shadowMapTexture},shadowMap_textureCube:function(){return t._shadowMapTexture},shadowMap_matrix:function(){return t._shadowMapMatrix},shadowMap_cascadeSplits:function(){return t._cascadeSplits},shadowMap_cascadeMatrices:function(){return t._cascadeMatrices},shadowMap_lightDirectionEC:function(){return t._lightDirectionEC},shadowMap_lightPositionEC:function(){return t._lightPositionEC},shadowMap_cascadeDistances:function(){return t._cascadeDistances},shadowMap_texelSizeDepthBiasAndNormalShadingSmooth:function(){let s=fct;return s.x=1/t._textureSize.x,s.y=1/t._textureSize.y,se.fromElements(s.x,s.y,o.depthBias,o.normalShadingSmooth,this.combinedUniforms1)},shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness:function(){return se.fromElements(o.normalOffsetScale,t._distance,t.maximumDistance,t._darkness,this.combinedUniforms2)},combinedUniforms1:new se,combinedUniforms2:new se};return At(n,r,!1)}function dct(t,n,i,o,r,s){let a,c,l;if(f(s)&&(a=s.shaderProgram,c=s.renderState,l=s.uniformMap),s=et.shallowClone(i,s),s.castShadows=!0,s.receiveShadows=!1,!f(a)||r!==i.shaderProgram.id||n){let u=i.shaderProgram,d=i.pass===Te.GLOBE,h=i.pass!==Te.TRANSLUCENT,_=t._isPointLight,y=t._usesDepthTexture,p=bp.getShadowCastShaderKeyword(_,d,y,h);if(a=o.shaderCache.getDerivedShaderProgram(u,p),!f(a)){let x=u.vertexShaderSource,T=u.fragmentShaderSource,E=bp.createShadowCastVertexShader(x,_,d),S=bp.createShadowCastFragmentShader(T,_,y,h);a=o.shaderCache.createDerivedShaderProgram(u,p,{vertexShaderSource:E,fragmentShaderSource:S,attributeLocations:u._attributeLocations})}c=t._primitiveRenderState,_?c=t._pointRenderState:d&&(c=t._terrainRenderState),i.renderState.cull.enabled||(c=tt(c,!1),c.cull=tt(c.cull,!1),c.cull.enabled=!1,c=Ve.fromCache(c)),l=Y_e(t,i.uniformMap,d)}return s.shaderProgram=a,s.renderState=c,s.uniformMap=l,s}qh.createReceiveDerivedCommand=function(t,n,i,o,r){f(r)||(r={});let s=t.length>0,a=n.shaderProgram,c=a.vertexShaderSource,l=a.fragmentShaderSource,u=n.pass===Te.GLOBE,d=!1;if(u&&(d=n.owner.data.renderedMesh.encoding.hasVertexNormals),n.receiveShadows&&s){let h,_;f(r.receiveCommand)&&(h=r.receiveCommand.shaderProgram,_=r.receiveCommand.uniformMap),r.receiveCommand=et.shallowClone(n,r.receiveCommand),r.castShadows=!1,r.receiveShadows=!0;let y=r.receiveShaderCastShadows!==n.castShadows,p=r.receiveShaderProgramId!==n.shaderProgram.id;if(!f(h)||p||i||y){let C=bp.getShadowReceiveShaderKeyword(t[0],n.castShadows,u,d);if(h=o.shaderCache.getDerivedShaderProgram(a,C),!f(h)){let x=bp.createShadowReceiveVertexShader(c,u,d),T=bp.createShadowReceiveFragmentShader(l,t[0],n.castShadows,u,d);h=o.shaderCache.createDerivedShaderProgram(a,C,{vertexShaderSource:x,fragmentShaderSource:T,attributeLocations:a._attributeLocations})}_=Y_e(t[0],n.uniformMap,u)}r.receiveCommand.shaderProgram=h,r.receiveCommand.uniformMap=_,r.receiveShaderProgramId=n.shaderProgram.id,r.receiveShaderCastShadows=n.castShadows}return r};qh.createCastDerivedCommand=function(t,n,i,o,r){if(f(r)||(r={}),n.castShadows){let s=r.castCommands;f(s)||(s=r.castCommands=[]);let a=r.castShaderProgramId,c=t.length;s.length=c;for(let l=0;l<c;++l)s[l]=dct(t[l],i,n,o,a,s[l]);r.castShaderProgramId=n.shaderProgram.id}return r};qh.prototype.isDestroyed=function(){return!1};qh.prototype.destroy=function(){Xj(this),this._debugLightFrustum=this._debugLightFrustum&&this._debugLightFrustum.destroy(),this._debugCameraFrustum=this._debugCameraFrustum&&this._debugCameraFrustum.destroy(),this._debugShadowViewCommand=this._debugShadowViewCommand&&this._debugShadowViewCommand.shaderProgram&&this._debugShadowViewCommand.shaderProgram.destroy();for(let t=0;t<this._numberOfCascades;++t)this._debugCascadeFrustums[t]=this._debugCascadeFrustums[t]&&this._debugCascadeFrustums[t].destroy();return ue(this)};var e0=qh;var ZE=`uniform sampler2D colorTexture;
#ifdef DEBUG_SHOW_DEPTH
uniform sampler2D u_packedTranslucentDepth;
#endif
varying vec2 v_textureCoordinates;
void main()
{
#ifdef DEBUG_SHOW_DEPTH
if (v_textureCoordinates.x < 0.5)
{
gl_FragColor.rgb = vec3(czm_unpackDepth(texture2D(u_packedTranslucentDepth, v_textureCoordinates)));
gl_FragColor.a = 1.0;
}
#else
vec4 color = texture2D(colorTexture, v_textureCoordinates);
#ifdef PICK
if (color == vec4(0.0))
{
discard;
}
#else
color.rgb /= color.a;
#endif
gl_FragColor = color;
#endif
}
`;var hct=!1;function t0(t){this._drawClassificationFBO=new ci({createDepthAttachments:!1}),this._accumulationFBO=new ci({createDepthAttachments:!1}),this._packFBO=new ci,this._opaqueDepthStencilTexture=void 0,this._textureToComposite=void 0,this._translucentDepthStencilTexture=void 0,this._packDepthCommand=void 0,this._accumulateCommand=void 0,this._compositeCommand=void 0,this._copyCommand=void 0,this._clearColorCommand=new Qn({color:new z(0,0,0,0),owner:this}),this._clearDepthStencilCommand=new Qn({depth:1,stencil:0,owner:this}),this._supported=t.depthTexture,this._viewport=new He,this._rsDepth=void 0,this._rsAccumulate=void 0,this._rsComp=void 0,this._useScissorTest=void 0,this._scissorRectangle=void 0,this._hasTranslucentDepth=!1,this._frustumsDrawn=0}Object.defineProperties(t0.prototype,{hasTranslucentDepth:{get:function(){return this._hasTranslucentDepth}}});function X_e(t){t._textureToComposite=void 0,t._translucentDepthStencilTexture=t._translucentDepthStencilTexture&&!t._translucentDepthStencilTexture.isDestroyed()&&t._translucentDepthStencilTexture.destroy()}function K_e(t){t._drawClassificationFBO.destroy(),t._accumulationFBO.destroy(),t._packFBO.destroy()}function mct(t,n,i,o){X_e(t),t._translucentDepthStencilTexture=new St({context:n,width:i,height:o,pixelFormat:st.DEPTH_STENCIL,pixelDatatype:je.UNSIGNED_INT_24_8,sampler:pn.NEAREST})}function pct(t,n,i,o){K_e(t),t._drawClassificationFBO.setDepthStencilTexture(t._translucentDepthStencilTexture),t._drawClassificationFBO.update(n,i,o),t._accumulationFBO.setDepthStencilTexture(t._translucentDepthStencilTexture),t._accumulationFBO.update(n,i,o),t._packFBO.update(n,i,o)}function _ct(t,n,i,o){if(!t.isSupported())return;t._opaqueDepthStencilTexture=o;let r=t._opaqueDepthStencilTexture.width,s=t._opaqueDepthStencilTexture.height;t._drawClassificationFBO.isDirty(r,s)&&(mct(t,n,r,s),pct(t,n,r,s));let a,c;if(f(t._packDepthCommand)||(a=new ze({sources:[BV]}),c={u_opaqueDepthTexture:function(){return t._opaqueDepthStencilTexture},u_translucentDepthTexture:function(){return t._translucentDepthStencilTexture}},t._packDepthCommand=n.createViewportQuadCommand(a,{uniformMap:c,owner:t})),!f(t._compositeCommand)){a=new ze({sources:[ZE]}),c={colorTexture:function(){return t._textureToComposite}},hct&&(a.defines=["DEBUG_SHOW_DEPTH"],c.u_packedTranslucentDepth=function(){return t._packFBO.getColorTexture()}),t._compositeCommand=n.createViewportQuadCommand(a,{uniformMap:c,owner:t});let d=t._compositeCommand,h=d.shaderProgram,_=n.shaderCache.createDerivedShaderProgram(h,"pick",{vertexShaderSource:h.vertexShaderSource,fragmentShaderSource:new ze({sources:a.sources,defines:["PICK"]}),attributeLocations:h._attributeLocations}),y=et.shallowClone(d);y.shaderProgram=_,d.derivedCommands.pick=y}f(t._copyCommand)||(a=new ze({sources:[ZE]}),c={colorTexture:function(){return t._drawClassificationFBO.getColorTexture()}},t._copyCommand=n.createViewportQuadCommand(a,{uniformMap:c,owner:t})),f(t._accumulateCommand)||(a=new ze({sources:[ZE]}),c={colorTexture:function(){return t._drawClassificationFBO.getColorTexture()}},t._accumulateCommand=n.createViewportQuadCommand(a,{uniformMap:c,owner:t})),t._viewport.width=r,t._viewport.height=s;let l=!He.equals(t._viewport,i.viewport),u=l!==t._useScissorTest;t._useScissorTest=l,He.equals(t._scissorRectangle,i.viewport)||(t._scissorRectangle=He.clone(i.viewport,t._scissorRectangle),u=!0),(!f(t._rsDepth)||!He.equals(t._viewport,t._rsDepth.viewport)||u)&&(t._rsDepth=Ve.fromCache({viewport:t._viewport,scissorTest:{enabled:t._useScissorTest,rectangle:t._scissorRectangle}})),f(t._packDepthCommand)&&(t._packDepthCommand.renderState=t._rsDepth),(!f(t._rsAccumulate)||!He.equals(t._viewport,t._rsAccumulate.viewport)||u)&&(t._rsAccumulate=Ve.fromCache({viewport:t._viewport,scissorTest:{enabled:t._useScissorTest,rectangle:t._scissorRectangle},stencilTest:{enabled:!0,frontFunction:kn.EQUAL,reference:Ot.CESIUM_3D_TILE_MASK}})),f(t._accumulateCommand)&&(t._accumulateCommand.renderState=t._rsAccumulate),(!f(t._rsComp)||!He.equals(t._viewport,t._rsComp.viewport)||u)&&(t._rsComp=Ve.fromCache({viewport:t._viewport,scissorTest:{enabled:t._useScissorTest,rectangle:t._scissorRectangle},blending:ln.ALPHA_BLEND})),f(t._compositeCommand)&&(t._compositeCommand.renderState=t._rsComp,t._compositeCommand.derivedCommands.pick.renderState=t._rsComp)}t0.prototype.executeTranslucentCommands=function(t,n,i,o,r){let s=o.length,a,c,l=t.frameState.useLogDepth,u=t.context,d=i.framebuffer;for(c=0;c<s;++c)if(a=o[c],a=l?a.derivedCommands.logDepth.command:a,a.depthForTranslucentClassification){this._hasTranslucentDepth=!0;break}if(!!this._hasTranslucentDepth){for(_ct(this,u,i,r),i.framebuffer=this._drawClassificationFBO.framebuffer,this._clearDepthStencilCommand.execute(u,i),c=0;c<s;++c){if(a=o[c],a=l?a.derivedCommands.logDepth.command:a,!a.depthForTranslucentClassification)continue;let h=a.derivedCommands.depth.depthOnlyCommand;n(h,t,u,i)}this._frustumsDrawn+=this._hasTranslucentDepth?1:0,this._hasTranslucentDepth&&(i.framebuffer=this._packFBO.framebuffer,this._packDepthCommand.execute(u,i)),i.framebuffer=d}};t0.prototype.executeClassificationCommands=function(t,n,i,o){if(!this._hasTranslucentDepth)return;let r=t.context,s=r.uniformState,a=i.framebuffer;this._frustumsDrawn===2&&(i.framebuffer=this._accumulationFBO.framebuffer,this._copyCommand.execute(r,i)),i.framebuffer=this._drawClassificationFBO.framebuffer,this._frustumsDrawn>1&&this._clearColorCommand.execute(r,i),s.updatePass(Te.CESIUM_3D_TILE_CLASSIFICATION);let c=s.globeDepthTexture;s.globeDepthTexture=this._packFBO.getColorTexture();let l=o.commands[Te.CESIUM_3D_TILE_CLASSIFICATION],u=o.indices[Te.CESIUM_3D_TILE_CLASSIFICATION];for(let d=0;d<u;++d)n(l[d],t,r,i);s.globeDepthTexture=c,i.framebuffer=a,this._frustumsDrawn!==1&&(i.framebuffer=this._accumulationFBO.framebuffer,this._accumulateCommand.execute(r,i),i.framebuffer=a)};t0.prototype.execute=function(t,n){if(!this._hasTranslucentDepth)return;this._frustumsDrawn===1?this._textureToComposite=this._drawClassificationFBO.getColorTexture():this._textureToComposite=this._accumulationFBO.getColorTexture(),(t.frameState.passes.pick?this._compositeCommand.derivedCommands.pick:this._compositeCommand).execute(t.context,n),gct(this,t,n)};function gct(t,n,i){if(!t._hasTranslucentDepth)return;let o=i.framebuffer;i.framebuffer=t._drawClassificationFBO.framebuffer,t._clearColorCommand.execute(n._context,i),i.framebuffer=o,t._frustumsDrawn>1&&(i.framebuffer=t._accumulationFBO.framebuffer,t._clearColorCommand.execute(n._context,i)),t._hasTranslucentDepth=!1,t._frustumsDrawn=0}t0.prototype.isSupported=function(){return this._supported};t0.prototype.isDestroyed=function(){return!1};t0.prototype.destroy=function(){return X_e(this),K_e(this),f(this._compositeCommand)&&(this._compositeCommand.shaderProgram=this._compositeCommand.shaderProgram&&this._compositeCommand.shaderProgram.destroy()),f(this._packDepthCommand)&&(this._packDepthCommand.shaderProgram=this._packDepthCommand.shaderProgram&&this._packDepthCommand.shaderProgram.destroy()),ue(this)};var OU=t0;function yct(){this.command=void 0,this.near=void 0,this.far=void 0}function RU(t,n,i){let o=t.context,r;o.depthTexture&&(r=new dU);let s;t._useOIT&&o.depthTexture&&(s=new bU(o));let a=new wc(o);a.viewport=He.clone(i),this.camera=n,this._cameraClone=lo.clone(n),this._cameraStartFired=!1,this._cameraMovedTime=void 0,this.viewport=i,this.passState=a,this.pickFramebuffer=new IU(o),this.pickDepthFramebuffer=new PU,this.sceneFramebuffer=new JE,this.globeDepth=r,this.globeTranslucencyFramebuffer=new hU,this.oit=s,this.translucentTileClassification=new OU(o),this.pickDepths=[],this.frustumCommandsList=[],this.debugFrustumStatistics=void 0,this._commandExtents=[]}var J_e=new m,Z_e=new m;function Act(t,n){let i=Math.max(Math.abs(t.x),Math.abs(n.x)),o=Math.max(Math.abs(t.y),Math.abs(n.y)),r=Math.max(Math.abs(t.z),Math.abs(n.z));return Math.max(Math.max(i,o),r)}function Cct(t,n,i){let o=1/Math.max(1,Act(t.position,n.position));return m.multiplyByScalar(t.position,o,J_e),m.multiplyByScalar(n.position,o,Z_e),m.equalsEpsilon(J_e,Z_e,i)&&m.equalsEpsilon(t.direction,n.direction,i)&&m.equalsEpsilon(t.up,n.up,i)&&m.equalsEpsilon(t.right,n.right,i)&&N.equalsEpsilon(t.transform,n.transform,i)&&t.frustum.equalsEpsilon(n.frustum,i)}RU.prototype.checkForCameraUpdates=function(t){let n=this.camera,i=this._cameraClone;return Cct(n,i,B.EPSILON15)?(this._cameraStartFired&&Fi()-this._cameraMovedTime>t.cameraEventWaitTime&&(n.moveEnd.raiseEvent(),this._cameraStartFired=!1),!1):(this._cameraStartFired||(n.moveStart.raiseEvent(),this._cameraStartFired=!0),this._cameraMovedTime=Fi(),lo.clone(n,i),!0)};function xct(t,n,i,o){let r=n.frameState,s=r.camera,a=r.useLogDepth?n.logarithmicDepthFarToNearRatio:n.farToNearRatio,c=n.mode===ne.SCENE2D,l=n.nearToFarDistance2D;o*=1+B.EPSILON2,i=Math.min(Math.max(i,s.frustum.near),s.frustum.far),o=Math.max(Math.min(o,s.frustum.far),i);let u;c?(o=Math.min(o,s.position.z+n.nearToFarDistance2D),i=Math.min(i,o),u=Math.ceil(Math.max(1,o-i)/n.nearToFarDistance2D)):u=Math.ceil(Math.log(o/i)/Math.log(a));let d=t.frustumCommandsList;d.length=u;for(let h=0;h<u;++h){let _,y;c?(_=Math.min(o-l,i+h*l),y=Math.min(o,_+l)):(_=Math.max(i,Math.pow(a,h)*i),y=Math.min(o,a*_));let p=d[h];f(p)?(p.near=_,p.far=y):p=d[h]=new Uk(_,y)}}function Tct(t,n,i,o,r){n.debugShowFrustums&&(i.debugOverlappingFrustums=0);let s=t.frustumCommandsList,a=s.length;for(let c=0;c<a;++c){let l=s[c],u=l.near,d=l.far;if(o>d)continue;if(r<u)break;let h=i.pass,_=l.indices[h]++;if(l.commands[h][_]=i,n.debugShowFrustums&&(i.debugOverlappingFrustums|=1<<c),i.executeInClosestFrustum)break}if(n.debugShowFrustums){let c=t.debugFrustumStatistics.commandsInFrustums;c[i.debugOverlappingFrustums]=f(c[i.debugOverlappingFrustums])?c[i.debugOverlappingFrustums]+1:1,++t.debugFrustumStatistics.totalCommands}n.updateDerivedCommands(i)}var Q_e=new $s,Ect=new Fc;RU.prototype.createPotentiallyVisibleSet=function(t){let n=t.frameState,i=n.camera,o=i.directionWC,r=i.positionWC,s=t._computeCommandList,a=t._overlayCommandList,c=n.commandList;t.debugShowFrustums&&(this.debugFrustumStatistics={totalCommands:0,commandsInFrustums:{}});let l=this.frustumCommandsList,u=l.length,d=Te.NUMBER_OF_PASSES;for(let b=0;b<u;++b)for(let v=0;v<d;++v)l[b].indices[v]=0;s.length=0,a.length=0;let h=this._commandExtents,_=h.length,y=0,p=+Number.MAX_VALUE,C=-Number.MAX_VALUE,x=n.shadowState.shadowsEnabled,T=+Number.MAX_VALUE,E=-Number.MAX_VALUE,S=Number.MAX_VALUE,w=n.mode===ne.SCENE3D?n.occluder:void 0,D=n.cullingVolume,I=Q_e.planes;for(let b=0;b<5;++b)I[b]=D.planes[b];D=Q_e;let O=c.length;for(let b=0;b<O;++b){let v=c[b],P=v.pass;if(P===Te.COMPUTE)s.push(v);else if(P===Te.OVERLAY)a.push(v);else{let R,V,H=v.boundingVolume;if(f(H)){if(!t.isVisible(v,D,w))continue;let G=H.computePlaneDistances(r,o,Ect);if(R=G.start,V=G.stop,p=Math.min(p,R),C=Math.max(C,V),x&&v.receiveShadows&&R<e0.MAXIMUM_DISTANCE&&!(P===Te.GLOBE&&R<-100&&V>100)){let k=V-R;P!==Te.GLOBE&&R<100&&(S=Math.min(S,k)),T=Math.min(T,R),E=Math.max(E,V)}}else v instanceof Qn?(R=i.frustum.near,V=i.frustum.far):(R=i.frustum.near,V=i.frustum.far,p=Math.min(p,R),C=Math.max(C,V));let U=h[y];f(U)||(U=h[y]=new yct),U.command=v,U.near=R,U.far=V,y++}}x&&(T=Math.min(Math.max(T,i.frustum.near),i.frustum.far),E=Math.max(Math.min(E,i.frustum.far),T)),x&&(n.shadowState.nearPlane=T,n.shadowState.farPlane=E,n.shadowState.closestObjectSize=S),xct(this,t,p,C);let M,L;for(M=0;M<y;M++)L=h[M],Tct(this,t,L.command,L.near,L.far);if(y<_)for(M=y;M<_&&(L=h[M],!!f(L.command));M++)L.command=void 0;let F=l.length,g=n.frustumSplits;g.length=F+1;for(let b=0;b<F;++b)g[b]=l[b].near,b===F-1&&(g[b+1]=l[b].far)};RU.prototype.destroy=function(){this.pickFramebuffer=this.pickFramebuffer&&this.pickFramebuffer.destroy(),this.pickDepthFramebuffer=this.pickDepthFramebuffer&&this.pickDepthFramebuffer.destroy(),this.sceneFramebuffer=this.sceneFramebuffer&&this.sceneFramebuffer.destroy(),this.globeDepth=this.globeDepth&&this.globeDepth.destroy(),this.oit=this.oit&&this.oit.destroy(),this.translucentTileClassification=this.translucentTileClassification&&this.translucentTileClassification.destroy(),this.globeTranslucencyFramebuffer=this.globeTranslucencyFramebuffer&&this.globeTranslucencyFramebuffer.destroy();let t,n=this.pickDepths,i=n.length;for(t=0;t<i;++t)n[t].destroy()};var QE=RU;var ege=.1,bct=new yd({pass:er.MOST_DETAILED_PRELOAD}),Sct=new yd({pass:er.MOST_DETAILED_PICK}),Jj=new yd({pass:er.PICK});function fa(t){this._mostDetailedRayPicks=[],this.pickRenderStateCache={},this._pickPositionCache={},this._pickPositionCacheDirty=!1;let n=new He(0,0,1,1),i=new lo(t);i.frustum=new $t({width:ege,aspectRatio:1,near:.1}),this._pickOffscreenView=new QE(t,i,n)}fa.prototype.update=function(){this._pickPositionCacheDirty=!0};fa.prototype.getPickDepth=function(t,n){let i=t.view.pickDepths,o=i[n];return f(o)||(o=new vU,i[n]=o),o};var wct=new Br,Dct=new m,MU=new m,vct=new W,Pct=new N;function Ict(t,n,i,o,r){let s=t.camera,a=s.frustum;f(a._offCenterFrustum)&&(a=a._offCenterFrustum);let c=2*(n.x-r.x)/r.width-1;c*=(a.right-a.left)*.5;let l=2*(r.height-n.y-r.y)/r.height-1;l*=(a.top-a.bottom)*.5;let u=N.clone(s.transform,Pct);s._setTransform(N.IDENTITY);let d=m.clone(s.position,Dct);m.multiplyByScalar(s.right,c,MU),m.add(MU,d,d),m.multiplyByScalar(s.up,l,MU),m.add(MU,d,d),s._setTransform(u),t.mode===ne.SCENE2D&&m.fromElements(d.z,d.x,d.y,d);let h=a.getPixelDimensions(r.width,r.height,1,1,vct),_=wct;return _.right=h.x*.5,_.left=-_.right,_.top=h.y*.5,_.bottom=-_.top,_.near=a.near,_.far=a.far,_.computeCullingVolume(d,s.directionWC,s.upWC)}var Bct=new ll,Oct=new W;function Rct(t,n,i,o,r){let s=t.camera,a=s.frustum,c=a.near,l=Math.tan(a.fovy*.5),u=a.aspectRatio*l,d=2*(n.x-r.x)/r.width-1,h=2*(r.height-n.y-r.y)/r.height-1,_=d*c*u,y=h*c*l,p=a.getPixelDimensions(r.width,r.height,1,1,Oct),C=p.x*i*.5,x=p.y*o*.5,T=Bct;return T.top=y+x,T.bottom=y-x,T.right=_+C,T.left=_-C,T.near=c,T.far=a.far,T.computeCullingVolume(s.positionWC,s.directionWC,s.upWC)}function tge(t,n,i,o,r){let s=t.camera.frustum;return s instanceof $t||s instanceof Br?Ict(t,n,i,o,r):Rct(t,n,i,o,r)}var $E=3,Nv=3,Xh=new He(0,0,$E,Nv),nge=new W,Zj=new z(0,0,0,0);fa.prototype.pick=function(t,n,i,o){$E=A(i,3),Nv=A(o,$E);let r=t.context,s=r.uniformState,a=t.frameState,c=t.defaultView;t.view=c;let l=c.viewport;l.x=0,l.y=0,l.width=r.drawingBufferWidth,l.height=r.drawingBufferHeight;let u=c.passState;u.viewport=He.clone(l,u.viewport);let d=Yi.transformWindowToDrawingBuffer(t,n,nge);t.jobScheduler.disableThisFrame(),t.updateFrameState(),a.cullingVolume=tge(t,d,$E,Nv,l),a.invertClassification=!1,a.passes.pick=!0,a.tilesetPassState=Jj,s.update(a),t.updateEnvironment(),Xh.x=d.x-($E-1)*.5,Xh.y=t.drawingBufferHeight-d.y-(Nv-1)*.5,Xh.width=$E,Xh.height=Nv,u=c.pickFramebuffer.begin(Xh,c.viewport),t.updateAndExecuteCommands(u,Zj),t.resolveFramebuffers(u);let h=c.pickFramebuffer.end(Xh);return r.endFrame(),h};function Mct(t,n){let i=t.context,o=t.frameState,r=t.environmentState,s=t.defaultView;t.view=s;let a=s.viewport;a.x=0,a.y=0,a.width=i.drawingBufferWidth,a.height=i.drawingBufferHeight;let c=s.passState;c.viewport=He.clone(a,c.viewport),t.clearPasses(o.passes),o.passes.pick=!0,o.passes.depth=!0,o.cullingVolume=tge(t,n,1,1,a),o.tilesetPassState=Jj,t.updateEnvironment(),r.renderTranslucentDepthForPick=!0,c=s.pickDepthFramebuffer.update(i,n,a),t.updateAndExecuteCommands(c,Zj),t.resolveFramebuffers(c),i.endFrame()}var Lct=new yi,Fct=new ll,Nct=new $t,Vct=new Br;fa.prototype.pickPositionWorldCoordinates=function(t,n,i){if(!t.useDepthPicking)return;let o=n.toString();if(this._pickPositionCacheDirty)this._pickPositionCache={},this._pickPositionCacheDirty=!1;else if(this._pickPositionCache.hasOwnProperty(o))return m.clone(this._pickPositionCache[o],i);let r=t.frameState,s=t.context,a=s.uniformState,c=t.defaultView;t.view=c;let l=Yi.transformWindowToDrawingBuffer(t,n,nge);t.pickTranslucentDepth?Mct(t,l):(t.updateFrameState(),a.update(r),t.updateEnvironment()),l.y=t.drawingBufferHeight-l.y;let u=t.camera,d;f(u.frustum.fov)?d=u.frustum.clone(Lct):f(u.frustum.infiniteProjectionMatrix)?d=u.frustum.clone(Fct):f(u.frustum.width)?d=u.frustum.clone(Nct):d=u.frustum.clone(Vct);let h=c.frustumCommandsList,_=h.length;for(let y=0;y<_;++y){let C=this.getPickDepth(t,y).getDepth(s,l.x,l.y);if(!!f(C)&&C>0&&C<1){let x=h[y],T;return t.mode===ne.SCENE2D?(T=u.position.z,u.position.z=T-x.near+1,d.far=Math.max(1,x.far-x.near),d.near=1,a.update(r),a.updateFrustum(d)):(d.near=x.near*(y!==0?t.opaqueFrustumNearOffset:1),d.far=x.far,a.updateFrustum(d)),i=Yi.drawingBufferToWgs84Coordinates(t,l,C,i),t.mode===ne.SCENE2D&&(u.position.z=T,a.update(r)),this._pickPositionCache[o]=m.clone(i),i}}this._pickPositionCache[o]=void 0};var kct=new de;fa.prototype.pickPosition=function(t,n,i){if(i=this.pickPositionWorldCoordinates(t,n,i),f(i)&&t.mode!==ne.SCENE3D){m.fromElements(i.y,i.z,i.x,i);let o=t.mapProjection,r=o.ellipsoid,s=o.unproject(i,kct);r.cartographicToCartesian(s,i)}return i};function ige(t,n){let i,o,r=[],s=[],a=[],c=[];f(t)||(t=Number.MAX_VALUE);let l=n();for(;f(l);){let u=l.object,d=l.position,h=l.exclude;if(f(d)&&!f(u)){r.push(l);break}if(!f(u)||!f(u.primitive)||!h&&(r.push(l),0>=--t))break;let _=u.primitive,y=!1;typeof _.getGeometryInstanceAttributes=="function"&&f(u.id)&&(o=_.getGeometryInstanceAttributes(u.id),f(o)&&f(o.show)&&(y=!0,o.show=mn.toValue(!1,o.show),a.push(o))),u instanceof Ds&&(y=!0,u.show=!1,c.push(u)),y||(_.show=!1,s.push(_)),l=n()}for(i=0;i<s.length;++i)s[i].show=!0;for(i=0;i<a.length;++i)o=a[i],o.show=mn.toValue(!0,o.show);for(i=0;i<c.length;++i)c[i].show=!0;return r}fa.prototype.drillPick=function(t,n,i,o,r){let s=this;return ige(i,function(){let l=s.pick(t,n,o,r);if(f(l))return{object:l,position:void 0,exclude:!1}}).map(function(l){return l.object})};var $_e=new m,Uct=new m;function zct(t,n,i){this.ray=t,this.width=n,this.tilesets=i,this.ready=!1;let o=this;this.promise=new Promise(r=>{o._completePick=()=>{r()}})}function oge(t,n,i,o){let r=n.direction,s=m.mostOrthogonalAxis(r,$_e),a=m.cross(r,s,$_e),c=m.cross(r,a,Uct);return o.position=n.origin,o.direction=r,o.up=c,o.right=a,o.frustum.width=A(i,ege),o.frustum.computeCullingVolume(o.positionWC,o.directionWC,o.upWC)}function Hct(t,n,i){let o=n.frameState,r=i.ray,s=i.width,a=i.tilesets,c=t._pickOffscreenView.camera,l=oge(t,r,s,c),u=bct;u.camera=c,u.cullingVolume=l;let d=!0,h=a.length;for(let _=0;_<h;++_){let y=a[_];y.show&&n.primitives.contains(y)&&(y.updateForPass(o,u),d=d&&u.ready)}return d&&i._completePick(),d}fa.prototype.updateMostDetailedRayPicks=function(t){let n=this._mostDetailedRayPicks;for(let i=0;i<n.length;++i)Hct(this,t,n[i])&&n.splice(i--,1)};function rge(t,n,i){let o=t.length;for(let r=0;r<o;++r){let s=t.get(r);s.show&&(f(s.isCesium3DTileset)?(!f(n)||n.indexOf(s)===-1)&&i.push(s):s instanceof Nl&&rge(s,n,i))}}function LU(t,n,i,o,r,s){let a=[];if(rge(n.primitives,o,a),a.length===0)return Promise.resolve(s());let c=new zct(i,r,a);return t._mostDetailedRayPicks.push(c),c.promise.then(function(){return s()})}function Gct(t,n){return!f(t)||!f(n)||n.length===0?!1:n.indexOf(t)>-1||n.indexOf(t.primitive)>-1||n.indexOf(t.id)>-1}function Wct(t,n,i,o,r,s,a){let c=n.context,l=c.uniformState,u=n.frameState,d=t._pickOffscreenView;n.view=d,oge(t,i,r,d.camera),Xh=He.clone(d.viewport,Xh);let h=d.pickFramebuffer.begin(Xh,d.viewport);n.jobScheduler.disableThisFrame(),n.updateFrameState(),u.invertClassification=!1,u.passes.pick=!0,u.passes.offscreen=!0,a?u.tilesetPassState=Sct:u.tilesetPassState=Jj,l.update(u),n.updateEnvironment(),n.updateAndExecuteCommands(h,Zj),n.resolveFramebuffers(h);let _,y=d.pickFramebuffer.end(Xh);if(n.context.depthTexture){let p=d.frustumCommandsList.length;for(let C=0;C<p;++C){let T=t.getPickDepth(n,C).getDepth(c,0,0);if(!!f(T)&&T>0&&T<1){let E=d.frustumCommandsList[C],S=E.near*(C!==0?n.opaqueFrustumNearOffset:1),w=E.far,D=S+T*(w-S);_=dn.getPoint(i,D);break}}}if(n.view=n.defaultView,c.endFrame(),f(y)||f(_))return{object:y,position:_,exclude:!f(_)&&s||Gct(y,o)}}function sge(t,n,i,o,r,s,a,c){return ige(o,function(){return Wct(t,n,i,r,s,a,c)})}function eb(t,n,i,o,r,s,a){let c=sge(t,n,i,1,o,r,s,a);if(c.length>0)return c[0]}function age(t,n,i,o,r,s,a,c){return sge(t,n,i,o,r,s,a,c)}function FU(t,n){return new Promise((i,o)=>{n.then(function(r){let s=t.postRender.addEventListener(function(){s(),i(r)});t.requestRender()}).catch(function(r){o(r)})})}fa.prototype.pickFromRay=function(t,n,i,o){return eb(this,t,n,i,o,!1,!1)};fa.prototype.drillPickFromRay=function(t,n,i,o,r){return age(this,t,n,i,o,r,!1,!1)};fa.prototype.pickFromRayMostDetailed=function(t,n,i,o){let r=this;return n=dn.clone(n),i=f(i)?i.slice():i,FU(t,LU(r,t,n,i,o,function(){return eb(r,t,n,i,o,!1,!0)}))};fa.prototype.drillPickFromRayMostDetailed=function(t,n,i,o,r){let s=this;return n=dn.clone(n),o=f(o)?o.slice():o,FU(t,LU(s,t,n,o,r,function(){return age(s,t,n,i,o,r,!1,!0)}))};var jct=new m,qct=new m,Yct=new dn,cge=new de;function Qj(t,n){let i=t.globe,o=f(i)?i.ellipsoid:t.mapProjection.ellipsoid,r=ri._defaultMaxTerrainHeight,s=o.geodeticSurfaceNormalCartographic(n,qct),a=de.toCartesian(n,o,jct),c=Yct;c.origin=a,c.direction=s;let l=new dn;return dn.getPoint(c,r,l.origin),m.negate(s,l.direction),l}function lge(t,n){let i=t.globe,o=f(i)?i.ellipsoid:t.mapProjection.ellipsoid,r=de.fromCartesian(n,o,cge);return Qj(t,r)}function uge(t,n){let i=t.globe,o=f(i)?i.ellipsoid:t.mapProjection.ellipsoid;return de.fromCartesian(n,o,cge).height}function Xct(t,n,i,o,r){let s=Qj(n,i);return LU(t,n,s,o,r,function(){let a=eb(t,n,s,o,r,!0,!0);if(f(a))return uge(n,a.position)})}function Kct(t,n,i,o,r,s){let a=lge(n,i);return LU(t,n,a,o,r,function(){let c=eb(t,n,a,o,r,!0,!0);if(f(c))return m.clone(c.position,s)})}fa.prototype.sampleHeight=function(t,n,i,o){let r=Qj(t,n),s=eb(this,t,r,i,o,!0,!1);if(f(s))return uge(t,s.position)};fa.prototype.clampToHeight=function(t,n,i,o,r){let s=lge(t,n),a=eb(this,t,s,i,o,!0,!1);if(f(a))return m.clone(a.position,r)};fa.prototype.sampleHeightMostDetailed=function(t,n,i,o){i=f(i)?i.slice():i;let r=n.length,s=new Array(r);for(let a=0;a<r;++a)s[a]=Xct(this,t,n[a],i,o);return FU(t,Promise.all(s).then(function(a){let c=a.length;for(let l=0;l<c;++l)n[l].height=a[l];return n}))};fa.prototype.clampToHeightMostDetailed=function(t,n,i,o){i=f(i)?i.slice():i;let r=n.length,s=new Array(r);for(let a=0;a<r;++a)s[a]=Kct(this,t,n[a],i,o,n[a]);return FU(t,Promise.all(s).then(function(a){let c=a.length;for(let l=0;l<c;++l)n[l]=a[l];return n}))};fa.prototype.destroy=function(){this._pickOffscreenView=this._pickOffscreenView&&this._pickOffscreenView.destroy()};var NU=fa;var hge=yo(pP(),1);var Jct={modifyFragmentShader:function(n){return n=ze.replaceMain(n,"czm_splitter_main"),n+=`uniform float czm_splitDirection; 
void main() 
{ 
#ifndef SHADOW_MAP
    if (czm_splitDirection < 0.0 && gl_FragCoord.x > czm_splitPosition) discard; 
    if (czm_splitDirection > 0.0 && gl_FragCoord.x < czm_splitPosition) discard; 
#endif
    czm_splitter_main(); 
} 
`,n},addUniforms:function(n,i){i.czm_splitDirection=function(){return n.splitDirection}}},Vv=Jct;var EA={NEEDS_DECODE:0,DECODING:1,READY:2,FAILED:3};function kv(t){this._parsedContent=void 0,this._drawCommand=void 0,this._isTranslucent=!1,this._styleTranslucent=!1,this._constantColor=z.clone(z.DARKGRAY),this._highlightColor=z.clone(z.WHITE),this._pointSize=1,this._rtcCenter=void 0,this._quantizedVolumeScale=void 0,this._quantizedVolumeOffset=void 0,this._styleableShaderAttributes=void 0,this._isQuantized=!1,this._isOctEncoded16P=!1,this._isRGB565=!1,this._hasColors=!1,this._hasNormals=!1,this._hasBatchIds=!1,this._decodingState=EA.READY,this._dequantizeInShader=!0,this._isQuantizedDraco=!1,this._isOctEncodedDraco=!1,this._quantizedRange=0,this._octEncodedRange=0,this.backFaceCulling=!1,this._backFaceCulling=!1,this.normalShading=!0,this._normalShading=!0,this._opaqueRenderState=void 0,this._translucentRenderState=void 0,this._mode=void 0,this._ready=!1,this._pointsLength=0,this._geometryByteLength=0,this._vertexShaderLoaded=t.vertexShaderLoaded,this._fragmentShaderLoaded=t.fragmentShaderLoaded,this._uniformMapLoaded=t.uniformMapLoaded,this._batchTableLoaded=t.batchTableLoaded,this._pickIdLoaded=t.pickIdLoaded,this._opaquePass=A(t.opaquePass,Te.OPAQUE),this._cull=A(t.cull,!0),this.style=void 0,this._style=void 0,this.styleDirty=!1,this.modelMatrix=N.clone(N.IDENTITY),this._modelMatrix=N.clone(N.IDENTITY),this.time=0,this.shadows=gn.ENABLED,this._boundingSphere=void 0,this.clippingPlanes=void 0,this.isClipped=!1,this.clippingPlanesDirty=!1,this.clippingPlanesOriginMatrix=void 0,this.attenuation=!1,this._attenuation=!1,this.geometricError=0,this.geometricErrorScale=1,this.maximumAttenuation=this._pointSize,this.splitDirection=A(t.splitDirection,Wc.NONE),this._splittingEnabled=!1,this._resolveReadyPromise=void 0,this._rejectReadyPromise=void 0,this._readyPromise=Zct(this,t)}Object.defineProperties(kv.prototype,{pointsLength:{get:function(){return this._pointsLength}},geometryByteLength:{get:function(){return this._geometryByteLength}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise}},color:{get:function(){return z.clone(this._highlightColor)},set:function(t){this._highlightColor=z.clone(t,this._highlightColor)}},boundingSphere:{get:function(){if(f(this._drawCommand))return this._drawCommand.boundingVolume},set:function(t){this._boundingSphere=ae.clone(t,this._boundingSphere)}}});function Zct(t,n){let i=ix.parse(n.arrayBuffer,n.byteOffset);if(t._parsedContent=i,t._rtcCenter=i.rtcCenter,t._hasNormals=i.hasNormals,t._hasColors=i.hasColors,t._hasBatchIds=i.hasBatchIds,t._isTranslucent=i.isTranslucent,!i.hasBatchIds&&f(i.batchTableBinary)&&(i.styleableProperties=E_.getBinaryProperties(i.pointsLength,i.batchTableJson,i.batchTableBinary)),f(i.draco)){let c=i.draco;t._decodingState=EA.NEEDS_DECODE,c.dequantizeInShader=t._dequantizeInShader}let o=i.positions;f(o)&&(t._isQuantized=o.isQuantized,t._quantizedVolumeScale=o.quantizedVolumeScale,t._quantizedVolumeOffset=o.quantizedVolumeOffset,t._quantizedRange=o.quantizedRange);let r=i.normals;f(r)&&(t._isOctEncoded16P=r.octEncoded);let s=i.colors;f(s)&&(f(s.constantColor)&&(t._constantColor=z.clone(s.constantColor,t._constantColor),t._hasColors=!1),t._isRGB565=s.isRGB565);let a=i.batchIds;return f(i.batchIds)&&(a.name="BATCH_ID",a.semantic="BATCH_ID",a.setIndex=void 0),i.hasBatchIds&&t._batchTableLoaded(i.batchLength,i.batchTableJson,i.batchTableBinary),t._pointsLength=i.pointsLength,new Promise(function(c,l){t._resolveReadyPromise=function(){t._ready=!0,c(t)},t._rejectReadyPromise=l})}var Qct=new m,$ct=new m,elt=new m,fge,VU;function tlt(t){if(!f(VU)){fge=new hge.default(0),VU=new Array(t);for(let n=0;n<t;++n)VU[n]=fge.random()}return VU}function nlt(t){let i=t.length/3,o=Math.min(i,20),r=tlt(20),s=Number.MAX_VALUE,a=-Number.MAX_VALUE,c=m.fromElements(s,s,s,Qct),l=m.fromElements(a,a,a,$ct);for(let d=0;d<o;++d){let h=Math.floor(r[d]*i),_=m.unpack(t,h*3,elt);m.minimumByComponent(c,_,c),m.maximumByComponent(l,_,l)}let u=ae.fromCornerPoints(c,l);return u.radius+=B.EPSILON2,u}function dge(t,n){let i=J.fromTypedArray(t);return i===J.INT||i===J.UNSIGNED_INT||i===J.DOUBLE?(Bt("Cast pnts property to floats",`Point cloud property "${n}" will be casted to a float array because INT, UNSIGNED_INT, and DOUBLE are not valid WebGL vertex attribute types. Some precision may be lost.`),new Float32Array(t)):t}var ilt=new se,olt=new se,rlt=new z,mge=0,kU=1,iq=2,pge=3,slt=4,$j=new N,alt=new N;function clt(t,n){let i=n.context,o=t._parsedContent,r=t._pointsLength,s=o.positions,a=o.colors,c=o.normals,l=o.batchIds,u=o.styleableProperties,d=f(u),h=t._isQuantized,_=t._isQuantizedDraco,y=t._isOctEncoded16P,p=t._isOctEncodedDraco,C=t._quantizedRange,x=t._octEncodedRange,T=t._isRGB565,E=t._isTranslucent,S=t._hasColors,w=t._hasNormals,D=t._hasBatchIds,I,O,M=[],L={};if(t._styleableShaderAttributes=L,d){let U=slt;for(let G in u)if(u.hasOwnProperty(G)){let k=u[G],X=dge(k.typedArray,G);I=k.componentCount,O=J.fromTypedArray(X);let Y=ut.createVertexBuffer({context:i,typedArray:X,usage:Fe.STATIC_DRAW});t._geometryByteLength+=Y.sizeInBytes;let K={index:U,vertexBuffer:Y,componentsPerAttribute:I,componentDatatype:O,normalize:!1,offsetInBytes:0,strideInBytes:0};M.push(K),L[G]={location:U,componentCount:I},++U}}let F=ut.createVertexBuffer({context:i,typedArray:s.typedArray,usage:Fe.STATIC_DRAW});t._geometryByteLength+=F.sizeInBytes;let g;S&&(g=ut.createVertexBuffer({context:i,typedArray:a.typedArray,usage:Fe.STATIC_DRAW}),t._geometryByteLength+=g.sizeInBytes);let b;w&&(b=ut.createVertexBuffer({context:i,typedArray:c.typedArray,usage:Fe.STATIC_DRAW}),t._geometryByteLength+=b.sizeInBytes);let v;D&&(l.typedArray=dge(l.typedArray,"batchIds"),v=ut.createVertexBuffer({context:i,typedArray:l.typedArray,usage:Fe.STATIC_DRAW}),t._geometryByteLength+=v.sizeInBytes);let P=[];if(h?O=J.UNSIGNED_SHORT:_?O=C<=255?J.UNSIGNED_BYTE:J.UNSIGNED_SHORT:O=J.FLOAT,P.push({index:mge,vertexBuffer:F,componentsPerAttribute:3,componentDatatype:O,normalize:!1,offsetInBytes:0,strideInBytes:0}),t._cull&&(h||_?t._boundingSphere=ae.fromCornerPoints(m.ZERO,t._quantizedVolumeScale):t._boundingSphere=nlt(s.typedArray)),S)if(T)P.push({index:kU,vertexBuffer:g,componentsPerAttribute:1,componentDatatype:J.UNSIGNED_SHORT,normalize:!1,offsetInBytes:0,strideInBytes:0});else{let U=E?4:3;P.push({index:kU,vertexBuffer:g,componentsPerAttribute:U,componentDatatype:J.UNSIGNED_BYTE,normalize:!0,offsetInBytes:0,strideInBytes:0})}w&&(y?(I=2,O=J.UNSIGNED_BYTE):p?(I=2,O=x<=255?J.UNSIGNED_BYTE:J.UNSIGNED_SHORT):(I=3,O=J.FLOAT),P.push({index:iq,vertexBuffer:b,componentsPerAttribute:I,componentDatatype:O,normalize:!1,offsetInBytes:0,strideInBytes:0})),D&&P.push({index:pge,vertexBuffer:v,componentsPerAttribute:1,componentDatatype:J.fromTypedArray(l.typedArray),normalize:!1,offsetInBytes:0,strideInBytes:0}),d&&(P=P.concat(M));let R=new $n({context:i,attributes:P}),V={depthTest:{enabled:!0}},H={depthTest:{enabled:!0},depthMask:!1,blending:ln.ALPHA_BLEND};t._opaquePass===Te.CESIUM_3D_TILE&&(V.stencilTest=Ot.setCesium3DTileBit(),V.stencilMask=Ot.CESIUM_3D_TILE_MASK,H.stencilTest=Ot.setCesium3DTileBit(),H.stencilMask=Ot.CESIUM_3D_TILE_MASK),t._opaqueRenderState=Ve.fromCache(V),t._translucentRenderState=Ve.fromCache(H),t._drawCommand=new et({boundingVolume:new ae,cull:t._cull,modelMatrix:new N,primitiveType:Re.POINTS,vertexArray:R,count:r,shaderProgram:void 0,uniformMap:void 0,renderState:E?t._translucentRenderState:t._opaqueRenderState,pass:E?Te.TRANSLUCENT:t._opaquePass,owner:t,castShadows:!1,receiveShadows:!1,pickId:t._pickIdLoaded()})}function llt(t,n){let i=n.context,o=t._isQuantized,r=t._isQuantizedDraco,s=t._isOctEncodedDraco,a={u_pointSizeAndTimeAndGeometricErrorAndDepthMultiplier:function(){let c=ilt;if(c.x=t._attenuation?t.maximumAttenuation:t._pointSize,c.x*=n.pixelRatio,c.y=t.time,t._attenuation){let l=n.camera.frustum,u;n.mode===ne.SCENE2D||l instanceof $t?u=Number.POSITIVE_INFINITY:u=i.drawingBufferHeight/n.camera.frustum.sseDenominator,c.z=t.geometricError*t.geometricErrorScale,c.w=u}return c},u_highlightColor:function(){return t._highlightColor},u_constantColor:function(){return t._constantColor},u_clippingPlanes:function(){let c=t.clippingPlanes;return t.isClipped?c.texture:i.defaultTexture},u_clippingPlanesEdgeStyle:function(){let c=t.clippingPlanes;if(!f(c))return z.TRANSPARENT;let l=z.clone(c.edgeColor,rlt);return l.alpha=c.edgeWidth,l},u_clippingPlanesMatrix:function(){let c=t.clippingPlanes;if(!f(c))return N.IDENTITY;let l=A(t.clippingPlanesOriginMatrix,t._modelMatrix);N.multiply(i.uniformState.view3D,l,$j);let u=N.multiply($j,c.modelMatrix,$j);return N.inverseTranspose(u,alt)}};Vv.addUniforms(t,a),(o||r||s)&&(a=At(a,{u_quantizedVolumeScaleAndOctEncodedRange:function(){let c=olt;if(f(t._quantizedVolumeScale)){let l=m.clone(t._quantizedVolumeScale,c);m.divideByScalar(l,t._quantizedRange,c)}return c.w=t._octEncodedRange,c}})),f(t._uniformMapLoaded)&&(a=t._uniformMapLoaded(a)),t._drawCommand.uniformMap=a}function eq(t,n){let i=/czm_3dtiles_property_(\d+)/g,o=i.exec(t);for(;o!==null;){let r=parseInt(o[1]);n.indexOf(r)===-1&&n.push(r),o=i.exec(t)}}function tq(t,n){t=t.slice(t.indexOf(`
`));let i=/czm_3dtiles_builtin_property_(\w+)/g,o=i.exec(t);for(;o!==null;){let r=o[1];n.indexOf(r)===-1&&n.push(r),o=i.exec(t)}}function nq(t,n){let i=t.numberOfAttributes;for(let o=0;o<i;++o){let r=t.getAttribute(o);if(r.index===n)return r}}var ult={POSITION:"czm_3dtiles_builtin_property_POSITION",POSITION_ABSOLUTE:"czm_3dtiles_builtin_property_POSITION_ABSOLUTE",COLOR:"czm_3dtiles_builtin_property_COLOR",NORMAL:"czm_3dtiles_builtin_property_NORMAL"};function flt(t,n,i){let o,r,s,a=n.context,c=f(i),l=t._isQuantized,u=t._isQuantizedDraco,d=t._isOctEncoded16P,h=t._isOctEncodedDraco,_=t._isRGB565,y=t._isTranslucent,p=t._hasColors,C=t._hasNormals,x=t._hasBatchIds,T=t._backFaceCulling,E=t._normalShading,S=t._drawCommand.vertexArray,w=t.clippingPlanes,D=t._attenuation,I,O,M,L=y,F=tt(ult),g={},b=t._styleableShaderAttributes;for(r in b)b.hasOwnProperty(r)&&(s=b[r],F[r]=`czm_3dtiles_property_${s.location}`,g[s.location]=s);if(c){let re={translucent:!1},fe="(vec3 czm_3dtiles_builtin_property_POSITION, vec3 czm_3dtiles_builtin_property_POSITION_ABSOLUTE, vec4 czm_3dtiles_builtin_property_COLOR, vec3 czm_3dtiles_builtin_property_NORMAL)";I=i.getColorShaderFunction(`getColorFromStyle${fe}`,F,re),O=i.getShowShaderFunction(`getShowFromStyle${fe}`,F,re),M=i.getPointSizeShaderFunction(`getPointSizeFromStyle${fe}`,F,re),f(I)&&re.translucent&&(L=!0)}t._styleTranslucent=L;let v=f(I),P=f(O),R=f(M),V=t.isClipped,H=[],U=[];v&&(eq(I,H),tq(I,U)),P&&(eq(O,H),tq(O,U)),R&&(eq(M,H),tq(M,U));let G=U.indexOf("COLOR")>=0,k=U.indexOf("NORMAL")>=0;if(k&&!C)throw new he("Style references the NORMAL semantic but the point cloud does not have normals");for(r in b)if(b.hasOwnProperty(r)){s=b[r];let re=H.indexOf(s.location)>=0,fe=nq(S,s.location);fe.enabled=re}let X=p&&(!v||G);if(p){let re=nq(S,kU);re.enabled=X}let Y=C&&(E||T||k);if(C){let re=nq(S,iq);re.enabled=Y}let K={a_position:mge};X&&(K.a_color=kU),Y&&(K.a_normal=iq),x&&(K.a_batchId=pge);let j="",Z=H.length;for(o=0;o<Z;++o){let re=H[o];s=g[re];let fe=s.componentCount,ge=`czm_3dtiles_property_${re}`,be;fe===1?be="float":be=`vec${fe}`,j+=`attribute ${be} ${ge}; 
`,K[ge]=s.location}llt(t,n);let Q=`attribute vec3 a_position; 
varying vec4 v_color; 
uniform vec4 u_pointSizeAndTimeAndGeometricErrorAndDepthMultiplier; 
uniform vec4 u_constantColor; 
uniform vec4 u_highlightColor; 
`;Q+=`float u_pointSize; 
float tiles3d_tileset_time; 
`,D&&(Q+=`float u_geometricError; 
float u_depthMultiplier; 
`),Q+=j,X&&(y?Q+=`attribute vec4 a_color; 
`:_?Q+=`attribute float a_color; 
const float SHIFT_RIGHT_11 = 1.0 / 2048.0; 
const float SHIFT_RIGHT_5 = 1.0 / 32.0; 
const float SHIFT_LEFT_11 = 2048.0; 
const float SHIFT_LEFT_5 = 32.0; 
const float NORMALIZE_6 = 1.0 / 64.0; 
const float NORMALIZE_5 = 1.0 / 32.0; 
`:Q+=`attribute vec3 a_color; 
`),Y&&(d||h?Q+=`attribute vec2 a_normal; 
`:Q+=`attribute vec3 a_normal; 
`),x&&(Q+=`attribute float a_batchId; 
`),(l||u||h)&&(Q+=`uniform vec4 u_quantizedVolumeScaleAndOctEncodedRange; 
`),v&&(Q+=I),P&&(Q+=O),R&&(Q+=M),Q+=`void main() 
{ 
    u_pointSize = u_pointSizeAndTimeAndGeometricErrorAndDepthMultiplier.x; 
    tiles3d_tileset_time = u_pointSizeAndTimeAndGeometricErrorAndDepthMultiplier.y; 
`,D&&(Q+=`    u_geometricError = u_pointSizeAndTimeAndGeometricErrorAndDepthMultiplier.z; 
    u_depthMultiplier = u_pointSizeAndTimeAndGeometricErrorAndDepthMultiplier.w; 
`),X?y?Q+=`    vec4 color = a_color; 
`:_?Q+=`    float compressed = a_color; 
    float r = floor(compressed * SHIFT_RIGHT_11); 
    compressed -= r * SHIFT_LEFT_11; 
    float g = floor(compressed * SHIFT_RIGHT_5); 
    compressed -= g * SHIFT_LEFT_5; 
    float b = compressed; 
    vec3 rgb = vec3(r * NORMALIZE_5, g * NORMALIZE_6, b * NORMALIZE_5); 
    vec4 color = vec4(rgb, 1.0); 
`:Q+=`    vec4 color = vec4(a_color, 1.0); 
`:Q+=`    vec4 color = u_constantColor; 
`,l||u?Q+=`    vec3 position = a_position * u_quantizedVolumeScaleAndOctEncodedRange.xyz; 
`:Q+=`    vec3 position = a_position; 
`,Q+=`    vec3 position_absolute = vec3(czm_model * vec4(position, 1.0)); 
`,Y?(d?Q+=`    vec3 normal = czm_octDecode(a_normal); 
`:h?Q+=`    vec3 normal = czm_octDecode(a_normal, u_quantizedVolumeScaleAndOctEncodedRange.w).zxy; 
`:Q+=`    vec3 normal = a_normal; 
`,Q+=`    vec3 normalEC = czm_normal * normal; 
`):Q+=`    vec3 normal = vec3(1.0); 
`,v&&(Q+=`    color = getColorFromStyle(position, position_absolute, color, normal); 
`),P&&(Q+=`    float show = float(getShowFromStyle(position, position_absolute, color, normal)); 
`),R?Q+=`    gl_PointSize = getPointSizeFromStyle(position, position_absolute, color, normal) * czm_pixelRatio; 
`:D?Q+=`    vec4 positionEC = czm_modelView * vec4(position, 1.0); 
    float depth = -positionEC.z; 
    gl_PointSize = min((u_geometricError / depth) * u_depthMultiplier, u_pointSize); 
`:Q+=`    gl_PointSize = u_pointSize; 
`,Q+=`    color = color * u_highlightColor; 
`,Y&&E&&(Q+=`    float diffuseStrength = czm_getLambertDiffuse(czm_lightDirectionEC, normalEC); 
    diffuseStrength = max(diffuseStrength, 0.4); 
    color.xyz *= diffuseStrength * czm_lightColor; 
`),Q+=`    v_color = color; 
    gl_Position = czm_modelViewProjection * vec4(position, 1.0); 
`,Y&&T&&(Q+=`    float visible = step(-normalEC.z, 0.0); 
    gl_Position *= visible; 
    gl_PointSize *= visible; 
`),P&&(Q+=`    gl_Position.w *= float(show); 
    gl_PointSize *= float(show); 
`),Q+=`} 
`;let me=`varying vec4 v_color; 
`;V&&(me+=`uniform highp sampler2D u_clippingPlanes; 
uniform mat4 u_clippingPlanesMatrix; 
uniform vec4 u_clippingPlanesEdgeStyle; 
`,me+=`
`,me+=zE(w,a),me+=`
`),me+=`void main() 
{ 
    gl_FragColor = czm_gammaCorrect(v_color); 
`,V&&(me+=zk("u_clippingPlanes","u_clippingPlanesMatrix","u_clippingPlanesEdgeStyle")),me+=`} 
`,t.splitDirection!==Wc.NONE&&(me=Vv.modifyFragmentShader(me)),f(t._vertexShaderLoaded)&&(Q=t._vertexShaderLoaded(Q)),f(t._fragmentShaderLoaded)&&(me=t._fragmentShaderLoaded(me));let _e=t._drawCommand;f(_e.shaderProgram)&&_e.shaderProgram.destroy(),_e.shaderProgram=qt.fromCache({context:a,vertexShaderSource:Q,fragmentShaderSource:me,attributeLocations:K});try{_e.shaderProgram._bind()}catch(re){throw new he("Error generating style shader: this may be caused by a type mismatch, index out-of-bounds, or other syntax error.")}}function dlt(t,n){if(t._decodingState===EA.READY)return!1;if(t._decodingState===EA.NEEDS_DECODE){let i=t._parsedContent,o=i.draco,r=Jp.decodePointCloud(o,n);f(r)&&(t._decodingState=EA.DECODING,r.then(function(s){t._decodingState=EA.READY;let a=f(s.POSITION)?s.POSITION.array:void 0,c=f(s.RGB)?s.RGB.array:void 0,l=f(s.RGBA)?s.RGBA.array:void 0,u=f(s.NORMAL)?s.NORMAL.array:void 0,d=f(s.BATCH_ID)?s.BATCH_ID.array:void 0,h=f(a)&&f(s.POSITION.data.quantization),_=f(u)&&f(s.NORMAL.data.quantization);if(h){let x=s.POSITION.data.quantization,T=x.range;t._quantizedVolumeScale=m.fromElements(T,T,T),t._quantizedVolumeOffset=m.unpack(x.minValues),t._quantizedRange=(1<<x.quantizationBits)-1,t._isQuantizedDraco=!0}_&&(t._octEncodedRange=(1<<s.NORMAL.data.quantization.quantizationBits)-1,t._isOctEncodedDraco=!0);let y=i.styleableProperties,p=o.batchTableProperties;for(let x in p)if(p.hasOwnProperty(x)){let T=s[x];f(y)||(y={}),y[x]={typedArray:T.array,componentCount:T.data.componentsPerAttribute}}f(a)&&(i.positions={typedArray:a});let C=A(l,c);f(C)&&(i.colors={typedArray:C}),f(u)&&(i.normals={typedArray:u}),f(d)&&(i.batchIds={typedArray:d}),i.styleableProperties=y}).catch(function(s){t._decodingState=EA.FAILED,t._rejectReadyPromise(s)}))}return!0}var hlt=new se,mlt=new m;kv.prototype.update=function(t){let n=t.context;if(dlt(this,n))return;let o=!1,r=!N.equals(this._modelMatrix,this.modelMatrix);if(this._mode!==t.mode&&(this._mode=t.mode,r=!0),f(this._drawCommand)||(clt(this,t),r=!0,o=!0,this._resolveReadyPromise(),this._parsedContent=void 0),r){N.clone(this.modelMatrix,this._modelMatrix);let u=this._drawCommand.modelMatrix;if(N.clone(this._modelMatrix,u),f(this._rtcCenter)&&N.multiplyByTranslation(u,this._rtcCenter,u),f(this._quantizedVolumeOffset)&&N.multiplyByTranslation(u,this._quantizedVolumeOffset,u),t.mode!==ne.SCENE3D){let h=t.mapProjection,_=N.getColumn(u,3,hlt);se.equals(_,se.UNIT_W)||vt.basisTo2D(h,u,u)}let d=this._drawCommand.boundingVolume;if(ae.clone(this._boundingSphere,d),this._cull){let h=d.center;N.multiplyByPoint(u,h,h);let _=N.getScale(u,mlt);d.radius*=m.maximumComponent(_)}}this.clippingPlanesDirty&&(this.clippingPlanesDirty=!1,o=!0),this._attenuation!==this.attenuation&&(this._attenuation=this.attenuation,o=!0),this.backFaceCulling!==this._backFaceCulling&&(this._backFaceCulling=this.backFaceCulling,o=!0),this.normalShading!==this._normalShading&&(this._normalShading=this.normalShading,o=!0),(this._style!==this.style||this.styleDirty)&&(this._style=this.style,this.styleDirty=!1,o=!0);let s=this.splitDirection!==Wc.NONE;this._splittingEnabled!==s&&(this._splittingEnabled=s,o=!0),o&&flt(this,t,this._style),this._drawCommand.castShadows=gn.castShadows(this.shadows),this._drawCommand.receiveShadows=gn.receiveShadows(this.shadows);let a=this._highlightColor.alpha<1||this._constantColor.alpha<1||this._styleTranslucent;this._drawCommand.renderState=a?this._translucentRenderState:this._opaqueRenderState,this._drawCommand.pass=a?Te.TRANSLUCENT:this._opaquePass;let c=t.commandList,l=t.passes;(l.render||l.pick)&&c.push(this._drawCommand)};kv.prototype.isDestroyed=function(){return!1};kv.prototype.destroy=function(){let t=this._drawCommand;return f(t)&&(t.vertexArray=t.vertexArray&&t.vertexArray.destroy(),t.shaderProgram=t.shaderProgram&&t.shaderProgram.destroy()),ue(this)};var UU=kv;var plt={NEAREST:0,LINEAR:1},hf=plt;function bA(t){t=A(t,A.EMPTY_OBJECT);let n=t.fragmentShader,i=A(t.textureScale,1),o=A(t.pixelFormat,st.RGBA);this._fragmentShader=n,this._uniforms=t.uniforms,this._textureScale=i,this._forcePowerOfTwo=A(t.forcePowerOfTwo,!1),this._sampleMode=A(t.sampleMode,hf.NEAREST),this._pixelFormat=o,this._pixelDatatype=A(t.pixelDatatype,je.UNSIGNED_BYTE),this._clearColor=A(t.clearColor,z.BLACK),this._uniformMap=void 0,this._command=void 0,this._colorTexture=void 0,this._depthTexture=void 0,this._idTexture=void 0,this._actualUniforms={},this._dirtyUniforms=[],this._texturesToRelease=[],this._texturesToCreate=[],this._texturePromise=void 0;let r=new wc;r.scissorTest={enabled:!0,rectangle:f(t.scissorRectangle)?He.clone(t.scissorRectangle):new He},this._passState=r,this._ready=!1;let s=t.name;f(s)||(s=Bn()),this._name=s,this._logDepthChanged=void 0,this._useLogDepth=void 0,this._selectedIdTexture=void 0,this._selected=void 0,this._selectedShadow=void 0,this._parentSelected=void 0,this._parentSelectedShadow=void 0,this._combinedSelected=void 0,this._combinedSelectedShadow=void 0,this._selectedLength=0,this._parentSelectedLength=0,this._selectedDirty=!0,this._textureCache=void 0,this._index=void 0,this.enabled=!0,this._enabled=!0}Object.defineProperties(bA.prototype,{ready:{get:function(){return this._ready}},name:{get:function(){return this._name}},fragmentShader:{get:function(){return this._fragmentShader}},uniforms:{get:function(){return this._uniforms}},textureScale:{get:function(){return this._textureScale}},forcePowerOfTwo:{get:function(){return this._forcePowerOfTwo}},sampleMode:{get:function(){return this._sampleMode}},pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},clearColor:{get:function(){return this._clearColor}},scissorRectangle:{get:function(){return this._passState.scissorTest.rectangle}},outputTexture:{get:function(){if(f(this._textureCache)){let t=this._textureCache.getFramebuffer(this._name);if(f(t))return t.getColorTexture(0)}}},selected:{get:function(){return this._selected},set:function(t){this._selected=t}},parentSelected:{get:function(){return this._parentSelected},set:function(t){this._parentSelected=t}}});var _lt=/uniform\s+sampler2D\s+depthTexture/g;bA.prototype._isSupported=function(t){return!_lt.test(this._fragmentShader)||t.depthTexture};function glt(t,n,i){let o=n[i];return(typeof o=="string"||o instanceof HTMLCanvasElement||o instanceof HTMLImageElement||o instanceof HTMLVideoElement||o instanceof ImageData)&&t._dirtyUniforms.push(i),{get:function(){return n[i]},set:function(r){let s=n[i];n[i]=r;let a=t._actualUniforms,c=a[i];f(c)&&c!==s&&c instanceof St&&!f(t._textureCache.getStageByName(i))&&(t._texturesToRelease.push(c),delete a[i],delete a[`${i}Dimensions`]),s instanceof St&&t._texturesToRelease.push(s),typeof r=="string"||r instanceof HTMLCanvasElement||r instanceof HTMLImageElement||r instanceof HTMLVideoElement||r instanceof ImageData?t._dirtyUniforms.push(i):a[i]=r}}}function ylt(t,n){return function(){let i=t._actualUniforms[n];return typeof i=="function"?i():i}}function Alt(t,n){return function(){let i=t[n]();if(f(i))return i.dimensions}}function Clt(t){if(f(t._uniformMap))return;let n={},i={},o=t._uniforms,r=t._actualUniforms;for(let s in o)if(o.hasOwnProperty(s)){typeof o[s]!="function"?(n[s]=ylt(t,s),i[s]=glt(t,o,s)):(n[s]=o[s],i[s]=o[s]),r[s]=o[s];let a=n[s]();(typeof a=="string"||a instanceof St||a instanceof HTMLImageElement||a instanceof HTMLCanvasElement||a instanceof HTMLVideoElement)&&(n[`${s}Dimensions`]=Alt(n,s))}t._uniforms={},Object.defineProperties(t._uniforms,i),t._uniformMap=At(n,{colorTexture:function(){return t._colorTexture},colorTextureDimensions:function(){return t._colorTexture.dimensions},depthTexture:function(){return t._depthTexture},depthTextureDimensions:function(){return t._depthTexture.dimensions},czm_idTexture:function(){return t._idTexture},czm_selectedIdTexture:function(){return t._selectedIdTexture},czm_selectedIdTextureStep:function(){return 1/t._selectedIdTexture.width}})}function xlt(t,n){if(f(t._command)&&!t._logDepthChanged&&!t._selectedDirty)return;let i=t._fragmentShader;if(f(t._selectedIdTexture)){let r=t._selectedIdTexture.width;i=i.replace(/varying\s+vec2\s+v_textureCoordinates;/g,""),i=`#define CZM_SELECTED_FEATURE 
uniform sampler2D czm_idTexture; 
uniform sampler2D czm_selectedIdTexture; 
uniform float czm_selectedIdTextureStep; 
varying vec2 v_textureCoordinates; 
bool czm_selected(vec2 offset) 
{ 
    bool selected = false;
    vec4 id = texture2D(czm_idTexture, v_textureCoordinates + offset); 
    for (int i = 0; i < ${r}; ++i) 
    { 
        vec4 selectedId = texture2D(czm_selectedIdTexture, vec2((float(i) + 0.5) * czm_selectedIdTextureStep, 0.5)); 
        if (all(equal(id, selectedId))) 
        { 
            return true; 
        } 
    } 
    return false; 
} 

bool czm_selected() 
{ 
    return czm_selected(vec2(0.0)); 
} 

${i}`}let o=new ze({defines:[t._useLogDepth?"LOG_DEPTH":""],sources:[i]});t._command=n.createViewportQuadCommand(o,{uniformMap:t._uniformMap,owner:t})}function Tlt(t){let n=t._sampleMode,i,o;n===hf.LINEAR?(i=fn.LINEAR,o=Qi.LINEAR):(i=fn.NEAREST,o=Qi.NEAREST);let r=t._sampler;(!f(r)||r.minificationFilter!==i||r.magnificationFilter!==o)&&(t._sampler=new pn({wrapS:Mn.CLAMP_TO_EDGE,wrapT:Mn.CLAMP_TO_EDGE,minificationFilter:i,magnificationFilter:o}))}function Elt(t,n){return function(i){t._texturesToCreate.push({name:n,source:i})}}function blt(t,n){return function(){return t._textureCache.getOutputTexture(n)}}function Slt(t,n){let i,o,r,s=t._texturesToRelease,a=s.length;for(i=0;i<a;++i)o=s[i],o=o&&o.destroy();s.length=0;let c=t._texturesToCreate;for(a=c.length,i=0;i<a;++i){let h=c[i];r=h.name;let _=h.source;t._actualUniforms[r]=new St({context:n,source:_})}c.length=0;let l=t._dirtyUniforms;if(l.length===0&&!f(t._texturePromise)){t._ready=!0;return}if(l.length===0||f(t._texturePromise))return;a=l.length;let u=t._uniforms,d=[];for(i=0;i<a;++i){r=l[i];let h=u[r],_=t._textureCache.getStageByName(h);if(f(_))t._actualUniforms[r]=blt(t,h);else if(typeof h=="string"){let y=new Ie({url:h});d.push(y.fetchImage().then(Elt(t,r)))}else t._texturesToCreate.push({name:r,source:h})}l.length=0,d.length>0?(t._ready=!1,t._texturePromise=Promise.all(d).then(function(){t._ready=!0,t._texturePromise=void 0})):t._ready=!0}function _ge(t){f(t._command)&&(t._command.shaderProgram=t._command.shaderProgram&&t._command.shaderProgram.destroy(),t._command=void 0),t._selectedIdTexture=t._selectedIdTexture&&t._selectedIdTexture.destroy();let n=t._textureCache;if(!f(n))return;let i=t._uniforms,o=t._actualUniforms;for(let r in o)o.hasOwnProperty(r)&&o[r]instanceof St&&(f(n.getStageByName(i[r]))||o[r].destroy(),t._dirtyUniforms.push(r))}function wlt(t){let n=f(t._selected)?t._selected.length:0,i=f(t._parentSelected)?t._parentSelected:0,o=t._selected!==t._selectedShadow||n!==t._selectedLength;if(o=o||t._parentSelected!==t._parentSelectedShadow||i!==t._parentSelectedLength,f(t._selected)&&f(t._parentSelected)?t._combinedSelected=t._selected.concat(t._parentSelected):f(t._parentSelected)?t._combinedSelected=t._parentSelected:t._combinedSelected=t._selected,!o&&f(t._combinedSelected)){if(!f(t._combinedSelectedShadow))return!0;n=t._combinedSelected.length;for(let r=0;r<n;++r)if(t._combinedSelected[r]!==t._combinedSelectedShadow[r])return!0}return o}function Dlt(t,n){if(!t._selectedDirty)return;t._selectedIdTexture=t._selectedIdTexture&&t._selectedIdTexture.destroy(),t._selectedIdTexture=void 0;let i=t._combinedSelected;if(!f(i))return;let o,r,s=0,a=i.length;for(o=0;o<a;++o)r=i[o],f(r.pickIds)?s+=r.pickIds.length:f(r.pickId)&&++s;if(a===0||s===0){let d=new Uint8Array(4);d[0]=255,d[1]=255,d[2]=255,d[3]=255,t._selectedIdTexture=new St({context:n,pixelFormat:st.RGBA,pixelDatatype:je.UNSIGNED_BYTE,source:{arrayBufferView:d,width:1,height:1},sampler:pn.NEAREST});return}let c,l=0,u=new Uint8Array(s*4);for(o=0;o<a;++o)if(r=i[o],f(r.pickIds)){let d=r.pickIds,h=d.length;for(let _=0;_<h;++_)c=d[_].color,u[l]=z.floatToByte(c.red),u[l+1]=z.floatToByte(c.green),u[l+2]=z.floatToByte(c.blue),u[l+3]=z.floatToByte(c.alpha),l+=4}else f(r.pickId)&&(c=r.pickId.color,u[l]=z.floatToByte(c.red),u[l+1]=z.floatToByte(c.green),u[l+2]=z.floatToByte(c.blue),u[l+3]=z.floatToByte(c.alpha),l+=4);t._selectedIdTexture=new St({context:n,pixelFormat:st.RGBA,pixelDatatype:je.UNSIGNED_BYTE,source:{arrayBufferView:u,width:s,height:1},sampler:pn.NEAREST})}bA.prototype.update=function(t,n){if(this.enabled!==this._enabled&&!this.enabled&&_ge(this),this._enabled=this.enabled,!this._enabled||(this._logDepthChanged=n!==this._useLogDepth,this._useLogDepth=n,this._selectedDirty=wlt(this),this._selectedShadow=this._selected,this._parentSelectedShadow=this._parentSelected,this._combinedSelectedShadow=this._combinedSelected,this._selectedLength=f(this._selected)?this._selected.length:0,this._parentSelectedLength=f(this._parentSelected)?this._parentSelected.length:0,Dlt(this,t),Clt(this),Slt(this,t),xlt(this,t),Tlt(this),this._selectedDirty=!1,!this._ready))return;let i=this._textureCache.getFramebuffer(this._name);if(this._command.framebuffer=i,!f(i))return;let o=i.getColorTexture(0),r;(o.width!==t.drawingBufferWidth||o.height!==t.drawingBufferHeight)&&(r=this._renderState,(!f(r)||o.width!==r.viewport.width||o.height!==r.viewport.height)&&(this._renderState=Ve.fromCache({viewport:new He(0,0,o.width,o.height)}))),this._command.renderState=r};bA.prototype.execute=function(t,n,i,o){if(!f(this._command)||!f(this._command.framebuffer)||!this._ready||!this._enabled)return;this._colorTexture=n,this._depthTexture=i,this._idTexture=o,pn.equals(this._colorTexture.sampler,this._sampler)||(this._colorTexture.sampler=this._sampler);let r=this.scissorRectangle.width>0&&this.scissorRectangle.height>0?this._passState:void 0;f(r)&&(r.context=t),this._command.execute(t,r)};bA.prototype.isDestroyed=function(){return!1};bA.prototype.destroy=function(){return _ge(this),ue(this)};var go=bA;var zU=`uniform sampler2D colorTexture;
varying vec2 v_textureCoordinates;
#ifdef AUTO_EXPOSURE
uniform sampler2D autoExposure;
#endif
void main()
{
vec4 fragmentColor = texture2D(colorTexture, v_textureCoordinates);
vec3 color = fragmentColor.rgb;
#ifdef AUTO_EXPOSURE
color /= texture2D(autoExposure, vec2(0.5)).r;
#endif
color = czm_acesTonemapping(color);
color = czm_inverseGamma(color);
gl_FragColor = vec4(color, fragmentColor.a);
}
`;var HU=`uniform sampler2D randomTexture;
uniform sampler2D depthTexture;
uniform float intensity;
uniform float bias;
uniform float lengthCap;
uniform float stepSize;
uniform float frustumLength;
varying vec2 v_textureCoordinates;
vec4 clipToEye(vec2 uv, float depth)
{
vec2 xy = vec2((uv.x * 2.0 - 1.0), ((1.0 - uv.y) * 2.0 - 1.0));
vec4 posEC = czm_inverseProjection * vec4(xy, depth, 1.0);
posEC = posEC / posEC.w;
return posEC;
}
vec3 getNormalXEdge(vec3 posInCamera, float depthU, float depthD, float depthL, float depthR, vec2 pixelSize)
{
vec4 posInCameraUp = clipToEye(v_textureCoordinates - vec2(0.0, pixelSize.y), depthU);
vec4 posInCameraDown = clipToEye(v_textureCoordinates + vec2(0.0, pixelSize.y), depthD);
vec4 posInCameraLeft = clipToEye(v_textureCoordinates - vec2(pixelSize.x, 0.0), depthL);
vec4 posInCameraRight = clipToEye(v_textureCoordinates + vec2(pixelSize.x, 0.0), depthR);
vec3 up = posInCamera.xyz - posInCameraUp.xyz;
vec3 down = posInCameraDown.xyz - posInCamera.xyz;
vec3 left = posInCamera.xyz - posInCameraLeft.xyz;
vec3 right = posInCameraRight.xyz - posInCamera.xyz;
vec3 DX = length(left) < length(right) ? left : right;
vec3 DY = length(up) < length(down) ? up : down;
return normalize(cross(DY, DX));
}
void main(void)
{
float depth = czm_readDepth(depthTexture, v_textureCoordinates);
vec4 posInCamera = clipToEye(v_textureCoordinates, depth);
if (posInCamera.z > frustumLength)
{
gl_FragColor = vec4(1.0);
return;
}
vec2 pixelSize = czm_pixelRatio / czm_viewport.zw;
float depthU = czm_readDepth(depthTexture, v_textureCoordinates - vec2(0.0, pixelSize.y));
float depthD = czm_readDepth(depthTexture, v_textureCoordinates + vec2(0.0, pixelSize.y));
float depthL = czm_readDepth(depthTexture, v_textureCoordinates - vec2(pixelSize.x, 0.0));
float depthR = czm_readDepth(depthTexture, v_textureCoordinates + vec2(pixelSize.x, 0.0));
vec3 normalInCamera = getNormalXEdge(posInCamera.xyz, depthU, depthD, depthL, depthR, pixelSize);
float ao = 0.0;
vec2 sampleDirection = vec2(1.0, 0.0);
float gapAngle = 90.0 * czm_radiansPerDegree;
float randomVal = texture2D(randomTexture, v_textureCoordinates).x;
for (int i = 0; i < 4; i++)
{
float newGapAngle = gapAngle * (float(i) + randomVal);
float cosVal = cos(newGapAngle);
float sinVal = sin(newGapAngle);
vec2 rotatedSampleDirection = vec2(cosVal * sampleDirection.x - sinVal * sampleDirection.y, sinVal * sampleDirection.x + cosVal * sampleDirection.y);
float localAO = 0.0;
float localStepSize = stepSize;
for (int j = 0; j < 6; j++)
{
vec2 newCoords = v_textureCoordinates + rotatedSampleDirection * localStepSize * pixelSize;
if(newCoords.x > 1.0 || newCoords.y > 1.0 || newCoords.x < 0.0 || newCoords.y < 0.0)
{
break;
}
float stepDepthInfo = czm_readDepth(depthTexture, newCoords);
vec4 stepPosInCamera = clipToEye(newCoords, stepDepthInfo);
vec3 diffVec = stepPosInCamera.xyz - posInCamera.xyz;
float len = length(diffVec);
if (len > lengthCap)
{
break;
}
float dotVal = clamp(dot(normalInCamera, normalize(diffVec)), 0.0, 1.0 );
float weight = len / lengthCap;
weight = 1.0 - weight * weight;
if (dotVal < bias)
{
dotVal = 0.0;
}
localAO = max(localAO, dotVal * weight);
localStepSize += stepSize;
}
ao += localAO;
}
ao /= 4.0;
ao = 1.0 - clamp(ao, 0.0, 1.0);
ao = pow(ao, intensity);
gl_FragColor = vec4(vec3(ao), 1.0);
}
`;var GU=`uniform sampler2D colorTexture;
uniform sampler2D ambientOcclusionTexture;
uniform bool ambientOcclusionOnly;
varying vec2 v_textureCoordinates;
void main(void)
{
vec3 color = texture2D(colorTexture, v_textureCoordinates).rgb;
vec3 ao = texture2D(ambientOcclusionTexture, v_textureCoordinates).rgb;
gl_FragColor.rgb = ambientOcclusionOnly ? ao : ao * color;
}
`;var WU=`uniform sampler2D colorTexture;
uniform float gradations;
varying vec2 v_textureCoordinates;
void main(void)
{
vec3 rgb = texture2D(colorTexture, v_textureCoordinates).rgb;
#ifdef CZM_SELECTED_FEATURE
if (czm_selected()) {
gl_FragColor = vec4(rgb, 1.0);
return;
}
#endif
float luminance = czm_luminance(rgb);
float darkness = luminance * gradations;
darkness = (darkness - fract(darkness)) / gradations;
gl_FragColor = vec4(vec3(darkness), 1.0);
}
`;var jU=`uniform sampler2D colorTexture;
uniform sampler2D bloomTexture;
uniform bool glowOnly;
varying vec2 v_textureCoordinates;
void main(void)
{
vec4 color = texture2D(colorTexture, v_textureCoordinates);
#ifdef CZM_SELECTED_FEATURE
if (czm_selected()) {
gl_FragColor = color;
return;
}
#endif
vec4 bloom = texture2D(bloomTexture, v_textureCoordinates);
gl_FragColor = glowOnly ? bloom : bloom + color;
}
`;var qU=`uniform sampler2D colorTexture;
uniform float brightness;
varying vec2 v_textureCoordinates;
void main(void)
{
vec3 rgb = texture2D(colorTexture, v_textureCoordinates).rgb;
vec3 target = vec3(0.0);
gl_FragColor = vec4(mix(target, rgb, brightness), 1.0);
}
`;var YU=`uniform sampler2D colorTexture;
uniform float contrast;
uniform float brightness;
varying vec2 v_textureCoordinates;
void main(void)
{
vec3 sceneColor = texture2D(colorTexture, v_textureCoordinates).xyz;
sceneColor = czm_RGBToHSB(sceneColor);
sceneColor.z += brightness;
sceneColor = czm_HSBToRGB(sceneColor);
float factor = (259.0 * (contrast + 255.0)) / (255.0 * (259.0 - contrast));
sceneColor = factor * (sceneColor - vec3(0.5)) + vec3(0.5);
gl_FragColor = vec4(sceneColor, 1.0);
}
`;var XU=`uniform sampler2D colorTexture;
uniform sampler2D blurTexture;
uniform sampler2D depthTexture;
uniform float focalDistance;
varying vec2 v_textureCoordinates;
vec4 toEye(vec2 uv, float depth)
{
vec2 xy = vec2((uv.x * 2.0 - 1.0), ((1.0 - uv.y) * 2.0 - 1.0));
vec4 posInCamera = czm_inverseProjection * vec4(xy, depth, 1.0);
posInCamera = posInCamera / posInCamera.w;
return posInCamera;
}
float computeDepthBlur(float depth)
{
float f;
if (depth < focalDistance)
{
f = (focalDistance - depth) / (focalDistance - czm_currentFrustum.x);
}
else
{
f = (depth - focalDistance) / (czm_currentFrustum.y - focalDistance);
f = pow(f, 0.1);
}
f *= f;
f = clamp(f, 0.0, 1.0);
return pow(f, 0.5);
}
void main(void)
{
float depth = czm_readDepth(depthTexture, v_textureCoordinates);
vec4 posInCamera = toEye(v_textureCoordinates, depth);
float d = computeDepthBlur(-posInCamera.z);
gl_FragColor = mix(texture2D(colorTexture, v_textureCoordinates), texture2D(blurTexture, v_textureCoordinates), d);
}
`;var KU=`uniform sampler2D depthTexture;
varying vec2 v_textureCoordinates;
void main(void)
{
float depth = czm_readDepth(depthTexture, v_textureCoordinates);
gl_FragColor = vec4(vec3(depth), 1.0);
}
`;var JU=`uniform sampler2D depthTexture;
uniform float length;
uniform vec4 color;
varying vec2 v_textureCoordinates;
void main(void)
{
float directions[3];
directions[0] = -1.0;
directions[1] = 0.0;
directions[2] = 1.0;
float scalars[3];
scalars[0] = 3.0;
scalars[1] = 10.0;
scalars[2] = 3.0;
float padx = czm_pixelRatio / czm_viewport.z;
float pady = czm_pixelRatio / czm_viewport.w;
#ifdef CZM_SELECTED_FEATURE
bool selected = false;
for (int i = 0; i < 3; ++i)
{
float dir = directions[i];
selected = selected || czm_selected(vec2(-padx, dir * pady));
selected = selected || czm_selected(vec2(padx, dir * pady));
selected = selected || czm_selected(vec2(dir * padx, -pady));
selected = selected || czm_selected(vec2(dir * padx, pady));
if (selected)
{
break;
}
}
if (!selected)
{
gl_FragColor = vec4(color.rgb, 0.0);
return;
}
#endif
float horizEdge = 0.0;
float vertEdge = 0.0;
for (int i = 0; i < 3; ++i)
{
float dir = directions[i];
float scale = scalars[i];
horizEdge -= texture2D(depthTexture, v_textureCoordinates + vec2(-padx, dir * pady)).x * scale;
horizEdge += texture2D(depthTexture, v_textureCoordinates + vec2(padx, dir * pady)).x * scale;
vertEdge -= texture2D(depthTexture, v_textureCoordinates + vec2(dir * padx, -pady)).x * scale;
vertEdge += texture2D(depthTexture, v_textureCoordinates + vec2(dir * padx, pady)).x * scale;
}
float len = sqrt(horizEdge * horizEdge + vertEdge * vertEdge);
gl_FragColor = vec4(color.rgb, len > length ? color.a : 0.0);
}
`;var ZU=`uniform sampler2D colorTexture;
varying vec2 v_textureCoordinates;
#ifdef AUTO_EXPOSURE
uniform sampler2D autoExposure;
#endif
void main()
{
vec4 fragmentColor = texture2D(colorTexture, v_textureCoordinates);
vec3 color = fragmentColor.rgb;
#ifdef AUTO_EXPOSURE
float exposure = texture2D(autoExposure, vec2(0.5)).r;
color /= exposure;
#endif
const float A = 0.22;
const float B = 0.30;
const float C = 0.10;
const float D = 0.20;
const float E = 0.01;
const float F = 0.30;
const float white = 11.2;
vec3 c = ((color * (A * color + C * B) + D * E) / (color * ( A * color + B) + D * F)) - E / F;
float w = ((white * (A * white + C * B) + D * E) / (white * ( A * white + B) + D * F)) - E / F;
c = czm_inverseGamma(c / w);
gl_FragColor = vec4(c, fragmentColor.a);
}
`;var QU=`varying vec2 v_textureCoordinates;
uniform sampler2D colorTexture;
const float fxaaQualitySubpix = 0.5;
const float fxaaQualityEdgeThreshold = 0.125;
const float fxaaQualityEdgeThresholdMin = 0.0833;
void main()
{
vec2 fxaaQualityRcpFrame = vec2(1.0) / czm_viewport.zw;
vec4 color = FxaaPixelShader(
v_textureCoordinates,
colorTexture,
fxaaQualityRcpFrame,
fxaaQualitySubpix,
fxaaQualityEdgeThreshold,
fxaaQualityEdgeThresholdMin);
float alpha = texture2D(colorTexture, v_textureCoordinates).a;
gl_FragColor = vec4(color.rgb, alpha);
}
`;var SA=`#define SAMPLES 8
uniform float delta;
uniform float sigma;
uniform float direction;
uniform sampler2D colorTexture;
#ifdef USE_STEP_SIZE
uniform float stepSize;
#else
uniform vec2 step;
#endif
varying vec2 v_textureCoordinates;
void main()
{
vec2 st = v_textureCoordinates;
vec2 dir = vec2(1.0 - direction, direction);
#ifdef USE_STEP_SIZE
vec2 step = vec2(stepSize * (czm_pixelRatio / czm_viewport.zw));
#else
vec2 step = step;
#endif
vec3 g;
g.x = 1.0 / (sqrt(czm_twoPi) * sigma);
g.y = exp((-0.5 * delta * delta) / (sigma * sigma));
g.z = g.y * g.y;
vec4 result = texture2D(colorTexture, st) * g.x;
for (int i = 1; i < SAMPLES; ++i)
{
g.xy *= g.yz;
vec2 offset = float(i) * dir * step;
result += texture2D(colorTexture, st - offset) * g.x;
result += texture2D(colorTexture, st + offset) * g.x;
}
gl_FragColor = result;
}
`;var $U=`uniform sampler2D colorTexture;
uniform sampler2D dirtTexture;
uniform sampler2D starTexture;
uniform vec2 dirtTextureDimensions;
uniform float distortion;
uniform float ghostDispersal;
uniform float haloWidth;
uniform float dirtAmount;
uniform float earthRadius;
uniform float intensity;
varying vec2 v_textureCoordinates;
#define DISTANCE_TO_SPACE 6500000.0
vec4 getNDCFromWC(vec3 WC, float earthRadius)
{
vec4 positionEC = czm_view * vec4(WC, 1.0);
positionEC = vec4(positionEC.x + earthRadius, positionEC.y, positionEC.z, 1.0);
vec4 positionWC = czm_eyeToWindowCoordinates(positionEC);
return czm_viewportOrthographic * vec4(positionWC.xy, -positionWC.z, 1.0);
}
float isInEarth(vec2 texcoord, vec2 sceneSize)
{
vec2 NDC = texcoord * 2.0 - 1.0;
vec4 earthPosSC = getNDCFromWC(vec3(0.0), 0.0);
vec4 earthPosSCEdge = getNDCFromWC(vec3(0.0), earthRadius * 1.5);
NDC.xy -= earthPosSC.xy;
float X = abs(NDC.x) * sceneSize.x;
float Y = abs(NDC.y) * sceneSize.y;
return clamp(0.0, 1.0, max(sqrt(X * X + Y * Y) / max(abs(earthPosSCEdge.x * sceneSize.x), 1.0) - 0.8 , 0.0));
}
vec4 textureDistorted(sampler2D tex, vec2 texcoord, vec2 direction, vec3 distortion, bool isSpace)
{
vec2 sceneSize = czm_viewport.zw;
vec3 color;
if(isSpace)
{
color.r = isInEarth(texcoord + direction * distortion.r, sceneSize) * texture2D(tex, texcoord + direction * distortion.r).r;
color.g = isInEarth(texcoord + direction * distortion.g, sceneSize) * texture2D(tex, texcoord + direction * distortion.g).g;
color.b = isInEarth(texcoord + direction * distortion.b, sceneSize) * texture2D(tex, texcoord + direction * distortion.b).b;
}
else
{
color.r = texture2D(tex, texcoord + direction * distortion.r).r;
color.g = texture2D(tex, texcoord + direction * distortion.g).g;
color.b = texture2D(tex, texcoord + direction * distortion.b).b;
}
return vec4(clamp(color, 0.0, 1.0), 0.0);
}
void main(void)
{
vec4 originalColor = texture2D(colorTexture, v_textureCoordinates);
vec3 rgb = originalColor.rgb;
bool isSpace = length(czm_viewerPositionWC.xyz) > DISTANCE_TO_SPACE;
vec4 sunPos = czm_morphTime == 1.0 ? vec4(czm_sunPositionWC, 1.0) : vec4(czm_sunPositionColumbusView.zxy, 1.0);
vec4 sunPositionEC = czm_view * sunPos;
vec4 sunPositionWC = czm_eyeToWindowCoordinates(sunPositionEC);
sunPos = czm_viewportOrthographic * vec4(sunPositionWC.xy, -sunPositionWC.z, 1.0);
if(!isSpace || !((sunPos.x >= -1.1 && sunPos.x <= 1.1) && (sunPos.y >= -1.1 && sunPos.y <= 1.1)))
{
gl_FragColor = originalColor;
return;
}
vec2 texcoord = vec2(1.0) - v_textureCoordinates;
vec2 pixelSize = czm_pixelRatio / czm_viewport.zw;
vec2 invPixelSize = 1.0 / pixelSize;
vec3 distortionVec = pixelSize.x * vec3(-distortion, 0.0, distortion);
vec2 ghostVec = (vec2(0.5) - texcoord) * ghostDispersal;
vec3 direction = normalize(vec3(ghostVec, 0.0));
vec4 result = vec4(0.0);
vec4 ghost = vec4(0.0);
for (int i = 0; i < 4; ++i)
{
vec2 offset = fract(texcoord + ghostVec * float(i));
ghost += textureDistorted(colorTexture, offset, direction.xy, distortionVec, isSpace);
}
result += ghost;
vec2 haloVec = normalize(ghostVec) * haloWidth;
float weightForHalo = length(vec2(0.5) - fract(texcoord + haloVec)) / length(vec2(0.5));
weightForHalo = pow(1.0 - weightForHalo, 5.0);
result += textureDistorted(colorTexture, texcoord + haloVec, direction.xy, distortionVec, isSpace) * weightForHalo * 1.5;
vec2 dirtTexCoords = (v_textureCoordinates * invPixelSize) / dirtTextureDimensions;
if (dirtTexCoords.x > 1.0)
{
dirtTexCoords.x = mod(floor(dirtTexCoords.x), 2.0) == 1.0 ? 1.0 - fract(dirtTexCoords.x) :  fract(dirtTexCoords.x);
}
if (dirtTexCoords.y > 1.0)
{
dirtTexCoords.y = mod(floor(dirtTexCoords.y), 2.0) == 1.0 ? 1.0 - fract(dirtTexCoords.y) :  fract(dirtTexCoords.y);
}
result += dirtAmount * texture2D(dirtTexture, dirtTexCoords);
float camrot = czm_view[0].z + czm_view[1].y;
float cosValue = cos(camrot);
float sinValue = sin(camrot);
mat3 rotation = mat3(
cosValue, -sinValue, 0.0,
sinValue, cosValue, 0.0,
0.0, 0.0, 1.0
);
vec3 st1 = vec3(v_textureCoordinates * 2.0 - vec2(1.0), 1.0);
vec3 st2 = vec3((rotation * st1).xy, 1.0);
vec3 st3 = st2 * 0.5 + vec3(0.5);
vec2 lensStarTexcoord = st3.xy;
float weightForLensFlare = length(vec3(sunPos.xy, 0.0));
float oneMinusWeightForLensFlare = max(1.0 - weightForLensFlare, 0.0);
if (!isSpace)
{
result *= oneMinusWeightForLensFlare * intensity * 0.2;
}
else
{
result *= oneMinusWeightForLensFlare * intensity;
result *= texture2D(starTexture, lensStarTexcoord) * pow(weightForLensFlare, 1.0) * max((1.0 - length(vec3(st1.xy, 0.0))), 0.0) * 2.0;
}
result += texture2D(colorTexture, v_textureCoordinates);
gl_FragColor = result;
}
`;var e4=`uniform sampler2D colorTexture;
uniform vec3 white;
varying vec2 v_textureCoordinates;
#ifdef AUTO_EXPOSURE
uniform sampler2D autoExposure;
#endif
void main()
{
vec4 fragmentColor = texture2D(colorTexture, v_textureCoordinates);
vec3 color = fragmentColor.rgb;
#ifdef AUTO_EXPOSURE
float exposure = texture2D(autoExposure, vec2(0.5)).r;
color /= exposure;
#endif
color = (color * (1.0 + color / white)) / (1.0 + color);
color = czm_inverseGamma(color);
gl_FragColor = vec4(color, fragmentColor.a);
}
`;var t4=`uniform sampler2D colorTexture;
varying vec2 v_textureCoordinates;
float rand(vec2 co)
{
return fract(sin(dot(co.xy ,vec2(12.9898, 78.233))) * 43758.5453);
}
void main(void)
{
float noiseValue = rand(v_textureCoordinates + sin(czm_frameNumber)) * 0.1;
vec3 rgb = texture2D(colorTexture, v_textureCoordinates).rgb;
vec3 green = vec3(0.0, 1.0, 0.0);
gl_FragColor = vec4((noiseValue + rgb) * green, 1.0);
}
`;var n4=`uniform sampler2D colorTexture;
varying vec2 v_textureCoordinates;
#ifdef AUTO_EXPOSURE
uniform sampler2D autoExposure;
#endif
void main()
{
vec4 fragmentColor = texture2D(colorTexture, v_textureCoordinates);
vec3 color = fragmentColor.rgb;
#ifdef AUTO_EXPOSURE
float exposure = texture2D(autoExposure, vec2(0.5)).r;
color /= exposure;
#endif
color = color / (1.0 + color);
color = czm_inverseGamma(color);
gl_FragColor = vec4(color, fragmentColor.a);
}
`;var i4=`uniform sampler2D colorTexture;
uniform sampler2D silhouetteTexture;
varying vec2 v_textureCoordinates;
void main(void)
{
vec4 silhouetteColor = texture2D(silhouetteTexture, v_textureCoordinates);
vec4 color = texture2D(colorTexture, v_textureCoordinates);
gl_FragColor = mix(color, silhouetteColor, silhouetteColor.a);
}
`;function wA(t){t=A(t,A.EMPTY_OBJECT),this._stages=t.stages,this._inputPreviousStageTexture=A(t.inputPreviousStageTexture,!0);let n=t.name;f(n)||(n=Bn()),this._name=n,this._uniforms=t.uniforms,this._textureCache=void 0,this._index=void 0,this._selected=void 0,this._selectedShadow=void 0,this._parentSelected=void 0,this._parentSelectedShadow=void 0,this._combinedSelected=void 0,this._combinedSelectedShadow=void 0,this._selectedLength=0,this._parentSelectedLength=0,this._selectedDirty=!0}Object.defineProperties(wA.prototype,{ready:{get:function(){let t=this._stages,n=t.length;for(let i=0;i<n;++i)if(!t[i].ready)return!1;return!0}},name:{get:function(){return this._name}},enabled:{get:function(){return this._stages[0].enabled},set:function(t){let n=this._stages,i=n.length;for(let o=0;o<i;++o)n[o].enabled=t}},uniforms:{get:function(){return this._uniforms}},inputPreviousStageTexture:{get:function(){return this._inputPreviousStageTexture}},length:{get:function(){return this._stages.length}},selected:{get:function(){return this._selected},set:function(t){this._selected=t}},parentSelected:{get:function(){return this._parentSelected},set:function(t){this._parentSelected=t}}});wA.prototype._isSupported=function(t){let n=this._stages,i=n.length;for(let o=0;o<i;++o)if(!n[o]._isSupported(t))return!1;return!0};wA.prototype.get=function(t){return this._stages[t]};function vlt(t){let n=f(t._selected)?t._selected.length:0,i=f(t._parentSelected)?t._parentSelected:0,o=t._selected!==t._selectedShadow||n!==t._selectedLength;if(o=o||t._parentSelected!==t._parentSelectedShadow||i!==t._parentSelectedLength,f(t._selected)&&f(t._parentSelected)?t._combinedSelected=t._selected.concat(t._parentSelected):f(t._parentSelected)?t._combinedSelected=t._parentSelected:t._combinedSelected=t._selected,!o&&f(t._combinedSelected)){if(!f(t._combinedSelectedShadow))return!0;n=t._combinedSelected.length;for(let r=0;r<n;++r)if(t._combinedSelected[r]!==t._combinedSelectedShadow[r])return!0}return o}wA.prototype.update=function(t,n){this._selectedDirty=vlt(this),this._selectedShadow=this._selected,this._parentSelectedShadow=this._parentSelected,this._combinedSelectedShadow=this._combinedSelected,this._selectedLength=f(this._selected)?this._selected.length:0,this._parentSelectedLength=f(this._parentSelected)?this._parentSelected.length:0;let i=this._stages,o=i.length;for(let r=0;r<o;++r){let s=i[r];this._selectedDirty&&(s.parentSelected=this._combinedSelected),s.update(t,n)}};wA.prototype.isDestroyed=function(){return!1};wA.prototype.destroy=function(){let t=this._stages,n=t.length;for(let i=0;i<n;++i)t[i].destroy();return ue(this)};var pl=wA;var wr={};function o4(t){let r=`#define USE_STEP_SIZE
${SA}`,s=new go({name:`${t}_x_direction`,fragmentShader:r,uniforms:{delta:1,sigma:2,stepSize:1,direction:0},sampleMode:hf.LINEAR}),a=new go({name:`${t}_y_direction`,fragmentShader:r,uniforms:{delta:1,sigma:2,stepSize:1,direction:1},sampleMode:hf.LINEAR}),c={};return Object.defineProperties(c,{delta:{get:function(){return s.uniforms.delta},set:function(l){let u=s.uniforms,d=a.uniforms;u.delta=d.delta=l}},sigma:{get:function(){return s.uniforms.sigma},set:function(l){let u=s.uniforms,d=a.uniforms;u.sigma=d.sigma=l}},stepSize:{get:function(){return s.uniforms.stepSize},set:function(l){let u=s.uniforms,d=a.uniforms;u.stepSize=d.stepSize=l}}}),new pl({name:t,stages:[s,a],uniforms:c})}wr.createBlurStage=function(){return o4("czm_blur")};wr.createDepthOfFieldStage=function(){let t=o4("czm_depth_of_field_blur"),n=new go({name:"czm_depth_of_field_composite",fragmentShader:XU,uniforms:{focalDistance:5,blurTexture:t.name}}),i={};return Object.defineProperties(i,{focalDistance:{get:function(){return n.uniforms.focalDistance},set:function(o){n.uniforms.focalDistance=o}},delta:{get:function(){return t.uniforms.delta},set:function(o){t.uniforms.delta=o}},sigma:{get:function(){return t.uniforms.sigma},set:function(o){t.uniforms.sigma=o}},stepSize:{get:function(){return t.uniforms.stepSize},set:function(o){t.uniforms.stepSize=o}}}),new pl({name:"czm_depth_of_field",stages:[t,n],inputPreviousStageTexture:!1,uniforms:i})};wr.isDepthOfFieldSupported=function(t){return t.context.depthTexture};wr.createEdgeDetectionStage=function(){let t=Bn();return new go({name:`czm_edge_detection_${t}`,fragmentShader:JU,uniforms:{length:.25,color:z.clone(z.BLACK)}})};wr.isEdgeDetectionSupported=function(t){return t.context.depthTexture};function Plt(t){if(!f(t))return wr.createEdgeDetectionStage();let n=new pl({name:"czm_edge_detection_multiple",stages:t,inputPreviousStageTexture:!1}),i={},o="",r="";for(let c=0;c<t.length;++c)o+=`uniform sampler2D edgeTexture${c}; 
`,r+=`        vec4 edge${c} = texture2D(edgeTexture${c}, v_textureCoordinates); 
        if (edge${c}.a > 0.0) 
        { 
            color = edge${c}; 
            break; 
        } 
`,i[`edgeTexture${c}`]=t[c].name;let s=`${o}varying vec2 v_textureCoordinates; 
void main() { 
    vec4 color = vec4(0.0); 
    for (int i = 0; i < ${t.length}; i++) 
    { 
${r}    } 
    gl_FragColor = color; 
} 
`,a=new go({name:"czm_edge_detection_combine",fragmentShader:s,uniforms:i});return new pl({name:"czm_edge_detection_composite",stages:[n,a]})}wr.createSilhouetteStage=function(t){let n=Plt(t),i=new go({name:"czm_silhouette_color_edges",fragmentShader:i4,uniforms:{silhouetteTexture:n.name}});return new pl({name:"czm_silhouette",stages:[n,i],inputPreviousStageTexture:!1,uniforms:n.uniforms})};wr.isSilhouetteSupported=function(t){return t.context.depthTexture};wr.createBloomStage=function(){let t=new go({name:"czm_bloom_contrast_bias",fragmentShader:YU,uniforms:{contrast:128,brightness:-.3}}),n=o4("czm_bloom_blur"),i=new pl({name:"czm_bloom_contrast_bias_blur",stages:[t,n]}),o=new go({name:"czm_bloom_generate_composite",fragmentShader:jU,uniforms:{glowOnly:!1,bloomTexture:i.name}}),r={};return Object.defineProperties(r,{glowOnly:{get:function(){return o.uniforms.glowOnly},set:function(s){o.uniforms.glowOnly=s}},contrast:{get:function(){return t.uniforms.contrast},set:function(s){t.uniforms.contrast=s}},brightness:{get:function(){return t.uniforms.brightness},set:function(s){t.uniforms.brightness=s}},delta:{get:function(){return n.uniforms.delta},set:function(s){n.uniforms.delta=s}},sigma:{get:function(){return n.uniforms.sigma},set:function(s){n.uniforms.sigma=s}},stepSize:{get:function(){return n.uniforms.stepSize},set:function(s){n.uniforms.stepSize=s}}}),new pl({name:"czm_bloom",stages:[i,o],inputPreviousStageTexture:!1,uniforms:r})};wr.createAmbientOcclusionStage=function(){let t=new go({name:"czm_ambient_occlusion_generate",fragmentShader:HU,uniforms:{intensity:3,bias:.1,lengthCap:.26,stepSize:1.95,frustumLength:1e3,randomTexture:void 0}}),n=o4("czm_ambient_occlusion_blur");n.uniforms.stepSize=.86;let i=new pl({name:"czm_ambient_occlusion_generate_blur",stages:[t,n]}),o=new go({name:"czm_ambient_occlusion_composite",fragmentShader:GU,uniforms:{ambientOcclusionOnly:!1,ambientOcclusionTexture:i.name}}),r={};return Object.defineProperties(r,{intensity:{get:function(){return t.uniforms.intensity},set:function(s){t.uniforms.intensity=s}},bias:{get:function(){return t.uniforms.bias},set:function(s){t.uniforms.bias=s}},lengthCap:{get:function(){return t.uniforms.lengthCap},set:function(s){t.uniforms.lengthCap=s}},stepSize:{get:function(){return t.uniforms.stepSize},set:function(s){t.uniforms.stepSize=s}},frustumLength:{get:function(){return t.uniforms.frustumLength},set:function(s){t.uniforms.frustumLength=s}},randomTexture:{get:function(){return t.uniforms.randomTexture},set:function(s){t.uniforms.randomTexture=s}},delta:{get:function(){return n.uniforms.delta},set:function(s){n.uniforms.delta=s}},sigma:{get:function(){return n.uniforms.sigma},set:function(s){n.uniforms.sigma=s}},blurStepSize:{get:function(){return n.uniforms.stepSize},set:function(s){n.uniforms.stepSize=s}},ambientOcclusionOnly:{get:function(){return o.uniforms.ambientOcclusionOnly},set:function(s){o.uniforms.ambientOcclusionOnly=s}}}),new pl({name:"czm_ambient_occlusion",stages:[i,o],inputPreviousStageTexture:!1,uniforms:r})};wr.isAmbientOcclusionSupported=function(t){return t.context.depthTexture};var Ilt=`#define FXAA_QUALITY_PRESET 39 
${LV}
${QU}`;wr.createFXAAStage=function(){return new go({name:"czm_FXAA",fragmentShader:Ilt,sampleMode:hf.LINEAR})};wr.createAcesTonemappingStage=function(t){let n=t?`#define AUTO_EXPOSURE
`:"";return n+=zU,new go({name:"czm_aces",fragmentShader:n,uniforms:{autoExposure:void 0}})};wr.createFilmicTonemappingStage=function(t){let n=t?`#define AUTO_EXPOSURE
`:"";return n+=ZU,new go({name:"czm_filmic",fragmentShader:n,uniforms:{autoExposure:void 0}})};wr.createReinhardTonemappingStage=function(t){let n=t?`#define AUTO_EXPOSURE
`:"";return n+=n4,new go({name:"czm_reinhard",fragmentShader:n,uniforms:{autoExposure:void 0}})};wr.createModifiedReinhardTonemappingStage=function(t){let n=t?`#define AUTO_EXPOSURE
`:"";return n+=e4,new go({name:"czm_modified_reinhard",fragmentShader:n,uniforms:{white:z.WHITE,autoExposure:void 0}})};wr.createAutoExposureStage=function(){return new YV};wr.createBlackAndWhiteStage=function(){return new go({name:"czm_black_and_white",fragmentShader:WU,uniforms:{gradations:5}})};wr.createBrightnessStage=function(){return new go({name:"czm_brightness",fragmentShader:qU,uniforms:{brightness:.5}})};wr.createNightVisionStage=function(){return new go({name:"czm_night_vision",fragmentShader:t4})};wr.createDepthViewStage=function(){return new go({name:"czm_depth_view",fragmentShader:KU})};wr.createLensFlareStage=function(){return new go({name:"czm_lens_flare",fragmentShader:$U,uniforms:{dirtTexture:Qt("Assets/Textures/LensFlare/DirtMask.jpg"),starTexture:Qt("Assets/Textures/LensFlare/StarBurst.jpg"),intensity:2,distortion:10,ghostDispersal:.4,haloWidth:.4,dirtAmount:.4,earthRadius:oe.WGS84.maximumRadius}})};var Sd=wr;function Sp(t){this._collection=t,this._framebuffers=[],this._stageNameToFramebuffer={},this._width=void 0,this._height=void 0,this._updateDependencies=!1}function zv(t){for(;f(t.length);)t=t.get(t.length-1);return t.name}function oq(t,n,i,o,r){if(!o.enabled||!o._isSupported(n))return r;let s=i[o.name]={};if(f(r)){let c=t.getStageByName(r);s[zv(c)]=!0}let a=o.uniforms;if(f(a)){let c=Object.getOwnPropertyNames(a),l=c.length;for(let u=0;u<l;++u){let d=a[c[u]];if(typeof d=="string"){let h=t.getStageByName(d);f(h)&&(s[zv(h)]=!0)}}}return o.name}function Uv(t,n,i,o,r){if(f(o.enabled)&&!o.enabled||f(o._isSupported)&&!o._isSupported(n))return r;let s=r,a=!f(o.inputPreviousStageTexture)||o.inputPreviousStageTexture,c=r,l=o.length;for(let h=0;h<l;++h){let _=o.get(h);f(_.length)?c=Uv(t,n,i,_,r):c=oq(t,n,i,_,r),a&&(r=c)}let u,d;if(a)for(u=1;u<l;++u)d=zv(o.get(u)),f(i[d])||(i[d]={}),i[d][s]=!0;else for(u=1;u<l;++u){d=zv(o.get(u));let h=i[d];for(let _=0;_<u;++_)h[zv(o.get(_))]=!0}return c}function Blt(t,n){let i={};if(f(t.ambientOcclusion)){let o=t.ambientOcclusion,r=t.bloom,s=t._tonemapping,a=t.fxaa,c=Uv(t,n,i,o,void 0);c=Uv(t,n,i,r,c),c=oq(t,n,i,s,c),c=Uv(t,n,i,t,c),oq(t,n,i,a,c)}else Uv(t,n,i,t,void 0);return i}function Olt(t,n,i){let r=t._collection.getStageByName(n),s=r._textureScale,a=r._forcePowerOfTwo,c=r._pixelFormat,l=r._pixelDatatype,u=r._clearColor,d,h,_=t._framebuffers,y=_.length;for(d=0;d<y;++d){if(h=_[d],s!==h.textureScale||a!==h.forcePowerOfTwo||c!==h.pixelFormat||l!==h.pixelDatatype||!z.equals(u,h.clearColor))continue;let p=h.stages,C=p.length,x=!1;for(let T=0;T<C;++T)if(i[p[T]]){x=!0;break}if(!x)break}return f(h)&&d<y?(h.stages.push(n),h):(h={textureScale:s,forcePowerOfTwo:a,pixelFormat:c,pixelDatatype:l,clearColor:u,stages:[n],buffer:new ci({pixelFormat:c,pixelDatatype:l}),clear:void 0},_.push(h),h)}function Rlt(t,n){let i=Blt(t._collection,n);for(let o in i)i.hasOwnProperty(o)&&(t._stageNameToFramebuffer[o]=Olt(t,o,i[o]))}function rq(t){let n=t._framebuffers,i=n.length;for(let o=0;o<i;++o)n[o].buffer.destroy()}function Mlt(t,n){let i=t._width,o=t._height,r=t._framebuffers,s=r.length;for(let a=0;a<s;++a){let c=r[a],l=c.textureScale,u=Math.ceil(i*l),d=Math.ceil(o*l),h=Math.min(u,d);c.forcePowerOfTwo&&(B.isPowerOfTwo(h)||(h=B.nextPowerOfTwo(h)),u=h,d=h),c.buffer.update(n,u,d),c.clear=new Qn({color:c.clearColor,framebuffer:c.buffer.framebuffer})}}Sp.prototype.updateDependencies=function(){this._updateDependencies=!0};Sp.prototype.update=function(t){let n=this._collection,i=this._updateDependencies,o=f(n.ambientOcclusion)&&n.ambientOcclusion.enabled&&n.ambientOcclusion._isSupported(t),r=f(n.bloom)&&n.bloom.enabled&&n.bloom._isSupported(t),s=f(n._tonemapping)&&n._tonemapping.enabled&&n._tonemapping._isSupported(t),a=f(n.fxaa)&&n.fxaa.enabled&&n.fxaa._isSupported(t),c=!f(n._activeStages)||n._activeStages.length>0||o||r||s||a;if((i||!c&&this._framebuffers.length>0)&&(rq(this),this._framebuffers.length=0,this._stageNameToFramebuffer={},this._width=void 0,this._height=void 0),!i&&!c)return;this._framebuffers.length===0&&Rlt(this,t);let l=t.drawingBufferWidth,u=t.drawingBufferHeight,d=this._width!==l||this._height!==u;!i&&!d||(this._width=l,this._height=u,this._updateDependencies=!1,rq(this),Mlt(this,t))};Sp.prototype.clear=function(t){let n=this._framebuffers;for(let i=0;i<n.length;++i)n[i].clear.execute(t)};Sp.prototype.getStageByName=function(t){return this._collection.getStageByName(t)};Sp.prototype.getOutputTexture=function(t){return this._collection.getOutputTexture(t)};Sp.prototype.getFramebuffer=function(t){let n=this._stageNameToFramebuffer[t];if(!!f(n))return n.buffer.framebuffer};Sp.prototype.isDestroyed=function(){return!1};Sp.prototype.destroy=function(){return rq(this),ue(this)};var tb=Sp;var Hv={REINHARD:0,MODIFIED_REINHARD:1,FILMIC:2,ACES:3,validate:function(t){return t===Hv.REINHARD||t===Hv.MODIFIED_REINHARD||t===Hv.FILMIC||t===Hv.ACES}},DA=Object.freeze(Hv);var sq=[];function vc(){let t=Sd.createFXAAStage(),n=Sd.createAmbientOcclusionStage(),i=Sd.createBloomStage();this._autoExposureEnabled=!1,this._autoExposure=Sd.createAutoExposureStage(),this._tonemapping=void 0,this._tonemapper=void 0,this.tonemapper=DA.ACES;let o=this._tonemapping;t.enabled=!1,n.enabled=!1,i.enabled=!1,o.enabled=!1;let r=new tb(this),s={},a=sq;for(a.push(t,n,i,o);a.length>0;){let l=a.pop();s[l.name]=l,l._textureCache=r;let u=l.length;if(f(u))for(let d=0;d<u;++d)a.push(l.get(d))}this._stages=[],this._activeStages=[],this._previousActiveStages=[],this._randomTexture=void 0;let c=this;n.uniforms.randomTexture=function(){return c._randomTexture},this._ao=n,this._bloom=i,this._fxaa=t,this._aoEnabled=void 0,this._bloomEnabled=void 0,this._tonemappingEnabled=void 0,this._fxaaEnabled=void 0,this._activeStagesChanged=!1,this._stagesRemoved=!1,this._textureCacheDirty=!1,this._stageNames=s,this._textureCache=r}Object.defineProperties(vc.prototype,{ready:{get:function(){let t=!1,n=this._stages,i=n.length;for(let c=i-1;c>=0;--c){let l=n[c];t=t||l.ready&&l.enabled}let o=this._fxaa,r=this._ao,s=this._bloom,a=this._tonemapping;return t=t||o.ready&&o.enabled,t=t||r.ready&&r.enabled,t=t||s.ready&&s.enabled,t=t||a.ready&&a.enabled,t}},fxaa:{get:function(){return this._fxaa}},ambientOcclusion:{get:function(){return this._ao}},bloom:{get:function(){return this._bloom}},length:{get:function(){return aq(this),this._stages.length}},outputTexture:{get:function(){let t=this._fxaa;if(t.enabled&&t.ready)return this.getOutputTexture(t.name);let n=this._stages,i=n.length;for(let a=i-1;a>=0;--a){let c=n[a];if(f(c)&&c.ready&&c.enabled)return this.getOutputTexture(c.name)}let o=this._tonemapping;if(o.enabled&&o.ready)return this.getOutputTexture(o.name);let r=this._bloom;if(r.enabled&&r.ready)return this.getOutputTexture(r.name);let s=this._ao;if(s.enabled&&s.ready)return this.getOutputTexture(s.name)}},hasSelected:{get:function(){let t=this._stages.slice();for(;t.length>0;){let n=t.pop();if(!f(n))continue;if(f(n.selected))return!0;let i=n.length;if(f(i))for(let o=0;o<i;++o)t.push(n.get(o))}return!1}},tonemapper:{get:function(){return this._tonemapper},set:function(t){if(this._tonemapper===t)return;f(this._tonemapping)&&(delete this._stageNames[this._tonemapping.name],this._tonemapping.destroy());let n=this._autoExposureEnabled,i;switch(t){case DA.REINHARD:i=Sd.createReinhardTonemappingStage(n);break;case DA.MODIFIED_REINHARD:i=Sd.createModifiedReinhardTonemappingStage(n);break;case DA.FILMIC:i=Sd.createFilmicTonemappingStage(n);break;default:i=Sd.createAcesTonemappingStage(n);break}if(n){let o=this._autoExposure;i.uniforms.autoExposure=function(){return o.outputTexture}}this._tonemapper=t,this._tonemapping=i,f(this._stageNames)&&(this._stageNames[i.name]=i,i._textureCache=this._textureCache),this._textureCacheDirty=!0}}});function aq(t){if(!t._stagesRemoved)return;t._stagesRemoved=!1;let n=[],i=t._stages,o=i.length;for(let r=0,s=0;r<o;++r){let a=i[r];a&&(a._index=s++,n.push(a))}t._stages=n}vc.prototype.add=function(t){let n=this._stageNames,i=sq;for(i.push(t);i.length>0;){let r=i.pop();n[r.name]=r,r._textureCache=this._textureCache;let s=r.length;if(f(s))for(let a=0;a<s;++a)i.push(r.get(a))}let o=this._stages;return t._index=o.length,o.push(t),this._textureCacheDirty=!0,t};vc.prototype.remove=function(t){if(!this.contains(t))return!1;let n=this._stageNames,i=sq;for(i.push(t);i.length>0;){let o=i.pop();delete n[o.name];let r=o.length;if(f(r))for(let s=0;s<r;++s)i.push(o.get(s))}return this._stages[t._index]=void 0,this._stagesRemoved=!0,this._textureCacheDirty=!0,t._index=void 0,t._textureCache=void 0,t.destroy(),!0};vc.prototype.contains=function(t){return f(t)&&f(t._index)&&t._textureCache===this._textureCache};vc.prototype.get=function(t){return aq(this),this._stages[t]};vc.prototype.removeAll=function(){let t=this._stages,n=t.length;for(let i=0;i<n;++i)this.remove(t[i]);t.length=0};vc.prototype.getStageByName=function(t){return this._stageNames[t]};vc.prototype.update=function(t,n,i){aq(this);let o=this._activeStages,r=this._activeStages=this._previousActiveStages;this._previousActiveStages=o;let s=this._stages,a=r.length=s.length,c,l,u=0;for(c=0;c<a;++c)l=s[c],l.ready&&l.enabled&&l._isSupported(t)&&(r[u++]=l);r.length=u;let d=u!==o.length;if(!d){for(c=0;c<u;++c)if(r[c]!==o[c]){d=!0;break}}let h=this._ao,_=this._bloom,y=this._autoExposure,p=this._tonemapping,C=this._fxaa;p.enabled=i;let x=h.enabled&&h._isSupported(t),T=_.enabled&&_._isSupported(t),E=p.enabled&&p._isSupported(t),S=C.enabled&&C._isSupported(t);if((d||this._textureCacheDirty||x!==this._aoEnabled||T!==this._bloomEnabled||E!==this._tonemappingEnabled||S!==this._fxaaEnabled)&&(this._textureCache.updateDependencies(),this._aoEnabled=x,this._bloomEnabled=T,this._tonemappingEnabled=E,this._fxaaEnabled=S,this._textureCacheDirty=!1),f(this._randomTexture)&&!x&&(this._randomTexture.destroy(),this._randomTexture=void 0),!f(this._randomTexture)&&x){a=256*256*3;let w=new Uint8Array(a);for(c=0;c<a;c+=3)w[c]=Math.floor(Math.random()*255);this._randomTexture=new St({context:t,pixelFormat:st.RGB,pixelDatatype:je.UNSIGNED_BYTE,source:{arrayBufferView:w,width:256,height:256},sampler:new pn({wrapS:Mn.REPEAT,wrapT:Mn.REPEAT,minificationFilter:fn.NEAREST,magnificationFilter:Qi.NEAREST})})}for(this._textureCache.update(t),C.update(t,n),h.update(t,n),_.update(t,n),p.update(t,n),this._autoExposureEnabled&&y.update(t,n),a=s.length,c=0;c<a;++c)s[c].update(t,n);for(u=0,c=0;c<a;++c)l=s[c],l.ready&&l.enabled&&l._isSupported(t)&&u++;d=u!==r.length,d&&this.update(t,n,i)};vc.prototype.clear=function(t){this._textureCache.clear(t),this._autoExposureEnabled&&this._autoExposure.clear(t)};function vA(t){for(;f(t.length);)t=t.get(t.length-1);return t.outputTexture}vc.prototype.getOutputTexture=function(t){let n=this.getStageByName(t);if(!!f(n))return vA(n)};function Kh(t,n,i,o,r){if(f(t.execute)){t.execute(n,i,o,r);return}let s=t.length,a;if(t.inputPreviousStageTexture)for(Kh(t.get(0),n,i,o,r),a=1;a<s;++a)Kh(t.get(a),n,vA(t.get(a-1)),o,r);else for(a=0;a<s;++a)Kh(t.get(a),n,i,o,r)}vc.prototype.execute=function(t,n,i,o){let r=this._activeStages,s=r.length,a=this._fxaa,c=this._ao,l=this._bloom,u=this._autoExposure,d=this._tonemapping,h=c.enabled&&c._isSupported(t),_=l.enabled&&l._isSupported(t),y=this._autoExposureEnabled,p=d.enabled&&d._isSupported(t),C=a.enabled&&a._isSupported(t);if(!C&&!h&&!_&&!p&&s===0)return;let x=n;h&&c.ready&&(Kh(c,t,x,i,o),x=vA(c)),_&&l.ready&&(Kh(l,t,x,i,o),x=vA(l)),y&&u.ready&&Kh(u,t,x,i,o),p&&d.ready&&(Kh(d,t,x,i,o),x=vA(d));let T=x;if(s>0){Kh(r[0],t,x,i,o);for(let E=1;E<s;++E)Kh(r[E],t,vA(r[E-1]),i,o);T=vA(r[s-1])}C&&a.ready&&Kh(a,t,T,i,o)};vc.prototype.copy=function(t,n){if(!f(this._copyColorCommand)){let i=this;this._copyColorCommand=t.createViewportQuadCommand(tu,{uniformMap:{colorTexture:function(){return i.outputTexture}},owner:this})}this._copyColorCommand.framebuffer=n,this._copyColorCommand.execute(t)};vc.prototype.isDestroyed=function(){return!1};vc.prototype.destroy=function(){return this._fxaa.destroy(),this._ao.destroy(),this._bloom.destroy(),this._autoExposure.destroy(),this._tonemapping.destroy(),this.removeAll(),this._textureCache=this._textureCache&&this._textureCache.destroy(),ue(this)};var r4=vc;function nu(){Ce.throwInstantiationError()}nu.computeDefaultLevelZeroMaximumGeometricError=function(t){return t.ellipsoid.maximumRadius*2*Math.PI*.25/(65*t.getNumberOfXTilesAtLevel(0))};Object.defineProperties(nu.prototype,{quadtree:{get:Ce.throwInstantiationError,set:Ce.throwInstantiationError},ready:{get:Ce.throwInstantiationError},tilingScheme:{get:Ce.throwInstantiationError},errorEvent:{get:Ce.throwInstantiationError}});nu.prototype.update=Ce.throwInstantiationError;nu.prototype.beginUpdate=Ce.throwInstantiationError;nu.prototype.endUpdate=Ce.throwInstantiationError;nu.prototype.getLevelMaximumGeometricError=Ce.throwInstantiationError;nu.prototype.loadTile=Ce.throwInstantiationError;nu.prototype.computeTileVisibility=Ce.throwInstantiationError;nu.prototype.showTileThisFrame=Ce.throwInstantiationError;nu.prototype.computeDistanceToTile=Ce.throwInstantiationError;nu.prototype.isDestroyed=Ce.throwInstantiationError;nu.prototype.destroy=Ce.throwInstantiationError;var gge=nu;function PA(t){this._scene=t,this._currentTweens=[],this._morphHandler=void 0,this._morphCancelled=!1,this._completeMorph=void 0,this._morphToOrthographic=!1}PA.prototype.completeMorph=function(){f(this._completeMorph)&&this._completeMorph()};PA.prototype.morphTo2D=function(t,n){f(this._completeMorph)&&this._completeMorph();let i=this._scene;this._previousMode=i.mode,this._morphToOrthographic=i.camera.frustum instanceof $t,!(this._previousMode===ne.SCENE2D||this._previousMode===ne.MORPHING)&&(this._scene.morphStart.raiseEvent(this,this._previousMode,ne.SCENE2D,!0),i._mode=ne.MORPHING,i.camera._setTransform(N.IDENTITY),this._previousMode===ne.COLUMBUS_VIEW?hut(this,t):Cut(this,t,n),t===0&&f(this._completeMorph)&&this._completeMorph())};var Llt=new m,Flt=new m,Nlt=new m,Vlt=new m,klt=new m,Ult=new m,zlt=new m,Hlt=new de,Glt=new N,Wlt=new yi,jlt=new $t,qlt={position:void 0,direction:void 0,up:void 0,position2D:void 0,direction2D:void 0,up2D:void 0,frustum:void 0};PA.prototype.morphToColumbusView=function(t,n){f(this._completeMorph)&&this._completeMorph();let i=this._scene;if(this._previousMode=i.mode,this._previousMode===ne.COLUMBUS_VIEW||this._previousMode===ne.MORPHING)return;this._scene.morphStart.raiseEvent(this,this._previousMode,ne.COLUMBUS_VIEW,!0),i.camera._setTransform(N.IDENTITY);let o=Llt,r=Flt,s=Nlt;if(t>0)o.x=0,o.y=-1,o.z=1,o=m.multiplyByScalar(m.normalize(o,o),5*n.maximumRadius,o),m.negate(m.normalize(o,r),r),m.cross(m.UNIT_X,r,s);else{let u=i.camera;if(this._previousMode===ne.SCENE2D)m.clone(u.position,o),o.z=u.frustum.right-u.frustum.left,m.negate(m.UNIT_Z,r),m.clone(m.UNIT_Y,s);else{m.clone(u.positionWC,o),m.clone(u.directionWC,r),m.clone(u.upWC,s);let d=n.scaleToGeodeticSurface(o,zlt),h=vt.eastNorthUpToFixedFrame(d,n,Glt);N.inverseTransformation(h,h),i.mapProjection.project(n.cartesianToCartographic(o,Hlt),o),N.multiplyByPointAsVector(h,r,r),N.multiplyByPointAsVector(h,s,s)}}let a;this._morphToOrthographic?(a=jlt,a.width=i.camera.frustum.right-i.camera.frustum.left,a.aspectRatio=i.drawingBufferWidth/i.drawingBufferHeight):(a=Wlt,a.aspectRatio=i.drawingBufferWidth/i.drawingBufferHeight,a.fov=B.toRadians(60));let c=qlt;c.position=o,c.direction=r,c.up=s,c.frustum=a;let l=Tut(c);Gv(this,l),this._previousMode===ne.SCENE2D?xut(this,t,c,l):(c.position2D=N.multiplyByPoint(lo.TRANSFORM_2D,o,Vlt),c.direction2D=N.multiplyByPointAsVector(lo.TRANSFORM_2D,r,klt),c.up2D=N.multiplyByPointAsVector(lo.TRANSFORM_2D,s,Ult),i._mode=ne.MORPHING,vge(this,t,c,l)),t===0&&f(this._completeMorph)&&this._completeMorph()};var uq={position:new m,direction:new m,up:new m,frustum:void 0},Age=new yi;PA.prototype.morphTo3D=function(t,n){f(this._completeMorph)&&this._completeMorph();let i=this._scene;if(this._previousMode=i.mode,!(this._previousMode===ne.SCENE3D||this._previousMode===ne.MORPHING)){if(this._scene.morphStart.raiseEvent(this,this._previousMode,ne.SCENE3D,!0),i._mode=ne.MORPHING,i.camera._setTransform(N.IDENTITY),this._previousMode===ne.SCENE2D)iut(this,t,n);else{let o;t>0?(o=uq,m.fromDegrees(0,0,5*n.maximumRadius,n,o.position),m.negate(o.position,o.direction),m.normalize(o.direction,o.direction),m.clone(m.UNIT_Z,o.up)):o=Cge(this,n);let r,s=i.camera;s.frustum instanceof $t?r=s.frustum.clone():(r=Age,r.aspectRatio=i.drawingBufferWidth/i.drawingBufferHeight,r.fov=B.toRadians(60)),o.frustum=r;let a=Ige(o);Gv(this,a),lq(this,t,o,a)}t===0&&f(this._completeMorph)&&this._completeMorph()}};PA.prototype.isDestroyed=function(){return!1};PA.prototype.destroy=function(){return s4(this),ue(this)};function Gv(t,n){if(t._scene.completeMorphOnUserInput){t._morphHandler=new nf(t._scene.canvas);let i=function(){t._morphCancelled=!0,t._scene.camera.cancelFlight(),n(t)};t._completeMorph=i,t._morphHandler.setInputAction(i,yn.LEFT_DOWN),t._morphHandler.setInputAction(i,yn.MIDDLE_DOWN),t._morphHandler.setInputAction(i,yn.RIGHT_DOWN),t._morphHandler.setInputAction(i,yn.WHEEL)}}function s4(t){let n=t._currentTweens;for(let i=0;i<n.length;++i)n[i].cancelTween();t._currentTweens.length=0,t._morphHandler=t._morphHandler&&t._morphHandler.destroy()}var Ylt=new de,Xlt=new m,Klt=new N;function Cge(t,n){let i=t._scene,o=i.camera,r=uq,s=r.position,a=r.direction,c=r.up,l=i.mapProjection.unproject(o.position,Ylt);n.cartographicToCartesian(l,s);let u=n.scaleToGeodeticSurface(s,Xlt),d=vt.eastNorthUpToFixedFrame(u,n,Klt);return N.multiplyByPointAsVector(d,o.direction,a),N.multiplyByPointAsVector(d,o.up,c),r}var Jlt=new m,Zlt=new m,Qlt=new m,$lt=new m,eut=new m,tut=new m;function lq(t,n,i,o){n*=.5;let r=t._scene,s=r.camera,a=m.clone(s.position,Jlt),c=m.clone(s.direction,Zlt),l=m.clone(s.up,Qlt),u=N.multiplyByPoint(lo.TRANSFORM_2D_INVERSE,i.position,$lt),d=N.multiplyByPointAsVector(lo.TRANSFORM_2D_INVERSE,i.direction,eut),h=N.multiplyByPointAsVector(lo.TRANSFORM_2D_INVERSE,i.up,tut);function _(p){mf(a,u,p.time,s.position),mf(c,d,p.time,s.direction),mf(l,h,p.time,s.up),m.cross(s.direction,s.up,s.right),m.normalize(s.right,s.right)}let y=r.tweens.add({duration:n,easingFunction:Vr.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:_,complete:function(){Pge(t,r,0,1,n,o)}});t._currentTweens.push(y)}var nut=new $t,xge=new m,Tge=new m,Ege=new m,fq=new m,bge=new m,Sge=new m;function iut(t,n,i){n/=3;let o=t._scene,r=o.camera,s;n>0?(s=uq,m.fromDegrees(0,0,5*i.maximumRadius,i,s.position),m.negate(s.position,s.direction),m.normalize(s.direction,s.direction),m.clone(m.UNIT_Z,s.up)):(r.position.z=r.frustum.right-r.frustum.left,s=Cge(t,i));let a;t._morphToOrthographic?(a=nut,a.aspectRatio=o.drawingBufferWidth/o.drawingBufferHeight,a.width=r.frustum.right-r.frustum.left):(a=Age,a.aspectRatio=o.drawingBufferWidth/o.drawingBufferHeight,a.fov=B.toRadians(60)),s.frustum=a;let c=Ige(s);Gv(t,c);let l;t._morphToOrthographic?l=function(){lq(t,n,s,c)}:l=function(){Dge(t,n,s,function(){lq(t,n,s,c)})},n>0?(o._mode=ne.SCENE2D,r.flyTo({duration:n,destination:m.fromDegrees(0,0,5*i.maximumRadius,i,fq),complete:function(){o._mode=ne.MORPHING,l()}})):l()}function mf(t,n,i,o){return m.lerp(t,n,i,o)}function wge(t,n,i,o,r){let s=t._scene,a=s.camera;if(a.frustum instanceof $t)return;let c=a.frustum.fov,l=B.RADIANS_PER_DEGREE*.5,u=i.position.z*Math.tan(c*.5);a.frustum.far=u/Math.tan(l*.5)+1e7;function d(_){a.frustum.fov=B.lerp(c,l,_.time);let y=u/Math.tan(a.frustum.fov*.5);o(a,y)}let h=s.tweens.add({duration:n,easingFunction:Vr.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:d,complete:function(){a.frustum=i.frustum.clone(),r(t)}});t._currentTweens.push(h)}var out=new m,rut=new m,sut=new m,cq=new m,aut=new m,cut=new m,lut=new Br,uut=new dn,fut=new m,dut={position:void 0,direction:void 0,up:void 0,frustum:void 0};function hut(t,n){n*=.5;let i=t._scene,o=i.camera,r=m.clone(o.position,out),s=m.clone(o.direction,rut),a=m.clone(o.up,sut),c=m.negate(m.UNIT_Z,aut),l=m.clone(m.UNIT_Y,cut),u=cq;if(n>0)m.clone(m.ZERO,cq),u.z=5*i.mapProjection.ellipsoid.maximumRadius;else{m.clone(r,cq);let x=uut;N.multiplyByPoint(lo.TRANSFORM_2D,r,x.origin),N.multiplyByPointAsVector(lo.TRANSFORM_2D,s,x.direction);let T=i.globe;if(f(T)){let E=T.pickWorldCoordinates(x,i,!0,fut);f(E)&&(N.multiplyByPoint(lo.TRANSFORM_2D_INVERSE,E,u),u.z+=m.distance(r,u))}}let d=lut;d.right=u.z*.5,d.left=-d.right,d.top=d.right*(i.drawingBufferHeight/i.drawingBufferWidth),d.bottom=-d.top;let h=dut;h.position=u,h.direction=c,h.up=l,h.frustum=d;let _=Bge(h);Gv(t,_);function y(x){mf(r,u,x.time,o.position),mf(s,c,x.time,o.direction),mf(a,l,x.time,o.up),m.cross(o.direction,o.up,o.right),m.normalize(o.right,o.right),o._adjustOrthographicFrustum(!0)}function p(x,T){x.position.z=T}let C=i.tweens.add({duration:n,easingFunction:Vr.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:y,complete:function(){wge(t,n,h,p,_)}});t._currentTweens.push(C)}var yge=new de,mut={position:new m,direction:new m,up:new m,position2D:new m,direction2D:new m,up2D:new m,frustum:new Br},put={position:new m,direction:new m,up:new m,frustum:void 0},_ut=new m,gut=new dn,yut=new N,Aut=new m;function Cut(t,n,i){n*=.5;let o=t._scene,r=o.camera,s=mut;if(n>0)m.clone(m.ZERO,s.position),s.position.z=5*i.maximumRadius,m.negate(m.UNIT_Z,s.direction),m.clone(m.UNIT_Y,s.up);else{i.cartesianToCartographic(r.positionWC,yge),o.mapProjection.project(yge,s.position),m.negate(m.UNIT_Z,s.direction),m.clone(m.UNIT_Y,s.up);let h=gut;m.clone(s.position2D,h.origin);let _=m.clone(r.directionWC,h.direction),y=i.scaleToGeodeticSurface(r.positionWC,Aut),p=vt.eastNorthUpToFixedFrame(y,i,yut);N.inverseTransformation(p,p),N.multiplyByPointAsVector(p,_,_),N.multiplyByPointAsVector(lo.TRANSFORM_2D,_,_);let C=o.globe;if(f(C)){let x=C.pickWorldCoordinates(h,o,!0,_ut);if(f(x)){let T=m.distance(s.position2D,x);x.x+=T,m.clone(x,s.position2D)}}}function a(h,_){h.position.x=_}N.multiplyByPoint(lo.TRANSFORM_2D,s.position,s.position2D),N.multiplyByPointAsVector(lo.TRANSFORM_2D,s.direction,s.direction2D),N.multiplyByPointAsVector(lo.TRANSFORM_2D,s.up,s.up2D);let c=s.frustum;c.right=s.position.z*.5,c.left=-c.right,c.top=c.right*(o.drawingBufferHeight/o.drawingBufferWidth),c.bottom=-c.top;let l=put;N.multiplyByPoint(lo.TRANSFORM_2D_INVERSE,s.position2D,l.position),m.clone(s.direction,l.direction),m.clone(s.up,l.up),l.frustum=c;let u=Bge(l);Gv(t,u);function d(){wge(t,n,s,a,u)}vge(t,n,s,d)}function Dge(t,n,i,o){let r=t._scene,s=r.camera,a=s.frustum.right-s.frustum.left;s.frustum=i.frustum.clone();let c=s.frustum.fov,l=B.RADIANS_PER_DEGREE*.5,u=a*Math.tan(c*.5);s.frustum.far=u/Math.tan(l*.5)+1e7,s.frustum.fov=l;function d(_){s.frustum.fov=B.lerp(l,c,_.time),s.position.z=u/Math.tan(s.frustum.fov*.5)}let h=r.tweens.add({duration:n,easingFunction:Vr.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:d,complete:function(){o(t)}});t._currentTweens.push(h)}function xut(t,n,i,o){n*=.5;let r=t._scene,s=r.camera,a=m.clone(i.position,fq),c=m.clone(i.direction,bge),l=m.clone(i.up,Sge);r._mode=ne.MORPHING;function u(){s.frustum=i.frustum.clone();let d=m.clone(s.position,xge),h=m.clone(s.direction,Tge),_=m.clone(s.up,Ege);d.z=a.z;function y(C){mf(d,a,C.time,s.position),mf(h,c,C.time,s.direction),mf(_,l,C.time,s.up),m.cross(s.direction,s.up,s.right),m.normalize(s.right,s.right)}let p=r.tweens.add({duration:n,easingFunction:Vr.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:y,complete:function(){o(t)}});t._currentTweens.push(p)}t._morphToOrthographic?u():Dge(t,0,i,u)}function vge(t,n,i,o){let r=t._scene,s=r.camera,a=m.clone(s.position,xge),c=m.clone(s.direction,Tge),l=m.clone(s.up,Ege),u=m.clone(i.position2D,fq),d=m.clone(i.direction2D,bge),h=m.clone(i.up2D,Sge);function _(p){mf(a,u,p.time,s.position),mf(c,d,p.time,s.direction),mf(l,h,p.time,s.up),m.cross(s.direction,s.up,s.right),m.normalize(s.right,s.right),s._adjustOrthographicFrustum(!0)}let y=r.tweens.add({duration:n,easingFunction:Vr.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:_,complete:function(){Pge(t,r,1,0,n,o)}});t._currentTweens.push(y)}function Pge(t,n,i,o,r,s){let a={object:n,property:"morphTime",startValue:i,stopValue:o,duration:r,easingFunction:Vr.QUARTIC_OUT};f(s)&&(a.complete=function(){s(t)});let c=n.tweens.addProperty(a);t._currentTweens.push(c)}function Ige(t){return function(n){let i=n._scene;i._mode=ne.SCENE3D,i.morphTime=ne.getMorphTime(ne.SCENE3D),s4(n);let o=i.camera;(n._previousMode!==ne.MORPHING||n._morphCancelled)&&(n._morphCancelled=!1,m.clone(t.position,o.position),m.clone(t.direction,o.direction),m.clone(t.up,o.up),m.cross(o.direction,o.up,o.right),m.normalize(o.right,o.right),o.frustum=t.frustum.clone());let r=o.frustum;i.frameState.useLogDepth&&(r.near=.1,r.far=1e10);let s=f(n._completeMorph);n._completeMorph=void 0,i.camera.update(i.mode),n._scene.morphComplete.raiseEvent(n,n._previousMode,ne.SCENE3D,s)}}function Bge(t){return function(n){let i=n._scene;i._mode=ne.SCENE2D,i.morphTime=ne.getMorphTime(ne.SCENE2D),s4(n);let o=i.camera;m.clone(t.position,o.position),o.position.z=i.mapProjection.ellipsoid.maximumRadius*2,m.clone(t.direction,o.direction),m.clone(t.up,o.up),m.cross(o.direction,o.up,o.right),m.normalize(o.right,o.right),o.frustum=t.frustum.clone();let r=f(n._completeMorph);n._completeMorph=void 0,i.camera.update(i.mode),n._scene.morphComplete.raiseEvent(n,n._previousMode,ne.SCENE2D,r)}}function Tut(t){return function(n){let i=n._scene;i._mode=ne.COLUMBUS_VIEW,i.morphTime=ne.getMorphTime(ne.COLUMBUS_VIEW),s4(n);let o=i.camera;(n._previousModeMode!==ne.MORPHING||n._morphCancelled)&&(n._morphCancelled=!1,m.clone(t.position,o.position),m.clone(t.direction,o.direction),m.clone(t.up,o.up),m.cross(o.direction,o.up,o.right),m.normalize(o.right,o.right));let r=o.frustum;i.frameState.useLogDepth&&(r.near=.1,r.far=1e10);let s=f(n._completeMorph);n._completeMorph=void 0,i.camera.update(i.mode),n._scene.morphComplete.raiseEvent(n,n._previousMode,ne.COLUMBUS_VIEW,s)}}var a4=PA;function c4(t,n,i,o,r,s,a,c,l,u){this._tweens=t,this._tweenjs=n,this._startObject=tt(i),this._stopObject=tt(o),this._duration=r,this._delay=s,this._easingFunction=a,this._update=c,this._complete=l,this.cancel=u,this.needsStart=!0}Object.defineProperties(c4.prototype,{startObject:{get:function(){return this._startObject}},stopObject:{get:function(){return this._stopObject}},duration:{get:function(){return this._duration}},delay:{get:function(){return this._delay}},easingFunction:{get:function(){return this._easingFunction}},update:{get:function(){return this._update}},complete:{get:function(){return this._complete}},tweenjs:{get:function(){return this._tweenjs}}});c4.prototype.cancelTween=function(){this._tweens.remove(this)};function wd(){this._tweens=[]}Object.defineProperties(wd.prototype,{length:{get:function(){return this._tweens.length}}});wd.prototype.add=function(t){if(t=A(t,A.EMPTY_OBJECT),t.duration===0)return f(t.complete)&&t.complete(),new c4(this);let n=t.duration/Yn.SECONDS_PER_MILLISECOND,i=A(t.delay,0),o=i/Yn.SECONDS_PER_MILLISECOND,r=A(t.easingFunction,Vr.LINEAR_NONE),s=t.startObject,a=new ife(s);a.to(tt(t.stopObject),n),a.delay(o),a.easing(r),f(t.update)&&a.onUpdate(function(){t.update(s)}),a.onComplete(A(t.complete,null)),a.repeat(A(t._repeat,0));let c=new c4(this,a,t.startObject,t.stopObject,t.duration,i,r,t.update,t.complete,t.cancel);return this._tweens.push(c),c};wd.prototype.addProperty=function(t){t=A(t,A.EMPTY_OBJECT);let n=t.object,i=t.property,o=t.startValue,r=t.stopValue;function s(a){n[i]=a.value}return this.add({startObject:{value:o},stopObject:{value:r},duration:A(t.duration,3),delay:t.delay,easingFunction:t.easingFunction,update:s,complete:t.complete,cancel:t.cancel,_repeat:t._repeat})};wd.prototype.addAlpha=function(t){t=A(t,A.EMPTY_OBJECT);let n=t.material,i=[];for(let r in n.uniforms)n.uniforms.hasOwnProperty(r)&&f(n.uniforms[r])&&f(n.uniforms[r].alpha)&&i.push(r);function o(r){let s=i.length;for(let a=0;a<s;++a)n.uniforms[i[a]].alpha=r.alpha}return this.add({startObject:{alpha:A(t.startValue,0)},stopObject:{alpha:A(t.stopValue,1)},duration:A(t.duration,3),delay:t.delay,easingFunction:t.easingFunction,update:o,complete:t.complete,cancel:t.cancel})};wd.prototype.addOffsetIncrement=function(t){t=A(t,A.EMPTY_OBJECT);let i=t.material.uniforms;return this.addProperty({object:i,property:"offset",startValue:i.offset,stopValue:i.offset+1,duration:t.duration,delay:t.delay,easingFunction:t.easingFunction,update:t.update,cancel:t.cancel,_repeat:1/0})};wd.prototype.remove=function(t){if(!f(t))return!1;let n=this._tweens.indexOf(t);return n!==-1?(t.tweenjs.stop(),f(t.cancel)&&t.cancel(),this._tweens.splice(n,1),!0):!1};wd.prototype.removeAll=function(){let t=this._tweens;for(let n=0;n<t.length;++n){let i=t[n];i.tweenjs.stop(),f(i.cancel)&&i.cancel()}t.length=0};wd.prototype.contains=function(t){return f(t)&&this._tweens.indexOf(t)!==-1};wd.prototype.get=function(t){return this._tweens[t]};wd.prototype.update=function(t){let n=this._tweens,i=0;for(t=f(t)?t/Yn.SECONDS_PER_MILLISECOND:Fi();i<n.length;){let o=n[i],r=o.tweenjs;o.needsStart?(o.needsStart=!1,r.start(t)):r.update(t)?i++:(r.stop(),n.splice(i,1))}};var nb=wd;function jv(t){this.enableInputs=!0,this.enableTranslate=!0,this.enableZoom=!0,this.enableRotate=!0,this.enableTilt=!0,this.enableLook=!0,this.inertiaSpin=.9,this.inertiaTranslate=.9,this.inertiaZoom=.8,this.maximumMovementRatio=.1,this.bounceAnimationTime=3,this.minimumZoomDistance=1,this.maximumZoomDistance=Number.POSITIVE_INFINITY,this.translateEventTypes=Pi.LEFT_DRAG,this.zoomEventTypes=[Pi.RIGHT_DRAG,Pi.WHEEL,Pi.PINCH],this.rotateEventTypes=Pi.LEFT_DRAG,this.tiltEventTypes=[Pi.MIDDLE_DRAG,Pi.PINCH,{eventType:Pi.LEFT_DRAG,modifier:aa.CTRL},{eventType:Pi.RIGHT_DRAG,modifier:aa.CTRL}],this.lookEventTypes={eventType:Pi.LEFT_DRAG,modifier:aa.SHIFT},this.minimumPickingTerrainHeight=15e4,this._minimumPickingTerrainHeight=this.minimumPickingTerrainHeight,this.minimumCollisionTerrainHeight=15e3,this._minimumCollisionTerrainHeight=this.minimumCollisionTerrainHeight,this.minimumTrackBallHeight=75e5,this._minimumTrackBallHeight=this.minimumTrackBallHeight,this.enableCollisionDetection=!0,this._scene=t,this._globe=void 0,this._ellipsoid=void 0,this._aggregator=new sk(t.canvas),this._lastInertiaSpinMovement=void 0,this._lastInertiaZoomMovement=void 0,this._lastInertiaTranslateMovement=void 0,this._lastInertiaTiltMovement=void 0,this._inertiaDisablers={_lastInertiaZoomMovement:["_lastInertiaSpinMovement","_lastInertiaTranslateMovement","_lastInertiaTiltMovement"],_lastInertiaTiltMovement:["_lastInertiaSpinMovement","_lastInertiaTranslateMovement"]},this._tweens=new nb,this._tween=void 0,this._horizontalRotationAxis=void 0,this._tiltCenterMousePosition=new W(-1,-1),this._tiltCenter=new m,this._rotateMousePosition=new W(-1,-1),this._rotateStartPosition=new m,this._strafeStartPosition=new m,this._strafeMousePosition=new W,this._strafeEndMousePosition=new W,this._zoomMouseStart=new W(-1,-1),this._zoomWorldPosition=new m,this._useZoomWorldPosition=!1,this._tiltCVOffMap=!1,this._looking=!1,this._rotating=!1,this._strafing=!1,this._zoomingOnVector=!1,this._zoomingUnderground=!1,this._rotatingZoom=!1,this._adjustedHeightForTerrain=!1,this._cameraUnderground=!1;let n=t.mapProjection;this._maxCoord=n.project(new de(Math.PI,B.PI_OVER_TWO)),this._zoomFactor=5,this._rotateFactor=void 0,this._rotateRateRangeAdjustment=void 0,this._maximumRotateRate=1.77,this._minimumRotateRate=1/5e3,this._minimumZoomRate=20,this._maximumZoomRate=5906376272e3,this._minimumUndergroundPickDistance=2e3,this._maximumUndergroundPickDistance=1e4}function Eut(t,n){if(t<0)return 0;let i=(1-n)*25;return Math.exp(-i*t)}function but(t){return W.equalsEpsilon(t.startPosition,t.endPosition,B.EPSILON14)}var Sut=.4;function wut(t,n,i,o,r,s,a){let c=s[a];f(c)||(c=s[a]={startPosition:new W,endPosition:new W,motion:new W,inertiaEnabled:!0});let l=t.getButtonPressTime(n,i),u=t.getButtonReleaseTime(n,i),d=l&&u&&(u.getTime()-l.getTime())/1e3,h=new Date,_=u&&(h.getTime()-u.getTime())/1e3;if(l&&u&&d<Sut){let y=Eut(_,o),p=t.getLastMovement(n,i);if(!f(p)||but(p)||!c.inertiaEnabled||(c.motion.x=(p.endPosition.x-p.startPosition.x)*.5,c.motion.y=(p.endPosition.y-p.startPosition.y)*.5,c.startPosition=W.clone(p.startPosition,c.startPosition),c.endPosition=W.multiplyByScalar(c.motion,y,c.endPosition),c.endPosition=W.add(c.startPosition,c.endPosition,c.endPosition),isNaN(c.endPosition.x)||isNaN(c.endPosition.y)||W.distance(c.startPosition,c.endPosition)<.5))return;if(!t.isButtonDown(n,i)){let C=t.getStartMousePosition(n,i);r(s,C,c)}}}function Dut(t,n){if(f(n)){let i=t[n];f(i)&&(i.inertiaEnabled=!0);let o=t._inertiaDisablers[n];if(f(o)){let r=o.length;for(let s=0;s<r;++s)i=t[o[s]],f(i)&&(i.inertiaEnabled=!1)}}}var Oge=[];function Pc(t,n,i,o,r,s){if(!f(i))return;let a=t._aggregator;Array.isArray(i)||(Oge[0]=i,i=Oge);let c=i.length;for(let l=0;l<c;++l){let u=i[l],d=f(u.eventType)?u.eventType:u,h=u.modifier,_=a.isMoving(d,h)&&a.getMovement(d,h),y=a.getStartMousePosition(d,h);t.enableInputs&&n&&(_?(o(t,y,_),Dut(t,s)):r<1&&wut(a,d,h,r,o,t,s))}}var l4=new dn,vut=new m,Put=new W,Iut=new m,But=new W,Out=new m,Rut=new m,Mut=new m,Lut=new m,Fut=new m,Nut=new m,Vut=new m,kut=new m,Uut=new m,zut=new m,Hut=new m,Gut=new m,Wut=new m,jut=new m,qut=new m,IA=new m,Rge=new m,Mge=new m,dq={orientation:new yl};function Cq(t,n,i,o,r,s){let a=1;f(s)&&(a=B.clamp(Math.abs(s),.25,1));let c=i.endPosition.y-i.startPosition.y,u=c>0?t.minimumZoomDistance*a:0,d=t.maximumZoomDistance,h=r-u,_=o*h;_=B.clamp(_,t._minimumZoomRate,t._maximumZoomRate);let y=c/t._scene.canvas.clientHeight;y=Math.min(y,t.maximumMovementRatio);let p=_*y;if(t.enableCollisionDetection||t.minimumZoomDistance===0||!f(t._globe)){if(p>0&&Math.abs(r-u)<1||p<0&&Math.abs(r-d)<1)return;r-p<u?p=r-u-1:r-p>d&&(p=r-d)}let C=t._scene,x=C.camera,T=C.mode,E=dq.orientation;if(E.heading=x.heading,E.pitch=x.pitch,E.roll=x.roll,x.frustum instanceof $t){Math.abs(p)>0&&(x.zoomIn(p),x._adjustOrthographicFrustum());return}let S=W.equals(n,t._zoomMouseStart),w=t._zoomingOnVector,D=t._rotatingZoom,I;if(S||(t._zoomMouseStart=W.clone(n,t._zoomMouseStart),f(t._globe)&&(T===ne.SCENE2D?(I=x.getPickRay(n,l4).origin,I=m.fromElements(I.y,I.z,I.x)):I=n0(t,n,vut)),f(I)?(t._useZoomWorldPosition=!0,t._zoomWorldPosition=m.clone(I,t._zoomWorldPosition)):t._useZoomWorldPosition=!1,w=t._zoomingOnVector=!1,D=t._rotatingZoom=!1,t._zoomingUnderground=t._cameraUnderground),!t._useZoomWorldPosition){x.zoomIn(p);return}let O=T===ne.COLUMBUS_VIEW;if(x.positionCartographic.height<2e6&&(D=!0),!S||D){if(T===ne.SCENE2D){let M=t._zoomWorldPosition,L=x.position;if(!m.equals(M,L)&&x.positionCartographic.height<t._maxCoord.x*2){let F=x.position.x,g=m.subtract(M,L,Iut);m.normalize(g,g);let b=m.distance(M,L)*p/(x.getMagnitude()*.5);x.move(g,b*.5),(x.position.x<0&&F>0||x.position.x>0&&F<0)&&(I=x.getPickRay(n,l4).origin,I=m.fromElements(I.y,I.z,I.x),t._zoomWorldPosition=m.clone(I,t._zoomWorldPosition))}}else if(T===ne.SCENE3D){let M=m.normalize(x.position,Fut);if(t._cameraUnderground||t._zoomingUnderground||x.positionCartographic.height<3e3&&Math.abs(m.dot(x.direction,M))<.6)O=!0;else{let L=C.canvas,F=But;F.x=L.clientWidth/2,F.y=L.clientHeight/2;let g=n0(t,F,Out);if(!f(g))O=!0;else if(x.positionCartographic.height<1e6)if(m.dot(x.direction,M)>=-.5)O=!0;else{let b=Vut;m.clone(x.position,b);let v=t._zoomWorldPosition,P=Nut;if(P=m.normalize(v,P),m.dot(P,M)<0)return;let R=qut,V=zut;m.clone(x.direction,V),m.add(b,m.multiplyByScalar(V,1e3,IA),R);let H=Hut,U=Gut;m.subtract(v,b,H),m.normalize(H,U);let G=m.dot(M,U);if(G>=0){t._zoomMouseStart.x=-1;return}let k=Math.acos(-G),X=m.magnitude(b),Y=m.magnitude(v),K=X-p,j=m.magnitude(H),Z=Math.asin(B.clamp(j/Y*Math.sin(k),-1,1)),Q=Math.asin(B.clamp(K/Y*Math.sin(k),-1,1)),me=Z-Q+k,_e=kut;m.normalize(b,_e);let re=Uut;re=m.cross(U,_e,re),re=m.normalize(re,re),m.normalize(m.cross(_e,re,IA),V),m.multiplyByScalar(m.normalize(R,IA),m.magnitude(R)-p,R),m.normalize(b,b),m.multiplyByScalar(b,K,b);let fe=Wut;m.multiplyByScalar(m.add(m.multiplyByScalar(_e,Math.cos(me)-1,Rge),m.multiplyByScalar(V,Math.sin(me),Mge),IA),K,fe),m.add(b,fe,b),m.normalize(R,_e),m.normalize(m.cross(_e,re,IA),V);let ge=jut;m.multiplyByScalar(m.add(m.multiplyByScalar(_e,Math.cos(me)-1,Rge),m.multiplyByScalar(V,Math.sin(me),Mge),IA),m.magnitude(R),ge),m.add(R,ge,R),m.clone(b,x.position),m.normalize(m.subtract(R,b,IA),x.direction),m.clone(x.direction,x.direction),m.cross(x.direction,x.up,x.right),m.cross(x.right,x.direction,x.up),x.setView(dq);return}else{let b=m.normalize(g,Rut),v=m.normalize(t._zoomWorldPosition,Mut),P=m.dot(v,b);if(P>0&&P<1){let R=B.acosClamped(P),V=m.cross(v,b,Lut),H=Math.abs(R)>B.toRadians(20)?x.positionCartographic.height*.75:x.positionCartographic.height-p,U=p/H;x.rotate(V,R*U)}}}}t._rotatingZoom=!O}if(!S&&O||w){let M,L=Yi.wgs84ToWindowCoordinates(C,t._zoomWorldPosition,Put);T!==ne.COLUMBUS_VIEW&&W.equals(n,t._zoomMouseStart)&&f(L)?M=x.getPickRay(L,l4):M=x.getPickRay(n,l4);let F=M.direction;(T===ne.COLUMBUS_VIEW||T===ne.SCENE2D)&&m.fromElements(F.y,F.z,F.x,F),x.move(F,p),t._zoomingOnVector=!0}else x.zoomIn(p);t._cameraUnderground||x.setView(dq)}var Yut=new dn,Xut=new dn,Kut=new m;function Jut(t,n,i){let r=t._scene.camera,s=r.getPickRay(i.startPosition,Yut).origin,a=r.getPickRay(i.endPosition,Xut).origin;s=m.fromElements(s.y,s.z,s.x,s),a=m.fromElements(a.y,a.z,a.x,a);let c=m.subtract(s,a,Kut),l=m.magnitude(c);l>0&&(m.normalize(c,c),r.move(c,l))}function Lge(t,n,i){f(i.distance)&&(i=i.distance);let r=t._scene.camera;Cq(t,n,i,t._zoomFactor,r.getMagnitude())}var Zut=new W,Qut=new W;function Fge(t,n,i){if(f(i.angleAndHeight)){$ut(t,n,i.angleAndHeight);return}let o=t._scene,r=o.camera,s=o.canvas,a=s.clientWidth,c=s.clientHeight,l=Zut;l.x=2/a*i.startPosition.x-1,l.y=2/c*(c-i.startPosition.y)-1,l=W.normalize(l,l);let u=Qut;u.x=2/a*i.endPosition.x-1,u.y=2/c*(c-i.endPosition.y)-1,u=W.normalize(u,u);let d=B.acosClamped(l.x);l.y<0&&(d=B.TWO_PI-d);let h=B.acosClamped(u.x);u.y<0&&(h=B.TWO_PI-h);let _=h-d;r.twistRight(_)}function $ut(t,n,i){let o=t._rotateFactor*t._rotateRateRangeAdjustment;o>t._maximumRotateRate&&(o=t._maximumRotateRate),o<t._minimumRotateRate&&(o=t._minimumRotateRate);let r=t._scene,s=r.camera,a=r.canvas,c=(i.endPosition.x-i.startPosition.x)/a.clientWidth;c=Math.min(c,t.maximumMovementRatio);let l=o*c*Math.PI*4;s.twistRight(l)}function eft(t){let n=t._scene.mapMode2D===Zl.ROTATE;N.equals(N.IDENTITY,t._scene.camera.transform)?(Pc(t,t.enableTranslate,t.translateEventTypes,Jut,t.inertiaTranslate,"_lastInertiaTranslateMovement"),Pc(t,t.enableZoom,t.zoomEventTypes,Lge,t.inertiaZoom,"_lastInertiaZoomMovement"),n&&Pc(t,t.enableRotate,t.tiltEventTypes,Fge,t.inertiaSpin,"_lastInertiaTiltMovement")):(Pc(t,t.enableZoom,t.zoomEventTypes,Lge,t.inertiaZoom,"_lastInertiaZoomMovement"),n&&Pc(t,t.enableRotate,t.translateEventTypes,Fge,t.inertiaSpin,"_lastInertiaSpinMovement"))}var zge=new dn,tft=new m,nft=new m;function n0(t,n,i){let o=t._scene,r=t._globe,s=o.camera;if(!f(r))return;let a=!t._cameraUnderground,c;o.pickPositionSupported&&(c=o.pickPositionWorldCoordinates(n,tft));let l=s.getPickRay(n,zge),u=r.pickWorldCoordinates(l,o,a,nft),d=f(c)?m.distance(c,s.positionWC):Number.POSITIVE_INFINITY,h=f(u)?m.distance(u,s.positionWC):Number.POSITIVE_INFINITY;return d<h?m.clone(c,i):m.clone(u,i)}var ift=new de;function p4(t){let n=t._ellipsoid,i=t._scene,o=i.camera,r=i.mode,s=0;if(r===ne.SCENE3D){let l=n.cartesianToCartographic(o.position,ift);f(l)&&(s=l.height)}else s=o.position.z;let a=A(t._scene.globeHeight,0);return Math.abs(a-s)}var oft=new m;function Hge(t,n){let i=n.origin,o=n.direction,r=p4(t),s=m.normalize(i,oft),a=Math.abs(m.dot(s,o));return a=Math.max(a,.5)*2,r*a}function Gge(t,n,i,o){let r=m.distance(n.origin,i),s=p4(t),a=B.clamp(s*5,t._minimumUndergroundPickDistance,t._maximumUndergroundPickDistance);return r>a&&(r=Math.min(r,s/5),r=Math.max(r,100)),dn.getPoint(n,r,o)}function Wge(t,n,i,o){let r;return f(i)?(r=m.distance(n.origin,i),r>t._maximumUndergroundPickDistance&&(r=p4(t))):r=p4(t),dn.getPoint(n,r,o)}var rft=new W;function jge(t,n){let i=n.endPosition,o=W.subtract(n.endPosition,n.startPosition,rft),r=t._strafeEndMousePosition;W.add(r,o,r),n.endPosition=r,xq(t,n,t._strafeStartPosition),n.endPosition=i}var Nge=new dn,sft=new dn,hq=new m,aft=new m,cft=new m,lft=new m,uft=new rn(m.UNIT_X,0),fft=new W,dft=new W;function hft(t,n,i){if(m.equals(n,t._translateMousePosition)||(t._looking=!1),m.equals(n,t._strafeMousePosition)||(t._strafing=!1),t._looking){ou(t,n,i);return}if(t._strafing){jge(t,i);return}let r=t._scene.camera,s=t._cameraUnderground,a=W.clone(i.startPosition,fft),c=W.clone(i.endPosition,dft),l=r.getPickRay(a,Nge),u=m.clone(m.ZERO,lft),d=m.UNIT_X,h;if(r.position.z<t._minimumPickingTerrainHeight&&(h=n0(t,a,hq),f(h)&&(u.x=h.x)),s||u.x>r.position.z&&f(h)){let S=h;s&&(S=Wge(t,l,h,hq)),W.clone(n,t._strafeMousePosition),W.clone(n,t._strafeEndMousePosition),m.clone(S,t._strafeStartPosition),t._strafing=!0,xq(t,i,t._strafeStartPosition);return}let _=rn.fromPointNormal(u,d,uft);l=r.getPickRay(a,Nge);let y=ji.rayPlane(l,_,hq),p=r.getPickRay(c,sft),C=ji.rayPlane(p,_,aft);if(!f(y)||!f(C)){t._looking=!0,ou(t,n,i),W.clone(n,t._translateMousePosition);return}let x=m.subtract(y,C,cft),T=x.x;x.x=x.y,x.y=x.z,x.z=T;let E=m.magnitude(x);E>B.EPSILON6&&(m.normalize(x,x),r.move(x,E))}var qge=new W,f4=new dn,d4=new m,mft=new m,Yge=new N,pft=new N,_ft=new m,gft=new rn(m.UNIT_X,0),mq=new m,gq=new de,Xge=new N,yft=new Me,Aft=new $,h4=new m;function Cft(t,n,i){if(f(i.angleAndHeight)&&(i=i.angleAndHeight),W.equals(n,t._tiltCenterMousePosition)||(t._tiltCVOffMap=!1,t._looking=!1),t._looking){ou(t,n,i);return}let r=t._scene.camera;t._tiltCVOffMap||!t.onMap()||Math.abs(r.position.z)>t._minimumPickingTerrainHeight?(t._tiltCVOffMap=!0,xft(t,n,i)):Tft(t,n,i)}function xft(t,n,i){let o=t._scene,r=o.camera,s=o.canvas,a=qge;a.x=s.clientWidth/2,a.y=s.clientHeight/2;let c=r.getPickRay(a,f4),l=m.UNIT_X,u=c.origin,d=c.direction,h,_=m.dot(l,d);if(Math.abs(_)>B.EPSILON6&&(h=-m.dot(l,u)/_),!f(h)||h<=0){t._looking=!0,ou(t,n,i),W.clone(n,t._tiltCenterMousePosition);return}let y=m.multiplyByScalar(d,h,d4);m.add(u,y,y);let p=o.mapProjection,C=p.ellipsoid;m.fromElements(y.y,y.z,y.x,y);let x=p.unproject(y,gq);C.cartographicToCartesian(x,y);let T=vt.eastNorthUpToFixedFrame(y,C,Yge),E=t._globe,S=t._ellipsoid;t._globe=void 0,t._ellipsoid=oe.UNIT_SPHERE,t._rotateFactor=1,t._rotateRateRangeAdjustment=1;let w=N.clone(r.transform,Xge);r._setTransform(T),iu(t,n,i,m.UNIT_Z),r._setTransform(w),t._globe=E,t._ellipsoid=S;let D=S.maximumRadius;t._rotateFactor=1/D,t._rotateRateRangeAdjustment=D}function Tft(t,n,i){let o=t._scene,r=o.camera,s=t._cameraUnderground,a,c,l=m.UNIT_X;if(W.equals(n,t._tiltCenterMousePosition))a=m.clone(t._tiltCenter,d4);else{if(r.position.z<t._minimumPickingTerrainHeight&&(a=n0(t,n,d4)),!f(a)){c=r.getPickRay(n,f4);let g=c.origin,b=c.direction,v,P=m.dot(l,b);if(Math.abs(P)>B.EPSILON6&&(v=-m.dot(l,g)/P),!f(v)||v<=0){t._looking=!0,ou(t,n,i),W.clone(n,t._tiltCenterMousePosition);return}a=m.multiplyByScalar(b,v,d4),m.add(g,a,a)}s&&(f(c)||(c=r.getPickRay(n,f4)),Gge(t,c,a,a)),W.clone(n,t._tiltCenterMousePosition),m.clone(a,t._tiltCenter)}let u=o.canvas,d=qge;d.x=u.clientWidth/2,d.y=t._tiltCenterMousePosition.y,c=r.getPickRay(d,f4);let h=m.clone(m.ZERO,_ft);h.x=a.x;let _=rn.fromPointNormal(h,l,gft),y=ji.rayPlane(c,_,mft),p=r._projection,C=p.ellipsoid;m.fromElements(a.y,a.z,a.x,a);let x=p.unproject(a,gq);C.cartographicToCartesian(x,a);let T=vt.eastNorthUpToFixedFrame(a,C,Yge),E;f(y)?(m.fromElements(y.y,y.z,y.x,y),x=p.unproject(y,gq),C.cartographicToCartesian(x,y),E=vt.eastNorthUpToFixedFrame(y,C,pft)):E=T;let S=t._globe,w=t._ellipsoid;t._globe=void 0,t._ellipsoid=oe.UNIT_SPHERE,t._rotateFactor=1,t._rotateRateRangeAdjustment=1;let D=m.UNIT_Z,I=N.clone(r.transform,Xge);r._setTransform(T);let O=m.cross(m.UNIT_Z,m.normalize(r.position,mq),mq),M=m.dot(r.right,O);if(iu(t,n,i,D,!1,!0),r._setTransform(E),M<0){let g=i.startPosition.y-i.endPosition.y;(s&&g<0||!s&&g>0)&&(D=void 0);let b=r.constrainedAxis;r.constrainedAxis=void 0,iu(t,n,i,D,!0,!1),r.constrainedAxis=b}else iu(t,n,i,D,!0,!1);if(f(r.constrainedAxis)){let g=m.cross(r.direction,r.constrainedAxis,h4);m.equalsEpsilon(g,m.ZERO,B.EPSILON6)||(m.dot(g,r.right)<0&&m.negate(g,g),m.cross(g,r.direction,r.up),m.cross(r.direction,r.up,r.right),m.normalize(r.up,r.up),m.normalize(r.right,r.right))}r._setTransform(I),t._globe=S,t._ellipsoid=w;let L=w.maximumRadius;t._rotateFactor=1/L,t._rotateRateRangeAdjustment=L;let F=m.clone(r.positionWC,mq);if(t.enableCollisionDetection&&bq(t),!m.equals(r.positionWC,F)){r._setTransform(E),r.worldToCameraCoordinatesPoint(F,F);let g=m.magnitudeSquared(F);m.magnitudeSquared(r.position)>g&&(m.normalize(r.position,r.position),m.multiplyByScalar(r.position,Math.sqrt(g),r.position));let b=m.angleBetween(F,r.position),v=m.cross(F,r.position,F);m.normalize(v,v);let P=Me.fromAxisAngle(v,b,yft),R=$.fromQuaternion(P,Aft);$.multiplyByVector(R,r.direction,r.direction),$.multiplyByVector(R,r.up,r.up),m.cross(r.direction,r.up,r.right),m.cross(r.right,r.direction,r.up),r._setTransform(I)}}var Kge=new W,Jge=new dn,Zge=new m;function Eft(t,n,i){f(i.distance)&&(i=i.distance);let o=t._scene,r=o.camera,s=o.canvas,a=t._cameraUnderground,c;a?c=n:(c=Kge,c.x=s.clientWidth/2,c.y=s.clientHeight/2);let l=r.getPickRay(c,Jge),u=l.origin,d=l.direction,h=r.position.z,_;h<t._minimumPickingTerrainHeight&&(_=n0(t,c,Zge));let y;if(f(_)&&(y=m.distance(u,_)),a){let p=Hge(t,l,h);f(y)?y=Math.min(y,p):y=p}if(!f(y)){let p=m.UNIT_X;y=-m.dot(p,u)/m.dot(p,d)}Cq(t,n,i,t._zoomFactor,y)}function bft(t){let i=t._scene.camera;if(!N.equals(N.IDENTITY,i.transform))Pc(t,t.enableRotate,t.rotateEventTypes,iu,t.inertiaSpin,"_lastInertiaSpinMovement"),Pc(t,t.enableZoom,t.zoomEventTypes,Qge,t.inertiaZoom,"_lastInertiaZoomMovement");else{let o=t._tweens;if(t._aggregator.anyButtonDown&&o.removeAll(),Pc(t,t.enableTilt,t.tiltEventTypes,Cft,t.inertiaSpin,"_lastInertiaTiltMovement"),Pc(t,t.enableTranslate,t.translateEventTypes,hft,t.inertiaTranslate,"_lastInertiaTranslateMovement"),Pc(t,t.enableZoom,t.zoomEventTypes,Eft,t.inertiaZoom,"_lastInertiaZoomMovement"),Pc(t,t.enableLook,t.lookEventTypes,ou),!t._aggregator.anyButtonDown&&!o.contains(t._tween)){let r=i.createCorrectPositionTween(t.bounceAnimationTime);f(r)&&(t._tween=o.add(r))}o.update()}}var Sft=new dn,wft=new rn(m.UNIT_X,0),Dft=new m,vft=new m,Pft=new m;function xq(t,n,i){let o=t._scene,r=o.camera,s=r.getPickRay(n.endPosition,Sft),a=m.clone(r.direction,vft);o.mode===ne.COLUMBUS_VIEW&&m.fromElements(a.z,a.x,a.y,a);let c=rn.fromPointNormal(i,a,wft),l=ji.rayPlane(s,c,Dft);!f(l)||(a=m.subtract(i,l,a),o.mode===ne.COLUMBUS_VIEW&&m.fromElements(a.y,a.z,a.x,a),m.add(r.position,a,r.position))}var Vge=new m,Ift=new de,yq=new m,Aq=new oe,Bft=new m,Oft=new m;function Rft(t,n,i){n.x=n.x/xt.canvasScale.x,n.y=n.y/xt.canvasScale.y;let r=t._scene.camera,s=t._cameraUnderground,a=t._ellipsoid;if(!N.equals(r.transform,N.IDENTITY)){iu(t,n,i);return}let c,l,u=a.geodeticSurfaceNormal(r.position,Bft);if(W.equals(n,t._rotateMousePosition)){if(t._looking)ou(t,n,i,u);else if(t._rotating)iu(t,n,i);else if(t._strafing)jge(t,i);else{if(m.magnitude(r.position)<m.magnitude(t._rotateStartPosition))return;c=m.magnitude(t._rotateStartPosition),l=yq,l.x=l.y=l.z=c,a=oe.fromCartesian3(l,Aq),_q(t,n,i,a)}return}t._looking=!1,t._rotating=!1,t._strafing=!1;let d=a.cartesianToCartographic(r.positionWC,Ift).height,h=t._globe;if(f(h)&&d<t._minimumPickingTerrainHeight){let _=n0(t,i.startPosition,Pft);if(f(_)){let y=!1,p=r.getPickRay(i.startPosition,zge);if(s)y=!0,Wge(t,p,_,_);else{let C=a.geodeticSurfaceNormal(_,Oft);Math.abs(m.dot(p.direction,C))<.05?y=!0:y=m.magnitude(r.position)<m.magnitude(_)}y?(W.clone(n,t._strafeEndMousePosition),m.clone(_,t._strafeStartPosition),t._strafing=!0,xq(t,i,t._strafeStartPosition)):(c=m.magnitude(_),l=yq,l.x=l.y=l.z=c,a=oe.fromCartesian3(l,Aq),_q(t,n,i,a),m.clone(_,t._rotateStartPosition))}else t._looking=!0,ou(t,n,i,u)}else f(r.pickEllipsoid(i.startPosition,t._ellipsoid,Vge))?(_q(t,n,i,t._ellipsoid),m.clone(Vge,t._rotateStartPosition)):d>t._minimumTrackBallHeight?(t._rotating=!0,iu(t,n,i)):(t._looking=!0,ou(t,n,i,u));W.clone(n,t._rotateMousePosition)}function iu(t,n,i,o,r,s){r=A(r,!1),s=A(s,!1);let a=t._scene,c=a.camera,l=a.canvas;if(c._kmap_limit_pitch&&(c.pitch>B.toRadians(c._kmap_limit_pitch[1])&&i.startPosition.y>i.endPosition.y||c.pitch<B.toRadians(c._kmap_limit_pitch[0])&&i.startPosition.y<i.endPosition.y))return;let u=c.constrainedAxis;f(o)&&(c.constrainedAxis=o);let d=m.magnitude(c.position),h=t._rotateFactor*(d-t._rotateRateRangeAdjustment);h>t._maximumRotateRate&&(h=t._maximumRotateRate),h<t._minimumRotateRate&&(h=t._minimumRotateRate);let _=(i.startPosition.x-i.endPosition.x)/l.clientWidth,y=(i.startPosition.y-i.endPosition.y)/l.clientHeight;_=Math.min(_,t.maximumMovementRatio),y=Math.min(y,t.maximumMovementRatio);let p=h*_*Math.PI*2,C=h*y*Math.PI;r||c.rotateRight(p),s||c.rotateUp(C),c.constrainedAxis=u}var Mft=se.clone(se.UNIT_W),Lft=se.clone(se.UNIT_W),u4=new m,pq=new m,Fft=new m,Nft=new m,Vft=new W,kft=new W;function _q(t,n,i,o){n.x=n.x/xt.canvasScale.x,n.y=n.y/xt.canvasScale.y,i.startPosition.x=i.startPosition.x/xt.canvasScale.x,i.startPosition.y=i.startPosition.y/xt.canvasScale.y,i.endPosition.x=i.endPosition.x/xt.canvasScale.x,i.endPosition.y=i.endPosition.y/xt.canvasScale.y;let s=t._scene.camera,a=W.clone(i.startPosition,Vft),c=W.clone(i.endPosition,kft),l=s.pickEllipsoid(a,o,Mft),u=s.pickEllipsoid(c,o,Lft);if(!f(l)||!f(u)){t._rotating=!0,iu(t,n,i);return}if(l=s.worldToCameraCoordinates(l,l),u=s.worldToCameraCoordinates(u,u),f(s.constrainedAxis)){let d=s.constrainedAxis,h=m.mostOrthogonalAxis(d,u4);m.cross(h,d,h),m.normalize(h,h);let _=m.cross(d,h,pq),y=m.magnitude(l),p=m.dot(d,l),C=Math.acos(p/y),x=m.multiplyByScalar(d,p,Fft);m.subtract(l,x,x),m.normalize(x,x);let T=m.magnitude(u),E=m.dot(d,u),S=Math.acos(E/T),w=m.multiplyByScalar(d,E,Nft);m.subtract(u,w,w),m.normalize(w,w);let D=Math.acos(m.dot(x,h));m.dot(x,_)<0&&(D=B.TWO_PI-D);let I=Math.acos(m.dot(w,h));m.dot(w,_)<0&&(I=B.TWO_PI-I);let O=D-I,M;m.equalsEpsilon(d,s.position,B.EPSILON2)?M=s.right:M=m.cross(d,s.position,u4);let L=m.cross(d,M,u4),F=m.dot(L,m.subtract(l,d,pq)),g=m.dot(L,m.subtract(u,d,pq)),b;F>0&&g>0?b=S-C:F>0&&g<=0?m.dot(s.position,d)>0?b=-C-S:b=C+S:b=C-S,s.rotateRight(O),s.rotateUp(b)}else{m.normalize(l,l),m.normalize(u,u);let d=m.dot(l,u),h=m.cross(l,u,u4);if(d<1&&!m.equalsEpsilon(h,m.ZERO,B.EPSILON14)){let _=Math.acos(d);s.rotate(h,_)}}}var Uft=new m,zft=new de;function Qge(t,n,i){f(i.distance)&&(i=i.distance);let o=t._ellipsoid,r=t._scene,s=r.camera,a=r.canvas,c=t._cameraUnderground,l;c?l=n:(l=Kge,l.x=a.clientWidth/2,l.y=a.clientHeight/2);let u=s.getPickRay(l,Jge),d,h=o.cartesianToCartographic(s.position,zft).height;h<t._minimumPickingTerrainHeight&&(d=n0(t,l,Zge));let _;if(f(d)&&(_=m.distance(u.origin,d)),c){let p=Hge(t,u,h);f(_)?_=Math.min(_,p):_=p}f(_)||(_=h);let y=m.normalize(s.position,Uft);Cq(t,n,i,t._zoomFactor,_,m.dot(y,s.direction))}var $ge=new W,m4=new dn,Wv=new m,Hft=new m,e0e=new N,Gft=new N,t0e=new N,Wft=new Me,jft=new $,Tq=new de,Eq=new m;function qft(t,n,i){let r=t._scene.camera;if(r._kmap_limit_pitch&&(r.pitch>B.toRadians(r._kmap_limit_pitch[1])&&i.startPosition.y>i.endPosition.y||r.pitch<B.toRadians(r._kmap_limit_pitch[0])&&i.startPosition.y<i.endPosition.y)||!N.equals(r.transform,N.IDENTITY))return;if(f(i.angleAndHeight)&&(i=i.angleAndHeight),W.equals(n,t._tiltCenterMousePosition)||(t._tiltOnEllipsoid=!1,t._looking=!1),t._looking){let c=t._ellipsoid.geodeticSurfaceNormal(r.position,Eq);ou(t,n,i,c);return}let a=t._ellipsoid.cartesianToCartographic(r.position,Tq);t._tiltOnEllipsoid||a.height>t._minimumCollisionTerrainHeight?(t._tiltOnEllipsoid=!0,Xft(t,n,i)):Kft(t,n,i)}var Yft=new de;function Xft(t,n,i){let o=t._ellipsoid,r=t._scene,s=r.camera,a=t.minimumZoomDistance*.25,c=o.cartesianToCartographic(s.positionWC,Yft).height;if(c-a-1<B.EPSILON3&&i.endPosition.y-i.startPosition.y<0)return;let l=r.canvas,u=$ge;u.x=l.clientWidth/2,u.y=l.clientHeight/2;let d=s.getPickRay(u,m4),h,_=ji.rayEllipsoid(d,o);if(f(_))h=dn.getPoint(d,_.start,Wv);else if(c>t._minimumTrackBallHeight){let E=ji.grazingAltitudeLocation(d,o);if(!f(E))return;let S=o.cartesianToCartographic(E,Tq);S.height=0,h=o.cartographicToCartesian(S,Wv)}else{t._looking=!0;let E=t._ellipsoid.geodeticSurfaceNormal(s.position,Eq);ou(t,n,i,E),W.clone(n,t._tiltCenterMousePosition);return}let y=vt.eastNorthUpToFixedFrame(h,o,e0e),p=t._globe,C=t._ellipsoid;t._globe=void 0,t._ellipsoid=oe.UNIT_SPHERE,t._rotateFactor=1,t._rotateRateRangeAdjustment=1;let x=N.clone(s.transform,t0e);s._setTransform(y),iu(t,n,i,m.UNIT_Z),s._setTransform(x),t._globe=p,t._ellipsoid=C;let T=C.maximumRadius;t._rotateFactor=1/T,t._rotateRateRangeAdjustment=T}function Kft(t,n,i){let o=t._ellipsoid,r=t._scene,s=r.camera,a=t._cameraUnderground,c,l,u;if(W.equals(n,t._tiltCenterMousePosition))c=m.clone(t._tiltCenter,Wv);else{if(c=n0(t,n,Wv),!f(c)){if(l=s.getPickRay(n,m4),u=ji.rayEllipsoid(l,o),!f(u)){if(o.cartesianToCartographic(s.position,Tq).height<=t._minimumTrackBallHeight){t._looking=!0;let b=t._ellipsoid.geodeticSurfaceNormal(s.position,Eq);ou(t,n,i,b),W.clone(n,t._tiltCenterMousePosition)}return}c=dn.getPoint(l,u.start,Wv)}a&&(f(l)||(l=s.getPickRay(n,m4)),Gge(t,l,c,c)),W.clone(n,t._tiltCenterMousePosition),m.clone(c,t._tiltCenter)}let d=r.canvas,h=$ge;h.x=d.clientWidth/2,h.y=t._tiltCenterMousePosition.y,l=s.getPickRay(h,m4);let _=m.magnitude(c),y=m.fromElements(_,_,_,yq),p=oe.fromCartesian3(y,Aq);if(u=ji.rayEllipsoid(l,p),!f(u))return;let C=m.magnitude(l.origin)>_?u.start:u.stop,x=dn.getPoint(l,C,Hft),T=vt.eastNorthUpToFixedFrame(c,o,e0e),E=vt.eastNorthUpToFixedFrame(x,p,Gft),S=t._globe,w=t._ellipsoid;t._globe=void 0,t._ellipsoid=oe.UNIT_SPHERE,t._rotateFactor=1,t._rotateRateRangeAdjustment=1;let D=m.UNIT_Z,I=N.clone(s.transform,t0e);s._setTransform(E);let O=m.cross(x,s.positionWC,h4);if(m.dot(s.rightWC,O)<0){let g=i.startPosition.y-i.endPosition.y;(a&&g<0||!a&&g>0)&&(D=void 0);let b=s.constrainedAxis;s.constrainedAxis=void 0,iu(t,n,i,D,!0,!1),s.constrainedAxis=b}else iu(t,n,i,D,!0,!1);if(s._setTransform(T),iu(t,n,i,D,!1,!0),f(s.constrainedAxis)){let g=m.cross(s.direction,s.constrainedAxis,h4);m.equalsEpsilon(g,m.ZERO,B.EPSILON6)||(m.dot(g,s.right)<0&&m.negate(g,g),m.cross(g,s.direction,s.up),m.cross(s.direction,s.up,s.right),m.normalize(s.up,s.up),m.normalize(s.right,s.right))}s._setTransform(I),t._globe=S,t._ellipsoid=w;let L=w.maximumRadius;t._rotateFactor=1/L,t._rotateRateRangeAdjustment=L;let F=m.clone(s.positionWC,h4);if(t.enableCollisionDetection&&bq(t),!m.equals(s.positionWC,F)){s._setTransform(E),s.worldToCameraCoordinatesPoint(F,F);let g=m.magnitudeSquared(F);m.magnitudeSquared(s.position)>g&&(m.normalize(s.position,s.position),m.multiplyByScalar(s.position,Math.sqrt(g),s.position));let b=m.angleBetween(F,s.position),v=m.cross(F,s.position,F);m.normalize(v,v);let P=Me.fromAxisAngle(v,b,Wft),R=$.fromQuaternion(P,jft);$.multiplyByVector(R,s.direction,s.direction),$.multiplyByVector(R,s.up,s.up),m.cross(s.direction,s.up,s.right),m.cross(s.right,s.direction,s.up),s._setTransform(I)}}var Jft=new W,Zft=new W,kge=new dn,Uge=new dn,Qft=new m,$ft=new m;function ou(t,n,i,o){let s=t._scene.camera,a=Jft;a.x=i.startPosition.x,a.y=0;let c=Zft;c.x=i.endPosition.x,c.y=0;let l=s.getPickRay(a,kge),u=s.getPickRay(c,Uge),d=0,h,_;s.frustum instanceof $t?(h=l.origin,_=u.origin,m.add(s.direction,h,h),m.add(s.direction,_,_),m.subtract(h,s.position,h),m.subtract(_,s.position,_),m.normalize(h,h),m.normalize(_,_)):(h=l.direction,_=u.direction);let y=m.dot(h,_);y<1&&(d=Math.acos(y)),d=i.startPosition.x>i.endPosition.x?-d:d;let p=t._horizontalRotationAxis;if(f(o)?s.look(o,-d):f(p)?s.look(p,-d):s.lookLeft(d),a.x=0,a.y=i.startPosition.y,c.x=0,c.y=i.endPosition.y,l=s.getPickRay(a,kge),u=s.getPickRay(c,Uge),d=0,s.frustum instanceof $t?(h=l.origin,_=u.origin,m.add(s.direction,h,h),m.add(s.direction,_,_),m.subtract(h,s.position,h),m.subtract(_,s.position,_),m.normalize(h,h),m.normalize(_,_)):(h=l.direction,_=u.direction),y=m.dot(h,_),y<1&&(d=Math.acos(y)),d=i.startPosition.y>i.endPosition.y?-d:d,o=A(o,p),f(o)){let C=s.direction,x=m.negate(o,Qft),T=m.equalsEpsilon(C,o,B.EPSILON2),E=m.equalsEpsilon(C,x,B.EPSILON2);if(!T&&!E){y=m.dot(C,o);let S=B.acosClamped(y);d>0&&d>S&&(d=S-B.EPSILON4),y=m.dot(C,x),S=B.acosClamped(y),d<0&&-d>S&&(d=-S+B.EPSILON4);let w=m.cross(o,C,$ft);s.look(w,d)}else(T&&d<0||E&&d>0)&&s.look(s.right,-d)}else s.lookUp(d)}function edt(t){Pc(t,t.enableRotate,t.rotateEventTypes,Rft,t.inertiaSpin,"_lastInertiaSpinMovement"),Pc(t,t.enableZoom,t.zoomEventTypes,Qge,t.inertiaZoom,"_lastInertiaZoomMovement"),Pc(t,t.enableTilt,t.tiltEventTypes,qft,t.inertiaSpin,"_lastInertiaTiltMovement"),Pc(t,t.enableLook,t.lookEventTypes,ou)}var tdt=new N,ndt=new de;function bq(t){t._adjustedHeightForTerrain=!0;let n=t._scene,i=n.mode,o=n.globe;if(!f(o)||i===ne.SCENE2D||i===ne.MORPHING)return;let r=n.camera,s=o.ellipsoid,a=n.mapProjection,c,l;N.equals(r.transform,N.IDENTITY)||(c=N.clone(r.transform,tdt),l=m.magnitude(r.position),r._setTransform(N.IDENTITY));let u=ndt;i===ne.SCENE3D?s.cartesianToCartographic(r.position,u):a.unproject(r.position,u);let d=!1;if(u.height<t._minimumCollisionTerrainHeight){let h=t._scene.globeHeight;if(f(h)){let _=h+t.minimumZoomDistance;u.height<_&&(u.height=_,i===ne.SCENE3D?s.cartographicToCartesian(u,r.position):a.project(u,r.position),d=!0)}}f(c)&&(r._setTransform(c),d&&(m.normalize(r.position,r.position),m.negate(r.position,r.direction),m.multiplyByScalar(r.position,Math.max(l,t.minimumZoomDistance),r.position),m.normalize(r.direction,r.direction),m.cross(r.direction,r.up,r.right),m.cross(r.right,r.direction,r.up)))}jv.prototype.onMap=function(){let t=this._scene,n=t.mode,i=t.camera;return n===ne.COLUMBUS_VIEW?Math.abs(i.position.x)-this._maxCoord.x<0&&Math.abs(i.position.y)-this._maxCoord.y<0:!0};var idt=new m,odt=new m;jv.prototype.update=function(){let t=this._scene,n=t.camera,i=t.globe,o=t.mode;N.equals(n.transform,N.IDENTITY)?(this._globe=i,this._ellipsoid=f(this._globe)?this._globe.ellipsoid:t.mapProjection.ellipsoid):(this._globe=void 0,this._ellipsoid=oe.UNIT_SPHERE);let r=f(this._globe)?this._globe.terrainExaggeration:1,s=f(this._globe)?this._globe.terrainExaggerationRelativeHeight:0;this._minimumCollisionTerrainHeight=kc.getHeight(this.minimumCollisionTerrainHeight,r,s),this._minimumPickingTerrainHeight=kc.getHeight(this.minimumPickingTerrainHeight,r,s),this._minimumTrackBallHeight=kc.getHeight(this.minimumTrackBallHeight,r,s),this._cameraUnderground=t.cameraUnderground&&f(this._globe);let a=this._ellipsoid.maximumRadius;this._rotateFactor=1/a,this._rotateRateRangeAdjustment=a,this._adjustedHeightForTerrain=!1;let c=m.clone(n.positionWC,idt),l=m.clone(n.directionWC,odt);o===ne.SCENE2D?eft(this):o===ne.COLUMBUS_VIEW?(this._horizontalRotationAxis=m.UNIT_Z,bft(this)):o===ne.SCENE3D&&(this._horizontalRotationAxis=void 0,edt(this)),this.enableCollisionDetection&&!this._adjustedHeightForTerrain&&(!m.equals(c,n.positionWC)||!m.equals(l,n.directionWC))&&bq(this),this._aggregator.reset()};jv.prototype.isDestroyed=function(){return!1};jv.prototype.destroy=function(){return this._tweens.removeAll(),this._aggregator=this._aggregator&&this._aggregator.destroy(),ue(this)};var _4=jv;var g4=`uniform sampler2D colorTexture;
uniform sampler2D colorTexture2;
uniform vec2 center;
uniform float radius;
varying vec2 v_textureCoordinates;
void main()
{
vec4 color0 = texture2D(colorTexture, v_textureCoordinates);
vec4 color1 = texture2D(colorTexture2, v_textureCoordinates);
float x = length(gl_FragCoord.xy - center) / radius;
float t = smoothstep(0.5, 0.8, x);
gl_FragColor = mix(color0 + color1, color1, t);
}
`;var y4=`uniform sampler2D colorTexture;
uniform float avgLuminance;
uniform float threshold;
uniform float offset;
varying vec2 v_textureCoordinates;
float key(float avg)
{
float guess = 1.5 - (1.5 / (avg * 0.1 + 1.0));
return max(0.0, guess) + 0.1;
}
void main()
{
vec4 color = texture2D(colorTexture, v_textureCoordinates);
vec3 xyz = czm_RGBToXYZ(color.rgb);
float luminance = xyz.r;
float scaledLum = key(avgLuminance) * luminance / avgLuminance;
float brightLum = max(scaledLum - threshold, 0.0);
float brightness = brightLum / (offset + brightLum);
xyz.r = brightness;
gl_FragColor = vec4(czm_XYZToRGB(xyz), 1.0);
}
`;function wp(){this._sceneFramebuffer=new JE;let t=.125,n=new Array(6);n[0]=new go({fragmentShader:tu,textureScale:t,forcePowerOfTwo:!0,sampleMode:hf.LINEAR});let i=n[1]=new go({fragmentShader:y4,uniforms:{avgLuminance:.5,threshold:.25,offset:.1},textureScale:t,forcePowerOfTwo:!0}),o=this;this._delta=1,this._sigma=2,this._blurStep=new W,n[2]=new go({fragmentShader:SA,uniforms:{step:function(){return o._blurStep.x=o._blurStep.y=1/i.outputTexture.width,o._blurStep},delta:function(){return o._delta},sigma:function(){return o._sigma},direction:0},textureScale:t,forcePowerOfTwo:!0}),n[3]=new go({fragmentShader:SA,uniforms:{step:function(){return o._blurStep.x=o._blurStep.y=1/i.outputTexture.width,o._blurStep},delta:function(){return o._delta},sigma:function(){return o._sigma},direction:1},textureScale:t,forcePowerOfTwo:!0}),n[4]=new go({fragmentShader:tu,sampleMode:hf.LINEAR}),this._uCenter=new W,this._uRadius=void 0,n[5]=new go({fragmentShader:g4,uniforms:{center:function(){return o._uCenter},radius:function(){return o._uRadius},colorTexture2:function(){return o._sceneFramebuffer.framebuffer.getColorTexture(0)}}}),this._stages=new pl({stages:n});let r=new tb(this),s=n.length;for(let a=0;a<s;++a)n[a]._textureCache=r;this._textureCache=r,this.length=n.length}wp.prototype.get=function(t){return this._stages.get(t)};wp.prototype.getStageByName=function(t){let n=this._stages.length;for(let i=0;i<n;++i){let o=this._stages.get(i);if(o.name===t)return o}};var rdt=new se,n0e=new W,sdt=new W,i0e=new N;function adt(t,n,i){let o=n.uniformState,r=o.sunPositionWC,s=o.view,a=o.viewProjection,c=o.projection,l=N.computeViewportTransformation(i,0,1,i0e),u=N.multiplyByPoint(s,r,rdt),d=vt.pointToGLWindowCoordinates(a,l,r,n0e);u.x+=B.SOLAR_RADIUS;let h=vt.pointToGLWindowCoordinates(c,l,u,u),_=W.magnitude(W.subtract(h,d,h))*30*2,y=sdt;y.x=_,y.y=_,t._uCenter=W.clone(d,t._uCenter),t._uRadius=Math.max(y.x,y.y)*.15;let p=n.drawingBufferWidth,C=n.drawingBufferHeight,x=t._stages,T=x.get(0),E=T.outputTexture.width,S=T.outputTexture.height,w=new He;w.width=E,w.height=S,l=N.computeViewportTransformation(w,0,1,i0e),d=vt.pointToGLWindowCoordinates(a,l,r,n0e),y.x*=E/p,y.y*=S/C;let D=T.scissorRectangle;D.x=Math.max(d.x-y.x*.5,0),D.y=Math.max(d.y-y.y*.5,0),D.width=Math.min(y.x,p),D.height=Math.min(y.y,C);for(let I=1;I<4;++I)He.clone(D,x.get(I).scissorRectangle)}wp.prototype.clear=function(t,n,i){this._sceneFramebuffer.clear(t,n,i),this._textureCache.clear(t)};wp.prototype.update=function(t){let n=t.context,i=t.viewport,o=this._sceneFramebuffer;o.update(n,i);let r=o.framebuffer;return this._textureCache.update(n),this._stages.update(n,!1),adt(this,n,i),r};wp.prototype.execute=function(t){let n=this._sceneFramebuffer.framebuffer.getColorTexture(0),i=this._stages,o=i.length;i.get(0).execute(t,n);for(let r=1;r<o;++r)i.get(r).execute(t,i.get(r-1).outputTexture)};wp.prototype.copy=function(t,n){if(!f(this._copyColorCommand)){let i=this;this._copyColorCommand=t.createViewportQuadCommand(tu,{uniformMap:{colorTexture:function(){return i._stages.get(i._stages.length-1).outputTexture}},owner:this})}this._copyColorCommand.framebuffer=n,this._copyColorCommand.execute(t)};wp.prototype.isDestroyed=function(){return!1};wp.prototype.destroy=function(){return this._textureCache.destroy(),this._stages.destroy(),ue(this)};var A4=wp;var x4=function(t){return function(){t.frameState.afterRender.push(function(){t.requestRender()})}};function Ni(t){t=A(t,A.EMPTY_OBJECT);let n=t.canvas,i=t.creditContainer,o=t.creditViewport,r=tt(t.contextOptions);f(r)||(r={}),f(r.webgl)||(r.webgl={}),r.webgl.powerPreference=A(r.webgl.powerPreference,"high-performance");let s=f(i),a=new EV(n,r);s||(i=document.createElement("div"),i.style.position="absolute",i.style.bottom="0",i.style["text-shadow"]="0 0 2px #000000",i.style.color="#ffffff",i.style["font-size"]="10px",i.style["padding-right"]="5px",n.parentNode.appendChild(i)),f(o)||(o=n.parentNode),this._id=Bn(),this._jobScheduler=new CU,this._frameState=new kk(a,new Ek(i," \u2022 ",o),this._jobScheduler),this._frameState.scene3DOnly=A(t.scene3DOnly,!1),this._removeCreditContainer=!s,this._creditContainer=i,this._canvas=n,this._context=a,this._computeEngine=new AV(a),this._globe=void 0,this._globeTranslucencyState=new mU,this._primitives=new Nl,this._groundPrimitives=new Nl,this._globeHeight=void 0,this._cameraUnderground=!1,this._logDepthBuffer=a.fragmentDepth,this._logDepthBufferDirty=!0,this._tweens=new nb,this._shaderFrameCount=0,this._sunPostProcess=void 0,this._computeCommandList=[],this._overlayCommandList=[],this._useOIT=A(t.orderIndependentTranslucency,!0),this._executeOITFunction=void 0,this._depthPlane=new Pk(t.depthPlaneEllipsoidOffset),this._clearColorCommand=new Qn({color:new z,stencil:0,owner:this}),this._depthClearCommand=new Qn({depth:1,owner:this}),this._stencilClearCommand=new Qn({stencil:0}),this._classificationStencilClearCommand=new Qn({stencil:0,renderState:Ve.fromCache({stencilMask:Ot.CLASSIFICATION_MASK})}),this._depthOnlyRenderStateCache={},this._transitioner=new a4(this),this._preUpdate=new Ae,this._postUpdate=new Ae,this._renderError=new Ae,this._preRender=new Ae,this._postRender=new Ae,this._minimumDisableDepthTestDistance=0,this._debugInspector=new Sk,this._msaaSamples=A(t.msaaSamples,1),this.rethrowRenderErrors=!1,this.completeMorphOnUserInput=!0,this.morphStart=new Ae,this.morphComplete=new Ae,this.skyBox=void 0,this.skyAtmosphere=void 0,this.sun=void 0,this.sunBloom=!0,this._sunBloom=void 0,this.moon=void 0,this.backgroundColor=z.clone(z.BLACK),this._mode=ne.SCENE3D,this._mapProjection=f(t.mapProjection)?t.mapProjection:new Ci,this.morphTime=1,this.farToNearRatio=1e3,this.logarithmicDepthFarToNearRatio=1e9,this.nearToFarDistance2D=175e4,this.debugCommandFilter=void 0,this.debugShowCommands=!1,this.debugShowFrustums=!1,this.debugShowFramesPerSecond=!1,this.debugShowDepthFrustum=1,this.debugShowFrustumPlanes=!1,this._debugShowFrustumPlanes=!1,this._debugFrustumPlanes=void 0,this.useDepthPicking=!0,this.pickTranslucentDepth=!1,this.cameraEventWaitTime=500,this.fog=new Nk,this._shadowMapCamera=new lo(this),this.shadowMap=new e0({context:a,lightCamera:this._shadowMapCamera,enabled:A(t.shadows,!1)}),this.invertClassification=!1,this.invertClassificationColor=z.clone(z.WHITE),this._actualInvertClassificationColor=z.clone(this._invertClassificationColor),this._invertClassification=new Iv,this.focalLength=void 0,this.eyeSeparation=void 0,this.postProcessStages=new r4,this._brdfLutGenerator=new ZV,this._performanceDisplay=void 0,this._debugVolume=void 0,this._screenSpaceCameraController=new _4(this),this._cameraUnderground=!1,this._mapMode2D=A(t.mapMode2D,Zl.INFINITE_SCROLL),this._environmentState={skyBoxCommand:void 0,skyAtmosphereCommand:void 0,sunDrawCommand:void 0,sunComputeCommand:void 0,moonCommand:void 0,isSunVisible:!1,isMoonVisible:!1,isReadyForAtmosphere:!1,isSkyAtmosphereVisible:!1,clearGlobeDepth:!1,useDepthPlane:!1,renderTranslucentDepthForPick:!1,originalFramebuffer:void 0,useGlobeDepthFramebuffer:!1,useOIT:!1,useInvertClassification:!1,usePostProcess:!1,usePostProcessSelected:!1,useWebVR:!1},this._useWebVR=!1,this._cameraVR=void 0,this._aspectRatioVR=void 0,this.requestRenderMode=A(t.requestRenderMode,!1),this._renderRequested=!0,this.maximumRenderTimeChange=A(t.maximumRenderTimeChange,0),this._lastRenderTime=void 0,this._frameRateMonitor=void 0,this._removeRequestListenerCallback=ec.requestCompletedEvent.addEventListener(x4(this)),this._removeTaskProcessorListenerCallback=fi.taskCompletedEvent.addEventListener(x4(this)),this._removeGlobeCallbacks=[];let c=new He(0,0,a.drawingBufferWidth,a.drawingBufferHeight),l=new lo(this);this._logDepthBuffer&&(l.frustum.near=.1,l.frustum.far=1e10),this.preloadFlightCamera=new lo(this),this.preloadFlightCullingVolume=void 0,this._picking=new NU(this),this._defaultView=new QE(this,l,c),this._view=this._defaultView,this._hdr=void 0,this._hdrDirty=void 0,this.highDynamicRange=!1,this.gamma=2.2,this.sphericalHarmonicCoefficients=void 0,this.specularEnvironmentMaps=void 0,this._specularEnvironmentMapAtlas=void 0,this.light=new Ug,this.lightSource=new gV,a0e(this,0,te.now()),this.updateFrameState(),this.initializeFrame()}function cdt(t,n){for(let o=0;o<t._removeGlobeCallbacks.length;++o)t._removeGlobeCallbacks[o]();t._removeGlobeCallbacks.length=0;let i=[];f(n)&&(i.push(n.imageryLayersUpdatedEvent.addEventListener(x4(t))),i.push(n.terrainProviderChanged.addEventListener(x4(t)))),t._removeGlobeCallbacks=i}Object.defineProperties(Ni.prototype,{canvas:{get:function(){return this._canvas}},drawingBufferHeight:{get:function(){return this._context.drawingBufferHeight}},drawingBufferWidth:{get:function(){return this._context.drawingBufferWidth}},maximumAliasedLineWidth:{get:function(){return Ut.maximumAliasedLineWidth}},maximumCubeMapSize:{get:function(){return Ut.maximumCubeMapSize}},pickPositionSupported:{get:function(){return this._context.depthTexture}},sampleHeightSupported:{get:function(){return this._context.depthTexture}},clampToHeightSupported:{get:function(){return this._context.depthTexture}},invertClassificationSupported:{get:function(){return this._context.depthTexture}},specularEnvironmentMapsSupported:{get:function(){return Kd.isSupported(this._context)}},globe:{get:function(){return this._globe},set:function(t){this._globe=this._globe&&this._globe.destroy(),this._globe=t,cdt(this,t)}},primitives:{get:function(){return this._primitives}},groundPrimitives:{get:function(){return this._groundPrimitives}},camera:{get:function(){return this._view.camera},set:function(t){this._view.camera=t}},view:{get:function(){return this._view},set:function(t){this._view=t}},defaultView:{get:function(){return this._defaultView}},picking:{get:function(){return this._picking}},screenSpaceCameraController:{get:function(){return this._screenSpaceCameraController}},mapProjection:{get:function(){return this._mapProjection}},jobScheduler:{get:function(){return this._jobScheduler}},frameState:{get:function(){return this._frameState}},environmentState:{get:function(){return this._environmentState}},tweens:{get:function(){return this._tweens}},imageryLayers:{get:function(){if(!!f(this.globe))return this.globe.imageryLayers}},terrainProvider:{get:function(){if(!!f(this.globe))return this.globe.terrainProvider},set:function(t){f(this.globe)&&(this.globe.terrainProvider=t)}},terrainProviderChanged:{get:function(){if(!!f(this.globe))return this.globe.terrainProviderChanged}},preUpdate:{get:function(){return this._preUpdate}},postUpdate:{get:function(){return this._postUpdate}},renderError:{get:function(){return this._renderError}},preRender:{get:function(){return this._preRender}},postRender:{get:function(){return this._postRender}},lastRenderTime:{get:function(){return this._lastRenderTime}},context:{get:function(){return this._context}},debugFrustumStatistics:{get:function(){return this._view.debugFrustumStatistics}},scene3DOnly:{get:function(){return this._frameState.scene3DOnly}},orderIndependentTranslucency:{get:function(){return this._useOIT}},id:{get:function(){return this._id}},mode:{get:function(){return this._mode},set:function(t){t===ne.SCENE2D?this.morphTo2D(0):t===ne.SCENE3D?this.morphTo3D(0):t===ne.COLUMBUS_VIEW&&this.morphToColumbusView(0),this._mode=t}},frustumCommandsList:{get:function(){return this._view.frustumCommandsList}},numberOfFrustums:{get:function(){return this._view.frustumCommandsList.length}},useWebVR:{get:function(){return this._useWebVR},set:function(t){this._useWebVR=t,this._useWebVR?(this._frameState.creditDisplay.container.style.visibility="hidden",this._cameraVR=new lo(this),f(this._deviceOrientationCameraController)||(this._deviceOrientationCameraController=new Bk(this)),this._aspectRatioVR=this.camera.frustum.aspectRatio):(this._frameState.creditDisplay.container.style.visibility="visible",this._cameraVR=void 0,this._deviceOrientationCameraController=this._deviceOrientationCameraController&&!this._deviceOrientationCameraController.isDestroyed()&&this._deviceOrientationCameraController.destroy(),this.camera.frustum.aspectRatio=this._aspectRatioVR,this.camera.frustum.xOffset=0)}},mapMode2D:{get:function(){return this._mapMode2D}},splitPosition:{get:function(){return this._frameState.splitPosition},set:function(t){this._frameState.splitPosition=t}},minimumDisableDepthTestDistance:{get:function(){return this._minimumDisableDepthTestDistance},set:function(t){this._minimumDisableDepthTestDistance=t}},logarithmicDepthBuffer:{get:function(){return this._logDepthBuffer},set:function(t){t=this._context.fragmentDepth&&t,this._logDepthBuffer!==t&&(this._logDepthBuffer=t,this._logDepthBufferDirty=!0)}},gamma:{get:function(){return this._context.uniformState.gamma},set:function(t){this._context.uniformState.gamma=t}},highDynamicRange:{get:function(){return this._hdr},set:function(t){let n=this._context,i=t&&n.depthTexture&&(n.colorBufferFloat||n.colorBufferHalfFloat);this._hdrDirty=i!==this._hdr,this._hdr=i}},highDynamicRangeSupported:{get:function(){let t=this._context;return t.depthTexture&&(t.colorBufferFloat||t.colorBufferHalfFloat)}},cameraUnderground:{get:function(){return this._cameraUnderground}},msaaSamples:{get:function(){return this._msaaSamples},set:function(t){t=Math.min(t,Ut.maximumSamples),this._msaaSamples=t}},msaaSupported:{get:function(){return this._context.msaa}},pixelRatio:{get:function(){return this._frameState.pixelRatio},set:function(t){this._frameState.pixelRatio=t}},opaqueFrustumNearOffset:{get:function(){return .9999}},globeHeight:{get:function(){return this._globeHeight}}});Ni.prototype.getCompressedTextureFormatSupported=function(t){let n=this.context;return(t==="WEBGL_compressed_texture_s3tc"||t==="s3tc")&&n.s3tc||(t==="WEBGL_compressed_texture_pvrtc"||t==="pvrtc")&&n.pvrtc||(t==="WEBGL_compressed_texture_etc"||t==="etc")&&n.etc||(t==="WEBGL_compressed_texture_etc1"||t==="etc1")&&n.etc1||(t==="WEBGL_compressed_texture_astc"||t==="astc")&&n.astc||(t==="EXT_texture_compression_bptc"||t==="bc7")&&n.bc7};function o0e(t,n,i){let o=t._frameState,r=t._context,s=t._view.oit,a=o.shadowState.lightShadowMaps,c=o.shadowState.lightShadowsEnabled,l=n.derivedCommands;f(n.pickId)&&(l.picking=Kg.createPickDerivedCommand(t,n,r,l.picking)),n.pickOnly||(l.depth=Kg.createDepthOnlyDerivedCommand(t,n,r,l.depth)),l.originalCommand=n,t._hdr&&(l.hdr=Kg.createHdrCommand(n,r,l.hdr),n=l.hdr.command,l=n.derivedCommands),c&&n.receiveShadows&&(l.shadows=e0.createReceiveDerivedCommand(a,n,i,r,l.shadows)),n.pass===Te.TRANSLUCENT&&f(s)&&s.isSupported()&&(c&&n.receiveShadows?(l.oit=f(l.oit)?l.oit:{},l.oit.shadows=s.createDerivedCommands(l.shadows.receiveCommand,r,l.oit.shadows)):l.oit=s.createDerivedCommands(n,r,l.oit))}Ni.prototype.updateDerivedCommands=function(t){if(!f(t.derivedCommands))return;let n=this._frameState,i=this._context,o=!1,r=n.shadowState.lastDirtyTime;t.lastDirtyTime!==r&&(t.lastDirtyTime=r,t.dirty=!0,o=!0);let s=n.useLogDepth,a=this._hdr,c=t.derivedCommands,l=f(c.logDepth),u=f(c.hdr),d=f(c.originalCommand),h=s&&!l,_=a&&!u,y=(!s||!a)&&!d;if(t.dirty=t.dirty||h||_||y,t.dirty){t.dirty=!1;let p=n.shadowState.shadowMaps;n.shadowState.shadowsEnabled&&t.castShadows&&(c.shadows=e0.createCastDerivedCommand(p,t,o,i,c.shadows)),(l||h)&&(c.logDepth=Kg.createLogDepthCommand(t,i,c.logDepth),o0e(this,c.logDepth.command,o)),(d||y)&&o0e(this,t,o)}};var ldt=new yd({pass:er.RENDER}),Sq=new yd({pass:er.PRELOAD}),wq=new yd({pass:er.PRELOAD_FLIGHT}),udt=new yd({pass:er.REQUEST_RENDER_MODE_DEFER_CHECK}),r0e=new ae,Dq;function fdt(t){let n=t.globe;if(t._mode===ne.SCENE3D&&f(n)&&n.show&&!t._cameraUnderground&&!t._globeTranslucencyState.translucent){let i=n.ellipsoid,o=t.frameState.minimumTerrainHeight;return r0e.radius=i.minimumRadius+o,Dq=uV.fromBoundingSphere(r0e,t.camera.positionWC,Dq),Dq}}Ni.prototype.clearPasses=function(t){t.render=!1,t.pick=!1,t.depth=!1,t.postProcess=!1,t.offscreen=!1};function a0e(t,n,i){let o=t._frameState;o.frameNumber=n,o.time=te.clone(i,o.time)}Ni.prototype.updateFrameState=function(){let t=this.camera,n=this._frameState;n.commandList.length=0,n.shadowMaps.length=0,n.brdfLutGenerator=this._brdfLutGenerator,n.environmentMap=this.skyBox&&this.skyBox._cubeMap,n.mode=this._mode,n.morphTime=this.morphTime,n.mapProjection=this.mapProjection,n.camera=t,n.cullingVolume=t.frustum.computeCullingVolume(t.positionWC,t.directionWC,t.upWC),n.occluder=fdt(this),n.minimumTerrainHeight=0,n.minimumDisableDepthTestDistance=this._minimumDisableDepthTestDistance,n.invertClassification=this.invertClassification,n.useLogDepth=this._logDepthBuffer&&!(this.camera.frustum instanceof $t||this.camera.frustum instanceof Br),n.light=this.light,n.cameraUnderground=this._cameraUnderground,n.globeTranslucencyState=this._globeTranslucencyState,f(this.globe)&&(n.terrainExaggeration=this.globe.terrainExaggeration,n.terrainExaggerationRelativeHeight=this.globe.terrainExaggerationRelativeHeight),f(this._specularEnvironmentMapAtlas)&&this._specularEnvironmentMapAtlas.ready?(n.specularEnvironmentMaps=this._specularEnvironmentMapAtlas.texture,n.specularEnvironmentMapsMaximumLOD=this._specularEnvironmentMapAtlas.maximumMipmapLevel):(n.specularEnvironmentMaps=void 0,n.specularEnvironmentMapsMaximumLOD=void 0),n.sphericalHarmonicCoefficients=this.sphericalHarmonicCoefficients,this._actualInvertClassificationColor=z.clone(this.invertClassificationColor,this._actualInvertClassificationColor),Iv.isTranslucencySupported(this._context)||(this._actualInvertClassificationColor.alpha=1),n.invertClassificationColor=this._actualInvertClassificationColor,f(this.globe)?n.maximumScreenSpaceError=this.globe.maximumScreenSpaceError:n.maximumScreenSpaceError=2,this.clearPasses(n.passes),n.tilesetPassState=void 0,n.lightSource=this.lightSource};Ni.prototype.isVisible=function(t,n,i){return f(t)&&(!f(t.boundingVolume)||!t.cull||n.computeVisibility(t.boundingVolume)!==jt.OUTSIDE&&(!f(i)||!t.occlude||!t.boundingVolume.isOccluded(i)))};var C4=new N(0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,1);C4=N.inverseTransformation(C4,C4);function ddt(t,n,i,o){let r=n._frameState,s=r.context,a=t.boundingVolume;f(n._debugVolume)&&n._debugVolume.destroy();let c,l=m.clone(a.center);if(r.mode!==ne.SCENE3D){l=N.multiplyByPoint(C4,l,l);let _=r.mapProjection,y=_.unproject(l);l=_.ellipsoid.cartographicToCartesian(y)}if(f(a.radius)){let _=a.radius;c=Fn.toWireframe(Vs.createGeometry(new Vs({radii:new m(_,_,_),vertexFormat:tn.FLAT_VERTEX_FORMAT}))),n._debugVolume=new Sn({geometryInstances:new Ct({geometry:c,modelMatrix:N.fromTranslation(l),attributes:{color:new Lt(1,0,0,1)}}),appearance:new tn({flat:!0,translucent:!1}),asynchronous:!1})}else{let _=a.halfAxes;c=Fn.toWireframe(Cl.createGeometry(Cl.fromDimensions({dimensions:new m(2,2,2),vertexFormat:tn.FLAT_VERTEX_FORMAT}))),n._debugVolume=new Sn({geometryInstances:new Ct({geometry:c,modelMatrix:N.fromRotationTranslation(_,l,new N),attributes:{color:new Lt(1,0,0,1)}}),appearance:new tn({flat:!0,translucent:!1}),asynchronous:!1})}let u=r.commandList,d=r.commandList=[];n._debugVolume.update(r),t=d[0],r.useLogDepth&&(t=Kg.createLogDepthCommand(t,s).command);let h;f(o)&&(h=i.framebuffer,i.framebuffer=o),t.execute(s,i),f(h)&&(i.framebuffer=h),r.commandList=u}function Xa(t,n,i,o,r){let s=n._frameState;if(f(n.debugCommandFilter)&&!n.debugCommandFilter(t))return;if(t instanceof Qn){t.execute(i,o);return}t.debugShowBoundingVolume&&f(t.boundingVolume)&&ddt(t,n,o,r),s.useLogDepth&&f(t.derivedCommands.logDepth)&&(t=t.derivedCommands.logDepth.command);let a=s.passes;if(!a.pick&&!a.depth&&n._hdr&&f(t.derivedCommands)&&f(t.derivedCommands.hdr)&&(t=t.derivedCommands.hdr.command),a.pick||a.depth){if(a.pick&&!a.depth&&f(t.derivedCommands.picking)){t=t.derivedCommands.picking.pickCommand,t.execute(i,o);return}else if(f(t.derivedCommands.depth)){t=t.derivedCommands.depth.depthOnlyCommand,t.execute(i,o);return}}if(n.debugShowCommands||n.debugShowFrustums){n._debugInspector.executeDebugShowFrustumsCommand(n,t,o);return}s.shadowState.lightShadowsEnabled&&t.receiveShadows&&f(t.derivedCommands.shadows)?t.derivedCommands.shadows.receiveCommand.execute(i,o):t.execute(i,o)}function qv(t,n,i,o){let r=n._frameState,s=t.derivedCommands;!f(s)||(r.useLogDepth&&f(s.logDepth)&&(t=s.logDepth.command),s=t.derivedCommands,f(s.picking)?(t=s.picking.pickCommand,t.execute(i,o)):f(s.depth)&&(t=s.depth.depthOnlyCommand,t.execute(i,o)))}function hdt(t,n,i){return n.boundingVolume.distanceSquaredTo(i)-t.boundingVolume.distanceSquaredTo(i)}function mdt(t,n,i){return t.boundingVolume.distanceSquaredTo(i)-n.boundingVolume.distanceSquaredTo(i)+B.EPSILON12}function pdt(t,n,i,o,r){let s=t.context;oA(o,hdt,t.camera.positionWC),f(r)&&n(r.unclassifiedCommand,t,s,i);let a=o.length;for(let c=0;c<a;++c)n(o[c],t,s,i)}function _dt(t,n,i,o,r){let s=t.context;oA(o,mdt,t.camera.positionWC),f(r)&&n(r.unclassifiedCommand,t,s,i);let a=o.length;for(let c=0;c<a;++c)n(o[c],t,s,i)}var gdt=new yi,ydt=new ll,Adt=new $t,Cdt=new Br;function Pq(t,n){let i=t.camera,o=t.context,r=t.frameState,s=o.uniformState;s.updateCamera(i);let a;f(i.frustum.fov)?a=i.frustum.clone(gdt):f(i.frustum.infiniteProjectionMatrix)?a=i.frustum.clone(ydt):f(i.frustum.width)?a=i.frustum.clone(Adt):a=i.frustum.clone(Cdt),a.near=i.frustum.near,a.far=i.frustum.far,s.updateFrustum(a),s.updatePass(Te.ENVIRONMENT);let c=r.passes,l=c.pick,u=t._environmentState,d=t._view,h=u.renderTranslucentDepthForPick,_=u.useWebVR;if(!l){let b=u.skyBoxCommand;if(f(b)&&Xa(b,t,o,n),u.isSkyAtmosphereVisible&&Xa(u.skyAtmosphereCommand,t,o,n),u.isSunVisible&&(u.sunDrawCommand.execute(o,n),t.sunBloom&&!_)){let v;u.useGlobeDepthFramebuffer?v=d.globeDepth.framebuffer:u.usePostProcess?v=d.sceneFramebuffer.framebuffer:v=u.originalFramebuffer,t._sunPostProcess.execute(o),t._sunPostProcess.copy(o,v),n.framebuffer=v}u.isMoonVisible&&u.moonCommand.execute(o,n)}let y;u.useOIT?(f(t._executeOITFunction)||(t._executeOITFunction=function(b,v,P,R,V){d.globeDepth.prepareColorTextures(o),d.oit.executeCommands(b,v,P,R,V)}),y=t._executeOITFunction):c.render?y=pdt:y=_dt;let p=d.frustumCommandsList,C=p.length,x=u.clearGlobeDepth,T=u.useDepthPlane,E=t._globeTranslucencyState,S=E.translucent,w=t._view.globeTranslucencyFramebuffer,D=t._depthClearCommand,I=t._stencilClearCommand,O=t._classificationStencilClearCommand,M=t._depthPlane,L=u.usePostProcessSelected,F=i.position.z,g;for(let b=0;b<C;++b){let v=C-b-1,P=p[v];t.mode===ne.SCENE2D?(i.position.z=F-P.near+1,a.far=Math.max(1,P.far-P.near),a.near=1,s.update(r),s.updateFrustum(a)):(a.near=v!==0?P.near*t.opaqueFrustumNearOffset:P.near,a.far=P.far,s.updateFrustum(a)),D.execute(o,n),o.stencilBuffer&&I.execute(o,n),s.updatePass(Te.GLOBE);let R=P.commands[Te.GLOBE],V=P.indices[Te.GLOBE];if(S)E.executeGlobeCommands(P,Xa,w,t,n);else if(!n.MirrorEnable)for(g=0;g<V;++g)Xa(R[g],t,o,n);let H=d.globeDepth;if(f(H)&&u.useGlobeDepthFramebuffer&&!n.MirrorEnable&&H.executeCopyDepth(o,n),!u.renderTranslucentDepthForPick&&!n.MirrorEnable)if(s.updatePass(Te.TERRAIN_CLASSIFICATION),R=P.commands[Te.TERRAIN_CLASSIFICATION],V=P.indices[Te.TERRAIN_CLASSIFICATION],S)E.executeGlobeClassificationCommands(P,Xa,w,t,n);else for(g=0;g<V;++g)Xa(R[g],t,o,n);if(x&&!n.MirrorEnable&&(D.execute(o,n),T&&M.execute(o,n)),!u.useInvertClassification||l||u.renderTranslucentDepthForPick){for(s.updatePass(Te.CESIUM_3D_TILE),R=P.commands[Te.CESIUM_3D_TILE],V=P.indices[Te.CESIUM_3D_TILE],g=0;g<V;++g)Xa(R[g],t,o,n);if(V>0&&(f(H)&&u.useGlobeDepthFramebuffer&&!n.MirrorEnable&&(H.prepareColorTextures(o,x),H.executeUpdateDepth(o,n,x,H.depthStencilTexture)),!u.renderTranslucentDepthForPick&&!n.MirrorEnable))for(s.updatePass(Te.CESIUM_3D_TILE_CLASSIFICATION),R=P.commands[Te.CESIUM_3D_TILE_CLASSIFICATION],V=P.indices[Te.CESIUM_3D_TILE_CLASSIFICATION],g=0;g<V;++g)Xa(R[g],t,o,n)}else{t._invertClassification.clear(o,n);let X=n.framebuffer;for(n.framebuffer=t._invertClassification._fbo.framebuffer,s.updatePass(Te.CESIUM_3D_TILE),R=P.commands[Te.CESIUM_3D_TILE],V=P.indices[Te.CESIUM_3D_TILE],g=0;g<V;++g)Xa(R[g],t,o,n);for(f(H)&&u.useGlobeDepthFramebuffer&&(t._invertClassification.prepareTextures(o),H.executeUpdateDepth(o,n,x,t._invertClassification._fbo.getDepthStencilTexture())),s.updatePass(Te.CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW),R=P.commands[Te.CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW],V=P.indices[Te.CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW],g=0;g<V;++g)Xa(R[g],t,o,n);for(n.framebuffer=X,t._invertClassification.executeClassified(o,n),r.invertClassificationColor.alpha===1&&t._invertClassification.executeUnclassified(o,n),V>0&&o.stencilBuffer&&O.execute(o,n),s.updatePass(Te.CESIUM_3D_TILE_CLASSIFICATION),R=P.commands[Te.CESIUM_3D_TILE_CLASSIFICATION],V=P.indices[Te.CESIUM_3D_TILE_CLASSIFICATION],g=0;g<V;++g)Xa(R[g],t,o,n)}for(V>0&&o.stencilBuffer&&I.execute(o,n),s.updatePass(Te.OPAQUE),R=P.commands[Te.OPAQUE],V=P.indices[Te.OPAQUE],g=0;g<V;++g)Xa(R[g],t,o,n);v!==0&&t.mode!==ne.SCENE2D&&(a.near=P.near,s.updateFrustum(a));let U;if(!l&&u.useInvertClassification&&r.invertClassificationColor.alpha<1&&(U=t._invertClassification),s.updatePass(Te.TRANSLUCENT),R=P.commands[Te.TRANSLUCENT],R.length=P.indices[Te.TRANSLUCENT],y(t,Xa,n,R,U),P.indices[Te.CESIUM_3D_TILE_CLASSIFICATION]>0&&d.translucentTileClassification.isSupported()&&(d.translucentTileClassification.executeTranslucentCommands(t,Xa,n,R,H.depthStencilTexture),d.translucentTileClassification.executeClassificationCommands(t,Xa,n,P)),o.depthTexture&&t.useDepthPicking&&(u.useGlobeDepthFramebuffer||h)){let X=H.depthStencilTexture,Y=t._picking.getPickDepth(t,v);Y.update(o,X),Y.executeCopyDepth(o,n)}if(l||!L)continue;let k=n.framebuffer;if(n.framebuffer=d.sceneFramebuffer.getIdFramebuffer(),a.near=v!==0?P.near*t.opaqueFrustumNearOffset:P.near,a.far=P.far,s.updateFrustum(a),s.updatePass(Te.GLOBE),R=P.commands[Te.GLOBE],V=P.indices[Te.GLOBE],S)E.executeGlobeCommands(P,qv,w,t,n);else for(g=0;g<V;++g)qv(R[g],t,o,n);for(x&&(D.framebuffer=n.framebuffer,D.execute(o,n),D.framebuffer=void 0),x&&T&&M.execute(o,n),s.updatePass(Te.CESIUM_3D_TILE),R=P.commands[Te.CESIUM_3D_TILE],V=P.indices[Te.CESIUM_3D_TILE],g=0;g<V;++g)qv(R[g],t,o,n);for(s.updatePass(Te.OPAQUE),R=P.commands[Te.OPAQUE],V=P.indices[Te.OPAQUE],g=0;g<V;++g)qv(R[g],t,o,n);for(s.updatePass(Te.TRANSLUCENT),R=P.commands[Te.TRANSLUCENT],V=P.indices[Te.TRANSLUCENT],g=0;g<V;++g)qv(R[g],t,o,n);n.framebuffer=k}}function c0e(t){t.context.uniformState.updatePass(Te.COMPUTE);let i=t._environmentState.sunComputeCommand;f(i)&&i.execute(t._computeEngine);let o=t._computeCommandList,r=o.length;for(let s=0;s<r;++s)o[s].execute(t._computeEngine)}function xdt(t,n){t.context.uniformState.updatePass(Te.OVERLAY);let o=t.context,r=t._overlayCommandList,s=r.length;for(let a=0;a<s;++a)r[a].execute(o,n)}function Tdt(t,n,i){let o=i.shadowMapCullingVolume,r=i.isPointLight,s=i.passes,a=s.length,c=n.length;for(let l=0;l<c;++l){let u=n[l];if(t.updateDerivedCommands(u),u.castShadows&&(u.pass===Te.GLOBE||u.pass===Te.CESIUM_3D_TILE||u.pass===Te.OPAQUE||u.pass===Te.TRANSLUCENT)&&t.isVisible(u,o))if(r)for(let d=0;d<a;++d)s[d].commandList.push(u);else if(a===1)s[0].commandList.push(u);else{let d=!1;for(let h=a-1;h>=0;--h){let _=s[h].cullingVolume;if(t.isVisible(u,_))s[h].commandList.push(u),d=!0;else if(d)break}}}}function l0e(t){let n=t.frameState,i=n.shadowState.shadowMaps,o=i.length;if(!n.shadowState.shadowsEnabled)return;let r=t.context,s=r.uniformState;for(let a=0;a<o;++a){let c=i[a];if(c.outOfView)continue;let l=c.passes,u=l.length;for(let h=0;h<u;++h)l[h].commandList.length=0;let d=t.frameState.commandList;Tdt(t,d,c);for(let h=0;h<u;++h){let _=c.passes[h];s.updateCamera(_.camera),c.updatePass(r,h);let y=_.commandList.length;for(let p=0;p<y;++p){let C=_.commandList[p];s.updatePass(C.pass),Xa(C.derivedCommands.shadows.castCommands[a],t,r,_.passState)}}}}var Edt=new m;Ni.prototype.updateAndExecuteCommands=function(t,n){let o=this._frameState.mode;this._environmentState.useWebVR?bdt(this,t,n):o!==ne.SCENE2D||this._mapMode2D===Zl.ROTATE?i0(!0,this,t,n):(Bq(this,t,n),Rdt(this,t))};function bdt(t,n,i){let o=t._view,r=o.camera,a=t._environmentState.renderTranslucentDepthForPick;Bq(t,n,i),u0e(t),o.createPotentiallyVisibleSet(t),c0e(t),a||l0e(t,n.MirrorEnable);let c=n.viewport;c.x=0,c.y=0,c.width=c.width*.5;let l=lo.clone(r,t._cameraVR);l.frustum=r.frustum;let u=r.frustum.near,d=u*A(t.focalLength,5),h=A(t.eyeSeparation,d/30),_=m.multiplyByScalar(l.right,h*.5,Edt);r.frustum.aspectRatio=c.width/c.height;let y=.5*h*u/d;m.add(l.position,_,r.position),r.frustum.xOffset=y,Pq(t,n),c.x=c.width,m.subtract(l.position,_,r.position),r.frustum.xOffset=-y,Pq(t,n),lo.clone(l,r)}var Sdt=new de(Math.PI,B.PI_OVER_TWO),wdt=new m,Ddt=new m,vdt=new N,Pdt=new N,Idt=new m,Bdt=new m,Odt=new He;function Rdt(t,n){let i=t.context,o=t.frameState,r=t.camera,s=n.viewport,a=He.clone(s,Odt);n.viewport=a;let c=Sdt,l=wdt;t.mapProjection.project(c,l);let d=m.clone(r.position,Ddt),h=N.clone(r.transform,Pdt),_=r.frustum.clone();r._setTransform(N.IDENTITY);let y=N.computeViewportTransformation(a,0,1,vdt),p=r.frustum.projectionMatrix,C=r.positionWC.y,x=m.fromElements(B.sign(C)*l.x-C,0,-r.positionWC.x,Idt),T=vt.pointToGLWindowCoordinates(p,y,x,Bdt);T.x=Math.floor(T.x);let E=a.x,S=a.width;if(C===0||T.x<=E||T.x>=E+S)i0(!0,t,n);else if(Math.abs(E+S*.5-T.x)<1)a.width=T.x-a.x,r.position.x*=B.sign(r.position.x),r.frustum.right=0,o.cullingVolume=r.frustum.computeCullingVolume(r.positionWC,r.directionWC,r.upWC),i.uniformState.update(o),i0(!0,t,n),a.x=T.x,r.position.x=-r.position.x,r.frustum.right=-r.frustum.left,r.frustum.left=0,o.cullingVolume=r.frustum.computeCullingVolume(r.positionWC,r.directionWC,r.upWC),i.uniformState.update(o),i0(!1,t,n);else if(T.x>E+S*.5){a.width=T.x-E;let w=r.frustum.right;r.frustum.right=l.x-C,o.cullingVolume=r.frustum.computeCullingVolume(r.positionWC,r.directionWC,r.upWC),i.uniformState.update(o),i0(!0,t,n),a.x=T.x,a.width=E+S-T.x,r.position.x=-r.position.x,r.frustum.left=-r.frustum.right,r.frustum.right=w-r.frustum.right*2,o.cullingVolume=r.frustum.computeCullingVolume(r.positionWC,r.directionWC,r.upWC),i.uniformState.update(o),i0(!1,t,n)}else{a.x=T.x,a.width=E+S-T.x;let w=r.frustum.left;r.frustum.left=-l.x-C,o.cullingVolume=r.frustum.computeCullingVolume(r.positionWC,r.directionWC,r.upWC),i.uniformState.update(o),i0(!0,t,n),a.x=E,a.width=T.x-E,r.position.x=-r.position.x,r.frustum.right=-r.frustum.left,r.frustum.left=w-r.frustum.left*2,o.cullingVolume=r.frustum.computeCullingVolume(r.positionWC,r.directionWC,r.upWC),i.uniformState.update(o),i0(!1,t,n)}r._setTransform(h),m.clone(d,r.position),r.frustum=_.clone(),n.viewport=s}function i0(t,n,i,o){let r=n._environmentState,s=n._view,a=r.renderTranslucentDepthForPick;t||(n.frameState.commandList.length=0),u0e(n),s.createPotentiallyVisibleSet(n),t&&(f(o)&&Bq(n,i,o),c0e(n),a||l0e(n)),Pq(n,i)}var s0e=new $s;Ni.prototype.updateEnvironment=function(){let t=this._frameState,n=this._view,i=this._environmentState,o=t.passes.render,r=t.passes.offscreen,s=this.skyAtmosphere,a=this.globe,c=this._globeTranslucencyState;if(!o||this._mode!==ne.SCENE2D&&n.camera.frustum instanceof $t||!c.environmentVisible)i.skyAtmosphereCommand=void 0,i.skyBoxCommand=void 0,i.sunDrawCommand=void 0,i.sunComputeCommand=void 0,i.moonCommand=void 0;else{f(s)?(f(a)&&(s.setDynamicAtmosphereColor(a.enableLighting&&a.dynamicAtmosphereLighting,a.dynamicAtmosphereLightingFromSun),i.isReadyForAtmosphere=i.isReadyForAtmosphere||a._surface._tilesToRender.length>0),i.skyAtmosphereCommand=s.update(t,a),f(i.skyAtmosphereCommand)&&this.updateDerivedCommands(i.skyAtmosphereCommand)):i.skyAtmosphereCommand=void 0,i.skyBoxCommand=f(this.skyBox)?this.skyBox.update(t,this._hdr):void 0;let C=f(this.sun)?this.sun.update(t,n.passState,this._hdr):void 0;i.sunDrawCommand=f(C)?C.drawCommand:void 0,i.sunComputeCommand=f(C)?C.computeCommand:void 0,i.moonCommand=f(this.moon)?this.moon.update(t):void 0}let l=i.clearGlobeDepth=f(a)&&a.show&&(!a.depthTestAgainstTerrain||this.mode===ne.SCENE2D);(i.useDepthPlane=l&&this.mode===ne.SCENE3D&&c.useDepthPlane)&&this._depthPlane.update(t),i.renderTranslucentDepthForPick=!1,i.useWebVR=this._useWebVR&&this.mode!==ne.SCENE2D&&!r;let d=t.mode===ne.SCENE3D&&!c.sunVisibleThroughGlobe?t.occluder:void 0,h=t.cullingVolume,_=s0e.planes;for(let C=0;C<5;++C)_[C]=h.planes[C];h=s0e,i.isSkyAtmosphereVisible=f(i.skyAtmosphereCommand)&&i.isReadyForAtmosphere,i.isSunVisible=this.isVisible(i.sunDrawCommand,h,d),i.isMoonVisible=this.isVisible(i.moonCommand,h,d);let y=this.specularEnvironmentMaps,p=this._specularEnvironmentMapAtlas;f(y)&&(!f(p)||p.url!==y)?(p=p&&p.destroy(),this._specularEnvironmentMapAtlas=new Kd(y)):!f(y)&&f(p)&&(p.destroy(),this._specularEnvironmentMapAtlas=void 0),f(this._specularEnvironmentMapAtlas)&&this._specularEnvironmentMapAtlas.update(t)};function Mdt(t){let n=t._frameState;t.debugShowFrustumPlanes!==t._debugShowFrustumPlanes&&(t.debugShowFrustumPlanes?t._debugFrustumPlanes=new Cp({camera:t.camera,updateOnChange:!1,frustumSplits:n.frustumSplits}):t._debugFrustumPlanes=t._debugFrustumPlanes&&t._debugFrustumPlanes.destroy(),t._debugShowFrustumPlanes=t.debugShowFrustumPlanes),f(t._debugFrustumPlanes)&&t._debugFrustumPlanes.update(n)}function Ldt(t){let n=t._frameState,i=n.shadowMaps,o=i.length,r=o>0&&!n.passes.pick&&t.mode===ne.SCENE3D;if(r!==n.shadowState.shadowsEnabled&&(++n.shadowState.lastDirtyTime,n.shadowState.shadowsEnabled=r),n.shadowState.lightShadowsEnabled=!1,!!r){for(let s=0;s<o;++s)if(i[s]!==n.shadowState.shadowMaps[s]){++n.shadowState.lastDirtyTime;break}n.shadowState.shadowMaps.length=0,n.shadowState.lightShadowMaps.length=0;for(let s=0;s<o;++s){let a=i[s];a.update(n),n.shadowState.shadowMaps.push(a),a.fromLightSource&&(n.shadowState.lightShadowMaps.push(a),n.shadowState.lightShadowsEnabled=!0),a.dirty&&(++n.shadowState.lastDirtyTime,a.dirty=!1)}}}function u0e(t,n){let i=t._frameState;n||t._groundPrimitives.update(i),t._primitives.update(i),Mdt(t),Ldt(t),t._globe&&t._globe.show&&t._globe.render(i)}function Bq(t,n,i){let o=t._context,r=t._frameState,s=t._environmentState,a=t._view,l=t._frameState.passes.pick;f(a.globeDepth)&&(a.globeDepth.picking=l);let u=s.useWebVR;s.originalFramebuffer=n.framebuffer,f(t.sun)&&t.sunBloom!==t._sunBloom?(t.sunBloom&&!u?t._sunPostProcess=new A4:f(t._sunPostProcess)&&(t._sunPostProcess=t._sunPostProcess.destroy()),t._sunBloom=t.sunBloom):!f(t.sun)&&f(t._sunPostProcess)&&(t._sunPostProcess=t._sunPostProcess.destroy(),t._sunBloom=!1);let d=t._clearColorCommand;z.clone(i,d.color),d.execute(o,n);let h=s.useGlobeDepthFramebuffer=f(a.globeDepth);h&&(a.globeDepth.update(o,n,a.viewport,t.msaaSamples,t._hdr,s.clearGlobeDepth),a.globeDepth.clear(o,n,i));let _=a.oit,y=s.useOIT=!l&&f(_)&&_.isSupported();y&&(_.update(o,n,a.globeDepth.colorFramebufferManager,t._hdr,t.msaaSamples),_.clear(o,n,i),s.useOIT=_.isSupported());let p=t.postProcessStages,C=s.usePostProcess=!l&&(t._hdr||p.length>0||p.ambientOcclusion.enabled||p.fxaa.enabled||p.bloom.enabled);if(s.usePostProcessSelected=!1,C&&(a.sceneFramebuffer.update(o,a.viewport,t._hdr,t.msaaSamples),a.sceneFramebuffer.clear(o,n,i),p.update(o,r.useLogDepth,t._hdr),p.clear(o),C=s.usePostProcess=p.ready,s.usePostProcessSelected=C&&p.hasSelected),s.isSunVisible&&t.sunBloom&&!u?(n.framebuffer=t._sunPostProcess.update(n),t._sunPostProcess.clear(o,n,i)):h?n.MirrorEnable?n.framebuffer=xt.mirror.MirrorFrameBuffer:n.framebuffer=a.globeDepth.framebuffer:C&&(n.framebuffer=a.sceneFramebuffer.framebuffer),f(n.framebuffer)&&d.execute(o,n),s.useInvertClassification=!l&&f(n.framebuffer)&&t.invertClassification){let T;if(t.frameState.invertClassificationColor.alpha===1&&s.useGlobeDepthFramebuffer&&(T=a.globeDepth.framebuffer),f(T)||o.depthTexture){if(t._invertClassification.previousFramebuffer=T,t._invertClassification.update(o,t.msaaSamples,a.globeDepth.colorFramebufferManager),t._invertClassification.clear(o,n),t.frameState.invertClassificationColor.alpha<1&&y){let E=t._invertClassification.unclassifiedCommand,S=E.derivedCommands;S.oit=_.createDerivedCommands(E,o,S.oit)}}else s.useInvertClassification=!1}t._globeTranslucencyState.translucent&&a.globeTranslucencyFramebuffer.updateAndClear(t._hdr,a.viewport,o,n)}Ni.prototype.resolveFramebuffers=function(t){let n=this._context,i=this._environmentState,o=this._view,r=o.globeDepth;f(r)&&r.prepareColorTextures(n);let s=i.useOIT,a=i.useGlobeDepthFramebuffer,c=i.usePostProcess,l=i.originalFramebuffer,u=a?r.colorFramebufferManager:void 0,d=o.sceneFramebuffer._colorFramebuffer,h=o.sceneFramebuffer.idFramebuffer;s&&(t.framebuffer=c?d.framebuffer:l,o.oit.execute(n,t));let _=o.translucentTileClassification;if(_.hasTranslucentDepth&&_.isSupported()&&_.execute(this,t),c){o.sceneFramebuffer.prepareColorTextures(n);let y=d;a&&!s&&(y=u);let p=this.postProcessStages,C=y.getColorTexture(0),x=h.getColorTexture(0),T=A(u,d).getDepthStencilTexture();p.execute(n,C,T,x),p.copy(n,l)}!s&&!c&&a&&(t.framebuffer=l,r.executeCopyColor(n,t))};function Fdt(t){let n=t._frameState.afterRender;for(let i=0,o=n.length;i<o;++i)n[i]()&&t.requestRender();n.length=0}function Ndt(t){let n=t._globe,o=t.camera.positionCartographic;if(f(n)&&n.show&&f(o))return n.getHeight(o)}function Vdt(t){let n=t.camera,i=t._mode,o=t.globe,r=t._screenSpaceCameraController,s=n.positionCartographic;if(!f(s))return!1;if(!r.onMap()&&s.height<0)return!0;if(!f(o)||!o.show||i===ne.SCENE2D||i===ne.MORPHING)return!1;let a=t._globeHeight;return f(a)&&s.height<a}Ni.prototype.initializeFrame=function(){this._shaderFrameCount++===120&&(this._shaderFrameCount=0,this._context.shaderCache.destroyReleasedShaderPrograms(),this._context.textureCache.destroyReleasedTextures()),this._tweens.update(),this._globeHeight=Ndt(this),this._cameraUnderground=Vdt(this),this._globeTranslucencyState.update(this),this._screenSpaceCameraController.update(),f(this._deviceOrientationCameraController)&&this._deviceOrientationCameraController.update(),this.camera.update(this._mode),this.camera._updateCameraChanged()};function kdt(t,n){if(t.debugShowFramesPerSecond){if(!f(t._performanceDisplay)){let i=document.createElement("div");i.style.display="none",i.className="cesium-performanceDisplay-defaultContainer",t._canvas.parentNode.appendChild(i);let r=new Qg({container:i});t._performanceDisplay=r,t._performanceContainer=i}t._performanceDisplay.throttled=t.requestRenderMode,t._performanceDisplay.update(n)}else f(t._performanceDisplay)&&(t._performanceDisplay=t._performanceDisplay&&t._performanceDisplay.destroy(),t._performanceContainer.parentNode.removeChild(t._performanceContainer))}function Udt(t){t._jobScheduler.resetBudgets();let n=t._frameState;t.primitives.prePassesUpdate(n),f(t.globe)&&t.globe.update(n),t._picking.update(),n.creditDisplay.update()}function zdt(t){let n=t._frameState;t.primitives.postPassesUpdate(n),ec.update()}var Hdt=new z;function Gdt(t,n,i){if(!t||!i||!n)return;let o=m.subtract(t,n,new m),r=m.dot(i,o),s=m.multiplyByScalar(i,r,new m);return m.subtract(t,s,new m)}function Wdt(t,n,i){if(!t)return;let o={position:new m,positionWC:new m,up:new m,upWC:new m,direction:new m,directionWC:new m,right:new m,rightWC:new m};return o.positionWC=Iq(t.positionWC,n,i),N.multiplyByPoint(t.inverseTransform,o.positionWC,o.position),o.upWC=vq(t.positionWC,t.upWC,n,i,1),N.multiplyByPointAsVector(t.inverseTransform,o.upWC,o.up),o.directionWC=vq(t.positionWC,t.directionWC,n,i,1),N.multiplyByPointAsVector(t.inverseTransform,o.directionWC,o.direction),o.rightWC=vq(t.positionWC,t.rightWC,n,i,1),N.multiplyByPointAsVector(t.inverseTransform,o.rightWC,o.right),o}function Iq(t,n,i){if(!t||!i||!n)return;let o=Gdt(t,n,i),r=m.normalize(m.subtract(o,t,new m),new m),s=m.distance(t,o),a=new dn(o,r);return dn.getPoint(a,s)}function vq(t,n,i,o,r){if(!n||!o||!t)return;let s=new dn(t,n),a=dn.getPoint(s,1*r),c=Iq(t,i,o),l=Iq(a,i,o);return m.normalize(m.subtract(l,c,new m),new m)}function jdt(t){let n=t._frameState,i=t.context;xt.resetBloomSize=!1,(xt.oldWidth!==i.drawingBufferWidth||xt.oldHeight!==i.drawingBufferHeight)&&(xt.resetBloomSize=!0,xt.oldWidth=i.drawingBufferWidth,xt.oldHeight=i.drawingBufferHeight);let o=i.uniformState,r=t._defaultView;t._view=r,t.updateFrameState(),n.passes.render=!0,n.passes.postProcess=t.postProcessStages.hasSelected,n.tilesetPassState=ldt;let s=A(t.backgroundColor,z.BLACK);t._hdr&&(s=z.clone(s,Hdt),s.red=Math.pow(s.red,t.gamma),s.green=Math.pow(s.green,t.gamma),s.blue=Math.pow(s.blue,t.gamma)),n.backgroundColor=s,t.fog.update(n),o.update(n);let a=t.shadowMap;f(a)&&a.enabled&&(!f(t.light)||t.light instanceof Ug?m.negate(o.sunDirectionWC,t._shadowMapCamera.direction):m.clone(t.light.direction,t._shadowMapCamera.direction),n.shadowMaps.push(a)),t._computeCommandList.length=0,t._overlayCommandList.length=0;let c=r.passState,l=t.globe.show;if(xt.mirror.MirrorEnable){if((xt.definitionChange||xt.resetBloomSize&&xt.mirror.MirrorFrameBuffer)&&(xt.mirror.colorTexture.destroy(),xt.mirror.MirrorFrameBuffer.destroy(),xt.mirror.colorTexture=null,xt.mirror.MirrorFrameBuffer=null,xt.definitionChange=!1),c.MirrorEnable=!0,t._globe.show=!1,!xt.mirror.MirrorFrameBuffer){let x=new St({context:i,width:i.drawingBufferWidth*(xt.inverSceneDefinition||1),height:i.drawingBufferHeight*(xt.inverSceneDefinition||1),pixelFormat:st.RGBA,pixelDatatype:je.FLOAT,flipY:!1});xt.mirror.colorTexture=x;let T=new St({context:i,width:i.drawingBufferWidth*(xt.inverSceneDefinition||1),height:i.drawingBufferHeight*(xt.inverSceneDefinition||1),pixelFormat:st.DEPTH_STENCIL,pixelDatatype:je.UNSIGNED_INT_24_8});xt.mirror.MirrorFrameBuffer=new Xo({context:i,colorTextures:[x],depthStencilTexture:T})}c.framebuffer=xt.mirror.MirrorFrameBuffer;let d=new m,h=de.fromCartesian(t._view.camera.positionWC);d=m.fromRadians(h.longitude,h.latitude);let _=m.normalize(d,new m),y=Wdt(t._view.camera,d,_),p={};p.position=new m(t.camera.position.x,t.camera.position.y,t.camera.position.z),p.right=new m(t.camera.right.x,t.camera.right.y,t.camera.right.z),p.up=new m(t.camera.up.x,t.camera.up.y,t.camera.up.z),p.direction=new m(t.camera.direction.x,t.camera.direction.y,t.camera.direction.z),t.camera.position=y.position,t.camera.right=y.right,t.camera.direction=y.direction,t.camera.up=y.up,t.camera.frustum.near=.1;let C=r.viewport;c.viewport=He.clone(c.viewport,C),c.viewport.width=c.viewport.width*(xt.inverSceneDefinition||1),c.viewport.height=c.viewport.height*(xt.inverSceneDefinition||1),t.updateEnvironment(),t.updateAndExecuteCommands(c,s),c.framebuffer=xt.mirror.MirrorFrameBuffer,t.camera.position=p.position,t.camera.right=p.right,t.camera.direction=p.direction,t.camera.up=p.up,t.camera.frustum.near=1,xt.mirror.stcTex&&xt.mirror.stcTex.destroy(),xt.mirror.stcTex=null,xt.mirror.stcTex=St.fromFramebuffer({context:i,framebuffer:xt.mirror.MirrorFrameBuffer}),t._globe.show=l}let u=r.viewport;if(u.x=0,u.y=0,u.width=i.drawingBufferWidth,u.height=i.drawingBufferHeight,c.MirrorEnable=!1,c.framebuffer=void 0,c.blendingEnabled=void 0,c.scissorTest=void 0,c.viewport=He.clone(u,c.viewport),f(t.globe)&&t.globe.beginFrame(n),t.updateEnvironment(),t.updateAndExecuteCommands(c,s),t.resolveFramebuffers(c),c.framebuffer=void 0,c.framebuffer=xt.MirrorFrameBuffer,xt.bloomInside.primitiveBloomFBO){let d=xt.bloomInside,h=xt.bloomInside,_=xt.bloomInside;if(xt.resetBloomSize&&_.brightColorFbo&&(_.brightColorT&&_.brightColorT.destroy(),_.brightColorFbo&&_.brightColorFbo.destroy(),_.brightColorT=null,_.brightColorFbo=null,_.blurXT&&_.blurXT.destroy(),_.blurXFbo&&_.blurXFbo.destroy(),_.blurXT=null,_.blurXFbo=null,_.blurYT&&_.blurYT.destroy(),_.blurYFbo&&_.blurYFbo.destroy(),_.blurYT=null,_.blurYFbo=null),!_.brightColorFbo){let x=new St({context:i,width:i.drawingBufferWidth,height:i.drawingBufferHeight,pixelFormat:st.RGBA,pixelDatatype:je.FLOAT,flipY:!1});_.brightColorT=x,_.brightColorFbo=new Xo({context:i,colorTextures:[x]});let T=new St({context:i,width:i.drawingBufferWidth/(xt.bloomSizeScale||1),height:i.drawingBufferHeight/(xt.bloomSizeScale||1),pixelFormat:st.RGBA,pixelDatatype:je.FLOAT,flipY:!1});_.blurXT=T,_.blurXFbo=new Xo({context:i,colorTextures:[T]});let E=new St({context:i,width:i.drawingBufferWidth/(xt.bloomSizeScale||1),height:i.drawingBufferHeight/(xt.bloomSizeScale||1),pixelFormat:st.RGBA,pixelDatatype:je.FLOAT,flipY:!1});if(_.blurYT=E,_.blurYFbo=new Xo({context:i,colorTextures:[E]}),!_.clearFboCommand){_.clearFboCommand=new Qn({color:new z(0,0,0,0),depth:!0}),_.brightColorCommand=i.createViewportQuadCommand("uniform sampler2D colorTexture;          uniform float fgNum;          varying vec2 v_textureCoordinates;          void main() {               vec4 result = texture2D(colorTexture,v_textureCoordinates);              float brightness = dot(result.rgb, vec3(0.2126, 0.7152, 0.0722));              vec4 BrightColor;              if(brightness > fgNum){                  BrightColor = vec4(result.rgb, 1.0);              } else {                  BrightColor = vec4(0.0, 0.0, 0.0, 1.0);              }              gl_FragColor = BrightColor;          }",{renderState:Ve.fromCache(),uniformMap:{colorTexture:function(){return xt.bloomInside.primitiveBloomFBO._colorTextures[0]},fgNum:function(){return d.fgNum||0}}});let S="uniform sampler2D colorTexture;    uniform vec2 sizeDC;    uniform vec2 dir;    uniform float blurRadius;    uniform float brightStrength;    varying vec2 v_textureCoordinates;    void main()    {        vec4 sum = vec4(0.0);        vec2 tc = v_textureCoordinates;        float blurX = blurRadius/sizeDC.x;        float blurY = blurRadius/sizeDC.y;        float hstep = dir.x;        float vstep = dir.y;        vec4 color = vec4(0.0,0.0,0.0,0.0);        color += texture2D(colorTexture,vec2(tc.x - 5.0*blurX*hstep, tc.y - 5.0*blurY*vstep)) * 0.1;        color += texture2D(colorTexture,vec2(tc.x - 4.5*blurX*hstep, tc.y - 4.5*blurY*vstep)) * 0.1;        color += texture2D(colorTexture,vec2(tc.x - 4.0*blurX*hstep, tc.y - 4.0*blurY*vstep)) * 0.22;        color += texture2D(colorTexture,vec2(tc.x - 3.5*blurX*hstep, tc.y - 3.5*blurY*vstep)) * 0.22;        color += texture2D(colorTexture,vec2(tc.x - 3.0*blurX*hstep, tc.y - 3.0*blurY*vstep)) * 0.358;        color += texture2D(colorTexture,vec2(tc.x - 2.5*blurX*hstep, tc.y - 2.5*blurY*vstep)) * 0.358;        color += texture2D(colorTexture,vec2(tc.x - 2.0*blurX*hstep, tc.y - 2.0*blurY*vstep)) * 0.523;        color += texture2D(colorTexture,vec2(tc.x - 1.5*blurX*hstep, tc.y - 1.5*blurY*vstep)) * 0.523;        color += texture2D(colorTexture,vec2(tc.x - 1.0*blurX*hstep, tc.y - 1.0*blurY*vstep)) * 0.843;        color += texture2D(colorTexture,vec2(tc.x - 0.5*blurX*hstep, tc.y - 0.5*blurY*vstep)) * 0.843;        color += texture2D(colorTexture,tc ) * 1.0;        color += texture2D(colorTexture,vec2(tc.x + 0.5*blurX*hstep, tc.y + 0.5*blurY*vstep)) * 0.843;        color += texture2D(colorTexture,vec2(tc.x + 1.0*blurX*hstep, tc.y + 1.0*blurY*vstep)) * 0.843;        color += texture2D(colorTexture,vec2(tc.x + 1.5*blurX*hstep, tc.y + 1.5*blurY*vstep)) * 0.523;        color += texture2D(colorTexture,vec2(tc.x + 2.0*blurX*hstep, tc.y + 2.0*blurY*vstep)) * 0.523;        color += texture2D(colorTexture,vec2(tc.x + 2.5*blurX*hstep, tc.y + 2.5*blurY*vstep)) * 0.358;        color += texture2D(colorTexture,vec2(tc.x + 3.0*blurX*hstep, tc.y + 3.0*blurY*vstep)) * 0.358;        color += texture2D(colorTexture,vec2(tc.x + 3.5*blurX*hstep, tc.y + 3.5*blurY*vstep)) * 0.22;        color += texture2D(colorTexture,vec2(tc.x + 4.0*blurX*hstep, tc.y + 4.0*blurY*vstep)) * 0.22;        color += texture2D(colorTexture,vec2(tc.x + 4.5*blurX*hstep, tc.y + 4.5*blurY*vstep)) * 0.1;        color += texture2D(colorTexture,vec2(tc.x + 5.0*blurX*hstep, tc.y + 5.0*blurY*vstep)) * 0.1;        color /= brightStrength;         gl_FragColor = color;    }    ";_.gaussXCommand=i.createViewportQuadCommand(S,{renderState:Ve.fromCache(),uniformMap:{blurRadius:function(){return d.blurRadius||1},sizeDC:function(){return new W(i.drawingBufferWidth,i.drawingBufferHeight)},colorTexture:function(){return h.currBlurFbo._colorTextures[0]},dir:function(){return new W(1,0)},brightStrength:function(){return d.brightStrength}}}),_.gaussXCommand._renderState=Ve.fromCache({viewport:new He(0,0,i.drawingBufferWidth/(xt.bloomSizeScale||1),i.drawingBufferHeight/(xt.bloomSizeScale||1))}),_.gaussYCommand=i.createViewportQuadCommand(S,{renderState:Ve.fromCache(),uniformMap:{blurRadius:function(){return d.blurRadius||1},sizeDC:function(){return new W(i.drawingBufferWidth,i.drawingBufferHeight)},colorTexture:function(){return h.blurXFbo._colorTextures[0]},dir:function(){return new W(0,1)},brightStrength:function(){return d.brightStrength}}}),_.gaussYCommand._renderState=Ve.fromCache({viewport:new He(0,0,i.drawingBufferWidth/(xt.bloomSizeScale||1),i.drawingBufferHeight/(xt.bloomSizeScale||1))})}_.brightColorCommand.framebuffer=h.brightColorFbo,_.gaussXCommand.framebuffer=h.blurXFbo,_.gaussYCommand.framebuffer=h.blurYFbo}let y=h.gaussXCommand,p=h.gaussYCommand,C=h.brightColorCommand;h.clearFboCommand.depth=!1,h.clearFboCommand.framebuffer=h.blurXFbo,h.clearFboCommand.execute(i),h.clearFboCommand.framebuffer=h.blurYFbo,h.clearFboCommand.execute(i),i.draw(C),h.currBlurFbo=h.brightColorFbo,i.draw(y),i.draw(p),h.clearFboCommand.framebuffer=h.blurXFbo,h.clearFboCommand.execute(i),h.currBlurFbo=h.blurYFbo,i.draw(y),h.clearFboCommand.framebuffer=h.blurYFbo,h.clearFboCommand.execute(i),i.draw(p),h.clearFboCommand.framebuffer=h.blurXFbo,h.clearFboCommand.execute(i),i.draw(y),h.clearFboCommand.framebuffer=h.blurYFbo,h.clearFboCommand.execute(i),i.draw(p)}if(xdt(t,c),xt.bloomInside.primitiveBloomFBO){if(!xt.bloomInside.pasteScreenCommand){let d=`uniform sampler2D u_texture;
uniform sampler2D u_polygonArea;
uniform vec4 u_glowColor;
varying vec2 v_textureCoordinates;
void main()
{
    vec4 bloomColor = texture2D(u_texture, v_textureCoordinates);
    vec4 areaColor = texture2D(u_polygonArea, v_textureCoordinates);
    if(areaColor.r >0.0 || areaColor.g >0.0 || areaColor.b >0.0){gl_FragColor = bloomColor;}
}
`,h=new Ve;h.blending.enabled=!0,h.blending.functionDestinationAlpha=ee.ONE,h.blending.functionDestinationRgb=ee.ONE,xt.bloomInside.pasteScreenCommand=i.createViewportQuadCommand(d,{renderState:h,uniformMap:{u_texture:function(){return xt.bloomInside.blurYFbo._colorTextures[0]||i._defaultTexture},u_polygonArea:function(){return xt.bloomInside.primitiveBloomFBOInside&&xt.bloomInside.primitiveBloomFBOInside._colorTextures[0]||i._defaultTexture}},pass:Te.OVERLAY})}xt.bloomInside.pasteScreenCommand.execute(i,c)}f(t.globe)&&(t.globe.endFrame(n),t.globe.tilesLoaded||(t._renderRequested=!0)),n.lightSource.resetChange(),i.endFrame()}function BA(t,n){try{n(t)}catch(i){if(t._renderError.raiseEvent(t,i),t.rethrowRenderErrors)throw i}}function qdt(t){return t._picking.updateMostDetailedRayPicks(t)}Ni.prototype.render=function(t){this._preUpdate.raiseEvent(this,t),xt.bloomInside.primitiveBloomFBO&&xt.bloomInside.clearFboCommand&&(xt.bloomInside.clearFboCommand.depth=!0,xt.bloomInside.clearFboCommand.framebuffer=xt.bloomInside.primitiveBloomFBO,xt.bloomInside.clearFboCommand.execute(this.context),xt.bloomInside.clearFboCommand.framebuffer=xt.bloomInside.primitiveBloomFBOInside,xt.bloomInside.clearFboCommand.execute(this.context));let n=this._frameState;n.newFrame=!1,f(t)||(t=te.now());let i=this._view.checkForCameraUpdates(this),o=!this.requestRenderMode||this._renderRequested||i||this._logDepthBufferDirty||this._hdrDirty||this.mode===ne.MORPHING;if(!o&&f(this.maximumRenderTimeChange)&&f(this._lastRenderTime)){let r=Math.abs(te.secondsDifference(this._lastRenderTime,t));o=o||r>this.maximumRenderTimeChange}if(o){this._lastRenderTime=te.clone(t,this._lastRenderTime),this._renderRequested=!1,this._logDepthBufferDirty=!1,this._hdrDirty=!1;let r=B.incrementWrap(n.frameNumber,15e6,1);a0e(this,r,t),n.newFrame=!0}BA(this,Udt),this.primitives.show&&(BA(this,qdt),BA(this,Ydt),BA(this,Xdt),o||BA(this,Kdt)),this._postUpdate.raiseEvent(this,t),o&&(this._preRender.raiseEvent(this,t),n.creditDisplay.beginFrame(),BA(this,jdt)),kdt(this,o),BA(this,zdt),Fdt(this),o&&(this._postRender.raiseEvent(this,t),n.creditDisplay.endFrame())};Ni.prototype.forceRender=function(t){this._renderRequested=!0,this.render(t)};Ni.prototype.requestRender=function(){this._renderRequested=!0};Ni.prototype.clampLineWidth=function(t){return Math.max(Ut.minimumAliasedLineWidth,Math.min(t,Ut.maximumAliasedLineWidth))};Ni.prototype.pick=function(t,n,i){return this._picking.pick(this,t,n,i)};Ni.prototype.pickPositionWorldCoordinates=function(t,n){return this._picking.pickPositionWorldCoordinates(this,t,n)};Ni.prototype.pickPosition=function(t,n){return this._picking.pickPosition(this,t,n)};Ni.prototype.drillPick=function(t,n,i,o){return this._picking.drillPick(this,t,n,i,o)};function Ydt(t){let n=t._frameState;Sq.camera=n.camera,Sq.cullingVolume=n.cullingVolume,t.primitives.updateForPass(n,Sq)}function Xdt(t){let n=t._frameState;if(!n.camera.canPreloadFlight())return;wq.camera=t.preloadFlightCamera,wq.cullingVolume=t.preloadFlightCullingVolume,t.primitives.updateForPass(n,wq)}function Kdt(t){t.primitives.updateForPass(t._frameState,udt)}Ni.prototype.pickFromRay=function(t,n,i){return this._picking.pickFromRay(this,t,n,i)};Ni.prototype.drillPickFromRay=function(t,n,i,o){return this._picking.drillPickFromRay(this,t,n,i,o)};Ni.prototype.pickFromRayMostDetailed=function(t,n,i){return this._picking.pickFromRayMostDetailed(this,t,n,i)};Ni.prototype.drillPickFromRayMostDetailed=function(t,n,i,o){return this._picking.drillPickFromRayMostDetailed(this,t,n,i,o)};Ni.prototype.sampleHeight=function(t,n,i){return this._picking.sampleHeight(this,t,n,i)};Ni.prototype.clampToHeight=function(t,n,i,o){return this._picking.clampToHeight(this,t,n,i,o)};Ni.prototype.sampleHeightMostDetailed=function(t,n,i){return this._picking.sampleHeightMostDetailed(this,t,n,i)};Ni.prototype.clampToHeightMostDetailed=function(t,n,i){return this._picking.clampToHeightMostDetailed(this,t,n,i)};Ni.prototype.cartesianToCanvasCoordinates=function(t,n){return Yi.wgs84ToWindowCoordinates(this,t,n)};Ni.prototype.completeMorph=function(){this._transitioner.completeMorph()};Ni.prototype.morphTo2D=function(t){let n,i=this.globe;f(i)?n=i.ellipsoid:n=this.mapProjection.ellipsoid,t=A(t,2),this._transitioner.morphTo2D(t,n)};Ni.prototype.morphToColumbusView=function(t){let n,i=this.globe;f(i)?n=i.ellipsoid:n=this.mapProjection.ellipsoid,t=A(t,2),this._transitioner.morphToColumbusView(t,n)};Ni.prototype.morphTo3D=function(t){let n,i=this.globe;f(i)?n=i.ellipsoid:n=this.mapProjection.ellipsoid,t=A(t,2),this._transitioner.morphTo3D(t,n)};Ni.prototype.isDestroyed=function(){return!1};Ni.prototype.destroy=function(){this._tweens.removeAll(),this._computeEngine=this._computeEngine&&this._computeEngine.destroy(),this._screenSpaceCameraController=this._screenSpaceCameraController&&this._screenSpaceCameraController.destroy(),this._deviceOrientationCameraController=this._deviceOrientationCameraController&&!this._deviceOrientationCameraController.isDestroyed()&&this._deviceOrientationCameraController.destroy(),this._primitives=this._primitives&&this._primitives.destroy(),this._groundPrimitives=this._groundPrimitives&&this._groundPrimitives.destroy(),this._globe=this._globe&&this._globe.destroy(),this.skyBox=this.skyBox&&this.skyBox.destroy(),this.skyAtmosphere=this.skyAtmosphere&&this.skyAtmosphere.destroy(),this._debugSphere=this._debugSphere&&this._debugSphere.destroy(),this.sun=this.sun&&this.sun.destroy(),this._sunPostProcess=this._sunPostProcess&&this._sunPostProcess.destroy(),this._depthPlane=this._depthPlane&&this._depthPlane.destroy(),this._transitioner=this._transitioner&&this._transitioner.destroy(),this._debugFrustumPlanes=this._debugFrustumPlanes&&this._debugFrustumPlanes.destroy(),this._brdfLutGenerator=this._brdfLutGenerator&&this._brdfLutGenerator.destroy(),this._picking=this._picking&&this._picking.destroy(),this._defaultView=this._defaultView&&this._defaultView.destroy(),this._view=void 0,this._removeCreditContainer&&this._canvas.parentNode.removeChild(this._creditContainer),this.postProcessStages=this.postProcessStages&&this.postProcessStages.destroy(),this._context=this._context&&this._context.destroy(),this._frameState.creditDisplay=this._frameState.creditDisplay&&this._frameState.creditDisplay.destroy(),f(this._performanceDisplay)&&(this._performanceDisplay=this._performanceDisplay&&this._performanceDisplay.destroy(),this._performanceContainer.parentNode.removeChild(this._performanceContainer)),this._removeRequestListenerCallback(),this._removeTaskProcessorListenerCallback();for(let t=0;t<this._removeGlobeCallbacks.length;++t)this._removeGlobeCallbacks[t]();return this._removeGlobeCallbacks.length=0,ue(this)};var T4=Ni;function ib(t){t=A(t,oe.WGS84),this.show=!0,this.perFragmentAtmosphere=!1,this._ellipsoid=t;let n=1.025,i=m.multiplyByScalar(t.radii,n,new m);this._scaleMatrix=N.fromScale(i),this._modelMatrix=new N,this._command=new et({owner:this,modelMatrix:this._modelMatrix}),this._spSkyFromSpace=void 0,this._spSkyFromAtmosphere=void 0,this._flags=void 0,this.atmosphereLightIntensity=50,this.atmosphereRayleighCoefficient=new m(55e-7,13e-6,284e-7),this.atmosphereMieCoefficient=new m(21e-6,21e-6,21e-6),this.atmosphereRayleighScaleHeight=1e4,this.atmosphereMieScaleHeight=3200,this.atmosphereMieAnisotropy=.9,this.hueShift=0,this.saturationShift=0,this.brightnessShift=0,this._hueSaturationBrightness=new m;let o=new m;o.x=t.maximumRadius*n,o.y=t.maximumRadius,o.z=0,this._radiiAndDynamicAtmosphereColor=o;let r=this;this._command.uniformMap={u_radiiAndDynamicAtmosphereColor:function(){return r._radiiAndDynamicAtmosphereColor},u_hsbShift:function(){return r._hueSaturationBrightness.x=r.hueShift,r._hueSaturationBrightness.y=r.saturationShift,r._hueSaturationBrightness.z=r.brightnessShift,r._hueSaturationBrightness},u_atmosphereLightIntensity:function(){return r.atmosphereLightIntensity},u_atmosphereRayleighCoefficient:function(){return r.atmosphereRayleighCoefficient},u_atmosphereMieCoefficient:function(){return r.atmosphereMieCoefficient},u_atmosphereRayleighScaleHeight:function(){return r.atmosphereRayleighScaleHeight},u_atmosphereMieScaleHeight:function(){return r.atmosphereMieScaleHeight},u_atmosphereMieAnisotropy:function(){return r.atmosphereMieAnisotropy}}}Object.defineProperties(ib.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}});ib.prototype.setDynamicAtmosphereColor=function(t,n){let i=t?n?2:1:0;this._radiiAndDynamicAtmosphereColor.z=i};var Oq=new N;ib.prototype.update=function(t,n){if(!this.show)return;let i=t.mode;if(i!==ne.SCENE3D&&i!==ne.MORPHING||!t.passes.render)return;let o=N.fromRotationTranslation(t.context.uniformState.inverseViewRotation,m.ZERO,Oq),r=N.multiplyTransformation(o,vo.Y_UP_TO_Z_UP,Oq),s=N.multiply(this._scaleMatrix,r,Oq);N.clone(s,this._modelMatrix);let a=t.context,c=Jdt(this),l=t.globeTranslucencyState.translucent,u=this.perFragmentAtmosphere||l||!f(n)||!n.show,d=this._command;if(!f(d.vertexArray)){let _=Vs.createGeometry(new Vs({radii:new m(1,1,1),slicePartitions:256,stackPartitions:256,vertexFormat:De.POSITION_ONLY}));d.vertexArray=$n.fromGeometry({context:a,geometry:_,attributeLocations:Fn.createAttributeLocations(_),bufferUsage:Fe.STATIC_DRAW}),d.renderState=Ve.fromCache({cull:{enabled:!0,face:xi.FRONT},blending:ln.ALPHA_BLEND,depthMask:!1})}let h=c|u<<2|l<<3;if(h!==this._flags){this._flags=h;let _=[];c&&_.push("COLOR_CORRECT"),u&&_.push("PER_FRAGMENT_ATMOSPHERE"),l&&_.push("GLOBE_TRANSLUCENT");let y=new ze({defines:_,sources:[zg,QD,zV]}),p=new ze({defines:_,sources:[zg,QD,UV]});this._spSkyAtmosphere=qt.fromCache({context:a,vertexShaderSource:y,fragmentShaderSource:p}),d.shaderProgram=this._spSkyAtmosphere}return d};function Jdt(t){return!(B.equalsEpsilon(t.hueShift,0,B.EPSILON7)&&B.equalsEpsilon(t.saturationShift,0,B.EPSILON7)&&B.equalsEpsilon(t.brightnessShift,0,B.EPSILON7))}ib.prototype.isDestroyed=function(){return!1};ib.prototype.destroy=function(){let t=this._command;return t.vertexArray=t.vertexArray&&t.vertexArray.destroy(),this._spSkyAtmosphere=this._spSkyAtmosphere&&this._spSkyAtmosphere.destroy(),ue(this)};var E4=ib;function Rq(t){t=A(t,1),this._radius=A(t,1)}Object.defineProperties(Rq.prototype,{radius:{get:function(){return this._radius},set:function(t){this._radius=t}}});Rq.prototype.emit=function(t){let n=B.randomBetween(0,B.TWO_PI),i=B.randomBetween(0,B.PI),o=B.randomBetween(0,this._radius),r=o*Math.cos(n)*Math.sin(i),s=o*Math.sin(n)*Math.sin(i),a=o*Math.cos(i);t.position=m.fromElements(r,s,a,t.position),t.velocity=m.normalize(t.position,t.velocity)};var f0e=Rq;function Yv(){}Yv.prototype.evaluate=function(t,n){Ce.throwInstantiationError()};Yv.prototype.evaluateColor=function(t,n){Ce.throwInstantiationError()};Yv.prototype.getShaderFunction=function(t,n,i,o){Ce.throwInstantiationError()};Yv.prototype.getVariables=function(){Ce.throwInstantiationError()};var d0e=Yv;function Kv(){this.show=!0,this._drawCommand=new et({primitiveType:Re.TRIANGLES,boundingVolume:new ae,owner:this}),this._commands={drawCommand:this._drawCommand,computeCommand:void 0},this._boundingVolume=new ae,this._boundingVolume2D=new ae,this._texture=void 0,this._drawingBufferWidth=void 0,this._drawingBufferHeight=void 0,this._radiusTS=void 0,this._size=void 0,this.glowFactor=1,this._glowFactorDirty=!1,this._useHdr=void 0;let t=this;this._uniformMap={u_texture:function(){return t._texture},u_size:function(){return t._size}}}Object.defineProperties(Kv.prototype,{glowFactor:{get:function(){return this._glowFactor},set:function(t){t=Math.max(t,0),this._glowFactor=t,this._glowFactorDirty=!0}}});var Zdt=new W,Qdt=new W,$dt=new se,Xv=new se;Kv.prototype.update=function(t,n,i){if(!this.show)return;let o=t.mode;if(o===ne.SCENE2D||o===ne.MORPHING||!t.passes.render)return;let r=t.context,s=n.viewport.width,a=n.viewport.height;if(!f(this._texture)||s!==this._drawingBufferWidth||a!==this._drawingBufferHeight||this._glowFactorDirty||i!==this._useHdr){this._texture=this._texture&&this._texture.destroy(),this._drawingBufferWidth=s,this._drawingBufferHeight=a,this._glowFactorDirty=!1,this._useHdr=i;let w=Math.max(s,a);w=Math.pow(2,Math.ceil(Math.log(w)/Math.log(2))-2),w=Math.max(1,w);let D=i?r.halfFloatingPointTexture?je.HALF_FLOAT:je.FLOAT:je.UNSIGNED_BYTE;this._texture=new St({context:r,width:w,height:w,pixelFormat:st.RGBA,pixelDatatype:D}),this._glowLengthTS=this._glowFactor*5,this._radiusTS=1/(1+2*this._glowLengthTS)*.5;let I=this,O={u_radiusTS:function(){return I._radiusTS}};this._commands.computeCommand=new Pf({fragmentShaderSource:GV,outputTexture:this._texture,uniformMap:O,persists:!1,owner:this,postExecute:function(){I._commands.computeCommand=void 0}})}let c=this._drawCommand;if(!f(c.vertexArray)){let w={direction:0},D=new Uint8Array(4*2);D[0]=0,D[1]=0,D[2]=255,D[3]=0,D[4]=255,D[5]=255,D[6]=0,D[7]=255;let I=ut.createVertexBuffer({context:r,typedArray:D,usage:Fe.STATIC_DRAW}),O=[{index:w.direction,vertexBuffer:I,componentsPerAttribute:2,normalize:!0,componentDatatype:J.UNSIGNED_BYTE}],M=ut.createIndexBuffer({context:r,typedArray:new Uint16Array([0,1,2,0,2,3]),usage:Fe.STATIC_DRAW,indexDatatype:Ne.UNSIGNED_SHORT});c.vertexArray=new $n({context:r,attributes:O,indexBuffer:M}),c.shaderProgram=qt.fromCache({context:r,vertexShaderSource:WV,fragmentShaderSource:HV,attributeLocations:w}),c.renderState=Ve.fromCache({blending:ln.ALPHA_BLEND}),c.uniformMap=this._uniformMap}let l=r.uniformState.sunPositionWC,u=r.uniformState.sunPositionColumbusView,d=this._boundingVolume,h=this._boundingVolume2D;m.clone(l,d.center),h.center.x=u.z,h.center.y=u.x,h.center.z=u.y,d.radius=B.SOLAR_RADIUS+B.SOLAR_RADIUS*this._glowLengthTS,h.radius=d.radius,o===ne.SCENE3D?ae.clone(d,c.boundingVolume):o===ne.COLUMBUS_VIEW&&ae.clone(h,c.boundingVolume);let _=Yi.computeActualWgs84Position(t,l,Xv),y=m.magnitude(m.subtract(_,t.camera.position,Xv)),p=r.uniformState.projection,C=$dt;C.x=0,C.y=0,C.z=-y,C.w=1;let x=N.multiplyByVector(p,C,Xv),T=Yi.clipToGLWindowCoordinates(n.viewport,x,Zdt);C.x=B.SOLAR_RADIUS;let E=N.multiplyByVector(p,C,Xv),S=Yi.clipToGLWindowCoordinates(n.viewport,E,Qdt);return this._size=W.magnitude(W.subtract(S,T,Xv)),this._size=2*this._size*(1+2*this._glowLengthTS),this._size=Math.ceil(this._size),this._commands};Kv.prototype.isDestroyed=function(){return!1};Kv.prototype.destroy=function(){let t=this._drawCommand;return t.vertexArray=t.vertexArray&&t.vertexArray.destroy(),t.shaderProgram=t.shaderProgram&&t.shaderProgram.destroy(),this._texture=this._texture&&this._texture.destroy(),ue(this)};var b4=Kv;function ob(){}ob.prototype.boundingVolume=void 0;ob.prototype.boundingSphere=void 0;ob.prototype.distanceToCamera=function(t){Ce.throwInstantiationError()};ob.prototype.intersectPlane=function(t){Ce.throwInstantiationError()};ob.prototype.createDebugVolume=function(t){Ce.throwInstantiationError()};var h0e=ob;function Jv(t){t=A(t,A.EMPTY_OBJECT),this._tilingScheme=f(t.tilingScheme)?t.tilingScheme:new Wi({ellipsoid:t.ellipsoid}),this._color=A(t.color,z.YELLOW),this._errorEvent=new Ae,this._tileWidth=A(t.tileWidth,256),this._tileHeight=A(t.tileHeight,256),this._readyPromise=Promise.resolve(!0),this.defaultAlpha=void 0,this.defaultNightAlpha=void 0,this.defaultDayAlpha=void 0,this.defaultBrightness=void 0,this.defaultContrast=void 0,this.defaultHue=void 0,this.defaultSaturation=void 0,this.defaultGamma=void 0,this.defaultMinificationFilter=void 0,this.defaultMagnificationFilter=void 0}Object.defineProperties(Jv.prototype,{proxy:{get:function(){}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){}},minimumLevel:{get:function(){}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return!0}},readyPromise:{get:function(){return this._readyPromise}},credit:{get:function(){}},hasAlphaChannel:{get:function(){return!0}}});Jv.prototype.getTileCredits=function(t,n,i){};Jv.prototype.requestImage=function(t,n,i,o){let r=document.createElement("canvas");r.width=256,r.height=256;let s=r.getContext("2d"),a=this._color.toCssColorString();return s.strokeStyle=a,s.lineWidth=2,s.strokeRect(1,1,255,255),s.font="bold 25px Arial",s.textAlign="center",s.fillStyle=a,s.fillText(`L: ${i}`,124,86),s.fillText(`X: ${t}`,124,136),s.fillText(`Y: ${n}`,124,186),Promise.resolve(r)};Jv.prototype.pickFeatures=function(t,n,i,o,r){};var S4=Jv;function Mq(t){Ce.throwInstantiationError()}Mq.prototype.isReady=Ce.throwInstantiationError;Mq.prototype.shouldDiscardImage=Ce.throwInstantiationError;var m0e=Mq;var eht={START:0,LOADING:1,READY:2,UPSAMPLED_ONLY:3},p0e=Object.freeze(eht);function RA(t){t=A(t,A.EMPTY_OBJECT),this.show=A(t.show,!0),this.modelMatrix=N.clone(A(t.modelMatrix,N.IDENTITY)),this.shadows=A(t.shadows,gn.ENABLED),this.maximumMemoryUsage=A(t.maximumMemoryUsage,256),this.shading=new xm(t.shading),this.style=t.style,this.frameFailed=new Ae,this.frameChanged=new Ae,this._clock=t.clock,this._intervals=t.intervals,this._clippingPlanes=void 0,this.clippingPlanes=t.clippingPlanes,this._pointCloudEyeDomeLighting=new o_,this._loadTimestamp=void 0,this._clippingPlanesState=0,this._styleDirty=!1,this._pickId=void 0,this._totalMemoryUsageInBytes=0,this._frames=[],this._previousInterval=void 0,this._nextInterval=void 0,this._lastRenderedFrame=void 0,this._clockMultiplier=0,this._resolveReadyPromise=void 0;let n=this;this._readyPromise=new Promise(function(i){n._resolveReadyPromise=i}),this._runningSum=0,this._runningLength=0,this._runningIndex=0,this._runningSamples=new Array(5).fill(0),this._runningAverage=0}Object.defineProperties(RA.prototype,{clippingPlanes:{get:function(){return this._clippingPlanes},set:function(t){Qs.setOwner(t,this,"_clippingPlanes")}},totalMemoryUsageInBytes:{get:function(){return this._totalMemoryUsageInBytes}},boundingSphere:{get:function(){if(f(this._lastRenderedFrame))return this._lastRenderedFrame.pointCloud.boundingSphere}},readyPromise:{get:function(){return this._readyPromise}}});function tht(t){return`uniform vec4 czm_pickColor;
${t}`}function nht(t){return function(n){return At(n,{czm_pickColor:function(){return t._pickId.color}})}}function iht(){return"czm_pickColor"}RA.prototype.makeStyleDirty=function(){this._styleDirty=!0};RA.prototype._getAverageLoadTime=function(){return this._runningLength===0?.05:this._runningAverage};var oht=new te;function Fq(t){let n=t._clock,i=n.canAnimate&&n.shouldAnimate,o=n.multiplier;return i?o:0}function OA(t,n){return t._intervals.indexOf(n.start)}function rht(t,n){let i=t._intervals,o=t._clock,r=Fq(t);if(r===0)return;let s=t._getAverageLoadTime(),a=te.addSeconds(o.currentTime,s*r,oht),c=i.indexOf(a),l=OA(t,n);return c===l&&(r>=0?++c:--c),i.get(c)}function sht(t){let n=t._intervals,o=t._clock.currentTime,r=n.indexOf(o);return n.get(r)}function aht(t,n,i){let o=Fq(t),r=OA(t,n),s=OA(t,i);return o>=0?r>=s:r<=s}function cht(t,n){return function(i){let o=f(i.message)?i.message:i.toString();t.frameFailed.numberOfListeners>0?t.frameFailed.raiseEvent({uri:n,message:o}):(console.log(`A frame failed to load: ${n}`),console.log(`Error: ${o}`))}}function lht(t,n,i){let o=OA(t,n),r=t._frames,s=r[o];if(!f(s)){let a=n.data.transform,c=f(a)?N.fromArray(a):void 0,l=n.data.uri;s={pointCloud:void 0,transform:c,timestamp:Fi(),sequential:!0,ready:!1,touchedFrameNumber:i.frameNumber},r[o]=s,Ie.fetchArrayBuffer({url:l}).then(function(u){return s.pointCloud=new UU({arrayBuffer:u,cull:!0,fragmentShaderLoaded:tht,uniformMapLoaded:nht(t),pickIdLoaded:iht}),s.pointCloud.readyPromise}).catch(cht(t,l))}return s}function uht(t,n){t._runningSum+=n,t._runningSum-=t._runningSamples[t._runningIndex],t._runningSamples[t._runningIndex]=n,t._runningLength=Math.min(t._runningLength+1,t._runningSamples.length),t._runningIndex=(t._runningIndex+1)%t._runningSamples.length,t._runningAverage=t._runningSum/t._runningLength}function fht(t,n,i,o){n.touchedFrameNumber<o.frameNumber-1&&(n.sequential=!1);let r=n.pointCloud;if(f(r)&&!n.ready){let s=o.commandList,a=s.length;if(g0e(t,n,i,o),r.ready&&(n.ready=!0,t._totalMemoryUsageInBytes+=r.geometryByteLength,s.length=a,n.sequential)){let c=(Fi()-n.timestamp)/1e3;uht(t,c)}}n.touchedFrameNumber=o.frameNumber}var dht=new N;function hht(t,n){let i=t.shading;return f(i)&&f(i.baseResolution)?i.baseResolution:f(n.boundingSphere)?B.cbrt(n.boundingSphere.volume()/n.pointsLength):0}function mht(t){let n=t.shading;return f(n)&&f(n.maximumAttenuation)?n.maximumAttenuation:10}var pht=new xm;function g0e(t,n,i,o){let r=A(t.shading,pht),s=n.pointCloud,a=A(n.transform,N.IDENTITY);s.modelMatrix=N.multiplyTransformation(t.modelMatrix,a,dht),s.style=t.style,s.time=i.timeSinceLoad,s.shadows=t.shadows,s.clippingPlanes=t._clippingPlanes,s.isClipped=i.isClipped,s.attenuation=r.attenuation,s.backFaceCulling=r.backFaceCulling,s.normalShading=r.normalShading,s.geometricError=hht(t,s),s.geometricErrorScale=r.geometricErrorScale,s.maximumAttenuation=mht(t),s.update(o),n.touchedFrameNumber=o.frameNumber}function Lq(t,n,i,o){let r=lht(t,n,o);fht(t,r,i,o)}function _ht(t){return function(n){return n.touchedFrameNumber<t.frameNumber}}function y0e(t,n){let i=t._frames,o=i.length;for(let r=0;r<o;++r){let s=i[r];if(f(s)&&(!f(n)||n(s))){let a=s.pointCloud;s.ready&&(t._totalMemoryUsageInBytes-=a.geometryByteLength),f(a)&&a.destroy(),s===t._lastRenderedFrame&&(t._lastRenderedFrame=void 0),i[r]=void 0}}}function ght(t,n){let i=OA(t,n),o=t._frames[i];if(f(o)&&o.ready)return o}function _0e(t,n,i,o,r){return f(i)?i.ready?!0:(Lq(t,n,o,r),i.ready):!1}function yht(t,n,i,o,r){let s,a,c,l=t._intervals,u=t._frames,d=OA(t,i),h=OA(t,n);if(d>=h){for(s=d;s>=h;--s)if(a=l.get(s),c=u[s],_0e(t,a,c,o,r))return a}else for(s=d;s<=h;++s)if(a=l.get(s),c=u[s],_0e(t,a,c,o,r))return a;return n}function Aht(t,n,i){let o=t._frames,r=o.length;for(let s=0;s<r;++s){let a=o[s];f(a)&&f(a.pointCloud)&&(a.pointCloud.clippingPlanesDirty=n,a.pointCloud.styleDirty=i)}}var rb={timeSinceLoad:0,isClipped:!1,clippingPlanesDirty:!1};RA.prototype.update=function(t){if(t.mode===ne.MORPHING||!this.show)return;f(this._pickId)||(this._pickId=t.context.createPickId({primitive:this})),f(this._loadTimestamp)||(this._loadTimestamp=te.clone(t.time));let n=Math.max(te.secondsDifference(t.time,this._loadTimestamp)*1e3,0),i=this._clippingPlanes,o=0,r=!1,s=f(i)&&i.enabled;s&&(i.update(t),o=i.clippingPlanesState),this._clippingPlanesState!==o&&(this._clippingPlanesState=o,r=!0);let a=this._styleDirty;this._styleDirty=!1,(r||a)&&Aht(this,r,a),rb.timeSinceLoad=n,rb.isClipped=s;let c=this.shading,l=this._pointCloudEyeDomeLighting,u=t.commandList,d=u.length,h=this._previousInterval,_=this._nextInterval,y=sht(this);if(!f(y))return;let p=!1,C=Fq(this),x=C===0;C!==this._clockMultiplier&&(p=!0,this._clockMultiplier=C),(!f(h)||x)&&(h=y),(!f(_)||p||aht(this,y,_))&&(_=rht(this,y)),h=yht(this,h,y,rb,t);let T=ght(this,h);f(T)||(Lq(this,h,rb,t),T=this._lastRenderedFrame),f(T)&&g0e(this,T,rb,t),f(_)&&Lq(this,_,rb,t);let E=this;f(T)&&!f(this._lastRenderedFrame)&&t.afterRender.push(function(){return E._resolveReadyPromise(E),!0}),f(T)&&T!==this._lastRenderedFrame&&E.frameChanged.numberOfListeners>0&&t.afterRender.push(function(){return E.frameChanged.raiseEvent(E),!0}),this._previousInterval=h,this._nextInterval=_,this._lastRenderedFrame=T;let S=this._totalMemoryUsageInBytes,w=this.maximumMemoryUsage*1024*1024;S>w&&y0e(this,_ht(t));let I=u.length-d;f(c)&&c.attenuation&&c.eyeDomeLighting&&I>0&&l.update(t,d,c,this.boundingSphere)};RA.prototype.isDestroyed=function(){return!1};RA.prototype.destroy=function(){return y0e(this),this._clippingPlanes=this._clippingPlanes&&this._clippingPlanes.destroy(),this._pickId=this._pickId&&this._pickId.destroy(),ue(this)};var Zv=RA;function w4(t,n){this.show=!0,f(t)||(t=new He),this.rectangle=He.clone(t),f(n)||(n=$i.fromType($i.ColorType,{color:new z(1,1,1,1)})),this.material=n,this._material=void 0,this._overlayCommand=void 0,this._rs=void 0}w4.prototype.update=function(t){if(!this.show)return;let n=this._rs;if((!f(n)||!He.equals(n.viewport,this.rectangle))&&(this._rs=Ve.fromCache({blending:ln.ALPHA_BLEND,viewport:this.rectangle})),t.passes.render){let o=t.context;if(this._material!==this.material||!f(this._overlayCommand)){this._material=this.material,f(this._overlayCommand)&&this._overlayCommand.shaderProgram.destroy();let r=new ze({sources:[this._material.shaderSource,jV]});this._overlayCommand=o.createViewportQuadCommand(r,{renderState:this._rs,uniformMap:this._material._uniforms,owner:this}),this._overlayCommand.pass=Te.OVERLAY}this._material.update(o),this._overlayCommand.renderState=this._rs,this._overlayCommand.uniformMap=this._material._uniforms,t.commandList.push(this._overlayCommand)}};w4.prototype.isDestroyed=function(){return!1};w4.prototype.destroy=function(){return f(this._overlayCommand)&&(this._overlayCommand.shaderProgram=this._overlayCommand.shaderProgram&&this._overlayCommand.shaderProgram.destroy()),ue(this)};var A0e=w4;function Qv(t){f(t)||(t=new _h),this._clock=t,this._eventHelper=new Mr,this._eventHelper.add(t.onTick,this.synchronize,this),this.systemTime=xe.observable(te.now()),this.systemTime.equalityComparer=te.equals,this.startTime=xe.observable(t.startTime),this.startTime.equalityComparer=te.equals,this.startTime.subscribe(function(n){t.startTime=n,this.synchronize()},this),this.stopTime=xe.observable(t.stopTime),this.stopTime.equalityComparer=te.equals,this.stopTime.subscribe(function(n){t.stopTime=n,this.synchronize()},this),this.currentTime=xe.observable(t.currentTime),this.currentTime.equalityComparer=te.equals,this.currentTime.subscribe(function(n){t.currentTime=n,this.synchronize()},this),this.multiplier=xe.observable(t.multiplier),this.multiplier.subscribe(function(n){t.multiplier=n,this.synchronize()},this),this.clockStep=xe.observable(t.clockStep),this.clockStep.subscribe(function(n){t.clockStep=n,this.synchronize()},this),this.clockRange=xe.observable(t.clockRange),this.clockRange.subscribe(function(n){t.clockRange=n,this.synchronize()},this),this.canAnimate=xe.observable(t.canAnimate),this.canAnimate.subscribe(function(n){t.canAnimate=n,this.synchronize()},this),this.shouldAnimate=xe.observable(t.shouldAnimate),this.shouldAnimate.subscribe(function(n){t.shouldAnimate=n,this.synchronize()},this),xe.track(this,["systemTime","startTime","stopTime","currentTime","multiplier","clockStep","clockRange","canAnimate","shouldAnimate"])}Object.defineProperties(Qv.prototype,{clock:{get:function(){return this._clock}}});Qv.prototype.synchronize=function(){let t=this._clock;this.systemTime=te.now(),this.startTime=t.startTime,this.stopTime=t.stopTime,this.currentTime=t.currentTime,this.multiplier=t.multiplier,this.clockStep=t.clockStep,this.clockRange=t.clockRange,this.canAnimate=t.canAnimate,this.shouldAnimate=t.shouldAnimate};Qv.prototype.isDestroyed=function(){return!1};Qv.prototype.destroy=function(){this._eventHelper.removeAll(),ue(this)};var D4=Qv;function Cht(){this.canExecute=void 0,this.beforeExecute=void 0,this.afterExecute=void 0,Ce.throwInstantiationError()}var C0e=Cht;function xht(t,n){n=A(n,!0);let i=new Ae,o=new Ae;function r(){let s={args:arguments,cancel:!1},a;return i.raiseEvent(s),s.cancel||(a=t.apply(null,arguments),o.raiseEvent(a)),a}return r.canExecute=n,xe.track(r,["canExecute"]),Object.defineProperties(r,{beforeExecute:{value:i},afterExecute:{value:o}}),r}var Tn=xht;var Nq={};Nq.createCheckbox=function(t,n,i){let o=document.createElement("div"),r=document.createElement("label"),s=document.createElement("input");s.type="checkbox";let a=`checked: ${n}`;return f(i)&&(a+=`, enable: ${i}`),s.setAttribute("data-bind",a),r.appendChild(s),r.appendChild(document.createTextNode(t)),o.appendChild(r),o};Nq.createSection=function(t,n,i,o){let r=document.createElement("div");r.className="cesium-cesiumInspector-section",r.setAttribute("data-bind",`css: { "cesium-cesiumInspector-section-collapsed": !${i} }`),t.appendChild(r);let s=document.createElement("h3");s.className="cesium-cesiumInspector-sectionHeader",s.appendChild(document.createTextNode(n)),s.setAttribute("data-bind",`click: ${o}`),r.appendChild(s);let a=document.createElement("div");return a.className="cesium-cesiumInspector-sectionContent",r.appendChild(a),a};var o0=Nq;function Tht(t,n,i,o,r){return i.call(o,t[n]),xe.getObservable(t,n).subscribe(i,o,r)}var da=Tht;function x0e(t,n){this._command=t,n=A(n,A.EMPTY_OBJECT),this.toggled=A(n.toggled,!1),this.tooltip=A(n.tooltip,""),xe.track(this,["toggled","tooltip"])}Object.defineProperties(x0e.prototype,{command:{get:function(){return this._command}}});var MA=x0e;var T0e=`uniform sampler2D u_depthTexture;
varying vec2 v_textureCoordinates;
void main()
{
float z_window = czm_unpackDepth(texture2D(u_depthTexture, v_textureCoordinates));
z_window = czm_reverseLogDepth(z_window);
float n_range = czm_depthRange.near;
float f_range = czm_depthRange.far;
float z_ndc = (2.0 * z_window - n_range - f_range) / (f_range - n_range);
float scale = pow(z_ndc * 0.5 + 0.5, 8.0);
gl_FragColor = vec4(mix(vec3(0.0), vec3(1.0), scale), 1.0);
}
`;var v4={FLOAT:"float",VEC2:"vec2",VEC3:"vec3",VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",MAT2:"mat2",MAT3:"mat3",MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube"};for(let t=1;t<=200;t++){let n=`VEC3_ARRAY_${t}`;v4[n]=n.toLocaleLowerCase()}for(let t=1;t<=50;t++){let n=`VEC4_ARRAY_${t}`,i=`FLOAT_ARRAY_${t}`;v4[n]=n.toLocaleLowerCase(),v4[i]=i.toLocaleLowerCase()}var $v=Object.freeze(v4);function sb(){this._defaultTexture=void 0,this._textures={},this._loadedImages=[],this._lastUpdatedFrame=-1}sb.prototype.getTexture=function(t){return this._textures[t]};function Eht(t,n,i){i.resource.fetchImage().then(function(o){t._loadedImages.push({id:n,image:o,textureUniform:i})}).catch(function(){let o=t._textures[n];f(o)&&o!==t._defaultTexture&&o.destroy(),t._textures[n]=t._defaultTexture})}sb.prototype.loadTexture2D=function(t,n){f(n.typedArray)?this._loadedImages.push({id:t,textureUniform:n}):Eht(this,t,n)};function bht(t,n,i){let{id:o,textureUniform:r,image:s}=n,a=i.webgl2?P4(r,s,i):Sht(r,s,i),c=t._textures[o];f(c)&&c!==i.defaultTexture&&c.destroy(),t._textures[o]=a}function P4(t,n,i){let{typedArray:o,sampler:r}=t,s=f(o)?b0e(t,i):new St({context:i,source:n,sampler:r});return E0e(r)&&s.generateMipmap(),s}function Sht(t,n,i){let{typedArray:o,sampler:r}=t,s=E0e(r),a=r.wrapS===Mn.REPEAT||r.wrapS===Mn.MIRRORED_REPEAT||r.wrapT===Mn.REPEAT||r.wrapT===Mn.MIRRORED_REPEAT,{width:c,height:l}=f(o)?t:n,u=[c,l].every(B.isPowerOfTwo);if((s||a)&&!u)if(f(o)){if(t.pixelDatatype===je.UNSIGNED_BYTE){let h=Z3(o,c,l),_=B0(h);return P4({sampler:r},_,i)}}else{let h=B0(n);return P4(t,h,i)}else return P4(t,n,i);return s?console.warn("Texture requires resizing for mipmaps but pixelDataType cannot be resized. The texture may be rendered incorrectly."):a&&console.warn("Texture requires resizing for wrapping but pixelDataType cannot be resized. The texture may be rendered incorrectly."),b0e(t,i)}function E0e(t){return[fn.NEAREST_MIPMAP_NEAREST,fn.NEAREST_MIPMAP_LINEAR,fn.LINEAR_MIPMAP_NEAREST,fn.LINEAR_MIPMAP_LINEAR].includes(t.minificationFilter)}function b0e(t,n){let{pixelFormat:i,pixelDatatype:o,width:r,height:s,typedArray:a,sampler:c}=t;return new St({context:n,pixelFormat:i,pixelDatatype:o,source:{arrayBufferView:a,width:r,height:s},sampler:c,flipY:!1})}sb.prototype.update=function(t){if(t.frameNumber===this._lastUpdatedFrame)return;this._lastUpdatedFrame=t.frameNumber;let n=t.context;this._defaultTexture=n.defaultTexture;let i=this._loadedImages;for(let o=0;o<i.length;o++){let r=i[o];bht(this,r,n)}i.length=0};sb.prototype.isDestroyed=function(){return!1};sb.prototype.destroy=function(){let t=this._textures;for(let n in t)if(t.hasOwnProperty(n)){let i=t[n];i!==this._defaultTexture&&i.destroy()}return ue(this)};var I4=sb;function eP(t){t=A(t,A.EMPTY_OBJECT),this.mode=A(t.mode,f_.MODIFY_MATERIAL),this.lightingModel=t.lightingModel,this.uniforms=A(t.uniforms,A.EMPTY_OBJECT),this.varyings=A(t.varyings,A.EMPTY_OBJECT),this.vertexShaderText=t.vertexShaderText,this.fragmentShaderText=t.fragmentShaderText,this.translucencyMode=A(t.translucencyMode,W0.INHERIT),this._textureManager=new I4,this._defaultTexture=void 0,this.uniformMap=wht(this),this.usedVariablesVertex={attributeSet:{},featureIdSet:{},metadataSet:{}},this.usedVariablesFragment={attributeSet:{},featureIdSet:{},metadataSet:{},materialSet:{}},Pht(this),Iht(this)}function wht(t){let n=t.uniforms,i={};for(let o in n)if(n.hasOwnProperty(o)){let r=n[o];r.type===$v.SAMPLER_2D?(t._textureManager.loadTexture2D(o,r.value),i[o]=Dht(t,o)):i[o]=vht(t,o)}return i}function Dht(t,n){return function(){return A(t._textureManager.getTexture(n),t._defaultTexture)}}function vht(t,n){return function(){return t.uniforms[n].value}}function LA(t,n,i){let o;for(;(o=n.exec(t))!==null;){let r=o[1];i[r]=!0}}function Pht(t){let n=/[vf]sInput\.attributes\.(\w+)/g,i=/[vf]sInput\.featureIds\.(\w+)/g,o=/[vf]sInput\.metadata.(\w+)/g,r,s=t.vertexShaderText;f(s)&&(r=t.usedVariablesVertex.attributeSet,LA(s,n,r),r=t.usedVariablesVertex.featureIdSet,LA(s,i,r),r=t.usedVariablesVertex.metadataSet,LA(s,o,r));let a=t.fragmentShaderText;if(f(a)){r=t.usedVariablesFragment.attributeSet,LA(a,n,r),r=t.usedVariablesFragment.featureIdSet,LA(a,i,r),r=t.usedVariablesFragment.metadataSet,LA(a,o,r);let c=/material\.(\w+)/g,l=t.usedVariablesFragment.materialSet;LA(a,c,l)}}function S0e(t){let n=/^.*MC$/,i=/^.*WC$/,o=/^.*EC$/;return n.test(t)?`${t} (model coordinates)`:i.test(t)?`${t} (Cartesian world coordinates)`:o.test(t)?`${t} (eye coordinates)`:t}function Ka(t,n,i,o){if(t.hasOwnProperty(n)){let r=`${S0e(n)} is not available in the ${o} shader. Did you mean ${S0e(i)} instead?`;throw new Ce(r)}}function Iht(t){let n=t.usedVariablesVertex.attributeSet;Ka(n,"position","positionMC","vertex"),Ka(n,"normal","normalMC","vertex"),Ka(n,"tangent","tangentMC","vertex"),Ka(n,"bitangent","bitangentMC","vertex"),Ka(n,"positionWC","positionMC","vertex"),Ka(n,"positionEC","positionMC","vertex"),Ka(n,"normalEC","normalMC","vertex"),Ka(n,"tangentEC","tangentMC","vertex"),Ka(n,"bitangentEC","bitangentMC","vertex");let i=t.usedVariablesFragment.attributeSet;Ka(i,"position","positionEC","fragment"),Ka(i,"normal","normalEC","fragment"),Ka(i,"tangent","tangentEC","fragment"),Ka(i,"bitangent","bitangentEC","fragment"),Ka(i,"normalMC","normalEC","fragment"),Ka(i,"tangentMC","tangentEC","fragment"),Ka(i,"bitangentMC","bitangentEC","fragment")}eP.prototype.setUniform=function(t,n){let i=this.uniforms[t];i.type===$v.SAMPLER_2D?this._textureManager.loadTexture2D(t,n):f(n.clone)?i.value=n.clone(i.value):i.value=n};eP.prototype.update=function(t){this._defaultTexture=t.context.defaultTexture,this._textureManager.update(t)};eP.prototype.isDestroyed=function(){return!1};eP.prototype.destroy=function(){this._textureManager=this._textureManager&&this._textureManager.destroy(),ue(this)};var w0e=eP;function Bht(t){t=A(t,A.EMPTY_OBJECT),this.typedArray=t.typedArray,this.width=t.width,this.height=t.height,this.pixelFormat=A(t.pixelFormat,st.RGBA),this.pixelDatatype=A(t.pixelDatatype,je.UNSIGNED_BYTE);let n=t.url;typeof n=="string"&&(n=Ie.createIfNeeded(n)),this.resource=n;let o=A(t.repeat,!0)?Mn.REPEAT:Mn.CLAMP_TO_EDGE;this.sampler=new pn({wrapS:o,wrapT:o,minificationFilter:t.minificationFilter,magnificationFilter:t.magnificationFilter,maximumAnisotropy:t.maximumAnisotropy})}var D0e=Bht;var Oht={FLOAT:"float",VEC2:"vec2",VEC3:"vec3",VEC4:"vec4",MAT2:"mat2",MAT3:"mat3",MAT4:"mat4"},v0e=Object.freeze(Oht);var FA="http://www.w3.org/2000/svg",B0e="http://www.w3.org/1999/xlink",B4,tP=z.fromCssColorString("rgba(247,250,255,0.384)"),O4=z.fromCssColorString("rgba(143,191,255,0.216)"),Vq=z.fromCssColorString("rgba(153,197,255,0.098)"),R4=z.fromCssColorString("rgba(255,255,255,0.086)"),Rht=z.fromCssColorString("rgba(255,255,255,0.267)"),Mht=z.fromCssColorString("rgba(255,255,255,0)"),P0e=z.fromCssColorString("rgba(66,67,68,0.3)"),I0e=z.fromCssColorString("rgba(0,0,0,0.5)");function r0(t){return z.fromCssColorString(window.getComputedStyle(t).getPropertyValue("color"))}var nP={animation_pathReset:{tagName:"path",transform:"translate(16,16) scale(0.85) translate(-16,-16)",d:"M24.316,5.318,9.833,13.682,9.833,5.5,5.5,5.5,5.5,25.5,9.833,25.5,9.833,17.318,24.316,25.682z"},animation_pathPause:{tagName:"path",transform:"translate(16,16) scale(0.85) translate(-16,-16)",d:"M13,5.5,7.5,5.5,7.5,25.5,13,25.5zM24.5,5.5,19,5.5,19,25.5,24.5,25.5z"},animation_pathPlay:{tagName:"path",transform:"translate(16,16) scale(0.85) translate(-16,-16)",d:"M6.684,25.682L24.316,15.5L6.684,5.318V25.682z"},animation_pathPlayReverse:{tagName:"path",transform:"translate(16,16) scale(-0.85,0.85) translate(-16,-16)",d:"M6.684,25.682L24.316,15.5L6.684,5.318V25.682z"},animation_pathLoop:{tagName:"path",transform:"translate(16,16) scale(0.85) translate(-16,-16)",d:"M24.249,15.499c-0.009,4.832-3.918,8.741-8.75,8.75c-2.515,0-4.768-1.064-6.365-2.763l2.068-1.442l-7.901-3.703l0.744,8.694l2.193-1.529c2.244,2.594,5.562,4.242,9.26,4.242c6.767,0,12.249-5.482,12.249-12.249H24.249zM15.499,6.75c2.516,0,4.769,1.065,6.367,2.764l-2.068,1.443l7.901,3.701l-0.746-8.693l-2.192,1.529c-2.245-2.594-5.562-4.245-9.262-4.245C8.734,3.25,3.25,8.734,3.249,15.499H6.75C6.758,10.668,10.668,6.758,15.499,6.75z"},animation_pathClock:{tagName:"path",transform:"translate(16,16) scale(0.85) translate(-16,-15.5)",d:"M15.5,2.374C8.251,2.375,2.376,8.251,2.374,15.5C2.376,22.748,8.251,28.623,15.5,28.627c7.249-0.004,13.124-5.879,13.125-13.127C28.624,8.251,22.749,2.375,15.5,2.374zM15.5,25.623C9.909,25.615,5.385,21.09,5.375,15.5C5.385,9.909,9.909,5.384,15.5,5.374c5.59,0.01,10.115,4.535,10.124,10.125C25.615,21.09,21.091,25.615,15.5,25.623zM8.625,15.5c-0.001-0.552-0.448-0.999-1.001-1c-0.553,0-1,0.448-1,1c0,0.553,0.449,1,1,1C8.176,16.5,8.624,16.053,8.625,15.5zM8.179,18.572c-0.478,0.277-0.642,0.889-0.365,1.367c0.275,0.479,0.889,0.641,1.365,0.365c0.479-0.275,0.643-0.887,0.367-1.367C9.27,18.461,8.658,18.297,8.179,18.572zM9.18,10.696c-0.479-0.276-1.09-0.112-1.366,0.366s-0.111,1.09,0.365,1.366c0.479,0.276,1.09,0.113,1.367-0.366C9.821,11.584,9.657,10.973,9.18,10.696zM22.822,12.428c0.478-0.275,0.643-0.888,0.366-1.366c-0.275-0.478-0.89-0.642-1.366-0.366c-0.479,0.278-0.642,0.89-0.366,1.367C21.732,12.54,22.344,12.705,22.822,12.428zM12.062,21.455c-0.478-0.275-1.089-0.111-1.366,0.367c-0.275,0.479-0.111,1.09,0.366,1.365c0.478,0.277,1.091,0.111,1.365-0.365C12.704,22.344,12.54,21.732,12.062,21.455zM12.062,9.545c0.479-0.276,0.642-0.888,0.366-1.366c-0.276-0.478-0.888-0.642-1.366-0.366s-0.642,0.888-0.366,1.366C10.973,9.658,11.584,9.822,12.062,9.545zM22.823,18.572c-0.48-0.275-1.092-0.111-1.367,0.365c-0.275,0.479-0.112,1.092,0.367,1.367c0.477,0.275,1.089,0.113,1.365-0.365C23.464,19.461,23.3,18.848,22.823,18.572zM19.938,7.813c-0.477-0.276-1.091-0.111-1.365,0.366c-0.275,0.48-0.111,1.091,0.366,1.367s1.089,0.112,1.366-0.366C20.581,8.702,20.418,8.089,19.938,7.813zM23.378,14.5c-0.554,0.002-1.001,0.45-1.001,1c0.001,0.552,0.448,1,1.001,1c0.551,0,1-0.447,1-1C24.378,14.949,23.929,14.5,23.378,14.5zM15.501,6.624c-0.552,0-1,0.448-1,1l-0.466,7.343l-3.004,1.96c-0.478,0.277-0.642,0.889-0.365,1.365c0.275,0.479,0.889,0.643,1.365,0.367l3.305-1.676C15.39,16.99,15.444,17,15.501,17c0.828,0,1.5-0.671,1.5-1.5l-0.5-7.876C16.501,7.072,16.053,6.624,15.501,6.624zM15.501,22.377c-0.552,0-1,0.447-1,1s0.448,1,1,1s1-0.447,1-1S16.053,22.377,15.501,22.377zM18.939,21.455c-0.479,0.277-0.643,0.889-0.366,1.367c0.275,0.477,0.888,0.643,1.366,0.365c0.478-0.275,0.642-0.889,0.366-1.365C20.028,21.344,19.417,21.18,18.939,21.455z"},animation_pathWingButton:{tagName:"path",d:"m 4.5,0.5 c -2.216,0 -4,1.784 -4,4 l 0,24 c 0,2.216 1.784,4 4,4 l 13.71875,0 C 22.478584,27.272785 27.273681,22.511272 32.5,18.25 l 0,-13.75 c 0,-2.216 -1.784,-4 -4,-4 l -24,0 z"},animation_pathPointer:{tagName:"path",d:"M-15,-65,-15,-55,15,-55,15,-65,0,-95z"},animation_pathSwooshFX:{tagName:"path",d:"m 85,0 c 0,16.617 -4.813944,35.356 -13.131081,48.4508 h 6.099803 c 8.317138,-13.0948 13.13322,-28.5955 13.13322,-45.2124 0,-46.94483 -38.402714,-85.00262 -85.7743869,-85.00262 -1.0218522,0 -2.0373001,0.0241 -3.0506131,0.0589 45.958443,1.59437 82.723058,35.77285 82.723058,81.70532 z"}};function Dd(t){let n=document.createElementNS(FA,t.tagName);for(let i in t)if(t.hasOwnProperty(i)&&i!=="tagName")if(i==="children"){let o=t.children.length;for(let r=0;r<o;++r)n.appendChild(Dd(t.children[r]))}else i.indexOf("xlink:")===0?n.setAttributeNS(B0e,i.substring(6),t[i]):i==="textContent"?n.textContent=t[i]:n.setAttribute(i,t[i]);return n}function kq(t,n,i){let o=document.createElementNS(FA,"text");o.setAttribute("x",t),o.setAttribute("y",n),o.setAttribute("class","cesium-animation-svgText");let r=document.createElementNS(FA,"tspan");return r.textContent=i,o.appendChild(r),o}function Lht(t,n,i){t.setAttribute("transform",`translate(100,100) rotate(${i})`),n.setAttribute("transform",`rotate(${i})`)}var M4=new z;function kr(t,n){let i=n.alpha,o=1-i;return M4.red=t.red*o+n.red*i,M4.green=t.green*o+n.green*i,M4.blue=t.blue*o+n.blue*i,M4.toCssColorString()}function Uq(t,n,i){let o=nP[i],r={tagName:"g",class:"cesium-animation-rectButton",transform:`translate(${t},${n})`,children:[{tagName:"rect",class:"cesium-animation-buttonGlow",width:32,height:32,rx:2,ry:2},{tagName:"rect",class:"cesium-animation-buttonMain",width:32,height:32,rx:4,ry:4},{class:"cesium-animation-buttonPath",id:i,tagName:o.tagName,transform:o.transform,d:o.d},{tagName:"title",textContent:""}]};return Dd(r)}function Fht(t,n,i){let o=nP[i],r=nP.animation_pathWingButton,s={tagName:"g",class:"cesium-animation-rectButton",transform:`translate(${t},${n})`,children:[{class:"cesium-animation-buttonGlow",id:"animation_pathWingButton",tagName:r.tagName,d:r.d},{class:"cesium-animation-buttonMain",id:"animation_pathWingButton",tagName:r.tagName,d:r.d},{class:"cesium-animation-buttonPath",id:i,tagName:o.tagName,transform:o.transform,d:o.d},{tagName:"title",textContent:""}]};return Dd(s)}function Nht(t,n){let i=t._viewModel,o=i.shuttleRingDragging;if(!(o&&B4!==t))if(n.type==="mousedown"||o&&n.type==="mousemove"||n.type==="touchstart"&&n.touches.length===1||o&&n.type==="touchmove"&&n.touches.length===1){let r=t._centerX,s=t._centerY,c=t._svgNode.getBoundingClientRect(),l,u;if(n.type==="touchstart"||n.type==="touchmove"?(l=n.touches[0].clientX,u=n.touches[0].clientY):(l=n.clientX,u=n.clientY),!o&&(l>c.right||l<c.left||u<c.top||u>c.bottom))return;let d=t._shuttleRingPointer.getBoundingClientRect(),h=l-r-c.left,_=u-s-c.top,y=Math.atan2(_,h)*180/Math.PI+90;y>180&&(y-=360);let p=i.shuttleRingAngle;o||l<d.right&&l>d.left&&u>d.top&&u<d.bottom?(B4=t,i.shuttleRingDragging=!0,i.shuttleRingAngle=y):y<p?i.slower():y>p&&i.faster(),n.preventDefault()}else t===B4&&(B4=void 0),i.shuttleRingDragging=!1}function Dp(t,n){this._viewModel=n,this.svgElement=t,this._enabled=void 0,this._toggled=void 0;let i=this;this._clickFunction=function(){let o=i._viewModel.command;o.canExecute&&o()},t.addEventListener("click",this._clickFunction,!0),this._subscriptions=[da(n,"toggled",this.setToggled,this),da(n,"tooltip",this.setTooltip,this),da(n.command,"canExecute",this.setEnabled,this)]}Dp.prototype.destroy=function(){this.svgElement.removeEventListener("click",this._clickFunction,!0);let t=this._subscriptions;for(let n=0,i=t.length;n<i;n++)t[n].dispose();ue(this)};Dp.prototype.isDestroyed=function(){return!1};Dp.prototype.setEnabled=function(t){if(this._enabled!==t){if(this._enabled=t,!t){this.svgElement.setAttribute("class","cesium-animation-buttonDisabled");return}if(this._toggled){this.svgElement.setAttribute("class","cesium-animation-rectButton cesium-animation-buttonToggled");return}this.svgElement.setAttribute("class","cesium-animation-rectButton")}};Dp.prototype.setToggled=function(t){this._toggled!==t&&(this._toggled=t,this._enabled&&(t?this.svgElement.setAttribute("class","cesium-animation-rectButton cesium-animation-buttonToggled"):this.svgElement.setAttribute("class","cesium-animation-rectButton")))};Dp.prototype.setTooltip=function(t){this.svgElement.getElementsByTagName("title")[0].textContent=t};function ab(t,n){t=On(t),this._viewModel=n,this._container=t,this._centerX=0,this._centerY=0,this._defsElement=void 0,this._svgNode=void 0,this._topG=void 0,this._lastHeight=void 0,this._lastWidth=void 0;let i=t.ownerDocument,o=document.createElement("style");o.textContent=".cesium-animation-rectButton .cesium-animation-buttonGlow { filter: url(#animation_blurred); }.cesium-animation-rectButton .cesium-animation-buttonMain { fill: url(#animation_buttonNormal); }.cesium-animation-buttonToggled .cesium-animation-buttonMain { fill: url(#animation_buttonToggled); }.cesium-animation-rectButton:hover .cesium-animation-buttonMain { fill: url(#animation_buttonHovered); }.cesium-animation-buttonDisabled .cesium-animation-buttonMain { fill: url(#animation_buttonDisabled); }.cesium-animation-shuttleRingG .cesium-animation-shuttleRingSwoosh { fill: url(#animation_shuttleRingSwooshGradient); }.cesium-animation-shuttleRingG:hover .cesium-animation-shuttleRingSwoosh { fill: url(#animation_shuttleRingSwooshHovered); }.cesium-animation-shuttleRingPointer { fill: url(#animation_shuttleRingPointerGradient); }.cesium-animation-shuttleRingPausePointer { fill: url(#animation_shuttleRingPointerPaused); }.cesium-animation-knobOuter { fill: url(#animation_knobOuter); }.cesium-animation-knobInner { fill: url(#animation_knobInner); }",i.head.insertBefore(o,i.head.childNodes[0]);let r=document.createElement("div");r.className="cesium-animation-theme",r.innerHTML='<div class="cesium-animation-themeNormal"></div><div class="cesium-animation-themeHover"></div><div class="cesium-animation-themeSelect"></div><div class="cesium-animation-themeDisabled"></div><div class="cesium-animation-themeKnob"></div><div class="cesium-animation-themePointer"></div><div class="cesium-animation-themeSwoosh"></div><div class="cesium-animation-themeSwooshHover"></div>',this._theme=r,this._themeNormal=r.childNodes[0],this._themeHover=r.childNodes[1],this._themeSelect=r.childNodes[2],this._themeDisabled=r.childNodes[3],this._themeKnob=r.childNodes[4],this._themePointer=r.childNodes[5],this._themeSwoosh=r.childNodes[6],this._themeSwooshHover=r.childNodes[7];let s=document.createElementNS(FA,"svg:svg");this._svgNode=s,s.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink",B0e);let a=document.createElementNS(FA,"g");this._topG=a,this._realtimeSVG=new Dp(Fht(3,4,"animation_pathClock"),n.playRealtimeViewModel),this._playReverseSVG=new Dp(Uq(44,99,"animation_pathPlayReverse"),n.playReverseViewModel),this._playForwardSVG=new Dp(Uq(124,99,"animation_pathPlay"),n.playForwardViewModel),this._pauseSVG=new Dp(Uq(84,99,"animation_pathPause"),n.pauseViewModel);let c=document.createElementNS(FA,"g");c.appendChild(this._realtimeSVG.svgElement),c.appendChild(this._playReverseSVG.svgElement),c.appendChild(this._playForwardSVG.svgElement),c.appendChild(this._pauseSVG.svgElement);let l=Dd({tagName:"circle",class:"cesium-animation-shuttleRingBack",cx:100,cy:100,r:99});this._shuttleRingBackPanel=l;let u=nP.animation_pathSwooshFX,d=nP.animation_pathPointer,h=Dd({tagName:"g",class:"cesium-animation-shuttleRingSwoosh",children:[{tagName:u.tagName,transform:"translate(100,97) scale(-1,1)",id:"animation_pathSwooshFX",d:u.d},{tagName:u.tagName,transform:"translate(100,97)",id:"animation_pathSwooshFX",d:u.d},{tagName:"line",x1:100,y1:8,x2:100,y2:22}]});this._shuttleRingSwooshG=h,this._shuttleRingPointer=Dd({class:"cesium-animation-shuttleRingPointer",id:"animation_pathPointer",tagName:d.tagName,d:d.d});let _=Dd({tagName:"g",transform:"translate(100,100)"});this._knobOuter=Dd({tagName:"circle",class:"cesium-animation-knobOuter",cx:0,cy:0,r:71});let y=61,p=Dd({tagName:"circle",class:"cesium-animation-knobInner",cx:0,cy:0,r:y});this._knobDate=kq(0,-24,""),this._knobTime=kq(0,-7,""),this._knobStatus=kq(0,-41,"");let C=Dd({tagName:"circle",class:"cesium-animation-blank",cx:0,cy:0,r:y}),x=document.createElementNS(FA,"g");x.setAttribute("class","cesium-animation-shuttleRingG"),t.appendChild(r),a.appendChild(x),a.appendChild(_),a.appendChild(c),x.appendChild(l),x.appendChild(h),x.appendChild(this._shuttleRingPointer),_.appendChild(this._knobOuter),_.appendChild(p),_.appendChild(this._knobDate),_.appendChild(this._knobTime),_.appendChild(this._knobStatus),_.appendChild(C),s.appendChild(a),t.appendChild(s);let T=this;function E(O){Nht(T,O)}this._mouseCallback=E,l.addEventListener("mousedown",E,!0),l.addEventListener("touchstart",E,!0),h.addEventListener("mousedown",E,!0),h.addEventListener("touchstart",E,!0),i.addEventListener("mousemove",E,!0),i.addEventListener("touchmove",E,!0),i.addEventListener("mouseup",E,!0),i.addEventListener("touchend",E,!0),i.addEventListener("touchcancel",E,!0),this._shuttleRingPointer.addEventListener("mousedown",E,!0),this._shuttleRingPointer.addEventListener("touchstart",E,!0),this._knobOuter.addEventListener("mousedown",E,!0),this._knobOuter.addEventListener("touchstart",E,!0);let S=this._knobTime.childNodes[0],w=this._knobDate.childNodes[0],D=this._knobStatus.childNodes[0],I;this._subscriptions=[da(n.pauseViewModel,"toggled",function(O){I!==O&&(I=O,I?T._shuttleRingPointer.setAttribute("class","cesium-animation-shuttleRingPausePointer"):T._shuttleRingPointer.setAttribute("class","cesium-animation-shuttleRingPointer"))}),da(n,"shuttleRingAngle",function(O){Lht(T._shuttleRingPointer,T._knobOuter,O)}),da(n,"dateLabel",function(O){w.textContent!==O&&(w.textContent=O)}),da(n,"timeLabel",function(O){S.textContent!==O&&(S.textContent=O)}),da(n,"multiplierLabel",function(O){D.textContent!==O&&(D.textContent=O)})],this.applyThemeChanges(),this.resize()}Object.defineProperties(ab.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}});ab.prototype.isDestroyed=function(){return!1};ab.prototype.destroy=function(){f(this._observer)&&(this._observer.disconnect(),this._observer=void 0);let t=this._container.ownerDocument,n=this._mouseCallback;this._shuttleRingBackPanel.removeEventListener("mousedown",n,!0),this._shuttleRingBackPanel.removeEventListener("touchstart",n,!0),this._shuttleRingSwooshG.removeEventListener("mousedown",n,!0),this._shuttleRingSwooshG.removeEventListener("touchstart",n,!0),t.removeEventListener("mousemove",n,!0),t.removeEventListener("touchmove",n,!0),t.removeEventListener("mouseup",n,!0),t.removeEventListener("touchend",n,!0),t.removeEventListener("touchcancel",n,!0),this._shuttleRingPointer.removeEventListener("mousedown",n,!0),this._shuttleRingPointer.removeEventListener("touchstart",n,!0),this._knobOuter.removeEventListener("mousedown",n,!0),this._knobOuter.removeEventListener("touchstart",n,!0),this._container.removeChild(this._svgNode),this._container.removeChild(this._theme),this._realtimeSVG.destroy(),this._playReverseSVG.destroy(),this._playForwardSVG.destroy(),this._pauseSVG.destroy();let i=this._subscriptions;for(let o=0,r=i.length;o<r;o++)i[o].dispose();return ue(this)};ab.prototype.resize=function(){let t=this._container.clientWidth,n=this._container.clientHeight;if(t===this._lastWidth&&n===this._lastHeight)return;let i=this._svgNode,o=200,r=132,s=t,a=n;t===0&&n===0?(s=o,a=r):t===0?(a=n,s=o*(n/r)):n===0&&(s=t,a=r*(t/o));let c=s/o,l=a/r;i.style.cssText=`width: ${s}px; height: ${a}px; position: absolute; bottom: 0; left: 0; overflow: hidden;`,i.setAttribute("width",s),i.setAttribute("height",a),i.setAttribute("viewBox",`0 0 ${s} ${a}`),this._topG.setAttribute("transform",`scale(${c},${l})`),this._centerX=Math.max(1,100*c),this._centerY=Math.max(1,100*l),this._lastHeight=t,this._lastWidth=n};ab.prototype.applyThemeChanges=function(){let t=this._container.ownerDocument;if(!t.body.contains(this._container)){if(f(this._observer))return;let d=this;d._observer=new MutationObserver(function(){t.body.contains(d._container)&&(d._observer.disconnect(),d._observer=void 0,d.applyThemeChanges())}),d._observer.observe(t,{childList:!0,subtree:!0});return}let n=r0(this._themeNormal),i=r0(this._themeHover),o=r0(this._themeSelect),r=r0(this._themeDisabled),s=r0(this._themeKnob),a=r0(this._themePointer),c=r0(this._themeSwoosh),l=r0(this._themeSwooshHover),u=Dd({tagName:"defs",children:[{id:"animation_buttonNormal",tagName:"linearGradient",x1:"50%",y1:"0%",x2:"50%",y2:"100%",children:[{tagName:"stop",offset:"0%","stop-color":kr(n,tP)},{tagName:"stop",offset:"12%","stop-color":kr(n,O4)},{tagName:"stop",offset:"46%","stop-color":kr(n,Vq)},{tagName:"stop",offset:"81%","stop-color":kr(n,R4)}]},{id:"animation_buttonHovered",tagName:"linearGradient",x1:"50%",y1:"0%",x2:"50%",y2:"100%",children:[{tagName:"stop",offset:"0%","stop-color":kr(i,tP)},{tagName:"stop",offset:"12%","stop-color":kr(i,O4)},{tagName:"stop",offset:"46%","stop-color":kr(i,Vq)},{tagName:"stop",offset:"81%","stop-color":kr(i,R4)}]},{id:"animation_buttonToggled",tagName:"linearGradient",x1:"50%",y1:"0%",x2:"50%",y2:"100%",children:[{tagName:"stop",offset:"0%","stop-color":kr(o,tP)},{tagName:"stop",offset:"12%","stop-color":kr(o,O4)},{tagName:"stop",offset:"46%","stop-color":kr(o,Vq)},{tagName:"stop",offset:"81%","stop-color":kr(o,R4)}]},{id:"animation_buttonDisabled",tagName:"linearGradient",x1:"50%",y1:"0%",x2:"50%",y2:"100%",children:[{tagName:"stop",offset:"0%","stop-color":kr(r,Rht)},{tagName:"stop",offset:"75%","stop-color":kr(r,Mht)}]},{id:"animation_blurred",tagName:"filter",width:"200%",height:"200%",x:"-50%",y:"-50%",children:[{tagName:"feGaussianBlur",stdDeviation:4,in:"SourceGraphic"}]},{id:"animation_shuttleRingSwooshGradient",tagName:"linearGradient",x1:"50%",y1:"0%",x2:"50%",y2:"100%",children:[{tagName:"stop",offset:"0%","stop-opacity":.2,"stop-color":c.toCssColorString()},{tagName:"stop",offset:"85%","stop-opacity":.85,"stop-color":c.toCssColorString()},{tagName:"stop",offset:"95%","stop-opacity":.05,"stop-color":c.toCssColorString()}]},{id:"animation_shuttleRingSwooshHovered",tagName:"linearGradient",x1:"50%",y1:"0%",x2:"50%",y2:"100%",children:[{tagName:"stop",offset:"0%","stop-opacity":.2,"stop-color":l.toCssColorString()},{tagName:"stop",offset:"85%","stop-opacity":.85,"stop-color":l.toCssColorString()},{tagName:"stop",offset:"95%","stop-opacity":.05,"stop-color":l.toCssColorString()}]},{id:"animation_shuttleRingPointerGradient",tagName:"linearGradient",x1:"0%",y1:"50%",x2:"100%",y2:"50%",children:[{tagName:"stop",offset:"0%","stop-color":a.toCssColorString()},{tagName:"stop",offset:"40%","stop-color":a.toCssColorString()},{tagName:"stop",offset:"60%","stop-color":kr(a,I0e)},{tagName:"stop",offset:"100%","stop-color":kr(a,I0e)}]},{id:"animation_shuttleRingPointerPaused",tagName:"linearGradient",x1:"0%",y1:"50%",x2:"100%",y2:"50%",children:[{tagName:"stop",offset:"0%","stop-color":"#CCC"},{tagName:"stop",offset:"40%","stop-color":"#CCC"},{tagName:"stop",offset:"60%","stop-color":"#555"},{tagName:"stop",offset:"100%","stop-color":"#555"}]},{id:"animation_knobOuter",tagName:"linearGradient",x1:"20%",y1:"0%",x2:"90%",y2:"100%",children:[{tagName:"stop",offset:"5%","stop-color":kr(s,tP)},{tagName:"stop",offset:"60%","stop-color":kr(s,P0e)},{tagName:"stop",offset:"85%","stop-color":kr(s,O4)}]},{id:"animation_knobInner",tagName:"linearGradient",x1:"20%",y1:"0%",x2:"90%",y2:"100%",children:[{tagName:"stop",offset:"5%","stop-color":kr(s,P0e)},{tagName:"stop",offset:"60%","stop-color":kr(s,tP)},{tagName:"stop",offset:"85%","stop-color":kr(s,R4)}]}]});f(this._defsElement)?this._svgNode.replaceChild(u,this._defsElement):this._svgNode.appendChild(u),this._defsElement=u};var L4=ab;var Vht=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],s0=15,cb=105;function O0e(t,n){return t-n}function zq(t,n){let i=jo(n,t,O0e);return i<0?~i:i}function kht(t,n){if(Math.abs(t)<=s0)return t/s0;let i=s0,o=cb,r,s=0,a;return t>0?(r=Math.log(n[n.length-1]),a=(r-s)/(o-i),Math.exp(s+a*(t-i))):(r=Math.log(-n[0]),a=(r-s)/(o-i),-Math.exp(s+a*(Math.abs(t)-i)))}function Uht(t,n,i){if(i.clockStep===po.SYSTEM_CLOCK)return s0;if(Math.abs(t)<=1)return t*s0;let o=n[n.length-1];t>o?t=o:t<-o&&(t=-o);let r=s0,s=cb,a,c=0,l;return t>0?(a=Math.log(o),l=(a-c)/(s-r),(Math.log(t)-c)/l+r):(a=Math.log(-n[0]),l=(a-c)/(s-r),-((Math.log(Math.abs(t))-c)/l+r))}function pf(t){let n=this;this._clockViewModel=t,this._allShuttleRingTicks=[],this._dateFormatter=pf.defaultDateFormatter,this._timeFormatter=pf.defaultTimeFormatter,this.shuttleRingDragging=!1,this.snapToTicks=!1,xe.track(this,["_allShuttleRingTicks","_dateFormatter","_timeFormatter","shuttleRingDragging","snapToTicks"]),this._sortedFilteredPositiveTicks=[],this.setShuttleRingTicks(pf.defaultTicks),this.timeLabel=void 0,xe.defineProperty(this,"timeLabel",function(){return n._timeFormatter(n._clockViewModel.currentTime,n)}),this.dateLabel=void 0,xe.defineProperty(this,"dateLabel",function(){return n._dateFormatter(n._clockViewModel.currentTime,n)}),this.multiplierLabel=void 0,xe.defineProperty(this,"multiplierLabel",function(){let a=n._clockViewModel;if(a.clockStep===po.SYSTEM_CLOCK)return"Today";let c=a.multiplier;return c%1===0?`${c.toFixed(0)}x`:`${c.toFixed(3).replace(/0{0,3}$/,"")}x`}),this.shuttleRingAngle=void 0,xe.defineProperty(this,"shuttleRingAngle",{get:function(){return Uht(t.multiplier,n._allShuttleRingTicks,t)},set:function(a){a=Math.max(Math.min(a,cb),-cb);let c=n._allShuttleRingTicks,l=n._clockViewModel;if(l.clockStep=po.SYSTEM_CLOCK_MULTIPLIER,Math.abs(a)===cb){l.multiplier=a>0?c[c.length-1]:c[0];return}let u=kht(a,c);if(n.snapToTicks)u=c[zq(u,c)];else if(u!==0){let d=Math.abs(u);if(d>100){let h=d.toFixed(0).length-2,_=Math.pow(10,h);u=Math.round(u/_)*_|0}else d>s0?u=Math.round(u):d>1?u=+u.toFixed(1):d>0&&(u=+u.toFixed(2))}l.multiplier=u}}),this._canAnimate=void 0,xe.defineProperty(this,"_canAnimate",function(){let a=n._clockViewModel,c=a.clockRange;if(n.shuttleRingDragging||c===Nr.UNBOUNDED)return!0;let l=a.multiplier,u=a.currentTime,d=a.startTime,h=!1;if(c===Nr.LOOP_STOP)h=te.greaterThan(u,d)||u.equals(d)&&l>0;else{let _=a.stopTime;h=te.greaterThan(u,d)&&te.lessThan(u,_)||u.equals(d)&&l>0||u.equals(_)&&l<0}return h||(a.shouldAnimate=!1),h}),this._isSystemTimeAvailable=void 0,xe.defineProperty(this,"_isSystemTimeAvailable",function(){let a=n._clockViewModel;if(a.clockRange===Nr.UNBOUNDED)return!0;let l=a.systemTime;return te.greaterThanOrEquals(l,a.startTime)&&te.lessThanOrEquals(l,a.stopTime)}),this._isAnimating=void 0,xe.defineProperty(this,"_isAnimating",function(){return n._clockViewModel.shouldAnimate&&(n._canAnimate||n.shuttleRingDragging)});let i=Tn(function(){let a=n._clockViewModel;a.shouldAnimate?a.shouldAnimate=!1:n._canAnimate&&(a.shouldAnimate=!0)});this._pauseViewModel=new MA(i,{toggled:xe.computed(function(){return!n._isAnimating}),tooltip:"Pause"});let o=Tn(function(){let a=n._clockViewModel,c=a.multiplier;c>0&&(a.multiplier=-c),a.shouldAnimate=!0});this._playReverseViewModel=new MA(o,{toggled:xe.computed(function(){return n._isAnimating&&t.multiplier<0}),tooltip:"Play Reverse"});let r=Tn(function(){let a=n._clockViewModel,c=a.multiplier;c<0&&(a.multiplier=-c),a.shouldAnimate=!0});this._playForwardViewModel=new MA(r,{toggled:xe.computed(function(){return n._isAnimating&&t.multiplier>0&&t.clockStep!==po.SYSTEM_CLOCK}),tooltip:"Play Forward"});let s=Tn(function(){n._clockViewModel.clockStep=po.SYSTEM_CLOCK},xe.getObservable(this,"_isSystemTimeAvailable"));this._playRealtimeViewModel=new MA(s,{toggled:xe.computed(function(){return t.clockStep===po.SYSTEM_CLOCK}),tooltip:xe.computed(function(){return n._isSystemTimeAvailable?"Today (real-time)":"Current time not in range"})}),this._slower=Tn(function(){let a=n._clockViewModel,c=n._allShuttleRingTicks,l=a.multiplier,u=zq(l,c)-1;u>=0&&(a.multiplier=c[u])}),this._faster=Tn(function(){let a=n._clockViewModel,c=n._allShuttleRingTicks,l=a.multiplier,u=zq(l,c)+1;u<c.length&&(a.multiplier=c[u])})}pf.defaultDateFormatter=function(t,n){let i=te.toGregorianDate(t);return`${Vht[i.month-1]} ${i.day} ${i.year}`};pf.defaultTicks=[.001,.002,.005,.01,.02,.05,.1,.25,.5,1,2,5,10,15,30,60,120,300,600,900,1800,3600,7200,14400,21600,43200,86400,172800,345600,604800];pf.defaultTimeFormatter=function(t,n){let i=te.toGregorianDate(t),o=Math.round(i.millisecond);return Math.abs(n._clockViewModel.multiplier)<1?`${i.hour.toString().padStart(2,"0")}:${i.minute.toString().padStart(2,"0")}:${i.second.toString().padStart(2,"0")}.${o.toString().padStart(3,"0")}`:`${i.hour.toString().padStart(2,"0")}:${i.minute.toString().padStart(2,"0")}:${i.second.toString().padStart(2,"0")} UTC`};pf.prototype.getShuttleRingTicks=function(){return this._sortedFilteredPositiveTicks.slice(0)};pf.prototype.setShuttleRingTicks=function(t){let n,i,o,r={},s=this._sortedFilteredPositiveTicks;for(s.length=0,n=0,i=t.length;n<i;++n)o=t[n],r.hasOwnProperty(o)||(r[o]=!0,s.push(o));s.sort(O0e);let a=[];for(i=s.length,n=i-1;n>=0;--n)o=s[n],o!==0&&a.push(-o);Array.prototype.push.apply(a,s),this._allShuttleRingTicks=a};Object.defineProperties(pf.prototype,{slower:{get:function(){return this._slower}},faster:{get:function(){return this._faster}},clockViewModel:{get:function(){return this._clockViewModel}},pauseViewModel:{get:function(){return this._pauseViewModel}},playReverseViewModel:{get:function(){return this._playReverseViewModel}},playForwardViewModel:{get:function(){return this._playForwardViewModel}},playRealtimeViewModel:{get:function(){return this._playRealtimeViewModel}},dateFormatter:{get:function(){return this._dateFormatter},set:function(t){this._dateFormatter=t}},timeFormatter:{get:function(){return this._timeFormatter},set:function(t){this._timeFormatter=t}}});pf._maxShuttleRingAngle=cb;pf._realtimeShuttleRingAngle=s0;var F4=pf;function R0e(t){t=A(t,A.EMPTY_OBJECT);let n=t.globe,i=A(t.imageryProviderViewModels,[]),o=A(t.terrainProviderViewModels,[]);this._globe=n,this.imageryProviderViewModels=i.slice(0),this.terrainProviderViewModels=o.slice(0),this.dropDownVisible=!1,xe.track(this,["imageryProviderViewModels","terrainProviderViewModels","dropDownVisible"]);let r=xe.getObservable(this,"imageryProviderViewModels"),s=xe.pureComputed(function(){let h=r(),_={},y;for(y=0;y<h.length;y++){let x=h[y],T=x.category;f(_[T])?_[T].push(x):_[T]=[x]}let p=Object.keys(_),C=[];for(y=0;y<p.length;y++){let x=p[y];C.push({name:x,providers:_[x]})}return C});this._imageryProviders=s;let a=xe.getObservable(this,"terrainProviderViewModels"),c=xe.pureComputed(function(){let h=a(),_={},y;for(y=0;y<h.length;y++){let x=h[y],T=x.category;f(_[T])?_[T].push(x):_[T]=[x]}let p=Object.keys(_),C=[];for(y=0;y<p.length;y++){let x=p[y];C.push({name:x,providers:_[x]})}return C});this._terrainProviders=c,this.buttonTooltip=void 0,xe.defineProperty(this,"buttonTooltip",function(){let h=this.selectedImagery,_=this.selectedTerrain,y=f(h)?h.name:void 0,p=f(_)?_.name:void 0;return f(y)&&f(p)?`${y}
${p}`:f(y)?y:p}),this.buttonImageUrl=void 0,xe.defineProperty(this,"buttonImageUrl",function(){let h=this.selectedImagery;if(f(h))return h.iconUrl}),this.selectedImagery=void 0;let l=xe.observable();this._currentImageryProviders=[],xe.defineProperty(this,"selectedImagery",{get:function(){return l()},set:function(h){if(l()===h){this.dropDownVisible=!1;return}let _,y=this._currentImageryProviders,p=y.length,C=this._globe.imageryLayers,x=!1;for(_=0;_<p;_++){let T=C.length;for(let E=0;E<T;E++){let S=C.get(E);if(S.imageryProvider===y[_]){C.remove(S),x=!0;break}}}if(f(h)){let T=h.creationCommand();if(Array.isArray(T)){let E=T.length;for(_=E-1;_>=0;_--)C.addImageryProvider(T[_],0);this._currentImageryProviders=T.slice(0)}else if(this._currentImageryProviders=[T],x)C.addImageryProvider(T,0);else{let E=C.get(0);f(E)&&C.remove(E),C.addImageryProvider(T,0)}}l(h),this.dropDownVisible=!1}}),this.selectedTerrain=void 0;let u=xe.observable();xe.defineProperty(this,"selectedTerrain",{get:function(){return u()},set:function(h){if(u()===h){this.dropDownVisible=!1;return}let _;f(h)&&(_=h.creationCommand()),this._globe.depthTestAgainstTerrain=!(_ instanceof Lg),this._globe.terrainProvider=_,u(h),this.dropDownVisible=!1}});let d=this;this._toggleDropDown=Tn(function(){d.dropDownVisible=!d.dropDownVisible}),this.selectedImagery=A(t.selectedImageryProviderViewModel,i[0]),this.selectedTerrain=A(t.selectedTerrainProviderViewModel,o[0])}Object.defineProperties(R0e.prototype,{toggleDropDown:{get:function(){return this._toggleDropDown}},globe:{get:function(){return this._globe}}});var N4=R0e;function V4(t,n){t=On(t);let i=new N4(n),o=document.createElement("button");o.type="button",o.className="cesium-button cesium-toolbar-button",o.setAttribute("data-bind","attr: { title: buttonTooltip },click: toggleDropDown"),t.appendChild(o);let r=document.createElement("img");r.setAttribute("draggable","false"),r.className="cesium-baseLayerPicker-selected",r.setAttribute("data-bind","attr: { src: buttonImageUrl }, visible: !!buttonImageUrl"),o.appendChild(r);let s=document.createElement("div");s.className="cesium-baseLayerPicker-dropDown",s.setAttribute("data-bind",'css: { "cesium-baseLayerPicker-dropDown-visible" : dropDownVisible }'),t.appendChild(s);let a=document.createElement("div");a.className="cesium-baseLayerPicker-sectionTitle",a.setAttribute("data-bind","visible: imageryProviderViewModels.length > 0"),a.innerHTML="Imagery",s.appendChild(a);let c=document.createElement("div");c.className="cesium-baseLayerPicker-section",c.setAttribute("data-bind","foreach: _imageryProviders"),s.appendChild(c);let l=document.createElement("div");l.className="cesium-baseLayerPicker-category",c.appendChild(l);let u=document.createElement("div");u.className="cesium-baseLayerPicker-categoryTitle",u.setAttribute("data-bind","text: name"),l.appendChild(u);let d=document.createElement("div");d.className="cesium-baseLayerPicker-choices",d.setAttribute("data-bind","foreach: providers"),l.appendChild(d);let h=document.createElement("div");h.className="cesium-baseLayerPicker-item",h.setAttribute("data-bind",'css: { "cesium-baseLayerPicker-selectedItem" : $data === $parents[1].selectedImagery },attr: { title: tooltip },visible: creationCommand.canExecute,click: function($data) { $parents[1].selectedImagery = $data; }'),d.appendChild(h);let _=document.createElement("img");_.className="cesium-baseLayerPicker-itemIcon",_.setAttribute("data-bind","attr: { src: iconUrl }"),_.setAttribute("draggable","false"),h.appendChild(_);let y=document.createElement("div");y.className="cesium-baseLayerPicker-itemLabel",y.setAttribute("data-bind","text: name"),h.appendChild(y);let p=document.createElement("div");p.className="cesium-baseLayerPicker-sectionTitle",p.setAttribute("data-bind","visible: terrainProviderViewModels.length > 0"),p.innerHTML="Terrain",s.appendChild(p);let C=document.createElement("div");C.className="cesium-baseLayerPicker-section",C.setAttribute("data-bind","foreach: _terrainProviders"),s.appendChild(C);let x=document.createElement("div");x.className="cesium-baseLayerPicker-category",C.appendChild(x);let T=document.createElement("div");T.className="cesium-baseLayerPicker-categoryTitle",T.setAttribute("data-bind","text: name"),x.appendChild(T);let E=document.createElement("div");E.className="cesium-baseLayerPicker-choices",E.setAttribute("data-bind","foreach: providers"),x.appendChild(E);let S=document.createElement("div");S.className="cesium-baseLayerPicker-item",S.setAttribute("data-bind",'css: { "cesium-baseLayerPicker-selectedItem" : $data === $parents[1].selectedTerrain },attr: { title: tooltip },visible: creationCommand.canExecute,click: function($data) { $parents[1].selectedTerrain = $data; }'),E.appendChild(S);let w=document.createElement("img");w.className="cesium-baseLayerPicker-itemIcon",w.setAttribute("data-bind","attr: { src: iconUrl }"),w.setAttribute("draggable","false"),S.appendChild(w);let D=document.createElement("div");D.className="cesium-baseLayerPicker-itemLabel",D.setAttribute("data-bind","text: name"),S.appendChild(D),xe.applyBindings(i,o),xe.applyBindings(i,s),this._viewModel=i,this._container=t,this._element=o,this._dropPanel=s,this._closeDropDown=function(I){o.contains(I.target)||s.contains(I.target)||(i.dropDownVisible=!1)},Vt.supportsPointerEvents()?document.addEventListener("pointerdown",this._closeDropDown,!0):(document.addEventListener("mousedown",this._closeDropDown,!0),document.addEventListener("touchstart",this._closeDropDown,!0))}Object.defineProperties(V4.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}});V4.prototype.isDestroyed=function(){return!1};V4.prototype.destroy=function(){return Vt.supportsPointerEvents()?document.removeEventListener("pointerdown",this._closeDropDown,!0):(document.removeEventListener("mousedown",this._closeDropDown,!0),document.removeEventListener("touchstart",this._closeDropDown,!0)),xe.cleanNode(this._element),xe.cleanNode(this._dropPanel),this._container.removeChild(this._element),this._container.removeChild(this._dropPanel),ue(this)};var k4=V4;function M0e(t){let n=t.creationFunction;f(n.canExecute)||(n=Tn(n)),this._creationCommand=n,this.name=t.name,this.tooltip=t.tooltip,this.iconUrl=t.iconUrl,this._category=A(t.category,""),xe.track(this,["name","tooltip","iconUrl"])}Object.defineProperties(M0e.prototype,{creationCommand:{get:function(){return this._creationCommand}},category:{get:function(){return this._category}}});var ys=M0e;function zht(){let t=[];return t.push(new ys({name:"Bing Maps Aerial",iconUrl:Qt("Widgets/Images/ImageryProviders/bingAerial.png"),tooltip:"Bing Maps aerial imagery, provided by Cesium ion",category:"Cesium ion",creationFunction:function(){return Xg({style:Yg.AERIAL})}})),t.push(new ys({name:"Bing Maps Aerial with Labels",iconUrl:Qt("Widgets/Images/ImageryProviders/bingAerialLabels.png"),tooltip:"Bing Maps aerial imagery with labels, provided by Cesium ion",category:"Cesium ion",creationFunction:function(){return Xg({style:Yg.AERIAL_WITH_LABELS})}})),t.push(new ys({name:"Bing Maps Roads",iconUrl:Qt("Widgets/Images/ImageryProviders/bingRoads.png"),tooltip:"Bing Maps standard road maps, provided by Cesium ion",category:"Cesium ion",creationFunction:function(){return Xg({style:Yg.ROAD})}})),t.push(new ys({name:"ESRI World Imagery",iconUrl:Qt("Widgets/Images/ImageryProviders/esriWorldImagery.png"),tooltip:`World Imagery provides one meter or better satellite and aerial imagery in many parts of the world and lower resolution satellite imagery worldwide.  The map includes NASA Blue Marble: Next Generation 500m resolution imagery at small scales (above 1:1,000,000), i-cubed 15m eSAT imagery at medium-to-large scales (down to 1:70,000) for the world, and USGS 15m Landsat imagery for Antarctica. The map features 0.3m resolution imagery in the continental United States and 0.6m resolution imagery in parts of Western Europe from DigitalGlobe. In other parts of the world, 1 meter resolution imagery is available from GeoEye IKONOS, i-cubed Nationwide Prime, Getmapping, AeroGRID, IGN Spain, and IGP Portugal.  Additionally, imagery at different resolutions has been contributed by the GIS User Community.
http://www.esri.com`,category:"Other",creationFunction:function(){return new Hg({url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",enablePickFeatures:!1})}})),t.push(new ys({name:"ESRI World Street Map",iconUrl:Qt("Widgets/Images/ImageryProviders/esriWorldStreetMap.png"),tooltip:`This worldwide street map presents highway-level data for the world. Street-level data includes the United States; much of Canada; Japan; most countries in Europe; Australia and New Zealand; India; parts of South America including Argentina, Brazil, Chile, Colombia, and Venezuela; Ghana; and parts of southern Africa including Botswana, Lesotho, Namibia, South Africa, and Swaziland.
http://www.esri.com`,category:"Other",creationFunction:function(){return new Hg({url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer",enablePickFeatures:!1})}})),t.push(new ys({name:"ESRI National Geographic",iconUrl:Qt("Widgets/Images/ImageryProviders/esriNationalGeographic.png"),tooltip:`This web map contains the National Geographic World Map service. This map service is designed to be used as a general reference map for informational and educational purposes as well as a basemap by GIS professionals and other users for creating web maps and web mapping applications.
http://www.esri.com`,category:"Other",creationFunction:function(){return new Hg({url:"https://services.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer/",enablePickFeatures:!1})}})),t.push(new ys({name:"Open\xADStreet\xADMap",iconUrl:Qt("Widgets/Images/ImageryProviders/openStreetMap.png"),tooltip:`OpenStreetMap (OSM) is a collaborative project to create a free editable map of the world.
http://www.openstreetmap.org`,category:"Other",creationFunction:function(){return new KE({url:"https://a.tile.openstreetmap.org/"})}})),t.push(new ys({name:"Stamen Watercolor",iconUrl:Qt("Widgets/Images/ImageryProviders/stamenWatercolor.png"),tooltip:`Reminiscent of hand drawn maps, Stamen watercolor maps apply raster effect area washes and organic edges over a paper texture to add warm pop to any map.
http://maps.stamen.com`,category:"Other",creationFunction:function(){return new KE({url:"https://stamen-tiles.a.ssl.fastly.net/watercolor/",credit:"Map tiles by Stamen Design, under CC BY 3.0. Data by OpenStreetMap, under CC BY SA."})}})),t.push(new ys({name:"Stamen Toner",iconUrl:Qt("Widgets/Images/ImageryProviders/stamenToner.png"),tooltip:`A high contrast black and white map.
http://maps.stamen.com`,category:"Other",creationFunction:function(){return new KE({url:"https://stamen-tiles.a.ssl.fastly.net/toner/",credit:"Map tiles by Stamen Design, under CC BY 3.0. Data by OpenStreetMap, under CC BY SA."})}})),t.push(new ys({name:"Sentinel-2",iconUrl:Qt("Widgets/Images/ImageryProviders/sentinel-2.png"),tooltip:"Sentinel-2 cloudless by EOX IT Services GmbH (Contains modified Copernicus Sentinel data 2016 and 2017).",category:"Cesium ion",creationFunction:function(){return new qg({assetId:3954})}})),t.push(new ys({name:"Blue Marble",iconUrl:Qt("Widgets/Images/ImageryProviders/blueMarble.png"),tooltip:"Blue Marble Next Generation July, 2004 imagery from NASA.",category:"Cesium ion",creationFunction:function(){return new qg({assetId:3845})}})),t.push(new ys({name:"Earth at night",iconUrl:Qt("Widgets/Images/ImageryProviders/earthAtNight.png"),tooltip:"The Earth at night, also known as The Black Marble, is a 500 meter resolution global composite imagery layer released by NASA.",category:"Cesium ion",creationFunction:function(){return new qg({assetId:3812})}})),t.push(new ys({name:"Natural Earth\xA0II",iconUrl:Qt("Widgets/Images/ImageryProviders/naturalEarthII.png"),tooltip:`Natural Earth II, darkened for contrast.
http://www.naturalearthdata.com/`,category:"Cesium ion",creationFunction:function(){return new hA({url:Qt("Assets/Textures/NaturalEarthII")})}})),t}var U4=zht;function Hht(){let t=[];return t.push(new ys({name:"WGS84 Ellipsoid",iconUrl:Qt("Widgets/Images/TerrainProviders/Ellipsoid.png"),tooltip:"WGS84 standard ellipsoid, also known as EPSG:4326",category:"Cesium ion",creationFunction:function(){return new Lg}})),t.push(new ys({name:"Cesium World Terrain",iconUrl:Qt("Widgets/Images/TerrainProviders/CesiumWorldTerrain.png"),tooltip:"High-resolution global terrain tileset curated from several datasources and hosted by Cesium ion",category:"Cesium ion",creationFunction:function(){return q3({requestWaterMask:!0,requestVertexNormals:!0})}})),t}var z4=Hht;function Ght(t){return function(n){let i=t._scene.pick(n.position);f(i)&&i.primitive instanceof $c&&(t.tileset=i.primitive),t.pickActive=!1}}function F0e(t,n){n?t._eventHandler.setInputAction(function(i){let o=t._scene.pick(i.endPosition);f(o)&&o.primitive instanceof $c&&(t.tileset=o.primitive)},yn.MOUSE_MOVE):(t._eventHandler.removeInputAction(yn.MOUSE_MOVE),t.picking=t.picking)}var Wht={maximumFractionDigits:3};function iP(t){let n=t/1048576;return n<1?n.toLocaleString(void 0,Wht):Math.round(n).toLocaleString()}function oP(t,n){if(!f(t))return"";let i=n?t._statisticsPerPass[er.PICK]:t._statisticsPerPass[er.RENDER],o='<ul class="cesium-cesiumInspector-statistics">';return o+=`<li><strong>Visited: </strong>${i.visited.toLocaleString()}</li><li><strong>Selected: </strong>${i.selected.toLocaleString()}</li><li><strong>Commands: </strong>${i.numberOfCommands.toLocaleString()}</li>`,o+="</ul>",n||(o+='<ul class="cesium-cesiumInspector-statistics">',o+=`<li><strong>Requests: </strong>${i.numberOfPendingRequests.toLocaleString()}</li><li><strong>Attempted: </strong>${i.numberOfAttemptedRequests.toLocaleString()}</li><li><strong>Processing: </strong>${i.numberOfTilesProcessing.toLocaleString()}</li><li><strong>Content Ready: </strong>${i.numberOfTilesWithContentReady.toLocaleString()}</li><li><strong>Total: </strong>${i.numberOfTilesTotal.toLocaleString()}</li>`,o+="</ul>",o+='<ul class="cesium-cesiumInspector-statistics">',o+=`<li><strong>Features Selected: </strong>${i.numberOfFeaturesSelected.toLocaleString()}</li><li><strong>Features Loaded: </strong>${i.numberOfFeaturesLoaded.toLocaleString()}</li><li><strong>Points Selected: </strong>${i.numberOfPointsSelected.toLocaleString()}</li><li><strong>Points Loaded: </strong>${i.numberOfPointsLoaded.toLocaleString()}</li><li><strong>Triangles Selected: </strong>${i.numberOfTrianglesSelected.toLocaleString()}</li>`,o+="</ul>",o+='<ul class="cesium-cesiumInspector-statistics">',o+=`<li><strong>Tiles styled: </strong>${i.numberOfTilesStyled.toLocaleString()}</li><li><strong>Features styled: </strong>${i.numberOfFeaturesStyled.toLocaleString()}</li>`,o+="</ul>",o+='<ul class="cesium-cesiumInspector-statistics">',o+=`<li><strong>Children Union Culled: </strong>${i.numberOfTilesCulledWithChildrenUnion.toLocaleString()}</li>`,o+="</ul>",o+='<ul class="cesium-cesiumInspector-statistics">',o+=`<li><strong>Geometry Memory (MB): </strong>${iP(i.geometryByteLength)}</li><li><strong>Texture Memory (MB): </strong>${iP(i.texturesByteLength)}</li><li><strong>Batch Table Memory (MB): </strong>${iP(i.batchTableByteLength)}</li>`,o+="</ul>"),o}function N0e(){let t=fo.statistics;return`
  <ul class="cesium-cesiumInspector-statistics">
    <li><strong>Geometry Memory (MB): </strong>${iP(t.geometryByteLength)}</li>
    <li><strong>Texture Memory (MB): </strong>${iP(t.texturesByteLength)}</li>
  </ul>
  `}var jht=[{text:"Highlight",value:Bl.HIGHLIGHT},{text:"Replace",value:Bl.REPLACE},{text:"Mix",value:Bl.MIX}],L0e=new z(1,1,0,.4),qht=new z,H4=new z;function Ys(t,n){let i=this,o=t.canvas;this._eventHandler=new nf(o),this._scene=t,this._performanceContainer=n,this._canvas=o,this._performanceDisplay=new Qg({container:n}),this._statisticsText="",this._pickStatisticsText="",this._resourceCacheStatisticsText="",this._editorError="",this.performance=!1,this.showStatistics=!0,this.showPickStatistics=!0,this.showResourceCacheStatistics=!1,this.inspectorVisible=!0,this.tilesetVisible=!1,this.displayVisible=!1,this.updateVisible=!1,this.loggingVisible=!1,this.styleVisible=!1,this.tileDebugLabelsVisible=!1,this.optimizationVisible=!1,this.styleString="{}",this.hasEnabledWireframe=!1,this._tileset=void 0,this._feature=void 0,this._tile=void 0,xe.track(this,["performance","inspectorVisible","_statisticsText","_pickStatisticsText","_resourceCacheStatisticsText","_editorError","showPickStatistics","showStatistics","showResourceCacheStatistics","tilesetVisible","displayVisible","updateVisible","loggingVisible","styleVisible","optimizationVisible","tileDebugLabelsVisible","styleString","_feature","_tile","_tileset","hasEnabledWireframe"]),this._properties=xe.observable({}),this.properties=[],xe.defineProperty(this,"properties",function(){let k=[],X=i._properties();for(let Y in X)X.hasOwnProperty(Y)&&k.push(Y);return k});let r=xe.observable();xe.defineProperty(this,"dynamicScreenSpaceError",{get:function(){return r()},set:function(k){r(k),f(i._tileset)&&(i._tileset.dynamicScreenSpaceError=k)}}),this.dynamicScreenSpaceError=!1;let s=xe.observable();xe.defineProperty(this,"colorBlendMode",{get:function(){return s()},set:function(k){s(k),f(i._tileset)&&(i._tileset.colorBlendMode=k,i._scene.requestRender())}}),this.colorBlendMode=Bl.HIGHLIGHT;let a=xe.observable(),c=xe.observable();xe.defineProperty(this,"picking",{get:function(){return c()},set:function(k){c(k),k?i._eventHandler.setInputAction(function(X){let Y=t.pick(X.endPosition);if(Y instanceof Ds?(i.feature=Y,i.tile=Y.content.tile):f(Y)&&f(Y.content)?(i.feature=void 0,i.tile=Y.content.tile):(i.feature=void 0,i.tile=void 0),!!f(i._tileset)){if(a&&f(Y)&&f(Y.content)){let K;t.pickPositionSupported&&(K=t.pickPosition(X.endPosition),f(K)&&(i._tileset.debugPickPosition=K)),i._tileset.debugPickedTile=Y.content.tile}else i._tileset.debugPickedTile=void 0;i._scene.requestRender()}},yn.MOUSE_MOVE):(i.feature=void 0,i.tile=void 0,i._eventHandler.removeInputAction(yn.MOUSE_MOVE))}}),this.picking=!0;let l=xe.observable();xe.defineProperty(this,"colorize",{get:function(){return l()},set:function(k){l(k),f(i._tileset)&&(i._tileset.debugColorizeTiles=k,i._scene.requestRender())}}),this.colorize=!1;let u=xe.observable();xe.defineProperty(this,"wireframe",{get:function(){return u()},set:function(k){u(k),f(i._tileset)&&(i._tileset.debugWireframe=k,i._scene.requestRender())}}),this.wireframe=!1;let d=xe.observable();xe.defineProperty(this,"showBoundingVolumes",{get:function(){return d()},set:function(k){d(k),f(i._tileset)&&(i._tileset.debugShowBoundingVolume=k,i._scene.requestRender())}}),this.showBoundingVolumes=!1;let h=xe.observable();xe.defineProperty(this,"showContentBoundingVolumes",{get:function(){return h()},set:function(k){h(k),f(i._tileset)&&(i._tileset.debugShowContentBoundingVolume=k,i._scene.requestRender())}}),this.showContentBoundingVolumes=!1;let _=xe.observable();xe.defineProperty(this,"showRequestVolumes",{get:function(){return _()},set:function(k){_(k),f(i._tileset)&&(i._tileset.debugShowViewerRequestVolume=k,i._scene.requestRender())}}),this.showRequestVolumes=!1;let y=xe.observable();xe.defineProperty(this,"freezeFrame",{get:function(){return y()},set:function(k){y(k),f(i._tileset)&&(i._tileset.debugFreezeFrame=k,i._scene.debugShowFrustumPlanes=k,i._scene.requestRender())}}),this.freezeFrame=!1,xe.defineProperty(this,"showOnlyPickedTileDebugLabel",{get:function(){return a()},set:function(k){a(k),f(i._tileset)&&(i._tileset.debugPickedTileLabelOnly=k,i._scene.requestRender())}}),this.showOnlyPickedTileDebugLabel=!1;let p=xe.observable();xe.defineProperty(this,"showGeometricError",{get:function(){return p()},set:function(k){p(k),f(i._tileset)&&(i._tileset.debugShowGeometricError=k,i._scene.requestRender())}}),this.showGeometricError=!1;let C=xe.observable();xe.defineProperty(this,"showRenderingStatistics",{get:function(){return C()},set:function(k){C(k),f(i._tileset)&&(i._tileset.debugShowRenderingStatistics=k,i._scene.requestRender())}}),this.showRenderingStatistics=!1;let x=xe.observable();xe.defineProperty(this,"showMemoryUsage",{get:function(){return x()},set:function(k){x(k),f(i._tileset)&&(i._tileset.debugShowMemoryUsage=k,i._scene.requestRender())}}),this.showMemoryUsage=!1;let T=xe.observable();xe.defineProperty(this,"showUrl",{get:function(){return T()},set:function(k){T(k),f(i._tileset)&&(i._tileset.debugShowUrl=k,i._scene.requestRender())}}),this.showUrl=!1;let E=xe.observable();xe.defineProperty(this,"maximumScreenSpaceError",{get:function(){return E()},set:function(k){k=Number(k),isNaN(k)||(E(k),f(i._tileset)&&(i._tileset.maximumScreenSpaceError=k))}}),this.maximumScreenSpaceError=16;let S=xe.observable();xe.defineProperty(this,"dynamicScreenSpaceErrorDensity",{get:function(){return S()},set:function(k){k=Number(k),isNaN(k)||(S(k),f(i._tileset)&&(i._tileset.dynamicScreenSpaceErrorDensity=k))}}),this.dynamicScreenSpaceErrorDensity=.00278,this.dynamicScreenSpaceErrorDensitySliderValue=void 0,xe.defineProperty(this,"dynamicScreenSpaceErrorDensitySliderValue",{get:function(){return Math.pow(S(),1/6)},set:function(k){S(Math.pow(k,6))}});let w=xe.observable();xe.defineProperty(this,"dynamicScreenSpaceErrorFactor",{get:function(){return w()},set:function(k){k=Number(k),isNaN(k)||(w(k),f(i._tileset)&&(i._tileset.dynamicScreenSpaceErrorFactor=k))}}),this.dynamicScreenSpaceErrorFactor=4;let D=Ght(this),I=xe.observable();xe.defineProperty(this,"pickActive",{get:function(){return I()},set:function(k){I(k),k?i._eventHandler.setInputAction(D,yn.LEFT_CLICK):i._eventHandler.removeInputAction(yn.LEFT_CLICK)}});let O=xe.observable();xe.defineProperty(this,"pointCloudShading",{get:function(){return O()},set:function(k){O(k),f(i._tileset)&&(i._tileset.pointCloudShading.attenuation=k)}}),this.pointCloudShading=!1;let M=xe.observable();xe.defineProperty(this,"geometricErrorScale",{get:function(){return M()},set:function(k){k=Number(k),isNaN(k)||(M(k),f(i._tileset)&&(i._tileset.pointCloudShading.geometricErrorScale=k))}}),this.geometricErrorScale=1;let L=xe.observable();xe.defineProperty(this,"maximumAttenuation",{get:function(){return L()},set:function(k){k=Number(k),isNaN(k)||(L(k),f(i._tileset)&&(i._tileset.pointCloudShading.maximumAttenuation=k===0?void 0:k))}}),this.maximumAttenuation=0;let F=xe.observable();xe.defineProperty(this,"baseResolution",{get:function(){return F()},set:function(k){k=Number(k),isNaN(k)||(F(k),f(i._tileset)&&(i._tileset.pointCloudShading.baseResolution=k===0?void 0:k))}}),this.baseResolution=0;let g=xe.observable();xe.defineProperty(this,"eyeDomeLighting",{get:function(){return g()},set:function(k){g(k),f(i._tileset)&&(i._tileset.pointCloudShading.eyeDomeLighting=k)}}),this.eyeDomeLighting=!1;let b=xe.observable();xe.defineProperty(this,"eyeDomeLightingStrength",{get:function(){return b()},set:function(k){k=Number(k),isNaN(k)||(b(k),f(i._tileset)&&(i._tileset.pointCloudShading.eyeDomeLightingStrength=k))}}),this.eyeDomeLightingStrength=1;let v=xe.observable();xe.defineProperty(this,"eyeDomeLightingRadius",{get:function(){return v()},set:function(k){k=Number(k),isNaN(k)||(v(k),f(i._tileset)&&(i._tileset.pointCloudShading.eyeDomeLightingRadius=k))}}),this.eyeDomeLightingRadius=1,this.pickActive=!1;let P=xe.observable();xe.defineProperty(this,"skipLevelOfDetail",{get:function(){return P()},set:function(k){P(k),f(i._tileset)&&(i._tileset.skipLevelOfDetail=k)}}),this.skipLevelOfDetail=!0;let R=xe.observable();xe.defineProperty(this,"skipScreenSpaceErrorFactor",{get:function(){return R()},set:function(k){k=Number(k),isNaN(k)||(R(k),f(i._tileset)&&(i._tileset.skipScreenSpaceErrorFactor=k))}}),this.skipScreenSpaceErrorFactor=16;let V=xe.observable();xe.defineProperty(this,"baseScreenSpaceError",{get:function(){return V()},set:function(k){k=Number(k),isNaN(k)||(V(k),f(i._tileset)&&(i._tileset.baseScreenSpaceError=k))}}),this.baseScreenSpaceError=1024;let H=xe.observable();xe.defineProperty(this,"skipLevels",{get:function(){return H()},set:function(k){k=Number(k),isNaN(k)||(H(k),f(i._tileset)&&(i._tileset.skipLevels=k))}}),this.skipLevels=1;let U=xe.observable();xe.defineProperty(this,"immediatelyLoadDesiredLevelOfDetail",{get:function(){return U()},set:function(k){U(k),f(i._tileset)&&(i._tileset.immediatelyLoadDesiredLevelOfDetail=k)}}),this.immediatelyLoadDesiredLevelOfDetail=!1;let G=xe.observable();xe.defineProperty(this,"loadSiblings",{get:function(){return G()},set:function(k){G(k),f(i._tileset)&&(i._tileset.loadSiblings=k)}}),this.loadSiblings=!1,this._style=void 0,this._shouldStyle=!1,this._definedProperties=["properties","dynamicScreenSpaceError","colorBlendMode","picking","colorize","wireframe","showBoundingVolumes","showContentBoundingVolumes","showRequestVolumes","freezeFrame","maximumScreenSpaceError","dynamicScreenSpaceErrorDensity","baseScreenSpaceError","skipScreenSpaceErrorFactor","skipLevelOfDetail","skipLevels","immediatelyLoadDesiredLevelOfDetail","loadSiblings","dynamicScreenSpaceErrorDensitySliderValue","dynamicScreenSpaceErrorFactor","pickActive","showOnlyPickedTileDebugLabel","showGeometricError","showRenderingStatistics","showMemoryUsage","showUrl","pointCloudShading","geometricErrorScale","maximumAttenuation","baseResolution","eyeDomeLighting","eyeDomeLightingStrength","eyeDomeLightingRadius"],this._removePostRenderEvent=t.postRender.addEventListener(function(){i._update()}),f(this._tileset)||F0e(this,!0)}Object.defineProperties(Ys.prototype,{scene:{get:function(){return this._scene}},performanceContainer:{get:function(){return this._performanceContainer}},statisticsText:{get:function(){return this._statisticsText}},pickStatisticsText:{get:function(){return this._pickStatisticsText}},resourceCacheStatisticsText:{get:function(){return this._resourceCacheStatisticsText}},colorBlendModes:{get:function(){return jht}},editorError:{get:function(){return this._editorError}},tileset:{get:function(){return this._tileset},set:function(t){if(this._tileset=t,this._style=void 0,this.styleString="{}",this.feature=void 0,this.tile=void 0,f(t)){let n=this;t.readyPromise.then(function(s){n.isDestroyed()||n._properties(s.properties)});let i=["colorize","wireframe","showBoundingVolumes","showContentBoundingVolumes","showRequestVolumes","freezeFrame","showOnlyPickedTileDebugLabel","showGeometricError","showRenderingStatistics","showMemoryUsage","showUrl"],o=i.length;for(let s=0;s<o;++s){let a=i[s];this[a]=this[a]}this.maximumScreenSpaceError=t.maximumScreenSpaceError,this.dynamicScreenSpaceError=t.dynamicScreenSpaceError,this.dynamicScreenSpaceErrorDensity=t.dynamicScreenSpaceErrorDensity,this.dynamicScreenSpaceErrorFactor=t.dynamicScreenSpaceErrorFactor,this.colorBlendMode=t.colorBlendMode,this.skipLevelOfDetail=t.skipLevelOfDetail,this.skipScreenSpaceErrorFactor=t.skipScreenSpaceErrorFactor,this.baseScreenSpaceError=t.baseScreenSpaceError,this.skipLevels=t.skipLevels,this.immediatelyLoadDesiredLevelOfDetail=t.immediatelyLoadDesiredLevelOfDetail,this.loadSiblings=t.loadSiblings,this.hasEnabledWireframe=t._enableDebugWireframe;let r=t.pointCloudShading;this.pointCloudShading=r.attenuation,this.geometricErrorScale=r.geometricErrorScale,this.maximumAttenuation=r.maximumAttenuation?r.maximumAttenuation:0,this.baseResolution=r.baseResolution?r.baseResolution:0,this.eyeDomeLighting=r.eyeDomeLighting,this.eyeDomeLightingStrength=r.eyeDomeLightingStrength,this.eyeDomeLightingRadius=r.eyeDomeLightingRadius,this._scene.requestRender()}else this._properties({});this._statisticsText=oP(t,!1),this._pickStatisticsText=oP(t,!0),this._resourceCacheStatisticsText=N0e(),F0e(this,!1)}},feature:{get:function(){return this._feature},set:function(t){if(this._feature===t)return;let n=this._feature;f(n)&&!n.content.isDestroyed()&&(!this.colorize&&f(this._style)?n.color=f(this._style.color)?this._style.color.evaluateColor(n,qht):z.WHITE:n.color=H4,this._scene.requestRender()),f(t)&&(z.clone(t.color,H4),t.color=L0e,this._scene.requestRender()),this._feature=t}},tile:{get:function(){return this._tile},set:function(t){if(this._tile===t)return;let n=this._tile;f(n)&&!n.isDestroyed()&&!Hq(n.content)&&(n.color=H4,this._scene.requestRender()),f(t)&&!Hq(t.content)&&(z.clone(t.color,H4),t.color=L0e,this._scene.requestRender()),this._tile=t}}});function Hq(t){if(!f(t))return!1;if(t.featuresLength>0)return!0;let n=t.innerContents;if(f(n)){let i=n.length;for(let o=0;o<i;++o)if(!Hq(n[o]))return!1;return!0}return!1}Ys.prototype.togglePickTileset=function(){this.pickActive=!this.pickActive};Ys.prototype.toggleInspector=function(){this.inspectorVisible=!this.inspectorVisible};Ys.prototype.toggleTileset=function(){this.tilesetVisible=!this.tilesetVisible};Ys.prototype.toggleDisplay=function(){this.displayVisible=!this.displayVisible};Ys.prototype.toggleUpdate=function(){this.updateVisible=!this.updateVisible};Ys.prototype.toggleLogging=function(){this.loggingVisible=!this.loggingVisible};Ys.prototype.toggleStyle=function(){this.styleVisible=!this.styleVisible};Ys.prototype.toggleTileDebugLabels=function(){this.tileDebugLabelsVisible=!this.tileDebugLabelsVisible};Ys.prototype.toggleOptimization=function(){this.optimizationVisible=!this.optimizationVisible};Ys.prototype.trimTilesCache=function(){f(this._tileset)&&this._tileset.trimLoadedTiles()};Ys.prototype.compileStyle=function(){let t=this._tileset;if(!(!f(t)||this.styleString===JSON.stringify(t.style))){this._editorError="";try{this.styleString.length===0&&(this.styleString="{}"),this._style=new OE(JSON.parse(this.styleString)),this._shouldStyle=!0,this._scene.requestRender()}catch(n){this._editorError=n.toString()}this.feature=this._feature,this.tile=this._tile}};Ys.prototype.styleEditorKeyPress=function(t,n){if(n.keyCode===9){n.preventDefault();let i=n.target,o=i.selectionStart,r=i.selectionEnd,s=r,c=i.value.slice(o,r).split(`
`),l=c.length,u;if(n.shiftKey)for(u=0;u<l;++u)c[u][0]===" "&&(c[u][1]===" "?(c[u]=c[u].substr(2),s-=2):(c[u]=c[u].substr(1),s-=1));else for(u=0;u<l;++u)c[u]=`  ${c[u]}`,s+=2;let d=c.join(`
`);i.value=i.value.slice(0,o)+d+i.value.slice(r),i.selectionStart=o!==r?o:s,i.selectionEnd=s}else n.ctrlKey&&(n.keyCode===10||n.keyCode===13)&&this.compileStyle();return!0};Ys.prototype._update=function(){let t=this._tileset;if(this.performance&&this._performanceDisplay.update(),f(t)){if(t.isDestroyed()){this.tile=void 0,this.feature=void 0,this.tileset=void 0;return}let n=t.style;this._style!==t.style&&(this._shouldStyle?(t.style=this._style,this._shouldStyle=!1):(this._style=n,this.styleString=JSON.stringify(n.style,null,"  ")))}this.showStatistics&&(this._statisticsText=oP(t,!1),this._pickStatisticsText=oP(t,!0),this._resourceCacheStatisticsText=N0e())};Ys.prototype.isDestroyed=function(){return!1};Ys.prototype.destroy=function(){this._eventHandler.destroy(),this._removePostRenderEvent();let t=this;return this._definedProperties.forEach(function(n){xe.getObservable(t,n).dispose()}),ue(this)};Ys.getStatistics=oP;var G4=Ys;function W4(t,n){t=On(t);let i=document.createElement("div"),o=document.createElement("div");o.setAttribute("data-bind","visible: performance");let r=new G4(n,o);this._viewModel=r,this._container=t,this._element=i;let s=document.createElement("div");s.textContent="3D Tiles Inspector",s.className="cesium-cesiumInspector-button",s.setAttribute("data-bind","click: toggleInspector"),i.appendChild(s),i.className="cesium-cesiumInspector cesium-3DTilesInspector",i.setAttribute("data-bind",'css: { "cesium-cesiumInspector-visible" : inspectorVisible, "cesium-cesiumInspector-hidden" : !inspectorVisible}'),t.appendChild(i);let a=document.createElement("div");this._panel=a,a.className="cesium-cesiumInspector-dropDown",i.appendChild(a);let c=o0.createSection,l=o0.createCheckbox,u=c(a,"Tileset","tilesetVisible","toggleTileset"),d=c(a,"Display","displayVisible","toggleDisplay"),h=c(a,"Update","updateVisible","toggleUpdate"),_=c(a,"Logging","loggingVisible","toggleLogging"),y=c(a,"Tile Debug Labels","tileDebugLabelsVisible","toggleTileDebugLabels"),p=c(a,"Style","styleVisible","toggleStyle"),C=c(a,"Optimization","optimizationVisible","toggleOptimization"),x=document.createElement("div");x.className="field-group";let T=document.createElement("label");T.className="field-label",T.appendChild(document.createTextNode("Properties: "));let E=document.createElement("div");E.setAttribute("data-bind","text: properties"),x.appendChild(T),x.appendChild(E),u.appendChild(x),u.appendChild(Gq("togglePickTileset","Pick Tileset","pickActive")),u.appendChild(Gq("trimTilesCache","Trim Tiles Cache")),u.appendChild(l("Enable Picking","picking")),d.appendChild(l("Colorize","colorize")),d.appendChild(l("Wireframe","wireframe","_tileset === undefined || hasEnabledWireframe"));let S=document.createElement("p");S.setAttribute("data-bind","visible: _tileset !== undefined && !hasEnabledWireframe"),S.setAttribute("class","cesium-3DTilesInspector-disabledElementsInfo"),S.innerText="Set enableDebugWireframe to true in the tileset constructor to enable this option.",d.lastChild.appendChild(S),d.appendChild(l("Bounding Volumes","showBoundingVolumes")),d.appendChild(l("Content Volumes","showContentBoundingVolumes")),d.appendChild(l("Request Volumes","showRequestVolumes")),d.appendChild(l("Point Cloud Shading","pointCloudShading"));let w=document.createElement("div");w.setAttribute("data-bind","visible: pointCloudShading"),w.appendChild(vd("geometricErrorScale",0,2,.01,"Geometric Error Scale")),w.appendChild(vd("maximumAttenuation",0,32,1,"Maximum Attenuation")),w.appendChild(vd("baseResolution",0,1,.01,"Base Resolution")),w.appendChild(l("Eye Dome Lighting (EDL)","eyeDomeLighting")),d.appendChild(w);let D=document.createElement("div");D.setAttribute("data-bind","visible: eyeDomeLighting"),D.appendChild(vd("eyeDomeLightingStrength",0,2,.1,"EDL Strength")),D.appendChild(vd("eyeDomeLightingRadius",0,4,.1,"EDL Radius")),w.appendChild(D),h.appendChild(l("Freeze Frame","freezeFrame")),h.appendChild(l("Dynamic Screen Space Error","dynamicScreenSpaceError"));let I=document.createElement("div");I.appendChild(vd("maximumScreenSpaceError",0,128,1,"Maximum Screen Space Error")),h.appendChild(I);let O=document.createElement("div");O.setAttribute("data-bind","visible: dynamicScreenSpaceError"),O.appendChild(vd("dynamicScreenSpaceErrorDensitySliderValue",0,1,.005,"Screen Space Error Density","dynamicScreenSpaceErrorDensity")),O.appendChild(vd("dynamicScreenSpaceErrorFactor",1,10,.1,"Screen Space Error Factor")),h.appendChild(O),_.appendChild(l("Performance","performance")),_.appendChild(o),_.appendChild(l("Statistics","showStatistics"));let M=document.createElement("div");M.className="cesium-3dTilesInspector-statistics",M.setAttribute("data-bind","html: statisticsText, visible: showStatistics"),_.appendChild(M),_.appendChild(l("Pick Statistics","showPickStatistics"));let L=document.createElement("div");L.className="cesium-3dTilesInspector-statistics",L.setAttribute("data-bind","html: pickStatisticsText, visible: showPickStatistics"),_.appendChild(L),_.appendChild(l("Resource Cache Statistics","showResourceCacheStatistics"));let F=document.createElement("div");F.className="cesium-3dTilesInspector-statistics",F.setAttribute("data-bind","html: resourceCacheStatisticsText, visible: showResourceCacheStatistics"),_.appendChild(F);let g=document.createElement("div");p.appendChild(g),g.appendChild(document.createTextNode("Color Blend Mode: "));let b=document.createElement("select");b.setAttribute("data-bind",'options: colorBlendModes, optionsText: "text", optionsValue: "value", value: colorBlendMode'),g.appendChild(b);let v=document.createElement("textarea");v.setAttribute("data-bind","textInput: styleString, event: { keydown: styleEditorKeyPress }"),g.className="cesium-cesiumInspector-styleEditor",g.appendChild(v);let P=Gq("compileStyle","Compile (Ctrl+Enter)");g.appendChild(P);let R=document.createElement("div");R.className="cesium-cesiumInspector-error",R.setAttribute("data-bind","text: editorError"),g.appendChild(R),y.appendChild(l("Show Picked Only","showOnlyPickedTileDebugLabel")),y.appendChild(l("Geometric Error","showGeometricError")),y.appendChild(l("Rendering Statistics","showRenderingStatistics")),y.appendChild(l("Memory Usage (MB)","showMemoryUsage")),y.appendChild(l("Url","showUrl")),C.appendChild(l("Skip Tile LODs","skipLevelOfDetail"));let V=document.createElement("div");V.appendChild(vd("skipScreenSpaceErrorFactor",1,50,1,"Skip SSE Factor")),C.appendChild(V);let H=document.createElement("div");H.appendChild(vd("baseScreenSpaceError",0,4096,1,"SSE before skipping LOD")),C.appendChild(H);let U=document.createElement("div");U.appendChild(vd("skipLevels",0,10,1,"Min. levels to skip")),C.appendChild(U),C.appendChild(l("Load only tiles that meet the max SSE.","immediatelyLoadDesiredLevelOfDetail")),C.appendChild(l("Load siblings of visible tiles","loadSiblings")),xe.applyBindings(r,i)}Object.defineProperties(W4.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}});W4.prototype.isDestroyed=function(){return!1};W4.prototype.destroy=function(){return xe.cleanNode(this._element),this._container.removeChild(this._element),this.viewModel.destroy(),ue(this)};function vd(t,n,i,o,r,s){s=A(s,t);let a=document.createElement("input");a.setAttribute("data-bind",`value: ${s}`),a.type="number";let c=document.createElement("input");c.type="range",c.min=n,c.max=i,c.step=o,c.setAttribute("data-bind",`valueUpdate: "input", value: ${t}`);let l=document.createElement("div");l.appendChild(c);let u=document.createElement("div");return u.className="cesium-cesiumInspector-slider",u.appendChild(document.createTextNode(r)),u.appendChild(a),u.appendChild(l),u}function Gq(t,n,i){let o=document.createElement("button");o.type="button",o.textContent=n,o.className="cesium-cesiumInspector-pickButton";let r=`click: ${t}`;return f(i)&&(r+=`, css: {"cesium-cesiumInspector-pickButtonHighlight" : ${i}}`),o.setAttribute("data-bind",r),o}var j4=W4;function Yht(t){let n;if(f(t)){n="Command Statistics";let i=t.commandsInFrustums;for(let o in i)if(i.hasOwnProperty(o)){let r=parseInt(o,10),s;if(r===7)s="1, 2 and 3";else{let a=[];for(let c=2;c>=0;c--){let l=Math.pow(2,c);r>=l&&(a.push(c+1),r-=l)}s=a.reverse().join(" and ")}n+=`<br>&nbsp;&nbsp;&nbsp;&nbsp;${i[o]} in frustum ${s}`}n+=`<br>Total: ${t.totalCommands}`}return n}function Wq(t,n,i){let o=Math.min(i,n);return o=Math.max(o,t),o}var Xht=new dn,Kht=new m;function rP(t,n){let i=this,o=t.canvas,r=new nf(o);this._eventHandler=r,this._scene=t,this._canvas=o,this._primitive=void 0,this._tile=void 0,this._modelMatrixPrimitive=void 0,this._performanceDisplay=void 0,this._performanceContainer=n;let s=this._scene.globe;s.depthTestAgainstTerrain=!0,this.frustums=!1,this.frustumPlanes=!1,this.performance=!1,this.shaderCacheText="",this.primitiveBoundingSphere=!1,this.primitiveReferenceFrame=!1,this.filterPrimitive=!1,this.tileBoundingSphere=!1,this.filterTile=!1,this.wireframe=!1,this.depthFrustum=1,this._numberOfFrustums=1,this.suspendUpdates=!1,this.tileCoordinates=!1,this.frustumStatisticText=!1,this.tileText="",this.hasPickedPrimitive=!1,this.hasPickedTile=!1,this.pickPrimitiveActive=!1,this.pickTileActive=!1,this.dropDownVisible=!0,this.generalVisible=!0,this.primitivesVisible=!1,this.terrainVisible=!1,this.depthFrustumText="",xe.track(this,["frustums","frustumPlanes","performance","shaderCacheText","primitiveBoundingSphere","primitiveReferenceFrame","filterPrimitive","tileBoundingSphere","filterTile","wireframe","depthFrustum","suspendUpdates","tileCoordinates","frustumStatisticText","tileText","hasPickedPrimitive","hasPickedTile","pickPrimitiveActive","pickTileActive","dropDownVisible","generalVisible","primitivesVisible","terrainVisible","depthFrustumText"]),this._toggleDropDown=Tn(function(){i.dropDownVisible=!i.dropDownVisible}),this._toggleGeneral=Tn(function(){i.generalVisible=!i.generalVisible}),this._togglePrimitives=Tn(function(){i.primitivesVisible=!i.primitivesVisible}),this._toggleTerrain=Tn(function(){i.terrainVisible=!i.terrainVisible}),this._frustumsSubscription=xe.getObservable(this,"frustums").subscribe(function(u){i._scene.debugShowFrustums=u,i._scene.requestRender()}),this._frustumPlanesSubscription=xe.getObservable(this,"frustumPlanes").subscribe(function(u){i._scene.debugShowFrustumPlanes=u,i._scene.requestRender()}),this._performanceSubscription=xe.getObservable(this,"performance").subscribe(function(u){u?i._performanceDisplay=new Qg({container:i._performanceContainer}):i._performanceContainer.innerHTML=""}),this._showPrimitiveBoundingSphere=Tn(function(){return i._primitive.debugShowBoundingVolume=i.primitiveBoundingSphere,i._scene.requestRender(),!0}),this._primitiveBoundingSphereSubscription=xe.getObservable(this,"primitiveBoundingSphere").subscribe(function(){i._showPrimitiveBoundingSphere()}),this._showPrimitiveReferenceFrame=Tn(function(){if(i.primitiveReferenceFrame){let u=i._primitive.modelMatrix;i._modelMatrixPrimitive=new Dk({modelMatrix:u}),i._scene.primitives.add(i._modelMatrixPrimitive)}else f(i._modelMatrixPrimitive)&&(i._scene.primitives.remove(i._modelMatrixPrimitive),i._modelMatrixPrimitive=void 0);return i._scene.requestRender(),!0}),this._primitiveReferenceFrameSubscription=xe.getObservable(this,"primitiveReferenceFrame").subscribe(function(){i._showPrimitiveReferenceFrame()}),this._doFilterPrimitive=Tn(function(){return i.filterPrimitive?i._scene.debugCommandFilter=function(u){return f(i._modelMatrixPrimitive)&&u.owner===i._modelMatrixPrimitive._primitive?!0:f(i._primitive)?u.owner===i._primitive||u.owner===i._primitive._billboardCollection||u.owner.primitive===i._primitive:!1}:i._scene.debugCommandFilter=void 0,!0}),this._filterPrimitiveSubscription=xe.getObservable(this,"filterPrimitive").subscribe(function(){i._doFilterPrimitive(),i._scene.requestRender()}),this._wireframeSubscription=xe.getObservable(this,"wireframe").subscribe(function(u){s._surface.tileProvider._debug.wireframe=u,i._scene.requestRender()}),this._depthFrustumSubscription=xe.getObservable(this,"depthFrustum").subscribe(function(u){i._scene.debugShowDepthFrustum=u,i._scene.requestRender()}),this._incrementDepthFrustum=Tn(function(){let u=i.depthFrustum+1;return i.depthFrustum=Wq(1,i._numberOfFrustums,u),i._scene.requestRender(),!0}),this._decrementDepthFrustum=Tn(function(){let u=i.depthFrustum-1;return i.depthFrustum=Wq(1,i._numberOfFrustums,u),i._scene.requestRender(),!0}),this._suspendUpdatesSubscription=xe.getObservable(this,"suspendUpdates").subscribe(function(u){s._surface._debug.suspendLodUpdate=u,u||(i.filterTile=!1)});let a;this._showTileCoordinates=Tn(function(){return i.tileCoordinates&&!f(a)?a=t.imageryLayers.addImageryProvider(new S4({tilingScheme:t.terrainProvider.tilingScheme})):!i.tileCoordinates&&f(a)&&(t.imageryLayers.remove(a),a=void 0),!0}),this._tileCoordinatesSubscription=xe.getObservable(this,"tileCoordinates").subscribe(function(){i._showTileCoordinates(),i._scene.requestRender()}),this._tileBoundingSphereSubscription=xe.getObservable(this,"tileBoundingSphere").subscribe(function(){i._showTileBoundingSphere(),i._scene.requestRender()}),this._showTileBoundingSphere=Tn(function(){return i.tileBoundingSphere?s._surface.tileProvider._debug.boundingSphereTile=i._tile:s._surface.tileProvider._debug.boundingSphereTile=void 0,i._scene.requestRender(),!0}),this._doFilterTile=Tn(function(){return i.filterTile?(i.suspendUpdates=!0,s._surface._tilesToRender=[],f(i._tile)&&i._tile.renderable&&s._surface._tilesToRender.push(i._tile)):i.suspendUpdates=!1,!0}),this._filterTileSubscription=xe.getObservable(this,"filterTile").subscribe(function(){i.doFilterTile(),i._scene.requestRender()});function c(u){let d=i._scene.pick({x:u.position.x,y:u.position.y});f(d)&&(i.primitive=f(d.collection)?d.collection:d.primitive),i._scene.requestRender(),i.pickPrimitiveActive=!1}this._pickPrimitive=Tn(function(){i.pickPrimitiveActive=!i.pickPrimitiveActive}),this._pickPrimitiveActiveSubscription=xe.getObservable(this,"pickPrimitiveActive").subscribe(function(u){u?r.setInputAction(c,yn.LEFT_CLICK):r.removeInputAction(yn.LEFT_CLICK)});function l(u){let d,h=s.ellipsoid,_=i._scene.camera.getPickRay(u.position,Xht),y=s.pick(_,i._scene,Kht);if(f(y)){let p=h.cartesianToCartographic(y),C=s._surface.tileProvider._tilesToRenderByTextureCount;for(let x=0;!d&&x<C.length;++x){let T=C[x];if(!!f(T))for(let E=0;!d&&E<T.length;++E){let S=T[E];le.contains(S.rectangle,p)&&(d=S)}}}i.tile=d,i.pickTileActive=!1}this._pickTile=Tn(function(){i.pickTileActive=!i.pickTileActive}),this._pickTileActiveSubscription=xe.getObservable(this,"pickTileActive").subscribe(function(u){u?r.setInputAction(l,yn.LEFT_CLICK):r.removeInputAction(yn.LEFT_CLICK)}),this._removePostRenderEvent=t.postRender.addEventListener(function(){i._update()})}Object.defineProperties(rP.prototype,{scene:{get:function(){return this._scene}},performanceContainer:{get:function(){return this._performanceContainer}},toggleDropDown:{get:function(){return this._toggleDropDown}},showPrimitiveBoundingSphere:{get:function(){return this._showPrimitiveBoundingSphere}},showPrimitiveReferenceFrame:{get:function(){return this._showPrimitiveReferenceFrame}},doFilterPrimitive:{get:function(){return this._doFilterPrimitive}},incrementDepthFrustum:{get:function(){return this._incrementDepthFrustum}},decrementDepthFrustum:{get:function(){return this._decrementDepthFrustum}},showTileCoordinates:{get:function(){return this._showTileCoordinates}},showTileBoundingSphere:{get:function(){return this._showTileBoundingSphere}},doFilterTile:{get:function(){return this._doFilterTile}},toggleGeneral:{get:function(){return this._toggleGeneral}},togglePrimitives:{get:function(){return this._togglePrimitives}},toggleTerrain:{get:function(){return this._toggleTerrain}},pickPrimitive:{get:function(){return this._pickPrimitive}},pickTile:{get:function(){return this._pickTile}},selectParent:{get:function(){let t=this;return Tn(function(){t.tile=t.tile.parent})}},selectNW:{get:function(){let t=this;return Tn(function(){t.tile=t.tile.northwestChild})}},selectNE:{get:function(){let t=this;return Tn(function(){t.tile=t.tile.northeastChild})}},selectSW:{get:function(){let t=this;return Tn(function(){t.tile=t.tile.southwestChild})}},selectSE:{get:function(){let t=this;return Tn(function(){t.tile=t.tile.southeastChild})}},primitive:{get:function(){return this._primitive},set:function(t){let n=this._primitive;t!==n&&(this.hasPickedPrimitive=!0,f(n)&&(n.debugShowBoundingVolume=!1),this._scene.debugCommandFilter=void 0,f(this._modelMatrixPrimitive)&&(this._scene.primitives.remove(this._modelMatrixPrimitive),this._modelMatrixPrimitive=void 0),this._primitive=t,t.show=!1,setTimeout(function(){t.show=!0},50),this.showPrimitiveBoundingSphere(),this.showPrimitiveReferenceFrame(),this.doFilterPrimitive())}},tile:{get:function(){return this._tile},set:function(t){if(f(t)){this.hasPickedTile=!0;let n=this._tile;if(t!==n){this.tileText=`L: ${t.level} X: ${t.x} Y: ${t.y}`,this.tileText+=`<br>SW corner: ${t.rectangle.west}, ${t.rectangle.south}`,this.tileText+=`<br>NE corner: ${t.rectangle.east}, ${t.rectangle.north}`;let i=t.data;f(i)&&f(i.tileBoundingRegion)?this.tileText+=`<br>Min: ${i.tileBoundingRegion.minimumHeight} Max: ${i.tileBoundingRegion.maximumHeight}`:this.tileText+="<br>(Tile is not loaded)"}this._tile=t,this.showTileBoundingSphere(),this.doFilterTile()}else this.hasPickedTile=!1,this._tile=void 0}}});rP.prototype._update=function(){this.frustums&&(this.frustumStatisticText=Yht(this._scene.debugFrustumStatistics));let t=this._scene.numberOfFrustums;this._numberOfFrustums=t,this.depthFrustum=Wq(1,t,this.depthFrustum),this.depthFrustumText=`${this.depthFrustum} of ${t}`,this.performance&&this._performanceDisplay.update(),this.primitiveReferenceFrame&&(this._modelMatrixPrimitive.modelMatrix=this._primitive.modelMatrix),this.shaderCacheText=`Cached shaders: ${this._scene.context.shaderCache.numberOfShaders}`};rP.prototype.isDestroyed=function(){return!1};rP.prototype.destroy=function(){return this._eventHandler.destroy(),this._removePostRenderEvent(),this._frustumsSubscription.dispose(),this._frustumPlanesSubscription.dispose(),this._performanceSubscription.dispose(),this._primitiveBoundingSphereSubscription.dispose(),this._primitiveReferenceFrameSubscription.dispose(),this._filterPrimitiveSubscription.dispose(),this._wireframeSubscription.dispose(),this._depthFrustumSubscription.dispose(),this._suspendUpdatesSubscription.dispose(),this._tileCoordinatesSubscription.dispose(),this._tileBoundingSphereSubscription.dispose(),this._filterTileSubscription.dispose(),this._pickPrimitiveActiveSubscription.dispose(),this._pickTileActiveSubscription.dispose(),ue(this)};var q4=rP;function Y4(t,n){t=On(t);let i=document.createElement("div"),o=new q4(n,i);this._viewModel=o,this._container=t;let r=document.createElement("div");this._element=r;let s=document.createElement("div");s.textContent="Cesium Inspector",s.className="cesium-cesiumInspector-button",s.setAttribute("data-bind","click: toggleDropDown"),r.appendChild(s),r.className="cesium-cesiumInspector",r.setAttribute("data-bind",'css: { "cesium-cesiumInspector-visible" : dropDownVisible, "cesium-cesiumInspector-hidden" : !dropDownVisible }'),t.appendChild(this._element);let a=document.createElement("div");this._panel=a,a.className="cesium-cesiumInspector-dropDown",r.appendChild(a);let c=o0.createSection,l=o0.createCheckbox,u=c(a,"General","generalVisible","toggleGeneral"),d=l("Show Frustums","frustums"),h=document.createElement("div");h.className="cesium-cesiumInspector-frustumStatistics",h.setAttribute("data-bind","visible: frustums, html: frustumStatisticText"),d.appendChild(h),u.appendChild(d),u.appendChild(l("Show Frustum Planes","frustumPlanes")),u.appendChild(l("Performance Display","performance")),i.className="cesium-cesiumInspector-performanceDisplay",u.appendChild(i);let _=document.createElement("div");_.className="cesium-cesiumInspector-shaderCache",_.setAttribute("data-bind","html: shaderCacheText"),u.appendChild(_);let y=document.createElement("div");u.appendChild(y);let p=document.createElement("span");p.setAttribute("data-bind",'html: "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Frustum:"'),y.appendChild(p);let C=document.createElement("span");C.setAttribute("data-bind","text: depthFrustumText"),y.appendChild(C);let x=document.createElement("input");x.type="button",x.value="-",x.className="cesium-cesiumInspector-pickButton",x.setAttribute("data-bind","click: decrementDepthFrustum"),y.appendChild(x);let T=document.createElement("input");T.type="button",T.value="+",T.className="cesium-cesiumInspector-pickButton",T.setAttribute("data-bind","click: incrementDepthFrustum"),y.appendChild(T);let E=c(a,"Primitives","primitivesVisible","togglePrimitives"),S=document.createElement("div");S.className="cesium-cesiumInspector-pickSection",E.appendChild(S);let w=document.createElement("input");w.type="button",w.value="Pick a primitive",w.className="cesium-cesiumInspector-pickButton",w.setAttribute("data-bind",'css: {"cesium-cesiumInspector-pickButtonHighlight" : pickPrimitiveActive}, click: pickPrimitive');let D=document.createElement("div");D.className="cesium-cesiumInspector-center",D.appendChild(w),S.appendChild(D),S.appendChild(l("Show bounding sphere","primitiveBoundingSphere","hasPickedPrimitive")),S.appendChild(l("Show reference frame","primitiveReferenceFrame","hasPickedPrimitive")),this._primitiveOnly=l("Show only selected","filterPrimitive","hasPickedPrimitive"),S.appendChild(this._primitiveOnly);let I=c(a,"Terrain","terrainVisible","toggleTerrain"),O=document.createElement("div");O.className="cesium-cesiumInspector-pickSection",I.appendChild(O);let M=document.createElement("input");M.type="button",M.value="Pick a tile",M.className="cesium-cesiumInspector-pickButton",M.setAttribute("data-bind",'css: {"cesium-cesiumInspector-pickButtonHighlight" : pickTileActive}, click: pickTile'),D=document.createElement("div"),D.appendChild(M),D.className="cesium-cesiumInspector-center",O.appendChild(D);let L=document.createElement("div");O.appendChild(L);let F=document.createElement("input");F.type="button",F.value="Parent",F.className="cesium-cesiumInspector-pickButton",F.setAttribute("data-bind","click: selectParent");let g=document.createElement("input");g.type="button",g.value="NW",g.className="cesium-cesiumInspector-pickButton",g.setAttribute("data-bind","click: selectNW");let b=document.createElement("input");b.type="button",b.value="NE",b.className="cesium-cesiumInspector-pickButton",b.setAttribute("data-bind","click: selectNE");let v=document.createElement("input");v.type="button",v.value="SW",v.className="cesium-cesiumInspector-pickButton",v.setAttribute("data-bind","click: selectSW");let P=document.createElement("input");P.type="button",P.value="SE",P.className="cesium-cesiumInspector-pickButton",P.setAttribute("data-bind","click: selectSE");let R=document.createElement("div");R.className="cesium-cesiumInspector-tileText",L.className="cesium-cesiumInspector-frustumStatistics",L.appendChild(R),L.setAttribute("data-bind","visible: hasPickedTile"),R.setAttribute("data-bind","html: tileText");let V=document.createElement("div");V.className="cesium-cesiumInspector-relativeText",V.textContent="Select relative:",L.appendChild(V);let H=document.createElement("table"),U=document.createElement("tr"),G=document.createElement("tr"),k=document.createElement("td");k.appendChild(F);let X=document.createElement("td");X.appendChild(g);let Y=document.createElement("td");Y.appendChild(b),U.appendChild(k),U.appendChild(X),U.appendChild(Y);let K=document.createElement("td"),j=document.createElement("td");j.appendChild(v);let Z=document.createElement("td");Z.appendChild(P),G.appendChild(K),G.appendChild(j),G.appendChild(Z),H.appendChild(U),H.appendChild(G),L.appendChild(H),O.appendChild(l("Show bounding volume","tileBoundingSphere","hasPickedTile")),O.appendChild(l("Show only selected","filterTile","hasPickedTile")),I.appendChild(l("Wireframe","wireframe")),I.appendChild(l("Suspend LOD update","suspendUpdates")),I.appendChild(l("Show tile coordinates","tileCoordinates")),xe.applyBindings(o,this._element)}Object.defineProperties(Y4.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}});Y4.prototype.isDestroyed=function(){return!1};Y4.prototype.destroy=function(){return xe.cleanNode(this._element),this._container.removeChild(this._element),this.viewModel.destroy(),ue(this)};var X4=Y4;function lb(t){return Qt(`Assets/Textures/SkyBox/tycho2t3_80_${t}.jpg`)}function Jht(t){t._renderLoopRunning=!0;let n=0;function i(o){if(!t.isDestroyed())if(t._useDefaultRenderLoop)try{let r=t._targetFrameRate;if(!f(r))t.resize(),t.render(),requestAnimationFrame(i);else{let s=1e3/r,a=o-n;a>s&&(t.resize(),t.render(),n=o-a%s),requestAnimationFrame(i)}}catch(r){if(t._useDefaultRenderLoop=!1,t._renderLoopRunning=!1,t._showRenderLoopErrors){let s="An error occurred while rendering.  Rendering has stopped.";t.showErrorPanel(s,void 0,r)}}else t._renderLoopRunning=!1}requestAnimationFrame(i)}function V0e(t){let n=t._useBrowserRecommendedResolution?1:window.devicePixelRatio;return n*=t._resolutionScale,f(t._scene)&&(t._scene.pixelRatio=n),n}function k0e(t){let n=t._canvas,i=n.clientWidth,o=n.clientHeight,r=V0e(t);t._canvasClientWidth=i,t._canvasClientHeight=o,i*=r,o*=r,n.width=i,n.height=o,t._canRender=i!==0&&o!==0,t._lastDevicePixelRatio=window.devicePixelRatio}function U0e(t){let n=t._canvas,i=n.width,o=n.height;if(i!==0&&o!==0){let r=t._scene.camera.frustum;f(r.aspectRatio)?r.aspectRatio=i/o:(r.top=r.right*(o/i),r.bottom=-r.top)}}function NA(t,n){t=On(t),n=A(n,A.EMPTY_OBJECT);let i=document.createElement("div");i.className="cesium-widget",t.appendChild(i);let o=document.createElement("canvas"),r=Vt.supportsImageRenderingPixelated();this._supportsImageRenderingPixelated=r,r&&(o.style.imageRendering=Vt.imageRenderingValue()),o.oncontextmenu=function(){return!1},o.onselectstart=function(){return!1};function s(){o!==o.ownerDocument.activeElement&&o.ownerDocument.activeElement.blur()}A(n.blurActiveElementOnCanvasFocus,!0)&&(o.addEventListener("mousedown",s),o.addEventListener("pointerdown",s)),i.appendChild(o);let c=document.createElement("div");c.className="cesium-widget-credits";let l=f(n.creditContainer)?On(n.creditContainer):i;l.appendChild(c);let u=f(n.creditViewport)?On(n.creditViewport):i,d=A(n.showRenderLoopErrors,!0),h=A(n.useBrowserRecommendedResolution,!0);this._element=i,this._container=t,this._canvas=o,this._canvasClientWidth=0,this._canvasClientHeight=0,this._lastDevicePixelRatio=0,this._creditViewport=u,this._creditContainer=l,this._innerCreditContainer=c,this._canRender=!1,this._renderLoopRunning=!1,this._showRenderLoopErrors=d,this._resolutionScale=1,this._useBrowserRecommendedResolution=h,this._forceResize=!1,this._clock=f(n.clock)?n.clock:new _h,k0e(this);try{let _=new T4({canvas:o,contextOptions:n.contextOptions,creditContainer:c,creditViewport:u,mapProjection:n.mapProjection,orderIndependentTranslucency:n.orderIndependentTranslucency,scene3DOnly:A(n.scene3DOnly,!1),shadows:n.shadows,mapMode2D:n.mapMode2D,requestRenderMode:n.requestRenderMode,maximumRenderTimeChange:n.maximumRenderTimeChange,depthPlaneEllipsoidOffset:n.depthPlaneEllipsoidOffset,msaaSamples:n.msaaSamples});this._scene=_,_.camera.constrainedAxis=m.UNIT_Z,V0e(this),U0e(this);let y=A(_.mapProjection.ellipsoid,oe.WGS84),p=n.globe;f(p)||(p=new fU(y)),p!==!1&&(_.globe=p,_.globe.shadows=A(n.terrainShadows,gn.RECEIVE_ONLY));let C=n.skyBox;f(C)||(C=new vC({sources:{positiveX:lb("px"),negativeX:lb("mx"),positiveY:lb("py"),negativeY:lb("my"),positiveZ:lb("pz"),negativeZ:lb("mz")}})),C!==!1&&(_.skyBox=C,_.sun=new b4,_.moon=new EU);let x=n.skyAtmosphere;f(x)||(x=new E4(y)),x!==!1&&(_.skyAtmosphere=x);let T=n.globe===!1?!1:n.imageryProvider;f(T)||(T=Xg()),T!==!1&&_.imageryLayers.addImageryProvider(T),f(n.terrainProvider)&&n.globe!==!1&&(_.terrainProvider=n.terrainProvider),this._screenSpaceEventHandler=new nf(o),f(n.sceneMode)&&(n.sceneMode===ne.SCENE2D&&this._scene.morphTo2D(0),n.sceneMode===ne.COLUMBUS_VIEW&&this._scene.morphToColumbusView(0)),this._useDefaultRenderLoop=void 0,this.useDefaultRenderLoop=A(n.useDefaultRenderLoop,!0),this._targetFrameRate=void 0,this.targetFrameRate=n.targetFrameRate;let E=this;this._onRenderError=function(S,w){if(E._useDefaultRenderLoop=!1,E._renderLoopRunning=!1,E._showRenderLoopErrors){let D="An error occurred while rendering.  Rendering has stopped.";E.showErrorPanel(D,void 0,w)}},_.renderError.addEventListener(this._onRenderError)}catch(_){if(d){let y="Error constructing CesiumWidget.",p='Visit <a href="http://get.webgl.org">http://get.webgl.org</a> to verify that your web browser and hardware support WebGL.  Consider trying a different web browser or updating your video drivers.  Detailed error information is below:';this.showErrorPanel(y,p,_)}throw _}}Object.defineProperties(NA.prototype,{container:{get:function(){return this._container}},canvas:{get:function(){return this._canvas}},creditContainer:{get:function(){return this._creditContainer}},creditViewport:{get:function(){return this._creditViewport}},scene:{get:function(){return this._scene}},imageryLayers:{get:function(){return this._scene.imageryLayers}},terrainProvider:{get:function(){return this._scene.terrainProvider},set:function(t){this._scene.terrainProvider=t}},camera:{get:function(){return this._scene.camera}},clock:{get:function(){return this._clock}},screenSpaceEventHandler:{get:function(){return this._screenSpaceEventHandler}},targetFrameRate:{get:function(){return this._targetFrameRate},set:function(t){this._targetFrameRate=t}},useDefaultRenderLoop:{get:function(){return this._useDefaultRenderLoop},set:function(t){this._useDefaultRenderLoop!==t&&(this._useDefaultRenderLoop=t,t&&!this._renderLoopRunning&&Jht(this))}},resolutionScale:{get:function(){return this._resolutionScale},set:function(t){this._resolutionScale!==t&&(this._resolutionScale=t,this._forceResize=!0)}},useBrowserRecommendedResolution:{get:function(){return this._useBrowserRecommendedResolution},set:function(t){this._useBrowserRecommendedResolution!==t&&(this._useBrowserRecommendedResolution=t,this._forceResize=!0)}}});NA.prototype.showErrorPanel=function(t,n,i){let o=this._element,r=document.createElement("div");r.className="cesium-widget-errorPanel";let s=document.createElement("div");s.className="cesium-widget-errorPanel-content",r.appendChild(s);let a=document.createElement("div");a.className="cesium-widget-errorPanel-header",a.appendChild(document.createTextNode(t)),s.appendChild(a);let c=document.createElement("div");c.className="cesium-widget-errorPanel-scroll",s.appendChild(c);function l(){c.style.maxHeight=`${Math.max(Math.round(o.clientHeight*.9-100),30)}px`}l(),f(window.addEventListener)&&window.addEventListener("resize",l,!1);let u=f(n),d=f(i);if(u||d){let y=document.createElement("div");if(y.className="cesium-widget-errorPanel-message",c.appendChild(y),d){let p=_p(i);u||(typeof i=="string"&&(i=new Error(i)),n=_p({name:i.name,message:i.message}),p=i.stack),typeof console!="undefined"&&console.error(`${t}
${n}
${p}`);let C=document.createElement("div");C.className="cesium-widget-errorPanel-message-details collapsed";let x=document.createElement("span");x.className="cesium-widget-errorPanel-more-details",x.appendChild(document.createTextNode("See more...")),C.appendChild(x),C.onclick=function(T){C.removeChild(x),C.appendChild(document.createTextNode(p)),C.className="cesium-widget-errorPanel-message-details",s.className="cesium-widget-errorPanel-content expanded",C.onclick=void 0},c.appendChild(C)}y.innerHTML=`<p>${n}</p>`}let h=document.createElement("div");h.className="cesium-widget-errorPanel-buttonPanel",s.appendChild(h);let _=document.createElement("button");_.setAttribute("type","button"),_.className="cesium-button",_.appendChild(document.createTextNode("OK")),_.onclick=function(){f(l)&&f(window.removeEventListener)&&window.removeEventListener("resize",l,!1),o.removeChild(r)},h.appendChild(_),o.appendChild(r)};NA.prototype.isDestroyed=function(){return!1};NA.prototype.destroy=function(){f(this._scene)&&(this._scene.renderError.removeEventListener(this._onRenderError),this._scene=this._scene.destroy()),this._container.removeChild(this._element),this._creditContainer.removeChild(this._innerCreditContainer),ue(this)};NA.prototype.resize=function(){let t=this._canvas;!this._forceResize&&this._canvasClientWidth===t.clientWidth&&this._canvasClientHeight===t.clientHeight&&this._lastDevicePixelRatio===window.devicePixelRatio||(this._forceResize=!1,k0e(this),U0e(this),this._scene.requestRender())};NA.prototype.render=function(){if(this._canRender){this._scene.initializeFrame();let t=this._clock.tick();this._scene.render(t)}else this._clock.tick()};var K4=NA;function J4(t,n){f(n)||(n=document.body),n=On(n);let i=this,o=xe.observable(gr.fullscreen),r=xe.observable(gr.enabled),s=n.ownerDocument;this.isFullscreen=void 0,xe.defineProperty(this,"isFullscreen",{get:function(){return o()}}),this.isFullscreenEnabled=void 0,xe.defineProperty(this,"isFullscreenEnabled",{get:function(){return r()},set:function(a){r(a&&gr.enabled)}}),this.tooltip=void 0,xe.defineProperty(this,"tooltip",function(){return this.isFullscreenEnabled?o()?"Exit full screen":"Full screen":"Full screen unavailable"}),this._command=Tn(function(){gr.fullscreen?gr.exitFullscreen():gr.requestFullscreen(i._fullscreenElement)},xe.getObservable(this,"isFullscreenEnabled")),this._fullscreenElement=A(On(t),s.body),this._callback=function(){o(gr.fullscreen)},s.addEventListener(gr.changeEventName,this._callback)}Object.defineProperties(J4.prototype,{fullscreenElement:{get:function(){return this._fullscreenElement},set:function(t){this._fullscreenElement=t}},command:{get:function(){return this._command}}});J4.prototype.isDestroyed=function(){return!1};J4.prototype.destroy=function(){document.removeEventListener(gr.changeEventName,this._callback),ue(this)};var Z4=J4;var Zht="M 83.96875 17.5625 L 83.96875 17.59375 L 76.65625 24.875 L 97.09375 24.96875 L 76.09375 45.96875 L 81.9375 51.8125 L 102.78125 30.9375 L 102.875 51.15625 L 110.15625 43.875 L 110.1875 17.59375 L 83.96875 17.5625 z M 44.125 17.59375 L 17.90625 17.625 L 17.9375 43.90625 L 25.21875 51.1875 L 25.3125 30.96875 L 46.15625 51.8125 L 52 45.96875 L 31 25 L 51.4375 24.90625 L 44.125 17.59375 z M 46.0625 76.03125 L 25.1875 96.875 L 25.09375 76.65625 L 17.8125 83.9375 L 17.8125 110.21875 L 44 110.25 L 51.3125 102.9375 L 30.90625 102.84375 L 51.875 81.875 L 46.0625 76.03125 z M 82 76.15625 L 76.15625 82 L 97.15625 103 L 76.71875 103.0625 L 84.03125 110.375 L 110.25 110.34375 L 110.21875 84.0625 L 102.9375 76.8125 L 102.84375 97 L 82 76.15625 z",Qht="M 104.34375 17.5625 L 83.5 38.4375 L 83.40625 18.21875 L 76.125 25.5 L 76.09375 51.78125 L 102.3125 51.8125 L 102.3125 51.78125 L 109.625 44.5 L 89.1875 44.40625 L 110.1875 23.40625 L 104.34375 17.5625 z M 23.75 17.59375 L 17.90625 23.4375 L 38.90625 44.4375 L 18.5 44.53125 L 25.78125 51.8125 L 52 51.78125 L 51.96875 25.53125 L 44.6875 18.25 L 44.625 38.46875 L 23.75 17.59375 z M 25.6875 76.03125 L 18.375 83.3125 L 38.78125 83.40625 L 17.8125 104.40625 L 23.625 110.25 L 44.5 89.375 L 44.59375 109.59375 L 51.875 102.3125 L 51.875 76.0625 L 25.6875 76.03125 z M 102.375 76.15625 L 76.15625 76.1875 L 76.1875 102.4375 L 83.46875 109.71875 L 83.5625 89.53125 L 104.40625 110.375 L 110.25 104.53125 L 89.25 83.53125 L 109.6875 83.46875 L 102.375 76.15625 z";function Q4(t,n){t=On(t);let i=new Z4(n,t);i._exitFullScreenPath=Qht,i._enterFullScreenPath=Zht;let o=document.createElement("button");o.type="button",o.className="cesium-button cesium-fullscreenButton",o.setAttribute("data-bind","attr: { title: tooltip },click: command,enable: isFullscreenEnabled,cesiumSvgPath: { path: isFullscreen ? _exitFullScreenPath : _enterFullScreenPath, width: 128, height: 128 }"),t.appendChild(o),xe.applyBindings(i,o),this._container=t,this._viewModel=i,this._element=o}Object.defineProperties(Q4.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}});Q4.prototype.isDestroyed=function(){return!1};Q4.prototype.destroy=function(){return this._viewModel.destroy(),xe.cleanNode(this._element),this._container.removeChild(this._element),ue(this)};var $4=Q4;var z0e=1e3;function Jh(t){f(t.geocoderServices)?this._geocoderServices=t.geocoderServices:this._geocoderServices=[new U3,new rV({scene:t.scene})],this._viewContainer=t.container,this._scene=t.scene,this._flightDuration=t.flightDuration,this._searchText="",this._isSearchInProgress=!1,this._geocodePromise=void 0,this._complete=new Ae,this._suggestions=[],this._selectedSuggestion=void 0,this._showSuggestions=!0,this._handleArrowDown=G0e,this._handleArrowUp=H0e;let n=this;this._suggestionsVisible=xe.pureComputed(function(){let r=xe.getObservable(n,"_suggestions")().length>0,s=xe.getObservable(n,"_showSuggestions")();return r&&s}),this._searchCommand=Tn(function(o){if(o=A(o,nA.SEARCH),n._focusTextbox=!1,f(n._selectedSuggestion))return n.activateSuggestion(n._selectedSuggestion),!1;n.hideSuggestions(),n.isSearchInProgress?omt(n):nmt(n,n._geocoderServices,o)}),this.deselectSuggestion=function(){n._selectedSuggestion=void 0},this.handleKeyDown=function(o,r){let s=r.key==="ArrowDown"||r.key==="Down"||r.keyCode===40,a=r.key==="ArrowUp"||r.key==="Up"||r.keyCode===38;return(s||a)&&r.preventDefault(),!0},this.handleKeyUp=function(o,r){let s=r.key==="ArrowDown"||r.key==="Down"||r.keyCode===40,a=r.key==="ArrowUp"||r.key==="Up"||r.keyCode===38,c=r.key==="Enter"||r.keyCode===13;return a?H0e(n):s?G0e(n):c&&n._searchCommand(),!0},this.activateSuggestion=function(o){n.hideSuggestions(),n._searchText=o.displayName;let r=o.destination;j0e(n),n.destinationFound(n,r)},this.hideSuggestions=function(){n._showSuggestions=!1,n._selectedSuggestion=void 0},this.showSuggestions=function(){n._showSuggestions=!0},this.handleMouseover=function(o,r){o!==n._selectedSuggestion&&(n._selectedSuggestion=o)},this.keepExpanded=!1,this.autoComplete=A(t.autocomplete,!0),this.destinationFound=A(t.destinationFound,Jh.flyToDestination),this._focusTextbox=!1,xe.track(this,["_searchText","_isSearchInProgress","keepExpanded","_suggestions","_selectedSuggestion","_showSuggestions","_focusTextbox"]);let i=xe.getObservable(this,"_searchText");i.extend({rateLimit:{timeout:500}}),this._suggestionSubscription=i.subscribe(function(){Jh._updateSearchSuggestions(n)}),this.isSearchInProgress=void 0,xe.defineProperty(this,"isSearchInProgress",{get:function(){return this._isSearchInProgress}}),this.searchText=void 0,xe.defineProperty(this,"searchText",{get:function(){return this.isSearchInProgress?"Searching...":this._searchText},set:function(o){this._searchText=o}}),this.flightDuration=void 0,xe.defineProperty(this,"flightDuration",{get:function(){return this._flightDuration},set:function(o){this._flightDuration=o}})}Object.defineProperties(Jh.prototype,{complete:{get:function(){return this._complete}},scene:{get:function(){return this._scene}},search:{get:function(){return this._searchCommand}},selectedSuggestion:{get:function(){return this._selectedSuggestion}},suggestions:{get:function(){return this._suggestions}}});Jh.prototype.destroy=function(){this._suggestionSubscription.dispose()};function H0e(t){if(t._suggestions.length===0)return;let n=t._suggestions.indexOf(t._selectedSuggestion);if(n===-1||n===0){t._selectedSuggestion=void 0;return}let i=n-1;t._selectedSuggestion=t._suggestions[i],Jh._adjustSuggestionsScroll(t,i)}function G0e(t){if(t._suggestions.length===0)return;let n=t._suggestions.length,o=(t._suggestions.indexOf(t._selectedSuggestion)+1)%n;t._selectedSuggestion=t._suggestions[o],Jh._adjustSuggestionsScroll(t,o)}function $ht(t,n){let i=f(n)?n.availability:void 0;return f(i)?dg(n,[t]).then(function(o){return t=o[0],t.height+=z0e,t}):(t.height+=z0e,Promise.resolve(t))}function emt(t,n){let i=t._scene,r=i.mapProjection.ellipsoid,s=i.camera,a=i.terrainProvider,c=n,l;return n instanceof le?B.equalsEpsilon(n.south,n.north,B.EPSILON7)&&B.equalsEpsilon(n.east,n.west,B.EPSILON7)?n=le.center(n):l=RE(n,i):n=r.cartesianToCartographic(n),f(l)||(l=$ht(n,a)),l.then(function(u){c=r.cartographicToCartesian(u)}).finally(function(){s.flyTo({destination:c,complete:function(){t._complete.raiseEvent()},duration:t._flightDuration,endTransform:N.IDENTITY})})}function tmt(t,n,i,o){return t.then(function(r){return f(r)&&r.state==="fulfilled"&&r.value.length>0?r:n.geocode(i,o).then(function(a){return{state:"fulfilled",value:a}}).catch(function(a){return{state:"rejected",reason:a}})})}function nmt(t,n,i){let o=t._searchText;if(W0e(o)){t.showSuggestions();return}t._isSearchInProgress=!0;let r=Promise.resolve();for(let s=0;s<n.length;s++)r=tmt(r,n[s],o,i);t._geocodePromise=r,r.then(function(s){if(r.cancel)return;t._isSearchInProgress=!1;let a=s.value;if(s.state==="fulfilled"&&f(a)&&a.length>0){t._searchText=a[0].displayName,t.destinationFound(t,a[0].destination);return}t._searchText=`${o} (not found)`})}function imt(t,n){let i=On(t._viewContainer),o=i.getElementsByClassName("search-results")[0],s=i.getElementsByTagName("li")[n];if(n===0){o.scrollTop=0;return}let a=s.offsetTop;a+s.clientHeight>o.clientHeight?o.scrollTop=a+s.clientHeight:a<o.scrollTop&&(o.scrollTop=a)}function omt(t){t._isSearchInProgress=!1,f(t._geocodePromise)&&(t._geocodePromise.cancel=!0,t._geocodePromise=void 0)}function W0e(t){return/^\s*$/.test(t)}function j0e(t){xe.getObservable(t,"_suggestions").removeAll()}function rmt(t){if(!t.autoComplete)return;let n=t._searchText;if(j0e(t),W0e(n))return;let i=Promise.resolve([]);return t._geocoderServices.forEach(function(o){i=i.then(function(r){return r.length>=5?r:o.geocode(n,nA.AUTOCOMPLETE).then(function(s){return r=r.concat(s),r})})}),i.then(function(o){let r=t._suggestions;for(let s=0;s<o.length;s++)r.push(o[s])})}Jh.flyToDestination=emt;Jh._updateSearchSuggestions=rmt;Jh._adjustSuggestionsScroll=imt;var ez=Jh;var smt="M29.772,26.433l-7.126-7.126c0.96-1.583,1.523-3.435,1.524-5.421C24.169,8.093,19.478,3.401,13.688,3.399C7.897,3.401,3.204,8.093,3.204,13.885c0,5.789,4.693,10.481,10.484,10.481c1.987,0,3.839-0.563,5.422-1.523l7.128,7.127L29.772,26.433zM7.203,13.885c0.006-3.582,2.903-6.478,6.484-6.486c3.579,0.008,6.478,2.904,6.484,6.486c-0.007,3.58-2.905,6.476-6.484,6.484C10.106,20.361,7.209,17.465,7.203,13.885z",amt="M24.778,21.419 19.276,15.917 24.777,10.415 21.949,7.585 16.447,13.087 10.945,7.585 8.117,10.415 13.618,15.917 8.116,21.419 10.946,24.248 16.447,18.746 21.948,24.248z";function tz(t){let n=On(t.container),i=new ez(t);i._startSearchPath=smt,i._stopSearchPath=amt;let o=document.createElement("form");o.setAttribute("data-bind","submit: search");let r=document.createElement("input");r.type="search",r.className="cesium-geocoder-input",r.setAttribute("placeholder","Enter an address or landmark..."),r.setAttribute("data-bind",'textInput: searchText,disable: isSearchInProgress,event: { keyup: handleKeyUp, keydown: handleKeyDown, mouseover: deselectSuggestion },css: { "cesium-geocoder-input-wide" : keepExpanded || searchText.length > 0 },hasFocus: _focusTextbox'),this._onTextBoxFocus=function(){setTimeout(function(){r.select()},0)},r.addEventListener("focus",this._onTextBoxFocus,!1),o.appendChild(r),this._textBox=r;let s=document.createElement("span");s.className="cesium-geocoder-searchButton",s.setAttribute("data-bind","click: search,cesiumSvgPath: { path: isSearchInProgress ? _stopSearchPath : _startSearchPath, width: 32, height: 32 }"),o.appendChild(s),n.appendChild(o);let a=document.createElement("div");a.className="search-results",a.setAttribute("data-bind","visible: _suggestionsVisible");let c=document.createElement("ul");c.setAttribute("data-bind","foreach: _suggestions");let l=document.createElement("li");c.appendChild(l),l.setAttribute("data-bind","text: $data.displayName, click: $parent.activateSuggestion, event: { mouseover: $parent.handleMouseover}, css: { active: $data === $parent._selectedSuggestion }"),a.appendChild(c),n.appendChild(a),xe.applyBindings(i,o),xe.applyBindings(i,a),this._container=n,this._searchSuggestionsContainer=a,this._viewModel=i,this._form=o,this._onInputBegin=function(u){let d=u.target;typeof u.composedPath=="function"&&(d=u.composedPath()[0]),n.contains(d)||(i._focusTextbox=!1,i.hideSuggestions())},this._onInputEnd=function(u){i._focusTextbox=!0,i.showSuggestions()},Vt.supportsPointerEvents()?(document.addEventListener("pointerdown",this._onInputBegin,!0),n.addEventListener("pointerup",this._onInputEnd,!0),n.addEventListener("pointercancel",this._onInputEnd,!0)):(document.addEventListener("mousedown",this._onInputBegin,!0),n.addEventListener("mouseup",this._onInputEnd,!0),document.addEventListener("touchstart",this._onInputBegin,!0),n.addEventListener("touchend",this._onInputEnd,!0),n.addEventListener("touchcancel",this._onInputEnd,!0))}Object.defineProperties(tz.prototype,{container:{get:function(){return this._container}},searchSuggestionsContainer:{get:function(){return this._searchSuggestionsContainer}},viewModel:{get:function(){return this._viewModel}}});tz.prototype.isDestroyed=function(){return!1};tz.prototype.destroy=function(){let t=this._container;return Vt.supportsPointerEvents()?(document.removeEventListener("pointerdown",this._onInputBegin,!0),t.removeEventListener("pointerup",this._onInputEnd,!0)):(document.removeEventListener("mousedown",this._onInputBegin,!0),t.removeEventListener("mouseup",this._onInputEnd,!0),document.removeEventListener("touchstart",this._onInputBegin,!0),t.removeEventListener("touchend",this._onInputEnd,!0)),this._viewModel.destroy(),xe.cleanNode(this._form),xe.cleanNode(this._searchSuggestionsContainer),t.removeChild(this._form),t.removeChild(this._searchSuggestionsContainer),this._textBox.removeEventListener("focus",this._onTextBoxFocus,!1),ue(this)};var nz=tz;function q0e(t,n){this._scene=t,this._duration=n;let i=this;this._command=Tn(function(){i._scene.camera.flyHome(i._duration)}),this.tooltip="View Home",xe.track(this,["tooltip"])}Object.defineProperties(q0e.prototype,{scene:{get:function(){return this._scene}},command:{get:function(){return this._command}},duration:{get:function(){return this._duration},set:function(t){this._duration=t}}});var iz=q0e;function oz(t,n,i){t=On(t);let o=new iz(n,i);o._svgPath="M14,4l-10,8.75h20l-4.25-3.7188v-4.6562h-2.812v2.1875l-2.938-2.5625zm-7.0938,9.906v10.094h14.094v-10.094h-14.094zm2.1876,2.313h3.3122v4.25h-3.3122v-4.25zm5.8442,1.281h3.406v6.438h-3.406v-6.438z";let r=document.createElement("button");r.type="button",r.className="cesium-button cesium-toolbar-button cesium-home-button",r.setAttribute("data-bind","attr: { title: tooltip },click: command,cesiumSvgPath: { path: _svgPath, width: 28, height: 28 }"),t.appendChild(r),xe.applyBindings(o,r),this._container=t,this._viewModel=o,this._element=r}Object.defineProperties(oz.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}});oz.prototype.isDestroyed=function(){return!1};oz.prototype.destroy=function(){return xe.cleanNode(this._element),this._container.removeChild(this._element),ue(this)};var rz=oz;var cmt="M 13.84375 7.03125 C 11.412798 7.03125 9.46875 8.975298 9.46875 11.40625 L 9.46875 11.59375 L 2.53125 7.21875 L 2.53125 24.0625 L 9.46875 19.6875 C 9.4853444 22.104033 11.423165 24.0625 13.84375 24.0625 L 25.875 24.0625 C 28.305952 24.0625 30.28125 22.087202 30.28125 19.65625 L 30.28125 11.40625 C 30.28125 8.975298 28.305952 7.03125 25.875 7.03125 L 13.84375 7.03125 z",lmt="M 27.34375 1.65625 L 5.28125 27.9375 L 8.09375 30.3125 L 30.15625 4.03125 L 27.34375 1.65625 z M 13.84375 7.03125 C 11.412798 7.03125 9.46875 8.975298 9.46875 11.40625 L 9.46875 11.59375 L 2.53125 7.21875 L 2.53125 24.0625 L 9.46875 19.6875 C 9.4724893 20.232036 9.5676108 20.7379 9.75 21.21875 L 21.65625 7.03125 L 13.84375 7.03125 z M 28.21875 7.71875 L 14.53125 24.0625 L 25.875 24.0625 C 28.305952 24.0625 30.28125 22.087202 30.28125 19.65625 L 30.28125 11.40625 C 30.28125 9.8371439 29.456025 8.4902779 28.21875 7.71875 z";function jq(){this._cameraClicked=new Ae,this._closeClicked=new Ae,this.maxHeight=500,this.enableCamera=!1,this.isCameraTracking=!1,this.showInfo=!1,this.titleText="",this.description="",xe.track(this,["showInfo","titleText","description","maxHeight","enableCamera","isCameraTracking"]),this._loadingIndicatorHtml='<div class="cesium-infoBox-loadingContainer"><span class="cesium-infoBox-loading"></span></div>',this.cameraIconPath=void 0,xe.defineProperty(this,"cameraIconPath",{get:function(){return!this.enableCamera||this.isCameraTracking?lmt:cmt}}),xe.defineProperty(this,"_bodyless",{get:function(){return!f(this.description)||this.description.length===0}})}jq.prototype.maxHeightOffset=function(t){return`${this.maxHeight-t}px`};Object.defineProperties(jq.prototype,{cameraClicked:{get:function(){return this._cameraClicked}},closeClicked:{get:function(){return this._closeClicked}}});var sz=jq;function az(t){t=On(t);let n=document.createElement("div");n.className="cesium-infoBox",n.setAttribute("data-bind",'css: { "cesium-infoBox-visible" : showInfo, "cesium-infoBox-bodyless" : _bodyless }'),t.appendChild(n);let i=document.createElement("div");i.className="cesium-infoBox-title",i.setAttribute("data-bind","text: titleText"),n.appendChild(i);let o=document.createElement("button");o.type="button",o.className="cesium-button cesium-infoBox-camera",o.setAttribute("data-bind",'attr: { title: "Focus camera on object" },click: function () { cameraClicked.raiseEvent(this); },enable: enableCamera,cesiumSvgPath: { path: cameraIconPath, width: 32, height: 32 }'),n.appendChild(o);let r=document.createElement("button");r.type="button",r.className="cesium-infoBox-close",r.setAttribute("data-bind","click: function () { closeClicked.raiseEvent(this); }"),r.innerHTML="&times;",n.appendChild(r);let s=document.createElement("iframe");s.className="cesium-infoBox-iframe",s.setAttribute("sandbox","allow-same-origin allow-popups allow-forms"),s.setAttribute("data-bind","style : { maxHeight : maxHeightOffset(40) }"),s.setAttribute("allowfullscreen",!0),n.appendChild(s);let a=new sz;xe.applyBindings(a,n),this._container=t,this._element=n,this._frame=s,this._viewModel=a,this._descriptionSubscription=void 0;let c=this;s.addEventListener("load",function(){let l=s.contentDocument,u=l.createElement("link");u.href=Qt("Widgets/InfoBox/InfoBoxDescription.css"),u.rel="stylesheet",u.type="text/css";let d=l.createElement("div");d.className="cesium-infoBox-description",l.head.appendChild(u),l.body.appendChild(d),c._descriptionSubscription=da(a,"description",function(h){s.style.height="5px",d.innerHTML=h;let _=null,y=d.firstElementChild;if(y!==null&&d.childNodes.length===1){let C=window.getComputedStyle(y);if(C!==null){let x=C["background-color"],T=z.fromCssColorString(x);f(T)&&T.alpha!==0&&(_=C["background-color"])}}n.style["background-color"]=_;let p=d.getBoundingClientRect().height;s.style.height=`${p}px`})}),s.setAttribute("src","about:blank")}Object.defineProperties(az.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}},frame:{get:function(){return this._frame}}});az.prototype.isDestroyed=function(){return!1};az.prototype.destroy=function(){let t=this._container;return xe.cleanNode(this._element),t.removeChild(this._element),f(this._descriptionSubscription)&&this._descriptionSubscription.dispose(),ue(this)};var cz=az;function Y0e(){this.showInstructions=!1;let t=this;this._command=Tn(function(){t.showInstructions=!t.showInstructions}),this._showClick=Tn(function(){t._touch=!1}),this._showTouch=Tn(function(){t._touch=!0}),this._touch=!1,this.tooltip="Navigation Instructions",xe.track(this,["tooltip","showInstructions","_touch"])}Object.defineProperties(Y0e.prototype,{command:{get:function(){return this._command}},showClick:{get:function(){return this._showClick}},showTouch:{get:function(){return this._showTouch}}});var lz=Y0e;function uz(t){let n=On(t.container),i=new lz,o=A(t.instructionsInitiallyVisible,!1);i.showInstructions=o,i._svgPath="M16,1.466C7.973,1.466,1.466,7.973,1.466,16c0,8.027,6.507,14.534,14.534,14.534c8.027,0,14.534-6.507,14.534-14.534C30.534,7.973,24.027,1.466,16,1.466z M17.328,24.371h-2.707v-2.596h2.707V24.371zM17.328,19.003v0.858h-2.707v-1.057c0-3.19,3.63-3.696,3.63-5.963c0-1.034-0.924-1.826-2.134-1.826c-1.254,0-2.354,0.924-2.354,0.924l-1.541-1.915c0,0,1.519-1.584,4.137-1.584c2.487,0,4.796,1.54,4.796,4.136C21.156,16.208,17.328,16.627,17.328,19.003z";let r=document.createElement("span");r.className="cesium-navigationHelpButton-wrapper",n.appendChild(r);let s=document.createElement("button");s.type="button",s.className="cesium-button cesium-toolbar-button cesium-navigation-help-button",s.setAttribute("data-bind","attr: { title: tooltip },click: command,cesiumSvgPath: { path: _svgPath, width: 32, height: 32 }"),r.appendChild(s);let a=document.createElement("div");a.className="cesium-navigation-help",a.setAttribute("data-bind",'css: { "cesium-navigation-help-visible" : showInstructions}'),r.appendChild(a);let c=document.createElement("button");c.type="button",c.className="cesium-navigation-button cesium-navigation-button-left",c.setAttribute("data-bind",'click: showClick, css: {"cesium-navigation-button-selected": !_touch, "cesium-navigation-button-unselected": _touch}');let l=document.createElement("img");l.src=Qt("Widgets/Images/NavigationHelp/Mouse.svg"),l.className="cesium-navigation-button-icon",l.style.width="25px",l.style.height="25px",c.appendChild(l),c.appendChild(document.createTextNode("Mouse"));let u=document.createElement("button");u.type="button",u.className="cesium-navigation-button cesium-navigation-button-right",u.setAttribute("data-bind",'click: showTouch, css: {"cesium-navigation-button-selected": _touch, "cesium-navigation-button-unselected": !_touch}');let d=document.createElement("img");d.src=Qt("Widgets/Images/NavigationHelp/Touch.svg"),d.className="cesium-navigation-button-icon",d.style.width="25px",d.style.height="25px",u.appendChild(d),u.appendChild(document.createTextNode("Touch")),a.appendChild(c),a.appendChild(u);let h=document.createElement("div");h.className="cesium-click-navigation-help cesium-navigation-help-instructions",h.setAttribute("data-bind",'css: { "cesium-click-navigation-help-visible" : !_touch}'),h.innerHTML=`            <table>                <tr>                    <td><img src="${Qt("Widgets/Images/NavigationHelp/MouseLeft.svg")}" width="48" height="48" /></td>                    <td>                        <div class="cesium-navigation-help-pan">Pan view</div>                        <div class="cesium-navigation-help-details">Left click + drag</div>                    </td>                </tr>                <tr>                    <td><img src="${Qt("Widgets/Images/NavigationHelp/MouseRight.svg")}" width="48" height="48" /></td>                    <td>                        <div class="cesium-navigation-help-zoom">Zoom view</div>                        <div class="cesium-navigation-help-details">Right click + drag, or</div>                        <div class="cesium-navigation-help-details">Mouse wheel scroll</div>                    </td>                </tr>                <tr>                    <td><img src="${Qt("Widgets/Images/NavigationHelp/MouseMiddle.svg")}" width="48" height="48" /></td>                    <td>                        <div class="cesium-navigation-help-rotate">Rotate view</div>                        <div class="cesium-navigation-help-details">Middle click + drag, or</div>                        <div class="cesium-navigation-help-details">CTRL + Left/Right click + drag</div>                    </td>                </tr>            </table>`,a.appendChild(h);let _=document.createElement("div");_.className="cesium-touch-navigation-help cesium-navigation-help-instructions",_.setAttribute("data-bind",'css: { "cesium-touch-navigation-help-visible" : _touch}'),_.innerHTML=`            <table>                <tr>                    <td><img src="${Qt("Widgets/Images/NavigationHelp/TouchDrag.svg")}" width="70" height="48" /></td>                    <td>                        <div class="cesium-navigation-help-pan">Pan view</div>                        <div class="cesium-navigation-help-details">One finger drag</div>                    </td>                </tr>                <tr>                    <td><img src="${Qt("Widgets/Images/NavigationHelp/TouchZoom.svg")}" width="70" height="48" /></td>                    <td>                        <div class="cesium-navigation-help-zoom">Zoom view</div>                        <div class="cesium-navigation-help-details">Two finger pinch</div>                    </td>                </tr>                <tr>                    <td><img src="${Qt("Widgets/Images/NavigationHelp/TouchTilt.svg")}" width="70" height="48" /></td>                    <td>                        <div class="cesium-navigation-help-rotate">Tilt view</div>                        <div class="cesium-navigation-help-details">Two finger drag, same direction</div>                    </td>                </tr>                <tr>                    <td><img src="${Qt("Widgets/Images/NavigationHelp/TouchRotate.svg")}" width="70" height="48" /></td>                    <td>                        <div class="cesium-navigation-help-tilt">Rotate view</div>                        <div class="cesium-navigation-help-details">Two finger drag, opposite direction</div>                    </td>                </tr>            </table>`,a.appendChild(_),xe.applyBindings(i,r),this._container=n,this._viewModel=i,this._wrapper=r,this._closeInstructions=function(y){r.contains(y.target)||(i.showInstructions=!1)},Vt.supportsPointerEvents()?document.addEventListener("pointerdown",this._closeInstructions,!0):(document.addEventListener("mousedown",this._closeInstructions,!0),document.addEventListener("touchstart",this._closeInstructions,!0))}Object.defineProperties(uz.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}});uz.prototype.isDestroyed=function(){return!1};uz.prototype.destroy=function(){return Vt.supportsPointerEvents()?document.removeEventListener("pointerdown",this._closeInstructions,!0):(document.removeEventListener("mousedown",this._closeInstructions,!0),document.removeEventListener("touchstart",this._closeInstructions,!0)),xe.cleanNode(this._wrapper),this._container.removeChild(this._wrapper),ue(this)};var fz=uz;function qq(t){this._scene=t.scene,this.lowFrameRateMessage=A(t.lowFrameRateMessage,"This application appears to be performing poorly on your system.  Please try using a different web browser or updating your video drivers."),this.lowFrameRateMessageDismissed=!1,this.showingLowFrameRateMessage=!1,xe.track(this,["lowFrameRateMessage","lowFrameRateMessageDismissed","showingLowFrameRateMessage"]);let n=this;this._dismissMessage=Tn(function(){n.showingLowFrameRateMessage=!1,n.lowFrameRateMessageDismissed=!0});let i=Vk.fromScene(t.scene);this._unsubscribeLowFrameRate=i.lowFrameRate.addEventListener(function(){n.lowFrameRateMessageDismissed||(n.showingLowFrameRateMessage=!0)}),this._unsubscribeNominalFrameRate=i.nominalFrameRate.addEventListener(function(){n.showingLowFrameRateMessage=!1})}Object.defineProperties(qq.prototype,{scene:{get:function(){return this._scene}},dismissMessage:{get:function(){return this._dismissMessage}}});qq.prototype.destroy=function(){return this._unsubscribeLowFrameRate(),this._unsubscribeNominalFrameRate(),ue(this)};var dz=qq;function hz(t){let n=On(t.container),i=new dz(t),o=document.createElement("div");o.className="cesium-performance-watchdog-message-area",o.setAttribute("data-bind","visible: showingLowFrameRateMessage");let r=document.createElement("button");r.setAttribute("type","button"),r.className="cesium-performance-watchdog-message-dismiss",r.innerHTML="&times;",r.setAttribute("data-bind","click: dismissMessage"),o.appendChild(r);let s=document.createElement("div");s.className="cesium-performance-watchdog-message",s.setAttribute("data-bind","html: lowFrameRateMessage"),o.appendChild(s),n.appendChild(o),xe.applyBindings(i,o),this._container=n,this._viewModel=i,this._element=o}Object.defineProperties(hz.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}});hz.prototype.isDestroyed=function(){return!1};hz.prototype.destroy=function(){return this._viewModel.destroy(),xe.cleanNode(this._element),this._container.removeChild(this._element),ue(this)};var mz=hz;function pz(t){this._scene=t,this._orthographic=t.camera.frustum instanceof $t,this._flightInProgress=!1,this.dropDownVisible=!1,this.tooltipPerspective="Perspective Projection",this.tooltipOrthographic="Orthographic Projection",this.selectedTooltip=void 0,this.sceneMode=t.mode,xe.track(this,["_orthographic","_flightInProgress","sceneMode","dropDownVisible","tooltipPerspective","tooltipOrthographic"]);let n=this;xe.defineProperty(this,"selectedTooltip",function(){return n._orthographic?n.tooltipOrthographic:n.tooltipPerspective}),this._toggleDropDown=Tn(function(){n.sceneMode===ne.SCENE2D||n._flightInProgress||(n.dropDownVisible=!n.dropDownVisible)}),this._eventHelper=new Mr,this._eventHelper.add(t.morphComplete,function(i,o,r,s){n.sceneMode=r,n._orthographic=r===ne.SCENE2D||n._scene.camera.frustum instanceof $t}),this._eventHelper.add(t.preRender,function(){n._flightInProgress=f(t.camera._currentFlight)}),this._switchToPerspective=Tn(function(){n.sceneMode!==ne.SCENE2D&&(n._scene.camera.switchToPerspectiveFrustum(),n._orthographic=!1,n.dropDownVisible=!1)}),this._switchToOrthographic=Tn(function(){n.sceneMode!==ne.SCENE2D&&(n._scene.camera.switchToOrthographicFrustum(),n._orthographic=!0,n.dropDownVisible=!1)}),this._sceneMode=ne}Object.defineProperties(pz.prototype,{scene:{get:function(){return this._scene}},toggleDropDown:{get:function(){return this._toggleDropDown}},switchToPerspective:{get:function(){return this._switchToPerspective}},switchToOrthographic:{get:function(){return this._switchToOrthographic}},isOrthographicProjection:{get:function(){return this._orthographic}}});pz.prototype.isDestroyed=function(){return!1};pz.prototype.destroy=function(){this._eventHelper.removeAll(),ue(this)};var _z=pz;var umt="M 28.15625,10.4375 9.125,13.21875 13.75,43.25 41.75,55.09375 50.8125,37 54.5,11.9375 z m 0.125,3 19.976451,0.394265 L 43.03125,16.875 22.6875,14.28125 z M 50.971746,15.705477 47.90625,36.03125 42.53125,46 44.84375,19.3125 z M 12.625,16.03125 l 29.15625,3.6875 -2.65625,31 L 16.4375,41.125 z",fmt="m 31.560594,6.5254438 -20.75,12.4687502 0.1875,24.5625 22.28125,11.8125 19.5,-12 0.65625,-0.375 0,-0.75 0.0312,-23.21875 z m 0.0625,3.125 16.65625,9.5000002 -16.125,10.28125 -17.34375,-9.71875 z m 18.96875,11.1875002 0.15625,20.65625 -17.46875,10.59375 0.15625,-20.28125 z m -37.0625,1.25 17.21875,9.625 -0.15625,19.21875 -16.9375,-9 z";function gz(t,n){t=On(t);let i=new _z(n);i._perspectivePath=umt,i._orthographicPath=fmt;let o=document.createElement("span");o.className="cesium-projectionPicker-wrapper cesium-toolbar-button",t.appendChild(o);let r=document.createElement("button");r.type="button",r.className="cesium-button cesium-toolbar-button",r.setAttribute("data-bind",'css: { "cesium-projectionPicker-buttonPerspective": !_orthographic,       "cesium-projectionPicker-buttonOrthographic": _orthographic,       "cesium-button-disabled" : sceneMode === _sceneMode.SCENE2D || _flightInProgress,        "cesium-projectionPicker-selected": dropDownVisible },attr: { title: selectedTooltip },click: toggleDropDown'),r.innerHTML='<!-- ko cesiumSvgPath: { path: _perspectivePath, width: 64, height: 64, css: "cesium-projectionPicker-iconPerspective" } --><!-- /ko --><!-- ko cesiumSvgPath: { path: _orthographicPath, width: 64, height: 64, css: "cesium-projectionPicker-iconOrthographic" } --><!-- /ko -->',o.appendChild(r);let s=document.createElement("button");s.type="button",s.className="cesium-button cesium-toolbar-button cesium-projectionPicker-dropDown-icon",s.setAttribute("data-bind",'css: { "cesium-projectionPicker-visible" : (dropDownVisible && _orthographic),       "cesium-projectionPicker-none" : !_orthographic,       "cesium-projectionPicker-hidden" : !dropDownVisible },attr: { title: tooltipPerspective },click: switchToPerspective,cesiumSvgPath: { path: _perspectivePath, width: 64, height: 64 }'),o.appendChild(s);let a=document.createElement("button");a.type="button",a.className="cesium-button cesium-toolbar-button cesium-projectionPicker-dropDown-icon",a.setAttribute("data-bind",'css: { "cesium-projectionPicker-visible" : (dropDownVisible && !_orthographic),       "cesium-projectionPicker-none" : _orthographic,       "cesium-projectionPicker-hidden" : !dropDownVisible},attr: { title: tooltipOrthographic },click: switchToOrthographic,cesiumSvgPath: { path: _orthographicPath, width: 64, height: 64 }'),o.appendChild(a),xe.applyBindings(i,o),this._viewModel=i,this._container=t,this._wrapper=o,this._closeDropDown=function(c){o.contains(c.target)||(i.dropDownVisible=!1)},Vt.supportsPointerEvents()?document.addEventListener("pointerdown",this._closeDropDown,!0):(document.addEventListener("mousedown",this._closeDropDown,!0),document.addEventListener("touchstart",this._closeDropDown,!0))}Object.defineProperties(gz.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}});gz.prototype.isDestroyed=function(){return!1};gz.prototype.destroy=function(){return this._viewModel.destroy(),Vt.supportsPointerEvents()?document.removeEventListener("pointerdown",this._closeDropDown,!0):(document.removeEventListener("mousedown",this._closeDropDown,!0),document.removeEventListener("touchstart",this._closeDropDown,!0)),xe.cleanNode(this._wrapper),this._container.removeChild(this._wrapper),ue(this)};var yz=gz;var dmt=new W,Az="-1000px";function sP(t,n,i){this._scene=t,this._screenPositionX=Az,this._screenPositionY=Az,this._tweens=t.tweens,this._container=A(i,document.body),this._selectionIndicatorElement=n,this._scale=1,this.position=void 0,this.showSelection=!1,xe.track(this,["position","_screenPositionX","_screenPositionY","_scale","showSelection"]),this.isVisible=void 0,xe.defineProperty(this,"isVisible",{get:function(){return this.showSelection&&f(this.position)}}),xe.defineProperty(this,"_transform",{get:function(){return`scale(${this._scale})`}}),this.computeScreenSpacePosition=function(o,r){return Yi.wgs84ToWindowCoordinates(t,o,r)}}sP.prototype.update=function(){if(this.showSelection&&f(this.position)){let t=this.computeScreenSpacePosition(this.position,dmt);if(!f(t))this._screenPositionX=Az,this._screenPositionY=Az;else{let n=this._container,i=n.parentNode.clientWidth,o=n.parentNode.clientHeight,r=this._selectionIndicatorElement.clientWidth,s=r*.5;t.x=Math.min(Math.max(t.x,-r),i+r)-s,t.y=Math.min(Math.max(t.y,-r),o+r)-s,this._screenPositionX=`${Math.floor(t.x+.25)}px`,this._screenPositionY=`${Math.floor(t.y+.25)}px`}}};sP.prototype.animateAppear=function(){this._tweens.addProperty({object:this,property:"_scale",startValue:2,stopValue:1,duration:.8,easingFunction:Vr.EXPONENTIAL_OUT})};sP.prototype.animateDepart=function(){this._tweens.addProperty({object:this,property:"_scale",startValue:this._scale,stopValue:1.5,duration:.8,easingFunction:Vr.EXPONENTIAL_OUT})};Object.defineProperties(sP.prototype,{container:{get:function(){return this._container}},selectionIndicatorElement:{get:function(){return this._selectionIndicatorElement}},scene:{get:function(){return this._scene}}});var Cz=sP;function xz(t,n){t=On(t),this._container=t;let i=document.createElement("div");i.className="cesium-selection-wrapper",i.setAttribute("data-bind",'style: { "top" : _screenPositionY, "left" : _screenPositionX },css: { "cesium-selection-wrapper-visible" : isVisible }'),t.appendChild(i),this._element=i;let o="http://www.w3.org/2000/svg",r="M -34 -34 L -34 -11.25 L -30 -15.25 L -30 -30 L -15.25 -30 L -11.25 -34 L -34 -34 z M 11.25 -34 L 15.25 -30 L 30 -30 L 30 -15.25 L 34 -11.25 L 34 -34 L 11.25 -34 z M -34 11.25 L -34 34 L -11.25 34 L -15.25 30 L -30 30 L -30 15.25 L -34 11.25 z M 34 11.25 L 30 15.25 L 30 30 L 15.25 30 L 11.25 34 L 34 34 L 34 11.25 z",s=document.createElementNS(o,"svg:svg");s.setAttribute("width",160),s.setAttribute("height",160),s.setAttribute("viewBox","0 0 160 160");let a=document.createElementNS(o,"g");a.setAttribute("transform","translate(80,80)"),s.appendChild(a);let c=document.createElementNS(o,"path");c.setAttribute("data-bind","attr: { transform: _transform }"),c.setAttribute("d",r),a.appendChild(c),i.appendChild(s);let l=new Cz(n,this._element,this._container);this._viewModel=l,xe.applyBindings(this._viewModel,this._element)}Object.defineProperties(xz.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}});xz.prototype.isDestroyed=function(){return!1};xz.prototype.destroy=function(){let t=this._container;return xe.cleanNode(this._element),t.removeChild(this._element),ue(this)};var Tz=xz;function Ez(t,n){this._scene=t;let i=this,o=function(r,s,a,c){i.sceneMode=a,i.dropDownVisible=!1};this._eventHelper=new Mr,this._eventHelper.add(t.morphStart,o),this._duration=A(n,2),this.sceneMode=t.mode,this.dropDownVisible=!1,this.tooltip2D="2D",this.tooltip3D="3D",this.tooltipColumbusView="Columbus View",xe.track(this,["sceneMode","dropDownVisible","tooltip2D","tooltip3D","tooltipColumbusView"]),this.selectedTooltip=void 0,xe.defineProperty(this,"selectedTooltip",function(){let r=i.sceneMode;return r===ne.SCENE2D?i.tooltip2D:r===ne.SCENE3D?i.tooltip3D:i.tooltipColumbusView}),this._toggleDropDown=Tn(function(){i.dropDownVisible=!i.dropDownVisible}),this._morphTo2D=Tn(function(){t.morphTo2D(i._duration)}),this._morphTo3D=Tn(function(){t.morphTo3D(i._duration)}),this._morphToColumbusView=Tn(function(){t.morphToColumbusView(i._duration)}),this._sceneMode=ne}Object.defineProperties(Ez.prototype,{scene:{get:function(){return this._scene}},duration:{get:function(){return this._duration},set:function(t){this._duration=t}},toggleDropDown:{get:function(){return this._toggleDropDown}},morphTo2D:{get:function(){return this._morphTo2D}},morphTo3D:{get:function(){return this._morphTo3D}},morphToColumbusView:{get:function(){return this._morphToColumbusView}}});Ez.prototype.isDestroyed=function(){return!1};Ez.prototype.destroy=function(){this._eventHelper.removeAll(),ue(this)};var bz=Ez;var hmt="m 32.401392,4.9330437 c -7.087603,0 -14.096095,2.884602 -19.10793,7.8946843 -5.0118352,5.010083 -7.9296167,11.987468 -7.9296167,19.072999 0,7.085531 2.9177815,14.097848 7.9296167,19.107931 4.837653,4.835961 11.541408,7.631372 18.374354,7.82482 0.05712,0.01231 0.454119,0.139729 0.454119,0.139729 l 0.03493,-0.104797 c 0.08246,7.84e-4 0.162033,0.03493 0.244525,0.03493 0.08304,0 0.161515,-0.03414 0.244526,-0.03493 l 0.03493,0.104797 c 0,0 0.309474,-0.129487 0.349323,-0.139729 6.867765,-0.168094 13.582903,-2.965206 18.444218,-7.82482 2.558195,-2.5573 4.551081,-5.638134 5.903547,-8.977584 1.297191,-3.202966 2.02607,-6.661489 2.02607,-10.130347 0,-6.237309 -2.366261,-12.31219 -6.322734,-17.116794 -0.0034,-0.02316 0.0049,-0.04488 0,-0.06986 -0.01733,-0.08745 -0.104529,-0.278855 -0.104797,-0.279458 -5.31e-4,-0.0012 -0.522988,-0.628147 -0.523984,-0.62878         -3.47e-4,-2.2e-4 -0.133444,-0.03532 -0.244525,-0.06987 C 51.944299,13.447603 51.751076,13.104317 51.474391,12.827728 46.462556,7.8176457 39.488996,4.9330437 32.401392,4.9330437 z m -2.130866,3.5281554 0.104797,9.6762289 c -4.111695,-0.08361 -7.109829,-0.423664 -9.257041,-0.943171 1.198093,-2.269271 2.524531,-4.124404 3.91241,-5.414496 2.167498,-2.0147811 3.950145,-2.8540169 5.239834,-3.3185619 z m 2.794579,0 c 1.280302,0.4754953 3.022186,1.3285948 5.065173,3.2486979 1.424667,1.338973 2.788862,3.303645 3.982275,5.728886 -2.29082,0.403367 -5.381258,0.621049 -8.942651,0.698645 L 33.065105,8.4611991 z m 5.728886,0.2445256 c 4.004072,1.1230822 7.793098,3.1481363 10.724195,6.0782083 0.03468,0.03466 0.07033,0.06991 0.104797,0.104797 -0.45375,0.313891 -0.923054,0.663002 -1.956205,1.082899 -0.647388,0.263114 -1.906242,0.477396 -2.829511,0.733577 -1.382296,-2.988132         -3.027146,-5.368585 -4.785716,-7.0213781 -0.422866,-0.397432 -0.835818,-0.6453247 -1.25756,-0.9781032 z m -15.33525,0.7685092 c -0.106753,0.09503 -0.207753,0.145402 -0.31439,0.244526 -1.684973,1.5662541 -3.298068,3.8232211 -4.680919,6.5672591 -0.343797,-0.14942 -1.035052,-0.273198 -1.292493,-0.419186 -0.956528,-0.542427 -1.362964,-1.022024 -1.537018,-1.292493 -0.0241,-0.03745 -0.01868,-0.0401 -0.03493,-0.06986 2.250095,-2.163342 4.948824,-3.869984 7.859752,-5.0302421 z m -9.641296,7.0912431 c 0.464973,0.571618 0.937729,1.169056 1.956205,1.746612 0.349907,0.198425 1.107143,0.335404 1.537018,0.523983 -1.20166,3.172984 -1.998037,7.051901 -2.165798,11.772162 C 14.256557,30.361384 12.934823,30.161483 12.280427,29.90959 10.644437,29.279855 9.6888882,28.674891 9.1714586,28.267775 8.6540289,27.860658 8.6474751,27.778724 8.6474751,27.778724 l -0.069864,0.03493 C 9.3100294,23.691285         11.163248,19.798527 13.817445,16.565477 z m 37.552149,0.523984 c 2.548924,3.289983 4.265057,7.202594 4.890513,11.318043 -0.650428,0.410896 -1.756876,1.001936 -3.563088,1.606882 -1.171552,0.392383 -3.163859,0.759153 -4.960377,1.117832 -0.04367,-4.752703 -0.784809,-8.591423 -1.88634,-11.807094 0.917574,-0.263678 2.170552,-0.486495 2.864443,-0.76851 1.274693,-0.518066 2.003942,-1.001558 2.654849,-1.467153 z m -31.439008,2.619917 c 2.487341,0.672766 5.775813,1.137775 10.479669,1.222628 l 0.104797,10.689263 0,0.03493 0,0.733577 c -5.435005,-0.09059 -9.512219,-0.519044 -12.610536,-1.117831 0.106127,-4.776683 0.879334,-8.55791 2.02607,-11.562569 z m 23.264866,0.31439 c 1.073459,3.067541 1.833795,6.821314 1.816476,11.702298 -3.054474,0.423245 -7.062018,0.648559 -11.702298,0.698644 l 0,-0.838373 -0.104796,-10.654331 c 4.082416,-0.0864 7.404468,-0.403886 9.990618,-0.908238 z         M 8.2632205,30.922625 c 0.7558676,0.510548 1.5529563,1.013339 3.0041715,1.57195 0.937518,0.360875 2.612202,0.647642 3.91241,0.978102 0.112814,3.85566 0.703989,7.107756 1.606883,9.920754 -1.147172,-0.324262 -2.644553,-0.640648 -3.423359,-0.978102 -1.516688,-0.657177 -2.386627,-1.287332 -2.864443,-1.71168 -0.477816,-0.424347 -0.489051,-0.489051 -0.489051,-0.489051 L 9.8002387,40.319395 C 8.791691,37.621767 8.1584238,34.769583 8.1584238,31.900727 c 0,-0.330153 0.090589,-0.648169 0.1047967,-0.978102 z m 48.2763445,0.419186 c 0.0047,0.188973 0.06986,0.36991 0.06986,0.558916 0,2.938869 -0.620228,5.873558 -1.676747,8.628261 -0.07435,0.07583 -0.06552,0.07411 -0.454119,0.349323 -0.606965,0.429857 -1.631665,1.042044 -3.318562,1.676747 -1.208528,0.454713 -3.204964,0.850894 -5.135038,1.25756 0.84593,-2.765726 1.41808,-6.005357 1.606883,-9.815957 2.232369,-0.413371 4.483758,-0.840201         5.938479,-1.327425 1.410632,-0.472457 2.153108,-0.89469 2.96924,-1.327425 z m -38.530252,2.864443 c 3.208141,0.56697 7.372279,0.898588 12.575603,0.978103 l 0.174662,9.885821 c -4.392517,-0.06139 -8.106722,-0.320566 -10.863925,-0.803441 -1.051954,-2.664695 -1.692909,-6.043794 -1.88634,-10.060483 z m 26.793022,0.31439 c -0.246298,3.923551 -0.877762,7.263679 -1.816476,9.885822 -2.561957,0.361954 -5.766249,0.560708 -9.431703,0.62878 l -0.174661,-9.815957 c 4.491734,-0.04969 8.334769,-0.293032 11.42284,-0.698645 z M 12.035901,44.860585 c 0.09977,0.04523 0.105535,0.09465 0.209594,0.139729 1.337656,0.579602 3.441099,1.058072 5.589157,1.537018 1.545042,3.399208 3.548524,5.969402 5.589157,7.789888 -3.034411,-1.215537 -5.871615,-3.007978 -8.174142,-5.309699 -1.245911,-1.245475 -2.271794,-2.662961 -3.213766,-4.156936 z m 40.69605,0 c -0.941972,1.493975 -1.967855,2.911461         -3.213765,4.156936 -2.74253,2.741571 -6.244106,4.696717 -9.955686,5.868615 0.261347,-0.241079 0.507495,-0.394491 0.768509,-0.663713 1.674841,-1.727516 3.320792,-4.181056 4.645987,-7.265904 2.962447,-0.503021 5.408965,-1.122293 7.161107,-1.781544 0.284034,-0.106865 0.337297,-0.207323 0.593848,-0.31439 z m -31.404076,2.305527 c 2.645807,0.376448 5.701178,0.649995 9.466635,0.698645 l 0.139729,7.789888 c -1.38739,-0.480844 -3.316218,-1.29837 -5.659022,-3.388427 -1.388822,-1.238993 -2.743668,-3.0113 -3.947342,-5.100106 z m 20.365491,0.104797 c -1.04872,2.041937 -2.174337,3.779068 -3.353494,4.995309 -1.853177,1.911459 -3.425515,2.82679 -4.611055,3.353494 l -0.139729,-7.789887 c 3.13091,-0.05714 5.728238,-0.278725 8.104278,-0.558916 z",mmt="m 2.9825053,17.550598 0,1.368113 0,26.267766 0,1.368113 1.36811,0 54.9981397,0 1.36811,0 0,-1.368113 0,-26.267766 0,-1.368113 -1.36811,0 -54.9981397,0 -1.36811,0 z m 2.73623,2.736226 10.3292497,0 0,10.466063 -10.3292497,0 0,-10.466063 z m 13.0654697,0 11.69737,0 0,10.466063 -11.69737,0 0,-10.466063 z m 14.43359,0 11.69737,0 0,10.466063 -11.69737,0 0,-10.466063 z m 14.43359,0 10.32926,0 0,10.466063 -10.32926,0 0,-10.466063 z m -41.9326497,13.202288 10.3292497,0 0,10.329252 -10.3292497,0 0,-10.329252 z m 13.0654697,0 11.69737,0 0,10.329252 -11.69737,0 0,-10.329252 z m 14.43359,0 11.69737,0 0,10.329252 -11.69737,0 0,-10.329252 z m 14.43359,0 10.32926,0 0,10.329252 -10.32926,0 0,-10.329252 z",pmt="m 14.723969,17.675598 -0.340489,0.817175 -11.1680536,26.183638 -0.817175,1.872692 2.076986,0 54.7506996,0 2.07698,0 -0.81717,-1.872692 -11.16805,-26.183638 -0.34049,-0.817175 -0.91933,0 -32.414586,0 -0.919322,0 z m 1.838643,2.723916 6.196908,0 -2.928209,10.418977 -7.729111,0 4.460412,-10.418977 z m 9.02297,0 4.903049,0 0,10.418977 -7.831258,0 2.928209,-10.418977 z m 7.626964,0 5.584031,0 2.62176,10.418977 -8.205791,0 0,-10.418977 z m 8.410081,0 5.51593,0 4.46042,10.418977 -7.38863,0 -2.58772,-10.418977 z m -30.678091,13.142892 8.103649,0 -2.89416,10.282782 -9.6018026,0 4.3923136,-10.282782 z m 10.929711,0 8.614384,0 0,10.282782 -11.508544,0 2.89416,-10.282782 z m 11.338299,0 8.852721,0 2.58772,10.282782 -11.440441,0 0,-10.282782 z m 11.678781,0 7.86531,0 4.39231,10.282782 -9.6699,0 -2.58772,-10.282782 z";function Sz(t,n,i){t=On(t);let o=new bz(n,i);o._globePath=hmt,o._flatMapPath=mmt,o._columbusViewPath=pmt;let r=document.createElement("span");r.className="cesium-sceneModePicker-wrapper cesium-toolbar-button",t.appendChild(r);let s=document.createElement("button");s.type="button",s.className="cesium-button cesium-toolbar-button",s.setAttribute("data-bind",'css: { "cesium-sceneModePicker-button2D": sceneMode === _sceneMode.SCENE2D,       "cesium-sceneModePicker-button3D": sceneMode === _sceneMode.SCENE3D,       "cesium-sceneModePicker-buttonColumbusView": sceneMode === _sceneMode.COLUMBUS_VIEW,       "cesium-sceneModePicker-selected": dropDownVisible },attr: { title: selectedTooltip },click: toggleDropDown'),s.innerHTML='<!-- ko cesiumSvgPath: { path: _globePath, width: 64, height: 64, css: "cesium-sceneModePicker-slide-svg cesium-sceneModePicker-icon3D" } --><!-- /ko --><!-- ko cesiumSvgPath: { path: _flatMapPath, width: 64, height: 64, css: "cesium-sceneModePicker-slide-svg cesium-sceneModePicker-icon2D" } --><!-- /ko --><!-- ko cesiumSvgPath: { path: _columbusViewPath, width: 64, height: 64, css: "cesium-sceneModePicker-slide-svg cesium-sceneModePicker-iconColumbusView" } --><!-- /ko -->',r.appendChild(s);let a=document.createElement("button");a.type="button",a.className="cesium-button cesium-toolbar-button cesium-sceneModePicker-dropDown-icon",a.setAttribute("data-bind",'css: { "cesium-sceneModePicker-visible" : (dropDownVisible && (sceneMode !== _sceneMode.SCENE3D)) || (!dropDownVisible && (sceneMode === _sceneMode.SCENE3D)),       "cesium-sceneModePicker-none" : sceneMode === _sceneMode.SCENE3D,       "cesium-sceneModePicker-hidden" : !dropDownVisible },attr: { title: tooltip3D },click: morphTo3D,cesiumSvgPath: { path: _globePath, width: 64, height: 64 }'),r.appendChild(a);let c=document.createElement("button");c.type="button",c.className="cesium-button cesium-toolbar-button cesium-sceneModePicker-dropDown-icon",c.setAttribute("data-bind",'css: { "cesium-sceneModePicker-visible" : (dropDownVisible && (sceneMode !== _sceneMode.SCENE2D)),       "cesium-sceneModePicker-none" : sceneMode === _sceneMode.SCENE2D,       "cesium-sceneModePicker-hidden" : !dropDownVisible },attr: { title: tooltip2D },click: morphTo2D,cesiumSvgPath: { path: _flatMapPath, width: 64, height: 64 }'),r.appendChild(c);let l=document.createElement("button");l.type="button",l.className="cesium-button cesium-toolbar-button cesium-sceneModePicker-dropDown-icon",l.setAttribute("data-bind",'css: { "cesium-sceneModePicker-visible" : (dropDownVisible && (sceneMode !== _sceneMode.COLUMBUS_VIEW)) || (!dropDownVisible && (sceneMode === _sceneMode.COLUMBUS_VIEW)),       "cesium-sceneModePicker-none" : sceneMode === _sceneMode.COLUMBUS_VIEW,       "cesium-sceneModePicker-hidden" : !dropDownVisible},attr: { title: tooltipColumbusView },click: morphToColumbusView,cesiumSvgPath: { path: _columbusViewPath, width: 64, height: 64 }'),r.appendChild(l),xe.applyBindings(o,r),this._viewModel=o,this._container=t,this._wrapper=r,this._closeDropDown=function(u){r.contains(u.target)||(o.dropDownVisible=!1)},Vt.supportsPointerEvents()?document.addEventListener("pointerdown",this._closeDropDown,!0):(document.addEventListener("mousedown",this._closeDropDown,!0),document.addEventListener("touchstart",this._closeDropDown,!0))}Object.defineProperties(Sz.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}});Sz.prototype.isDestroyed=function(){return!1};Sz.prototype.destroy=function(){return this._viewModel.destroy(),Vt.supportsPointerEvents()?document.removeEventListener("pointerdown",this._closeDropDown,!0):(document.removeEventListener("mousedown",this._closeDropDown,!0),document.removeEventListener("touchstart",this._closeDropDown,!0)),xe.cleanNode(this._wrapper),this._container.removeChild(this._wrapper),ue(this)};var wz=Sz;function VA(t,n,i){this._color=t,this._height=n,this._base=A(i,0)}VA.prototype.getHeight=function(){return this._height};VA.prototype.getBase=function(){return this._base};VA.prototype.getStartTime=function(){return this._start};VA.prototype.getStopTime=function(){return this._stop};VA.prototype.setRange=function(t,n){this._start=t,this._stop=n};VA.prototype.render=function(t){let n="";if(this._start&&this._stop&&this._color){let i=te.secondsDifference(this._start,t.epochJulian),o=Math.round(t.timeBarWidth*t.getAlpha(i)),r=te.secondsDifference(this._stop,t.epochJulian),s=Math.round(t.timeBarWidth*t.getAlpha(r))-o;o<0&&(s+=o,o=0),o+s>t.timeBarWidth&&(s=t.timeBarWidth-o),s>0&&(n=`<span class="cesium-timeline-highlight" style="left: ${o.toString()}px; width: ${s.toString()}px; bottom: ${this._base.toString()}px; height: ${this._height}px; background-color: ${this._color};"></span>`)}return n};var Dz=VA;function X0e(t,n,i,o){this.interval=t,this.height=n,this.color=i||new z(.5,.5,.5,1),this.backgroundColor=o||new z(0,0,0,0)}X0e.prototype.render=function(t,n){let i=this.interval.start,o=this.interval.stop,r=n.startJulian,s=te.addSeconds(n.startJulian,n.duration,new te);if(te.lessThan(i,r)&&te.greaterThan(o,s))t.fillStyle=this.color.toCssColorString(),t.fillRect(0,n.y,n.timeBarWidth,this.height);else if(te.lessThanOrEquals(i,s)&&te.greaterThanOrEquals(o,r)){let a,c,l;for(a=0;a<n.timeBarWidth;++a){let u=te.addSeconds(n.startJulian,a/n.timeBarWidth*n.duration,new te);!f(c)&&te.greaterThanOrEquals(u,i)?c=a:!f(l)&&te.greaterThanOrEquals(u,o)&&(l=a)}t.fillStyle=this.backgroundColor.toCssColorString(),t.fillRect(0,n.y,n.timeBarWidth,this.height),f(c)&&(f(l)||(l=n.timeBarWidth),t.fillStyle=this.color.toCssColorString(),t.fillRect(c,n.y,Math.max(l-c,1),this.height))}};var vz=X0e;var Yq=1e12,_f={none:0,scrub:1,slide:2,zoom:3,touchOnly:4},Ic={none:0,scrub:1,slideZoom:2,singleTap:3,ignore:4},a0=[.001,.002,.005,.01,.02,.05,.1,.25,.5,1,2,5,10,15,30,60,120,300,600,900,1800,3600,7200,14400,21600,43200,86400,172800,345600,604800,1296e3,2592e3,5184e3,7776e3,15552e3,31536e3,63072e3,126144e3,15768e4,31536e4,63072e4,126144e4,15768e5,31536e5,63072e5,126144e5,15768e6,31536e6],_mt=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function Bc(t,n){t=On(t);let i=t.ownerDocument;this.container=t;let o=i.createElement("div");o.className="cesium-timeline-main",t.appendChild(o),this._topDiv=o,this._endJulian=void 0,this._epochJulian=void 0,this._lastXPos=void 0,this._scrubElement=void 0,this._startJulian=void 0,this._timeBarSecondsSpan=void 0,this._clock=n,this._scrubJulian=n.currentTime,this._mainTicSpan=-1,this._mouseMode=_f.none,this._touchMode=Ic.none,this._touchState={centerX:0,spanX:0},this._mouseX=0,this._timelineDrag=0,this._timelineDragLocation=void 0,this._lastHeight=void 0,this._lastWidth=void 0,this._topDiv.innerHTML='<div class="cesium-timeline-bar"></div><div class="cesium-timeline-trackContainer"><canvas class="cesium-timeline-tracks" width="10" height="1"></canvas></div><div class="cesium-timeline-needle"></div><span class="cesium-timeline-ruler"></span>',this._timeBarEle=this._topDiv.childNodes[0],this._trackContainer=this._topDiv.childNodes[1],this._trackListEle=this._topDiv.childNodes[1].childNodes[0],this._needleEle=this._topDiv.childNodes[2],this._rulerEle=this._topDiv.childNodes[3],this._context=this._trackListEle.getContext("2d"),this._trackList=[],this._highlightRanges=[],this.zoomTo(n.startTime,n.stopTime),this._onMouseDown=gmt(this),this._onMouseUp=ymt(this),this._onMouseMove=Amt(this),this._onMouseWheel=Cmt(this),this._onTouchStart=xmt(this),this._onTouchMove=Emt(this),this._onTouchEnd=Tmt(this);let r=this._timeBarEle;i.addEventListener("mouseup",this._onMouseUp,!1),i.addEventListener("mousemove",this._onMouseMove,!1),r.addEventListener("mousedown",this._onMouseDown,!1),r.addEventListener("DOMMouseScroll",this._onMouseWheel,!1),r.addEventListener("mousewheel",this._onMouseWheel,!1),r.addEventListener("touchstart",this._onTouchStart,!1),r.addEventListener("touchmove",this._onTouchMove,!1),r.addEventListener("touchend",this._onTouchEnd,!1),r.addEventListener("touchcancel",this._onTouchEnd,!1),this._topDiv.oncontextmenu=function(){return!1},n.onTick.addEventListener(this.updateFromClock,this),this.updateFromClock()}Bc.prototype.addEventListener=function(t,n,i){this._topDiv.addEventListener(t,n,i)};Bc.prototype.removeEventListener=function(t,n,i){this._topDiv.removeEventListener(t,n,i)};Bc.prototype.isDestroyed=function(){return!1};Bc.prototype.destroy=function(){this._clock.onTick.removeEventListener(this.updateFromClock,this);let t=this.container.ownerDocument;t.removeEventListener("mouseup",this._onMouseUp,!1),t.removeEventListener("mousemove",this._onMouseMove,!1);let n=this._timeBarEle;n.removeEventListener("mousedown",this._onMouseDown,!1),n.removeEventListener("DOMMouseScroll",this._onMouseWheel,!1),n.removeEventListener("mousewheel",this._onMouseWheel,!1),n.removeEventListener("touchstart",this._onTouchStart,!1),n.removeEventListener("touchmove",this._onTouchMove,!1),n.removeEventListener("touchend",this._onTouchEnd,!1),n.removeEventListener("touchcancel",this._onTouchEnd,!1),this.container.removeChild(this._topDiv),ue(this)};Bc.prototype.addHighlightRange=function(t,n,i){let o=new Dz(t,n,i);return this._highlightRanges.push(o),this.resize(),o};Bc.prototype.addTrack=function(t,n,i,o){let r=new vz(t,n,i,o);return this._trackList.push(r),this._lastHeight=void 0,this.resize(),r};Bc.prototype.zoomTo=function(t,n){if(this._startJulian=t,this._endJulian=n,this._timeBarSecondsSpan=te.secondsDifference(n,t),this._clock&&this._clock.clockRange!==Nr.UNBOUNDED){let o=this._clock.startTime,r=this._clock.stopTime,s=te.secondsDifference(r,o),a=te.secondsDifference(o,this._startJulian),c=te.secondsDifference(r,this._endJulian);this._timeBarSecondsSpan>=s?(this._timeBarSecondsSpan=s,this._startJulian=this._clock.startTime,this._endJulian=this._clock.stopTime):a>0?(this._endJulian=te.addSeconds(this._endJulian,a,new te),this._startJulian=o,this._timeBarSecondsSpan=te.secondsDifference(this._endJulian,this._startJulian)):c<0&&(this._startJulian=te.addSeconds(this._startJulian,c,new te),this._endJulian=r,this._timeBarSecondsSpan=te.secondsDifference(this._endJulian,this._startJulian))}this._makeTics();let i=document.createEvent("Event");i.initEvent("setzoom",!0,!0),i.startJulian=this._startJulian,i.endJulian=this._endJulian,i.epochJulian=this._epochJulian,i.totalSpan=this._timeBarSecondsSpan,i.mainTicSpan=this._mainTicSpan,this._topDiv.dispatchEvent(i)};Bc.prototype.zoomFrom=function(t){let n=te.secondsDifference(this._scrubJulian,this._startJulian);t>1||n<0||n>this._timeBarSecondsSpan?n=this._timeBarSecondsSpan*.5:n+=n-this._timeBarSecondsSpan*.5;let i=this._timeBarSecondsSpan-n;this.zoomTo(te.addSeconds(this._startJulian,n-n*t,new te),te.addSeconds(this._endJulian,i*t-i,new te))};function Xq(t){return t<10?`0${t.toString()}`:t.toString()}Bc.prototype.makeLabel=function(t){let n=te.toGregorianDate(t),i=n.millisecond,o=" UTC";if(i>0&&this._timeBarSecondsSpan<3600){for(o=Math.floor(i).toString();o.length<3;)o=`0${o}`;o=`.${o}`}return`${_mt[n.month-1]} ${n.day} ${n.year} ${Xq(n.hour)}:${Xq(n.minute)}:${Xq(n.second)}${o}`};Bc.prototype.smallestTicInPixels=7;Bc.prototype._makeTics=function(){let t=this._timeBarEle,n=te.secondsDifference(this._scrubJulian,this._startJulian),i=Math.round(n*this._topDiv.clientWidth/this._timeBarSecondsSpan),o=i-8,r,s=this;this._needleEle.style.left=`${i.toString()}px`;let a="",c=.01,l=31536e6,u=1e-10,d=0,h=this._timeBarSecondsSpan;h<c?(h=c,this._timeBarSecondsSpan=c,this._endJulian=te.addSeconds(this._startJulian,c,new te)):h>l&&(h=l,this._timeBarSecondsSpan=l,this._endJulian=te.addSeconds(this._startJulian,l,new te));let _=this._timeBarEle.clientWidth;_<10&&(_=10);let y=this._startJulian,p=Math.min(h/_*1e-5,.4),C,x=te.toGregorianDate(y);h>31536e4?C=te.fromDate(new Date(Date.UTC(Math.floor(x.year/100)*100,0))):h>31536e3?C=te.fromDate(new Date(Date.UTC(Math.floor(x.year/10)*10,0))):h>86400?C=te.fromDate(new Date(Date.UTC(x.year,0))):C=te.fromDate(new Date(Date.UTC(x.year,x.month,x.day)));let T=te.secondsDifference(this._startJulian,te.addSeconds(C,p,new te)),E=T+h;this._epochJulian=C;function S(k){return Math.floor(T/k)*k}function w(k,X){return Math.ceil(k/X+.5)*X}function D(k){return(k-T)/h}function I(k,X){return k-X*Math.round(k/X)}this._rulerEle.innerHTML=this.makeLabel(te.addSeconds(this._endJulian,-c,new te));let O=this._rulerEle.offsetWidth+20;O<30&&(O=180);let M=d;d-=u;let L={startTime:T,startJulian:y,epochJulian:C,duration:h,timeBarWidth:_,getAlpha:D};this._highlightRanges.forEach(function(k){a+=k.render(L)});let F=0,g=0,b=0,v=O/_;v>1&&(v=1),v*=this._timeBarSecondsSpan;let P=-1,R=-1,V=a0.length,H;for(H=0;H<V;++H){let k=a0[H];if(++P,F=k,k>v&&k>d)break;R<0&&_*(k/this._timeBarSecondsSpan)>=this.smallestTicInPixels&&(R=P)}if(P>0){for(;P>0;)if(--P,Math.abs(I(F,a0[P]))<1e-5){a0[P]>=d&&(g=a0[P]);break}if(R>=0)for(;R<P;){if(Math.abs(I(g,a0[R]))<1e-5&&a0[R]>=d){b=a0[R];break}++R}}d=M,d>u&&b<1e-5&&Math.abs(d-F)>u&&(b=d,d<=F+u&&(g=0));let U=-999999,G;if(_*(b/this._timeBarSecondsSpan)>=3)for(r=S(b);r<=E;r=w(r,b))a+=`<span class="cesium-timeline-ticTiny" style="left: ${Math.round(_*D(r)).toString()}px;"></span>`;if(_*(g/this._timeBarSecondsSpan)>=3)for(r=S(g);r<=E;r=w(r,g))a+=`<span class="cesium-timeline-ticSub" style="left: ${Math.round(_*D(r)).toString()}px;"></span>`;if(_*(F/this._timeBarSecondsSpan)>=2){this._mainTicSpan=F,E+=F,r=S(F);let k=te.computeTaiMinusUtc(C);for(;r<=E;){let X=te.addSeconds(y,r-T,new te);if(F>2.1){let Z=te.computeTaiMinusUtc(X);Math.abs(Z-k)>.1&&(r+=Z-k,X=te.addSeconds(y,r-T,new te))}let Y=Math.round(_*D(r)),K=this.makeLabel(X);this._rulerEle.innerHTML=K,G=this._rulerEle.offsetWidth,G<10&&(G=O);let j=Y-(G/2-1);j>U?(U=j+G+5,a+=`<span class="cesium-timeline-ticMain" style="left: ${Y.toString()}px;"></span><span class="cesium-timeline-ticLabel" style="left: ${j.toString()}px;">${K}</span>`):a+=`<span class="cesium-timeline-ticSub" style="left: ${Y.toString()}px;"></span>`,r=w(r,F)}}else this._mainTicSpan=-1;a+=`<span class="cesium-timeline-icon16" style="left:${o}px;bottom:0;background-position: 0 0;"></span>`,t.innerHTML=a,this._scrubElement=t.lastChild,this._context.clearRect(0,0,this._trackListEle.width,this._trackListEle.height),L.y=0,this._trackList.forEach(function(k){k.render(s._context,L),L.y+=k.height})};Bc.prototype.updateFromClock=function(){this._scrubJulian=this._clock.currentTime;let t=this._scrubElement;if(f(this._scrubElement)){let n=te.secondsDifference(this._scrubJulian,this._startJulian),i=Math.round(n*this._topDiv.clientWidth/this._timeBarSecondsSpan);this._lastXPos!==i&&(this._lastXPos=i,t.style.left=`${i-8}px`,this._needleEle.style.left=`${i}px`)}f(this._timelineDragLocation)&&(this._setTimeBarTime(this._timelineDragLocation,this._timelineDragLocation*this._timeBarSecondsSpan/this._topDiv.clientWidth),this.zoomTo(te.addSeconds(this._startJulian,this._timelineDrag,new te),te.addSeconds(this._endJulian,this._timelineDrag,new te)))};Bc.prototype._setTimeBarTime=function(t,n){if(t=Math.round(t),this._scrubJulian=te.addSeconds(this._startJulian,n,new te),this._scrubElement){let o=t-8;this._scrubElement.style.left=`${o.toString()}px`,this._needleEle.style.left=`${t.toString()}px`}let i=document.createEvent("Event");i.initEvent("settime",!0,!0),i.clientX=t,i.timeSeconds=n,i.timeJulian=this._scrubJulian,i.clock=this._clock,this._topDiv.dispatchEvent(i)};function gmt(t){return function(n){t._mouseMode!==_f.touchOnly&&(n.button===0?(t._mouseMode=_f.scrub,t._scrubElement&&(t._scrubElement.style.backgroundPosition="-16px 0"),t._onMouseMove(n)):(t._mouseX=n.clientX,n.button===2?t._mouseMode=_f.zoom:t._mouseMode=_f.slide)),n.preventDefault()}}function ymt(t){return function(n){t._mouseMode=_f.none,t._scrubElement&&(t._scrubElement.style.backgroundPosition="0 0"),t._timelineDrag=0,t._timelineDragLocation=void 0}}function Amt(t){return function(n){let i;if(t._mouseMode===_f.scrub){n.preventDefault();let o=n.clientX-t._topDiv.getBoundingClientRect().left;o<0?(t._timelineDragLocation=0,t._timelineDrag=-.01*t._timeBarSecondsSpan):o>t._topDiv.clientWidth?(t._timelineDragLocation=t._topDiv.clientWidth,t._timelineDrag=.01*t._timeBarSecondsSpan):(t._timelineDragLocation=void 0,t._setTimeBarTime(o,o*t._timeBarSecondsSpan/t._topDiv.clientWidth))}else if(t._mouseMode===_f.slide){if(i=t._mouseX-n.clientX,t._mouseX=n.clientX,i!==0){let o=i*t._timeBarSecondsSpan/t._topDiv.clientWidth;t.zoomTo(te.addSeconds(t._startJulian,o,new te),te.addSeconds(t._endJulian,o,new te))}}else t._mouseMode===_f.zoom&&(i=t._mouseX-n.clientX,t._mouseX=n.clientX,i!==0&&t.zoomFrom(Math.pow(1.01,i)))}}function Cmt(t){return function(n){let i=n.wheelDeltaY||n.wheelDelta||-n.detail;Yq=Math.max(Math.min(Math.abs(i),Yq),1),i/=Yq,t.zoomFrom(Math.pow(1.05,-i))}}function xmt(t){return function(n){let i=n.touches.length,o,r,s=t._topDiv.getBoundingClientRect().left;n.preventDefault(),t._mouseMode=_f.touchOnly,i===1?(o=te.secondsDifference(t._scrubJulian,t._startJulian),r=Math.round(o*t._topDiv.clientWidth/t._timeBarSecondsSpan+s),Math.abs(n.touches[0].clientX-r)<50?(t._touchMode=Ic.scrub,t._scrubElement&&(t._scrubElement.style.backgroundPosition=i===1?"-16px 0":"0 0")):(t._touchMode=Ic.singleTap,t._touchState.centerX=n.touches[0].clientX-s)):i===2?(t._touchMode=Ic.slideZoom,t._touchState.centerX=(n.touches[0].clientX+n.touches[1].clientX)*.5-s,t._touchState.spanX=Math.abs(n.touches[0].clientX-n.touches[1].clientX)):t._touchMode=Ic.ignore}}function Tmt(t){return function(n){let i=n.touches.length,o=t._topDiv.getBoundingClientRect().left;t._touchMode===Ic.singleTap?(t._touchMode=Ic.scrub,t._onTouchMove(n)):t._touchMode===Ic.scrub&&t._onTouchMove(n),t._mouseMode=_f.touchOnly,i!==1?t._touchMode=i>0?Ic.ignore:Ic.none:t._touchMode===Ic.slideZoom&&(t._touchState.centerX=n.touches[0].clientX-o),t._scrubElement&&(t._scrubElement.style.backgroundPosition="0 0")}}function Emt(t){return function(n){let i,o,r,s,a,c,l=1,u=t._topDiv.getBoundingClientRect().left;t._touchMode===Ic.singleTap&&(t._touchMode=Ic.slideZoom),t._mouseMode=_f.touchOnly,t._touchMode===Ic.scrub?(n.preventDefault(),n.changedTouches.length===1&&(o=n.changedTouches[0].clientX-u,o>=0&&o<=t._topDiv.clientWidth&&t._setTimeBarTime(o,o*t._timeBarSecondsSpan/t._topDiv.clientWidth))):t._touchMode===Ic.slideZoom&&(r=n.touches.length,r===2?(s=(n.touches[0].clientX+n.touches[1].clientX)*.5-u,a=Math.abs(n.touches[0].clientX-n.touches[1].clientX)):r===1&&(s=n.touches[0].clientX-u,a=0),f(s)&&(a>0&&t._touchState.spanX>0?(l=t._touchState.spanX/a,c=te.addSeconds(t._startJulian,(t._touchState.centerX*t._timeBarSecondsSpan-s*t._timeBarSecondsSpan*l)/t._topDiv.clientWidth,new te)):(i=t._touchState.centerX-s,c=te.addSeconds(t._startJulian,i*t._timeBarSecondsSpan/t._topDiv.clientWidth,new te)),t.zoomTo(c,te.addSeconds(c,t._timeBarSecondsSpan*l,new te)),t._touchState.centerX=s,t._touchState.spanX=a))}}Bc.prototype.resize=function(){let t=this.container.clientWidth,n=this.container.clientHeight;if(t===this._lastWidth&&n===this._lastHeight)return;this._trackContainer.style.height=`${n}px`;let i=1;this._trackList.forEach(function(o){i+=o.height}),this._trackListEle.style.height=`${i.toString()}px`,this._trackListEle.width=this._trackListEle.clientWidth,this._trackListEle.height=i,this._makeTics(),this._lastXPos=void 0,this._lastWidth=t,this._lastHeight=n};var Pz=Bc;var $0e=yo(Q0e(),1);function wmt(t){let n=!1,i=window.screen;return f(i)&&(f(i.lockOrientation)?n=i.lockOrientation(t):f(i.mozLockOrientation)?n=i.mozLockOrientation(t):f(i.msLockOrientation)?n=i.msLockOrientation(t):f(i.orientation&&i.orientation.lock)&&(n=i.orientation.lock(t))),n}function eye(){let t=window.screen;f(t)&&(f(t.unlockOrientation)?t.unlockOrientation():f(t.mozUnlockOrientation)?t.mozUnlockOrientation():f(t.msUnlockOrientation)?t.msUnlockOrientation():f(t.orientation&&t.orientation.unlock)&&t.orientation.unlock())}function Dmt(t,n,i,o){o()||(i()?(n.useWebVR=!1,t._locked&&(eye(),t._locked=!1),t._noSleep.disable(),gr.exitFullscreen(),i(!1)):(gr.fullscreen||gr.requestFullscreen(t._vrElement),t._noSleep.enable(),t._locked||(t._locked=wmt("landscape")),n.useWebVR=!0,i(!0)))}function Iz(t,n){let i=this,o=xe.observable(gr.enabled),r=xe.observable(!1);this.isVRMode=void 0,xe.defineProperty(this,"isVRMode",{get:function(){return r()}}),this.isVREnabled=void 0,xe.defineProperty(this,"isVREnabled",{get:function(){return o()},set:function(a){o(a&&gr.enabled)}}),this.tooltip=void 0,xe.defineProperty(this,"tooltip",function(){return o()?r()?"Exit VR mode":"Enter VR mode":"VR mode is unavailable"});let s=xe.observable(!1);this._isOrthographic=void 0,xe.defineProperty(this,"_isOrthographic",{get:function(){return s()}}),this._eventHelper=new Mr,this._eventHelper.add(t.preRender,function(){s(t.camera.frustum instanceof $t)}),this._locked=!1,this._noSleep=new $0e.default,this._command=Tn(function(){Dmt(i,t,r,s)},xe.getObservable(this,"isVREnabled")),this._vrElement=A(On(n),document.body),this._callback=function(){!gr.fullscreen&&r()&&(t.useWebVR=!1,i._locked&&(eye(),i._locked=!1),i._noSleep.disable(),r(!1))},document.addEventListener(gr.changeEventName,this._callback)}Object.defineProperties(Iz.prototype,{vrElement:{get:function(){return this._vrElement},set:function(t){this._vrElement=t}},command:{get:function(){return this._command}}});Iz.prototype.isDestroyed=function(){return!1};Iz.prototype.destroy=function(){this._eventHelper.removeAll(),document.removeEventListener(gr.changeEventName,this._callback),ue(this)};var Bz=Iz;var vmt="M 5.3125 6.375 C 4.008126 6.375 2.96875 7.4141499 2.96875 8.71875 L 2.96875 19.5 C 2.96875 20.8043 4.008126 21.875 5.3125 21.875 L 13.65625 21.875 C 13.71832 20.0547 14.845166 18.59375 16.21875 18.59375 C 17.592088 18.59375 18.71881 20.0552 18.78125 21.875 L 27.09375 21.875 C 28.398125 21.875 29.4375 20.8043 29.4375 19.5 L 29.4375 8.71875 C 29.4375 7.4141499 28.398125 6.375 27.09375 6.375 L 5.3125 6.375 z M 9.625 10.4375 C 11.55989 10.4375 13.125 12.03385 13.125 13.96875 C 13.125 15.90365 11.55989 17.46875 9.625 17.46875 C 7.69011 17.46875 6.125 15.90365 6.125 13.96875 C 6.125 12.03385 7.69011 10.4375 9.625 10.4375 z M 22.46875 10.4375 C 24.40364 10.4375 25.96875 12.03385 25.96875 13.96875 C 25.96875 15.90365 24.40364 17.46875 22.46875 17.46875 C 20.53386 17.46875 18.96875 15.90365 18.96875 13.96875 C 18.96875 12.03385 20.53386 10.4375 22.46875 10.4375 z",Pmt="M 25.770585,2.4552065 C 15.72282,13.962707 10.699956,19.704407 8.1768352,22.580207 c -1.261561,1.4379 -1.902282,2.1427 -2.21875,2.5 -0.141624,0.1599 -0.208984,0.2355 -0.25,0.2813 l 0.6875,0.75 c 10e-5,-10e-5 0.679191,0.727 0.6875,0.7187 0.01662,-0.016 0.02451,-0.024 0.03125,-0.031 0.01348,-0.014 0.04013,-0.038 0.0625,-0.062 0.04474,-0.05 0.120921,-0.1315 0.28125,-0.3126 0.320657,-0.3619 0.956139,-1.0921 2.2187499,-2.5312 2.5252219,-2.8781 7.5454589,-8.6169 17.5937499,-20.1250005 l -1.5,-1.3125 z m -20.5624998,3.9063 c -1.304375,0 -2.34375,1.0391 -2.34375,2.3437 l 0,10.8125005 c 0,1.3043 1.039375,2.375 2.34375,2.375 l 2.25,0 c 1.9518039,-2.2246 7.4710958,-8.5584 13.5624998,-15.5312005 l -15.8124998,0 z m 21.1249998,0 c -1.855467,2.1245 -2.114296,2.4005 -3.59375,4.0936995 1.767282,0.1815 3.15625,1.685301 3.15625,3.500001 0,1.9349 -1.56511,3.5 -3.5,3.5 -1.658043,0 -3.043426,-1.1411 -3.40625,-2.6875 -1.089617,1.2461 -2.647139,2.9988 -3.46875,3.9375 0.191501,-0.062 0.388502,-0.094 0.59375,-0.094 1.373338,0 2.50006,1.4614 2.5625,3.2812 l 8.3125,0 c 1.304375,0 2.34375,-1.0707 2.34375,-2.375 l 0,-10.8125005 c 0,-1.3046 -1.039375,-2.3437 -2.34375,-2.3437 l -0.65625,0 z M 9.5518351,10.423906 c 1.9348899,0 3.4999999,1.596401 3.4999999,3.531301 0,1.9349 -1.56511,3.5 -3.4999999,3.5 -1.9348899,0 -3.4999999,-1.5651 -3.4999999,-3.5 0,-1.9349 1.56511,-3.531301 3.4999999,-3.531301 z m 4.2187499,10.312601 c -0.206517,0.2356 -0.844218,0.9428 -1.03125,1.1562 l 0.8125,0 c 0.01392,-0.4081 0.107026,-0.7968 0.21875,-1.1562 z";function Oz(t,n,i){t=On(t);let o=new Bz(n,i);o._exitVRPath=Pmt,o._enterVRPath=vmt;let r=document.createElement("button");r.type="button",r.className="cesium-button cesium-vrButton",r.setAttribute("data-bind",'css: { "cesium-button-disabled" : _isOrthographic }, attr: { title: tooltip },click: command,enable: isVREnabled,cesiumSvgPath: { path: isVRMode ? _exitVRPath : _enterVRPath, width: 32, height: 32 }'),t.appendChild(r),xe.applyBindings(o,r),this._container=t,this._viewModel=o,this._element=r}Object.defineProperties(Oz.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}});Oz.prototype.isDestroyed=function(){return!1};Oz.prototype.destroy=function(){return this._viewModel.destroy(),xe.cleanNode(this._element),this._container.removeChild(this._element),ue(this)};var Rz=Oz;var c0=new ae;function iye(t){let n=t.clock;n.currentTime=t.timeJulian,n.shouldAnimate=!1}function Imt(t){let n=t.getPropertyIds(),i="";return n.forEach(function(o){let r=t.getProperty(o);f(r)&&(i+=`<tr><th>${o}</th><td>${r}</td></tr>`)}),i.length>0&&(i=`<table class="cesium-infoBox-defaultTable"><tbody>${i}</tbody></table>`),i}function Bmt(t){let n,i=[],o=t.getPropertyIds();for(n=0;n<o.length;n++){let s=o[n];/^name$/i.test(s)?i[0]=t.getProperty(s):/name/i.test(s)?i[1]=t.getProperty(s):/^title$/i.test(s)?i[2]=t.getProperty(s):/^(id|identifier)$/i.test(s)?i[3]=t.getProperty(s):/element/i.test(s)?i[4]=t.getProperty(s):/(id|identifier)$/i.test(s)&&(i[5]=t.getProperty(s))}let r=i.length;for(n=0;n<r;n++){let s=i[n];if(f(s)&&s!=="")return s}return"Unnamed Feature"}function tye(t,n){let i=t.scene.pick(n.position);if(f(i)){let o=A(i.id,i.primitive.id);if(o instanceof Qo)return o;if(i instanceof Ds)return new Qo({name:Bmt(i),description:Imt(i),feature:i})}if(f(t.scene.globe))return Mmt(t,n.position)}var Omt=new te;function oye(t,n,i){if(f(i)){let o=i.clock;if(f(o)&&(o.getValue(n),f(t))){let r=o.startTime,s=o.stopTime;te.equals(r,s)&&(s=te.addSeconds(r,B.EPSILON2,Omt)),t.updateFromClock(),t.zoomTo(r,s)}}}var Rmt=new m;function Mmt(t,n){let i=t.scene,o=i.camera.getPickRay(n),r=i.imageryLayers.pickImageryLayerFeatures(o,i);if(!f(r))return;let s=new Qo({id:"Loading...",description:"Loading feature information..."});return r.then(function(a){if(t.selectedEntity!==s)return;if(!f(a)||a.length===0){t.selectedEntity=nye();return}let c=a[0],l=new Qo({id:c.name,description:c.description});if(f(c.position)){let u=t.scene.globe.ellipsoid.cartographicToCartesian(c.position,Rmt);l.position=new Jc(u)}t.selectedEntity=l},function(){t.selectedEntity===s&&(t.selectedEntity=nye())}),s}function nye(){return new Qo({id:"None",description:"No features found."})}function Lmt(t,n){let i=t._geocoder,o=t._homeButton,r=t._sceneModePicker,s=t._projectionPicker,a=t._baseLayerPicker,c=t._animation,l=t._timeline,u=t._fullscreenButton,d=t._infoBox,h=t._selectionIndicator,_=n?"hidden":"visible";if(f(i)&&(i.container.style.visibility=_),f(o)&&(o.container.style.visibility=_),f(r)&&(r.container.style.visibility=_),f(s)&&(s.container.style.visibility=_),f(a)&&(a.container.style.visibility=_),f(c)&&(c.container.style.visibility=_),f(l)&&(l.container.style.visibility=_),f(u)&&u.viewModel.isFullscreenEnabled&&(u.container.style.visibility=_),f(d)&&(d.container.style.visibility=_),f(h)&&(h.container.style.visibility=_),t._container){let y=n||!f(u)?0:u.container.clientWidth;t._vrButton.container.style.right=`${y}px`,t.forceResize()}}function Ai(t,n){t=On(t),n=A(n,A.EMPTY_OBJECT);let i=(!f(n.globe)||n.globe!==!1)&&(!f(n.baseLayerPicker)||n.baseLayerPicker!==!1),o=this,r=document.createElement("div");r.className="cesium-viewer",t.appendChild(r);let s=document.createElement("div");s.className="cesium-viewer-cesiumWidgetContainer",r.appendChild(s);let a=document.createElement("div");a.className="cesium-viewer-bottom",r.appendChild(a);let c=A(n.scene3DOnly,!1),l,u,d=!1;f(n.clockViewModel)?(u=n.clockViewModel,l=u.clock):(l=new _h,u=new D4(l),d=!0),f(n.shouldAnimate)&&(l.shouldAnimate=n.shouldAnimate);let h=new K4(s,{imageryProvider:i||f(n.imageryProvider)?!1:void 0,clock:l,skyBox:n.skyBox,skyAtmosphere:n.skyAtmosphere,sceneMode:n.sceneMode,mapProjection:n.mapProjection,globe:n.globe,orderIndependentTranslucency:n.orderIndependentTranslucency,contextOptions:n.contextOptions,useDefaultRenderLoop:n.useDefaultRenderLoop,targetFrameRate:n.targetFrameRate,showRenderLoopErrors:n.showRenderLoopErrors,useBrowserRecommendedResolution:n.useBrowserRecommendedResolution,creditContainer:f(n.creditContainer)?n.creditContainer:a,creditViewport:n.creditViewport,scene3DOnly:c,shadows:n.shadows,terrainShadows:n.terrainShadows,mapMode2D:n.mapMode2D,blurActiveElementOnCanvasFocus:n.blurActiveElementOnCanvasFocus,requestRenderMode:n.requestRenderMode,maximumRenderTimeChange:n.maximumRenderTimeChange,depthPlaneEllipsoidOffset:n.depthPlaneEllipsoidOffset,msaaSamples:n.msaaSamples}),_=n.dataSources,y=!1;f(_)||(_=new _N,y=!0);let p=h.scene,C=new r2({scene:p,dataSourceCollection:_}),x=new Mr;x.add(l.onTick,Ai.prototype._onTick,this),x.add(p.morphStart,Ai.prototype._clearTrackedObject,this);let T;if(!f(n.selectionIndicator)||n.selectionIndicator!==!1){let Y=document.createElement("div");Y.className="cesium-viewer-selectionIndicatorContainer",r.appendChild(Y),T=new Tz(Y,p)}let E;if(!f(n.infoBox)||n.infoBox!==!1){let Y=document.createElement("div");Y.className="cesium-viewer-infoBoxContainer",r.appendChild(Y),E=new cz(Y);let K=E.viewModel;x.add(K.cameraClicked,Ai.prototype._onInfoBoxCameraClicked,this),x.add(K.closeClicked,Ai.prototype._onInfoBoxClockClicked,this)}let S=document.createElement("div");S.className="cesium-viewer-toolbar",r.appendChild(S);let w;if(!f(n.geocoder)||n.geocoder!==!1){let Y=document.createElement("div");Y.className="cesium-viewer-geocoderContainer",S.appendChild(Y);let K;f(n.geocoder)&&typeof n.geocoder!="boolean"&&(K=Array.isArray(n.geocoder)?n.geocoder:[n.geocoder]),w=new nz({container:Y,geocoderServices:K,scene:p}),x.add(w.viewModel.search.beforeExecute,Ai.prototype._clearObjects,this)}let D;(!f(n.homeButton)||n.homeButton!==!1)&&(D=new rz(S,p),f(w)&&x.add(D.viewModel.command.afterExecute,function(){let Y=w.viewModel;Y.searchText="",Y.isSearchInProgress&&Y.search()}),x.add(D.viewModel.command.beforeExecute,Ai.prototype._clearTrackedObject,this));let I;!c&&(!f(n.sceneModePicker)||n.sceneModePicker!==!1)&&(I=new wz(S,p));let O;n.projectionPicker&&(O=new yz(S,p));let M,L;if(i){let Y=A(n.imageryProviderViewModels,U4()),K=A(n.terrainProviderViewModels,z4());M=new k4(S,{globe:p.globe,imageryProviderViewModels:Y,selectedImageryProviderViewModel:n.selectedImageryProviderViewModel,terrainProviderViewModels:K,selectedTerrainProviderViewModel:n.selectedTerrainProviderViewModel}),L=S.getElementsByClassName("cesium-baseLayerPicker-dropDown")[0]}f(n.imageryProvider)&&n.imageryProvider!==!1&&(i&&(M.viewModel.selectedImagery=void 0),p.imageryLayers.removeAll(),p.imageryLayers.addImageryProvider(n.imageryProvider)),f(n.terrainProvider)&&(i&&(M.viewModel.selectedTerrain=void 0),p.terrainProvider=n.terrainProvider);let F;if(!f(n.navigationHelpButton)||n.navigationHelpButton!==!1){let Y=!0;try{if(f(window.localStorage)){let K=window.localStorage.getItem("cesium-hasSeenNavHelp");f(K)&&Boolean(K)?Y=!1:window.localStorage.setItem("cesium-hasSeenNavHelp","true")}}catch(K){}F=new fz({container:S,instructionsInitiallyVisible:A(n.navigationInstructionsInitiallyVisible,Y)})}let g;if(!f(n.animation)||n.animation!==!1){let Y=document.createElement("div");Y.className="cesium-viewer-animationContainer",r.appendChild(Y),g=new L4(Y,new F4(u))}let b;if(!f(n.timeline)||n.timeline!==!1){let Y=document.createElement("div");Y.className="cesium-viewer-timelineContainer",r.appendChild(Y),b=new Pz(Y,l),b.addEventListener("settime",iye,!1),b.zoomTo(l.startTime,l.stopTime)}let v,P,R;(!f(n.fullscreenButton)||n.fullscreenButton!==!1)&&(R=document.createElement("div"),R.className="cesium-viewer-fullscreenContainer",r.appendChild(R),v=new $4(R,n.fullscreenElement),P=da(v.viewModel,"isFullscreenEnabled",function(Y){R.style.display=Y?"block":"none",f(b)&&(b.container.style.right=`${R.clientWidth}px`,b.resize())}));let V,H,U;if(n.vrButton){let Y=document.createElement("div");Y.className="cesium-viewer-vrContainer",r.appendChild(Y),V=new Rz(Y,p,n.fullScreenElement),H=da(V.viewModel,"isVREnabled",function(K){Y.style.display=K?"block":"none",f(v)&&(Y.style.right=`${R.clientWidth}px`),f(b)&&(b.container.style.right=`${Y.clientWidth}px`,b.resize())}),U=da(V.viewModel,"isVRMode",function(K){Lmt(o,K)})}this._baseLayerPickerDropDown=L,this._fullscreenSubscription=P,this._vrSubscription=H,this._vrModeSubscription=U,this._dataSourceChangedListeners={},this._automaticallyTrackDataSourceClocks=A(n.automaticallyTrackDataSourceClocks,!0),this._container=t,this._bottomContainer=a,this._element=r,this._cesiumWidget=h,this._selectionIndicator=T,this._infoBox=E,this._dataSourceCollection=_,this._destroyDataSourceCollection=y,this._dataSourceDisplay=C,this._clockViewModel=u,this._destroyClockViewModel=d,this._toolbar=S,this._homeButton=D,this._sceneModePicker=I,this._projectionPicker=O,this._baseLayerPicker=M,this._navigationHelpButton=F,this._animation=g,this._timeline=b,this._fullscreenButton=v,this._vrButton=V,this._geocoder=w,this._eventHelper=x,this._lastWidth=0,this._lastHeight=0,this._allowDataSourcesToSuspendAnimation=!0,this._entityView=void 0,this._enableInfoOrSelection=f(E)||f(T),this._clockTrackedDataSource=void 0,this._trackedEntity=void 0,this._needTrackedEntityUpdate=!1,this._selectedEntity=void 0,this._zoomIsFlight=!1,this._zoomTarget=void 0,this._zoomPromise=void 0,this._zoomOptions=void 0,this._selectedEntityChanged=new Ae,this._trackedEntityChanged=new Ae,xe.track(this,["_trackedEntity","_selectedEntity","_clockTrackedDataSource"]),x.add(_.dataSourceAdded,Ai.prototype._onDataSourceAdded,this),x.add(_.dataSourceRemoved,Ai.prototype._onDataSourceRemoved,this),x.add(p.postUpdate,Ai.prototype.resize,this),x.add(p.postRender,Ai.prototype._postRender,this);let G=_.length;for(let Y=0;Y<G;Y++)this._dataSourceAdded(_,_.get(Y));this._dataSourceAdded(void 0,C.defaultDataSource),x.add(_.dataSourceAdded,Ai.prototype._dataSourceAdded,this),x.add(_.dataSourceRemoved,Ai.prototype._dataSourceRemoved,this);function k(Y){let K=tye(o,Y);f(K)?q.getValueOrUndefined(K.position,o.clock.currentTime)?o.trackedEntity=K:o.zoomTo(K):f(o.trackedEntity)&&(o.trackedEntity=void 0)}function X(Y){o.selectedEntity=tye(o,Y)}h.screenSpaceEventHandler.setInputAction(X,yn.LEFT_CLICK),h.screenSpaceEventHandler.setInputAction(k,yn.LEFT_DOUBLE_CLICK)}Object.defineProperties(Ai.prototype,{container:{get:function(){return this._container}},bottomContainer:{get:function(){return this._bottomContainer}},cesiumWidget:{get:function(){return this._cesiumWidget}},selectionIndicator:{get:function(){return this._selectionIndicator}},infoBox:{get:function(){return this._infoBox}},geocoder:{get:function(){return this._geocoder}},homeButton:{get:function(){return this._homeButton}},sceneModePicker:{get:function(){return this._sceneModePicker}},projectionPicker:{get:function(){return this._projectionPicker}},baseLayerPicker:{get:function(){return this._baseLayerPicker}},navigationHelpButton:{get:function(){return this._navigationHelpButton}},animation:{get:function(){return this._animation}},timeline:{get:function(){return this._timeline}},fullscreenButton:{get:function(){return this._fullscreenButton}},vrButton:{get:function(){return this._vrButton}},dataSourceDisplay:{get:function(){return this._dataSourceDisplay}},entities:{get:function(){return this._dataSourceDisplay.defaultDataSource.entities}},dataSources:{get:function(){return this._dataSourceCollection}},canvas:{get:function(){return this._cesiumWidget.canvas}},scene:{get:function(){return this._cesiumWidget.scene}},shadows:{get:function(){return this.scene.shadowMap.enabled},set:function(t){this.scene.shadowMap.enabled=t}},terrainShadows:{get:function(){return this.scene.globe.shadows},set:function(t){this.scene.globe.shadows=t}},shadowMap:{get:function(){return this.scene.shadowMap}},imageryLayers:{get:function(){return this.scene.imageryLayers}},terrainProvider:{get:function(){return this.scene.terrainProvider},set:function(t){this.scene.terrainProvider=t}},camera:{get:function(){return this.scene.camera}},postProcessStages:{get:function(){return this.scene.postProcessStages}},clock:{get:function(){return this._clockViewModel.clock}},clockViewModel:{get:function(){return this._clockViewModel}},screenSpaceEventHandler:{get:function(){return this._cesiumWidget.screenSpaceEventHandler}},targetFrameRate:{get:function(){return this._cesiumWidget.targetFrameRate},set:function(t){this._cesiumWidget.targetFrameRate=t}},useDefaultRenderLoop:{get:function(){return this._cesiumWidget.useDefaultRenderLoop},set:function(t){this._cesiumWidget.useDefaultRenderLoop=t}},resolutionScale:{get:function(){return this._cesiumWidget.resolutionScale},set:function(t){this._cesiumWidget.resolutionScale=t}},useBrowserRecommendedResolution:{get:function(){return this._cesiumWidget.useBrowserRecommendedResolution},set:function(t){this._cesiumWidget.useBrowserRecommendedResolution=t}},allowDataSourcesToSuspendAnimation:{get:function(){return this._allowDataSourcesToSuspendAnimation},set:function(t){this._allowDataSourcesToSuspendAnimation=t}},trackedEntity:{get:function(){return this._trackedEntity},set:function(t){if(this._trackedEntity!==t){this._trackedEntity=t,Mz(this);let n=this.scene,i=n.mode;!f(t)||!f(t.position)?(this._needTrackedEntityUpdate=!1,(i===ne.COLUMBUS_VIEW||i===ne.SCENE2D)&&(n.screenSpaceCameraController.enableTranslate=!0),(i===ne.COLUMBUS_VIEW||i===ne.SCENE3D)&&(n.screenSpaceCameraController.enableTilt=!0),this._entityView=void 0,this.camera.lookAtTransform(N.IDENTITY)):this._needTrackedEntityUpdate=!0,this._trackedEntityChanged.raiseEvent(t),this.scene.requestRender()}}},selectedEntity:{get:function(){return this._selectedEntity},set:function(t){if(this._selectedEntity!==t){this._selectedEntity=t;let n=f(this._selectionIndicator)?this._selectionIndicator.viewModel:void 0;f(t)?f(n)&&n.animateAppear():f(n)&&n.animateDepart(),this._selectedEntityChanged.raiseEvent(t)}}},selectedEntityChanged:{get:function(){return this._selectedEntityChanged}},trackedEntityChanged:{get:function(){return this._trackedEntityChanged}},clockTrackedDataSource:{get:function(){return this._clockTrackedDataSource},set:function(t){this._clockTrackedDataSource!==t&&(this._clockTrackedDataSource=t,oye(this._timeline,this.clock,t))}}});Ai.prototype.extend=function(t,n){t(this,n)};Ai.prototype.resize=function(){let t=this._cesiumWidget,n=this._container,i=n.clientWidth,o=n.clientHeight,r=f(this._animation),s=f(this._timeline);if(t.resize(),i===this._lastWidth&&o===this._lastHeight)return;let a=o-125,c=this._baseLayerPickerDropDown;if(f(c)&&(c.style.maxHeight=`${a}px`),f(this._geocoder)){let y=this._geocoder.searchSuggestionsContainer;y.style.maxHeight=`${a}px`}f(this._infoBox)&&(this._infoBox.viewModel.maxHeight=a);let l=this._timeline,u,d=0,h=0,_=0;if(r&&window.getComputedStyle(this._animation.container).visibility!=="hidden"){let y=this._lastWidth;u=this._animation.container,i>900?(d=169,y<=900&&(u.style.width="169px",u.style.height="112px",this._animation.resize())):i>=600?(d=136,(y<600||y>900)&&(u.style.width="136px",u.style.height="90px",this._animation.resize())):(d=106,(y>600||y===0)&&(u.style.width="106px",u.style.height="70px",this._animation.resize())),h=d+5}if(s&&window.getComputedStyle(this._timeline.container).visibility!=="hidden"){let y=this._fullscreenButton,p=this._vrButton,C=l.container,x=C.style;_=C.clientHeight+3,x.left=`${d}px`;let T=0;f(y)&&(T+=y.container.clientWidth),f(p)&&(T+=p.container.clientWidth),x.right=`${T}px`,l.resize()}this._bottomContainer.style.left=`${h}px`,this._bottomContainer.style.bottom=`${_}px`,this._lastWidth=i,this._lastHeight=o};Ai.prototype.forceResize=function(){this._lastWidth=0,this.resize()};Ai.prototype.render=function(){this._cesiumWidget.render()};Ai.prototype.isDestroyed=function(){return!1};Ai.prototype.destroy=function(){let t;this.screenSpaceEventHandler.removeInputAction(yn.LEFT_CLICK),this.screenSpaceEventHandler.removeInputAction(yn.LEFT_DOUBLE_CLICK);let n=this.dataSources,i=n.length;for(t=0;t<i;t++)this._dataSourceRemoved(n,n.get(t));return this._dataSourceRemoved(void 0,this._dataSourceDisplay.defaultDataSource),this._container.removeChild(this._element),this._element.removeChild(this._toolbar),this._eventHelper.removeAll(),f(this._geocoder)&&(this._geocoder=this._geocoder.destroy()),f(this._homeButton)&&(this._homeButton=this._homeButton.destroy()),f(this._sceneModePicker)&&(this._sceneModePicker=this._sceneModePicker.destroy()),f(this._projectionPicker)&&(this._projectionPicker=this._projectionPicker.destroy()),f(this._baseLayerPicker)&&(this._baseLayerPicker=this._baseLayerPicker.destroy()),f(this._animation)&&(this._element.removeChild(this._animation.container),this._animation=this._animation.destroy()),f(this._timeline)&&(this._timeline.removeEventListener("settime",iye,!1),this._element.removeChild(this._timeline.container),this._timeline=this._timeline.destroy()),f(this._fullscreenButton)&&(this._fullscreenSubscription.dispose(),this._element.removeChild(this._fullscreenButton.container),this._fullscreenButton=this._fullscreenButton.destroy()),f(this._vrButton)&&(this._vrSubscription.dispose(),this._vrModeSubscription.dispose(),this._element.removeChild(this._vrButton.container),this._vrButton=this._vrButton.destroy()),f(this._infoBox)&&(this._element.removeChild(this._infoBox.container),this._infoBox=this._infoBox.destroy()),f(this._selectionIndicator)&&(this._element.removeChild(this._selectionIndicator.container),this._selectionIndicator=this._selectionIndicator.destroy()),this._destroyClockViewModel&&(this._clockViewModel=this._clockViewModel.destroy()),this._dataSourceDisplay=this._dataSourceDisplay.destroy(),this._cesiumWidget=this._cesiumWidget.destroy(),this._destroyDataSourceCollection&&(this._dataSourceCollection=this._dataSourceCollection.destroy()),ue(this)};Ai.prototype._dataSourceAdded=function(t,n){n.entities.collectionChanged.addEventListener(Ai.prototype._onEntityCollectionChanged,this)};Ai.prototype._dataSourceRemoved=function(t,n){let i=n.entities;i.collectionChanged.removeEventListener(Ai.prototype._onEntityCollectionChanged,this),f(this.trackedEntity)&&i.getById(this.trackedEntity.id)===this.trackedEntity&&(this.trackedEntity=void 0),f(this.selectedEntity)&&i.getById(this.selectedEntity.id)===this.selectedEntity&&(this.selectedEntity=void 0)};Ai.prototype._onTick=function(t){let n=t.currentTime,i=this._dataSourceDisplay.update(n);this._allowDataSourcesToSuspendAnimation&&(this._clockViewModel.canAnimate=i);let o=this._entityView;if(f(o)){let d=this._trackedEntity;this._dataSourceDisplay.getBoundingSphere(d,!1,c0)===rt.DONE&&o.update(n,c0)}let r,s=!1,a=this.selectedEntity,c=f(a)&&this._enableInfoOrSelection;c&&a.isShowing&&a.isAvailable(n)&&(this._dataSourceDisplay.getBoundingSphere(a,!0,c0)!==rt.FAILED?r=c0.center:f(a.position)&&(r=a.position.getValue(n,r)),s=f(r));let l=f(this._selectionIndicator)?this._selectionIndicator.viewModel:void 0;f(l)&&(l.position=m.clone(r,l.position),l.showSelection=c&&s,l.update());let u=f(this._infoBox)?this._infoBox.viewModel:void 0;f(u)&&(u.showInfo=c,u.enableCamera=s,u.isCameraTracking=this.trackedEntity===this.selectedEntity,c?(u.titleText=A(a.name,a.id),u.description=q.getValueOrDefault(a.description,n,"")):(u.titleText="",u.description=""))};Ai.prototype._onEntityCollectionChanged=function(t,n,i){let o=i.length;for(let r=0;r<o;r++){let s=i[r];this.trackedEntity===s&&(this.trackedEntity=void 0),this.selectedEntity===s&&(this.selectedEntity=void 0)}};Ai.prototype._onInfoBoxCameraClicked=function(t){if(t.isCameraTracking&&this.trackedEntity===this.selectedEntity)this.trackedEntity=void 0;else{let i=this.selectedEntity.position;f(i)?this.trackedEntity=this.selectedEntity:this.zoomTo(this.selectedEntity)}};Ai.prototype._clearTrackedObject=function(){this.trackedEntity=void 0};Ai.prototype._onInfoBoxClockClicked=function(t){this.selectedEntity=void 0};Ai.prototype._clearObjects=function(){this.trackedEntity=void 0,this.selectedEntity=void 0};Ai.prototype._onDataSourceChanged=function(t){this.clockTrackedDataSource===t&&oye(this.timeline,this.clock,t)};Ai.prototype._onDataSourceAdded=function(t,n){this._automaticallyTrackDataSourceClocks&&(this.clockTrackedDataSource=n);let i=n.entities.id,o=this._eventHelper.add(n.changedEvent,Ai.prototype._onDataSourceChanged,this);this._dataSourceChangedListeners[i]=o};Ai.prototype._onDataSourceRemoved=function(t,n){let i=this.clockTrackedDataSource===n,o=n.entities.id;if(this._dataSourceChangedListeners[o](),this._dataSourceChangedListeners[o]=void 0,i){let r=t.length;this._automaticallyTrackDataSourceClocks&&r>0?this.clockTrackedDataSource=t.get(r-1):this.clockTrackedDataSource=void 0}};Ai.prototype.zoomTo=function(t,n){return rye(this,t,{offset:n},!1)};Ai.prototype.flyTo=function(t,n){return rye(this,t,n,!0)};function rye(t,n,i,o){Mz(t);let r=new Promise(s=>{t._completeZoom=function(a){s(a)}});return t._zoomPromise=r,t._zoomIsFlight=o,t._zoomOptions=i,Promise.resolve(n).then(function(s){if(t._zoomPromise===r){if(s instanceof lf){s.getViewableRectangle().then(function(a){return RE(a,t.scene)}).then(function(a){t._zoomPromise===r&&(t._zoomTarget=a)});return}if(s instanceof $c){t._zoomTarget=s;return}if(s instanceof Zv){t._zoomTarget=s;return}if(s.isLoading&&f(s.loadingEvent)){let a=s.loadingEvent.addEventListener(function(){a(),t._zoomPromise===r&&(t._zoomTarget=s.entities.values.slice(0))});return}if(Array.isArray(s)){t._zoomTarget=s.slice(0);return}s=A(s.values,s),f(s.entities)&&(s=s.entities.values),Array.isArray(s)?t._zoomTarget=s.slice(0):t._zoomTarget=[s]}}),t.scene.requestRender(),r}function ub(t){t._zoomPromise=void 0,t._zoomTarget=void 0,t._zoomOptions=void 0}function Mz(t){let n=t._zoomPromise;f(n)&&(ub(t),t._completeZoom(!1))}Ai.prototype._postRender=function(){Fmt(this),Nmt(this)};function Fmt(t){let n=t._zoomTarget;if(!f(n)||t.scene.mode===ne.MORPHING)return;let i=t.scene,o=i.camera,r=A(t._zoomOptions,{}),s;if(n instanceof $c)return n.readyPromise.then(function(){let u=n.boundingSphere;f(r.offset)||(r.offset=new Ku(0,-.5,u.radius)),s={offset:r.offset,duration:r.duration,maximumHeight:r.maximumHeight,complete:function(){t._completeZoom(!0)},cancel:function(){t._completeZoom(!1)}},t._zoomIsFlight?o.flyToBoundingSphere(n.boundingSphere,s):(o.viewBoundingSphere(u,r.offset),o.lookAtTransform(N.IDENTITY),t._completeZoom(!0)),ub(t)}).catch(()=>{Mz(t)});if(n instanceof Zv)return n.readyPromise.then(function(){let u=n.boundingSphere;f(r.offset)||(r.offset=new Ku(0,-.5,u.radius)),s={offset:r.offset,duration:r.duration,maximumHeight:r.maximumHeight,complete:function(){t._completeZoom(!0)},cancel:function(){t._completeZoom(!1)}},t._zoomIsFlight?o.flyToBoundingSphere(u,s):(o.viewBoundingSphere(u,r.offset),o.lookAtTransform(N.IDENTITY),t._completeZoom(!0)),ub(t)});if(n instanceof de){s={destination:i.mapProjection.ellipsoid.cartographicToCartesian(n),duration:r.duration,maximumHeight:r.maximumHeight,complete:function(){t._completeZoom(!0)},cancel:function(){t._completeZoom(!1)}},t._zoomIsFlight?o.flyTo(s):(o.setView(s),t._completeZoom(!0)),ub(t);return}let a=n,c=[];for(let u=0,d=a.length;u<d;u++){let h=t._dataSourceDisplay.getBoundingSphere(a[u],!1,c0);if(h===rt.PENDING)return;h!==rt.FAILED&&c.push(ae.clone(c0))}if(c.length===0){Mz(t);return}t.trackedEntity=void 0;let l=ae.fromBoundingSpheres(c);t._zoomIsFlight?(ub(t),o.flyToBoundingSphere(l,{duration:r.duration,maximumHeight:r.maximumHeight,complete:function(){t._completeZoom(!0)},cancel:function(){t._completeZoom(!1)},offset:r.offset})):(o.viewBoundingSphere(l,r.offset),o.lookAtTransform(N.IDENTITY),ub(t),t._completeZoom(!0))}function Nmt(t){if(!t._needTrackedEntityUpdate)return;let n=t._trackedEntity,i=t.clock.currentTime,o=q.getValueOrUndefined(n.position,i);if(!f(o))return;let r=t.scene,s=t._dataSourceDisplay.getBoundingSphere(n,!1,c0);if(s===rt.PENDING)return;let a=r.mode;(a===ne.COLUMBUS_VIEW||a===ne.SCENE2D)&&(r.screenSpaceCameraController.enableTranslate=!1),(a===ne.COLUMBUS_VIEW||a===ne.SCENE3D)&&(r.screenSpaceCameraController.enableTilt=!1);let c=s!==rt.FAILED?c0:void 0;t._entityView=new c2(n,r,r.mapProjection.ellipsoid),t._entityView.update(i,c),t._needTrackedEntityUpdate=!1}var sye=Ai;function Vmt(t){let n=document.createElement("div");n.className="cesium-viewer-cesium3DTilesInspectorContainer",t.container.appendChild(n);let i=new j4(n,t.scene);Object.defineProperties(t,{cesium3DTilesInspector:{get:function(){return i}}})}var aye=Vmt;function kmt(t){let n=document.createElement("div");n.className="cesium-viewer-cesiumInspectorContainer",t.container.appendChild(n);let i=new X4(n,t.scene);Object.defineProperties(t,{cesiumInspector:{get:function(){return i}}})}var cye=kmt;function Umt(t,n){n=A(n,A.EMPTY_OBJECT);let i=!0,o=A(n.flyToOnDrop,!0),r=new Ae,s=A(n.clearOnDrop,!0),a=A(n.dropTarget,t.container),c=A(n.clampToGround,!0),l=n.proxy;a=On(a),Object.defineProperties(t,{dropTarget:{get:function(){return a},set:function(d){lye(a,u),a=d,Qq(a,u)}},dropEnabled:{get:function(){return i},set:function(d){d!==i&&(d?Qq(a,u):lye(a,u),i=d)}},dropError:{get:function(){return r}},clearOnDrop:{get:function(){return s},set:function(d){s=d}},flyToOnDrop:{get:function(){return o},set:function(d){o=d}},proxy:{get:function(){return l},set:function(d){l=d}},clampToGround:{get:function(){return c},set:function(d){c=d}}});function u(d){kA(d),s&&(t.entities.removeAll(),t.dataSources.removeAll());let h=d.dataTransfer.files,_=h.length;for(let y=0;y<_;y++){let p=h[y],C=new FileReader;C.onload=zmt(t,p,l,c),C.onerror=Hmt(t,p),C.readAsText(p)}}Qq(a,u),t.destroy=_V(t,t.destroy,function(){t.dropEnabled=!1}),t._handleDrop=u}function kA(t){t.stopPropagation(),t.preventDefault()}function lye(t,n){let i=t;f(i)&&(i.removeEventListener("drop",n,!1),i.removeEventListener("dragenter",kA,!1),i.removeEventListener("dragover",kA,!1),i.removeEventListener("dragexit",kA,!1))}function Qq(t,n){t.addEventListener("drop",n,!1),t.addEventListener("dragenter",kA,!1),t.addEventListener("dragover",kA,!1),t.addEventListener("dragexit",kA,!1)}function zmt(t,n,i,o){let r=t.scene;return function(s){let a=n.name;try{let c;if(/\.czml$/i.test(a))c=mN.load(JSON.parse(s.target.result),{sourceUri:a});else if(/\.geojson$/i.test(a)||/\.json$/i.test(a)||/\.topojson$/i.test(a))c=o3.load(JSON.parse(s.target.result),{sourceUri:a,clampToGround:o});else if(/\.(kml|kmz)$/i.test(a))c=O3.load(n,{sourceUri:a,proxy:i,camera:r.camera,canvas:r.canvas,clampToGround:o,screenOverlayContainer:t.container});else if(/\.gpx$/i.test(a))c=y3.load(n,{sourceUri:a,proxy:i});else{t.dropError.raiseEvent(t,a,`Unrecognized file: ${a}`);return}f(c)&&t.dataSources.add(c).then(function(l){t.flyToOnDrop&&t.flyTo(l)}).catch(function(l){t.dropError.raiseEvent(t,a,l)})}catch(c){t.dropError.raiseEvent(t,a,c)}}}function Hmt(t,n){return function(i){t.dropError.raiseEvent(t,n.name,i.target.error)}}var uye=Umt;function Gmt(t,n){n=A(n,A.EMPTY_OBJECT);let i=new mz({scene:t.scene,container:t.bottomContainer,lowFrameRateMessage:n.lowFrameRateMessage});Object.defineProperties(t,{performanceWatchdog:{get:function(){return i}}})}var fye=Gmt;function Wmt(t,n,i){let o;try{return o=t(n,i),o}catch(r){return Promise.reject(r)}}function jmt(t){let n;return function(i){let o=i.data,r=[],s={id:o.id,result:void 0,error:void 0};return Promise.resolve(Wmt(t,o.parameters,r)).then(function(a){s.result=a}).catch(function(a){a instanceof Error?s.error={name:a.name,message:a.message,stack:a.stack}:s.error=a}).finally(function(){f(n)||(n=A(self.webkitPostMessage,self.postMessage)),o.canTransferArrayBuffer||(r.length=0);try{n(s,r)}catch(a){s.result=void 0,s.error=`postMessage failed with error: ${_p(a)}
  with responseMessage: ${JSON.stringify(s)}`,n(s)}})}}var dye=jmt;var qmt="1.99";return vye(Ymt);})();
